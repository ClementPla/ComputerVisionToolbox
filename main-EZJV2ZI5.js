import{$ as Re,C as oR,E as aR,F as sR,J as qb,P as zg,S as Ln,T as lR,U as yr,V as ji,W as Xb,X as qa,Z as Dn,_ as Ca,aa as rh,f as Ml,fa as cR,g as nR,ga as dR,h as ih,ha as uR,i as gd,ia as xC,ja as hR,k as vd,ka as pR,l as Es,la as fR,m as mn,n as kl,o as gn,q as Wb}from"./chunk-SC6CLNZB.js";import{$ as u3,$a as $p,$b as qt,$c as Ss,A as ud,Aa as Xu,Ab as N3,Ac as q3,B as hd,Ba as vt,Bb as C,Bc as Ju,C as Hp,Ca as We,Cb as A,Cc as X3,D as sC,Da as Yu,Db as he,Dc as Y3,E as wn,Ea as g3,Eb as Ot,Ec as Bt,F as Pg,Fa as Rg,Fb as Rt,Fc as Z3,G as $u,Ga as v3,Gb as Yp,Gc as Vg,H as Wu,Ha as mc,Hb as Ze,Hc as K3,I as pd,Ia as pr,Ib as Dl,Ic as Q3,J as lC,Ja as Fg,Jb as O3,Jc as eh,K as a3,Ka as jp,Kb as Y,Kc as J3,L as cC,La as Gp,Lb as R3,Lc as Il,M as s3,Ma as _3,Mb as ae,Mc as Xn,N as l3,Na as b3,Nb as vi,Nc as Yn,O as dC,Oa as y3,Ob as gt,Oc as Gb,P as Ob,Pa as x3,Pb as Xi,Pc as th,Q as xa,Qa as w3,Qb as ht,Qc as eR,R as An,Ra as E3,Rb as Ve,Rc as To,S as Ui,Sa as C3,Sb as ze,Sc as tR,T as c3,Ta as Wa,Tb as Ft,Tc as $b,U as an,Ua as S3,Ub as W,Uc as yC,V as d3,Va as T3,Vb as Pr,Vc as iR,W as Tr,Wa as A3,Wb as Qr,Wc as rR,X as fd,Xa as pC,Xb as F3,Xc as Pl,Y as Yo,Ya as Lg,Yb as L3,Yc as ll,Z as tt,Za as O,Zb as Wt,Zc as Ko,_ as it,_a as G,_b as jt,_c as Cs,a as fn,aa as Ye,ab as Wp,ac as Li,ad as mR,b as r3,ba as uC,bb as Lb,bc as ci,bd as gR,c as al,ca as Ae,cb as qp,cc as gc,d as rC,da as Je,db as Xp,dc as Zu,e as Mb,ea as h3,eb as Bg,ec as Zp,f as Ct,fa as Rb,fb as fC,fc as B3,g as Eo,ga as hC,gb as st,gc as V3,h as nC,ha as Ng,hb as mC,hc as Ku,hd as vR,i as n3,ia as _e,ib as sl,ic as z3,id as Ug,j as ws,ja as Le,jb as gC,jc as Vb,jd as Yb,k as Co,ka as rt,kb as D3,kc as U3,l as Dt,la as xt,lb as Yt,lc as zb,m as Gu,ma as Fb,mb as Hi,mc as Ub,n as kb,na as p3,nb as I3,nc as _C,o as o3,oa as f3,ob as vC,oc as Hb,od as _R,p as Xt,pa as qu,pb as M3,pc as bC,pd as Zb,q as Up,qa as md,qb as Be,qc as H3,r as $a,ra as kr,rb as Zt,rc as Qu,rd as bR,s as oC,sa as q,sb as z,sc as jb,t as Pb,ta as X,tb as li,tc as j3,u as kg,ua as wa,ub as It,uc as ei,v as Nb,va as Og,vb as Kr,vc as G3,w as ya,wa as Ar,wb as Bb,wc as $3,wd as yR,x as So,xa as Zo,xb as Ni,xc as yt,y as Ji,ya as m3,yb as k3,yc as sn,z as aC,za as Ea,zb as P3,zc as W3}from"./chunk-KGZBHULH.js";import{a as L,b as ve,c as ju,e as _Q,g as i3,h as Qe,i as iC}from"./chunk-BQWXLU4Q.js";var qM=_Q(($M,WM)=>{"use strict";(function(e,t){typeof $M=="object"&&typeof WM<"u"?WM.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self,e["'typed'"]=t())})($M,function(){"use strict";function e(){return!0}function t(){return!1}function i(){}let r="Argument is not a typed-function.";function n(){function a(H){return typeof H=="object"&&H!==null&&H.constructor===Object}let s=[{name:"number",test:function(H){return typeof H=="number"}},{name:"string",test:function(H){return typeof H=="string"}},{name:"boolean",test:function(H){return typeof H=="boolean"}},{name:"Function",test:function(H){return typeof H=="function"}},{name:"Array",test:Array.isArray},{name:"Date",test:function(H){return H instanceof Date}},{name:"RegExp",test:function(H){return H instanceof RegExp}},{name:"Object",test:a},{name:"null",test:function(H){return H===null}},{name:"undefined",test:function(H){return H===void 0}}],c={name:"any",test:e,isAny:!0},l,d,u=0,h={createCount:0};function p(H){let ee=l.get(H);if(ee)return ee;let ce='Unknown type "'+H+'"',Se=H.toLowerCase(),Oe;for(Oe of d)if(Oe.toLowerCase()===Se){ce+='. Did you mean "'+Oe+'" ?';break}throw new TypeError(ce)}function m(H){let ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"any",ce=ee?p(ee).index:d.length,Se=[];for(let Me=0;Me<H.length;++Me){if(!H[Me]||typeof H[Me].name!="string"||typeof H[Me].test!="function")throw new TypeError("Object with properties {name: string, test: function} expected");let at=H[Me].name;if(l.has(at))throw new TypeError('Duplicate type name "'+at+'"');Se.push(at),l.set(at,{name:at,test:H[Me].test,isAny:H[Me].isAny,index:ce+Me,conversionsTo:[]})}let Oe=d.slice(ce);d=d.slice(0,ce).concat(Se).concat(Oe);for(let Me=ce+Se.length;Me<d.length;++Me)l.get(d[Me]).index=Me}function f(){l=new Map,d=[],u=0,m([c],!1)}f(),m(s);function g(){let H;for(H of d)l.get(H).conversionsTo=[];u=0}function v(H){let ee=d.filter(ce=>{let Se=l.get(ce);return!Se.isAny&&Se.test(H)});return ee.length?ee:["any"]}function _(H){return H&&typeof H=="function"&&"_typedFunctionData"in H}function b(H,ee,ce){if(!_(H))throw new TypeError(r);let Se=ce&&ce.exact,Oe=Array.isArray(ee)?ee.join(","):ee,Me=N(Oe),at=w(Me);if(!Se||at in H.signatures){let hr=H._typedFunctionData.signatureMap.get(at);if(hr)return hr}let je=Me.length,lt;if(Se){lt=[];let hr;for(hr in H.signatures)lt.push(H._typedFunctionData.signatureMap.get(hr))}else lt=H._typedFunctionData.signatures;for(let hr=0;hr<je;++hr){let Sr=Me[hr],pn=[],uo;for(uo of lt){let qn=R(uo.params,hr);if(!(!qn||Sr.restParam&&!qn.restParam)){if(!qn.hasAny){let va=E(qn);if(Sr.types.some(_a=>!va.has(_a.name)))continue}pn.push(uo)}}if(lt=pn,lt.length===0)break}let Ue;for(Ue of lt)if(Ue.params.length<=je)return Ue;throw new TypeError("Signature not found (signature: "+(H.name||"unnamed")+"("+w(Me,", ")+"))")}function y(H,ee,ce){return b(H,ee,ce).implementation}function x(H,ee){let ce=p(ee);if(ce.test(H))return H;let Se=ce.conversionsTo;if(Se.length===0)throw new Error("There are no conversions to "+ee+" defined.");for(let Oe=0;Oe<Se.length;Oe++)if(p(Se[Oe].from).test(H))return Se[Oe].convert(H);throw new Error("Cannot convert "+H+" to "+ee)}function w(H){let ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",";return H.map(ce=>ce.name).join(ee)}function I(H){let ee=H.indexOf("...")===0,Se=(ee?H.length>3?H.slice(3):"any":H).split("|").map(je=>p(je.trim())),Oe=!1,Me=ee?"...":"";return{types:Se.map(function(je){return Oe=je.isAny||Oe,Me+=je.name+"|",{name:je.name,typeIndex:je.index,test:je.test,isAny:je.isAny,conversion:null,conversionIndex:-1}}),name:Me.slice(0,-1),hasAny:Oe,hasConversion:!1,restParam:ee}}function S(H){let ee=H.types.map(at=>at.name),ce=ue(ee),Se=H.hasAny,Oe=H.name,Me=ce.map(function(at){let je=p(at.from);return Se=je.isAny||Se,Oe+="|"+at.from,{name:at.from,typeIndex:je.index,test:je.test,isAny:je.isAny,conversion:at,conversionIndex:at.index}});return{types:H.types.concat(Me),name:Oe,hasAny:Se,hasConversion:Me.length>0,restParam:H.restParam}}function E(H){return H.typeSet||(H.typeSet=new Set,H.types.forEach(ee=>H.typeSet.add(ee.name))),H.typeSet}function N(H){let ee=[];if(typeof H!="string")throw new TypeError("Signatures must be strings");let ce=H.trim();if(ce==="")return ee;let Se=ce.split(",");for(let Oe=0;Oe<Se.length;++Oe){let Me=I(Se[Oe].trim());if(Me.restParam&&Oe!==Se.length-1)throw new SyntaxError('Unexpected rest parameter "'+Se[Oe]+'": only allowed for the last parameter');if(Me.types.length===0)return null;ee.push(Me)}return ee}function M(H){let ee=bt(H);return ee?ee.restParam:!1}function P(H){if(!H||H.types.length===0)return e;if(H.types.length===1)return p(H.types[0].name).test;if(H.types.length===2){let ee=p(H.types[0].name).test,ce=p(H.types[1].name).test;return function(Oe){return ee(Oe)||ce(Oe)}}else{let ee=H.types.map(function(ce){return p(ce.name).test});return function(Se){for(let Oe=0;Oe<ee.length;Oe++)if(ee[Oe](Se))return!0;return!1}}}function $(H){let ee,ce,Se;if(M(H)){ee=At(H).map(P);let Oe=ee.length,Me=P(bt(H)),at=function(je){for(let lt=Oe;lt<je.length;lt++)if(!Me(je[lt]))return!1;return!0};return function(lt){for(let Ue=0;Ue<ee.length;Ue++)if(!ee[Ue](lt[Ue]))return!1;return at(lt)&&lt.length>=Oe+1}}else return H.length===0?function(Me){return Me.length===0}:H.length===1?(ce=P(H[0]),function(Me){return ce(Me[0])&&Me.length===1}):H.length===2?(ce=P(H[0]),Se=P(H[1]),function(Me){return ce(Me[0])&&Se(Me[1])&&Me.length===2}):(ee=H.map(P),function(Me){for(let at=0;at<ee.length;at++)if(!ee[at](Me[at]))return!1;return Me.length===ee.length})}function R(H,ee){return ee<H.length?H[ee]:M(H)?bt(H):null}function j(H,ee){let ce=R(H,ee);return ce?E(ce):new Set}function B(H){return H.conversion===null||H.conversion===void 0}function te(H,ee){let ce=new Set;return H.forEach(Se=>{let Oe=j(Se.params,ee),Me;for(Me of Oe)ce.add(Me)}),ce.has("any")?["any"]:Array.from(ce)}function Z(H,ee,ce){let Se,Oe,Me=H||"unnamed",at=ce,je;for(je=0;je<ee.length;je++){let Sr=[];if(at.forEach(pn=>{let uo=R(pn.params,je),qn=P(uo);(je<pn.params.length||M(pn.params))&&qn(ee[je])&&Sr.push(pn)}),Sr.length===0){if(Oe=te(at,je),Oe.length>0){let pn=v(ee[je]);return Se=new TypeError("Unexpected type of argument in function "+Me+" (expected: "+Oe.join(" or ")+", actual: "+pn.join(" | ")+", index: "+je+")"),Se.data={category:"wrongType",fn:Me,index:je,actual:pn,expected:Oe},Se}}else at=Sr}let lt=at.map(function(Sr){return M(Sr.params)?1/0:Sr.params.length});if(ee.length<Math.min.apply(null,lt))return Oe=te(at,je),Se=new TypeError("Too few arguments in function "+Me+" (expected: "+Oe.join(" or ")+", index: "+ee.length+")"),Se.data={category:"tooFewArgs",fn:Me,index:ee.length,expected:Oe},Se;let Ue=Math.max.apply(null,lt);if(ee.length>Ue)return Se=new TypeError("Too many arguments in function "+Me+" (expected: "+Ue+", actual: "+ee.length+")"),Se.data={category:"tooManyArgs",fn:Me,index:ee.length,expectedLength:Ue},Se;let hr=[];for(let Sr=0;Sr<ee.length;++Sr)hr.push(v(ee[Sr]).join("|"));return Se=new TypeError('Arguments of type "'+hr.join(", ")+'" do not match any of the defined signatures of function '+Me+"."),Se.data={category:"mismatch",actual:hr},Se}function ne(H){let ee=d.length+1;for(let ce=0;ce<H.types.length;ce++)B(H.types[ce])&&(ee=Math.min(ee,H.types[ce].typeIndex));return ee}function se(H){let ee=u+1;for(let ce=0;ce<H.types.length;ce++)B(H.types[ce])||(ee=Math.min(ee,H.types[ce].conversionIndex));return ee}function we(H,ee){if(H.hasAny){if(!ee.hasAny)return 1}else if(ee.hasAny)return-1;if(H.restParam){if(!ee.restParam)return 1}else if(ee.restParam)return-1;if(H.hasConversion){if(!ee.hasConversion)return 1}else if(ee.hasConversion)return-1;let ce=ne(H)-ne(ee);if(ce<0)return-1;if(ce>0)return 1;let Se=se(H)-se(ee);return Se<0?-1:Se>0?1:0}function ie(H,ee){let ce=H.params,Se=ee.params,Oe=bt(ce),Me=bt(Se),at=M(ce),je=M(Se);if(at&&Oe.hasAny){if(!je||!Me.hasAny)return 1}else if(je&&Me.hasAny)return-1;let lt=0,Ue=0,hr;for(hr of ce)hr.hasAny&&++lt,hr.hasConversion&&++Ue;let Sr=0,pn=0;for(hr of Se)hr.hasAny&&++Sr,hr.hasConversion&&++pn;if(lt!==Sr)return lt-Sr;if(at&&Oe.hasConversion){if(!je||!Me.hasConversion)return 1}else if(je&&Me.hasConversion)return-1;if(Ue!==pn)return Ue-pn;if(at){if(!je)return 1}else if(je)return-1;let uo=(ce.length-Se.length)*(at?-1:1);if(uo!==0)return uo;let qn=[],va=0;for(let xs=0;xs<ce.length;++xs){let Bu=we(ce[xs],Se[xs]);qn.push(Bu),va+=Bu}if(va!==0)return va;let _a;for(_a of qn)if(_a!==0)return _a;return 0}function ue(H){if(H.length===0)return[];let ee=H.map(p);H.length>1&&ee.sort((Oe,Me)=>Oe.index-Me.index);let ce=ee[0].conversionsTo;if(H.length===1)return ce;ce=ce.concat([]);let Se=new Set(H);for(let Oe=1;Oe<ee.length;++Oe){let Me;for(Me of ee[Oe].conversionsTo)Se.has(Me.from)||(ce.push(Me),Se.add(Me.from))}return ce}function Ee(H,ee){let ce=ee;if(H.some(Oe=>Oe.hasConversion)){let Oe=M(H),Me=H.map(ye);ce=function(){let je=[],lt=Oe?arguments.length-1:arguments.length;for(let Ue=0;Ue<lt;Ue++)je[Ue]=Me[Ue](arguments[Ue]);return Oe&&(je[lt]=arguments[lt].map(Me[lt])),ee.apply(this,je)}}let Se=ce;if(M(H)){let Oe=H.length-1;Se=function(){return ce.apply(this,Kt(arguments,0,Oe).concat([Kt(arguments,Oe)]))}}return Se}function ye(H){let ee,ce,Se,Oe,Me=[],at=[];switch(H.types.forEach(function(je){je.conversion&&(Me.push(p(je.conversion.from).test),at.push(je.conversion.convert))}),at.length){case 0:return function(lt){return lt};case 1:return ee=Me[0],Se=at[0],function(lt){return ee(lt)?Se(lt):lt};case 2:return ee=Me[0],ce=Me[1],Se=at[0],Oe=at[1],function(lt){return ee(lt)?Se(lt):ce(lt)?Oe(lt):lt};default:return function(lt){for(let Ue=0;Ue<at.length;Ue++)if(Me[Ue](lt))return at[Ue](lt);return lt}}}function Te(H){function ee(ce,Se,Oe){if(Se<ce.length){let Me=ce[Se],at=[];if(Me.restParam){let je=Me.types.filter(B);je.length<Me.types.length&&at.push({types:je,name:"..."+je.map(lt=>lt.name).join("|"),hasAny:je.some(lt=>lt.isAny),hasConversion:!1,restParam:!0}),at.push(Me)}else at=Me.types.map(function(je){return{types:[je],name:je.name,hasAny:je.isAny,hasConversion:je.conversion,restParam:!1}});return Ki(at,function(je){return ee(ce,Se+1,Oe.concat([je]))})}else return[Oe]}return ee(H,0,[])}function pe(H,ee){let ce=Math.max(H.length,ee.length);for(let je=0;je<ce;je++){let lt=j(H,je),Ue=j(ee,je),hr=!1,Sr;for(Sr of Ue)if(lt.has(Sr)){hr=!0;break}if(!hr)return!1}let Se=H.length,Oe=ee.length,Me=M(H),at=M(ee);return Me?at?Se===Oe:Oe>=Se:at?Se>=Oe:Se===Oe}function be(H){return H.map(ee=>gi(ee)?Qi(ee.referToSelf.callback):hn(ee)?Wi(ee.referTo.references,ee.referTo.callback):ee)}function De(H,ee,ce){let Se=[],Oe;for(Oe of H){let Me=ce[Oe];if(typeof Me!="number")throw new TypeError('No definition for referenced signature "'+Oe+'"');if(Me=ee[Me],typeof Me!="function")return!1;Se.push(Me)}return Se}function fe(H,ee,ce){let Se=be(H),Oe=new Array(Se.length).fill(!1),Me=!0;for(;Me;){Me=!1;let at=!0;for(let je=0;je<Se.length;++je){if(Oe[je])continue;let lt=Se[je];if(gi(lt))Se[je]=lt.referToSelf.callback(ce),Se[je].referToSelf=lt.referToSelf,Oe[je]=!0,at=!1;else if(hn(lt)){let Ue=De(lt.referTo.references,Se,ee);Ue?(Se[je]=lt.referTo.callback.apply(this,Ue),Se[je].referTo=lt.referTo,Oe[je]=!0,at=!1):Me=!0}}if(at&&Me)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return Se}function Ne(H){let ee=/\bthis(\(|\.signatures\b)/;Object.keys(H).forEach(ce=>{let Se=H[ce];if(ee.test(Se.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")})}function Pe(H,ee){if(h.createCount++,Object.keys(ee).length===0)throw new SyntaxError("No signatures provided");h.warnAgainstDeprecatedThis&&Ne(ee);let ce=[],Se=[],Oe={},Me=[],at;for(at in ee){if(!Object.prototype.hasOwnProperty.call(ee,at))continue;let sr=N(at);if(!sr)continue;ce.forEach(function(Uu){if(pe(Uu,sr))throw new TypeError('Conflicting signatures "'+w(Uu)+'" and "'+w(sr)+'".')}),ce.push(sr);let xo=Se.length;Se.push(ee[at]);let Sb=sr.map(S),zu;for(zu of Te(Sb)){let Uu=w(zu);Me.push({params:zu,name:Uu,fn:xo}),zu.every(Mg=>!Mg.hasConversion)&&(Oe[Uu]=xo)}}Me.sort(ie);let je=fe(Se,Oe,dd),lt;for(lt in Oe)Object.prototype.hasOwnProperty.call(Oe,lt)&&(Oe[lt]=je[Oe[lt]]);let Ue=[],hr=new Map;for(lt of Me)hr.has(lt.name)||(lt.fn=je[lt.fn],Ue.push(lt),hr.set(lt.name,lt));let Sr=Ue[0]&&Ue[0].params.length<=2&&!M(Ue[0].params),pn=Ue[1]&&Ue[1].params.length<=2&&!M(Ue[1].params),uo=Ue[2]&&Ue[2].params.length<=2&&!M(Ue[2].params),qn=Ue[3]&&Ue[3].params.length<=2&&!M(Ue[3].params),va=Ue[4]&&Ue[4].params.length<=2&&!M(Ue[4].params),_a=Ue[5]&&Ue[5].params.length<=2&&!M(Ue[5].params),xs=Sr&&pn&&uo&&qn&&va&&_a;for(let sr=0;sr<Ue.length;++sr)Ue[sr].test=$(Ue[sr].params);let Bu=Sr?P(Ue[0].params[0]):t,db=pn?P(Ue[1].params[0]):t,ub=uo?P(Ue[2].params[0]):t,hb=qn?P(Ue[3].params[0]):t,Vu=va?P(Ue[4].params[0]):t,pb=_a?P(Ue[5].params[0]):t,fb=Sr?P(Ue[0].params[1]):t,mb=pn?P(Ue[1].params[1]):t,gb=uo?P(Ue[2].params[1]):t,vb=qn?P(Ue[3].params[1]):t,_b=va?P(Ue[4].params[1]):t,bb=_a?P(Ue[5].params[1]):t;for(let sr=0;sr<Ue.length;++sr)Ue[sr].implementation=Ee(Ue[sr].params,Ue[sr].fn);let yb=Sr?Ue[0].implementation:i,xb=pn?Ue[1].implementation:i,wb=uo?Ue[2].implementation:i,Eb=qn?Ue[3].implementation:i,HE=va?Ue[4].implementation:i,jE=_a?Ue[5].implementation:i,GE=Sr?Ue[0].params.length:-1,Dg=pn?Ue[1].params.length:-1,Bp=uo?Ue[2].params.length:-1,$E=qn?Ue[3].params.length:-1,Ig=va?Ue[4].params.length:-1,WE=_a?Ue[5].params.length:-1,qE=xs?6:0,XE=Ue.length,YE=Ue.map(sr=>sr.test),cd=Ue.map(sr=>sr.implementation),Cb=function(){for(let xo=qE;xo<XE;xo++)if(YE[xo](arguments))return cd[xo].apply(this,arguments);return h.onMismatch(H,arguments,Ue)};function dd(sr,xo){return arguments.length===GE&&Bu(sr)&&fb(xo)?yb.apply(this,arguments):arguments.length===Dg&&db(sr)&&mb(xo)?xb.apply(this,arguments):arguments.length===Bp&&ub(sr)&&gb(xo)?wb.apply(this,arguments):arguments.length===$E&&hb(sr)&&vb(xo)?Eb.apply(this,arguments):arguments.length===Ig&&Vu(sr)&&_b(xo)?HE.apply(this,arguments):arguments.length===WE&&pb(sr)&&bb(xo)?jE.apply(this,arguments):Cb.apply(this,arguments)}try{Object.defineProperty(dd,"name",{value:H})}catch{}return dd.signatures=Oe,dd._typedFunctionData={signatures:Ue,signatureMap:hr},dd}function Ke(H,ee,ce){throw Z(H,ee,ce)}function At(H){return Kt(H,0,H.length-1)}function bt(H){return H[H.length-1]}function Kt(H,ee,ce){return Array.prototype.slice.call(H,ee,ce)}function zi(H,ee){for(let ce=0;ce<H.length;ce++)if(ee(H[ce]))return H[ce]}function Ki(H,ee){return Array.prototype.concat.apply([],H.map(ee))}function br(){let H=At(arguments).map(ce=>w(N(ce))),ee=bt(arguments);if(typeof ee!="function")throw new TypeError("Callback function expected as last argument");return Wi(H,ee)}function Wi(H,ee){return{referTo:{references:H,callback:ee}}}function Qi(H){if(typeof H!="function")throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:H}}}function hn(H){return H&&typeof H.referTo=="object"&&Array.isArray(H.referTo.references)&&typeof H.referTo.callback=="function"}function gi(H){return H&&typeof H.referToSelf=="object"&&typeof H.referToSelf.callback=="function"}function Zr(H,ee){if(!H)return ee;if(ee&&ee!==H){let ce=new Error("Function names do not match (expected: "+H+", actual: "+ee+")");throw ce.data={actual:ee,expected:H},ce}return H}function ys(H){let ee;for(let ce in H)Object.prototype.hasOwnProperty.call(H,ce)&&(_(H[ce])||typeof H[ce].signature=="string")&&(ee=Zr(ee,H[ce].name));return ee}function Wn(H,ee){let ce;for(ce in ee)if(Object.prototype.hasOwnProperty.call(ee,ce)){if(ce in H&&ee[ce]!==H[ce]){let Se=new Error('Signature "'+ce+'" is defined twice');throw Se.data={signature:ce,sourceFunction:ee[ce],destFunction:H[ce]},Se}H[ce]=ee[ce]}}let qo=h;h=function(H){let ee=typeof H=="string",ce=ee?1:0,Se=ee?H:"",Oe={};for(let Me=ce;Me<arguments.length;++Me){let at=arguments[Me],je={},lt;if(typeof at=="function"?(lt=at.name,typeof at.signature=="string"?je[at.signature]=at:_(at)&&(je=at.signatures)):a(at)&&(je=at,ee||(lt=ys(at))),Object.keys(je).length===0){let Ue=new TypeError("Argument to 'typed' at index "+Me+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw Ue.data={index:Me,argument:at},Ue}ee||(Se=Zr(Se,lt)),Wn(Oe,je)}return Pe(Se||"",Oe)},h.create=n,h.createCount=qo.createCount,h.onMismatch=Ke,h.throwMismatchError=Ke,h.createError=Z,h.clear=f,h.clearConversions=g,h.addTypes=m,h._findType=p,h.referTo=br,h.referToSelf=Qi,h.convert=x,h.findSignature=b,h.find=y,h.isTypedFunction=_,h.warnAgainstDeprecatedThis=!0,h.addType=function(H,ee){let ce="any";ee!==!1&&l.has("Object")&&(ce="Object"),h.addTypes([H],ce)};function Tn(H){if(!H||typeof H.from!="string"||typeof H.to!="string"||typeof H.convert!="function")throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(H.to===H.from)throw new SyntaxError('Illegal to define conversion from "'+H.from+'" to itself.')}return h.addConversion=function(H){let ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{override:!1};Tn(H);let ce=p(H.to),Se=ce.conversionsTo.find(Oe=>Oe.from===H.from);if(Se)if(ee&&ee.override)h.removeConversion({from:Se.from,to:H.to,convert:Se.convert});else throw new Error('There is already a conversion from "'+H.from+'" to "'+ce.name+'"');ce.conversionsTo.push({from:H.from,convert:H.convert,index:u++})},h.addConversions=function(H,ee){H.forEach(ce=>h.addConversion(ce,ee))},h.removeConversion=function(H){Tn(H);let ee=p(H.to),ce=zi(ee.conversionsTo,Oe=>Oe.from===H.from);if(!ce)throw new Error("Attempt to remove nonexistent conversion from "+H.from+" to "+H.to);if(ce.convert!==H.convert)throw new Error("Conversion to remove does not match existing conversion");let Se=ee.conversionsTo.indexOf(ce);ee.conversionsTo.splice(Se,1)},h.resolve=function(H,ee){if(!_(H))throw new TypeError(r);let ce=H._typedFunctionData.signatures;for(let Se=0;Se<ce.length;++Se)if(ce[Se].test(ee))return ce[Se];return null},h}var o=n();return o})});var EC=class{};var Kp=class e{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?typeof t=="string"?this.lazyInit=()=>{this.headers=new Map,t.split(`
`).forEach(i=>{let r=i.indexOf(":");if(r>0){let n=i.slice(0,r),o=n.toLowerCase(),a=i.slice(r+1).trim();this.maybeSetNormalizedName(n,o),this.headers.has(o)?this.headers.get(o).push(a):this.headers.set(o,[a])}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((i,r)=>{this.setHeaderEntries(r,i)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([i,r])=>{this.setHeaderEntries(i,r)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();let i=this.headers.get(t.toLowerCase());return i&&i.length>0?i[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,i){return this.clone({name:t,value:i,op:"a"})}set(t,i){return this.clone({name:t,value:i,op:"s"})}delete(t,i){return this.clone({name:t,value:i,op:"d"})}maybeSetNormalizedName(t,i){this.normalizedNames.has(i)||this.normalizedNames.set(i,t)}init(){this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(i=>{this.headers.set(i,t.headers.get(i)),this.normalizedNames.set(i,t.normalizedNames.get(i))})}clone(t){let i=new e;return i.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,i.lazyUpdate=(this.lazyUpdate||[]).concat([t]),i}applyUpdate(t){let i=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(t.name,i);let n=(t.op==="a"?this.headers.get(i):void 0)||[];n.push(...r),this.headers.set(i,n);break;case"d":let o=t.value;if(!o)this.headers.delete(i),this.normalizedNames.delete(i);else{let a=this.headers.get(i);if(!a)return;a=a.filter(s=>o.indexOf(s)===-1),a.length===0?(this.headers.delete(i),this.normalizedNames.delete(i)):this.headers.set(i,a)}break}}setHeaderEntries(t,i){let r=(Array.isArray(i)?i:[i]).map(o=>o.toString()),n=t.toLowerCase();this.headers.set(n,r),this.maybeSetNormalizedName(t,n)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(i=>t(this.normalizedNames.get(i),this.headers.get(i)))}};var CC=class{encodeKey(t){return xR(t)}encodeValue(t){return xR(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}};function bQ(e,t){let i=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(n=>{let o=n.indexOf("="),[a,s]=o==-1?[t.decodeKey(n),""]:[t.decodeKey(n.slice(0,o)),t.decodeValue(n.slice(o+1))],c=i.get(a)||[];c.push(s),i.set(a,c)}),i}var yQ=/%(\d[a-f0-9])/gi,xQ={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function xR(e){return encodeURIComponent(e).replace(yQ,(t,i)=>xQ[i]??t)}function Kb(e){return`${e}`}var _d=class e{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new CC,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=bQ(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(i=>{let r=t.fromObject[i],n=Array.isArray(r)?r.map(Kb):[Kb(r)];this.map.set(i,n)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();let i=this.map.get(t);return i?i[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,i){return this.clone({param:t,value:i,op:"a"})}appendAll(t){let i=[];return Object.keys(t).forEach(r=>{let n=t[r];Array.isArray(n)?n.forEach(o=>{i.push({param:r,value:o,op:"a"})}):i.push({param:r,value:n,op:"a"})}),this.clone(i)}set(t,i){return this.clone({param:t,value:i,op:"s"})}delete(t,i){return this.clone({param:t,value:i,op:"d"})}toString(){return this.init(),this.keys().map(t=>{let i=this.encoder.encodeKey(t);return this.map.get(t).map(r=>i+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>t!=="").join("&")}clone(t){let i=new e({encoder:this.encoder});return i.cloneFrom=this.cloneFrom||this,i.updates=(this.updates||[]).concat(t),i}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":let i=(t.op==="a"?this.map.get(t.param):void 0)||[];i.push(Kb(t.value)),this.map.set(t.param,i);break;case"d":if(t.value!==void 0){let r=this.map.get(t.param)||[],n=r.indexOf(Kb(t.value));n!==-1&&r.splice(n,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}else{this.map.delete(t.param);break}}}),this.cloneFrom=this.updates=null)}};var SC=class{constructor(){this.map=new Map}set(t,i){return this.map.set(t,i),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}};function wQ(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function wR(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function ER(e){return typeof Blob<"u"&&e instanceof Blob}function CR(e){return typeof FormData<"u"&&e instanceof FormData}function EQ(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}var Hg=class e{constructor(t,i,r,n){this.url=i,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase();let o;if(wQ(this.method)||n?(this.body=r!==void 0?r:null,o=n):o=r,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),this.transferCache=o.transferCache),this.headers??=new Kp,this.context??=new SC,!this.params)this.params=new _d,this.urlWithParams=i;else{let a=this.params.toString();if(a.length===0)this.urlWithParams=i;else{let s=i.indexOf("?"),c=s===-1?"?":s<i.length-1?"&":"";this.urlWithParams=i+c+a}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||wR(this.body)||ER(this.body)||CR(this.body)||EQ(this.body)?this.body:this.body instanceof _d?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||CR(this.body)?null:ER(this.body)?this.body.type||null:wR(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof _d?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(t={}){let i=t.method||this.method,r=t.url||this.url,n=t.responseType||this.responseType,o=t.transferCache??this.transferCache,a=t.body!==void 0?t.body:this.body,s=t.withCredentials??this.withCredentials,c=t.reportProgress??this.reportProgress,l=t.headers||this.headers,d=t.params||this.params,u=t.context??this.context;return t.setHeaders!==void 0&&(l=Object.keys(t.setHeaders).reduce((h,p)=>h.set(p,t.setHeaders[p]),l)),t.setParams&&(d=Object.keys(t.setParams).reduce((h,p)=>h.set(p,t.setParams[p]),d)),new e(i,r,a,{params:d,headers:l,context:u,reportProgress:c,responseType:n,withCredentials:s,transferCache:o})}},SR=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(SR||{}),TC=class{constructor(t,i=TR.Ok,r="OK"){this.headers=t.headers||new Kp,this.status=t.status!==void 0?t.status:i,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}};var AC=class e extends TC{constructor(t={}){super(t),this.type=SR.Response,this.body=t.body!==void 0?t.body:null}clone(t={}){return new e({body:t.body!==void 0?t.body:this.body,headers:t.headers||this.headers,status:t.status!==void 0?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}};var TR=function(e){return e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Processing=102]="Processing",e[e.EarlyHints=103]="EarlyHints",e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.MultiStatus=207]="MultiStatus",e[e.AlreadyReported=208]="AlreadyReported",e[e.ImUsed=226]="ImUsed",e[e.MultipleChoices=300]="MultipleChoices",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.Unused=306]="Unused",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.LengthRequired=411]="LengthRequired",e[e.PreconditionFailed=412]="PreconditionFailed",e[e.PayloadTooLarge=413]="PayloadTooLarge",e[e.UriTooLong=414]="UriTooLong",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RangeNotSatisfiable=416]="RangeNotSatisfiable",e[e.ExpectationFailed=417]="ExpectationFailed",e[e.ImATeapot=418]="ImATeapot",e[e.MisdirectedRequest=421]="MisdirectedRequest",e[e.UnprocessableEntity=422]="UnprocessableEntity",e[e.Locked=423]="Locked",e[e.FailedDependency=424]="FailedDependency",e[e.TooEarly=425]="TooEarly",e[e.UpgradeRequired=426]="UpgradeRequired",e[e.PreconditionRequired=428]="PreconditionRequired",e[e.TooManyRequests=429]="TooManyRequests",e[e.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",e[e.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.HttpVersionNotSupported=505]="HttpVersionNotSupported",e[e.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",e[e.InsufficientStorage=507]="InsufficientStorage",e[e.LoopDetected=508]="LoopDetected",e[e.NotExtended=510]="NotExtended",e[e.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",e}(TR||{});function wC(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials,transferCache:e.transferCache}}var AR=(()=>{class e{constructor(i){this.handler=i}request(i,r,n={}){let o;if(i instanceof Hg)o=i;else{let c;n.headers instanceof Kp?c=n.headers:c=new Kp(n.headers);let l;n.params&&(n.params instanceof _d?l=n.params:l=new _d({fromObject:n.params})),o=new Hg(i,r,n.body!==void 0?n.body:null,{headers:c,context:n.context,params:l,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials,transferCache:n.transferCache})}let a=Dt(o).pipe(hd(c=>this.handler.handle(c)));if(i instanceof Hg||n.observe==="events")return a;let s=a.pipe(Ji(c=>c instanceof AC));switch(n.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return s.pipe(Xt(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return s.pipe(Xt(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return s.pipe(Xt(c=>{if(c.body!==null&&typeof c.body!="string")throw new Error("Response is not a string.");return c.body}));case"json":default:return s.pipe(Xt(c=>c.body))}case"response":return s;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(i,r={}){return this.request("DELETE",i,r)}get(i,r={}){return this.request("GET",i,r)}head(i,r={}){return this.request("HEAD",i,r)}jsonp(i,r){return this.request("JSONP",i,{params:new _d().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(i,r={}){return this.request("OPTIONS",i,r)}patch(i,r,n={}){return this.request("PATCH",i,wC(n,r))}post(i,r,n={}){return this.request("POST",i,wC(n,r))}put(i,r,n={}){return this.request("PUT",i,wC(n,r))}static{this.\u0275fac=function(r){return new(r||e)(Ae(EC))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac})}}return e})();var MC=class extends Y3{constructor(){super(...arguments),this.supportsDOMEvents=!0}},kC=class e extends MC{static makeCurrent(){X3(new e)}onAndCancel(t,i,r){return t.addEventListener(i,r),()=>{t.removeEventListener(i,r)}}dispatchEvent(t,i){t.dispatchEvent(i)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,i){return i=i||this.getDefaultDocument(),i.createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,i){return i==="window"?window:i==="document"?t:i==="body"?t.body:null}getBaseHref(t){let i=TQ();return i==null?null:AQ(i)}resetBaseElement(){jg=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return J3(document.cookie,t)}},jg=null;function TQ(){return jg=jg||document.querySelector("base"),jg?jg.getAttribute("href"):null}function AQ(e){return new URL(e,document.baseURI).pathname}var PC=class{addToWindow(t){fd.getAngularTestability=(r,n=!0)=>{let o=t.findTestabilityInTree(r,n);if(o==null)throw new Tr(5103,!1);return o},fd.getAllAngularTestabilities=()=>t.getAllTestabilities(),fd.getAllAngularRootElements=()=>t.getAllRootElements();let i=r=>{let n=fd.getAllAngularTestabilities(),o=n.length,a=function(){o--,o==0&&r()};n.forEach(s=>{s.whenStable(a)})};fd.frameworkStabilizers||(fd.frameworkStabilizers=[]),fd.frameworkStabilizers.push(i)}findTestabilityInTree(t,i,r){if(i==null)return null;let n=t.getTestability(i);return n??(r?Ju().isShadowRoot(i)?this.findTestabilityInTree(t,i.host,!0):this.findTestabilityInTree(t,i.parentElement,!0):null)}},DQ=(()=>{class e{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac})}}return e})(),NC=new Ye(""),MR=(()=>{class e{constructor(i,r){this._zone=r,this._eventNameToPlugin=new Map,i.forEach(n=>{n.manager=this}),this._plugins=i.slice().reverse()}addEventListener(i,r,n){return this._findPluginFor(r).addEventListener(i,r,n)}getZone(){return this._zone}_findPluginFor(i){let r=this._eventNameToPlugin.get(i);if(r)return r;if(r=this._plugins.find(o=>o.supports(i)),!r)throw new Tr(5101,!1);return this._eventNameToPlugin.set(i,r),r}static{this.\u0275fac=function(r){return new(r||e)(Ae(NC),Ae(st))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac})}}return e})(),Qb=class{constructor(t){this._doc=t}},DC="ng-app-id",kR=(()=>{class e{constructor(i,r,n,o={}){this.doc=i,this.appId=r,this.nonce=n,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=yC(o),this.resetHostNodes()}addStyles(i){for(let r of i)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(i){for(let r of i)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let i=this.styleNodesInDOM;i&&(i.forEach(r=>r.remove()),i.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(i){this.hostNodes.add(i);for(let r of this.getAllStyles())this.addStyleToHost(i,r)}removeHost(i){this.hostNodes.delete(i)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(i){for(let r of this.hostNodes)this.addStyleToHost(r,i)}onStyleRemoved(i){let r=this.styleRef;r.get(i)?.elements?.forEach(n=>n.remove()),r.delete(i)}collectServerRenderedStyles(){let i=this.doc.head?.querySelectorAll(`style[${DC}="${this.appId}"]`);if(i?.length){let r=new Map;return i.forEach(n=>{n.textContent!=null&&r.set(n.textContent,n)}),r}return null}changeUsageCount(i,r){let n=this.styleRef;if(n.has(i)){let o=n.get(i);return o.usage+=r,o.usage}return n.set(i,{usage:r,elements:[]}),r}getStyleElement(i,r){let n=this.styleNodesInDOM,o=n?.get(r);if(o?.parentNode===i)return n.delete(r),o.removeAttribute(DC),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=r,this.platformIsServer&&a.setAttribute(DC,this.appId),i.appendChild(a),a}}addStyleToHost(i,r){let n=this.getStyleElement(i,r),o=this.styleRef,a=o.get(r)?.elements;a?a.push(n):o.set(r,{elements:[n],usage:1})}resetHostNodes(){let i=this.hostNodes;i.clear(),i.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||e)(Ae(Bt),Ae(Rg),Ae(Fg,8),Ae(mc))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac})}}return e})(),IC={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},FC=/%COMP%/g,PR="%COMP%",IQ=`_nghost-${PR}`,MQ=`_ngcontent-${PR}`,kQ=!0,PQ=new Ye("",{providedIn:"root",factory:()=>kQ});function NQ(e){return MQ.replace(FC,e)}function OQ(e){return IQ.replace(FC,e)}function NR(e,t){return t.map(i=>i.replace(FC,e))}var Qp=(()=>{class e{constructor(i,r,n,o,a,s,c,l=null){this.eventManager=i,this.sharedStylesHost=r,this.appId=n,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=s,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=yC(s),this.defaultRenderer=new Gg(i,a,c,this.platformIsServer)}createRenderer(i,r){if(!i||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Ng.ShadowDom&&(r=ve(L({},r),{encapsulation:Ng.Emulated}));let n=this.getOrCreateRenderer(i,r);return n instanceof Jb?n.applyToHost(i):n instanceof $g&&n.applyStyles(),n}getOrCreateRenderer(i,r){let n=this.rendererByCompId,o=n.get(r.id);if(!o){let a=this.doc,s=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,u=this.platformIsServer;switch(r.encapsulation){case Ng.Emulated:o=new Jb(c,l,r,this.appId,d,a,s,u);break;case Ng.ShadowDom:return new OC(c,l,i,r,a,s,this.nonce,u);default:o=new $g(c,l,r,d,a,s,u);break}n.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||e)(Ae(MR),Ae(kR),Ae(Rg),Ae(PQ),Ae(Bt),Ae(mc),Ae(st),Ae(Fg))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac})}}return e})(),Gg=class{constructor(t,i,r,n){this.eventManager=t,this.doc=i,this.ngZone=r,this.platformIsServer=n,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(t,i){return i?this.doc.createElementNS(IC[i]||i,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,i){(DR(t)?t.content:t).appendChild(i)}insertBefore(t,i,r){t&&(DR(t)?t.content:t).insertBefore(i,r)}removeChild(t,i){t&&t.removeChild(i)}selectRootElement(t,i){let r=typeof t=="string"?this.doc.querySelector(t):t;if(!r)throw new Tr(-5104,!1);return i||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,i,r,n){if(n){i=n+":"+i;let o=IC[n];o?t.setAttributeNS(o,i,r):t.setAttribute(i,r)}else t.setAttribute(i,r)}removeAttribute(t,i,r){if(r){let n=IC[r];n?t.removeAttributeNS(n,i):t.removeAttribute(`${r}:${i}`)}else t.removeAttribute(i)}addClass(t,i){t.classList.add(i)}removeClass(t,i){t.classList.remove(i)}setStyle(t,i,r,n){n&(Lg.DashCase|Lg.Important)?t.style.setProperty(i,r,n&Lg.Important?"important":""):t.style[i]=r}removeStyle(t,i,r){r&Lg.DashCase?t.style.removeProperty(i):t.style[i]=""}setProperty(t,i,r){t!=null&&(t[i]=r)}setValue(t,i){t.nodeValue=i}listen(t,i,r){if(typeof t=="string"&&(t=Ju().getGlobalEventTarget(this.doc,t),!t))throw new Error(`Unsupported event target ${t} for event ${i}`);return this.eventManager.addEventListener(t,i,this.decoratePreventDefault(r))}decoratePreventDefault(t){return i=>{if(i==="__ngUnwrap__")return t;(this.platformIsServer?this.ngZone.runGuarded(()=>t(i)):t(i))===!1&&i.preventDefault()}}};function DR(e){return e.tagName==="TEMPLATE"&&e.content!==void 0}var OC=class extends Gg{constructor(t,i,r,n,o,a,s,c){super(t,o,a,c),this.sharedStylesHost=i,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=NR(n.id,n.styles);for(let d of l){let u=document.createElement("style");s&&u.setAttribute("nonce",s),u.textContent=d,this.shadowRoot.appendChild(u)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,i){return super.appendChild(this.nodeOrShadowRoot(t),i)}insertBefore(t,i,r){return super.insertBefore(this.nodeOrShadowRoot(t),i,r)}removeChild(t,i){return super.removeChild(this.nodeOrShadowRoot(t),i)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},$g=class extends Gg{constructor(t,i,r,n,o,a,s,c){super(t,o,a,s),this.sharedStylesHost=i,this.removeStylesOnCompDestroy=n,this.styles=c?NR(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Jb=class extends $g{constructor(t,i,r,n,o,a,s,c){let l=n+"-"+r.id;super(t,i,r,o,a,s,c,l),this.contentAttr=NQ(l),this.hostAttr=OQ(l)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,i){let r=super.createElement(t,i);return super.setAttribute(r,this.contentAttr,""),r}},RQ=(()=>{class e extends Qb{constructor(i){super(i)}supports(i){return!0}addEventListener(i,r,n){return i.addEventListener(r,n,!1),()=>this.removeEventListener(i,r,n)}removeEventListener(i,r,n){return i.removeEventListener(r,n)}static{this.\u0275fac=function(r){return new(r||e)(Ae(Bt))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac})}}return e})(),IR=["alt","control","meta","shift"],FQ={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},LQ={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey},BQ=(()=>{class e extends Qb{constructor(i){super(i)}supports(i){return e.parseEventName(i)!=null}addEventListener(i,r,n){let o=e.parseEventName(r),a=e.eventCallback(o.fullKey,n,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ju().onAndCancel(i,o.domEventName,a))}static parseEventName(i){let r=i.toLowerCase().split("."),n=r.shift();if(r.length===0||!(n==="keydown"||n==="keyup"))return null;let o=e._normalizeKey(r.pop()),a="",s=r.indexOf("code");if(s>-1&&(r.splice(s,1),a="code."),IR.forEach(l=>{let d=r.indexOf(l);d>-1&&(r.splice(d,1),a+=l+".")}),a+=o,r.length!=0||o.length===0)return null;let c={};return c.domEventName=n,c.fullKey=a,c}static matchEventFullKeyCode(i,r){let n=FQ[i.key]||i.key,o="";return r.indexOf("code.")>-1&&(n=i.code,o="code."),n==null||!n?!1:(n=n.toLowerCase(),n===" "?n="space":n==="."&&(n="dot"),IR.forEach(a=>{if(a!==n){let s=LQ[a];s(i)&&(o+=a+".")}}),o+=n,o===r)}static eventCallback(i,r,n){return o=>{e.matchEventFullKeyCode(o,i)&&n.runGuarded(()=>r(o))}}static _normalizeKey(i){return i==="esc"?"escape":i}static{this.\u0275fac=function(r){return new(r||e)(Ae(Bt))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac})}}return e})();function VQ(){kC.makeCurrent()}function zQ(){return new Xu}function UQ(){return g3(document),document}var HQ=[{provide:mc,useValue:tR},{provide:v3,useValue:VQ,multi:!0},{provide:Bt,useFactory:UQ,deps:[]}],OR=j3(G3,"browser",HQ),jQ=new Ye(""),GQ=[{provide:zb,useClass:PC,deps:[]},{provide:U3,useClass:Ub,deps:[st,_C,zb]},{provide:Ub,useClass:Ub,deps:[st,_C,zb]}],$Q=[{provide:f3,useValue:"root"},{provide:Xu,useFactory:zQ,deps:[]},{provide:NC,useClass:RQ,multi:!0,deps:[Bt,st,mc]},{provide:NC,useClass:BQ,multi:!0,deps:[Bt]},Qp,kR,MR,{provide:Xp,useExisting:Qp},{provide:rR,useClass:DQ,deps:[]},[]],ey=(()=>{class e{constructor(i){}static withServerTransition(i){return{ngModule:e,providers:[{provide:Rg,useValue:i.appId}]}}static{this.\u0275fac=function(r){return new(r||e)(Ae(jQ,12))}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({providers:[...$Q,...GQ],imports:[To,$3]})}}return e})();var RR=(()=>{class e{constructor(i){this._doc=i}getTitle(){return this._doc.title}setTitle(i){this._doc.title=i||""}static{this.\u0275fac=function(r){return new(r||e)(Ae(Bt))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var LC=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:function(r){let n=null;return r?n=new(r||e):n=Ae(WQ),n},providedIn:"root"})}}return e})(),WQ=(()=>{class e extends LC{constructor(i){super(),this._doc=i}sanitize(i,r){if(r==null)return null;switch(i){case Wa.NONE:return r;case Wa.HTML:return Gp(r,"HTML")?jp(r):C3(this._doc,String(r)).toString();case Wa.STYLE:return Gp(r,"Style")?jp(r):r;case Wa.SCRIPT:if(Gp(r,"Script"))return jp(r);throw new Tr(5200,!1);case Wa.URL:return Gp(r,"URL")?jp(r):E3(String(r));case Wa.RESOURCE_URL:if(Gp(r,"ResourceURL"))return jp(r);throw new Tr(5201,!1);default:throw new Tr(5202,!1)}}bypassSecurityTrustHtml(i){return _3(i)}bypassSecurityTrustStyle(i){return b3(i)}bypassSecurityTrustScript(i){return y3(i)}bypassSecurityTrustUrl(i){return x3(i)}bypassSecurityTrustResourceUrl(i){return w3(i)}static{this.\u0275fac=function(r){return new(r||e)(Ae(Bt))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();ji([dR,uR]);ji(cR);function FR(e,t,i){typeof t=="object"&&(i=t,t=null);var r=this,n;if(!(e instanceof Function)){n=[];for(var o in e)e.hasOwnProperty(o)&&n.push(o)}var a=function(c){if(r.apply(this,arguments),e instanceof Function?LR(this,e.call(this,c)):qQ(this,e,n),this.constructor===a)for(var l=a.__initializers__,d=0;d<l.length;d++)l[d].apply(this,arguments)};a.__super__=r,r.__initializers__?a.__initializers__=r.__initializers__.slice():a.__initializers__=[],t&&a.__initializers__.push(t);var s=function(){};return s.prototype=r.prototype,a.prototype=new s,a.prototype.constructor=a,LR(a.prototype,i),a.extend=r.extend,a.derive=r.extend,a}function LR(e,t){if(t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}function qQ(e,t,i){for(var r=0;r<i.length;r++){var n=i[r];e[n]=t[n]}}var BR={extend:FR,derive:FR};function XQ(e,t){this.action=e,this.context=t}var YQ={trigger:function(e){if(this.hasOwnProperty("__handlers__")&&this.__handlers__.hasOwnProperty(e)){var t=this.__handlers__[e],i=t.length,r=-1,n=arguments;switch(n.length){case 1:for(;++r<i;)t[r].action.call(t[r].context);return;case 2:for(;++r<i;)t[r].action.call(t[r].context,n[1]);return;case 3:for(;++r<i;)t[r].action.call(t[r].context,n[1],n[2]);return;case 4:for(;++r<i;)t[r].action.call(t[r].context,n[1],n[2],n[3]);return;case 5:for(;++r<i;)t[r].action.call(t[r].context,n[1],n[2],n[3],n[4]);return;default:for(;++r<i;)t[r].action.apply(t[r].context,Array.prototype.slice.call(n,1));return}}},on:function(e,t,i){if(!(!e||!t)){var r=this.__handlers__||(this.__handlers__={});if(!r[e])r[e]=[];else if(this.has(e,t))return;var n=new XQ(t,i||this);return r[e].push(n),this}},once:function(e,t,i){if(!e||!t)return;var r=this;function n(){r.off(e,n),t.apply(this,arguments)}return this.on(e,n,i)},before:function(e,t,i){if(!(!e||!t))return e="before"+e,this.on(e,t,i)},after:function(e,t,i){if(!(!e||!t))return e="after"+e,this.on(e,t,i)},success:function(e,t){return this.once("success",e,t)},error:function(e,t){return this.once("error",e,t)},off:function(e,t){var i=this.__handlers__||(this.__handlers__={});if(!t){i[e]=[];return}if(i[e]){for(var r=i[e],n=[],o=0;o<r.length;o++)t&&r[o].action!==t&&n.push(r[o]);i[e]=n}return this},has:function(e,t){var i=this.__handlers__;if(!i||!i[e])return!1;for(var r=i[e],n=0;n<r.length;n++)if(r[n].action===t)return!0}},Jp=YQ;var ZQ=0,KQ=Array.prototype,QQ=KQ.forEach,Wg={genGUID:function(){return++ZQ},relative2absolute:function(e,t){if(!t||e.match(/^\//))return e;for(var i=e.split("/"),r=t.split("/"),n=i[0];n==="."||n==="..";)n===".."&&r.pop(),i.shift(),n=i[0];return r.join("/")+"/"+i.join("/")},extend:function(e,t){if(t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},defaults:function(e,t){if(t)for(var i in t)e[i]===void 0&&(e[i]=t[i]);return e},extendWithPropList:function(e,t,i){if(t)for(var r=0;r<i.length;r++){var n=i[r];e[n]=t[n]}return e},defaultsWithPropList:function(e,t,i){if(t)for(var r=0;r<i.length;r++){var n=i[r];e[n]==null&&(e[n]=t[n])}return e},each:function(e,t,i){if(e&&t)if(e.forEach&&e.forEach===QQ)e.forEach(t,i);else if(e.length===+e.length)for(var r=0,n=e.length;r<n;r++)t.call(i,e[r],r,e);else for(var o in e)e.hasOwnProperty(o)&&t.call(i,e[o],o,e)},isObject:function(e){return e===Object(e)},isArray:function(e){return Array.isArray(e)},isArrayLike:function(e){return e?e.length===+e.length:!1},clone:function(e){if(Wg.isObject(e)){if(Wg.isArray(e))return e.slice();if(Wg.isArrayLike(e)){for(var t=new e.constructor(e.length),i=0;i<e.length;i++)t[i]=e[i];return t}else return Wg.extend({},e)}else return e}},Wr=Wg;var ty=function(){this.__uid__=Wr.genGUID()};ty.__initializers__=[function(e){Wr.extend(this,e)}];Wr.extend(ty,BR);Wr.extend(ty.prototype,Jp);var fr=ty;var VR=["OES_texture_float","OES_texture_half_float","OES_texture_float_linear","OES_texture_half_float_linear","OES_standard_derivatives","OES_vertex_array_object","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","EXT_texture_filter_anisotropic","EXT_shader_texture_lod","WEBGL_draw_buffers","EXT_frag_depth","EXT_sRGB","ANGLE_instanced_arrays"],zR=["MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE"];function JQ(e){for(var t={},i={},r=0;r<VR.length;r++){var n=VR[r];a(n)}for(var r=0;r<zR.length;r++){var o=zR[r];i[o]=e.getParameter(e[o])}this.getExtension=function(s){return s in t||a(s),t[s]},this.getParameter=function(s){return i[s]};function a(s){if(e.getExtension){var c=e.getExtension(s);c||(c=e.getExtension("MOZ_"+s)),c||(c=e.getExtension("WEBKIT_"+s)),t[s]=c}}}var UR=JQ;var me={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444};function eJ(e){var t=new XMLHttpRequest;t.open("get",e.url),t.responseType=e.responseType||"text",e.onprogress&&(t.onprogress=function(i){if(i.lengthComputable){var r=i.loaded/i.total;e.onprogress(r,i.loaded,i.total)}else e.onprogress(null)}),t.onload=function(i){t.status>=400?e.onerror&&e.onerror():e.onload&&e.onload(t.response)},e.onerror&&(t.onerror=e.onerror),t.send(null)}var HR={get:eJ};var VC,Qo={};Qo.supportWebGL=function(){if(VC==null)try{var e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");if(!t)throw new Error}catch{VC=!1}return VC};Qo.Int8Array=typeof Int8Array>"u"?Array:Int8Array;Qo.Uint8Array=typeof Uint8Array>"u"?Array:Uint8Array;Qo.Uint16Array=typeof Uint16Array>"u"?Array:Uint16Array;Qo.Uint32Array=typeof Uint32Array>"u"?Array:Uint32Array;Qo.Int16Array=typeof Int16Array>"u"?Array:Int16Array;Qo.Float32Array=typeof Float32Array>"u"?Array:Float32Array;Qo.Float64Array=typeof Float64Array>"u"?Array:Float64Array;var nh={};typeof window<"u"?nh=window:typeof global<"u"&&(nh=global);Qo.requestAnimationFrame=nh.requestAnimationFrame||nh.msRequestAnimationFrame||nh.mozRequestAnimationFrame||nh.webkitRequestAnimationFrame||function(e){setTimeout(e,16)};Qo.createCanvas=function(){return document.createElement("canvas")};Qo.createImage=function(){return new nh.Image};Qo.request={get:HR.get};Qo.addEventListener=function(e,t,i,r){e.addEventListener(t,i,r)};Qo.removeEventListener=function(e,t,i){e.removeEventListener(t,i)};var Yi=Qo;var Bn=function(){this.head=null,this.tail=null,this._length=0};Bn.prototype.insert=function(e){var t=new Bn.Entry(e);return this.insertEntry(t),t};Bn.prototype.insertAt=function(e,t){if(!(e<0)){for(var i=this.head,r=0;i&&r!=e;)i=i.next,r++;if(i){var n=new Bn.Entry(t),o=i.prev;o?(o.next=n,n.prev=o):this.head=n,n.next=i,i.prev=n}else this.insert(t)}};Bn.prototype.insertBeforeEntry=function(e,t){var i=new Bn.Entry(e),r=t.prev;r?(r.next=i,i.prev=r):this.head=i,i.next=t,t.prev=i,this._length++};Bn.prototype.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,this.tail=e):this.head=this.tail=e,this._length++};Bn.prototype.remove=function(e){var t=e.prev,i=e.next;t?t.next=i:this.head=i,i?i.prev=t:this.tail=t,e.next=e.prev=null,this._length--};Bn.prototype.removeAt=function(e){if(!(e<0)){for(var t=this.head,i=0;t&&i!=e;)t=t.next,i++;if(t)return this.remove(t),t.value}};Bn.prototype.getHead=function(){if(this.head)return this.head.value};Bn.prototype.getTail=function(){if(this.tail)return this.tail.value};Bn.prototype.getAt=function(e){if(!(e<0)){for(var t=this.head,i=0;t&&i!=e;)t=t.next,i++;return t.value}};Bn.prototype.indexOf=function(e){for(var t=this.head,i=0;t;){if(t.value===e)return i;t=t.next,i++}};Bn.prototype.length=function(){return this._length};Bn.prototype.isEmpty=function(){return this._length===0};Bn.prototype.forEach=function(e,t){for(var i=this.head,r=0,n=typeof t<"u";i;)n?e.call(t,i.value,r):e(i.value,r),i=i.next,r++};Bn.prototype.clear=function(){this.tail=this.head=null,this._length=0};Bn.Entry=function(e){this.value=e,this.next=null,this.prev=null};var jR=Bn;var ef=function(e){this._list=new jR,this._map={},this._maxSize=e||10};ef.prototype.setMaxSize=function(e){this._maxSize=e};ef.prototype.put=function(e,t){if(!this._map.hasOwnProperty(e)){var i=this._list.length();if(i>=this._maxSize&&i>0){var r=this._list.head;this._list.remove(r),delete this._map[r.key]}var n=this._list.insert(t);n.key=e,this._map[e]=n}};ef.prototype.get=function(e){var t=this._map[e];if(this._map.hasOwnProperty(e))return t!==this._list.tail&&(this._list.remove(t),this._list.insertEntry(t)),t.value};ef.prototype.remove=function(e){var t=this._map[e];typeof t<"u"&&(delete this._map[e],this._list.remove(t))};ef.prototype.clear=function(){this._list.clear(),this._map={}};var iy=ef;var qr={},GR={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function dl(e){return e=Math.round(e),e<0?0:e>255?255:e}function tJ(e){return e=Math.round(e),e<0?0:e>360?360:e}function qg(e){return e<0?0:e>1?1:e}function zC(e){return e.length&&e.charAt(e.length-1)==="%"?dl(parseFloat(e)/100*255):dl(parseInt(e,10))}function rf(e){return e.length&&e.charAt(e.length-1)==="%"?qg(parseFloat(e)/100):qg(parseFloat(e))}function UC(e,t,i){return i<0?i+=1:i>1&&(i-=1),i*6<1?e+(t-e)*i*6:i*2<1?t:i*3<2?e+(t-e)*(2/3-i)*6:e}function bd(e,t,i){return e+(t-e)*i}function cl(e,t,i,r,n){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e}function HC(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var $R=new iy(20),ry=null;function tf(e,t){ry&&HC(ry,t),ry=$R.put(e,ry||t.slice())}qr.parse=function(e,t){if(e){t=t||[];var i=$R.get(e);if(i)return HC(t,i);e=e+"";var r=e.replace(/ /g,"").toLowerCase();if(r in GR)return HC(t,GR[r]),tf(e,t),t;if(r.charAt(0)==="#"){if(r.length===4){var n=parseInt(r.substr(1),16);if(!(n>=0&&n<=4095)){cl(t,0,0,0,1);return}return cl(t,(n&3840)>>4|(n&3840)>>8,n&240|(n&240)>>4,n&15|(n&15)<<4,1),tf(e,t),t}else if(r.length===7){var n=parseInt(r.substr(1),16);if(!(n>=0&&n<=16777215)){cl(t,0,0,0,1);return}return cl(t,(n&16711680)>>16,(n&65280)>>8,n&255,1),tf(e,t),t}return}var o=r.indexOf("("),a=r.indexOf(")");if(o!==-1&&a+1===r.length){var s=r.substr(0,o),c=r.substr(o+1,a-(o+1)).split(","),l=1;switch(s){case"rgba":if(c.length!==4){cl(t,0,0,0,1);return}l=rf(c.pop());case"rgb":if(c.length!==3){cl(t,0,0,0,1);return}return cl(t,zC(c[0]),zC(c[1]),zC(c[2]),l),tf(e,t),t;case"hsla":if(c.length!==4){cl(t,0,0,0,1);return}return c[3]=rf(c[3]),jC(c,t),tf(e,t),t;case"hsl":if(c.length!==3){cl(t,0,0,0,1);return}return jC(c,t),tf(e,t),t;default:return}}cl(t,0,0,0,1)}};qr.parseToFloat=function(e,t){if(t=qr.parse(e,t),!!t)return t[0]/=255,t[1]/=255,t[2]/=255,t};function jC(e,t){var i=(parseFloat(e[0])%360+360)%360/360,r=rf(e[1]),n=rf(e[2]),o=n<=.5?n*(r+1):n+r-n*r,a=n*2-o;return t=t||[],cl(t,dl(UC(a,o,i+1/3)*255),dl(UC(a,o,i)*255),dl(UC(a,o,i-1/3)*255),1),e.length===4&&(t[3]=e[3]),t}function iJ(e){if(e){var t=e[0]/255,i=e[1]/255,r=e[2]/255,n=Math.min(t,i,r),o=Math.max(t,i,r),a=o-n,s=(o+n)/2,c,l;if(a===0)c=0,l=0;else{s<.5?l=a/(o+n):l=a/(2-o-n);var d=((o-t)/6+a/2)/a,u=((o-i)/6+a/2)/a,h=((o-r)/6+a/2)/a;t===o?c=h-u:i===o?c=1/3+d-h:r===o&&(c=2/3+u-d),c<0&&(c+=1),c>1&&(c-=1)}var p=[c*360,l,s];return e[3]!=null&&p.push(e[3]),p}}qr.lift=function(e,t){var i=qr.parse(e);if(i){for(var r=0;r<3;r++)t<0?i[r]=i[r]*(1-t)|0:i[r]=(255-i[r])*t+i[r]|0;return qr.stringify(i,i.length===4?"rgba":"rgb")}};qr.toHex=function(e){var t=qr.parse(e);if(t)return((1<<24)+(t[0]<<16)+(t[1]<<8)+ +t[2]).toString(16).slice(1)};qr.fastLerp=function(e,t,i){if(!(!(t&&t.length)||!(e>=0&&e<=1))){i=i||[];var r=e*(t.length-1),n=Math.floor(r),o=Math.ceil(r),a=t[n],s=t[o],c=r-n;return i[0]=dl(bd(a[0],s[0],c)),i[1]=dl(bd(a[1],s[1],c)),i[2]=dl(bd(a[2],s[2],c)),i[3]=qg(bd(a[3],s[3],c)),i}};qr.fastMapToColor=qr.fastLerp;qr.lerp=function(e,t,i){if(!(!(t&&t.length)||!(e>=0&&e<=1))){var r=e*(t.length-1),n=Math.floor(r),o=Math.ceil(r),a=qr.parse(t[n]),s=qr.parse(t[o]),c=r-n,l=qr.stringify([dl(bd(a[0],s[0],c)),dl(bd(a[1],s[1],c)),dl(bd(a[2],s[2],c)),qg(bd(a[3],s[3],c))],"rgba");return i?{color:l,leftIndex:n,rightIndex:o,value:r}:l}};qr.mapToColor=qr.lerp;qr.modifyHSL=function(e,t,i,r){if(e=qr.parse(e),e)return e=iJ(e),t!=null&&(e[0]=tJ(t)),i!=null&&(e[1]=rf(i)),r!=null&&(e[2]=rf(r)),qr.stringify(jC(e),"rgba")};qr.modifyAlpha=function(e,t){if(e=qr.parse(e),e&&t!=null)return e[3]=qg(t),qr.stringify(e,"rgba")};qr.stringify=function(e,t){if(!(!e||!e.length)){var i=e[0]+","+e[1]+","+e[2];return(t==="rgba"||t==="hsva"||t==="hsla")&&(i+=","+e[3]),t+"("+i+")"}};var WR=qr;var rJ=WR.parseToFloat,GC={};function qR(e){var t=Object.keys(e);t.sort();for(var i=[],r=0;r<t.length;r++){var n=t[r],o=e[n];o===null?i.push(n):i.push(n+" "+o.toString())}return i.join(`
`)}function nJ(e,t,i){i.sort();for(var r=[],n=0;n<i.length;n++){var o=i[n];r.push(o)}var a=qR(e)+`
`+qR(t)+`
`+r.join(`
`);if(GC[a])return GC[a];var s=Wr.genGUID();return GC[a]=s,s}var oJ=fr.extend(function(){return{name:"",depthTest:!0,depthMask:!0,transparent:!1,blend:null,autoUpdateTextureStatus:!0,uniforms:{},vertexDefines:{},fragmentDefines:{},_textureStatus:{},_enabledUniforms:null}},function(){this.name||(this.name="MATERIAL_"+this.__uid__),this.shader&&this.attachShader(this.shader,!0)},{precision:"highp",setUniform:function(e,t){t===void 0&&console.warn('Uniform value "'+e+'" is undefined');var i=this.uniforms[e];i&&(typeof t=="string"&&(t=rJ(t)||t),i.value=t,this.autoUpdateTextureStatus&&i.type==="t"&&(t?this.enableTexture(e):this.disableTexture(e)))},setUniforms:function(e){for(var t in e){var i=e[t];this.setUniform(t,i)}},isUniformEnabled:function(e){return this._enabledUniforms.indexOf(e)>=0},getEnabledUniforms:function(){return this._enabledUniforms},getTextureUniforms:function(){return this._textureUniforms},set:function(e,t){if(typeof e=="object")for(var i in e){var r=e[i];this.setUniform(i,r)}else this.setUniform(e,t)},get:function(e){var t=this.uniforms[e];if(t)return t.value},attachShader:function(e,t){var i=this.uniforms;this.uniforms=e.createUniforms(),this.shader=e;var r=this.uniforms;this._enabledUniforms=Object.keys(r),this._enabledUniforms.sort(),this._textureUniforms=this._enabledUniforms.filter(function(l){var d=this.uniforms[l].type;return d==="t"||d==="tv"},this);var n=this.vertexDefines,o=this.fragmentDefines;if(this.vertexDefines=Wr.clone(e.vertexDefines),this.fragmentDefines=Wr.clone(e.fragmentDefines),t){for(var a in i)r[a]&&(r[a].value=i[a].value);Wr.defaults(this.vertexDefines,n),Wr.defaults(this.fragmentDefines,o)}var s={};for(var c in e.textures)s[c]={shaderType:e.textures[c].shaderType,type:e.textures[c].type,enabled:t&&this._textureStatus[c]?this._textureStatus[c].enabled:!1};this._textureStatus=s,this._programKey=""},clone:function(){var e=new this.constructor({name:this.name,shader:this.shader});for(var t in this.uniforms)e.uniforms[t].value=this.uniforms[t].value;return e.depthTest=this.depthTest,e.depthMask=this.depthMask,e.transparent=this.transparent,e.blend=this.blend,e.vertexDefines=Wr.clone(this.vertexDefines),e.fragmentDefines=Wr.clone(this.fragmentDefines),e.enableTexture(this.getEnabledTextures()),e.precision=this.precision,e},define:function(e,t,i){var r=this.vertexDefines,n=this.fragmentDefines;e!=="vertex"&&e!=="fragment"&&e!=="both"&&arguments.length<3&&(i=t,t=e,e="both"),i=i??null,(e==="vertex"||e==="both")&&r[t]!==i&&(r[t]=i,this._programKey=""),(e==="fragment"||e==="both")&&n[t]!==i&&(n[t]=i,e!=="both"&&(this._programKey=""))},undefine:function(e,t){e!=="vertex"&&e!=="fragment"&&e!=="both"&&arguments.length<2&&(t=e,e="both"),(e==="vertex"||e==="both")&&this.isDefined("vertex",t)&&(delete this.vertexDefines[t],this._programKey=""),(e==="fragment"||e==="both")&&this.isDefined("fragment",t)&&(delete this.fragmentDefines[t],e!=="both"&&(this._programKey=""))},isDefined:function(e,t){switch(e){case"vertex":return this.vertexDefines[t]!==void 0;case"fragment":return this.fragmentDefines[t]!==void 0}},getDefine:function(e,t){switch(e){case"vertex":return this.vertexDefines[t];case"fragment":return this.fragmentDefines[t]}},enableTexture:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)this.enableTexture(e[t]);return}var i=this._textureStatus[e];if(i){var r=i.enabled;r||(i.enabled=!0,this._programKey="")}},enableTexturesAll:function(){var e=this._textureStatus;for(var t in e)e[t].enabled=!0;this._programKey=""},disableTexture:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)this.disableTexture(e[t]);return}var i=this._textureStatus[e];if(i){var r=!i.enabled;r||(i.enabled=!1,this._programKey="")}},disableTexturesAll:function(){var e=this._textureStatus;for(var t in e)e[t].enabled=!1;this._programKey=""},isTextureEnabled:function(e){var t=this._textureStatus;return!!t[e]&&t[e].enabled},getEnabledTextures:function(){var e=[],t=this._textureStatus;for(var i in t)t[i].enabled&&e.push(i);return e},dirtyDefines:function(){this._programKey=""},getProgramKey:function(){return this._programKey||(this._programKey=nJ(this.vertexDefines,this.fragmentDefines,this.getEnabledTextures())),this._programKey}}),In=oJ;var Xg=1e-6,Fr=Array,yd=Math.random;var ri={};ri.create=function(){var e=new Fr(2);return e[0]=0,e[1]=0,e};ri.clone=function(e){var t=new Fr(2);return t[0]=e[0],t[1]=e[1],t};ri.fromValues=function(e,t){var i=new Fr(2);return i[0]=e,i[1]=t,i};ri.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e};ri.set=function(e,t,i){return e[0]=t,e[1]=i,e};ri.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e};ri.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e};ri.sub=ri.subtract;ri.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e};ri.mul=ri.multiply;ri.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e};ri.div=ri.divide;ri.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e};ri.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e};ri.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e};ri.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e};ri.distance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(i*i+r*r)};ri.dist=ri.distance;ri.squaredDistance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1];return i*i+r*r};ri.sqrDist=ri.squaredDistance;ri.length=function(e){var t=e[0],i=e[1];return Math.sqrt(t*t+i*i)};ri.len=ri.length;ri.squaredLength=function(e){var t=e[0],i=e[1];return t*t+i*i};ri.sqrLen=ri.squaredLength;ri.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e};ri.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e};ri.normalize=function(e,t){var i=t[0],r=t[1],n=i*i+r*r;return n>0&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n),e};ri.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]};ri.cross=function(e,t,i){var r=t[0]*i[1]-t[1]*i[0];return e[0]=e[1]=0,e[2]=r,e};ri.lerp=function(e,t,i,r){var n=t[0],o=t[1];return e[0]=n+r*(i[0]-n),e[1]=o+r*(i[1]-o),e};ri.random=function(e,t){t=t||1;var i=GLMAT_RANDOM()*2*Math.PI;return e[0]=Math.cos(i)*t,e[1]=Math.sin(i)*t,e};ri.transformMat2=function(e,t,i){var r=t[0],n=t[1];return e[0]=i[0]*r+i[2]*n,e[1]=i[1]*r+i[3]*n,e};ri.transformMat2d=function(e,t,i){var r=t[0],n=t[1];return e[0]=i[0]*r+i[2]*n+i[4],e[1]=i[1]*r+i[3]*n+i[5],e};ri.transformMat3=function(e,t,i){var r=t[0],n=t[1];return e[0]=i[0]*r+i[3]*n+i[6],e[1]=i[1]*r+i[4]*n+i[7],e};ri.transformMat4=function(e,t,i){var r=t[0],n=t[1];return e[0]=i[0]*r+i[4]*n+i[12],e[1]=i[1]*r+i[5]*n+i[13],e};ri.forEach=function(){var e=ri.create();return function(t,i,r,n,o,a){var s,c;for(i||(i=2),r||(r=0),n?c=Math.min(n*i+r,t.length):c=t.length,s=r;s<c;s+=i)e[0]=t[s],e[1]=t[s+1],o(e,e,a),t[s]=e[0],t[s+1]=e[1];return t}}();var Mt=ri;var _i=function(e,t){e=e||0,t=t||0,this.array=Mt.fromValues(e,t),this._dirty=!0};_i.prototype={constructor:_i,add:function(e){return Mt.add(this.array,this.array,e.array),this._dirty=!0,this},set:function(e,t){return this.array[0]=e,this.array[1]=t,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this._dirty=!0,this},clone:function(){return new _i(this.x,this.y)},copy:function(e){return Mt.copy(this.array,e.array),this._dirty=!0,this},cross:function(e,t){return Mt.cross(e.array,this.array,t.array),e._dirty=!0,this},dist:function(e){return Mt.dist(this.array,e.array)},distance:function(e){return Mt.distance(this.array,e.array)},div:function(e){return Mt.div(this.array,this.array,e.array),this._dirty=!0,this},divide:function(e){return Mt.divide(this.array,this.array,e.array),this._dirty=!0,this},dot:function(e){return Mt.dot(this.array,e.array)},len:function(){return Mt.len(this.array)},length:function(){return Mt.length(this.array)},lerp:function(e,t,i){return Mt.lerp(this.array,e.array,t.array,i),this._dirty=!0,this},min:function(e){return Mt.min(this.array,this.array,e.array),this._dirty=!0,this},max:function(e){return Mt.max(this.array,this.array,e.array),this._dirty=!0,this},mul:function(e){return Mt.mul(this.array,this.array,e.array),this._dirty=!0,this},multiply:function(e){return Mt.multiply(this.array,this.array,e.array),this._dirty=!0,this},negate:function(){return Mt.negate(this.array,this.array),this._dirty=!0,this},normalize:function(){return Mt.normalize(this.array,this.array),this._dirty=!0,this},random:function(e){return Mt.random(this.array,e),this._dirty=!0,this},scale:function(e){return Mt.scale(this.array,this.array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return Mt.scaleAndAdd(this.array,this.array,e.array,t),this._dirty=!0,this},sqrDist:function(e){return Mt.sqrDist(this.array,e.array)},squaredDistance:function(e){return Mt.squaredDistance(this.array,e.array)},sqrLen:function(){return Mt.sqrLen(this.array)},squaredLength:function(){return Mt.squaredLength(this.array)},sub:function(e){return Mt.sub(this.array,this.array,e.array),this._dirty=!0,this},subtract:function(e){return Mt.subtract(this.array,this.array,e.array),this._dirty=!0,this},transformMat2:function(e){return Mt.transformMat2(this.array,this.array,e.array),this._dirty=!0,this},transformMat2d:function(e){return Mt.transformMat2d(this.array,this.array,e.array),this._dirty=!0,this},transformMat3:function(e){return Mt.transformMat3(this.array,this.array,e.array),this._dirty=!0,this},transformMat4:function(e){return Mt.transformMat4(this.array,this.array,e.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};Object.defineProperty&&($C=_i.prototype,Object.defineProperty($C,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),Object.defineProperty($C,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}));var $C;_i.add=function(e,t,i){return Mt.add(e.array,t.array,i.array),e._dirty=!0,e};_i.set=function(e,t,i){return Mt.set(e.array,t,i),e._dirty=!0,e};_i.copy=function(e,t){return Mt.copy(e.array,t.array),e._dirty=!0,e};_i.cross=function(e,t,i){return Mt.cross(e.array,t.array,i.array),e._dirty=!0,e};_i.dist=function(e,t){return Mt.distance(e.array,t.array)};_i.distance=_i.dist;_i.div=function(e,t,i){return Mt.divide(e.array,t.array,i.array),e._dirty=!0,e};_i.divide=_i.div;_i.dot=function(e,t){return Mt.dot(e.array,t.array)};_i.len=function(e){return Mt.length(e.array)};_i.lerp=function(e,t,i,r){return Mt.lerp(e.array,t.array,i.array,r),e._dirty=!0,e};_i.min=function(e,t,i){return Mt.min(e.array,t.array,i.array),e._dirty=!0,e};_i.max=function(e,t,i){return Mt.max(e.array,t.array,i.array),e._dirty=!0,e};_i.mul=function(e,t,i){return Mt.multiply(e.array,t.array,i.array),e._dirty=!0,e};_i.multiply=_i.mul;_i.negate=function(e,t){return Mt.negate(e.array,t.array),e._dirty=!0,e};_i.normalize=function(e,t){return Mt.normalize(e.array,t.array),e._dirty=!0,e};_i.random=function(e,t){return Mt.random(e.array,t),e._dirty=!0,e};_i.scale=function(e,t,i){return Mt.scale(e.array,t.array,i),e._dirty=!0,e};_i.scaleAndAdd=function(e,t,i,r){return Mt.scaleAndAdd(e.array,t.array,i.array,r),e._dirty=!0,e};_i.sqrDist=function(e,t){return Mt.sqrDist(e.array,t.array)};_i.squaredDistance=_i.sqrDist;_i.sqrLen=function(e){return Mt.sqrLen(e.array)};_i.squaredLength=_i.sqrLen;_i.sub=function(e,t,i){return Mt.subtract(e.array,t.array,i.array),e._dirty=!0,e};_i.subtract=_i.sub;_i.transformMat2=function(e,t,i){return Mt.transformMat2(e.array,t.array,i.array),e._dirty=!0,e};_i.transformMat2d=function(e,t,i){return Mt.transformMat2d(e.array,t.array,i.array),e._dirty=!0,e};_i.transformMat3=function(e,t,i){return Mt.transformMat3(e.array,t.array,i.array),e._dirty=!0,e};_i.transformMat4=function(e,t,i){return Mt.transformMat4(e.array,t.array,i.array),e._dirty=!0,e};var Vn=_i;var XR=1,YR=2,WC=3,ZR={};function aJ(e){for(var t=e.split(`
`),i=0,r=t.length;i<r;i++)t[i]=i+1+": "+t[i];return t.join(`
`)}function KR(e,t,i){if(!e.getShaderParameter(t,e.COMPILE_STATUS))return[e.getShaderInfoLog(t),aJ(i)].join(`
`)}var QR=new Yi.Float32Array(16),sJ=fr.extend({uniformSemantics:{},attributes:{}},function(){this._locations={},this._textureSlot=0,this._program=null},{bind:function(e){this._textureSlot=0,e.gl.useProgram(this._program)},hasUniform:function(e){var t=this._locations[e];return t!=null},useTextureSlot:function(e,t,i){t&&(e.gl.activeTexture(e.gl.TEXTURE0+i),t.isRenderable()?t.bind(e):t.unbind(e))},currentTextureSlot:function(){return this._textureSlot},resetTextureSlot:function(e){this._textureSlot=e||0},takeCurrentTextureSlot:function(e,t){var i=this._textureSlot;return this.useTextureSlot(e,t,i),this._textureSlot++,i},setUniform:function(e,t,i,r){var n=this._locations,o=n[i];if(o==null)return!1;switch(t){case"m4":if(!(r instanceof Float32Array)){for(var a=0;a<r.length;a++)QR[a]=r[a];r=QR}e.uniformMatrix4fv(o,!1,r);break;case"2i":e.uniform2i(o,r[0],r[1]);break;case"2f":e.uniform2f(o,r[0],r[1]);break;case"3i":e.uniform3i(o,r[0],r[1],r[2]);break;case"3f":e.uniform3f(o,r[0],r[1],r[2]);break;case"4i":e.uniform4i(o,r[0],r[1],r[2],r[3]);break;case"4f":e.uniform4f(o,r[0],r[1],r[2],r[3]);break;case"1i":e.uniform1i(o,r);break;case"1f":e.uniform1f(o,r);break;case"1fv":e.uniform1fv(o,r);break;case"1iv":e.uniform1iv(o,r);break;case"2iv":e.uniform2iv(o,r);break;case"2fv":e.uniform2fv(o,r);break;case"3iv":e.uniform3iv(o,r);break;case"3fv":e.uniform3fv(o,r);break;case"4iv":e.uniform4iv(o,r);break;case"4fv":e.uniform4fv(o,r);break;case"m2":case"m2v":e.uniformMatrix2fv(o,!1,r);break;case"m3":case"m3v":e.uniformMatrix3fv(o,!1,r);break;case"m4v":if(Array.isArray(r)&&Array.isArray(r[0])){for(var s=new Yi.Float32Array(r.length*16),c=0,a=0;a<r.length;a++)for(var l=r[a],d=0;d<16;d++)s[c++]=l[d];e.uniformMatrix4fv(o,!1,s)}else e.uniformMatrix4fv(o,!1,r);break}return!0},setUniformOfSemantic:function(e,t,i){var r=this.uniformSemantics[t];return r?this.setUniform(e,r.type,r.symbol,i):!1},enableAttributes:function(e,t,i){var r=e.gl,n=this._program,o=this._locations,a;i?a=i.__enabledAttributeList:a=ZR[e.__uid__],a||(i?a=i.__enabledAttributeList=[]:a=ZR[e.__uid__]=[]);for(var s=[],c=0;c<t.length;c++){var l=t[c];if(!this.attributes[l]){s[c]=-1;continue}var d=o[l];if(d==null){if(d=r.getAttribLocation(n,l),d===-1){s[c]=-1;continue}o[l]=d}s[c]=d,a[d]?a[d]=YR:a[d]=XR}for(var c=0;c<a.length;c++)switch(a[c]){case XR:r.enableVertexAttribArray(c),a[c]=WC;break;case YR:a[c]=WC;break;case WC:r.disableVertexAttribArray(c),a[c]=0;break}return s},getAttribLocation:function(e,t){var i=this._locations,r=i[t];return r==null&&(r=e.getAttribLocation(this._program,t),i[t]=r),r},buildProgram:function(e,t,i,r){var n=e.createShader(e.VERTEX_SHADER),o=e.createProgram();e.shaderSource(n,i),e.compileShader(n);var a=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(a,r),e.compileShader(a);var s=KR(e,n,i);if(s||(s=KR(e,a,r),s))return s;if(e.attachShader(o,n),e.attachShader(o,a),t.attributeSemantics.POSITION)e.bindAttribLocation(o,0,t.attributeSemantics.POSITION.symbol);else{var c=Object.keys(this.attributes);e.bindAttribLocation(o,0,c[0])}if(e.linkProgram(o),e.deleteShader(n),e.deleteShader(a),this._program=o,this.vertexCode=i,this.fragmentCode=r,!e.getProgramParameter(o,e.LINK_STATUS))return`Could not link program
`+e.getProgramInfoLog(o);for(var l=0;l<t.uniforms.length;l++){var d=t.uniforms[l];this._locations[d]=e.getUniformLocation(o,d)}}}),JR=sJ;var lJ=/for\s*?\(int\s*?_idx_\s*\=\s*([\w-]+)\;\s*_idx_\s*<\s*([\w-]+);\s*_idx_\s*\+\+\s*\)\s*\{\{([\s\S]+?)(?=\}\})\}\}/g;function eF(e,t,i){function r(a,s,c,l){var d="";isNaN(s)&&(s in t?s=t[s]:s=n[s]),isNaN(c)&&(c in t?c=t[c]:c=n[c]);for(var u=parseInt(s);u<parseInt(c);u++)d+="{"+l.replace(/float\s*\(\s*_idx_\s*\)/g,u.toFixed(1)).replace(/_idx_/g,u)+"}";return d}var n={};for(var o in i)n[o+"_COUNT"]=i[o];return e.replace(lJ,r)}function qC(e,t,i){var r=[];if(t)for(var n in t){var o=t[n];o>0&&r.push("#define "+n.toUpperCase()+"_COUNT "+o)}if(i)for(var a=0;a<i.length;a++){var s=i[a];r.push("#define "+s.toUpperCase()+"_ENABLED")}for(var s in e){var c=e[s];c===null?r.push("#define "+s):r.push("#define "+s+" "+c.toString())}return r.join(`
`)}function cJ(e){for(var t=[],i=0;i<e.length;i++)t.push("#extension GL_"+e[i]+" : enable");return t.join(`
`)}function dJ(e){return["precision",e,"float"].join(" ")+`;
`+["precision",e,"int"].join(" ")+`;
`+["precision",e,"sampler2D"].join(" ")+`;
`}function tF(e){this._renderer=e,this._cache={}}tF.prototype.getProgram=function(e,t,i){var r=this._cache,n=e.isSkinnedMesh&&e.isSkinnedMesh(),o=e.isInstancedMesh&&e.isInstancedMesh(),a="s"+t.shader.shaderID+"m"+t.getProgramKey();i&&(a+="se"+i.getProgramKey(e.lightGroup)),n&&(a+=",sk"+e.joints.length),o&&(a+=",is");var y=r[a];if(y)return y;var s=i?i.getLightsNumbers(e.lightGroup):{},c=this._renderer,l=c.gl,d=t.getEnabledTextures(),u="";if(n){var h={SKINNING:null,JOINT_COUNT:e.joints.length};e.joints.length>c.getMaxJointNumber()&&(h.USE_SKIN_MATRICES_TEXTURE=null),u+=`
`+qC(h)+`
`}o&&(u+=`
#define INSTANCING
`);var p=u+qC(t.vertexDefines,s,d),m=u+qC(t.fragmentDefines,s,d),f=p+`
`+t.shader.vertex,g=["OES_standard_derivatives","EXT_shader_texture_lod"].filter(function(w){return c.getGLExtension(w)!=null});g.indexOf("EXT_shader_texture_lod")>=0&&(m+=`
#define SUPPORT_TEXTURE_LOD`),g.indexOf("OES_standard_derivatives")>=0&&(m+=`
#define SUPPORT_STANDARD_DERIVATIVES`);var v=cJ(g)+`
`+dJ(t.precision)+`
`+m+`
`+t.shader.fragment,_=eF(f,t.vertexDefines,s),b=eF(v,t.fragmentDefines,s),y=new JR;y.uniformSemantics=t.shader.uniformSemantics,y.attributes=t.shader.attributes;var x=y.buildProgram(l,t.shader,_,b);return y.__error=x,r[a]=y,y};var iF=tF;var rF=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g,uJ=/attribute\s+(float|int|vec2|vec3|vec4)\s+([\s\S]*?);/g,nF=/#define\s+(\w+)?(\s+[\d-.]+)?\s*;?\s*\n/g,hJ={bool:"1i",int:"1i",sampler2D:"t",samplerCube:"t",float:"1f",vec2:"2f",vec3:"3f",vec4:"4f",ivec2:"2i",ivec3:"3i",ivec4:"4i",mat2:"m2",mat3:"m3",mat4:"m4"};function vc(e){for(var t=[],i=0;i<e;i++)t[i]=0;return t}var oF={bool:function(){return!0},int:function(){return 0},float:function(){return 0},sampler2D:function(){return null},samplerCube:function(){return null},vec2:function(){return vc(2)},vec3:function(){return vc(3)},vec4:function(){return vc(4)},ivec2:function(){return vc(2)},ivec3:function(){return vc(3)},ivec4:function(){return vc(4)},mat2:function(){return vc(4)},mat3:function(){return vc(9)},mat4:function(){return vc(16)},array:function(){return[]}},YC=["POSITION","NORMAL","BINORMAL","TANGENT","TEXCOORD","TEXCOORD_0","TEXCOORD_1","COLOR","JOINT","WEIGHT"],lF=["SKIN_MATRIX","VIEWPORT_SIZE","VIEWPORT","DEVICEPIXELRATIO","WINDOW_SIZE","NEAR","FAR","TIME"],cF=["WORLD","VIEW","PROJECTION","WORLDVIEW","VIEWPROJECTION","WORLDVIEWPROJECTION","WORLDINVERSE","VIEWINVERSE","PROJECTIONINVERSE","WORLDVIEWINVERSE","VIEWPROJECTIONINVERSE","WORLDVIEWPROJECTIONINVERSE","WORLDTRANSPOSE","VIEWTRANSPOSE","PROJECTIONTRANSPOSE","WORLDVIEWTRANSPOSE","VIEWPROJECTIONTRANSPOSE","WORLDVIEWPROJECTIONTRANSPOSE","WORLDINVERSETRANSPOSE","VIEWINVERSETRANSPOSE","PROJECTIONINVERSETRANSPOSE","WORLDVIEWINVERSETRANSPOSE","VIEWPROJECTIONINVERSETRANSPOSE","WORLDVIEWPROJECTIONINVERSETRANSPOSE"],pJ={vec4:4,vec3:3,vec2:2,float:1},XC={},dF={};function fJ(e,t){var i="vertex:"+e+"fragment:"+t;if(XC[i])return XC[i];var r=Wr.genGUID();return XC[i]=r,dF[r]={vertex:e,fragment:t},r}function aF(e){return e.replace(/[ \t]*\/\/.*\n/g,"").replace(/[ \t]*\/\*[\s\S]*?\*\//g,"")}function nf(){console.error("Wrong uniform/attributes syntax")}function sF(e,t){for(var i=/[,=\(\):]/,r=t.replace(/:\s*\[\s*(.*)\s*\]/g,"="+e+"($1)").replace(/\s+/g,"").split(/(?=[,=\(\):])/g),n=[],o=0;o<r.length;o++)r[o].match(i)?n.push(r[o].charAt(0),r[o].slice(1)):n.push(r[o]);r=n;var a=0,s=1,c=2,l=3,d=4,u=5,h=a,p={},m=null,f;g(r[0]);function g(b){b||nf();var y=b.match(/\[(.*?)\]/);f=b.replace(/\[(.*?)\]/,""),p[f]={},y&&(p[f].isArray=!0,p[f].arraySize=y[1])}for(var o=1;o<r.length;o++){var v=r[o];if(v){if(v==="="){if(h!==a&&h!==l){nf();break}h=s;continue}else if(v===":"){h=d;continue}else if(v===","){if(h===c){if(!(m instanceof Array)){nf();break}m.push(+r[++o])}else h=u;continue}else if(v===")"){p[f].value=new Yi.Float32Array(m),m=null,h=u;continue}else if(v==="("){if(h!==c){nf();break}if(!(m instanceof Array)){nf();break}m.push(+r[++o]);continue}else if(v.indexOf("vec")>=0){if(h!==s&&h!==d){nf();break}h=c,m=[];continue}else if(h===s){e==="bool"?p[f].value=v==="true":p[f].value=parseFloat(v),m=null;continue}else if(h===d){var _=v;YC.indexOf(_)>=0||lF.indexOf(_)>=0||cF.indexOf(_)>=0?p[f].semantic=_:_==="ignore"||_==="unconfigurable"?p[f].ignore=!0:e==="bool"?p[f].value=_==="true":p[f].value=parseFloat(_);continue}g(v),h=a}}return p}function Mn(e,t){typeof e=="object"&&(t=e.fragment,e=e.vertex),e=aF(e),t=aF(t),this._shaderID=fJ(e,t),this._vertexCode=Mn.parseImport(e),this._fragmentCode=Mn.parseImport(t),this.attributeSemantics={},this.matrixSemantics={},this.uniformSemantics={},this.matrixSemanticKeys=[],this.uniformTemplates={},this.attributes={},this.textures={},this.vertexDefines={},this.fragmentDefines={},this._parseAttributes(),this._parseUniforms(),this._parseDefines()}Mn.prototype={constructor:Mn,createUniforms:function(){var e={};for(var t in this.uniformTemplates){var i=this.uniformTemplates[t];e[t]={type:i.type,value:i.value()}}return e},_parseImport:function(){this._vertexCode=Mn.parseImport(this.vertex),this._fragmentCode=Mn.parseImport(this.fragment)},_addSemanticUniform:function(e,t,i){if(YC.indexOf(i)>=0)this.attributeSemantics[i]={symbol:e,type:t};else if(cF.indexOf(i)>=0){var r=!1,n=i;i.match(/TRANSPOSE$/)&&(r=!0,n=i.slice(0,-9)),this.matrixSemantics[i]={symbol:e,type:t,isTranspose:r,semanticNoTranspose:n}}else lF.indexOf(i)>=0&&(this.uniformSemantics[i]={symbol:e,type:t})},_addMaterialUniform:function(e,t,i,r,n,o){o[e]={type:i,value:n?oF.array:r||oF[t],semantic:null}},_parseUniforms:function(){var e={},t=this,i="vertex";this._uniformList=[],this._vertexCode=this._vertexCode.replace(rF,n),i="fragment",this._fragmentCode=this._fragmentCode.replace(rF,n),t.matrixSemanticKeys=Object.keys(this.matrixSemantics);function r(o){return o!=null?function(){return o}:null}function n(o,a,s){var c=sF(a,s),l=[];for(var d in c){var u=c[d],h=u.semantic,p=d,m=hJ[a],f=r(c[d].value);c[d].isArray&&(p+="["+c[d].arraySize+"]",m+="v"),l.push(p),t._uniformList.push(d),u.ignore||((a==="sampler2D"||a==="samplerCube")&&(t.textures[d]={shaderType:i,type:a}),h?t._addSemanticUniform(d,m,h):t._addMaterialUniform(d,a,m,f,c[d].isArray,e))}return l.length>0?"uniform "+a+" "+l.join(",")+`;
`:""}this.uniformTemplates=e},_parseAttributes:function(){var e={},t=this;this._vertexCode=this._vertexCode.replace(uJ,i);function i(r,n,o){var a=sF(n,o),s=pJ[n]||1,c=[];for(var l in a){var d=a[l].semantic;if(e[l]={type:"float",size:s,semantic:d||null},d){if(YC.indexOf(d)<0)throw new Error('Unkown semantic "'+d+'"');t.attributeSemantics[d]={symbol:l,type:n}}c.push(l)}return"attribute "+n+" "+c.join(",")+`;
`}this.attributes=e},_parseDefines:function(){var e=this,t="vertex";this._vertexCode=this._vertexCode.replace(nF,i),t="fragment",this._fragmentCode=this._fragmentCode.replace(nF,i);function i(r,n,o){var a=t==="vertex"?e.vertexDefines:e.fragmentDefines;return a[n]||(o==="false"?a[n]=!1:o==="true"?a[n]=!0:a[n]=o?isNaN(parseFloat(o))?o.trim():parseFloat(o):null),""}},clone:function(){var e=dF[this._shaderID],t=new Mn(e.vertex,e.fragment);return t}};Object.defineProperty&&(Object.defineProperty(Mn.prototype,"shaderID",{get:function(){return this._shaderID}}),Object.defineProperty(Mn.prototype,"vertex",{get:function(){return this._vertexCode}}),Object.defineProperty(Mn.prototype,"fragment",{get:function(){return this._fragmentCode}}),Object.defineProperty(Mn.prototype,"uniforms",{get:function(){return this._uniformList}}));var mJ=/(@import)\s*([0-9a-zA-Z_\-\.]*)/g;Mn.parseImport=function(e){return e=e.replace(mJ,function(n,i,r){var n=Mn.source(r);return n?Mn.parseImport(n):(console.error('Shader chunk "'+r+'" not existed in library'),"")}),e};var gJ=/(@export)\s*([0-9a-zA-Z_\-\.]*)\s*\n([\s\S]*?)@end/g;Mn.import=function(e){e.replace(gJ,function(t,i,r,o){var o=o.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+\x24)/g,"");if(o){for(var a=r.split("."),s=Mn.codes,c=0,l;c<a.length-1;)l=a[c++],s[l]||(s[l]={}),s=s[l];l=a[c],s[l]=o}return o})};Mn.codes={};Mn.source=function(e){for(var t=e.split("."),i=Mn.codes,r=0;i&&r<t.length;){var n=t[r++];i=i[n]}return typeof i!="string"?(console.error('Shader "'+e+'" not existed in library'),""):i};var qe=Mn;var ny=`@export clay.prez.vertex
uniform mat4 WVP : WORLDVIEWPROJECTION;
attribute vec3 pos : POSITION;
attribute vec2 uv : TEXCOORD_0;
uniform vec2 uvRepeat : [1.0, 1.0];
uniform vec2 uvOffset : [0.0, 0.0];
@import clay.chunk.skinning_header
@import clay.chunk.instancing_header
varying vec2 v_Texcoord;
void main()
{
 vec4 P = vec4(pos, 1.0);
#ifdef SKINNING
 @import clay.chunk.skin_matrix
 P = skinMatrixWS * P;
#endif
#ifdef INSTANCING
 @import clay.chunk.instancing_matrix
 P = instanceMat * P;
#endif
 gl_Position = WVP * P;
 v_Texcoord = uv * uvRepeat + uvOffset;
}
@end
@export clay.prez.fragment
uniform sampler2D alphaMap;
uniform float alphaCutoff: 0.0;
varying vec2 v_Texcoord;
void main()
{
 if (alphaCutoff > 0.0) {
 if (texture2D(alphaMap, v_Texcoord).a <= alphaCutoff) {
 discard;
 }
 }
 gl_FragColor = vec4(0.0,0.0,0.0,1.0);
}
@end`;var xr={};xr.create=function(){var e=new Fr(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};xr.clone=function(e){var t=new Fr(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t};xr.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e};xr.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};xr.transpose=function(e,t){if(e===t){var i=t[1],r=t[2],n=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=i,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=n,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e};xr.invert=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=t[4],s=t[5],c=t[6],l=t[7],d=t[8],u=t[9],h=t[10],p=t[11],m=t[12],f=t[13],g=t[14],v=t[15],_=i*s-r*a,b=i*c-n*a,y=i*l-o*a,x=r*c-n*s,w=r*l-o*s,I=n*l-o*c,S=d*f-u*m,E=d*g-h*m,N=d*v-p*m,M=u*g-h*f,P=u*v-p*f,$=h*v-p*g,R=_*$-b*P+y*M+x*N-w*E+I*S;return R?(R=1/R,e[0]=(s*$-c*P+l*M)*R,e[1]=(n*P-r*$-o*M)*R,e[2]=(f*I-g*w+v*x)*R,e[3]=(h*w-u*I-p*x)*R,e[4]=(c*N-a*$-l*E)*R,e[5]=(i*$-n*N+o*E)*R,e[6]=(g*y-m*I-v*b)*R,e[7]=(d*I-h*y+p*b)*R,e[8]=(a*P-s*N+l*S)*R,e[9]=(r*N-i*P-o*S)*R,e[10]=(m*w-f*y+v*_)*R,e[11]=(u*y-d*w-p*_)*R,e[12]=(s*E-a*M-c*S)*R,e[13]=(i*M-r*E+n*S)*R,e[14]=(f*b-m*x-g*_)*R,e[15]=(d*x-u*b+h*_)*R,e):null};xr.adjoint=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=t[4],s=t[5],c=t[6],l=t[7],d=t[8],u=t[9],h=t[10],p=t[11],m=t[12],f=t[13],g=t[14],v=t[15];return e[0]=s*(h*v-p*g)-u*(c*v-l*g)+f*(c*p-l*h),e[1]=-(r*(h*v-p*g)-u*(n*v-o*g)+f*(n*p-o*h)),e[2]=r*(c*v-l*g)-s*(n*v-o*g)+f*(n*l-o*c),e[3]=-(r*(c*p-l*h)-s*(n*p-o*h)+u*(n*l-o*c)),e[4]=-(a*(h*v-p*g)-d*(c*v-l*g)+m*(c*p-l*h)),e[5]=i*(h*v-p*g)-d*(n*v-o*g)+m*(n*p-o*h),e[6]=-(i*(c*v-l*g)-a*(n*v-o*g)+m*(n*l-o*c)),e[7]=i*(c*p-l*h)-a*(n*p-o*h)+d*(n*l-o*c),e[8]=a*(u*v-p*f)-d*(s*v-l*f)+m*(s*p-l*u),e[9]=-(i*(u*v-p*f)-d*(r*v-o*f)+m*(r*p-o*u)),e[10]=i*(s*v-l*f)-a*(r*v-o*f)+m*(r*l-o*s),e[11]=-(i*(s*p-l*u)-a*(r*p-o*u)+d*(r*l-o*s)),e[12]=-(a*(u*g-h*f)-d*(s*g-c*f)+m*(s*h-c*u)),e[13]=i*(u*g-h*f)-d*(r*g-n*f)+m*(r*h-n*u),e[14]=-(i*(s*g-c*f)-a*(r*g-n*f)+m*(r*c-n*s)),e[15]=i*(s*h-c*u)-a*(r*h-n*u)+d*(r*c-n*s),e};xr.determinant=function(e){var t=e[0],i=e[1],r=e[2],n=e[3],o=e[4],a=e[5],s=e[6],c=e[7],l=e[8],d=e[9],u=e[10],h=e[11],p=e[12],m=e[13],f=e[14],g=e[15],v=t*a-i*o,_=t*s-r*o,b=t*c-n*o,y=i*s-r*a,x=i*c-n*a,w=r*c-n*s,I=l*m-d*p,S=l*f-u*p,E=l*g-h*p,N=d*f-u*m,M=d*g-h*m,P=u*g-h*f;return v*P-_*M+b*N+y*E-x*S+w*I};xr.multiply=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=t[4],c=t[5],l=t[6],d=t[7],u=t[8],h=t[9],p=t[10],m=t[11],f=t[12],g=t[13],v=t[14],_=t[15],b=i[0],y=i[1],x=i[2],w=i[3];return e[0]=b*r+y*s+x*u+w*f,e[1]=b*n+y*c+x*h+w*g,e[2]=b*o+y*l+x*p+w*v,e[3]=b*a+y*d+x*m+w*_,b=i[4],y=i[5],x=i[6],w=i[7],e[4]=b*r+y*s+x*u+w*f,e[5]=b*n+y*c+x*h+w*g,e[6]=b*o+y*l+x*p+w*v,e[7]=b*a+y*d+x*m+w*_,b=i[8],y=i[9],x=i[10],w=i[11],e[8]=b*r+y*s+x*u+w*f,e[9]=b*n+y*c+x*h+w*g,e[10]=b*o+y*l+x*p+w*v,e[11]=b*a+y*d+x*m+w*_,b=i[12],y=i[13],x=i[14],w=i[15],e[12]=b*r+y*s+x*u+w*f,e[13]=b*n+y*c+x*h+w*g,e[14]=b*o+y*l+x*p+w*v,e[15]=b*a+y*d+x*m+w*_,e};xr.multiplyAffine=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[4],s=t[5],c=t[6],l=t[8],d=t[9],u=t[10],h=t[12],p=t[13],m=t[14],f=i[0],g=i[1],v=i[2];return e[0]=f*r+g*a+v*l,e[1]=f*n+g*s+v*d,e[2]=f*o+g*c+v*u,f=i[4],g=i[5],v=i[6],e[4]=f*r+g*a+v*l,e[5]=f*n+g*s+v*d,e[6]=f*o+g*c+v*u,f=i[8],g=i[9],v=i[10],e[8]=f*r+g*a+v*l,e[9]=f*n+g*s+v*d,e[10]=f*o+g*c+v*u,f=i[12],g=i[13],v=i[14],e[12]=f*r+g*a+v*l+h,e[13]=f*n+g*s+v*d+p,e[14]=f*o+g*c+v*u+m,e};xr.mul=xr.multiply;xr.mulAffine=xr.multiplyAffine;xr.translate=function(e,t,i){var r=i[0],n=i[1],o=i[2],a,s,c,l,d,u,h,p,m,f,g,v;return t===e?(e[12]=t[0]*r+t[4]*n+t[8]*o+t[12],e[13]=t[1]*r+t[5]*n+t[9]*o+t[13],e[14]=t[2]*r+t[6]*n+t[10]*o+t[14],e[15]=t[3]*r+t[7]*n+t[11]*o+t[15]):(a=t[0],s=t[1],c=t[2],l=t[3],d=t[4],u=t[5],h=t[6],p=t[7],m=t[8],f=t[9],g=t[10],v=t[11],e[0]=a,e[1]=s,e[2]=c,e[3]=l,e[4]=d,e[5]=u,e[6]=h,e[7]=p,e[8]=m,e[9]=f,e[10]=g,e[11]=v,e[12]=a*r+d*n+m*o+t[12],e[13]=s*r+u*n+f*o+t[13],e[14]=c*r+h*n+g*o+t[14],e[15]=l*r+p*n+v*o+t[15]),e};xr.scale=function(e,t,i){var r=i[0],n=i[1],o=i[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e};xr.rotate=function(e,t,i,r){var n=r[0],o=r[1],a=r[2],s=Math.sqrt(n*n+o*o+a*a),c,l,d,u,h,p,m,f,g,v,_,b,y,x,w,I,S,E,N,M,P,$,R,j;return Math.abs(s)<Xg?null:(s=1/s,n*=s,o*=s,a*=s,c=Math.sin(i),l=Math.cos(i),d=1-l,u=t[0],h=t[1],p=t[2],m=t[3],f=t[4],g=t[5],v=t[6],_=t[7],b=t[8],y=t[9],x=t[10],w=t[11],I=n*n*d+l,S=o*n*d+a*c,E=a*n*d-o*c,N=n*o*d-a*c,M=o*o*d+l,P=a*o*d+n*c,$=n*a*d+o*c,R=o*a*d-n*c,j=a*a*d+l,e[0]=u*I+f*S+b*E,e[1]=h*I+g*S+y*E,e[2]=p*I+v*S+x*E,e[3]=m*I+_*S+w*E,e[4]=u*N+f*M+b*P,e[5]=h*N+g*M+y*P,e[6]=p*N+v*M+x*P,e[7]=m*N+_*M+w*P,e[8]=u*$+f*R+b*j,e[9]=h*$+g*R+y*j,e[10]=p*$+v*R+x*j,e[11]=m*$+_*R+w*j,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)};xr.rotateX=function(e,t,i){var r=Math.sin(i),n=Math.cos(i),o=t[4],a=t[5],s=t[6],c=t[7],l=t[8],d=t[9],u=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*n+l*r,e[5]=a*n+d*r,e[6]=s*n+u*r,e[7]=c*n+h*r,e[8]=l*n-o*r,e[9]=d*n-a*r,e[10]=u*n-s*r,e[11]=h*n-c*r,e};xr.rotateY=function(e,t,i){var r=Math.sin(i),n=Math.cos(i),o=t[0],a=t[1],s=t[2],c=t[3],l=t[8],d=t[9],u=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*n-l*r,e[1]=a*n-d*r,e[2]=s*n-u*r,e[3]=c*n-h*r,e[8]=o*r+l*n,e[9]=a*r+d*n,e[10]=s*r+u*n,e[11]=c*r+h*n,e};xr.rotateZ=function(e,t,i){var r=Math.sin(i),n=Math.cos(i),o=t[0],a=t[1],s=t[2],c=t[3],l=t[4],d=t[5],u=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*n+l*r,e[1]=a*n+d*r,e[2]=s*n+u*r,e[3]=c*n+h*r,e[4]=l*n-o*r,e[5]=d*n-a*r,e[6]=u*n-s*r,e[7]=h*n-c*r,e};xr.fromRotationTranslation=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=r+r,c=n+n,l=o+o,d=r*s,u=r*c,h=r*l,p=n*c,m=n*l,f=o*l,g=a*s,v=a*c,_=a*l;return e[0]=1-(p+f),e[1]=u+_,e[2]=h-v,e[3]=0,e[4]=u-_,e[5]=1-(d+f),e[6]=m+g,e[7]=0,e[8]=h+v,e[9]=m-g,e[10]=1-(d+p),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e};xr.fromQuat=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=i+i,s=r+r,c=n+n,l=i*a,d=r*a,u=r*s,h=n*a,p=n*s,m=n*c,f=o*a,g=o*s,v=o*c;return e[0]=1-u-m,e[1]=d+v,e[2]=h-g,e[3]=0,e[4]=d-v,e[5]=1-l-m,e[6]=p+f,e[7]=0,e[8]=h+g,e[9]=p-f,e[10]=1-l-u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};xr.frustum=function(e,t,i,r,n,o,a){var s=1/(i-t),c=1/(n-r),l=1/(o-a);return e[0]=o*2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o*2*c,e[6]=0,e[7]=0,e[8]=(i+t)*s,e[9]=(n+r)*c,e[10]=(a+o)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*l,e[15]=0,e};xr.perspective=function(e,t,i,r,n){var o=1/Math.tan(t/2),a=1/(r-n);return e[0]=o/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(n+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*n*r*a,e[15]=0,e};xr.ortho=function(e,t,i,r,n,o,a){var s=1/(t-i),c=1/(r-n),l=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+i)*s,e[13]=(n+r)*c,e[14]=(a+o)*l,e[15]=1,e};xr.lookAt=function(e,t,i,r){var n,o,a,s,c,l,d,u,h,p,m=t[0],f=t[1],g=t[2],v=r[0],_=r[1],b=r[2],y=i[0],x=i[1],w=i[2];return Math.abs(m-y)<Xg&&Math.abs(f-x)<Xg&&Math.abs(g-w)<Xg?xr.identity(e):(d=m-y,u=f-x,h=g-w,p=1/Math.sqrt(d*d+u*u+h*h),d*=p,u*=p,h*=p,n=_*h-b*u,o=b*d-v*h,a=v*u-_*d,p=Math.sqrt(n*n+o*o+a*a),p?(p=1/p,n*=p,o*=p,a*=p):(n=0,o=0,a=0),s=u*a-h*o,c=h*n-d*a,l=d*o-u*n,p=Math.sqrt(s*s+c*c+l*l),p?(p=1/p,s*=p,c*=p,l*=p):(s=0,c=0,l=0),e[0]=n,e[1]=s,e[2]=d,e[3]=0,e[4]=o,e[5]=c,e[6]=u,e[7]=0,e[8]=a,e[9]=l,e[10]=h,e[11]=0,e[12]=-(n*m+o*f+a*g),e[13]=-(s*m+c*f+l*g),e[14]=-(d*m+u*f+h*g),e[15]=1,e)};xr.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))};var Ge=xr;var Vt={};Vt.create=function(){var e=new Fr(3);return e[0]=0,e[1]=0,e[2]=0,e};Vt.clone=function(e){var t=new Fr(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t};Vt.fromValues=function(e,t,i){var r=new Fr(3);return r[0]=e,r[1]=t,r[2]=i,r};Vt.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e};Vt.set=function(e,t,i,r){return e[0]=t,e[1]=i,e[2]=r,e};Vt.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e};Vt.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e};Vt.sub=Vt.subtract;Vt.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e};Vt.mul=Vt.multiply;Vt.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e};Vt.div=Vt.divide;Vt.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e};Vt.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e};Vt.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e};Vt.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e};Vt.distance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return Math.sqrt(i*i+r*r+n*n)};Vt.dist=Vt.distance;Vt.squaredDistance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return i*i+r*r+n*n};Vt.sqrDist=Vt.squaredDistance;Vt.length=function(e){var t=e[0],i=e[1],r=e[2];return Math.sqrt(t*t+i*i+r*r)};Vt.len=Vt.length;Vt.squaredLength=function(e){var t=e[0],i=e[1],r=e[2];return t*t+i*i+r*r};Vt.sqrLen=Vt.squaredLength;Vt.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e};Vt.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e};Vt.normalize=function(e,t){var i=t[0],r=t[1],n=t[2],o=i*i+r*r+n*n;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e};Vt.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]};Vt.cross=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=i[0],s=i[1],c=i[2];return e[0]=n*c-o*s,e[1]=o*a-r*c,e[2]=r*s-n*a,e};Vt.lerp=function(e,t,i,r){var n=t[0],o=t[1],a=t[2];return e[0]=n+r*(i[0]-n),e[1]=o+r*(i[1]-o),e[2]=a+r*(i[2]-a),e};Vt.random=function(e,t){t=t||1;var i=yd()*2*Math.PI,r=yd()*2-1,n=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(i)*n,e[1]=Math.sin(i)*n,e[2]=r*t,e};Vt.transformMat4=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=i[3]*r+i[7]*n+i[11]*o+i[15];return a=a||1,e[0]=(i[0]*r+i[4]*n+i[8]*o+i[12])/a,e[1]=(i[1]*r+i[5]*n+i[9]*o+i[13])/a,e[2]=(i[2]*r+i[6]*n+i[10]*o+i[14])/a,e};Vt.transformMat3=function(e,t,i){var r=t[0],n=t[1],o=t[2];return e[0]=r*i[0]+n*i[3]+o*i[6],e[1]=r*i[1]+n*i[4]+o*i[7],e[2]=r*i[2]+n*i[5]+o*i[8],e};Vt.transformQuat=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=i[0],s=i[1],c=i[2],l=i[3],d=l*r+s*o-c*n,u=l*n+c*r-a*o,h=l*o+a*n-s*r,p=-a*r-s*n-c*o;return e[0]=d*l+p*-a+u*-c-h*-s,e[1]=u*l+p*-s+h*-a-d*-c,e[2]=h*l+p*-c+d*-s-u*-a,e};Vt.rotateX=function(e,t,i,r){var n=[],o=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],o[0]=n[0],o[1]=n[1]*Math.cos(r)-n[2]*Math.sin(r),o[2]=n[1]*Math.sin(r)+n[2]*Math.cos(r),e[0]=o[0]+i[0],e[1]=o[1]+i[1],e[2]=o[2]+i[2],e};Vt.rotateY=function(e,t,i,r){var n=[],o=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],o[0]=n[2]*Math.sin(r)+n[0]*Math.cos(r),o[1]=n[1],o[2]=n[2]*Math.cos(r)-n[0]*Math.sin(r),e[0]=o[0]+i[0],e[1]=o[1]+i[1],e[2]=o[2]+i[2],e};Vt.rotateZ=function(e,t,i,r){var n=[],o=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],o[0]=n[0]*Math.cos(r)-n[1]*Math.sin(r),o[1]=n[0]*Math.sin(r)+n[1]*Math.cos(r),o[2]=n[2],e[0]=o[0]+i[0],e[1]=o[1]+i[1],e[2]=o[2]+i[2],e};Vt.forEach=function(){var e=Vt.create();return function(t,i,r,n,o,a){var s,c;for(i||(i=3),r||(r=0),n?c=Math.min(n*i+r,t.length):c=t.length,s=r;s<c;s+=i)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}();Vt.angle=function(e,t){var i=Vt.fromValues(e[0],e[1],e[2]),r=Vt.fromValues(t[0],t[1],t[2]);Vt.normalize(i,i),Vt.normalize(r,r);var n=Vt.dot(i,r);return n>1?0:Math.acos(n)};var J=Vt;qe.import(ny);var Br=Ge.create,uF={};function hF(e){return e.material}function vJ(e,t,i){return t.uniforms[i].value}function _J(e,t,i,r){return i!==r}function bJ(e){return!0}function pF(){}var fF={float:me.FLOAT,byte:me.BYTE,ubyte:me.UNSIGNED_BYTE,short:me.SHORT,ushort:me.UNSIGNED_SHORT};function yJ(e,t,i){this.availableAttributes=e,this.availableAttributeSymbols=t,this.indicesBuffer=i,this.vao=null}function xJ(e){var t,i;this.bind=function(r){t||(t=Yi.createCanvas(),t.width=t.height=1,t.getContext("2d"));var n=r.gl,o=!i;o&&(i=n.createTexture()),n.bindTexture(n.TEXTURE_2D,i),o&&n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)},this.unbind=function(r){r.gl.bindTexture(r.gl.TEXTURE_2D,null)},this.isRenderable=function(){return!0}}var xd=fr.extend(function(){return{canvas:null,_width:100,_height:100,devicePixelRatio:typeof window<"u"&&window.devicePixelRatio||1,clearColor:[0,0,0,0],clearBit:17664,alpha:!0,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,throwError:!0,gl:null,viewport:{},maxJointNumber:20,__currentFrameBuffer:null,_viewportStack:[],_clearStack:[],_sceneRendering:null}},function(){this.canvas||(this.canvas=Yi.createCanvas());var e=this.canvas;try{var t={alpha:this.alpha,depth:this.depth,stencil:this.stencil,antialias:this.antialias,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer};if(this.gl=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!this.gl)throw new Error;this._glinfo=new UR(this.gl),this.gl.targetRenderer&&console.error("Already created a renderer"),this.gl.targetRenderer=this,this.resize()}catch(i){throw"Error creating WebGL Context "+i}this._programMgr=new iF(this),this._placeholderTexture=new xJ(this)},{resize:function(e,t){var i=this.canvas,r=this.devicePixelRatio;e!=null?(i.style&&(i.style.width=e+"px",i.style.height=t+"px"),i.width=e*r,i.height=t*r,this._width=e,this._height=t):(this._width=i.width/r,this._height=i.height/r),this.setViewport(0,0,this._width,this._height)},getWidth:function(){return this._width},getHeight:function(){return this._height},getViewportAspect:function(){var e=this.viewport;return e.width/e.height},setDevicePixelRatio:function(e){this.devicePixelRatio=e,this.resize(this._width,this._height)},getDevicePixelRatio:function(){return this.devicePixelRatio},getGLExtension:function(e){return this._glinfo.getExtension(e)},getGLParameter:function(e){return this._glinfo.getParameter(e)},setViewport:function(e,t,i,r,n){if(typeof e=="object"){var o=e;e=o.x,t=o.y,i=o.width,r=o.height,n=o.devicePixelRatio}n=n||this.devicePixelRatio,this.gl.viewport(e*n,t*n,i*n,r*n),this.viewport={x:e,y:t,width:i,height:r,devicePixelRatio:n}},saveViewport:function(){this._viewportStack.push(this.viewport)},restoreViewport:function(){this._viewportStack.length>0&&this.setViewport(this._viewportStack.pop())},saveClear:function(){this._clearStack.push({clearBit:this.clearBit,clearColor:this.clearColor})},restoreClear:function(){if(this._clearStack.length>0){var e=this._clearStack.pop();this.clearColor=e.clearColor,this.clearBit=e.clearBit}},bindSceneRendering:function(e){this._sceneRendering=e},render:function(e,t,i,r){var n=this.gl,o=this.clearColor;if(this.clearBit){n.colorMask(!0,!0,!0,!0),n.depthMask(!0);var a=this.viewport,s=!1,c=a.devicePixelRatio;(a.width!==this._width||a.height!==this._height||c&&c!==this.devicePixelRatio||a.x||a.y)&&(s=!0,n.enable(n.SCISSOR_TEST),n.scissor(a.x*c,a.y*c,a.width*c,a.height*c)),n.clearColor(o[0],o[1],o[2],o[3]),n.clear(this.clearBit),s&&n.disable(n.SCISSOR_TEST)}if(i||e.update(!1),e.updateLights(),t=t||e.getMainCamera(),!t){console.error("Can't find camera in the scene.");return}t.update();var l=e.updateRenderList(t,!0);this._sceneRendering=e;var d=l.opaque,u=l.transparent,h=e.material;e.trigger("beforerender",this,e,t,l),r?(this.renderPreZ(d,e,t),n.depthFunc(n.LEQUAL)):n.depthFunc(n.LESS);for(var p=Br(),m=J.create(),f=0;f<u.length;f++){var g=u[f];Ge.multiplyAffine(p,t.viewMatrix.array,g.worldTransform.array),J.transformMat4(m,g.position.array,p),g.__depth=m[2]}this.renderPass(d,t,{getMaterial:function(v){return h||v.material},sortCompare:this.opaqueSortCompare}),this.renderPass(u,t,{getMaterial:function(v){return h||v.material},sortCompare:this.transparentSortCompare}),e.trigger("afterrender",this,e,t,l),this._sceneRendering=null},getProgram:function(e,t,i){return t=t||e.material,this._programMgr.getProgram(e,t,i)},validateProgram:function(e){if(e.__error){var t=e.__error;if(uF[e.__uid__])return;if(uF[e.__uid__]=!0,this.throwError)throw new Error(t);this.trigger("error",t)}},updatePrograms:function(e,t,i){var r=i&&i.getMaterial||hF;t=t||null;for(var n=0;n<e.length;n++){var o=e[n],a=r.call(this,o);if(n>0){var s=e[n-1],c=s.joints?s.joints.length:0,l=o.joints?o.joints.length:0;if(l===c&&o.material===s.material&&o.lightGroup===s.lightGroup){o.__program=s.__program;continue}}var d=this._programMgr.getProgram(o,a,t);this.validateProgram(d),o.__program=d}},renderPass:function(e,t,i){this.trigger("beforerenderpass",this,e,t,i),i=i||{},i.getMaterial=i.getMaterial||hF,i.getUniform=i.getUniform||vJ,i.isMaterialChanged=i.isMaterialChanged||_J,i.beforeRender=i.beforeRender||pF,i.afterRender=i.afterRender||pF;var r=i.ifRender||bJ;this.updatePrograms(e,this._sceneRendering,i),i.sortCompare&&e.sort(i.sortCompare);var n=this.viewport,o=n.devicePixelRatio,a=[n.x*o,n.y*o,n.width*o,n.height*o],s=this.devicePixelRatio,c=this.__currentFrameBuffer?[this.__currentFrameBuffer.getTextureWidth(),this.__currentFrameBuffer.getTextureHeight()]:[this._width*s,this._height*s],l=[a[2],a[3]],d=Date.now();t?(Ge.copy(Lr.VIEW,t.viewMatrix.array),Ge.copy(Lr.PROJECTION,t.projectionMatrix.array),Ge.copy(Lr.VIEWINVERSE,t.worldTransform.array)):(Ge.identity(Lr.VIEW),Ge.identity(Lr.PROJECTION),Ge.identity(Lr.VIEWINVERSE)),Ge.multiply(Lr.VIEWPROJECTION,Lr.PROJECTION,Lr.VIEW),Ge.invert(Lr.PROJECTIONINVERSE,Lr.PROJECTION),Ge.invert(Lr.VIEWPROJECTIONINVERSE,Lr.VIEWPROJECTION);for(var u=this.gl,h=this._sceneRendering,p,m,f,g,v,_,b,y,x,w,I,S,E=null,N=0;N<e.length;N++){var M=e[N],P=M.worldTransform!=null,$;if(r(M)){P&&($=M.isSkinnedMesh&&M.isSkinnedMesh()?M.offsetMatrix?M.offsetMatrix.array:Lr.IDENTITY:M.worldTransform.array);var R=M.geometry,j=i.getMaterial.call(this,M),B=M.__program,te=j.shader,Z=R.__uid__+"-"+B.__uid__,ne=Z!==w;w=Z,ne&&E&&E.bindVertexArrayOES(null),P&&(Ge.copy(Lr.WORLD,$),Ge.multiply(Lr.WORLDVIEWPROJECTION,Lr.VIEWPROJECTION,$),Ge.multiplyAffine(Lr.WORLDVIEW,Lr.VIEW,$),(te.matrixSemantics.WORLDINVERSE||te.matrixSemantics.WORLDINVERSETRANSPOSE)&&Ge.invert(Lr.WORLDINVERSE,$),(te.matrixSemantics.WORLDVIEWINVERSE||te.matrixSemantics.WORLDVIEWINVERSETRANSPOSE)&&Ge.invert(Lr.WORLDVIEWINVERSE,Lr.WORLDVIEW),(te.matrixSemantics.WORLDVIEWPROJECTIONINVERSE||te.matrixSemantics.WORLDVIEWPROJECTIONINVERSETRANSPOSE)&&Ge.invert(Lr.WORLDVIEWPROJECTIONINVERSE,Lr.WORLDVIEWPROJECTION)),M.beforeRender&&M.beforeRender(this),i.beforeRender.call(this,M,j,p);var se=B!==m;se?(B.bind(this),B.setUniformOfSemantic(u,"VIEWPORT",a),B.setUniformOfSemantic(u,"WINDOW_SIZE",c),t&&(B.setUniformOfSemantic(u,"NEAR",t.near),B.setUniformOfSemantic(u,"FAR",t.far)),B.setUniformOfSemantic(u,"DEVICEPIXELRATIO",o),B.setUniformOfSemantic(u,"TIME",d),B.setUniformOfSemantic(u,"VIEWPORT_SIZE",l),h&&h.setLightUniforms(B,M.lightGroup,this)):B=m,(se||i.isMaterialChanged(M,f,j,p))&&(j.depthTest!==g&&(j.depthTest?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),g=j.depthTest),j.depthMask!==v&&(u.depthMask(j.depthMask),v=j.depthMask),j.transparent!==x&&(j.transparent?u.enable(u.BLEND):u.disable(u.BLEND),x=j.transparent),j.transparent&&(j.blend?j.blend(u):(u.blendEquationSeparate(u.FUNC_ADD,u.FUNC_ADD),u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA))),S=this._bindMaterial(M,j,B,f||null,p||null,m||null,i.getUniform),p=j);var we=te.matrixSemanticKeys;if(P)for(var ie=0;ie<we.length;ie++){var ue=we[ie],Ee=te.matrixSemantics[ue],ye=Lr[ue];if(Ee.isTranspose){var Te=Lr[Ee.semanticNoTranspose];Ge.transpose(ye,Te)}B.setUniform(u,Ee.type,Ee.symbol,ye)}M.cullFace!==b&&(b=M.cullFace,u.cullFace(b)),M.frontFace!==y&&(y=M.frontFace,u.frontFace(y)),M.culling!==_&&(_=M.culling,_?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE)),this._updateSkeleton(M,B,S),ne&&(I=this._bindVAO(E,te,R,B)),this._renderObject(M,I,B),i.afterRender(this,M),M.afterRender&&M.afterRender(this),m=B,f=M}}E&&E.bindVertexArrayOES(null),this.trigger("afterrenderpass",this,e,t,i)},getMaxJointNumber:function(){return this.maxJointNumber},_updateSkeleton:function(e,t,i){var r=this.gl,n=e.skeleton;if(n)if(n.update(),e.joints.length>this.getMaxJointNumber()){var o=n.getSubSkinMatricesTexture(e.__uid__,e.joints);t.useTextureSlot(this,o,i),t.setUniform(r,"1i","skinMatricesTexture",i),t.setUniform(r,"1f","skinMatricesTextureSize",o.width)}else{var a=n.getSubSkinMatrices(e.__uid__,e.joints);t.setUniformOfSemantic(r,"SKIN_MATRIX",a)}},_renderObject:function(e,t,i){var r=this.gl,n=e.geometry,o=e.mode;o==null&&(o=4);var a=null,s=e.isInstancedMesh&&e.isInstancedMesh();if(s&&(a=this.getGLExtension("ANGLE_instanced_arrays"),!a)){console.warn("Device not support ANGLE_instanced_arrays extension");return}var c;if(s&&(c=this._bindInstancedAttributes(e,i,a)),t.indicesBuffer){var l=this.getGLExtension("OES_element_index_uint"),d=l&&n.indices instanceof Uint32Array,u=d?r.UNSIGNED_INT:r.UNSIGNED_SHORT;s?a.drawElementsInstancedANGLE(o,t.indicesBuffer.count,u,0,e.getInstanceCount()):r.drawElements(o,t.indicesBuffer.count,u,0)}else s?a.drawArraysInstancedANGLE(o,0,n.vertexCount,e.getInstanceCount()):r.drawArrays(o,0,n.vertexCount);if(s)for(var h=0;h<c.length;h++)r.disableVertexAttribArray(c[h])},_bindInstancedAttributes:function(e,t,i){for(var r=this.gl,n=e.getInstancedAttributesBuffers(this),o=[],a=0;a<n.length;a++){var s=n[a],c=t.getAttribLocation(r,s.symbol);if(!(c<0)){var l=fF[s.type]||r.FLOAT;r.enableVertexAttribArray(c),r.bindBuffer(r.ARRAY_BUFFER,s.buffer),r.vertexAttribPointer(c,s.size,l,!1,0,0),i.vertexAttribDivisorANGLE(c,s.divisor),o.push(c)}}return o},_bindMaterial:function(e,t,i,r,n,o,a){for(var s=this.gl,c=o===i,l=i.currentTextureSlot(),d=t.getEnabledUniforms(),u=t.getTextureUniforms(),h=this._placeholderTexture,p=0;p<u.length;p++){var m=u[p],f=a(e,t,m),g=t.uniforms[m].type;if(g==="t"&&f)f.__slot=-1;else if(g==="tv")for(var v=0;v<f.length;v++)f[v]&&(f[v].__slot=-1)}h.__slot=-1;for(var p=0;p<d.length;p++){var m=d[p],_=t.uniforms[m],f=a(e,t,m),g=_.type,b=g==="t";if(b&&(!f||!f.isRenderable())&&(f=h),n&&c){var y=a(r,n,m);if(b&&(!y||!y.isRenderable())&&(y=h),y===f){if(b)i.takeCurrentTextureSlot(this,null);else if(g==="tv"&&f)for(var v=0;v<f.length;v++)i.takeCurrentTextureSlot(this,null);continue}}if(f!=null)if(b)if(f.__slot<0){var x=i.currentTextureSlot(),w=i.setUniform(s,"1i",m,x);w&&(i.takeCurrentTextureSlot(this,f),f.__slot=x)}else i.setUniform(s,"1i",m,f.__slot);else if(Array.isArray(f)){if(f.length===0)continue;if(g==="tv"){if(!i.hasUniform(m))continue;for(var I=[],v=0;v<f.length;v++){var S=f[v];if(S.__slot<0){var x=i.currentTextureSlot();I.push(x),i.takeCurrentTextureSlot(this,S),S.__slot=x}else I.push(S.__slot)}i.setUniform(s,"1iv",m,I)}else i.setUniform(s,_.type,m,f)}else i.setUniform(s,_.type,m,f)}var E=i.currentTextureSlot();return i.resetTextureSlot(l),E},_bindVAO:function(e,t,i,r){var n=!i.dynamic,o=this.gl,a=this.__uid__+"-"+r.__uid__,s=i.__vaoCache[a];if(!s){var c=i.getBufferChunks(this);if(!c||!c.length)return;for(var l=c[0],d=l.attributeBuffers,y=l.indicesBuffer,b=[],u=[],h=0;h<d.length;h++){var p=d[h],m=p.name,f=p.semantic,g;if(f){var v=t.attributeSemantics[f];g=v&&v.symbol}else g=m;g&&r.attributes[g]&&(b.push(p),u.push(g))}s=new yJ(b,u,y),n&&(i.__vaoCache[a]=s)}var _=!0;e&&n&&(s.vao==null?s.vao=e.createVertexArrayOES():_=!1,e.bindVertexArrayOES(s.vao));var b=s.availableAttributes,y=s.indicesBuffer;if(_){for(var x=r.enableAttributes(this,s.availableAttributeSymbols,e&&n&&s),h=0;h<b.length;h++){var w=x[h];if(w!==-1){var p=b[h],I=p.buffer,S=p.size,E=fF[p.type]||o.FLOAT;o.bindBuffer(o.ARRAY_BUFFER,I),o.vertexAttribPointer(w,S,E,!1,0,0)}}i.isUseIndices()&&o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,y.buffer)}return s},renderPreZ:function(e,t,i){var r=this.gl,n=this._prezMaterial||new In({shader:new qe(qe.source("clay.prez.vertex"),qe.source("clay.prez.fragment"))});this._prezMaterial=n,r.colorMask(!1,!1,!1,!1),r.depthMask(!0),this.renderPass(e,i,{ifRender:function(o){return!o.ignorePreZ},isMaterialChanged:function(o,a){var s=o.material,c=a.material;return s.get("diffuseMap")!==c.get("diffuseMap")||(s.get("alphaCutoff")||0)!==(c.get("alphaCutoff")||0)},getUniform:function(o,a,s){if(s==="alphaMap")return o.material.get("diffuseMap");if(s==="alphaCutoff"){if(o.material.isDefined("fragment","ALPHA_TEST")&&o.material.get("diffuseMap")){var c=o.material.get("alphaCutoff");return c||0}return 0}else return s==="uvRepeat"?o.material.get("uvRepeat"):s==="uvOffset"?o.material.get("uvOffset"):a.get(s)},getMaterial:function(){return n},sort:this.opaqueSortCompare}),r.colorMask(!0,!0,!0,!0),r.depthMask(!0)},disposeScene:function(e){this.disposeNode(e,!0,!0),e.dispose()},disposeNode:function(e,t,i){e.getParent()&&e.getParent().remove(e);var r={};e.traverse(function(n){var o=n.material;if(n.geometry&&t&&n.geometry.dispose(this),i&&o&&!r[o.__uid__]){for(var a=o.getTextureUniforms(),s=0;s<a.length;s++){var c=a[s],l=o.uniforms[c].value,d=o.uniforms[c].type;if(l){if(d==="t")l.dispose&&l.dispose(this);else if(d==="tv")for(var u=0;u<l.length;u++)l[u]&&l[u].dispose&&l[u].dispose(this)}}r[o.__uid__]=!0}n.dispose&&n.dispose(this)},this)},disposeGeometry:function(e){e.dispose(this)},disposeTexture:function(e){e.dispose(this)},disposeFrameBuffer:function(e){e.dispose(this)},dispose:function(){},screenToNDC:function(e,t,i){i||(i=new Vn),t=this._height-t;var r=this.viewport,n=i.array;return n[0]=(e-r.x)/r.width,n[0]=n[0]*2-1,n[1]=(t-r.y)/r.height,n[1]=n[1]*2-1,i}});xd.opaqueSortCompare=xd.prototype.opaqueSortCompare=function(e,t){return e.renderOrder===t.renderOrder?e.__program===t.__program?e.material===t.material?e.geometry.__uid__-t.geometry.__uid__:e.material.__uid__-t.material.__uid__:e.__program&&t.__program?e.__program.__uid__-t.__program.__uid__:0:e.renderOrder-t.renderOrder};xd.transparentSortCompare=xd.prototype.transparentSortCompare=function(e,t){return e.renderOrder===t.renderOrder?e.__depth===t.__depth?e.__program===t.__program?e.material===t.material?e.geometry.__uid__-t.geometry.__uid__:e.material.__uid__-t.material.__uid__:e.__program&&t.__program?e.__program.__uid__-t.__program.__uid__:0:e.__depth-t.__depth:e.renderOrder-t.renderOrder};var Lr={IDENTITY:Br(),WORLD:Br(),VIEW:Br(),PROJECTION:Br(),WORLDVIEW:Br(),VIEWPROJECTION:Br(),WORLDVIEWPROJECTION:Br(),WORLDINVERSE:Br(),VIEWINVERSE:Br(),PROJECTIONINVERSE:Br(),WORLDVIEWINVERSE:Br(),VIEWPROJECTIONINVERSE:Br(),WORLDVIEWPROJECTIONINVERSE:Br(),WORLDTRANSPOSE:Br(),VIEWTRANSPOSE:Br(),PROJECTIONTRANSPOSE:Br(),WORLDVIEWTRANSPOSE:Br(),VIEWPROJECTIONTRANSPOSE:Br(),WORLDVIEWPROJECTIONTRANSPOSE:Br(),WORLDINVERSETRANSPOSE:Br(),VIEWINVERSETRANSPOSE:Br(),PROJECTIONINVERSETRANSPOSE:Br(),WORLDVIEWINVERSETRANSPOSE:Br(),VIEWPROJECTIONINVERSETRANSPOSE:Br(),WORLDVIEWPROJECTIONINVERSETRANSPOSE:Br()};xd.COLOR_BUFFER_BIT=me.COLOR_BUFFER_BIT;xd.DEPTH_BUFFER_BIT=me.DEPTH_BUFFER_BIT;xd.STENCIL_BUFFER_BIT=me.STENCIL_BUFFER_BIT;var wd=xd;var zt=function(e,t,i){e=e||0,t=t||0,i=i||0,this.array=J.fromValues(e,t,i),this._dirty=!0};zt.prototype={constructor:zt,add:function(e){return J.add(this.array,this.array,e.array),this._dirty=!0,this},set:function(e,t,i){return this.array[0]=e,this.array[1]=t,this.array[2]=i,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this._dirty=!0,this},clone:function(){return new zt(this.x,this.y,this.z)},copy:function(e){return J.copy(this.array,e.array),this._dirty=!0,this},cross:function(e,t){return J.cross(this.array,e.array,t.array),this._dirty=!0,this},dist:function(e){return J.dist(this.array,e.array)},distance:function(e){return J.distance(this.array,e.array)},div:function(e){return J.div(this.array,this.array,e.array),this._dirty=!0,this},divide:function(e){return J.divide(this.array,this.array,e.array),this._dirty=!0,this},dot:function(e){return J.dot(this.array,e.array)},len:function(){return J.len(this.array)},length:function(){return J.length(this.array)},lerp:function(e,t,i){return J.lerp(this.array,e.array,t.array,i),this._dirty=!0,this},min:function(e){return J.min(this.array,this.array,e.array),this._dirty=!0,this},max:function(e){return J.max(this.array,this.array,e.array),this._dirty=!0,this},mul:function(e){return J.mul(this.array,this.array,e.array),this._dirty=!0,this},multiply:function(e){return J.multiply(this.array,this.array,e.array),this._dirty=!0,this},negate:function(){return J.negate(this.array,this.array),this._dirty=!0,this},normalize:function(){return J.normalize(this.array,this.array),this._dirty=!0,this},random:function(e){return J.random(this.array,e),this._dirty=!0,this},scale:function(e){return J.scale(this.array,this.array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return J.scaleAndAdd(this.array,this.array,e.array,t),this._dirty=!0,this},sqrDist:function(e){return J.sqrDist(this.array,e.array)},squaredDistance:function(e){return J.squaredDistance(this.array,e.array)},sqrLen:function(){return J.sqrLen(this.array)},squaredLength:function(){return J.squaredLength(this.array)},sub:function(e){return J.sub(this.array,this.array,e.array),this._dirty=!0,this},subtract:function(e){return J.subtract(this.array,this.array,e.array),this._dirty=!0,this},transformMat3:function(e){return J.transformMat3(this.array,this.array,e.array),this._dirty=!0,this},transformMat4:function(e){return J.transformMat4(this.array,this.array,e.array),this._dirty=!0,this},transformQuat:function(e){return J.transformQuat(this.array,this.array,e.array),this._dirty=!0,this},applyProjection:function(e){var t=this.array;if(e=e.array,e[15]===0){var i=-1/t[2];t[0]=e[0]*t[0]*i,t[1]=e[5]*t[1]*i,t[2]=(e[10]*t[2]+e[14])*i}else t[0]=e[0]*t[0]+e[12],t[1]=e[5]*t[1]+e[13],t[2]=e[10]*t[2]+e[14];return this._dirty=!0,this},eulerFromQuat:function(e,t){zt.eulerFromQuat(this,e,t)},eulerFromMat3:function(e,t){zt.eulerFromMat3(this,e,t)},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var oy=Object.defineProperty;oy&&(ay=zt.prototype,oy(ay,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),oy(ay,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}),oy(ay,"z",{get:function(){return this.array[2]},set:function(e){this.array[2]=e,this._dirty=!0}}));var ay;zt.add=function(e,t,i){return J.add(e.array,t.array,i.array),e._dirty=!0,e};zt.set=function(e,t,i,r){J.set(e.array,t,i,r),e._dirty=!0};zt.copy=function(e,t){return J.copy(e.array,t.array),e._dirty=!0,e};zt.cross=function(e,t,i){return J.cross(e.array,t.array,i.array),e._dirty=!0,e};zt.dist=function(e,t){return J.distance(e.array,t.array)};zt.distance=zt.dist;zt.div=function(e,t,i){return J.divide(e.array,t.array,i.array),e._dirty=!0,e};zt.divide=zt.div;zt.dot=function(e,t){return J.dot(e.array,t.array)};zt.len=function(e){return J.length(e.array)};zt.lerp=function(e,t,i,r){return J.lerp(e.array,t.array,i.array,r),e._dirty=!0,e};zt.min=function(e,t,i){return J.min(e.array,t.array,i.array),e._dirty=!0,e};zt.max=function(e,t,i){return J.max(e.array,t.array,i.array),e._dirty=!0,e};zt.mul=function(e,t,i){return J.multiply(e.array,t.array,i.array),e._dirty=!0,e};zt.multiply=zt.mul;zt.negate=function(e,t){return J.negate(e.array,t.array),e._dirty=!0,e};zt.normalize=function(e,t){return J.normalize(e.array,t.array),e._dirty=!0,e};zt.random=function(e,t){return J.random(e.array,t),e._dirty=!0,e};zt.scale=function(e,t,i){return J.scale(e.array,t.array,i),e._dirty=!0,e};zt.scaleAndAdd=function(e,t,i,r){return J.scaleAndAdd(e.array,t.array,i.array,r),e._dirty=!0,e};zt.sqrDist=function(e,t){return J.sqrDist(e.array,t.array)};zt.squaredDistance=zt.sqrDist;zt.sqrLen=function(e){return J.sqrLen(e.array)};zt.squaredLength=zt.sqrLen;zt.sub=function(e,t,i){return J.subtract(e.array,t.array,i.array),e._dirty=!0,e};zt.subtract=zt.sub;zt.transformMat3=function(e,t,i){return J.transformMat3(e.array,t.array,i.array),e._dirty=!0,e};zt.transformMat4=function(e,t,i){return J.transformMat4(e.array,t.array,i.array),e._dirty=!0,e};zt.transformQuat=function(e,t,i){return J.transformQuat(e.array,t.array,i.array),e._dirty=!0,e};function Ts(e,t,i){return e<t?t:e>i?i:e}var mr=Math.atan2,As=Math.asin,of=Math.abs;zt.eulerFromQuat=function(e,t,h){e._dirty=!0,t=t.array;var r=e.array,n=t[0],o=t[1],a=t[2],s=t[3],c=n*n,l=o*o,d=a*a,u=s*s,h=(h||"XYZ").toUpperCase();switch(h){case"XYZ":r[0]=mr(2*(n*s-o*a),u-c-l+d),r[1]=As(Ts(2*(n*a+o*s),-1,1)),r[2]=mr(2*(a*s-n*o),u+c-l-d);break;case"YXZ":r[0]=As(Ts(2*(n*s-o*a),-1,1)),r[1]=mr(2*(n*a+o*s),u-c-l+d),r[2]=mr(2*(n*o+a*s),u-c+l-d);break;case"ZXY":r[0]=As(Ts(2*(n*s+o*a),-1,1)),r[1]=mr(2*(o*s-a*n),u-c-l+d),r[2]=mr(2*(a*s-n*o),u-c+l-d);break;case"ZYX":r[0]=mr(2*(n*s+a*o),u-c-l+d),r[1]=As(Ts(2*(o*s-n*a),-1,1)),r[2]=mr(2*(n*o+a*s),u+c-l-d);break;case"YZX":r[0]=mr(2*(n*s-a*o),u-c+l-d),r[1]=mr(2*(o*s-n*a),u+c-l-d),r[2]=As(Ts(2*(n*o+a*s),-1,1));break;case"XZY":r[0]=mr(2*(n*s+o*a),u-c+l-d),r[1]=mr(2*(n*a+o*s),u+c-l-d),r[2]=As(Ts(2*(a*s-n*o),-1,1));break;default:console.warn("Unkown order: "+h)}return e};zt.eulerFromMat3=function(e,t,m){var r=t.array,n=r[0],o=r[3],a=r[6],s=r[1],c=r[4],l=r[7],d=r[2],u=r[5],h=r[8],p=e.array,m=(m||"XYZ").toUpperCase();switch(m){case"XYZ":p[1]=As(Ts(a,-1,1)),of(a)<.99999?(p[0]=mr(-l,h),p[2]=mr(-o,n)):(p[0]=mr(u,c),p[2]=0);break;case"YXZ":p[0]=As(-Ts(l,-1,1)),of(l)<.99999?(p[1]=mr(a,h),p[2]=mr(s,c)):(p[1]=mr(-d,n),p[2]=0);break;case"ZXY":p[0]=As(Ts(u,-1,1)),of(u)<.99999?(p[1]=mr(-d,h),p[2]=mr(-o,c)):(p[1]=0,p[2]=mr(s,n));break;case"ZYX":p[1]=As(-Ts(d,-1,1)),of(d)<.99999?(p[0]=mr(u,h),p[2]=mr(s,n)):(p[0]=0,p[2]=mr(-o,c));break;case"YZX":p[2]=As(Ts(s,-1,1)),of(s)<.99999?(p[0]=mr(-l,c),p[1]=mr(-d,n)):(p[0]=0,p[1]=mr(a,h));break;case"XZY":p[2]=As(-Ts(o,-1,1)),of(o)<.99999?(p[0]=mr(u,c),p[1]=mr(a,n)):(p[0]=mr(-l,h),p[1]=0);break;default:console.warn("Unkown order: "+m)}return e._dirty=!0,e};Object.defineProperties(zt,{POSITIVE_X:{get:function(){return new zt(1,0,0)}},NEGATIVE_X:{get:function(){return new zt(-1,0,0)}},POSITIVE_Y:{get:function(){return new zt(0,1,0)}},NEGATIVE_Y:{get:function(){return new zt(0,-1,0)}},POSITIVE_Z:{get:function(){return new zt(0,0,1)}},NEGATIVE_Z:{get:function(){return new zt(0,0,-1)}},UP:{get:function(){return new zt(0,1,0)}},ZERO:{get:function(){return new zt}}});var Fe=zt;var ZC=1e-5,sy=function(e,t){this.origin=e||new Fe,this.direction=t||new Fe};sy.prototype={constructor:sy,intersectPlane:function(e,t){var i=e.normal.array,r=e.distance,n=this.origin.array,o=this.direction.array,a=J.dot(i,o);if(a===0)return null;t||(t=new Fe);var s=(J.dot(i,n)-r)/a;return J.scaleAndAdd(t.array,n,o,-s),t._dirty=!0,t},mirrorAgainstPlane:function(e){var t=J.dot(e.normal.array,this.direction.array);J.scaleAndAdd(this.direction.array,this.direction.array,e.normal.array,-t*2),this.direction._dirty=!0},distanceToPoint:function(){var e=J.create();return function(t){J.sub(e,t,this.origin.array);var i=J.dot(e,this.direction.array);if(i<0)return J.distance(this.origin.array,t);var r=J.lenSquared(e);return Math.sqrt(r-i*i)}}(),intersectSphere:function(){var e=J.create();return function(t,i,r){var n=this.origin.array,o=this.direction.array;t=t.array,J.sub(e,t,n);var a=J.dot(e,o),s=J.squaredLength(e),c=s-a*a,l=i*i;if(!(c>l)){var d=Math.sqrt(l-c),u=a-d,h=a+d;return r||(r=new Fe),u<0?h<0?null:(J.scaleAndAdd(r.array,n,o,h),r):(J.scaleAndAdd(r.array,n,o,u),r)}}}(),intersectBoundingBox:function(e,t){var i=this.direction.array,r=this.origin.array,n=e.min.array,o=e.max.array,a=1/i[0],s=1/i[1],c=1/i[2],l,d,u,h,p,m;if(a>=0?(l=(n[0]-r[0])*a,d=(o[0]-r[0])*a):(d=(n[0]-r[0])*a,l=(o[0]-r[0])*a),s>=0?(u=(n[1]-r[1])*s,h=(o[1]-r[1])*s):(h=(n[1]-r[1])*s,u=(o[1]-r[1])*s),l>h||u>d||((u>l||l!==l)&&(l=u),(h<d||d!==d)&&(d=h),c>=0?(p=(n[2]-r[2])*c,m=(o[2]-r[2])*c):(m=(n[2]-r[2])*c,p=(o[2]-r[2])*c),l>m||p>d)||((p>l||l!==l)&&(l=p),(m<d||d!==d)&&(d=m),d<0))return null;var f=l>=0?l:d;return t||(t=new Fe),J.scaleAndAdd(t.array,r,i,f),t},intersectTriangle:function(){var e=J.create(),t=J.create(),i=J.create(),r=J.create();return function(n,o,a,s,c,l){var d=this.direction.array,u=this.origin.array;n=n.array,o=o.array,a=a.array,J.sub(e,o,n),J.sub(t,a,n),J.cross(r,t,d);var h=J.dot(e,r);if(s){if(h>-ZC)return null}else if(h>-ZC&&h<ZC)return null;J.sub(i,u,n);var p=J.dot(r,i)/h;if(p<0||p>1)return null;J.cross(r,e,i);var m=J.dot(d,r)/h;if(m<0||m>1||p+m>1)return null;J.cross(r,e,t);var f=-J.dot(i,r)/h;return f<0?null:(c||(c=new Fe),l&&Fe.set(l,1-p-m,p,m),J.scaleAndAdd(c.array,u,d,f),c)}}(),applyTransform:function(e){Fe.add(this.direction,this.direction,this.origin),Fe.transformMat4(this.origin,this.origin,e),Fe.transformMat4(this.direction,this.direction,e),Fe.sub(this.direction,this.direction,this.origin),Fe.normalize(this.direction,this.direction)},copy:function(e){Fe.copy(this.origin,e.origin),Fe.copy(this.direction,e.direction)},clone:function(){var e=new sy;return e.copy(this),e}};var oh=sy;var oi={};oi.create=function(){var e=new Fr(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e};oi.clone=function(e){var t=new Fr(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t};oi.fromValues=function(e,t,i,r){var n=new Fr(4);return n[0]=e,n[1]=t,n[2]=i,n[3]=r,n};oi.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e};oi.set=function(e,t,i,r,n){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e};oi.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e};oi.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e};oi.sub=oi.subtract;oi.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e};oi.mul=oi.multiply;oi.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e[3]=t[3]/i[3],e};oi.div=oi.divide;oi.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e[3]=Math.min(t[3],i[3]),e};oi.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e[3]=Math.max(t[3],i[3]),e};oi.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e};oi.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e};oi.distance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(i*i+r*r+n*n+o*o)};oi.dist=oi.distance;oi.squaredDistance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],o=t[3]-e[3];return i*i+r*r+n*n+o*o};oi.sqrDist=oi.squaredDistance;oi.length=function(e){var t=e[0],i=e[1],r=e[2],n=e[3];return Math.sqrt(t*t+i*i+r*r+n*n)};oi.len=oi.length;oi.squaredLength=function(e){var t=e[0],i=e[1],r=e[2],n=e[3];return t*t+i*i+r*r+n*n};oi.sqrLen=oi.squaredLength;oi.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e};oi.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e};oi.normalize=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=i*i+r*r+n*n+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a),e};oi.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]};oi.lerp=function(e,t,i,r){var n=t[0],o=t[1],a=t[2],s=t[3];return e[0]=n+r*(i[0]-n),e[1]=o+r*(i[1]-o),e[2]=a+r*(i[2]-a),e[3]=s+r*(i[3]-s),e};oi.random=function(e,t){return t=t||1,e[0]=yd(),e[1]=yd(),e[2]=yd(),e[3]=yd(),oi.normalize(e,e),oi.scale(e,e,t),e};oi.transformMat4=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3];return e[0]=i[0]*r+i[4]*n+i[8]*o+i[12]*a,e[1]=i[1]*r+i[5]*n+i[9]*o+i[13]*a,e[2]=i[2]*r+i[6]*n+i[10]*o+i[14]*a,e[3]=i[3]*r+i[7]*n+i[11]*o+i[15]*a,e};oi.transformQuat=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=i[0],s=i[1],c=i[2],l=i[3],d=l*r+s*o-c*n,u=l*n+c*r-a*o,h=l*o+a*n-s*r,p=-a*r-s*n-c*o;return e[0]=d*l+p*-a+u*-c-h*-s,e[1]=u*l+p*-s+h*-a-d*-c,e[2]=h*l+p*-c+d*-s-u*-a,e};oi.forEach=function(){var e=oi.create();return function(t,i,r,n,o,a){var s,c;for(i||(i=4),r||(r=0),n?c=Math.min(n*i+r,t.length):c=t.length,s=r;s<c;s+=i)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}();var nt=oi;var kn={};kn.create=function(){var e=new Fr(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e};kn.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e};kn.clone=function(e){var t=new Fr(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t};kn.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e};kn.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e};kn.transpose=function(e,t){if(e===t){var i=t[1],r=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=r,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e};kn.invert=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=t[4],s=t[5],c=t[6],l=t[7],d=t[8],u=d*a-s*l,h=-d*o+s*c,p=l*o-a*c,m=i*u+r*h+n*p;return m?(m=1/m,e[0]=u*m,e[1]=(-d*r+n*l)*m,e[2]=(s*r-n*a)*m,e[3]=h*m,e[4]=(d*i-n*c)*m,e[5]=(-s*i+n*o)*m,e[6]=p*m,e[7]=(-l*i+r*c)*m,e[8]=(a*i-r*o)*m,e):null};kn.adjoint=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=t[4],s=t[5],c=t[6],l=t[7],d=t[8];return e[0]=a*d-s*l,e[1]=n*l-r*d,e[2]=r*s-n*a,e[3]=s*c-o*d,e[4]=i*d-n*c,e[5]=n*o-i*s,e[6]=o*l-a*c,e[7]=r*c-i*l,e[8]=i*a-r*o,e};kn.determinant=function(e){var t=e[0],i=e[1],r=e[2],n=e[3],o=e[4],a=e[5],s=e[6],c=e[7],l=e[8];return t*(l*o-a*c)+i*(-l*n+a*s)+r*(c*n-o*s)};kn.multiply=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=t[4],c=t[5],l=t[6],d=t[7],u=t[8],h=i[0],p=i[1],m=i[2],f=i[3],g=i[4],v=i[5],_=i[6],b=i[7],y=i[8];return e[0]=h*r+p*a+m*l,e[1]=h*n+p*s+m*d,e[2]=h*o+p*c+m*u,e[3]=f*r+g*a+v*l,e[4]=f*n+g*s+v*d,e[5]=f*o+g*c+v*u,e[6]=_*r+b*a+y*l,e[7]=_*n+b*s+y*d,e[8]=_*o+b*c+y*u,e};kn.mul=kn.multiply;kn.translate=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=t[4],c=t[5],l=t[6],d=t[7],u=t[8],h=i[0],p=i[1];return e[0]=r,e[1]=n,e[2]=o,e[3]=a,e[4]=s,e[5]=c,e[6]=h*r+p*a+l,e[7]=h*n+p*s+d,e[8]=h*o+p*c+u,e};kn.rotate=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=t[4],c=t[5],l=t[6],d=t[7],u=t[8],h=Math.sin(i),p=Math.cos(i);return e[0]=p*r+h*a,e[1]=p*n+h*s,e[2]=p*o+h*c,e[3]=p*a-h*r,e[4]=p*s-h*n,e[5]=p*c-h*o,e[6]=l,e[7]=d,e[8]=u,e};kn.scale=function(e,t,i){var r=i[0],n=i[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e};kn.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e};kn.fromQuat=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=i+i,s=r+r,c=n+n,l=i*a,d=r*a,u=r*s,h=n*a,p=n*s,m=n*c,f=o*a,g=o*s,v=o*c;return e[0]=1-u-m,e[3]=d-v,e[6]=h+g,e[1]=d+v,e[4]=1-l-m,e[7]=p-f,e[2]=h-g,e[5]=p+f,e[8]=1-l-u,e};kn.normalFromMat4=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=t[4],s=t[5],c=t[6],l=t[7],d=t[8],u=t[9],h=t[10],p=t[11],m=t[12],f=t[13],g=t[14],v=t[15],_=i*s-r*a,b=i*c-n*a,y=i*l-o*a,x=r*c-n*s,w=r*l-o*s,I=n*l-o*c,S=d*f-u*m,E=d*g-h*m,N=d*v-p*m,M=u*g-h*f,P=u*v-p*f,$=h*v-p*g,R=_*$-b*P+y*M+x*N-w*E+I*S;return R?(R=1/R,e[0]=(s*$-c*P+l*M)*R,e[1]=(c*N-a*$-l*E)*R,e[2]=(a*P-s*N+l*S)*R,e[3]=(n*P-r*$-o*M)*R,e[4]=(i*$-n*N+o*E)*R,e[5]=(r*N-i*P-o*S)*R,e[6]=(f*I-g*w+v*x)*R,e[7]=(g*y-m*I-v*b)*R,e[8]=(m*w-f*y+v*_)*R,e):null};kn.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))};var ai=kn;var Bi={};Bi.create=function(){var e=new Fr(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e};Bi.rotationTo=function(){var e=J.create(),t=J.fromValues(1,0,0),i=J.fromValues(0,1,0);return function(r,n,o){var a=J.dot(n,o);return a<-.999999?(J.cross(e,t,n),J.length(e)<1e-6&&J.cross(e,i,n),J.normalize(e,e),Bi.setAxisAngle(r,e,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(J.cross(e,n,o),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+a,Bi.normalize(r,r))}}();Bi.setAxes=function(){var e=ai.create();return function(t,i,r,n){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=n[0],e[4]=n[1],e[7]=n[2],e[2]=-i[0],e[5]=-i[1],e[8]=-i[2],Bi.normalize(t,Bi.fromMat3(t,e))}}();Bi.clone=nt.clone;Bi.fromValues=nt.fromValues;Bi.copy=nt.copy;Bi.set=nt.set;Bi.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e};Bi.setAxisAngle=function(e,t,i){i=i*.5;var r=Math.sin(i);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(i),e};Bi.add=nt.add;Bi.multiply=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=i[0],c=i[1],l=i[2],d=i[3];return e[0]=r*d+a*s+n*l-o*c,e[1]=n*d+a*c+o*s-r*l,e[2]=o*d+a*l+r*c-n*s,e[3]=a*d-r*s-n*c-o*l,e};Bi.mul=Bi.multiply;Bi.scale=nt.scale;Bi.rotateX=function(e,t,i){i*=.5;var r=t[0],n=t[1],o=t[2],a=t[3],s=Math.sin(i),c=Math.cos(i);return e[0]=r*c+a*s,e[1]=n*c+o*s,e[2]=o*c-n*s,e[3]=a*c-r*s,e};Bi.rotateY=function(e,t,i){i*=.5;var r=t[0],n=t[1],o=t[2],a=t[3],s=Math.sin(i),c=Math.cos(i);return e[0]=r*c-o*s,e[1]=n*c+a*s,e[2]=o*c+r*s,e[3]=a*c-n*s,e};Bi.rotateZ=function(e,t,i){i*=.5;var r=t[0],n=t[1],o=t[2],a=t[3],s=Math.sin(i),c=Math.cos(i);return e[0]=r*c+n*s,e[1]=n*c-r*s,e[2]=o*c+a*s,e[3]=a*c-o*s,e};Bi.calculateW=function(e,t){var i=t[0],r=t[1],n=t[2];return e[0]=i,e[1]=r,e[2]=n,e[3]=Math.sqrt(Math.abs(1-i*i-r*r-n*n)),e};Bi.dot=nt.dot;Bi.lerp=nt.lerp;Bi.slerp=function(e,t,i,r){var n=t[0],o=t[1],a=t[2],s=t[3],c=i[0],l=i[1],d=i[2],u=i[3],h,p,m,f,g;return p=n*c+o*l+a*d+s*u,p<0&&(p=-p,c=-c,l=-l,d=-d,u=-u),1-p>1e-6?(h=Math.acos(p),m=Math.sin(h),f=Math.sin((1-r)*h)/m,g=Math.sin(r*h)/m):(f=1-r,g=r),e[0]=f*n+g*c,e[1]=f*o+g*l,e[2]=f*a+g*d,e[3]=f*s+g*u,e};Bi.invert=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=i*i+r*r+n*n+o*o,s=a?1/a:0;return e[0]=-i*s,e[1]=-r*s,e[2]=-n*s,e[3]=o*s,e};Bi.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e};Bi.length=nt.length;Bi.len=Bi.length;Bi.squaredLength=nt.squaredLength;Bi.sqrLen=Bi.squaredLength;Bi.normalize=nt.normalize;Bi.fromMat3=function(e,t){var i=t[0]+t[4]+t[8],r;if(i>0)r=Math.sqrt(i+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[n*3+n]&&(n=2);var o=(n+1)%3,a=(n+2)%3;r=Math.sqrt(t[n*3+n]-t[o*3+o]-t[a*3+a]+1),e[n]=.5*r,r=.5/r,e[3]=(t[o*3+a]-t[a*3+o])*r,e[o]=(t[o*3+n]+t[n*3+o])*r,e[a]=(t[a*3+n]+t[n*3+a])*r}return e};var Lt=Bi;var Nr=function(){this._axisX=new Fe,this._axisY=new Fe,this._axisZ=new Fe,this.array=Ge.create(),this._dirty=!0};Nr.prototype={constructor:Nr,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},adjoint:function(){return Ge.adjoint(this.array,this.array),this._dirty=!0,this},clone:function(){return new Nr().copy(this)},copy:function(e){return Ge.copy(this.array,e.array),this._dirty=!0,this},determinant:function(){return Ge.determinant(this.array)},fromQuat:function(e){return Ge.fromQuat(this.array,e.array),this._dirty=!0,this},fromRotationTranslation:function(e,t){return Ge.fromRotationTranslation(this.array,e.array,t.array),this._dirty=!0,this},fromMat2d:function(e){return Nr.fromMat2d(this,e),this},frustum:function(e,t,i,r,n,o){return Ge.frustum(this.array,e,t,i,r,n,o),this._dirty=!0,this},identity:function(){return Ge.identity(this.array),this._dirty=!0,this},invert:function(){return Ge.invert(this.array,this.array),this._dirty=!0,this},lookAt:function(e,t,i){return Ge.lookAt(this.array,e.array,t.array,i.array),this._dirty=!0,this},mul:function(e){return Ge.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return Ge.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return Ge.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return Ge.multiply(this.array,e.array,this.array),this._dirty=!0,this},ortho:function(e,t,i,r,n,o){return Ge.ortho(this.array,e,t,i,r,n,o),this._dirty=!0,this},perspective:function(e,t,i,r){return Ge.perspective(this.array,e,t,i,r),this._dirty=!0,this},rotate:function(e,t){return Ge.rotate(this.array,this.array,e,t.array),this._dirty=!0,this},rotateX:function(e){return Ge.rotateX(this.array,this.array,e),this._dirty=!0,this},rotateY:function(e){return Ge.rotateY(this.array,this.array,e),this._dirty=!0,this},rotateZ:function(e){return Ge.rotateZ(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return Ge.scale(this.array,this.array,e.array),this._dirty=!0,this},translate:function(e){return Ge.translate(this.array,this.array,e.array),this._dirty=!0,this},transpose:function(){return Ge.transpose(this.array,this.array),this._dirty=!0,this},decomposeMatrix:function(){var e=J.create(),t=J.create(),i=J.create(),r=ai.create();return function(n,o,a){var s=this.array;J.set(e,s[0],s[1],s[2]),J.set(t,s[4],s[5],s[6]),J.set(i,s[8],s[9],s[10]);var c=J.length(e),l=J.length(t),d=J.length(i),u=this.determinant();u<0&&(c=-c),n&&n.set(c,l,d),a.set(s[12],s[13],s[14]),ai.fromMat4(r,s),r[0]/=c,r[1]/=c,r[2]/=c,r[3]/=l,r[4]/=l,r[5]/=l,r[6]/=d,r[7]/=d,r[8]/=d,Lt.fromMat3(o.array,r),Lt.normalize(o.array,o.array),o._dirty=!0,a._dirty=!0}}(),toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var ly=Object.defineProperty;ly&&(cy=Nr.prototype,ly(cy,"z",{get:function(){var e=this.array;return this._axisZ.set(e[8],e[9],e[10]),this._axisZ},set:function(e){var t=this.array;e=e.array,t[8]=e[0],t[9]=e[1],t[10]=e[2],this._dirty=!0}}),ly(cy,"y",{get:function(){var e=this.array;return this._axisY.set(e[4],e[5],e[6]),this._axisY},set:function(e){var t=this.array;e=e.array,t[4]=e[0],t[5]=e[1],t[6]=e[2],this._dirty=!0}}),ly(cy,"x",{get:function(){var e=this.array;return this._axisX.set(e[0],e[1],e[2]),this._axisX},set:function(e){var t=this.array;e=e.array,t[0]=e[0],t[1]=e[1],t[2]=e[2],this._dirty=!0}}));var cy;Nr.adjoint=function(e,t){return Ge.adjoint(e.array,t.array),e._dirty=!0,e};Nr.copy=function(e,t){return Ge.copy(e.array,t.array),e._dirty=!0,e};Nr.determinant=function(e){return Ge.determinant(e.array)};Nr.identity=function(e){return Ge.identity(e.array),e._dirty=!0,e};Nr.ortho=function(e,t,i,r,n,o,a){return Ge.ortho(e.array,t,i,r,n,o,a),e._dirty=!0,e};Nr.perspective=function(e,t,i,r,n){return Ge.perspective(e.array,t,i,r,n),e._dirty=!0,e};Nr.lookAt=function(e,t,i,r){return Ge.lookAt(e.array,t.array,i.array,r.array),e._dirty=!0,e};Nr.invert=function(e,t){return Ge.invert(e.array,t.array),e._dirty=!0,e};Nr.mul=function(e,t,i){return Ge.mul(e.array,t.array,i.array),e._dirty=!0,e};Nr.multiply=Nr.mul;Nr.fromQuat=function(e,t){return Ge.fromQuat(e.array,t.array),e._dirty=!0,e};Nr.fromRotationTranslation=function(e,t,i){return Ge.fromRotationTranslation(e.array,t.array,i.array),e._dirty=!0,e};Nr.fromMat2d=function(r,i){r._dirty=!0;var i=i.array,r=r.array;return r[0]=i[0],r[4]=i[2],r[12]=i[4],r[1]=i[1],r[5]=i[3],r[13]=i[5],r};Nr.rotate=function(e,t,i,r){return Ge.rotate(e.array,t.array,i,r.array),e._dirty=!0,e};Nr.rotateX=function(e,t,i){return Ge.rotateX(e.array,t.array,i),e._dirty=!0,e};Nr.rotateY=function(e,t,i){return Ge.rotateY(e.array,t.array,i),e._dirty=!0,e};Nr.rotateZ=function(e,t,i){return Ge.rotateZ(e.array,t.array,i),e._dirty=!0,e};Nr.scale=function(e,t,i){return Ge.scale(e.array,t.array,i.array),e._dirty=!0,e};Nr.transpose=function(e,t){return Ge.transpose(e.array,t.array),e._dirty=!0,e};Nr.translate=function(e,t,i){return Ge.translate(e.array,t.array,i.array),e._dirty=!0,e};var ct=Nr;var er=function(e,t,i,r){e=e||0,t=t||0,i=i||0,r=r===void 0?1:r,this.array=Lt.fromValues(e,t,i,r),this._dirty=!0};er.prototype={constructor:er,add:function(e){return Lt.add(this.array,this.array,e.array),this._dirty=!0,this},calculateW:function(){return Lt.calculateW(this.array,this.array),this._dirty=!0,this},set:function(e,t,i,r){return this.array[0]=e,this.array[1]=t,this.array[2]=i,this.array[3]=r,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this.array[3]=e[3],this._dirty=!0,this},clone:function(){return new er(this.x,this.y,this.z,this.w)},conjugate:function(){return Lt.conjugate(this.array,this.array),this._dirty=!0,this},copy:function(e){return Lt.copy(this.array,e.array),this._dirty=!0,this},dot:function(e){return Lt.dot(this.array,e.array)},fromMat3:function(e){return Lt.fromMat3(this.array,e.array),this._dirty=!0,this},fromMat4:function(){var e=ai.create();return function(t){return ai.fromMat4(e,t.array),ai.transpose(e,e),Lt.fromMat3(this.array,e),this._dirty=!0,this}}(),identity:function(){return Lt.identity(this.array),this._dirty=!0,this},invert:function(){return Lt.invert(this.array,this.array),this._dirty=!0,this},len:function(){return Lt.len(this.array)},length:function(){return Lt.length(this.array)},lerp:function(e,t,i){return Lt.lerp(this.array,e.array,t.array,i),this._dirty=!0,this},mul:function(e){return Lt.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return Lt.multiply(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return Lt.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return Lt.multiply(this.array,e.array,this.array),this._dirty=!0,this},normalize:function(){return Lt.normalize(this.array,this.array),this._dirty=!0,this},rotateX:function(e){return Lt.rotateX(this.array,this.array,e),this._dirty=!0,this},rotateY:function(e){return Lt.rotateY(this.array,this.array,e),this._dirty=!0,this},rotateZ:function(e){return Lt.rotateZ(this.array,this.array,e),this._dirty=!0,this},rotationTo:function(e,t){return Lt.rotationTo(this.array,e.array,t.array),this._dirty=!0,this},setAxes:function(e,t,i){return Lt.setAxes(this.array,e.array,t.array,i.array),this._dirty=!0,this},setAxisAngle:function(e,t){return Lt.setAxisAngle(this.array,e.array,t),this._dirty=!0,this},slerp:function(e,t,i){return Lt.slerp(this.array,e.array,t.array,i),this._dirty=!0,this},sqrLen:function(){return Lt.sqrLen(this.array)},squaredLength:function(){return Lt.squaredLength(this.array)},fromEuler:function(e,t){return er.fromEuler(this,e,t)},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var Yg=Object.defineProperty;Yg&&(Zg=er.prototype,Yg(Zg,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),Yg(Zg,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}),Yg(Zg,"z",{get:function(){return this.array[2]},set:function(e){this.array[2]=e,this._dirty=!0}}),Yg(Zg,"w",{get:function(){return this.array[3]},set:function(e){this.array[3]=e,this._dirty=!0}}));var Zg;er.add=function(e,t,i){return Lt.add(e.array,t.array,i.array),e._dirty=!0,e};er.set=function(e,t,i,r,n){Lt.set(e.array,t,i,r,n),e._dirty=!0};er.copy=function(e,t){return Lt.copy(e.array,t.array),e._dirty=!0,e};er.calculateW=function(e,t){return Lt.calculateW(e.array,t.array),e._dirty=!0,e};er.conjugate=function(e,t){return Lt.conjugate(e.array,t.array),e._dirty=!0,e};er.identity=function(e){return Lt.identity(e.array),e._dirty=!0,e};er.invert=function(e,t){return Lt.invert(e.array,t.array),e._dirty=!0,e};er.dot=function(e,t){return Lt.dot(e.array,t.array)};er.len=function(e){return Lt.length(e.array)};er.lerp=function(e,t,i,r){return Lt.lerp(e.array,t.array,i.array,r),e._dirty=!0,e};er.slerp=function(e,t,i,r){return Lt.slerp(e.array,t.array,i.array,r),e._dirty=!0,e};er.mul=function(e,t,i){return Lt.multiply(e.array,t.array,i.array),e._dirty=!0,e};er.multiply=er.mul;er.rotateX=function(e,t,i){return Lt.rotateX(e.array,t.array,i),e._dirty=!0,e};er.rotateY=function(e,t,i){return Lt.rotateY(e.array,t.array,i),e._dirty=!0,e};er.rotateZ=function(e,t,i){return Lt.rotateZ(e.array,t.array,i),e._dirty=!0,e};er.setAxisAngle=function(e,t,i){return Lt.setAxisAngle(e.array,t.array,i),e._dirty=!0,e};er.normalize=function(e,t){return Lt.normalize(e.array,t.array),e._dirty=!0,e};er.sqrLen=function(e){return Lt.sqrLen(e.array)};er.squaredLength=er.sqrLen;er.fromMat3=function(e,t){return Lt.fromMat3(e.array,t.array),e._dirty=!0,e};er.setAxes=function(e,t,i,r){return Lt.setAxes(e.array,t.array,i.array,r.array),e._dirty=!0,e};er.rotationTo=function(e,t,i){return Lt.rotationTo(e.array,t.array,i.array),e._dirty=!0,e};er.fromEuler=function(e,t,d){e._dirty=!0,t=t.array;var r=e.array,n=Math.cos(t[0]/2),o=Math.cos(t[1]/2),a=Math.cos(t[2]/2),s=Math.sin(t[0]/2),c=Math.sin(t[1]/2),l=Math.sin(t[2]/2),d=(d||"XYZ").toUpperCase();switch(d){case"XYZ":r[0]=s*o*a+n*c*l,r[1]=n*c*a-s*o*l,r[2]=n*o*l+s*c*a,r[3]=n*o*a-s*c*l;break;case"YXZ":r[0]=s*o*a+n*c*l,r[1]=n*c*a-s*o*l,r[2]=n*o*l-s*c*a,r[3]=n*o*a+s*c*l;break;case"ZXY":r[0]=s*o*a-n*c*l,r[1]=n*c*a+s*o*l,r[2]=n*o*l+s*c*a,r[3]=n*o*a-s*c*l;break;case"ZYX":r[0]=s*o*a-n*c*l,r[1]=n*c*a+s*o*l,r[2]=n*o*l-s*c*a,r[3]=n*o*a+s*c*l;break;case"YZX":r[0]=s*o*a+n*c*l,r[1]=n*c*a+s*o*l,r[2]=n*o*l-s*c*a,r[3]=n*o*a-s*c*l;break;case"XZY":r[0]=s*o*a-n*c*l,r[1]=n*c*a-s*o*l,r[2]=n*o*l+s*c*a,r[3]=n*o*a+s*c*l;break}};var dy=er;var Ed=J.set,uy=J.copy,hy=function(e,t){this.min=e||new Fe(1/0,1/0,1/0),this.max=t||new Fe(-1/0,-1/0,-1/0),this.vertices=null};hy.prototype={constructor:hy,updateFromVertices:function(e){if(e.length>0){var t=this.min,i=this.max,r=t.array,n=i.array;uy(r,e[0]),uy(n,e[0]);for(var o=1;o<e.length;o++){var a=e[o];a[0]<r[0]&&(r[0]=a[0]),a[1]<r[1]&&(r[1]=a[1]),a[2]<r[2]&&(r[2]=a[2]),a[0]>n[0]&&(n[0]=a[0]),a[1]>n[1]&&(n[1]=a[1]),a[2]>n[2]&&(n[2]=a[2])}t._dirty=!0,i._dirty=!0}},union:function(e){var t=this.min,i=this.max;return J.min(t.array,t.array,e.min.array),J.max(i.array,i.array,e.max.array),t._dirty=!0,i._dirty=!0,this},intersection:function(e){var t=this.min,i=this.max;return J.max(t.array,t.array,e.min.array),J.min(i.array,i.array,e.max.array),t._dirty=!0,i._dirty=!0,this},intersectBoundingBox:function(e){var t=this.min.array,i=this.max.array,r=e.min.array,n=e.max.array;return!(t[0]>n[0]||t[1]>n[1]||t[2]>n[2]||i[0]<r[0]||i[1]<r[1]||i[2]<r[2])},containBoundingBox:function(e){var t=this.min.array,i=this.max.array,r=e.min.array,n=e.max.array;return t[0]<=r[0]&&t[1]<=r[1]&&t[2]<=r[2]&&i[0]>=n[0]&&i[1]>=n[1]&&i[2]>=n[2]},containPoint:function(e){var t=this.min.array,i=this.max.array,r=e.array;return t[0]<=r[0]&&t[1]<=r[1]&&t[2]<=r[2]&&i[0]>=r[0]&&i[1]>=r[1]&&i[2]>=r[2]},isFinite:function(){var e=this.min.array,t=this.max.array;return isFinite(e[0])&&isFinite(e[1])&&isFinite(e[2])&&isFinite(t[0])&&isFinite(t[1])&&isFinite(t[2])},applyTransform:function(e){this.transformFrom(this,e)},transformFrom:function(){var e=J.create(),t=J.create(),i=J.create(),r=J.create(),n=J.create(),o=J.create();return function(a,s){var c=a.min.array,l=a.max.array,d=s.array;return e[0]=d[0]*c[0],e[1]=d[1]*c[0],e[2]=d[2]*c[0],t[0]=d[0]*l[0],t[1]=d[1]*l[0],t[2]=d[2]*l[0],i[0]=d[4]*c[1],i[1]=d[5]*c[1],i[2]=d[6]*c[1],r[0]=d[4]*l[1],r[1]=d[5]*l[1],r[2]=d[6]*l[1],n[0]=d[8]*c[2],n[1]=d[9]*c[2],n[2]=d[10]*c[2],o[0]=d[8]*l[2],o[1]=d[9]*l[2],o[2]=d[10]*l[2],c=this.min.array,l=this.max.array,c[0]=Math.min(e[0],t[0])+Math.min(i[0],r[0])+Math.min(n[0],o[0])+d[12],c[1]=Math.min(e[1],t[1])+Math.min(i[1],r[1])+Math.min(n[1],o[1])+d[13],c[2]=Math.min(e[2],t[2])+Math.min(i[2],r[2])+Math.min(n[2],o[2])+d[14],l[0]=Math.max(e[0],t[0])+Math.max(i[0],r[0])+Math.max(n[0],o[0])+d[12],l[1]=Math.max(e[1],t[1])+Math.max(i[1],r[1])+Math.max(n[1],o[1])+d[13],l[2]=Math.max(e[2],t[2])+Math.max(i[2],r[2])+Math.max(n[2],o[2])+d[14],this.min._dirty=!0,this.max._dirty=!0,this}}(),applyProjection:function(e){var t=this.min.array,i=this.max.array,r=e.array,n=t[0],o=t[1],a=t[2],s=i[0],c=i[1],l=t[2],d=i[0],u=i[1],h=i[2];if(r[15]===1)t[0]=r[0]*n+r[12],t[1]=r[5]*o+r[13],i[2]=r[10]*a+r[14],i[0]=r[0]*d+r[12],i[1]=r[5]*u+r[13],t[2]=r[10]*h+r[14];else{var p=-1/a;t[0]=r[0]*n*p,t[1]=r[5]*o*p,i[2]=(r[10]*a+r[14])*p,p=-1/l,i[0]=r[0]*s*p,i[1]=r[5]*c*p,p=-1/h,t[2]=(r[10]*h+r[14])*p}return this.min._dirty=!0,this.max._dirty=!0,this},updateVertices:function(){var e=this.vertices;if(!e){e=[];for(var t=0;t<8;t++)e[t]=J.fromValues(0,0,0);this.vertices=e}var i=this.min.array,r=this.max.array;return Ed(e[0],i[0],i[1],i[2]),Ed(e[1],i[0],r[1],i[2]),Ed(e[2],r[0],i[1],i[2]),Ed(e[3],r[0],r[1],i[2]),Ed(e[4],i[0],i[1],r[2]),Ed(e[5],i[0],r[1],r[2]),Ed(e[6],r[0],i[1],r[2]),Ed(e[7],r[0],r[1],r[2]),this},copy:function(e){var t=this.min,i=this.max;return uy(t.array,e.min.array),uy(i.array,e.max.array),t._dirty=!0,i._dirty=!0,this},clone:function(){var e=new hy;return e.copy(this),e}};var Jr=hy;var wJ=0,EJ=fr.extend({name:"",position:null,rotation:null,scale:null,worldTransform:null,localTransform:null,autoUpdateLocalTransform:!0,_parent:null,_scene:null,_needsUpdateWorldTransform:!0,_inIterating:!1,__depth:0},function(){this.name||(this.name=(this.type||"NODE")+"_"+wJ++),this.position||(this.position=new Fe),this.rotation||(this.rotation=new dy),this.scale||(this.scale=new Fe(1,1,1)),this.worldTransform=new ct,this.localTransform=new ct,this._children=[]},{target:null,invisible:!1,isSkinnedMesh:function(){return!1},isRenderable:function(){return!1},setName:function(e){var t=this._scene;if(t){var i=t._nodeRepository;delete i[this.name],i[e]=this}this.name=e},add:function(e){var t=e._parent;if(t!==this){t&&t.remove(e),e._parent=this,this._children.push(e);var i=this._scene;i&&i!==e.scene&&e.traverse(this._addSelfToScene,this),e._needsUpdateWorldTransform=!0}},remove:function(e){var t=this._children,i=t.indexOf(e);i<0||(t.splice(i,1),e._parent=null,this._scene&&e.traverse(this._removeSelfFromScene,this))},removeAll:function(){for(var e=this._children,t=0;t<e.length;t++)e[t]._parent=null,this._scene&&e[t].traverse(this._removeSelfFromScene,this);this._children=[]},getScene:function(){return this._scene},getParent:function(){return this._parent},_removeSelfFromScene:function(e){e._scene.removeFromScene(e),e._scene=null},_addSelfToScene:function(e){this._scene.addToScene(e),e._scene=this._scene},isAncestor:function(e){for(var t=e._parent;t;){if(t===this)return!0;t=t._parent}return!1},children:function(){return this._children.slice()},childAt:function(e){return this._children[e]},getChildByName:function(e){for(var t=this._children,i=0;i<t.length;i++)if(t[i].name===e)return t[i]},getDescendantByName:function(e){for(var t=this._children,i=0;i<t.length;i++){var r=t[i];if(r.name===e)return r;var n=r.getDescendantByName(e);if(n)return n}},queryNode:function(e){if(e){for(var t=e.split("/"),i=this,r=0;r<t.length;r++){var n=t[r];if(n){for(var o=!1,a=i._children,s=0;s<a.length;s++){var c=a[s];if(c.name===n){i=c,o=!0;break}}if(!o)return}}return i}},getPath:function(e){if(!this._parent)return"/";for(var t=this._parent,i=this.name;t._parent&&(i=t.name+"/"+i,t._parent!=e);)t=t._parent;return!t._parent&&e?null:i},traverse:function(e,t){e.call(t,this);for(var i=this._children,r=0,n=i.length;r<n;r++)i[r].traverse(e,t)},eachChild:function(e,t){for(var i=this._children,r=0,n=i.length;r<n;r++){var o=i[r];e.call(t,o,r)}},setLocalTransform:function(e){Ge.copy(this.localTransform.array,e.array),this.decomposeLocalTransform()},decomposeLocalTransform:function(e){var t=e?null:this.scale;this.localTransform.decomposeMatrix(t,this.rotation,this.position)},setWorldTransform:function(e){Ge.copy(this.worldTransform.array,e.array),this.decomposeWorldTransform()},decomposeWorldTransform:function(){var e=Ge.create();return function(t){var i=this.localTransform,r=this.worldTransform;this._parent?(Ge.invert(e,this._parent.worldTransform.array),Ge.multiply(i.array,e,r.array)):Ge.copy(i.array,r.array);var n=t?null:this.scale;i.decomposeMatrix(n,this.rotation,this.position)}}(),transformNeedsUpdate:function(){return this.position._dirty||this.rotation._dirty||this.scale._dirty},updateLocalTransform:function(){var e=this.position,t=this.rotation,i=this.scale;if(this.transformNeedsUpdate()){var r=this.localTransform.array;Ge.fromRotationTranslation(r,t.array,e.array),Ge.scale(r,r,i.array),t._dirty=!1,i._dirty=!1,e._dirty=!1,this._needsUpdateWorldTransform=!0}},_updateWorldTransformTopDown:function(){var e=this.localTransform.array,t=this.worldTransform.array;this._parent?Ge.multiplyAffine(t,this._parent.worldTransform.array,e):Ge.copy(t,e)},updateWorldTransform:function(){for(var e=this;e&&e.getParent()&&e.getParent().transformNeedsUpdate();)e=e.getParent();e.update()},update:function(e){this.autoUpdateLocalTransform?this.updateLocalTransform():e=!0,(e||this._needsUpdateWorldTransform)&&(this._updateWorldTransformTopDown(),e=!0,this._needsUpdateWorldTransform=!1);for(var t=this._children,i=0,r=t.length;i<r;i++)t[i].update(e)},getBoundingBox:function(){function e(n){return!n.invisible&&n.geometry}var t=new Jr,i=new ct,r=new ct;return function(n,o){return o=o||new Jr,n=n||e,this._parent?ct.invert(r,this._parent.worldTransform):ct.identity(r),this.traverse(function(a){a.geometry&&a.geometry.boundingBox&&(t.copy(a.geometry.boundingBox),ct.multiply(i,r,a.worldTransform),t.applyTransform(i),o.union(t))},this,e),o}}(),getWorldPosition:function(e){this.transformNeedsUpdate()&&this.updateWorldTransform();var t=this.worldTransform.array;if(e){var i=e.array;return i[0]=t[12],i[1]=t[13],i[2]=t[14],e}else return new Fe(t[12],t[13],t[14])},clone:function(){var e=new this.constructor,t=this._children;e.setName(this.name),e.position.copy(this.position),e.rotation.copy(this.rotation),e.scale.copy(this.scale);for(var i=0;i<t.length;i++)e.add(t[i].clone());return e},rotateAround:function(){var e=new Fe,t=new ct;return function(i,r,n){e.copy(this.position).subtract(i);var o=this.localTransform;o.identity(),o.translate(i),o.rotate(n,r),t.fromRotationTranslation(this.rotation,e),o.multiply(t),o.scale(this.scale),this.decomposeLocalTransform(),this._needsUpdateWorldTransform=!0}}(),lookAt:function(){var e=new ct;return function(t,i){e.lookAt(this.position,t,i||this.localTransform.y).invert(),this.setLocalTransform(e),this.target=t}}()}),Jo=EJ;var Xa=Jo.extend({material:null,geometry:null,mode:me.TRIANGLES,_renderInfo:null},{__program:null,lightGroup:0,renderOrder:0,culling:!0,cullFace:me.BACK,frontFace:me.CCW,frustumCulling:!0,receiveShadow:!0,castShadow:!0,ignorePicking:!1,ignorePreZ:!1,ignoreGBuffer:!1,isRenderable:function(){return this.geometry&&this.material&&this.material.shader&&!this.invisible&&this.geometry.vertexCount>0},beforeRender:function(e){},afterRender:function(e,t){},getBoundingBox:function(e,t){return t=Jo.prototype.getBoundingBox.call(this,e,t),this.geometry&&this.geometry.boundingBox&&t.union(this.geometry.boundingBox),t},clone:function(){var e=["castShadow","receiveShadow","mode","culling","cullFace","frontFace","frustumCulling","renderOrder","lineWidth","ignorePicking","ignorePreZ","ignoreGBuffer"];return function(){var t=Jo.prototype.clone.call(this);t.geometry=this.geometry,t.material=this.material;for(var i=0;i<e.length;i++){var r=e[i];t[r]!==this[r]&&(t[r]=this[r])}return t}}()});Xa.POINTS=me.POINTS;Xa.LINES=me.LINES;Xa.LINE_LOOP=me.LINE_LOOP;Xa.LINE_STRIP=me.LINE_STRIP;Xa.TRIANGLES=me.TRIANGLES;Xa.TRIANGLE_STRIP=me.TRIANGLE_STRIP;Xa.TRIANGLE_FAN=me.TRIANGLE_FAN;Xa.BACK=me.BACK;Xa.FRONT=me.FRONT;Xa.FRONT_AND_BACK=me.FRONT_AND_BACK;Xa.CW=me.CW;Xa.CCW=me.CCW;var Kg=Xa;var KC=fr.extend({scene:null,camera:null,renderer:null},function(){this._ray=new oh,this._ndc=new Vn},{pick:function(e,t,i){var r=this.pickAll(e,t,[],i);return r[0]||null},pickAll:function(e,t,i,r){return this.renderer.screenToNDC(e,t,this._ndc),this.camera.castRay(this._ndc,this._ray),i=i||[],this._intersectNode(this.scene,i,r||!1),i.sort(this._intersectionCompareFunc),i},_intersectNode:function(e,t,i){e instanceof Kg&&e.isRenderable()&&(!e.ignorePicking||i)&&(e.mode===me.TRIANGLES&&e.geometry.isUseIndices()||e.geometry.pickByRay||e.geometry.pick)&&this._intersectRenderable(e,t);for(var r=0;r<e._children.length;r++)this._intersectNode(e._children[r],t,i)},_intersectRenderable:function(){var e=new Fe,t=new Fe,i=new Fe,r=new oh,n=new ct;return function(o,a){var s=o.isSkinnedMesh();r.copy(this._ray),ct.invert(n,o.worldTransform),s||r.applyTransform(n);var c=o.geometry,l=s?o.skeleton.boundingBox:c.boundingBox;if(!(l&&!r.intersectBoundingBox(l))){if(c.pick){c.pick(this._ndc.x,this._ndc.y,this.renderer,this.camera,o,a);return}else if(c.pickByRay){c.pickByRay(r,o,a);return}var d=o.cullFace===me.BACK&&o.frontFace===me.CCW||o.cullFace===me.FRONT&&o.frontFace===me.CW,u,h=c.indices,p=c.attributes.position,m=c.attributes.weight,f=c.attributes.joint,g,v=[];if(!(!p||!p.value||!h)){if(s){g=o.skeleton.getSubSkinMatrices(o.__uid__,o.joints);for(var _=0;_<o.joints.length;_++){v[_]=v[_]||[];for(var b=0;b<16;b++)v[_][b]=g[_*16+b]}var y=[],x=[],w=[],I=[],S=[],E=c.attributes.skinnedPosition;(!E||!E.value)&&(c.createAttribute("skinnedPosition","f",3),E=c.attributes.skinnedPosition,E.init(c.vertexCount));for(var _=0;_<c.vertexCount;_++){p.get(_,y),m.get(_,x),f.get(_,w),x[3]=1-x[0]-x[1]-x[2],J.set(I,0,0,0);for(var b=0;b<4;b++)w[b]>=0&&x[b]>1e-4&&(J.transformMat4(S,y,v[w[b]]),J.scaleAndAdd(I,I,S,x[b]));E.set(_,I)}}for(var _=0;_<h.length;_+=3){var N=h[_],M=h[_+1],P=h[_+2],$=s?c.attributes.skinnedPosition:p;if($.get(N,e.array),$.get(M,t.array),$.get(P,i.array),d?u=r.intersectTriangle(e,t,i,o.culling):u=r.intersectTriangle(e,i,t,o.culling),u){var R=new Fe;s?Fe.copy(R,u):Fe.transformMat4(R,u,o.worldTransform),a.push(new KC.Intersection(u,R,o,[N,M,P],_/3,Fe.dist(R,this._ray.origin)))}}}}}}(),_intersectionCompareFunc:function(e,t){return e.distance-t.distance}});KC.Intersection=function(e,t,i,r,n,o){this.point=e,this.pointWorld=t,this.target=i,this.triangle=r,this.triangleIndex=n,this.distance=o};var mF=KC;var Qg="__dt__",py=function(){this._contextId=0,this._caches=[],this._context={}};py.prototype={use:function(e,t){var i=this._caches;i[e]||(i[e]={},t&&(i[e]=t())),this._contextId=e,this._context=i[e]},put:function(e,t){this._context[e]=t},get:function(e){return this._context[e]},dirty:function(e){e=e||"";var t=Qg+e;this.put(t,!0)},dirtyAll:function(e){e=e||"";for(var t=Qg+e,i=this._caches,r=0;r<i.length;r++)i[r]&&(i[r][t]=!0)},fresh:function(e){e=e||"";var t=Qg+e;this.put(t,!1)},freshAll:function(e){e=e||"";for(var t=Qg+e,i=this._caches,r=0;r<i.length;r++)i[r]&&(i[r][t]=!1)},isDirty:function(e){e=e||"";var t=Qg+e,i=this._context;return!i.hasOwnProperty(t)||i[t]===!0},deleteContext:function(e){delete this._caches[e],this._context={}},delete:function(e){delete this._context[e]},clearAll:function(){this._caches={}},getContext:function(){return this._context},eachContext:function(e,t){var i=Object.keys(this._caches);i.forEach(function(r){e&&e.call(t,r)})},miss:function(e){return!this._context.hasOwnProperty(e)}};py.prototype.constructor=py;var af=py;var Mi=fr.extend({width:512,height:512,type:me.UNSIGNED_BYTE,format:me.RGBA,wrapS:me.REPEAT,wrapT:me.REPEAT,minFilter:me.LINEAR_MIPMAP_LINEAR,magFilter:me.LINEAR,useMipmap:!0,anisotropic:1,flipY:!0,sRGB:!0,unpackAlignment:4,premultiplyAlpha:!1,dynamic:!1,NPOT:!1,__used:0},function(){this._cache=new af},{getWebGLTexture:function(e){var t=e.gl,i=this._cache;return i.use(e.__uid__),i.miss("webgl_texture")&&i.put("webgl_texture",t.createTexture()),this.dynamic?this.update(e):i.isDirty()&&(this.update(e),i.fresh()),i.get("webgl_texture")},bind:function(){},unbind:function(){},dirty:function(){this._cache&&this._cache.dirtyAll()},update:function(e){},updateCommon:function(e){var t=e.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,this.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,this.unpackAlignment),this.format===me.DEPTH_COMPONENT&&(this.useMipmap=!1);var i=e.getGLExtension("EXT_sRGB");this.format===Mi.SRGB&&!i&&(this.format=Mi.RGB),this.format===Mi.SRGB_ALPHA&&!i&&(this.format=Mi.RGBA),this.NPOT=!this.isPowerOfTwo()},getAvailableWrapS:function(){return this.NPOT?me.CLAMP_TO_EDGE:this.wrapS},getAvailableWrapT:function(){return this.NPOT?me.CLAMP_TO_EDGE:this.wrapT},getAvailableMinFilter:function(){var e=this.minFilter;return this.NPOT||!this.useMipmap?e===me.NEAREST_MIPMAP_NEAREST||e===me.NEAREST_MIPMAP_LINEAR?me.NEAREST:e===me.LINEAR_MIPMAP_LINEAR||e===me.LINEAR_MIPMAP_NEAREST?me.LINEAR:e:e},getAvailableMagFilter:function(){return this.magFilter},nextHighestPowerOfTwo:function(e){--e;for(var t=1;t<32;t<<=1)e=e|e>>t;return e+1},dispose:function(e){var t=this._cache;t.use(e.__uid__);var i=t.get("webgl_texture");i&&e.gl.deleteTexture(i),t.deleteContext(e.__uid__)},isRenderable:function(){},isPowerOfTwo:function(){}});Object.defineProperty(Mi.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e}});Object.defineProperty(Mi.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e}});Mi.BYTE=me.BYTE;Mi.UNSIGNED_BYTE=me.UNSIGNED_BYTE;Mi.SHORT=me.SHORT;Mi.UNSIGNED_SHORT=me.UNSIGNED_SHORT;Mi.INT=me.INT;Mi.UNSIGNED_INT=me.UNSIGNED_INT;Mi.FLOAT=me.FLOAT;Mi.HALF_FLOAT=36193;Mi.UNSIGNED_INT_24_8_WEBGL=34042;Mi.DEPTH_COMPONENT=me.DEPTH_COMPONENT;Mi.DEPTH_STENCIL=me.DEPTH_STENCIL;Mi.ALPHA=me.ALPHA;Mi.RGB=me.RGB;Mi.RGBA=me.RGBA;Mi.LUMINANCE=me.LUMINANCE;Mi.LUMINANCE_ALPHA=me.LUMINANCE_ALPHA;Mi.SRGB=35904;Mi.SRGB_ALPHA=35906;Mi.COMPRESSED_RGB_S3TC_DXT1_EXT=33776;Mi.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777;Mi.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778;Mi.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779;Mi.NEAREST=me.NEAREST;Mi.LINEAR=me.LINEAR;Mi.NEAREST_MIPMAP_NEAREST=me.NEAREST_MIPMAP_NEAREST;Mi.LINEAR_MIPMAP_NEAREST=me.LINEAR_MIPMAP_NEAREST;Mi.NEAREST_MIPMAP_LINEAR=me.NEAREST_MIPMAP_LINEAR;Mi.LINEAR_MIPMAP_LINEAR=me.LINEAR_MIPMAP_LINEAR;Mi.REPEAT=me.REPEAT;Mi.CLAMP_TO_EDGE=me.CLAMP_TO_EDGE;Mi.MIRRORED_REPEAT=me.MIRRORED_REPEAT;var ot=Mi;var Ya=Kg.extend({skeleton:null,joints:null},function(){this.joints||(this.joints=[])},{offsetMatrix:null,isInstancedMesh:function(){return!1},isSkinnedMesh:function(){return!!(this.skeleton&&this.joints&&this.joints.length>0)},clone:function(){var e=Kg.prototype.clone.call(this);return e.skeleton=this.skeleton,this.joints&&(e.joints=this.joints.slice()),e}});Ya.POINTS=me.POINTS;Ya.LINES=me.LINES;Ya.LINE_LOOP=me.LINE_LOOP;Ya.LINE_STRIP=me.LINE_STRIP;Ya.TRIANGLES=me.TRIANGLES;Ya.TRIANGLE_STRIP=me.TRIANGLE_STRIP;Ya.TRIANGLE_FAN=me.TRIANGLE_FAN;Ya.BACK=me.BACK;Ya.FRONT=me.FRONT;Ya.FRONT_AND_BACK=me.FRONT_AND_BACK;Ya.CW=me.CW;Ya.CCW=me.CCW;var ul=Ya;var fy={};fy.isPowerOfTwo=function(e){return(e&e-1)===0};fy.nextPowerOfTwo=function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e};fy.nearestPowerOfTwo=function(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))};var my=fy;var gF=my.isPowerOfTwo;function vF(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))}function CJ(e,t){var i=vF(e.width),r=vF(e.height);t=t||document.createElement("canvas"),t.width=i,t.height=r;var n=t.getContext("2d");return n.drawImage(e.image,0,0,i,r),t}var QC=ot.extend(function(){return{image:null,pixels:null,mipmaps:[],convertToPOT:!1}},{textureType:"texture2D",update:function(e){var t=e.gl;t.bindTexture(t.TEXTURE_2D,this._cache.get("webgl_texture")),this.updateCommon(e);var i=this.format,r=this.type,n=!!(this.convertToPOT&&!this.mipmaps.length&&this.image&&(this.wrapS===ot.REPEAT||this.wrapT===ot.REPEAT)&&this.NPOT);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,n?this.wrapS:this.getAvailableWrapS()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,n?this.wrapT:this.getAvailableWrapT()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n?this.magFilter:this.getAvailableMagFilter()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n?this.minFilter:this.getAvailableMinFilter());var o=e.getGLExtension("EXT_texture_filter_anisotropic");if(o&&this.anisotropic>1&&t.texParameterf(t.TEXTURE_2D,o.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),r===36193){var a=e.getGLExtension("OES_texture_half_float");a||(r=me.FLOAT)}if(this.mipmaps.length)for(var s=this.width,c=this.height,l=0;l<this.mipmaps.length;l++){var d=this.mipmaps[l];this._updateTextureData(t,d,l,s,c,i,r,!1),s/=2,c/=2}else this._updateTextureData(t,this,0,this.width,this.height,i,r,n),this.useMipmap&&(!this.NPOT||n)&&t.generateMipmap(t.TEXTURE_2D);t.bindTexture(t.TEXTURE_2D,null)},_updateTextureData:function(e,t,i,r,n,o,a,s){if(t.image){var c=t.image;s&&(this._potCanvas=CJ(this,this._potCanvas),c=this._potCanvas),e.texImage2D(e.TEXTURE_2D,i,o,o,a,c)}else o<=ot.COMPRESSED_RGBA_S3TC_DXT5_EXT&&o>=ot.COMPRESSED_RGB_S3TC_DXT1_EXT?e.compressedTexImage2D(e.TEXTURE_2D,i,o,r,n,0,t.pixels):e.texImage2D(e.TEXTURE_2D,i,o,r,n,0,o,a,t.pixels)},generateMipmap:function(e){var t=e.gl;this.useMipmap&&!this.NPOT&&(t.bindTexture(t.TEXTURE_2D,this._cache.get("webgl_texture")),t.generateMipmap(t.TEXTURE_2D))},isPowerOfTwo:function(){return gF(this.width)&&gF(this.height)},isRenderable:function(){return this.image?this.image.width>0&&this.image.height>0:!!(this.width&&this.height)},bind:function(e){e.gl.bindTexture(e.gl.TEXTURE_2D,this.getWebGLTexture(e))},unbind:function(e){e.gl.bindTexture(e.gl.TEXTURE_2D,null)},load:function(e,t){var i=Yi.createImage();t&&(i.crossOrigin=t);var r=this;return i.onload=function(){r.dirty(),r.trigger("success",r)},i.onerror=function(){r.trigger("error",r)},i.src=e,this.image=i,this}});Object.defineProperty(QC.prototype,"width",{get:function(){return this.image?this.image.width:this._width},set:function(e){this.image?console.warn("Texture from image can't set width"):(this._width!==e&&this.dirty(),this._width=e)}});Object.defineProperty(QC.prototype,"height",{get:function(){return this.image?this.image.height:this._height},set:function(e){this.image?console.warn("Texture from image can't set height"):(this._height!==e&&this.dirty(),this._height=e)}});var wt=QC;function _F(e){return{byte:Yi.Int8Array,ubyte:Yi.Uint8Array,short:Yi.Int16Array,ushort:Yi.Uint16Array}[e]||Yi.Float32Array}function JC(e){return"attr_"+e}function sf(e,t,i,r){switch(this.name=e,this.type=t,this.size=i,this.semantic=r||"",this.value=null,i){case 1:this.get=function(n){return this.value[n]},this.set=function(n,o){this.value[n]=o},this.copy=function(n,o){this.value[n]=this.value[n]};break;case 2:this.get=function(n,o){var a=this.value;return o[0]=a[n*2],o[1]=a[n*2+1],o},this.set=function(n,o){var a=this.value;a[n*2]=o[0],a[n*2+1]=o[1]},this.copy=function(n,o){var a=this.value;o*=2,n*=2,a[n]=a[o],a[n+1]=a[o+1]};break;case 3:this.get=function(n,o){var a=n*3,s=this.value;return o[0]=s[a],o[1]=s[a+1],o[2]=s[a+2],o},this.set=function(n,o){var a=n*3,s=this.value;s[a]=o[0],s[a+1]=o[1],s[a+2]=o[2]},this.copy=function(n,o){var a=this.value;o*=3,n*=3,a[n]=a[o],a[n+1]=a[o+1],a[n+2]=a[o+2]};break;case 4:this.get=function(n,o){var a=this.value,s=n*4;return o[0]=a[s],o[1]=a[s+1],o[2]=a[s+2],o[3]=a[s+3],o},this.set=function(n,o){var a=this.value,s=n*4;a[s]=o[0],a[s+1]=o[1],a[s+2]=o[2],a[s+3]=o[3]},this.copy=function(n,o){var a=this.value;o*=4,n*=4,a[n]=a[o],a[n+1]=a[o+1],a[n+2]=a[o+2],a[n+3]=a[o+3]}}}sf.prototype.init=function(e){if(!this.value||this.value.length!==e*this.size){var t=_F(this.type);this.value=new t(e*this.size)}};sf.prototype.fromArray=function(e){var t=_F(this.type),i;if(e[0]&&e[0].length){var r=0,n=this.size;i=new t(e.length*n);for(var o=0;o<e.length;o++)for(var a=0;a<n;a++)i[r++]=e[o][a]}else i=new t(e);this.value=i};sf.prototype.clone=function(e){var t=new sf(this.name,this.type,this.size,this.semantic);return e&&console.warn("todo"),t};function bF(e,t,i,r,n){this.name=e,this.type=t,this.buffer=i,this.size=r,this.semantic=n,this.symbol="",this.needsRemove=!1}function yF(e){this.buffer=e,this.count=0}var _c=fr.extend(function(){return{attributes:{},indices:null,dynamic:!0,_enabledAttributes:null,__used:0}},function(){this._cache=new af,this._attributeList=Object.keys(this.attributes),this.__vaoCache={}},{mainAttribute:"",pick:null,pickByRay:null,dirty:function(){for(var e=this.getEnabledAttributes(),t=0;t<e.length;t++)this.dirtyAttribute(e[t]);this.dirtyIndices(),this._enabledAttributes=null,this._cache.dirty("any")},dirtyIndices:function(){this._cache.dirtyAll("indices")},dirtyAttribute:function(e){this._cache.dirtyAll(JC(e)),this._cache.dirtyAll("attributes")},getTriangleIndices:function(e,t){if(e<this.triangleCount&&e>=0){t||(t=[]);var i=this.indices;return t[0]=i[e*3],t[1]=i[e*3+1],t[2]=i[e*3+2],t}},setTriangleIndices:function(e,t){var i=this.indices;i[e*3]=t[0],i[e*3+1]=t[1],i[e*3+2]=t[2]},isUseIndices:function(){return!!this.indices},initIndicesFromArray:function(e){var t,i=this.vertexCount>65535?Yi.Uint32Array:Yi.Uint16Array;if(e[0]&&e[0].length){var r=0,n=3;t=new i(e.length*n);for(var o=0;o<e.length;o++)for(var a=0;a<n;a++)t[r++]=e[o][a]}else t=new i(e);this.indices=t},createAttribute:function(e,t,i,r){var n=new sf(e,t,i,r);return this.attributes[e]&&this.removeAttribute(e),this.attributes[e]=n,this._attributeList.push(e),n},removeAttribute:function(e){var t=this._attributeList,i=t.indexOf(e);return i>=0?(t.splice(i,1),delete this.attributes[e],!0):!1},getAttribute:function(e){return this.attributes[e]},getEnabledAttributes:function(){var e=this._enabledAttributes,t=this._attributeList;if(e)return e;for(var i=[],r=this.vertexCount,n=0;n<t.length;n++){var o=t[n],a=this.attributes[o];a.value&&a.value.length===r*a.size&&i.push(o)}return this._enabledAttributes=i,i},getBufferChunks:function(e){var t=this._cache;t.use(e.__uid__);var i=t.isDirty("attributes"),r=t.isDirty("indices");if(i||r){this._updateBuffer(e.gl,i,r);for(var n=this.getEnabledAttributes(),o=0;o<n.length;o++)t.fresh(JC(n[o]));t.fresh("attributes"),t.fresh("indices")}return t.fresh("any"),t.get("chunks")},_updateBuffer:function(e,t,i){var r=this._cache,n=r.get("chunks"),o=!1;n||(n=[],n[0]={attributeBuffers:[],indicesBuffer:null},r.put("chunks",n),o=!0);var a=n[0],s=a.attributeBuffers,c=a.indicesBuffer;if(t||o){var l=this.getEnabledAttributes(),d={};if(!o)for(var u=0;u<s.length;u++)d[s[u].name]=s[u];for(var h=0;h<l.length;h++){var p=l[h],m=this.attributes[p],f;o||(f=d[p]);var g;f?g=f.buffer:g=e.createBuffer(),r.isDirty(JC(p))&&(e.bindBuffer(e.ARRAY_BUFFER,g),e.bufferData(e.ARRAY_BUFFER,m.value,this.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW)),s[h]=new bF(p,m.type,g,m.size,m.semantic)}for(var u=h;u<s.length;u++)e.deleteBuffer(s[u].buffer);s.length=h}this.isUseIndices()&&(i||o)&&(c||(c=new yF(e.createBuffer()),a.indicesBuffer=c),c.count=this.indices.length,e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,c.buffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,this.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW))},dispose:function(e){var t=this._cache;t.use(e.__uid__);var i=t.get("chunks");if(i)for(var r=0;r<i.length;r++){for(var n=i[r],o=0;o<n.attributeBuffers.length;o++){var a=n.attributeBuffers[o];e.gl.deleteBuffer(a.buffer)}n.indicesBuffer&&e.gl.deleteBuffer(n.indicesBuffer.buffer)}if(this.__vaoCache){var s=e.getGLExtension("OES_vertex_array_object");for(var c in this.__vaoCache){var l=this.__vaoCache[c].vao;l&&s.deleteVertexArrayOES(l)}}this.__vaoCache={},t.deleteContext(e.__uid__)}});Object.defineProperty&&(Object.defineProperty(_c.prototype,"vertexCount",{enumerable:!1,get:function(){var e=this.attributes[this.mainAttribute];return e||(e=this.attributes[this._attributeList[0]]),!e||!e.value?0:e.value.length/e.size}}),Object.defineProperty(_c.prototype,"triangleCount",{enumerable:!1,get:function(){var e=this.indices;return e?e.length/3:0}}));_c.STATIC_DRAW=me.STATIC_DRAW;_c.DYNAMIC_DRAW=me.DYNAMIC_DRAW;_c.STREAM_DRAW=me.STREAM_DRAW;_c.AttributeBuffer=bF;_c.IndicesBuffer=yF;_c.Attribute=sf;var Cd=_c;var ea=J.create,lf=J.add,ah=J.set,Nl=Cd.Attribute,sh=Cd.extend(function(){return{attributes:{position:new Nl("position","float",3,"POSITION"),texcoord0:new Nl("texcoord0","float",2,"TEXCOORD_0"),texcoord1:new Nl("texcoord1","float",2,"TEXCOORD_1"),normal:new Nl("normal","float",3,"NORMAL"),tangent:new Nl("tangent","float",4,"TANGENT"),color:new Nl("color","float",4,"COLOR"),weight:new Nl("weight","float",3,"WEIGHT"),joint:new Nl("joint","float",4,"JOINT"),barycentric:new Nl("barycentric","float",3,null)},boundingBox:null}},{mainAttribute:"position",updateBoundingBox:function(){var e=this.boundingBox;e||(e=this.boundingBox=new Jr);var t=this.attributes.position.value;if(t&&t.length){var i=e.min,r=e.max,n=i.array,o=r.array;J.set(n,t[0],t[1],t[2]),J.set(o,t[0],t[1],t[2]);for(var a=3;a<t.length;){var s=t[a++],c=t[a++],l=t[a++];s<n[0]&&(n[0]=s),c<n[1]&&(n[1]=c),l<n[2]&&(n[2]=l),s>o[0]&&(o[0]=s),c>o[1]&&(o[1]=c),l>o[2]&&(o[2]=l)}i._dirty=!0,r._dirty=!0}},generateVertexNormals:function(){if(this.vertexCount){var e=this.indices,t=this.attributes,i=t.position.value,r=t.normal.value;if(!r||r.length!==i.length)r=t.normal.value=new Yi.Float32Array(i.length);else for(var n=0;n<r.length;n++)r[n]=0;for(var o=ea(),a=ea(),s=ea(),c=ea(),l=ea(),d=ea(),u=e?e.length:this.vertexCount,h,p,m,f=0;f<u;){e?(h=e[f++],p=e[f++],m=e[f++]):(h=f++,p=f++,m=f++),ah(o,i[h*3],i[h*3+1],i[h*3+2]),ah(a,i[p*3],i[p*3+1],i[p*3+2]),ah(s,i[m*3],i[m*3+1],i[m*3+2]),J.sub(c,o,a),J.sub(l,a,s),J.cross(d,c,l);for(var n=0;n<3;n++)r[h*3+n]=r[h*3+n]+d[n],r[p*3+n]=r[p*3+n]+d[n],r[m*3+n]=r[m*3+n]+d[n]}for(var n=0;n<r.length;)ah(d,r[n],r[n+1],r[n+2]),J.normalize(d,d),r[n++]=d[0],r[n++]=d[1],r[n++]=d[2];this.dirty()}},generateFaceNormals:function(){if(this.vertexCount){this.isUniqueVertex()||this.generateUniqueVertex();var e=this.indices,t=this.attributes,i=t.position.value,r=t.normal.value,n=ea(),o=ea(),a=ea(),s=ea(),c=ea(),l=ea();r||(r=t.normal.value=new Float32Array(i.length));for(var d=e?e.length:this.vertexCount,u,h,p,m=0;m<d;){e?(u=e[m++],h=e[m++],p=e[m++]):(u=m++,h=m++,p=m++),ah(n,i[u*3],i[u*3+1],i[u*3+2]),ah(o,i[h*3],i[h*3+1],i[h*3+2]),ah(a,i[p*3],i[p*3+1],i[p*3+2]),J.sub(s,n,o),J.sub(c,o,a),J.cross(l,s,c),J.normalize(l,l);for(var f=0;f<3;f++)r[u*3+f]=l[f],r[h*3+f]=l[f],r[p*3+f]=l[f]}this.dirty()}},generateTangents:function(){if(this.vertexCount){var e=this.vertexCount,t=this.attributes;t.tangent.value||(t.tangent.value=new Float32Array(e*4));var i=t.texcoord0.value,r=t.position.value,n=t.tangent.value,o=t.normal.value;if(!i){console.warn("Geometry without texcoords can't generate tangents.");return}for(var a=[],s=[],c=0;c<e;c++)a[c]=[0,0,0],s[c]=[0,0,0];for(var l=[0,0,0],d=[0,0,0],u=this.indices,h=u?u.length:this.vertexCount,p,m,f,c=0;c<h;){u?(p=u[c++],m=u[c++],f=u[c++]):(p=c++,m=c++,f=c++);var g=i[p*2],v=i[m*2],_=i[f*2],b=i[p*2+1],y=i[m*2+1],x=i[f*2+1],w=r[p*3],I=r[m*3],S=r[f*3],E=r[p*3+1],N=r[m*3+1],M=r[f*3+1],P=r[p*3+2],$=r[m*3+2],R=r[f*3+2],j=I-w,B=S-w,te=N-E,Z=M-E,ne=$-P,se=R-P,we=v-g,ie=_-g,ue=y-b,Ee=x-b,ye=1/(we*Ee-ue*ie);l[0]=(Ee*j-ue*B)*ye,l[1]=(Ee*te-ue*Z)*ye,l[2]=(Ee*ne-ue*se)*ye,d[0]=(we*B-ie*j)*ye,d[1]=(we*Z-ie*te)*ye,d[2]=(we*se-ie*ne)*ye,lf(a[p],a[p],l),lf(a[m],a[m],l),lf(a[f],a[f],l),lf(s[p],s[p],d),lf(s[m],s[m],d),lf(s[f],s[f],d)}for(var Te=ea(),pe=ea(),be=ea(),c=0;c<e;c++){be[0]=o[c*3],be[1]=o[c*3+1],be[2]=o[c*3+2];var De=a[c];J.scale(Te,be,J.dot(be,De)),J.sub(Te,De,Te),J.normalize(Te,Te),J.cross(pe,be,De),n[c*4]=Te[0],n[c*4+1]=Te[1],n[c*4+2]=Te[2],n[c*4+3]=J.dot(pe,s[c])<0?-1:1}this.dirty()}},isUniqueVertex:function(){return this.isUseIndices()?this.vertexCount===this.indices.length:!0},generateUniqueVertex:function(){if(!(!this.vertexCount||!this.indices)){this.indices.length>65535&&(this.indices=new Yi.Uint32Array(this.indices));for(var e=this.attributes,t=this.indices,i=this.getEnabledAttributes(),r={},n=0;n<i.length;n++){var o=i[n];r[o]=e[o].value,e[o].init(this.indices.length)}for(var a=0,s=0;s<t.length;s++){for(var c=t[s],n=0;n<i.length;n++)for(var o=i[n],l=e[o].value,d=e[o].size,u=0;u<d;u++)l[a*d+u]=r[o][c*d+u];t[s]=a,a++}this.dirty()}},generateBarycentric:function(){if(this.vertexCount){this.isUniqueVertex()||this.generateUniqueVertex();var e=this.attributes,t=e.barycentric.value,i=this.indices;if(!(t&&t.length===i.length*3)){t=e.barycentric.value=new Float32Array(i.length*3);for(var r=0;r<(i?i.length:this.vertexCount/3);)for(var n=0;n<3;n++){var o=i?i[r++]:r*3+n;t[o*3+n]=1}this.dirty()}}},applyTransform:function(e){var t=this.attributes,i=t.position.value,r=t.normal.value,n=t.tangent.value;e=e.array;var o=Ge.create();Ge.invert(o,e),Ge.transpose(o,o);var a=J.transformMat4,s=J.forEach;s(i,3,0,null,a,e),r&&s(r,3,0,null,a,o),n&&s(n,4,0,null,a,o),this.boundingBox&&this.updateBoundingBox()},dispose:function(e){var t=this._cache;t.use(e.__uid__);var i=t.get("chunks");if(i)for(var r=0;r<i.length;r++){for(var n=i[r],o=0;o<n.attributeBuffers.length;o++){var a=n.attributeBuffers[o];e.gl.deleteBuffer(a.buffer)}n.indicesBuffer&&e.gl.deleteBuffer(n.indicesBuffer.buffer)}if(this.__vaoCache){var s=e.getGLExtension("OES_vertex_array_object");for(var c in this.__vaoCache){var l=this.__vaoCache[c].vao;l&&s.deleteVertexArrayOES(l)}}this.__vaoCache={},t.deleteContext(e.__uid__)}});sh.STATIC_DRAW=Cd.STATIC_DRAW;sh.DYNAMIC_DRAW=Cd.DYNAMIC_DRAW;sh.STREAM_DRAW=Cd.STREAM_DRAW;sh.AttributeBuffer=Cd.AttributeBuffer;sh.IndicesBuffer=Cd.IndicesBuffer;sh.Attribute=Nl;var Jt=sh;var xF=`vec3 calcAmbientSHLight(int idx, vec3 N) {
 int offset = 9 * idx;
 return ambientSHLightCoefficients[0]
 + ambientSHLightCoefficients[1] * N.x
 + ambientSHLightCoefficients[2] * N.y
 + ambientSHLightCoefficients[3] * N.z
 + ambientSHLightCoefficients[4] * N.x * N.z
 + ambientSHLightCoefficients[5] * N.z * N.y
 + ambientSHLightCoefficients[6] * N.y * N.x
 + ambientSHLightCoefficients[7] * (3.0 * N.z * N.z - 1.0)
 + ambientSHLightCoefficients[8] * (N.x * N.x - N.y * N.y);
}`;var hl="uniform vec3 ",Jg="uniform float ",cf="@export clay.header.",df="@end",Zn=":unconfigurable;",wF=[cf+"directional_light",hl+"directionalLightDirection[DIRECTIONAL_LIGHT_COUNT]"+Zn,hl+"directionalLightColor[DIRECTIONAL_LIGHT_COUNT]"+Zn,df,cf+"ambient_light",hl+"ambientLightColor[AMBIENT_LIGHT_COUNT]"+Zn,df,cf+"ambient_sh_light",hl+"ambientSHLightColor[AMBIENT_SH_LIGHT_COUNT]"+Zn,hl+"ambientSHLightCoefficients[AMBIENT_SH_LIGHT_COUNT * 9]"+Zn,xF,df,cf+"ambient_cubemap_light",hl+"ambientCubemapLightColor[AMBIENT_CUBEMAP_LIGHT_COUNT]"+Zn,"uniform samplerCube ambientCubemapLightCubemap[AMBIENT_CUBEMAP_LIGHT_COUNT]"+Zn,"uniform sampler2D ambientCubemapLightBRDFLookup[AMBIENT_CUBEMAP_LIGHT_COUNT]"+Zn,df,cf+"point_light",hl+"pointLightPosition[POINT_LIGHT_COUNT]"+Zn,Jg+"pointLightRange[POINT_LIGHT_COUNT]"+Zn,hl+"pointLightColor[POINT_LIGHT_COUNT]"+Zn,df,cf+"spot_light",hl+"spotLightPosition[SPOT_LIGHT_COUNT]"+Zn,hl+"spotLightDirection[SPOT_LIGHT_COUNT]"+Zn,Jg+"spotLightRange[SPOT_LIGHT_COUNT]"+Zn,Jg+"spotLightUmbraAngleCosine[SPOT_LIGHT_COUNT]"+Zn,Jg+"spotLightPenumbraAngleCosine[SPOT_LIGHT_COUNT]"+Zn,Jg+"spotLightFalloffFactor[SPOT_LIGHT_COUNT]"+Zn,hl+"spotLightColor[SPOT_LIGHT_COUNT]"+Zn,df].join(`
`);qe.import(wF);var SJ=Jo.extend(function(){return{color:[1,1,1],intensity:1,castShadow:!0,shadowResolution:512,group:0}},{type:"",clone:function(){var e=Jo.prototype.clone.call(this);return e.color=Array.prototype.slice.call(this.color),e.intensity=this.intensity,e.castShadow=this.castShadow,e.shadowResolution=this.shadowResolution,e}}),Kn=SJ;var gy=function(e,t){this.normal=e||new Fe(0,1,0),this.distance=t||0};gy.prototype={constructor:gy,distanceToPoint:function(e){return J.dot(e.array,this.normal.array)-this.distance},projectPoint:function(e,t){t||(t=new Fe);var i=this.distanceToPoint(e);return J.scaleAndAdd(t.array,e.array,this.normal.array,-i),t._dirty=!0,t},normalize:function(){var e=1/J.len(this.normal.array);J.scale(this.normal.array,e),this.distance*=e},intersectFrustum:function(e){for(var t=e.vertices,i=this.normal.array,r=J.dot(t[0].array,i)>this.distance,n=1;n<8;n++)if(J.dot(t[n].array,i)>this.distance!=r)return!0},intersectLine:function(){var e=J.create();return function(t,i,r){var n=this.distanceToPoint(t),o=this.distanceToPoint(i);if(n>0&&o>0||n<0&&o<0)return null;var a=this.normal.array,s=this.distance,c=t.array;J.sub(e,i.array,t.array),J.normalize(e,e);var l=J.dot(a,e);if(l===0)return null;r||(r=new Fe);var d=(J.dot(a,c)-s)/l;return J.scaleAndAdd(r.array,c,e,-d),r._dirty=!0,r}}(),applyTransform:function(){var e=Ge.create(),t=nt.create(),i=nt.create();return i[3]=1,function(r){r=r.array,J.scale(i,this.normal.array,this.distance),nt.transformMat4(i,i,r),this.distance=J.dot(i,this.normal.array),Ge.invert(e,r),Ge.transpose(e,e),t[3]=0,J.copy(t,this.normal.array),nt.transformMat4(t,t,e),J.copy(this.normal.array,t)}}(),copy:function(e){J.copy(this.normal.array,e.normal.array),this.normal._dirty=!0,this.distance=e.distance},clone:function(){var e=new gy;return e.copy(this),e}};var vy=gy;var vn=J.set,EF=J.copy,CF=J.transformMat4,eS=Math.min,tS=Math.max,SF=function(){this.planes=[];for(var e=0;e<6;e++)this.planes.push(new vy);this.boundingBox=new Jr,this.vertices=[];for(var e=0;e<8;e++)this.vertices[e]=J.fromValues(0,0,0)};SF.prototype={setFromProjection:function(e){var t=this.planes,i=e.array,r=i[0],n=i[1],o=i[2],a=i[3],s=i[4],c=i[5],l=i[6],d=i[7],u=i[8],h=i[9],p=i[10],m=i[11],f=i[12],g=i[13],v=i[14],_=i[15];vn(t[0].normal.array,a-r,d-s,m-u),t[0].distance=-(_-f),t[0].normalize(),vn(t[1].normal.array,a+r,d+s,m+u),t[1].distance=-(_+f),t[1].normalize(),vn(t[2].normal.array,a+n,d+c,m+h),t[2].distance=-(_+g),t[2].normalize(),vn(t[3].normal.array,a-n,d-c,m-h),t[3].distance=-(_-g),t[3].normalize(),vn(t[4].normal.array,a-o,d-l,m-p),t[4].distance=-(_-v),t[4].normalize(),vn(t[5].normal.array,a+o,d+l,m+p),t[5].distance=-(_+v),t[5].normalize();var b=this.boundingBox,y=this.vertices;if(_===0){var x=c/r,w=-v/(p-1),I=-v/(p+1),S=-I/c,E=-w/c;b.min.set(-S*x,-S,I),b.max.set(S*x,S,w),vn(y[0],-S*x,-S,I),vn(y[1],-S*x,S,I),vn(y[2],S*x,-S,I),vn(y[3],S*x,S,I),vn(y[4],-E*x,-E,w),vn(y[5],-E*x,E,w),vn(y[6],E*x,-E,w),vn(y[7],E*x,E,w)}else{var N=(-1-f)/r,M=(1-f)/r,P=(1-g)/c,$=(-1-g)/c,R=(-1-v)/p,j=(1-v)/p;b.min.set(Math.min(N,M),Math.min($,P),Math.min(j,R)),b.max.set(Math.max(M,N),Math.max(P,$),Math.max(R,j));var B=b.min.array,te=b.max.array;vn(y[0],B[0],B[1],B[2]),vn(y[1],B[0],te[1],B[2]),vn(y[2],te[0],B[1],B[2]),vn(y[3],te[0],te[1],B[2]),vn(y[4],B[0],B[1],te[2]),vn(y[5],B[0],te[1],te[2]),vn(y[6],te[0],B[1],te[2]),vn(y[7],te[0],te[1],te[2])}},getTransformedBoundingBox:function(){var e=J.create();return function(t,i){var r=this.vertices,n=i.array,o=t.min,a=t.max,s=o.array,c=a.array,l=r[0];CF(e,l,n),EF(s,e),EF(c,e);for(var d=1;d<8;d++)l=r[d],CF(e,l,n),s[0]=eS(e[0],s[0]),s[1]=eS(e[1],s[1]),s[2]=eS(e[2],s[2]),c[0]=tS(e[0],c[0]),c[1]=tS(e[1],c[1]),c[2]=tS(e[2],c[2]);return o._dirty=!0,a._dirty=!0,t}}()};var uf=SF;var TJ=Jo.extend(function(){return{projectionMatrix:new ct,invProjectionMatrix:new ct,viewMatrix:new ct,frustum:new uf}},function(){this.update(!0)},{update:function(e){Jo.prototype.update.call(this,e),ct.invert(this.viewMatrix,this.worldTransform),this.updateProjectionMatrix(),ct.invert(this.invProjectionMatrix,this.projectionMatrix),this.frustum.setFromProjection(this.projectionMatrix)},setViewMatrix:function(e){ct.copy(this.viewMatrix,e),ct.invert(this.worldTransform,e),this.decomposeWorldTransform()},decomposeProjectionMatrix:function(){},setProjectionMatrix:function(e){ct.copy(this.projectionMatrix,e),ct.invert(this.invProjectionMatrix,e),this.decomposeProjectionMatrix()},updateProjectionMatrix:function(){},castRay:function(){var e=nt.create();return function(t,i){var r=i!==void 0?i:new oh,n=t.array[0],o=t.array[1];return nt.set(e,n,o,-1,1),nt.transformMat4(e,e,this.invProjectionMatrix.array),nt.transformMat4(e,e,this.worldTransform.array),J.scale(r.origin.array,e,1/e[3]),nt.set(e,n,o,1,1),nt.transformMat4(e,e,this.invProjectionMatrix.array),nt.transformMat4(e,e,this.worldTransform.array),J.scale(e,e,1/e[3]),J.sub(r.direction.array,e,r.origin.array),J.normalize(r.direction.array,r.direction.array),r.direction._dirty=!0,r.origin._dirty=!0,r}}()}),bc=TJ;var AJ=Ge.create(),TF=Ge.create(),iS={};function DJ(e){var t=[],i=Object.keys(e);i.sort();for(var r=0;r<i.length;r++){var n=i[r];t.push(n+" "+e[n])}var o=t.join(`
`);if(iS[o])return iS[o];var a=Wr.genGUID();return iS[o]=a,a}function _y(){this.opaque=[],this.transparent=[],this._opaqueCount=0,this._transparentCount=0}_y.prototype.startCount=function(){this._opaqueCount=0,this._transparentCount=0};_y.prototype.add=function(e,t){t?this.transparent[this._transparentCount++]=e:this.opaque[this._opaqueCount++]=e};_y.prototype.endCount=function(){this.transparent.length=this._transparentCount,this.opaque.length=this._opaqueCount};var IJ=Jo.extend(function(){return{material:null,lights:[],viewBoundingBoxLastFrame:new Jr,shadowUniforms:{},_cameraList:[],_lightUniforms:{},_previousLightNumber:{},_lightNumber:{},_lightProgramKeys:{},_nodeRepository:{},_renderLists:new iy(20)}},function(){this._scene=this},{addToScene:function(e){e instanceof bc?(this._cameraList.length>0&&console.warn("Found multiple camera in one scene. Use the fist one."),this._cameraList.push(e)):e instanceof Kn&&this.lights.push(e),e.name&&(this._nodeRepository[e.name]=e)},removeFromScene:function(e){var t;e instanceof bc?(t=this._cameraList.indexOf(e),t>=0&&this._cameraList.splice(t,1)):e instanceof Kn&&(t=this.lights.indexOf(e),t>=0&&this.lights.splice(t,1)),e.name&&delete this._nodeRepository[e.name]},getNode:function(e){return this._nodeRepository[e]},setMainCamera:function(e){var t=this._cameraList.indexOf(e);t>=0&&this._cameraList.splice(t,1),this._cameraList.unshift(e)},getMainCamera:function(){return this._cameraList[0]},getLights:function(){return this.lights},updateLights:function(){var e=this.lights;this._previousLightNumber=this._lightNumber;for(var t={},i=0;i<e.length;i++){var r=e[i];if(!r.invisible){var n=r.group;t[n]||(t[n]={}),t[n][r.type]=t[n][r.type]||0,t[n][r.type]++}}this._lightNumber=t;for(var o in t)this._lightProgramKeys[o]=DJ(t[o]);this._updateLightUniforms()},cloneNode:function(e){var t=e.clone(),i={};function r(n,o){i[n.__uid__]=o;for(var a=0;a<n._children.length;a++){var s=n._children[a],c=o._children[a];r(s,c)}}return r(e,t),t.traverse(function(n){n.skeleton&&(n.skeleton=n.skeleton.clone(i)),n.material&&(n.material=n.material.clone())}),t},updateRenderList:function(e,t){var i=e.__uid__,r=this._renderLists.get(i);r||(r=new _y,this._renderLists.put(i,r)),r.startCount(),t&&(this.viewBoundingBoxLastFrame.min.set(1/0,1/0,1/0),this.viewBoundingBoxLastFrame.max.set(-1/0,-1/0,-1/0));var n=this.material&&this.material.transparent||!1;return this._doUpdateRenderList(this,e,n,r,t),r.endCount(),r},getRenderList:function(e){return this._renderLists.get(e.__uid__)},_doUpdateRenderList:function(e,t,i,r,n){if(!e.invisible)for(var o=0;o<e._children.length;o++){var a=e._children[o];if(a.isRenderable()){var s=a.isSkinnedMesh()?AJ:a.worldTransform.array,c=a.geometry;Ge.multiplyAffine(TF,t.viewMatrix.array,s),(n&&!c.boundingBox||!this.isFrustumCulled(a,t,TF))&&r.add(a,a.material.transparent||i)}a._children.length>0&&this._doUpdateRenderList(a,t,i,r,n)}},isFrustumCulled:function(){var e=new Jr,t=new ct;return function(i,r,n){var o=i.boundingBox;if(o||(i.skeleton&&i.skeleton.boundingBox?o=i.skeleton.boundingBox:o=i.geometry.boundingBox),!o)return!1;if(t.array=n,e.transformFrom(o,t),i.castShadow&&this.viewBoundingBoxLastFrame.union(e),i.frustumCulling){if(!e.intersectBoundingBox(r.frustum.boundingBox))return!0;t.array=r.projectionMatrix.array,e.max.array[2]>0&&e.min.array[2]<0&&(e.max.array[2]=-1e-20),e.applyProjection(t);var a=e.min.array,s=e.max.array;if(s[0]<-1||a[0]>1||s[1]<-1||a[1]>1||s[2]<-1||a[2]>1)return!0}return!1}}(),_updateLightUniforms:function(){var e=this.lights;e.sort(MJ);var t=this._lightUniforms;for(var i in t)for(var r in t[i])t[i][r].value.length=0;for(var n=0;n<e.length;n++){var o=e[n];if(!o.invisible){var i=o.group;for(var r in o.uniformTemplates){var a=o.uniformTemplates[r],s=a.value(o);if(s!=null){t[i]||(t[i]={}),t[i][r]||(t[i][r]={type:"",value:[]});var c=t[i][r];switch(c.type=a.type+"v",a.type){case"1i":case"1f":case"t":c.value.push(s);break;case"2f":case"3f":case"4f":for(var l=0;l<s.length;l++)c.value.push(s[l]);break;default:console.error("Unkown light uniform type "+a.type)}}}}}},getLightGroups:function(){var e=[];for(var t in this._lightNumber)e.push(t);return e},getNumberChangedLightGroups:function(){var e=[];for(var t in this._lightNumber)this.isLightNumberChanged(t)&&e.push(t);return e},isLightNumberChanged:function(e){var t=this._previousLightNumber,i=this._lightNumber;for(var r in i[e])if(!t[e]||i[e][r]!==t[e][r])return!0;for(var r in t[e])if(!i[e]||i[e][r]!==t[e][r])return!0;return!1},getLightsNumbers:function(e){return this._lightNumber[e]},getProgramKey:function(e){return this._lightProgramKeys[e]},setLightUniforms:function(){function e(t,i,r){for(var n in t){var o=t[n];if(o.type==="tv"){if(!i.hasUniform(n))continue;for(var a=[],s=0;s<o.value.length;s++){var c=o.value[s],l=i.takeCurrentTextureSlot(r,c);a.push(l)}i.setUniform(r.gl,"1iv",n,a)}else i.setUniform(r.gl,o.type,n,o.value)}}return function(t,i,r){e(this._lightUniforms[i],t,r),e(this.shadowUniforms,t,r)}}(),dispose:function(){this.material=null,this._opaqueList=[],this._transparentList=[],this.lights=[],this._lightUniforms={},this._lightNumber={},this._nodeRepository={}}});function MJ(e,t){if(t.castShadow&&!e.castShadow)return!0}var Za=IJ;var AF=function(){function e(t){this.value=t}return e}();var kJ=function(){function e(){this._len=0}return e.prototype.insert=function(t){var i=new AF(t);return this.insertEntry(i),i},e.prototype.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},e.prototype.remove=function(t){var i=t.prev,r=t.next;i?i.next=r:this.head=r,r?r.prev=i:this.tail=i,t.next=t.prev=null,this._len--},e.prototype.len=function(){return this._len},e.prototype.clear=function(){this.head=this.tail=null,this._len=0},e}();var PJ=function(){function e(t){this._list=new kJ,this._maxSize=10,this._map={},this._maxSize=t}return e.prototype.put=function(t,i){var r=this._list,n=this._map,o=null;if(n[t]==null){var a=r.len(),s=this._lastRemovedEntry;if(a>=this._maxSize&&a>0){var c=r.head;r.remove(c),delete n[c.key],o=c.value,this._lastRemovedEntry=c}s?s.value=i:s=new AF(i),s.key=t,r.insertEntry(s),n[t]=s}return o},e.prototype.get=function(t){var i=this._map[t],r=this._list;if(i!=null)return i!==r.tail&&(r.remove(i),r.insertEntry(i)),i.value},e.prototype.clear=function(){this._list.clear(),this._map={}},e.prototype.len=function(){return this._list.len()},e}(),by=PJ;var yy=my.isPowerOfTwo,NJ=["px","nx","py","ny","pz","nz"],rS=ot.extend(function(){return{image:{px:null,nx:null,py:null,ny:null,pz:null,nz:null},pixels:{px:null,nx:null,py:null,ny:null,pz:null,nz:null},mipmaps:[]}},{textureType:"textureCube",update:function(e){var t=e.gl;t.bindTexture(t.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),this.updateCommon(e);var i=this.format,r=this.type;t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,this.getAvailableWrapS()),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,this.getAvailableWrapT()),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,this.getAvailableMagFilter()),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,this.getAvailableMinFilter());var n=e.getGLExtension("EXT_texture_filter_anisotropic");if(n&&this.anisotropic>1&&t.texParameterf(t.TEXTURE_CUBE_MAP,n.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),r===36193){var o=e.getGLExtension("OES_texture_half_float");o||(r=me.FLOAT)}if(this.mipmaps.length)for(var a=this.width,s=this.height,c=0;c<this.mipmaps.length;c++){var l=this.mipmaps[c];this._updateTextureData(t,l,c,a,s,i,r),a/=2,s/=2}else this._updateTextureData(t,this,0,this.width,this.height,i,r),!this.NPOT&&this.useMipmap&&t.generateMipmap(t.TEXTURE_CUBE_MAP);t.bindTexture(t.TEXTURE_CUBE_MAP,null)},_updateTextureData:function(e,t,i,r,n,o,a){for(var s=0;s<6;s++){var c=NJ[s],l=t.image&&t.image[c];l?e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,i,o,o,a,l):e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,i,o,r,n,0,o,a,t.pixels&&t.pixels[c])}},generateMipmap:function(e){var t=e.gl;this.useMipmap&&!this.NPOT&&(t.bindTexture(t.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),t.generateMipmap(t.TEXTURE_CUBE_MAP))},bind:function(e){e.gl.bindTexture(e.gl.TEXTURE_CUBE_MAP,this.getWebGLTexture(e))},unbind:function(e){e.gl.bindTexture(e.gl.TEXTURE_CUBE_MAP,null)},isPowerOfTwo:function(){return this.image.px?yy(this.image.px.width)&&yy(this.image.px.height):yy(this.width)&&yy(this.height)},isRenderable:function(){return this.image.px?hf(this.image.px)&&hf(this.image.nx)&&hf(this.image.py)&&hf(this.image.ny)&&hf(this.image.pz)&&hf(this.image.nz):!!(this.width&&this.height)},load:function(e,t){var i=0,r=this;return Wr.each(e,function(n,o){var a=Yi.createImage();t&&(a.crossOrigin=t),a.onload=function(){i--,i===0&&(r.dirty(),r.trigger("success",r))},a.onerror=function(){i--},i++,a.src=n,r.image[o]=a}),this}});Object.defineProperty(rS.prototype,"width",{get:function(){return this.image&&this.image.px?this.image.px.width:this._width},set:function(e){this.image&&this.image.px?console.warn("Texture from image can't set width"):(this._width!==e&&this.dirty(),this._width=e)}});Object.defineProperty(rS.prototype,"height",{get:function(){return this.image&&this.image.px?this.image.px.height:this._height},set:function(e){this.image&&this.image.px?console.warn("Texture from image can't set height"):(this._height!==e&&this.dirty(),this._height=e)}});function hf(e){return e.width>0&&e.height>0}var yc=rS;var OJ=bc.extend({fov:50,aspect:1,near:.1,far:2e3},{updateProjectionMatrix:function(){var e=this.fov/180*Math.PI;this.projectionMatrix.perspective(e,this.aspect,this.near,this.far)},decomposeProjectionMatrix:function(){var e=this.projectionMatrix.array,t=Math.atan(1/e[5])*2;this.fov=t/Math.PI*180,this.aspect=e[5]/e[0],this.near=e[14]/(e[10]-1),this.far=e[14]/(e[10]+1)},clone:function(){var e=bc.prototype.clone.call(this);return e.fov=this.fov,e.aspect=this.aspect,e.near=this.near,e.far=this.far,e}}),en=OJ;var xy="framebuffer",xc="renderbuffer",DF=xc+"_width",IF=xc+"_height",nS=xc+"_attached",oS="depthtexture_attached",lh=me.FRAMEBUFFER,ev=me.RENDERBUFFER,tv=me.DEPTH_ATTACHMENT,MF=me.COLOR_ATTACHMENT0,iv=fr.extend({depthBuffer:!0,viewport:null,_width:0,_height:0,_textures:null,_boundRenderer:null},function(){this._cache=new af,this._textures={}},{getTextureWidth:function(){return this._width},getTextureHeight:function(){return this._height},bind:function(e){if(e.__currentFrameBuffer){if(e.__currentFrameBuffer===this)return;console.warn("Renderer already bound with another framebuffer. Unbind it first")}e.__currentFrameBuffer=this;var t=e.gl;t.bindFramebuffer(lh,this._getFrameBufferGL(e)),this._boundRenderer=e;var i=this._cache;i.put("viewport",e.viewport);var r=!1,n,o;for(var a in this._textures){r=!0;var s=this._textures[a];s&&(n=s.texture.width,o=s.texture.height,this._doAttach(e,s.texture,a,s.target))}this._width=n,this._height=o,!r&&this.depthBuffer&&console.error("Must attach texture before bind, or renderbuffer may have incorrect width and height."),this.viewport?e.setViewport(this.viewport):e.setViewport(0,0,n,o,1);var c=i.get("attached_textures");if(c){for(var a in c)if(!this._textures[a]){var l=c[a];this._doDetach(t,a,l)}}if(!i.get(oS)&&this.depthBuffer){i.miss(xc)&&i.put(xc,t.createRenderbuffer());var d=i.get(xc);(n!==i.get(DF)||o!==i.get(IF))&&(t.bindRenderbuffer(ev,d),t.renderbufferStorage(ev,t.DEPTH_COMPONENT16,n,o),i.put(DF,n),i.put(IF,o),t.bindRenderbuffer(ev,null)),i.get(nS)||(t.framebufferRenderbuffer(lh,tv,ev,d),i.put(nS,!0))}},unbind:function(e){e.__currentFrameBuffer=null;var t=e.gl;t.bindFramebuffer(lh,null),this._boundRenderer=null,this._cache.use(e.__uid__);var i=this._cache.get("viewport");i&&e.setViewport(i),this.updateMipmap(e)},updateMipmap:function(e){var t=e.gl;for(var i in this._textures){var r=this._textures[i];if(r){var n=r.texture;if(!n.NPOT&&n.useMipmap&&n.minFilter===ot.LINEAR_MIPMAP_LINEAR){var o=n.textureType==="textureCube"?me.TEXTURE_CUBE_MAP:me.TEXTURE_2D;t.bindTexture(o,n.getWebGLTexture(e)),t.generateMipmap(o),t.bindTexture(o,null)}}}},checkStatus:function(e){return e.checkFramebufferStatus(lh)},_getFrameBufferGL:function(e){var t=this._cache;return t.use(e.__uid__),t.miss(xy)&&t.put(xy,e.gl.createFramebuffer()),t.get(xy)},attach:function(e,t,i){if(!e.width)throw new Error("The texture attached to color buffer is not a valid.");t=t||MF,i=i||me.TEXTURE_2D;var r=this._boundRenderer,n=r&&r.gl,o;if(n){var a=this._cache;a.use(r.__uid__),o=a.get("attached_textures")}var s=this._textures[t];if(!(s&&s.target===i&&s.texture===e&&o&&o[t]!=null)){var c=!0;r&&(c=this._doAttach(r,e,t,i),this.viewport||r.setViewport(0,0,e.width,e.height,1)),c&&(this._textures[t]=this._textures[t]||{},this._textures[t].texture=e,this._textures[t].target=i)}},_doAttach:function(e,t,i,r){var n=e.gl,o=t.getWebGLTexture(e),a=this._cache.get("attached_textures");if(a&&a[i]){var s=a[i];if(s.texture===t&&s.target===r)return}i=+i;var c=!0;if(i===tv||i===me.DEPTH_STENCIL_ATTACHMENT){var l=e.getGLExtension("WEBGL_depth_texture");if(l||(console.error("Depth texture is not supported by the browser"),c=!1),t.format!==me.DEPTH_COMPONENT&&t.format!==me.DEPTH_STENCIL&&(console.error("The texture attached to depth buffer is not a valid."),c=!1),c){var d=this._cache.get(xc);d&&(n.framebufferRenderbuffer(lh,tv,ev,null),n.deleteRenderbuffer(d),this._cache.put(xc,!1)),this._cache.put(nS,!1),this._cache.put(oS,!0)}}return n.framebufferTexture2D(lh,i,r,o,0),a||(a={},this._cache.put("attached_textures",a)),a[i]=a[i]||{},a[i].texture=t,a[i].target=r,c},_doDetach:function(e,t,i){e.framebufferTexture2D(lh,t,i,null,0);var r=this._cache.get("attached_textures");r&&r[t]&&(r[t]=null),(t===tv||t===me.DEPTH_STENCIL_ATTACHMENT)&&this._cache.put(oS,!1)},detach:function(e,t){if(this._textures[e]=null,this._boundRenderer){var i=this._cache;i.use(this._boundRenderer.__uid__),this._doDetach(this._boundRenderer.gl,e,t)}},dispose:function(e){var t=e.gl,i=this._cache;i.use(e.__uid__);var r=i.get(xc);r&&t.deleteRenderbuffer(r);var n=i.get(xy);n&&t.deleteFramebuffer(n),i.deleteContext(e.__uid__),this._textures={}}});iv.DEPTH_ATTACHMENT=tv;iv.COLOR_ATTACHMENT0=MF;iv.STENCIL_ATTACHMENT=me.STENCIL_ATTACHMENT;iv.DEPTH_STENCIL_ATTACHMENT=me.DEPTH_STENCIL_ATTACHMENT;var tr=iv;var RJ=["px","nx","py","ny","pz","nz"],FJ=fr.extend(function(){var e={position:new Fe,far:1e3,near:.1,texture:null,shadowMapPass:null},t=e._cameras={px:new en({fov:90}),nx:new en({fov:90}),py:new en({fov:90}),ny:new en({fov:90}),pz:new en({fov:90}),nz:new en({fov:90})};return t.px.lookAt(Fe.POSITIVE_X,Fe.NEGATIVE_Y),t.nx.lookAt(Fe.NEGATIVE_X,Fe.NEGATIVE_Y),t.py.lookAt(Fe.POSITIVE_Y,Fe.POSITIVE_Z),t.ny.lookAt(Fe.NEGATIVE_Y,Fe.NEGATIVE_Z),t.pz.lookAt(Fe.POSITIVE_Z,Fe.NEGATIVE_Y),t.nz.lookAt(Fe.NEGATIVE_Z,Fe.NEGATIVE_Y),e._frameBuffer=new tr,e},{getCamera:function(e){return this._cameras[e]},render:function(e,t,i){var r=e.gl;i||t.update();for(var n=this.texture.width,o=2*Math.atan(n/(n-.5))/Math.PI*180,a=0;a<6;a++){var s=RJ[a],c=this._cameras[s];if(Fe.copy(c.position,this.position),c.far=this.far,c.near=this.near,c.fov=o,this.shadowMapPass){c.update();var l=t.getBoundingBox();l.applyTransform(c.viewMatrix),t.viewBoundingBoxLastFrame.copy(l),this.shadowMapPass.render(e,t,c,!0)}this._frameBuffer.attach(this.texture,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+a),this._frameBuffer.bind(e),e.render(t,c,!0),this._frameBuffer.unbind(e)}},dispose:function(e){this._frameBuffer.dispose(e)}}),pf=FJ;var LJ=Jt.extend({dynamic:!1,widthSegments:1,heightSegments:1},function(){this.build()},{build:function(){for(var e=this.heightSegments,t=this.widthSegments,i=this.attributes,r=[],n=[],o=[],a=[],s=0;s<=e;s++)for(var c=s/e,l=0;l<=t;l++){var d=l/t;if(r.push([2*d-1,2*c-1,0]),n&&n.push([d,c]),o&&o.push([0,0,1]),l<t&&s<e){var u=l+s*(t+1);a.push([u,u+1,u+t+1]),a.push([u+t+1,u+1,u+t+2])}}i.position.fromArray(r),i.texcoord0.fromArray(n),i.normal.fromArray(o),this.initIndicesFromArray(a),this.boundingBox=new Jr,this.boundingBox.min.set(-1,-1,0),this.boundingBox.max.set(1,1,0)}}),Sd=LJ;var tn=new ct,BJ=Jt.extend({dynamic:!1,widthSegments:1,heightSegments:1,depthSegments:1,inside:!1},function(){this.build()},{build:function(){var e={px:ff("px",this.depthSegments,this.heightSegments),nx:ff("nx",this.depthSegments,this.heightSegments),py:ff("py",this.widthSegments,this.depthSegments),ny:ff("ny",this.widthSegments,this.depthSegments),pz:ff("pz",this.widthSegments,this.heightSegments),nz:ff("nz",this.widthSegments,this.heightSegments)},t=["position","texcoord0","normal"],i=0,r=0;for(var n in e)i+=e[n].vertexCount,r+=e[n].indices.length;for(var o=0;o<t.length;o++)this.attributes[t[o]].init(i);this.indices=new Yi.Uint16Array(r);var a=0,s=0;for(var n in e){for(var c=e[n],o=0;o<t.length;o++)for(var l=t[o],d=c.attributes[l].value,u=c.attributes[l].size,h=l==="normal",p=0;p<d.length;p++){var m=d[p];this.inside&&h&&(m=-m),this.attributes[l].value[p+u*s]=m}for(var f=c.indices.length,p=0;p<c.indices.length;p++)this.indices[p+a]=s+c.indices[this.inside?f-p-1:p];a+=c.indices.length,s+=c.vertexCount}this.boundingBox=new Jr,this.boundingBox.max.set(1,1,1),this.boundingBox.min.set(-1,-1,-1)}});function ff(e,t,i){tn.identity();var r=new Sd({widthSegments:t,heightSegments:i});switch(e){case"px":ct.translate(tn,tn,Fe.POSITIVE_X),ct.rotateY(tn,tn,Math.PI/2);break;case"nx":ct.translate(tn,tn,Fe.NEGATIVE_X),ct.rotateY(tn,tn,-Math.PI/2);break;case"py":ct.translate(tn,tn,Fe.POSITIVE_Y),ct.rotateX(tn,tn,-Math.PI/2);break;case"ny":ct.translate(tn,tn,Fe.NEGATIVE_Y),ct.rotateX(tn,tn,Math.PI/2);break;case"pz":ct.translate(tn,tn,Fe.POSITIVE_Z);break;case"nz":ct.translate(tn,tn,Fe.NEGATIVE_Z),ct.rotateY(tn,tn,Math.PI);break}return r.applyTransform(tn),r}var wy=BJ;var kF=`@export clay.skybox.vertex
#define SHADER_NAME skybox
uniform mat4 world : WORLD;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
attribute vec3 position : POSITION;
varying vec3 v_WorldPosition;
void main()
{
 v_WorldPosition = (world * vec4(position, 1.0)).xyz;
 gl_Position = worldViewProjection * vec4(position, 1.0);
}
@end
@export clay.skybox.fragment
#define PI 3.1415926
uniform mat4 viewInverse : VIEWINVERSE;
#ifdef EQUIRECTANGULAR
uniform sampler2D environmentMap;
#else
uniform samplerCube environmentMap;
#endif
uniform float lod: 0.0;
varying vec3 v_WorldPosition;
@import clay.util.rgbm
@import clay.util.srgb
@import clay.util.ACES
void main()
{
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(v_WorldPosition - eyePos);
#ifdef EQUIRECTANGULAR
 float phi = acos(V.y);
 float theta = atan(-V.x, V.z) + PI * 0.5;
 vec2 uv = vec2(theta / 2.0 / PI, phi / PI);
 vec4 texel = decodeHDR(texture2D(environmentMap, fract(uv)));
#else
 #if defined(LOD) || defined(SUPPORT_TEXTURE_LOD)
 vec4 texel = decodeHDR(textureCubeLodEXT(environmentMap, V, lod));
 #else
 vec4 texel = decodeHDR(textureCube(environmentMap, V));
 #endif
#endif
#ifdef SRGB_DECODE
 texel = sRGBToLinear(texel);
#endif
#ifdef TONEMAPPING
 texel.rgb = ACESToneMapping(texel.rgb);
#endif
#ifdef SRGB_ENCODE
 texel = linearTosRGB(texel);
#endif
 gl_FragColor = encodeHDR(vec4(texel.rgb, 1.0));
}
@end`;qe.import(kF);var VJ=ul.extend(function(){var e=new qe({vertex:qe.source("clay.skybox.vertex"),fragment:qe.source("clay.skybox.fragment")}),t=new In({shader:e,depthMask:!1});return{scene:null,geometry:new wy,material:t,environmentMap:null,culling:!1,_dummyCamera:new en}},function(){var e=this.scene;e&&this.attachScene(e),this.environmentMap&&this.setEnvironmentMap(this.environmentMap)},{attachScene:function(e){this.scene&&this.detachScene(),e.skybox=this,this.scene=e,e.on("beforerender",this._beforeRenderScene,this)},detachScene:function(){this.scene&&(this.scene.off("beforerender",this._beforeRenderScene),this.scene.skybox=null),this.scene=null},dispose:function(e){this.detachScene(),this.geometry.dispose(e)},setEnvironmentMap:function(e){e.textureType==="texture2D"?(this.material.define("EQUIRECTANGULAR"),e.minFilter=ot.LINEAR):this.material.undefine("EQUIRECTANGULAR"),this.material.set("environmentMap",e)},getEnvironmentMap:function(){return this.material.get("environmentMap")},_beforeRenderScene:function(e,t,i){this.renderSkybox(e,i)},renderSkybox:function(e,t){var i=this._dummyCamera;i.aspect=e.getViewportAspect(),i.fov=t.fov||50,i.updateProjectionMatrix(),ct.invert(i.invProjectionMatrix,i.projectionMatrix),i.worldTransform.copy(t.worldTransform),i.viewMatrix.copy(t.viewMatrix),this.position.copy(t.getWorldPosition()),this.update(),e.gl.disable(e.gl.BLEND),this.material.get("lod")>0?this.material.define("fragment","LOD"):this.material.undefine("fragment","LOD"),e.renderPass([this],i)}}),Td=VJ;var Ey=Td;var zJ=542327876;var UJ=131072;var HJ=512;var jJ=4;function aS(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var GJ=31,$J=aS("DXT1"),WJ=aS("DXT3"),qJ=aS("DXT5"),XJ=0,YJ=1,ZJ=2,KJ=3,QJ=4,JJ=7,eee=20,tee=21;var iee=28;var ree={parse:function(e,t){var i=new Int32Array(e,0,GJ);if(i[XJ]!==zJ||!i(eee)&jJ)return null;var r=i(tee),n=i[QJ],o=i[KJ],a=i[iee]&HJ,s=i[ZJ]&UJ,c,l;switch(r){case $J:c=8,l=ot.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case WJ:c=16,l=ot.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case qJ:c=16,l=ot.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return null}var d=i[YJ]+4,u=a?6:1,h=1;s&&(h=Math.max(1,i[JJ]));for(var p=[],m=0;m<u;m++){var f=n,g=o;p[m]=new wt({width:f,height:g,format:l});for(var v=[],_=0;_<h;_++){var b=Math.max(4,f)/4*Math.max(4,g)/4*c,y=new Uint8Array(e,d,b);d+=b,f*=.5,g*=.5,v[_]=y}p[m].pixels=v[0],s&&(p[m].mipmaps=v)}if(t)t.width=p[0].width,t.height=p[0].height,t.format=p[0].format,t.pixels=p[0].pixels,t.mipmaps=p[0].mipmaps;else return p[0]}},PF=ree;var Cy=String.fromCharCode,nee=8,oee=32767;function aee(e,t,i,r){if(e[3]>0){var n=Math.pow(2,e[3]-128-8+r);t[i+0]=e[0]*n,t[i+1]=e[1]*n,t[i+2]=e[2]*n}else t[i+0]=0,t[i+1]=0,t[i+2]=0;return t[i+3]=1,t}function see(e,t,i){for(var r="",n=t;n<i;n++)r+=Cy(e[n]);return r}function lee(e,t){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]}function NF(e,t,i,r){for(var n=0,o=0,a=r;a>0;)if(e[o][0]=t[i++],e[o][1]=t[i++],e[o][2]=t[i++],e[o][3]=t[i++],e[o][0]===1&&e[o][1]===1&&e[o][2]===1){for(var s=e[o][3]<<n>>>0;s>0;s--)lee(e[o-1],e[o]),o++,a--;n+=8}else o++,a--,n=0;return i}function cee(e,t,i,r){if(r<nee|r>oee)return NF(e,t,i,r);var n=t[i++];if(n!=2)return NF(e,t,i-1,r);if(e[0][1]=t[i++],e[0][2]=t[i++],n=t[i++],(e[0][2]<<8>>>0|n)>>>0!==r)return null;for(var n=0;n<4;n++)for(var o=0;o<r;){var a=t[i++];if(a>128){a=(a&127)>>>0;for(var s=t[i++];a--;)e[o++][n]=s}else for(;a--;)e[o++][n]=t[i++]}return i}var dee={parseRGBE:function(e,t,i){i==null&&(i=0);var r=new Uint8Array(e),n=r.length;if(see(r,0,2)==="#?"){for(var o=2;o<n&&!(Cy(r[o])===`
`&&Cy(r[o+1])===`
`);o++);if(!(o>=n)){o+=2;for(var a="";o<n;o++){var s=Cy(r[o]);if(s===`
`)break;a+=s}var c=a.split(" "),l=parseInt(c[1]),d=parseInt(c[3]);if(!(!d||!l)){for(var u=o+1,h=[],p=0;p<d;p++){h[p]=[];for(var m=0;m<4;m++)h[p][m]=0}for(var f=new Float32Array(d*l*4),g=0,v=0;v<l;v++){var u=cee(h,r,u,d);if(!u)return null;for(var p=0;p<d;p++)aee(h[p],f,g,i),g+=4}return t||(t=new wt),t.width=d,t.height=l,t.pixels=f,t.type=ot.FLOAT,t}}}},parseRGBEFromPNG:function(e){}},OF=dee;var Sy={loadTexture:function(e,t,i,r){var n;if(typeof t=="function"?(i=t,r=i,t={}):t=t||{},typeof e=="string"){if(e.match(/.hdr$/)||t.fileType==="hdr")return n=new wt({width:0,height:0,sRGB:!1}),Sy._fetchTexture(e,function(o){OF.parseRGBE(o,n,t.exposure),n.dirty(),i&&i(n)},r),n;e.match(/.dds$/)||t.fileType==="dds"?(n=new wt({width:0,height:0}),Sy._fetchTexture(e,function(o){PF.parse(o,n),n.dirty(),i&&i(n)},r)):(n=new wt,n.load(e),n.success(i),n.error(r))}else typeof e=="object"&&typeof e.px<"u"&&(n=new yc,n.load(e),n.success(i),n.error(r));return n},loadPanorama:function(e,t,i,r,n,o){var a=this;typeof r=="function"?(n=r,o=n,r={}):r=r||{},Sy.loadTexture(t,r,function(s){s.flipY=r.flipY||!1,a.panoramaToCubeMap(e,s,i,r),s.dispose(e),n&&n(i)},o)},panoramaToCubeMap:function(e,t,i,r){var n=new pf,o=new Ey({scene:new Za});return o.setEnvironmentMap(t),r=r||{},r.encodeRGBM&&o.material.define("fragment","RGBM_ENCODE"),i.sRGB=t.sRGB,n.texture=i,n.render(e,o.scene),n.texture=null,n.dispose(e),i},heightToNormal:function(e,t){var i=document.createElement("canvas"),r=i.width=e.width,n=i.height=e.height,o=i.getContext("2d");o.drawImage(e,0,0,r,n),t=t||!1;for(var a=o.getImageData(0,0,r,n),s=o.createImageData(r,n),c=0;c<a.data.length;c+=4){if(t){var l=a.data[c],d=a.data[c+1],u=a.data[c+2],h=Math.abs(l-d)+Math.abs(d-u);if(h>20)return console.warn("Given image is not a height map"),e}var p,m,f,g;c%(r*4)===0?(p=a.data[c],f=a.data[c+4]):c%(r*4)===(r-1)*4?(p=a.data[c-4],f=a.data[c]):(p=a.data[c-4],f=a.data[c+4]),c<r*4?(m=a.data[c],g=a.data[c+r*4]):c>r*(n-1)*4?(m=a.data[c-r*4],g=a.data[c]):(m=a.data[c-r*4],g=a.data[c+r*4]),s.data[c]=p-f+127,s.data[c+1]=m-g+127,s.data[c+2]=255,s.data[c+3]=255}return o.putImageData(s,0,0),i},isHeightImage:function(e,t,i){if(!e||!e.width||!e.height)return!1;var r=document.createElement("canvas"),n=r.getContext("2d"),o=t||32;i=i||20,r.width=r.height=o,n.drawImage(e,0,0,o,o);for(var a=n.getImageData(0,0,o,o),s=0;s<a.data.length;s+=4){var c=a.data[s],l=a.data[s+1],d=a.data[s+2],u=Math.abs(c-l)+Math.abs(l-d);if(u>i)return!1}return!0},_fetchTexture:function(e,t,i){Yi.request.get({url:e,responseType:"arraybuffer",onload:t,onerror:i})},createChessboard:function(e,t,i,r){e=e||512,t=t||64,i=i||"black",r=r||"white";var n=Math.ceil(e/t),o=document.createElement("canvas");o.width=e,o.height=e;var a=o.getContext("2d");a.fillStyle=r,a.fillRect(0,0,e,e),a.fillStyle=i;for(var s=0;s<n;s++)for(var c=0;c<n;c++){var l=c%2?s%2:s%2-1;l&&a.fillRect(s*t,c*t,t,t)}var d=new wt({image:o,anisotropic:8});return d},createBlank:function(e){var t=document.createElement("canvas");t.width=1,t.height=1;var i=t.getContext("2d");i.fillStyle=e,i.fillRect(0,0,1,1);var r=new wt({image:t});return r}},Ol=Sy;var sS=["mousedown","mouseup","mousemove","mouseover","mouseout","click","dblclick","contextmenu"];function lS(e){return"_on"+e}var cS=function(e){var t=this;this._texture=new wt({anisotropic:32,flipY:!1,surface:this,dispose:function(i){t.dispose(),wt.prototype.dispose.call(this,i)}}),sS.forEach(function(i){this[lS(i)]=function(r){r.triangle&&this._meshes.forEach(function(n){this.dispatchEvent(i,n,r.triangle,r.point)},this)}},this),this._meshes=[],e&&this.setECharts(e),this.onupdate=null};cS.prototype={constructor:cS,getTexture:function(){return this._texture},setECharts:function(e){this._chart=e;var t=e.getDom();if(!(t instanceof HTMLCanvasElement))console.error("ECharts must init on canvas if it is used as texture."),t=document.createElement("canvas");else{var i=this,r=e.getZr(),n=r.__oldRefreshImmediately||r.refreshImmediately;r.refreshImmediately=function(){n.call(this),i._texture.dirty(),i.onupdate&&i.onupdate()},r.__oldRefreshImmediately=n}this._texture.image=t,this._texture.dirty(),this.onupdate&&this.onupdate()},dispatchEvent:function(){var e=new Fe,t=new Fe,i=new Fe,r=new Vn,n=new Vn,o=new Vn,a=new Vn,s=new Fe;return function(c,l,d,u){var h=l.geometry,p=h.attributes.position,m=h.attributes.texcoord0,f=Fe.dot,g=Fe.cross;p.get(d[0],e.array),p.get(d[1],t.array),p.get(d[2],i.array),m.get(d[0],r.array),m.get(d[1],n.array),m.get(d[2],o.array),g(s,t,i);var v=f(e,s),_=f(u,s)/v;g(s,i,e);var b=f(u,s)/v;g(s,e,t);var y=f(u,s)/v;Vn.scale(a,r,_),Vn.scaleAndAdd(a,a,n,b),Vn.scaleAndAdd(a,a,o,y);var x=a.x*this._chart.getWidth(),w=a.y*this._chart.getHeight();this._chart.getZr().handler.dispatch(c,{zrX:x,zrY:w})}}(),attachToMesh:function(e){this._meshes.indexOf(e)>=0||(sS.forEach(function(t){e.on(t,this[lS(t)],this)},this),this._meshes.push(e))},detachFromMesh:function(e){var t=this._meshes.indexOf(e);t>=0&&this._meshes.splice(t,1),sS.forEach(function(i){e.off(i,this[lS(i)])},this)},dispose:function(){this._meshes.forEach(function(e){this.detachFromMesh(e)},this)}};var RF=cS;var uee=bc.extend({left:-1,right:1,near:-1,far:1,top:1,bottom:-1},{updateProjectionMatrix:function(){this.projectionMatrix.ortho(this.left,this.right,this.bottom,this.top,this.near,this.far)},decomposeProjectionMatrix:function(){var e=this.projectionMatrix.array;this.left=(-1-e[12])/e[0],this.right=(1-e[12])/e[0],this.top=(1-e[13])/e[5],this.bottom=(-1-e[13])/e[5],this.near=-(-1-e[14])/e[10],this.far=-(1-e[14])/e[10]},clone:function(){var e=bc.prototype.clone.call(this);return e.left=this.left,e.right=this.right,e.near=this.near,e.far=this.far,e.top=this.top,e.bottom=this.bottom,e}}),pl=uee;var FF=`
@export clay.compositor.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;
varying vec2 v_Texcoord;
void main()
{
 v_Texcoord = texcoord;
 gl_Position = worldViewProjection * vec4(position, 1.0);
}
@end`;qe.import(FF);var hee=new Sd,LF=new ul({geometry:hee,frustumCulling:!1}),pee=new pl,fee=fr.extend(function(){return{fragment:"",outputs:null,material:null,blendWithPrevious:!1,clearColor:!1,clearDepth:!0}},function(){var e=new qe(qe.source("clay.compositor.vertex"),this.fragment),t=new In({shader:e});t.enableTexturesAll(),this.material=t},{setUniform:function(e,t){this.material.setUniform(e,t)},getUniform:function(e){var t=this.material.uniforms[e];if(t)return t.value},attachOutput:function(e,t){this.outputs||(this.outputs={}),t=t||me.COLOR_ATTACHMENT0,this.outputs[t]=e},detachOutput:function(e){for(var t in this.outputs)this.outputs[t]===e&&(this.outputs[t]=null)},bind:function(e,t){if(this.outputs)for(var i in this.outputs){var r=this.outputs[i];r&&t.attach(r,i)}t&&t.bind(e)},unbind:function(e,t){t.unbind(e)},render:function(e,t){var i=e.gl;if(t){this.bind(e,t);var r=e.getGLExtension("EXT_draw_buffers");if(r&&this.outputs){var n=[];for(var o in this.outputs)o=+o,o>=i.COLOR_ATTACHMENT0&&o<=i.COLOR_ATTACHMENT0+8&&n.push(o);r.drawBuffersEXT(n)}}this.trigger("beforerender",this,e);var a=this.clearDepth?i.DEPTH_BUFFER_BIT:0;if(i.depthMask(!0),this.clearColor){a=a|i.COLOR_BUFFER_BIT,i.colorMask(!0,!0,!0,!0);var s=this.clearColor;Array.isArray(s)&&i.clearColor(s[0],s[1],s[2],s[3])}i.clear(a),this.blendWithPrevious?(i.enable(i.BLEND),this.material.transparent=!0):(i.disable(i.BLEND),this.material.transparent=!1),this.renderQuad(e),this.trigger("afterrender",this,e),t&&this.unbind(e,t)},renderQuad:function(e){LF.material=this.material,e.renderPass([LF],pee)},dispose:function(e){}}),cr=fee;var BF=`#define SAMPLE_NUMBER 1024
#define PI 3.14159265358979
uniform sampler2D normalDistribution;
uniform vec2 viewportSize : [512, 256];
const vec3 N = vec3(0.0, 0.0, 1.0);
const float fSampleNumber = float(SAMPLE_NUMBER);
vec3 importanceSampleNormal(float i, float roughness, vec3 N) {
 vec3 H = texture2D(normalDistribution, vec2(roughness, i)).rgb;
 vec3 upVector = abs(N.y) > 0.999 ? vec3(1.0, 0.0, 0.0) : vec3(0.0, 1.0, 0.0);
 vec3 tangentX = normalize(cross(N, upVector));
 vec3 tangentZ = cross(N, tangentX);
 return normalize(tangentX * H.x + N * H.y + tangentZ * H.z);
}
float G_Smith(float roughness, float NoV, float NoL) {
 float k = roughness * roughness / 2.0;
 float G1V = NoV / (NoV * (1.0 - k) + k);
 float G1L = NoL / (NoL * (1.0 - k) + k);
 return G1L * G1V;
}
void main() {
 vec2 uv = gl_FragCoord.xy / viewportSize;
 float NoV = uv.x;
 float roughness = uv.y;
 vec3 V;
 V.x = sqrt(1.0 - NoV * NoV);
 V.y = 0.0;
 V.z = NoV;
 float A = 0.0;
 float B = 0.0;
 for (int i = 0; i < SAMPLE_NUMBER; i++) {
 vec3 H = importanceSampleNormal(float(i) / fSampleNumber, roughness, N);
 vec3 L = reflect(-V, H);
 float NoL = clamp(L.z, 0.0, 1.0);
 float NoH = clamp(H.z, 0.0, 1.0);
 float VoH = clamp(dot(V, H), 0.0, 1.0);
 if (NoL > 0.0) {
 float G = G_Smith(roughness, NoV, NoL);
 float G_Vis = G * VoH / (NoH * NoV);
 float Fc = pow(1.0 - VoH, 5.0);
 A += (1.0 - Fc) * G_Vis;
 B += Fc * G_Vis;
 }
 }
 gl_FragColor = vec4(vec2(A, B) / fSampleNumber, 0.0, 1.0);
}
`;var VF=`#define SHADER_NAME prefilter
#define SAMPLE_NUMBER 1024
#define PI 3.14159265358979
uniform mat4 viewInverse : VIEWINVERSE;
uniform samplerCube environmentMap;
uniform sampler2D normalDistribution;
uniform float roughness : 0.5;
varying vec2 v_Texcoord;
varying vec3 v_WorldPosition;
@import clay.util.rgbm
vec3 importanceSampleNormal(float i, float roughness, vec3 N) {
 vec3 H = texture2D(normalDistribution, vec2(roughness, i)).rgb;
 vec3 upVector = abs(N.y) > 0.999 ? vec3(1.0, 0.0, 0.0) : vec3(0.0, 1.0, 0.0);
 vec3 tangentX = normalize(cross(N, upVector));
 vec3 tangentZ = cross(N, tangentX);
 return normalize(tangentX * H.x + N * H.y + tangentZ * H.z);
}
void main() {
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(v_WorldPosition - eyePos);
 vec3 N = V;
 vec3 prefilteredColor = vec3(0.0);
 float totalWeight = 0.0;
 float fMaxSampleNumber = float(SAMPLE_NUMBER);
 for (int i = 0; i < SAMPLE_NUMBER; i++) {
 vec3 H = importanceSampleNormal(float(i) / fMaxSampleNumber, roughness, N);
 vec3 L = reflect(-V, H);
 float NoL = clamp(dot(N, L), 0.0, 1.0);
 if (NoL > 0.0) {
 prefilteredColor += decodeHDR(textureCube(environmentMap, L)).rgb * NoL;
 totalWeight += NoL;
 }
 }
 gl_FragColor = encodeHDR(vec4(prefilteredColor / totalWeight, 1.0));
}
`;var ch={},dS=["px","nx","py","ny","pz","nz"];ch.prefilterEnvironmentMap=function(e,t,i,r,n){(!n||!r)&&(r=ch.generateNormalDistribution(),n=ch.integrateBRDF(e,r)),i=i||{};var o=i.width||64,a=i.height||64,s=i.type||t.type,c=new yc({width:o,height:a,type:s,flipY:!1,mipmaps:[]});c.isPowerOfTwo()||console.warn("Width and height must be power of two to enable mipmap.");var l=Math.min(o,a),d=Math.log(l)/Math.log(2)+1,u=new In({shader:new qe({vertex:qe.source("clay.skybox.vertex"),fragment:VF})});u.set("normalDistribution",r),i.encodeRGBM&&u.define("fragment","RGBM_ENCODE"),i.decodeRGBM&&u.define("fragment","RGBM_DECODE");var h=new Za,p;if(t.textureType==="texture2D"){var m=new yc({width:o,height:a,type:s===ot.FLOAT?ot.HALF_FLOAT:s});Ol.panoramaToCubeMap(e,t,m,{encodeRGBM:i.decodeRGBM}),t=m}p=new Td({scene:h,material:u}),p.material.set("environmentMap",t);var f=new pf({texture:c});i.encodeRGBM&&(s=c.type=ot.UNSIGNED_BYTE);for(var g=new wt({width:o,height:a,type:s}),v=new tr({depthBuffer:!1}),_=Yi[s===ot.UNSIGNED_BYTE?"Uint8Array":"Float32Array"],b=0;b<d;b++){c.mipmaps[b]={pixels:{}},p.material.set("roughness",b/(d-1));for(var y=g.width,x=2*Math.atan(y/(y-.5))/Math.PI*180,w=0;w<dS.length;w++){var I=new _(g.width*g.height*4);v.attach(g),v.bind(e);var S=f.getCamera(dS[w]);S.fov=x,e.render(h,S),e.gl.readPixels(0,0,g.width,g.height,ot.RGBA,s,I),v.unbind(e),c.mipmaps[b].pixels[dS[w]]=I}g.width/=2,g.height/=2,g.dirty()}return v.dispose(e),g.dispose(e),p.dispose(e),r.dispose(e),{environmentMap:c,brdfLookup:n,normalDistribution:r,maxMipmapLevel:d}};ch.integrateBRDF=function(e,t){t=t||ch.generateNormalDistribution();var i=new tr({depthBuffer:!1}),r=new cr({fragment:BF}),n=new wt({width:512,height:256,type:ot.HALF_FLOAT,wrapS:ot.CLAMP_TO_EDGE,wrapT:ot.CLAMP_TO_EDGE,minFilter:ot.NEAREST,magFilter:ot.NEAREST,useMipmap:!1});return r.setUniform("normalDistribution",t),r.setUniform("viewportSize",[512,256]),r.attachOutput(n),r.render(e,i),i.dispose(e),n};ch.generateNormalDistribution=function(i,r){for(var i=i||256,r=r||1024,n=new wt({width:i,height:r,type:ot.FLOAT,minFilter:ot.NEAREST,magFilter:ot.NEAREST,wrapS:ot.CLAMP_TO_EDGE,wrapT:ot.CLAMP_TO_EDGE,useMipmap:!1}),o=new Float32Array(r*i*4),a=[],s=0;s<i;s++){for(var c=s/i,l=c*c,d=0;d<r;d++){var u=(d<<16|d>>>16)>>>0;u=((u&1431655765)<<1|(u&2863311530)>>>1)>>>0,u=((u&858993459)<<2|(u&3435973836)>>>2)>>>0,u=((u&252645135)<<4|(u&4042322160)>>>4)>>>0,u=(((u&16711935)<<8|(u&4278255360)>>>8)>>>0)/4294967296;var h=Math.sqrt((1-u)/(1+(l*l-1)*u));a[d]=h}for(var d=0;d<r;d++){var p=(d*i+s)*4,h=a[d],m=Math.sqrt(1-h*h),f=d/r,g=2*Math.PI*f;o[p]=m*Math.cos(g),o[p+1]=h,o[p+2]=m*Math.sin(g),o[p+3]=1}}return n.pixels=o,n};var mf=ch;var mee=Kn.extend({cubemap:null,castShadow:!1,_normalDistribution:null,_brdfLookup:null},{type:"AMBIENT_CUBEMAP_LIGHT",prefilter:function(e,t){if(!e.getGLExtension("EXT_shader_texture_lod")){console.warn("Device not support textureCubeLodEXT");return}this._brdfLookup||(this._normalDistribution=mf.generateNormalDistribution(),this._brdfLookup=mf.integrateBRDF(e,this._normalDistribution));var i=this.cubemap;if(!i.__prefiltered){var r=mf.prefilterEnvironmentMap(e,i,{encodeRGBM:!0,width:t,height:t},this._normalDistribution,this._brdfLookup);this.cubemap=r.environmentMap,this.cubemap.__prefiltered=!0,i.dispose(e)}},getBRDFLookup:function(){return this._brdfLookup},uniformTemplates:{ambientCubemapLightColor:{type:"3f",value:function(e){var t=e.color,i=e.intensity;return[t[0]*i,t[1]*i,t[2]*i]}},ambientCubemapLightCubemap:{type:"t",value:function(e){return e.cubemap}},ambientCubemapLightBRDFLookup:{type:"t",value:function(e){return e._brdfLookup}}}}),zF=mee;var gee=Kn.extend({castShadow:!1,coefficients:[]},function(){this._coefficientsTmpArr=new Yi.Float32Array(9*3)},{type:"AMBIENT_SH_LIGHT",uniformTemplates:{ambientSHLightColor:{type:"3f",value:function(e){var t=e.color,i=e.intensity;return[t[0]*i,t[1]*i,t[2]*i]}},ambientSHLightCoefficients:{type:"3f",value:function(e){for(var t=e._coefficientsTmpArr,i=0;i<e.coefficients.length;i++)t[i]=e.coefficients[i];return t}}}}),UF=gee;var HF={},dh=["px","nx","py","ny","pz","nz"];function vee(e,t){var i=e[0],r=e[1],n=e[2];return t===0?1:t===1?i:t===2?r:t===3?n:t===4?i*n:t===5?r*n:t===6?i*r:t===7?3*n*n-1:i*i-r*r}var _ee={px:[2,1,0,-1,-1,1],nx:[2,1,0,1,-1,-1],py:[0,2,1,1,-1,-1],ny:[0,2,1,1,1,1],pz:[0,1,2,-1,-1,-1],nz:[0,1,2,1,-1,1]};function bee(e,t,i,r){for(var n=new Yi.Float32Array(27),o=J.create(),a=J.create(),s=J.create(),c=0;c<9;c++){for(var l=J.create(),d=0;d<dh.length;d++){for(var u=t[dh[d]],h=J.create(),p=0,m=0,f=_ee[dh[d]],g=0;g<r;g++)for(var v=0;v<i;v++){o[0]=v/(i-1)*2-1,o[1]=g/(r-1)*2-1,o[2]=-1,J.normalize(o,o),s[0]=o[f[0]]*f[3],s[1]=o[f[1]]*f[4],s[2]=o[f[2]]*f[5],a[0]=u[m++]/255,a[1]=u[m++]/255,a[2]=u[m++]/255;var _=u[m++]/255*8.12;a[0]*=_,a[1]*=_,a[2]*=_,J.scaleAndAdd(h,h,a,vee(s,c)*-o[2]),p+=-o[2]}J.scaleAndAdd(l,l,h,1/p)}n[c*3]=l[0]/6,n[c*3+1]=l[1]/6,n[c*3+2]=l[2]/6}return n}HF.projectEnvironmentMap=function(e,t,i){i=i||{},i.lod=i.lod||0;var r,n=new Za,o=64;t.textureType==="texture2D"?r=new Ey({scene:n,environmentMap:t}):(o=t.image&&t.image.px?t.image.px.width:t.width,r=new Td({scene:n,environmentMap:t}));var a=Math.ceil(o/Math.pow(2,i.lod)),s=Math.ceil(o/Math.pow(2,i.lod)),c=new wt({width:a,height:s}),l=new tr;r.material.define("fragment","RGBM_ENCODE"),i.decodeRGBM&&r.material.define("fragment","RGBM_DECODE"),r.material.set("lod",i.lod);for(var d=new pf({texture:c}),u={},h=0;h<dh.length;h++){u[dh[h]]=new Uint8Array(a*s*4);var p=d.getCamera(dh[h]);p.fov=90,l.attach(c),l.bind(e),e.render(n,p),e.gl.readPixels(0,0,a,s,ot.RGBA,ot.UNSIGNED_BYTE,u[dh[h]]),l.unbind(e)}return r.dispose(e),l.dispose(e),c.dispose(e),bee(e,u,a,s)};var jF=HF;var yee={firstNotNull:function(){for(var e=0,t=arguments.length;e<t;e++)if(arguments[e]!=null)return arguments[e]},queryDataIndex:function(e,t){if(t.dataIndexInside!=null)return t.dataIndexInside;if(t.dataIndex!=null)return Re.isArray(t.dataIndex)?Re.map(t.dataIndex,function(i){return e.indexOfRawIndex(i)}):e.indexOfRawIndex(t.dataIndex);if(t.name!=null)return Re.isArray(t.name)?Re.map(t.name,function(i){return e.indexOfName(i)}):e.indexOfName(t.name)}},St=yee;var xee=Jt.extend({dynamic:!1,widthSegments:40,heightSegments:20,phiStart:0,phiLength:Math.PI*2,thetaStart:0,thetaLength:Math.PI,radius:1},function(){this.build()},{build:function(){var e=this.heightSegments,t=this.widthSegments,i=this.attributes.position,r=this.attributes.texcoord0,n=this.attributes.normal,o=(t+1)*(e+1);i.init(o),r.init(o),n.init(o);var a=o>65535?Uint32Array:Uint16Array,s=this.indices=new a(t*e*6),c,l,d,u,h,p,m,b=this.radius,f=this.phiStart,g=this.phiLength,v=this.thetaStart,_=this.thetaLength,b=this.radius,y=[],x=[],w=0,I=1/b;for(m=0;m<=e;m++)for(p=0;p<=t;p++)u=p/t,h=m/e,c=-b*Math.cos(f+u*g)*Math.sin(v+h*_),l=b*Math.cos(v+h*_),d=b*Math.sin(f+u*g)*Math.sin(v+h*_),y[0]=c,y[1]=l,y[2]=d,x[0]=u,x[1]=h,i.set(w,y),r.set(w,x),y[0]*=I,y[1]*=I,y[2]*=I,n.set(w,y),w++;var S,E,N,M,P=t+1,$=0;for(m=0;m<e;m++)for(p=0;p<t;p++)E=m*P+p,S=m*P+p+1,M=(m+1)*P+p+1,N=(m+1)*P+p,s[$++]=S,s[$++]=E,s[$++]=M,s[$++]=E,s[$++]=N,s[$++]=M;this.boundingBox=new Jr,this.boundingBox.max.set(b,b,b),this.boundingBox.min.set(-b,-b,-b)}}),GF=xee;var wee=Kn.extend({castShadow:!1},{type:"AMBIENT_LIGHT",uniformTemplates:{ambientLightColor:{type:"3f",value:function(e){var t=e.color,i=e.intensity;return[t[0]*i,t[1]*i,t[2]*i]}}}}),$F=wee;var Eee=Kn.extend({shadowBias:.001,shadowSlopeScale:2,shadowCascade:1,cascadeSplitLogFactor:.2},{type:"DIRECTIONAL_LIGHT",uniformTemplates:{directionalLightDirection:{type:"3f",value:function(e){return e.__dir=e.__dir||new Fe,e.__dir.copy(e.worldTransform.z).normalize().negate().array}},directionalLightColor:{type:"3f",value:function(e){var t=e.color,i=e.intensity;return[t[0]*i,t[1]*i,t[2]*i]}}},clone:function(){var e=Kn.prototype.clone.call(this);return e.shadowBias=this.shadowBias,e.shadowSlopeScale=this.shadowSlopeScale,e}}),WF=Eee;var Cee=Kn.extend({range:100,castShadow:!1},{type:"POINT_LIGHT",uniformTemplates:{pointLightPosition:{type:"3f",value:function(e){return e.getWorldPosition().array}},pointLightRange:{type:"1f",value:function(e){return e.range}},pointLightColor:{type:"3f",value:function(e){var t=e.color,i=e.intensity;return[t[0]*i,t[1]*i,t[2]*i]}}},clone:function(){var e=Kn.prototype.clone.call(this);return e.range=this.range,e}}),qF=Cee;var See=Kn.extend({range:20,umbraAngle:30,penumbraAngle:45,falloffFactor:2,shadowBias:.001,shadowSlopeScale:2},{type:"SPOT_LIGHT",uniformTemplates:{spotLightPosition:{type:"3f",value:function(e){return e.getWorldPosition().array}},spotLightRange:{type:"1f",value:function(e){return e.range}},spotLightUmbraAngleCosine:{type:"1f",value:function(e){return Math.cos(e.umbraAngle*Math.PI/180)}},spotLightPenumbraAngleCosine:{type:"1f",value:function(e){return Math.cos(e.penumbraAngle*Math.PI/180)}},spotLightFalloffFactor:{type:"1f",value:function(e){return e.falloffFactor}},spotLightDirection:{type:"3f",value:function(e){return e.__dir=e.__dir||new Fe,e.__dir.copy(e.worldTransform.z).negate().array}},spotLightColor:{type:"3f",value:function(e){var t=e.color,i=e.intensity;return[t[0]*i,t[1]*i,t[2]*i]}}},clone:function(){var e=Kn.prototype.clone.call(this);return e.range=this.range,e.umbraAngle=this.umbraAngle,e.penumbraAngle=this.penumbraAngle,e.falloffFactor=this.falloffFactor,e.shadowBias=this.shadowBias,e.shadowSlopeScale=this.shadowSlopeScale,e}}),XF=See;var ki=function(e,t,i,r){e=e||0,t=t||0,i=i||0,r=r||0,this.array=nt.fromValues(e,t,i,r),this._dirty=!0};ki.prototype={constructor:ki,add:function(e){return nt.add(this.array,this.array,e.array),this._dirty=!0,this},set:function(e,t,i,r){return this.array[0]=e,this.array[1]=t,this.array[2]=i,this.array[3]=r,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this.array[3]=e[3],this._dirty=!0,this},clone:function(){return new ki(this.x,this.y,this.z,this.w)},copy:function(e){return nt.copy(this.array,e.array),this._dirty=!0,this},dist:function(e){return nt.dist(this.array,e.array)},distance:function(e){return nt.distance(this.array,e.array)},div:function(e){return nt.div(this.array,this.array,e.array),this._dirty=!0,this},divide:function(e){return nt.divide(this.array,this.array,e.array),this._dirty=!0,this},dot:function(e){return nt.dot(this.array,e.array)},len:function(){return nt.len(this.array)},length:function(){return nt.length(this.array)},lerp:function(e,t,i){return nt.lerp(this.array,e.array,t.array,i),this._dirty=!0,this},min:function(e){return nt.min(this.array,this.array,e.array),this._dirty=!0,this},max:function(e){return nt.max(this.array,this.array,e.array),this._dirty=!0,this},mul:function(e){return nt.mul(this.array,this.array,e.array),this._dirty=!0,this},multiply:function(e){return nt.multiply(this.array,this.array,e.array),this._dirty=!0,this},negate:function(){return nt.negate(this.array,this.array),this._dirty=!0,this},normalize:function(){return nt.normalize(this.array,this.array),this._dirty=!0,this},random:function(e){return nt.random(this.array,e),this._dirty=!0,this},scale:function(e){return nt.scale(this.array,this.array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return nt.scaleAndAdd(this.array,this.array,e.array,t),this._dirty=!0,this},sqrDist:function(e){return nt.sqrDist(this.array,e.array)},squaredDistance:function(e){return nt.squaredDistance(this.array,e.array)},sqrLen:function(){return nt.sqrLen(this.array)},squaredLength:function(){return nt.squaredLength(this.array)},sub:function(e){return nt.sub(this.array,this.array,e.array),this._dirty=!0,this},subtract:function(e){return nt.subtract(this.array,this.array,e.array),this._dirty=!0,this},transformMat4:function(e){return nt.transformMat4(this.array,this.array,e.array),this._dirty=!0,this},transformQuat:function(e){return nt.transformQuat(this.array,this.array,e.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var rv=Object.defineProperty;rv&&(nv=ki.prototype,rv(nv,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),rv(nv,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}),rv(nv,"z",{get:function(){return this.array[2]},set:function(e){this.array[2]=e,this._dirty=!0}}),rv(nv,"w",{get:function(){return this.array[3]},set:function(e){this.array[3]=e,this._dirty=!0}}));var nv;ki.add=function(e,t,i){return nt.add(e.array,t.array,i.array),e._dirty=!0,e};ki.set=function(e,t,i,r,n){nt.set(e.array,t,i,r,n),e._dirty=!0};ki.copy=function(e,t){return nt.copy(e.array,t.array),e._dirty=!0,e};ki.dist=function(e,t){return nt.distance(e.array,t.array)};ki.distance=ki.dist;ki.div=function(e,t,i){return nt.divide(e.array,t.array,i.array),e._dirty=!0,e};ki.divide=ki.div;ki.dot=function(e,t){return nt.dot(e.array,t.array)};ki.len=function(e){return nt.length(e.array)};ki.lerp=function(e,t,i,r){return nt.lerp(e.array,t.array,i.array,r),e._dirty=!0,e};ki.min=function(e,t,i){return nt.min(e.array,t.array,i.array),e._dirty=!0,e};ki.max=function(e,t,i){return nt.max(e.array,t.array,i.array),e._dirty=!0,e};ki.mul=function(e,t,i){return nt.multiply(e.array,t.array,i.array),e._dirty=!0,e};ki.multiply=ki.mul;ki.negate=function(e,t){return nt.negate(e.array,t.array),e._dirty=!0,e};ki.normalize=function(e,t){return nt.normalize(e.array,t.array),e._dirty=!0,e};ki.random=function(e,t){return nt.random(e.array,t),e._dirty=!0,e};ki.scale=function(e,t,i){return nt.scale(e.array,t.array,i),e._dirty=!0,e};ki.scaleAndAdd=function(e,t,i,r){return nt.scaleAndAdd(e.array,t.array,i.array,r),e._dirty=!0,e};ki.sqrDist=function(e,t){return nt.sqrDist(e.array,t.array)};ki.squaredDistance=ki.sqrDist;ki.sqrLen=function(e){return nt.sqrLen(e.array)};ki.squaredLength=ki.sqrLen;ki.sub=function(e,t,i){return nt.subtract(e.array,t.array,i.array),e._dirty=!0,e};ki.subtract=ki.sub;ki.transformMat4=function(e,t,i){return nt.transformMat4(e.array,t.array,i.array),e._dirty=!0,e};ki.transformQuat=function(e,t,i){return nt.transformQuat(e.array,t.array,i.array),e._dirty=!0,e};var YF=ki;var Ao={};Ao.create=function(){var e=new Fr(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e};Ao.clone=function(e){var t=new Fr(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t};Ao.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e};Ao.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e};Ao.transpose=function(e,t){if(e===t){var i=t[1];e[1]=t[2],e[2]=i}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e};Ao.invert=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=i*o-n*r;return a?(a=1/a,e[0]=o*a,e[1]=-r*a,e[2]=-n*a,e[3]=i*a,e):null};Ao.adjoint=function(e,t){var i=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=i,e};Ao.determinant=function(e){return e[0]*e[3]-e[2]*e[1]};Ao.multiply=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=i[0],c=i[1],l=i[2],d=i[3];return e[0]=r*s+o*c,e[1]=n*s+a*c,e[2]=r*l+o*d,e[3]=n*l+a*d,e};Ao.mul=Ao.multiply;Ao.rotate=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=Math.sin(i),c=Math.cos(i);return e[0]=r*c+o*s,e[1]=n*c+a*s,e[2]=r*-s+o*c,e[3]=n*-s+a*c,e};Ao.scale=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=i[0],c=i[1];return e[0]=r*s,e[1]=n*s,e[2]=o*c,e[3]=a*c,e};Ao.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))};Ao.LDU=function(e,t,i,r){return e[2]=r[2]/r[0],i[0]=r[0],i[1]=r[1],i[3]=r[3]-e[2]*i[1],[e,t,i]};var Xr=Ao;var ta=function(){this.array=Xr.create(),this._dirty=!0};ta.prototype={constructor:ta,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},clone:function(){return new ta().copy(this)},copy:function(e){return Xr.copy(this.array,e.array),this._dirty=!0,this},adjoint:function(){return Xr.adjoint(this.array,this.array),this._dirty=!0,this},determinant:function(){return Xr.determinant(this.array)},identity:function(){return Xr.identity(this.array),this._dirty=!0,this},invert:function(){return Xr.invert(this.array,this.array),this._dirty=!0,this},mul:function(e){return Xr.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return Xr.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return Xr.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return Xr.multiply(this.array,e.array,this.array),this._dirty=!0,this},rotate:function(e){return Xr.rotate(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return Xr.scale(this.array,this.array,e.array),this._dirty=!0,this},transpose:function(){return Xr.transpose(this.array,this.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};ta.adjoint=function(e,t){return Xr.adjoint(e.array,t.array),e._dirty=!0,e};ta.copy=function(e,t){return Xr.copy(e.array,t.array),e._dirty=!0,e};ta.determinant=function(e){return Xr.determinant(e.array)};ta.identity=function(e){return Xr.identity(e.array),e._dirty=!0,e};ta.invert=function(e,t){return Xr.invert(e.array,t.array),e._dirty=!0,e};ta.mul=function(e,t,i){return Xr.mul(e.array,t.array,i.array),e._dirty=!0,e};ta.multiply=ta.mul;ta.rotate=function(e,t,i){return Xr.rotate(e.array,t.array,i),e._dirty=!0,e};ta.scale=function(e,t,i){return Xr.scale(e.array,t.array,i.array),e._dirty=!0,e};ta.transpose=function(e,t){return Xr.transpose(e.array,t.array),e._dirty=!0,e};var ZF=ta;var Sa={};Sa.create=function(){var e=new Fr(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e};Sa.clone=function(e){var t=new Fr(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t};Sa.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e};Sa.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e};Sa.invert=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=t[4],s=t[5],c=i*o-r*n;return c?(c=1/c,e[0]=o*c,e[1]=-r*c,e[2]=-n*c,e[3]=i*c,e[4]=(n*s-o*a)*c,e[5]=(r*a-i*s)*c,e):null};Sa.determinant=function(e){return e[0]*e[3]-e[1]*e[2]};Sa.multiply=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=t[4],c=t[5],l=i[0],d=i[1],u=i[2],h=i[3],p=i[4],m=i[5];return e[0]=r*l+o*d,e[1]=n*l+a*d,e[2]=r*u+o*h,e[3]=n*u+a*h,e[4]=r*p+o*m+s,e[5]=n*p+a*m+c,e};Sa.mul=Sa.multiply;Sa.rotate=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=t[4],c=t[5],l=Math.sin(i),d=Math.cos(i);return e[0]=r*d+o*l,e[1]=n*d+a*l,e[2]=r*-l+o*d,e[3]=n*-l+a*d,e[4]=s,e[5]=c,e};Sa.scale=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=t[4],c=t[5],l=i[0],d=i[1];return e[0]=r*l,e[1]=n*l,e[2]=o*d,e[3]=a*d,e[4]=s,e[5]=c,e};Sa.translate=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=t[4],c=t[5],l=i[0],d=i[1];return e[0]=r,e[1]=n,e[2]=o,e[3]=a,e[4]=r*l+o*d+s,e[5]=n*l+a*d+c,e};Sa.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)};var ln=Sa;var Ta=function(){this.array=ln.create(),this._dirty=!0};Ta.prototype={constructor:Ta,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},clone:function(){return new Ta().copy(this)},copy:function(e){return ln.copy(this.array,e.array),this._dirty=!0,this},determinant:function(){return ln.determinant(this.array)},identity:function(){return ln.identity(this.array),this._dirty=!0,this},invert:function(){return ln.invert(this.array,this.array),this._dirty=!0,this},mul:function(e){return ln.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return ln.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return ln.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return ln.multiply(this.array,e.array,this.array),this._dirty=!0,this},rotate:function(e){return ln.rotate(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return ln.scale(this.array,this.array,e.array),this._dirty=!0,this},translate:function(e){return ln.translate(this.array,this.array,e.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};Ta.copy=function(e,t){return ln.copy(e.array,t.array),e._dirty=!0,e};Ta.determinant=function(e){return ln.determinant(e.array)};Ta.identity=function(e){return ln.identity(e.array),e._dirty=!0,e};Ta.invert=function(e,t){return ln.invert(e.array,t.array),e._dirty=!0,e};Ta.mul=function(e,t,i){return ln.mul(e.array,t.array,i.array),e._dirty=!0,e};Ta.multiply=Ta.mul;Ta.rotate=function(e,t,i){return ln.rotate(e.array,t.array,i),e._dirty=!0,e};Ta.scale=function(e,t,i){return ln.scale(e.array,t.array,i.array),e._dirty=!0,e};Ta.translate=function(e,t,i){return ln.translate(e.array,t.array,i.array),e._dirty=!0,e};var KF=Ta;var Pn=function(){this.array=ai.create(),this._dirty=!0};Pn.prototype={constructor:Pn,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},adjoint:function(){return ai.adjoint(this.array,this.array),this._dirty=!0,this},clone:function(){return new Pn().copy(this)},copy:function(e){return ai.copy(this.array,e.array),this._dirty=!0,this},determinant:function(){return ai.determinant(this.array)},fromMat2d:function(e){return ai.fromMat2d(this.array,e.array),this._dirty=!0,this},fromMat4:function(e){return ai.fromMat4(this.array,e.array),this._dirty=!0,this},fromQuat:function(e){return ai.fromQuat(this.array,e.array),this._dirty=!0,this},identity:function(){return ai.identity(this.array),this._dirty=!0,this},invert:function(){return ai.invert(this.array,this.array),this._dirty=!0,this},mul:function(e){return ai.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return ai.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return ai.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return ai.multiply(this.array,e.array,this.array),this._dirty=!0,this},rotate:function(e){return ai.rotate(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return ai.scale(this.array,this.array,e.array),this._dirty=!0,this},translate:function(e){return ai.translate(this.array,this.array,e.array),this._dirty=!0,this},normalFromMat4:function(e){return ai.normalFromMat4(this.array,e.array),this._dirty=!0,this},transpose:function(){return ai.transpose(this.array,this.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};Pn.adjoint=function(e,t){return ai.adjoint(e.array,t.array),e._dirty=!0,e};Pn.copy=function(e,t){return ai.copy(e.array,t.array),e._dirty=!0,e};Pn.determinant=function(e){return ai.determinant(e.array)};Pn.identity=function(e){return ai.identity(e.array),e._dirty=!0,e};Pn.invert=function(e,t){return ai.invert(e.array,t.array),e};Pn.mul=function(e,t,i){return ai.mul(e.array,t.array,i.array),e._dirty=!0,e};Pn.multiply=Pn.mul;Pn.fromMat2d=function(e,t){return ai.fromMat2d(e.array,t.array),e._dirty=!0,e};Pn.fromMat4=function(e,t){return ai.fromMat4(e.array,t.array),e._dirty=!0,e};Pn.fromQuat=function(e,t){return ai.fromQuat(e.array,t.array),e._dirty=!0,e};Pn.normalFromMat4=function(e,t){return ai.normalFromMat4(e.array,t.array),e._dirty=!0,e};Pn.rotate=function(e,t,i){return ai.rotate(e.array,t.array,i),e._dirty=!0,e};Pn.scale=function(e,t,i){return ai.scale(e.array,t.array,i.array),e._dirty=!0,e};Pn.transpose=function(e,t){return ai.transpose(e.array,t.array),e._dirty=!0,e};Pn.translate=function(e,t,i){return ai.translate(e.array,t.array,i.array),e._dirty=!0,e};var QF=Pn;var Ty={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return .5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return e===0?0:Math.pow(1024,e-1)},exponentialOut:function(e){return e===1?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var t,i=.1,r=.4;return e===0?0:e===1?1:(!i||i<1?(i=1,t=r/4):t=r*Math.asin(1/i)/(2*Math.PI),-(i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/r)))},elasticOut:function(e){var t,i=.1,r=.4;return e===0?0:e===1?1:(!i||i<1?(i=1,t=r/4):t=r*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/r)+1)},elasticInOut:function(e){var t,i=.1,r=.4;return e===0?0:e===1?1:(!i||i<1?(i=1,t=r/4):t=r*Math.asin(1/i)/(2*Math.PI),(e*=2)<1?-.5*(i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/r)):i*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/r)*.5+1)},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},backInOut:function(e){var t=2.5949095;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)},bounceIn:function(e){return 1-Ty.bounceOut(1-e)},bounceOut:function(e){return e<.36363636363636365?7.5625*e*e:e<.7272727272727273?7.5625*(e-=.5454545454545454)*e+.75:e<.9090909090909091?7.5625*(e-=.8181818181818182)*e+.9375:7.5625*(e-=.9545454545454546)*e+.984375},bounceInOut:function(e){return e<.5?Ty.bounceIn(e*2)*.5:Ty.bounceOut(e*2-1)*.5+.5}},Ay=Ty;var eL=12,Tee="sans-serif",JF=eL+"px "+Tee,Aee=20,Dee=100,Iee="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function Mee(e){var t={};if(typeof JSON>"u")return t;for(var i=0;i<e.length;i++){var r=String.fromCharCode(i+32),n=(e.charCodeAt(i)-Aee)/Dee;t[r]=n}return t}var kee=Mee(Iee),uS={createCanvas:function(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){var e,t;return function(i,r){if(!e){var n=uS.createCanvas();e=n&&n.getContext("2d")}if(e)return t!==r&&(t=e.font=r||JF),e.measureText(i);i=i||"",r=r||JF;var o=/^([0-9]*?)px$/.exec(r),a=+(o&&o[1])||eL,s=0;if(r.indexOf("mono")>=0)s=a*i.length;else for(var c=0;c<i.length;c++){var l=kee[i[c]];s+=l==null?a:l*a}return{width:s}}}(),loadImage:function(e,t,i){var r=new Image;return r.onload=t,r.onerror=i,r.src=e,r}};var Qke=oL(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(e,t){return e["[object "+t+"]"]=!0,e},{}),Jke=oL(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(e,t){return e["[object "+t+"Array]"]=!0,e},{}),Pee=Object.prototype.toString,Iy=Array.prototype,Nee=Iy.forEach,ePe=Iy.filter,iL=Iy.slice,Oee=Iy.map,tL=function(){}.constructor,Dy=tL?tL.prototype:null,Ree="__proto__";function rL(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];typeof console<"u"&&console.error.apply(console,e)}function nL(e,t){if(Object.assign)Object.assign(e,t);else for(var i in t)t.hasOwnProperty(i)&&i!==Ree&&(e[i]=t[i]);return e}var tPe=uS.createCanvas;function ov(e){return!e||typeof e=="string"?!1:typeof e.length=="number"}function Fee(e,t,i){if(e&&t)if(e.forEach&&e.forEach===Nee)e.forEach(t,i);else if(e.length===+e.length)for(var r=0,n=e.length;r<n;r++)t.call(i,e[r],r,e);else for(var o in e)e.hasOwnProperty(o)&&t.call(i,e[o],o,e)}function My(e,t,i){if(!e)return[];if(!t)return Vee(e);if(e.map&&e.map===Oee)return e.map(t,i);for(var r=[],n=0,o=e.length;n<o;n++)r.push(t.call(i,e[n],n,e));return r}function oL(e,t,i,r){if(e&&t){for(var n=0,o=e.length;n<o;n++)i=t.call(r,i,e[n],n,e);return i}}function ky(e){if(!e)return[];if(Object.keys)return Object.keys(e);var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t}function Lee(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return function(){return e.apply(t,i.concat(iL.call(arguments)))}}var iPe=Dy&&uh(Dy.bind)?Dy.call.bind(Dy.bind):Lee;function Bee(e){return Array.isArray?Array.isArray(e):Pee.call(e)==="[object Array]"}function uh(e){return typeof e=="function"}function aL(e){return typeof e=="string"}function Py(e){return typeof e=="number"}function sL(e){return e.colorStops!=null}function lL(e){return e!==e}function Vee(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return iL.apply(e,t)}function av(e){return e==null?null:typeof e.trim=="function"?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var rPe=function(){function e(t){this.data={};var i=Bee(t);this.data={};var r=this;t instanceof e?t.each(n):t&&Fee(t,n);function n(o,a){i?r.set(o,a):r.set(a,o)}}return e.prototype.get=function(t){return this.data.hasOwnProperty(t)?this.data[t]:null},e.prototype.set=function(t,i){return this.data[t]=i},e.prototype.each=function(t,i){for(var r in this.data)this.data.hasOwnProperty(r)&&t.call(i,this.data[r],r)},e.prototype.keys=function(){return ky(this.data)},e.prototype.removeKey=function(t){delete this.data[t]},e}();function hS(e,t){for(var i=new e.constructor(e.length+t.length),r=0;r<e.length;r++)i[r]=e[r];for(var n=e.length,r=0;r<t.length;r++)i[r+n]=t[r];return i}function Ny(){}var zee=180/Math.PI;function Oy(e,t){return e==null&&(e=0),t==null&&(t=0),[e,t]}function pS(e,t,i){var r=t[0],n=t[1];return e[0]=i[0]*r+i[2]*n+i[4],e[1]=i[1]*r+i[3]*n+i[5],e}var Ry=Math.pow,By=Math.sqrt,cL=1e-8;var dL=By(3),Fy=1/3,sPe=Oy(),lPe=Oy(),cPe=Oy();function Ly(e){return e>-cL&&e<cL}function uL(e,t,i,r,n){var o=1-n;return o*o*(o*e+3*n*t)+n*n*(n*r+3*o*i)}function hL(e,t,i,r,n,o){var a=r+3*(t-i)-e,s=3*(i-t*2+e),c=3*(t-e),l=e-n,d=s*s-3*a*c,u=s*c-9*a*l,h=c*c-3*s*l,p=0;if(Ly(d)&&Ly(u))if(Ly(s))o[0]=0;else{var m=-c/s;m>=0&&m<=1&&(o[p++]=m)}else{var f=u*u-4*d*h;if(Ly(f)){var g=u/d,m=-s/a+g,v=-g/2;m>=0&&m<=1&&(o[p++]=m),v>=0&&v<=1&&(o[p++]=v)}else if(f>0){var _=By(f),b=d*s+1.5*a*(-u+_),y=d*s+1.5*a*(-u-_);b<0?b=-Ry(-b,Fy):b=Ry(b,Fy),y<0?y=-Ry(-y,Fy):y=Ry(y,Fy);var m=(-s-(b+y))/(3*a);m>=0&&m<=1&&(o[p++]=m)}else{var x=(2*d*s-3*a*u)/(2*By(d*d*d)),w=Math.acos(x)/3,I=By(d),S=Math.cos(w),m=(-s-2*I*S)/(3*a),v=(-s+I*(S+dL*Math.sin(w)))/(3*a),E=(-s+I*(S-dL*Math.sin(w)))/(3*a);m>=0&&m<=1&&(o[p++]=m),v>=0&&v<=1&&(o[p++]=v),E>=0&&E<=1&&(o[p++]=E)}}return p}var Hee=/cubic-bezier\(([0-9,\.e ]+)\)/;function Vy(e){var t=e&&Hee.exec(e);if(t){var i=t[1].split(","),r=+av(i[0]),n=+av(i[1]),o=+av(i[2]),a=+av(i[3]);if(isNaN(r+n+o+a))return;var s=[];return function(c){return c<=0?0:c>=1?1:hL(0,r,o,1,c,s)&&uL(0,n,a,1,s[0])}}}var jee=function(){function e(t){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=t.life||1e3,this._delay=t.delay||0,this.loop=t.loop||!1,this.onframe=t.onframe||Ny,this.ondestroy=t.ondestroy||Ny,this.onrestart=t.onrestart||Ny,t.easing&&this.setEasing(t.easing)}return e.prototype.step=function(t,i){if(this._inited||(this._startTime=t+this._delay,this._inited=!0),this._paused){this._pausedTime+=i;return}var r=this._life,n=t-this._startTime-this._pausedTime,o=n/r;o<0&&(o=0),o=Math.min(o,1);var a=this.easingFunc,s=a?a(o):o;if(this.onframe(s),o===1)if(this.loop){var c=n%r;this._startTime=t-c,this._pausedTime=0,this.onrestart()}else return!0;return!1},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1},e.prototype.setEasing=function(t){this.easing=t,this.easingFunc=uh(t)?t:Ay[t]||Vy(t)},e}(),pL=jee;var fL={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function sv(e){return e=Math.round(e),e<0?0:e>255?255:e}function mL(e){return e<0?0:e>1?1:e}function fS(e){var t=e;return t.length&&t.charAt(t.length-1)==="%"?sv(parseFloat(t)/100*255):sv(parseInt(t,10))}function Uy(e){var t=e;return t.length&&t.charAt(t.length-1)==="%"?mL(parseFloat(t)/100):mL(parseFloat(t))}function mS(e,t,i){return i<0?i+=1:i>1&&(i-=1),i*6<1?e+(t-e)*i*6:i*2<1?t:i*3<2?e+(t-e)*(2/3-i)*6:e}function Ds(e,t,i,r,n){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e}function gS(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var vL=new by(20),zy=null;function gf(e,t){zy&&gS(zy,t),zy=vL.put(e,zy||t.slice())}function Hy(e,t){if(e){t=t||[];var i=vL.get(e);if(i)return gS(t,i);e=e+"";var r=e.replace(/ /g,"").toLowerCase();if(r in fL)return gS(t,fL[r]),gf(e,t),t;var n=r.length;if(r.charAt(0)==="#"){if(n===4||n===5){var o=parseInt(r.slice(1,4),16);if(!(o>=0&&o<=4095)){Ds(t,0,0,0,1);return}return Ds(t,(o&3840)>>4|(o&3840)>>8,o&240|(o&240)>>4,o&15|(o&15)<<4,n===5?parseInt(r.slice(4),16)/15:1),gf(e,t),t}else if(n===7||n===9){var o=parseInt(r.slice(1,7),16);if(!(o>=0&&o<=16777215)){Ds(t,0,0,0,1);return}return Ds(t,(o&16711680)>>16,(o&65280)>>8,o&255,n===9?parseInt(r.slice(7),16)/255:1),gf(e,t),t}return}var a=r.indexOf("("),s=r.indexOf(")");if(a!==-1&&s+1===n){var c=r.substr(0,a),l=r.substr(a+1,s-(a+1)).split(","),d=1;switch(c){case"rgba":if(l.length!==4)return l.length===3?Ds(t,+l[0],+l[1],+l[2],1):Ds(t,0,0,0,1);d=Uy(l.pop());case"rgb":if(l.length!==3){Ds(t,0,0,0,1);return}return Ds(t,fS(l[0]),fS(l[1]),fS(l[2]),d),gf(e,t),t;case"hsla":if(l.length!==4){Ds(t,0,0,0,1);return}return l[3]=Uy(l[3]),gL(l,t),gf(e,t),t;case"hsl":if(l.length!==3){Ds(t,0,0,0,1);return}return gL(l,t),gf(e,t),t;default:return}}Ds(t,0,0,0,1)}}function gL(e,t){var i=(parseFloat(e[0])%360+360)%360/360,r=Uy(e[1]),n=Uy(e[2]),o=n<=.5?n*(r+1):n+r-n*r,a=n*2-o;return t=t||[],Ds(t,sv(mS(a,o,i+1/3)*255),sv(mS(a,o,i)*255),sv(mS(a,o,i-1/3)*255),1),e.length===4&&(t[3]=e[3]),t}var $ee=function(){function e(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return e}(),Wee=function(){function e(){this.browser=new $ee,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<"u"}return e}(),hh=new Wee;typeof wx=="object"&&typeof wx.getSystemInfoSync=="function"?(hh.wxa=!0,hh.touchEventsSupported=!0):typeof document>"u"&&typeof self<"u"?hh.worker=!0:typeof navigator>"u"?(hh.node=!0,hh.svgSupported=!0):qee(navigator.userAgent,hh);function qee(e,t){var i=t.browser,r=e.match(/Firefox\/([\d.]+)/),n=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/.+?rv:(([\d.]+))/),o=e.match(/Edge?\/([\d.]+)/),a=/micromessenger/i.test(e);r&&(i.firefox=!0,i.version=r[1]),n&&(i.ie=!0,i.version=n[1]),o&&(i.edge=!0,i.version=o[1],i.newEdge=+o[1].split(".")[0]>18),a&&(i.weChat=!0),t.svgSupported=typeof SVGRect<"u",t.touchEventsSupported="ontouchstart"in window&&!i.ie&&!i.edge,t.pointerEventsSupported="onpointerdown"in window&&(i.edge||i.ie&&+i.version>=11),t.domSupported=typeof document<"u";var s=document.documentElement.style;t.transform3dSupported=(i.ie&&"transition"in s||i.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in s)&&!("OTransition"in s),t.transformSupported=t.transform3dSupported||i.ie&&+i.version>=9}var jy=hh;function _L(e){return e.type==="linear"}function bL(e){return e.type==="radial"}var CPe=function(){return jy.hasGlobalWindow&&uh(window.btoa)?function(e){return window.btoa(unescape(e))}:typeof Buffer<"u"?function(e){return Buffer.from(e).toString("base64")}:function(e){return null}}();var bS=Array.prototype.slice;function wc(e,t,i){return(t-e)*i+e}function vS(e,t,i,r){for(var n=t.length,o=0;o<n;o++)e[o]=wc(t[o],i[o],r);return e}function Xee(e,t,i,r){for(var n=t.length,o=n&&t[0].length,a=0;a<n;a++){e[a]||(e[a]=[]);for(var s=0;s<o;s++)e[a][s]=wc(t[a][s],i[a][s],r)}return e}function Gy(e,t,i,r){for(var n=t.length,o=0;o<n;o++)e[o]=t[o]+i[o]*r;return e}function yL(e,t,i,r){for(var n=t.length,o=n&&t[0].length,a=0;a<n;a++){e[a]||(e[a]=[]);for(var s=0;s<o;s++)e[a][s]=t[a][s]+i[a][s]*r}return e}function Yee(e,t){for(var i=e.length,r=t.length,n=i>r?t:e,o=Math.min(i,r),a=n[o-1]||{color:[0,0,0,0],offset:0},s=o;s<Math.max(i,r);s++)n.push({offset:a.offset,color:a.color.slice()})}function Zee(e,t,i){var r=e,n=t;if(!(!r.push||!n.push)){var o=r.length,a=n.length;if(o!==a){var s=o>a;if(s)r.length=a;else for(var c=o;c<a;c++)r.push(i===1?n[c]:bS.call(n[c]))}for(var l=r[0]&&r[0].length,c=0;c<r.length;c++)if(i===1)isNaN(r[c])&&(r[c]=n[c]);else for(var d=0;d<l;d++)isNaN(r[c][d])&&(r[c][d]=n[c][d])}}function _S(e){if(ov(e)){var t=e.length;if(ov(e[0])){for(var i=[],r=0;r<t;r++)i.push(bS.call(e[r]));return i}return bS.call(e)}return e}function qy(e){return e[0]=Math.floor(e[0])||0,e[1]=Math.floor(e[1])||0,e[2]=Math.floor(e[2])||0,e[3]=e[3]==null?1:e[3],"rgba("+e.join(",")+")"}function Kee(e){return ov(e&&e[0])?2:1}var $y=0,Xy=1,EL=2,dv=3,yS=4,xS=5,xL=6;function wL(e){return e===yS||e===xS}function Wy(e){return e===Xy||e===EL}var lv=[0,0,0,0],Qee=function(){function e(t){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=t}return e.prototype.isFinished=function(){return this._finished},e.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},e.prototype.needsAnimate=function(){return this.keyframes.length>=1},e.prototype.getAdditiveTrack=function(){return this._additiveTrack},e.prototype.addKeyframe=function(t,i,r){this._needsSort=!0;var n=this.keyframes,o=n.length,a=!1,s=xL,c=i;if(ov(i)){var l=Kee(i);s=l,(l===1&&!Py(i[0])||l===2&&!Py(i[0][0]))&&(a=!0)}else if(Py(i)&&!lL(i))s=$y;else if(aL(i))if(!isNaN(+i))s=$y;else{var d=Hy(i);d&&(c=d,s=dv)}else if(sL(i)){var u=nL({},c);u.colorStops=My(i.colorStops,function(p){return{offset:p.offset,color:Hy(p.color)}}),_L(i)?s=yS:bL(i)&&(s=xS),c=u}o===0?this.valType=s:(s!==this.valType||s===xL)&&(a=!0),this.discrete=this.discrete||a;var h={time:t,value:c,rawValue:i,percent:0};return r&&(h.easing=r,h.easingFunc=uh(r)?r:Ay[r]||Vy(r)),n.push(h),h},e.prototype.prepare=function(t,i){var r=this.keyframes;this._needsSort&&r.sort(function(f,g){return f.time-g.time});for(var n=this.valType,o=r.length,a=r[o-1],s=this.discrete,c=Wy(n),l=wL(n),d=0;d<o;d++){var u=r[d],h=u.value,p=a.value;u.percent=u.time/t,s||(c&&d!==o-1?Zee(h,p,n):l&&Yee(h.colorStops,p.colorStops))}if(!s&&n!==xS&&i&&this.needsAnimate()&&i.needsAnimate()&&n===i.valType&&!i._finished){this._additiveTrack=i;for(var m=r[0].value,d=0;d<o;d++)n===$y?r[d].additiveValue=r[d].value-m:n===dv?r[d].additiveValue=Gy([],r[d].value,m,-1):Wy(n)&&(r[d].additiveValue=n===Xy?Gy([],r[d].value,m,-1):yL([],r[d].value,m,-1))}},e.prototype.step=function(t,i){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var r=this._additiveTrack!=null,n=r?"additiveValue":"value",o=this.valType,a=this.keyframes,s=a.length,c=this.propName,l=o===dv,d,u=this._lastFr,h=Math.min,p,m;if(s===1)p=m=a[0];else{if(i<0)d=0;else if(i<this._lastFrP){var f=h(u+1,s-1);for(d=f;d>=0&&!(a[d].percent<=i);d--);d=h(d,s-2)}else{for(d=u;d<s&&!(a[d].percent>i);d++);d=h(d-1,s-2)}m=a[d+1],p=a[d]}if(p&&m){this._lastFr=d,this._lastFrP=i;var g=m.percent-p.percent,v=g===0?1:h((i-p.percent)/g,1);m.easingFunc&&(v=m.easingFunc(v));var _=r?this._additiveValue:l?lv:t[c];if((Wy(o)||l)&&!_&&(_=this._additiveValue=[]),this.discrete)t[c]=v<1?p.rawValue:m.rawValue;else if(Wy(o))o===Xy?vS(_,p[n],m[n],v):Xee(_,p[n],m[n],v);else if(wL(o)){var b=p[n],y=m[n],x=o===yS;t[c]={type:x?"linear":"radial",x:wc(b.x,y.x,v),y:wc(b.y,y.y,v),colorStops:My(b.colorStops,function(I,S){var E=y.colorStops[S];return{offset:wc(I.offset,E.offset,v),color:qy(vS([],I.color,E.color,v))}}),global:y.global},x?(t[c].x2=wc(b.x2,y.x2,v),t[c].y2=wc(b.y2,y.y2,v)):t[c].r=wc(b.r,y.r,v)}else if(l)vS(_,p[n],m[n],v),r||(t[c]=qy(_));else{var w=wc(p[n],m[n],v);r?this._additiveValue=w:t[c]=w}r&&this._addToTarget(t)}}},e.prototype._addToTarget=function(t){var i=this.valType,r=this.propName,n=this._additiveValue;i===$y?t[r]=t[r]+n:i===dv?(Hy(t[r],lv),Gy(lv,lv,n,1),t[r]=qy(lv)):i===Xy?Gy(t[r],t[r],n,1):i===EL&&yL(t[r],t[r],n,1)},e}(),Jee=function(){function e(t,i,r,n){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=t,this._loop=i,i&&n){rL("Can' use additive animation on looped animation.");return}this._additiveAnimators=n,this._allowDiscrete=r}return e.prototype.getMaxTime=function(){return this._maxTime},e.prototype.getDelay=function(){return this._delay},e.prototype.getLoop=function(){return this._loop},e.prototype.getTarget=function(){return this._target},e.prototype.changeTarget=function(t){this._target=t},e.prototype.when=function(t,i,r){return this.whenWithKeys(t,i,ky(i),r)},e.prototype.whenWithKeys=function(t,i,r,n){for(var o=this._tracks,a=0;a<r.length;a++){var s=r[a],c=o[s];if(!c){c=o[s]=new Qee(s);var l=void 0,d=this._getAdditiveTrack(s);if(d){var u=d.keyframes,h=u[u.length-1];l=h&&h.value,d.valType===dv&&l&&(l=qy(l))}else l=this._target[s];if(l==null)continue;t>0&&c.addKeyframe(0,_S(l),n),this._trackKeys.push(s)}c.addKeyframe(t,_S(i[s]),n)}return this._maxTime=Math.max(this._maxTime,t),this},e.prototype.pause=function(){this._clip.pause(),this._paused=!0},e.prototype.resume=function(){this._clip.resume(),this._paused=!1},e.prototype.isPaused=function(){return!!this._paused},e.prototype.duration=function(t){return this._maxTime=t,this._force=!0,this},e.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var t=this._doneCbs;if(t)for(var i=t.length,r=0;r<i;r++)t[r].call(this)},e.prototype._abortedCallback=function(){this._setTracksFinished();var t=this.animation,i=this._abortedCbs;if(t&&t.removeClip(this._clip),this._clip=null,i)for(var r=0;r<i.length;r++)i[r].call(this)},e.prototype._setTracksFinished=function(){for(var t=this._tracks,i=this._trackKeys,r=0;r<i.length;r++)t[i[r]].setFinished()},e.prototype._getAdditiveTrack=function(t){var i,r=this._additiveAnimators;if(r)for(var n=0;n<r.length;n++){var o=r[n].getTrack(t);o&&(i=o)}return i},e.prototype.start=function(t){if(!(this._started>0)){this._started=1;for(var i=this,r=[],n=this._maxTime||0,o=0;o<this._trackKeys.length;o++){var a=this._trackKeys[o],s=this._tracks[a],c=this._getAdditiveTrack(a),l=s.keyframes,d=l.length;if(s.prepare(n,c),s.needsAnimate())if(!this._allowDiscrete&&s.discrete){var u=l[d-1];u&&(i._target[s.propName]=u.rawValue),s.setFinished()}else r.push(s)}if(r.length||this._force){var h=new pL({life:n,loop:this._loop,delay:this._delay||0,onframe:function(p){i._started=2;var m=i._additiveAnimators;if(m){for(var f=!1,g=0;g<m.length;g++)if(m[g]._clip){f=!0;break}f||(i._additiveAnimators=null)}for(var g=0;g<r.length;g++)r[g].step(i._target,p);var v=i._onframeCbs;if(v)for(var g=0;g<v.length;g++)v[g](i._target,p)},ondestroy:function(){i._doneCallback()}});this._clip=h,this.animation&&this.animation.addClip(h),t&&h.setEasing(t)}else this._doneCallback();return this}},e.prototype.stop=function(t){if(this._clip){var i=this._clip;t&&i.onframe(1),this._abortedCallback()}},e.prototype.delay=function(t){return this._delay=t,this},e.prototype.during=function(t){return t&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(t)),this},e.prototype.done=function(t){return t&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(t)),this},e.prototype.aborted=function(t){return t&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(t)),this},e.prototype.getClip=function(){return this._clip},e.prototype.getTrack=function(t){return this._tracks[t]},e.prototype.getTracks=function(){var t=this;return My(this._trackKeys,function(i){return t._tracks[i]})},e.prototype.stopTracks=function(t,i){if(!t.length||!this._clip)return!0;for(var r=this._tracks,n=this._trackKeys,o=0;o<t.length;o++){var a=r[t[o]];a&&!a.isFinished()&&(i?a.step(this._target,1):this._started===1&&a.step(this._target,0),a.setFinished())}for(var s=!0,o=0;o<n.length;o++)if(!r[n[o]].isFinished()){s=!1;break}return s&&this._abortedCallback(),s},e.prototype.saveTo=function(t,i,r){if(t){i=i||this._trackKeys;for(var n=0;n<i.length;n++){var o=i[n],a=this._tracks[o];if(!(!a||a.isFinished())){var s=a.keyframes,c=s[r?0:s.length-1];c&&(t[o]=_S(c.rawValue))}}}},e.prototype.__changeFinalValue=function(t,i){i=i||ky(t);for(var r=0;r<i.length;r++){var n=i[r],o=this._tracks[n];if(o){var a=o.keyframes;if(a.length>1){var s=a.pop();o.addKeyframe(s.time,t[n]),o.prepare(this._maxTime,o.getAdditiveTrack())}}}},e}(),CL=Jee;var ete={_animators:null,getAnimators:function(){return this._animators=this._animators||[],this._animators},animate:function(e,t){this._animators=this._animators||[];var i=this,r;if(e){for(var n=e.split("."),o=i,a=0,s=n.length;a<s;a++)o&&(o=o[n[a]]);o&&(r=o)}else r=i;if(r==null)throw new Error("Target "+e+" not exists");var c=this._animators,l=new CL(r,t),d=this;return l.during(function(){d.__zr&&d.__zr.refresh()}).done(function(){var u=c.indexOf(l);u>=0&&c.splice(u,1)}),c.push(l),this.__zr&&this.__zr.animation.addAnimator(l),l},stopAnimation:function(e){this._animators=this._animators||[];for(var t=this._animators,i=t.length,r=0;r<i;r++)t[r].stop(e);return t.length=0,this},addAnimatorsToZr:function(e){if(this._animators)for(var t=0;t<this._animators.length;t++)e.animation.addAnimator(this._animators[t])},removeAnimatorsFromZr:function(e){if(this._animators)for(var t=0;t<this._animators.length;t++)e.animation.removeAnimator(this._animators[t])}},SL=ete;var Yy=`
@export clay.util.rand
highp float rand(vec2 uv) {
 const highp float a = 12.9898, b = 78.233, c = 43758.5453;
 highp float dt = dot(uv.xy, vec2(a,b)), sn = mod(dt, 3.141592653589793);
 return fract(sin(sn) * c);
}
@end
@export clay.util.calculate_attenuation
uniform float attenuationFactor : 5.0;
float lightAttenuation(float dist, float range)
{
 float attenuation = 1.0;
 attenuation = dist*dist/(range*range+1.0);
 float att_s = attenuationFactor;
 attenuation = 1.0/(attenuation*att_s+1.0);
 att_s = 1.0/(att_s+1.0);
 attenuation = attenuation - att_s;
 attenuation /= 1.0 - att_s;
 return clamp(attenuation, 0.0, 1.0);
}
@end
@export clay.util.edge_factor
#ifdef SUPPORT_STANDARD_DERIVATIVES
float edgeFactor(float width)
{
 vec3 d = fwidth(v_Barycentric);
 vec3 a3 = smoothstep(vec3(0.0), d * width, v_Barycentric);
 return min(min(a3.x, a3.y), a3.z);
}
#else
float edgeFactor(float width)
{
 return 1.0;
}
#endif
@end
@export clay.util.encode_float
vec4 encodeFloat(const in float depth)
{
 const vec4 bitShifts = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);
 const vec4 bit_mask = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);
 vec4 res = fract(depth * bitShifts);
 res -= res.xxyz * bit_mask;
 return res;
}
@end
@export clay.util.decode_float
float decodeFloat(const in vec4 color)
{
 const vec4 bitShifts = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);
 return dot(color, bitShifts);
}
@end
@export clay.util.float
@import clay.util.encode_float
@import clay.util.decode_float
@end
@export clay.util.rgbm_decode
vec3 RGBMDecode(vec4 rgbm, float range) {
 return range * rgbm.rgb * rgbm.a;
}
@end
@export clay.util.rgbm_encode
vec4 RGBMEncode(vec3 color, float range) {
 if (dot(color, color) == 0.0) {
 return vec4(0.0);
 }
 vec4 rgbm;
 color /= range;
 rgbm.a = clamp(max(max(color.r, color.g), max(color.b, 1e-6)), 0.0, 1.0);
 rgbm.a = ceil(rgbm.a * 255.0) / 255.0;
 rgbm.rgb = color / rgbm.a;
 return rgbm;
}
@end
@export clay.util.rgbm
@import clay.util.rgbm_decode
@import clay.util.rgbm_encode
vec4 decodeHDR(vec4 color)
{
#if defined(RGBM_DECODE) || defined(RGBM)
 return vec4(RGBMDecode(color, 8.12), 1.0);
#else
 return color;
#endif
}
vec4 encodeHDR(vec4 color)
{
#if defined(RGBM_ENCODE) || defined(RGBM)
 return RGBMEncode(color.xyz, 8.12);
#else
 return color;
#endif
}
@end
@export clay.util.srgb
vec4 sRGBToLinear(in vec4 value) {
 return vec4(mix(pow(value.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)), value.rgb * 0.0773993808, vec3(lessThanEqual(value.rgb, vec3(0.04045)))), value.w);
}
vec4 linearTosRGB(in vec4 value) {
 return vec4(mix(pow(value.rgb, vec3(0.41666)) * 1.055 - vec3(0.055), value.rgb * 12.92, vec3(lessThanEqual(value.rgb, vec3(0.0031308)))), value.w);
}
@end
@export clay.chunk.skinning_header
#ifdef SKINNING
attribute vec3 weight : WEIGHT;
attribute vec4 joint : JOINT;
#ifdef USE_SKIN_MATRICES_TEXTURE
uniform sampler2D skinMatricesTexture : ignore;
uniform float skinMatricesTextureSize: ignore;
mat4 getSkinMatrix(sampler2D tex, float idx) {
 float j = idx * 4.0;
 float x = mod(j, skinMatricesTextureSize);
 float y = floor(j / skinMatricesTextureSize) + 0.5;
 vec2 scale = vec2(skinMatricesTextureSize);
 return mat4(
 texture2D(tex, vec2(x + 0.5, y) / scale),
 texture2D(tex, vec2(x + 1.5, y) / scale),
 texture2D(tex, vec2(x + 2.5, y) / scale),
 texture2D(tex, vec2(x + 3.5, y) / scale)
 );
}
mat4 getSkinMatrix(float idx) {
 return getSkinMatrix(skinMatricesTexture, idx);
}
#else
uniform mat4 skinMatrix[JOINT_COUNT] : SKIN_MATRIX;
mat4 getSkinMatrix(float idx) {
 return skinMatrix[int(idx)];
}
#endif
#endif
@end
@export clay.chunk.skin_matrix
mat4 skinMatrixWS = getSkinMatrix(joint.x) * weight.x;
if (weight.y > 1e-4)
{
 skinMatrixWS += getSkinMatrix(joint.y) * weight.y;
}
if (weight.z > 1e-4)
{
 skinMatrixWS += getSkinMatrix(joint.z) * weight.z;
}
float weightW = 1.0-weight.x-weight.y-weight.z;
if (weightW > 1e-4)
{
 skinMatrixWS += getSkinMatrix(joint.w) * weightW;
}
@end
@export clay.chunk.instancing_header
#ifdef INSTANCING
attribute vec4 instanceMat1;
attribute vec4 instanceMat2;
attribute vec4 instanceMat3;
#endif
@end
@export clay.chunk.instancing_matrix
mat4 instanceMat = mat4(
 vec4(instanceMat1.xyz, 0.0),
 vec4(instanceMat2.xyz, 0.0),
 vec4(instanceMat3.xyz, 0.0),
 vec4(instanceMat1.w, instanceMat2.w, instanceMat3.w, 1.0)
);
@end
@export clay.util.parallax_correct
vec3 parallaxCorrect(in vec3 dir, in vec3 pos, in vec3 boxMin, in vec3 boxMax) {
 vec3 first = (boxMax - pos) / dir;
 vec3 second = (boxMin - pos) / dir;
 vec3 further = max(first, second);
 float dist = min(further.x, min(further.y, further.z));
 vec3 fixedPos = pos + dir * dist;
 vec3 boxCenter = (boxMax + boxMin) * 0.5;
 return normalize(fixedPos - boxCenter);
}
@end
@export clay.util.clamp_sample
vec4 clampSample(const in sampler2D texture, const in vec2 coord)
{
#ifdef STEREO
 float eye = step(0.5, coord.x) * 0.5;
 vec2 coordClamped = clamp(coord, vec2(eye, 0.0), vec2(0.5 + eye, 1.0));
#else
 vec2 coordClamped = clamp(coord, vec2(0.0), vec2(1.0));
#endif
 return texture2D(texture, coordClamped);
}
@end
@export clay.util.ACES
vec3 ACESToneMapping(vec3 color)
{
 const float A = 2.51;
 const float B = 0.03;
 const float C = 2.43;
 const float D = 0.59;
 const float E = 0.14;
 return (color * (A * color + B)) / (color * (C * color + D) + E);
}
@end`;var TL=`
@export ecgl.common.transformUniforms
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform mat4 worldInverseTranspose : WORLDINVERSETRANSPOSE;
uniform mat4 world : WORLD;
@end

@export ecgl.common.attributes
attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;
attribute vec3 normal : NORMAL;
@end

@export ecgl.common.uv.header
uniform vec2 uvRepeat : [1.0, 1.0];
uniform vec2 uvOffset : [0.0, 0.0];
uniform vec2 detailUvRepeat : [1.0, 1.0];
uniform vec2 detailUvOffset : [0.0, 0.0];

varying vec2 v_Texcoord;
varying vec2 v_DetailTexcoord;
@end

@export ecgl.common.uv.main
v_Texcoord = texcoord * uvRepeat + uvOffset;
v_DetailTexcoord = texcoord * detailUvRepeat + detailUvOffset;
@end

@export ecgl.common.uv.fragmentHeader
varying vec2 v_Texcoord;
varying vec2 v_DetailTexcoord;
@end


@export ecgl.common.albedo.main

 vec4 albedoTexel = vec4(1.0);
#ifdef DIFFUSEMAP_ENABLED
 albedoTexel = texture2D(diffuseMap, v_Texcoord);
 #ifdef SRGB_DECODE
 albedoTexel = sRGBToLinear(albedoTexel);
 #endif
#endif

#ifdef DETAILMAP_ENABLED
 vec4 detailTexel = texture2D(detailMap, v_DetailTexcoord);
 #ifdef SRGB_DECODE
 detailTexel = sRGBToLinear(detailTexel);
 #endif
 albedoTexel.rgb = mix(albedoTexel.rgb, detailTexel.rgb, detailTexel.a);
 albedoTexel.a = detailTexel.a + (1.0 - detailTexel.a) * albedoTexel.a;
#endif

@end

@export ecgl.common.wireframe.vertexHeader

#ifdef WIREFRAME_QUAD
attribute vec4 barycentric;
varying vec4 v_Barycentric;
#elif defined(WIREFRAME_TRIANGLE)
attribute vec3 barycentric;
varying vec3 v_Barycentric;
#endif

@end

@export ecgl.common.wireframe.vertexMain

#if defined(WIREFRAME_QUAD) || defined(WIREFRAME_TRIANGLE)
 v_Barycentric = barycentric;
#endif

@end


@export ecgl.common.wireframe.fragmentHeader

uniform float wireframeLineWidth : 1;
uniform vec4 wireframeLineColor: [0, 0, 0, 0.5];

#ifdef WIREFRAME_QUAD
varying vec4 v_Barycentric;
float edgeFactor () {
 vec4 d = fwidth(v_Barycentric);
 vec4 a4 = smoothstep(vec4(0.0), d * wireframeLineWidth, v_Barycentric);
 return min(min(min(a4.x, a4.y), a4.z), a4.w);
}
#elif defined(WIREFRAME_TRIANGLE)
varying vec3 v_Barycentric;
float edgeFactor () {
 vec3 d = fwidth(v_Barycentric);
 vec3 a3 = smoothstep(vec3(0.0), d * wireframeLineWidth, v_Barycentric);
 return min(min(a3.x, a3.y), a3.z);
}
#endif

@end


@export ecgl.common.wireframe.fragmentMain

#if defined(WIREFRAME_QUAD) || defined(WIREFRAME_TRIANGLE)
 if (wireframeLineWidth > 0.) {
 vec4 lineColor = wireframeLineColor;
#ifdef SRGB_DECODE
 lineColor = sRGBToLinear(lineColor);
#endif

 gl_FragColor.rgb = mix(gl_FragColor.rgb, lineColor.rgb, (1.0 - edgeFactor()) * lineColor.a);
 }
#endif
@end




@export ecgl.common.bumpMap.header

#ifdef BUMPMAP_ENABLED
uniform sampler2D bumpMap;
uniform float bumpScale : 1.0;


vec3 bumpNormal(vec3 surfPos, vec3 surfNormal, vec3 baseNormal)
{
 vec2 dSTdx = dFdx(v_Texcoord);
 vec2 dSTdy = dFdy(v_Texcoord);

 float Hll = bumpScale * texture2D(bumpMap, v_Texcoord).x;
 float dHx = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdx).x - Hll;
 float dHy = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdy).x - Hll;

 vec3 vSigmaX = dFdx(surfPos);
 vec3 vSigmaY = dFdy(surfPos);
 vec3 vN = surfNormal;

 vec3 R1 = cross(vSigmaY, vN);
 vec3 R2 = cross(vN, vSigmaX);

 float fDet = dot(vSigmaX, R1);

 vec3 vGrad = sign(fDet) * (dHx * R1 + dHy * R2);
 return normalize(abs(fDet) * baseNormal - vGrad);

}
#endif

@end

@export ecgl.common.normalMap.vertexHeader

#ifdef NORMALMAP_ENABLED
attribute vec4 tangent : TANGENT;
varying vec3 v_Tangent;
varying vec3 v_Bitangent;
#endif

@end

@export ecgl.common.normalMap.vertexMain

#ifdef NORMALMAP_ENABLED
 if (dot(tangent, tangent) > 0.0) {
 v_Tangent = normalize((worldInverseTranspose * vec4(tangent.xyz, 0.0)).xyz);
 v_Bitangent = normalize(cross(v_Normal, v_Tangent) * tangent.w);
 }
#endif

@end


@export ecgl.common.normalMap.fragmentHeader

#ifdef NORMALMAP_ENABLED
uniform sampler2D normalMap;
varying vec3 v_Tangent;
varying vec3 v_Bitangent;
#endif

@end

@export ecgl.common.normalMap.fragmentMain
#ifdef NORMALMAP_ENABLED
 if (dot(v_Tangent, v_Tangent) > 0.0) {
 vec3 normalTexel = texture2D(normalMap, v_DetailTexcoord).xyz;
 if (dot(normalTexel, normalTexel) > 0.0) { N = normalTexel * 2.0 - 1.0;
 mat3 tbn = mat3(v_Tangent, v_Bitangent, v_Normal);
 N = normalize(tbn * N);
 }
 }
#endif
@end



@export ecgl.common.vertexAnimation.header

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
attribute vec3 prevNormal;
uniform float percent;
#endif

@end

@export ecgl.common.vertexAnimation.main

#ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
 vec3 norm = mix(prevNormal, normal, percent);
#else
 vec3 pos = position;
 vec3 norm = normal;
#endif

@end


@export ecgl.common.ssaoMap.header
#ifdef SSAOMAP_ENABLED
uniform sampler2D ssaoMap;
uniform vec4 viewport : VIEWPORT;
#endif
@end

@export ecgl.common.ssaoMap.main
 float ao = 1.0;
#ifdef SSAOMAP_ENABLED
 ao = texture2D(ssaoMap, (gl_FragCoord.xy - viewport.xy) / viewport.zw).r;
#endif
@end




@export ecgl.common.diffuseLayer.header

#if (LAYER_DIFFUSEMAP_COUNT > 0)
uniform float layerDiffuseIntensity[LAYER_DIFFUSEMAP_COUNT];
uniform sampler2D layerDiffuseMap[LAYER_DIFFUSEMAP_COUNT];
#endif

@end

@export ecgl.common.emissiveLayer.header

#if (LAYER_EMISSIVEMAP_COUNT > 0)
uniform float layerEmissionIntensity[LAYER_EMISSIVEMAP_COUNT];
uniform sampler2D layerEmissiveMap[LAYER_EMISSIVEMAP_COUNT];
#endif

@end

@export ecgl.common.layers.header
@import ecgl.common.diffuseLayer.header
@import ecgl.common.emissiveLayer.header
@end

@export ecgl.common.diffuseLayer.main

#if (LAYER_DIFFUSEMAP_COUNT > 0)
 for (int _idx_ = 0; _idx_ < LAYER_DIFFUSEMAP_COUNT; _idx_++) {{
 float intensity = layerDiffuseIntensity[_idx_];
 vec4 texel2 = texture2D(layerDiffuseMap[_idx_], v_Texcoord);
 #ifdef SRGB_DECODE
 texel2 = sRGBToLinear(texel2);
 #endif
 albedoTexel.rgb = mix(albedoTexel.rgb, texel2.rgb * intensity, texel2.a);
 albedoTexel.a = texel2.a + (1.0 - texel2.a) * albedoTexel.a;
 }}
#endif

@end

@export ecgl.common.emissiveLayer.main

#if (LAYER_EMISSIVEMAP_COUNT > 0)
 for (int _idx_ = 0; _idx_ < LAYER_EMISSIVEMAP_COUNT; _idx_++)
 {{
 vec4 texel2 = texture2D(layerEmissiveMap[_idx_], v_Texcoord) * layerEmissionIntensity[_idx_];
 #ifdef SRGB_DECODE
 texel2 = sRGBToLinear(texel2);
 #endif
 float intensity = layerEmissionIntensity[_idx_];
 gl_FragColor.rgb += texel2.rgb * texel2.a * intensity;
 }}
#endif

@end
`;var AL=`@export ecgl.color.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

@import ecgl.common.uv.header

attribute vec2 texcoord : TEXCOORD_0;
attribute vec3 position: POSITION;

@import ecgl.common.wireframe.vertexHeader

#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
uniform float percent : 1.0;
#endif

#ifdef ATMOSPHERE_ENABLED
attribute vec3 normal: NORMAL;
uniform mat4 worldInverseTranspose : WORLDINVERSETRANSPOSE;
varying vec3 v_Normal;
#endif

void main()
{
#ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
#else
 vec3 pos = position;
#endif

 gl_Position = worldViewProjection * vec4(pos, 1.0);

 @import ecgl.common.uv.main

#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif

#ifdef ATMOSPHERE_ENABLED
 v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);
#endif

 @import ecgl.common.wireframe.vertexMain

}

@end

@export ecgl.color.fragment

#define LAYER_DIFFUSEMAP_COUNT 0
#define LAYER_EMISSIVEMAP_COUNT 0

uniform sampler2D diffuseMap;
uniform sampler2D detailMap;

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

#ifdef ATMOSPHERE_ENABLED
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform vec3 glowColor;
uniform float glowPower;
varying vec3 v_Normal;
#endif

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif

@import ecgl.common.layers.header

@import ecgl.common.uv.fragmentHeader

@import ecgl.common.wireframe.fragmentHeader

@import clay.util.srgb

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color);
#else
 gl_FragColor = color;
#endif

#ifdef VERTEX_COLOR
 gl_FragColor *= v_Color;
#endif

 @import ecgl.common.albedo.main

 @import ecgl.common.diffuseLayer.main

 gl_FragColor *= albedoTexel;

#ifdef ATMOSPHERE_ENABLED
 float atmoIntensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor.rgb += glowColor * atmoIntensity;
#endif

 @import ecgl.common.emissiveLayer.main

 @import ecgl.common.wireframe.fragmentMain

}
@end`;var DL=`/**
 * http: */

@export ecgl.lambert.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header


@import ecgl.common.attributes

@import ecgl.common.wireframe.vertexHeader

#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif


@import ecgl.common.vertexAnimation.header


varying vec3 v_Normal;
varying vec3 v_WorldPosition;

void main()
{
 @import ecgl.common.uv.main

 @import ecgl.common.vertexAnimation.main


 gl_Position = worldViewProjection * vec4(pos, 1.0);

 v_Normal = normalize((worldInverseTranspose * vec4(norm, 0.0)).xyz);
 v_WorldPosition = (world * vec4(pos, 1.0)).xyz;

#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif

 @import ecgl.common.wireframe.vertexMain
}

@end


@export ecgl.lambert.fragment

#define LAYER_DIFFUSEMAP_COUNT 0
#define LAYER_EMISSIVEMAP_COUNT 0

#define NORMAL_UP_AXIS 1
#define NORMAL_FRONT_AXIS 2

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform sampler2D diffuseMap;
uniform sampler2D detailMap;

@import ecgl.common.layers.header

uniform float emissionIntensity: 1.0;

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

uniform mat4 viewInverse : VIEWINVERSE;

#ifdef ATMOSPHERE_ENABLED
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform vec3 glowColor;
uniform float glowPower;
#endif

#ifdef AMBIENT_LIGHT_COUNT
@import clay.header.ambient_light
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
@import clay.header.ambient_sh_light
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif


@import ecgl.common.ssaoMap.header

@import ecgl.common.bumpMap.header

@import clay.util.srgb

@import ecgl.common.wireframe.fragmentHeader

@import clay.plugin.compute_shadow_map

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color);
#else
 gl_FragColor = color;
#endif

#ifdef VERTEX_COLOR
 #ifdef SRGB_DECODE
 gl_FragColor *= sRGBToLinear(v_Color);
 #else
 gl_FragColor *= v_Color;
 #endif
#endif

 @import ecgl.common.albedo.main

 @import ecgl.common.diffuseLayer.main

 gl_FragColor *= albedoTexel;

 vec3 N = v_Normal;
#ifdef DOUBLE_SIDED
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);

 if (dot(N, V) < 0.0) {
 N = -N;
 }
#endif

 float ambientFactor = 1.0;

#ifdef BUMPMAP_ENABLED
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 ambientFactor = dot(v_Normal, N);
#endif

 vec3 N2 = vec3(N.x, N[NORMAL_UP_AXIS], N[NORMAL_FRONT_AXIS]);

 vec3 diffuseColor = vec3(0.0, 0.0, 0.0);

 @import ecgl.common.ssaoMap.main

#ifdef AMBIENT_LIGHT_COUNT
 for(int i = 0; i < AMBIENT_LIGHT_COUNT; i++)
 {
 diffuseColor += ambientLightColor[i] * ambientFactor * ao;
 }
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)
 {{
 diffuseColor += calcAmbientSHLight(_idx_, N2) * ambientSHLightColor[_idx_] * ao;
 }}
#endif
#ifdef DIRECTIONAL_LIGHT_COUNT
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
#endif
 for(int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++)
 {
 vec3 lightDirection = -directionalLightDirection[i];
 vec3 lightColor = directionalLightColor[i];

 float shadowContrib = 1.0;
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 if (shadowEnabled)
 {
 shadowContrib = shadowContribsDir[i];
 }
#endif

 float ndl = dot(N, normalize(lightDirection)) * shadowContrib;

 diffuseColor += lightColor * clamp(ndl, 0.0, 1.0);
 }
#endif

 gl_FragColor.rgb *= diffuseColor;

#ifdef ATMOSPHERE_ENABLED
 float atmoIntensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor.rgb += glowColor * atmoIntensity;
#endif

 @import ecgl.common.emissiveLayer.main

 @import ecgl.common.wireframe.fragmentMain
}

@end`;var IL=`@export ecgl.realistic.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header

@import ecgl.common.attributes


@import ecgl.common.wireframe.vertexHeader

#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif

#ifdef NORMALMAP_ENABLED
attribute vec4 tangent : TANGENT;
varying vec3 v_Tangent;
varying vec3 v_Bitangent;
#endif

@import ecgl.common.vertexAnimation.header

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

void main()
{

 @import ecgl.common.uv.main

 @import ecgl.common.vertexAnimation.main

 gl_Position = worldViewProjection * vec4(pos, 1.0);

 v_Normal = normalize((worldInverseTranspose * vec4(norm, 0.0)).xyz);
 v_WorldPosition = (world * vec4(pos, 1.0)).xyz;

#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif

#ifdef NORMALMAP_ENABLED
 v_Tangent = normalize((worldInverseTranspose * vec4(tangent.xyz, 0.0)).xyz);
 v_Bitangent = normalize(cross(v_Normal, v_Tangent) * tangent.w);
#endif

 @import ecgl.common.wireframe.vertexMain

}

@end



@export ecgl.realistic.fragment

#define LAYER_DIFFUSEMAP_COUNT 0
#define LAYER_EMISSIVEMAP_COUNT 0
#define PI 3.14159265358979
#define ROUGHNESS_CHANEL 0
#define METALNESS_CHANEL 1

#define NORMAL_UP_AXIS 1
#define NORMAL_FRONT_AXIS 2

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform sampler2D diffuseMap;

uniform sampler2D detailMap;
uniform sampler2D metalnessMap;
uniform sampler2D roughnessMap;

@import ecgl.common.layers.header

uniform float emissionIntensity: 1.0;

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

uniform float metalness : 0.0;
uniform float roughness : 0.5;

uniform mat4 viewInverse : VIEWINVERSE;

#ifdef ATMOSPHERE_ENABLED
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform vec3 glowColor;
uniform float glowPower;
#endif

#ifdef AMBIENT_LIGHT_COUNT
@import clay.header.ambient_light
#endif

#ifdef AMBIENT_SH_LIGHT_COUNT
@import clay.header.ambient_sh_light
#endif

#ifdef AMBIENT_CUBEMAP_LIGHT_COUNT
@import clay.header.ambient_cubemap_light
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

@import ecgl.common.normalMap.fragmentHeader

@import ecgl.common.ssaoMap.header

@import ecgl.common.bumpMap.header

@import clay.util.srgb

@import clay.util.rgbm

@import ecgl.common.wireframe.fragmentHeader

@import clay.plugin.compute_shadow_map

vec3 F_Schlick(float ndv, vec3 spec) {
 return spec + (1.0 - spec) * pow(1.0 - ndv, 5.0);
}

float D_Phong(float g, float ndh) {
 float a = pow(8192.0, g);
 return (a + 2.0) / 8.0 * pow(ndh, a);
}

void main()
{
 vec4 albedoColor = color;

 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);
#ifdef VERTEX_COLOR
 #ifdef SRGB_DECODE
 albedoColor *= sRGBToLinear(v_Color);
 #else
 albedoColor *= v_Color;
 #endif
#endif

 @import ecgl.common.albedo.main

 @import ecgl.common.diffuseLayer.main

 albedoColor *= albedoTexel;

 float m = metalness;

#ifdef METALNESSMAP_ENABLED
 float m2 = texture2D(metalnessMap, v_DetailTexcoord)[METALNESS_CHANEL];
 m = clamp(m2 + (m - 0.5) * 2.0, 0.0, 1.0);
#endif

 vec3 baseColor = albedoColor.rgb;
 albedoColor.rgb = baseColor * (1.0 - m);
 vec3 specFactor = mix(vec3(0.04), baseColor, m);

 float g = 1.0 - roughness;

#ifdef ROUGHNESSMAP_ENABLED
 float g2 = 1.0 - texture2D(roughnessMap, v_DetailTexcoord)[ROUGHNESS_CHANEL];
 g = clamp(g2 + (g - 0.5) * 2.0, 0.0, 1.0);
#endif

 vec3 N = v_Normal;

#ifdef DOUBLE_SIDED
 if (dot(N, V) < 0.0) {
 N = -N;
 }
#endif

 float ambientFactor = 1.0;

#ifdef BUMPMAP_ENABLED
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 ambientFactor = dot(v_Normal, N);
#endif

@import ecgl.common.normalMap.fragmentMain

 vec3 N2 = vec3(N.x, N[NORMAL_UP_AXIS], N[NORMAL_FRONT_AXIS]);

 vec3 diffuseTerm = vec3(0.0);
 vec3 specularTerm = vec3(0.0);

 float ndv = clamp(dot(N, V), 0.0, 1.0);
 vec3 fresnelTerm = F_Schlick(ndv, specFactor);

 @import ecgl.common.ssaoMap.main

#ifdef AMBIENT_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_LIGHT_COUNT; _idx_++)
 {{
 diffuseTerm += ambientLightColor[_idx_] * ambientFactor * ao;
 }}
#endif

#ifdef AMBIENT_SH_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)
 {{
 diffuseTerm += calcAmbientSHLight(_idx_, N2) * ambientSHLightColor[_idx_] * ao;
 }}
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
#endif
 for(int _idx_ = 0; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++)
 {{
 vec3 L = -directionalLightDirection[_idx_];
 vec3 lc = directionalLightColor[_idx_];

 vec3 H = normalize(L + V);
 float ndl = clamp(dot(N, normalize(L)), 0.0, 1.0);
 float ndh = clamp(dot(N, H), 0.0, 1.0);

 float shadowContrib = 1.0;
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 if (shadowEnabled)
 {
 shadowContrib = shadowContribsDir[_idx_];
 }
#endif

 vec3 li = lc * ndl * shadowContrib;

 diffuseTerm += li;
 specularTerm += li * fresnelTerm * D_Phong(g, ndh);
 }}
#endif


#ifdef AMBIENT_CUBEMAP_LIGHT_COUNT
 vec3 L = reflect(-V, N);
 L = vec3(L.x, L[NORMAL_UP_AXIS], L[NORMAL_FRONT_AXIS]);
 float rough2 = clamp(1.0 - g, 0.0, 1.0);
 float bias2 = rough2 * 5.0;
 vec2 brdfParam2 = texture2D(ambientCubemapLightBRDFLookup[0], vec2(rough2, ndv)).xy;
 vec3 envWeight2 = specFactor * brdfParam2.x + brdfParam2.y;
 vec3 envTexel2;
 for(int _idx_ = 0; _idx_ < AMBIENT_CUBEMAP_LIGHT_COUNT; _idx_++)
 {{
 envTexel2 = RGBMDecode(textureCubeLodEXT(ambientCubemapLightCubemap[_idx_], L, bias2), 8.12);
 specularTerm += ambientCubemapLightColor[_idx_] * envTexel2 * envWeight2 * ao;
 }}
#endif

 gl_FragColor.rgb = albedoColor.rgb * diffuseTerm + specularTerm;
 gl_FragColor.a = albedoColor.a;

#ifdef ATMOSPHERE_ENABLED
 float atmoIntensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor.rgb += glowColor * atmoIntensity;
#endif

#ifdef SRGB_ENCODE
 gl_FragColor = linearTosRGB(gl_FragColor);
#endif

 @import ecgl.common.emissiveLayer.main

 @import ecgl.common.wireframe.fragmentMain
}

@end`;var ML=`@export ecgl.hatching.vertex

@import ecgl.realistic.vertex

@end


@export ecgl.hatching.fragment

#define NORMAL_UP_AXIS 1
#define NORMAL_FRONT_AXIS 2

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform vec4 color : [0.0, 0.0, 0.0, 1.0];
uniform vec4 paperColor : [1.0, 1.0, 1.0, 1.0];

uniform mat4 viewInverse : VIEWINVERSE;

#ifdef AMBIENT_LIGHT_COUNT
@import clay.header.ambient_light
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
@import clay.header.ambient_sh_light
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif


@import ecgl.common.ssaoMap.header

@import ecgl.common.bumpMap.header

@import clay.util.srgb

@import ecgl.common.wireframe.fragmentHeader

@import clay.plugin.compute_shadow_map

uniform sampler2D hatch1;
uniform sampler2D hatch2;
uniform sampler2D hatch3;
uniform sampler2D hatch4;
uniform sampler2D hatch5;
uniform sampler2D hatch6;

float shade(in float tone) {
 vec4 c = vec4(1. ,1., 1., 1.);
 float step = 1. / 6.;
 vec2 uv = v_DetailTexcoord;
 if (tone <= step / 2.0) {
 c = mix(vec4(0.), texture2D(hatch6, uv), 12. * tone);
 }
 else if (tone <= step) {
 c = mix(texture2D(hatch6, uv), texture2D(hatch5, uv), 6. * tone);
 }
 if(tone > step && tone <= 2. * step){
 c = mix(texture2D(hatch5, uv), texture2D(hatch4, uv) , 6. * (tone - step));
 }
 if(tone > 2. * step && tone <= 3. * step){
 c = mix(texture2D(hatch4, uv), texture2D(hatch3, uv), 6. * (tone - 2. * step));
 }
 if(tone > 3. * step && tone <= 4. * step){
 c = mix(texture2D(hatch3, uv), texture2D(hatch2, uv), 6. * (tone - 3. * step));
 }
 if(tone > 4. * step && tone <= 5. * step){
 c = mix(texture2D(hatch2, uv), texture2D(hatch1, uv), 6. * (tone - 4. * step));
 }
 if(tone > 5. * step){
 c = mix(texture2D(hatch1, uv), vec4(1.), 6. * (tone - 5. * step));
 }

 return c.r;
}

const vec3 w = vec3(0.2125, 0.7154, 0.0721);

void main()
{
#ifdef SRGB_DECODE
 vec4 inkColor = sRGBToLinear(color);
#else
 vec4 inkColor = color;
#endif

#ifdef VERTEX_COLOR
 #ifdef SRGB_DECODE
 inkColor *= sRGBToLinear(v_Color);
 #else
 inkColor *= v_Color;
 #endif
#endif

 vec3 N = v_Normal;
#ifdef DOUBLE_SIDED
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);

 if (dot(N, V) < 0.0) {
 N = -N;
 }
#endif

 float tone = 0.0;

 float ambientFactor = 1.0;

#ifdef BUMPMAP_ENABLED
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 ambientFactor = dot(v_Normal, N);
#endif

 vec3 N2 = vec3(N.x, N[NORMAL_UP_AXIS], N[NORMAL_FRONT_AXIS]);

 @import ecgl.common.ssaoMap.main

#ifdef AMBIENT_LIGHT_COUNT
 for(int i = 0; i < AMBIENT_LIGHT_COUNT; i++)
 {
 tone += dot(ambientLightColor[i], w) * ambientFactor * ao;
 }
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)
 {{
 tone += dot(calcAmbientSHLight(_idx_, N2) * ambientSHLightColor[_idx_], w) * ao;
 }}
#endif
#ifdef DIRECTIONAL_LIGHT_COUNT
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
#endif
 for(int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++)
 {
 vec3 lightDirection = -directionalLightDirection[i];
 float lightTone = dot(directionalLightColor[i], w);

 float shadowContrib = 1.0;
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 if (shadowEnabled)
 {
 shadowContrib = shadowContribsDir[i];
 }
#endif

 float ndl = dot(N, normalize(lightDirection)) * shadowContrib;

 tone += lightTone * clamp(ndl, 0.0, 1.0);
 }
#endif

 gl_FragColor = mix(inkColor, paperColor, shade(clamp(tone, 0.0, 1.0)));
 }
@end
`;var kL=`@export ecgl.sm.depth.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
uniform float percent : 1.0;
#endif

varying vec4 v_ViewPosition;
varying vec2 v_Texcoord;

void main(){

#ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
#else
 vec3 pos = position;
#endif

 v_ViewPosition = worldViewProjection * vec4(pos, 1.0);
 gl_Position = v_ViewPosition;

 v_Texcoord = texcoord;

}
@end



@export ecgl.sm.depth.fragment

@import clay.sm.depth.fragment

@end`;Object.assign(Jo.prototype,SL);qe.import(Yy);qe.import(ny);qe.import(TL);qe.import(AL);qe.import(DL);qe.import(IL);qe.import(ML);qe.import(kL);function tte(e){return!e||e==="none"}function OL(e){return e instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof Image}function ite(e){return e.getZr&&e.setOption}var rte=Za.prototype.addToScene,nte=Za.prototype.removeFromScene;Za.prototype.addToScene=function(e){if(rte.call(this,e),this.__zr){var t=this.__zr;e.traverse(function(i){i.__zr=t,i.addAnimatorsToZr&&i.addAnimatorsToZr(t)})}};Za.prototype.removeFromScene=function(e){nte.call(this,e),e.traverse(function(t){var i=t.__zr;t.__zr=null,i&&t.removeAnimatorsFromZr&&t.removeAnimatorsFromZr(i)})};In.prototype.setTextureImage=function(e,t,i,r){if(this.shader){var n=i.getZr(),o=this,a;return o.autoUpdateTextureStatus=!1,o.disableTexture(e),tte(t)||(a=Ht.loadTexture(t,i,r,function(s){o.enableTexture(e),n&&n.refresh()}),o.set(e,a)),a}};var Ht={};Ht.Renderer=wd;Ht.Node=Jo;Ht.Mesh=ul;Ht.Shader=qe;Ht.Material=In;Ht.Texture=ot;Ht.Texture2D=wt;Ht.Geometry=Jt;Ht.SphereGeometry=GF;Ht.PlaneGeometry=Sd;Ht.CubeGeometry=wy;Ht.AmbientLight=$F;Ht.DirectionalLight=WF;Ht.PointLight=qF;Ht.SpotLight=XF;Ht.PerspectiveCamera=en;Ht.OrthographicCamera=pl;Ht.Vector2=Vn;Ht.Vector3=Fe;Ht.Vector4=YF;Ht.Quaternion=dy;Ht.Matrix2=ZF;Ht.Matrix2d=KF;Ht.Matrix3=QF;Ht.Matrix4=ct;Ht.Plane=vy;Ht.Ray=oh;Ht.BoundingBox=Jr;Ht.Frustum=uf;var Zy=null;function ote(){return Zy!==null||(Zy=Ol.createBlank("rgba(255,255,255,0)").image),Zy}function PL(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))}function NL(e){if((e.wrapS===ot.REPEAT||e.wrapT===ot.REPEAT)&&e.image){var t=PL(e.width),i=PL(e.height);if(t!==e.width||i!==e.height){var r=document.createElement("canvas");r.width=t,r.height=i;var n=r.getContext("2d");n.drawImage(e.image,0,0,t,i),e.image=r}}}Ht.loadTexture=function(e,t,i,r){typeof i=="function"&&(r=i,i={}),i=i||{};for(var n=Object.keys(i).sort(),o="",a=0;a<n.length;a++)o+=n[a]+"_"+i[n[a]]+"_";var s=t.__textureCache=t.__textureCache||new by(20);if(ite(e)){var c=e.__textureid__,l=s.get(o+c);if(l)l.texture.surface.setECharts(e),r&&r(l.texture);else{var d=new RF(e);d.onupdate=function(){t.getZr().refresh()},l={texture:d.getTexture()};for(var a=0;a<n.length;a++)l.texture[n[a]]=i[n[a]];c=e.__textureid__||"__ecgl_ec__"+l.texture.__uid__,e.__textureid__=c,s.put(o+c,l),r&&r(l.texture)}return l.texture}else if(OL(e)){var c=e.__textureid__,l=s.get(o+c);if(!l){l={texture:new Ht.Texture2D({image:e})};for(var a=0;a<n.length;a++)l.texture[n[a]]=i[n[a]];c=e.__textureid__||"__ecgl_image__"+l.texture.__uid__,e.__textureid__=c,s.put(o+c,l),NL(l.texture),r&&r(l.texture)}return l.texture}else{var l=s.get(o+e);if(l)l.callbacks?l.callbacks.push(r):r&&r(l.texture);else if(e.match(/.hdr$|^data:application\/octet-stream/)){l={callbacks:[r]};var u=Ol.loadTexture(e,{exposure:i.exposure,fileType:"hdr"},function(){u.dirty(),l.callbacks.forEach(function(m){m&&m(u)}),l.callbacks=null});l.texture=u,s.put(o+e,l)}else{for(var u=new Ht.Texture2D({image:new Image}),a=0;a<n.length;a++)u[n[a]]=i[n[a]];l={texture:u,callbacks:[r]};var h=u.image;h.onload=function(){u.image=h,NL(u),u.dirty(),l.callbacks.forEach(function(f){f&&f(u)}),l.callbacks=null},h.crossOrigin="Anonymous",h.src=e,u.image=ote(),s.put(o+e,l)}return l.texture}};Ht.createAmbientCubemap=function(e,t,i,r){e=e||{};var n=e.texture,o=St.firstNotNull(e.exposure,1),a=new zF({intensity:St.firstNotNull(e.specularIntensity,1)}),s=new UF({intensity:St.firstNotNull(e.diffuseIntensity,1),coefficients:[.844,.712,.691,-.037,.083,.167,.343,.288,.299,-.041,-.021,-.009,-.003,-.041,-.064,-.011,-.007,-.004,-.031,.034,.081,-.06,-.049,-.06,.046,.056,.05]});return a.cubemap=Ht.loadTexture(n,i,{exposure:o},function(){if(a.cubemap.flipY=!1,0)var c;if(a.prefilter(t,32),0)var l;s.coefficients=jF.projectEnvironmentMap(t,a.cubemap,{lod:1}),r&&r()}),{specular:a,diffuse:s}};Ht.createBlankTexture=Ol.createBlank;Ht.isImage=OL;Ht.additiveBlend=function(e){e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE)};Ht.parseColor=function(e,t){return e instanceof Array?(t||(t=[]),t[0]=e[0],t[1]=e[1],t[2]=e[2],e.length>3?t[3]=e[3]:t[3]=1,t):(t=Ml.parse(e||"#000",t)||[0,0,0,0],t[0]/=255,t[1]/=255,t[2]/=255,t)};Ht.directionFromAlphaBeta=function(e,t){var i=e/180*Math.PI+Math.PI/2,r=-t/180*Math.PI+Math.PI/2,n=[],o=Math.sin(i);return n[0]=o*Math.cos(r),n[1]=-Math.cos(i),n[2]=o*Math.sin(r),n};Ht.getShadowResolution=function(e){var t=1024;switch(e){case"low":t=512;break;case"medium":break;case"high":t=2048;break;case"ultra":t=4096;break}return t};Ht.COMMON_SHADERS=["lambert","color","realistic","hatching","shadow"];Ht.createShader=function(e){e==="ecgl.shadow"&&(e="ecgl.displayShadow");var t=qe.source(e+".vertex"),i=qe.source(e+".fragment");t||console.error("Vertex shader of '%s' not exits",e),i||console.error("Fragment shader of '%s' not exits",e);var r=new qe(t,i);return r.name=e,r};Ht.createMaterial=function(e,t){t instanceof Array||(t=[t]);var i=Ht.createShader(e),r=new In({shader:i});return t.forEach(function(n){typeof n=="string"&&r.define(n)}),r};Ht.setMaterialFromModel=function(e,t,i,r){t.autoUpdateTextureStatus=!1;var n=i.getModel(e+"Material"),o=n.get("detailTexture"),a=St.firstNotNull(n.get("textureTiling"),1),s=St.firstNotNull(n.get("textureOffset"),0);typeof a=="number"&&(a=[a,a]),typeof s=="number"&&(s=[s,s]);var c=a[0]>1||a[1]>1?Ht.Texture.REPEAT:Ht.Texture.CLAMP_TO_EDGE,l={anisotropic:8,wrapS:c,wrapT:c};if(e==="realistic"){var d=n.get("roughness"),u=n.get("metalness");u!=null?isNaN(u)&&(t.setTextureImage("metalnessMap",u,r,l),u=St.firstNotNull(n.get("metalnessAdjust"),.5)):u=0,d!=null?isNaN(d)&&(t.setTextureImage("roughnessMap",d,r,l),d=St.firstNotNull(n.get("roughnessAdjust"),.5)):d=.5;var h=n.get("normalTexture");t.setTextureImage("detailMap",o,r,l),t.setTextureImage("normalMap",h,r,l),t.set({roughness:d,metalness:u,detailUvRepeat:a,detailUvOffset:s})}else if(e==="lambert")t.setTextureImage("detailMap",o,r,l),t.set({detailUvRepeat:a,detailUvOffset:s});else if(e==="color")t.setTextureImage("detailMap",o,r,l),t.set({detailUvRepeat:a,detailUvOffset:s});else if(e==="hatching"){var p=n.get("hatchingTextures")||[];p.length<6;for(var m=0;m<6;m++)t.setTextureImage("hatch"+(m+1),p[m],r,{anisotropic:8,wrapS:Ht.Texture.REPEAT,wrapT:Ht.Texture.REPEAT});t.set({detailUvRepeat:a,detailUvOffset:s})}};Ht.updateVertexAnimation=function(e,t,i,r){var n=r.get("animation"),o=r.get("animationDurationUpdate"),a=r.get("animationEasingUpdate"),s=i.shadowDepthMaterial;if(n&&t&&o>0&&t.geometry.vertexCount===i.geometry.vertexCount){i.material.define("vertex","VERTEX_ANIMATION"),i.ignorePreZ=!0,s&&s.define("vertex","VERTEX_ANIMATION");for(var c=0;c<e.length;c++)i.geometry.attributes[e[c][0]].value=t.geometry.attributes[e[c][1]].value;i.geometry.dirty(),i.__percent=0,i.material.set("percent",0),i.stopAnimation(),i.animate().when(o,{__percent:1}).during(function(){i.material.set("percent",i.__percent),s&&s.set("percent",i.__percent)}).done(function(){i.ignorePreZ=!1,i.material.undefine("vertex","VERTEX_ANIMATION"),s&&s.undefine("vertex","VERTEX_ANIMATION")}).start(a)}else i.material.undefine("vertex","VERTEX_ANIMATION"),s&&s.undefine("vertex","VERTEX_ANIMATION")};var F=Ht;var RL;RL=jy.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){return setTimeout(e,16)};var uv=RL;var wr=function(e,t){this.id=e,this.zr=t;try{this.renderer=new wd({clearBit:0,devicePixelRatio:t.painter.dpr,preserveDrawingBuffer:!0,premultipliedAlpha:!0}),this.renderer.resize(t.painter.getWidth(),t.painter.getHeight())}catch(r){this.renderer=null,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute; left: 0; top: 0; right: 0; bottom: 0;",this.dom.className="ecgl-nowebgl",this.dom.innerHTML="Sorry, your browser does not support WebGL",console.error(r);return}this.onglobalout=this.onglobalout.bind(this),t.on("globalout",this.onglobalout),this.dom=this.renderer.canvas;var i=this.dom.style;i.position="absolute",i.left="0",i.top="0",this.views=[],this._picking=new mF({renderer:this.renderer}),this._viewsToDispose=[],this._accumulatingId=0,this._zrEventProxy=new Dn.Rect({shape:{x:-1,y:-1,width:2,height:2},__isGLToZRProxy:!0}),this._backgroundColor=null,this._disposed=!1};wr.prototype.setUnpainted=function(){};wr.prototype.addView=function(e){if(e.layer!==this){var t=this._viewsToDispose.indexOf(e);t>=0&&this._viewsToDispose.splice(t,1),this.views.push(e),e.layer=this;var i=this.zr;e.scene.traverse(function(r){r.__zr=i,r.addAnimatorsToZr&&r.addAnimatorsToZr(i)})}};function FL(e){var t=e.__zr;e.__zr=null,t&&e.removeAnimatorsFromZr&&e.removeAnimatorsFromZr(t)}wr.prototype.removeView=function(e){if(e.layer===this){var t=this.views.indexOf(e);t>=0&&(this.views.splice(t,1),e.scene.traverse(FL,this),e.layer=null,this._viewsToDispose.push(e))}};wr.prototype.removeViewsAll=function(){this.views.forEach(function(e){e.scene.traverse(FL,this),e.layer=null,this._viewsToDispose.push(e)},this),this.views.length=0};wr.prototype.resize=function(e,t){var i=this.renderer;i.resize(e,t)};wr.prototype.clear=function(){var e=this.renderer.gl,t=this._backgroundColor||[0,0,0,0];e.clearColor(t[0],t[1],t[2],t[3]),e.depthMask(!0),e.colorMask(!0,!0,!0,!0),e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT)};wr.prototype.clearDepth=function(){var e=this.renderer.gl;e.clear(e.DEPTH_BUFFER_BIT)};wr.prototype.clearColor=function(){var e=this.renderer.gl;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)};wr.prototype.needsRefresh=function(){this.zr.refresh()};wr.prototype.refresh=function(e){this._backgroundColor=e?F.parseColor(e):[0,0,0,0],this.renderer.clearColor=this._backgroundColor;for(var t=0;t<this.views.length;t++)this.views[t].prepareRender(this.renderer);this._doRender(!1),this._trackAndClean();for(var t=0;t<this._viewsToDispose.length;t++)this._viewsToDispose[t].dispose(this.renderer);this._viewsToDispose.length=0,this._startAccumulating()};wr.prototype.renderToCanvas=function(e){this._startAccumulating(!0),e.drawImage(this.dom,0,0,e.canvas.width,e.canvas.height)};wr.prototype._doRender=function(e){this.clear(),this.renderer.saveViewport();for(var t=0;t<this.views.length;t++)this.views[t].render(this.renderer,e);this.renderer.restoreViewport()};wr.prototype._stopAccumulating=function(){this._accumulatingId=0,clearTimeout(this._accumulatingTimeout)};var ate=1;wr.prototype._startAccumulating=function(e){var t=this;this._stopAccumulating();for(var i=!1,r=0;r<this.views.length;r++)i=this.views[r].needsAccumulate()||i;if(!i)return;function n(o){if(!(!t._accumulatingId||o!==t._accumulatingId)){for(var a=!0,s=0;s<t.views.length;s++)a=t.views[s].isAccumulateFinished()&&i;a||(t._doRender(!0),e?n(o):uv(function(){n(o)}))}}this._accumulatingId=ate++,e?n(t._accumulatingId):this._accumulatingTimeout=setTimeout(function(){n(t._accumulatingId)},50)};wr.prototype._trackAndClean=function(){var e=[],t=[];this._textureList&&(Qy(this._textureList),Qy(this._geometriesList));for(var i=0;i<this.views.length;i++)ste(this.views[i].scene,e,t);this._textureList&&(Jy(this.renderer,this._textureList),Jy(this.renderer,this._geometriesList)),this._textureList=e,this._geometriesList=t};function Qy(e){for(var t=0;t<e.length;t++)e[t].__used__=0}function Jy(e,t){for(var i=0;i<t.length;i++)t[i].__used__||t[i].dispose(e)}function Ky(e,t){e.__used__=e.__used__||0,e.__used__++,e.__used__===1&&t.push(e)}function ste(e,t,i){var r,n;e.traverse(function(a){if(a.isRenderable()){var s=a.geometry,c=a.material;if(c!==r)for(var l=c.getTextureUniforms(),d=0;d<l.length;d++){var u=l[d],h=c.uniforms[u].value;if(h){if(h instanceof ot)Ky(h,t);else if(h instanceof Array)for(var p=0;p<h.length;p++)h[p]instanceof ot&&Ky(h[p],t)}}s!==n&&Ky(s,i),r=c,n=s}});for(var o=0;o<e.lights.length;o++)e.lights[o].cubemap&&Ky(e.lights[o].cubemap,t)}wr.prototype.dispose=function(){this._disposed||(this._stopAccumulating(),this._textureList&&(Qy(this._textureList),Qy(this._geometriesList),Jy(this.renderer,this._textureList),Jy(this.renderer,this._geometriesList)),this.zr.off("globalout",this.onglobalout),this._disposed=!0)};wr.prototype.onmousedown=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY);t&&(this._dispatchEvent("mousedown",e,t),this._dispatchDataEvent("mousedown",e,t)),this._downX=e.offsetX,this._downY=e.offsetY}};wr.prototype.onmousemove=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY),i=t&&t.target,r=this._hovered;this._hovered=t,r&&i!==r.target&&(r.relatedTarget=i,this._dispatchEvent("mouseout",e,r),this.zr.setCursorStyle("default")),this._dispatchEvent("mousemove",e,t),t&&(this.zr.setCursorStyle("pointer"),(!r||i!==r.target)&&this._dispatchEvent("mouseover",e,t)),this._dispatchDataEvent("mousemove",e,t)}};wr.prototype.onmouseup=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY);t&&(this._dispatchEvent("mouseup",e,t),this._dispatchDataEvent("mouseup",e,t)),this._upX=e.offsetX,this._upY=e.offsetY}};wr.prototype.onclick=wr.prototype.dblclick=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){var t=this._upX-this._downX,i=this._upY-this._downY;if(!(Math.sqrt(t*t+i*i)>20)){e=e.event;var r=this.pickObject(e.offsetX,e.offsetY);r&&(this._dispatchEvent(e.type,e,r),this._dispatchDataEvent(e.type,e,r));var n=this._clickToSetFocusPoint(e);if(n){var o=n.view.setDOFFocusOnPoint(n.distance);o&&this.zr.refresh()}}}};wr.prototype._clickToSetFocusPoint=function(e){for(var t=this.renderer,i=t.viewport,r=this.views.length-1;r>=0;r--){var n=this.views[r];if(n.hasDOF()&&n.containPoint(e.offsetX,e.offsetY)){this._picking.scene=n.scene,this._picking.camera=n.camera,t.viewport=n.viewport;var o=this._picking.pick(e.offsetX,e.offsetY,!0);if(o)return o.view=n,o}}t.viewport=i};wr.prototype.onglobalout=function(e){var t=this._hovered;t&&this._dispatchEvent("mouseout",e,{target:t.target})};wr.prototype.pickObject=function(e,t){for(var i=[],r=this.renderer,n=r.viewport,o=0;o<this.views.length;o++){var a=this.views[o];a.containPoint(e,t)&&(this._picking.scene=a.scene,this._picking.camera=a.camera,r.viewport=a.viewport,this._picking.pickAll(e,t,i))}return r.viewport=n,i.sort(function(s,c){return s.distance-c.distance}),i[0]};wr.prototype._dispatchEvent=function(e,t,i){i||(i={});var r=i.target;for(i.cancelBubble=!1,i.event=t,i.type=e,i.offsetX=t.offsetX,i.offsetY=t.offsetY;r&&(r.trigger(e,i),r=r.getParent(),!i.cancelBubble););this._dispatchToView(e,i)};wr.prototype._dispatchDataEvent=function(e,t,i){var r=i&&i.target,n=r&&r.dataIndex,o=r&&r.seriesIndex,a=r&&r.eventData,s=!1,c=this._zrEventProxy;c.x=t.offsetX,c.y=t.offsetY,c.update();var l={target:c};let d=yr.getECData(c);e==="mousemove"&&(n!=null?n!==this._lastDataIndex&&(parseInt(this._lastDataIndex,10)>=0&&(d.dataIndex=this._lastDataIndex,d.seriesIndex=this._lastSeriesIndex,this.zr.handler.dispatchToElement(l,"mouseout",t)),s=!0):a!=null&&a!==this._lastEventData&&(this._lastEventData!=null&&(d.eventData=this._lastEventData,this.zr.handler.dispatchToElement(l,"mouseout",t)),s=!0),this._lastEventData=a,this._lastDataIndex=n,this._lastSeriesIndex=o),d.eventData=a,d.dataIndex=n,d.seriesIndex=o,(a!=null||parseInt(n,10)>=0&&parseInt(o,10)>=0)&&(this.zr.handler.dispatchToElement(l,e,t),s&&this.zr.handler.dispatchToElement(l,"mouseover",t))};wr.prototype._dispatchToView=function(e,t){for(var i=0;i<this.views.length;i++)this.views[i].containPoint(t.offsetX,t.offsetY)&&this.views[i].trigger(e,t)};Object.assign(wr.prototype,Jp);var wS=wr;var lte=["bar3D","line3D","map3D","scatter3D","surface","lines3D","scatterGL","scatter3D"];function hv(e,t){if(e&&e[t]&&(e[t].normal||e[t].emphasis)){var i=e[t].normal,r=e[t].emphasis;i&&(e[t]=i),r&&(e.emphasis=e.emphasis||{},e.emphasis[t]=r)}}function cte(e){hv(e,"itemStyle"),hv(e,"lineStyle"),hv(e,"areaStyle"),hv(e,"label")}function ex(e){e&&(e instanceof Array||(e=[e]),Re.each(e,function(t){if(t.axisLabel){var i=t.axisLabel;Object.assign(i,i.textStyle),i.textStyle=null}}))}function LL(e){Re.each(e.series,function(t){Re.indexOf(lte,t.type)>=0&&(cte(t),t.coordinateSystem==="mapbox"&&(t.coordinateSystem="mapbox3D",e.mapbox3D=e.mapbox))}),ex(e.xAxis3D),ex(e.yAxis3D),ex(e.zAxis3D),ex(e.grid3D),hv(e.geo3D)}function BL(e){this._layers={},this._zr=e}BL.prototype.update=function(e,t){var i=this,r=t.getZr();if(!r.getWidth()||!r.getHeight()){console.warn("Dom has no width or height");return}function n(s){r.setSleepAfterStill(0);var c;s.coordinateSystem&&s.coordinateSystem.model,c=s.get("zlevel");var l=i._layers,d=l[c];if(!d){if(d=l[c]=new wS("gl-"+c,r),r.painter.isSingleCanvas()){d.virtual=!0;var u=new Dn.Image({z:1e4,style:{image:d.renderer.canvas},silent:!0});d.__hostImage=u,r.add(u)}r.painter.insertLayer(c,d)}return d.__hostImage&&d.__hostImage.setStyle({width:d.renderer.getWidth(),height:d.renderer.getHeight()}),d}function o(s,c){s&&s.traverse(function(l){l.isRenderable&&l.isRenderable()&&(l.ignorePicking=l.$ignorePicking!=null?l.$ignorePicking:c)})}for(var a in this._layers)this._layers[a].removeViewsAll();e.eachComponent(function(s,c){if(s!=="series"){var l=t.getViewOfComponentModel(c),d=c.coordinateSystem;if(l.__ecgl__){var u;if(d){if(!d.viewGL){console.error("Can't find viewGL in coordinateSystem of component "+c.id);return}u=d.viewGL}else{if(!c.viewGL){console.error("Can't find viewGL of component "+c.id);return}u=d.viewGL}var u=d.viewGL,h=n(c);h.addView(u),l.afterRender&&l.afterRender(c,e,t,h),o(l.groupGL,c.get("silent"))}}}),e.eachSeries(function(s){var c=t.getViewOfSeriesModel(s),l=s.coordinateSystem;if(c.__ecgl__){if(l&&!l.viewGL&&!c.viewGL){console.error("Can't find viewGL of series "+c.id);return}var d=l&&l.viewGL||c.viewGL,u=n(s);u.addView(d),c.afterRender&&c.afterRender(s,e,t,u),o(c.groupGL,s.get("silent"))}})};aR(function(e){var t=e.getZr(),i=t.painter.dispose;t.painter.dispose=function(){this.eachOtherLayer(function(r){r instanceof wS&&r.dispose()}),i.call(this)},t.painter.getRenderedCanvas=function(r){if(r=r||{},this._singleCanvas)return this._layers[0].dom;var n=document.createElement("canvas"),o=r.pixelRatio||this.dpr;n.width=this.getWidth()*o,n.height=this.getHeight()*o;var a=n.getContext("2d");a.dpr=o,a.clearRect(0,0,n.width,n.height),r.backgroundColor&&(a.fillStyle=r.backgroundColor,a.fillRect(0,0,n.width,n.height));var s=this.storage.getDisplayList(!0),c={},l,d=this;function u(f,g){var v=d._zlevelList;f==null&&(f=-1/0);for(var _,b=0;b<v.length;b++){var y=v[b],x=d._layers[y];if(!x.__builtin__&&y>f&&y<g){_=x;break}}_&&_.renderToCanvas&&(a.save(),_.renderToCanvas(a),a.restore())}for(var h={ctx:a},p=0;p<s.length;p++){var m=s[p];m.zlevel!==l&&(u(l,m.zlevel),l=m.zlevel),this._doPaintEl(m,h,!0,null,c)}return u(l,1/0),n}});sR(function(e,t){var i=t.getZr(),r=i.__egl=i.__egl||new BL(i);r.update(e,t)});oR(LL);var Ad={defaultOption:{viewControl:{projection:"perspective",autoRotate:!1,autoRotateDirection:"cw",autoRotateSpeed:10,autoRotateAfterStill:3,damping:.8,rotateSensitivity:1,zoomSensitivity:1,panSensitivity:1,panMouseButton:"middle",rotateMouseButton:"left",distance:150,minDistance:40,maxDistance:400,orthographicSize:150,maxOrthographicSize:400,minOrthographicSize:20,center:[0,0,0],alpha:0,beta:0,minAlpha:-90,maxAlpha:90}},setView:function(e){e=e||{},this.option.viewControl=this.option.viewControl||{},e.alpha!=null&&(this.option.viewControl.alpha=e.alpha),e.beta!=null&&(this.option.viewControl.beta=e.beta),e.distance!=null&&(this.option.viewControl.distance=e.distance),e.center!=null&&(this.option.viewControl.center=e.center)}};var Is={defaultOption:{postEffect:{enable:!1,bloom:{enable:!0,intensity:.1},depthOfField:{enable:!1,focalRange:20,focalDistance:50,blurRadius:10,fstop:2.8,quality:"medium"},screenSpaceAmbientOcclusion:{enable:!1,radius:2,quality:"medium",intensity:1},screenSpaceReflection:{enable:!1,quality:"medium",maxRoughness:.8},colorCorrection:{enable:!0,exposure:0,brightness:0,contrast:1,saturation:1,lookupTexture:""},edge:{enable:!1},FXAA:{enable:!1}},temporalSuperSampling:{enable:"auto"}}};var Ms={defaultOption:{light:{main:{shadow:!1,shadowQuality:"high",color:"#fff",intensity:1,alpha:0,beta:0},ambient:{color:"#fff",intensity:.2},ambientCubemap:{texture:null,exposure:1,diffuseIntensity:.5,specularIntensity:.5}}}};var tx=Es.extend({type:"grid3D",dependencies:["xAxis3D","yAxis3D","zAxis3D"],defaultOption:{show:!0,zlevel:-10,left:0,top:0,width:"100%",height:"100%",environment:"auto",boxWidth:100,boxHeight:100,boxDepth:100,axisPointer:{show:!0,lineStyle:{color:"rgba(0, 0, 0, 0.8)",width:1},label:{show:!0,formatter:null,margin:8,textStyle:{fontSize:14,color:"#fff",backgroundColor:"rgba(0,0,0,0.5)",padding:3,borderRadius:3}}},axisLine:{show:!0,lineStyle:{color:"#333",width:2,type:"solid"}},axisTick:{show:!0,inside:!1,length:3,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,margin:8,textStyle:{fontSize:12}},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}},light:{main:{alpha:30,beta:40},ambient:{intensity:.4}},viewControl:{alpha:20,beta:40,autoRotate:!1,distance:200,minDistance:40,maxDistance:400}}});Re.merge(tx.prototype,Ad);Re.merge(tx.prototype,Is);Re.merge(tx.prototype,Ms);var VL=tx;var pv=St.firstNotNull,zL={left:0,middle:1,right:2};function UL(e){return e instanceof Array||(e=[e,e]),e}var HL=fr.extend(function(){return{zr:null,viewGL:null,_center:new Fe,minDistance:.5,maxDistance:1.5,maxOrthographicSize:300,minOrthographicSize:30,minAlpha:-90,maxAlpha:90,minBeta:-1/0,maxBeta:1/0,autoRotateAfterStill:0,autoRotateDirection:"cw",autoRotateSpeed:60,damping:.8,rotateSensitivity:1,zoomSensitivity:1,panSensitivity:1,panMouseButton:"middle",rotateMouseButton:"left",_mode:"rotate",_camera:null,_needsUpdate:!1,_rotating:!1,_phi:0,_theta:0,_mouseX:0,_mouseY:0,_rotateVelocity:new Vn,_panVelocity:new Vn,_distance:500,_zoomSpeed:0,_stillTimeout:0,_animators:[]}},function(){["_mouseDownHandler","_mouseWheelHandler","_mouseMoveHandler","_mouseUpHandler","_pinchHandler","_contextMenuHandler","_update"].forEach(function(e){this[e]=this[e].bind(this)},this)},{init:function(){var e=this.zr;e&&(e.on("mousedown",this._mouseDownHandler),e.on("globalout",this._mouseUpHandler),e.on("mousewheel",this._mouseWheelHandler),e.on("pinch",this._pinchHandler),e.animation.on("frame",this._update),e.dom.addEventListener("contextmenu",this._contextMenuHandler))},dispose:function(){var e=this.zr;e&&(e.off("mousedown",this._mouseDownHandler),e.off("mousemove",this._mouseMoveHandler),e.off("mouseup",this._mouseUpHandler),e.off("mousewheel",this._mouseWheelHandler),e.off("pinch",this._pinchHandler),e.off("globalout",this._mouseUpHandler),e.dom.removeEventListener("contextmenu",this._contextMenuHandler),e.animation.off("frame",this._update)),this.stopAllAnimation()},getDistance:function(){return this._distance},setDistance:function(e){this._distance=e,this._needsUpdate=!0},getOrthographicSize:function(){return this._orthoSize},setOrthographicSize:function(e){this._orthoSize=e,this._needsUpdate=!0},getAlpha:function(){return this._theta/Math.PI*180},getBeta:function(){return-this._phi/Math.PI*180},getCenter:function(){return this._center.toArray()},setAlpha:function(e){e=Math.max(Math.min(this.maxAlpha,e),this.minAlpha),this._theta=e/180*Math.PI,this._needsUpdate=!0},setBeta:function(e){e=Math.max(Math.min(this.maxBeta,e),this.minBeta),this._phi=-e/180*Math.PI,this._needsUpdate=!0},setCenter:function(e){this._center.setArray(e)},setViewGL:function(e){this.viewGL=e},getCamera:function(){return this.viewGL.camera},setFromViewControlModel:function(e,t){t=t||{};var i=t.baseDistance||0,r=t.baseOrthoSize||1,n=e.get("projection");n!=="perspective"&&n!=="orthographic"&&n!=="isometric"&&(n="perspective"),this._projection=n,this.viewGL.setProjection(n);var o=e.get("distance")+i,a=e.get("orthographicSize")+r;[["damping",.8],["autoRotate",!1],["autoRotateAfterStill",3],["autoRotateDirection","cw"],["autoRotateSpeed",10],["minDistance",30],["maxDistance",400],["minOrthographicSize",30],["maxOrthographicSize",300],["minAlpha",-90],["maxAlpha",90],["minBeta",-1/0],["maxBeta",1/0],["rotateSensitivity",1],["zoomSensitivity",1],["panSensitivity",1],["panMouseButton","left"],["rotateMouseButton","middle"]].forEach(function(h){this[h[0]]=pv(e.get(h[0]),h[1])},this),this.minDistance+=i,this.maxDistance+=i,this.minOrthographicSize+=r,this.maxOrthographicSize+=r;var s=e.ecModel,c={};["animation","animationDurationUpdate","animationEasingUpdate"].forEach(function(h){c[h]=pv(e.get(h),s&&s.get(h))});var l=pv(t.alpha,e.get("alpha"))||0,d=pv(t.beta,e.get("beta"))||0,u=pv(t.center,e.get("center"))||[0,0,0];c.animation&&c.animationDurationUpdate>0&&this._notFirst?this.animateTo({alpha:l,beta:d,center:u,distance:o,orthographicSize:a,easing:c.animationEasingUpdate,duration:c.animationDurationUpdate}):(this.setDistance(o),this.setAlpha(l),this.setBeta(d),this.setCenter(u),this.setOrthographicSize(a)),this._notFirst=!0,this._validateProperties()},_validateProperties:function(){},animateTo:function(e){var t=this.zr,i=this,r={},n={};return e.distance!=null&&(r.distance=this.getDistance(),n.distance=e.distance),e.orthographicSize!=null&&(r.orthographicSize=this.getOrthographicSize(),n.orthographicSize=e.orthographicSize),e.alpha!=null&&(r.alpha=this.getAlpha(),n.alpha=e.alpha),e.beta!=null&&(r.beta=this.getBeta(),n.beta=e.beta),e.center!=null&&(r.center=this.getCenter(),n.center=e.center),this._addAnimator(t.animation.animate(r).when(e.duration||1e3,n).during(function(){r.alpha!=null&&i.setAlpha(r.alpha),r.beta!=null&&i.setBeta(r.beta),r.distance!=null&&i.setDistance(r.distance),r.center!=null&&i.setCenter(r.center),r.orthographicSize!=null&&i.setOrthographicSize(r.orthographicSize),i._needsUpdate=!0})).start(e.easing||"linear")},stopAllAnimation:function(){for(var e=0;e<this._animators.length;e++)this._animators[e].stop();this._animators.length=0},update:function(){this._needsUpdate=!0,this._update(20)},_isAnimating:function(){return this._animators.length>0},_update:function(e){if(this._rotating){var t=(this.autoRotateDirection==="cw"?1:-1)*this.autoRotateSpeed/180*Math.PI;this._phi-=t*e/1e3,this._needsUpdate=!0}else this._rotateVelocity.len()>0&&(this._needsUpdate=!0);(Math.abs(this._zoomSpeed)>.1||this._panVelocity.len()>0)&&(this._needsUpdate=!0),this._needsUpdate&&(e=Math.min(e,50),this._updateDistanceOrSize(e),this._updatePan(e),this._updateRotate(e),this._updateTransform(),this.getCamera().update(),this.zr&&this.zr.refresh(),this.trigger("update"),this._needsUpdate=!1)},_updateRotate:function(e){var t=this._rotateVelocity;this._phi=t.y*e/20+this._phi,this._theta=t.x*e/20+this._theta,this.setAlpha(this.getAlpha()),this.setBeta(this.getBeta()),this._vectorDamping(t,Math.pow(this.damping,e/16))},_updateDistanceOrSize:function(e){this._projection==="perspective"?this._setDistance(this._distance+this._zoomSpeed*e/20):this._setOrthoSize(this._orthoSize+this._zoomSpeed*e/20),this._zoomSpeed*=Math.pow(this.damping,e/16)},_setDistance:function(e){this._distance=Math.max(Math.min(e,this.maxDistance),this.minDistance)},_setOrthoSize:function(e){this._orthoSize=Math.max(Math.min(e,this.maxOrthographicSize),this.minOrthographicSize);var t=this.getCamera(),i=this._orthoSize,r=i/this.viewGL.viewport.height*this.viewGL.viewport.width;t.left=-r/2,t.right=r/2,t.top=i/2,t.bottom=-i/2},_updatePan:function(e){var t=this._panVelocity,i=this._distance,r=this.getCamera(),n=r.worldTransform.y,o=r.worldTransform.x;this._center.scaleAndAdd(o,-t.x*i/200).scaleAndAdd(n,-t.y*i/200),this._vectorDamping(t,0)},_updateTransform:function(){var e=this.getCamera(),t=new Fe,i=this._theta+Math.PI/2,r=this._phi+Math.PI/2,n=Math.sin(i);t.x=n*Math.cos(r),t.y=-Math.cos(i),t.z=n*Math.sin(r),e.position.copy(this._center).scaleAndAdd(t,this._distance),e.rotation.identity().rotateY(-this._phi).rotateX(-this._theta)},_startCountingStill:function(){clearTimeout(this._stillTimeout);var e=this.autoRotateAfterStill,t=this;!isNaN(e)&&e>0&&(this._stillTimeout=setTimeout(function(){t._rotating=!0},e*1e3))},_vectorDamping:function(e,t){var i=e.len();i=i*t,i<1e-4&&(i=0),e.normalize().scale(i)},_decomposeTransform:function(){if(this.getCamera()){this.getCamera().updateWorldTransform();var e=this.getCamera().worldTransform.z,t=Math.asin(e.y),i=Math.atan2(e.x,e.z);this._theta=t,this._phi=-i,this.setBeta(this.getBeta()),this.setAlpha(this.getAlpha()),this.getCamera().aspect?this._setDistance(this.getCamera().position.dist(this._center)):this._setOrthoSize(this.getCamera().top-this.getCamera().bottom)}},_mouseDownHandler:function(e){if(!e.target&&!this._isAnimating()){var t=e.offsetX,i=e.offsetY;this.viewGL&&!this.viewGL.containPoint(t,i)||(this.zr.on("mousemove",this._mouseMoveHandler),this.zr.on("mouseup",this._mouseUpHandler),e.event.targetTouches?e.event.targetTouches.length===1&&(this._mode="rotate"):e.event.button===zL[this.rotateMouseButton]?this._mode="rotate":e.event.button===zL[this.panMouseButton]?this._mode="pan":this._mode="",this._rotateVelocity.set(0,0),this._rotating=!1,this.autoRotate&&this._startCountingStill(),this._mouseX=e.offsetX,this._mouseY=e.offsetY)}},_mouseMoveHandler:function(e){if(!(e.target&&e.target.__isGLToZRProxy)&&!this._isAnimating()){var t=UL(this.panSensitivity),i=UL(this.rotateSensitivity);this._mode==="rotate"?(this._rotateVelocity.y=(e.offsetX-this._mouseX)/this.zr.getHeight()*2*i[0],this._rotateVelocity.x=(e.offsetY-this._mouseY)/this.zr.getWidth()*2*i[1]):this._mode==="pan"&&(this._panVelocity.x=(e.offsetX-this._mouseX)/this.zr.getWidth()*t[0]*400,this._panVelocity.y=(-e.offsetY+this._mouseY)/this.zr.getHeight()*t[1]*400),this._mouseX=e.offsetX,this._mouseY=e.offsetY,e.event.preventDefault()}},_mouseWheelHandler:function(e){if(!this._isAnimating()){var t=e.event.wheelDelta||-e.event.detail;this._zoomHandler(e,t)}},_pinchHandler:function(e){this._isAnimating()||(this._zoomHandler(e,e.pinchScale>1?1:-1),this._mode="")},_zoomHandler:function(e,t){if(t!==0){var i=e.offsetX,r=e.offsetY;if(!(this.viewGL&&!this.viewGL.containPoint(i,r))){var n;this._projection==="perspective"?n=Math.max(Math.max(Math.min(this._distance-this.minDistance,this.maxDistance-this._distance))/20,.5):n=Math.max(Math.max(Math.min(this._orthoSize-this.minOrthographicSize,this.maxOrthographicSize-this._orthoSize))/20,.5),this._zoomSpeed=(t>0?-1:1)*n*this.zoomSensitivity,this._rotating=!1,this.autoRotate&&this._mode==="rotate"&&this._startCountingStill(),e.event.preventDefault()}}},_mouseUpHandler:function(){this.zr.off("mousemove",this._mouseMoveHandler),this.zr.off("mouseup",this._mouseUpHandler)},_isRightMouseButtonUsed:function(){return this.rotateMouseButton==="right"||this.panMouseButton==="right"},_contextMenuHandler:function(e){this._isRightMouseButtonUsed()&&e.preventDefault()},_addAnimator:function(e){var t=this._animators;return t.push(e),e.done(function(){var i=t.indexOf(e);i>=0&&t.splice(i,1)}),e}});Object.defineProperty(HL.prototype,"autoRotate",{get:function(e){return this._autoRotate},set:function(e){this._autoRotate=e,this._rotating=e}});var Dd=HL;var Rl={convertToDynamicArray:function(e){e&&this.resetOffset();var t=this.attributes;for(var i in t)e||!t[i].value?t[i].value=[]:t[i].value=Array.prototype.slice.call(t[i].value);e||!this.indices?this.indices=[]:this.indices=Array.prototype.slice.call(this.indices)},convertToTypedArray:function(){var e=this.attributes;for(var t in e)e[t].value&&e[t].value.length>0?e[t].value=new Float32Array(e[t].value):e[t].value=null;this.indices&&this.indices.length>0&&(this.indices=this.vertexCount>65535?new Uint32Array(this.indices):new Uint16Array(this.indices)),this.dirty()}};var jL={vec2:Mt,vec3:J,vec4:nt,mat2:Xr,mat2d:ln,mat3:ai,mat4:Ge,quat:Lt};var bi=jL;var ES=bi.vec3,GL=[[0,0],[1,1]],$L=Jt.extend(function(){return{segmentScale:1,dynamic:!0,useNativeLine:!0,attributes:{position:new Jt.Attribute("position","float",3,"POSITION"),positionPrev:new Jt.Attribute("positionPrev","float",3),positionNext:new Jt.Attribute("positionNext","float",3),prevPositionPrev:new Jt.Attribute("prevPositionPrev","float",3),prevPosition:new Jt.Attribute("prevPosition","float",3),prevPositionNext:new Jt.Attribute("prevPositionNext","float",3),offset:new Jt.Attribute("offset","float",1),color:new Jt.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._triangleOffset=0,this._itemVertexOffsets=[]},setVertexCount:function(e){var t=this.attributes;this.vertexCount!==e&&(t.position.init(e),t.color.init(e),this.useNativeLine||(t.positionPrev.init(e),t.positionNext.init(e),t.offset.init(e)),e>65535?this.indices instanceof Uint16Array&&(this.indices=new Uint32Array(this.indices)):this.indices instanceof Uint32Array&&(this.indices=new Uint16Array(this.indices)))},setTriangleCount:function(e){this.triangleCount!==e&&(e===0?this.indices=null:this.indices=this.vertexCount>65535?new Uint32Array(e*3):new Uint16Array(e*3))},_getCubicCurveApproxStep:function(e,t,i,r){var n=ES.dist(e,t)+ES.dist(i,t)+ES.dist(r,i),o=1/(n+1)*this.segmentScale;return o},getCubicCurveVertexCount:function(e,t,i,r){var n=this._getCubicCurveApproxStep(e,t,i,r),o=Math.ceil(1/n);return this.useNativeLine?o*2:o*2+2},getCubicCurveTriangleCount:function(e,t,i,r){var n=this._getCubicCurveApproxStep(e,t,i,r),o=Math.ceil(1/n);return this.useNativeLine?0:o*2},getLineVertexCount:function(){return this.getPolylineVertexCount(GL)},getLineTriangleCount:function(){return this.getPolylineTriangleCount(GL)},getPolylineVertexCount:function(e){var t;if(typeof e=="number")t=e;else{var i=typeof e[0]!="number";t=i?e.length:e.length/3}return this.useNativeLine?(t-1)*2:(t-1)*2+2},getPolylineTriangleCount:function(e){var t;if(typeof e=="number")t=e;else{var i=typeof e[0]!="number";t=i?e.length:e.length/3}return this.useNativeLine?0:Math.max(t-1,0)*2},addCubicCurve:function(e,t,i,r,n,o){o==null&&(o=1);for(var a=e[0],s=e[1],c=e[2],l=t[0],d=t[1],u=t[2],h=i[0],p=i[1],m=i[2],f=r[0],g=r[1],v=r[2],_=this._getCubicCurveApproxStep(e,t,i,r),b=_*_,y=b*_,x=3*_,w=3*b,I=6*b,S=6*y,E=a-l*2+h,N=s-d*2+p,M=c-u*2+m,P=(l-h)*3-a+f,$=(d-p)*3-s+g,R=(u-m)*3-c+v,j=a,B=s,te=c,Z=(l-a)*x+E*w+P*y,ne=(d-s)*x+N*w+$*y,se=(u-c)*x+M*w+R*y,we=E*I+P*S,ie=N*I+$*S,ue=M*I+R*S,Ee=P*S,ye=$*S,Te=R*S,pe=0,be=0,De=Math.ceil(1/_),fe=new Float32Array((De+1)*3),fe=[],Ne=0,be=0;be<De+1;be++)fe[Ne++]=j,fe[Ne++]=B,fe[Ne++]=te,j+=Z,B+=ne,te+=se,Z+=we,ne+=ie,se+=ue,we+=Ee,ie+=ye,ue+=Te,pe+=_,pe>1&&(j=Z>0?Math.min(j,f):Math.max(j,f),B=ne>0?Math.min(B,g):Math.max(B,g),te=se>0?Math.min(te,v):Math.max(te,v));return this.addPolyline(fe,n,o)},addLine:function(e,t,i,r){return this.addPolyline([e,t],i,r)},addPolyline:function(e,t,i,r,n){if(e.length){var o=typeof e[0]!="number";if(n==null&&(n=o?e.length:e.length/3),!(n<2)){r==null&&(r=0),i==null&&(i=1),this._itemVertexOffsets.push(this._vertexOffset);var o=typeof e[0]!="number",a=o?typeof t[0]!="number":t.length/4===n,s=this.attributes.position,c=this.attributes.positionPrev,l=this.attributes.positionNext,d=this.attributes.color,u=this.attributes.offset,h=this.indices,p=this._vertexOffset,m,f;i=Math.max(i,.01);for(var g=r;g<n;g++){if(o)m=e[g],a?f=t[g]:f=t;else{var v=g*3;if(m=m||[],m[0]=e[v],m[1]=e[v+1],m[2]=e[v+2],a){var _=g*4;f=f||[],f[0]=t[_],f[1]=t[_+1],f[2]=t[_+2],f[3]=t[_+3]}else f=t}if(this.useNativeLine?g>1&&(s.copy(p,p-1),d.copy(p,p-1),p++):(g<n-1&&(c.set(p+2,m),c.set(p+3,m)),g>0&&(l.set(p-2,m),l.set(p-1,m)),s.set(p,m),s.set(p+1,m),d.set(p,f),d.set(p+1,f),u.set(p,i/2),u.set(p+1,-i/2),p+=2),this.useNativeLine)d.set(p,f),s.set(p,m),p++;else if(g>0){var b=this._triangleOffset*3,h=this.indices;h[b]=p-4,h[b+1]=p-3,h[b+2]=p-2,h[b+3]=p-3,h[b+4]=p-1,h[b+5]=p-2,this._triangleOffset+=2}}if(!this.useNativeLine){var y=this._vertexOffset,x=this._vertexOffset+n*2;c.copy(y,y+2),c.copy(y+1,y+3),l.copy(x-1,x-3),l.copy(x-2,x-4)}return this._vertexOffset=p,this._vertexOffset}}},setItemColor:function(e,t){for(var i=this._itemVertexOffsets[e],r=e<this._itemVertexOffsets.length-1?this._itemVertexOffsets[e+1]:this._vertexOffset,n=i;n<r;n++)this.attributes.color.set(n,t);this.dirty("color")},currentTriangleOffset:function(){return this._triangleOffset},currentVertexOffset:function(){return this._vertexOffset}});Re.defaults($L.prototype,Rl);var Aa=$L;function ix(e,t,i,r,n,o,a){this._zr=e,this._x=0,this._y=0,this._rowHeight=0,this.width=r,this.height=n,this.offsetX=t,this.offsetY=i,this.dpr=a,this.gap=o}ix.prototype={constructor:ix,clear:function(){this._x=0,this._y=0,this._rowHeight=0},add:function(e,t,i){var r=e.getBoundingRect();t==null&&(t=r.width),i==null&&(i=r.height),t*=this.dpr,i*=this.dpr,this._fitElement(e,t,i);var n=this._x,o=this._y,a=this.width*this.dpr,s=this.height*this.dpr,c=this.gap;if(n+t+c>a&&(n=this._x=0,o+=this._rowHeight+c,this._y=o,this._rowHeight=0),this._x+=t+c,this._rowHeight=Math.max(this._rowHeight,i),o+i+c>s)return null;e.x+=this.offsetX*this.dpr+n,e.y+=this.offsetY*this.dpr+o,this._zr.add(e);var l=[this.offsetX/this.width,this.offsetY/this.height],d=[[n/a+l[0],o/s+l[1]],[(n+t)/a+l[0],(o+i)/s+l[1]]];return d},_fitElement:function(e,t,i){var r=e.getBoundingRect(),n=t/r.width,o=i/r.height;e.x=-r.x*n,e.y=-r.y*o,e.scaleX=n,e.scaleY=o,e.update()}};function WL(e){e=e||{},e.width=e.width||512,e.height=e.height||512,e.devicePixelRatio=e.devicePixelRatio||1,e.gap=e.gap==null?2:e.gap;var t=document.createElement("canvas");t.width=e.width*e.devicePixelRatio,t.height=e.height*e.devicePixelRatio,this._canvas=t,this._texture=new wt({image:t,flipY:!1});var i=this;this._zr=nR.init(t);var r=this._zr.refreshImmediately;this._zr.refreshImmediately=function(){r.call(this),i._texture.dirty(),i.onupdate&&i.onupdate()},this._dpr=e.devicePixelRatio,this._coords={},this.onupdate=e.onupdate,this._gap=e.gap,this._textureAtlasNodes=[new ix(this._zr,0,0,e.width,e.height,this._gap,this._dpr)],this._nodeWidth=e.width,this._nodeHeight=e.height,this._currentNodeIdx=0}WL.prototype={clear:function(){for(var e=0;e<this._textureAtlasNodes.length;e++)this._textureAtlasNodes[e].clear();this._currentNodeIdx=0,this._zr.clear(),this._coords={}},getWidth:function(){return this._width},getHeight:function(){return this._height},getTexture:function(){return this._texture},getDevicePixelRatio:function(){return this._dpr},getZr:function(){return this._zr},_getCurrentNode:function(){return this._textureAtlasNodes[this._currentNodeIdx]},_expand:function(){if(this._currentNodeIdx++,this._textureAtlasNodes[this._currentNodeIdx])return this._textureAtlasNodes[this._currentNodeIdx];var e=4096/this._dpr,t=this._textureAtlasNodes,i=t.length,r=i*this._nodeWidth%e,n=Math.floor(i*this._nodeWidth/e)*this._nodeHeight;if(!(n>=e)){var o=(r+this._nodeWidth)*this._dpr,a=(n+this._nodeHeight)*this._dpr;try{this._zr.resize({width:o,height:a})}catch{this._canvas.width=o,this._canvas.height=a}var s=new ix(this._zr,r,n,this._nodeWidth,this._nodeHeight,this._gap,this._dpr);return this._textureAtlasNodes.push(s),s}},add:function(e,t,i){if(this._coords[e.id])return this._coords[e.id];var r=this._getCurrentNode().add(e,t,i);if(!r){var n=this._expand();if(!n)return;r=n.add(e,t,i)}return this._coords[e.id]=r,r},getCoordsScale:function(){var e=this._dpr;return[this._nodeWidth/this._canvas.width*e,this._nodeHeight/this._canvas.height*e]},getCoords:function(e){return this._coords[e]},dispose:function(){this._zr.dispose()}};var fv=WL;function CS(){}CS.prototype={constructor:CS,setScene:function(e){this._scene=e,this._skybox&&this._skybox.attachScene(this._scene)},initLight:function(e){this._lightRoot=e,this.mainLight=new F.DirectionalLight({shadowBias:.005}),this.ambientLight=new F.AmbientLight,e.add(this.mainLight),e.add(this.ambientLight)},dispose:function(){this._lightRoot&&(this._lightRoot.remove(this.mainLight),this._lightRoot.remove(this.ambientLight))},updateLight:function(e){var t=this.mainLight,i=this.ambientLight,r=e.getModel("light"),n=r.getModel("main"),o=r.getModel("ambient");t.intensity=n.get("intensity"),i.intensity=o.get("intensity"),t.color=F.parseColor(n.get("color")).slice(0,3),i.color=F.parseColor(o.get("color")).slice(0,3);var a=n.get("alpha")||0,s=n.get("beta")||0;t.position.setArray(F.directionFromAlphaBeta(a,s)),t.lookAt(F.Vector3.ZERO),t.castShadow=n.get("shadow"),t.shadowResolution=F.getShadowResolution(n.get("shadowQuality"))},updateAmbientCubemap:function(e,t,i){var r=t.getModel("light.ambientCubemap"),n=r.get("texture");if(n){this._cubemapLightsCache=this._cubemapLightsCache||{};var o=this._cubemapLightsCache[n];if(!o){var a=this;o=this._cubemapLightsCache[n]=F.createAmbientCubemap(r.option,e,i,function(){a._isSkyboxFromAmbientCubemap&&a._skybox.setEnvironmentMap(o.specular.cubemap),i.getZr().refresh()})}this._lightRoot.add(o.diffuse),this._lightRoot.add(o.specular),this._currentCubemapLights=o}else this._currentCubemapLights&&(this._lightRoot.remove(this._currentCubemapLights.diffuse),this._lightRoot.remove(this._currentCubemapLights.specular),this._currentCubemapLights=null)},updateSkybox:function(e,t,i){var r=t.get("environment"),n=this;function o(){return n._skybox=n._skybox||new Td,n._skybox}var a=o();if(r&&r!=="none")if(r==="auto")if(this._isSkyboxFromAmbientCubemap=!0,this._currentCubemapLights){var s=this._currentCubemapLights.specular.cubemap;a.setEnvironmentMap(s),this._scene&&a.attachScene(this._scene),a.material.set("lod",3)}else this._skybox&&this._skybox.detachScene();else if(typeof r=="object"&&r.colorStops||typeof r=="string"&&Ml.parse(r)){this._isSkyboxFromAmbientCubemap=!1;var c=new F.Texture2D({anisotropic:8,flipY:!1});a.setEnvironmentMap(c);var l=c.image=document.createElement("canvas");l.width=l.height=16;var d=l.getContext("2d"),u=new Dn.Rect({shape:{x:0,y:0,width:16,height:16},style:{fill:r}});Wb(d,u),a.attachScene(this._scene)}else{this._isSkyboxFromAmbientCubemap=!1;var c=F.loadTexture(r,i,{anisotropic:8,flipY:!1});a.setEnvironmentMap(c),a.attachScene(this._scene)}else this._skybox&&this._skybox.detachScene(this._scene),this._skybox=null;var h=t.coordinateSystem;if(this._skybox)if(h&&h.viewGL&&r!=="auto"&&!(r.match&&r.match(/.hdr$/))){var p=h.viewGL.isLinearSpace()?"define":"undefine";this._skybox.material[p]("fragment","SRGB_DECODE")}else this._skybox.material.undefine("fragment","SRGB_DECODE")}};var ks=CS;var ph=bi.vec3,qL=Jt.extend(function(){return{segmentScale:1,useNativeLine:!0,attributes:{position:new Jt.Attribute("position","float",3,"POSITION"),normal:new Jt.Attribute("normal","float",3,"NORMAL"),color:new Jt.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setQuadCount:function(e){var t=this.attributes,i=this.getQuadVertexCount()*e,r=this.getQuadTriangleCount()*e;this.vertexCount!==i&&(t.position.init(i),t.normal.init(i),t.color.init(i)),this.triangleCount!==r&&(this.indices=i>65535?new Uint32Array(r*3):new Uint16Array(r*3))},getQuadVertexCount:function(){return 4},getQuadTriangleCount:function(){return 2},addQuad:function(){var e=ph.create(),t=ph.create(),i=ph.create(),r=[0,3,1,3,2,1];return function(n,o){var a=this.attributes.position,s=this.attributes.normal,c=this.attributes.color;ph.sub(e,n[1],n[0]),ph.sub(t,n[2],n[1]),ph.cross(i,e,t),ph.normalize(i,i);for(var l=0;l<4;l++)a.set(this._vertexOffset+l,n[l]),c.set(this._vertexOffset+l,o),s.set(this._vertexOffset+l,i);for(var d=this._faceOffset*3,l=0;l<6;l++)this.indices[d+l]=r[l]+this._vertexOffset;this._vertexOffset+=4,this._faceOffset+=2}}()});Re.defaults(qL.prototype,Rl);var XL=qL;var SS=St.firstNotNull,dte={x:0,y:2,z:1};function ute(e,t,i,r){var n=[0,0,0],o=r<0?i.getExtentMin():i.getExtentMax();n[dte[i.dim]]=o,e.position.setArray(n),e.rotation.identity(),t.distance=-Math.abs(o),t.normal.set(0,0,0),i.dim==="x"?(e.rotation.rotateY(r*Math.PI/2),t.normal.x=-r):i.dim==="z"?(e.rotation.rotateX(-r*Math.PI/2),t.normal.y=-r):(r>0&&e.rotation.rotateY(Math.PI),t.normal.z=-r)}function rx(e,t,i){this.rootNode=new F.Node;var r=new F.Mesh({geometry:new Aa({useNativeLine:!1}),material:t,castShadow:!1,ignorePicking:!0,$ignorePicking:!0,renderOrder:1}),n=new F.Mesh({geometry:new XL,material:i,castShadow:!1,culling:!1,ignorePicking:!0,$ignorePicking:!0,renderOrder:0});this.rootNode.add(n),this.rootNode.add(r),this.faceInfo=e,this.plane=new F.Plane,this.linesMesh=r,this.quadsMesh=n}rx.prototype.update=function(e,t,i){var r=e.coordinateSystem,n=[r.getAxis(this.faceInfo[0]),r.getAxis(this.faceInfo[1])],o=this.linesMesh.geometry,a=this.quadsMesh.geometry;o.convertToDynamicArray(!0),a.convertToDynamicArray(!0),this._updateSplitLines(o,n,e,i),this._udpateSplitAreas(a,n,e,i),o.convertToTypedArray(),a.convertToTypedArray();var s=r.getAxis(this.faceInfo[2]);ute(this.rootNode,this.plane,s,this.faceInfo[3])};rx.prototype._updateSplitLines=function(e,t,i,r){var n=r.getDevicePixelRatio();t.forEach(function(o,a){var s=o.model,c=t[1-a].getExtent();if(!o.scale.isBlank()){var l=s.getModel("splitLine",i.getModel("splitLine"));if(l.get("show")){var d=l.getModel("lineStyle"),u=d.get("color"),h=SS(d.get("opacity"),1),p=SS(d.get("width"),1);u=Re.isArray(u)?u:[u];for(var m=o.getTicksCoords({tickModel:l}),f=0,g=0;g<m.length;g++){var v=m[g].coord,_=F.parseColor(u[f%u.length]);_[3]*=h;var b=[0,0,0],y=[0,0,0];b[a]=y[a]=v,b[1-a]=c[0],y[1-a]=c[1],e.addLine(b,y,_,p*n),f++}}}})};rx.prototype._udpateSplitAreas=function(e,t,i,r){t.forEach(function(n,o){var a=n.model,s=t[1-o].getExtent();if(!n.scale.isBlank()){var c=a.getModel("splitArea",i.getModel("splitArea"));if(c.get("show")){var l=c.getModel("areaStyle"),d=l.get("color"),u=SS(l.get("opacity"),1);d=Re.isArray(d)?d:[d];for(var h=n.getTicksCoords({tickModel:c,clamp:!0}),p=0,m=[0,0,0],f=[0,0,0],g=0;g<h.length;g++){var v=h[g].coord,_=[0,0,0],b=[0,0,0];if(_[o]=b[o]=v,_[1-o]=s[0],b[1-o]=s[1],g===0){m=_,f=b;continue}var y=F.parseColor(d[p%d.length]);y[3]*=u,e.addQuad([m,_,b,f],y),m=_,f=b,p++}}}})};var YL=rx;var ZL=[0,1,2,0,2,3],KL=Jt.extend(function(){return{attributes:{position:new Jt.Attribute("position","float",3,"POSITION"),texcoord:new Jt.Attribute("texcoord","float",2,"TEXCOORD_0"),offset:new Jt.Attribute("offset","float",2),color:new Jt.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setSpriteCount:function(e){this._spriteCount=e;var t=e*4,i=e*2;this.vertexCount!==t&&(this.attributes.position.init(t),this.attributes.offset.init(t),this.attributes.color.init(t)),this.triangleCount!==i&&(this.indices=t>65535?new Uint32Array(i*3):new Uint16Array(i*3))},setSpriteAlign:function(e,t,i,r,n){i==null&&(i="left"),r==null&&(r="top");var o,a,s,c;switch(n=n||0,i){case"left":o=n,s=t[0]+n;break;case"center":case"middle":o=-t[0]/2,s=t[0]/2;break;case"right":o=-t[0]-n,s=-n;break}switch(r){case"bottom":a=n,c=t[1]+n;break;case"middle":a=-t[1]/2,c=t[1]/2;break;case"top":a=-t[1]-n,c=-n;break}var l=e*4,d=this.attributes.offset;d.set(l,[o,c]),d.set(l+1,[s,c]),d.set(l+2,[s,a]),d.set(l+3,[o,a])},addSprite:function(e,t,i,r,n,o){var a=this._vertexOffset;this.setSprite(this._vertexOffset/4,e,t,i,r,n,o);for(var s=0;s<ZL.length;s++)this.indices[this._faceOffset*3+s]=ZL[s]+a;return this._faceOffset+=2,this._vertexOffset+=4,a/4},setSprite:function(e,t,i,r,n,o,a){for(var s=e*4,c=this.attributes,l=0;l<4;l++)c.position.set(s+l,t);var d=c.texcoord;d.set(s,[r[0][0],r[0][1]]),d.set(s+1,[r[1][0],r[0][1]]),d.set(s+2,[r[1][0],r[1][1]]),d.set(s+3,[r[0][0],r[1][1]]),this.setSpriteAlign(e,i,n,o,a)}});Re.defaults(KL.prototype,Rl);var QL=KL;var JL=`@export ecgl.labels.vertex

attribute vec3 position: POSITION;
attribute vec2 texcoord: TEXCOORD_0;
attribute vec2 offset;
#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;

varying vec2 v_Texcoord;

void main()
{
 vec4 proj = worldViewProjection * vec4(position, 1.0);

 vec2 screen = (proj.xy / abs(proj.w) + 1.0) * 0.5 * viewport.zw;

 screen += offset;

 proj.xy = (screen / viewport.zw - 0.5) * 2.0 * abs(proj.w);
 gl_Position = proj;
#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif
 v_Texcoord = texcoord;
}
@end


@export ecgl.labels.fragment

uniform vec3 color : [1.0, 1.0, 1.0];
uniform float alpha : 1.0;
uniform sampler2D textureAtlas;
uniform vec2 uvScale: [1.0, 1.0];

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif
varying float v_Miter;

varying vec2 v_Texcoord;

void main()
{
 gl_FragColor = vec4(color, alpha) * texture2D(textureAtlas, v_Texcoord * uvScale);
#ifdef VERTEX_COLOR
 gl_FragColor *= v_Color;
#endif
}

@end`;F.Shader.import(JL);var vf=F.Mesh.extend(function(){var e=new QL({dynamic:!0}),t=new F.Material({shader:F.createShader("ecgl.labels"),transparent:!0,depthMask:!1});return{geometry:e,material:t,culling:!1,castShadow:!1,ignorePicking:!0}});var fh=St.firstNotNull,mh={x:0,y:2,z:1};function AS(e,t){var i=new F.Mesh({geometry:new Aa({useNativeLine:!1}),material:t,castShadow:!1,ignorePicking:!0,renderOrder:2}),r=new vf;r.material.depthMask=!1;var n=new F.Node;n.add(i),n.add(r),this.rootNode=n,this.dim=e,this.linesMesh=i,this.labelsMesh=r,this.axisLineCoords=null,this.labelElements=[]}var TS={x:"y",y:"x",z:"y"};AS.prototype.update=function(e,t,i){var r=e.coordinateSystem,n=r.getAxis(this.dim),o=this.linesMesh.geometry,a=this.labelsMesh.geometry;o.convertToDynamicArray(!0),a.convertToDynamicArray(!0);var s=n.model,c=n.getExtent(),M=i.getDevicePixelRatio(),l=s.getModel("axisLine",e.getModel("axisLine")),d=s.getModel("axisTick",e.getModel("axisTick")),u=s.getModel("axisLabel",e.getModel("axisLabel")),h=l.get("lineStyle.color");if(l.get("show")){var p=l.getModel("lineStyle"),m=[0,0,0],f=[0,0,0],g=mh[n.dim];m[g]=c[0],f[g]=c[1],this.axisLineCoords=[m,f];var v=F.parseColor(h),_=fh(p.get("width"),1),b=fh(p.get("opacity"),1);v[3]*=b,o.addLine(m,f,v,_*M)}if(d.get("show")){var y=d.getModel("lineStyle"),x=F.parseColor(fh(y.get("color"),h)),_=fh(y.get("width"),1);x[3]*=fh(y.get("opacity"),1);for(var w=n.getTicksCoords(),I=d.get("length"),S=0;S<w.length;S++){var E=w[S].coord,m=[0,0,0],f=[0,0,0],g=mh[n.dim],N=mh[TS[n.dim]];m[g]=f[g]=E,f[N]=I,o.addLine(m,f,x,_*M)}}this.labelElements=[];var M=i.getDevicePixelRatio();if(u.get("show"))for(var w=n.getTicksCoords(),P=s.get("data"),$=u.get("margin"),R=n.getViewLabels(),S=0;S<R.length;S++){var j=R[S].tickValue,B=R[S].formattedLabel,te=R[S].rawLabel,E=n.dataToCoord(j),Z=[0,0,0],g=mh[n.dim],N=mh[TS[n.dim]];Z[g]=Z[g]=E,Z[N]=$;var ne=u;P&&P[j]&&P[j].textStyle&&(ne=new gd(P[j].textStyle,u,s.ecModel));var se=fh(ne.get("color"),h),we=new Dn.Text({style:ih(ne,{text:B,fill:typeof se=="function"?se(n.type==="category"?te:n.type==="value"?j+"":j,S):se,verticalAlign:"top",align:"left"})}),ie=t.add(we),ue=we.getBoundingRect();a.addSprite(Z,[ue.width*M,ue.height*M],ie),this.labelElements.push(we)}if(s.get("name")){var Ee=s.getModel("nameTextStyle"),Z=[0,0,0],g=mh[n.dim],N=mh[TS[n.dim]],ye=fh(Ee.get("color"),h),Te=Ee.get("borderColor"),_=Ee.get("borderWidth");Z[g]=Z[g]=(c[0]+c[1])/2,Z[N]=s.get("nameGap");var we=new Dn.Text({style:ih(Ee,{text:s.get("name"),fill:ye,stroke:Te,lineWidth:_})}),ie=t.add(we),ue=we.getBoundingRect();a.addSprite(Z,[ue.width*M,ue.height*M],ie),we.__idx=this.labelElements.length,this.nameLabelElement=we}this.labelsMesh.material.set("textureAtlas",t.getTexture()),this.labelsMesh.material.set("uvScale",t.getCoordsScale()),o.convertToTypedArray(),a.convertToTypedArray()};AS.prototype.setSpriteAlign=function(e,t,i){for(var r=i.getDevicePixelRatio(),n=this.labelsMesh.geometry,o=0;o<this.labelElements.length;o++){var a=this.labelElements[o],s=a.getBoundingRect();n.setSpriteAlign(o,[s.width*r,s.height*r],e,t)}var c=this.nameLabelElement;if(c){var s=c.getBoundingRect();n.setSpriteAlign(c.__idx,[s.width*r,s.height*r],e,t),n.dirty()}this.textAlign=e,this.textVerticalAlign=t};var e4=AS;var Id=`@export ecgl.lines3D.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec3 position: POSITION;
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;

void main()
{
 gl_Position = worldViewProjection * vec4(position, 1.0);
 v_Color = a_Color;
}

@end

@export ecgl.lines3D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;

@import clay.util.srgb

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color * v_Color);
#else
 gl_FragColor = color * v_Color;
#endif
}
@end



@export ecgl.lines3D.clipNear

vec4 clipNear(vec4 p1, vec4 p2) {
 float n = (p1.w - near) / (p1.w - p2.w);
 return vec4(mix(p1.xy, p2.xy, n), -near, near);
}

@end

@export ecgl.lines3D.expandLine
#ifdef VERTEX_ANIMATION
 vec4 prevProj = worldViewProjection * vec4(mix(prevPositionPrev, positionPrev, percent), 1.0);
 vec4 currProj = worldViewProjection * vec4(mix(prevPosition, position, percent), 1.0);
 vec4 nextProj = worldViewProjection * vec4(mix(prevPositionNext, positionNext, percent), 1.0);
#else
 vec4 prevProj = worldViewProjection * vec4(positionPrev, 1.0);
 vec4 currProj = worldViewProjection * vec4(position, 1.0);
 vec4 nextProj = worldViewProjection * vec4(positionNext, 1.0);
#endif

 if (currProj.w < 0.0) {
 if (nextProj.w > 0.0) {
 currProj = clipNear(currProj, nextProj);
 }
 else if (prevProj.w > 0.0) {
 currProj = clipNear(currProj, prevProj);
 }
 }

 vec2 prevScreen = (prevProj.xy / abs(prevProj.w) + 1.0) * 0.5 * viewport.zw;
 vec2 currScreen = (currProj.xy / abs(currProj.w) + 1.0) * 0.5 * viewport.zw;
 vec2 nextScreen = (nextProj.xy / abs(nextProj.w) + 1.0) * 0.5 * viewport.zw;

 vec2 dir;
 float len = offset;
 if (position == positionPrev) {
 dir = normalize(nextScreen - currScreen);
 }
 else if (position == positionNext) {
 dir = normalize(currScreen - prevScreen);
 }
 else {
 vec2 dirA = normalize(currScreen - prevScreen);
 vec2 dirB = normalize(nextScreen - currScreen);

 vec2 tanget = normalize(dirA + dirB);

 float miter = 1.0 / max(dot(tanget, dirA), 0.5);
 len *= miter;
 dir = tanget;
 }

 dir = vec2(-dir.y, dir.x) * len;
 currScreen += dir;

 currProj.xy = (currScreen / viewport.zw - 0.5) * 2.0 * abs(currProj.w);
@end


@export ecgl.meshLines3D.vertex

attribute vec3 position: POSITION;
attribute vec3 positionPrev;
attribute vec3 positionNext;
attribute float offset;
attribute vec4 a_Color : COLOR;

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
attribute vec3 prevPositionPrev;
attribute vec3 prevPositionNext;
uniform float percent : 1.0;
#endif

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;
uniform float near : NEAR;

varying vec4 v_Color;

@import ecgl.common.wireframe.vertexHeader

@import ecgl.lines3D.clipNear

void main()
{
 @import ecgl.lines3D.expandLine

 gl_Position = currProj;

 v_Color = a_Color;

 @import ecgl.common.wireframe.vertexMain
}
@end


@export ecgl.meshLines3D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;

@import ecgl.common.wireframe.fragmentHeader

@import clay.util.srgb

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color * v_Color);
#else
 gl_FragColor = color * v_Color;
#endif

 @import ecgl.common.wireframe.fragmentMain
}

@end`;var t4=St.firstNotNull;F.Shader.import(Id);var gh={x:0,y:2,z:1},i4=kl.extend({type:"grid3D",__ecgl__:!0,init:function(e,t){var i=[["y","z","x",-1,"left"],["y","z","x",1,"right"],["x","y","z",-1,"bottom"],["x","y","z",1,"top"],["x","z","y",-1,"far"],["x","z","y",1,"near"]],r=["x","y","z"],n=new F.Material({shader:F.createShader("ecgl.color"),depthMask:!1,transparent:!0}),o=new F.Material({shader:F.createShader("ecgl.meshLines3D"),depthMask:!1,transparent:!0});n.define("fragment","DOUBLE_SIDED"),n.define("both","VERTEX_COLOR"),this.groupGL=new F.Node,this._control=new Dd({zr:t.getZr()}),this._control.init(),this._faces=i.map(function(s){var c=new YL(s,o,n);return this.groupGL.add(c.rootNode),c},this),this._axes=r.map(function(s){var c=new e4(s,o);return this.groupGL.add(c.rootNode),c},this);var a=t.getDevicePixelRatio();this._axisLabelSurface=new fv({width:256,height:256,devicePixelRatio:a}),this._axisLabelSurface.onupdate=function(){t.getZr().refresh()},this._axisPointerLineMesh=new F.Mesh({geometry:new Aa({useNativeLine:!1}),material:o,castShadow:!1,ignorePicking:!0,renderOrder:3}),this.groupGL.add(this._axisPointerLineMesh),this._axisPointerLabelsSurface=new fv({width:128,height:128,devicePixelRatio:a}),this._axisPointerLabelsMesh=new vf({ignorePicking:!0,renderOrder:4,castShadow:!1}),this._axisPointerLabelsMesh.material.set("textureAtlas",this._axisPointerLabelsSurface.getTexture()),this.groupGL.add(this._axisPointerLabelsMesh),this._lightRoot=new F.Node,this._sceneHelper=new ks,this._sceneHelper.initLight(this._lightRoot)},render:function(e,t,i){this._model=e,this._api=i;var r=e.coordinateSystem;r.viewGL.add(this._lightRoot),e.get("show")?r.viewGL.add(this.groupGL):r.viewGL.remove(this.groupGL);var n=this._control;n.setViewGL(r.viewGL);var o=e.getModel("viewControl");n.setFromViewControlModel(o,0),this._axisLabelSurface.clear(),n.off("update"),e.get("show")&&(this._faces.forEach(function(a){a.update(e,t,i)},this),this._axes.forEach(function(a){a.update(e,this._axisLabelSurface,i)},this)),n.on("update",this._onCameraChange.bind(this,e,i),this),this._sceneHelper.setScene(r.viewGL.scene),this._sceneHelper.updateLight(e),r.viewGL.setPostEffect(e.getModel("postEffect"),i),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._initMouseHandler(e)},afterRender:function(e,t,i,r){var n=r.renderer;this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i)},showAxisPointer:function(e,t,i,r){this._doShowAxisPointer(),this._updateAxisPointer(r.value)},hideAxisPointer:function(e,t,i,r){this._doHideAxisPointer()},_initMouseHandler:function(e){var t=e.coordinateSystem,i=t.viewGL;e.get("show")&&e.get("axisPointer.show")?i.on("mousemove",this._updateAxisPointerOnMousePosition,this):i.off("mousemove",this._updateAxisPointerOnMousePosition)},_updateAxisPointerOnMousePosition:function(e){if(!e.target){for(var t=this._model,i=t.coordinateSystem,r=i.viewGL,n=r.castRay(e.offsetX,e.offsetY,new F.Ray),o,a=0;a<this._faces.length;a++){var s=this._faces[a];if(!s.rootNode.invisible){s.plane.normal.dot(r.camera.worldTransform.z)<0&&s.plane.normal.negate();var c=n.intersectPlane(s.plane);if(c){var l=i.getAxis(s.faceInfo[0]),d=i.getAxis(s.faceInfo[1]),u=gh[s.faceInfo[0]],h=gh[s.faceInfo[1]];l.contain(c.array[u])&&d.contain(c.array[h])&&(o=c)}}}if(o){var p=i.pointToData(o.array,[],!0);this._updateAxisPointer(p),this._doShowAxisPointer()}else this._doHideAxisPointer()}},_onCameraChange:function(e,t){e.get("show")&&(this._updateFaceVisibility(),this._updateAxisLinePosition());var i=this._control;t.dispatchAction({type:"grid3DChangeCamera",alpha:i.getAlpha(),beta:i.getBeta(),distance:i.getDistance(),center:i.getCenter(),from:this.uid,grid3DId:e.id})},_updateFaceVisibility:function(){var e=this._control.getCamera(),t=new F.Vector3;e.update();for(var i=0;i<this._faces.length/2;i++){for(var r=[],n=0;n<2;n++){var o=this._faces[i*2+n];o.rootNode.getWorldPosition(t),t.transformMat4(e.viewMatrix),r[n]=t.z}var a=r[0]>r[1]?0:1,s=this._faces[i*2+a],c=this._faces[i*2+1-a];s.rootNode.invisible=!0,c.rootNode.invisible=!1}},_updateAxisLinePosition:function(){var e=this._model.coordinateSystem,t=e.getAxis("x"),i=e.getAxis("y"),r=e.getAxis("z"),n=r.getExtentMax(),o=r.getExtentMin(),a=t.getExtentMin(),s=t.getExtentMax(),c=i.getExtentMax(),l=i.getExtentMin(),d=this._axes[0].rootNode,u=this._axes[1].rootNode,h=this._axes[2].rootNode,p=this._faces,m=p[4].rootNode.invisible?l:c,f=p[2].rootNode.invisible?n:o,g=p[0].rootNode.invisible?a:s,v=p[2].rootNode.invisible?n:o,_=p[0].rootNode.invisible?s:a,b=p[4].rootNode.invisible?l:c;d.rotation.identity(),u.rotation.identity(),h.rotation.identity(),p[4].rootNode.invisible&&(this._axes[0].flipped=!0,d.rotation.rotateX(Math.PI)),p[0].rootNode.invisible&&(this._axes[1].flipped=!0,u.rotation.rotateZ(Math.PI)),p[4].rootNode.invisible&&(this._axes[2].flipped=!0,h.rotation.rotateY(Math.PI)),d.position.set(0,f,m),u.position.set(g,v,0),h.position.set(_,0,b),d.update(),u.update(),h.update(),this._updateAxisLabelAlign()},_updateAxisLabelAlign:function(){var e=this._control.getCamera(),t=[new F.Vector4,new F.Vector4],i=new F.Vector4;this.groupGL.getWorldPosition(i),i.w=1,i.transformMat4(e.viewMatrix).transformMat4(e.projectionMatrix),i.x/=i.w,i.y/=i.w,this._axes.forEach(function(r){for(var n=r.axisLineCoords,o=r.labelsMesh.geometry,a=0;a<t.length;a++)t[a].setArray(n[a]),t[a].w=1,t[a].transformMat4(r.rootNode.worldTransform).transformMat4(e.viewMatrix).transformMat4(e.projectionMatrix),t[a].x/=t[a].w,t[a].y/=t[a].w;var s=t[1].x-t[0].x,c=t[1].y-t[0].y,l=(t[1].x+t[0].x)/2,d=(t[1].y+t[0].y)/2,u,h;Math.abs(c/s)<.5?(u="center",h=d>i.y?"bottom":"top"):(h="middle",u=l>i.x?"left":"right"),r.setSpriteAlign(u,h,this._api)},this)},_doShowAxisPointer:function(){this._axisPointerLineMesh.invisible&&(this._axisPointerLineMesh.invisible=!1,this._axisPointerLabelsMesh.invisible=!1,this._api.getZr().refresh())},_doHideAxisPointer:function(){this._axisPointerLineMesh.invisible||(this._axisPointerLineMesh.invisible=!0,this._axisPointerLabelsMesh.invisible=!0,this._api.getZr().refresh())},_updateAxisPointer:function(e){var t=this._model.coordinateSystem,i=t.dataToPoint(e),r=this._axisPointerLineMesh,n=r.geometry,o=this._model.getModel("axisPointer"),a=this._api.getDevicePixelRatio();n.convertToDynamicArray(!0);function s(S){return St.firstNotNull(S.model.get("axisPointer.show"),o.get("show"))}function c(S){var E=S.model.getModel("axisPointer",o),N=E.getModel("lineStyle"),M=F.parseColor(N.get("color")),P=t4(N.get("width"),1),$=t4(N.get("opacity"),1);return M[3]*=$,{color:M,lineWidth:P}}for(var l=0;l<this._faces.length;l++){var d=this._faces[l];if(!d.rootNode.invisible){for(var u=d.faceInfo,h=u[3]<0?t.getAxis(u[2]).getExtentMin():t.getAxis(u[2]).getExtentMax(),p=gh[u[2]],m=0;m<2;m++){var f=u[m],g=u[1-m],v=t.getAxis(f),_=t.getAxis(g);if(s(v)){var b=[0,0,0],y=[0,0,0],x=gh[f],w=gh[g];b[x]=y[x]=i[x],b[p]=y[p]=h,b[w]=_.getExtentMin(),y[w]=_.getExtentMax();var I=c(v);n.addLine(b,y,I.color,I.lineWidth*a)}}if(s(t.getAxis(u[2]))){var b=i.slice(),y=i.slice();y[p]=h;var I=c(t.getAxis(u[2]));n.addLine(b,y,I.color,I.lineWidth*a)}}}n.convertToTypedArray(),this._updateAxisPointerLabelsMesh(e),this._api.getZr().refresh()},_updateAxisPointerLabelsMesh:function(e){var t=this._model,i=this._axisPointerLabelsMesh,r=this._axisPointerLabelsSurface,n=t.coordinateSystem,o=t.getModel("axisPointer");i.geometry.convertToDynamicArray(!0),r.clear();var a={x:"y",y:"x",z:"y"};this._axes.forEach(function(s,c){var l=n.getAxis(s.dim),d=l.model,u=d.getModel("axisPointer",o),h=u.getModel("label"),p=u.get("lineStyle.color");if(!(!h.get("show")||!u.get("show"))){var m=e[c],f=h.get("formatter"),g=l.scale.getLabel({value:m});if(f!=null)g=f(g,e);else if(l.scale.type==="interval"||l.scale.type==="log"){var v=qa.getPrecisionSafe(l.scale.getTicks()[0]);g=m.toFixed(v+2)}var _=h.get("color"),b=new Dn.Text({style:ih(h,{text:g,fill:_||p,align:"left",verticalAlign:"top"})}),y=r.add(b),x=b.getBoundingRect(),w=this._api.getDevicePixelRatio(),I=s.rootNode.position.toArray(),S=gh[a[s.dim]];I[S]+=(s.flipped?-1:1)*h.get("margin"),I[gh[s.dim]]=l.dataToCoord(e[c]),i.geometry.addSprite(I,[x.width*w,x.height*w],y,s.textAlign,s.textVerticalAlign)}},this),r.getZr().refreshImmediately(),i.material.set("uvScale",r.getCoordsScale()),i.geometry.convertToTypedArray()},dispose:function(){this.groupGL.removeAll(),this._control.dispose(),this._axisLabelSurface.dispose(),this._axisPointerLabelsSurface.dispose()}});function nx(e){xC.call(this,e),this.type="cartesian3D",this.dimensions=["x","y","z"],this.size=[0,0,0]}nx.prototype={constructor:nx,model:null,containPoint:function(e){return this.getAxis("x").contain(e[0])&&this.getAxis("y").contain(e[2])&&this.getAxis("z").contain(e[1])},containData:function(e){return this.getAxis("x").containData(e[0])&&this.getAxis("y").containData(e[1])&&this.getAxis("z").containData(e[2])},dataToPoint:function(e,t,i){return t=t||[],t[0]=this.getAxis("x").dataToCoord(e[0],i),t[2]=this.getAxis("y").dataToCoord(e[1],i),t[1]=this.getAxis("z").dataToCoord(e[2],i),t},pointToData:function(e,t,i){return t=t||[],t[0]=this.getAxis("x").coordToData(e[0],i),t[1]=this.getAxis("y").coordToData(e[2],i),t[2]=this.getAxis("z").coordToData(e[1],i),t}};Re.inherits(nx,xC);var DS=nx;function ox(e,t,i){rh.call(this,e,t,i)}ox.prototype={constructor:ox,getExtentMin:function(){var e=this._extent;return Math.min(e[0],e[1])},getExtentMax:function(){var e=this._extent;return Math.max(e[0],e[1])},calculateCategoryInterval:function(){return Math.floor(this.scale.count()/8)}};Re.inherits(ox,rh);var r4=ox;var MS=function(){this._pool={},this._allocatedTextures=[]};MS.prototype={constructor:MS,get:function(e){var t=n4(e);this._pool.hasOwnProperty(t)||(this._pool[t]=[]);var i=this._pool[t];if(!i.length){var r=new wt(e);return this._allocatedTextures.push(r),r}return i.pop()},put:function(e){var t=n4(e);this._pool.hasOwnProperty(t)||(this._pool[t]=[]);var i=this._pool[t];i.push(e)},clear:function(e){for(var t=0;t<this._allocatedTextures.length;t++)this._allocatedTextures[t].dispose(e);this._pool={},this._allocatedTextures=[]}};var o4={width:512,height:512,type:me.UNSIGNED_BYTE,format:me.RGBA,wrapS:me.CLAMP_TO_EDGE,wrapT:me.CLAMP_TO_EDGE,minFilter:me.LINEAR_MIPMAP_LINEAR,magFilter:me.LINEAR,useMipmap:!0,anisotropic:1,flipY:!0,unpackAlignment:4,premultiplyAlpha:!1},IS=Object.keys(o4);function n4(e){Wr.defaultsWithPropList(e,o4,IS),hte(e);for(var t="",i=0;i<IS.length;i++){var r=IS[i],n=e[r].toString();t+=n}return t}function hte(e){var t=pte(e.width,e.height);e.format===me.DEPTH_COMPONENT&&(e.useMipmap=!1),(!t||!e.useMipmap)&&(e.minFilter==me.NEAREST_MIPMAP_NEAREST||e.minFilter==me.NEAREST_MIPMAP_LINEAR?e.minFilter=me.NEAREST:(e.minFilter==me.LINEAR_MIPMAP_LINEAR||e.minFilter==me.LINEAR_MIPMAP_NEAREST)&&(e.minFilter=me.LINEAR)),t||(e.wrapS=me.CLAMP_TO_EDGE,e.wrapT=me.CLAMP_TO_EDGE)}function pte(e,t){return(e&e-1)===0&&(t&t-1)===0}var ax=MS;var a4=`@export clay.sm.depth.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;
uniform vec2 uvRepeat = vec2(1.0, 1.0);
uniform vec2 uvOffset = vec2(0.0, 0.0);
@import clay.chunk.skinning_header
@import clay.chunk.instancing_header
varying vec4 v_ViewPosition;
varying vec2 v_Texcoord;
void main(){
 vec4 P = vec4(position, 1.0);
#ifdef SKINNING
 @import clay.chunk.skin_matrix
 P = skinMatrixWS * P;
#endif
#ifdef INSTANCING
 @import clay.chunk.instancing_matrix
 P = instanceMat * P;
#endif
 v_ViewPosition = worldViewProjection * P;
 gl_Position = v_ViewPosition;
 v_Texcoord = texcoord * uvRepeat + uvOffset;
}
@end
@export clay.sm.depth.fragment
varying vec4 v_ViewPosition;
varying vec2 v_Texcoord;
uniform float bias : 0.001;
uniform float slopeScale : 1.0;
uniform sampler2D alphaMap;
uniform float alphaCutoff: 0.0;
@import clay.util.encode_float
void main(){
 float depth = v_ViewPosition.z / v_ViewPosition.w;
 if (alphaCutoff > 0.0) {
 if (texture2D(alphaMap, v_Texcoord).a <= alphaCutoff) {
 discard;
 }
 }
#ifdef USE_VSM
 depth = depth * 0.5 + 0.5;
 float moment1 = depth;
 float moment2 = depth * depth;
 #ifdef SUPPORT_STANDARD_DERIVATIVES
 float dx = dFdx(depth);
 float dy = dFdy(depth);
 moment2 += 0.25*(dx*dx+dy*dy);
 #endif
 gl_FragColor = vec4(moment1, moment2, 0.0, 1.0);
#else
 #ifdef SUPPORT_STANDARD_DERIVATIVES
 float dx = dFdx(depth);
 float dy = dFdy(depth);
 depth += sqrt(dx*dx + dy*dy) * slopeScale + bias;
 #else
 depth += bias;
 #endif
 gl_FragColor = encodeFloat(depth * 0.5 + 0.5);
#endif
}
@end
@export clay.sm.debug_depth
uniform sampler2D depthMap;
varying vec2 v_Texcoord;
@import clay.util.decode_float
void main() {
 vec4 tex = texture2D(depthMap, v_Texcoord);
#ifdef USE_VSM
 gl_FragColor = vec4(tex.rgb, 1.0);
#else
 float depth = decodeFloat(tex);
 gl_FragColor = vec4(depth, depth, depth, 1.0);
#endif
}
@end
@export clay.sm.distance.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform mat4 world : WORLD;
attribute vec3 position : POSITION;
@import clay.chunk.skinning_header
varying vec3 v_WorldPosition;
void main (){
 vec4 P = vec4(position, 1.0);
#ifdef SKINNING
 @import clay.chunk.skin_matrix
 P = skinMatrixWS * P;
#endif
#ifdef INSTANCING
 @import clay.chunk.instancing_matrix
 P = instanceMat * P;
#endif
 gl_Position = worldViewProjection * P;
 v_WorldPosition = (world * P).xyz;
}
@end
@export clay.sm.distance.fragment
uniform vec3 lightPosition;
uniform float range : 100;
varying vec3 v_WorldPosition;
@import clay.util.encode_float
void main(){
 float dist = distance(lightPosition, v_WorldPosition);
#ifdef USE_VSM
 gl_FragColor = vec4(dist, dist * dist, 0.0, 0.0);
#else
 dist = dist / range;
 gl_FragColor = encodeFloat(dist);
#endif
}
@end
@export clay.plugin.shadow_map_common
@import clay.util.decode_float
float tapShadowMap(sampler2D map, vec2 uv, float z){
 vec4 tex = texture2D(map, uv);
 return step(z, decodeFloat(tex) * 2.0 - 1.0);
}
float pcf(sampler2D map, vec2 uv, float z, float textureSize, vec2 scale) {
 float shadowContrib = tapShadowMap(map, uv, z);
 vec2 offset = vec2(1.0 / textureSize) * scale;
#ifdef PCF_KERNEL_SIZE
 for (int _idx_ = 0; _idx_ < PCF_KERNEL_SIZE; _idx_++) {{
 shadowContrib += tapShadowMap(map, uv + offset * pcfKernel[_idx_], z);
 }}
 return shadowContrib / float(PCF_KERNEL_SIZE + 1);
#else
 shadowContrib += tapShadowMap(map, uv+vec2(offset.x, 0.0), z);
 shadowContrib += tapShadowMap(map, uv+vec2(offset.x, offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(0.0, offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, 0.0), z);
 shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, -offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(offset.x, -offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(0.0, -offset.y), z);
 return shadowContrib / 9.0;
#endif
}
float pcf(sampler2D map, vec2 uv, float z, float textureSize) {
 return pcf(map, uv, z, textureSize, vec2(1.0));
}
float chebyshevUpperBound(vec2 moments, float z){
 float p = 0.0;
 z = z * 0.5 + 0.5;
 if (z <= moments.x) {
 p = 1.0;
 }
 float variance = moments.y - moments.x * moments.x;
 variance = max(variance, 0.0000001);
 float mD = moments.x - z;
 float pMax = variance / (variance + mD * mD);
 pMax = clamp((pMax-0.4)/(1.0-0.4), 0.0, 1.0);
 return max(p, pMax);
}
float computeShadowContrib(
 sampler2D map, mat4 lightVPM, vec3 position, float textureSize, vec2 scale, vec2 offset
) {
 vec4 posInLightSpace = lightVPM * vec4(position, 1.0);
 posInLightSpace.xyz /= posInLightSpace.w;
 float z = posInLightSpace.z;
 if(all(greaterThan(posInLightSpace.xyz, vec3(-0.99, -0.99, -1.0))) &&
 all(lessThan(posInLightSpace.xyz, vec3(0.99, 0.99, 1.0)))){
 vec2 uv = (posInLightSpace.xy+1.0) / 2.0;
 #ifdef USE_VSM
 vec2 moments = texture2D(map, uv * scale + offset).xy;
 return chebyshevUpperBound(moments, z);
 #else
 return pcf(map, uv * scale + offset, z, textureSize, scale);
 #endif
 }
 return 1.0;
}
float computeShadowContrib(sampler2D map, mat4 lightVPM, vec3 position, float textureSize) {
 return computeShadowContrib(map, lightVPM, position, textureSize, vec2(1.0), vec2(0.0));
}
float computeShadowContribOmni(samplerCube map, vec3 direction, float range)
{
 float dist = length(direction);
 vec4 shadowTex = textureCube(map, direction);
#ifdef USE_VSM
 vec2 moments = shadowTex.xy;
 float variance = moments.y - moments.x * moments.x;
 float mD = moments.x - dist;
 float p = variance / (variance + mD * mD);
 if(moments.x + 0.001 < dist){
 return clamp(p, 0.0, 1.0);
 }else{
 return 1.0;
 }
#else
 return step(dist, (decodeFloat(shadowTex) + 0.0002) * range);
#endif
}
@end
@export clay.plugin.compute_shadow_map
#if defined(SPOT_LIGHT_SHADOWMAP_COUNT) || defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT) || defined(POINT_LIGHT_SHADOWMAP_COUNT)
#ifdef SPOT_LIGHT_SHADOWMAP_COUNT
uniform sampler2D spotLightShadowMaps[SPOT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform mat4 spotLightMatrices[SPOT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform float spotLightShadowMapSizes[SPOT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
#endif
#ifdef DIRECTIONAL_LIGHT_SHADOWMAP_COUNT
#if defined(SHADOW_CASCADE)
uniform sampler2D directionalLightShadowMaps[1]:unconfigurable;
uniform mat4 directionalLightMatrices[SHADOW_CASCADE]:unconfigurable;
uniform float directionalLightShadowMapSizes[1]:unconfigurable;
uniform float shadowCascadeClipsNear[SHADOW_CASCADE]:unconfigurable;
uniform float shadowCascadeClipsFar[SHADOW_CASCADE]:unconfigurable;
#else
uniform sampler2D directionalLightShadowMaps[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform mat4 directionalLightMatrices[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform float directionalLightShadowMapSizes[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
#endif
#endif
#ifdef POINT_LIGHT_SHADOWMAP_COUNT
uniform samplerCube pointLightShadowMaps[POINT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
#endif
uniform bool shadowEnabled : true;
#ifdef PCF_KERNEL_SIZE
uniform vec2 pcfKernel[PCF_KERNEL_SIZE];
#endif
@import clay.plugin.shadow_map_common
#if defined(SPOT_LIGHT_SHADOWMAP_COUNT)
void computeShadowOfSpotLights(vec3 position, inout float shadowContribs[SPOT_LIGHT_COUNT] ) {
 float shadowContrib;
 for(int _idx_ = 0; _idx_ < SPOT_LIGHT_SHADOWMAP_COUNT; _idx_++) {{
 shadowContrib = computeShadowContrib(
 spotLightShadowMaps[_idx_], spotLightMatrices[_idx_], position,
 spotLightShadowMapSizes[_idx_]
 );
 shadowContribs[_idx_] = shadowContrib;
 }}
 for(int _idx_ = SPOT_LIGHT_SHADOWMAP_COUNT; _idx_ < SPOT_LIGHT_COUNT; _idx_++){{
 shadowContribs[_idx_] = 1.0;
 }}
}
#endif
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
#ifdef SHADOW_CASCADE
void computeShadowOfDirectionalLights(vec3 position, inout float shadowContribs[DIRECTIONAL_LIGHT_COUNT]){
 float depth = (2.0 * gl_FragCoord.z - gl_DepthRange.near - gl_DepthRange.far)
 / (gl_DepthRange.far - gl_DepthRange.near);
 float shadowContrib;
 shadowContribs[0] = 1.0;
 for (int _idx_ = 0; _idx_ < SHADOW_CASCADE; _idx_++) {{
 if (
 depth >= shadowCascadeClipsNear[_idx_] &&
 depth <= shadowCascadeClipsFar[_idx_]
 ) {
 shadowContrib = computeShadowContrib(
 directionalLightShadowMaps[0], directionalLightMatrices[_idx_], position,
 directionalLightShadowMapSizes[0],
 vec2(1.0 / float(SHADOW_CASCADE), 1.0),
 vec2(float(_idx_) / float(SHADOW_CASCADE), 0.0)
 );
 shadowContribs[0] = shadowContrib;
 }
 }}
 for(int _idx_ = DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++) {{
 shadowContribs[_idx_] = 1.0;
 }}
}
#else
void computeShadowOfDirectionalLights(vec3 position, inout float shadowContribs[DIRECTIONAL_LIGHT_COUNT]){
 float shadowContrib;
 for(int _idx_ = 0; _idx_ < DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_++) {{
 shadowContrib = computeShadowContrib(
 directionalLightShadowMaps[_idx_], directionalLightMatrices[_idx_], position,
 directionalLightShadowMapSizes[_idx_]
 );
 shadowContribs[_idx_] = shadowContrib;
 }}
 for(int _idx_ = DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++) {{
 shadowContribs[_idx_] = 1.0;
 }}
}
#endif
#endif
#if defined(POINT_LIGHT_SHADOWMAP_COUNT)
void computeShadowOfPointLights(vec3 position, inout float shadowContribs[POINT_LIGHT_COUNT] ){
 vec3 lightPosition;
 vec3 direction;
 for(int _idx_ = 0; _idx_ < POINT_LIGHT_SHADOWMAP_COUNT; _idx_++) {{
 lightPosition = pointLightPosition[_idx_];
 direction = position - lightPosition;
 shadowContribs[_idx_] = computeShadowContribOmni(pointLightShadowMaps[_idx_], direction, pointLightRange[_idx_]);
 }}
 for(int _idx_ = POINT_LIGHT_SHADOWMAP_COUNT; _idx_ < POINT_LIGHT_COUNT; _idx_++) {{
 shadowContribs[_idx_] = 1.0;
 }}
}
#endif
#endif
@end`;var Md=["px","nx","py","ny","pz","nz"];qe.import(a4);function kS(e,t,i){if(i==="alphaMap")return e.material.get("diffuseMap");if(i==="alphaCutoff"){if(e.material.isDefined("fragment","ALPHA_TEST")&&e.material.get("diffuseMap")){var r=e.material.get("alphaCutoff");return r||0}return 0}else return i==="uvRepeat"?e.material.get("uvRepeat"):i==="uvOffset"?e.material.get("uvOffset"):t.get(i)}function s4(e,t){var i=e.material,r=t.material;return i.get("diffuseMap")!==r.get("diffuseMap")||(i.get("alphaCutoff")||0)!==(r.get("alphaCutoff")||0)}var Fl=fr.extend(function(){return{softShadow:Fl.PCF,shadowBlur:1,lightFrustumBias:"auto",kernelPCF:new Float32Array([1,0,1,1,-1,1,0,1,-1,0,-1,-1,1,-1,0,-1]),precision:"highp",_lastRenderNotCastShadow:!1,_frameBuffer:new tr,_textures:{},_shadowMapNumber:{POINT_LIGHT:0,DIRECTIONAL_LIGHT:0,SPOT_LIGHT:0},_depthMaterials:{},_distanceMaterials:{},_receivers:[],_lightsCastShadow:[],_lightCameras:{},_lightMaterials:{},_texturePool:new ax}},function(){this._gaussianPassH=new cr({fragment:qe.source("clay.compositor.gaussian_blur")}),this._gaussianPassV=new cr({fragment:qe.source("clay.compositor.gaussian_blur")}),this._gaussianPassH.setUniform("blurSize",this.shadowBlur),this._gaussianPassH.setUniform("blurDir",0),this._gaussianPassV.setUniform("blurSize",this.shadowBlur),this._gaussianPassV.setUniform("blurDir",1),this._outputDepthPass=new cr({fragment:qe.source("clay.sm.debug_depth")})},{render:function(e,t,i,r){i||(i=t.getMainCamera()),this.trigger("beforerender",this,e,t,i),this._renderShadowPass(e,t,i,r),this.trigger("afterrender",this,e,t,i)},renderDebug:function(e,t){e.saveClear();var i=e.viewport,r=0,n=0,o=t||i.width/4,a=o;this.softShadow===Fl.VSM?this._outputDepthPass.material.define("fragment","USE_VSM"):this._outputDepthPass.material.undefine("fragment","USE_VSM");for(var s in this._textures){var c=this._textures[s];e.setViewport(r,n,o*c.width/c.height,a),this._outputDepthPass.setUniform("depthMap",c),this._outputDepthPass.render(e),r+=o*c.width/c.height}e.setViewport(i),e.restoreClear()},_updateReceivers:function(e,t){if(t.receiveShadow?(this._receivers.push(t),t.material.set("shadowEnabled",1),t.material.set("pcfKernel",this.kernelPCF)):t.material.set("shadowEnabled",0),this.softShadow===Fl.VSM)t.material.define("fragment","USE_VSM"),t.material.undefine("fragment","PCF_KERNEL_SIZE");else{t.material.undefine("fragment","USE_VSM");var i=this.kernelPCF;i&&i.length?t.material.define("fragment","PCF_KERNEL_SIZE",i.length/2):t.material.undefine("fragment","PCF_KERNEL_SIZE")}},_update:function(e,t){var i=this;t.traverse(function(o){o.isRenderable()&&i._updateReceivers(e,o)});for(var r=0;r<t.lights.length;r++){var n=t.lights[r];n.castShadow&&!n.invisible&&this._lightsCastShadow.push(n)}},_renderShadowPass:function(e,t,i,r){for(var n in this._shadowMapNumber)this._shadowMapNumber[n]=0;this._lightsCastShadow.length=0,this._receivers.length=0;var o=e.gl;if(r||t.update(),i&&i.update(),t.updateLights(),this._update(e,t),!this._lightsCastShadow.length&&this._lastRenderNotCastShadow)return;this._lastRenderNotCastShadow=this._lightsCastShadow===0,o.enable(o.DEPTH_TEST),o.depthMask(!0),o.disable(o.BLEND),o.clearColor(1,1,1,1);for(var a=[],s=[],c=[],l=[],d=[],u=[],h,p=0;p<this._lightsCastShadow.length;p++){var m=this._lightsCastShadow[p];if(m.type==="DIRECTIONAL_LIGHT"){if(h){console.warn("Only one direectional light supported with shadow cascade");continue}if(m.shadowCascade>4){console.warn("Support at most 4 cascade");continue}m.shadowCascade>1&&(h=m),this.renderDirectionalLightShadow(e,t,i,m,d,l,c)}else m.type==="SPOT_LIGHT"?this.renderSpotLightShadow(e,t,m,s,a):m.type==="POINT_LIGHT"&&this.renderPointLightShadow(e,t,m,u);this._shadowMapNumber[m.type]++}for(var f in this._shadowMapNumber)for(var g=this._shadowMapNumber[f],v=f+"_SHADOWMAP_COUNT",p=0;p<this._receivers.length;p++){var _=this._receivers[p],b=_.material;b.fragmentDefines[v]!==g&&(g>0?b.define("fragment",v,g):b.isDefined("fragment",v)&&b.undefine("fragment",v))}for(var p=0;p<this._receivers.length;p++){var _=this._receivers[p],b=_.material;h?b.define("fragment","SHADOW_CASCADE",h.shadowCascade):b.undefine("fragment","SHADOW_CASCADE")}var y=t.shadowUniforms;function x(N){return N.height}if(c.length>0){var w=c.map(x);if(y.directionalLightShadowMaps={value:c,type:"tv"},y.directionalLightMatrices={value:l,type:"m4v"},y.directionalLightShadowMapSizes={value:w,type:"1fv"},h){var I=d.slice(),S=d.slice();I.pop(),S.shift(),I.reverse(),S.reverse(),l.reverse(),y.shadowCascadeClipsNear={value:I,type:"1fv"},y.shadowCascadeClipsFar={value:S,type:"1fv"}}}if(a.length>0){var E=a.map(x),y=t.shadowUniforms;y.spotLightShadowMaps={value:a,type:"tv"},y.spotLightMatrices={value:s,type:"m4v"},y.spotLightShadowMapSizes={value:E,type:"1fv"}}u.length>0&&(y.pointLightShadowMaps={value:u,type:"tv"})},renderDirectionalLightShadow:function(){var e=new uf,t=new ct,i=new Jr,r=new ct,n=new ct,o=new ct,a=new ct;return function(s,c,l,d,u,h,p){var m=this._getDepthMaterial(d),f={getMaterial:function(ue){return ue.shadowDepthMaterial||m},isMaterialChanged:s4,getUniform:kS,ifRender:function(ue){return ue.castShadow},sortCompare:wd.opaqueSortCompare};if(!c.viewBoundingBoxLastFrame.isFinite()){var g=c.getBoundingBox();c.viewBoundingBoxLastFrame.copy(g).applyTransform(l.viewMatrix)}var v=Math.min(-c.viewBoundingBoxLastFrame.min.z,l.far),_=Math.max(-c.viewBoundingBoxLastFrame.max.z,l.near),b=this._getDirectionalLightCamera(d,c,l),y=o.array;a.copy(b.projectionMatrix),Ge.invert(n.array,b.worldTransform.array),Ge.multiply(n.array,n.array,l.worldTransform.array),Ge.multiply(y,a.array,n.array);for(var x=[],w=l instanceof en,I=(l.near+l.far)/(l.near-l.far),S=2*l.near*l.far/(l.near-l.far),E=0;E<=d.shadowCascade;E++){var N=_*Math.pow(v/_,E/d.shadowCascade),M=_+(v-_)*E/d.shadowCascade,P=N*d.cascadeSplitLogFactor+M*(1-d.cascadeSplitLogFactor);x.push(P),u.push(-(-P*I+S)/-P)}var $=this._getTexture(d,d.shadowCascade);p.push($);var R=s.viewport,j=s.gl;this._frameBuffer.attach($),this._frameBuffer.bind(s),j.clear(j.COLOR_BUFFER_BIT|j.DEPTH_BUFFER_BIT);for(var E=0;E<d.shadowCascade;E++){var B=x[E],te=x[E+1];w?Ge.perspective(t.array,l.fov/180*Math.PI,l.aspect,B,te):Ge.ortho(t.array,l.left,l.right,l.bottom,l.top,B,te),e.setFromProjection(t),e.getTransformedBoundingBox(i,n),i.applyProjection(a);var Z=i.min.array,ne=i.max.array;Z[0]=Math.max(Z[0],-1),Z[1]=Math.max(Z[1],-1),ne[0]=Math.min(ne[0],1),ne[1]=Math.min(ne[1],1),r.ortho(Z[0],ne[0],Z[1],ne[1],1,-1),b.projectionMatrix.multiplyLeft(r);var se=d.shadowResolution||512;s.setViewport((d.shadowCascade-E-1)*se,0,se,se,1);var we=c.updateRenderList(b);s.renderPass(we.opaque,b,f),this.softShadow===Fl.VSM&&this._gaussianFilter(s,$,$.width);var ie=new ct;ie.copy(b.viewMatrix).multiplyLeft(b.projectionMatrix),h.push(ie.array),b.projectionMatrix.copy(a)}this._frameBuffer.unbind(s),s.setViewport(R)}}(),renderSpotLightShadow:function(e,t,i,r,n){var o=this._getTexture(i),a=this._getSpotLightCamera(i),s=e.gl;this._frameBuffer.attach(o),this._frameBuffer.bind(e),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var c=this._getDepthMaterial(i),l={getMaterial:function(h){return h.shadowDepthMaterial||c},isMaterialChanged:s4,getUniform:kS,ifRender:function(h){return h.castShadow},sortCompare:wd.opaqueSortCompare},d=t.updateRenderList(a);e.renderPass(d.opaque,a,l),this._frameBuffer.unbind(e),this.softShadow===Fl.VSM&&this._gaussianFilter(e,o,o.width);var u=new ct;u.copy(a.worldTransform).invert().multiplyLeft(a.projectionMatrix),n.push(o),r.push(u.array)},renderPointLightShadow:function(e,t,i,r){var n=this._getTexture(i),o=e.gl;r.push(n);var a=this._getDepthMaterial(i),s={getMaterial:function(_){return _.shadowDepthMaterial||a},getUniform:kS,sortCompare:wd.opaqueSortCompare},c={px:[],py:[],pz:[],nx:[],ny:[],nz:[]},l=new Jr,d=i.getWorldPosition().array,u=new Jr,h=i.range;u.min.setArray(d),u.max.setArray(d);var p=new Fe(h,h,h);u.max.add(p),u.min.sub(p);var m={px:!1,py:!1,pz:!1,nx:!1,ny:!1,nz:!1};t.traverse(function(_){if(_.isRenderable()&&_.castShadow){var b=_.geometry;if(!b.boundingBox){for(var y=0;y<Md.length;y++)c[Md[y]].push(_);return}if(l.transformFrom(b.boundingBox,_.worldTransform),!l.intersectBoundingBox(u))return;l.updateVertices();for(var y=0;y<Md.length;y++)m[Md[y]]=!1;for(var y=0;y<8;y++){var x=l.vertices[y],w=x[0]-d[0],I=x[1]-d[1],S=x[2]-d[2],E=Math.abs(w),N=Math.abs(I),M=Math.abs(S);E>N?E>M?m[w>0?"px":"nx"]=!0:m[S>0?"pz":"nz"]=!0:N>M?m[I>0?"py":"ny"]=!0:m[S>0?"pz":"nz"]=!0}for(var y=0;y<Md.length;y++)m[Md[y]]&&c[Md[y]].push(_)}});for(var f=0;f<6;f++){var g=Md[f],v=this._getPointLightCamera(i,g);this._frameBuffer.attach(n,o.COLOR_ATTACHMENT0,o.TEXTURE_CUBE_MAP_POSITIVE_X+f),this._frameBuffer.bind(e),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),e.renderPass(c[g],v,s)}this._frameBuffer.unbind(e)},_getDepthMaterial:function(e){var t=this._lightMaterials[e.__uid__],i=e.type==="POINT_LIGHT";if(!t){var r=i?"clay.sm.distance.":"clay.sm.depth.";t=new In({precision:this.precision,shader:new qe(qe.source(r+"vertex"),qe.source(r+"fragment"))}),this._lightMaterials[e.__uid__]=t}return e.shadowSlopeScale!=null&&t.setUniform("slopeScale",e.shadowSlopeScale),e.shadowBias!=null&&t.setUniform("bias",e.shadowBias),this.softShadow===Fl.VSM?t.define("fragment","USE_VSM"):t.undefine("fragment","USE_VSM"),i&&(t.set("lightPosition",e.getWorldPosition().array),t.set("range",e.range)),t},_gaussianFilter:function(e,t,i){var r={width:i,height:i,type:ot.FLOAT},n=this._texturePool.get(r);this._frameBuffer.attach(n),this._frameBuffer.bind(e),this._gaussianPassH.setUniform("texture",t),this._gaussianPassH.setUniform("textureWidth",i),this._gaussianPassH.render(e),this._frameBuffer.attach(t),this._gaussianPassV.setUniform("texture",n),this._gaussianPassV.setUniform("textureHeight",i),this._gaussianPassV.render(e),this._frameBuffer.unbind(e),this._texturePool.put(n)},_getTexture:function(e,t){var i=e.__uid__,r=this._textures[i],n=e.shadowResolution||512;return t=t||1,r||(e.type==="POINT_LIGHT"?r=new yc:r=new wt,r.width=n*t,r.height=n,this.softShadow===Fl.VSM?(r.type=ot.FLOAT,r.anisotropic=4):(r.minFilter=me.NEAREST,r.magFilter=me.NEAREST,r.useMipmap=!1),this._textures[i]=r),r},_getPointLightCamera:function(e,t){this._lightCameras.point||(this._lightCameras.point={px:new en,nx:new en,py:new en,ny:new en,pz:new en,nz:new en});var i=this._lightCameras.point[t];switch(i.far=e.range,i.fov=90,i.position.set(0,0,0),t){case"px":i.lookAt(Fe.POSITIVE_X,Fe.NEGATIVE_Y);break;case"nx":i.lookAt(Fe.NEGATIVE_X,Fe.NEGATIVE_Y);break;case"py":i.lookAt(Fe.POSITIVE_Y,Fe.POSITIVE_Z);break;case"ny":i.lookAt(Fe.NEGATIVE_Y,Fe.NEGATIVE_Z);break;case"pz":i.lookAt(Fe.POSITIVE_Z,Fe.NEGATIVE_Y);break;case"nz":i.lookAt(Fe.NEGATIVE_Z,Fe.NEGATIVE_Y);break}return e.getWorldPosition(i.position),i.update(),i},_getDirectionalLightCamera:function(){var e=new ct,t=new Jr,i=new Jr;return function(r,n,o){this._lightCameras.directional||(this._lightCameras.directional=new pl);var a=this._lightCameras.directional;t.copy(n.viewBoundingBoxLastFrame),t.intersection(o.frustum.boundingBox),a.position.copy(t.min).add(t.max).scale(.5).transformMat4(o.worldTransform),a.rotation.copy(r.rotation),a.scale.copy(r.scale),a.updateWorldTransform(),ct.invert(e,a.worldTransform),ct.multiply(e,e,o.worldTransform),i.copy(t).applyTransform(e);var s=i.min.array,c=i.max.array;return a.position.set((s[0]+c[0])/2,(s[1]+c[1])/2,c[2]).transformMat4(a.worldTransform),a.near=0,a.far=-s[2]+c[2],isNaN(this.lightFrustumBias)?a.far*=4:a.far+=this.lightFrustumBias,a.left=s[0],a.right=c[0],a.top=c[1],a.bottom=s[1],a.update(!0),a}}(),_getSpotLightCamera:function(e){this._lightCameras.spot||(this._lightCameras.spot=new en);var t=this._lightCameras.spot;return t.fov=e.penumbraAngle*2,t.far=e.range,t.worldTransform.copy(e.worldTransform),t.updateProjectionMatrix(),Ge.invert(t.viewMatrix.array,t.worldTransform.array),t},dispose:function(e){var t=e.gl||e;this._frameBuffer&&this._frameBuffer.dispose(t);for(var i in this._textures)this._textures[i].dispose(t);this._texturePool.clear(e.gl),this._depthMaterials={},this._distanceMaterials={},this._textures={},this._lightCameras={},this._shadowMapNumber={POINT_LIGHT:0,DIRECTIONAL_LIGHT:0,SPOT_LIGHT:0},this._meshMaterials={};for(var r=0;r<this._receivers.length;r++){var n=this._receivers[r];if(n.material){var o=n.material;o.undefine("fragment","POINT_LIGHT_SHADOW_COUNT"),o.undefine("fragment","DIRECTIONAL_LIGHT_SHADOW_COUNT"),o.undefine("fragment","AMBIENT_LIGHT_SHADOW_COUNT"),o.set("shadowEnabled",0)}}this._receivers=[],this._lightsCastShadow=[]}});Fl.VSM=1;Fl.PCF=2;var l4=Fl;var fte=fr.extend(function(){return{name:"",inputLinks:{},outputLinks:{},_prevOutputTextures:{},_outputTextures:{},_outputReferences:{},_rendering:!1,_rendered:!1,_compositor:null}},{updateParameter:function(e,t){var i=this.outputs[e],r=i.parameters,n=i._parametersCopy;if(n||(n=i._parametersCopy={}),r)for(var o in r)o!=="width"&&o!=="height"&&(n[o]=r[o]);var a,s;return r.width instanceof Function?a=r.width.call(this,t):a=r.width,r.height instanceof Function?s=r.height.call(this,t):s=r.height,(n.width!==a||n.height!==s)&&this._outputTextures[e]&&this._outputTextures[e].dispose(t.gl),n.width=a,n.height=s,n},setParameter:function(e,t){},getParameter:function(e){},setParameters:function(e){for(var t in e)this.setParameter(t,e[t])},render:function(){},getOutput:function(e,t){if(t==null)return t=e,this._outputTextures[t];var i=this.outputs[t];if(i)return this._rendered?i.outputLastFrame?this._prevOutputTextures[t]:this._outputTextures[t]:this._rendering?(this._prevOutputTextures[t]||(this._prevOutputTextures[t]=this._compositor.allocateTexture(i.parameters||{})),this._prevOutputTextures[t]):(this.render(e),this._outputTextures[t])},removeReference:function(e){if(this._outputReferences[e]--,this._outputReferences[e]===0){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}},link:function(e,t,i){this.inputLinks[e]={node:t,pin:i},t.outputLinks[i]||(t.outputLinks[i]=[]),t.outputLinks[i].push({node:this,pin:e}),this.pass.material.enableTexture(e)},clear:function(){this.inputLinks={},this.outputLinks={}},updateReference:function(e){if(!this._rendering){this._rendering=!0;for(var t in this.inputLinks){var i=this.inputLinks[t];i.node.updateReference(i.pin)}this._rendering=!1}e&&this._outputReferences[e]++},beforeFrame:function(){this._rendered=!1;for(var e in this.outputLinks)this._outputReferences[e]=0},afterFrame:function(){for(var e in this.outputLinks)if(this._outputReferences[e]>0){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}}}),Ec=fte;var mte=fr.extend(function(){return{nodes:[]}},{dirty:function(){this._dirty=!0},addNode:function(e){this.nodes.indexOf(e)>=0||(this.nodes.push(e),this._dirty=!0)},removeNode:function(e){typeof e=="string"&&(e=this.getNodeByName(e));var t=this.nodes.indexOf(e);t>=0&&(this.nodes.splice(t,1),this._dirty=!0)},getNodeByName:function(e){for(var t=0;t<this.nodes.length;t++)if(this.nodes[t].name===e)return this.nodes[t]},update:function(){for(var e=0;e<this.nodes.length;e++)this.nodes[e].clear();for(var e=0;e<this.nodes.length;e++){var t=this.nodes[e];if(t.inputs){for(var i in t.inputs)if(t.inputs[i]){if(t.pass&&!t.pass.material.isUniformEnabled(i)){console.warn("Pin "+t.name+"."+i+" not used.");continue}var r=t.inputs[i],n=this.findPin(r);n?t.link(i,n.node,n.pin):console.warn(typeof r=="string"?"Node "+r+" not exist":"Pin of "+r.node+"."+r.pin+" not exist")}}}},findPin:function(e){var t;if((typeof e=="string"||e instanceof Ec)&&(e={node:e}),typeof e.node=="string")for(var i=0;i<this.nodes.length;i++){var r=this.nodes[i];r.name===e.node&&(t=r)}else t=e.node;if(t){var n=e.pin;if(n||t.outputs&&(n=Object.keys(t.outputs)[0]),t.outputs[n])return{node:t,pin:n}}}}),PS=mte;var gte=PS.extend(function(){return{_outputs:[],_texturePool:new ax,_frameBuffer:new tr({depthBuffer:!1})}},{addNode:function(e){PS.prototype.addNode.call(this,e),e._compositor=this},render:function(e,t){if(this._dirty){this.update(),this._dirty=!1,this._outputs.length=0;for(var i=0;i<this.nodes.length;i++)this.nodes[i].outputs||this._outputs.push(this.nodes[i])}for(var i=0;i<this.nodes.length;i++)this.nodes[i].beforeFrame();for(var i=0;i<this._outputs.length;i++)this._outputs[i].updateReference();for(var i=0;i<this._outputs.length;i++)this._outputs[i].render(e,t);for(var i=0;i<this.nodes.length;i++)this.nodes[i].afterFrame()},allocateTexture:function(e){return this._texturePool.get(e)},releaseTexture:function(e){this._texturePool.put(e)},getFrameBuffer:function(){return this._frameBuffer},dispose:function(e){this._texturePool.clear(e)}}),c4=gte;var vte=Ec.extend({name:"scene",scene:null,camera:null,autoUpdateScene:!0,preZ:!1},function(){this.frameBuffer=new tr},{render:function(e){this._rendering=!0;var t=e.gl;this.trigger("beforerender");var i;if(!this.outputs)i=e.render(this.scene,this.camera,!this.autoUpdateScene,this.preZ);else{var r=this.frameBuffer;for(var n in this.outputs){var o=this.updateParameter(n,e),a=this.outputs[n],s=this._compositor.allocateTexture(o);this._outputTextures[n]=s;var c=a.attachment||t.COLOR_ATTACHMENT0;typeof c=="string"&&(c=t[c]),r.attach(s,c)}r.bind(e);var l=e.getGLExtension("EXT_draw_buffers");if(l){var d=[];for(var c in this.outputs)c=parseInt(c),c>=t.COLOR_ATTACHMENT0&&c<=t.COLOR_ATTACHMENT0+8&&d.push(c);l.drawBuffersEXT(d)}e.saveClear(),e.clearBit=me.DEPTH_BUFFER_BIT|me.COLOR_BUFFER_BIT,i=e.render(this.scene,this.camera,!this.autoUpdateScene,this.preZ),e.restoreClear(),r.unbind(e)}this.trigger("afterrender",i),this._rendering=!1,this._rendered=!0}}),d4=vte;var _te=Ec.extend(function(){return{texture:null,outputs:{color:{}}}},function(){},{getOutput:function(e,t){return this.texture},beforeFrame:function(){},afterFrame:function(){}}),u4=_te;var bte=Ec.extend(function(){return{name:"",inputs:{},outputs:null,shader:"",inputLinks:{},outputLinks:{},pass:null,_prevOutputTextures:{},_outputTextures:{},_outputReferences:{},_rendering:!1,_rendered:!1,_compositor:null}},function(){var e=new cr({fragment:this.shader});this.pass=e},{render:function(e,t){this.trigger("beforerender",e),this._rendering=!0;var i=e.gl;for(var r in this.inputLinks){var n=this.inputLinks[r],o=n.node.getOutput(e,n.pin);this.pass.setUniform(r,o)}if(!this.outputs)this.pass.outputs=null,this._compositor.getFrameBuffer().unbind(e),this.pass.render(e,t);else{this.pass.outputs={};var a={};for(var s in this.outputs){var c=this.updateParameter(s,e);isNaN(c.width)&&this.updateParameter(s,e);var l=this.outputs[s],d=this._compositor.allocateTexture(c);this._outputTextures[s]=d;var u=l.attachment||i.COLOR_ATTACHMENT0;typeof u=="string"&&(u=i[u]),a[u]=d}this._compositor.getFrameBuffer().bind(e);for(var u in a)this._compositor.getFrameBuffer().attach(a[u],u);this.pass.render(e),this._compositor.getFrameBuffer().updateMipmap(e)}for(var r in this.inputLinks){var n=this.inputLinks[r];n.node.removeReference(n.pin)}this._rendering=!1,this._rendered=!0,this.trigger("afterrender",e)},updateParameter:function(e,t){var i=this.outputs[e],r=i.parameters,n=i._parametersCopy;if(n||(n=i._parametersCopy={}),r)for(var o in r)o!=="width"&&o!=="height"&&(n[o]=r[o]);var a,s;return typeof r.width=="function"?a=r.width.call(this,t):a=r.width,typeof r.height=="function"?s=r.height.call(this,t):s=r.height,a=Math.ceil(a),s=Math.ceil(s),(n.width!==a||n.height!==s)&&this._outputTextures[e]&&this._outputTextures[e].dispose(t),n.width=a,n.height=s,n},setParameter:function(e,t){this.pass.setUniform(e,t)},getParameter:function(e){return this.pass.getUniform(e)},setParameters:function(e){for(var t in e)this.setParameter(t,e[t])},define:function(e,t){this.pass.material.define("fragment",e,t)},undefine:function(e){this.pass.material.undefine("fragment",e)},removeReference:function(e){if(this._outputReferences[e]--,this._outputReferences[e]===0){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}},clear:function(){Ec.prototype.clear.call(this),this.pass.material.disableTexturesAll()}}),h4=bte;var p4=`@export clay.compositor.coloradjust
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float brightness : 0.0;
uniform float contrast : 1.0;
uniform float exposure : 0.0;
uniform float gamma : 1.0;
uniform float saturation : 1.0;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord);
 vec3 color = clamp(tex.rgb + vec3(brightness), 0.0, 1.0);
 color = clamp( (color-vec3(0.5))*contrast+vec3(0.5), 0.0, 1.0);
 color = clamp( color * pow(2.0, exposure), 0.0, 1.0);
 color = clamp( pow(color, vec3(gamma)), 0.0, 1.0);
 float luminance = dot( color, w );
 color = mix(vec3(luminance), color, saturation);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.brightness
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float brightness : 0.0;
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord);
 vec3 color = tex.rgb + vec3(brightness);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.contrast
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float contrast : 1.0;
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord);
 vec3 color = (tex.rgb-vec3(0.5))*contrast+vec3(0.5);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.exposure
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float exposure : 0.0;
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 vec3 color = tex.rgb * pow(2.0, exposure);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.gamma
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float gamma : 1.0;
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 vec3 color = pow(tex.rgb, vec3(gamma));
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.saturation
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float saturation : 1.0;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 vec3 color = tex.rgb;
 float luminance = dot(color, w);
 color = mix(vec3(luminance), color, saturation);
 gl_FragColor = vec4(color, tex.a);
}
@end`;var sx=`@export clay.compositor.kernel.gaussian_9
float gaussianKernel[9];
gaussianKernel[0] = 0.07;
gaussianKernel[1] = 0.09;
gaussianKernel[2] = 0.12;
gaussianKernel[3] = 0.14;
gaussianKernel[4] = 0.16;
gaussianKernel[5] = 0.14;
gaussianKernel[6] = 0.12;
gaussianKernel[7] = 0.09;
gaussianKernel[8] = 0.07;
@end
@export clay.compositor.kernel.gaussian_13
float gaussianKernel[13];
gaussianKernel[0] = 0.02;
gaussianKernel[1] = 0.03;
gaussianKernel[2] = 0.06;
gaussianKernel[3] = 0.08;
gaussianKernel[4] = 0.11;
gaussianKernel[5] = 0.13;
gaussianKernel[6] = 0.14;
gaussianKernel[7] = 0.13;
gaussianKernel[8] = 0.11;
gaussianKernel[9] = 0.08;
gaussianKernel[10] = 0.06;
gaussianKernel[11] = 0.03;
gaussianKernel[12] = 0.02;
@end
@export clay.compositor.gaussian_blur
#define SHADER_NAME gaussian_blur
uniform sampler2D texture;varying vec2 v_Texcoord;
uniform float blurSize : 2.0;
uniform vec2 textureSize : [512.0, 512.0];
uniform float blurDir : 0.0;
@import clay.util.rgbm
@import clay.util.clamp_sample
void main (void)
{
 @import clay.compositor.kernel.gaussian_9
 vec2 off = blurSize / textureSize;
 off *= vec2(1.0 - blurDir, blurDir);
 vec4 sum = vec4(0.0);
 float weightAll = 0.0;
 for (int i = 0; i < 9; i++) {
 float w = gaussianKernel[i];
 vec4 texel = decodeHDR(clampSample(texture, v_Texcoord + float(i - 4) * off));
 sum += texel * w;
 weightAll += w;
 }
 gl_FragColor = encodeHDR(sum / max(weightAll, 0.01));
}
@end
`;var f4=`@export clay.compositor.hdr.log_lum
varying vec2 v_Texcoord;
uniform sampler2D texture;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
@import clay.util.rgbm
void main()
{
 vec4 tex = decodeHDR(texture2D(texture, v_Texcoord));
 float luminance = dot(tex.rgb, w);
 luminance = log(luminance + 0.001);
 gl_FragColor = encodeHDR(vec4(vec3(luminance), 1.0));
}
@end
@export clay.compositor.hdr.lum_adaption
varying vec2 v_Texcoord;
uniform sampler2D adaptedLum;
uniform sampler2D currentLum;
uniform float frameTime : 0.02;
@import clay.util.rgbm
void main()
{
 float fAdaptedLum = decodeHDR(texture2D(adaptedLum, vec2(0.5, 0.5))).r;
 float fCurrentLum = exp(encodeHDR(texture2D(currentLum, vec2(0.5, 0.5))).r);
 fAdaptedLum += (fCurrentLum - fAdaptedLum) * (1.0 - pow(0.98, 30.0 * frameTime));
 gl_FragColor = encodeHDR(vec4(vec3(fAdaptedLum), 1.0));
}
@end
@export clay.compositor.lum
varying vec2 v_Texcoord;
uniform sampler2D texture;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord );
 float luminance = dot(tex.rgb, w);
 gl_FragColor = vec4(vec3(luminance), 1.0);
}
@end`;var lx=`
@export clay.compositor.lut
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform sampler2D lookup;
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 float blueColor = tex.b * 63.0;
 vec2 quad1;
 quad1.y = floor(floor(blueColor) / 8.0);
 quad1.x = floor(blueColor) - (quad1.y * 8.0);
 vec2 quad2;
 quad2.y = floor(ceil(blueColor) / 8.0);
 quad2.x = ceil(blueColor) - (quad2.y * 8.0);
 vec2 texPos1;
 texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.r);
 texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.g);
 vec2 texPos2;
 texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.r);
 texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.g);
 vec4 newColor1 = texture2D(lookup, texPos1);
 vec4 newColor2 = texture2D(lookup, texPos2);
 vec4 newColor = mix(newColor1, newColor2, fract(blueColor));
 gl_FragColor = vec4(newColor.rgb, tex.w);
}
@end`;var m4=`@export clay.compositor.vignette
#define OUTPUT_ALPHA
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float darkness: 1;
uniform float offset: 1;
@import clay.util.rgbm
void main()
{
 vec4 texel = decodeHDR(texture2D(texture, v_Texcoord));
 gl_FragColor.rgb = texel.rgb;
 vec2 uv = (v_Texcoord - vec2(0.5)) * vec2(offset);
 gl_FragColor = encodeHDR(vec4(mix(texel.rgb, vec3(1.0 - darkness), dot(uv, uv)), texel.a));
}
@end`;var cx=`@export clay.compositor.output
#define OUTPUT_ALPHA
varying vec2 v_Texcoord;
uniform sampler2D texture;
@import clay.util.rgbm
void main()
{
 vec4 tex = decodeHDR(texture2D(texture, v_Texcoord));
 gl_FragColor.rgb = tex.rgb;
#ifdef OUTPUT_ALPHA
 gl_FragColor.a = tex.a;
#else
 gl_FragColor.a = 1.0;
#endif
 gl_FragColor = encodeHDR(gl_FragColor);
#ifdef PREMULTIPLY_ALPHA
 gl_FragColor.rgb *= gl_FragColor.a;
#endif
}
@end`;var dx=`@export clay.compositor.bright
uniform sampler2D texture;
uniform float threshold : 1;
uniform float scale : 1.0;
uniform vec2 textureSize: [512, 512];
varying vec2 v_Texcoord;
const vec3 lumWeight = vec3(0.2125, 0.7154, 0.0721);
@import clay.util.rgbm
vec4 median(vec4 a, vec4 b, vec4 c)
{
 return a + b + c - min(min(a, b), c) - max(max(a, b), c);
}
void main()
{
 vec4 texel = decodeHDR(texture2D(texture, v_Texcoord));
#ifdef ANTI_FLICKER
 vec3 d = 1.0 / textureSize.xyx * vec3(1.0, 1.0, 0.0);
 vec4 s1 = decodeHDR(texture2D(texture, v_Texcoord - d.xz));
 vec4 s2 = decodeHDR(texture2D(texture, v_Texcoord + d.xz));
 vec4 s3 = decodeHDR(texture2D(texture, v_Texcoord - d.zy));
 vec4 s4 = decodeHDR(texture2D(texture, v_Texcoord + d.zy));
 texel = median(median(texel, s1, s2), s3, s4);
#endif
 float lum = dot(texel.rgb , lumWeight);
 vec4 color;
 if (lum > threshold && texel.a > 0.0)
 {
 color = vec4(texel.rgb * scale, texel.a * scale);
 }
 else
 {
 color = vec4(0.0);
 }
 gl_FragColor = encodeHDR(color);
}
@end
`;var ux=`@export clay.compositor.downsample
uniform sampler2D texture;
uniform vec2 textureSize : [512, 512];
varying vec2 v_Texcoord;
@import clay.util.rgbm
float brightness(vec3 c)
{
 return max(max(c.r, c.g), c.b);
}
@import clay.util.clamp_sample
void main()
{
 vec4 d = vec4(-1.0, -1.0, 1.0, 1.0) / textureSize.xyxy;
#ifdef ANTI_FLICKER
 vec3 s1 = decodeHDR(clampSample(texture, v_Texcoord + d.xy)).rgb;
 vec3 s2 = decodeHDR(clampSample(texture, v_Texcoord + d.zy)).rgb;
 vec3 s3 = decodeHDR(clampSample(texture, v_Texcoord + d.xw)).rgb;
 vec3 s4 = decodeHDR(clampSample(texture, v_Texcoord + d.zw)).rgb;
 float s1w = 1.0 / (brightness(s1) + 1.0);
 float s2w = 1.0 / (brightness(s2) + 1.0);
 float s3w = 1.0 / (brightness(s3) + 1.0);
 float s4w = 1.0 / (brightness(s4) + 1.0);
 float oneDivideSum = 1.0 / (s1w + s2w + s3w + s4w);
 vec4 color = vec4(
 (s1 * s1w + s2 * s2w + s3 * s3w + s4 * s4w) * oneDivideSum,
 1.0
 );
#else
 vec4 color = decodeHDR(clampSample(texture, v_Texcoord + d.xy));
 color += decodeHDR(clampSample(texture, v_Texcoord + d.zy));
 color += decodeHDR(clampSample(texture, v_Texcoord + d.xw));
 color += decodeHDR(clampSample(texture, v_Texcoord + d.zw));
 color *= 0.25;
#endif
 gl_FragColor = encodeHDR(color);
}
@end`;var hx=`
@export clay.compositor.upsample
#define HIGH_QUALITY
uniform sampler2D texture;
uniform vec2 textureSize : [512, 512];
uniform float sampleScale: 0.5;
varying vec2 v_Texcoord;
@import clay.util.rgbm
@import clay.util.clamp_sample
void main()
{
#ifdef HIGH_QUALITY
 vec4 d = vec4(1.0, 1.0, -1.0, 0.0) / textureSize.xyxy * sampleScale;
 vec4 s;
 s = decodeHDR(clampSample(texture, v_Texcoord - d.xy));
 s += decodeHDR(clampSample(texture, v_Texcoord - d.wy)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord - d.zy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zw)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord )) * 4.0;
 s += decodeHDR(clampSample(texture, v_Texcoord + d.xw)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.wy)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord + d.xy));
 gl_FragColor = encodeHDR(s / 16.0);
#else
 vec4 d = vec4(-1.0, -1.0, +1.0, +1.0) / textureSize.xyxy;
 vec4 s;
 s = decodeHDR(clampSample(texture, v_Texcoord + d.xy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.xw));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zw));
 gl_FragColor = encodeHDR(s / 4.0);
#endif
}
@end`;var px=`@export clay.compositor.hdr.composite
#define TONEMAPPING
uniform sampler2D texture;
#ifdef BLOOM_ENABLED
uniform sampler2D bloom;
#endif
#ifdef LENSFLARE_ENABLED
uniform sampler2D lensflare;
uniform sampler2D lensdirt;
#endif
#ifdef LUM_ENABLED
uniform sampler2D lum;
#endif
#ifdef LUT_ENABLED
uniform sampler2D lut;
#endif
#ifdef COLOR_CORRECTION
uniform float brightness : 0.0;
uniform float contrast : 1.0;
uniform float saturation : 1.0;
#endif
#ifdef VIGNETTE
uniform float vignetteDarkness: 1.0;
uniform float vignetteOffset: 1.0;
#endif
uniform float exposure : 1.0;
uniform float bloomIntensity : 0.25;
uniform float lensflareIntensity : 1;
varying vec2 v_Texcoord;
@import clay.util.srgb
vec3 ACESToneMapping(vec3 color)
{
 const float A = 2.51;
 const float B = 0.03;
 const float C = 2.43;
 const float D = 0.59;
 const float E = 0.14;
 return (color * (A * color + B)) / (color * (C * color + D) + E);
}
float eyeAdaption(float fLum)
{
 return mix(0.2, fLum, 0.5);
}
#ifdef LUT_ENABLED
vec3 lutTransform(vec3 color) {
 float blueColor = color.b * 63.0;
 vec2 quad1;
 quad1.y = floor(floor(blueColor) / 8.0);
 quad1.x = floor(blueColor) - (quad1.y * 8.0);
 vec2 quad2;
 quad2.y = floor(ceil(blueColor) / 8.0);
 quad2.x = ceil(blueColor) - (quad2.y * 8.0);
 vec2 texPos1;
 texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.r);
 texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.g);
 vec2 texPos2;
 texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.r);
 texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.g);
 vec4 newColor1 = texture2D(lut, texPos1);
 vec4 newColor2 = texture2D(lut, texPos2);
 vec4 newColor = mix(newColor1, newColor2, fract(blueColor));
 return newColor.rgb;
}
#endif
@import clay.util.rgbm
void main()
{
 vec4 texel = vec4(0.0);
 vec4 originalTexel = vec4(0.0);
#ifdef TEXTURE_ENABLED
 texel = decodeHDR(texture2D(texture, v_Texcoord));
 originalTexel = texel;
#endif
#ifdef BLOOM_ENABLED
 vec4 bloomTexel = decodeHDR(texture2D(bloom, v_Texcoord));
 texel.rgb += bloomTexel.rgb * bloomIntensity;
 texel.a += bloomTexel.a * bloomIntensity;
#endif
#ifdef LENSFLARE_ENABLED
 texel += decodeHDR(texture2D(lensflare, v_Texcoord)) * texture2D(lensdirt, v_Texcoord) * lensflareIntensity;
#endif
 texel.a = min(texel.a, 1.0);
#ifdef LUM_ENABLED
 float fLum = texture2D(lum, vec2(0.5, 0.5)).r;
 float adaptedLumDest = 3.0 / (max(0.1, 1.0 + 10.0*eyeAdaption(fLum)));
 float exposureBias = adaptedLumDest * exposure;
#else
 float exposureBias = exposure;
#endif
#ifdef TONEMAPPING
 texel.rgb *= exposureBias;
 texel.rgb = ACESToneMapping(texel.rgb);
#endif
 texel = linearTosRGB(texel);
#ifdef LUT_ENABLED
 texel.rgb = lutTransform(clamp(texel.rgb,vec3(0.0),vec3(1.0)));
#endif
#ifdef COLOR_CORRECTION
 texel.rgb = clamp(texel.rgb + vec3(brightness), 0.0, 1.0);
 texel.rgb = clamp((texel.rgb - vec3(0.5))*contrast+vec3(0.5), 0.0, 1.0);
 float lum = dot(texel.rgb, vec3(0.2125, 0.7154, 0.0721));
 texel.rgb = mix(vec3(lum), texel.rgb, saturation);
#endif
#ifdef VIGNETTE
 vec2 uv = (v_Texcoord - vec2(0.5)) * vec2(vignetteOffset);
 texel.rgb = mix(texel.rgb, vec3(1.0 - vignetteDarkness), dot(uv, uv));
#endif
 gl_FragColor = encodeHDR(texel);
#ifdef DEBUG
 #if DEBUG == 1
 gl_FragColor = encodeHDR(decodeHDR(texture2D(texture, v_Texcoord)));
 #elif DEBUG == 2
 gl_FragColor = encodeHDR(decodeHDR(texture2D(bloom, v_Texcoord)) * bloomIntensity);
 #elif DEBUG == 3
 gl_FragColor = encodeHDR(decodeHDR(texture2D(lensflare, v_Texcoord) * lensflareIntensity));
 #endif
#endif
 if (originalTexel.a <= 0.01 && gl_FragColor.a > 1e-5) {
 gl_FragColor.a = dot(gl_FragColor.rgb, vec3(0.2125, 0.7154, 0.0721));
 }
#ifdef PREMULTIPLY_ALPHA
 gl_FragColor.rgb *= gl_FragColor.a;
#endif
}
@end`;var g4=`@export clay.compositor.lensflare
#define SAMPLE_NUMBER 8
uniform sampler2D texture;
uniform sampler2D lenscolor;
uniform vec2 textureSize : [512, 512];
uniform float dispersal : 0.3;
uniform float haloWidth : 0.4;
uniform float distortion : 1.0;
varying vec2 v_Texcoord;
@import clay.util.rgbm
vec4 textureDistorted(
 in vec2 texcoord,
 in vec2 direction,
 in vec3 distortion
) {
 return vec4(
 decodeHDR(texture2D(texture, texcoord + direction * distortion.r)).r,
 decodeHDR(texture2D(texture, texcoord + direction * distortion.g)).g,
 decodeHDR(texture2D(texture, texcoord + direction * distortion.b)).b,
 1.0
 );
}
void main()
{
 vec2 texcoord = -v_Texcoord + vec2(1.0); vec2 textureOffset = 1.0 / textureSize;
 vec2 ghostVec = (vec2(0.5) - texcoord) * dispersal;
 vec2 haloVec = normalize(ghostVec) * haloWidth;
 vec3 distortion = vec3(-textureOffset.x * distortion, 0.0, textureOffset.x * distortion);
 vec4 result = vec4(0.0);
 for (int i = 0; i < SAMPLE_NUMBER; i++)
 {
 vec2 offset = fract(texcoord + ghostVec * float(i));
 float weight = length(vec2(0.5) - offset) / length(vec2(0.5));
 weight = pow(1.0 - weight, 10.0);
 result += textureDistorted(offset, normalize(ghostVec), distortion) * weight;
 }
 result *= texture2D(lenscolor, vec2(length(vec2(0.5) - texcoord)) / length(vec2(0.5)));
 float weight = length(vec2(0.5) - fract(texcoord + haloVec)) / length(vec2(0.5));
 weight = pow(1.0 - weight, 10.0);
 vec2 offset = fract(texcoord + haloVec);
 result += textureDistorted(offset, normalize(ghostVec), distortion) * weight;
 gl_FragColor = result;
}
@end`;var fx=`@export clay.compositor.blend
#define SHADER_NAME blend
#ifdef TEXTURE1_ENABLED
uniform sampler2D texture1;
uniform float weight1 : 1.0;
#endif
#ifdef TEXTURE2_ENABLED
uniform sampler2D texture2;
uniform float weight2 : 1.0;
#endif
#ifdef TEXTURE3_ENABLED
uniform sampler2D texture3;
uniform float weight3 : 1.0;
#endif
#ifdef TEXTURE4_ENABLED
uniform sampler2D texture4;
uniform float weight4 : 1.0;
#endif
#ifdef TEXTURE5_ENABLED
uniform sampler2D texture5;
uniform float weight5 : 1.0;
#endif
#ifdef TEXTURE6_ENABLED
uniform sampler2D texture6;
uniform float weight6 : 1.0;
#endif
varying vec2 v_Texcoord;
@import clay.util.rgbm
void main()
{
 vec4 tex = vec4(0.0);
#ifdef TEXTURE1_ENABLED
 tex += decodeHDR(texture2D(texture1, v_Texcoord)) * weight1;
#endif
#ifdef TEXTURE2_ENABLED
 tex += decodeHDR(texture2D(texture2, v_Texcoord)) * weight2;
#endif
#ifdef TEXTURE3_ENABLED
 tex += decodeHDR(texture2D(texture3, v_Texcoord)) * weight3;
#endif
#ifdef TEXTURE4_ENABLED
 tex += decodeHDR(texture2D(texture4, v_Texcoord)) * weight4;
#endif
#ifdef TEXTURE5_ENABLED
 tex += decodeHDR(texture2D(texture5, v_Texcoord)) * weight5;
#endif
#ifdef TEXTURE6_ENABLED
 tex += decodeHDR(texture2D(texture6, v_Texcoord)) * weight6;
#endif
 gl_FragColor = encodeHDR(tex);
}
@end`;var mx=`@export clay.compositor.fxaa
uniform sampler2D texture;
uniform vec4 viewport : VIEWPORT;
varying vec2 v_Texcoord;
#define FXAA_REDUCE_MIN (1.0/128.0)
#define FXAA_REDUCE_MUL (1.0/8.0)
#define FXAA_SPAN_MAX 8.0
@import clay.util.rgbm
void main()
{
 vec2 resolution = 1.0 / viewport.zw;
 vec3 rgbNW = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * resolution ) ).xyz;
 vec3 rgbNE = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * resolution ) ).xyz;
 vec3 rgbSW = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * resolution ) ).xyz;
 vec3 rgbSE = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * resolution ) ).xyz;
 vec4 rgbaM = decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution ) );
 vec3 rgbM = rgbaM.xyz;
 float opacity = rgbaM.w;
 vec3 luma = vec3( 0.299, 0.587, 0.114 );
 float lumaNW = dot( rgbNW, luma );
 float lumaNE = dot( rgbNE, luma );
 float lumaSW = dot( rgbSW, luma );
 float lumaSE = dot( rgbSE, luma );
 float lumaM = dot( rgbM, luma );
 float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );
 float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );
 vec2 dir;
 dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
 dir.y = ((lumaNW + lumaSW) - (lumaNE + lumaSE));
 float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );
 float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );
 dir = min( vec2( FXAA_SPAN_MAX, FXAA_SPAN_MAX),
 max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
 dir * rcpDirMin)) * resolution;
 vec3 rgbA = decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * ( 1.0 / 3.0 - 0.5 ) ) ).xyz;
 rgbA += decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * ( 2.0 / 3.0 - 0.5 ) ) ).xyz;
 rgbA *= 0.5;
 vec3 rgbB = decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * -0.5 ) ).xyz;
 rgbB += decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * 0.5 ) ).xyz;
 rgbB *= 0.25;
 rgbB += rgbA * 0.5;
 float lumaB = dot( rgbB, luma );
 if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) )
 {
 gl_FragColor = vec4( rgbA, opacity );
 }
 else {
 gl_FragColor = vec4( rgbB, opacity );
 }
}
@end`;function NS(e){e.import(p4),e.import(sx),e.import(f4),e.import(lx),e.import(m4),e.import(cx),e.import(dx),e.import(ux),e.import(hx),e.import(px),e.import(g4),e.import(fx),e.import(mx)}NS(qe);var yte=/^#source\((.*?)\)/;function xte(e,t){var i=new c4;t=t||{};var r={textures:{},parameters:{}},n=function(s,c){for(var l=0;l<e.nodes.length;l++){var d=e.nodes[l],u=wte(d,r,t);u&&i.addNode(u)}};for(var o in e.parameters){var a=e.parameters[o];r.parameters[o]=OS(a)}return Ste(e,r,t,function(s){r.textures=s,n()}),i}function wte(e,t,i){var r=e.type||"filter",n,o,a;if(r==="filter"){var s=e.shader.trim(),c=yte.exec(s);if(c?n=qe.source(c[1].trim()):s.charAt(0)==="#"&&(n=t.shaders[s.substr(1)]),n||(n=s),!n)return}if(e.inputs){o={};for(var l in e.inputs)typeof e.inputs[l]=="string"?o[l]=e.inputs[l]:o[l]={node:e.inputs[l].node,pin:e.inputs[l].pin}}if(e.outputs){a={};for(var l in e.outputs){var d=e.outputs[l];a[l]={},d.attachment!=null&&(a[l].attachment=d.attachment),d.keepLastFrame!=null&&(a[l].keepLastFrame=d.keepLastFrame),d.outputLastFrame!=null&&(a[l].outputLastFrame=d.outputLastFrame),d.parameters&&(a[l].parameters=OS(d.parameters))}}var u;if(r==="scene"?u=new d4({name:e.name,scene:i.scene,camera:i.camera,outputs:a}):r==="texture"?u=new u4({name:e.name,outputs:a}):u=new h4({name:e.name,shader:n,inputs:o,outputs:a}),u){if(e.parameters)for(var l in e.parameters){var h=e.parameters[l];typeof h=="string"?(h=h.trim(),h.charAt(0)==="#"?h=t.textures[h.substr(1)]:u.on("beforerender",Tte(l,v4(h)))):typeof h=="function"&&u.on("beforerender",h),u.setParameter(l,h)}if(e.defines&&u.pass)for(var l in e.defines){var h=e.defines[l];u.pass.material.define("fragment",l,h)}}return u}function Ete(e,t){return e}function Cte(e,t){return t}function OS(e){var t={};if(!e)return t;["type","minFilter","magFilter","wrapS","wrapT","flipY","useMipmap"].forEach(function(r){var n=e[r];n!=null&&(typeof n=="string"&&(n=ot[n]),t[r]=n)});var i=e.scale||1;return["width","height"].forEach(function(r){if(e[r]!=null){var n=e[r];typeof n=="string"?(n=n.trim(),t[r]=Ate(r,v4(n),i)):t[r]=n}}),t.width||(t.width=Ete),t.height||(t.height=Cte),e.useMipmap!=null&&(t.useMipmap=e.useMipmap),t}function Ste(e,t,i,r){if(!e.textures){r({});return}var n={},o=0,a=!1,s=i.textureRootPath;Wr.each(e.textures,function(c,l){var d,u=c.path,h=OS(c.parameters);if(Array.isArray(u)&&u.length===6)s&&(u=u.map(function(p){return Wr.relative2absolute(p,s)})),d=new yc(h);else if(typeof u=="string")s&&(u=Wr.relative2absolute(u,s)),d=new wt(h);else return;d.load(u),o++,d.once("success",function(){n[l]=d,o--,o===0&&(r(n),a=!0)})}),o===0&&!a&&r(n)}function Tte(e,t){return function(i){var r=i.getDevicePixelRatio(),n=i.getWidth(),o=i.getHeight(),a=t(n,o,r);this.setParameter(e,a)}}function Ate(e,t,i){return i=i||1,function(r){var n=r.getDevicePixelRatio(),o=r.getWidth()*i,a=r.getHeight()*i;return t(o,a,n)}}function v4(e){var t=/^expr\((.*)\)$/.exec(e);if(t)try{var i=new Function("width","height","dpr","return "+t[1]);return i(1,1),i}catch{throw new Error("Invalid expression.")}}var _4=xte;var b4=_4;function Dte(e,t){for(var i=0,r=1/t,n=e;n>0;)i=i+r*(n%t),n=Math.floor(n/t),r=r/t;return i}var Cc=Dte;var y4=`@export ecgl.ssao.estimate

uniform sampler2D depthTex;

uniform sampler2D normalTex;

uniform sampler2D noiseTex;

uniform vec2 depthTexSize;

uniform vec2 noiseTexSize;

uniform mat4 projection;

uniform mat4 projectionInv;

uniform mat4 viewInverseTranspose;

uniform vec3 kernel[KERNEL_SIZE];

uniform float radius : 1;

uniform float power : 1;

uniform float bias: 1e-2;

uniform float intensity: 1.0;

varying vec2 v_Texcoord;

float ssaoEstimator(in vec3 originPos, in mat3 kernelBasis) {
 float occlusion = 0.0;

 for (int i = 0; i < KERNEL_SIZE; i++) {
 vec3 samplePos = kernel[i];
#ifdef NORMALTEX_ENABLED
 samplePos = kernelBasis * samplePos;
#endif
 samplePos = samplePos * radius + originPos;

 vec4 texCoord = projection * vec4(samplePos, 1.0);
 texCoord.xy /= texCoord.w;

 vec4 depthTexel = texture2D(depthTex, texCoord.xy * 0.5 + 0.5);

 float sampleDepth = depthTexel.r * 2.0 - 1.0;
 if (projection[3][3] == 0.0) {
 sampleDepth = projection[3][2] / (sampleDepth * projection[2][3] - projection[2][2]);
 }
 else {
 sampleDepth = (sampleDepth - projection[3][2]) / projection[2][2];
 }
 
 float rangeCheck = smoothstep(0.0, 1.0, radius / abs(originPos.z - sampleDepth));
 occlusion += rangeCheck * step(samplePos.z, sampleDepth - bias);
 }
#ifdef NORMALTEX_ENABLED
 occlusion = 1.0 - occlusion / float(KERNEL_SIZE);
#else
 occlusion = 1.0 - clamp((occlusion / float(KERNEL_SIZE) - 0.6) * 2.5, 0.0, 1.0);
#endif
 return pow(occlusion, power);
}

void main()
{

 vec4 depthTexel = texture2D(depthTex, v_Texcoord);

#ifdef NORMALTEX_ENABLED
 vec4 tex = texture2D(normalTex, v_Texcoord);
 if (dot(tex.rgb, tex.rgb) == 0.0) {
 gl_FragColor = vec4(1.0);
 return;
 }
 vec3 N = tex.rgb * 2.0 - 1.0;
 N = (viewInverseTranspose * vec4(N, 0.0)).xyz;

 vec2 noiseTexCoord = depthTexSize / vec2(noiseTexSize) * v_Texcoord;
 vec3 rvec = texture2D(noiseTex, noiseTexCoord).rgb * 2.0 - 1.0;
 vec3 T = normalize(rvec - N * dot(rvec, N));
 vec3 BT = normalize(cross(N, T));
 mat3 kernelBasis = mat3(T, BT, N);
#else
 if (depthTexel.r > 0.99999) {
 gl_FragColor = vec4(1.0);
 return;
 }
 mat3 kernelBasis;
#endif

 float z = depthTexel.r * 2.0 - 1.0;

 vec4 projectedPos = vec4(v_Texcoord * 2.0 - 1.0, z, 1.0);
 vec4 p4 = projectionInv * projectedPos;

 vec3 position = p4.xyz / p4.w;

 float ao = ssaoEstimator(position, kernelBasis);
 ao = clamp(1.0 - (1.0 - ao) * intensity, 0.0, 1.0);
 gl_FragColor = vec4(vec3(ao), 1.0);
}

@end


@export ecgl.ssao.blur
#define SHADER_NAME SSAO_BLUR

uniform sampler2D ssaoTexture;

#ifdef NORMALTEX_ENABLED
uniform sampler2D normalTex;
#endif

varying vec2 v_Texcoord;

uniform vec2 textureSize;
uniform float blurSize : 1.0;

uniform int direction: 0.0;

#ifdef DEPTHTEX_ENABLED
uniform sampler2D depthTex;
uniform mat4 projection;
uniform float depthRange : 0.5;

float getLinearDepth(vec2 coord)
{
 float depth = texture2D(depthTex, coord).r * 2.0 - 1.0;
 return projection[3][2] / (depth * projection[2][3] - projection[2][2]);
}
#endif

void main()
{
 float kernel[5];
 kernel[0] = 0.122581;
 kernel[1] = 0.233062;
 kernel[2] = 0.288713;
 kernel[3] = 0.233062;
 kernel[4] = 0.122581;

 vec2 off = vec2(0.0);
 if (direction == 0) {
 off[0] = blurSize / textureSize.x;
 }
 else {
 off[1] = blurSize / textureSize.y;
 }

 vec2 coord = v_Texcoord;

 float sum = 0.0;
 float weightAll = 0.0;

#ifdef NORMALTEX_ENABLED
 vec3 centerNormal = texture2D(normalTex, v_Texcoord).rgb * 2.0 - 1.0;
#endif
#if defined(DEPTHTEX_ENABLED)
 float centerDepth = getLinearDepth(v_Texcoord);
#endif

 for (int i = 0; i < 5; i++) {
 vec2 coord = clamp(v_Texcoord + vec2(float(i) - 2.0) * off, vec2(0.0), vec2(1.0));

 float w = kernel[i];
#ifdef NORMALTEX_ENABLED
 vec3 normal = texture2D(normalTex, coord).rgb * 2.0 - 1.0;
 w *= clamp(dot(normal, centerNormal), 0.0, 1.0);
#endif
#ifdef DEPTHTEX_ENABLED
 float d = getLinearDepth(coord);
 w *= (1.0 - smoothstep(abs(centerDepth - d) / depthRange, 0.0, 1.0));
#endif

 weightAll += w;
 sum += texture2D(ssaoTexture, coord).r * w;
 }

 gl_FragColor = vec4(vec3(sum / weightAll), 1.0);
}

@end
`;qe.import(y4);function w4(e){for(var t=new Uint8Array(e*e*4),i=0,r=new Fe,n=0;n<e;n++)for(var o=0;o<e;o++)r.set(Math.random()*2-1,Math.random()*2-1,0).normalize(),t[i++]=(r.x*.5+.5)*255,t[i++]=(r.y*.5+.5)*255,t[i++]=0,t[i++]=255;return t}function x4(e){return new wt({pixels:w4(e),wrapS:ot.REPEAT,wrapT:ot.REPEAT,width:e,height:e})}function Ite(e,t,i){var r=new Float32Array(e*3);t=t||0;for(var n=0;n<e;n++){var o=Cc(n+t,2)*(i?1:2)*Math.PI,a=Cc(n+t,3)*Math.PI,s=Math.random(),c=Math.cos(o)*Math.sin(a)*s,l=Math.cos(a)*s,d=Math.sin(o)*Math.sin(a)*s;r[n*3]=c,r[n*3+1]=l,r[n*3+2]=d}return r}function Sc(e){e=e||{},this._ssaoPass=new cr({fragment:qe.source("ecgl.ssao.estimate")}),this._blurPass=new cr({fragment:qe.source("ecgl.ssao.blur")}),this._framebuffer=new tr({depthBuffer:!1}),this._ssaoTexture=new wt,this._blurTexture=new wt,this._blurTexture2=new wt,this._depthTex=e.depthTexture,this._normalTex=e.normalTexture,this.setNoiseSize(4),this.setKernelSize(e.kernelSize||12),e.radius!=null&&this.setParameter("radius",e.radius),e.power!=null&&this.setParameter("power",e.power),this._normalTex||(this._ssaoPass.material.disableTexture("normalTex"),this._blurPass.material.disableTexture("normalTex")),this._depthTex||this._blurPass.material.disableTexture("depthTex"),this._blurPass.material.setUniform("normalTex",this._normalTex),this._blurPass.material.setUniform("depthTex",this._depthTex)}Sc.prototype.setDepthTexture=function(e){this._depthTex=e};Sc.prototype.setNormalTexture=function(e){this._normalTex=e,this._ssaoPass.material[e?"enableTexture":"disableTexture"]("normalTex"),this.setKernelSize(this._kernelSize)};Sc.prototype.update=function(e,t,i){var r=e.getWidth(),n=e.getHeight(),o=this._ssaoPass,a=this._blurPass;o.setUniform("kernel",this._kernels[i%this._kernels.length]),o.setUniform("depthTex",this._depthTex),this._normalTex!=null&&o.setUniform("normalTex",this._normalTex),o.setUniform("depthTexSize",[this._depthTex.width,this._depthTex.height]);var s=new ct;ct.transpose(s,t.worldTransform),o.setUniform("projection",t.projectionMatrix.array),o.setUniform("projectionInv",t.invProjectionMatrix.array),o.setUniform("viewInverseTranspose",s.array);var c=this._ssaoTexture,l=this._blurTexture,d=this._blurTexture2;c.width=r/2,c.height=n/2,l.width=r,l.height=n,d.width=r,d.height=n,this._framebuffer.attach(c),this._framebuffer.bind(e),e.gl.clearColor(1,1,1,1),e.gl.clear(e.gl.COLOR_BUFFER_BIT),o.render(e),a.setUniform("textureSize",[r/2,n/2]),a.setUniform("projection",t.projectionMatrix.array),this._framebuffer.attach(l),a.setUniform("direction",0),a.setUniform("ssaoTexture",c),a.render(e),this._framebuffer.attach(d),a.setUniform("textureSize",[r,n]),a.setUniform("direction",1),a.setUniform("ssaoTexture",l),a.render(e),this._framebuffer.unbind(e);var u=e.clearColor;e.gl.clearColor(u[0],u[1],u[2],u[3])};Sc.prototype.getTargetTexture=function(){return this._blurTexture2};Sc.prototype.setParameter=function(e,t){e==="noiseTexSize"?this.setNoiseSize(t):e==="kernelSize"?this.setKernelSize(t):e==="intensity"?this._ssaoPass.material.set("intensity",t):this._ssaoPass.setUniform(e,t)};Sc.prototype.setKernelSize=function(e){this._kernelSize=e,this._ssaoPass.material.define("fragment","KERNEL_SIZE",e),this._kernels=this._kernels||[];for(var t=0;t<30;t++)this._kernels[t]=Ite(e,t*e,!!this._normalTex)};Sc.prototype.setNoiseSize=function(e){var t=this._ssaoPass.getUniform("noiseTex");t?(t.data=w4(e),t.width=t.height=e,t.dirty()):(t=x4(e),this._ssaoPass.setUniform("noiseTex",x4(e))),this._ssaoPass.setUniform("noiseTexSize",[e,e])};Sc.prototype.dispose=function(e){this._blurTexture.dispose(e),this._ssaoTexture.dispose(e),this._blurTexture2.dispose(e)};var E4=Sc;var C4=`@export ecgl.ssr.main

#define SHADER_NAME SSR
#define MAX_ITERATION 20;
#define SAMPLE_PER_FRAME 5;
#define TOTAL_SAMPLES 128;

uniform sampler2D sourceTexture;
uniform sampler2D gBufferTexture1;
uniform sampler2D gBufferTexture2;
uniform sampler2D gBufferTexture3;
uniform samplerCube specularCubemap;
uniform float specularIntensity: 1;

uniform mat4 projection;
uniform mat4 projectionInv;
uniform mat4 toViewSpace;
uniform mat4 toWorldSpace;

uniform float maxRayDistance: 200;

uniform float pixelStride: 16;
uniform float pixelStrideZCutoff: 50; 
uniform float screenEdgeFadeStart: 0.9; 
uniform float eyeFadeStart : 0.2; uniform float eyeFadeEnd: 0.8; 
uniform float minGlossiness: 0.2; uniform float zThicknessThreshold: 1;

uniform float nearZ;
uniform vec2 viewportSize : VIEWPORT_SIZE;

uniform float jitterOffset: 0;

varying vec2 v_Texcoord;

#ifdef DEPTH_DECODE
@import clay.util.decode_float
#endif

#ifdef PHYSICALLY_CORRECT
uniform sampler2D normalDistribution;
uniform float sampleOffset: 0;
uniform vec2 normalDistributionSize;

vec3 transformNormal(vec3 H, vec3 N) {
 vec3 upVector = N.y > 0.999 ? vec3(1.0, 0.0, 0.0) : vec3(0.0, 1.0, 0.0);
 vec3 tangentX = normalize(cross(N, upVector));
 vec3 tangentZ = cross(N, tangentX);
 return normalize(tangentX * H.x + N * H.y + tangentZ * H.z);
}
vec3 importanceSampleNormalGGX(float i, float roughness, vec3 N) {
 float p = fract((i + sampleOffset) / float(TOTAL_SAMPLES));
 vec3 H = texture2D(normalDistribution,vec2(roughness, p)).rgb;
 return transformNormal(H, N);
}
float G_Smith(float g, float ndv, float ndl) {
 float roughness = 1.0 - g;
 float k = roughness * roughness / 2.0;
 float G1V = ndv / (ndv * (1.0 - k) + k);
 float G1L = ndl / (ndl * (1.0 - k) + k);
 return G1L * G1V;
}
vec3 F_Schlick(float ndv, vec3 spec) {
 return spec + (1.0 - spec) * pow(1.0 - ndv, 5.0);
}
#endif

float fetchDepth(sampler2D depthTexture, vec2 uv)
{
 vec4 depthTexel = texture2D(depthTexture, uv);
 return depthTexel.r * 2.0 - 1.0;
}

float linearDepth(float depth)
{
 if (projection[3][3] == 0.0) {
 return projection[3][2] / (depth * projection[2][3] - projection[2][2]);
 }
 else {
 return (depth - projection[3][2]) / projection[2][2];
 }
}

bool rayIntersectDepth(float rayZNear, float rayZFar, vec2 hitPixel)
{
 if (rayZFar > rayZNear)
 {
 float t = rayZFar; rayZFar = rayZNear; rayZNear = t;
 }
 float cameraZ = linearDepth(fetchDepth(gBufferTexture2, hitPixel));
 return rayZFar <= cameraZ && rayZNear >= cameraZ - zThicknessThreshold;
}


bool traceScreenSpaceRay(
 vec3 rayOrigin, vec3 rayDir, float jitter,
 out vec2 hitPixel, out vec3 hitPoint, out float iterationCount
)
{
 float rayLength = ((rayOrigin.z + rayDir.z * maxRayDistance) > -nearZ)
 ? (-nearZ - rayOrigin.z) / rayDir.z : maxRayDistance;

 vec3 rayEnd = rayOrigin + rayDir * rayLength;

 vec4 H0 = projection * vec4(rayOrigin, 1.0);
 vec4 H1 = projection * vec4(rayEnd, 1.0);

 float k0 = 1.0 / H0.w, k1 = 1.0 / H1.w;

 vec3 Q0 = rayOrigin * k0, Q1 = rayEnd * k1;

 vec2 P0 = (H0.xy * k0 * 0.5 + 0.5) * viewportSize;
 vec2 P1 = (H1.xy * k1 * 0.5 + 0.5) * viewportSize;

 P1 += dot(P1 - P0, P1 - P0) < 0.0001 ? 0.01 : 0.0;
 vec2 delta = P1 - P0;

 bool permute = false;
 if (abs(delta.x) < abs(delta.y)) {
 permute = true;
 delta = delta.yx;
 P0 = P0.yx;
 P1 = P1.yx;
 }
 float stepDir = sign(delta.x);
 float invdx = stepDir / delta.x;

 vec3 dQ = (Q1 - Q0) * invdx;
 float dk = (k1 - k0) * invdx;

 vec2 dP = vec2(stepDir, delta.y * invdx);

 float strideScaler = 1.0 - min(1.0, -rayOrigin.z / pixelStrideZCutoff);
 float pixStride = 1.0 + strideScaler * pixelStride;

 dP *= pixStride; dQ *= pixStride; dk *= pixStride;

 vec4 pqk = vec4(P0, Q0.z, k0);
 vec4 dPQK = vec4(dP, dQ.z, dk);

 pqk += dPQK * jitter;
 float rayZFar = (dPQK.z * 0.5 + pqk.z) / (dPQK.w * 0.5 + pqk.w);
 float rayZNear;

 bool intersect = false;

 vec2 texelSize = 1.0 / viewportSize;

 iterationCount = 0.0;

 for (int i = 0; i < MAX_ITERATION; i++)
 {
 pqk += dPQK;

 rayZNear = rayZFar;
 rayZFar = (dPQK.z * 0.5 + pqk.z) / (dPQK.w * 0.5 + pqk.w);

 hitPixel = permute ? pqk.yx : pqk.xy;
 hitPixel *= texelSize;

 intersect = rayIntersectDepth(rayZNear, rayZFar, hitPixel);

 iterationCount += 1.0;

 dPQK *= 1.2;

 if (intersect) {
 break;
 }
 }

 Q0.xy += dQ.xy * iterationCount;
 Q0.z = pqk.z;
 hitPoint = Q0 / pqk.w;

 return intersect;
}

float calculateAlpha(
 float iterationCount, float reflectivity,
 vec2 hitPixel, vec3 hitPoint, float dist, vec3 rayDir
)
{
 float alpha = clamp(reflectivity, 0.0, 1.0);
 alpha *= 1.0 - (iterationCount / float(MAX_ITERATION));
 vec2 hitPixelNDC = hitPixel * 2.0 - 1.0;
 float maxDimension = min(1.0, max(abs(hitPixelNDC.x), abs(hitPixelNDC.y)));
 alpha *= 1.0 - max(0.0, maxDimension - screenEdgeFadeStart) / (1.0 - screenEdgeFadeStart);

 float _eyeFadeStart = eyeFadeStart;
 float _eyeFadeEnd = eyeFadeEnd;
 if (_eyeFadeStart > _eyeFadeEnd) {
 float tmp = _eyeFadeEnd;
 _eyeFadeEnd = _eyeFadeStart;
 _eyeFadeStart = tmp;
 }

 float eyeDir = clamp(rayDir.z, _eyeFadeStart, _eyeFadeEnd);
 alpha *= 1.0 - (eyeDir - _eyeFadeStart) / (_eyeFadeEnd - _eyeFadeStart);

 alpha *= 1.0 - clamp(dist / maxRayDistance, 0.0, 1.0);

 return alpha;
}

@import clay.util.rand

@import clay.util.rgbm

void main()
{
 vec4 normalAndGloss = texture2D(gBufferTexture1, v_Texcoord);

 if (dot(normalAndGloss.rgb, vec3(1.0)) == 0.0) {
 discard;
 }

 float g = normalAndGloss.a;
#if !defined(PHYSICALLY_CORRECT)
 if (g <= minGlossiness) {
 discard;
 }
#endif

 float reflectivity = (g - minGlossiness) / (1.0 - minGlossiness);

 vec3 N = normalize(normalAndGloss.rgb * 2.0 - 1.0);
 N = normalize((toViewSpace * vec4(N, 0.0)).xyz);

 vec4 projectedPos = vec4(v_Texcoord * 2.0 - 1.0, fetchDepth(gBufferTexture2, v_Texcoord), 1.0);
 vec4 pos = projectionInv * projectedPos;
 vec3 rayOrigin = pos.xyz / pos.w;
 vec3 V = -normalize(rayOrigin);

 float ndv = clamp(dot(N, V), 0.0, 1.0);
 float iterationCount;
 float jitter = rand(fract(v_Texcoord + jitterOffset));

#ifdef PHYSICALLY_CORRECT
 vec4 color = vec4(vec3(0.0), 1.0);
 vec4 albedoMetalness = texture2D(gBufferTexture3, v_Texcoord);
 vec3 albedo = albedoMetalness.rgb;
 float m = albedoMetalness.a;
 vec3 diffuseColor = albedo * (1.0 - m);
 vec3 spec = mix(vec3(0.04), albedo, m);

 float jitter2 = rand(fract(v_Texcoord)) * float(TOTAL_SAMPLES);

 for (int i = 0; i < SAMPLE_PER_FRAME; i++) {
 vec3 H = importanceSampleNormalGGX(float(i) + jitter2, 1.0 - g, N);
 vec3 rayDir = normalize(reflect(-V, H));
#else
 vec3 rayDir = normalize(reflect(-V, N));
#endif
 vec2 hitPixel;
 vec3 hitPoint;

 bool intersect = traceScreenSpaceRay(rayOrigin, rayDir, jitter, hitPixel, hitPoint, iterationCount);

 float dist = distance(rayOrigin, hitPoint);

 vec3 hitNormal = texture2D(gBufferTexture1, hitPixel).rgb * 2.0 - 1.0;
 hitNormal = normalize((toViewSpace * vec4(hitNormal, 0.0)).xyz);
#ifdef PHYSICALLY_CORRECT
 float ndl = clamp(dot(N, rayDir), 0.0, 1.0);
 float vdh = clamp(dot(V, H), 0.0, 1.0);
 float ndh = clamp(dot(N, H), 0.0, 1.0);
 vec3 litTexel = vec3(0.0);
 if (dot(hitNormal, rayDir) < 0.0 && intersect) {
 litTexel = texture2D(sourceTexture, hitPixel).rgb;
 litTexel *= pow(clamp(1.0 - dist / 200.0, 0.0, 1.0), 3.0);

 }
 else {
 #ifdef SPECULARCUBEMAP_ENABLED
 vec3 rayDirW = normalize(toWorldSpace * vec4(rayDir, 0.0)).rgb;
 litTexel = RGBMDecode(textureCubeLodEXT(specularCubemap, rayDirW, 0.0), 8.12).rgb * specularIntensity;
#endif
 }
 color.rgb += ndl * litTexel * (
 F_Schlick(ndl, spec) * G_Smith(g, ndv, ndl) * vdh / (ndh * ndv + 0.001)
 );
 }
 color.rgb /= float(SAMPLE_PER_FRAME);
#else
 #if !defined(SPECULARCUBEMAP_ENABLED)
 if (dot(hitNormal, rayDir) >= 0.0) {
 discard;
 }
 if (!intersect) {
 discard;
 }
#endif
 float alpha = clamp(calculateAlpha(iterationCount, reflectivity, hitPixel, hitPoint, dist, rayDir), 0.0, 1.0);
 vec4 color = texture2D(sourceTexture, hitPixel);
 color.rgb *= alpha;

#ifdef SPECULARCUBEMAP_ENABLED
 vec3 rayDirW = normalize(toWorldSpace * vec4(rayDir, 0.0)).rgb;
 alpha = alpha * (intersect ? 1.0 : 0.0);
 float bias = (1.0 -g) * 5.0;
 color.rgb += (1.0 - alpha)
 * RGBMDecode(textureCubeLodEXT(specularCubemap, rayDirW, bias), 8.12).rgb
 * specularIntensity;
#endif

#endif

 gl_FragColor = encodeHDR(color);
}
@end

@export ecgl.ssr.blur

uniform sampler2D texture;
uniform sampler2D gBufferTexture1;
uniform sampler2D gBufferTexture2;
uniform mat4 projection;
uniform float depthRange : 0.05;

varying vec2 v_Texcoord;

uniform vec2 textureSize;
uniform float blurSize : 1.0;

#ifdef BLEND
 #ifdef SSAOTEX_ENABLED
uniform sampler2D ssaoTex;
 #endif
uniform sampler2D sourceTexture;
#endif

float getLinearDepth(vec2 coord)
{
 float depth = texture2D(gBufferTexture2, coord).r * 2.0 - 1.0;
 return projection[3][2] / (depth * projection[2][3] - projection[2][2]);
}

@import clay.util.rgbm


void main()
{
 @import clay.compositor.kernel.gaussian_9

 vec4 centerNTexel = texture2D(gBufferTexture1, v_Texcoord);
 float g = centerNTexel.a;
 float maxBlurSize = clamp(1.0 - g, 0.0, 1.0) * blurSize;
#ifdef VERTICAL
 vec2 off = vec2(0.0, maxBlurSize / textureSize.y);
#else
 vec2 off = vec2(maxBlurSize / textureSize.x, 0.0);
#endif

 vec2 coord = v_Texcoord;

 vec4 sum = vec4(0.0);
 float weightAll = 0.0;

 vec3 cN = centerNTexel.rgb * 2.0 - 1.0;
 float cD = getLinearDepth(v_Texcoord);
 for (int i = 0; i < 9; i++) {
 vec2 coord = clamp((float(i) - 4.0) * off + v_Texcoord, vec2(0.0), vec2(1.0));
 float w = gaussianKernel[i]
 * clamp(dot(cN, texture2D(gBufferTexture1, coord).rgb * 2.0 - 1.0), 0.0, 1.0);
 float d = getLinearDepth(coord);
 w *= (1.0 - smoothstep(abs(cD - d) / depthRange, 0.0, 1.0));

 weightAll += w;
 sum += decodeHDR(texture2D(texture, coord)) * w;
 }

#ifdef BLEND
 float aoFactor = 1.0;
 #ifdef SSAOTEX_ENABLED
 aoFactor = texture2D(ssaoTex, v_Texcoord).r;
 #endif
 gl_FragColor = encodeHDR(
 sum / weightAll * aoFactor + decodeHDR(texture2D(sourceTexture, v_Texcoord))
 );
#else
 gl_FragColor = encodeHDR(sum / weightAll);
#endif
}

@end`;qe.import(C4);function Tc(e){e=e||{},this._ssrPass=new cr({fragment:qe.source("ecgl.ssr.main"),clearColor:[0,0,0,0]}),this._blurPass1=new cr({fragment:qe.source("ecgl.ssr.blur"),clearColor:[0,0,0,0]}),this._blurPass2=new cr({fragment:qe.source("ecgl.ssr.blur"),clearColor:[0,0,0,0]}),this._blendPass=new cr({fragment:qe.source("clay.compositor.blend")}),this._blendPass.material.disableTexturesAll(),this._blendPass.material.enableTexture(["texture1","texture2"]),this._ssrPass.setUniform("gBufferTexture1",e.normalTexture),this._ssrPass.setUniform("gBufferTexture2",e.depthTexture),this._blurPass1.setUniform("gBufferTexture1",e.normalTexture),this._blurPass1.setUniform("gBufferTexture2",e.depthTexture),this._blurPass2.setUniform("gBufferTexture1",e.normalTexture),this._blurPass2.setUniform("gBufferTexture2",e.depthTexture),this._blurPass2.material.define("fragment","VERTICAL"),this._blurPass2.material.define("fragment","BLEND"),this._ssrTexture=new wt({type:ot.HALF_FLOAT}),this._texture2=new wt({type:ot.HALF_FLOAT}),this._texture3=new wt({type:ot.HALF_FLOAT}),this._prevTexture=new wt({type:ot.HALF_FLOAT}),this._currentTexture=new wt({type:ot.HALF_FLOAT}),this._frameBuffer=new tr({depthBuffer:!1}),this._normalDistribution=null,this._totalSamples=256,this._samplePerFrame=4,this._ssrPass.material.define("fragment","SAMPLE_PER_FRAME",this._samplePerFrame),this._ssrPass.material.define("fragment","TOTAL_SAMPLES",this._totalSamples),this._downScale=1}Tc.prototype.setAmbientCubemap=function(e,t){this._ssrPass.material.set("specularCubemap",e),this._ssrPass.material.set("specularIntensity",t);var i=e&&t;this._ssrPass.material[i?"enableTexture":"disableTexture"]("specularCubemap")};Tc.prototype.update=function(e,t,i,r){var n=e.getWidth(),o=e.getHeight(),a=this._ssrTexture,s=this._texture2,c=this._texture3;a.width=this._prevTexture.width=this._currentTexture.width=n/this._downScale,a.height=this._prevTexture.height=this._currentTexture.height=o/this._downScale,s.width=c.width=n,s.height=c.height=o;var l=this._frameBuffer,d=this._ssrPass,u=this._blurPass1,h=this._blurPass2,p=this._blendPass,m=new ct,f=new ct;ct.transpose(m,t.worldTransform),ct.transpose(f,t.viewMatrix),d.setUniform("sourceTexture",i),d.setUniform("projection",t.projectionMatrix.array),d.setUniform("projectionInv",t.invProjectionMatrix.array),d.setUniform("toViewSpace",m.array),d.setUniform("toWorldSpace",f.array),d.setUniform("nearZ",t.near);var g=r/this._totalSamples*this._samplePerFrame;if(d.setUniform("jitterOffset",g),d.setUniform("sampleOffset",r*this._samplePerFrame),u.setUniform("textureSize",[a.width,a.height]),h.setUniform("textureSize",[n,o]),h.setUniform("sourceTexture",i),u.setUniform("projection",t.projectionMatrix.array),h.setUniform("projection",t.projectionMatrix.array),l.attach(a),l.bind(e),d.render(e),this._physicallyCorrect&&(l.attach(this._currentTexture),p.setUniform("texture1",this._prevTexture),p.setUniform("texture2",a),p.material.set({weight1:r>=1?.95:0,weight2:r>=1?.05:1}),p.render(e)),l.attach(s),u.setUniform("texture",this._physicallyCorrect?this._currentTexture:a),u.render(e),l.attach(c),h.setUniform("texture",s),h.render(e),l.unbind(e),this._physicallyCorrect){var v=this._prevTexture;this._prevTexture=this._currentTexture,this._currentTexture=v}};Tc.prototype.getTargetTexture=function(){return this._texture3};Tc.prototype.setParameter=function(e,t){e==="maxIteration"?this._ssrPass.material.define("fragment","MAX_ITERATION",t):this._ssrPass.setUniform(e,t)};Tc.prototype.setPhysicallyCorrect=function(e){e?(this._normalDistribution||(this._normalDistribution=mf.generateNormalDistribution(64,this._totalSamples)),this._ssrPass.material.define("fragment","PHYSICALLY_CORRECT"),this._ssrPass.material.set("normalDistribution",this._normalDistribution),this._ssrPass.material.set("normalDistributionSize",[64,this._totalSamples])):this._ssrPass.material.undefine("fragment","PHYSICALLY_CORRECT"),this._physicallyCorrect=e};Tc.prototype.setSSAOTexture=function(e){var t=this._blurPass2;e?(t.material.enableTexture("ssaoTex"),t.material.set("ssaoTex",e)):t.material.disableTexture("ssaoTex")};Tc.prototype.isFinished=function(e){return this._physicallyCorrect?e>this._totalSamples/this._samplePerFrame:!0};Tc.prototype.dispose=function(e){this._ssrTexture.dispose(e),this._texture2.dispose(e),this._texture3.dispose(e),this._prevTexture.dispose(e),this._currentTexture.dispose(e),this._frameBuffer.dispose(e)};var S4=Tc;var RS=[0,0,-.321585265978,-.154972575841,.458126042375,.188473391593,.842080129861,.527766490688,.147304551086,-.659453822776,-.331943915203,-.940619700594,.0479226680259,.54812163202,.701581552186,-.709825561388,-.295436780218,.940589268233,-.901489676764,.237713156085,.973570876096,-.109899459384,-.866792314779,-.451805525005,.330975007087,.800048655954,-.344275183665,.381779221166,-.386139432542,-.437418421534,-.576478634965,-.0148463392551,.385798197415,-.262426961053,-.666302061145,.682427250835,-.628010632582,-.732836215494,.10163141741,-.987658134403,.711995289051,-.320024291314,.0296005138058,.950296523438,.0130612307608,-.351024443122,-.879596633704,-.10478487883,.435712737232,.504254490347,.779203817497,.206477676721,.388264289969,-.896736162545,-.153106280781,-.629203242522,-.245517550697,.657969239148,.126830499058,.26862328493,-.634888119007,-.302301223431,.617074219636,.779817204925];var T4=`@export ecgl.normal.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header

@import ecgl.common.attributes

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

@import ecgl.common.normalMap.vertexHeader

@import ecgl.common.vertexAnimation.header

void main()
{

 @import ecgl.common.vertexAnimation.main

 @import ecgl.common.uv.main

 v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);
 v_WorldPosition = (world * vec4(pos, 1.0)).xyz;

 @import ecgl.common.normalMap.vertexMain

 gl_Position = worldViewProjection * vec4(pos, 1.0);

}


@end


@export ecgl.normal.fragment

#define ROUGHNESS_CHANEL 0

uniform bool useBumpMap;
uniform bool useRoughnessMap;
uniform bool doubleSide;
uniform float roughness;

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform mat4 viewInverse : VIEWINVERSE;

@import ecgl.common.normalMap.fragmentHeader
@import ecgl.common.bumpMap.header

uniform sampler2D roughnessMap;

void main()
{
 vec3 N = v_Normal;
 
 bool flipNormal = false;
 if (doubleSide) {
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);

 if (dot(N, V) < 0.0) {
 flipNormal = true;
 }
 }

 @import ecgl.common.normalMap.fragmentMain

 if (useBumpMap) {
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 }

 float g = 1.0 - roughness;

 if (useRoughnessMap) {
 float g2 = 1.0 - texture2D(roughnessMap, v_DetailTexcoord)[ROUGHNESS_CHANEL];
 g = clamp(g2 + (g - 0.5) * 2.0, 0.0, 1.0);
 }

 if (flipNormal) {
 N = -N;
 }

 gl_FragColor.rgb = (N.xyz + 1.0) * 0.5;
 gl_FragColor.a = g;
}
@end`;qe.import(T4);function FS(e,t,i,r,n){var o=e.gl;t.setUniform(o,"1i",i,n),o.activeTexture(o.TEXTURE0+n),r.isRenderable()?r.bind(e):r.unbind(e)}function Mte(e,t,i,r,n){var o,a,s,c,l=e.gl;return function(d,u,h){if(!(c&&c.material===d.material)){var p=d.material,m=d.__program,f=p.get("roughness");f==null&&(f=1);var g=p.get("normalMap")||t,v=p.get("roughnessMap"),_=p.get("bumpMap"),b=p.get("uvRepeat"),y=p.get("uvOffset"),x=p.get("detailUvRepeat"),w=p.get("detailUvOffset"),I=!!_&&p.isTextureEnabled("bumpMap"),S=!!v&&p.isTextureEnabled("roughnessMap"),E=p.isDefined("fragment","DOUBLE_SIDED");_=_||i,v=v||r,h!==u?(u.set("normalMap",g),u.set("bumpMap",_),u.set("roughnessMap",v),u.set("useBumpMap",I),u.set("useRoughnessMap",S),u.set("doubleSide",E),b!=null&&u.set("uvRepeat",b),y!=null&&u.set("uvOffset",y),x!=null&&u.set("detailUvRepeat",x),w!=null&&u.set("detailUvOffset",w),u.set("roughness",f)):(m.setUniform(l,"1f","roughness",f),o!==g&&FS(e,m,"normalMap",g,0),a!==_&&_&&FS(e,m,"bumpMap",_,1),s!==v&&v&&FS(e,m,"roughnessMap",v,2),b!=null&&m.setUniform(l,"2f","uvRepeat",b),y!=null&&m.setUniform(l,"2f","uvOffset",y),x!=null&&m.setUniform(l,"2f","detailUvRepeat",x),w!=null&&m.setUniform(l,"2f","detailUvOffset",w),m.setUniform(l,"1i","useBumpMap",+I),m.setUniform(l,"1i","useRoughnessMap",+S),m.setUniform(l,"1i","doubleSide",+E)),o=g,a=_,s=v,c=d}}}function _f(e){e=e||{},this._depthTex=new wt({format:ot.DEPTH_COMPONENT,type:ot.UNSIGNED_INT}),this._normalTex=new wt({type:ot.HALF_FLOAT}),this._framebuffer=new tr,this._framebuffer.attach(this._normalTex),this._framebuffer.attach(this._depthTex,tr.DEPTH_ATTACHMENT),this._normalMaterial=new In({shader:new qe(qe.source("ecgl.normal.vertex"),qe.source("ecgl.normal.fragment"))}),this._normalMaterial.enableTexture(["normalMap","bumpMap","roughnessMap"]),this._defaultNormalMap=Ol.createBlank("#000"),this._defaultBumpMap=Ol.createBlank("#000"),this._defaultRoughessMap=Ol.createBlank("#000"),this._debugPass=new cr({fragment:qe.source("clay.compositor.output")}),this._debugPass.setUniform("texture",this._normalTex),this._debugPass.material.undefine("fragment","OUTPUT_ALPHA")}_f.prototype.getDepthTexture=function(){return this._depthTex};_f.prototype.getNormalTexture=function(){return this._normalTex};_f.prototype.update=function(e,t,i){var r=e.getWidth(),n=e.getHeight(),o=this._depthTex,a=this._normalTex,s=this._normalMaterial;o.width=r,o.height=n,a.width=r,a.height=n;var c=t.getRenderList(i).opaque;this._framebuffer.bind(e),e.gl.clearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT|e.gl.DEPTH_BUFFER_BIT),e.gl.disable(e.gl.BLEND),e.renderPass(c,i,{getMaterial:function(){return s},ifRender:function(l){return l.renderNormal},beforeRender:Mte(e,this._defaultNormalMap,this._defaultBumpMap,this._defaultRoughessMap,this._normalMaterial),sort:e.opaqueSortCompare}),this._framebuffer.unbind(e)};_f.prototype.renderDebug=function(e){this._debugPass.render(e)};_f.prototype.dispose=function(e){this._depthTex.dispose(e),this._normalTex.dispose(e)};var A4=_f;function mv(e){e=e||{},this._edgePass=new cr({fragment:qe.source("ecgl.edge")}),this._edgePass.setUniform("normalTexture",e.normalTexture),this._edgePass.setUniform("depthTexture",e.depthTexture),this._targetTexture=new wt({type:ot.HALF_FLOAT}),this._frameBuffer=new tr,this._frameBuffer.attach(this._targetTexture)}mv.prototype.update=function(e,t,i,r){var n=e.getWidth(),o=e.getHeight(),a=this._targetTexture;a.width=n,a.height=o;var s=this._frameBuffer;s.bind(e),this._edgePass.setUniform("projectionInv",t.invProjectionMatrix.array),this._edgePass.setUniform("textureSize",[n,o]),this._edgePass.setUniform("texture",i),this._edgePass.render(e),s.unbind(e)};mv.prototype.getTargetTexture=function(){return this._targetTexture};mv.prototype.setParameter=function(e,t){this._edgePass.setUniform(e,t)};mv.prototype.dispose=function(e){this._targetTexture.dispose(e),this._frameBuffer.dispose(e)};var D4=mv;var I4={type:"compositor",nodes:[{name:"source",type:"texture",outputs:{color:{}}},{name:"source_half",shader:"#source(clay.compositor.downsample)",inputs:{texture:"source"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"bright",shader:"#source(clay.compositor.bright)",inputs:{texture:"source_half"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{threshold:2,scale:4,textureSize:"expr([width * 1.0 / 2, height / 2])"}},{name:"bright_downsample_4",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 2, height / 2] )"}},{name:"bright_downsample_8",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright_downsample_4"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 4, height / 4] )"}},{name:"bright_downsample_16",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright_downsample_8"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 8, height / 8] )"}},{name:"bright_downsample_32",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright_downsample_16"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 32)",height:"expr(height * 1.0 / 32)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 16, height / 16] )"}},{name:"bright_upsample_16_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_32"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 32, height / 32] )"}},{name:"bright_upsample_16_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_16_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 16, height * 1.0 / 16] )"}},{name:"bright_upsample_8_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_16"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 16, height * 1.0 / 16] )"}},{name:"bright_upsample_8_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_8_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 8, height * 1.0 / 8] )"}},{name:"bright_upsample_8_blend",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_8_blur_v",texture2:"bright_upsample_16_blur_v"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_4_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_8"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 8, height * 1.0 / 8] )"}},{name:"bright_upsample_4_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_4_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 4, height * 1.0 / 4] )"}},{name:"bright_upsample_4_blend",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_4_blur_v",texture2:"bright_upsample_8_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_2_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_4"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 4, height * 1.0 / 4] )"}},{name:"bright_upsample_2_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_2_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 2, height * 1.0 / 2] )"}},{name:"bright_upsample_2_blend",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_2_blur_v",texture2:"bright_upsample_4_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_full_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 2, height * 1.0 / 2] )"}},{name:"bright_upsample_full_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_full_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"bloom_composite",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_full_blur_v",texture2:"bright_upsample_2_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"coc",shader:"#source(ecgl.dof.coc)",outputs:{color:{parameters:{minFilter:"NEAREST",magFilter:"NEAREST",width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},parameters:{focalDist:50,focalRange:30}},{name:"dof_far_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"source",coc:"coc"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"dof_near_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"source",coc:"coc"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"},defines:{BLUR_NEARFIELD:null}},{name:"dof_coc_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"coc"},outputs:{color:{parameters:{minFilter:"NEAREST",magFilter:"NEAREST",width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"},defines:{BLUR_COC:null}},{name:"dof_composite",shader:"#source(ecgl.dof.composite)",inputs:{original:"source",blurred:"dof_far_blur",nearfield:"dof_near_blur",coc:"coc",nearcoc:"dof_coc_blur"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}}},{name:"composite",shader:"#source(clay.compositor.hdr.composite)",inputs:{texture:"source",bloom:"bloom_composite"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},defines:{}},{name:"FXAA",shader:"#source(clay.compositor.fxaa)",inputs:{texture:"composite"}}]};var M4=`@export ecgl.dof.coc

uniform sampler2D depth;

uniform float zNear: 0.1;
uniform float zFar: 2000;

uniform float focalDistance: 3;
uniform float focalRange: 1;
uniform float focalLength: 30;
uniform float fstop: 2.8;

varying vec2 v_Texcoord;

@import clay.util.encode_float

void main()
{
 float z = texture2D(depth, v_Texcoord).r * 2.0 - 1.0;

 float dist = 2.0 * zNear * zFar / (zFar + zNear - z * (zFar - zNear));

 float aperture = focalLength / fstop;

 float coc;

 float uppper = focalDistance + focalRange;
 float lower = focalDistance - focalRange;
 if (dist <= uppper && dist >= lower) {
 coc = 0.5;
 }
 else {
 float focalAdjusted = dist > uppper ? uppper : lower;

 coc = abs(aperture * (focalLength * (dist - focalAdjusted)) / (dist * (focalAdjusted - focalLength)));
 coc = clamp(coc, 0.0, 2.0) / 2.00001;

 if (dist < lower) {
 coc = -coc;
 }
 coc = coc * 0.5 + 0.5;
 }

 gl_FragColor = encodeFloat(coc);
}
@end


@export ecgl.dof.composite

#define DEBUG 0

uniform sampler2D original;
uniform sampler2D blurred;
uniform sampler2D nearfield;
uniform sampler2D coc;
uniform sampler2D nearcoc;
varying vec2 v_Texcoord;

@import clay.util.rgbm
@import clay.util.float

void main()
{
 vec4 blurredColor = texture2D(blurred, v_Texcoord);
 vec4 originalColor = texture2D(original, v_Texcoord);

 float fCoc = decodeFloat(texture2D(coc, v_Texcoord));

 fCoc = abs(fCoc * 2.0 - 1.0);

 float weight = smoothstep(0.0, 1.0, fCoc);
 
#ifdef NEARFIELD_ENABLED
 vec4 nearfieldColor = texture2D(nearfield, v_Texcoord);
 float fNearCoc = decodeFloat(texture2D(nearcoc, v_Texcoord));
 fNearCoc = abs(fNearCoc * 2.0 - 1.0);

 gl_FragColor = encodeHDR(
 mix(
 nearfieldColor, mix(originalColor, blurredColor, weight),
 pow(1.0 - fNearCoc, 4.0)
 )
 );
#else
 gl_FragColor = encodeHDR(mix(originalColor, blurredColor, weight));
#endif

}

@end



@export ecgl.dof.diskBlur

#define POISSON_KERNEL_SIZE 16;

uniform sampler2D texture;
uniform sampler2D coc;
varying vec2 v_Texcoord;

uniform float blurRadius : 10.0;
uniform vec2 textureSize : [512.0, 512.0];

uniform vec2 poissonKernel[POISSON_KERNEL_SIZE];

uniform float percent;

float nrand(const in vec2 n) {
 return fract(sin(dot(n.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

@import clay.util.rgbm
@import clay.util.float


void main()
{
 vec2 offset = blurRadius / textureSize;

 float rnd = 6.28318 * nrand(v_Texcoord + 0.07 * percent );
 float cosa = cos(rnd);
 float sina = sin(rnd);
 vec4 basis = vec4(cosa, -sina, sina, cosa);

#if !defined(BLUR_NEARFIELD) && !defined(BLUR_COC)
 offset *= abs(decodeFloat(texture2D(coc, v_Texcoord)) * 2.0 - 1.0);
#endif

#ifdef BLUR_COC
 float cocSum = 0.0;
#else
 vec4 color = vec4(0.0);
#endif


 float weightSum = 0.0;

 for (int i = 0; i < POISSON_KERNEL_SIZE; i++) {
 vec2 ofs = poissonKernel[i];

 ofs = vec2(dot(ofs, basis.xy), dot(ofs, basis.zw));

 vec2 uv = v_Texcoord + ofs * offset;
 vec4 texel = texture2D(texture, uv);

 float w = 1.0;
#ifdef BLUR_COC
 float fCoc = decodeFloat(texel) * 2.0 - 1.0;
 cocSum += clamp(fCoc, -1.0, 0.0) * w;
#else
 texel = texel;
 #if !defined(BLUR_NEARFIELD)
 float fCoc = decodeFloat(texture2D(coc, uv)) * 2.0 - 1.0;
 w *= abs(fCoc);
 #endif
 texel.rgb *= texel.a;
 color += texel * w;
#endif

 weightSum += w;
 }

#ifdef BLUR_COC
 gl_FragColor = encodeFloat(clamp(cocSum / weightSum, -1.0, 0.0) * 0.5 + 0.5);
#else
 color /= weightSum;
 color.rgb /= (color.a + 0.0001);
 gl_FragColor = color;
#endif
}

@end`;var k4=`@export ecgl.edge

uniform sampler2D texture;

uniform sampler2D normalTexture;
uniform sampler2D depthTexture;

uniform mat4 projectionInv;

uniform vec2 textureSize;

uniform vec4 edgeColor: [0,0,0,0.8];

varying vec2 v_Texcoord;

vec3 packColor(vec2 coord) {
 float z = texture2D(depthTexture, coord).r * 2.0 - 1.0;
 vec4 p = vec4(v_Texcoord * 2.0 - 1.0, z, 1.0);
 vec4 p4 = projectionInv * p;

 return vec3(
 texture2D(normalTexture, coord).rg,
 -p4.z / p4.w / 5.0
 );
}

void main() {
 vec2 cc = v_Texcoord;
 vec3 center = packColor(cc);

 float size = clamp(1.0 - (center.z - 10.0) / 100.0, 0.0, 1.0) * 0.5;
 float dx = size / textureSize.x;
 float dy = size / textureSize.y;

 vec2 coord;
 vec3 topLeft = packColor(cc+vec2(-dx, -dy));
 vec3 top = packColor(cc+vec2(0.0, -dy));
 vec3 topRight = packColor(cc+vec2(dx, -dy));
 vec3 left = packColor(cc+vec2(-dx, 0.0));
 vec3 right = packColor(cc+vec2(dx, 0.0));
 vec3 bottomLeft = packColor(cc+vec2(-dx, dy));
 vec3 bottom = packColor(cc+vec2(0.0, dy));
 vec3 bottomRight = packColor(cc+vec2(dx, dy));

 vec3 v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;
 vec3 h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;

 float edge = sqrt(dot(h, h) + dot(v, v));

 edge = smoothstep(0.8, 1.0, edge);

 gl_FragColor = mix(texture2D(texture, v_Texcoord), vec4(edgeColor.rgb, 1.0), edgeColor.a * edge);
}
@end`;qe.import(sx);qe.import(lx);qe.import(cx);qe.import(dx);qe.import(ux);qe.import(hx);qe.import(px);qe.import(fx);qe.import(mx);qe.import(M4);qe.import(k4);function P4(e,t){return{color:{parameters:{width:e,height:t}}}}var LS=["composite","FXAA"];function Ei(){this._width,this._height,this._dpr,this._sourceTexture=new wt({type:ot.HALF_FLOAT}),this._depthTexture=new wt({format:ot.DEPTH_COMPONENT,type:ot.UNSIGNED_INT}),this._framebuffer=new tr,this._framebuffer.attach(this._sourceTexture),this._framebuffer.attach(this._depthTexture,tr.DEPTH_ATTACHMENT),this._normalPass=new A4,this._compositor=b4(I4);var e=this._compositor.getNodeByName("source");e.texture=this._sourceTexture;var t=this._compositor.getNodeByName("coc");this._sourceNode=e,this._cocNode=t,this._compositeNode=this._compositor.getNodeByName("composite"),this._fxaaNode=this._compositor.getNodeByName("FXAA"),this._dofBlurNodes=["dof_far_blur","dof_near_blur","dof_coc_blur"].map(function(r){return this._compositor.getNodeByName(r)},this),this._dofBlurKernel=0,this._dofBlurKernelSize=new Float32Array(0),this._finalNodesChain=LS.map(function(r){return this._compositor.getNodeByName(r)},this);var i={normalTexture:this._normalPass.getNormalTexture(),depthTexture:this._normalPass.getDepthTexture()};this._ssaoPass=new E4(i),this._ssrPass=new S4(i),this._edgePass=new D4(i)}Ei.prototype.resize=function(r,n,i){i=i||1;var r=r*i,n=n*i,o=this._sourceTexture,a=this._depthTexture;o.width=r,o.height=n,a.width=r,a.height=n;var s={getWidth:function(){return r},getHeight:function(){return n},getDevicePixelRatio:function(){return i}};function c(l,d){if(typeof l[d]=="function"){var u=l[d].__original||l[d];l[d]=function(h){return u.call(this,s)},l[d].__original=u}}this._compositor.nodes.forEach(function(l){for(var d in l.outputs){var u=l.outputs[d].parameters;u&&(c(u,"width"),c(u,"height"))}for(var h in l.parameters)c(l.parameters,h)}),this._width=r,this._height=n,this._dpr=i};Ei.prototype.getWidth=function(){return this._width};Ei.prototype.getHeight=function(){return this._height};Ei.prototype._ifRenderNormalPass=function(){return this._enableSSAO||this._enableEdge||this._enableSSR};Ei.prototype._getPrevNode=function(e){for(var t=LS.indexOf(e.name)-1,i=this._finalNodesChain[t];i&&!this._compositor.getNodeByName(i.name);)t-=1,i=this._finalNodesChain[t];return i};Ei.prototype._getNextNode=function(e){for(var t=LS.indexOf(e.name)+1,i=this._finalNodesChain[t];i&&!this._compositor.getNodeByName(i.name);)t+=1,i=this._finalNodesChain[t];return i};Ei.prototype._addChainNode=function(e){var t=this._getPrevNode(e),i=this._getNextNode(e);t&&(e.inputs.texture=t.name,i?(e.outputs=P4(this.getWidth.bind(this),this.getHeight.bind(this)),i.inputs.texture=e.name):e.outputs=null,this._compositor.addNode(e))};Ei.prototype._removeChainNode=function(e){var t=this._getPrevNode(e),i=this._getNextNode(e);t&&(i?(t.outputs=P4(this.getWidth.bind(this),this.getHeight.bind(this)),i.inputs.texture=t.name):t.outputs=null,this._compositor.removeNode(e))};Ei.prototype.updateNormal=function(e,t,i,r){this._ifRenderNormalPass()&&this._normalPass.update(e,t,i)};Ei.prototype.updateSSAO=function(e,t,i,r){this._ssaoPass.update(e,i,r)};Ei.prototype.enableSSAO=function(){this._enableSSAO=!0};Ei.prototype.disableSSAO=function(){this._enableSSAO=!1};Ei.prototype.enableSSR=function(){this._enableSSR=!0};Ei.prototype.disableSSR=function(){this._enableSSR=!1};Ei.prototype.getSSAOTexture=function(){return this._ssaoPass.getTargetTexture()};Ei.prototype.getSourceFrameBuffer=function(){return this._framebuffer};Ei.prototype.getSourceTexture=function(){return this._sourceTexture};Ei.prototype.disableFXAA=function(){this._removeChainNode(this._fxaaNode)};Ei.prototype.enableFXAA=function(){this._addChainNode(this._fxaaNode)};Ei.prototype.enableBloom=function(){this._compositeNode.inputs.bloom="bloom_composite",this._compositor.dirty()};Ei.prototype.disableBloom=function(){this._compositeNode.inputs.bloom=null,this._compositor.dirty()};Ei.prototype.enableDOF=function(){this._compositeNode.inputs.texture="dof_composite",this._compositor.dirty()};Ei.prototype.disableDOF=function(){this._compositeNode.inputs.texture="source",this._compositor.dirty()};Ei.prototype.enableColorCorrection=function(){this._compositeNode.define("COLOR_CORRECTION"),this._enableColorCorrection=!0};Ei.prototype.disableColorCorrection=function(){this._compositeNode.undefine("COLOR_CORRECTION"),this._enableColorCorrection=!1};Ei.prototype.enableEdge=function(){this._enableEdge=!0};Ei.prototype.disableEdge=function(){this._enableEdge=!1};Ei.prototype.setBloomIntensity=function(e){this._compositeNode.setParameter("bloomIntensity",e)};Ei.prototype.setSSAOParameter=function(e,t){switch(e){case"quality":var i={low:6,medium:12,high:32,ultra:62}[t]||12;this._ssaoPass.setParameter("kernelSize",i);break;case"radius":this._ssaoPass.setParameter(e,t),this._ssaoPass.setParameter("bias",t/200);break;case"intensity":this._ssaoPass.setParameter(e,t);break;default:}};Ei.prototype.setDOFParameter=function(e,t){switch(e){case"focalDistance":case"focalRange":case"fstop":this._cocNode.setParameter(e,t);break;case"blurRadius":for(var i=0;i<this._dofBlurNodes.length;i++)this._dofBlurNodes[i].setParameter("blurRadius",t);break;case"quality":var r={low:4,medium:8,high:16,ultra:32}[t]||8;this._dofBlurKernelSize=r;for(var i=0;i<this._dofBlurNodes.length;i++)this._dofBlurNodes[i].pass.material.define("POISSON_KERNEL_SIZE",r);this._dofBlurKernel=new Float32Array(r*2);break;default:}};Ei.prototype.setSSRParameter=function(e,t){if(t!=null)switch(e){case"quality":var i={low:10,medium:15,high:30,ultra:80}[t]||20,r={low:32,medium:16,high:8,ultra:4}[t]||16;this._ssrPass.setParameter("maxIteration",i),this._ssrPass.setParameter("pixelStride",r);break;case"maxRoughness":this._ssrPass.setParameter("minGlossiness",Math.max(Math.min(1-t,1),0));break;case"physical":this.setPhysicallyCorrectSSR(t);break;default:console.warn("Unkown SSR parameter "+e)}};Ei.prototype.setPhysicallyCorrectSSR=function(e){this._ssrPass.setPhysicallyCorrect(e)};Ei.prototype.setEdgeColor=function(e){var t=F.parseColor(e);this._edgePass.setParameter("edgeColor",t)};Ei.prototype.setExposure=function(e){this._compositeNode.setParameter("exposure",Math.pow(2,e))};Ei.prototype.setColorLookupTexture=function(e,t){this._compositeNode.pass.material.setTextureImage("lut",this._enableColorCorrection?e:"none",t,{minFilter:F.Texture.NEAREST,magFilter:F.Texture.NEAREST,flipY:!1})};Ei.prototype.setColorCorrection=function(e,t){this._compositeNode.setParameter(e,t)};Ei.prototype.isSSREnabled=function(){return this._enableSSR};Ei.prototype.composite=function(e,t,i,r,n){var o=this._sourceTexture,a=o;this._enableEdge&&(this._edgePass.update(e,i,o,n),o=a=this._edgePass.getTargetTexture()),this._enableSSR&&(this._ssrPass.update(e,i,o,n),a=this._ssrPass.getTargetTexture(),this._ssrPass.setSSAOTexture(this._enableSSAO?this._ssaoPass.getTargetTexture():null)),this._sourceNode.texture=a,this._cocNode.setParameter("depth",this._depthTexture);for(var s=this._dofBlurKernel,c=this._dofBlurKernelSize,l=Math.floor(RS.length/2/c),d=n%l,u=0;u<c*2;u++)s[u]=RS[u+d*c*2];for(var u=0;u<this._dofBlurNodes.length;u++)this._dofBlurNodes[u].setParameter("percent",n/30),this._dofBlurNodes[u].setParameter("poissonKernel",s);this._cocNode.setParameter("zNear",i.near),this._cocNode.setParameter("zFar",i.far),this._compositor.render(e,r)};Ei.prototype.dispose=function(e){this._sourceTexture.dispose(e),this._depthTexture.dispose(e),this._framebuffer.dispose(e),this._compositor.dispose(e),this._normalPass.dispose(e),this._ssaoPass.dispose(e)};var N4=Ei;function BS(e){for(var t=[],i=0;i<30;i++)t.push([Cc(i,2),Cc(i,3)]);this._haltonSequence=t,this._frame=0,this._sourceTex=new wt,this._sourceFb=new tr,this._sourceFb.attach(this._sourceTex),this._prevFrameTex=new wt,this._outputTex=new wt;var r=this._blendPass=new cr({fragment:qe.source("clay.compositor.blend")});r.material.disableTexturesAll(),r.material.enableTexture(["texture1","texture2"]),this._blendFb=new tr({depthBuffer:!1}),this._outputPass=new cr({fragment:qe.source("clay.compositor.output"),blendWithPrevious:!0}),this._outputPass.material.define("fragment","OUTPUT_ALPHA"),this._outputPass.material.blend=function(n){n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD),n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA)}}BS.prototype={constructor:BS,jitterProjection:function(e,t){var i=e.viewport,r=i.devicePixelRatio||e.getDevicePixelRatio(),n=i.width*r,o=i.height*r,a=this._haltonSequence[this._frame%this._haltonSequence.length],s=new ct;s.array[12]=(a[0]*2-1)/n,s.array[13]=(a[1]*2-1)/o,ct.mul(t.projectionMatrix,s,t.projectionMatrix),ct.invert(t.invProjectionMatrix,t.projectionMatrix)},resetFrame:function(){this._frame=0},getFrame:function(){return this._frame},getSourceFrameBuffer:function(){return this._sourceFb},getOutputTexture:function(){return this._outputTex},resize:function(e,t){this._prevFrameTex.width=e,this._prevFrameTex.height=t,this._outputTex.width=e,this._outputTex.height=t,this._sourceTex.width=e,this._sourceTex.height=t,this._prevFrameTex.dirty(),this._outputTex.dirty(),this._sourceTex.dirty()},isFinished:function(){return this._frame>=this._haltonSequence.length},render:function(e,t,i){var r=this._blendPass;this._frame===0?(r.setUniform("weight1",0),r.setUniform("weight2",1)):(r.setUniform("weight1",.9),r.setUniform("weight2",.1)),r.setUniform("texture1",this._prevFrameTex),r.setUniform("texture2",t||this._sourceTex),this._blendFb.attach(this._outputTex),this._blendFb.bind(e),r.render(e),this._blendFb.unbind(e),i||(this._outputPass.setUniform("texture",this._outputTex),this._outputPass.render(e));var n=this._prevFrameTex;this._prevFrameTex=this._outputTex,this._outputTex=n,this._frame++},dispose:function(e){this._sourceFb.dispose(e),this._blendFb.dispose(e),this._prevFrameTex.dispose(e),this._outputTex.dispose(e),this._sourceTex.dispose(e),this._outputPass.dispose(e),this._blendPass.dispose(e)}};var O4=BS;function Yr(e){e=e||"perspective",this.layer=null,this.scene=new Za,this.rootNode=this.scene,this.viewport={x:0,y:0,width:0,height:0},this.setProjection(e),this._compositor=new N4,this._temporalSS=new O4,this._shadowMapPass=new l4;for(var t=[],i=0,r=0;r<30;r++){for(var n=[],o=0;o<6;o++)n.push(Cc(i,2)*4-2),n.push(Cc(i,3)*4-2),i++;t.push(n)}this._pcfKernels=t,this.scene.on("beforerender",function(a,s,c){this.needsTemporalSS()&&this._temporalSS.jitterProjection(a,c)},this)}Yr.prototype.setProjection=function(e){var t=this.camera;t&&t.update(),e==="perspective"?this.camera instanceof en||(this.camera=new en,t&&this.camera.setLocalTransform(t.localTransform)):this.camera instanceof pl||(this.camera=new pl,t&&this.camera.setLocalTransform(t.localTransform)),this.camera.near=.1,this.camera.far=2e3};Yr.prototype.setViewport=function(e,t,i,r,n){this.camera instanceof en&&(this.camera.aspect=i/r),n=n||1,this.viewport.x=e,this.viewport.y=t,this.viewport.width=i,this.viewport.height=r,this.viewport.devicePixelRatio=n,this._compositor.resize(i*n,r*n),this._temporalSS.resize(i*n,r*n)};Yr.prototype.containPoint=function(e,t){var i=this.viewport,r=this.layer.renderer.getHeight();return t=r-t,e>=i.x&&t>=i.y&&e<=i.x+i.width&&t<=i.y+i.height};var R4=new Vn;Yr.prototype.castRay=function(e,t,i){var r=this.layer.renderer,n=r.viewport;return r.viewport=this.viewport,r.screenToNDC(e,t,R4),this.camera.castRay(R4,i),r.viewport=n,i};Yr.prototype.prepareRender=function(){this.scene.update(),this.camera.update(),this.scene.updateLights();var e=this.scene.updateRenderList(this.camera);this._needsSortProgressively=!1;for(var t=0;t<e.transparent.length;t++){var i=e.transparent[t],r=i.geometry;r.needsSortVerticesProgressively&&r.needsSortVerticesProgressively()&&(this._needsSortProgressively=!0),r.needsSortTrianglesProgressively&&r.needsSortTrianglesProgressively()&&(this._needsSortProgressively=!0)}this._frame=0,this._temporalSS.resetFrame()};Yr.prototype.render=function(e,t){this._doRender(e,t,this._frame),this._frame++};Yr.prototype.needsAccumulate=function(){return this.needsTemporalSS()||this._needsSortProgressively};Yr.prototype.needsTemporalSS=function(){var e=this._enableTemporalSS;return e==="auto"&&(e=this._enablePostEffect),e};Yr.prototype.hasDOF=function(){return this._enableDOF};Yr.prototype.isAccumulateFinished=function(){return this.needsTemporalSS()?this._temporalSS.isFinished():this._frame>30};Yr.prototype._doRender=function(e,t,i){var r=this.scene,n=this.camera;i=i||0,this._updateTransparent(e,r,n,i),t||(this._shadowMapPass.kernelPCF=this._pcfKernels[0],this._shadowMapPass.render(e,r,n,!0)),this._updateShadowPCFKernel(i);var o=e.clearColor;if(e.gl.clearColor(o[0],o[1],o[2],o[3]),this._enablePostEffect&&(this.needsTemporalSS()&&this._temporalSS.jitterProjection(e,n),this._compositor.updateNormal(e,r,n,this._temporalSS.getFrame())),this._updateSSAO(e,r,n,this._temporalSS.getFrame()),this._enablePostEffect){var a=this._compositor.getSourceFrameBuffer();a.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT),e.render(r,n,!0,!0),a.unbind(e),this.needsTemporalSS()&&t?(this._compositor.composite(e,r,n,this._temporalSS.getSourceFrameBuffer(),this._temporalSS.getFrame()),e.setViewport(this.viewport),this._temporalSS.render(e)):(e.setViewport(this.viewport),this._compositor.composite(e,r,n,null,0))}else if(this.needsTemporalSS()&&t){var a=this._temporalSS.getSourceFrameBuffer();a.bind(e),e.saveClear(),e.clearBit=e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT,e.render(r,n,!0,!0),e.restoreClear(),a.unbind(e),e.setViewport(this.viewport),this._temporalSS.render(e)}else e.setViewport(this.viewport),e.render(r,n,!0,!0)};Yr.prototype._updateTransparent=function(e,t,i,r){for(var n=new Fe,o=new ct,a=i.getWorldPosition(),s=t.getRenderList(i).transparent,c=0;c<s.length;c++){var l=s[c],d=l.geometry;ct.invert(o,l.worldTransform),Fe.transformMat4(n,a,o),d.needsSortTriangles&&d.needsSortTriangles()&&d.doSortTriangles(n,r),d.needsSortVertices&&d.needsSortVertices()&&d.doSortVertices(n,r)}};Yr.prototype._updateSSAO=function(e,t,i){var r=this._enableSSAO&&this._enablePostEffect;r&&this._compositor.updateSSAO(e,t,i,this._temporalSS.getFrame());for(var n=t.getRenderList(i),o=0;o<n.opaque.length;o++){var a=n.opaque[o];a.renderNormal&&a.material[r?"enableTexture":"disableTexture"]("ssaoMap"),r&&a.material.set("ssaoMap",this._compositor.getSSAOTexture())}};Yr.prototype._updateShadowPCFKernel=function(e){for(var t=this._pcfKernels[e%this._pcfKernels.length],i=this.scene.getRenderList(this.camera),r=i.opaque,n=0;n<r.length;n++)r[n].receiveShadow&&(r[n].material.set("pcfKernel",t),r[n].material.define("fragment","PCF_KERNEL_SIZE",t.length/2))};Yr.prototype.dispose=function(e){this._compositor.dispose(e.gl),this._temporalSS.dispose(e.gl),this._shadowMapPass.dispose(e)};Yr.prototype.setPostEffect=function(e,t){var i=this._compositor;this._enablePostEffect=e.get("enable");var r=e.getModel("bloom"),n=e.getModel("edge"),o=e.getModel("DOF",e.getModel("depthOfField")),a=e.getModel("SSAO",e.getModel("screenSpaceAmbientOcclusion")),s=e.getModel("SSR",e.getModel("screenSpaceReflection")),c=e.getModel("FXAA"),l=e.getModel("colorCorrection");r.get("enable")?i.enableBloom():i.disableBloom(),o.get("enable")?i.enableDOF():i.disableDOF(),s.get("enable")?i.enableSSR():i.disableSSR(),l.get("enable")?i.enableColorCorrection():i.disableColorCorrection(),n.get("enable")?i.enableEdge():i.disableEdge(),c.get("enable")?i.enableFXAA():i.disableFXAA(),this._enableDOF=o.get("enable"),this._enableSSAO=a.get("enable"),this._enableSSAO?i.enableSSAO():i.disableSSAO(),i.setBloomIntensity(r.get("intensity")),i.setEdgeColor(n.get("color")),i.setColorLookupTexture(l.get("lookupTexture"),t),i.setExposure(l.get("exposure")),["radius","quality","intensity"].forEach(function(d){i.setSSAOParameter(d,a.get(d))}),["quality","maxRoughness","physical"].forEach(function(d){i.setSSRParameter(d,s.get(d))}),["quality","focalDistance","focalRange","blurRadius","fstop"].forEach(function(d){i.setDOFParameter(d,o.get(d))}),["brightness","contrast","saturation"].forEach(function(d){i.setColorCorrection(d,l.get(d))})};Yr.prototype.setDOFFocusOnPoint=function(e){if(this._enablePostEffect)return e>this.camera.far||e<this.camera.near?void 0:(this._compositor.setDOFParameter("focalDistance",e),!0)};Yr.prototype.setTemporalSuperSampling=function(e){this._enableTemporalSS=e.get("enable")};Yr.prototype.isLinearSpace=function(){return this._enablePostEffect};Yr.prototype.setRootNode=function(e){if(this.rootNode!==e){for(var t=this.rootNode.children(),i=0;i<t.length;i++)e.add(t[i]);e!==this.scene&&this.scene.add(e),this.rootNode=e}};Yr.prototype.add=function(e){this.rootNode.add(e)};Yr.prototype.remove=function(e){this.rootNode.remove(e)};Yr.prototype.removeAll=function(e){this.rootNode.removeAll(e)};Object.assign(Yr.prototype,Jp);var Do=Yr;function kte(e,t){var i=e.getBoxLayoutParams(),r=vd(i,{width:t.getWidth(),height:t.getHeight()});r.y=t.getHeight()-r.y-r.height,this.viewGL.setViewport(r.x,r.y,r.width,r.height,t.getDevicePixelRatio());var n=e.get("boxWidth"),o=e.get("boxHeight"),a=e.get("boxDepth");this.getAxis("x").setExtent(-n/2,n/2),this.getAxis("y").setExtent(a/2,-a/2),this.getAxis("z").setExtent(-o/2,o/2),this.size=[n,o,a]}function Pte(e,t){var i={};function r(n,o){i[n]=i[n]||[1/0,-1/0],i[n][0]=Math.min(o[0],i[n][0]),i[n][1]=Math.max(o[1],i[n][1])}e.eachSeries(function(n){if(n.coordinateSystem===this){var o=n.getData();["x","y","z"].forEach(function(a){o.mapDimensionsAll(a,!0).forEach(function(s){r(a,o.getDataExtent(s,!0))})})}},this),["xAxis3D","yAxis3D","zAxis3D"].forEach(function(n){e.eachComponent(n,function(o){var a=n.charAt(0),s=o.getReferringComponents("grid3D").models[0],c=s.coordinateSystem;if(c===this){var l=c.getAxis(a);if(!l){var d=yr.createScale(i[a]||[1/0,-1/0],o);l=new r4(a,d),l.type=o.get("type");var u=l.type==="category";l.onBand=u&&o.get("boundaryGap"),l.inverse=o.get("inverse"),o.axis=l,l.model=o,l.getLabelModel=function(){return o.getModel("axisLabel",s.getModel("axisLabel"))},l.getTickModel=function(){return o.getModel("axisTick",s.getModel("axisTick"))},c.addAxis(l)}}},this)},this),this.resize(this.model,t)}var Nte={dimensions:DS.prototype.dimensions,create:function(e,t){var i=[];e.eachComponent("grid3D",function(o){o.__viewGL=o.__viewGL||new Do;var a=new DS;a.model=o,a.viewGL=o.__viewGL,o.coordinateSystem=a,i.push(a),a.resize=kte,a.update=Pte});var r=["xAxis3D","yAxis3D","zAxis3D"];function n(o,a){return r.map(function(s){var c=o.getReferringComponents(s).models[0];return c==null&&(c=a.getComponent(s)),c})}return e.eachSeries(function(o){if(o.get("coordinateSystem")==="cartesian3D"){var a=o.getReferringComponents("grid3D").models[0];if(a==null){var s=n(o,e),a=s[0].getCoordSysModel();s.forEach(function(d){var u=d.getCoordSysModel()})}var c=a.coordinateSystem;o.coordinateSystem=c}}),i}},F4=Nte;var L4=Es.extend({type:"cartesian3DAxis",axis:null,getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"grid3D",index:this.option.gridIndex,id:this.option.gridId})[0]}});yr.mixinAxisModelCommonMethods(L4);var B4=L4;var V4={show:!0,grid3DIndex:0,inverse:!1,name:"",nameLocation:"middle",nameTextStyle:{fontSize:16},nameGap:20,axisPointer:{},axisLine:{},axisTick:{},axisLabel:{},splitArea:{}},Ote=Re.merge({boundaryGap:!0,axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"},axisPointer:{label:{show:!1}}},V4),VS=Re.merge({boundaryGap:[0,0],splitNumber:5,axisPointer:{label:{}}},V4),Rte=Re.defaults({scale:!0,min:"dataMin",max:"dataMax"},VS),z4=Re.defaults({logBase:10},VS);z4.scale=!0;var U4={categoryAxis3D:Ote,valueAxis3D:VS,timeAxis3D:Rte,logAxis3D:z4};var Fte=["value","category","time","log"];function H4(e,t,i,r,n){Fte.forEach(function(o){var a=i.extend({type:t+"Axis3D."+o,__ordinalMeta:null,mergeDefaultAndTheme:function(s,c){var l=c.getTheme();Re.merge(s,l.get(o+"Axis3D")),Re.merge(s,this.getDefaultOption()),s.type=r(t,s)},optionUpdated:function(){var s=this.option;s.type==="category"&&(this.__ordinalMeta=lR.createByAxisModel(this))},getCategories:function(){if(this.option.type==="category")return this.__ordinalMeta.categories},getOrdinalMeta:function(){return this.__ordinalMeta},defaultOption:Re.merge(Re.clone(U4[o+"Axis3D"]),n||{},!0)});e.registerComponentModel(a)}),e.registerSubTypeDefaulter(t+"Axis3D",Re.curry(r,t))}function Lte(e,t){return t.type||(t.data?"category":"value")}function j4(e){e.registerComponentModel(VL),e.registerComponentView(i4),e.registerCoordinateSystem("grid3D",F4),["x","y","z"].forEach(function(t){H4(e,t,B4,Lte,{name:t.toUpperCase()});let i=e.ComponentView.extend({type:t+"Axis3D"});e.registerComponentView(i)}),e.registerAction({type:"grid3DChangeCamera",event:"grid3dcamerachanged",update:"series:updateCamera"},function(t,i){i.eachComponent({mainType:"grid3D",query:t},function(r){r.setView(t)})}),e.registerAction({type:"grid3DShowAxisPointer",event:"grid3dshowaxispointer",update:"grid3D:showAxisPointer"},function(t,i){}),e.registerAction({type:"grid3DHideAxisPointer",event:"grid3dhideaxispointer",update:"grid3D:hideAxisPointer"},function(t,i){})}ji(j4);var Ps={defaultOption:{shading:null,realisticMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},lambertMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},colorMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},hatchingMaterial:{textureTiling:1,textureOffset:0,paperColor:"#fff"}}};var gx={getFilledRegions:function(e,t){var i=(e||[]).slice(),r;if(typeof t=="string"?(t=zg(t),r=t&&t.geoJson):t&&t.features&&(r=t),!r)return[];for(var n={},o=r.features,a=0;a<i.length;a++)n[i[a].name]=i[a];for(var a=0;a<o.length;a++){var s=o[a].properties.name;n[s]||i.push({name:s})}return i},defaultOption:{show:!0,zlevel:-10,map:"",left:0,top:0,width:"100%",height:"100%",boxWidth:100,boxHeight:10,boxDepth:"auto",regionHeight:3,environment:"auto",groundPlane:{show:!1,color:"#aaa"},shading:"lambert",light:{main:{alpha:40,beta:30}},viewControl:{alpha:40,beta:0,distance:100,orthographicSize:60,minAlpha:5,minBeta:-80,maxBeta:80},label:{show:!1,distance:2,textStyle:{fontSize:20,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:4}},itemStyle:{color:"#fff",borderWidth:0,borderColor:"#333"},emphasis:{itemStyle:{color:"#639fc0"},label:{show:!0}}}};var bf=Es.extend({type:"geo3D",layoutMode:"box",coordinateSystem:null,optionUpdated:function(){var e=this.option;e.regions=this.getFilledRegions(e.regions,e.map);var t=yr.createDimensions(e.data||[],{coordDimensions:["value"],encodeDefine:this.get("encode"),dimensionsDefine:this.get("dimensions")}),i=new Ln(t,this);i.initData(e.regions);var r={};i.each(function(n){var o=i.getName(n),a=i.getItemModel(n);r[o]=a}),this._regionModelMap=r,this._data=i},getData:function(){return this._data},getRegionModel:function(e){var t=this.getData().getName(e);return this._regionModelMap[t]||new gd(null,this)},getRegionPolygonCoords:function(e){var t=this.getData().getName(e),i=this.coordinateSystem.getRegion(t);return i?i.geometries:[]},getFormattedLabel:function(e,t){var i=this._data.getName(e),r=this.getRegionModel(e),n=r.get(t==="normal"?["label","formatter"]:["emphasis","label","formatter"]);n==null&&(n=r.get(["label","formatter"]));var o={name:i};if(typeof n=="function")return o.status=t,n(o);if(typeof n=="string"){var a=o.seriesName;return n.replace("{a}",a??"")}else return i},defaultOption:{regions:[]}});Re.merge(bf.prototype,gx);Re.merge(bf.prototype,Ad);Re.merge(bf.prototype,Is);Re.merge(bf.prototype,Ms);Re.merge(bf.prototype,Ps);var G4=bf;var W4=q4;function q4(e,t,i){i=i||2;var r=t&&t.length,n=r?t[0]*i:e.length,o=X4(e,0,n,i,!0),a=[];if(!o)return a;var s,c,l,d,u,h,p;if(r&&(o=Hte(e,t,o,i)),e.length>80*i){s=l=e[0],c=d=e[1];for(var m=i;m<n;m+=i)u=e[m],h=e[m+1],u<s&&(s=u),h<c&&(c=h),u>l&&(l=u),h>d&&(d=h);p=Math.max(l-s,d-c)}return vv(o,a,i,s,c,p),a}function X4(e,t,i,r,n){var o,a;if(n===HS(e,t,i,r)>0)for(o=t;o<i;o+=r)a=$4(o,e[o],e[o+1],a);else for(o=i-r;o>=t;o-=r)a=$4(o,e[o],e[o+1],a);return a&&vh(a,a.next)&&(bv(a),a=a.next),a}function gv(e,t){if(!e)return e;t||(t=e);var i=e,r;do if(r=!1,!i.steiner&&(vh(i,i.next)||ia(i.prev,i,i.next)===0)){if(bv(i),i=t=i.prev,i===i.next)return null;r=!0}else i=i.next;while(r||i!==t);return t}function vv(e,t,i,r,n,o,a){if(e){!a&&o&&Wte(e,r,n,o);for(var s=e,c,l;e.prev!==e.next;){if(c=e.prev,l=e.next,o?Vte(e,r,n,o):Bte(e)){t.push(c.i/i),t.push(e.i/i),t.push(l.i/i),bv(e),e=l.next,s=l.next;continue}if(e=l,e===s){a?a===1?(e=zte(e,t,i),vv(e,t,i,r,n,o,2)):a===2&&Ute(e,t,i,r,n,o):vv(gv(e),t,i,r,n,o,1);break}}}}function Bte(e){var t=e.prev,i=e,r=e.next;if(ia(t,i,r)>=0)return!1;for(var n=e.next.next;n!==e.prev;){if(vx(t.x,t.y,i.x,i.y,r.x,r.y,n.x,n.y)&&ia(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function Vte(e,t,i,r){var n=e.prev,o=e,a=e.next;if(ia(n,o,a)>=0)return!1;for(var s=n.x<o.x?n.x<a.x?n.x:a.x:o.x<a.x?o.x:a.x,c=n.y<o.y?n.y<a.y?n.y:a.y:o.y<a.y?o.y:a.y,l=n.x>o.x?n.x>a.x?n.x:a.x:o.x>a.x?o.x:a.x,d=n.y>o.y?n.y>a.y?n.y:a.y:o.y>a.y?o.y:a.y,u=zS(s,c,t,i,r),h=zS(l,d,t,i,r),p=e.nextZ;p&&p.z<=h;){if(p!==e.prev&&p!==e.next&&vx(n.x,n.y,o.x,o.y,a.x,a.y,p.x,p.y)&&ia(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=e.prevZ;p&&p.z>=u;){if(p!==e.prev&&p!==e.next&&vx(n.x,n.y,o.x,o.y,a.x,a.y,p.x,p.y)&&ia(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function zte(e,t,i){var r=e;do{var n=r.prev,o=r.next.next;!vh(n,o)&&Y4(n,r,r.next,o)&&_v(n,o)&&_v(o,n)&&(t.push(n.i/i),t.push(r.i/i),t.push(o.i/i),bv(r),bv(r.next),r=e=o),r=r.next}while(r!==e);return r}function Ute(e,t,i,r,n,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Yte(a,s)){var c=Z4(a,s);a=gv(a,a.next),c=gv(c,c.next),vv(a,t,i,r,n,o),vv(c,t,i,r,n,o);return}s=s.next}a=a.next}while(a!==e)}function Hte(e,t,i,r){var n=[],o,a,s,c,l;for(o=0,a=t.length;o<a;o++)s=t[o]*r,c=o<a-1?t[o+1]*r:e.length,l=X4(e,s,c,r,!1),l===l.next&&(l.steiner=!0),n.push(Xte(l));for(n.sort(jte),o=0;o<n.length;o++)Gte(n[o],i),i=gv(i,i.next);return i}function jte(e,t){return e.x-t.x}function Gte(e,t){if(t=$te(e,t),t){var i=Z4(t,e);gv(i,i.next)}}function $te(e,t){var i=t,r=e.x,n=e.y,o=-1/0,a;do{if(n<=i.y&&n>=i.next.y&&i.next.y!==i.y){var s=i.x+(n-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>o){if(o=s,s===r){if(n===i.y)return i;if(n===i.next.y)return i.next}a=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!a)return null;if(r===o)return a.prev;var c=a,l=a.x,d=a.y,u=1/0,h;for(i=a.next;i!==c;)r>=i.x&&i.x>=l&&r!==i.x&&vx(n<d?r:o,n,l,d,n<d?o:r,n,i.x,i.y)&&(h=Math.abs(n-i.y)/(r-i.x),(h<u||h===u&&i.x>a.x)&&_v(i,e)&&(a=i,u=h)),i=i.next;return a}function Wte(e,t,i,r){var n=e;do n.z===null&&(n.z=zS(n.x,n.y,t,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,qte(n)}function qte(e){var t,i,r,n,o,a,s,c,l=1;do{for(i=e,e=null,o=null,a=0;i;){for(a++,r=i,s=0,t=0;t<l&&(s++,r=r.nextZ,!!r);t++);for(c=l;s>0||c>0&&r;)s!==0&&(c===0||!r||i.z<=r.z)?(n=i,i=i.nextZ,s--):(n=r,r=r.nextZ,c--),o?o.nextZ=n:e=n,n.prevZ=o,o=n;i=r}o.nextZ=null,l*=2}while(a>1);return e}function zS(e,t,i,r,n){return e=32767*(e-i)/n,t=32767*(t-r)/n,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function Xte(e){var t=e,i=e;do t.x<i.x&&(i=t),t=t.next;while(t!==e);return i}function vx(e,t,i,r,n,o,a,s){return(n-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(r-s)-(i-a)*(t-s)>=0&&(i-a)*(o-s)-(n-a)*(r-s)>=0}function Yte(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!Zte(e,t)&&_v(e,t)&&_v(t,e)&&Kte(e,t)}function ia(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function vh(e,t){return e.x===t.x&&e.y===t.y}function Y4(e,t,i,r){return vh(e,t)&&vh(i,r)||vh(e,r)&&vh(i,t)?!0:ia(e,t,i)>0!=ia(e,t,r)>0&&ia(i,r,e)>0!=ia(i,r,t)>0}function Zte(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&Y4(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}function _v(e,t){return ia(e.prev,e,e.next)<0?ia(e,t,e.next)>=0&&ia(e,e.prev,t)>=0:ia(e,t,e.prev)<0||ia(e,e.next,t)<0}function Kte(e,t){var i=e,r=!1,n=(e.x+t.x)/2,o=(e.y+t.y)/2;do i.y>o!=i.next.y>o&&i.next.y!==i.y&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next;while(i!==e);return r}function Z4(e,t){var i=new US(e.i,e.x,e.y),r=new US(t.i,t.x,t.y),n=e.next,o=t.prev;return e.next=t,t.prev=e,i.next=n,n.prev=i,r.next=i,i.prev=r,o.next=r,r.prev=o,r}function $4(e,t,i,r){var n=new US(e,t,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function bv(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function US(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}q4.deviation=function(e,t,i,r){var n=t&&t.length,o=n?t[0]*i:e.length,a=Math.abs(HS(e,0,o,i));if(n)for(var s=0,c=t.length;s<c;s++){var l=t[s]*i,d=s<c-1?t[s+1]*i:e.length;a-=Math.abs(HS(e,l,d,i))}var u=0;for(s=0;s<r.length;s+=3){var h=r[s]*i,p=r[s+1]*i,m=r[s+2]*i;u+=Math.abs((e[h]-e[m])*(e[p+1]-e[h+1])-(e[h]-e[p])*(e[m+1]-e[h+1]))}return a===0&&u===0?0:Math.abs((u-a)/a)};function HS(e,t,i,r){for(var n=0,o=t,a=i-r;o<i;o+=r)n+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return n}function jS(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}function K4(e,t,i,r,n){var o=i,a=e[t];jS(e,t,r);for(var s=i;s<r;s++)n(e[s],a)<0&&(jS(e,s,o),o++);return jS(e,r,o),o}function _x(e,t,i,r){if(i<r){var n=Math.floor((i+r)/2),o=K4(e,n,i,r,t);_x(e,t,i,o-1),_x(e,t,o+1,r)}}function GS(){this._parts=[]}GS.prototype.step=function(e,t,i){var r=e.length;if(i===0){this._parts=[],this._sorted=!1;var n=Math.floor(r/2);this._parts.push({pivot:n,left:0,right:r-1}),this._currentSortPartIdx=0}if(!this._sorted){var o=this._parts;if(o.length===0)return this._sorted=!0,!0;if(o.length<512){for(var a=0;a<o.length;a++)o[a].pivot=K4(e,o[a].pivot,o[a].left,o[a].right,t);for(var s=[],a=0;a<o.length;a++){var c=o[a].left,l=o[a].pivot-1;l>c&&s.push({pivot:Math.floor((l+c)/2),left:c,right:l});var c=o[a].pivot+1,l=o[a].right;l>c&&s.push({pivot:Math.floor((l+c)/2),left:c,right:l})}o=this._parts=s}else for(var a=0;a<Math.floor(o.length/10);a++){var d=o.length-1-this._currentSortPartIdx;if(_x(e,t,o[d].left,o[d].right),this._currentSortPartIdx++,this._currentSortPartIdx===o.length)return this._sorted=!0,!0}return!1}};GS.sort=_x;var yf=GS;var xf=bi.vec3,Q4=xf.create(),J4=xf.create(),eB=xf.create(),wf={needsSortTriangles:function(){return this.indices&&this.sortTriangles},needsSortTrianglesProgressively:function(){return this.needsSortTriangles()&&this.triangleCount>=2e4},doSortTriangles:function(e,t){var i=this.indices;if(t===0){var r=this.attributes.position,e=e.array;(!this._triangleZList||this._triangleZList.length!==this.triangleCount)&&(this._triangleZList=new Float32Array(this.triangleCount),this._sortedTriangleIndices=new Uint32Array(this.triangleCount),this._indicesTmp=new i.constructor(i.length),this._triangleZListTmp=new Float32Array(this.triangleCount));for(var n=0,o,a=0;a<i.length;){r.get(i[a++],Q4),r.get(i[a++],J4),r.get(i[a++],eB);var s=xf.sqrDist(Q4,e),c=xf.sqrDist(J4,e),l=xf.sqrDist(eB,e),d=Math.min(s,c);d=Math.min(d,l),a===3?(o=d,d=0):d=d-o,this._triangleZList[n++]=d}}for(var u=this._sortedTriangleIndices,a=0;a<u.length;a++)u[a]=a;if(this.triangleCount<2e4)t===0&&this._simpleSort(!0);else for(var a=0;a<3;a++)this._progressiveQuickSort(t*3+a);for(var h=this._indicesTmp,p=this._triangleZListTmp,m=this._triangleZList,a=0;a<this.triangleCount;a++){var f=u[a]*3,g=a*3;h[g++]=i[f++],h[g++]=i[f++],h[g]=i[f],p[a]=m[u[a]]}var v=this._indicesTmp;this._indicesTmp=this.indices,this.indices=v;var v=this._triangleZListTmp;this._triangleZListTmp=this._triangleZList,this._triangleZList=v,this.dirtyIndices()},_simpleSort:function(e){var t=this._triangleZList,i=this._sortedTriangleIndices;function r(n,o){return t[o]-t[n]}e?Array.prototype.sort.call(i,r):yf.sort(i,r,0,i.length-1)},_progressiveQuickSort:function(e){var t=this._triangleZList,i=this._sortedTriangleIndices;this._quickSort=this._quickSort||new yf,this._quickSort.step(i,function(r,n){return t[n]-t[r]},e)}};function tB(e){let t=e.getVisual("style");if(t){let i=e.getVisual("drawType");return t[i]}}function iB(e){return e.getVisual("style").opacity}function gr(e,t){let i=e.getItemVisual(t,"style");if(i){let r=e.getVisual("drawType");return i[r]}}function Er(e,t){let i=e.getItemVisual(t,"style");return i&&i.opacity}var rB=1,nB=2;function _h(e,t,i){this._labelsMesh=new vf,this._labelTextureSurface=new fv({width:512,height:512,devicePixelRatio:i.getDevicePixelRatio(),onupdate:function(){i.getZr().refresh()}}),this._api=i,this._labelsMesh.material.set("textureAtlas",this._labelTextureSurface.getTexture())}_h.prototype.getLabelPosition=function(e,t,i){return[0,0,0]};_h.prototype.getLabelDistance=function(e,t,i){return 0};_h.prototype.getMesh=function(){return this._labelsMesh};_h.prototype.updateData=function(e,t,i){t==null&&(t=0),i==null&&(i=e.count()),(!this._labelsVisibilitiesBits||this._labelsVisibilitiesBits.length!==i-t)&&(this._labelsVisibilitiesBits=new Uint8Array(i-t));for(var r=["label","show"],n=["emphasis","label","show"],o=t;o<i;o++){var a=e.getItemModel(o),s=a.get(r),c=a.get(n);c==null&&(c=s);var l=(s?rB:0)|(c?nB:0);this._labelsVisibilitiesBits[o-t]=l}this._start=t,this._end=i,this._data=e};_h.prototype.updateLabels=function(e){if(this._data){e=e||[];for(var t=e.length>0,i={},r=0;r<e.length;r++)i[e[r]]=!0;this._labelsMesh.geometry.convertToDynamicArray(!0),this._labelTextureSurface.clear();for(var n=["label"],o=["emphasis","label"],a=this._data.hostModel,s=this._data,c=a.getModel(n),l=a.getModel(o,c),d={left:"right",right:"left",top:"center",bottom:"center"},u={left:"middle",right:"middle",top:"bottom",bottom:"top"},h=this._start;h<this._end;h++){var p=!1;t&&i[h]&&(p=!0);var m=this._labelsVisibilitiesBits[h-this._start]&(p?nB:rB);if(m){var f=s.getItemModel(h),g=f.getModel(p?o:n,p?l:c),v=g.get("distance")||0,_=g.get("position"),b=this._api.getDevicePixelRatio(),y=a.getFormattedLabel(h,p?"emphasis":"normal");if(y==null||y==="")return;var x=new Dn.Text({style:ih(g,{text:y,fill:g.get("color")||gr(s,h)||"#000",align:"left",verticalAlign:"top",opacity:St.firstNotNull(g.get("opacity"),Er(s,h),1)})}),w=x.getBoundingRect(),I=1.2;w.height*=I;var S=this._labelTextureSurface.add(x),E=d[_]||"center",N=u[_]||"bottom";this._labelsMesh.geometry.addSprite(this.getLabelPosition(h,_,v),[w.width*b,w.height*b],S,E,N,this.getLabelDistance(h,_,v)*b)}}this._labelsMesh.material.set("uvScale",this._labelTextureSurface.getCoordsScale()),this._labelTextureSurface.getZr().refreshImmediately(),this._labelsMesh.geometry.convertToTypedArray(),this._labelsMesh.geometry.dirty()}};_h.prototype.dispose=function(){this._labelTextureSurface.dispose()};var Ef=_h;var Da=bi.vec3;F.Shader.import(Id);function $S(e){this.rootNode=new F.Node,this._triangulationResults={},this._shadersMap=F.COMMON_SHADERS.filter(function(i){return i!=="shadow"}).reduce(function(i,r){return i[r]=F.createShader("ecgl."+r),i},{}),this._linesShader=F.createShader("ecgl.meshLines3D");var t={};F.COMMON_SHADERS.forEach(function(i){t[i]=new F.Material({shader:F.createShader("ecgl."+i)})}),this._groundMaterials=t,this._groundMesh=new F.Mesh({geometry:new F.PlaneGeometry({dynamic:!0}),castShadow:!1,renderNormal:!0,$ignorePicking:!0}),this._groundMesh.rotation.rotateX(-Math.PI/2),this._labelsBuilder=new Ef(512,512,e),this._labelsBuilder.getMesh().renderOrder=100,this._labelsBuilder.getMesh().material.depthTest=!1,this.rootNode.add(this._labelsBuilder.getMesh()),this._initMeshes(),this._api=e}$S.prototype={constructor:$S,extrudeY:!0,update:function(e,t,i,r,n){var o=e.getData();r==null&&(r=0),n==null&&(n=o.count()),this._startIndex=r,this._endIndex=n-1,this._triangulation(e,r,n);var a=this._getShader(e.get("shading"));this._prepareMesh(e,a,i,r,n),this.rootNode.updateWorldTransform(),this._updateRegionMesh(e,i,r,n);var s=e.coordinateSystem;s.type==="geo3D"&&this._updateGroundPlane(e,s,i);var c=this;this._labelsBuilder.updateData(o,r,n),this._labelsBuilder.getLabelPosition=function(l,d,u){var h=o.getName(l),p,m=u;if(s.type==="geo3D"){var f=s.getRegion(h);if(!f)return[NaN,NaN,NaN];p=f.getCenter();var g=s.dataToPoint([p[0],p[1],m]);return g}else var v=c._triangulationResults[l-c._startIndex],p=c.extrudeY?[(v.max[0]+v.min[0])/2,v.max[1]+m,(v.max[2]+v.min[2])/2]:[(v.max[0]+v.min[0])/2,(v.max[1]+v.min[1])/2,v.max[2]+m]},this._data=o,this._labelsBuilder.updateLabels(),this._updateDebugWireframe(e),this._lastHoverDataIndex=0},_initMeshes:function(){var e=this;function t(){var n=new F.Mesh({name:"Polygon",material:new F.Material({shader:e._shadersMap.lambert}),geometry:new F.Geometry({sortTriangles:!0,dynamic:!0}),culling:!1,ignorePicking:!0,renderNormal:!0});return Object.assign(n.geometry,wf),n}var i=t(),r=new F.Mesh({material:new F.Material({shader:this._linesShader}),castShadow:!1,ignorePicking:!0,$ignorePicking:!0,geometry:new Aa({useNativeLine:!1})});this.rootNode.add(i),this.rootNode.add(r),i.material.define("both","VERTEX_COLOR"),i.material.define("fragment","DOUBLE_SIDED"),this._polygonMesh=i,this._linesMesh=r,this.rootNode.add(this._groundMesh)},_getShader:function(e){var t=this._shadersMap[e];return t||(t=this._shadersMap.lambert),t.__shading=e,t},_prepareMesh:function(e,t,i,r,n){for(var o=0,a=0,s=0,c=0,l=r;l<n;l++){var d=this._getRegionPolygonInfo(l),u=this._getRegionLinesInfo(l,e,this._linesMesh.geometry);o+=d.vertexCount,a+=d.triangleCount,s+=u.vertexCount,c+=u.triangleCount}var h=this._polygonMesh,p=h.geometry;["position","normal","texcoord0","color"].forEach(function(m){p.attributes[m].init(o)}),p.indices=o>65535?new Uint32Array(a*3):new Uint16Array(a*3),h.material.shader!==t&&h.material.attachShader(t,!0),F.setMaterialFromModel(t.__shading,h.material,e,i),s>0&&(this._linesMesh.geometry.resetOffset(),this._linesMesh.geometry.setVertexCount(s),this._linesMesh.geometry.setTriangleCount(c)),this._dataIndexOfVertex=new Uint32Array(o),this._vertexRangeOfDataIndex=new Uint32Array((n-r)*2)},_updateRegionMesh:function(e,t,i,r){for(var n=e.getData(),o=0,a=0,s=!1,w=this._polygonMesh,c=this._linesMesh,l=i;l<r;l++){var d=e.getRegionModel(l),u=d.getModel("itemStyle"),h=St.firstNotNull(gr(n,l),u.get("color"),"#fff"),p=St.firstNotNull(Er(n,l),1),m=F.parseColor(h),f=F.parseColor(u.get("borderColor"));m[3]*=p,f[3]*=p;var g=m[3]<.99;w.material.set("color",[1,1,1,1]),s=s||g;for(var v=St.firstNotNull(d.get("height",!0),e.get("regionHeight")),_=this._updatePolygonGeometry(e,w.geometry,l,v,o,a,m),b=o;b<_.vertexOffset;b++)this._dataIndexOfVertex[b]=l;this._vertexRangeOfDataIndex[(l-i)*2]=o,this._vertexRangeOfDataIndex[(l-i)*2+1]=_.vertexOffset,o=_.vertexOffset,a=_.triangleOffset;var y=u.get("borderWidth"),x=y>0;x&&(y*=t.getDevicePixelRatio(),this._updateLinesGeometry(c.geometry,e,l,v,y,e.coordinateSystem.transform)),c.invisible=!x,c.material.set({color:f})}var w=this._polygonMesh;w.material.transparent=s,w.material.depthMask=!s,w.geometry.updateBoundingBox(),w.frontFace=this.extrudeY?F.Mesh.CCW:F.Mesh.CW,w.material.get("normalMap")&&w.geometry.generateTangents(),w.seriesIndex=e.seriesIndex,w.on("mousemove",this._onmousemove,this),w.on("mouseout",this._onmouseout,this)},_updateDebugWireframe:function(e){var t=e.getModel("debug.wireframe");if(t.get("show")){var i=F.parseColor(t.get("lineStyle.color")||"rgba(0,0,0,0.5)"),r=St.firstNotNull(t.get("lineStyle.width"),1),n=this._polygonMesh;n.geometry.generateBarycentric(),n.material.define("both","WIREFRAME_TRIANGLE"),n.material.set("wireframeLineColor",i),n.material.set("wireframeLineWidth",r)}},_onmousemove:function(e){var t=this._dataIndexOfVertex[e.triangle[0]];t==null&&(t=-1),t!==this._lastHoverDataIndex&&(this.downplay(this._lastHoverDataIndex),this.highlight(t),this._labelsBuilder.updateLabels([t])),this._lastHoverDataIndex=t,this._polygonMesh.dataIndex=t},_onmouseout:function(e){e.target&&(this.downplay(this._lastHoverDataIndex),this._lastHoverDataIndex=-1,this._polygonMesh.dataIndex=-1),this._labelsBuilder.updateLabels([])},_updateGroundPlane:function(e,t,i){var r=e.getModel("groundPlane",e);if(this._groundMesh.invisible=!r.get("show",!0),!this._groundMesh.invisible){var n=e.get("shading"),o=this._groundMaterials[n];o||(o=this._groundMaterials.lambert),F.setMaterialFromModel(n,o,r,i),o.get("normalMap")&&this._groundMesh.geometry.generateTangents(),this._groundMesh.material=o,this._groundMesh.material.set("color",F.parseColor(r.get("color"))),this._groundMesh.scale.set(t.size[0],t.size[2],1)}},_triangulation:function(e,t,i){this._triangulationResults=[];for(var r=[1/0,1/0,1/0],n=[-1/0,-1/0,-1/0],o=e.coordinateSystem,a=t;a<i;a++){for(var s=[],c=e.getRegionPolygonCoords(a),l=0;l<c.length;l++){var d=c[l].exterior,u=c[l].interiors,h=[],p=[];if(!(d.length<3)){for(var m=0,f=0;f<d.length;f++){var g=d[f];h[m++]=g[0],h[m++]=g[1]}for(var f=0;f<u.length;f++)if(!(u[f].length<3)){for(var v=h.length/2,_=0;_<u[f].length;_++){var g=u[f][_];h.push(g[0]),h.push(g[1])}p.push(v)}for(var b=W4(h,p),y=new Float64Array(h.length/2*3),x=[],w=[1/0,1/0,1/0],I=[-1/0,-1/0,-1/0],S=0,f=0;f<h.length;)Da.set(x,h[f++],0,h[f++]),o&&o.transform&&Da.transformMat4(x,x,o.transform),Da.min(w,w,x),Da.max(I,I,x),y[S++]=x[0],y[S++]=x[1],y[S++]=x[2];Da.min(r,r,w),Da.max(n,n,I),s.push({points:y,indices:b,min:w,max:I})}}this._triangulationResults.push(s)}this._geoBoundingBox=[r,n]},_getRegionPolygonInfo:function(e){for(var t=this._triangulationResults[e-this._startIndex],i=0,r=0,n=0;n<t.length;n++)i+=t[n].points.length/3,r+=t[n].indices.length/3;var o=i*2+i*4,a=r*2+i*2;return{vertexCount:o,triangleCount:a}},_updatePolygonGeometry:function(e,t,i,r,n,o,a){var s=e.get("projectUVOnGround"),c=t.attributes.position,l=t.attributes.normal,d=t.attributes.texcoord0,u=t.attributes.color,h=this._triangulationResults[i-this._startIndex],p=u.value&&a,m=t.indices,f=this.extrudeY?1:2,g=this.extrudeY?2:1,v=[this.rootNode.worldTransform.x.len(),this.rootNode.worldTransform.y.len(),this.rootNode.worldTransform.z.len()],_=Da.mul([],this._geoBoundingBox[0],v),b=Da.mul([],this._geoBoundingBox[1],v),y=Math.max(b[0]-_[0],b[2]-_[2]);function x(be,De,fe){for(var Ne=be.points,Pe=Ne.length,Ke=[],At=[],bt=0;bt<Pe;bt+=3)Ke[0]=Ne[bt],Ke[f]=De,Ke[g]=Ne[bt+2],At[0]=(Ne[bt]*v[0]-_[0])/y,At[1]=(Ne[bt+2]*v[g]-_[2])/y,c.set(n,Ke),p&&u.set(n,a),d.set(n++,At)}function w(be,De,fe){var Ne=n;x(be,De,fe);for(var Pe=be.indices.length,Ke=0;Ke<Pe;Ke++)m[o*3+Ke]=be.indices[Ke]+Ne;o+=be.indices.length/3}for(var I=this.extrudeY?[0,1,0]:[0,0,1],S=Da.negate([],I),E=0;E<h.length;E++){var N=n,M=h[E];w(M,0,0),w(M,r,0);for(var P=M.points.length/3,$=0;$<P;$++)l.set(N+$,S),l.set(N+$+P,I);for(var R=[0,3,1,1,3,2],j=[[],[],[],[]],B=[],te=[],Z=[],ne=[],se=0,$=0;$<P;$++){for(var we=($+1)%P,ie=(M.points[we*3]-M.points[$*3])*v[0],ue=(M.points[we*3+2]-M.points[$*3+2])*v[g],Ee=Math.sqrt(ie*ie+ue*ue),ye=0;ye<4;ye++){var Te=ye===0||ye===3,pe=(Te?$:we)*3;j[ye][0]=M.points[pe],j[ye][f]=ye>1?r:0,j[ye][g]=M.points[pe+2],c.set(n+ye,j[ye]),s?(ne[0]=(M.points[pe]*v[0]-_[0])/y,ne[1]=(M.points[pe+2]*v[g]-_[g])/y):(ne[0]=(Te?se:se+Ee)/y,ne[1]=(j[ye][f]*v[f]-_[f])/y),d.set(n+ye,ne)}Da.sub(B,j[1],j[0]),Da.sub(te,j[3],j[0]),Da.cross(Z,B,te),Da.normalize(Z,Z);for(var ye=0;ye<4;ye++)l.set(n+ye,Z),p&&u.set(n+ye,a);for(var ye=0;ye<6;ye++)m[o*3+ye]=R[ye]+n;n+=4,o+=2,se+=Ee}}return t.dirty(),{vertexOffset:n,triangleOffset:o}},_getRegionLinesInfo:function(e,t,i){var r=0,n=0,o=t.getRegionModel(e),a=o.getModel("itemStyle"),s=a.get("borderWidth");if(s>0){var c=t.getRegionPolygonCoords(e);c.forEach(function(l){var d=l.exterior,u=l.interiors;r+=i.getPolylineVertexCount(d),n+=i.getPolylineTriangleCount(d);for(var h=0;h<u.length;h++)r+=i.getPolylineVertexCount(u[h]),n+=i.getPolylineTriangleCount(u[h])},this)}return{vertexCount:r,triangleCount:n}},_updateLinesGeometry:function(e,t,i,r,n,o){function a(l){for(var d=new Float64Array(l.length*3),u=0,h=[],p=0;p<l.length;p++)h[0]=l[p][0],h[1]=r+.1,h[2]=l[p][1],o&&Da.transformMat4(h,h,o),d[u++]=h[0],d[u++]=h[1],d[u++]=h[2];return d}var s=[1,1,1,1],c=t.getRegionPolygonCoords(i);c.forEach(function(l){var d=l.exterior,u=l.interiors;e.addPolyline(a(d),s,n);for(var h=0;h<u.length;h++)e.addPolyline(a(u[h]),s,n)})},highlight:function(e){var t=this._data;if(t){var i=t.getItemModel(e),r=i.getModel(["emphasis","itemStyle"]),n=r.get("color"),o=St.firstNotNull(r.get("opacity"),Er(t,e),1);if(n==null){var a=gr(t,e);n=Ml.lift(a,-.4)}o==null&&(o=Er(t,e));var s=F.parseColor(n);s[3]*=o,this._setColorOfDataIndex(t,e,s)}},downplay:function(e){var t=this._data;if(t){var i=St.firstNotNull(gr(t,e),t.getItemModel(e).get(["itemStyle","color"]),"#fff"),r=St.firstNotNull(Er(t,e),1),n=F.parseColor(i);n[3]*=r,this._setColorOfDataIndex(t,e,n)}},dispose:function(){this._labelsBuilder.dispose()},_setColorOfDataIndex:function(e,t,i){if(!(t<this._startIndex&&t>this._endIndex)){t-=this._startIndex;for(var r=this._vertexRangeOfDataIndex[t*2];r<this._vertexRangeOfDataIndex[t*2+1];r++)this._polygonMesh.geometry.attributes.color.set(r,i);this._polygonMesh.geometry.dirty(),this._api.getZr().refresh()}}};var bh=$S;var oB=kl.extend({type:"geo3D",__ecgl__:!0,init:function(e,t){this._geo3DBuilder=new bh(t),this.groupGL=new F.Node,this._lightRoot=new F.Node,this._sceneHelper=new ks(this._lightRoot),this._sceneHelper.initLight(this._lightRoot),this._control=new Dd({zr:t.getZr()}),this._control.init()},render:function(e,t,i){this.groupGL.add(this._geo3DBuilder.rootNode);var r=e.coordinateSystem;if(!(!r||!r.viewGL)){r.viewGL.add(this._lightRoot),e.get("show")?r.viewGL.add(this.groupGL):r.viewGL.remove(this.groupGL);var n=this._control;n.setViewGL(r.viewGL);var o=e.getModel("viewControl");n.setFromViewControlModel(o,0),this._sceneHelper.setScene(r.viewGL.scene),this._sceneHelper.updateLight(e),r.viewGL.setPostEffect(e.getModel("postEffect"),i),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._geo3DBuilder.update(e,t,i,0,e.getData().count());var a=r.viewGL.isLinearSpace()?"define":"undefine";this._geo3DBuilder.rootNode.traverse(function(s){s.material&&s.material[a]("fragment","SRGB_DECODE")}),n.off("update"),n.on("update",function(){i.dispatchAction({type:"geo3DChangeCamera",alpha:n.getAlpha(),beta:n.getBeta(),distance:n.getDistance(),center:n.getCenter(),from:this.uid,geo3DId:e.id})}),n.update()}},afterRender:function(e,t,i,r){var n=r.renderer;this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i)},dispose:function(){this._control.dispose(),this._geo3DBuilder.dispose()}});var Qte={Russia:[100,60],"United States":[-99,38],"United States of America":[-99,38]};function WS(e,t){if(e==="world"){var i=Qte[t.name];if(i){var r=[i[0],i[1]];t.setCenter(r)}}}var Jte=bi.vec3,Cf=bi.mat4,eie=[hR,WS];function qS(e,t,i,r,n){this.name=e,this.map=t,this.regionHeight=0,this.regions=[],this._nameCoordMap={},this.loadGeoJson(i,r,n),this.transform=Cf.identity(new Float64Array(16)),this.invTransform=Cf.identity(new Float64Array(16)),this.extrudeY=!0,this.altitudeAxis}qS.prototype={constructor:qS,type:"geo3D",dimensions:["lng","lat","alt"],containPoint:function(){},loadGeoJson:function(e,t,i){var r=Xb||Xb;try{this.regions=e?r(e):[]}catch(l){throw`Invalid geoJson format
`+l}t=t||{},i=i||{};for(var n=this.regions,o={},a=0;a<n.length;a++){var s=n[a].name;s=i[s]||s,n[a].name=s,o[s]=n[a],this.addGeoCoord(s,n[a].getCenter());var c=t[s];c&&n[a].transformTo(c.left,c.top,c.width,c.height)}this._regionsMap=o,this._geoRect=null,eie.forEach(function(l){l(this)},this)},getGeoBoundingRect:function(){if(this._geoRect)return this._geoRect;for(var e,t=this.regions,i=0;i<t.length;i++){var r=t[i].getBoundingRect();e=e||r.clone(),e.union(r)}return this._geoRect=e||new Dn.BoundingRect(0,0,0,0)},addGeoCoord:function(e,t){this._nameCoordMap[e]=t},getRegion:function(e){return this._regionsMap[e]},getRegionByCoord:function(e){for(var t=this.regions,i=0;i<t.length;i++)if(t[i].contain(e))return t[i]},setSize:function(e,t,i){this.size=[e,t,i];var r=this.getGeoBoundingRect(),n=e/r.width,o=-i/r.height,a=-e/2-r.x*n,s=i/2-r.y*o,c=this.extrudeY?[a,0,s]:[a,s,0],l=this.extrudeY?[n,1,o]:[n,o,1],d=this.transform;Cf.identity(d),Cf.translate(d,d,c),Cf.scale(d,d,l),Cf.invert(this.invTransform,d)},dataToPoint:function(e,t){t=t||[];var i=this.extrudeY?1:2,r=this.extrudeY?2:1,n=e[2];return isNaN(n)&&(n=0),t[0]=e[0],t[r]=e[1],this.altitudeAxis?t[i]=this.altitudeAxis.dataToCoord(n):t[i]=0,t[i]+=this.regionHeight,Jte.transformMat4(t,t,this.transform),t},pointToData:function(e,t){}};var XS=qS;function tie(e,t){var i=e.getBoxLayoutParams(),r=vd(i,{width:t.getWidth(),height:t.getHeight()});r.y=t.getHeight()-r.y-r.height,this.viewGL.setViewport(r.x,r.y,r.width,r.height,t.getDevicePixelRatio());var n=this.getGeoBoundingRect(),o=n.width/n.height*(e.get("aspectScale")||.75),a=e.get("boxWidth"),s=e.get("boxDepth"),c=e.get("boxHeight");c==null&&(c=5),isNaN(a)&&isNaN(s)&&(a=100),isNaN(s)?s=a/o:isNaN(a)&&(a=s/o),this.setSize(a,c,s),this.regionHeight=e.get("regionHeight"),this.altitudeAxis&&this.altitudeAxis.setExtent(0,Math.max(c-this.regionHeight,0))}function iie(e,t){var i=[1/0,-1/0];if(e.eachSeries(function(n){if(n.coordinateSystem===this&&n.type!=="series.map3D"){var o=n.getData(),a=n.coordDimToDataDim("alt"),s=a&&a[0];if(s){var c=o.getDataExtent(s,!0);i[0]=Math.min(i[0],c[0]),i[1]=Math.max(i[1],c[1])}}},this),i&&isFinite(i[1]-i[0])){var r=yr.createScale(i,{type:"value",min:"dataMin",max:"dataMax"});this.altitudeAxis=new rh("altitude",r),this.resize(this.model,t)}}var aB=0,sB={dimensions:XS.prototype.dimensions,create:function(e,t){var i=[];if(!zg)throw new Error("geo3D component depends on geo component");function r(n,o){var a=sB.createGeo3D(n);n.__viewGL=n.__viewGL||new Do,a.viewGL=n.__viewGL,n.coordinateSystem=a,a.model=n,i.push(a),a.resize=tie,a.resize(n,t),a.update=iie}return e.eachComponent("geo3D",function(n,o){r(n,o)}),e.eachSeriesByType("map3D",function(n,o){var a=n.get("coordinateSystem");a==null&&(a="geo3D"),a==="geo3D"&&r(n,o)}),e.eachSeries(function(n){if(n.get("coordinateSystem")==="geo3D"){if(n.type==="series.map3D")return;var o=n.getReferringComponents("geo3D").models[0];if(o||(o=e.getComponent("geo3D")),!o)throw new Error('geo "'+St.firstNotNull(n.get("geo3DIndex"),n.get("geo3DId"),0)+'" not found');n.coordinateSystem=o.coordinateSystem}}),i},createGeo3D:function(e){var t=e.get("map"),i;return typeof t=="string"?(i=t,t=zg(t)):t&&t.features&&(t={geoJson:t}),i==null&&(i="GEO_ANONYMOUS_"+aB++),new XS(i+aB++,i,t&&t.geoJson,t&&t.specialAreas,e.get("nameMap"))}},bx=sB;function yx(e){e.registerComponentModel(G4),e.registerComponentView(oB),e.registerAction({type:"geo3DChangeCamera",event:"geo3dcamerachanged",update:"series:updateCamera"},function(t,i){i.eachComponent({mainType:"geo3D",query:t},function(r){r.setView(t)})}),e.registerCoordinateSystem("geo3D",bx)}ji(yx);function lB(e,t){e.id=e.id||e.name||t+""}var yh=Es.extend({type:"globe",layoutMode:"box",coordinateSystem:null,init:function(){yh.superApply(this,"init",arguments),Re.each(this.option.layers,function(e,t){Re.merge(e,this.defaultLayerOption),lB(e,t)},this)},mergeOption:function(e){var t=this.option.layers;this.option.layers=null,yh.superApply(this,"mergeOption",arguments);function i(a){return Re.reduce(a,function(s,c,l){return lB(c,l),s[c.id]=c,s},{})}if(t&&t.length){var r=i(e.layers),n=i(t);for(var o in r)n[o]?Re.merge(n[o],r[o],!0):t.push(e.layers[o]);this.option.layers=t}Re.each(this.option.layers,function(a){Re.merge(a,this.defaultLayerOption)},this)},optionUpdated:function(){this.updateDisplacementHash()},defaultLayerOption:{show:!0,type:"overlay"},defaultOption:{show:!0,zlevel:-10,left:0,top:0,width:"100%",height:"100%",environment:"auto",baseColor:"#fff",baseTexture:"",heightTexture:"",displacementTexture:"",displacementScale:0,displacementQuality:"medium",globeRadius:100,globeOuterRadius:150,shading:"lambert",light:{main:{time:""}},atmosphere:{show:!1,offset:5,color:"#ffffff",glowPower:6,innerGlowPower:2},viewControl:{autoRotate:!0,panSensitivity:0,targetCoord:null},layers:[]},setDisplacementData:function(e,t,i){this.displacementData=e,this.displacementWidth=t,this.displacementHeight=i},getDisplacementTexture:function(){return this.get("displacementTexture")||this.get("heightTexture")},getDisplacemenScale:function(){var e=this.getDisplacementTexture(),t=this.get("displacementScale");return(!e||e==="none")&&(t=0),t},hasDisplacement:function(){return this.getDisplacemenScale()>0},_displacementChanged:!0,_displacementScale:0,updateDisplacementHash:function(){var e=this.getDisplacementTexture(),t=this.getDisplacemenScale();this._displacementChanged=this._displacementTexture!==e||this._displacementScale!==t,this._displacementTexture=e,this._displacementScale=t},isDisplacementChanged:function(){return this._displacementChanged}});Re.merge(yh.prototype,Ad);Re.merge(yh.prototype,Is);Re.merge(yh.prototype,Ms);Re.merge(yh.prototype,Ps);var cB=yh;var dB=Math.PI,Ns=Math.sin,Ac=Math.cos,uB=Math.tan,hB=Math.asin,pB=Math.atan2,xh=dB/180,rie=1e3*60*60*24,nie=2440588,oie=2451545;function aie(e){return e.valueOf()/rie-.5+nie}function sie(e){return aie(e)-oie}var xx=xh*23.4397;function lie(e,t){return pB(Ns(e)*Ac(xx)-uB(t)*Ns(xx),Ac(e))}function cie(e,t){return hB(Ns(t)*Ac(xx)+Ac(t)*Ns(xx)*Ns(e))}function die(e,t,i){return pB(Ns(e),Ac(e)*Ns(t)-uB(i)*Ac(t))}function uie(e,t,i){return hB(Ns(t)*Ns(i)+Ac(t)*Ac(i)*Ac(e))}function hie(e,t){return xh*(280.16+360.9856235*e)-t}function pie(e){return xh*(357.5291+.98560028*e)}function fie(e){var t=xh*(1.9148*Ns(e)+.02*Ns(2*e)+3e-4*Ns(3*e)),i=xh*102.9372;return e+t+i+dB}function mie(e){var t=pie(e),i=fie(t);return{dec:cie(i,0),ra:lie(i,0)}}var fB={};fB.getPosition=function(e,t,i){var r=xh*-i,n=xh*t,o=sie(e),a=mie(o),s=hie(o,r)-a.ra;return{azimuth:die(s,n,a.dec),altitude:uie(s,n,a.dec)}};var mB=fB;var gB=`@export ecgl.atmosphere.vertex
attribute vec3 position: POSITION;
attribute vec3 normal : NORMAL;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform mat4 normalMatrix : WORLDINVERSETRANSPOSE;

varying vec3 v_Normal;

void main() {
 v_Normal = normalize((normalMatrix * vec4(normal, 0.0)).xyz);
 gl_Position = worldViewProjection * vec4(position, 1.0);
}
@end


@export ecgl.atmosphere.fragment
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform float glowPower;
uniform vec3 glowColor;

varying vec3 v_Normal;

void main() {
 float intensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor = vec4(glowColor, intensity * intensity);
}
@end`;F.Shader.import(Yy);F.Shader.import(gB);var vB=kl.extend({type:"globe",__ecgl__:!0,_displacementScale:0,init:function(e,t){this.groupGL=new F.Node,this._sphereGeometry=new F.SphereGeometry({widthSegments:200,heightSegments:100,dynamic:!0}),this._overlayGeometry=new F.SphereGeometry({widthSegments:80,heightSegments:40}),this._planeGeometry=new F.PlaneGeometry,this._earthMesh=new F.Mesh({renderNormal:!0}),this._atmosphereMesh=new F.Mesh,this._atmosphereGeometry=new F.SphereGeometry({widthSegments:80,heightSegments:40}),this._atmosphereMaterial=new F.Material({shader:new F.Shader(F.Shader.source("ecgl.atmosphere.vertex"),F.Shader.source("ecgl.atmosphere.fragment")),transparent:!0}),this._atmosphereMesh.geometry=this._atmosphereGeometry,this._atmosphereMesh.material=this._atmosphereMaterial,this._atmosphereMesh.frontFace=F.Mesh.CW,this._lightRoot=new F.Node,this._sceneHelper=new ks,this._sceneHelper.initLight(this._lightRoot),this.groupGL.add(this._atmosphereMesh),this.groupGL.add(this._earthMesh),this._control=new Dd({zr:t.getZr()}),this._control.init(),this._layerMeshes={}},render:function(e,t,i){var r=e.coordinateSystem,n=e.get("shading");r.viewGL.add(this._lightRoot),e.get("show")?r.viewGL.add(this.groupGL):r.viewGL.remove(this.groupGL),this._sceneHelper.setScene(r.viewGL.scene),r.viewGL.setPostEffect(e.getModel("postEffect"),i),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling"));var o=this._earthMesh;o.geometry=this._sphereGeometry;var a="ecgl."+n;(!o.material||o.material.shader.name!==a)&&(o.material=F.createMaterial(a)),F.setMaterialFromModel(n,o.material,e,i),["roughnessMap","metalnessMap","detailMap","normalMap"].forEach(function(u){var h=o.material.get(u);h&&(h.flipY=!1)}),o.material.set("color",F.parseColor(e.get("baseColor")));var s=r.radius*.99;if(o.scale.set(s,s,s),e.get("atmosphere.show")){o.material.define("both","ATMOSPHERE_ENABLED"),this._atmosphereMesh.invisible=!1,this._atmosphereMaterial.setUniforms({glowPower:e.get("atmosphere.glowPower")||6,glowColor:e.get("atmosphere.color")||"#ffffff"}),o.material.setUniforms({glowPower:e.get("atmosphere.innerGlowPower")||2,glowColor:e.get("atmosphere.color")||"#ffffff"});var c=e.get("atmosphere.offset")||5;this._atmosphereMesh.scale.set(s+c,s+c,s+c)}else o.material.undefine("both","ATMOSPHERE_ENABLED"),this._atmosphereMesh.invisible=!0;var l=o.material.setTextureImage("diffuseMap",e.get("baseTexture"),i,{flipY:!1,anisotropic:8});l&&l.surface&&l.surface.attachToMesh(o);var d=o.material.setTextureImage("bumpMap",e.get("heightTexture"),i,{flipY:!1,anisotropic:8});d&&d.surface&&d.surface.attachToMesh(o),o.material[e.get("postEffect.enable")?"define":"undefine"]("fragment","SRGB_DECODE"),this._updateLight(e,i),this._displaceVertices(e,i),this._updateViewControl(e,i),this._updateLayers(e,i)},afterRender:function(e,t,i,r){var n=r.renderer;this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i)},_updateLayers:function(e,t){var i=e.coordinateSystem,r=e.get("layers"),n=i.radius,o=[],a=[],s=[],c=[];Re.each(r,function(p){var m=new gd(p),f=m.get("type"),g=F.loadTexture(m.get("texture"),t,{flipY:!1,anisotropic:8});if(g.surface&&g.surface.attachToMesh(this._earthMesh),f==="blend"){var v=m.get("blendTo"),_=St.firstNotNull(m.get("intensity"),1);v==="emission"?(s.push(g),c.push(_)):(o.push(g),a.push(_))}else{var b=m.get("id"),y=this._layerMeshes[b];y||(y=this._layerMeshes[b]=new F.Mesh({geometry:this._overlayGeometry,castShadow:!1,ignorePicking:!0}));var x=m.get("shading");x==="lambert"?(y.material=y.__lambertMaterial||new F.Material({autoUpdateTextureStatus:!1,shader:F.createShader("ecgl.lambert"),transparent:!0,depthMask:!1}),y.__lambertMaterial=y.material):(y.material=y.__colorMaterial||new F.Material({autoUpdateTextureStatus:!1,shader:F.createShader("ecgl.color"),transparent:!0,depthMask:!1}),y.__colorMaterial=y.material),y.material.enableTexture("diffuseMap");var w=m.get("distance"),I=n+(w??i.radius/100);y.scale.set(I,I,I),n=I;var S=this._blankTexture||(this._blankTexture=F.createBlankTexture("rgba(255, 255, 255, 0)"));y.material.set("diffuseMap",S),F.loadTexture(m.get("texture"),t,{flipY:!1,anisotropic:8},function(E){E.surface&&E.surface.attachToMesh(y),y.material.set("diffuseMap",E),t.getZr().refresh()}),m.get("show")?this.groupGL.add(y):this.groupGL.remove(y)}},this);var l=this._earthMesh.material;l.define("fragment","LAYER_DIFFUSEMAP_COUNT",o.length),l.define("fragment","LAYER_EMISSIVEMAP_COUNT",s.length),l.set("layerDiffuseMap",o),l.set("layerDiffuseIntensity",a),l.set("layerEmissiveMap",s),l.set("layerEmissionIntensity",c);var d=e.getModel("debug.wireframe");if(d.get("show")){l.define("both","WIREFRAME_TRIANGLE");var u=F.parseColor(d.get("lineStyle.color")||"rgba(0,0,0,0.5)"),h=St.firstNotNull(d.get("lineStyle.width"),1);l.set("wireframeLineWidth",h),l.set("wireframeLineColor",u)}else l.undefine("both","WIREFRAME_TRIANGLE")},_updateViewControl:function(e,t){var i=e.coordinateSystem,r=e.getModel("viewControl"),n=i.viewGL.camera,o=this;function a(){return{type:"globeChangeCamera",alpha:s.getAlpha(),beta:s.getBeta(),distance:s.getDistance()-i.radius,center:s.getCenter(),from:o.uid,globeId:e.id}}var s=this._control;s.setViewGL(i.viewGL);var c=r.get("targetCoord"),l,d;c!=null&&(d=c[0]+90,l=c[1]),s.setFromViewControlModel(r,{baseDistance:i.radius,alpha:l,beta:d}),s.off("update"),s.on("update",function(){t.dispatchAction(a())})},_displaceVertices:function(e,t){var i=e.get("displacementQuality"),r=e.get("debug.wireframe.show"),n=e.coordinateSystem;if(!(!e.isDisplacementChanged()&&i===this._displacementQuality&&r===this._showDebugWireframe)){this._displacementQuality=i,this._showDebugWireframe=r;var o=this._sphereGeometry,a={low:100,medium:200,high:400,ultra:800}[i]||200,s=a/2;(o.widthSegments!==a||r)&&(o.widthSegments=a,o.heightSegments=s,o.build()),this._doDisplaceVertices(o,n),r&&o.generateBarycentric()}},_doDisplaceVertices:function(e,t){var i=e.attributes.position.value,r=e.attributes.texcoord0.value,n=e.__originalPosition;(!n||n.length!==i.length)&&(n=new Float32Array(i.length),n.set(i),e.__originalPosition=n);for(var o=t.displacementWidth,a=t.displacementHeight,s=t.displacementData,c=0;c<e.vertexCount;c++){var l=c*3,d=c*2,u=n[l+1],h=n[l+2],p=n[l+3],m=r[d++],f=r[d++],g=Math.round(m*(o-1)),v=Math.round(f*(a-1)),_=v*o+g,b=s?s[_]:0;i[l+1]=u+u*b,i[l+2]=h+h*b,i[l+3]=p+p*b}e.generateVertexNormals(),e.dirty(),e.updateBoundingBox()},_updateLight:function(e,t){var i=this._earthMesh;this._sceneHelper.updateLight(e);var r=this._sceneHelper.mainLight,n=e.get("light.main.time")||new Date,o=mB.getPosition(qa.parseDate(n),0,0),a=Math.cos(o.altitude);r.position.y=-a*Math.cos(o.azimuth),r.position.x=Math.sin(o.altitude),r.position.z=a*Math.sin(o.azimuth),r.lookAt(i.getWorldPosition())},dispose:function(e,t){this.groupGL.removeAll(),this._control.dispose()}});var gie=bi.vec3;function YS(e){this.radius=e,this.viewGL=null,this.altitudeAxis,this.displacementData=null,this.displacementWidth,this.displacementHeight}YS.prototype={constructor:YS,dimensions:["lng","lat","alt"],type:"globe",containPoint:function(){},setDisplacementData:function(e,t,i){this.displacementData=e,this.displacementWidth=t,this.displacementHeight=i},_getDisplacementScale:function(e,t){var i=(e+180)/360*(this.displacementWidth-1),r=(90-t)/180*(this.displacementHeight-1),n=Math.round(i)+Math.round(r)*this.displacementWidth;return this.displacementData[n]},dataToPoint:function(e,t){var i=e[0],r=e[1],n=e[2]||0,o=this.radius;this.displacementData&&(o*=1+this._getDisplacementScale(i,r)),this.altitudeAxis&&(o+=this.altitudeAxis.dataToCoord(n)),i=i*Math.PI/180,r=r*Math.PI/180;var a=Math.cos(r)*o;return t=t||[],t[0]=-a*Math.cos(i+Math.PI),t[1]=Math.sin(r)*o,t[2]=a*Math.sin(i+Math.PI),t},pointToData:function(e,t){var i=e[0],r=e[1],n=e[2],o=gie.len(e);i/=o,r/=o,n/=o;var a=Math.asin(r),s=Math.atan2(n,-i);s<0&&(s=Math.PI*2+s);var c=a*180/Math.PI,l=s*180/Math.PI-180;return t=t||[],t[0]=l,t[1]=c,t[2]=o-this.radius,this.altitudeAxis&&(t[2]=this.altitudeAxis.coordToData(t[2])),t}};var ZS=YS;function vie(e,t){var i=document.createElement("canvas"),r=i.getContext("2d"),n=e.width,o=e.height;i.width=n,i.height=o,r.drawImage(e,0,0,n,o);for(var a=r.getImageData(0,0,n,o).data,s=new Float32Array(a.length/4),c=0;c<a.length/4;c++){var l=a[c*4];s[c]=l/255*t}return{data:s,width:n,height:o}}function _ie(e,t){var i=e.getBoxLayoutParams(),r=vd(i,{width:t.getWidth(),height:t.getHeight()});r.y=t.getHeight()-r.y-r.height,this.viewGL.setViewport(r.x,r.y,r.width,r.height,t.getDevicePixelRatio()),this.radius=e.get("globeRadius");var n=e.get("globeOuterRadius");this.altitudeAxis&&this.altitudeAxis.setExtent(0,n-this.radius)}function bie(e,t){var i=[1/0,-1/0];if(e.eachSeries(function(n){if(n.coordinateSystem===this){var o=n.getData(),a=n.coordDimToDataDim("alt"),s=a&&a[0];if(s){var c=o.getDataExtent(s,!0);i[0]=Math.min(i[0],c[0]),i[1]=Math.max(i[1],c[1])}}},this),i&&isFinite(i[1]-i[0])){var r=yr.createScale(i,{type:"value",min:"dataMin",max:"dataMax"});this.altitudeAxis=new rh("altitude",r),this.resize(this.model,t)}}var yie={dimensions:ZS.prototype.dimensions,create:function(e,t){var i=[];return e.eachComponent("globe",function(r){r.__viewGL=r.__viewGL||new Do;var n=new ZS;n.viewGL=r.__viewGL,r.coordinateSystem=n,n.model=r,i.push(n),n.resize=_ie,n.resize(r,t),n.update=bie}),e.eachSeries(function(r){if(r.get("coordinateSystem")==="globe"){var n=r.getReferringComponents("globe").models[0];if(n||(n=e.getComponent("globe")),!n)throw new Error('globe "'+St.firstNotNull(r.get("globe3DIndex"),r.get("globe3DId"),0)+'" not found');var o=n.coordinateSystem;r.coordinateSystem=o}}),e.eachComponent("globe",function(r,n){var o=r.coordinateSystem,a=r.getDisplacementTexture(),s=r.getDisplacemenScale();if(r.isDisplacementChanged()){if(r.hasDisplacement()){var c=!0;F.loadTexture(a,t,function(l){var d=l.image,u=vie(d,s);r.setDisplacementData(u.data,u.width,u.height),c||t.dispatchAction({type:"globeUpdateDisplacment"})}),c=!1}else o.setDisplacementData(null,0,0);o.setDisplacementData(r.displacementData,r.displacementWidth,r.displacementHeight)}}),i}},_B=yie;function bB(e){e.registerComponentModel(cB),e.registerComponentView(vB),e.registerCoordinateSystem("globe",_B),e.registerAction({type:"globeChangeCamera",event:"globecamerachanged",update:"series:updateCamera"},function(t,i){i.eachComponent({mainType:"globe",query:t},function(r){r.setView(t)})}),e.registerAction({type:"globeUpdateDisplacment",event:"globedisplacementupdated",update:"update"},function(t,i){})}ji(bB);var yB=["zoom","center","pitch","bearing"],KS=Es.extend({type:"mapbox3D",layoutMode:"box",coordinateSystem:null,defaultOption:{zlevel:-10,style:"mapbox://styles/mapbox/light-v9",center:[0,0],zoom:0,pitch:0,bearing:0,light:{main:{alpha:20,beta:30}},altitudeScale:1,boxHeight:"auto"},getMapboxCameraOption:function(){var e=this;return yB.reduce(function(t,i){return t[i]=e.get(i),t},{})},setMapboxCameraOption:function(e){e!=null&&yB.forEach(function(t){e[t]!=null&&(this.option[t]=e[t])},this)},getMapbox:function(){return this._mapbox},setMapbox:function(e){this._mapbox=e}});Re.merge(KS.prototype,Is);Re.merge(KS.prototype,Ms);var xB=KS;function kd(e,t){if(this.id=e,this.zr=t,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute;left:0;right:0;top:0;bottom:0;",!mapboxgl)throw new Error("Mapbox GL library must be included. See https://www.mapbox.com/mapbox-gl-js/api/");this._mapbox=new mapboxgl.Map({container:this.dom}),this._initEvents()}kd.prototype.setUnpainted=function(){};kd.prototype.resize=function(){this._mapbox.resize()};kd.prototype.getMapbox=function(){return this._mapbox};kd.prototype.clear=function(){};kd.prototype.refresh=function(){this._mapbox.resize()};var wB=["mousedown","mouseup","click","dblclick","mousemove","mousewheel","wheel","touchstart","touchend","touchmove","touchcancel"];kd.prototype._initEvents=function(){var e=this._mapbox.getCanvasContainer();this._handlers=this._handlers||{contextmenu:function(t){return t.preventDefault(),!1}},wB.forEach(function(t){this._handlers[t]=function(i){var r={};for(var n in i)r[n]=i[n];r.bubbles=!1;var o=new i.constructor(i.type,r);e.dispatchEvent(o)},this.zr.dom.addEventListener(t,this._handlers[t])},this),this.zr.dom.addEventListener("contextmenu",this._handlers.contextmenu)};kd.prototype.dispose=function(){wB.forEach(function(e){this.zr.dom.removeEventListener(e,this._handlers[e])},this)};var EB=kd;var Ex=`
@export ecgl.displayShadow.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header

@import ecgl.common.attributes

varying vec3 v_WorldPosition;

varying vec3 v_Normal;

void main()
{
 @import ecgl.common.uv.main
 v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);

 v_WorldPosition = (world * vec4(position, 1.0)).xyz;
 gl_Position = worldViewProjection * vec4(position, 1.0);
}

@end


@export ecgl.displayShadow.fragment

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform float roughness: 0.2;

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

@import ecgl.common.ssaoMap.header

@import clay.plugin.compute_shadow_map

void main()
{
 float shadow = 1.0;

 @import ecgl.common.ssaoMap.main

#if defined(DIRECTIONAL_LIGHT_COUNT) && defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
 for (int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++) {
 shadow = min(shadow, shadowContribsDir[i] * 0.5 + 0.5);
 }
#endif

 shadow *= 0.5 + ao * 0.5;
 shadow = clamp(shadow, 0.0, 1.0);

 gl_FragColor = vec4(vec3(0.0), 1.0 - shadow);
}

@end`;F.Shader.import(Ex);var CB=kl.extend({type:"mapbox3D",__ecgl__:!0,init:function(e,t){var i=t.getZr();this._zrLayer=new EB("mapbox3D",i),i.painter.insertLayer(-1e3,this._zrLayer),this._lightRoot=new F.Node,this._sceneHelper=new ks(this._lightRoot),this._sceneHelper.initLight(this._lightRoot);var r=this._zrLayer.getMapbox(),n=this._dispatchInteractAction.bind(this,t,r);["zoom","rotate","drag","pitch","rotate","move"].forEach(function(o){r.on(o,n)}),this._groundMesh=new F.Mesh({geometry:new F.PlaneGeometry,material:new F.Material({shader:new F.Shader({vertex:F.Shader.source("ecgl.displayShadow.vertex"),fragment:F.Shader.source("ecgl.displayShadow.fragment")}),depthMask:!1}),renderOrder:-100,culling:!1,castShadow:!1,$ignorePicking:!0,renderNormal:!0})},render:function(e,t,i){var r=this._zrLayer.getMapbox(),n=e.get("style"),o=JSON.stringify(n);o!==this._oldStyleStr&&n&&r.setStyle(n),this._oldStyleStr=o,r.setCenter(e.get("center")),r.setZoom(e.get("zoom")),r.setPitch(e.get("pitch")),r.setBearing(e.get("bearing")),e.setMapbox(r);var a=e.coordinateSystem;a.viewGL.scene.add(this._lightRoot),a.viewGL.add(this._groundMesh),this._updateGroundMesh(),this._sceneHelper.setScene(a.viewGL.scene),this._sceneHelper.updateLight(e),a.viewGL.setPostEffect(e.getModel("postEffect"),i),a.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._mapbox3DModel=e},afterRender:function(e,t,i,r){var n=r.renderer;this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i),e.coordinateSystem.viewGL.scene.traverse(function(o){o.material&&(o.material.define("fragment","NORMAL_UP_AXIS",2),o.material.define("fragment","NORMAL_FRONT_AXIS",1))})},updateCamera:function(e,t,i,r){e.coordinateSystem.setCameraOption(r),this._updateGroundMesh(),i.getZr().refresh()},_dispatchInteractAction:function(e,t,i){e.dispatchAction({type:"mapbox3DChangeCamera",pitch:t.getPitch(),zoom:t.getZoom(),center:t.getCenter().toArray(),bearing:t.getBearing(),mapbox3DId:this._mapbox3DModel&&this._mapbox3DModel.id})},_updateGroundMesh:function(){if(this._mapbox3DModel){var e=this._mapbox3DModel.coordinateSystem,t=e.dataToPoint(e.center);this._groundMesh.position.set(t[0],t[1],-.001);var i=new F.Plane(new F.Vector3(0,0,1),0),r=e.viewGL.camera.castRay(new F.Vector2(-1,-1)),n=e.viewGL.camera.castRay(new F.Vector2(1,1)),o=r.intersectPlane(i),a=n.intersectPlane(i),s=o.dist(a)/e.viewGL.rootNode.scale.x;this._groundMesh.scale.set(s,s,1)}},dispose:function(e,t){this._zrLayer&&this._zrLayer.dispose(),t.getZr().painter.delLayer(-1e3)}});var Pd=bi.mat4,yv=512,QS=.6435011087932844,Ia=Math.PI,Sf=1/10;function JS(){this.width=0,this.height=0,this.altitudeScale=1,this.boxHeight="auto",this.altitudeExtent,this.bearing=0,this.pitch=0,this.center=[0,0],this._origin,this.zoom=0,this._initialZoom,this.maxPitch=60,this.zoomOffset=0}JS.prototype={constructor:JS,dimensions:["lng","lat","alt"],containPoint:function(){},setCameraOption:function(e){this.bearing=e.bearing,this.pitch=e.pitch,this.center=e.center,this.zoom=e.zoom,this._origin||(this._origin=this.projectOnTileWithScale(this.center,yv)),this._initialZoom==null&&(this._initialZoom=this.zoom),this.updateTransform()},updateTransform:function(){if(this.height){var e=.5/Math.tan(QS/2)*this.height*Sf,t=Math.max(Math.min(this.pitch,this.maxPitch),0)/180*Math.PI,i=QS/2,r=Math.PI/2+t,n=Math.sin(i)*e/Math.sin(Math.PI-r-i),o=Math.cos(Math.PI/2-t)*n+e,a=o*1.1;this.pitch>50&&(a=1e3);var s=[];Pd.perspective(s,QS,this.width/this.height,1,a),this.viewGL.camera.projectionMatrix.setArray(s),this.viewGL.camera.decomposeProjectionMatrix();var s=Pd.identity([]),c=this.dataToPoint(this.center);Pd.scale(s,s,[1,-1,1]),Pd.translate(s,s,[0,0,-e]),Pd.rotateX(s,s,t),Pd.rotateZ(s,s,-this.bearing/180*Math.PI),Pd.translate(s,s,[-c[0]*this.getScale()*Sf,-c[1]*this.getScale()*Sf,0]),this.viewGL.camera.viewMatrix.array=s;var l=[];Pd.invert(l,s),this.viewGL.camera.worldTransform.array=l,this.viewGL.camera.decomposeWorldTransform();var d=yv*this.getScale(),u;if(this.altitudeExtent&&!isNaN(this.boxHeight)){var h=this.altitudeExtent[1]-this.altitudeExtent[0];u=this.boxHeight/h*this.getScale()/Math.pow(2,this._initialZoom-this.zoomOffset)}else u=d/(2*Math.PI*6378e3*Math.abs(Math.cos(this.center[1]*(Math.PI/180))))*this.altitudeScale*Sf;this.viewGL.rootNode.scale.set(this.getScale()*Sf,this.getScale()*Sf,u)}},getScale:function(){return Math.pow(2,this.zoom-this.zoomOffset)},projectOnTile:function(e,t){return this.projectOnTileWithScale(e,this.getScale()*yv,t)},projectOnTileWithScale:function(e,t,i){var r=e[0],n=e[1],o=r*Ia/180,a=n*Ia/180,s=t*(o+Ia)/(2*Ia),c=t*(Ia-Math.log(Math.tan(Ia/4+a*.5)))/(2*Ia);return i=i||[],i[0]=s,i[1]=c,i},unprojectFromTile:function(e,t){return this.unprojectOnTileWithScale(e,this.getScale()*yv,t)},unprojectOnTileWithScale:function(e,t,i){var r=e[0],n=e[1],o=r/t*(2*Ia)-Ia,a=2*(Math.atan(Math.exp(Ia-n/t*(2*Ia)))-Ia/4);return i=i||[],i[0]=o*180/Ia,i[1]=a*180/Ia,i},dataToPoint:function(e,t){return t=this.projectOnTileWithScale(e,yv,t),t[0]-=this._origin[0],t[1]-=this._origin[1],t[2]=isNaN(e[2])?0:e[2],isNaN(e[2])||(t[2]=e[2],this.altitudeExtent&&(t[2]-=this.altitudeExtent[0])),t}};var Tf=JS;function xv(){Tf.apply(this,arguments)}xv.prototype=new Tf;xv.prototype.constructor=xv;xv.prototype.type="mapbox3D";var SB=xv;function Cx(e,t,i){function r(o,a){var s=a.getWidth(),c=a.getHeight(),l=a.getDevicePixelRatio();this.viewGL.setViewport(0,0,s,c,l),this.width=s,this.height=c,this.altitudeScale=o.get("altitudeScale"),this.boxHeight=o.get("boxHeight")}function n(o,a){if(this.model.get("boxHeight")!=="auto"){var s=[1/0,-1/0];o.eachSeries(function(c){if(c.coordinateSystem===this){var l=c.getData(),d=c.coordDimToDataDim("alt")[0];if(d){var u=l.getDataExtent(d,!0);s[0]=Math.min(s[0],u[0]),s[1]=Math.max(s[1],u[1])}}},this),s&&isFinite(s[1]-s[0])&&(this.altitudeExtent=s)}}return{dimensions:t.prototype.dimensions,create:function(o,a){var s=[];return o.eachComponent(e,function(c){var l=c.__viewGL;l||(l=c.__viewGL=new Do,l.setRootNode(new F.Node));var d=new t;d.viewGL=c.__viewGL,d.resize=r,d.resize(c,a),s.push(d),c.coordinateSystem=d,d.model=c,d.update=n}),o.eachSeries(function(c){if(c.get("coordinateSystem")===e){var l=c.getReferringComponents(e).models[0];if(l||(l=o.getComponent(e)),!l)throw new Error(e+' "'+St.firstNotNull(c.get(e+"Index"),c.get(e+"Id"),0)+'" not found');c.coordinateSystem=l.coordinateSystem}}),i&&i(s,o,a),s}}}var xie=Cx("mapbox3D",SB,function(e){e.forEach(function(t){t.setCameraOption(t.model.getMapboxCameraOption())})}),TB=xie;function AB(e){e.registerComponentModel(xB),e.registerComponentView(CB),e.registerCoordinateSystem("mapbox3D",TB),e.registerAction({type:"mapbox3DChangeCamera",event:"mapbox3dcamerachanged",update:"mapbox3D:updateCamera"},function(t,i){i.eachComponent({mainType:"mapbox3D",query:t},function(r){r.setMapboxCameraOption(t)})})}ji(AB);var DB=["zoom","center","pitch","bearing"],eT=Es.extend({type:"maptalks3D",layoutMode:"box",coordinateSystem:null,defaultOption:{zlevel:-10,urlTemplate:"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://osm.org">OpenStreetMap</a> contributors, &copy; <a href="https://carto.com/">CARTO</a>',center:[0,0],zoom:0,pitch:0,bearing:0,light:{main:{alpha:20,beta:30}},altitudeScale:1,boxHeight:"auto"},getMaptalksCameraOption:function(){var e=this;return DB.reduce(function(t,i){return t[i]=e.get(i),t},{})},setMaptalksCameraOption:function(e){e!=null&&DB.forEach(function(t){e[t]!=null&&(this.option[t]=e[t])},this)},getMaptalks:function(){return this._maptalks},setMaptalks:function(e){this._maptalks=e}});Re.merge(eT.prototype,Is);Re.merge(eT.prototype,Ms);var IB=eT;function Nd(e,t,i,r){if(this.id=e,this.zr=t,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute;left:0;right:0;top:0;bottom:0;",!maptalks)throw new Error("Maptalks library must be included. See https://maptalks.org");this._maptalks=new maptalks.Map(this.dom,{center:i,zoom:r,doubleClickZoom:!1,fog:!1}),this._initEvents()}Nd.prototype.setUnpainted=function(){};Nd.prototype.resize=function(){this._maptalks.checkSize()};Nd.prototype.getMaptalks=function(){return this._maptalks};Nd.prototype.clear=function(){};Nd.prototype.refresh=function(){this._maptalks.checkSize()};var MB=["mousedown","mouseup","click","dblclick","mousemove","mousewheel","DOMMouseScroll","touchstart","touchend","touchmove","touchcancel"];Nd.prototype._initEvents=function(){var e=this.dom;this._handlers=this._handlers||{contextmenu:function(t){return t.preventDefault(),!1}},MB.forEach(function(t){this._handlers[t]=function(i){var r={};for(var n in i)r[n]=i[n];r.bubbles=!1;var o=new i.constructor(i.type,r);t==="mousewheel"||t==="DOMMouseScroll"?e.dispatchEvent(o):e.firstElementChild.dispatchEvent(o)},this.zr.dom.addEventListener(t,this._handlers[t])},this),this.zr.dom.addEventListener("contextmenu",this._handlers.contextmenu)};Nd.prototype.dispose=function(){MB.forEach(function(e){this.zr.dom.removeEventListener(e,this._handlers[e])},this),this._maptalks.remove()};var kB=Nd;F.Shader.import(Ex);var PB=kl.extend({type:"maptalks3D",__ecgl__:!0,init:function(e,t){this._groundMesh=new F.Mesh({geometry:new F.PlaneGeometry,material:new F.Material({shader:new F.Shader({vertex:F.Shader.source("ecgl.displayShadow.vertex"),fragment:F.Shader.source("ecgl.displayShadow.fragment")}),depthMask:!1}),renderOrder:-100,culling:!1,castShadow:!1,$ignorePicking:!0,renderNormal:!0})},_initMaptalksLayer:function(e,t){var i=t.getZr();this._zrLayer=new kB("maptalks3D",i,e.get("center"),e.get("zoom")),i.painter.insertLayer(-1e3,this._zrLayer),this._lightRoot=new F.Node,this._sceneHelper=new ks(this._lightRoot),this._sceneHelper.initLight(this._lightRoot);var r=this._zrLayer.getMaptalks(),n=this._dispatchInteractAction.bind(this,t,r);["zoomend","zooming","zoomstart","dragrotating","pitch","pitchend","movestart","moving","moveend","resize","touchstart","touchmove","touchend","animating"].forEach(function(o){r.on(o,n)})},render:function(e,t,i){this._zrLayer||this._initMaptalksLayer(e,i);var r=this._zrLayer.getMaptalks(),n=e.get("urlTemplate"),o=r.getBaseLayer();n!==this._oldUrlTemplate&&(o?o.setOptions({urlTemplate:n,attribution:e.get("attribution")}):(o=new maptalks.TileLayer("maptalks-echarts-gl-baselayer",{urlTemplate:n,subdomains:["a","b","c"],attribution:e.get("attribution")}),r.setBaseLayer(o))),this._oldUrlTemplate=n,r.setCenter(e.get("center")),r.setZoom(e.get("zoom"),{animation:!1}),r.setPitch(e.get("pitch")),r.setBearing(e.get("bearing")),e.setMaptalks(r);var a=e.coordinateSystem;a.viewGL.scene.add(this._lightRoot),a.viewGL.add(this._groundMesh),this._updateGroundMesh(),this._sceneHelper.setScene(a.viewGL.scene),this._sceneHelper.updateLight(e),a.viewGL.setPostEffect(e.getModel("postEffect"),i),a.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._maptalks3DModel=e},afterRender:function(e,t,i,r){var n=r.renderer;this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i),e.coordinateSystem.viewGL.scene.traverse(function(o){o.material&&(o.material.define("fragment","NORMAL_UP_AXIS",2),o.material.define("fragment","NORMAL_FRONT_AXIS",1))})},updateCamera:function(e,t,i,r){e.coordinateSystem.setCameraOption(r),this._updateGroundMesh(),i.getZr().refresh()},_dispatchInteractAction:function(e,t,i){e.dispatchAction({type:"maptalks3DChangeCamera",pitch:t.getPitch(),zoom:Eie(t.getResolution())+1,center:t.getCenter().toArray(),bearing:t.getBearing(),maptalks3DId:this._maptalks3DModel&&this._maptalks3DModel.id})},_updateGroundMesh:function(){if(this._maptalks3DModel){var e=this._maptalks3DModel.coordinateSystem,t=e.dataToPoint(e.center);this._groundMesh.position.set(t[0],t[1],-.001);var i=new F.Plane(new F.Vector3(0,0,1),0),r=e.viewGL.camera.castRay(new F.Vector2(-1,-1)),n=e.viewGL.camera.castRay(new F.Vector2(1,1)),o=r.intersectPlane(i),a=n.intersectPlane(i),s=o.dist(a)/e.viewGL.rootNode.scale.x;this._groundMesh.scale.set(s,s,1)}},dispose:function(e,t){this._zrLayer&&this._zrLayer.dispose(),t.getZr().painter.delLayer(-1e3)}}),wie=2*6378137*Math.PI/(256*Math.pow(2,20));function Eie(e){return 19-Math.log(e/wie)/Math.LN2}function wv(){Tf.apply(this,arguments),this.maxPitch=85,this.zoomOffset=1}wv.prototype=new Tf;wv.prototype.constructor=wv;wv.prototype.type="maptalks3D";var NB=wv;var Cie=Cx("maptalks3D",NB,function(e){e.forEach(function(t){t.setCameraOption(t.model.getMaptalksCameraOption())})}),OB=Cie;function RB(e){e.registerComponentModel(IB),e.registerComponentView(PB),e.registerCoordinateSystem("maptalks3D",OB),e.registerAction({type:"maptalks3DChangeCamera",event:"maptalks3dcamerachanged",update:"maptalks3D:updateCamera"},function(t,i){i.eachComponent({mainType:"maptalks3D",query:t},function(r){r.setMaptalksCameraOption(t)})})}ji(RB);var Sie=bi.vec3,Tie=yr.dataStack.isDimensionStacked;function Aie(e){var t=e[0],i=e[1];return!(t>0&&i>0||t<0&&i<0)}function Die(e,t){var i=e.getData(),r=e.get("barSize");if(r==null){var n=t.size,o,a,s=t.getAxis("x"),c=t.getAxis("y");s.type==="category"?o=s.getBandWidth()*.7:o=Math.round(n[0]/Math.sqrt(i.count()))*.6,c.type==="category"?a=c.getBandWidth()*.7:a=Math.round(n[1]/Math.sqrt(i.count()))*.6,r=[o,a]}else Re.isArray(r)||(r=[r,r]);var l=t.getAxis("z").scale.getExtent(),d=Aie(l),u=["x","y","z"].map(function(m){return e.coordDimToDataDim(m)[0]}),h=Tie(i,u[2]),p=h?i.getCalculationInfo("stackResultDimension"):u[2];i.each(u,function(m,f,g,v){var _=i.get(p,v),b=h?_-g:d?0:l[0],y=t.dataToPoint([m,f,b]),x=t.dataToPoint([m,f,_]),w=Sie.dist(y,x),I=[0,x[1]<y[1]?-1:1,0];Math.abs(w)===0&&(w=.1);var S=[r[0],w,r[1]];i.setItemLayout(v,[y,I,S])}),i.setLayout("orient",[1,0,0])}var FB=Die;function Sx(e,t,i){for(var r=e.getDataExtent(t),n=e.getDataExtent(i),o=r[1]-r[0]||r[0],a=n[1]-n[0]||n[0],s=50,c=new Uint8Array(s*s),l=0;l<e.count();l++){var d=e.get(t,l),u=e.get(i,l),h=Math.floor((d-r[0])/o*(s-1)),p=Math.floor((u-n[0])/a*(s-1)),m=p*s+h;c[m]=c[m]||1}for(var f=0,l=0;l<c.length;l++)c[l]&&f++;return f/c.length}var LB=bi.vec3,Iie=yr.dataStack.isDimensionStacked;function Mie(e,t){var i=e.getData(),r=e.get("minHeight")||0,n=e.get("barSize"),o=["lng","lat","alt"].map(function(l){return e.coordDimToDataDim(l)[0]});if(n==null){var a=t.radius*Math.PI,s=Sx(i,o[0],o[1]);n=[a/Math.sqrt(i.count()/s),a/Math.sqrt(i.count()/s)]}else Re.isArray(n)||(n=[n,n]);var c=tT(i,o);i.each(o,function(l,d,u,h){var p=i.get(c.dimension,h),m=c.isStacked?p-u:t.altitudeAxis.scale.getExtent()[0],f=Math.max(t.altitudeAxis.dataToCoord(u),r),g=t.dataToPoint([l,d,m]),v=t.dataToPoint([l,d,p]),_=LB.sub([],v,g);LB.normalize(_,_);var b=[n[0],f,n[1]];i.setItemLayout(h,[g,_,b])}),i.setLayout("orient",Fe.UP.array)}function kie(e,t){var i=e.getData(),r=e.get("barSize"),n=e.get("minHeight")||0,o=["lng","lat","alt"].map(function(d){return e.coordDimToDataDim(d)[0]});if(r==null){var a=Math.min(t.size[0],t.size[2]),s=Sx(i,o[0],o[1]);r=[a/Math.sqrt(i.count()/s),a/Math.sqrt(i.count()/s)]}else Re.isArray(r)||(r=[r,r]);var c=[0,1,0],l=tT(i,o);i.each(o,function(d,u,h,p){var m=i.get(l.dimension,p),f=l.isStacked?m-h:t.altitudeAxis.scale.getExtent()[0],g=Math.max(t.altitudeAxis.dataToCoord(h),n),v=t.dataToPoint([d,u,f]),_=[r[0],g,r[1]];i.setItemLayout(p,[v,c,_])}),i.setLayout("orient",[1,0,0])}function Pie(e,t){var i=e.getData(),r=e.coordDimToDataDim("lng")[0],n=e.coordDimToDataDim("lat")[0],o=e.coordDimToDataDim("alt")[0],a=e.get("barSize"),s=e.get("minHeight")||0;if(a==null){var c=i.getDataExtent(r),l=i.getDataExtent(n),d=t.dataToPoint([c[0],l[0]]),u=t.dataToPoint([c[1],l[1]]),h=Math.min(Math.abs(d[0]-u[0]),Math.abs(d[1]-u[1]))||1,p=Sx(i,r,n);a=[h/Math.sqrt(i.count()/p),h/Math.sqrt(i.count()/p)]}else Re.isArray(a)||(a=[a,a]),a[0]/=t.getScale()/16,a[1]/=t.getScale()/16;var m=[0,0,1],f=[r,n,o],g=tT(i,f);i.each(f,function(v,_,b,y){var x=i.get(g.dimension,y),w=g.isStacked?x-b:0,I=t.dataToPoint([v,_,w]),S=t.dataToPoint([v,_,x]),E=Math.max(S[2]-I[2],s),N=[a[0],E,a[1]];i.setItemLayout(y,[I,m,N])}),i.setLayout("orient",[1,0,0])}function tT(e,t){var i=Iie(e,t[2]);return{dimension:i?e.getCalculationInfo("stackResultDimension"):t[2],isStacked:i}}function iT(e){e.registerLayout(function(t,i){t.eachSeriesByType("bar3D",function(r){var n=r.coordinateSystem,o=n&&n.type;o==="globe"?Mie(r,n):o==="cartesian3D"?FB(r,n):o==="geo3D"?kie(r,n):(o==="mapbox3D"||o==="maptalks3D")&&Pie(r,n)})})}var rT={};rT.getFormattedLabel=function(e,t,i,r,n){i=i||"normal";var o=e.getData(r),a=o.getItemModel(t),s=e.getDataParams(t,r);n!=null&&s.value instanceof Array&&(s.value=s.value[n]);var c=a.get(i==="normal"?["label","formatter"]:["emphasis","label","formatter"]);c==null&&(c=a.get(["label","formatter"]));var l;return typeof c=="function"?(s.status=i,l=c(s)):typeof c=="string"&&(l=Ca.formatTpl(c,s)),l};rT.normalizeToArray=function(e){return e instanceof Array?e:e==null?[]:[e]};var Os=rT;function Nie(e,t){var i=[];return Re.each(e.dimensions,function(r){var n=e.getDimensionInfo(r),o=n.otherDims,a=o[t];a!=null&&a!==!1&&(i[a]=n.name)}),i}function Ll(e,t,i){function r(u){var h=!0,p=[],m=Nie(n,"tooltip");m.length?Re.each(m,function(g){f(n.get(g,t),g)}):Re.each(u,f);function f(g,v){var _=n.getDimensionInfo(v);if(!(!_||_.otherDims.tooltip===!1)){var b=_.type,y=(h?"- "+(_.tooltipName||_.name)+": ":"")+(b==="ordinal"?g+"":b==="time"?i?"":Ca.formatTime("yyyy/MM/dd hh:mm:ss",g):Ca.addCommas(g));y&&p.push(Ca.encodeHTML(y))}}return(h?"<br/>":"")+p.join(h?"<br/>":", ")}var n=e.getData(),o=e.getRawValue(t),a=Re.isArray(o)?r(o):Ca.encodeHTML(Ca.addCommas(o)),s=n.getName(t),c=gr(n,t);Re.isObject(c)&&c.colorStops&&(c=(c.colorStops[0]||{}).color),c=c||"transparent";var l=Ca.getTooltipMarker(c),d=e.name;return d==="\0-"&&(d=""),d=d?Ca.encodeHTML(d)+(i?": ":"<br/>"):"",i?l+d+a:d+l+(s?Ca.encodeHTML(s)+": "+a:a)}function Od(e,t,i){i=i||e.getSource();var r=t||qb(e.get("coordinateSystem"))||["x","y","z"],n=yr.createDimensions(i,{dimensionsDefine:i.dimensionsDefine||e.get("dimensions"),encodeDefine:i.encodeDefine||e.get("encode"),coordDimensions:r.map(function(s){var c=e.getReferringComponents(s+"Axis3D").models[0];return{type:c&&c.get("type")==="category"?"ordinal":"float",name:s}})});e.get("coordinateSystem")==="cartesian3D"&&n.forEach(function(s){if(r.indexOf(s.coordDim)>=0){var c=e.getReferringComponents(s.coordDim+"Axis3D").models[0];c&&c.get("type")==="category"&&(s.ordinalMeta=c.getOrdinalMeta())}});var o=yr.dataStack.enableDataStack(e,n,{byIndex:!0,stackedCoordDimension:"z"}),a=new Ln(n,e);return a.setCalculationInfo(o),a.initData(i),a}var BB=mn.extend({type:"series.bar3D",dependencies:["globe"],visualStyleAccessPathvisu:"itemStyle",getInitialData:function(e,t){return Od(this)},getFormattedLabel:function(e,t,i,r){var n=Os.getFormattedLabel(this,e,t,i,r);return n==null&&(n=this.getData().get("z",e)),n},formatTooltip:function(e){return Ll(this,e)},defaultOption:{coordinateSystem:"cartesian3D",globeIndex:0,grid3DIndex:0,zlevel:-10,bevelSize:0,bevelSmoothness:2,onGridPlane:"xy",shading:"color",minHeight:0,itemStyle:{opacity:1},label:{show:!1,distance:2,textStyle:{fontSize:14,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:3}},emphasis:{label:{show:!0}},animationDurationUpdate:500}});Re.merge(BB.prototype,Ps);var VB=BB;var rn=bi.vec3,Oie=bi.mat3,nT=Jt.extend(function(){return{attributes:{position:new Jt.Attribute("position","float",3,"POSITION"),normal:new Jt.Attribute("normal","float",3,"NORMAL"),color:new Jt.Attribute("color","float",4,"COLOR"),prevPosition:new Jt.Attribute("prevPosition","float",3),prevNormal:new Jt.Attribute("prevNormal","float",3)},dynamic:!0,enableNormal:!1,bevelSize:1,bevelSegments:0,_dataIndices:null,_vertexOffset:0,_triangleOffset:0}},{resetOffset:function(){this._vertexOffset=0,this._triangleOffset=0},setBarCount:function(e){var t=this.enableNormal,i=this.getBarVertexCount()*e,r=this.getBarTriangleCount()*e;this.vertexCount!==i&&(this.attributes.position.init(i),t?this.attributes.normal.init(i):this.attributes.normal.value=null,this.attributes.color.init(i)),this.triangleCount!==r&&(this.indices=i>65535?new Uint32Array(r*3):new Uint16Array(r*3),this._dataIndices=new Uint32Array(i))},getBarVertexCount:function(){var e=this.bevelSize>0?this.bevelSegments:0;return e>0?this._getBevelBarVertexCount(e):this.enableNormal?24:8},getBarTriangleCount:function(){var e=this.bevelSize>0?this.bevelSegments:0;return e>0?this._getBevelBarTriangleCount(e):12},_getBevelBarVertexCount:function(e){return(e+1)*4*(e+1)*2},_getBevelBarTriangleCount:function(e){var t=e*4+3,i=e*2+1;return(t+1)*i*2+4},setColor:function(e,t){for(var i=this.getBarVertexCount(),r=i*e,n=i*(e+1),o=r;o<n;o++)this.attributes.color.set(o,t);this.dirtyAttribute("color")},getDataIndexOfVertex:function(e){return this._dataIndices?this._dataIndices[e]:null},addBar:function(){for(var e=rn.create,t=rn.scaleAndAdd,i=e(),r=e(),n=e(),o=e(),a=e(),s=e(),c=e(),l=[],d=[],u=0;u<8;u++)l[u]=e();for(var h=[[0,1,5,4],[2,3,7,6],[4,5,6,7],[3,2,1,0],[0,4,7,3],[1,2,6,5]],p=[0,1,2,0,2,3],m=[],u=0;u<h.length;u++)for(var f=h[u],g=0;g<2;g++){for(var v=[],_=0;_<3;_++)v.push(f[p[g*3+_]]);m.push(v)}return function(b,y,x,w,I,S){var E=this._vertexOffset;if(this.bevelSize>0&&this.bevelSegments>0)this._addBevelBar(b,y,x,w,this.bevelSize,this.bevelSegments,I);else{rn.copy(n,y),rn.normalize(n,n),rn.cross(o,x,n),rn.normalize(o,o),rn.cross(r,n,o),rn.normalize(o,o),rn.negate(a,r),rn.negate(s,n),rn.negate(c,o),t(l[0],b,r,w[0]/2),t(l[0],l[0],o,w[2]/2),t(l[1],b,r,w[0]/2),t(l[1],l[1],c,w[2]/2),t(l[2],b,a,w[0]/2),t(l[2],l[2],c,w[2]/2),t(l[3],b,a,w[0]/2),t(l[3],l[3],o,w[2]/2),t(i,b,n,w[1]),t(l[4],i,r,w[0]/2),t(l[4],l[4],o,w[2]/2),t(l[5],i,r,w[0]/2),t(l[5],l[5],c,w[2]/2),t(l[6],i,a,w[0]/2),t(l[6],l[6],c,w[2]/2),t(l[7],i,a,w[0]/2),t(l[7],l[7],o,w[2]/2);var N=this.attributes;if(this.enableNormal){d[0]=r,d[1]=a,d[2]=n,d[3]=s,d[4]=o,d[5]=c;for(var M=this._vertexOffset,P=0;P<h.length;P++){for(var $=this._triangleOffset*3,R=0;R<6;R++)this.indices[$++]=M+p[R];M+=4,this._triangleOffset+=2}for(var P=0;P<h.length;P++)for(var j=d[P],R=0;R<4;R++){var B=h[P][R];N.position.set(this._vertexOffset,l[B]),N.normal.set(this._vertexOffset,j),N.color.set(this._vertexOffset++,I)}}else{for(var P=0;P<m.length;P++){for(var $=this._triangleOffset*3,R=0;R<3;R++)this.indices[$+R]=m[P][R]+this._vertexOffset;this._triangleOffset++}for(var P=0;P<l.length;P++)N.position.set(this._vertexOffset,l[P]),N.color.set(this._vertexOffset++,I)}}for(var te=this._vertexOffset,P=E;P<te;P++)this._dataIndices[P]=S}}(),_addBevelBar:function(){var e=rn.create(),t=rn.create(),i=rn.create(),r=Oie.create(),n=[],o=[1,-1,-1,1],a=[1,1,-1,-1],s=[2,0];return function(c,l,d,u,h,p,m){rn.copy(t,l),rn.normalize(t,t),rn.cross(i,d,t),rn.normalize(i,i),rn.cross(e,t,i),rn.normalize(i,i),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=t[0],r[4]=t[1],r[5]=t[2],r[6]=i[0],r[7]=i[1],r[8]=i[2],h=Math.min(u[0],u[2])/2*h;for(var f=0;f<3;f++)n[f]=Math.max(u[f]-h*2,0);for(var g=(u[0]-n[0])/2,v=(u[1]-n[1])/2,_=(u[2]-n[2])/2,b=[],y=[],x=this._vertexOffset,w=[],f=0;f<2;f++){w[f]=w[f]=[];for(var I=0;I<=p;I++)for(var S=0;S<4;S++){(I===0&&f===0||f===1&&I===p)&&w[f].push(x);for(var E=0;E<=p;E++){var N=E/p*Math.PI/2+Math.PI/2*S,M=I/p*Math.PI/2+Math.PI/2*f;y[0]=g*Math.cos(N)*Math.sin(M),y[1]=v*Math.cos(M),y[2]=_*Math.sin(N)*Math.sin(M),b[0]=y[0]+o[S]*n[0]/2,b[1]=y[1]+v+s[f]*n[1]/2,b[2]=y[2]+a[S]*n[2]/2,Math.abs(g-v)<1e-6&&Math.abs(v-_)<1e-6||(y[0]/=g*g,y[1]/=v*v,y[2]/=_*_),rn.normalize(y,y),rn.transformMat3(b,b,r),rn.transformMat3(y,y,r),rn.add(b,b,c),this.attributes.position.set(x,b),this.enableNormal&&this.attributes.normal.set(x,y),this.attributes.color.set(x,m),x++}}}for(var P=p*4+3,$=p*2+1,R=P+1,S=0;S<$;S++)for(var f=0;f<=P;f++){var j=S*R+f+this._vertexOffset,B=S*R+(f+1)%R+this._vertexOffset,te=(S+1)*R+(f+1)%R+this._vertexOffset,Z=(S+1)*R+f+this._vertexOffset;this.setTriangleIndices(this._triangleOffset++,[te,j,B]),this.setTriangleIndices(this._triangleOffset++,[te,Z,j])}this.setTriangleIndices(this._triangleOffset++,[w[0][0],w[0][2],w[0][1]]),this.setTriangleIndices(this._triangleOffset++,[w[0][0],w[0][3],w[0][2]]),this.setTriangleIndices(this._triangleOffset++,[w[1][0],w[1][1],w[1][2]]),this.setTriangleIndices(this._triangleOffset++,[w[1][0],w[1][2],w[1][3]]),this._vertexOffset=x}}()});Re.defaults(nT.prototype,Rl);Re.defaults(nT.prototype,wf);var zB=nT;var Rie=bi.vec3,UB=gn.extend({type:"bar3D",__ecgl__:!0,init:function(e,t){this.groupGL=new F.Node,this._api=t,this._labelsBuilder=new Ef(256,256,t);var i=this;this._labelsBuilder.getLabelPosition=function(r,n,o){if(i._data){var a=i._data.getItemLayout(r),s=a[0],c=a[1],l=a[2][1];return Rie.scaleAndAdd([],s,c,o+l)}else return[0,0]},this._labelsBuilder.getMesh().renderOrder=100},render:function(e,t,i){var r=this._prevBarMesh;this._prevBarMesh=this._barMesh,this._barMesh=r,this._barMesh||(this._barMesh=new F.Mesh({geometry:new zB,shadowDepthMaterial:new F.Material({shader:new F.Shader(F.Shader.source("ecgl.sm.depth.vertex"),F.Shader.source("ecgl.sm.depth.fragment"))}),culling:e.coordinateSystem.type==="cartesian3D",renderOrder:10,renderNormal:!0})),this.groupGL.remove(this._prevBarMesh),this.groupGL.add(this._barMesh),this.groupGL.add(this._labelsBuilder.getMesh());var n=e.coordinateSystem;if(this._doRender(e,i),n&&n.viewGL){n.viewGL.add(this.groupGL);var o=n.viewGL.isLinearSpace()?"define":"undefine";this._barMesh.material[o]("fragment","SRGB_DECODE")}this._data=e.getData(),this._labelsBuilder.updateData(this._data),this._labelsBuilder.updateLabels(),this._updateAnimation(e)},_updateAnimation:function(e){F.updateVertexAnimation([["prevPosition","position"],["prevNormal","normal"]],this._prevBarMesh,this._barMesh,e)},_doRender:function(e,t){var i=e.getData(),r=e.get("shading"),n=r!=="color",o=this,a=this._barMesh,s="ecgl."+r;(!a.material||a.material.shader.name!==s)&&(a.material=F.createMaterial(s,["VERTEX_COLOR"])),F.setMaterialFromModel(r,a.material,e,t),a.geometry.enableNormal=n,a.geometry.resetOffset();var c=e.get("bevelSize"),l=e.get("bevelSmoothness");a.geometry.bevelSegments=l,a.geometry.bevelSize=c;var d=[],u=new Float32Array(i.count()*4),h=0,g=0,p=!1;i.each(function(_){if(i.hasValue(_)){var b=gr(i,_),y=Er(i,_);y==null&&(y=1),F.parseColor(b,d),d[3]*=y,u[h++]=d[0],u[h++]=d[1],u[h++]=d[2],u[h++]=d[3],d[3]>0&&(g++,d[3]<.99&&(p=!0))}}),a.geometry.setBarCount(g);var m=i.getLayout("orient"),f=this._barIndexOfData=new Int32Array(i.count()),g=0;i.each(function(_){if(!i.hasValue(_)){f[_]=-1;return}var b=i.getItemLayout(_),y=b[0],x=b[1],w=b[2],I=_*4;d[0]=u[I++],d[1]=u[I++],d[2]=u[I++],d[3]=u[I++],d[3]>0&&(o._barMesh.geometry.addBar(y,x,m,w,d,_),f[_]=g++)}),a.geometry.dirty(),a.geometry.updateBoundingBox();var v=a.material;v.transparent=p,v.depthMask=!p,a.geometry.sortTriangles=p,this._initHandler(e,t)},_initHandler:function(e,t){var i=e.getData(),r=this._barMesh,n=e.coordinateSystem.type==="cartesian3D";r.seriesIndex=e.seriesIndex;var o=-1;r.off("mousemove"),r.off("mouseout"),r.on("mousemove",function(a){var s=r.geometry.getDataIndexOfVertex(a.triangle[0]);s!==o&&(this._downplay(o),this._highlight(s),this._labelsBuilder.updateLabels([s]),n&&t.dispatchAction({type:"grid3DShowAxisPointer",value:[i.get("x",s),i.get("y",s),i.get("z",s,!0)]})),o=s,r.dataIndex=s},this),r.on("mouseout",function(a){this._downplay(o),this._labelsBuilder.updateLabels(),o=-1,r.dataIndex=-1,n&&t.dispatchAction({type:"grid3DHideAxisPointer"})},this)},_highlight:function(e){var t=this._data;if(t){var i=this._barIndexOfData[e];if(!(i<0)){var r=t.getItemModel(e),n=r.getModel("emphasis.itemStyle"),o=n.get("color"),a=n.get("opacity");if(o==null){var s=gr(t,e);o=Ml.lift(s,-.4)}a==null&&(a=Er(t,e));var c=F.parseColor(o);c[3]*=a,this._barMesh.geometry.setColor(i,c),this._api.getZr().refresh()}}},_downplay:function(e){var t=this._data;if(t){var i=this._barIndexOfData[e];if(!(i<0)){var r=gr(t,e),n=Er(t,e),o=F.parseColor(r);o[3]*=n,this._barMesh.geometry.setColor(i,o),this._api.getZr().refresh()}}},highlight:function(e,t,i,r){this._toggleStatus("highlight",e,t,i,r)},downplay:function(e,t,i,r){this._toggleStatus("downplay",e,t,i,r)},_toggleStatus:function(e,t,i,r,n){var o=t.getData(),a=St.queryDataIndex(o,n),s=this;a!=null?Re.each(Os.normalizeToArray(a),function(c){e==="highlight"?this._highlight(c):this._downplay(c)},this):o.each(function(c){e==="highlight"?s._highlight(c):s._downplay(c)})},remove:function(){this.groupGL.removeAll()},dispose:function(){this._labelsBuilder.dispose(),this.groupGL.removeAll()}});function HB(e){e.registerChartView(UB),e.registerSeriesModel(VB),iT(e),e.registerProcessor(function(t,i){t.eachSeriesByType("bar3d",function(r){var n=r.getData();n.filterSelf(function(o){return n.hasValue(o)})})})}ji(HB);var Fie=mn.extend({type:"series.line3D",dependencies:["grid3D"],visualStyleAccessPath:"lineStyle",visualDrawType:"stroke",getInitialData:function(e,t){return Od(this)},formatTooltip:function(e){return Ll(this,e)},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,grid3DIndex:0,lineStyle:{width:2},animationDurationUpdate:500}}),jB=Fie;function GB(e,t,i,r,n,o,a){if(n===0)return!1;var s=n,c=0,l=e;if(a>t+s&&a>r+s||a<t-s&&a<r-s||o>e+s&&o>i+s||o<e-s&&o<i-s)return!1;if(e!==i)c=(t-r)/(e-i),l=(e*r-i*t)/(e-i);else return Math.abs(o-e)<=s/2;var d=c*o-a+l,u=d*d/(c*c+1);return u<=s/2*s/2}var Bie=bi.vec3;F.Shader.import(Id);var $B=gn.extend({type:"line3D",__ecgl__:!0,init:function(e,t){this.groupGL=new F.Node,this._api=t},render:function(e,t,i){var r=this._prevLine3DMesh;this._prevLine3DMesh=this._line3DMesh,this._line3DMesh=r,this._line3DMesh||(this._line3DMesh=new F.Mesh({geometry:new Aa({useNativeLine:!1,sortTriangles:!0}),material:new F.Material({shader:F.createShader("ecgl.meshLines3D")}),renderOrder:10}),this._line3DMesh.geometry.pick=this._pick.bind(this)),this.groupGL.remove(this._prevLine3DMesh),this.groupGL.add(this._line3DMesh);var n=e.coordinateSystem;if(n&&n.viewGL){n.viewGL.add(this.groupGL);var o=n.viewGL.isLinearSpace()?"define":"undefine";this._line3DMesh.material[o]("fragment","SRGB_DECODE")}this._doRender(e,i),this._data=e.getData(),this._camera=n.viewGL.camera,this.updateCamera(),this._updateAnimation(e)},updateCamera:function(){this._updateNDCPosition()},_doRender:function(e,t){var i=e.getData(),r=this._line3DMesh;r.geometry.resetOffset();var n=i.getLayout("points"),o=[],a=new Float32Array(n.length/3*4),s=0,c=!1;i.each(function(u){var h=gr(i,u),p=Er(i,u);p==null&&(p=1),F.parseColor(h,o),o[3]*=p,a[s++]=o[0],a[s++]=o[1],a[s++]=o[2],a[s++]=o[3],o[3]<.99&&(c=!0)}),r.geometry.setVertexCount(r.geometry.getPolylineVertexCount(n)),r.geometry.setTriangleCount(r.geometry.getPolylineTriangleCount(n)),r.geometry.addPolyline(n,a,St.firstNotNull(e.get("lineStyle.width"),1)),r.geometry.dirty(),r.geometry.updateBoundingBox();var l=r.material;l.transparent=c,l.depthMask=!c;var d=e.getModel("debug.wireframe");d.get("show")?(r.geometry.createAttribute("barycentric","float",3),r.geometry.generateBarycentric(),r.material.set("both","WIREFRAME_TRIANGLE"),r.material.set("wireframeLineColor",F.parseColor(d.get("lineStyle.color")||"rgba(0,0,0,0.5)")),r.material.set("wireframeLineWidth",St.firstNotNull(d.get("lineStyle.width"),1))):r.material.set("both","WIREFRAME_TRIANGLE"),this._points=n,this._initHandler(e,t)},_updateAnimation:function(e){F.updateVertexAnimation([["prevPosition","position"],["prevPositionPrev","positionPrev"],["prevPositionNext","positionNext"]],this._prevLine3DMesh,this._line3DMesh,e)},_initHandler:function(e,t){var i=e.getData(),r=e.coordinateSystem,n=this._line3DMesh,o=-1;n.seriesIndex=e.seriesIndex,n.off("mousemove"),n.off("mouseout"),n.on("mousemove",function(a){var s=r.pointToData(a.point.array),c=i.indicesOfNearest("x",s[0])[0];c!==o&&(t.dispatchAction({type:"grid3DShowAxisPointer",value:[i.get("x",c),i.get("y",c),i.get("z",c)]}),n.dataIndex=c),o=c},this),n.on("mouseout",function(a){o=-1,n.dataIndex=-1,t.dispatchAction({type:"grid3DHideAxisPointer"})},this)},_updateNDCPosition:function(){var e=new ct,t=this._camera;ct.multiply(e,t.projectionMatrix,t.viewMatrix);var i=this._positionNDC,r=this._points,n=r.length/3;(!i||i.length/2!==n)&&(i=this._positionNDC=new Float32Array(n*2));for(var o=[],a=0;a<n;a++){var s=a*3,c=a*2;o[0]=r[s],o[1]=r[s+1],o[2]=r[s+2],o[3]=1,Bie.transformMat4(o,o,e.array),i[c]=o[0]/o[3],i[c+1]=o[1]/o[3]}},_pick:function(e,t,i,r,n,o){var a=this._positionNDC,s=this._data.hostModel,c=s.get("lineStyle.width"),l=-1,d=i.viewport.width,u=i.viewport.height,h=d*.5,p=u*.5;e=(e+1)*h,t=(t+1)*p;for(var m=1;m<a.length/2;m++){var f=(a[(m-1)*2]+1)*h,g=(a[(m-1)*2+1]+1)*p,v=(a[m*2]+1)*h,_=(a[m*2+1]+1)*p;if(GB(f,g,v,_,c,e,t)){var b=(f-e)*(f-e)+(g-t)*(g-t),y=(v-e)*(v-e)+(_-t)*(_-t);l=b<y?m-1:m}}if(l>=0){var x=l*3,w=new Fe(this._points[x],this._points[x+1],this._points[x+2]);o.push({dataIndex:l,point:w,pointWorld:w.clone(),target:this._line3DMesh,distance:this._camera.getWorldPosition().dist(w)})}},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}});function WB(e){e.registerChartView($B),e.registerSeriesModel(jB),e.registerLayout(function(t,i){t.eachSeriesByType("line3D",function(r){var n=r.getData(),o=r.coordinateSystem;if(o){if(o.type!=="cartesian3D")return;var a=new Float32Array(n.count()*3),s=[],c=[],l=o.dimensions,d=l.map(function(u){return r.coordDimToDataDim(u)[0]});o&&n.each(d,function(u,h,p,m){s[0]=u,s[1]=h,s[2]=p,o.dataToPoint(s,c),a[m*3]=c[0],a[m*3+1]=c[1],a[m*3+2]=c[2]}),n.setLayout("points",a)}})})}ji(WB);var qB=mn.extend({type:"series.scatter3D",dependencies:["globe","grid3D","geo3D"],visualStyleAccessPath:"itemStyle",hasSymbolVisual:!0,getInitialData:function(e,t){return Od(this)},getFormattedLabel:function(e,t,i,r){var n=Os.getFormattedLabel(this,e,t,i,r);if(n==null){var o=this.getData(),a=o.dimensions[o.dimensions.length-1];n=o.get(a,e)}return n},formatTooltip:function(e){return Ll(this,e)},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,progressive:1e5,progressiveThreshold:1e5,grid3DIndex:0,globeIndex:0,symbol:"circle",symbolSize:10,blendMode:"source-over",label:{show:!1,position:"right",distance:5,textStyle:{fontSize:14,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:3}},itemStyle:{opacity:.8},emphasis:{label:{show:!0}},animationDurationUpdate:500}});function oT(e,r,i){var r=r||document.createElement("canvas");r.width=e,r.height=e;var n=r.getContext("2d");return i&&i(n),r}function Vie(e,t,i,r){Re.isArray(t)||(t=[t,t]);var n=aT.getMarginByStyle(i,r),o=t[0]+n.left+n.right,a=t[1]+n.top+n.bottom,s=yr.createSymbol(e,0,0,t[0],t[1]),c=Math.max(o,a);s.x=n.left,s.y=n.top,o>a?s.y+=(c-a)/2:s.x+=(c-o)/2;var l=s.getBoundingRect();return s.x-=l.x,s.y-=l.y,s.setStyle(i),s.update(),s.__size=c,s}function zie(e,t,i){var r=t.width,n=t.height,o=e.canvas.width,a=e.canvas.height,s=r/o,c=n/a;function l(v){return v<128?1:-1}function d(v,_){var b=1/0;v=Math.floor(v*s),_=Math.floor(_*c);for(var y=_*r+v,x=t.data[y*4],w=l(x),I=Math.max(_-i,0);I<Math.min(_+i,n);I++)for(var S=Math.max(v-i,0);S<Math.min(v+i,r);S++){var y=I*r+S,E=t.data[y*4],N=l(E),M=S-v,P=I-_;if(w!==N){var $=M*M+P*P;$<b&&(b=$)}}return w*Math.sqrt(b)}for(var u=e.createImageData(o,a),h=0;h<a;h++)for(var p=0;p<o;p++){var m=d(p,h),f=m/i*.5+.5,g=(h*o+p)*4;u.data[g++]=(1-f)*255,u.data[g++]=(1-f)*255,u.data[g++]=(1-f)*255,u.data[g++]=255}return u}var aT={getMarginByStyle:function(e){var t=e.minMargin||0,i=0;e.stroke&&e.stroke!=="none"&&(i=e.lineWidth==null?1:e.lineWidth);var r=e.shadowBlur||0,n=e.shadowOffsetX||0,o=e.shadowOffsetY||0,a={};return a.left=Math.max(i/2,-n+r,t),a.right=Math.max(i/2,n+r,t),a.top=Math.max(i/2,-o+r,t),a.bottom=Math.max(i/2,o+r,t),a},createSymbolSprite:function(e,t,i,r){var n=Vie(e,t,i),o=aT.getMarginByStyle(i);return{image:oT(n.__size,r,function(a){Wb(a,n)}),margin:o}},createSDFFromCanvas:function(e,t,i,r){return oT(t,r,function(n){var o=e.getContext("2d"),a=o.getImageData(0,0,e.width,e.height);n.putImageData(zie(n,a,i),0,0)})},createSimpleSprite:function(e,t){return oT(e,t,function(i){var r=e/2;i.beginPath(),i.arc(r,r,60,0,Math.PI*2,!1),i.closePath();var n=i.createRadialGradient(r,r,0,r,r,r);n.addColorStop(0,"rgba(255, 255, 255, 1)"),n.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),n.addColorStop(1,"rgba(255, 255, 255, 0)"),i.fillStyle=n,i.fill()})}},sT=aT;var XB=bi.vec3,YB={needsSortVertices:function(){return this.sortVertices},needsSortVerticesProgressively:function(){return this.needsSortVertices()&&this.vertexCount>=2e4},doSortVertices:function(e,t){var i=this.indices,r=XB.create();if(!i){i=this.indices=this.vertexCount>65535?new Uint32Array(this.vertexCount):new Uint16Array(this.vertexCount);for(var n=0;n<i.length;n++)i[n]=n}if(t===0){var o=this.attributes.position,e=e.array,a=0;(!this._zList||this._zList.length!==this.vertexCount)&&(this._zList=new Float32Array(this.vertexCount));for(var s,n=0;n<this.vertexCount;n++){o.get(n,r);var c=XB.sqrDist(r,e);isNaN(c)&&(c=1e7,a++),n===0?(s=c,c=0):c=c-s,this._zList[n]=c}this._noneCount=a}if(this.vertexCount<2e4)t===0&&this._simpleSort(this._noneCount/this.vertexCount>.05);else for(var n=0;n<3;n++)this._progressiveQuickSort(t*3+n);this.dirtyIndices()},_simpleSort:function(e){var t=this._zList,i=this.indices;function r(n,o){return t[o]-t[n]}e?Array.prototype.sort.call(i,r):yf.sort(i,r,0,i.length-1)},_progressiveQuickSort:function(e){var t=this._zList,i=this.indices;this._quickSort=this._quickSort||new yf,this._quickSort.step(i,function(r,n){return t[n]-t[r]},e)}};var ZB=`@export ecgl.sdfSprite.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform float elapsedTime : 0;

attribute vec3 position : POSITION;

#ifdef VERTEX_SIZE
attribute float size;
#else
uniform float u_Size;
#endif

#ifdef VERTEX_COLOR
attribute vec4 a_FillColor: COLOR;
varying vec4 v_Color;
#endif

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
attribute float prevSize;
uniform float percent : 1.0;
#endif


#ifdef POSITIONTEXTURE_ENABLED
uniform sampler2D positionTexture;
#endif

varying float v_Size;

void main()
{

#ifdef POSITIONTEXTURE_ENABLED
 gl_Position = worldViewProjection * vec4(texture2D(positionTexture, position.xy).xy, -10.0, 1.0);
#else

 #ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
 #else
 vec3 pos = position;
 #endif
 gl_Position = worldViewProjection * vec4(pos, 1.0);
#endif

#ifdef VERTEX_SIZE
#ifdef VERTEX_ANIMATION
 v_Size = mix(prevSize, size, percent);
#else
 v_Size = size;
#endif
#else
 v_Size = u_Size;
#endif

#ifdef VERTEX_COLOR
 v_Color = a_FillColor;
 #endif

 gl_PointSize = v_Size;
}

@end

@export ecgl.sdfSprite.fragment

uniform vec4 color: [1, 1, 1, 1];
uniform vec4 strokeColor: [1, 1, 1, 1];
uniform float smoothing: 0.07;

uniform float lineWidth: 0.0;

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif

varying float v_Size;

uniform sampler2D sprite;

@import clay.util.srgb

void main()
{
 gl_FragColor = color;

 vec4 _strokeColor = strokeColor;

#ifdef VERTEX_COLOR
 gl_FragColor *= v_Color;
 #endif

#ifdef SPRITE_ENABLED
 float d = texture2D(sprite, gl_PointCoord).r;
 gl_FragColor.a *= smoothstep(0.5 - smoothing, 0.5 + smoothing, d);

 if (lineWidth > 0.0) {
 float sLineWidth = lineWidth / 2.0;

 float outlineMaxValue0 = 0.5 + sLineWidth;
 float outlineMaxValue1 = 0.5 + sLineWidth + smoothing;
 float outlineMinValue0 = 0.5 - sLineWidth - smoothing;
 float outlineMinValue1 = 0.5 - sLineWidth;

 if (d <= outlineMaxValue1 && d >= outlineMinValue0) {
 float a = _strokeColor.a;
 if (d <= outlineMinValue1) {
 a = a * smoothstep(outlineMinValue0, outlineMinValue1, d);
 }
 else {
 a = a * smoothstep(outlineMaxValue1, outlineMaxValue0, d);
 }
 gl_FragColor.rgb = mix(gl_FragColor.rgb * gl_FragColor.a, _strokeColor.rgb, a);
 gl_FragColor.a = gl_FragColor.a * (1.0 - a) + a;
 }
 }
#endif

#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(gl_FragColor);
#endif
}
@end`;var lT=bi.vec4;F.Shader.import(ZB);var Uie=F.Mesh.extend(function(){var e=new F.Geometry({dynamic:!0,attributes:{color:new F.Geometry.Attribute("color","float",4,"COLOR"),position:new F.Geometry.Attribute("position","float",3,"POSITION"),size:new F.Geometry.Attribute("size","float",1),prevPosition:new F.Geometry.Attribute("prevPosition","float",3),prevSize:new F.Geometry.Attribute("prevSize","float",1)}});Object.assign(e,YB);var t=new F.Material({shader:F.createShader("ecgl.sdfSprite"),transparent:!0,depthMask:!1});t.enableTexture("sprite"),t.define("both","VERTEX_COLOR"),t.define("both","VERTEX_SIZE");var i=new F.Texture2D({image:document.createElement("canvas"),flipY:!1});return t.set("sprite",i),e.pick=this._pick.bind(this),{geometry:e,material:t,mode:F.Mesh.POINTS,sizeScale:1}},{_pick:function(e,t,i,r,n,o){var a=this._positionNDC;if(a)for(var s=i.viewport,c=2/s.width,l=2/s.height,d=this.geometry.vertexCount-1;d>=0;d--){var u;this.geometry.indices?u=this.geometry.indices[d]:u=d;var h=a[u*2],p=a[u*2+1],m=this.geometry.attributes.size.get(u)/this.sizeScale,f=m/2;if(e>h-f*c&&e<h+f*c&&t>p-f*l&&t<p+f*l){var g=new F.Vector3,v=new F.Vector3;this.geometry.attributes.position.get(u,g.array),F.Vector3.transformMat4(v,g,this.worldTransform),o.push({vertexIndex:u,point:g,pointWorld:v,target:this,distance:v.distance(r.getWorldPosition())})}}},updateNDCPosition:function(e,t,i){var r=this._positionNDC,n=this.geometry;(!r||r.length/2!==n.vertexCount)&&(r=this._positionNDC=new Float32Array(n.vertexCount*2));for(var o=lT.create(),a=0;a<n.vertexCount;a++)n.attributes.position.get(a,o),o[3]=1,lT.transformMat4(o,o,e.array),lT.scale(o,o,1/o[3]),r[a*2]=o[0],r[a*2+1]=o[1]}}),KB=Uie;var QB=20,JB=-10;function Hie(e,t){return e&&t&&e[0]===t[0]&&e[1]===t[1]}function cT(e,t){this.rootNode=new F.Node,this.is2D=e,this._labelsBuilder=new Ef(256,256,t),this._labelsBuilder.getMesh().renderOrder=100,this.rootNode.add(this._labelsBuilder.getMesh()),this._api=t,this._spriteImageCanvas=document.createElement("canvas"),this._startDataIndex=0,this._endDataIndex=0,this._sizeScale=1}cT.prototype={constructor:cT,highlightOnMouseover:!0,update:function(e,t,i,r,n){var o=this._prevMesh;this._prevMesh=this._mesh,this._mesh=o;var a=e.getData();if(r==null&&(r=0),n==null&&(n=a.count()),this._startDataIndex=r,this._endDataIndex=n-1,!this._mesh){var s=this._prevMesh&&this._prevMesh.material;this._mesh=new KB({renderOrder:10,frustumCulling:!1}),s&&(this._mesh.material=s)}var s=this._mesh.material,c=this._mesh.geometry,l=c.attributes;this.rootNode.remove(this._prevMesh),this.rootNode.add(this._mesh),this._setPositionTextureToMesh(this._mesh,this._positionTexture);var d=this._getSymbolInfo(e,r,n),u=i.getDevicePixelRatio(),h=e.getModel("itemStyle").getItemStyle(),p=e.get("large"),m=1;d.maxSize>2?(m=this._updateSymbolSprite(e,h,d,u),s.enableTexture("sprite")):s.disableTexture("sprite"),l.position.init(n-r);var f=[];if(p){s.undefine("VERTEX_SIZE"),s.undefine("VERTEX_COLOR");var g=tB(a),v=iB(a);F.parseColor(g,f),f[3]*=v,s.set({color:f,u_Size:d.maxSize*this._sizeScale})}else s.set({color:[1,1,1,1]}),s.define("VERTEX_SIZE"),s.define("VERTEX_COLOR"),l.size.init(n-r),l.color.init(n-r),this._originalOpacity=new Float32Array(n-r);for(var _=a.getLayout("points"),b=l.position.value,y=!1,x=0;x<n-r;x++){var w=x*3,I=x*2;if(this.is2D?(b[w]=_[I],b[w+1]=_[I+1],b[w+2]=JB):(b[w]=_[w],b[w+1]=_[w+1],b[w+2]=_[w+2]),!p){var g=gr(a,x),v=Er(a,x);F.parseColor(g,f),f[3]*=v,l.color.set(x,f),f[3]<.99&&(y=!0);var S=a.getItemVisual(x,"symbolSize");S=S instanceof Array?Math.max(S[0],S[1]):S,isNaN(S)&&(S=0),l.size.value[x]=S*m*this._sizeScale,this._originalOpacity[x]=f[3]}}this._mesh.sizeScale=m,c.updateBoundingBox(),c.dirty(),this._updateMaterial(e,h);var E=e.coordinateSystem;if(E&&E.viewGL){var N=E.viewGL.isLinearSpace()?"define":"undefine";s[N]("fragment","SRGB_DECODE")}p||this._updateLabelBuilder(e,r,n),this._updateHandler(e,t,i),this._updateAnimation(e),this._api=i},getPointsMesh:function(){return this._mesh},updateLabels:function(e){this._labelsBuilder.updateLabels(e)},hideLabels:function(){this.rootNode.remove(this._labelsBuilder.getMesh())},showLabels:function(){this.rootNode.add(this._labelsBuilder.getMesh())},dispose:function(){this._labelsBuilder.dispose()},_updateSymbolSprite:function(e,t,i,r){i.maxSize=Math.min(i.maxSize*2,200);var n=[];return i.aspect>1?(n[0]=i.maxSize,n[1]=i.maxSize/i.aspect):(n[1]=i.maxSize,n[0]=i.maxSize*i.aspect),n[0]=n[0]||1,n[1]=n[1]||1,(this._symbolType!==i.type||!Hie(this._symbolSize,n)||this._lineWidth!==t.lineWidth)&&(sT.createSymbolSprite(i.type,n,{fill:"#fff",lineWidth:t.lineWidth,stroke:"transparent",shadowColor:"transparent",minMargin:Math.min(n[0]/2,10)},this._spriteImageCanvas),sT.createSDFFromCanvas(this._spriteImageCanvas,Math.min(this._spriteImageCanvas.width,32),QB,this._mesh.material.get("sprite").image),this._symbolType=i.type,this._symbolSize=n,this._lineWidth=t.lineWidth),this._spriteImageCanvas.width/i.maxSize*r},_updateMaterial:function(e,t){var i=e.get("blendMode")==="lighter"?F.additiveBlend:null,r=this._mesh.material;r.blend=i,r.set("lineWidth",t.lineWidth/QB);var n=F.parseColor(t.stroke);r.set("strokeColor",n),r.transparent=!0,r.depthMask=!1,r.depthTest=!this.is2D,r.sortVertices=!this.is2D},_updateLabelBuilder:function(e,a,i){var r=e.getData(),n=this._mesh.geometry,o=n.attributes.position.value,a=this._startDataIndex,s=this._mesh.sizeScale;this._labelsBuilder.updateData(r,a,i),this._labelsBuilder.getLabelPosition=function(c,l,d){var u=(c-a)*3;return[o[u],o[u+1],o[u+2]]},this._labelsBuilder.getLabelDistance=function(c,l,d){var u=n.attributes.size.get(c-a)/s;return u/2+d},this._labelsBuilder.updateLabels()},_updateAnimation:function(e){F.updateVertexAnimation([["prevPosition","position"],["prevSize","size"]],this._prevMesh,this._mesh,e)},_updateHandler:function(e,t,i){var r=e.getData(),n=this._mesh,o=this,a=-1,s=e.coordinateSystem&&e.coordinateSystem.type==="cartesian3D",c;s&&(c=e.coordinateSystem.model),n.seriesIndex=e.seriesIndex,n.off("mousemove"),n.off("mouseout"),n.on("mousemove",function(l){var d=l.vertexIndex+o._startDataIndex;d!==a&&(this.highlightOnMouseover&&(this.downplay(r,a),this.highlight(r,d),this._labelsBuilder.updateLabels([d])),s&&i.dispatchAction({type:"grid3DShowAxisPointer",value:[r.get(e.coordDimToDataDim("x")[0],d),r.get(e.coordDimToDataDim("y")[0],d),r.get(e.coordDimToDataDim("z")[0],d)],grid3DIndex:c.componentIndex})),n.dataIndex=d,a=d},this),n.on("mouseout",function(l){var d=l.vertexIndex+o._startDataIndex;this.highlightOnMouseover&&(this.downplay(r,d),this._labelsBuilder.updateLabels()),a=-1,n.dataIndex=-1,s&&i.dispatchAction({type:"grid3DHideAxisPointer",grid3DIndex:c.componentIndex})},this)},updateLayout:function(e,t,i){var r=e.getData();if(this._mesh){var n=this._mesh.geometry.attributes.position.value,o=r.getLayout("points");if(this.is2D)for(var a=0;a<o.length/2;a++){var s=a*3,c=a*2;n[s]=o[c],n[s+1]=o[c+1],n[s+2]=JB}else for(var a=0;a<o.length;a++)n[a]=o[a];this._mesh.geometry.dirty(),i.getZr().refresh()}},updateView:function(e){if(this._mesh){var t=new ct;ct.mul(t,e.viewMatrix,this._mesh.worldTransform),ct.mul(t,e.projectionMatrix,t),this._mesh.updateNDCPosition(t,this.is2D,this._api)}},highlight:function(e,t){if(!(t>this._endDataIndex||t<this._startDataIndex)){var i=e.getItemModel(t),r=i.getModel("emphasis.itemStyle"),n=r.get("color"),o=r.get("opacity");if(n==null){var a=gr(e,t);n=Ml.lift(a,-.4)}o==null&&(o=Er(e,t));var s=F.parseColor(n);s[3]*=o,this._mesh.geometry.attributes.color.set(t-this._startDataIndex,s),this._mesh.geometry.dirtyAttribute("color"),this._api.getZr().refresh()}},downplay:function(e,t){if(!(t>this._endDataIndex||t<this._startDataIndex)){var i=gr(e,t),r=Er(e,t),n=F.parseColor(i);n[3]*=r,this._mesh.geometry.attributes.color.set(t-this._startDataIndex,n),this._mesh.geometry.dirtyAttribute("color"),this._api.getZr().refresh()}},fadeOutAll:function(e){if(this._originalOpacity){for(var t=this._mesh.geometry,i=0;i<t.vertexCount;i++){var r=this._originalOpacity[i]*e;t.attributes.color.value[i*4+3]=r}t.dirtyAttribute("color"),this._api.getZr().refresh()}},fadeInAll:function(){this.fadeOutAll(1)},setPositionTexture:function(e){this._mesh&&this._setPositionTextureToMesh(this._mesh,e),this._positionTexture=e},removePositionTexture:function(){this._positionTexture=null,this._mesh&&this._setPositionTextureToMesh(this._mesh,null)},setSizeScale:function(e){if(e!==this._sizeScale){if(this._mesh){var t=this._mesh.material.get("u_Size");this._mesh.material.set("u_Size",t/this._sizeScale*e);var i=this._mesh.geometry.attributes;if(i.size.value)for(var r=0;r<i.size.value.length;r++)i.size.value[r]=i.size.value[r]/this._sizeScale*e}this._sizeScale=e}},_setPositionTextureToMesh:function(e,t){t&&e.material.set("positionTexture",t),e.material[t?"enableTexture":"disableTexture"]("positionTexture")},_getSymbolInfo:function(e,t,i){if(e.get("large")){var r=St.firstNotNull(e.get("symbolSize"),1),l,o;return r instanceof Array?(l=Math.max(r[0],r[1]),o=r[0]/r[1]):(l=r,o=1),{maxSize:r,type:e.get("symbol"),aspect:o}}for(var n=e.getData(),o,a=!1,s=n.getItemVisual(0,"symbol")||"circle",c=!1,l=0,d=t;d<i;d++){var r=n.getItemVisual(d,"symbolSize"),u=n.getItemVisual(d,"symbol"),h;if(r instanceof Array)h=r[0]/r[1],l=Math.max(Math.max(r[0],r[1]),l);else{if(isNaN(r))continue;h=1,l=Math.max(r,l)}s=u,o=h}return{maxSize:l,type:s,aspect:o}}};var Rd=cT;var e5=gn.extend({type:"scatter3D",hasSymbolVisual:!0,__ecgl__:!0,init:function(e,t){this.groupGL=new F.Node,this._pointsBuilderList=[],this._currentStep=0},render:function(e,t,i){if(this.groupGL.removeAll(),!!e.getData().count()){var r=e.coordinateSystem;if(r&&r.viewGL){r.viewGL.add(this.groupGL),this._camera=r.viewGL.camera;var n=this._pointsBuilderList[0];n||(n=this._pointsBuilderList[0]=new Rd(!1,i)),this._pointsBuilderList.length=1,this.groupGL.add(n.rootNode),n.update(e,t,i),n.updateView(r.viewGL.camera)}}},incrementalPrepareRender:function(e,t,i){var r=e.coordinateSystem;r&&r.viewGL&&(r.viewGL.add(this.groupGL),this._camera=r.viewGL.camera),this.groupGL.removeAll(),this._currentStep=0},incrementalRender:function(e,t,i,r){if(!(e.end<=e.start)){var n=this._pointsBuilderList[this._currentStep];n||(n=new Rd(!1,r),this._pointsBuilderList[this._currentStep]=n),this.groupGL.add(n.rootNode),n.update(t,i,r,e.start,e.end),n.updateView(t.coordinateSystem.viewGL.camera),this._currentStep++}},updateCamera:function(){this._pointsBuilderList.forEach(function(e){e.updateView(this._camera)},this)},highlight:function(e,t,i,r){this._toggleStatus("highlight",e,t,i,r)},downplay:function(e,t,i,r){this._toggleStatus("downplay",e,t,i,r)},_toggleStatus:function(e,t,i,r,n){var o=t.getData(),a=St.queryDataIndex(o,n),s=e==="highlight";a!=null?Re.each(Os.normalizeToArray(a),function(c){for(var l=0;l<this._pointsBuilderList.length;l++){var d=this._pointsBuilderList[l];s?d.highlight(o,c):d.downplay(o,c)}},this):o.each(function(c){for(var l=0;l<this._pointsBuilderList.length;l++){var d=this._pointsBuilderList[l];s?d.highlight(o,c):d.downplay(o,c)}})},dispose:function(){this._pointsBuilderList.forEach(function(e){e.dispose()}),this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}});function t5(e){e.registerChartView(e5),e.registerSeriesModel(qB),e.registerLayout({seriesType:"scatter3D",reset:function(t){var i=t.coordinateSystem;if(i){var r=i.dimensions;if(r.length<3)return;var n=r.map(function(s){return t.coordDimToDataDim(s)[0]}),o=[],a=[];return{progress:function(s,c){for(var l=new Float32Array((s.end-s.start)*3),d=s.start;d<s.end;d++){var u=(d-s.start)*3;o[0]=c.get(n[0],d),o[1]=c.get(n[1],d),o[2]=c.get(n[2],d),i.dataToPoint(o,a),l[u]=a[0],l[u+1]=a[1],l[u+2]=a[2]}c.setLayout("points",l)}}}}})}ji(t5);var Nn=bi.vec3,i5=bi.vec2,Dc=Nn.normalize,Tx=Nn.cross,r5=Nn.sub,dT=Nn.add,Bd=Nn.create,Fd=Bd(),Rs=Bd(),Ld=Bd(),Ev=Bd(),n5=[],o5=[];function jie(e,t){i5.copy(n5,e[0]),i5.copy(o5,e[1]);var i=[],r=i[0]=Bd(),n=i[1]=Bd(),o=i[2]=Bd(),a=i[3]=Bd();t.dataToPoint(n5,r),t.dataToPoint(o5,a),Dc(Fd,r),r5(Rs,a,r),Dc(Rs,Rs),Tx(Ld,Rs,Fd),Dc(Ld,Ld),Tx(Rs,Fd,Ld),dT(n,Fd,Rs),Dc(n,n),Dc(Fd,a),r5(Rs,r,a),Dc(Rs,Rs),Tx(Ld,Rs,Fd),Dc(Ld,Ld),Tx(Rs,Fd,Ld),dT(o,Fd,Rs),Dc(o,o),dT(Ev,r,a),Dc(Ev,Ev);var s=Nn.dot(r,Ev),c=Nn.dot(Ev,n),l=(Math.max(Nn.len(r),Nn.len(a))-s)/c*2;return Nn.scaleAndAdd(n,r,n,l),Nn.scaleAndAdd(o,a,o,l),i}function Gie(e,t,i){var r=[],n=r[0]=Nn.create(),o=r[1]=Nn.create(),a=r[2]=Nn.create(),s=r[3]=Nn.create();t.dataToPoint(e[0],n),t.dataToPoint(e[1],s);var c=Nn.dist(n,s);return Nn.lerp(o,n,s,.3),Nn.lerp(a,n,s,.3),Nn.scaleAndAdd(o,o,i,Math.min(c*.1,10)),Nn.scaleAndAdd(a,a,i,Math.min(c*.1,10)),r}function s5(e,t){for(var i=new Float32Array(e.length*3),r=0,n=[],o=0;o<e.length;o++)t.dataToPoint(e[o],n),i[r++]=n[0],i[r++]=n[1],i[r++]=n[2];return i}function l5(e){var t=[];return e.each(function(i){var r=e.getItemModel(i),n=r.option instanceof Array?r.option:r.getShallow("coords",!0);t.push(n)}),{coordsList:t}}function $ie(e,t){var i=e.getData(),r=e.get("polyline");i.setLayout("lineType",r?"polyline":"cubicBezier");var n=l5(i);i.each(function(o){var a=n.coordsList[o],s=r?s5:jie;i.setItemLayout(o,s(a,t))})}function a5(e,t,i){var r=e.getData(),n=e.get("polyline"),o=l5(r);r.setLayout("lineType",n?"polyline":"cubicBezier"),r.each(function(a){var s=o.coordsList[a],c=n?s5(s,t):Gie(s,t,i);r.setItemLayout(a,c)})}function uT(e,t){e.eachSeriesByType("lines3D",function(i){var r=i.coordinateSystem;r.type==="globe"?$ie(i,r):r.type==="geo3D"?a5(i,r,[0,1,0]):(r.type==="mapbox3D"||r.type==="maptalks3D")&&a5(i,r,[0,0,1])})}var c5=mn.extend({type:"series.lines3D",dependencies:["globe"],visualStyleAccessPath:"lineStyle",visualDrawType:"stroke",getInitialData:function(e,t){var i=new Ln(["value"],this);return i.hasItemOption=!1,i.initData(e.data,[],function(r,n,o,a){if(r instanceof Array)return NaN;i.hasItemOption=!0;var s=r.value;if(s!=null)return s instanceof Array?s[a]:s}),i},defaultOption:{coordinateSystem:"globe",globeIndex:0,geo3DIndex:0,zlevel:-10,polyline:!1,effect:{show:!1,period:4,trailWidth:4,trailLength:.2,spotIntensity:6},silent:!0,blendMode:"source-over",lineStyle:{width:1,opacity:.5}}});var d5=`@export ecgl.trail2.vertex
attribute vec3 position: POSITION;
attribute vec3 positionPrev;
attribute vec3 positionNext;
attribute float offset;
attribute float dist;
attribute float distAll;
attribute float start;

attribute vec4 a_Color : COLOR;

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;
uniform float near : NEAR;

uniform float speed : 0;
uniform float trailLength: 0.3;
uniform float time;
uniform float period: 1000;

uniform float spotSize: 1;

varying vec4 v_Color;
varying float v_Percent;
varying float v_SpotPercent;

@import ecgl.common.wireframe.vertexHeader

@import ecgl.lines3D.clipNear

void main()
{
 @import ecgl.lines3D.expandLine

 gl_Position = currProj;

 v_Color = a_Color;

 @import ecgl.common.wireframe.vertexMain

#ifdef CONSTANT_SPEED
 float t = mod((speed * time + start) / distAll, 1. + trailLength) - trailLength;
#else
 float t = mod((time + start) / period, 1. + trailLength) - trailLength;
#endif

 float trailLen = distAll * trailLength;

 v_Percent = (dist - t * distAll) / trailLen;

 v_SpotPercent = spotSize / distAll;

 }
@end


@export ecgl.trail2.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
uniform float spotIntensity: 5;

varying vec4 v_Color;
varying float v_Percent;
varying float v_SpotPercent;

@import ecgl.common.wireframe.fragmentHeader

@import clay.util.srgb

void main()
{
 if (v_Percent > 1.0 || v_Percent < 0.0) {
 discard;
 }

 float fade = v_Percent;

#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color * v_Color);
#else
 gl_FragColor = color * v_Color;
#endif

 @import ecgl.common.wireframe.fragmentMain

 if (v_Percent > (1.0 - v_SpotPercent)) {
 gl_FragColor.rgb *= spotIntensity;
 }

 gl_FragColor.a *= fade;
}

@end`;var u5=bi.vec3;function Wie(e){return e>0?1:-1}F.Shader.import(d5);var h5=F.Mesh.extend(function(){var e=new F.Material({shader:new F.Shader(F.Shader.source("ecgl.trail2.vertex"),F.Shader.source("ecgl.trail2.fragment")),transparent:!0,depthMask:!1}),t=new Aa({dynamic:!0});return t.createAttribute("dist","float",1),t.createAttribute("distAll","float",1),t.createAttribute("start","float",1),{geometry:t,material:e,culling:!1,$ignorePicking:!0}},{updateData:function(e,t,i){var r=e.hostModel,n=this.geometry,o=r.getModel("effect"),a=o.get("trailWidth")*t.getDevicePixelRatio(),s=o.get("trailLength"),c=r.get("effect.constantSpeed"),l=r.get("effect.period")*1e3,d=c!=null;d?this.material.set("speed",c/1e3):this.material.set("period",l),this.material[d?"define":"undefine"]("vertex","CONSTANT_SPEED");var u=r.get("polyline");n.trailLength=s,this.material.set("trailLength",s),n.resetOffset(),["position","positionPrev","positionNext"].forEach(function(I){n.attributes[I].value=i.attributes[I].value});var h=["dist","distAll","start","offset","color"];h.forEach(function(I){n.attributes[I].init(n.vertexCount)}),n.indices=i.indices;var p=[],m=o.get("trailColor"),f=o.get("trailOpacity"),g=m!=null,v=f!=null;this.updateWorldTransform();var _=this.worldTransform.x.len(),b=this.worldTransform.y.len(),y=this.worldTransform.z.len(),x=0,w=0;e.each(function(I){var S=e.getItemLayout(I),E=v?f:Er(e,I),N=gr(e,I);E==null&&(E=1),p=F.parseColor(g?m:N,p),p[3]*=E;for(var M=u?i.getPolylineVertexCount(S):i.getCubicCurveVertexCount(S[0],S[1],S[2],S[3]),P=0,$=[],R=[],j=x;j<x+M;j++)n.attributes.position.get(j,$),$[0]*=_,$[1]*=b,$[2]*=y,j>x&&(P+=u5.dist($,R)),n.attributes.dist.set(j,P),u5.copy(R,$);w=Math.max(w,P);for(var B=Math.random()*(d?P:l),j=x;j<x+M;j++)n.attributes.distAll.set(j,P),n.attributes.start.set(j,B),n.attributes.offset.set(j,Wie(i.attributes.offset.get(j))*a/2),n.attributes.color.set(j,p);x+=M}),this.material.set("spotSize",w*.1*s),this.material.set("spotIntensity",o.get("spotIntensity")),n.dirty()},setAnimationTime:function(e){this.material.set("time",e)}});F.Shader.import(Id);function qie(e){return e.radius!=null?e.radius:e.size!=null?Math.max(e.size[0],e.size[1],e.size[2]):100}var p5=gn.extend({type:"lines3D",__ecgl__:!0,init:function(e,t){this.groupGL=new F.Node,this._meshLinesMaterial=new F.Material({shader:F.createShader("ecgl.meshLines3D"),transparent:!0,depthMask:!1}),this._linesMesh=new F.Mesh({geometry:new Aa,material:this._meshLinesMaterial,$ignorePicking:!0}),this._trailMesh=new h5},render:function(e,t,i){this.groupGL.add(this._linesMesh);var r=e.coordinateSystem,n=e.getData();if(r&&r.viewGL){var o=r.viewGL;o.add(this.groupGL),this._updateLines(e,t,i);var a=r.viewGL.isLinearSpace()?"define":"undefine";this._linesMesh.material[a]("fragment","SRGB_DECODE"),this._trailMesh.material[a]("fragment","SRGB_DECODE")}var s=this._trailMesh;if(s.stopAnimation(),e.get("effect.show")){this.groupGL.add(s),s.updateData(n,i,this._linesMesh.geometry),s.__time=s.__time||0;var c=3600*1e3;this._curveEffectsAnimator=s.animate("",{loop:!0}).when(c,{__time:c}).during(function(){s.setAnimationTime(s.__time)}).start()}else this.groupGL.remove(s),this._curveEffectsAnimator=null;this._linesMesh.material.blend=this._trailMesh.material.blend=e.get("blendMode")==="lighter"?F.additiveBlend:null},pauseEffect:function(){this._curveEffectsAnimator&&this._curveEffectsAnimator.pause()},resumeEffect:function(){this._curveEffectsAnimator&&this._curveEffectsAnimator.resume()},toggleEffect:function(){var e=this._curveEffectsAnimator;e&&(e.isPaused()?e.resume():e.pause())},_updateLines:function(e,t,i){var r=e.getData(),n=e.coordinateSystem,o=this._linesMesh.geometry,a=e.get("polyline");o.expandLine=!0;var s=qie(n);o.segmentScale=s/20;var c="lineStyle.width".split("."),l=i.getDevicePixelRatio(),d=0;r.each(function(m){var f=r.getItemModel(m),g=f.get(c);g==null&&(g=1),r.setItemVisual(m,"lineWidth",g),d=Math.max(g,d)}),o.useNativeLine=!1;var u=0,h=0;r.each(function(m){var f=r.getItemLayout(m);a?(u+=o.getPolylineVertexCount(f),h+=o.getPolylineTriangleCount(f)):(u+=o.getCubicCurveVertexCount(f[0],f[1],f[2],f[3]),h+=o.getCubicCurveTriangleCount(f[0],f[1],f[2],f[3]))}),o.setVertexCount(u),o.setTriangleCount(h),o.resetOffset();var p=[];r.each(function(m){var f=r.getItemLayout(m),g=gr(r,m),v=Er(r,m),_=r.getItemVisual(m,"lineWidth")*l;v==null&&(v=1),p=F.parseColor(g,p),p[3]*=v,a?o.addPolyline(f,p,_):o.addCubicCurve(f[0],f[1],f[2],f[3],p,_)}),o.dirty()},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}});function f5(e){e.registerChartView(p5),e.registerSeriesModel(c5),e.registerLayout(uT),e.registerAction({type:"lines3DPauseEffect",event:"lines3deffectpaused",update:"series.lines3D:pauseEffect"},function(){}),e.registerAction({type:"lines3DResumeEffect",event:"lines3deffectresumed",update:"series.lines3D:resumeEffect"},function(){}),e.registerAction({type:"lines3DToggleEffect",event:"lines3deffectchanged",update:"series.lines3D:toggleEffect"},function(){})}ji(f5);function m5(e,t){for(var i=[],r=0;r<t.length;r++)i.push(e.dataToPoint(t[r]));return i}var g5=mn.extend({type:"series.polygons3D",getRegionModel:function(e){return this.getData().getItemModel(e)},getRegionPolygonCoords:function(e){var t=this.coordinateSystem,i=this.getData().getItemModel(e),r=i.option instanceof Array?i.option:i.getShallow("coords");i.get("multiPolygon")||(r=[r]);for(var n=[],o=0;o<r.length;o++){for(var a=[],s=1;s<r[o].length;s++)a.push(m5(t,r[o][s]));n.push({exterior:m5(t,r[o][0]),interiors:a})}return n},getInitialData:function(e){var t=new Ln(["value"],this);return t.hasItemOption=!1,t.initData(e.data,[],function(i,r,n,o){if(i instanceof Array)return NaN;t.hasItemOption=!0;var a=i.value;if(a!=null)return a instanceof Array?a[o]:a}),t},defaultOption:{show:!0,data:null,multiPolygon:!1,progressiveThreshold:1e3,progressive:1e3,zlevel:-10,label:{show:!1,distance:2,textStyle:{fontSize:20,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:4}},itemStyle:{color:"#fff",borderWidth:0,borderColor:"#333"},emphasis:{itemStyle:{color:"#639fc0"},label:{show:!0}}}});Re.merge(g5.prototype,Ps);var v5=g5;var _5=gn.extend({type:"polygons3D",__ecgl__:!0,init:function(e,t){this.groupGL=new F.Node,this._geo3DBuilderList=[],this._currentStep=0},render:function(e,t,i){this.groupGL.removeAll();var r=e.coordinateSystem;r&&r.viewGL&&r.viewGL.add(this.groupGL);var n=this._geo3DBuilderList[0];n||(n=new bh(i),n.extrudeY=r.type!=="mapbox3D"&&r.type!=="maptalks3D",this._geo3DBuilderList[0]=n),this._updateShaderDefines(r,n),n.update(e,t,i),this._geo3DBuilderList.length=1,this.groupGL.add(n.rootNode)},incrementalPrepareRender:function(e,t,i){this.groupGL.removeAll();var r=e.coordinateSystem;r&&r.viewGL&&r.viewGL.add(this.groupGL),this._currentStep=0},incrementalRender:function(e,t,i,r){var n=this._geo3DBuilderList[this._currentStep],o=t.coordinateSystem;n||(n=new bh(r),n.extrudeY=o.type!=="mapbox3D"&&o.type!=="maptalks3D",this._geo3DBuilderList[this._currentStep]=n),n.update(t,i,r,e.start,e.end),this.groupGL.add(n.rootNode),this._updateShaderDefines(o,n),this._currentStep++},_updateShaderDefines:function(e,t){var i=e.viewGL.isLinearSpace()?"define":"undefine";t.rootNode.traverse(function(r){r.material&&(r.material[i]("fragment","SRGB_DECODE"),(e.type==="mapbox3D"||e.type==="maptalks3D")&&(r.material.define("fragment","NORMAL_UP_AXIS",2),r.material.define("fragment","NORMAL_FRONT_AXIS",1)))})},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll(),this._geo3DBuilderList.forEach(function(e){e.dispose()})}});function b5(e){e.registerChartView(_5),e.registerSeriesModel(v5)}ji(b5);var y5=mn.extend({type:"series.surface",dependencies:["globe","grid3D","geo3D"],visualStyleAccessPath:"itemStyle",formatTooltip:function(e){return Ll(this,e)},getInitialData:function(e,t){var i=e.data;function r(te){return!(isNaN(te.min)||isNaN(te.max)||isNaN(te.step))}function n(te){var Z=qa.getPrecisionSafe;return Math.max(Z(te.min),Z(te.max),Z(te.step))+1}if(!i)if(e.parametric){var y=e.parametricEquation||{},x=y.u||{},w=y.v||{};["u","v"].forEach(function(Z){r(y[Z])}),["x","y","z"].forEach(function(Z){y[Z]});var I=Math.floor((x.max+x.step-x.min)/x.step),S=Math.floor((w.max+w.step-w.min)/w.step);i=new Float32Array(I*S*5);for(var E=n(x),N=n(w),h=0,p=0;p<S;p++)for(var m=0;m<I;m++){var M=m*x.step+x.min,P=p*w.step+w.min,$=qa.round(Math.min(M,x.max),E),R=qa.round(Math.min(P,w.max),N),f=y.x($,R),g=y.y($,R),b=y.z($,R);i[h++]=f,i[h++]=g,i[h++]=b,i[h++]=$,i[h++]=R}}else{var o=e.equation||{},a=o.x||{},s=o.y||{};if(["x","y"].forEach(function(te){r(o[te])}),typeof o.z!="function")return;var c=Math.floor((a.max+a.step-a.min)/a.step),l=Math.floor((s.max+s.step-s.min)/s.step);i=new Float32Array(c*l*3);for(var d=n(a),u=n(s),h=0,p=0;p<l;p++)for(var m=0;m<c;m++){var f=m*a.step+a.min,g=p*s.step+s.min,v=qa.round(Math.min(f,a.max),d),_=qa.round(Math.min(g,s.max),u),b=o.z(v,_);i[h++]=v,i[h++]=_,i[h++]=b}}var j=["x","y","z"];e.parametric&&j.push("u","v");var B=Od(this,j,i);return B},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,grid3DIndex:0,shading:"lambert",parametric:!1,wireframe:{show:!0,lineStyle:{color:"rgba(0,0,0,0.5)",width:1}},equation:{x:{min:-1,max:1,step:.1},y:{min:-1,max:1,step:.1},z:null},parametricEquation:{u:{min:-1,max:1,step:.1},v:{min:-1,max:1,step:.1},x:null,y:null,z:null},dataShape:null,itemStyle:{},animationDurationUpdate:500}});Re.merge(y5.prototype,Ps);var x5=y5;var wh=bi.vec3;function Xie(e){return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])}var w5=gn.extend({type:"surface",__ecgl__:!0,init:function(e,t){this.groupGL=new F.Node},render:function(e,t,i){var r=this._prevSurfaceMesh;this._prevSurfaceMesh=this._surfaceMesh,this._surfaceMesh=r,this._surfaceMesh||(this._surfaceMesh=this._createSurfaceMesh()),this.groupGL.remove(this._prevSurfaceMesh),this.groupGL.add(this._surfaceMesh);var n=e.coordinateSystem,o=e.get("shading"),a=e.getData(),s="ecgl."+o;if((!this._surfaceMesh.material||this._surfaceMesh.material.shader.name!==s)&&(this._surfaceMesh.material=F.createMaterial(s,["VERTEX_COLOR","DOUBLE_SIDED"])),F.setMaterialFromModel(o,this._surfaceMesh.material,e,i),n&&n.viewGL){n.viewGL.add(this.groupGL);var c=n.viewGL.isLinearSpace()?"define":"undefine";this._surfaceMesh.material[c]("fragment","SRGB_DECODE")}var l=e.get("parametric"),d=e.get("dataShape");d||(d=this._getDataShape(a,l));var u=e.getModel("wireframe"),h=u.get("lineStyle.width"),p=u.get("show")&&h>0;this._updateSurfaceMesh(this._surfaceMesh,e,d,p);var m=this._surfaceMesh.material;p?(m.define("WIREFRAME_QUAD"),m.set("wireframeLineWidth",h),m.set("wireframeLineColor",F.parseColor(u.get("lineStyle.color")))):m.undefine("WIREFRAME_QUAD"),this._initHandler(e,i),this._updateAnimation(e)},_updateAnimation:function(e){F.updateVertexAnimation([["prevPosition","position"],["prevNormal","normal"]],this._prevSurfaceMesh,this._surfaceMesh,e)},_createSurfaceMesh:function(){var e=new F.Mesh({geometry:new F.Geometry({dynamic:!0,sortTriangles:!0}),shadowDepthMaterial:new F.Material({shader:new F.Shader(F.Shader.source("ecgl.sm.depth.vertex"),F.Shader.source("ecgl.sm.depth.fragment"))}),culling:!1,renderOrder:10,renderNormal:!0});return e.geometry.createAttribute("barycentric","float",4),e.geometry.createAttribute("prevPosition","float",3),e.geometry.createAttribute("prevNormal","float",3),Object.assign(e.geometry,wf),e},_initHandler:function(e,t){var i=e.getData(),r=this._surfaceMesh,n=e.coordinateSystem;function o(s,c){for(var l=1/0,d=-1,u=[],h=0;h<s.length;h++){r.geometry.attributes.position.get(s[h],u);var p=wh.dist(c.array,u);p<l&&(l=p,d=s[h])}return d}r.seriesIndex=e.seriesIndex;var a=-1;r.off("mousemove"),r.off("mouseout"),r.on("mousemove",function(s){var c=o(s.triangle,s.point);if(c>=0){var l=[];r.geometry.attributes.position.get(c,l);for(var d=n.pointToData(l),u=1/0,h=-1,p=[],m=0;m<i.count();m++){p[0]=i.get("x",m),p[1]=i.get("y",m),p[2]=i.get("z",m);var f=wh.squaredDistance(p,d);f<u&&(h=m,u=f)}h!==a&&t.dispatchAction({type:"grid3DShowAxisPointer",value:d}),a=h,r.dataIndex=h}else r.dataIndex=-1},this),r.on("mouseout",function(s){a=-1,r.dataIndex=-1,t.dispatchAction({type:"grid3DHideAxisPointer"})},this)},_updateSurfaceMesh:function(e,t,i,r){var n=e.geometry,o=t.getData(),a=o.getLayout("points"),s=0;o.each(function(Ke){o.hasValue(Ke)||s++});var c=s||r,l=n.attributes.position,d=n.attributes.normal,u=n.attributes.texcoord0,h=n.attributes.barycentric,p=n.attributes.color,m=i[0],f=i[1],g=t.get("shading"),v=g!=="color";if(c){var _=(m-1)*(f-1)*4;l.init(_),r&&h.init(_)}else l.value=new Float32Array(a);p.init(n.vertexCount),u.init(n.vertexCount);var b=[0,3,1,1,3,2],y=[[1,1,0,0],[0,1,0,1],[1,0,0,1],[1,0,1,0]],x=n.indices=new(n.vertexCount>65535?Uint32Array:Uint16Array)((m-1)*(f-1)*6),w=function(Ke,At,bt){bt[1]=Ke*f+At,bt[0]=Ke*f+At+1,bt[3]=(Ke+1)*f+At+1,bt[2]=(Ke+1)*f+At},I=!1;if(c){var S=[],E=[],N=0;v?d.init(n.vertexCount):d.value=null;for(var M=[[],[],[]],P=[],$=[],R=wh.create(),j=function(Ke,At,bt){var Kt=At*3;return bt[0]=Ke[Kt],bt[1]=Ke[Kt+1],bt[2]=Ke[Kt+2],bt},B=new Float32Array(a.length),te=new Float32Array(a.length/3*4),Z=0;Z<o.count();Z++)if(o.hasValue(Z)){var fe=F.parseColor(gr(o,Z)),ne=Er(o,Z);ne!=null&&(fe[3]*=ne),fe[3]<.99&&(I=!0);for(var se=0;se<4;se++)te[Z*4+se]=fe[se]}for(var we=[1e7,1e7,1e7],Z=0;Z<m-1;Z++)for(var ie=0;ie<f-1;ie++){var ue=Z*(f-1)+ie,Ee=ue*4;w(Z,ie,S);for(var ye=!1,se=0;se<4;se++)j(a,S[se],E),Xie(E)&&(ye=!0);for(var se=0;se<4;se++)ye?l.set(Ee+se,we):(j(a,S[se],E),l.set(Ee+se,E)),r&&h.set(Ee+se,y[se]);for(var se=0;se<6;se++)x[N++]=b[se]+Ee;if(v&&!ye)for(var se=0;se<2;se++){for(var Te=se*3,pe=0;pe<3;pe++){var be=S[b[Te]+pe];j(a,be,M[pe])}wh.sub(P,M[0],M[1]),wh.sub($,M[1],M[2]),wh.cross(R,P,$);for(var pe=0;pe<3;pe++){var De=S[b[Te]+pe]*3;B[De]=B[De]+R[0],B[De+1]=B[De+1]+R[1],B[De+2]=B[De+2]+R[2]}}}if(v)for(var Z=0;Z<B.length/3;Z++)j(B,Z,R),wh.normalize(R,R),B[Z*3]=R[0],B[Z*3+1]=R[1],B[Z*3+2]=R[2];for(var fe=[],Ne=[],Z=0;Z<m-1;Z++)for(var ie=0;ie<f-1;ie++){var ue=Z*(f-1)+ie,Ee=ue*4;w(Z,ie,S);for(var se=0;se<4;se++){for(var pe=0;pe<4;pe++)fe[pe]=te[S[se]*4+pe];p.set(Ee+se,fe),v&&(j(B,S[se],R),d.set(Ee+se,R));var be=S[se];Ne[0]=be%f/(f-1),Ne[1]=Math.floor(be/f)/(m-1),u.set(Ee+se,Ne)}ue++}}else{for(var Ne=[],Z=0;Z<o.count();Z++){Ne[0]=Z%f/(f-1),Ne[1]=Math.floor(Z/f)/(m-1);var fe=F.parseColor(gr(o,Z)),ne=Er(o,Z);ne!=null&&(fe[3]*=ne),fe[3]<.99&&(I=!0),p.set(Z,fe),u.set(Z,Ne)}for(var S=[],Pe=0,Z=0;Z<m-1;Z++)for(var ie=0;ie<f-1;ie++){w(Z,ie,S);for(var se=0;se<6;se++)x[Pe++]=S[b[se]]}v?n.generateVertexNormals():d.value=null}e.material.get("normalMap")&&n.generateTangents(),n.updateBoundingBox(),n.dirty(),e.material.transparent=I,e.material.depthMask=!I},_getDataShape:function(e,t){for(var i=-1/0,r=0,n=0,o=0,a=!1,s=t?"u":"x",c=e.count(),l=0;l<c;l++){var d=e.get(s,l);d<i&&(o=n,n=0,r++),i=d,n++}if((!r||n===1)&&(a=!0),!a)return[r+1,n];for(var u=Math.floor(Math.sqrt(c));u>0;){if(Math.floor(c/u)===c/u)return[u,c/u];u--}return u=Math.floor(Math.sqrt(c)),[u,u]},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}});function E5(e){e.registerChartView(w5),e.registerSeriesModel(x5),e.registerLayout(function(t,i){t.eachSeriesByType("surface",function(r){var n=r.coordinateSystem;!n||n.type;var o=r.getData(),a=new Float32Array(3*o.count()),s=[NaN,NaN,NaN];if(n&&n.type==="cartesian3D"){var c=n.dimensions,l=c.map(function(d){return r.coordDimToDataDim(d)[0]});o.each(l,function(d,u,h,p){var m;o.hasValue(p)?m=n.dataToPoint([d,u,h]):m=s,a[p*3]=m[0],a[p*3+1]=m[1],a[p*3+2]=m[2]})}o.setLayout("points",a)})})}ji(E5);function C5(e,t){for(var i=[],r=0;r<t.length;r++)i.push(e.dataToPoint(t[r]));return i}var Af=mn.extend({type:"series.map3D",layoutMode:"box",coordinateSystem:null,visualStyleAccessPath:"itemStyle",optionUpdated:function(e){e=e||{};var t=this.get("coordinateSystem");if(!(t==null||t==="geo3D")){if(0)var i,r;this.get("groundPlane.show")&&(this.option.groundPlane.show=!1),this._geo=null}},getInitialData:function(e){e.data=this.getFilledRegions(e.data,e.map);var t=yr.createDimensions(e.data,{coordDimensions:["value"]}),i=new Ln(t,this);i.initData(e.data);var r={};return i.each(function(n){var o=i.getName(n),a=i.getItemModel(n);r[o]=a}),this._regionModelMap=r,i},formatTooltip:function(e){return Ll(this,e)},getRegionModel:function(e){var t=this.getData().getName(e);return this._regionModelMap[t]||new gd(null,this)},getRegionPolygonCoords:function(e){var t=this.coordinateSystem,i=this.getData().getName(e);if(t.transform){var r=t.getRegion(i);return r?r.geometries:[]}else{this._geo||(this._geo=bx.createGeo3D(this));for(var r=this._geo.getRegion(i),n=[],o=0;o<r.geometries.length;o++){var a=r.geometries[o],s=[],c=C5(t,a.exterior);if(s&&s.length)for(var l=0;l<a.interiors.length;l++)s.push(C5(t,s[l]));n.push({interiors:s,exterior:c})}return n}},getFormattedLabel:function(e,t){var i=Os.getFormattedLabel(this,e,t);return i==null&&(i=this.getData().getName(e)),i},defaultOption:{coordinateSystem:"geo3D",data:null}});Re.merge(Af.prototype,gx);Re.merge(Af.prototype,Ad);Re.merge(Af.prototype,Is);Re.merge(Af.prototype,Ms);Re.merge(Af.prototype,Ps);var S5=Af;var T5=gn.extend({type:"map3D",__ecgl__:!0,init:function(e,t){this._geo3DBuilder=new bh(t),this.groupGL=new F.Node},render:function(e,t,i){var r=e.coordinateSystem;if(!(!r||!r.viewGL)){this.groupGL.add(this._geo3DBuilder.rootNode),r.viewGL.add(this.groupGL);var n;if(r.type==="geo3D"){n=r,this._sceneHelper||(this._sceneHelper=new ks,this._sceneHelper.initLight(this.groupGL)),this._sceneHelper.setScene(r.viewGL.scene),this._sceneHelper.updateLight(e),r.viewGL.setPostEffect(e.getModel("postEffect"),i),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling"));var o=this._control;o||(o=this._control=new Dd({zr:i.getZr()}),this._control.init());var a=e.getModel("viewControl");o.setViewGL(r.viewGL),o.setFromViewControlModel(a,0),o.off("update"),o.on("update",function(){i.dispatchAction({type:"map3DChangeCamera",alpha:o.getAlpha(),beta:o.getBeta(),distance:o.getDistance(),from:this.uid,map3DId:e.id})}),this._geo3DBuilder.extrudeY=!0}else this._control&&(this._control.dispose(),this._control=null),this._sceneHelper&&(this._sceneHelper.dispose(),this._sceneHelper=null),n=e.getData().getLayout("geo3D"),this._geo3DBuilder.extrudeY=!1;this._geo3DBuilder.update(e,t,i,0,e.getData().count());var s=r.viewGL.isLinearSpace()?"define":"undefine";this._geo3DBuilder.rootNode.traverse(function(c){c.material&&c.material[s]("fragment","SRGB_DECODE")})}},afterRender:function(e,t,i,r){var n=r.renderer,o=e.coordinateSystem;o&&o.type==="geo3D"&&(this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i))},dispose:function(){this.groupGL.removeAll(),this._control.dispose(),this._geo3DBuilder.dispose()}});function A5(e){yx(e),e.registerChartView(T5),e.registerSeriesModel(S5),e.registerAction({type:"map3DChangeCamera",event:"map3dcamerachanged",update:"series:updateCamera"},function(t,i){i.eachComponent({mainType:"series",subType:"map3D",query:t},function(r){r.setView(t)})})}ji(A5);var D5=mn.extend({type:"series.scatterGL",dependencies:["grid","polar","geo","singleAxis"],visualStyleAccessPath:"itemStyle",hasSymbolVisual:!0,getInitialData:function(){return yr.createList(this)},defaultOption:{coordinateSystem:"cartesian2d",zlevel:10,progressive:1e5,progressiveThreshold:1e5,large:!1,symbol:"circle",symbolSize:10,zoomScale:0,blendMode:"source-over",itemStyle:{opacity:.8},postEffect:{enable:!1,colorCorrection:{exposure:0,brightness:0,contrast:1,saturation:1,enable:!0}}}});function I5(){return[1,0,0,1,0,0]}function M5(e,t){var i=t[0],r=t[2],n=t[4],o=t[1],a=t[3],s=t[5],c=i*a-o*r;return c?(c=1/c,e[0]=a*c,e[1]=-o*c,e[2]=-r*c,e[3]=i*c,e[4]=(r*s-a*n)*c,e[5]=(o*n-i*s)*c,e):null}function Vd(e){this.viewGL=e}Vd.prototype.reset=function(e,t){this._updateCamera(t.getWidth(),t.getHeight(),t.getDevicePixelRatio()),this._viewTransform=I5(),this.updateTransform(e,t)};Vd.prototype.updateTransform=function(e,t){var i=e.coordinateSystem;i.getRoamTransform&&(M5(this._viewTransform,i.getRoamTransform()),this._setCameraTransform(this._viewTransform),t.getZr().refresh())};Vd.prototype.dataToPoint=function(e,t,i){i=e.dataToPoint(t,null,i);var r=this._viewTransform;r&&pS(i,i,r)};Vd.prototype.removeTransformInPoint=function(e){return this._viewTransform&&pS(e,e,this._viewTransform),e};Vd.prototype.getZoom=function(){if(this._viewTransform){var e=this._viewTransform;return 1/Math.max(Math.sqrt(e[0]*e[0]+e[1]*e[1]),Math.sqrt(e[2]*e[2]+e[3]*e[3]))}return 1};Vd.prototype._setCameraTransform=function(e){var t=this.viewGL.camera;t.position.set(e[4],e[5],0),t.scale.set(Math.sqrt(e[0]*e[0]+e[1]*e[1]),Math.sqrt(e[2]*e[2]+e[3]*e[3]),1)};Vd.prototype._updateCamera=function(e,t,i){this.viewGL.setViewport(0,0,e,t,i);var r=this.viewGL.camera;r.left=r.top=0,r.bottom=t,r.right=e,r.near=0,r.far=100};var Ax=Vd;var k5=gn.extend({type:"scatterGL",__ecgl__:!0,init:function(e,t){this.groupGL=new F.Node,this.viewGL=new Do("orthographic"),this.viewGL.add(this.groupGL),this._pointsBuilderList=[],this._currentStep=0,this._sizeScale=1,this._glViewHelper=new Ax(this.viewGL)},render:function(e,t,i){if(this.groupGL.removeAll(),this._glViewHelper.reset(e,i),!!e.getData().count()){var r=this._pointsBuilderList[0];r||(r=this._pointsBuilderList[0]=new Rd(!0,i)),this._pointsBuilderList.length=1,this.groupGL.add(r.rootNode),this._removeTransformInPoints(e.getData().getLayout("points")),r.update(e,t,i),this.viewGL.setPostEffect(e.getModel("postEffect"),i)}},incrementalPrepareRender:function(e,t,i){this.groupGL.removeAll(),this._glViewHelper.reset(e,i),this._currentStep=0,this.viewGL.setPostEffect(e.getModel("postEffect"),i)},incrementalRender:function(e,t,i,r){if(!(e.end<=e.start)){var n=this._pointsBuilderList[this._currentStep];n||(n=new Rd(!0,r),this._pointsBuilderList[this._currentStep]=n),this.groupGL.add(n.rootNode),this._removeTransformInPoints(t.getData().getLayout("points")),n.setSizeScale(this._sizeScale),n.update(t,i,r,e.start,e.end),r.getZr().refresh(),this._currentStep++}},updateTransform:function(e,t,i){if(e.coordinateSystem.getRoamTransform){this._glViewHelper.updateTransform(e,i);var r=this._glViewHelper.getZoom(),n=Math.max((e.get("zoomScale")||0)*(r-1)+1,0);this._sizeScale=n,this._pointsBuilderList.forEach(function(o){o.setSizeScale(n)})}},_removeTransformInPoints:function(e){if(e)for(var t=[],i=0;i<e.length;i+=2)t[0]=e[i],t[1]=e[i+1],this._glViewHelper.removeTransformInPoint(t),e[i]=t[0],e[i+1]=t[1]},dispose:function(){this.groupGL.removeAll(),this._pointsBuilderList.forEach(function(e){e.dispose()})},remove:function(){this.groupGL.removeAll()}});function P5(e){e.registerChartView(k5),e.registerSeriesModel(D5),e.registerLayout({seriesType:"scatterGL",reset:function(t){var i=t.coordinateSystem,r=t.getData(),n;if(i){var o=i.dimensions.map(function(s){return r.mapDimension(s)}).slice(0,2),a=[];o.length===1?n=function(s){for(var c=new Float32Array((s.end-s.start)*2),l=s.start;l<s.end;l++){var d=(l-s.start)*2,u=r.get(o[0],l),h=i.dataToPoint(u);c[d]=h[0],c[d+1]=h[1]}r.setLayout("points",c)}:o.length===2&&(n=function(s){for(var c=new Float32Array((s.end-s.start)*2),l=s.start;l<s.end;l++){var d=(l-s.start)*2,u=r.get(o[0],l),h=r.get(o[1],l);a[0]=u,a[1]=h,a=i.dataToPoint(a),c[d]=a[0],c[d+1]=a[1]}r.setLayout("points",c)})}return{progress:n}}})}ji(P5);var N5=fR;function O5(e,t,i,r,n){for(var o=new pR(r),a=0;a<e.length;a++)o.addNode(St.firstNotNull(e[a].id,e[a].name,a),a);for(var s=[],c=[],l=0,a=0;a<t.length;a++){var d=t[a],u=d.source,h=d.target;o.addEdge(u,h,l)&&(c.push(d),s.push(St.firstNotNull(d.id,u+" > "+h)),l++)}var p,m=yr.createDimensions(e,{coordDimensions:["value"]});p=new Ln(m,i),p.initData(e);var f=new Ln(["value"],i);return f.initData(c,s),n&&n(p,f),N5({mainData:p,struct:o,structAttr:"graph",datas:{node:p,edge:f},datasAttr:{node:"data",edge:"edgeData"}}),o.update(),o}var Cv=mn.extend({type:"series.graphGL",visualStyleAccessPath:"itemStyle",hasSymbolVisual:!0,init:function(e){Cv.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._categoriesData},this._updateCategoriesData()},mergeOption:function(e){Cv.superApply(this,"mergeOption",arguments),this._updateCategoriesData()},getFormattedLabel:function(e,t,i,r){var n=Os.getFormattedLabel(this,e,t,i,r);if(n==null){var o=this.getData(),a=o.dimensions[o.dimensions.length-1];n=o.get(a,e)}return n},getInitialData:function(e,t){var i=e.edges||e.links||[],r=e.data||e.nodes||[],n=this;if(r&&i)return O5(r,i,this,!0,o).data;function o(a,s){a.wrapMethod("getItemModel",function(u){let h=n._categoriesModels,p=u.getShallow("category"),m=h[p];return m&&(m.parentModel=u.parentModel,u.parentModel=m),u});let c=t.getModel([]).getModel;function l(u,h){let p=c.call(this,u,h);return p.resolveParentPath=d,p}s.wrapMethod("getItemModel",function(u){return u.resolveParentPath=d,u.getModel=l,u});function d(u){if(u&&(u[0]==="label"||u[1]==="label")){let h=u.slice();return u[0]==="label"?h[0]="edgeLabel":u[1]==="label"&&(h[1]="edgeLabel"),h}return u}}},getGraph:function(){return this.getData().graph},getEdgeData:function(){return this.getGraph().edgeData},getCategoriesData:function(){return this._categoriesData},formatTooltip:function(e,t,i){if(i==="edge"){var r=this.getData(),n=this.getDataParams(e,i),o=r.graph.getEdgeByIndex(e),a=r.getName(o.node1.dataIndex),s=r.getName(o.node2.dataIndex),c=[];return a!=null&&c.push(a),s!=null&&c.push(s),c=Ca.encodeHTML(c.join(" > ")),n.value&&(c+=" : "+Ca.encodeHTML(n.value)),c}else return Cv.superApply(this,"formatTooltip",arguments)},_updateCategoriesData:function(){var e=(this.option.categories||[]).map(function(i){return i.value!=null?i:Object.assign({value:0},i)}),t=new Ln(["value"],this);t.initData(e),this._categoriesData=t,this._categoriesModels=t.mapArray(function(i){return t.getItemModel(i,!0)})},setView:function(e){e.zoom!=null&&(this.option.zoom=e.zoom),e.offset!=null&&(this.option.offset=e.offset)},setNodePosition:function(e){for(var t=0;t<e.length/2;t++){var i=e[t*2],r=e[t*2+1],n=this.getData().getRawDataItem(t);n.x=i,n.y=r}},isAnimationEnabled:function(){return Cv.superCall(this,"isAnimationEnabled")&&!(this.get("layout")==="force"&&this.get("force.layoutAnimation"))},defaultOption:{zlevel:10,z:2,legendHoverLink:!0,layout:"forceAtlas2",forceAtlas2:{initLayout:null,GPU:!0,steps:1,maxSteps:1e3,repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,edgeWeightInfluence:1,edgeWeight:[1,4],nodeWeight:[1,4],preventOverlap:!1,gravityCenter:null},focusNodeAdjacency:!0,focusNodeAdjacencyOn:"mouseover",left:"center",top:"center",symbol:"circle",symbolSize:5,roam:!1,center:null,zoom:1,label:{show:!1,formatter:"{b}",position:"right",distance:5,textStyle:{fontSize:14}},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{label:{show:!0}},animation:!1}}),R5=Cv;var On=bi.vec2,F5=[[0,0],[1,1]],L5=Jt.extend(function(){return{segmentScale:4,dynamic:!0,useNativeLine:!0,attributes:{position:new Jt.Attribute("position","float",2,"POSITION"),normal:new Jt.Attribute("normal","float",2),offset:new Jt.Attribute("offset","float",1),color:new Jt.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0,this._itemVertexOffsets=[]},setVertexCount:function(e){var t=this.attributes;this.vertexCount!==e&&(t.position.init(e),t.color.init(e),this.useNativeLine||(t.offset.init(e),t.normal.init(e)),e>65535?this.indices instanceof Uint16Array&&(this.indices=new Uint32Array(this.indices)):this.indices instanceof Uint32Array&&(this.indices=new Uint16Array(this.indices)))},setTriangleCount:function(e){this.triangleCount!==e&&(e===0?this.indices=null:this.indices=this.vertexCount>65535?new Uint32Array(e*3):new Uint16Array(e*3))},_getCubicCurveApproxStep:function(e,t,i,r){var n=On.dist(e,t)+On.dist(i,t)+On.dist(r,i),o=1/(n+1)*this.segmentScale;return o},getCubicCurveVertexCount:function(e,t,i,r){var n=this._getCubicCurveApproxStep(e,t,i,r),o=Math.ceil(1/n);return this.useNativeLine?o*2:o*2+2},getCubicCurveTriangleCount:function(e,t,i,r){var n=this._getCubicCurveApproxStep(e,t,i,r),o=Math.ceil(1/n);return this.useNativeLine?0:o*2},getLineVertexCount:function(){return this.getPolylineVertexCount(F5)},getLineTriangleCount:function(){return this.getPolylineTriangleCount(F5)},getPolylineVertexCount:function(e){var t;if(typeof e=="number")t=e;else{var i=typeof e[0]!="number";t=i?e.length:e.length/2}return this.useNativeLine?(t-1)*2:(t-1)*2+2},getPolylineTriangleCount:function(e){var t;if(typeof e=="number")t=e;else{var i=typeof e[0]!="number";t=i?e.length:e.length/2}return this.useNativeLine?0:(t-1)*2},addCubicCurve:function(e,t,i,r,n,o){o==null&&(o=1);for(var a=e[0],s=e[1],c=t[0],l=t[1],d=i[0],u=i[1],h=r[0],p=r[1],m=this._getCubicCurveApproxStep(e,t,i,r),f=m*m,g=f*m,v=3*m,_=3*f,b=6*f,y=6*g,x=a-c*2+d,w=s-l*2+u,I=(c-d)*3-a+h,S=(l-u)*3-s+p,E=a,N=s,M=(c-a)*v+x*_+I*g,P=(l-s)*v+w*_+S*g,$=x*b+I*y,R=w*b+S*y,j=I*y,B=S*y,te=0,Z=0,ne=Math.ceil(1/m),se=new Float32Array((ne+1)*3),se=[],we=0,Z=0;Z<ne+1;Z++)se[we++]=E,se[we++]=N,E+=M,N+=P,M+=$,P+=R,$+=j,R+=B,te+=m,te>1&&(E=M>0?Math.min(E,h):Math.max(E,h),N=P>0?Math.min(N,p):Math.max(N,p));this.addPolyline(se,n,o)},addLine:function(e,t,i,r){this.addPolyline([e,t],i,r)},addPolyline:function(){var e=On.create(),t=On.create(),i=On.create(),r=On.create(),n=[],o=[],a=[];return function(s,c,l,d,u){if(s.length){var h=typeof s[0]!="number";if(u==null&&(u=h?s.length:s.length/2),!(u<2)){d==null&&(d=0),l==null&&(l=1),this._itemVertexOffsets.push(this._vertexOffset);for(var p=h?typeof c[0]!="number":c.length/4===u,m=this.attributes.position,f=this.attributes.color,g=this.attributes.offset,v=this.attributes.normal,_=this.indices,b=this._vertexOffset,y,x=0;x<u;x++){if(h)n=s[x+d],p?y=c[x+d]:y=c;else{var w=x*2+d;if(n=n||[],n[0]=s[w],n[1]=s[w+1],p){var I=x*4+d;y=y||[],y[0]=c[I],y[1]=c[I+1],y[2]=c[I+2],y[3]=c[I+3]}else y=c}if(this.useNativeLine)x>1&&(m.copy(b,b-1),f.copy(b,b-1),b++);else{var S;if(x<u-1){if(h)On.copy(o,s[x+1]);else{var w=(x+1)*2+d;o=o||[],o[0]=s[w],o[1]=s[w+1]}if(x>0){On.sub(e,n,a),On.sub(t,o,n),On.normalize(e,e),On.normalize(t,t),On.add(r,e,t),On.normalize(r,r);var E=l/2*Math.min(1/On.dot(e,r),2);i[0]=-r[1],i[1]=r[0],S=E}else On.sub(e,o,n),On.normalize(e,e),i[0]=-e[1],i[1]=e[0],S=l/2}else On.sub(e,n,a),On.normalize(e,e),i[0]=-e[1],i[1]=e[0],S=l/2;v.set(b,i),v.set(b+1,i),g.set(b,S),g.set(b+1,-S),On.copy(a,n),m.set(b,n),m.set(b+1,n),f.set(b,y),f.set(b+1,y),b+=2}if(this.useNativeLine)f.set(b,y),m.set(b,n),b++;else if(x>0){var N=this._faceOffset*3,_=this.indices;_[N]=b-4,_[N+1]=b-3,_[N+2]=b-2,_[N+3]=b-3,_[N+4]=b-1,_[N+5]=b-2,this._faceOffset+=2}}this._vertexOffset=b}}}}(),setItemColor:function(e,t){for(var i=this._itemVertexOffsets[e],r=e<this._itemVertexOffsets.length-1?this._itemVertexOffsets[e+1]:this._vertexOffset,n=i;n<r;n++)this.attributes.color.set(n,t);this.dirty("color")}});Re.defaults(L5.prototype,Rl);var Dx=L5;var B5=`@export ecgl.forceAtlas2.updateNodeRepulsion

#define NODE_COUNT 0

uniform sampler2D positionTex;

uniform vec2 textureSize;
uniform float gravity;
uniform float scaling;
uniform vec2 gravityCenter;

uniform bool strongGravityMode;
uniform bool preventOverlap;

varying vec2 v_Texcoord;

void main() {

 vec4 n0 = texture2D(positionTex, v_Texcoord);

 vec2 force = vec2(0.0);
 for (int i = 0; i < NODE_COUNT; i++) {
 vec2 uv = vec2(
 mod(float(i), textureSize.x) / (textureSize.x - 1.0),
 floor(float(i) / textureSize.x) / (textureSize.y - 1.0)
 );
 vec4 n1 = texture2D(positionTex, uv);

 vec2 dir = n0.xy - n1.xy;
 float d2 = dot(dir, dir);

 if (d2 > 0.0) {
 float factor = 0.0;
 if (preventOverlap) {
 float d = sqrt(d2);
 d = d - n0.w - n1.w;
 if (d > 0.0) {
 factor = scaling * n0.z * n1.z / (d * d);
 }
 else if (d < 0.0) {
 factor = scaling * 100.0 * n0.z * n1.z;
 }
 }
 else {
 factor = scaling * n0.z * n1.z / d2;
 }
 force += dir * factor;
 }
 }

 vec2 dir = gravityCenter - n0.xy;
 float d = 1.0;
 if (!strongGravityMode) {
 d = length(dir);
 }

 force += dir * n0.z * gravity / (d + 1.0);

 gl_FragColor = vec4(force, 0.0, 1.0);
}
@end

@export ecgl.forceAtlas2.updateEdgeAttraction.vertex

attribute vec2 node1;
attribute vec2 node2;
attribute float weight;

uniform sampler2D positionTex;
uniform float edgeWeightInfluence;
uniform bool preventOverlap;
uniform bool linLogMode;

uniform vec2 windowSize: WINDOW_SIZE;

varying vec2 v_Force;

void main() {

 vec4 n0 = texture2D(positionTex, node1);
 vec4 n1 = texture2D(positionTex, node2);

 vec2 dir = n1.xy - n0.xy;
 float d = length(dir);
 float w;
 if (edgeWeightInfluence == 0.0) {
 w = 1.0;
 }
 else if (edgeWeightInfluence == 1.0) {
 w = weight;
 }
 else {
 w = pow(weight, edgeWeightInfluence);
 }
 vec2 offset = vec2(1.0 / windowSize.x, 1.0 / windowSize.y);
 vec2 scale = vec2((windowSize.x - 1.0) / windowSize.x, (windowSize.y - 1.0) / windowSize.y);
 vec2 pos = node1 * scale * 2.0 - 1.0;
 gl_Position = vec4(pos + offset, 0.0, 1.0);
 gl_PointSize = 1.0;

 float factor;
 if (preventOverlap) {
 d = d - n1.w - n0.w;
 }
 if (d <= 0.0) {
 v_Force = vec2(0.0);
 return;
 }

 if (linLogMode) {
 factor = w * log(d) / d;
 }
 else {
 factor = w;
 }
 v_Force = dir * factor;
}
@end

@export ecgl.forceAtlas2.updateEdgeAttraction.fragment

varying vec2 v_Force;

void main() {
 gl_FragColor = vec4(v_Force, 0.0, 0.0);
}
@end

@export ecgl.forceAtlas2.calcWeightedSum.vertex

attribute vec2 node;

varying vec2 v_NodeUv;

void main() {

 v_NodeUv = node;
 gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
 gl_PointSize = 1.0;
}
@end

@export ecgl.forceAtlas2.calcWeightedSum.fragment

varying vec2 v_NodeUv;

uniform sampler2D positionTex;
uniform sampler2D forceTex;
uniform sampler2D forcePrevTex;

void main() {
 vec2 force = texture2D(forceTex, v_NodeUv).rg;
 vec2 forcePrev = texture2D(forcePrevTex, v_NodeUv).rg;

 float mass = texture2D(positionTex, v_NodeUv).z;
 float swing = length(force - forcePrev) * mass;
 float traction = length(force + forcePrev) * 0.5 * mass;

 gl_FragColor = vec4(swing, traction, 0.0, 0.0);
}
@end

@export ecgl.forceAtlas2.calcGlobalSpeed

uniform sampler2D globalSpeedPrevTex;
uniform sampler2D weightedSumTex;
uniform float jitterTolerence;

void main() {
 vec2 weightedSum = texture2D(weightedSumTex, vec2(0.5)).xy;
 float prevGlobalSpeed = texture2D(globalSpeedPrevTex, vec2(0.5)).x;
 float globalSpeed = jitterTolerence * jitterTolerence
 * weightedSum.y / weightedSum.x;
 if (prevGlobalSpeed > 0.0) {
 globalSpeed = min(globalSpeed / prevGlobalSpeed, 1.5) * prevGlobalSpeed;
 }
 gl_FragColor = vec4(globalSpeed, 0.0, 0.0, 1.0);
}
@end

@export ecgl.forceAtlas2.updatePosition

uniform sampler2D forceTex;
uniform sampler2D forcePrevTex;
uniform sampler2D positionTex;
uniform sampler2D globalSpeedTex;

varying vec2 v_Texcoord;

void main() {
 vec2 force = texture2D(forceTex, v_Texcoord).xy;
 vec2 forcePrev = texture2D(forcePrevTex, v_Texcoord).xy;
 vec4 node = texture2D(positionTex, v_Texcoord);

 float globalSpeed = texture2D(globalSpeedTex, vec2(0.5)).r;
 float swing = length(force - forcePrev);
 float speed = 0.1 * globalSpeed / (0.1 + globalSpeed * sqrt(swing));

 float df = length(force);
 if (df > 0.0) {
 speed = min(df * speed, 10.0) / df;

 gl_FragColor = vec4(node.xy + speed * force, node.zw);
 }
 else {
 gl_FragColor = node;
 }
}
@end

@export ecgl.forceAtlas2.edges.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec2 node;
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;

uniform sampler2D positionTex;

void main()
{
 gl_Position = worldViewProjection * vec4(
 texture2D(positionTex, node).xy, -10.0, 1.0
 );
 v_Color = a_Color;
}
@end

@export ecgl.forceAtlas2.edges.fragment
uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
varying vec4 v_Color;
void main() {
 gl_FragColor = color * v_Color;
}
@end`;F.Shader.import(B5);var hT={repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,scaling:1,edgeWeightInfluence:1,jitterTolerence:.1,preventOverlap:!1,dissuadeHubs:!1,gravityCenter:null};function Qn(e){var t={type:F.Texture.FLOAT,minFilter:F.Texture.NEAREST,magFilter:F.Texture.NEAREST};this._positionSourceTex=new F.Texture2D(t),this._positionSourceTex.flipY=!1,this._positionTex=new F.Texture2D(t),this._positionPrevTex=new F.Texture2D(t),this._forceTex=new F.Texture2D(t),this._forcePrevTex=new F.Texture2D(t),this._weightedSumTex=new F.Texture2D(t),this._weightedSumTex.width=this._weightedSumTex.height=1,this._globalSpeedTex=new F.Texture2D(t),this._globalSpeedPrevTex=new F.Texture2D(t),this._globalSpeedTex.width=this._globalSpeedTex.height=1,this._globalSpeedPrevTex.width=this._globalSpeedPrevTex.height=1,this._nodeRepulsionPass=new cr({fragment:F.Shader.source("ecgl.forceAtlas2.updateNodeRepulsion")}),this._positionPass=new cr({fragment:F.Shader.source("ecgl.forceAtlas2.updatePosition")}),this._globalSpeedPass=new cr({fragment:F.Shader.source("ecgl.forceAtlas2.calcGlobalSpeed")}),this._copyPass=new cr({fragment:F.Shader.source("clay.compositor.output")});var i=function(r){r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ONE,r.ONE)};this._edgeForceMesh=new F.Mesh({geometry:new F.Geometry({attributes:{node1:new F.Geometry.Attribute("node1","float",2),node2:new F.Geometry.Attribute("node2","float",2),weight:new F.Geometry.Attribute("weight","float",1)},dynamic:!0,mainAttribute:"node1"}),material:new F.Material({transparent:!0,shader:F.createShader("ecgl.forceAtlas2.updateEdgeAttraction"),blend:i,depthMask:!1,depthText:!1}),mode:F.Mesh.POINTS}),this._weightedSumMesh=new F.Mesh({geometry:new F.Geometry({attributes:{node:new F.Geometry.Attribute("node","float",2)},dynamic:!0,mainAttribute:"node"}),material:new F.Material({transparent:!0,shader:F.createShader("ecgl.forceAtlas2.calcWeightedSum"),blend:i,depthMask:!1,depthText:!1}),mode:F.Mesh.POINTS}),this._framebuffer=new tr({depthBuffer:!1}),this._dummyCamera=new F.OrthographicCamera({left:-1,right:1,top:1,bottom:-1,near:0,far:100}),this._globalSpeed=0}Qn.prototype.updateOption=function(e){for(var t in hT)this[t]=hT[t];var i=this._nodes.length;if(i>5e4?this.jitterTolerence=10:i>5e3?this.jitterTolerence=1:this.jitterTolerence=.1,i>100?this.scaling=2:this.scaling=10,e)for(var t in hT)e[t]!=null&&(this[t]=e[t]);if(this.repulsionByDegree)for(var r=this._positionSourceTex.pixels,n=0;n<this._nodes.length;n++)r[n*4+2]=(this._nodes[n].degree||0)+1};Qn.prototype._updateGravityCenter=function(e){var t=this._nodes,i=this._edges;if(this.gravityCenter)this._gravityCenter=this.gravityCenter;else{for(var r=[1/0,1/0],n=[-1/0,-1/0],o=0;o<t.length;o++)r[0]=Math.min(t[o].x,r[0]),r[1]=Math.min(t[o].y,r[1]),n[0]=Math.max(t[o].x,n[0]),n[1]=Math.max(t[o].y,n[1]);this._gravityCenter=[(r[0]+n[0])*.5,(r[1]+n[1])*.5]}for(var o=0;o<i.length;o++){var a=i[o].node1,s=i[o].node2;t[a].degree=(t[a].degree||0)+1,t[s].degree=(t[s].degree||0)+1}};Qn.prototype.initData=function(e,t){this._nodes=e,this._edges=t,this._updateGravityCenter();var i=Math.ceil(Math.sqrt(e.length)),r=i,n=new Float32Array(i*r*4);this._resize(i,r);for(var o=0,a=0;a<e.length;a++){var s=e[a];n[o++]=s.x||0,n[o++]=s.y||0,n[o++]=s.mass||1,n[o++]=s.size||1}this._positionSourceTex.pixels=n;var c=this._edgeForceMesh.geometry,l=t.length;c.attributes.node1.init(l*2),c.attributes.node2.init(l*2),c.attributes.weight.init(l*2);for(var d=[],a=0;a<t.length;a++){var u=c.attributes,h=t[a].weight;h==null&&(h=1),u.node1.set(a,this.getNodeUV(t[a].node1,d)),u.node2.set(a,this.getNodeUV(t[a].node2,d)),u.weight.set(a,h),u.node1.set(a+l,this.getNodeUV(t[a].node2,d)),u.node2.set(a+l,this.getNodeUV(t[a].node1,d)),u.weight.set(a+l,h)}var p=this._weightedSumMesh.geometry;p.attributes.node.init(e.length);for(var a=0;a<e.length;a++)p.attributes.node.set(a,this.getNodeUV(a,d));c.dirty(),p.dirty(),this._nodeRepulsionPass.material.define("fragment","NODE_COUNT",e.length),this._nodeRepulsionPass.material.setUniform("textureSize",[i,r]),this._inited=!1,this._frame=0};Qn.prototype.getNodes=function(){return this._nodes};Qn.prototype.getEdges=function(){return this._edges};Qn.prototype.step=function(e){this._inited||(this._initFromSource(e),this._inited=!0),this._frame++,this._framebuffer.attach(this._forceTex),this._framebuffer.bind(e);var t=this._nodeRepulsionPass;t.setUniform("strongGravityMode",this.strongGravityMode),t.setUniform("gravity",this.gravity),t.setUniform("gravityCenter",this._gravityCenter),t.setUniform("scaling",this.scaling),t.setUniform("preventOverlap",this.preventOverlap),t.setUniform("positionTex",this._positionPrevTex),t.render(e);var i=this._edgeForceMesh;i.material.set("linLogMode",this.linLogMode),i.material.set("edgeWeightInfluence",this.edgeWeightInfluence),i.material.set("preventOverlap",this.preventOverlap),i.material.set("positionTex",this._positionPrevTex),e.gl.enable(e.gl.BLEND),e.renderPass([i],this._dummyCamera),this._framebuffer.attach(this._weightedSumTex),e.gl.clearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT),e.gl.enable(e.gl.BLEND);var r=this._weightedSumMesh;r.material.set("positionTex",this._positionPrevTex),r.material.set("forceTex",this._forceTex),r.material.set("forcePrevTex",this._forcePrevTex),e.renderPass([r],this._dummyCamera),this._framebuffer.attach(this._globalSpeedTex);var n=this._globalSpeedPass;n.setUniform("globalSpeedPrevTex",this._globalSpeedPrevTex),n.setUniform("weightedSumTex",this._weightedSumTex),n.setUniform("jitterTolerence",this.jitterTolerence),e.gl.disable(e.gl.BLEND),n.render(e);var o=this._positionPass;this._framebuffer.attach(this._positionTex),o.setUniform("globalSpeedTex",this._globalSpeedTex),o.setUniform("positionTex",this._positionPrevTex),o.setUniform("forceTex",this._forceTex),o.setUniform("forcePrevTex",this._forcePrevTex),o.render(e),this._framebuffer.unbind(e),this._swapTexture()};Qn.prototype.update=function(e,t,i){t==null&&(t=1),t=Math.max(t,1);for(var r=0;r<t;r++)this.step(e);i&&i()};Qn.prototype.getNodePositionTexture=function(){return this._inited?this._positionPrevTex:this._positionSourceTex};Qn.prototype.getNodeUV=function(e,t){t=t||[];var i=this._positionTex.width,r=this._positionTex.height;return t[0]=e%i/(i-1),t[1]=Math.floor(e/i)/(r-1)||0,t};Qn.prototype.getNodePosition=function(e,t){var i=this._positionArr,r=this._positionTex.width,n=this._positionTex.height,o=r*n;(!i||i.length!==o*4)&&(i=this._positionArr=new Float32Array(o*4)),this._framebuffer.bind(e),this._framebuffer.attach(this._positionPrevTex),e.gl.readPixels(0,0,r,n,e.gl.RGBA,e.gl.FLOAT,i),this._framebuffer.unbind(e),t||(t=new Float32Array(this._nodes.length*2));for(var a=0;a<this._nodes.length;a++)t[a*2]=i[a*4],t[a*2+1]=i[a*4+1];return t};Qn.prototype.getTextureData=function(e,t){var i=this["_"+t+"Tex"],r=i.width,n=i.height;this._framebuffer.bind(e),this._framebuffer.attach(i);var o=new Float32Array(r*n*4);return e.gl.readPixels(0,0,r,n,e.gl.RGBA,e.gl.FLOAT,o),this._framebuffer.unbind(e),o};Qn.prototype.getTextureSize=function(){return{width:this._positionTex.width,height:this._positionTex.height}};Qn.prototype.isFinished=function(e){return this._frame>e};Qn.prototype._swapTexture=function(){var e=this._positionPrevTex;this._positionPrevTex=this._positionTex,this._positionTex=e;var e=this._forcePrevTex;this._forcePrevTex=this._forceTex,this._forceTex=e;var e=this._globalSpeedPrevTex;this._globalSpeedPrevTex=this._globalSpeedTex,this._globalSpeedTex=e};Qn.prototype._initFromSource=function(e){this._framebuffer.attach(this._positionPrevTex),this._framebuffer.bind(e),this._copyPass.setUniform("texture",this._positionSourceTex),this._copyPass.render(e),e.gl.clearColor(0,0,0,0),this._framebuffer.attach(this._forcePrevTex),e.gl.clear(e.gl.COLOR_BUFFER_BIT),this._framebuffer.attach(this._globalSpeedPrevTex),e.gl.clear(e.gl.COLOR_BUFFER_BIT),this._framebuffer.unbind(e)};Qn.prototype._resize=function(e,t){["_positionSourceTex","_positionTex","_positionPrevTex","_forceTex","_forcePrevTex"].forEach(function(i){this[i].width=e,this[i].height=t,this[i].dirty()},this)};Qn.prototype.dispose=function(e){this._framebuffer.dispose(e),this._copyPass.dispose(e),this._nodeRepulsionPass.dispose(e),this._positionPass.dispose(e),this._globalSpeedPass.dispose(e),this._edgeForceMesh.geometry.dispose(e),this._weightedSumMesh.geometry.dispose(e),this._positionSourceTex.dispose(e),this._positionTex.dispose(e),this._positionPrevTex.dispose(e),this._forceTex.dispose(e),this._forcePrevTex.dispose(e),this._weightedSumTex.dispose(e),this._globalSpeedTex.dispose(e),this._globalSpeedPrevTex.dispose(e)};var Ix=Qn;function Zie(){var e={create:function(){return new Float32Array(2)},dist:function(c,l){var d=l[0]-c[0],u=l[1]-c[1];return Math.sqrt(d*d+u*u)},len:function(c){var l=c[0],d=c[1];return Math.sqrt(l*l+d*d)},scaleAndAdd:function(c,l,d,u){return c[0]=l[0]+d[0]*u,c[1]=l[1]+d[1]*u,c},scale:function(c,l,d){return c[0]=l[0]*d,c[1]=l[1]*d,c},add:function(c,l,d){return c[0]=l[0]+d[0],c[1]=l[1]+d[1],c},sub:function(c,l,d){return c[0]=l[0]-d[0],c[1]=l[1]-d[1],c},normalize:function(c,l){var d=l[0],u=l[1],h=d*d+u*u;return h>0&&(h=1/Math.sqrt(h),c[0]=l[0]*h,c[1]=l[1]*h),c},negate:function(c,l){return c[0]=-l[0],c[1]=-l[1],c},copy:function(c,l){return c[0]=l[0],c[1]=l[1],c},set:function(c,l,d){return c[0]=l,c[1]=d,c}};function t(){this.subRegions=[],this.nSubRegions=0,this.node=null,this.mass=0,this.centerOfMass=null,this.bbox=new Float32Array(4),this.size=0}var i=t.prototype;i.beforeUpdate=function(){for(var c=0;c<this.nSubRegions;c++)this.subRegions[c].beforeUpdate();this.mass=0,this.centerOfMass&&(this.centerOfMass[0]=0,this.centerOfMass[1]=0),this.nSubRegions=0,this.node=null},i.afterUpdate=function(){this.subRegions.length=this.nSubRegions;for(var c=0;c<this.nSubRegions;c++)this.subRegions[c].afterUpdate()},i.addNode=function(c){if(this.nSubRegions===0)if(this.node==null){this.node=c;return}else this._addNodeToSubRegion(this.node),this.node=null;this._addNodeToSubRegion(c),this._updateCenterOfMass(c)},i.findSubRegion=function(c,l){for(var d=0;d<this.nSubRegions;d++){var u=this.subRegions[d];if(u.contain(c,l))return u}},i.contain=function(c,l){return this.bbox[0]<=c&&this.bbox[2]>=c&&this.bbox[1]<=l&&this.bbox[3]>=l},i.setBBox=function(c,l,d,u){this.bbox[0]=c,this.bbox[1]=l,this.bbox[2]=d,this.bbox[3]=u,this.size=(d-c+u-l)/2},i._newSubRegion=function(){var c=this.subRegions[this.nSubRegions];return c||(c=new t,this.subRegions[this.nSubRegions]=c),this.nSubRegions++,c},i._addNodeToSubRegion=function(c){var l=this.findSubRegion(c.position[0],c.position[1]),d=this.bbox;if(!l){var u=(d[0]+d[2])/2,h=(d[1]+d[3])/2,p=(d[2]-d[0])/2,m=(d[3]-d[1])/2,f=c.position[0]>=u?1:0,g=c.position[1]>=h?1:0,l=this._newSubRegion();l.setBBox(f*p+d[0],g*m+d[1],(f+1)*p+d[0],(g+1)*m+d[1])}l.addNode(c)},i._updateCenterOfMass=function(c){this.centerOfMass==null&&(this.centerOfMass=new Float32Array(2));var l=this.centerOfMass[0]*this.mass,d=this.centerOfMass[1]*this.mass;l+=c.position[0]*c.mass,d+=c.position[1]*c.mass,this.mass+=c.mass,this.centerOfMass[0]=l/this.mass,this.centerOfMass[1]=d/this.mass};function r(){this.position=new Float32Array(2),this.force=e.create(),this.forcePrev=e.create(),this.mass=1,this.inDegree=0,this.outDegree=0}function n(c,l){this.source=c,this.target=l,this.weight=1}function o(){this.autoSettings=!0,this.barnesHutOptimize=!0,this.barnesHutTheta=1.5,this.repulsionByDegree=!0,this.linLogMode=!1,this.strongGravityMode=!1,this.gravity=1,this.scaling=1,this.edgeWeightInfluence=1,this.jitterTolerence=.1,this.preventOverlap=!1,this.dissuadeHubs=!1,this.rootRegion=new t,this.rootRegion.centerOfMass=e.create(),this.nodes=[],this.edges=[],this.bbox=new Float32Array(4),this.gravityCenter=null,this._massArr=null,this._swingingArr=null,this._sizeArr=null,this._globalSpeed=0}var a=o.prototype;a.initNodes=function(c,l,d){var u=l.length;this.nodes.length=0;for(var h=typeof d<"u",p=0;p<u;p++){var m=new r;m.position[0]=c[p*2],m.position[1]=c[p*2+1],m.mass=l[p],h&&(m.size=d[p]),this.nodes.push(m)}this._massArr=l,this._swingingArr=new Float32Array(u),h&&(this._sizeArr=d)},a.initEdges=function(c,l){var d=c.length/2;this.edges.length=0;for(var u=0;u<d;u++){var h=c[u*2],p=c[u*2+1],m=this.nodes[h],f=this.nodes[p];if(!m||!f){console.error("Node not exists, try initNodes before initEdges");return}m.outDegree++,f.inDegree++;var g=new n(m,f);l&&(g.weight=l[u]),this.edges.push(g)}},a.updateSettings=function(){if(this.repulsionByDegree)for(var c=0;c<this.nodes.length;c++){var l=this.nodes[c];l.mass=l.inDegree+l.outDegree+1}else for(var c=0;c<this.nodes.length;c++){var l=this.nodes[c];l.mass=this._massArr[c]}},a.update=function(){var c=this.nodes.length;if(this.updateSettings(),this.updateBBox(),this.barnesHutOptimize){this.rootRegion.setBBox(this.bbox[0],this.bbox[1],this.bbox[2],this.bbox[3]),this.rootRegion.beforeUpdate();for(var l=0;l<c;l++)this.rootRegion.addNode(this.nodes[l]);this.rootRegion.afterUpdate()}for(var l=0;l<c;l++){var d=this.nodes[l];e.copy(d.forcePrev,d.force),e.set(d.force,0,0)}for(var l=0;l<c;l++){var u=this.nodes[l];if(this.barnesHutOptimize)this.applyRegionToNodeRepulsion(this.rootRegion,u);else for(var h=l+1;h<c;h++){var p=this.nodes[h];this.applyNodeToNodeRepulsion(u,p,!1)}this.gravity>0&&(this.strongGravityMode?this.applyNodeStrongGravity(u):this.applyNodeGravity(u))}for(var l=0;l<this.edges.length;l++)this.applyEdgeAttraction(this.edges[l]);for(var m=0,f=0,g=e.create(),l=0;l<c;l++){var d=this.nodes[l],v=e.dist(d.force,d.forcePrev);m+=v*d.mass,e.add(g,d.force,d.forcePrev);var _=e.len(g)*.5;f+=_*d.mass,this._swingingArr[l]=v}var b=this.jitterTolerence*this.jitterTolerence*f/m;this._globalSpeed>0&&(b=Math.min(b/this._globalSpeed,1.5)*this._globalSpeed),this._globalSpeed=b;for(var l=0;l<c;l++){var d=this.nodes[l],v=this._swingingArr[l],y=.1*b/(1+b*Math.sqrt(v)),x=e.len(d.force);x>0&&(y=Math.min(x*y,10)/x,e.scaleAndAdd(d.position,d.position,d.force,y))}},a.applyRegionToNodeRepulsion=function(){var c=e.create();return function(d,u){if(d.node)this.applyNodeToNodeRepulsion(d.node,u,!0);else{e.sub(c,u.position,d.centerOfMass);var h=c[0]*c[0]+c[1]*c[1];if(h>this.barnesHutTheta*d.size*d.size){var p=this.scaling*u.mass*d.mass/h;e.scaleAndAdd(u.force,u.force,c,p)}else for(var m=0;m<d.nSubRegions;m++)this.applyRegionToNodeRepulsion(d.subRegions[m],u)}}}(),a.applyNodeToNodeRepulsion=function(){var c=e.create();return function(d,u,h){if(d!=u){e.sub(c,d.position,u.position);var p=c[0]*c[0]+c[1]*c[1];if(p!==0){var m;if(this.preventOverlap){var f=Math.sqrt(p);if(f=f-d.size-u.size,f>0)m=this.scaling*d.mass*u.mass/(f*f);else if(f<0)m=this.scaling*100*d.mass*u.mass;else return}else m=this.scaling*d.mass*u.mass/p;e.scaleAndAdd(d.force,d.force,c,m),e.scaleAndAdd(u.force,u.force,c,-m)}}}}(),a.applyEdgeAttraction=function(){var c=e.create();return function(d){var u=d.source,h=d.target;e.sub(c,u.position,h.position);var p=e.len(c),m;this.edgeWeightInfluence===0?m=1:this.edgeWeightInfluence===1?m=d.weight:m=Math.pow(d.weight,this.edgeWeightInfluence);var f;this.preventOverlap&&(p=p-u.size-h.size,p<=0)||(this.linLogMode?f=-m*Math.log(p+1)/(p+1):f=-m,e.scaleAndAdd(u.force,u.force,c,f),e.scaleAndAdd(h.force,h.force,c,-f))}}(),a.applyNodeGravity=function(){var c=e.create();return function(l){e.sub(c,this.gravityCenter,l.position);var d=e.len(c);e.scaleAndAdd(l.force,l.force,c,this.gravity*l.mass/(d+1))}}(),a.applyNodeStrongGravity=function(){var c=e.create();return function(l){e.sub(c,this.gravityCenter,l.position),e.scaleAndAdd(l.force,l.force,c,this.gravity*l.mass)}}(),a.updateBBox=function(){for(var c=1/0,l=1/0,d=-1/0,u=-1/0,h=0;h<this.nodes.length;h++){var p=this.nodes[h].position;c=Math.min(c,p[0]),l=Math.min(l,p[1]),d=Math.max(d,p[0]),u=Math.max(u,p[1])}this.bbox[0]=c,this.bbox[1]=l,this.bbox[2]=d,this.bbox[3]=u},a.getGlobalSpeed=function(){return this._globalSpeed};var s=null;self.onmessage=function(c){switch(c.data.cmd){case"init":s=new o,s.initNodes(c.data.nodesPosition,c.data.nodesMass,c.data.nodesSize),s.initEdges(c.data.edges,c.data.edgesWeight);break;case"updateConfig":if(s)for(var l in c.data.config)s[l]=c.data.config[l];break;case"update":var d=c.data.steps;if(s){for(var u=0;u<d;u++)s.update();for(var h=s.nodes.length,p=new Float32Array(h*2),u=0;u<h;u++){var m=s.nodes[u];p[u*2]=m.position[0],p[u*2+1]=m.position[1]}self.postMessage({buffer:p.buffer,globalSpeed:s.getGlobalSpeed()},[p.buffer])}else{var f=new Float32Array;self.postMessage({buffer:f.buffer,globalSpeed:s.getGlobalSpeed()},[f.buffer])}break}}}var V5=Zie;var Sv=V5.toString();Sv=Sv.slice(Sv.indexOf("{")+1,Sv.lastIndexOf("}"));var Tv={barnesHutOptimize:!0,barnesHutTheta:1.5,repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,scaling:1,edgeWeightInfluence:1,jitterTolerence:.1,preventOverlap:!1,dissuadeHubs:!1,gravityCenter:null},Ka=function(e){for(var t in Tv)this[t]=Tv[t];if(e)for(var t in e)this[t]=e[t];this._nodes=[],this._edges=[],this._disposed=!1,this._positionTex=new wt({type:ot.FLOAT,flipY:!1,minFilter:ot.NEAREST,magFilter:ot.NEAREST})};Ka.prototype.initData=function(e,t){var i=new Blob([Sv]),r=window.URL.createObjectURL(i);this._worker=new Worker(r),this._worker.onmessage=this._$onupdate.bind(this),this._nodes=e,this._edges=t,this._frame=0;for(var n=e.length,o=t.length,a=new Float32Array(n*2),s=new Float32Array(n),c=new Float32Array(n),l=new Float32Array(o*2),d=new Float32Array(o),u=0;u<e.length;u++){var h=e[u];a[u*2]=h.x,a[u*2+1]=h.y,s[u]=h.mass==null?1:h.mass,c[u]=h.size==null?1:h.size}for(var u=0;u<t.length;u++){var p=t[u],m=p.node1,f=p.node2;l[u*2]=m,l[u*2+1]=f,d[u]=p.weight==null?1:p.weight}var g=Math.ceil(Math.sqrt(e.length)),v=g,_=new Float32Array(g*v*4),b=this._positionTex;b.width=g,b.height=v,b.pixels=_,this._worker.postMessage({cmd:"init",nodesPosition:a,nodesMass:s,nodesSize:c,edges:l,edgesWeight:d}),this._globalSpeed=1/0};Ka.prototype.updateOption=function(e){var t={};for(var i in Tv)t[i]=Tv[i];var r=this._nodes,n=this._edges,o=r.length;if(o>5e4?t.jitterTolerence=10:o>5e3?t.jitterTolerence=1:t.jitterTolerence=.1,o>100?t.scaling=2:t.scaling=10,o>1e3?t.barnesHutOptimize=!0:t.barnesHutOptimize=!1,e)for(var i in Tv)e[i]!=null&&(t[i]=e[i]);if(!t.gravityCenter){for(var a=[1/0,1/0],s=[-1/0,-1/0],c=0;c<r.length;c++)a[0]=Math.min(r[c].x,a[0]),a[1]=Math.min(r[c].y,a[1]),s[0]=Math.max(r[c].x,s[0]),s[1]=Math.max(r[c].y,s[1]);t.gravityCenter=[(a[0]+s[0])*.5,(a[1]+s[1])*.5]}for(var c=0;c<n.length;c++){var l=n[c].node1,d=n[c].node2;r[l].degree=(r[l].degree||0)+1,r[d].degree=(r[d].degree||0)+1}this._worker&&this._worker.postMessage({cmd:"updateConfig",config:t})};Ka.prototype.update=function(e,t,i){t==null&&(t=1),t=Math.max(t,1),this._frame+=t,this._onupdate=i,this._worker&&this._worker.postMessage({cmd:"update",steps:Math.round(t)})};Ka.prototype._$onupdate=function(e){if(!this._disposed){var t=new Float32Array(e.data.buffer);this._globalSpeed=e.data.globalSpeed,this._positionArr=t,this._updateTexture(t),this._onupdate&&this._onupdate()}};Ka.prototype.getNodePositionTexture=function(){return this._positionTex};Ka.prototype.getNodeUV=function(e,t){t=t||[];var i=this._positionTex.width,r=this._positionTex.height;return t[0]=e%i/(i-1),t[1]=Math.floor(e/i)/(r-1),t};Ka.prototype.getNodes=function(){return this._nodes};Ka.prototype.getEdges=function(){return this._edges};Ka.prototype.isFinished=function(e){return this._frame>e};Ka.prototype.getNodePosition=function(e,t){if(t||(t=new Float32Array(this._nodes.length*2)),this._positionArr)for(var i=0;i<this._positionArr.length;i++)t[i]=this._positionArr[i];return t};Ka.prototype._updateTexture=function(e){for(var t=this._positionTex.pixels,i=0,r=0;r<e.length;)t[i++]=e[r++],t[i++]=e[r++],t[i++]=1,t[i++]=1;this._positionTex.dirty()};Ka.prototype.dispose=function(e){this._disposed=!0,this._worker=null};var pT=Ka;var Kie=fr.extend(function(){return{zr:null,viewGL:null,minZoom:.2,maxZoom:5,_needsUpdate:!1,_dx:0,_dy:0,_zoom:1}},function(){this._mouseDownHandler=this._mouseDownHandler.bind(this),this._mouseWheelHandler=this._mouseWheelHandler.bind(this),this._mouseMoveHandler=this._mouseMoveHandler.bind(this),this._mouseUpHandler=this._mouseUpHandler.bind(this),this._update=this._update.bind(this)},{init:function(){var e=this.zr;e.on("mousedown",this._mouseDownHandler),e.on("mousewheel",this._mouseWheelHandler),e.on("globalout",this._mouseUpHandler),e.animation.on("frame",this._update)},setTarget:function(e){this._target=e},setZoom:function(e){this._zoom=Math.max(Math.min(e,this.maxZoom),this.minZoom),this._needsUpdate=!0},setOffset:function(e){this._dx=e[0],this._dy=e[1],this._needsUpdate=!0},getZoom:function(){return this._zoom},getOffset:function(){return[this._dx,this._dy]},_update:function(){if(this._target&&this._needsUpdate){var e=this._target,t=this._zoom;e.position.x=this._dx,e.position.y=this._dy,e.scale.set(t,t,t),this.zr.refresh(),this._needsUpdate=!1,this.trigger("update")}},_mouseDownHandler:function(e){if(!e.target){var t=e.offsetX,i=e.offsetY;if(!(this.viewGL&&!this.viewGL.containPoint(t,i))){this.zr.on("mousemove",this._mouseMoveHandler),this.zr.on("mouseup",this._mouseUpHandler);var r=this._convertPos(t,i);this._x=r.x,this._y=r.y}}},_convertPos:function(e,t){var i=this.viewGL.camera,r=this.viewGL.viewport;return{x:(e-r.x)/r.width*(i.right-i.left)+i.left,y:(t-r.y)/r.height*(i.bottom-i.top)+i.top}},_mouseMoveHandler:function(e){var t=this._convertPos(e.offsetX,e.offsetY);this._dx+=t.x-this._x,this._dy+=t.y-this._y,this._x=t.x,this._y=t.y,this._needsUpdate=!0},_mouseUpHandler:function(e){this.zr.off("mousemove",this._mouseMoveHandler),this.zr.off("mouseup",this._mouseUpHandler)},_mouseWheelHandler:function(e){e=e.event;var t=e.wheelDelta||-e.detail;if(t!==0){var i=e.offsetX,r=e.offsetY;if(!(this.viewGL&&!this.viewGL.containPoint(i,r))){var n=t>0?1.1:.9,o=Math.max(Math.min(this._zoom*n,this.maxZoom),this.minZoom);n=o/this._zoom;var a=this._convertPos(i,r),s=(a.x-this._dx)*(n-1),c=(a.y-this._dy)*(n-1);this._dx-=s,this._dy-=c,this._zoom=o,this._needsUpdate=!0}}},dispose:function(){var e=this.zr;e.off("mousedown",this._mouseDownHandler),e.off("mousemove",this._mouseMoveHandler),e.off("mouseup",this._mouseUpHandler),e.off("mousewheel",this._mouseWheelHandler),e.off("globalout",this._mouseUpHandler),e.animation.off("frame",this._update)}}),z5=Kie;var U5=`@export ecgl.lines2D.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec2 position: POSITION;
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;

#ifdef POSITIONTEXTURE_ENABLED
uniform sampler2D positionTexture;
#endif

void main()
{
 gl_Position = worldViewProjection * vec4(position, -10.0, 1.0);

 v_Color = a_Color;
}

@end

@export ecgl.lines2D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;

void main()
{
 gl_FragColor = color * v_Color;
}
@end


@export ecgl.meshLines2D.vertex

attribute vec2 position: POSITION;
attribute vec2 normal;
attribute float offset;
attribute vec4 a_Color : COLOR;

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;

varying vec4 v_Color;
varying float v_Miter;

void main()
{
 vec4 p2 = worldViewProjection * vec4(position + normal, -10.0, 1.0);
 gl_Position = worldViewProjection * vec4(position, -10.0, 1.0);

 p2.xy /= p2.w;
 gl_Position.xy /= gl_Position.w;

 vec2 N = normalize(p2.xy - gl_Position.xy);
 gl_Position.xy += N * offset / viewport.zw * 2.0;

 gl_Position.xy *= gl_Position.w;

 v_Color = a_Color;
}
@end


@export ecgl.meshLines2D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;
varying float v_Miter;

void main()
{
 gl_FragColor = color * v_Color;
}

@end`;var Mx=bi.vec2;F.Shader.import(U5);var Qie=1,H5=gn.extend({type:"graphGL",__ecgl__:!0,init:function(e,t){this.groupGL=new F.Node,this.viewGL=new Do("orthographic"),this.viewGL.camera.left=this.viewGL.camera.right=0,this.viewGL.add(this.groupGL),this._pointsBuilder=new Rd(!0,t),this._forceEdgesMesh=new F.Mesh({material:new F.Material({shader:F.createShader("ecgl.forceAtlas2.edges"),transparent:!0,depthMask:!1,depthTest:!1}),$ignorePicking:!0,geometry:new F.Geometry({attributes:{node:new F.Geometry.Attribute("node","float",2),color:new F.Geometry.Attribute("color","float",4,"COLOR")},dynamic:!0,mainAttribute:"node"}),renderOrder:-1,mode:F.Mesh.LINES}),this._edgesMesh=new F.Mesh({material:new F.Material({shader:F.createShader("ecgl.meshLines2D"),transparent:!0,depthMask:!1,depthTest:!1}),$ignorePicking:!0,geometry:new Dx({useNativeLine:!1,dynamic:!0}),renderOrder:-1,culling:!1}),this._layoutId=0,this._control=new z5({zr:t.getZr(),viewGL:this.viewGL}),this._control.setTarget(this.groupGL),this._control.init(),this._clickHandler=this._clickHandler.bind(this)},render:function(e,t,i){this.groupGL.add(this._pointsBuilder.rootNode),this._model=e,this._api=i,this._initLayout(e,t,i),this._pointsBuilder.update(e,t,i),this._forceLayoutInstance instanceof Ix||this.groupGL.remove(this._forceEdgesMesh),this._updateCamera(e,i),this._control.off("update"),this._control.on("update",function(){i.dispatchAction({type:"graphGLRoam",seriesId:e.id,zoom:this._control.getZoom(),offset:this._control.getOffset()}),this._pointsBuilder.updateView(this.viewGL.camera)},this),this._control.setZoom(St.firstNotNull(e.get("zoom"),1)),this._control.setOffset(e.get("offset")||[0,0]);var r=this._pointsBuilder.getPointsMesh();if(r.off("mousemove",this._mousemoveHandler),r.off("mouseout",this._mouseOutHandler,this),i.getZr().off("click",this._clickHandler),this._pointsBuilder.highlightOnMouseover=!0,e.get("focusNodeAdjacency")){var n=e.get("focusNodeAdjacencyOn");n==="click"?i.getZr().on("click",this._clickHandler):n==="mouseover"&&(r.on("mousemove",this._mousemoveHandler,this),r.on("mouseout",this._mouseOutHandler,this),this._pointsBuilder.highlightOnMouseover=!1)}this._lastMouseOverDataIndex=-1},_clickHandler:function(e){if(!this._layouting){var t=this._pointsBuilder.getPointsMesh().dataIndex;t>=0?this._api.dispatchAction({type:"graphGLFocusNodeAdjacency",seriesId:this._model.id,dataIndex:t}):this._api.dispatchAction({type:"graphGLUnfocusNodeAdjacency",seriesId:this._model.id})}},_mousemoveHandler:function(e){if(!this._layouting){var t=this._pointsBuilder.getPointsMesh().dataIndex;t>=0?t!==this._lastMouseOverDataIndex&&this._api.dispatchAction({type:"graphGLFocusNodeAdjacency",seriesId:this._model.id,dataIndex:t}):this._mouseOutHandler(e),this._lastMouseOverDataIndex=t}},_mouseOutHandler:function(e){this._layouting||(this._api.dispatchAction({type:"graphGLUnfocusNodeAdjacency",seriesId:this._model.id}),this._lastMouseOverDataIndex=-1)},_updateForceEdgesGeometry:function(e,t){var i=this._forceEdgesMesh.geometry,r=t.getEdgeData(),n=0,o=this._forceLayoutInstance,a=r.count()*2;i.attributes.node.init(a),i.attributes.color.init(a),r.each(function(s){var c=e[s];i.attributes.node.set(n,o.getNodeUV(c.node1)),i.attributes.node.set(n+1,o.getNodeUV(c.node2));var l=gr(r,c.dataIndex),d=F.parseColor(l);d[3]*=St.firstNotNull(Er(r,c.dataIndex),1),i.attributes.color.set(n,d),i.attributes.color.set(n+1,d),n+=2}),i.dirty()},_updateMeshLinesGeometry:function(){var t=this._model.getEdgeData(),e=this._edgesMesh.geometry,t=this._model.getEdgeData(),i=this._model.getData().getLayout("points");e.resetOffset(),e.setVertexCount(t.count()*e.getLineVertexCount()),e.setTriangleCount(t.count()*e.getLineTriangleCount());var r=[],n=[],o=["lineStyle","width"];this._originalEdgeColors=new Float32Array(t.count()*4),this._edgeIndicesMap=new Float32Array(t.count()),t.each(function(a){var s=t.graph.getEdgeByIndex(a),c=s.node1.dataIndex*2,l=s.node2.dataIndex*2;r[0]=i[c],r[1]=i[c+1],n[0]=i[l],n[1]=i[l+1];var d=gr(t,s.dataIndex),u=F.parseColor(d);u[3]*=St.firstNotNull(Er(t,s.dataIndex),1);var h=t.getItemModel(s.dataIndex),p=St.firstNotNull(h.get(o),1)*this._api.getDevicePixelRatio();e.addLine(r,n,u,p);for(var m=0;m<4;m++)this._originalEdgeColors[s.dataIndex*4+m]=u[m];this._edgeIndicesMap[s.dataIndex]=a},this),e.dirty()},_updateForceNodesGeometry:function(e){for(var t=this._pointsBuilder.getPointsMesh(),i=[],r=0;r<e.count();r++)this._forceLayoutInstance.getNodeUV(r,i),t.geometry.attributes.position.set(r,i);t.geometry.dirty("position")},_initLayout:function(e,t,i){var r=e.get("layout"),n=e.getGraph(),o=e.getBoxLayoutParams(),a=vd(o,{width:i.getWidth(),height:i.getHeight()});r==="force"&&(r="forceAtlas2"),this.stopLayout(e,t,i,{beforeLayout:!0});var s=e.getData(),c=e.getData();if(r==="forceAtlas2"){var l=e.getModel("forceAtlas2"),d=this._forceLayoutInstance,u=[],h=[],p=s.getDataExtent("value"),m=c.getDataExtent("value"),f=St.firstNotNull(l.get("edgeWeight"),1),g=St.firstNotNull(l.get("nodeWeight"),1);typeof f=="number"&&(f=[f,f]),typeof g=="number"&&(g=[g,g]);var v=0,_={},b=new Float32Array(s.count()*2);if(n.eachNode(function(x){var w=x.dataIndex,I=s.get("value",w),S,E;if(s.hasItemOption){var N=s.getItemModel(w);S=N.get("x"),E=N.get("y")}S==null&&(S=a.x+Math.random()*a.width,E=a.y+Math.random()*a.height),b[v*2]=S,b[v*2+1]=E,_[x.id]=v++;var M=qa.linearMap(I,p,g);isNaN(M)&&(isNaN(g[0])?M=1:M=g[0]),u.push({x:S,y:E,mass:M,size:s.getItemVisual(w,"symbolSize")})}),s.setLayout("points",b),n.eachEdge(function(x){var w=x.dataIndex,I=s.get("value",w),S=qa.linearMap(I,m,f);isNaN(S)&&(isNaN(f[0])?S=1:S=f[0]),h.push({node1:_[x.node1.id],node2:_[x.node2.id],weight:S,dataIndex:w})}),!d){var y=l.get("GPU");this._forceLayoutInstance&&(y&&!(this._forceLayoutInstance instanceof Ix)||!y&&!(this._forceLayoutInstance instanceof pT))&&(this._forceLayoutInstanceToDispose=this._forceLayoutInstance),d=this._forceLayoutInstance=y?new Ix:new pT}d.initData(u,h),d.updateOption(l.option),this._updateForceEdgesGeometry(d.getEdges(),e),this._updatePositionTexture(),i.dispatchAction({type:"graphGLStartLayout",from:this.uid})}else{var b=new Float32Array(s.count()*2),v=0;n.eachNode(function(I){var S=I.dataIndex,E,N;if(s.hasItemOption){var M=s.getItemModel(S);E=M.get("x"),N=M.get("y")}b[v++]=E,b[v++]=N}),s.setLayout("points",b),this._updateAfterLayout(e,t,i)}},_updatePositionTexture:function(){var e=this._forceLayoutInstance.getNodePositionTexture();this._pointsBuilder.setPositionTexture(e),this._forceEdgesMesh.material.set("positionTex",e)},startLayout:function(e,t,o,r){if(!(r&&r.from!=null&&r.from!==this.uid)){var n=this.viewGL,o=this._api,a=this._forceLayoutInstance,s=this._model.getData(),c=this._model.getModel("forceAtlas2");if(a&&(this.groupGL.remove(this._edgesMesh),this.groupGL.add(this._forceEdgesMesh),!!this._forceLayoutInstance)){this._updateForceNodesGeometry(e.getData()),this._pointsBuilder.hideLabels();var l=this,d=this._layoutId=Qie++,u=c.getShallow("maxSteps"),h=c.getShallow("steps"),p=0,m=Math.max(h*2,20),f=function(g){if(g===l._layoutId){if(a.isFinished(u)){o.dispatchAction({type:"graphGLStopLayout",from:l.uid}),o.dispatchAction({type:"graphGLFinishLayout",points:s.getLayout("points"),from:l.uid});return}a.update(n.layer.renderer,h,function(){l._updatePositionTexture(),p+=h,p>=m&&(l._syncNodePosition(e),p=0),o.getZr().refresh(),uv(function(){f(g)})})}};uv(function(){l._forceLayoutInstanceToDispose&&(l._forceLayoutInstanceToDispose.dispose(n.layer.renderer),l._forceLayoutInstanceToDispose=null),f(d)}),this._layouting=!0}}},stopLayout:function(e,t,i,r){r&&r.from!=null&&r.from!==this.uid||(this._layoutId=0,this.groupGL.remove(this._forceEdgesMesh),this.groupGL.add(this._edgesMesh),this._forceLayoutInstance&&this.viewGL.layer&&(r&&r.beforeLayout||(this._syncNodePosition(e),this._updateAfterLayout(e,t,i)),this._api.getZr().refresh(),this._layouting=!1))},_syncNodePosition:function(e){var t=this._forceLayoutInstance.getNodePosition(this.viewGL.layer.renderer);e.getData().setLayout("points",t),e.setNodePosition(t)},_updateAfterLayout:function(e,t,i){this._updateMeshLinesGeometry(),this._pointsBuilder.removePositionTexture(),this._pointsBuilder.updateLayout(e,t,i),this._pointsBuilder.updateView(this.viewGL.camera),this._pointsBuilder.updateLabels(),this._pointsBuilder.showLabels()},focusNodeAdjacency:function(e,t,i,r){var n=this._model.getData();this._downplayAll();var o=r.dataIndex,a=n.graph,s=[],c=a.getNodeByIndex(o);s.push(c),c.edges.forEach(function(d){d.dataIndex<0||(d.node1!==c&&s.push(d.node1),d.node2!==c&&s.push(d.node2))},this),this._pointsBuilder.fadeOutAll(.05),this._fadeOutEdgesAll(.05),s.forEach(function(d){this._pointsBuilder.highlight(n,d.dataIndex)},this),this._pointsBuilder.updateLabels(s.map(function(d){return d.dataIndex}));var l=[];c.edges.forEach(function(d){d.dataIndex>=0&&(this._highlightEdge(d.dataIndex),l.push(d))},this),this._focusNodes=s,this._focusEdges=l},unfocusNodeAdjacency:function(e,t,i,r){this._downplayAll(),this._pointsBuilder.fadeInAll(),this._fadeInEdgesAll(),this._pointsBuilder.updateLabels()},_highlightEdge:function(e){var t=this._model.getEdgeData().getItemModel(e),i=F.parseColor(t.get("emphasis.lineStyle.color")||t.get("lineStyle.color")),r=St.firstNotNull(t.get("emphasis.lineStyle.opacity"),t.get("lineStyle.opacity"),1);i[3]*=r,this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[e],i)},_downplayAll:function(){this._focusNodes&&this._focusNodes.forEach(function(e){this._pointsBuilder.downplay(this._model.getData(),e.dataIndex)},this),this._focusEdges&&this._focusEdges.forEach(function(e){this._downplayEdge(e.dataIndex)},this)},_downplayEdge:function(e){var t=this._getColor(e,[]);this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[e],t)},_setEdgeFade:function(){var e=[];return function(t,i){this._getColor(t,e),e[3]*=i,this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[t],e)}}(),_getColor:function(e,t){for(var i=0;i<4;i++)t[i]=this._originalEdgeColors[e*4+i];return t},_fadeOutEdgesAll:function(e){var t=this._model.getData().graph;t.eachEdge(function(i){this._setEdgeFade(i.dataIndex,e)},this)},_fadeInEdgesAll:function(){this._fadeOutEdgesAll(1)},_updateCamera:function(e,t){this.viewGL.setViewport(0,0,t.getWidth(),t.getHeight(),t.getDevicePixelRatio());for(var i=this.viewGL.camera,r=e.getData(),n=r.getLayout("points"),o=Mx.create(1/0,1/0),a=Mx.create(-1/0,-1/0),s=[],c=0;c<n.length;)s[0]=n[c++],s[1]=n[c++],Mx.min(o,o,s),Mx.max(a,a,s);var l=(a[1]+o[1])/2,d=(a[0]+o[0])/2;if(!(d>i.left&&d<i.right&&l<i.bottom&&l>i.top)){var u=Math.max(a[0]-o[0],10),h=u/t.getWidth()*t.getHeight();u*=1.4,h*=1.4,o[0]-=u*.2,i.left=o[0],i.top=l-h/2,i.bottom=l+h/2,i.right=u+o[0],i.near=0,i.far=100}},dispose:function(){var e=this.viewGL.layer.renderer;this._forceLayoutInstance&&this._forceLayoutInstance.dispose(e),this.groupGL.removeAll(),this._layoutId=-1,this._pointsBuilder.dispose()},remove:function(){this.groupGL.removeAll(),this._control.dispose()}});function kx(e){return e instanceof Array||(e=[e,e]),e}function j5(e){e.registerChartView(H5),e.registerSeriesModel(R5),e.registerVisual(function(i){let r={};i.eachSeriesByType("graphGL",function(n){var o=n.getCategoriesData(),a=n.getData(),s={};o.each(function(c){var l=o.getName(c);s["ec-"+l]=c;var d=o.getItemModel(c),u=d.getModel("itemStyle").getItemStyle();u.fill||(u.fill=n.getColorFromPalette(l,r)),o.setItemVisual(c,"style",u);var h=["symbol","symbolSize","symbolKeepAspect"];for(let m=0;m<h.length;m++){var p=d.getShallow(h[m],!0);p!=null&&o.setItemVisual(c,h[m],p)}}),o.count()&&a.each(function(c){var l=a.getItemModel(c);let d=l.getShallow("category");if(d!=null){typeof d=="string"&&(d=s["ec-"+d]);var u=o.getItemVisual(d,"style"),h=a.ensureUniqueItemVisual(c,"style");Re.extend(h,u);var p=["symbol","symbolSize","symbolKeepAspect"];for(let m=0;m<p.length;m++)a.setItemVisual(c,p[m],o.getItemVisual(d,p[m]))}})})}),e.registerVisual(function(i){i.eachSeriesByType("graphGL",function(r){var n=r.getGraph(),o=r.getEdgeData(),a=kx(r.get("edgeSymbol")),s=kx(r.get("edgeSymbolSize"));o.setVisual("drawType","stroke"),o.setVisual("fromSymbol",a&&a[0]),o.setVisual("toSymbol",a&&a[1]),o.setVisual("fromSymbolSize",s&&s[0]),o.setVisual("toSymbolSize",s&&s[1]),o.setVisual("style",r.getModel("lineStyle").getLineStyle()),o.each(function(c){var l=o.getItemModel(c),d=n.getEdgeByIndex(c),u=kx(l.getShallow("symbol",!0)),h=kx(l.getShallow("symbolSize",!0)),p=l.getModel("lineStyle").getLineStyle(),m=o.ensureUniqueItemVisual(c,"style");switch(Re.extend(m,p),m.stroke){case"source":{var f=d.node1.getVisual("style");m.stroke=f&&f.fill;break}case"target":{var f=d.node2.getVisual("style");m.stroke=f&&f.fill;break}}u[0]&&d.setVisual("fromSymbol",u[0]),u[1]&&d.setVisual("toSymbol",u[1]),h[0]&&d.setVisual("fromSymbolSize",h[0]),h[1]&&d.setVisual("toSymbolSize",h[1])})})}),e.registerAction({type:"graphGLRoam",event:"graphglroam",update:"series.graphGL:roam"},function(i,r){r.eachComponent({mainType:"series",query:i},function(n){n.setView(i)})});function t(){}e.registerAction({type:"graphGLStartLayout",event:"graphgllayoutstarted",update:"series.graphGL:startLayout"},t),e.registerAction({type:"graphGLStopLayout",event:"graphgllayoutstopped",update:"series.graphGL:stopLayout"},t),e.registerAction({type:"graphGLFocusNodeAdjacency",event:"graphGLFocusNodeAdjacency",update:"series.graphGL:focusNodeAdjacency"},t),e.registerAction({type:"graphGLUnfocusNodeAdjacency",event:"graphGLUnfocusNodeAdjacency",update:"series.graphGL:unfocusNodeAdjacency"},t)}ji(j5);var G5=mn.extend({type:"series.flowGL",dependencies:["geo","grid","bmap"],visualStyleAccessPath:"itemStyle",getInitialData:function(e,t){var i=this.get("coordinateSystem"),r=i==="geo"?["lng","lat"]:qb(i)||["x","y"];r.push("vx","vy");var n=yr.createDimensions(this.getSource(),{coordDimensions:r,encodeDefine:this.get("encode"),dimensionsDefine:this.get("dimensions")}),o=new Ln(n,this);return o.initData(this.getSource()),o},defaultOption:{coordinateSystem:"cartesian2d",zlevel:10,supersampling:1,particleType:"point",particleDensity:128,particleSize:1,particleSpeed:1,particleTrail:2,colorTexture:null,gridWidth:"auto",gridHeight:"auto",itemStyle:{color:"#fff",opacity:.8}}});var Jie=Jt.extend(function(){return{dynamic:!0,attributes:{position:new Jt.Attribute("position","float",3,"POSITION")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setLineCount:function(e){var t=this.attributes,i=4*e,r=2*e;this.vertexCount!==i&&t.position.init(i),this.triangleCount!==r&&(r===0?this.indices=null:this.indices=this.vertexCount>65535?new Uint32Array(r*3):new Uint16Array(r*3))},addLine:function(e){var t=this._vertexOffset;this.attributes.position.set(t,[e[0],e[1],1]),this.attributes.position.set(t+1,[e[0],e[1],-1]),this.attributes.position.set(t+2,[e[0],e[1],2]),this.attributes.position.set(t+3,[e[0],e[1],-2]),this.setTriangleIndices(this._faceOffset++,[t,t+1,t+2]),this.setTriangleIndices(this._faceOffset++,[t+1,t+2,t+3]),this._vertexOffset+=4}}),$5=Jie;var W5=`@export ecgl.vfParticle.particle.fragment

uniform sampler2D particleTexture;
uniform sampler2D spawnTexture;
uniform sampler2D velocityTexture;

uniform float deltaTime;
uniform float elapsedTime;

uniform float speedScaling : 1.0;

uniform vec2 textureSize;
uniform vec4 region : [0, 0, 1, 1];
uniform float firstFrameTime;

varying vec2 v_Texcoord;


void main()
{
 vec4 p = texture2D(particleTexture, v_Texcoord);
 bool spawn = false;
 if (p.w <= 0.0) {
 p = texture2D(spawnTexture, fract(v_Texcoord + elapsedTime / 10.0));
 p.w -= firstFrameTime;
 spawn = true;
 }
 vec2 v = texture2D(velocityTexture, fract(p.xy * region.zw + region.xy)).xy;
 v = (v - 0.5) * 2.0;
 p.z = length(v);
 p.xy += v * deltaTime / 10.0 * speedScaling;
 p.w -= deltaTime;

 if (spawn || p.xy != fract(p.xy)) {
 p.z = 0.0;
 }
 p.xy = fract(p.xy);

 gl_FragColor = p;
}
@end

@export ecgl.vfParticle.renderPoints.vertex

#define PI 3.1415926

attribute vec2 texcoord : TEXCOORD_0;

uniform sampler2D particleTexture;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

uniform float size : 1.0;

varying float v_Mag;
varying vec2 v_Uv;

void main()
{
 vec4 p = texture2D(particleTexture, texcoord);

 if (p.w > 0.0 && p.z > 1e-5) {
 gl_Position = worldViewProjection * vec4(p.xy * 2.0 - 1.0, 0.0, 1.0);
 }
 else {
 gl_Position = vec4(100000.0, 100000.0, 100000.0, 1.0);
 }

 v_Mag = p.z;
 v_Uv = p.xy;

 gl_PointSize = size;
}

@end

@export ecgl.vfParticle.renderPoints.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
uniform sampler2D gradientTexture;
uniform sampler2D colorTexture;
uniform sampler2D spriteTexture;

varying float v_Mag;
varying vec2 v_Uv;

void main()
{
 gl_FragColor = color;
#ifdef SPRITETEXTURE_ENABLED
 gl_FragColor *= texture2D(spriteTexture, gl_PointCoord);
 if (color.a == 0.0) {
 discard;
 }
#endif
#ifdef GRADIENTTEXTURE_ENABLED
 gl_FragColor *= texture2D(gradientTexture, vec2(v_Mag, 0.5));
#endif
#ifdef COLORTEXTURE_ENABLED
 gl_FragColor *= texture2D(colorTexture, v_Uv);
#endif
}

@end

@export ecgl.vfParticle.renderLines.vertex

#define PI 3.1415926

attribute vec3 position : POSITION;

uniform sampler2D particleTexture;
uniform sampler2D prevParticleTexture;

uniform float size : 1.0;
uniform vec4 vp: VIEWPORT;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

varying float v_Mag;
varying vec2 v_Uv;

@import clay.util.rand

void main()
{
 vec4 p = texture2D(particleTexture, position.xy);
 vec4 p2 = texture2D(prevParticleTexture, position.xy);

 p.xy = p.xy * 2.0 - 1.0;
 p2.xy = p2.xy * 2.0 - 1.0;

 if (p.w > 0.0 && p.z > 1e-5) {
 vec2 dir = normalize(p.xy - p2.xy);
 vec2 norm = vec2(dir.y / vp.z, -dir.x / vp.w) * sign(position.z) * size;
 if (abs(position.z) == 2.0) {
 gl_Position = vec4(p.xy + norm, 0.0, 1.0);
 v_Uv = p.xy;
 v_Mag = p.z;
 }
 else {
 gl_Position = vec4(p2.xy + norm, 0.0, 1.0);
 v_Mag = p2.z;
 v_Uv = p2.xy;
 }
 gl_Position = worldViewProjection * gl_Position;
 }
 else {
 gl_Position = vec4(100000.0, 100000.0, 100000.0, 1.0);
 }
}

@end

@export ecgl.vfParticle.renderLines.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
uniform sampler2D gradientTexture;
uniform sampler2D colorTexture;

varying float v_Mag;
varying vec2 v_Uv;

void main()
{
 gl_FragColor = color;
 #ifdef GRADIENTTEXTURE_ENABLED
 gl_FragColor *= texture2D(gradientTexture, vec2(v_Mag, 0.5));
#endif
#ifdef COLORTEXTURE_ENABLED
 gl_FragColor *= texture2D(colorTexture, v_Uv);
#endif
}

@end
`;qe.import(W5);function ere(e){var t=document.createElement("canvas");t.width=t.height=e;var i=t.getContext("2d");return i.fillStyle="#fff",i.arc(e/2,e/2,e/2,0,Math.PI*2),i.fill(),t}var fT=function(){this.motionBlurFactor=.99,this.vectorFieldTexture=new wt({type:ot.FLOAT,flipY:!1}),this.particleLife=[5,20],this._particleType="point",this._particleSize=1,this.particleColor=[1,1,1,1],this.particleSpeedScaling=1,this._thisFrameTexture=null,this._particlePass=null,this._spawnTexture=null,this._particleTexture0=null,this._particleTexture1=null,this._particlePointsMesh=null,this._surfaceFrameBuffer=null,this._elapsedTime=0,this._scene=null,this._camera=null,this._lastFrameTexture=null,this._supersampling=1,this._downsampleTextures=[],this._width=512,this._height=512,this.init()};fT.prototype={constructor:fT,init:function(){var e={type:ot.FLOAT,minFilter:ot.NEAREST,magFilter:ot.NEAREST,useMipmap:!1};this._spawnTexture=new wt(e),this._particleTexture0=new wt(e),this._particleTexture1=new wt(e),this._frameBuffer=new tr({depthBuffer:!1}),this._particlePass=new cr({fragment:qe.source("ecgl.vfParticle.particle.fragment")}),this._particlePass.setUniform("velocityTexture",this.vectorFieldTexture),this._particlePass.setUniform("spawnTexture",this._spawnTexture),this._downsamplePass=new cr({fragment:qe.source("clay.compositor.downsample")});var t=new ul({renderOrder:10,material:new In({shader:new qe(qe.source("ecgl.vfParticle.renderPoints.vertex"),qe.source("ecgl.vfParticle.renderPoints.fragment"))}),mode:ul.POINTS,geometry:new Jt({dynamic:!0,mainAttribute:"texcoord0"})}),i=new ul({renderOrder:10,material:new In({shader:new qe(qe.source("ecgl.vfParticle.renderLines.vertex"),qe.source("ecgl.vfParticle.renderLines.fragment"))}),geometry:new $5,culling:!1}),r=new ul({material:new In({shader:new qe(qe.source("ecgl.color.vertex"),qe.source("ecgl.color.fragment"))}),geometry:new Sd});r.material.enableTexture("diffuseMap"),this._particlePointsMesh=t,this._particleLinesMesh=i,this._lastFrameFullQuadMesh=r,this._camera=new pl,this._thisFrameTexture=new wt,this._lastFrameTexture=new wt},setParticleDensity:function(e,t){for(var i=e*t,r=new Float32Array(i*4),n=0,o=this.particleLife,a=0;a<e;a++)for(var s=0;s<t;s++,n++){r[n*4]=Math.random(),r[n*4+1]=Math.random(),r[n*4+2]=Math.random();var c=(o[1]-o[0])*Math.random()+o[0];r[n*4+3]=c}this._particleType==="line"?this._setLineGeometry(e,t):this._setPointsGeometry(e,t),this._spawnTexture.width=e,this._spawnTexture.height=t,this._spawnTexture.pixels=r,this._particleTexture0.width=this._particleTexture1.width=e,this._particleTexture0.height=this._particleTexture1.height=t,this._particlePass.setUniform("textureSize",[e,t])},_setPointsGeometry:function(e,t){var i=e*t,r=this._particlePointsMesh.geometry,n=r.attributes;n.texcoord0.init(i);for(var o=0,a=0;a<e;a++)for(var s=0;s<t;s++,o++)n.texcoord0.value[o*2]=a/e,n.texcoord0.value[o*2+1]=s/t;r.dirty()},_setLineGeometry:function(e,t){var i=e*t,r=this._getParticleMesh().geometry;r.setLineCount(i),r.resetOffset();for(var n=0;n<e;n++)for(var o=0;o<t;o++)r.addLine([n/e,o/t]);r.dirty()},_getParticleMesh:function(){return this._particleType==="line"?this._particleLinesMesh:this._particlePointsMesh},update:function(e,t,i,r){var n=this._getParticleMesh(),o=this._frameBuffer,a=this._particlePass;r&&this._updateDownsampleTextures(e,t),n.material.set("size",this._particleSize*this._supersampling),n.material.set("color",this.particleColor),a.setUniform("speedScaling",this.particleSpeedScaling),o.attach(this._particleTexture1),a.setUniform("firstFrameTime",r?(this.particleLife[1]+this.particleLife[0])/2:0),a.setUniform("particleTexture",this._particleTexture0),a.setUniform("deltaTime",i),a.setUniform("elapsedTime",this._elapsedTime),a.render(e,o),n.material.set("particleTexture",this._particleTexture1),n.material.set("prevParticleTexture",this._particleTexture0),o.attach(this._thisFrameTexture),o.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT);var s=this._lastFrameFullQuadMesh;s.material.set("diffuseMap",this._lastFrameTexture),s.material.set("color",[1,1,1,this.motionBlurFactor]),this._camera.update(!0),e.renderPass([s,n],this._camera),o.unbind(e),this._downsample(e),this._swapTexture(),this._elapsedTime+=i},_downsample:function(e){var t=this._downsampleTextures;if(t.length!==0)for(var i=0,r=this._thisFrameTexture,n=t[i];n;)this._frameBuffer.attach(n),this._downsamplePass.setUniform("texture",r),this._downsamplePass.setUniform("textureSize",[r.width,r.height]),this._downsamplePass.render(e,this._frameBuffer),r=n,n=t[++i]},getSurfaceTexture:function(){var e=this._downsampleTextures;return e.length>0?e[e.length-1]:this._lastFrameTexture},setRegion:function(e){this._particlePass.setUniform("region",e)},resize:function(e,t){this._lastFrameTexture.width=e*this._supersampling,this._lastFrameTexture.height=t*this._supersampling,this._thisFrameTexture.width=e*this._supersampling,this._thisFrameTexture.height=t*this._supersampling,this._width=e,this._height=t},setParticleSize:function(e){var t=this._getParticleMesh();if(e<=2){t.material.disableTexture("spriteTexture"),t.material.transparent=!1;return}this._spriteTexture||(this._spriteTexture=new wt),(!this._spriteTexture.image||this._spriteTexture.image.width!==e)&&(this._spriteTexture.image=ere(e),this._spriteTexture.dirty()),t.material.transparent=!0,t.material.enableTexture("spriteTexture"),t.material.set("spriteTexture",this._spriteTexture),this._particleSize=e},setGradientTexture:function(e){var t=this._getParticleMesh().material;t[e?"enableTexture":"disableTexture"]("gradientTexture"),t.setUniform("gradientTexture",e)},setColorTextureImage:function(e,t){var i=this._getParticleMesh().material;i.setTextureImage("colorTexture",e,t,{flipY:!0})},setParticleType:function(e){this._particleType=e},clearFrame:function(e){var t=this._frameBuffer;t.attach(this._lastFrameTexture),t.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT),t.unbind(e)},setSupersampling:function(e){this._supersampling=e,this.resize(this._width,this._height)},_updateDownsampleTextures:function(e,t){for(var i=this._downsampleTextures,r=Math.max(Math.floor(Math.log(this._supersampling/t.getDevicePixelRatio())/Math.log(2)),0),n=2,o=this._width*this._supersampling,a=this._height*this._supersampling,s=0;s<r;s++)i[s]=i[s]||new wt,i[s].width=o/n,i[s].height=a/n,n*=2;for(;s<i.length;s++)i[s].dispose(e);i.length=r},_swapTexture:function(){var e=this._particleTexture0;this._particleTexture0=this._particleTexture1,this._particleTexture1=e;var e=this._thisFrameTexture;this._thisFrameTexture=this._lastFrameTexture,this._lastFrameTexture=e},dispose:function(e){e.disposeFrameBuffer(this._frameBuffer),e.disposeTexture(this.vectorFieldTexture),e.disposeTexture(this._spawnTexture),e.disposeTexture(this._particleTexture0),e.disposeTexture(this._particleTexture1),e.disposeTexture(this._thisFrameTexture),e.disposeTexture(this._lastFrameTexture),e.disposeGeometry(this._particleLinesMesh.geometry),e.disposeGeometry(this._particlePointsMesh.geometry),e.disposeGeometry(this._lastFrameFullQuadMesh.geometry),this._spriteTexture&&e.disposeTexture(this._spriteTexture),this._particlePass.dispose(e),this._downsamplePass.dispose(e),this._downsampleTextures.forEach(function(t){t.dispose(e)})}};var q5=fT;var X5=gn.extend({type:"flowGL",__ecgl__:!0,init:function(e,t){this.viewGL=new Do("orthographic"),this.groupGL=new F.Node,this.viewGL.add(this.groupGL),this._particleSurface=new q5;var i=new F.Mesh({geometry:new F.PlaneGeometry,material:new F.Material({shader:new F.Shader({vertex:F.Shader.source("ecgl.color.vertex"),fragment:F.Shader.source("ecgl.color.fragment")}),transparent:!0})});i.material.enableTexture("diffuseMap"),this.groupGL.add(i),this._planeMesh=i},render:function(e,t,i){var r=this._particleSurface;r.setParticleType(e.get("particleType")),r.setSupersampling(e.get("supersampling")),this._updateData(e,i),this._updateCamera(i.getWidth(),i.getHeight(),i.getDevicePixelRatio());var n=St.firstNotNull(e.get("particleDensity"),128);r.setParticleDensity(n,n);var o=this._planeMesh,a=+new Date,s=this,c=!0;o.__percent=0,o.stopAnimation(),o.animate("",{loop:!0}).when(1e5,{__percent:1}).during(function(){var u=+new Date,h=Math.min(u-a,20);a=a+h,s._renderer&&(r.update(s._renderer,i,h/1e3,c),o.material.set("diffuseMap",r.getSurfaceTexture())),c=!1}).start();var l=e.getModel("itemStyle"),d=F.parseColor(l.get("color"));d[3]*=St.firstNotNull(l.get("opacity"),1),o.material.set("color",d),r.setColorTextureImage(e.get("colorTexture"),i),r.setParticleSize(e.get("particleSize")),r.particleSpeedScaling=e.get("particleSpeed"),r.motionBlurFactor=1-Math.pow(.1,e.get("particleTrail"))},updateTransform:function(e,t,i){this._updateData(e,i)},afterRender:function(e,t,i,r){var n=r.renderer;this._renderer=n},_updateData:function(e,t){var i=e.coordinateSystem,r=i.dimensions.map(function(_){return e.coordDimToDataDim(_)[0]}),n=e.getData(),o=n.getDataExtent(r[0]),a=n.getDataExtent(r[1]),s=e.get("gridWidth"),c=e.get("gridHeight");if(s==null||s==="auto"){var l=(o[1]-o[0])/(a[1]-a[0]);s=Math.round(Math.sqrt(l*n.count()))}(c==null||c==="auto")&&(c=Math.ceil(n.count()/s));var d=this._particleSurface.vectorFieldTexture,u=d.pixels;if(!u||u.length!==c*s*4)u=d.pixels=new Float32Array(s*c*4);else for(var h=0;h<u.length;h++)u[h]=0;var p=0,m=1/0,f=new Float32Array(n.count()*2),g=0,v=[[1/0,1/0],[-1/0,-1/0]];n.each([r[0],r[1],"vx","vy"],function(_,b,y,x){var w=i.dataToPoint([_,b]);f[g++]=w[0],f[g++]=w[1],v[0][0]=Math.min(w[0],v[0][0]),v[0][1]=Math.min(w[1],v[0][1]),v[1][0]=Math.max(w[0],v[1][0]),v[1][1]=Math.max(w[1],v[1][1]);var I=Math.sqrt(y*y+x*x);p=Math.max(p,I),m=Math.min(m,I)}),n.each(["vx","vy"],function(_,b,y){var x=Math.round((f[y*2]-v[0][0])/(v[1][0]-v[0][0])*(s-1)),w=c-1-Math.round((f[y*2+1]-v[0][1])/(v[1][1]-v[0][1])*(c-1)),I=(w*s+x)*4;u[I]=_/p*.5+.5,u[I+1]=b/p*.5+.5,u[I+3]=1}),d.width=s,d.height=c,e.get("coordinateSystem")==="bmap"&&this._fillEmptyPixels(d),d.dirty(),this._updatePlanePosition(v[0],v[1],e,t),this._updateGradientTexture(n.getVisual("visualMeta"),[m,p])},_fillEmptyPixels:function(e){var t=e.pixels,i=e.width,r=e.height;function n(f,g,v){f=Math.max(Math.min(f,i-1),0),g=Math.max(Math.min(g,r-1),0);var _=(g*(i-1)+f)*4;return t[_+3]===0?!1:(v[0]=t[_],v[1]=t[_+1],!0)}function o(f,g,v){v[0]=f[0]+g[0],v[1]=f[1]+g[1]}for(var a=[],s=[],c=[],l=[],d=[],u=0,h=0;h<r;h++)for(var p=0;p<i;p++){var m=(h*(i-1)+p)*4;t[m+3]===0&&(u=a[0]=a[1]=0,n(p-1,h,s)&&(u++,o(s,a,a)),n(p+1,h,c)&&(u++,o(c,a,a)),n(p,h-1,l)&&(u++,o(l,a,a)),n(p,h+1,d)&&(u++,o(d,a,a)),a[0]/=u,a[1]/=u,t[m]=a[0],t[m+1]=a[1]),t[m+3]=1}},_updateGradientTexture:function(e,t){if(!e||!e.length){this._particleSurface.setGradientTexture(null);return}this._gradientTexture=this._gradientTexture||new F.Texture2D({image:document.createElement("canvas")});var i=this._gradientTexture,r=i.image;r.width=200,r.height=1;var n=r.getContext("2d"),o=n.createLinearGradient(0,.5,r.width,.5);e[0].stops.forEach(function(a){var s;t[1]===t[0]?s=0:(s=a.value/t[1],s=Math.min(Math.max(s,0),1)),o.addColorStop(s,a.color)}),n.fillStyle=o,n.fillRect(0,0,r.width,r.height),i.dirty(),this._particleSurface.setGradientTexture(this._gradientTexture)},_updatePlanePosition:function(e,t,i,r){var n=this._limitInViewportAndFullFill(e,t,i,r);e=n.leftTop,t=n.rightBottom,this._particleSurface.setRegion(n.region),this._planeMesh.position.set((e[0]+t[0])/2,r.getHeight()-(e[1]+t[1])/2,0);var o=t[0]-e[0],a=t[1]-e[1];this._planeMesh.scale.set(o/2,a/2,1),this._particleSurface.resize(Math.max(Math.min(o,2048),1),Math.max(Math.min(a,2048),1)),this._renderer&&this._particleSurface.clearFrame(this._renderer)},_limitInViewportAndFullFill:function(e,t,i,r){var n=[Math.max(e[0],0),Math.max(e[1],0)],o=[Math.min(t[0],r.getWidth()),Math.min(t[1],r.getHeight())];if(i.get("coordinateSystem")==="bmap"){var a=i.getData().getDataExtent(i.coordDimToDataDim("lng")[0]),s=Math.floor(a[1]-a[0])>=359;s&&(n[0]>0&&(n[0]=0),o[0]<r.getWidth()&&(o[0]=r.getWidth()))}var c=t[0]-e[0],l=t[1]-e[1],d=o[0]-n[0],u=o[1]-n[1],h=[(n[0]-e[0])/c,1-u/l-(n[1]-e[1])/l,d/c,u/l];return{leftTop:n,rightBottom:o,region:h}},_updateCamera:function(e,t,i){this.viewGL.setViewport(0,0,e,t,i);var r=this.viewGL.camera;r.left=r.bottom=0,r.top=t,r.right=e,r.near=0,r.far=100,r.position.z=10},remove:function(){this._planeMesh.stopAnimation(),this.groupGL.removeAll()},dispose:function(){this._renderer&&this._particleSurface.dispose(this._renderer),this.groupGL.removeAll()}});function Y5(e){e.registerChartView(X5),e.registerSeriesModel(G5)}ji(Y5);var mT=mn.extend({type:"series.linesGL",dependencies:["grid","geo"],visualStyleAccessPath:"lineStyle",visualDrawType:"stroke",streamEnabled:!0,init:function(e){var t=this._processFlatCoordsArray(e.data);this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset,t.flatCoords&&(e.data=new Float32Array(t.count)),mT.superApply(this,"init",arguments)},mergeOption:function(e){var t=this._processFlatCoordsArray(e.data);this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset,t.flatCoords&&(e.data=new Float32Array(t.count)),mT.superApply(this,"mergeOption",arguments)},appendData:function(e){var t=this._processFlatCoordsArray(e.data);t.flatCoords&&(this._flatCoords?(this._flatCoords=hS(this._flatCoords,t.flatCoords),this._flatCoordsOffset=hS(this._flatCoordsOffset,t.flatCoordsOffset)):(this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset),e.data=new Float32Array(t.count)),this.getRawData().appendData(e.data)},_getCoordsFromItemModel:function(e){var t=this.getData().getItemModel(e),i=t.option instanceof Array?t.option:t.getShallow("coords");return i},getLineCoordsCount:function(e){return this._flatCoordsOffset?this._flatCoordsOffset[e*2+1]:this._getCoordsFromItemModel(e).length},getLineCoords:function(e,t){if(this._flatCoordsOffset){for(var i=this._flatCoordsOffset[e*2],r=this._flatCoordsOffset[e*2+1],n=0;n<r;n++)t[n]=t[n]||[],t[n][0]=this._flatCoords[i+n*2],t[n][1]=this._flatCoords[i+n*2+1];return r}else{for(var o=this._getCoordsFromItemModel(e),n=0;n<o.length;n++)t[n]=t[n]||[],t[n][0]=o[n][0],t[n][1]=o[n][1];return o.length}},_processFlatCoordsArray:function(e){var t=0;if(this._flatCoords&&(t=this._flatCoords.length),typeof e[0]=="number"){for(var i=e.length,r=new Uint32Array(i),n=new Float64Array(i),o=0,a=0,s=0,c=0;c<i;){s++;var l=e[c++];r[a++]=o+t,r[a++]=l;for(var d=0;d<l;d++){var u=e[c++],h=e[c++];n[o++]=u,n[o++]=h,c>i}}return{flatCoordsOffset:new Uint32Array(r.buffer,0,a),flatCoords:n,count:s}}return{flatCoordsOffset:null,flatCoords:null,count:e.length}},getInitialData:function(e,t){var i=new Ln(["value"],this);return i.hasItemOption=!1,i.initData(e.data,[],function(r,n,o,a){if(r instanceof Array)return NaN;i.hasItemOption=!0;var s=r.value;if(s!=null)return s instanceof Array?s[a]:s}),i},defaultOption:{coordinateSystem:"geo",zlevel:10,progressive:1e4,progressiveThreshold:5e4,blendMode:"source-over",lineStyle:{opacity:.8},postEffect:{enable:!1,colorCorrection:{exposure:0,brightness:0,contrast:1,saturation:1,enable:!0}}}}),Z5=mT;var K5=gn.extend({type:"linesGL",__ecgl__:!0,init:function(e,t){this.groupGL=new F.Node,this.viewGL=new Do("orthographic"),this.viewGL.add(this.groupGL),this._glViewHelper=new Ax(this.viewGL),this._nativeLinesShader=F.createShader("ecgl.lines3D"),this._meshLinesShader=F.createShader("ecgl.meshLines3D"),this._linesMeshes=[],this._currentStep=0},render:function(e,t,i){this.groupGL.removeAll(),this._glViewHelper.reset(e,i);var r=this._linesMeshes[0];r||(r=this._linesMeshes[0]=this._createLinesMesh(e)),this._linesMeshes.length=1,this.groupGL.add(r),this._updateLinesMesh(e,r,0,e.getData().count()),this.viewGL.setPostEffect(e.getModel("postEffect"),i)},incrementalPrepareRender:function(e,t,i){this.groupGL.removeAll(),this._glViewHelper.reset(e,i),this._currentStep=0,this.viewGL.setPostEffect(e.getModel("postEffect"),i)},incrementalRender:function(e,t,i,r){var n=this._linesMeshes[this._currentStep];n||(n=this._createLinesMesh(t),this._linesMeshes[this._currentStep]=n),this._updateLinesMesh(t,n,e.start,e.end),this.groupGL.add(n),r.getZr().refresh(),this._currentStep++},updateTransform:function(e,t,i){e.coordinateSystem.getRoamTransform&&this._glViewHelper.updateTransform(e,i)},_createLinesMesh:function(e){var t=new F.Mesh({$ignorePicking:!0,material:new F.Material({shader:F.createShader("ecgl.lines3D"),transparent:!0,depthMask:!1,depthTest:!1}),geometry:new Dx({segmentScale:10,useNativeLine:!0,dynamic:!1}),mode:F.Mesh.LINES,culling:!1});return t},_updateLinesMesh:function(e,t,i,r){var n=e.getData();t.material.blend=e.get("blendMode")==="lighter"?F.additiveBlend:null;var o=e.get("lineStyle.curveness")||0,a=e.get("polyline"),s=t.geometry,c=e.coordinateSystem,l=St.firstNotNull(e.get("lineStyle.width"),1);l>1?(t.material.shader!==this._meshLinesShader&&t.material.attachShader(this._meshLinesShader),t.mode=F.Mesh.TRIANGLES):(t.material.shader!==this._nativeLinesShader&&t.material.attachShader(this._nativeLinesShader),t.mode=F.Mesh.LINES),i=i||0,r=r||n.count(),s.resetOffset();var d=0,u=0,h=[],p=[],m=[],f=[],g=[],v=.3,_=.7;function b(){p[0]=h[0]*_+f[0]*v-(h[1]-f[1])*o,p[1]=h[1]*_+f[1]*v-(f[0]-h[0])*o,m[0]=h[0]*v+f[0]*_-(h[1]-f[1])*o,m[1]=h[1]*v+f[1]*_-(f[0]-h[0])*o}if(a||o!==0)for(var y=i;y<r;y++)if(a){var x=e.getLineCoordsCount(y);d+=s.getPolylineVertexCount(x),u+=s.getPolylineTriangleCount(x)}else e.getLineCoords(y,g),this._glViewHelper.dataToPoint(c,g[0],h),this._glViewHelper.dataToPoint(c,g[1],f),b(),d+=s.getCubicCurveVertexCount(h,p,m,f),u+=s.getCubicCurveTriangleCount(h,p,m,f);else{var w=r-i;d+=w*s.getLineVertexCount(),u+=w*s.getLineVertexCount()}s.setVertexCount(d),s.setTriangleCount(u);for(var I=i,S=[],y=i;y<r;y++){F.parseColor(gr(n,I),S);var E=St.firstNotNull(Er(n,I),1);S[3]*=E;for(var x=e.getLineCoords(y,g),N=0;N<x;N++)this._glViewHelper.dataToPoint(c,g[N],g[N]);a?s.addPolyline(g,S,l,0,x):o!==0?(h=g[0],f=g[1],b(),s.addCubicCurve(h,p,m,f,S,l)):s.addPolyline(g,S,l,0,2),I++}},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}});function Q5(e){e.registerChartView(K5),e.registerSeriesModel(Z5)}ji(Q5);var gT=class{constructor(){this.subject=new nC(1),this.subscriptions=new fn}doFilter(t){this.subject.next(t)}dispose(){this.subscriptions.unsubscribe()}notEmpty(t,i){this.subscriptions.add(this.subject.subscribe(r=>{if(r[t]){let n=r[t].currentValue;n!=null&&i(n)}}))}has(t,i){this.subscriptions.add(this.subject.subscribe(r=>{if(r[t]){let n=r[t].currentValue;i(n)}}))}notFirst(t,i){this.subscriptions.add(this.subject.subscribe(r=>{if(r[t]&&!r[t].isFirstChange()){let n=r[t].currentValue;i(n)}}))}notFirstAndEmpty(t,i){this.subscriptions.add(this.subject.subscribe(r=>{if(r[t]&&!r[t].isFirstChange()){let n=r[t].currentValue;n!=null&&i(n)}}))}},J5=new Ye("NGX_ECHARTS_CONFIG"),Jn=(()=>{class e{constructor(i,r,n){this.el=r,this.ngZone=n,this.options=null,this.theme=null,this.initOpts=null,this.merge=null,this.autoResize=!0,this.loading=!1,this.loadingType="default",this.loadingOpts=null,this.chartInit=new We,this.optionsError=new We,this.chartClick=this.createLazyEvent("click"),this.chartDblClick=this.createLazyEvent("dblclick"),this.chartMouseDown=this.createLazyEvent("mousedown"),this.chartMouseMove=this.createLazyEvent("mousemove"),this.chartMouseUp=this.createLazyEvent("mouseup"),this.chartMouseOver=this.createLazyEvent("mouseover"),this.chartMouseOut=this.createLazyEvent("mouseout"),this.chartGlobalOut=this.createLazyEvent("globalout"),this.chartContextMenu=this.createLazyEvent("contextmenu"),this.chartHighlight=this.createLazyEvent("highlight"),this.chartDownplay=this.createLazyEvent("downplay"),this.chartSelectChanged=this.createLazyEvent("selectchanged"),this.chartLegendSelectChanged=this.createLazyEvent("legendselectchanged"),this.chartLegendSelected=this.createLazyEvent("legendselected"),this.chartLegendUnselected=this.createLazyEvent("legendunselected"),this.chartLegendLegendSelectAll=this.createLazyEvent("legendselectall"),this.chartLegendLegendInverseSelect=this.createLazyEvent("legendinverseselect"),this.chartLegendScroll=this.createLazyEvent("legendscroll"),this.chartDataZoom=this.createLazyEvent("datazoom"),this.chartDataRangeSelected=this.createLazyEvent("datarangeselected"),this.chartGraphRoam=this.createLazyEvent("graphroam"),this.chartGeoRoam=this.createLazyEvent("georoam"),this.chartTreeRoam=this.createLazyEvent("treeroam"),this.chartTimelineChanged=this.createLazyEvent("timelinechanged"),this.chartTimelinePlayChanged=this.createLazyEvent("timelineplaychanged"),this.chartRestore=this.createLazyEvent("restore"),this.chartDataViewChanged=this.createLazyEvent("dataviewchanged"),this.chartMagicTypeChanged=this.createLazyEvent("magictypechanged"),this.chartGeoSelectChanged=this.createLazyEvent("geoselectchanged"),this.chartGeoSelected=this.createLazyEvent("geoselected"),this.chartGeoUnselected=this.createLazyEvent("geounselected"),this.chartAxisAreaSelected=this.createLazyEvent("axisareaselected"),this.chartBrush=this.createLazyEvent("brush"),this.chartBrushEnd=this.createLazyEvent("brushend"),this.chartBrushSelected=this.createLazyEvent("brushselected"),this.chartGlobalCursorTaken=this.createLazyEvent("globalcursortaken"),this.chartRendered=this.createLazyEvent("rendered"),this.chartFinished=this.createLazyEvent("finished"),this.animationFrameID=null,this.chart$=new nC(1),this.resize$=new Ct,this.changeFilter=new gT,this.resizeObFired=!1,this.echarts=i.echarts,this.theme=i.theme||null}ngOnChanges(i){this.changeFilter.doFilter(i)}ngOnInit(){if(!window.ResizeObserver)throw new Error("please install a polyfill for ResizeObserver");this.resizeSub=this.resize$.pipe(d3(100,n3,{leading:!1,trailing:!0})).subscribe(()=>this.resize()),this.autoResize&&(this.resizeOb=this.ngZone.runOutsideAngular(()=>new window.ResizeObserver(i=>{for(let r of i)r.target===this.el.nativeElement&&(this.resizeObFired?this.animationFrameID=window.requestAnimationFrame(()=>{this.resize$.next()}):this.resizeObFired=!0)})),this.resizeOb.observe(this.el.nativeElement)),this.changeFilter.notFirstAndEmpty("options",i=>this.onOptionsChange(i)),this.changeFilter.notFirstAndEmpty("merge",i=>this.setOption(i)),this.changeFilter.has("loading",i=>this.toggleLoading(!!i)),this.changeFilter.notFirst("theme",()=>this.refreshChart())}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&this.resizeSub.unsubscribe(),this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeOb&&this.resizeOb.unobserve(this.el.nativeElement),this.loadingSub&&this.loadingSub.unsubscribe(),this.changeFilter.dispose(),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.chart.resize()}toggleLoading(i){this.chart?i?this.chart.showLoading(this.loadingType,this.loadingOpts):this.chart.hideLoading():this.loadingSub=this.chart$.subscribe(r=>i?r.showLoading(this.loadingType,this.loadingOpts):r.hideLoading())}setOption(i,r){if(this.chart)try{this.chart.setOption(i,r)}catch(n){console.error(n),this.optionsError.emit(n)}}refreshChart(){return Qe(this,null,function*(){this.dispose(),yield this.initChart()})}createChart(){let i=this.el.nativeElement;if(window&&window.getComputedStyle){let r=window.getComputedStyle(i,null).getPropertyValue("height");(!r||r==="0px")&&(!i.style.height||i.style.height==="0px")&&(i.style.height="400px")}return this.ngZone.runOutsideAngular(()=>(typeof this.echarts=="function"?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:n})=>n(i,this.theme,this.initOpts)))}initChart(){return Qe(this,null,function*(){yield this.onOptionsChange(this.options),this.merge&&this.chart&&this.setOption(this.merge)})}onOptionsChange(i){return Qe(this,null,function*(){i&&(this.chart?this.setOption(this.options,!0):(this.chart=yield this.createChart(),this.chart$.next(this.chart),this.chartInit.emit(this.chart),this.setOption(this.options,!0)))})}createLazyEvent(i){return this.chartInit.pipe(An(r=>new al(n=>(r.on(i,o=>this.ngZone.run(()=>n.next(o))),()=>{this.chart&&(this.chart.isDisposed()||r.off(i))}))))}static{this.\u0275fac=function(r){return new(r||e)(G(J5),G(vt),G(st))}}static{this.\u0275dir=xt({type:e,selectors:[["echarts"],["","echarts",""]],inputs:{options:"options",theme:"theme",initOpts:"initOpts",merge:"merge",autoResize:"autoResize",loading:"loading",loadingType:"loadingType",loadingOpts:"loadingOpts"},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartHighlight:"chartHighlight",chartDownplay:"chartDownplay",chartSelectChanged:"chartSelectChanged",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendLegendSelectAll:"chartLegendLegendSelectAll",chartLegendLegendInverseSelect:"chartLegendLegendInverseSelect",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartGraphRoam:"chartGraphRoam",chartGeoRoam:"chartGeoRoam",chartTreeRoam:"chartTreeRoam",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartGeoSelectChanged:"chartGeoSelectChanged",chartGeoSelected:"chartGeoSelected",chartGeoUnselected:"chartGeoUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartGlobalCursorTaken:"chartGlobalCursorTaken",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],standalone:!0,features:[kr]})}}return e})();var tre=e=>({provide:J5,useValue:e}),e8=(()=>{class e{static forRoot(i){return{ngModule:e,providers:[tre(i)]}}static forChild(){return{ngModule:e}}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({})}}return e})();var t8=new RegExp(`(\\:not\\()|(([\\.\\#]?)[-\\w]+)|(?:\\[([-.\\w*\\\\$]+)(?:=(["']?)([^\\]"']*)\\5)?\\])|(\\))|(\\s*,\\s*)`,"g"),Xf=class e{constructor(){this.element=null,this.classNames=[],this.attrs=[],this.notSelectors=[]}static parse(t){let i=[],r=(c,l)=>{l.notSelectors.length>0&&!l.element&&l.classNames.length==0&&l.attrs.length==0&&(l.element="*"),c.push(l)},n=new e,o,a=n,s=!1;for(t8.lastIndex=0;o=t8.exec(t);){if(o[1]){if(s)throw new Error("Nesting :not in a selector is not allowed");s=!0,a=new e,n.notSelectors.push(a)}let c=o[2];if(c){let d=o[3];d==="#"?a.addAttribute("id",c.slice(1)):d==="."?a.addClassName(c.slice(1)):a.setElement(c)}let l=o[4];if(l&&a.addAttribute(a.unescapeAttribute(l),o[6]),o[7]&&(s=!1,a=n),o[8]){if(s)throw new Error("Multiple selectors in :not are not supported");r(i,n),n=a=new e}}return r(i,n),i}unescapeAttribute(t){let i="",r=!1;for(let n=0;n<t.length;n++){let o=t.charAt(n);if(o==="\\"){r=!0;continue}if(o==="$"&&!r)throw new Error(`Error in attribute selector "${t}". Unescaped "$" is not supported. Please escape with "\\$".`);r=!1,i+=o}return i}escapeAttribute(t){return t.replace(/\\/g,"\\\\").replace(/\$/g,"\\$")}isElementSelector(){return this.hasElementSelector()&&this.classNames.length==0&&this.attrs.length==0&&this.notSelectors.length===0}hasElementSelector(){return!!this.element}setElement(t=null){this.element=t}getAttrs(){let t=[];return this.classNames.length>0&&t.push("class",this.classNames.join(" ")),t.concat(this.attrs)}addAttribute(t,i=""){this.attrs.push(t,i&&i.toLowerCase()||"")}addClassName(t){this.classNames.push(t.toLowerCase())}toString(){let t=this.element||"";if(this.classNames&&this.classNames.forEach(i=>t+=`.${i}`),this.attrs)for(let i=0;i<this.attrs.length;i+=2){let r=this.escapeAttribute(this.attrs[i]),n=this.attrs[i+1];t+=`[${r}${n?"="+n:""}]`}return this.notSelectors.forEach(i=>t+=`:not(${i})`),t}},Yx=class e{constructor(){this._elementMap=new Map,this._elementPartialMap=new Map,this._classMap=new Map,this._classPartialMap=new Map,this._attrValueMap=new Map,this._attrValuePartialMap=new Map,this._listContexts=[]}static createNotMatcher(t){let i=new e;return i.addSelectables(t,null),i}addSelectables(t,i){let r=null;t.length>1&&(r=new UT(t),this._listContexts.push(r));for(let n=0;n<t.length;n++)this._addSelectable(t[n],i,r)}_addSelectable(t,i,r){let n=this,o=t.element,a=t.classNames,s=t.attrs,c=new HT(t,i,r);if(o&&(s.length===0&&a.length===0?this._addTerminal(n._elementMap,o,c):n=this._addPartial(n._elementPartialMap,o)),a)for(let l=0;l<a.length;l++){let d=s.length===0&&l===a.length-1,u=a[l];d?this._addTerminal(n._classMap,u,c):n=this._addPartial(n._classPartialMap,u)}if(s)for(let l=0;l<s.length;l+=2){let d=l===s.length-2,u=s[l],h=s[l+1];if(d){let p=n._attrValueMap,m=p.get(u);m||(m=new Map,p.set(u,m)),this._addTerminal(m,h,c)}else{let p=n._attrValuePartialMap,m=p.get(u);m||(m=new Map,p.set(u,m)),n=this._addPartial(m,h)}}}_addTerminal(t,i,r){let n=t.get(i);n||(n=[],t.set(i,n)),n.push(r)}_addPartial(t,i){let r=t.get(i);return r||(r=new e,t.set(i,r)),r}match(t,i){let r=!1,n=t.element,o=t.classNames,a=t.attrs;for(let s=0;s<this._listContexts.length;s++)this._listContexts[s].alreadyMatched=!1;if(r=this._matchTerminal(this._elementMap,n,t,i)||r,r=this._matchPartial(this._elementPartialMap,n,t,i)||r,o)for(let s=0;s<o.length;s++){let c=o[s];r=this._matchTerminal(this._classMap,c,t,i)||r,r=this._matchPartial(this._classPartialMap,c,t,i)||r}if(a)for(let s=0;s<a.length;s+=2){let c=a[s],l=a[s+1],d=this._attrValueMap.get(c);l&&(r=this._matchTerminal(d,"",t,i)||r),r=this._matchTerminal(d,l,t,i)||r;let u=this._attrValuePartialMap.get(c);l&&(r=this._matchPartial(u,"",t,i)||r),r=this._matchPartial(u,l,t,i)||r}return r}_matchTerminal(t,i,r,n){if(!t||typeof i!="string")return!1;let o=t.get(i)||[],a=t.get("*");if(a&&(o=o.concat(a)),o.length===0)return!1;let s,c=!1;for(let l=0;l<o.length;l++)s=o[l],c=s.finalize(r,n)||c;return c}_matchPartial(t,i,r,n){if(!t||typeof i!="string")return!1;let o=t.get(i);return o?o.match(r,n):!1}},UT=class{constructor(t){this.selectors=t,this.alreadyMatched=!1}},HT=class{constructor(t,i,r){this.selector=t,this.cbContext=i,this.listContext=r,this.notSelectors=t.notSelectors}finalize(t,i){let r=!0;return this.notSelectors.length>0&&(!this.listContext||!this.listContext.alreadyMatched)&&(r=!Yx.createNotMatcher(this.notSelectors).match(t,null)),r&&i&&(!this.listContext||!this.listContext.alreadyMatched)&&(this.listContext&&(this.listContext.alreadyMatched=!0),i(this.selector,this.cbContext)),r}};var Sh=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(Sh||{}),ID=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(ID||{}),Lf=function(e){return e[e.None=0]="None",e[e.SignalBased=1]="SignalBased",e[e.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",e}(Lf||{}),i8={name:"custom-elements"},r8={name:"no-errors-schema"};var Oi=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(Oi||{});function ire(e){let t=e.classNames&&e.classNames.length?[8,...e.classNames]:[];return[e.element&&e.element!=="*"?e.element:"",...e.attrs,...t]}function rre(e){let t=e.classNames&&e.classNames.length?[8,...e.classNames]:[];return e.element?[5,e.element,...e.attrs,...t]:e.attrs.length?[3,...e.attrs,...t]:e.classNames&&e.classNames.length?[9,...e.classNames]:[]}function nre(e){let t=ire(e),i=e.notSelectors&&e.notSelectors.length?e.notSelectors.map(r=>rre(r)):[];return t.concat(...i)}function b0(e){return e?Xf.parse(e).map(nre):[]}var Zx;function ore(e){return cre(lre(e.nodes).join("")+`[${e.meaning}]`)}function are(e){return e.id||l6(e)}function l6(e){let t=new jT,i=e.nodes.map(r=>r.visit(t,null));return c6(i.join(""),e.meaning)}var Kx=class{visitText(t,i){return t.value}visitContainer(t,i){return`[${t.children.map(r=>r.visit(this)).join(", ")}]`}visitIcu(t,i){let r=Object.keys(t.cases).map(n=>`${n} {${t.cases[n].visit(this)}}`);return`{${t.expression}, ${t.type}, ${r.join(", ")}}`}visitTagPlaceholder(t,i){return t.isVoid?`<ph tag name="${t.startName}"/>`:`<ph tag name="${t.startName}">${t.children.map(r=>r.visit(this)).join(", ")}</ph name="${t.closeName}">`}visitPlaceholder(t,i){return t.value?`<ph name="${t.name}">${t.value}</ph>`:`<ph name="${t.name}"/>`}visitIcuPlaceholder(t,i){return`<ph icu name="${t.name}">${t.value.visit(this)}</ph>`}visitBlockPlaceholder(t,i){return`<ph block name="${t.startName}">${t.children.map(r=>r.visit(this)).join(", ")}</ph name="${t.closeName}">`}},sre=new Kx;function lre(e){return e.map(t=>t.visit(sre,null))}var jT=class extends Kx{visitIcu(t,i){let r=Object.keys(t.cases).map(n=>`${n} {${t.cases[n].visit(this)}}`);return`{${t.type}, ${r.join(", ")}}`}};function cre(e){Zx??=new TextEncoder;let t=[...Zx.encode(e)],i=hre(t,MD.Big),r=t.length*8,n=new Uint32Array(80),o=1732584193,a=4023233417,s=2562383102,c=271733878,l=3285377520;i[r>>5]|=128<<24-r%32,i[(r+64>>9<<4)+15]=r;for(let d=0;d<i.length;d+=16){let u=o,h=a,p=s,m=c,f=l;for(let g=0;g<80;g++){g<16?n[g]=i[d+g]:n[g]=vT(n[g-3]^n[g-8]^n[g-14]^n[g-16],1);let v=dre(g,a,s,c),_=v[0],b=v[1],y=[vT(o,5),_,l,b,n[g]].reduce(Df);l=c,c=s,s=vT(a,30),a=o,o=y}o=Df(o,u),a=Df(a,h),s=Df(s,p),c=Df(c,m),l=Df(l,f)}return Av(o)+Av(a)+Av(s)+Av(c)+Av(l)}function Av(e){return(e>>>0).toString(16).padStart(8,"0")}function dre(e,t,i,r){return e<20?[t&i|~t&r,1518500249]:e<40?[t^i^r,1859775393]:e<60?[t&i|t&r|i&r,2400959708]:[t^i^r,3395469782]}function n8(e){Zx??=new TextEncoder;let t=Zx.encode(e),i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=o8(i,t.length,0),n=o8(i,t.length,102072);return r==0&&(n==0||n==1)&&(r=r^319790063,n=n^-1801410264),BigInt.asUintN(32,BigInt(r))<<BigInt(32)|BigInt.asUintN(32,BigInt(n))}function c6(e,t=""){let i=n8(e);return t&&(i=BigInt.asUintN(64,i<<BigInt(1))|i>>BigInt(63)&BigInt(1),i+=n8(t)),BigInt.asUintN(63,i).toString()}function o8(e,t,i){let r=2654435769,n=2654435769,o=0,a=t-12;for(;o<=a;o+=12){r+=e.getUint32(o,!0),n+=e.getUint32(o+4,!0),i+=e.getUint32(o+8,!0);let c=a8(r,n,i);r=c[0],n=c[1],i=c[2]}let s=t-o;return i+=t,s>=4?(r+=e.getUint32(o,!0),o+=4,s>=8?(n+=e.getUint32(o,!0),o+=4,s>=9&&(i+=e.getUint8(o++)<<8),s>=10&&(i+=e.getUint8(o++)<<16),s===11&&(i+=e.getUint8(o++)<<24)):(s>=5&&(n+=e.getUint8(o++)),s>=6&&(n+=e.getUint8(o++)<<8),s===7&&(n+=e.getUint8(o++)<<16))):(s>=1&&(r+=e.getUint8(o++)),s>=2&&(r+=e.getUint8(o++)<<8),s===3&&(r+=e.getUint8(o++)<<16)),a8(r,n,i)[2]}function a8(e,t,i){return e-=t,e-=i,e^=i>>>13,t-=i,t-=e,t^=e<<8,i-=e,i-=t,i^=t>>>13,e-=t,e-=i,e^=i>>>12,t-=i,t-=e,t^=e<<16,i-=e,i-=t,i^=t>>>5,e-=t,e-=i,e^=i>>>3,t-=i,t-=e,t^=e<<10,i-=e,i-=t,i^=t>>>15,[e,t,i]}var MD=function(e){return e[e.Little=0]="Little",e[e.Big=1]="Big",e}(MD||{});function Df(e,t){return ure(e,t)[1]}function ure(e,t){let i=(e&65535)+(t&65535),r=(e>>>16)+(t>>>16)+(i>>>16);return[r>>>16,r<<16|i&65535]}function vT(e,t){return e<<t|e>>>32-t}function hre(e,t){let i=e.length+3>>>2,r=[];for(let n=0;n<i;n++)r[n]=pre(e,n*4,t);return r}function s8(e,t){return t>=e.length?0:e[t]}function pre(e,t,i){let r=0;if(i===MD.Big)for(let n=0;n<4;n++)r+=s8(e,t+n)<<24-8*n;else for(let n=0;n<4;n++)r+=s8(e,t+n)<<8*n;return r}var d6=function(e){return e[e.None=0]="None",e[e.Const=1]="Const",e}(d6||{}),Qx=class{constructor(t=d6.None){this.modifiers=t}hasModifier(t){return(this.modifiers&t)!==0}},qc=function(e){return e[e.Dynamic=0]="Dynamic",e[e.Bool=1]="Bool",e[e.String=2]="String",e[e.Int=3]="Int",e[e.Number=4]="Number",e[e.Function=5]="Function",e[e.Inferred=6]="Inferred",e[e.None=7]="None",e}(qc||{}),$l=class extends Qx{constructor(t,i){super(i),this.name=t}visitType(t,i){return t.visitBuiltinType(this,i)}},Us=class extends Qx{constructor(t,i,r=null){super(i),this.value=t,this.typeParams=r}visitType(t,i){return t.visitExpressionType(this,i)}};var Xc=new $l(qc.Dynamic),aa=new $l(qc.Inferred),fre=new $l(qc.Bool),IUe=new $l(qc.Int),y0=new $l(qc.Number),kD=new $l(qc.String),MUe=new $l(qc.Function),Wl=new $l(qc.None),Fh=function(e){return e[e.Minus=0]="Minus",e[e.Plus=1]="Plus",e}(Fh||{}),et=function(e){return e[e.Equals=0]="Equals",e[e.NotEquals=1]="NotEquals",e[e.Identical=2]="Identical",e[e.NotIdentical=3]="NotIdentical",e[e.Minus=4]="Minus",e[e.Plus=5]="Plus",e[e.Divide=6]="Divide",e[e.Multiply=7]="Multiply",e[e.Modulo=8]="Modulo",e[e.And=9]="And",e[e.Or=10]="Or",e[e.BitwiseOr=11]="BitwiseOr",e[e.BitwiseAnd=12]="BitwiseAnd",e[e.Lower=13]="Lower",e[e.LowerEquals=14]="LowerEquals",e[e.Bigger=15]="Bigger",e[e.BiggerEquals=16]="BiggerEquals",e[e.NullishCoalesce=17]="NullishCoalesce",e}(et||{});function mre(e,t){return e==null||t==null?e==t:e.isEquivalent(t)}function u6(e,t,i){let r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(!i(e[n],t[n]))return!1;return!0}function is(e,t){return u6(e,t,(i,r)=>i.isEquivalent(r))}var rr=class{constructor(t,i){this.type=t||null,this.sourceSpan=i||null}prop(t,i){return new ca(this,t,null,i)}key(t,i,r){return new ql(this,t,i,r)}callFn(t,i,r){return new la(this,t,null,i,r)}instantiate(t,i,r){return new Uv(this,t,i,r)}conditional(t,i=null,r){return new ns(this,t,i,null,r)}equals(t,i){return new Si(et.Equals,this,t,null,i)}notEquals(t,i){return new Si(et.NotEquals,this,t,null,i)}identical(t,i){return new Si(et.Identical,this,t,null,i)}notIdentical(t,i){return new Si(et.NotIdentical,this,t,null,i)}minus(t,i){return new Si(et.Minus,this,t,null,i)}plus(t,i){return new Si(et.Plus,this,t,null,i)}divide(t,i){return new Si(et.Divide,this,t,null,i)}multiply(t,i){return new Si(et.Multiply,this,t,null,i)}modulo(t,i){return new Si(et.Modulo,this,t,null,i)}and(t,i){return new Si(et.And,this,t,null,i)}bitwiseOr(t,i,r=!0){return new Si(et.BitwiseOr,this,t,null,i,r)}bitwiseAnd(t,i,r=!0){return new Si(et.BitwiseAnd,this,t,null,i,r)}or(t,i){return new Si(et.Or,this,t,null,i)}lower(t,i){return new Si(et.Lower,this,t,null,i)}lowerEquals(t,i){return new Si(et.LowerEquals,this,t,null,i)}bigger(t,i){return new Si(et.Bigger,this,t,null,i)}biggerEquals(t,i){return new Si(et.BiggerEquals,this,t,null,i)}isBlank(t){return this.equals(Hd,t)}nullishCoalesce(t,i){return new Si(et.NullishCoalesce,this,t,null,i)}toStmt(){return new oo(this,null)}},rs=class e extends rr{constructor(t,i,r){super(i,r),this.name=t}isEquivalent(t){return t instanceof e&&this.name===t.name}isConstant(){return!1}visitExpression(t,i){return t.visitReadVarExpr(this,i)}clone(){return new e(this.name,this.type,this.sourceSpan)}set(t){return new Jx(this.name,t,null,this.sourceSpan)}},Yf=class e extends rr{constructor(t,i,r){super(i,r),this.expr=t}visitExpression(t,i){return t.visitTypeofExpr(this,i)}isEquivalent(t){return t instanceof e&&t.expr.isEquivalent(this.expr)}isConstant(){return this.expr.isConstant()}clone(){return new e(this.expr.clone())}},Ti=class e extends rr{constructor(t,i,r){super(i,r),this.node=t}isEquivalent(t){return t instanceof e&&this.node===t.node}isConstant(){return!1}visitExpression(t,i){return t.visitWrappedNodeExpr(this,i)}clone(){return new e(this.node,this.type,this.sourceSpan)}},Jx=class e extends rr{constructor(t,i,r,n){super(r||i.type,n),this.name=t,this.value=i}isEquivalent(t){return t instanceof e&&this.name===t.name&&this.value.isEquivalent(t.value)}isConstant(){return!1}visitExpression(t,i){return t.visitWriteVarExpr(this,i)}clone(){return new e(this.name,this.value.clone(),this.type,this.sourceSpan)}toDeclStmt(t,i){return new Ro(this.name,this.value,t,i,this.sourceSpan)}toConstDecl(){return this.toDeclStmt(aa,po.Final)}},zv=class e extends rr{constructor(t,i,r,n,o){super(n||r.type,o),this.receiver=t,this.index=i,this.value=r}isEquivalent(t){return t instanceof e&&this.receiver.isEquivalent(t.receiver)&&this.index.isEquivalent(t.index)&&this.value.isEquivalent(t.value)}isConstant(){return!1}visitExpression(t,i){return t.visitWriteKeyExpr(this,i)}clone(){return new e(this.receiver.clone(),this.index.clone(),this.value.clone(),this.type,this.sourceSpan)}},Zf=class e extends rr{constructor(t,i,r,n,o){super(n||r.type,o),this.receiver=t,this.name=i,this.value=r}isEquivalent(t){return t instanceof e&&this.receiver.isEquivalent(t.receiver)&&this.name===t.name&&this.value.isEquivalent(t.value)}isConstant(){return!1}visitExpression(t,i){return t.visitWritePropExpr(this,i)}clone(){return new e(this.receiver.clone(),this.name,this.value.clone(),this.type,this.sourceSpan)}},la=class e extends rr{constructor(t,i,r,n,o=!1){super(r,n),this.fn=t,this.args=i,this.pure=o}get receiver(){return this.fn}isEquivalent(t){return t instanceof e&&this.fn.isEquivalent(t.fn)&&is(this.args,t.args)&&this.pure===t.pure}isConstant(){return!1}visitExpression(t,i){return t.visitInvokeFunctionExpr(this,i)}clone(){return new e(this.fn.clone(),this.args.map(t=>t.clone()),this.type,this.sourceSpan,this.pure)}},ew=class e extends rr{constructor(t,i,r,n){super(r,n),this.tag=t,this.template=i}isEquivalent(t){return t instanceof e&&this.tag.isEquivalent(t.tag)&&u6(this.template.elements,t.template.elements,(i,r)=>i.text===r.text)&&is(this.template.expressions,t.template.expressions)}isConstant(){return!1}visitExpression(t,i){return t.visitTaggedTemplateExpr(this,i)}clone(){return new e(this.tag.clone(),this.template.clone(),this.type,this.sourceSpan)}},Uv=class e extends rr{constructor(t,i,r,n){super(r,n),this.classExpr=t,this.args=i}isEquivalent(t){return t instanceof e&&this.classExpr.isEquivalent(t.classExpr)&&is(this.args,t.args)}isConstant(){return!1}visitExpression(t,i){return t.visitInstantiateExpr(this,i)}clone(){return new e(this.classExpr.clone(),this.args.map(t=>t.clone()),this.type,this.sourceSpan)}},no=class e extends rr{constructor(t,i,r){super(i,r),this.value=t}isEquivalent(t){return t instanceof e&&this.value===t.value}isConstant(){return!0}visitExpression(t,i){return t.visitLiteralExpr(this,i)}clone(){return new e(this.value,this.type,this.sourceSpan)}},Hv=class e{constructor(t,i){this.elements=t,this.expressions=i}clone(){return new e(this.elements.map(t=>t.clone()),this.expressions.map(t=>t.clone()))}},jv=class e{constructor(t,i,r){this.text=t,this.sourceSpan=i,this.rawText=r??i?.toString()??GT($x(t))}clone(){return new e(this.text,this.sourceSpan,this.rawText)}},kh=class{constructor(t,i){this.text=t,this.sourceSpan=i}},$f=class{constructor(t,i,r){this.text=t,this.sourceSpan=i,this.associatedMessage=r}},gre="|",l8="@@",vre="\u241F",tw=class e extends rr{constructor(t,i,r,n,o){super(kD,o),this.metaBlock=t,this.messageParts=i,this.placeHolderNames=r,this.expressions=n}isEquivalent(t){return!1}isConstant(){return!1}visitExpression(t,i){return t.visitLocalizedString(this,i)}clone(){return new e(this.metaBlock,this.messageParts,this.placeHolderNames,this.expressions.map(t=>t.clone()),this.sourceSpan)}serializeI18nHead(){let t=this.metaBlock.description||"";return this.metaBlock.meaning&&(t=`${this.metaBlock.meaning}${gre}${t}`),this.metaBlock.customId&&(t=`${t}${l8}${this.metaBlock.customId}`),this.metaBlock.legacyIds&&this.metaBlock.legacyIds.forEach(i=>{t=`${t}${vre}${i}`}),c8(t,this.messageParts[0].text,this.getMessagePartSourceSpan(0))}getMessagePartSourceSpan(t){return this.messageParts[t]?.sourceSpan??this.sourceSpan}getPlaceholderSourceSpan(t){return this.placeHolderNames[t]?.sourceSpan??this.expressions[t]?.sourceSpan??this.sourceSpan}serializeI18nTemplatePart(t){let i=this.placeHolderNames[t-1],r=this.messageParts[t],n=i.text;return i.associatedMessage?.legacyIds.length===0&&(n+=`${l8}${c6(i.associatedMessage.messageString,i.associatedMessage.meaning)}`),c8(n,r.text,this.getMessagePartSourceSpan(t))}},$x=e=>e.replace(/\\/g,"\\\\"),_re=e=>e.replace(/^:/,"\\:"),bre=e=>e.replace(/:/g,"\\:"),GT=e=>e.replace(/`/g,"\\`").replace(/\${/g,"$\\{");function c8(e,t,i){return e===""?{cooked:t,raw:GT(_re($x(t))),range:i}:{cooked:`:${e}:${t}`,raw:GT(`:${bre($x(e))}:${$x(t)}`),range:i}}var Lc=class e extends rr{constructor(t,i,r=null,n){super(i,n),this.value=t,this.typeParams=r}isEquivalent(t){return t instanceof e&&this.value.name===t.value.name&&this.value.moduleName===t.value.moduleName&&this.value.runtime===t.value.runtime}isConstant(){return!1}visitExpression(t,i){return t.visitExternalExpr(this,i)}clone(){return new e(this.value,this.type,this.typeParams,this.sourceSpan)}};var ns=class e extends rr{constructor(t,i,r=null,n,o){super(n||i.type,o),this.condition=t,this.falseCase=r,this.trueCase=i}isEquivalent(t){return t instanceof e&&this.condition.isEquivalent(t.condition)&&this.trueCase.isEquivalent(t.trueCase)&&mre(this.falseCase,t.falseCase)}isConstant(){return!1}visitExpression(t,i){return t.visitConditionalExpr(this,i)}clone(){return new e(this.condition.clone(),this.trueCase.clone(),this.falseCase?.clone(),this.type,this.sourceSpan)}},Gv=class e extends rr{constructor(t,i){super(null,i),this.url=t}isEquivalent(t){return t instanceof e&&this.url===t.url}isConstant(){return!1}visitExpression(t,i){return t.visitDynamicImportExpr(this,i)}clone(){return new e(this.url,this.sourceSpan)}},Bc=class e extends rr{constructor(t,i){super(fre,i),this.condition=t}isEquivalent(t){return t instanceof e&&this.condition.isEquivalent(t.condition)}isConstant(){return!1}visitExpression(t,i){return t.visitNotExpr(this,i)}clone(){return new e(this.condition.clone(),this.sourceSpan)}},Dr=class e{constructor(t,i=null){this.name=t,this.type=i}isEquivalent(t){return this.name===t.name}clone(){return new e(this.name,this.type)}},Lh=class e extends rr{constructor(t,i,r,n,o){super(r,n),this.params=t,this.statements=i,this.name=o}isEquivalent(t){return(t instanceof e||t instanceof $v)&&is(this.params,t.params)&&is(this.statements,t.statements)}isConstant(){return!1}visitExpression(t,i){return t.visitFunctionExpr(this,i)}toDeclStmt(t,i){return new $v(t,this.params,this.statements,this.type,i,this.sourceSpan)}clone(){return new e(this.params.map(t=>t.clone()),this.statements,this.type,this.sourceSpan,this.name)}},Bh=class e extends rr{constructor(t,i,r,n){super(r,n),this.params=t,this.body=i}isEquivalent(t){return!(t instanceof e)||!is(this.params,t.params)?!1:this.body instanceof rr&&t.body instanceof rr?this.body.isEquivalent(t.body):Array.isArray(this.body)&&Array.isArray(t.body)?is(this.body,t.body):!1}isConstant(){return!1}visitExpression(t,i){return t.visitArrowFunctionExpr(this,i)}clone(){return new e(this.params.map(t=>t.clone()),Array.isArray(this.body)?this.body:this.body.clone(),this.type,this.sourceSpan)}toDeclStmt(t,i){return new Ro(t,this,aa,i,this.sourceSpan)}},Vh=class e extends rr{constructor(t,i,r,n,o=!0){super(r||y0,n),this.operator=t,this.expr=i,this.parens=o}isEquivalent(t){return t instanceof e&&this.operator===t.operator&&this.expr.isEquivalent(t.expr)}isConstant(){return!1}visitExpression(t,i){return t.visitUnaryOperatorExpr(this,i)}clone(){return new e(this.operator,this.expr.clone(),this.type,this.sourceSpan,this.parens)}},Si=class e extends rr{constructor(t,i,r,n,o,a=!0){super(n||i.type,o),this.operator=t,this.rhs=r,this.parens=a,this.lhs=i}isEquivalent(t){return t instanceof e&&this.operator===t.operator&&this.lhs.isEquivalent(t.lhs)&&this.rhs.isEquivalent(t.rhs)}isConstant(){return!1}visitExpression(t,i){return t.visitBinaryOperatorExpr(this,i)}clone(){return new e(this.operator,this.lhs.clone(),this.rhs.clone(),this.type,this.sourceSpan,this.parens)}},ca=class e extends rr{constructor(t,i,r,n){super(r,n),this.receiver=t,this.name=i}get index(){return this.name}isEquivalent(t){return t instanceof e&&this.receiver.isEquivalent(t.receiver)&&this.name===t.name}isConstant(){return!1}visitExpression(t,i){return t.visitReadPropExpr(this,i)}set(t){return new Zf(this.receiver,this.name,t,null,this.sourceSpan)}clone(){return new e(this.receiver.clone(),this.name,this.type,this.sourceSpan)}},ql=class e extends rr{constructor(t,i,r,n){super(r,n),this.receiver=t,this.index=i}isEquivalent(t){return t instanceof e&&this.receiver.isEquivalent(t.receiver)&&this.index.isEquivalent(t.index)}isConstant(){return!1}visitExpression(t,i){return t.visitReadKeyExpr(this,i)}set(t){return new zv(this.receiver,this.index,t,null,this.sourceSpan)}clone(){return new e(this.receiver.clone(),this.index.clone(),this.type,this.sourceSpan)}},Hs=class e extends rr{constructor(t,i,r){super(i,r),this.entries=t}isConstant(){return this.entries.every(t=>t.isConstant())}isEquivalent(t){return t instanceof e&&is(this.entries,t.entries)}visitExpression(t,i){return t.visitLiteralArrayExpr(this,i)}clone(){return new e(this.entries.map(t=>t.clone()),this.type,this.sourceSpan)}},Kf=class e{constructor(t,i,r){this.key=t,this.value=i,this.quoted=r}isEquivalent(t){return this.key===t.key&&this.value.isEquivalent(t.value)}clone(){return new e(this.key,this.value.clone(),this.quoted)}},vl=class e extends rr{constructor(t,i,r){super(i,r),this.entries=t,this.valueType=null,i&&(this.valueType=i.valueType)}isEquivalent(t){return t instanceof e&&is(this.entries,t.entries)}isConstant(){return this.entries.every(t=>t.value.isConstant())}visitExpression(t,i){return t.visitLiteralMapExpr(this,i)}clone(){let t=this.entries.map(i=>i.clone());return new e(t,this.type,this.sourceSpan)}};var zh=new no(null,null,null),Hd=new no(null,aa,null),po=function(e){return e[e.None=0]="None",e[e.Final=1]="Final",e[e.Private=2]="Private",e[e.Exported=4]="Exported",e[e.Static=8]="Static",e}(po||{}),$T=class{constructor(t,i,r){this.text=t,this.multiline=i,this.trailingNewline=r}toString(){return this.multiline?` ${this.text} `:this.text}},iw=class extends $T{constructor(t){super("",!0,!0),this.tags=t}toString(){return wre(this.tags)}},Uh=class{constructor(t=po.None,i=null,r){this.modifiers=t,this.sourceSpan=i,this.leadingComments=r}hasModifier(t){return(this.modifiers&t)!==0}addLeadingComment(t){this.leadingComments=this.leadingComments??[],this.leadingComments.push(t)}},Ro=class e extends Uh{constructor(t,i,r,n,o,a){super(n,o,a),this.name=t,this.value=i,this.type=r||i&&i.type||null}isEquivalent(t){return t instanceof e&&this.name===t.name&&(this.value?!!t.value&&this.value.isEquivalent(t.value):!t.value)}visitStatement(t,i){return t.visitDeclareVarStmt(this,i)}},$v=class e extends Uh{constructor(t,i,r,n,o,a,s){super(o,a,s),this.name=t,this.params=i,this.statements=r,this.type=n||null}isEquivalent(t){return t instanceof e&&is(this.params,t.params)&&is(this.statements,t.statements)}visitStatement(t,i){return t.visitDeclareFunctionStmt(this,i)}},oo=class e extends Uh{constructor(t,i,r){super(po.None,i,r),this.expr=t}isEquivalent(t){return t instanceof e&&this.expr.isEquivalent(t.expr)}visitStatement(t,i){return t.visitExpressionStmt(this,i)}},Rn=class e extends Uh{constructor(t,i=null,r){super(po.None,i,r),this.value=t}isEquivalent(t){return t instanceof e&&this.value.isEquivalent(t.value)}visitStatement(t,i){return t.visitReturnStmt(this,i)}},rw=class e extends Uh{constructor(t,i,r=[],n,o){super(po.None,n,o),this.condition=t,this.trueCase=i,this.falseCase=r}isEquivalent(t){return t instanceof e&&this.condition.isEquivalent(t.condition)&&is(this.trueCase,t.trueCase)&&is(this.falseCase,t.falseCase)}visitStatement(t,i){return t.visitIfStmt(this,i)}};function yre(e=[]){return new iw(e)}function ft(e,t,i){return new rs(e,t,i)}function Xe(e,t=null,i){return new Lc(e,null,t,i)}function fo(e,t,i){return new Us(e,t,i)}function x0(e){return new Yf(e)}function ti(e,t,i){return new Hs(e,t,i)}function ao(e,t=null){return new vl(e.map(i=>new Kf(i.key,i.value,i.quoted)),t,null)}function h6(e,t){return new Bc(e,t)}function Xl(e,t,i,r,n){return new Lh(e,t,i,r,n)}function ro(e,t,i,r){return new Bh(e,t,i,r)}function w0(e,t,i,r,n){return new rw(e,t,i,r,n)}function WT(e,t,i,r){return new ew(e,t,i,r)}function U(e,t,i){return new no(e,t,i)}function xre(e,t,i,r,n){return new tw(e,t,i,r,n)}function p6(e){return e instanceof no&&e.value===null}function d8(e){let t="";if(e.tagName&&(t+=` @${e.tagName}`),e.text){if(e.text.match(/\/\*|\*\//))throw new Error('JSDoc text cannot contain "/*" and "*/"');t+=" "+e.text.replace(/@/g,"\\@")}return t}function wre(e){if(e.length===0)return"";if(e.length===1&&e[0].tagName&&!e[0].text)return`*${d8(e[0])} `;let t=`*
`;for(let i of e)t+=" *",t+=d8(i).replace(/\n/g,`
 * `),t+=`
`;return t+=" ",t}var Ere="_c",u8=ft("<unknown>"),Cre={},Sre=50,nw=class e extends rr{constructor(t){super(t.type),this.resolved=t,this.shared=!1,this.original=t}visitExpression(t,i){return i===Cre?this.original.visitExpression(t,i):this.resolved.visitExpression(t,i)}isEquivalent(t){return t instanceof e&&this.resolved.isEquivalent(t.resolved)}isConstant(){return!0}clone(){throw new Error("Not supported.")}fixup(t){this.resolved=t,this.shared=!0}},ow=class{constructor(t=!1){this.isClosureCompilerEnabled=t,this.statements=[],this.literals=new Map,this.literalFactories=new Map,this.sharedConstants=new Map,this._claimedNames=new Map,this.nextNameIndex=0}getConstLiteral(t,i){if(t instanceof no&&!h8(t)||t instanceof nw)return t;let r=Wf.INSTANCE.keyOf(t),n=this.literals.get(r),o=!1;if(n||(n=new nw(t),this.literals.set(r,n),o=!0),!o&&!n.shared||o&&i){let a=this.freshName(),s,c;this.isClosureCompilerEnabled&&h8(t)?(s=ft(a).set(new Lh([],[new Rn(t)])),c=ft(a).callFn([])):(s=ft(a).set(t),c=ft(a)),this.statements.push(s.toDeclStmt(aa,po.Final)),n.fixup(c)}return n}getSharedConstant(t,i){let r=t.keyOf(i);if(!this.sharedConstants.has(r)){let n=this.freshName();this.sharedConstants.set(r,ft(n)),this.statements.push(t.toSharedConstantDeclaration(n,i))}return this.sharedConstants.get(r)}getLiteralFactory(t){if(t instanceof Hs){let i=t.entries.map(n=>n.isConstant()?n:u8),r=Wf.INSTANCE.keyOf(ti(i));return this._getLiteralFactory(r,t.entries,n=>ti(n))}else{let i=ao(t.entries.map(n=>({key:n.key,value:n.value.isConstant()?n.value:u8,quoted:n.quoted}))),r=Wf.INSTANCE.keyOf(i);return this._getLiteralFactory(r,t.entries.map(n=>n.value),n=>ao(n.map((o,a)=>({key:t.entries[a].key,value:o,quoted:t.entries[a].quoted}))))}}getSharedFunctionReference(t,i,r=!0){let n=t instanceof Bh;for(let a of this.statements)if(n&&a instanceof Ro&&a.value?.isEquivalent(t)||!n&&a instanceof $v&&t.isEquivalent(a))return ft(a.name);let o=r?this.uniqueName(i):i;return this.statements.push(t.toDeclStmt(o,po.Final)),ft(o)}_getLiteralFactory(t,i,r){let n=this.literalFactories.get(t),o=i.filter(a=>!a.isConstant());if(!n){let a=i.map((d,u)=>d.isConstant()?this.getConstLiteral(d,!0):ft(`a${u}`)),s=a.filter(Tre).map(d=>new Dr(d.name,Xc)),c=ro(s,r(a),aa),l=this.freshName();this.statements.push(ft(l).set(c).toDeclStmt(aa,po.Final)),n=ft(l),this.literalFactories.set(t,n)}return{literalFactory:n,literalFactoryArguments:o}}uniqueName(t,i=!0){let r=this._claimedNames.get(t)??0,n=r===0&&!i?`${t}`:`${t}${r}`;return this._claimedNames.set(t,r+1),n}freshName(){return this.uniqueName(Ere)}},Wf=class e{static{this.INSTANCE=new e}keyOf(t){if(t instanceof no&&typeof t.value=="string")return`"${t.value}"`;if(t instanceof no)return String(t.value);if(t instanceof Hs){let i=[];for(let r of t.entries)i.push(this.keyOf(r));return`[${i.join(",")}]`}else if(t instanceof vl){let i=[];for(let r of t.entries){let n=r.key;r.quoted&&(n=`"${n}"`),i.push(n+":"+this.keyOf(r.value))}return`{${i.join(",")}}`}else{if(t instanceof Lc)return`import("${t.value.moduleName}", ${t.value.name})`;if(t instanceof rs)return`read(${t.name})`;if(t instanceof Yf)return`typeof(${this.keyOf(t.expr)})`;throw new Error(`${this.constructor.name} does not handle expressions of type ${t.constructor.name}`)}}};function Tre(e){return e instanceof rs}function h8(e){return e instanceof no&&typeof e.value=="string"&&e.value.length>=Sre}var Q="@angular/core",T=(()=>{class e{static{this.NEW_METHOD="factory"}static{this.TRANSFORM_METHOD="transform"}static{this.PATCH_DEPS="patchedDeps"}static{this.core={name:null,moduleName:Q}}static{this.namespaceHTML={name:"\u0275\u0275namespaceHTML",moduleName:Q}}static{this.namespaceMathML={name:"\u0275\u0275namespaceMathML",moduleName:Q}}static{this.namespaceSVG={name:"\u0275\u0275namespaceSVG",moduleName:Q}}static{this.element={name:"\u0275\u0275element",moduleName:Q}}static{this.elementStart={name:"\u0275\u0275elementStart",moduleName:Q}}static{this.elementEnd={name:"\u0275\u0275elementEnd",moduleName:Q}}static{this.advance={name:"\u0275\u0275advance",moduleName:Q}}static{this.syntheticHostProperty={name:"\u0275\u0275syntheticHostProperty",moduleName:Q}}static{this.syntheticHostListener={name:"\u0275\u0275syntheticHostListener",moduleName:Q}}static{this.attribute={name:"\u0275\u0275attribute",moduleName:Q}}static{this.attributeInterpolate1={name:"\u0275\u0275attributeInterpolate1",moduleName:Q}}static{this.attributeInterpolate2={name:"\u0275\u0275attributeInterpolate2",moduleName:Q}}static{this.attributeInterpolate3={name:"\u0275\u0275attributeInterpolate3",moduleName:Q}}static{this.attributeInterpolate4={name:"\u0275\u0275attributeInterpolate4",moduleName:Q}}static{this.attributeInterpolate5={name:"\u0275\u0275attributeInterpolate5",moduleName:Q}}static{this.attributeInterpolate6={name:"\u0275\u0275attributeInterpolate6",moduleName:Q}}static{this.attributeInterpolate7={name:"\u0275\u0275attributeInterpolate7",moduleName:Q}}static{this.attributeInterpolate8={name:"\u0275\u0275attributeInterpolate8",moduleName:Q}}static{this.attributeInterpolateV={name:"\u0275\u0275attributeInterpolateV",moduleName:Q}}static{this.classProp={name:"\u0275\u0275classProp",moduleName:Q}}static{this.elementContainerStart={name:"\u0275\u0275elementContainerStart",moduleName:Q}}static{this.elementContainerEnd={name:"\u0275\u0275elementContainerEnd",moduleName:Q}}static{this.elementContainer={name:"\u0275\u0275elementContainer",moduleName:Q}}static{this.styleMap={name:"\u0275\u0275styleMap",moduleName:Q}}static{this.styleMapInterpolate1={name:"\u0275\u0275styleMapInterpolate1",moduleName:Q}}static{this.styleMapInterpolate2={name:"\u0275\u0275styleMapInterpolate2",moduleName:Q}}static{this.styleMapInterpolate3={name:"\u0275\u0275styleMapInterpolate3",moduleName:Q}}static{this.styleMapInterpolate4={name:"\u0275\u0275styleMapInterpolate4",moduleName:Q}}static{this.styleMapInterpolate5={name:"\u0275\u0275styleMapInterpolate5",moduleName:Q}}static{this.styleMapInterpolate6={name:"\u0275\u0275styleMapInterpolate6",moduleName:Q}}static{this.styleMapInterpolate7={name:"\u0275\u0275styleMapInterpolate7",moduleName:Q}}static{this.styleMapInterpolate8={name:"\u0275\u0275styleMapInterpolate8",moduleName:Q}}static{this.styleMapInterpolateV={name:"\u0275\u0275styleMapInterpolateV",moduleName:Q}}static{this.classMap={name:"\u0275\u0275classMap",moduleName:Q}}static{this.classMapInterpolate1={name:"\u0275\u0275classMapInterpolate1",moduleName:Q}}static{this.classMapInterpolate2={name:"\u0275\u0275classMapInterpolate2",moduleName:Q}}static{this.classMapInterpolate3={name:"\u0275\u0275classMapInterpolate3",moduleName:Q}}static{this.classMapInterpolate4={name:"\u0275\u0275classMapInterpolate4",moduleName:Q}}static{this.classMapInterpolate5={name:"\u0275\u0275classMapInterpolate5",moduleName:Q}}static{this.classMapInterpolate6={name:"\u0275\u0275classMapInterpolate6",moduleName:Q}}static{this.classMapInterpolate7={name:"\u0275\u0275classMapInterpolate7",moduleName:Q}}static{this.classMapInterpolate8={name:"\u0275\u0275classMapInterpolate8",moduleName:Q}}static{this.classMapInterpolateV={name:"\u0275\u0275classMapInterpolateV",moduleName:Q}}static{this.styleProp={name:"\u0275\u0275styleProp",moduleName:Q}}static{this.stylePropInterpolate1={name:"\u0275\u0275stylePropInterpolate1",moduleName:Q}}static{this.stylePropInterpolate2={name:"\u0275\u0275stylePropInterpolate2",moduleName:Q}}static{this.stylePropInterpolate3={name:"\u0275\u0275stylePropInterpolate3",moduleName:Q}}static{this.stylePropInterpolate4={name:"\u0275\u0275stylePropInterpolate4",moduleName:Q}}static{this.stylePropInterpolate5={name:"\u0275\u0275stylePropInterpolate5",moduleName:Q}}static{this.stylePropInterpolate6={name:"\u0275\u0275stylePropInterpolate6",moduleName:Q}}static{this.stylePropInterpolate7={name:"\u0275\u0275stylePropInterpolate7",moduleName:Q}}static{this.stylePropInterpolate8={name:"\u0275\u0275stylePropInterpolate8",moduleName:Q}}static{this.stylePropInterpolateV={name:"\u0275\u0275stylePropInterpolateV",moduleName:Q}}static{this.nextContext={name:"\u0275\u0275nextContext",moduleName:Q}}static{this.resetView={name:"\u0275\u0275resetView",moduleName:Q}}static{this.templateCreate={name:"\u0275\u0275template",moduleName:Q}}static{this.defer={name:"\u0275\u0275defer",moduleName:Q}}static{this.deferWhen={name:"\u0275\u0275deferWhen",moduleName:Q}}static{this.deferOnIdle={name:"\u0275\u0275deferOnIdle",moduleName:Q}}static{this.deferOnImmediate={name:"\u0275\u0275deferOnImmediate",moduleName:Q}}static{this.deferOnTimer={name:"\u0275\u0275deferOnTimer",moduleName:Q}}static{this.deferOnHover={name:"\u0275\u0275deferOnHover",moduleName:Q}}static{this.deferOnInteraction={name:"\u0275\u0275deferOnInteraction",moduleName:Q}}static{this.deferOnViewport={name:"\u0275\u0275deferOnViewport",moduleName:Q}}static{this.deferPrefetchWhen={name:"\u0275\u0275deferPrefetchWhen",moduleName:Q}}static{this.deferPrefetchOnIdle={name:"\u0275\u0275deferPrefetchOnIdle",moduleName:Q}}static{this.deferPrefetchOnImmediate={name:"\u0275\u0275deferPrefetchOnImmediate",moduleName:Q}}static{this.deferPrefetchOnTimer={name:"\u0275\u0275deferPrefetchOnTimer",moduleName:Q}}static{this.deferPrefetchOnHover={name:"\u0275\u0275deferPrefetchOnHover",moduleName:Q}}static{this.deferPrefetchOnInteraction={name:"\u0275\u0275deferPrefetchOnInteraction",moduleName:Q}}static{this.deferPrefetchOnViewport={name:"\u0275\u0275deferPrefetchOnViewport",moduleName:Q}}static{this.deferEnableTimerScheduling={name:"\u0275\u0275deferEnableTimerScheduling",moduleName:Q}}static{this.conditional={name:"\u0275\u0275conditional",moduleName:Q}}static{this.repeater={name:"\u0275\u0275repeater",moduleName:Q}}static{this.repeaterCreate={name:"\u0275\u0275repeaterCreate",moduleName:Q}}static{this.repeaterTrackByIndex={name:"\u0275\u0275repeaterTrackByIndex",moduleName:Q}}static{this.repeaterTrackByIdentity={name:"\u0275\u0275repeaterTrackByIdentity",moduleName:Q}}static{this.componentInstance={name:"\u0275\u0275componentInstance",moduleName:Q}}static{this.text={name:"\u0275\u0275text",moduleName:Q}}static{this.enableBindings={name:"\u0275\u0275enableBindings",moduleName:Q}}static{this.disableBindings={name:"\u0275\u0275disableBindings",moduleName:Q}}static{this.getCurrentView={name:"\u0275\u0275getCurrentView",moduleName:Q}}static{this.textInterpolate={name:"\u0275\u0275textInterpolate",moduleName:Q}}static{this.textInterpolate1={name:"\u0275\u0275textInterpolate1",moduleName:Q}}static{this.textInterpolate2={name:"\u0275\u0275textInterpolate2",moduleName:Q}}static{this.textInterpolate3={name:"\u0275\u0275textInterpolate3",moduleName:Q}}static{this.textInterpolate4={name:"\u0275\u0275textInterpolate4",moduleName:Q}}static{this.textInterpolate5={name:"\u0275\u0275textInterpolate5",moduleName:Q}}static{this.textInterpolate6={name:"\u0275\u0275textInterpolate6",moduleName:Q}}static{this.textInterpolate7={name:"\u0275\u0275textInterpolate7",moduleName:Q}}static{this.textInterpolate8={name:"\u0275\u0275textInterpolate8",moduleName:Q}}static{this.textInterpolateV={name:"\u0275\u0275textInterpolateV",moduleName:Q}}static{this.restoreView={name:"\u0275\u0275restoreView",moduleName:Q}}static{this.pureFunction0={name:"\u0275\u0275pureFunction0",moduleName:Q}}static{this.pureFunction1={name:"\u0275\u0275pureFunction1",moduleName:Q}}static{this.pureFunction2={name:"\u0275\u0275pureFunction2",moduleName:Q}}static{this.pureFunction3={name:"\u0275\u0275pureFunction3",moduleName:Q}}static{this.pureFunction4={name:"\u0275\u0275pureFunction4",moduleName:Q}}static{this.pureFunction5={name:"\u0275\u0275pureFunction5",moduleName:Q}}static{this.pureFunction6={name:"\u0275\u0275pureFunction6",moduleName:Q}}static{this.pureFunction7={name:"\u0275\u0275pureFunction7",moduleName:Q}}static{this.pureFunction8={name:"\u0275\u0275pureFunction8",moduleName:Q}}static{this.pureFunctionV={name:"\u0275\u0275pureFunctionV",moduleName:Q}}static{this.pipeBind1={name:"\u0275\u0275pipeBind1",moduleName:Q}}static{this.pipeBind2={name:"\u0275\u0275pipeBind2",moduleName:Q}}static{this.pipeBind3={name:"\u0275\u0275pipeBind3",moduleName:Q}}static{this.pipeBind4={name:"\u0275\u0275pipeBind4",moduleName:Q}}static{this.pipeBindV={name:"\u0275\u0275pipeBindV",moduleName:Q}}static{this.hostProperty={name:"\u0275\u0275hostProperty",moduleName:Q}}static{this.property={name:"\u0275\u0275property",moduleName:Q}}static{this.propertyInterpolate={name:"\u0275\u0275propertyInterpolate",moduleName:Q}}static{this.propertyInterpolate1={name:"\u0275\u0275propertyInterpolate1",moduleName:Q}}static{this.propertyInterpolate2={name:"\u0275\u0275propertyInterpolate2",moduleName:Q}}static{this.propertyInterpolate3={name:"\u0275\u0275propertyInterpolate3",moduleName:Q}}static{this.propertyInterpolate4={name:"\u0275\u0275propertyInterpolate4",moduleName:Q}}static{this.propertyInterpolate5={name:"\u0275\u0275propertyInterpolate5",moduleName:Q}}static{this.propertyInterpolate6={name:"\u0275\u0275propertyInterpolate6",moduleName:Q}}static{this.propertyInterpolate7={name:"\u0275\u0275propertyInterpolate7",moduleName:Q}}static{this.propertyInterpolate8={name:"\u0275\u0275propertyInterpolate8",moduleName:Q}}static{this.propertyInterpolateV={name:"\u0275\u0275propertyInterpolateV",moduleName:Q}}static{this.i18n={name:"\u0275\u0275i18n",moduleName:Q}}static{this.i18nAttributes={name:"\u0275\u0275i18nAttributes",moduleName:Q}}static{this.i18nExp={name:"\u0275\u0275i18nExp",moduleName:Q}}static{this.i18nStart={name:"\u0275\u0275i18nStart",moduleName:Q}}static{this.i18nEnd={name:"\u0275\u0275i18nEnd",moduleName:Q}}static{this.i18nApply={name:"\u0275\u0275i18nApply",moduleName:Q}}static{this.i18nPostprocess={name:"\u0275\u0275i18nPostprocess",moduleName:Q}}static{this.pipe={name:"\u0275\u0275pipe",moduleName:Q}}static{this.projection={name:"\u0275\u0275projection",moduleName:Q}}static{this.projectionDef={name:"\u0275\u0275projectionDef",moduleName:Q}}static{this.reference={name:"\u0275\u0275reference",moduleName:Q}}static{this.inject={name:"\u0275\u0275inject",moduleName:Q}}static{this.injectAttribute={name:"\u0275\u0275injectAttribute",moduleName:Q}}static{this.directiveInject={name:"\u0275\u0275directiveInject",moduleName:Q}}static{this.invalidFactory={name:"\u0275\u0275invalidFactory",moduleName:Q}}static{this.invalidFactoryDep={name:"\u0275\u0275invalidFactoryDep",moduleName:Q}}static{this.templateRefExtractor={name:"\u0275\u0275templateRefExtractor",moduleName:Q}}static{this.forwardRef={name:"forwardRef",moduleName:Q}}static{this.resolveForwardRef={name:"resolveForwardRef",moduleName:Q}}static{this.\u0275\u0275defineInjectable={name:"\u0275\u0275defineInjectable",moduleName:Q}}static{this.declareInjectable={name:"\u0275\u0275ngDeclareInjectable",moduleName:Q}}static{this.InjectableDeclaration={name:"\u0275\u0275InjectableDeclaration",moduleName:Q}}static{this.resolveWindow={name:"\u0275\u0275resolveWindow",moduleName:Q}}static{this.resolveDocument={name:"\u0275\u0275resolveDocument",moduleName:Q}}static{this.resolveBody={name:"\u0275\u0275resolveBody",moduleName:Q}}static{this.getComponentDepsFactory={name:"\u0275\u0275getComponentDepsFactory",moduleName:Q}}static{this.defineComponent={name:"\u0275\u0275defineComponent",moduleName:Q}}static{this.declareComponent={name:"\u0275\u0275ngDeclareComponent",moduleName:Q}}static{this.setComponentScope={name:"\u0275\u0275setComponentScope",moduleName:Q}}static{this.ChangeDetectionStrategy={name:"ChangeDetectionStrategy",moduleName:Q}}static{this.ViewEncapsulation={name:"ViewEncapsulation",moduleName:Q}}static{this.ComponentDeclaration={name:"\u0275\u0275ComponentDeclaration",moduleName:Q}}static{this.FactoryDeclaration={name:"\u0275\u0275FactoryDeclaration",moduleName:Q}}static{this.declareFactory={name:"\u0275\u0275ngDeclareFactory",moduleName:Q}}static{this.FactoryTarget={name:"\u0275\u0275FactoryTarget",moduleName:Q}}static{this.defineDirective={name:"\u0275\u0275defineDirective",moduleName:Q}}static{this.declareDirective={name:"\u0275\u0275ngDeclareDirective",moduleName:Q}}static{this.DirectiveDeclaration={name:"\u0275\u0275DirectiveDeclaration",moduleName:Q}}static{this.InjectorDef={name:"\u0275\u0275InjectorDef",moduleName:Q}}static{this.InjectorDeclaration={name:"\u0275\u0275InjectorDeclaration",moduleName:Q}}static{this.defineInjector={name:"\u0275\u0275defineInjector",moduleName:Q}}static{this.declareInjector={name:"\u0275\u0275ngDeclareInjector",moduleName:Q}}static{this.NgModuleDeclaration={name:"\u0275\u0275NgModuleDeclaration",moduleName:Q}}static{this.ModuleWithProviders={name:"ModuleWithProviders",moduleName:Q}}static{this.defineNgModule={name:"\u0275\u0275defineNgModule",moduleName:Q}}static{this.declareNgModule={name:"\u0275\u0275ngDeclareNgModule",moduleName:Q}}static{this.setNgModuleScope={name:"\u0275\u0275setNgModuleScope",moduleName:Q}}static{this.registerNgModuleType={name:"\u0275\u0275registerNgModuleType",moduleName:Q}}static{this.PipeDeclaration={name:"\u0275\u0275PipeDeclaration",moduleName:Q}}static{this.definePipe={name:"\u0275\u0275definePipe",moduleName:Q}}static{this.declarePipe={name:"\u0275\u0275ngDeclarePipe",moduleName:Q}}static{this.declareClassMetadata={name:"\u0275\u0275ngDeclareClassMetadata",moduleName:Q}}static{this.setClassMetadata={name:"\u0275setClassMetadata",moduleName:Q}}static{this.setClassMetadataAsync={name:"\u0275setClassMetadataAsync",moduleName:Q}}static{this.setClassDebugInfo={name:"\u0275setClassDebugInfo",moduleName:Q}}static{this.queryRefresh={name:"\u0275\u0275queryRefresh",moduleName:Q}}static{this.viewQuery={name:"\u0275\u0275viewQuery",moduleName:Q}}static{this.loadQuery={name:"\u0275\u0275loadQuery",moduleName:Q}}static{this.contentQuery={name:"\u0275\u0275contentQuery",moduleName:Q}}static{this.viewQuerySignal={name:"\u0275\u0275viewQuerySignal",moduleName:Q}}static{this.contentQuerySignal={name:"\u0275\u0275contentQuerySignal",moduleName:Q}}static{this.queryAdvance={name:"\u0275\u0275queryAdvance",moduleName:Q}}static{this.twoWayProperty={name:"\u0275\u0275twoWayProperty",moduleName:Q}}static{this.twoWayBindingSet={name:"\u0275\u0275twoWayBindingSet",moduleName:Q}}static{this.twoWayListener={name:"\u0275\u0275twoWayListener",moduleName:Q}}static{this.NgOnChangesFeature={name:"\u0275\u0275NgOnChangesFeature",moduleName:Q}}static{this.InheritDefinitionFeature={name:"\u0275\u0275InheritDefinitionFeature",moduleName:Q}}static{this.CopyDefinitionFeature={name:"\u0275\u0275CopyDefinitionFeature",moduleName:Q}}static{this.StandaloneFeature={name:"\u0275\u0275StandaloneFeature",moduleName:Q}}static{this.ProvidersFeature={name:"\u0275\u0275ProvidersFeature",moduleName:Q}}static{this.HostDirectivesFeature={name:"\u0275\u0275HostDirectivesFeature",moduleName:Q}}static{this.InputTransformsFeatureFeature={name:"\u0275\u0275InputTransformsFeature",moduleName:Q}}static{this.listener={name:"\u0275\u0275listener",moduleName:Q}}static{this.getInheritedFactory={name:"\u0275\u0275getInheritedFactory",moduleName:Q}}static{this.InputFlags={name:"\u0275\u0275InputFlags",moduleName:Q}}static{this.sanitizeHtml={name:"\u0275\u0275sanitizeHtml",moduleName:Q}}static{this.sanitizeStyle={name:"\u0275\u0275sanitizeStyle",moduleName:Q}}static{this.sanitizeResourceUrl={name:"\u0275\u0275sanitizeResourceUrl",moduleName:Q}}static{this.sanitizeScript={name:"\u0275\u0275sanitizeScript",moduleName:Q}}static{this.sanitizeUrl={name:"\u0275\u0275sanitizeUrl",moduleName:Q}}static{this.sanitizeUrlOrResourceUrl={name:"\u0275\u0275sanitizeUrlOrResourceUrl",moduleName:Q}}static{this.trustConstantHtml={name:"\u0275\u0275trustConstantHtml",moduleName:Q}}static{this.trustConstantResourceUrl={name:"\u0275\u0275trustConstantResourceUrl",moduleName:Q}}static{this.validateIframeAttribute={name:"\u0275\u0275validateIframeAttribute",moduleName:Q}}static{this.InputSignalBrandWriteType={name:"\u0275INPUT_SIGNAL_BRAND_WRITE_TYPE",moduleName:Q}}static{this.UnwrapDirectiveSignalInputs={name:"\u0275UnwrapDirectiveSignalInputs",moduleName:Q}}static{this.unwrapWritableSignal={name:"\u0275unwrapWritableSignal",moduleName:Q}}}return e})(),Are=/-+([a-z0-9])/g;function Dre(e){return e.replace(Are,(...t)=>t[1].toUpperCase())}function Ire(e,t){return f6(e,":",t)}function Mre(e,t){return f6(e,".",t)}function f6(e,t,i){let r=e.indexOf(t);return r==-1?i:[e.slice(0,r).trim(),e.slice(r+1).trim()]}function aw(e){throw new Error(`Internal Error: ${e}`)}function kre(e){let t=[];for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);if(r>=55296&&r<=56319&&e.length>i+1){let n=e.charCodeAt(i+1);n>=56320&&n<=57343&&(i++,r=(r-55296<<10)+n-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,r&63|128):r<=65535?t.push(r>>12|224,r>>6&63|128,r&63|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,r&63|128)}return t}function m6(e){if(typeof e=="string")return e;if(Array.isArray(e))return"["+e.map(m6).join(", ")+"]";if(e==null)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;if(!e.toString)return"object";let t=e.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i===-1?t:t.substring(0,i)}var qT=class{constructor(t){this.full=t;let i=t.split(".");this.major=i[0],this.minor=i[1],this.patch=i.slice(2).join(".")}},Ov=globalThis;function Pre(e,t){let i=[],r=[];for(let n of e)(t(n)?i:r).push(n);return[i,r]}var Nre=3,Ore="# sourceMappingURL=data:application/json;base64,",XT=class{constructor(t=null){this.file=t,this.sourcesContent=new Map,this.lines=[],this.lastCol0=0,this.hasMappings=!1}addSource(t,i=null){return this.sourcesContent.has(t)||this.sourcesContent.set(t,i),this}addLine(){return this.lines.push([]),this.lastCol0=0,this}addMapping(t,i,r,n){if(!this.currentLine)throw new Error("A line must be added before mappings can be added");if(i!=null&&!this.sourcesContent.has(i))throw new Error(`Unknown source file "${i}"`);if(t==null)throw new Error("The column in the generated code must be provided");if(t<this.lastCol0)throw new Error("Mapping should be added in output order");if(i&&(r==null||n==null))throw new Error("The source location must be provided when a source url is provided");return this.hasMappings=!0,this.lastCol0=t,this.currentLine.push({col0:t,sourceUrl:i,sourceLine0:r,sourceCol0:n}),this}get currentLine(){return this.lines.slice(-1)[0]}toJSON(){if(!this.hasMappings)return null;let t=new Map,i=[],r=[];Array.from(this.sourcesContent.keys()).forEach((l,d)=>{t.set(l,d),i.push(l),r.push(this.sourcesContent.get(l)||null)});let n="",o=0,a=0,s=0,c=0;return this.lines.forEach(l=>{o=0,n+=l.map(d=>{let u=Px(d.col0-o);return o=d.col0,d.sourceUrl!=null&&(u+=Px(t.get(d.sourceUrl)-a),a=t.get(d.sourceUrl),u+=Px(d.sourceLine0-s),s=d.sourceLine0,u+=Px(d.sourceCol0-c),c=d.sourceCol0),u}).join(","),n+=";"}),n=n.slice(0,-1),{file:this.file||"",version:Nre,sourceRoot:"",sources:i,sourcesContent:r,mappings:n}}toJsComment(){return this.hasMappings?"//"+Ore+Rre(JSON.stringify(this,null,0)):""}};function Rre(e){let t="",i=kre(e);for(let r=0;r<i.length;){let n=i[r++],o=r<i.length?i[r++]:null,a=r<i.length?i[r++]:null;t+=Mv(n>>2),t+=Mv((n&3)<<4|(o===null?0:o>>4)),t+=o===null?"=":Mv((o&15)<<2|(a===null?0:a>>6)),t+=o===null||a===null?"=":Mv(a&63)}return t}function Px(e){e=e<0?(-e<<1)+1:e<<1;let t="";do{let i=e&31;e=e>>5,e>0&&(i=i|32),t+=Mv(i)}while(e>0);return t}var Fre="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Mv(e){if(e<0||e>=64)throw new Error("Can only encode value in the range [0, 63]");return Fre[e]}var Lre=/'|\\|\n|\r|\$/g,Bre=/^[$A-Z_][0-9A-Z_$]*$/i,YT="  ",sw=class{constructor(t){this.indent=t,this.partsLength=0,this.parts=[],this.srcSpans=[]}},ZT=class e{static createRoot(){return new e(0)}constructor(t){this._indent=t,this._lines=[new sw(t)]}get _currentLine(){return this._lines[this._lines.length-1]}println(t,i=""){this.print(t||null,i,!0)}lineIsEmpty(){return this._currentLine.parts.length===0}lineLength(){return this._currentLine.indent*YT.length+this._currentLine.partsLength}print(t,i,r=!1){i.length>0&&(this._currentLine.parts.push(i),this._currentLine.partsLength+=i.length,this._currentLine.srcSpans.push(t&&t.sourceSpan||null)),r&&this._lines.push(new sw(this._indent))}removeEmptyLastLine(){this.lineIsEmpty()&&this._lines.pop()}incIndent(){this._indent++,this.lineIsEmpty()&&(this._currentLine.indent=this._indent)}decIndent(){this._indent--,this.lineIsEmpty()&&(this._currentLine.indent=this._indent)}toSource(){return this.sourceLines.map(t=>t.parts.length>0?p8(t.indent)+t.parts.join(""):"").join(`
`)}toSourceMapGenerator(t,i=0){let r=new XT(t),n=!1,o=()=>{n||(r.addSource(t," ").addMapping(0,t,0,0),n=!0)};for(let a=0;a<i;a++)r.addLine(),o();return this.sourceLines.forEach((a,s)=>{r.addLine();let c=a.srcSpans,l=a.parts,d=a.indent*YT.length,u=0;for(;u<c.length&&!c[u];)d+=l[u].length,u++;for(u<c.length&&s===0&&d===0?n=!0:o();u<c.length;){let h=c[u],p=h.start.file,m=h.start.line,f=h.start.col;for(r.addSource(p.url,p.content).addMapping(d,p.url,m,f),d+=l[u].length,u++;u<c.length&&(h===c[u]||!c[u]);)d+=l[u].length,u++}}),r}spanOf(t,i){let r=this._lines[t];if(r){let n=i-p8(r.indent).length;for(let o=0;o<r.parts.length;o++){let a=r.parts[o];if(a.length>n)return r.srcSpans[o];n-=a.length}}return null}get sourceLines(){return this._lines.length&&this._lines[this._lines.length-1].parts.length===0?this._lines.slice(0,-1):this._lines}},KT=class{constructor(t){this._escapeDollarInStrings=t}printLeadingComments(t,i){if(t.leadingComments!==void 0)for(let r of t.leadingComments)r instanceof iw?i.print(t,`/*${r.toString()}*/`,r.trailingNewline):r.multiline?i.print(t,`/* ${r.text} */`,r.trailingNewline):r.text.split(`
`).forEach(n=>{i.println(t,`// ${n}`)})}visitExpressionStmt(t,i){return this.printLeadingComments(t,i),t.expr.visitExpression(this,i),i.println(t,";"),null}visitReturnStmt(t,i){return this.printLeadingComments(t,i),i.print(t,"return "),t.value.visitExpression(this,i),i.println(t,";"),null}visitIfStmt(t,i){this.printLeadingComments(t,i),i.print(t,"if ("),t.condition.visitExpression(this,i),i.print(t,") {");let r=t.falseCase!=null&&t.falseCase.length>0;return t.trueCase.length<=1&&!r?(i.print(t," "),this.visitAllStatements(t.trueCase,i),i.removeEmptyLastLine(),i.print(t," ")):(i.println(),i.incIndent(),this.visitAllStatements(t.trueCase,i),i.decIndent(),r&&(i.println(t,"} else {"),i.incIndent(),this.visitAllStatements(t.falseCase,i),i.decIndent())),i.println(t,"}"),null}visitWriteVarExpr(t,i){let r=i.lineIsEmpty();return r||i.print(t,"("),i.print(t,`${t.name} = `),t.value.visitExpression(this,i),r||i.print(t,")"),null}visitWriteKeyExpr(t,i){let r=i.lineIsEmpty();return r||i.print(t,"("),t.receiver.visitExpression(this,i),i.print(t,"["),t.index.visitExpression(this,i),i.print(t,"] = "),t.value.visitExpression(this,i),r||i.print(t,")"),null}visitWritePropExpr(t,i){let r=i.lineIsEmpty();return r||i.print(t,"("),t.receiver.visitExpression(this,i),i.print(t,`.${t.name} = `),t.value.visitExpression(this,i),r||i.print(t,")"),null}visitInvokeFunctionExpr(t,i){let r=t.fn instanceof Bh;return r&&i.print(t.fn,"("),t.fn.visitExpression(this,i),r&&i.print(t.fn,")"),i.print(t,"("),this.visitAllExpressions(t.args,i,","),i.print(t,")"),null}visitTaggedTemplateExpr(t,i){t.tag.visitExpression(this,i),i.print(t,"`"+t.template.elements[0].rawText);for(let r=1;r<t.template.elements.length;r++)i.print(t,"${"),t.template.expressions[r-1].visitExpression(this,i),i.print(t,`}${t.template.elements[r].rawText}`);return i.print(t,"`"),null}visitWrappedNodeExpr(t,i){throw new Error("Abstract emitter cannot visit WrappedNodeExpr.")}visitTypeofExpr(t,i){i.print(t,"typeof "),t.expr.visitExpression(this,i)}visitReadVarExpr(t,i){return i.print(t,t.name),null}visitInstantiateExpr(t,i){return i.print(t,"new "),t.classExpr.visitExpression(this,i),i.print(t,"("),this.visitAllExpressions(t.args,i,","),i.print(t,")"),null}visitLiteralExpr(t,i){let r=t.value;return typeof r=="string"?i.print(t,Dh(r,this._escapeDollarInStrings)):i.print(t,`${r}`),null}visitLocalizedString(t,i){let r=t.serializeI18nHead();i.print(t,"$localize `"+r.raw);for(let n=1;n<t.messageParts.length;n++)i.print(t,"${"),t.expressions[n-1].visitExpression(this,i),i.print(t,`}${t.serializeI18nTemplatePart(n).raw}`);return i.print(t,"`"),null}visitConditionalExpr(t,i){return i.print(t,"("),t.condition.visitExpression(this,i),i.print(t,"? "),t.trueCase.visitExpression(this,i),i.print(t,": "),t.falseCase.visitExpression(this,i),i.print(t,")"),null}visitDynamicImportExpr(t,i){i.print(t,`import(${t.url})`)}visitNotExpr(t,i){return i.print(t,"!"),t.condition.visitExpression(this,i),null}visitUnaryOperatorExpr(t,i){let r;switch(t.operator){case Fh.Plus:r="+";break;case Fh.Minus:r="-";break;default:throw new Error(`Unknown operator ${t.operator}`)}return t.parens&&i.print(t,"("),i.print(t,r),t.expr.visitExpression(this,i),t.parens&&i.print(t,")"),null}visitBinaryOperatorExpr(t,i){let r;switch(t.operator){case et.Equals:r="==";break;case et.Identical:r="===";break;case et.NotEquals:r="!=";break;case et.NotIdentical:r="!==";break;case et.And:r="&&";break;case et.BitwiseOr:r="|";break;case et.BitwiseAnd:r="&";break;case et.Or:r="||";break;case et.Plus:r="+";break;case et.Minus:r="-";break;case et.Divide:r="/";break;case et.Multiply:r="*";break;case et.Modulo:r="%";break;case et.Lower:r="<";break;case et.LowerEquals:r="<=";break;case et.Bigger:r=">";break;case et.BiggerEquals:r=">=";break;case et.NullishCoalesce:r="??";break;default:throw new Error(`Unknown operator ${t.operator}`)}return t.parens&&i.print(t,"("),t.lhs.visitExpression(this,i),i.print(t,` ${r} `),t.rhs.visitExpression(this,i),t.parens&&i.print(t,")"),null}visitReadPropExpr(t,i){return t.receiver.visitExpression(this,i),i.print(t,"."),i.print(t,t.name),null}visitReadKeyExpr(t,i){return t.receiver.visitExpression(this,i),i.print(t,"["),t.index.visitExpression(this,i),i.print(t,"]"),null}visitLiteralArrayExpr(t,i){return i.print(t,"["),this.visitAllExpressions(t.entries,i,","),i.print(t,"]"),null}visitLiteralMapExpr(t,i){return i.print(t,"{"),this.visitAllObjects(r=>{i.print(t,`${Dh(r.key,this._escapeDollarInStrings,r.quoted)}:`),r.value.visitExpression(this,i)},t.entries,i,","),i.print(t,"}"),null}visitCommaExpr(t,i){return i.print(t,"("),this.visitAllExpressions(t.parts,i,","),i.print(t,")"),null}visitAllExpressions(t,i,r){this.visitAllObjects(n=>n.visitExpression(this,i),t,i,r)}visitAllObjects(t,i,r,n){let o=!1;for(let a=0;a<i.length;a++)a>0&&(r.lineLength()>80?(r.print(null,n,!0),o||(r.incIndent(),r.incIndent(),o=!0)):r.print(null,n,!1)),t(i[a]);o&&(r.decIndent(),r.decIndent())}visitAllStatements(t,i){t.forEach(r=>r.visitStatement(this,i))}};function Dh(e,t,i=!0){if(e==null)return null;let r=e.replace(Lre,(...o)=>o[0]=="$"?t?"\\$":"$":o[0]==`
`?"\\n":o[0]=="\r"?"\\r":`\\${o[0]}`);return i||!Bre.test(r)?`'${r}'`:r}function p8(e){let t="";for(let i=0;i<e;i++)t+=YT;return t}function n1(e,t){if(t===0)return fo(e);let i=[];for(let r=0;r<t;r++)i.push(Xc);return fo(e,void 0,i)}var g6="@";function v6(e){return`${g6}${e}`}function Vre(e,t){return`${g6}${e}.${t}`}function zre(e,t){let i=Dh(t,!1,!1);return i!==t?`${e}[${i}]`:`${e}.${t}`}function _6(e,t){return`animation_${e}_${t}`}function Ure(e){return Hre("ngJitMode",e)}function Hre(e,t){let i=new Lc({name:e,moduleName:null}),r=new Si(et.Identical,new Yf(i),U("undefined")),n=new Si(et.Or,r,i,void 0,void 0,!0);return new Si(et.And,n,t)}function zn(e){let t=new Ti(e);return{value:t,type:t}}function Ih(e,t){let i=ti(e.map(r=>r.value));return t?ro([],i):i}function PD(e,t){return{expression:e,forwardRef:t}}function jre({expression:e,forwardRef:t}){switch(t){case 0:case 1:return e;case 2:return Gre(e)}}function Gre(e){return Xe(T.forwardRef).callFn([ro([],e)])}var lw=function(e){return e[e.Class=0]="Class",e[e.Function=1]="Function",e}(lw||{}),kc=function(e){return e[e.Directive=0]="Directive",e[e.Component=1]="Component",e[e.Injectable=2]="Injectable",e[e.Pipe=3]="Pipe",e[e.NgModule=4]="NgModule",e}(kc||{});function Th(e){let t=ft("t"),i=null,r=m8(e)?t:new Si(et.Or,t,e.type.value),n=null;e.deps!==null?e.deps!=="invalid"&&(n=new Uv(r,f8(e.deps,e.target))):(i=ft(`\u0275${e.name}_BaseFactory`),n=i.callFn([r]));let o=[],a=null;function s(l){let d=ft("r");o.push(d.set(zh).toDeclStmt());let u=n!==null?d.set(n).toStmt():Xe(T.invalidFactory).callFn([]).toStmt();return o.push(w0(t,[u],[d.set(l).toStmt()])),d}if(m8(e)){let l=f8(e.delegateDeps,e.target),d=new(e.delegateType===lw.Class?Uv:la)(e.delegate,l);a=s(d)}else Yre(e)?a=s(e.expression):a=n;if(a===null)o.push(Xe(T.invalidFactory).callFn([]).toStmt());else if(i!==null){let l=Xe(T.getInheritedFactory).callFn([e.type.value]),d=new Si(et.Or,i,i.set(l));o.push(new Rn(d.callFn([r])))}else o.push(new Rn(a));let c=Xl([new Dr("t",Xc)],o,aa,void 0,`${e.name}_Factory`);return i!==null&&(c=ro([],[new Ro(i.name),new Rn(c)]).callFn([],void 0,!0)),{expression:c,statements:[],type:$re(e)}}function $re(e){let t=e.deps!==null&&e.deps!=="invalid"?qre(e.deps):Wl;return fo(Xe(T.FactoryDeclaration,[n1(e.type.type,e.typeArgumentCount),t]))}function f8(e,t){return e.map((i,r)=>Wre(i,t,r))}function Wre(e,t,i){if(e.token===null)return Xe(T.invalidFactoryDep).callFn([U(i)]);if(e.attributeNameType===null){let r=0|(e.self?2:0)|(e.skipSelf?4:0)|(e.host?1:0)|(e.optional?8:0)|(t===kc.Pipe?16:0),n=r!==0||e.optional?U(r):null,o=[e.token];n&&o.push(n);let a=Zre(t);return Xe(a).callFn(o)}else return Xe(T.injectAttribute).callFn([e.token])}function qre(e){let t=!1,i=e.map(r=>{let n=Xre(r);return n!==null?(t=!0,n):U(null)});return t?fo(ti(i)):Wl}function Xre(e){let t=[];return e.attributeNameType!==null&&t.push({key:"attribute",value:e.attributeNameType,quoted:!1}),e.optional&&t.push({key:"optional",value:U(!0),quoted:!1}),e.host&&t.push({key:"host",value:U(!0),quoted:!1}),e.self&&t.push({key:"self",value:U(!0),quoted:!1}),e.skipSelf&&t.push({key:"skipSelf",value:U(!0),quoted:!1}),t.length>0?ao(t):null}function m8(e){return e.delegateType!==void 0}function Yre(e){return e.expression!==void 0}function Zre(e){switch(e){case kc.Component:case kc.Directive:case kc.Pipe:return T.directiveInject;case kc.NgModule:case kc.Injectable:default:return T.inject}}var Vl=function(e){return e[e.RAW_TEXT=0]="RAW_TEXT",e[e.ESCAPABLE_RAW_TEXT=1]="ESCAPABLE_RAW_TEXT",e[e.PARSABLE_DATA=2]="PARSABLE_DATA",e}(Vl||{});function sa(e,t=!0){if(e[0]!=":")return[null,e];let i=e.indexOf(":",1);if(i===-1){if(t)throw new Error(`Unsupported format "${e}" expecting ":namespace:name"`);return[null,e]}return[e.slice(1,i),e.slice(i+1)]}function QT(e){return sa(e)[1]==="ng-container"}function JT(e){return sa(e)[1]==="ng-content"}function Kre(e){return sa(e)[1]==="ng-template"}function eA(e){return e===null?null:sa(e)[0]}function tA(e,t){return e?`:${e}:${t}`:t}var Qf=class{constructor(t,i){this.value=t,this.sourceSpan=i}visit(t){throw new Error("visit() not implemented for Comment")}},Rc=class{constructor(t,i){this.value=t,this.sourceSpan=i}visit(t){return t.visitText(this)}},Hh=class{constructor(t,i,r){this.value=t,this.sourceSpan=i,this.i18n=r}visit(t){return t.visitBoundText(this)}},Jf=class{constructor(t,i,r,n,o,a){this.name=t,this.value=i,this.sourceSpan=r,this.keySpan=n,this.valueSpan=o,this.i18n=a}visit(t){return t.visitTextAttribute(this)}},cw=class e{constructor(t,i,r,n,o,a,s,c,l){this.name=t,this.type=i,this.securityContext=r,this.value=n,this.unit=o,this.sourceSpan=a,this.keySpan=s,this.valueSpan=c,this.i18n=l}static fromBoundElementProperty(t,i){if(t.keySpan===void 0)throw new Error(`Unexpected state: keySpan must be defined for bound attributes but was not for ${t.name}: ${t.sourceSpan}`);return new e(t.name,t.type,t.securityContext,t.value,t.unit,t.sourceSpan,t.keySpan,t.valueSpan,i)}visit(t){return t.visitBoundAttribute(this)}},dw=class e{constructor(t,i,r,n,o,a,s,c){this.name=t,this.type=i,this.handler=r,this.target=n,this.phase=o,this.sourceSpan=a,this.handlerSpan=s,this.keySpan=c}static fromParsedEvent(t){let i=t.type===0?t.targetOrPhase:null,r=t.type===1?t.targetOrPhase:null;if(t.keySpan===void 0)throw new Error(`Unexpected state: keySpan must be defined for bound event but was not for ${t.name}: ${t.sourceSpan}`);return new e(t.name,t.type,t.handler,i,r,t.sourceSpan,t.handlerSpan,t.keySpan)}visit(t){return t.visitBoundEvent(this)}},da=class{constructor(t,i,r,n,o,a,s,c,l,d){this.name=t,this.attributes=i,this.inputs=r,this.outputs=n,this.children=o,this.references=a,this.sourceSpan=s,this.startSourceSpan=c,this.endSourceSpan=l,this.i18n=d}visit(t){return t.visitElement(this)}},Vc=class{constructor(t,i,r,n){this.nameSpan=t,this.sourceSpan=i,this.prefetchSpan=r,this.whenOrOnSourceSpan=n}visit(t){return t.visitDeferredTrigger(this)}},iA=class extends Vc{constructor(t,i,r,n){super(null,i,r,n),this.value=t}},rA=class extends Vc{},nA=class extends Vc{},uw=class extends Vc{constructor(t,i,r,n,o){super(i,r,n,o),this.reference=t}},oA=class extends Vc{constructor(t,i,r,n,o){super(i,r,n,o),this.delay=t}},hw=class extends Vc{constructor(t,i,r,n,o){super(i,r,n,o),this.reference=t}},pw=class extends Vc{constructor(t,i,r,n,o){super(i,r,n,o),this.reference=t}},js=class{constructor(t,i,r,n){this.nameSpan=t,this.sourceSpan=i,this.startSourceSpan=r,this.endSourceSpan=n}},Wv=class extends js{constructor(t,i,r,n,o,a,s){super(r,n,o,a),this.children=t,this.minimumTime=i,this.i18n=s}visit(t){return t.visitDeferredBlockPlaceholder(this)}},qv=class extends js{constructor(t,i,r,n,o,a,s,c){super(n,o,a,s),this.children=t,this.afterTime=i,this.minimumTime=r,this.i18n=c}visit(t){return t.visitDeferredBlockLoading(this)}},Xv=class extends js{constructor(t,i,r,n,o,a){super(i,r,n,o),this.children=t,this.i18n=a}visit(t){return t.visitDeferredBlockError(this)}},jh=class extends js{constructor(t,i,r,n,o,a,s,c,l,d,u,h){super(s,c,d,u),this.children=t,this.placeholder=n,this.loading=o,this.error=a,this.mainBlockSpan=l,this.i18n=h,this.triggers=i,this.prefetchTriggers=r,this.definedTriggers=Object.keys(i),this.definedPrefetchTriggers=Object.keys(r)}visit(t){return t.visitDeferredBlock(this)}visitAll(t){this.visitTriggers(this.definedTriggers,this.triggers,t),this.visitTriggers(this.definedPrefetchTriggers,this.prefetchTriggers,t),Rv(t,this.children);let i=[this.placeholder,this.loading,this.error].filter(r=>r!==null);Rv(t,i)}visitTriggers(t,i,r){Rv(r,t.map(n=>i[n]))}},fw=class extends js{constructor(t,i,r,n,o,a,s){super(s,n,o,a),this.expression=t,this.cases=i,this.unknownBlocks=r}visit(t){return t.visitSwitchBlock(this)}},Yv=class extends js{constructor(t,i,r,n,o,a,s){super(a,r,n,o),this.expression=t,this.children=i,this.i18n=s}visit(t){return t.visitSwitchBlockCase(this)}},em=class extends js{constructor(t,i,r,n,o,a,s,c,l,d,u,h,p){super(h,c,d,u),this.item=t,this.expression=i,this.trackBy=r,this.trackKeywordSpan=n,this.contextVariables=o,this.children=a,this.empty=s,this.mainBlockSpan=l,this.i18n=p}visit(t){return t.visitForLoopBlock(this)}},Zv=class extends js{constructor(t,i,r,n,o,a){super(o,i,r,n),this.children=t,this.i18n=a}visit(t){return t.visitForLoopBlockEmpty(this)}},mw=class extends js{constructor(t,i,r,n,o){super(o,i,r,n),this.branches=t}visit(t){return t.visitIfBlock(this)}},Ph=class extends js{constructor(t,i,r,n,o,a,s,c){super(s,n,o,a),this.expression=t,this.children=i,this.expressionAlias=r,this.i18n=c}visit(t){return t.visitIfBlockBranch(this)}},gw=class{constructor(t,i,r){this.name=t,this.sourceSpan=i,this.nameSpan=r}visit(t){return t.visitUnknownBlock(this)}},Fa=class{constructor(t,i,r,n,o,a,s,c,l,d,u,h){this.tagName=t,this.attributes=i,this.inputs=r,this.outputs=n,this.templateAttrs=o,this.children=a,this.references=s,this.variables=c,this.sourceSpan=l,this.startSourceSpan=d,this.endSourceSpan=u,this.i18n=h}visit(t){return t.visitTemplate(this)}},vw=class{constructor(t,i,r,n){this.selector=t,this.attributes=i,this.sourceSpan=r,this.i18n=n,this.name="ng-content"}visit(t){return t.visitContent(this)}},zc=class{constructor(t,i,r,n,o){this.name=t,this.value=i,this.sourceSpan=r,this.keySpan=n,this.valueSpan=o}visit(t){return t.visitVariable(this)}},Kv=class{constructor(t,i,r,n,o){this.name=t,this.value=i,this.sourceSpan=r,this.keySpan=n,this.valueSpan=o}visit(t){return t.visitReference(this)}},Qv=class{constructor(t,i,r,n){this.vars=t,this.placeholders=i,this.sourceSpan=r,this.i18n=n}visit(t){return t.visitIcu(this)}};function Rv(e,t){let i=[];if(e.visit)for(let r of t)e.visit(r)||r.visit(e);else for(let r of t){let n=r.visit(e);n&&i.push(n)}return i}var Oo=class{constructor(t,i,r,n,o,a){this.nodes=t,this.placeholders=i,this.placeholderToMessage=r,this.meaning=n,this.description=o,this.customId=a,this.legacyIds=[],this.id=this.customId,this.messageString=Qre(this.nodes),t.length?this.sources=[{filePath:t[0].sourceSpan.start.file.url,startLine:t[0].sourceSpan.start.line+1,startCol:t[0].sourceSpan.start.col+1,endLine:t[t.length-1].sourceSpan.end.line+1,endCol:t[0].sourceSpan.start.col+1}]:this.sources=[]}},Bf=class{constructor(t,i){this.value=t,this.sourceSpan=i}visit(t,i){return t.visitText(this,i)}},jl=class{constructor(t,i){this.children=t,this.sourceSpan=i}visit(t,i){return t.visitContainer(this,i)}},_w=class{constructor(t,i,r,n,o){this.expression=t,this.type=i,this.cases=r,this.sourceSpan=n,this.expressionPlaceholder=o}visit(t,i){return t.visitIcu(this,i)}},Kd=class{constructor(t,i,r,n,o,a,s,c,l){this.tag=t,this.attrs=i,this.startName=r,this.closeName=n,this.children=o,this.isVoid=a,this.sourceSpan=s,this.startSourceSpan=c,this.endSourceSpan=l}visit(t,i){return t.visitTagPlaceholder(this,i)}},Jv=class{constructor(t,i,r){this.value=t,this.name=i,this.sourceSpan=r}visit(t,i){return t.visitPlaceholder(this,i)}},tm=class{constructor(t,i,r){this.value=t,this.name=i,this.sourceSpan=r}visit(t,i){return t.visitIcuPlaceholder(this,i)}},Uc=class{constructor(t,i,r,n,o,a,s,c){this.name=t,this.parameters=i,this.startName=r,this.closeName=n,this.children=o,this.sourceSpan=a,this.startSourceSpan=s,this.endSourceSpan=c}visit(t,i){return t.visitBlockPlaceholder(this,i)}};function Qre(e){let t=new aA;return e.map(r=>r.visit(t)).join("")}var aA=class{visitText(t){return t.value}visitContainer(t){return t.children.map(i=>i.visit(this)).join("")}visitIcu(t){let i=Object.keys(t.cases).map(r=>`${r} {${t.cases[r].visit(this)}}`);return`{${t.expressionPlaceholder}, ${t.type}, ${i.join(" ")}}`}visitTagPlaceholder(t){let i=t.children.map(r=>r.visit(this)).join("");return`{$${t.startName}}${i}{$${t.closeName}}`}visitPlaceholder(t){return`{$${t.name}}`}visitIcuPlaceholder(t){return`{$${t.name}}`}visitBlockPlaceholder(t){let i=t.children.map(r=>r.visit(this)).join("");return`{$${t.startName}}${i}{$${t.closeName}}`}};var sA=class{visitTag(t){let i=this._serializeAttributes(t.attrs);if(t.children.length==0)return`<${t.name}${i}/>`;let r=t.children.map(n=>n.visit(this));return`<${t.name}${i}>${r.join("")}</${t.name}>`}visitText(t){return t.value}visitDeclaration(t){return`<?xml${this._serializeAttributes(t.attrs)} ?>`}_serializeAttributes(t){let i=Object.keys(t).map(r=>`${r}="${t[r]}"`).join(" ");return i.length>0?" "+i:""}visitDoctype(t){return`<!DOCTYPE ${t.rootTag} [
${t.dtd}
]>`}},kUe=new sA;function Jre(e){return e.toUpperCase().replace(/[^A-Z0-9_]/g,"_")}var ene="MSG_",tne="i18n_",b6="i18n",lA="i18n-",ine="VAR_",rne="I18N_EXP_",g8="\uFFFD";function y6(e){return e===b6||e.startsWith(lA)}function e0(e){return e instanceof Oo}function kv(e){return e0(e)&&e.nodes.length===1&&e.nodes[0]instanceof _w}function nne(e){return!!e.i18n}function one(e){return e.attrs.some(t=>y6(t.name))}function ND(e){return e.nodes[0]}function o1(e,t=0){let i=t>0?`:${t}`:"";return`${g8}${e}${i}${g8}`}function ane(e,t=0,i=0){if(!e.length)return"";let r="",n=e.length-1;for(let o=0;o<n;o++)r+=`${e[o]}${o1(t+o,i)}`;return r+=e[n],r}function sne(e=0){let t=e;return()=>t++}function v8(e){let t={};return e.forEach((i,r)=>{t[r]=U(i.length>1?`[${i.join("|")}]`:i[0])}),t}function Pv(e,t,...i){let r=e.get(t)||[];r.push(...i),e.set(t,r)}function x6(e,t=0,i=0){let r=t,n=new Map,o=e instanceof Oo?e.nodes.find(a=>a instanceof jl):e;return o&&o.children.filter(a=>a instanceof Jv).forEach((a,s)=>{let c=o1(r+s,i);Pv(n,a.name,c)}),n}function E0(e={},t){let i={};return e&&Object.keys(e).length&&Object.keys(e).forEach(r=>i[C0(r,t)]=e[r]),i}function C0(e,t=!0){let i=Jre(e);if(!t)return i;let r=i.split("_");if(r.length===1)return e.toLowerCase();let n;/^\d+$/.test(r[r.length-1])&&(n=r.pop());let o=r.shift().toLowerCase();return r.length&&(o+=r.map(a=>a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()).join("")),n?`${o}_${n}`:o}function bw(e){return`${ene}${e}`.toUpperCase()}function w6(e){return new Ro(e.name,void 0,aa,void 0,e.sourceSpan)}var lne=/[-.]/,OD="_t",na="ctx",S0="rf",cne="_r",dne="$implicit",une="ngNonBindable",E6="restoredCtx",cA="#context",hne=500,pne=new Set([T.element,T.elementStart,T.elementEnd,T.elementContainer,T.elementContainerStart,T.elementContainerEnd,T.i18nExp,T.listener,T.classProp,T.syntheticHostListener,T.hostProperty,T.syntheticHostProperty,T.property,T.propertyInterpolate1,T.propertyInterpolate2,T.propertyInterpolate3,T.propertyInterpolate4,T.propertyInterpolate5,T.propertyInterpolate6,T.propertyInterpolate7,T.propertyInterpolate8,T.propertyInterpolateV,T.attribute,T.attributeInterpolate1,T.attributeInterpolate2,T.attributeInterpolate3,T.attributeInterpolate4,T.attributeInterpolate5,T.attributeInterpolate6,T.attributeInterpolate7,T.attributeInterpolate8,T.attributeInterpolateV,T.styleProp,T.stylePropInterpolate1,T.stylePropInterpolate2,T.stylePropInterpolate3,T.stylePropInterpolate4,T.stylePropInterpolate5,T.stylePropInterpolate6,T.stylePropInterpolate7,T.stylePropInterpolate8,T.stylePropInterpolateV,T.textInterpolate,T.textInterpolate1,T.textInterpolate2,T.textInterpolate3,T.textInterpolate4,T.textInterpolate5,T.textInterpolate6,T.textInterpolate7,T.textInterpolate8,T.textInterpolateV,T.templateCreate,T.twoWayProperty,T.twoWayListener]);function Gh(e,t,i){return Xe(t,null,e).callFn(i,e)}function C6(e,t){let i=null;return()=>(i||(e(new Ro(OD,void 0,Xc)),i=ft(t)),i)}function Qa(e){throw new Error(`Invalid state: Visitor ${this.constructor.name} doesn't handle ${e.constructor.name}`)}function fl(e){return Array.isArray(e)?ti(e.map(fl)):U(e,aa)}function _8(e,t){let i=Object.getOwnPropertyNames(e);return i.length===0?null:ao(i.map(r=>{let n=e[r],o,a,s,c;if(typeof n=="string")o=r,s=r,a=n,c=fl(a);else{s=r,o=n.classPropertyName,a=n.bindingPropertyName;let l=a!==o,d=n.transformFunction!==null,u=null;if(n.isSignal&&(u=y8(Lf.SignalBased,u)),d&&(u=y8(Lf.HasDecoratorInputTransform,u)),t&&(l||d||u!==null)){let p=[u??Xe(T.InputFlags).prop(Lf[Lf.None]),fl(a)];(l||d)&&(p.push(fl(o)),d&&p.push(n.transformFunction)),c=ti(p)}else c=fl(a)}return{key:s,quoted:lne.test(s),value:c}}))}function b8(e){return Xe(T.InputFlags).prop(Lf[e])}function y8(e,t){return t===null?b8(e):b8(e).bitwiseOr(t)}function If(e){for(;p6(e[e.length-1]);)e.pop();return e}var Qd=class{constructor(){this.values=[]}set(t,i){if(i){let r=this.values.find(n=>n.key===t);r?r.value=i:this.values.push({key:t,value:i,quoted:!1})}}toLiteralMap(){return ao(this.values)}};function fne(e){let t=e instanceof da?e.name:"ng-template",i=mne(e),r=new Xf,n=sa(t)[1];return r.setElement(n),Object.getOwnPropertyNames(i).forEach(o=>{let a=sa(o)[1],s=i[o];r.addAttribute(a,s),o.toLowerCase()==="class"&&s.trim().split(/\s+/).forEach(l=>r.addClassName(l))}),r}function mne(e){let t={};return e instanceof Fa&&e.tagName!=="ng-template"?e.templateAttrs.forEach(i=>t[i.name]=""):(e.attributes.forEach(i=>{y6(i.name)||(t[i.name]=i.value)}),e.inputs.forEach(i=>{(i.type===0||i.type===5)&&(t[i.name]="")}),e.outputs.forEach(i=>{t[i.name]=""})),t}function np(e){let{expressions:t,strings:i}=e;return t.length===1&&i.length===2&&i[0]===""&&i[1]===""?1:t.length+i.length}function yw(e){let t=[],i=null,r=null,n=0;for(let o of e){let a=(typeof o.paramsOrFn=="function"?o.paramsOrFn():o.paramsOrFn)??[],s=Array.isArray(a)?a:[a];n<hne&&r===o.reference&&pne.has(r)?(i=i.callFn(s,i.sourceSpan),n++):(i!==null&&t.push(i.toStmt()),i=Gh(o.span,o.reference,s),r=o.reference,n=0)}return i!==null&&t.push(i.toStmt()),t}function x8(e,t){let i=null,r={name:e.name,type:e.type,typeArgumentCount:e.typeArgumentCount,deps:[],target:kc.Injectable};if(e.useClass!==void 0){let s=e.useClass.expression.isEquivalent(e.type.value),c;e.deps!==void 0&&(c=e.deps),c!==void 0?i=Th(ve(L({},r),{delegate:e.useClass.expression,delegateDeps:c,delegateType:lw.Class})):s?i=Th(r):i={statements:[],expression:w8(e.type.value,e.useClass.expression,t)}}else e.useFactory!==void 0?e.deps!==void 0?i=Th(ve(L({},r),{delegate:e.useFactory,delegateDeps:e.deps||[],delegateType:lw.Function})):i={statements:[],expression:ro([],e.useFactory.callFn([]))}:e.useValue!==void 0?i=Th(ve(L({},r),{expression:e.useValue.expression})):e.useExisting!==void 0?i=Th(ve(L({},r),{expression:Xe(T.inject).callFn([e.useExisting.expression])})):i={statements:[],expression:w8(e.type.value,e.type.value,t)};let n=e.type.value,o=new Qd;return o.set("token",n),o.set("factory",i.expression),e.providedIn.expression.value!==null&&o.set("providedIn",jre(e.providedIn)),{expression:Xe(T.\u0275\u0275defineInjectable).callFn([o.toLiteralMap()],void 0,!0),type:gne(e),statements:i.statements}}function gne(e){return new Us(Xe(T.InjectableDeclaration,[n1(e.type.type,e.typeArgumentCount)]))}function w8(e,t,i){if(e.node===t.node)return t.prop("\u0275fac");if(!i)return E8(t);let r=Xe(T.resolveForwardRef).callFn([t]);return E8(r)}function E8(e){return ro([new Dr("t",Xc)],e.prop("\u0275fac").callFn([ft("t")]))}var vne=[/^\s*$/,/[<>]/,/^[{}]$/,/&(#|[a-z])/i,/^\/\//];function _ne(e,t){if(t!=null&&!(Array.isArray(t)&&t.length==2))throw new Error(`Expected '${e}' to be an array, [start, end].`);if(t!=null){let i=t[0],r=t[1];vne.forEach(n=>{if(n.test(i)||n.test(r))throw new Error(`['${i}', '${r}'] contains unusable interpolation symbol.`)})}}var xw=class e{static fromArray(t){return t?(_ne("interpolation",t),new e(t[0],t[1])):zl}constructor(t,i){this.start=t,this.end=i}},zl=new xw("{{","}}"),bne=new Set(["switch"]),oa=0,yne=8,RD=9,Nh=10,S6=11,T6=12,FD=13,A6=32,dA=33,t0=34,D6=35,I6=36,xne=37,ww=38,i0=39,Fc=40,ml=41,wne=42,M6=43,zs=44,Ew=45,Rf=46,Pc=47,$d=58,gl=59,Vf=60,zf=61,Gd=62,C8=63,LD=48,Ene=55,k6=57,mm=65,Cne=69,Sne=70,Tne=88,a1=90,qf=91,Cw=92,Uf=93,Ane=94,s1=95,$h=97,Dne=98,Ine=101,BD=102,P6=110,N6=114,O6=116,R6=117,F6=118,L6=120,T0=122,Ul=123,S8=124,Pa=125,B6=160;var T8=64,Mne=96;function l1(e){return e>=RD&&e<=A6||e==B6}function Mc(e){return LD<=e&&e<=k6}function c1(e){return e>=$h&&e<=T0||e>=mm&&e<=a1}function kne(e){return e>=$h&&e<=BD||e>=mm&&e<=Sne||Mc(e)}function V6(e){return e===Nh||e===FD}function A8(e){return LD<=e&&e<=Ene}function Sw(e){return e===i0||e===t0||e===Mne}var r0=class e{constructor(t,i,r,n){this.file=t,this.offset=i,this.line=r,this.col=n}toString(){return this.offset!=null?`${this.file.url}@${this.line}:${this.col}`:this.file.url}moveBy(t){let i=this.file.content,r=i.length,n=this.offset,o=this.line,a=this.col;for(;n>0&&t<0;)if(n--,t++,i.charCodeAt(n)==Nh){o--;let c=i.substring(0,n-1).lastIndexOf(String.fromCharCode(Nh));a=c>0?n-c:n}else a--;for(;n<r&&t>0;){let s=i.charCodeAt(n);n++,t--,s==Nh?(o++,a=0):a++}return new e(this.file,n,o,a)}getContext(t,i){let r=this.file.content,n=this.offset;if(n!=null){n>r.length-1&&(n=r.length-1);let o=n,a=0,s=0;for(;a<t&&n>0&&(n--,a++,!(r[n]==`
`&&++s==i)););for(a=0,s=0;a<t&&o<r.length-1&&(o++,a++,!(r[o]==`
`&&++s==i)););return{before:r.substring(n,this.offset),after:r.substring(this.offset,o+1)}}return null}},Tw=class{constructor(t,i){this.content=t,this.url=i}},pi=class{constructor(t,i,r=t,n=null){this.start=t,this.end=i,this.fullStart=r,this.details=n}toString(){return this.start.file.content.substring(this.start.offset,this.end.offset)}},qd=function(e){return e[e.WARNING=0]="WARNING",e[e.ERROR=1]="ERROR",e}(qd||{}),si=class{constructor(t,i,r=qd.ERROR){this.span=t,this.msg=i,this.level=r}contextualMessage(){let t=this.span.start.getContext(100,3);return t?`${this.msg} ("${t.before}[${qd[this.level]} ->]${t.after}")`:this.msg}toString(){let t=this.span.details?`, ${this.span.details}`:"";return`${this.contextualMessage()}: ${this.span.start}${t}`}};function Pne(e,t,i){let r=`in ${e} ${t} in ${i}`,n=new Tw("",r);return new pi(new r0(n,-1,-1,-1),new r0(n,-1,-1,-1))}var Nne=0;function One(e){if(!e||!e.reference)return null;let t=e.reference;if(t.__anonymousType)return t.__anonymousType;if(t.__forward_ref__)return"__forward_ref__";let i=m6(t);return i.indexOf("(")>=0?(i=`anonymous_${Nne++}`,t.__anonymousType=i):i=Gl(i),i}function Gl(e){return e.replace(/\W/g,"_")}var D8='(this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e})',uA=class extends KT{constructor(){super(!1)}visitWrappedNodeExpr(t,i){throw new Error("Cannot emit a WrappedNodeExpr in Javascript.")}visitDeclareVarStmt(t,i){return i.print(t,`var ${t.name}`),t.value&&(i.print(t," = "),t.value.visitExpression(this,i)),i.println(t,";"),null}visitTaggedTemplateExpr(t,i){let r=t.template.elements;return t.tag.visitExpression(this,i),i.print(t,`(${D8}(`),i.print(t,`[${r.map(n=>Dh(n.text,!1)).join(", ")}], `),i.print(t,`[${r.map(n=>Dh(n.rawText,!1)).join(", ")}])`),t.template.expressions.forEach(n=>{i.print(t,", "),n.visitExpression(this,i)}),i.print(t,")"),null}visitFunctionExpr(t,i){return i.print(t,`function${t.name?" "+t.name:""}(`),this._visitParams(t.params,i),i.println(t,") {"),i.incIndent(),this.visitAllStatements(t.statements,i),i.decIndent(),i.print(t,"}"),null}visitArrowFunctionExpr(t,i){if(i.print(t,"("),this._visitParams(t.params,i),i.print(t,") =>"),Array.isArray(t.body))i.println(t,"{"),i.incIndent(),this.visitAllStatements(t.body,i),i.decIndent(),i.print(t,"}");else{let r=t.body instanceof vl;r&&i.print(t,"("),t.body.visitExpression(this,i),r&&i.print(t,")")}return null}visitDeclareFunctionStmt(t,i){return i.print(t,`function ${t.name}(`),this._visitParams(t.params,i),i.println(t,") {"),i.incIndent(),this.visitAllStatements(t.statements,i),i.decIndent(),i.println(t,"}"),null}visitLocalizedString(t,i){i.print(t,`$localize(${D8}(`);let r=[t.serializeI18nHead()];for(let n=1;n<t.messageParts.length;n++)r.push(t.serializeI18nTemplatePart(n));return i.print(t,`[${r.map(n=>Dh(n.cooked,!1)).join(", ")}], `),i.print(t,`[${r.map(n=>Dh(n.raw,!1)).join(", ")}])`),t.expressions.forEach(n=>{i.print(t,", "),n.visitExpression(this,i)}),i.print(t,")"),null}_visitParams(t,i){this.visitAllObjects(r=>i.print(null,r.name),t,i,",")}},Nx;function Rne(){if(Nx===void 0){let e=Ov.trustedTypes;if(Nx=null,e)try{Nx=e.createPolicy("angular#unsafe-jit",{createScript:t=>t})}catch{}}return Nx}function Fne(e){return Rne()?.createScript(e)||e}function I8(...e){if(!Ov.trustedTypes)return new Function(...e);let t=e.slice(0,-1).join(","),i=e[e.length-1],r=`(function anonymous(${t}
) { ${i}
})`,n=Ov.eval(Fne(r));return n.bind===void 0?new Function(...e):(n.toString=()=>r,n.bind(Ov))}var hA=class{evaluateStatements(t,i,r,n){let o=new pA(r),a=ZT.createRoot();return i.length>0&&!Lne(i[0])&&(i=[U("use strict").toStmt(),...i]),o.visitAllStatements(i,a),o.createReturnStmt(a),this.evaluateCode(t,a,o.getArgs(),n)}evaluateCode(t,i,r,n){let o=`"use strict";${i.toSource()}
//# sourceURL=${t}`,a=[],s=[];for(let l in r)s.push(r[l]),a.push(l);if(n){let l=I8(...a.concat("return null;")).toString(),d=l.slice(0,l.indexOf("return null;")).split(`
`).length-1;o+=`
${i.toSourceMapGenerator(t,d).toJsComment()}`}let c=I8(...a.concat(o));return this.executeFunction(c,s)}executeFunction(t,i){return t(...i)}},pA=class extends uA{constructor(t){super(),this.refResolver=t,this._evalArgNames=[],this._evalArgValues=[],this._evalExportedVars=[]}createReturnStmt(t){new Rn(new vl(this._evalExportedVars.map(r=>new Kf(r,ft(r),!1)))).visitStatement(this,t)}getArgs(){let t={};for(let i=0;i<this._evalArgNames.length;i++)t[this._evalArgNames[i]]=this._evalArgValues[i];return t}visitExternalExpr(t,i){return this._emitReferenceToExternal(t,this.refResolver.resolveExternalReference(t.value),i),null}visitWrappedNodeExpr(t,i){return this._emitReferenceToExternal(t,t.node,i),null}visitDeclareVarStmt(t,i){return t.hasModifier(po.Exported)&&this._evalExportedVars.push(t.name),super.visitDeclareVarStmt(t,i)}visitDeclareFunctionStmt(t,i){return t.hasModifier(po.Exported)&&this._evalExportedVars.push(t.name),super.visitDeclareFunctionStmt(t,i)}_emitReferenceToExternal(t,i,r){let n=this._evalArgValues.indexOf(i);if(n===-1){n=this._evalArgValues.length,this._evalArgValues.push(i);let o=One({reference:i})||"val";this._evalArgNames.push(`jit_${o}_${n}`)}r.print(t,this._evalArgNames[n])}};function Lne(e){return e.isEquivalent(U("use strict").toStmt())}function M8(e){let t=new Qd;e.providers!==null&&t.set("providers",e.providers),e.imports.length>0&&t.set("imports",ti(e.imports));let i=Xe(T.defineInjector).callFn([t.toLiteralMap()],void 0,!0),r=Bne(e);return{expression:i,type:r,statements:[]}}function Bne(e){return new Us(Xe(T.InjectorDeclaration,[new Us(e.type.type)]))}var fA=class{constructor(t){this.context=t}resolveExternalReference(t){if(t.moduleName!=="@angular/core")throw new Error(`Cannot resolve external reference to ${t.moduleName}, only references to @angular/core are supported.`);if(!this.context.hasOwnProperty(t.name))throw new Error(`No value provided for @angular/core symbol '${t.name}'.`);return this.context[t.name]}},Aw=function(e){return e[e.Inline=0]="Inline",e[e.SideEffect=1]="SideEffect",e[e.Omit=2]="Omit",e}(Aw||{}),Xd=function(e){return e[e.Global=0]="Global",e[e.Local=1]="Local",e}(Xd||{});function Vne(e){let t=[],i=new Qd;if(i.set("type",e.type.value),e.kind===Xd.Global&&e.bootstrap.length>0&&i.set("bootstrap",Ih(e.bootstrap,e.containsForwardDecls)),e.selectorScopeMode===Aw.Inline)e.declarations.length>0&&i.set("declarations",Ih(e.declarations,e.containsForwardDecls)),e.imports.length>0&&i.set("imports",Ih(e.imports,e.containsForwardDecls)),e.exports.length>0&&i.set("exports",Ih(e.exports,e.containsForwardDecls));else if(e.selectorScopeMode===Aw.SideEffect){let o=Hne(e);o!==null&&t.push(o)}e.schemas!==null&&e.schemas.length>0&&i.set("schemas",ti(e.schemas.map(o=>o.value))),e.id!==null&&(i.set("id",e.id),t.push(Xe(T.registerNgModuleType).callFn([e.type.value,e.id]).toStmt()));let r=Xe(T.defineNgModule).callFn([i.toLiteralMap()],void 0,!0),n=Une(e);return{expression:r,type:n,statements:t}}function zne(e){let t=new Qd;return t.set("type",new Ti(e.type)),e.bootstrap!==void 0&&t.set("bootstrap",new Ti(e.bootstrap)),e.declarations!==void 0&&t.set("declarations",new Ti(e.declarations)),e.imports!==void 0&&t.set("imports",new Ti(e.imports)),e.exports!==void 0&&t.set("exports",new Ti(e.exports)),e.schemas!==void 0&&t.set("schemas",new Ti(e.schemas)),e.id!==void 0&&t.set("id",new Ti(e.id)),Xe(T.defineNgModule).callFn([t.toLiteralMap()])}function Une(e){if(e.kind===Xd.Local)return new Us(e.type.value);let{type:t,declarations:i,exports:r,imports:n,includeImportTypes:o,publicDeclarationTypes:a}=e;return new Us(Xe(T.NgModuleDeclaration,[new Us(t.type),a===null?_T(i):jne(a),o?_T(n):Wl,_T(r)]))}function Hne(e){let t=new Qd;if(e.kind===Xd.Global?e.declarations.length>0&&t.set("declarations",Ih(e.declarations,e.containsForwardDecls)):e.declarationsExpression&&t.set("declarations",e.declarationsExpression),e.kind===Xd.Global?e.imports.length>0&&t.set("imports",Ih(e.imports,e.containsForwardDecls)):e.importsExpression&&t.set("imports",e.importsExpression),e.kind===Xd.Global?e.exports.length>0&&t.set("exports",Ih(e.exports,e.containsForwardDecls)):e.exportsExpression&&t.set("exports",e.exportsExpression),e.kind===Xd.Local&&e.bootstrapExpression&&t.set("bootstrap",e.bootstrapExpression),Object.keys(t.values).length===0)return null;let i=new la(Xe(T.setNgModuleScope),[e.type.value,t.toLiteralMap()]),r=Ure(i),n=new Lh([],[r.toStmt()]);return new la(n,[]).toStmt()}function _T(e){let t=e.map(i=>x0(i.type));return e.length>0?fo(ti(t)):Wl}function jne(e){let t=e.map(i=>x0(i));return e.length>0?fo(ti(t)):Wl}function k8(e){let t=[];t.push({key:"name",value:U(e.pipeName),quoted:!1}),t.push({key:"type",value:e.type.value,quoted:!1}),t.push({key:"pure",value:U(e.pure),quoted:!1}),e.isStandalone&&t.push({key:"standalone",value:U(!0),quoted:!1});let i=Xe(T.definePipe).callFn([ao(t)],void 0,!0),r=Gne(e);return{expression:i,type:r,statements:[]}}function Gne(e){return new Us(Xe(T.PipeDeclaration,[n1(e.type.type,e.typeArgumentCount),new Us(new no(e.pipeName)),new Us(new no(e.isStandalone))]))}var d1=function(e){return e[e.Directive=0]="Directive",e[e.Pipe=1]="Pipe",e[e.NgModule=2]="NgModule",e}(d1||{}),n0=class{constructor(t,i,r,n){this.input=i,this.errLocation=r,this.ctxLocation=n,this.message=`Parser Error: ${t} ${r} [${i}] in ${n}`}},Wh=class{constructor(t,i){this.start=t,this.end=i}toAbsolute(t){return new es(t+this.start,t+this.end)}},_n=class{constructor(t,i){this.span=t,this.sourceSpan=i}toString(){return"AST"}},im=class extends _n{constructor(t,i,r){super(t,i),this.nameSpan=r}},Mo=class extends _n{visit(t,i=null){}},Po=class extends _n{visit(t,i=null){return t.visitImplicitReceiver(this,i)}},Yd=class extends Po{visit(t,i=null){return t.visitThisReceiver?.(this,i)}},Jd=class extends _n{constructor(t,i,r){super(t,i),this.expressions=r}visit(t,i=null){return t.visitChain(this,i)}},qh=class extends _n{constructor(t,i,r,n,o){super(t,i),this.condition=r,this.trueExp=n,this.falseExp=o}visit(t,i=null){return t.visitConditional(this,i)}},to=class extends im{constructor(t,i,r,n,o){super(t,i,r),this.receiver=n,this.name=o}visit(t,i=null){return t.visitPropertyRead(this,i)}},rm=class extends im{constructor(t,i,r,n,o,a){super(t,i,r),this.receiver=n,this.name=o,this.value=a}visit(t,i=null){return t.visitPropertyWrite(this,i)}},nm=class extends im{constructor(t,i,r,n,o){super(t,i,r),this.receiver=n,this.name=o}visit(t,i=null){return t.visitSafePropertyRead(this,i)}},Hc=class extends _n{constructor(t,i,r,n){super(t,i),this.receiver=r,this.key=n}visit(t,i=null){return t.visitKeyedRead(this,i)}},Xh=class extends _n{constructor(t,i,r,n){super(t,i),this.receiver=r,this.key=n}visit(t,i=null){return t.visitSafeKeyedRead(this,i)}},om=class extends _n{constructor(t,i,r,n,o){super(t,i),this.receiver=r,this.key=n,this.value=o}visit(t,i=null){return t.visitKeyedWrite(this,i)}},Yh=class extends im{constructor(t,i,r,n,o,a){super(t,i,a),this.exp=r,this.name=n,this.args=o}visit(t,i=null){return t.visitPipe(this,i)}},ko=class extends _n{constructor(t,i,r){super(t,i),this.value=r}visit(t,i=null){return t.visitLiteralPrimitive(this,i)}},Zh=class extends _n{constructor(t,i,r){super(t,i),this.expressions=r}visit(t,i=null){return t.visitLiteralArray(this,i)}},am=class extends _n{constructor(t,i,r,n){super(t,i),this.keys=r,this.values=n}visit(t,i=null){return t.visitLiteralMap(this,i)}},En=class extends _n{constructor(t,i,r,n){super(t,i),this.strings=r,this.expressions=n}visit(t,i=null){return t.visitInterpolation(this,i)}},ka=class extends _n{constructor(t,i,r,n,o){super(t,i),this.operation=r,this.left=n,this.right=o}visit(t,i=null){return t.visitBinary(this,i)}},jc=class e extends ka{static createMinus(t,i,r){return new e(t,i,"-",r,"-",new ko(t,i,0),r)}static createPlus(t,i,r){return new e(t,i,"+",r,"-",r,new ko(t,i,0))}constructor(t,i,r,n,o,a,s){super(t,i,o,a,s),this.operator=r,this.expr=n,this.left=null,this.right=null,this.operation=null}visit(t,i=null){return t.visitUnary!==void 0?t.visitUnary(this,i):t.visitBinary(this,i)}},Kh=class extends _n{constructor(t,i,r){super(t,i),this.expression=r}visit(t,i=null){return t.visitPrefixNot(this,i)}},Qh=class extends _n{constructor(t,i,r){super(t,i),this.expression=r}visit(t,i=null){return t.visitNonNullAssert(this,i)}},Yl=class extends _n{constructor(t,i,r,n,o){super(t,i),this.receiver=r,this.args=n,this.argumentSpan=o}visit(t,i=null){return t.visitCall(this,i)}},Jh=class extends _n{constructor(t,i,r,n,o){super(t,i),this.receiver=r,this.args=n,this.argumentSpan=o}visit(t,i=null){return t.visitSafeCall(this,i)}},es=class{constructor(t,i){this.start=t,this.end=i}},Oa=class extends _n{constructor(t,i,r,n,o){super(new Wh(0,i===null?0:i.length),new es(n,i===null?n:n+i.length)),this.ast=t,this.source=i,this.location=r,this.errors=o}visit(t,i=null){return t.visitASTWithSource?t.visitASTWithSource(this,i):this.ast.visit(t,i)}toString(){return`${this.source} in ${this.location}`}},o0=class{constructor(t,i,r){this.sourceSpan=t,this.key=i,this.value=r}},mA=class{constructor(t,i,r){this.sourceSpan=t,this.key=i,this.value=r}},Dw=class{visit(t,i){t.visit(this,i)}visitUnary(t,i){this.visit(t.expr,i)}visitBinary(t,i){this.visit(t.left,i),this.visit(t.right,i)}visitChain(t,i){this.visitAll(t.expressions,i)}visitConditional(t,i){this.visit(t.condition,i),this.visit(t.trueExp,i),this.visit(t.falseExp,i)}visitPipe(t,i){this.visit(t.exp,i),this.visitAll(t.args,i)}visitImplicitReceiver(t,i){}visitThisReceiver(t,i){}visitInterpolation(t,i){this.visitAll(t.expressions,i)}visitKeyedRead(t,i){this.visit(t.receiver,i),this.visit(t.key,i)}visitKeyedWrite(t,i){this.visit(t.receiver,i),this.visit(t.key,i),this.visit(t.value,i)}visitLiteralArray(t,i){this.visitAll(t.expressions,i)}visitLiteralMap(t,i){this.visitAll(t.values,i)}visitLiteralPrimitive(t,i){}visitPrefixNot(t,i){this.visit(t.expression,i)}visitNonNullAssert(t,i){this.visit(t.expression,i)}visitPropertyRead(t,i){this.visit(t.receiver,i)}visitPropertyWrite(t,i){this.visit(t.receiver,i),this.visit(t.value,i)}visitSafePropertyRead(t,i){this.visit(t.receiver,i)}visitSafeKeyedRead(t,i){this.visit(t.receiver,i),this.visit(t.key,i)}visitCall(t,i){this.visit(t.receiver,i),this.visitAll(t.args,i)}visitSafeCall(t,i){this.visit(t.receiver,i),this.visitAll(t.args,i)}visitAll(t,i){for(let r of t)this.visit(r,i)}},gA=class{visitImplicitReceiver(t,i){return t}visitThisReceiver(t,i){return t}visitInterpolation(t,i){return new En(t.span,t.sourceSpan,t.strings,this.visitAll(t.expressions))}visitLiteralPrimitive(t,i){return new ko(t.span,t.sourceSpan,t.value)}visitPropertyRead(t,i){return new to(t.span,t.sourceSpan,t.nameSpan,t.receiver.visit(this),t.name)}visitPropertyWrite(t,i){return new rm(t.span,t.sourceSpan,t.nameSpan,t.receiver.visit(this),t.name,t.value.visit(this))}visitSafePropertyRead(t,i){return new nm(t.span,t.sourceSpan,t.nameSpan,t.receiver.visit(this),t.name)}visitLiteralArray(t,i){return new Zh(t.span,t.sourceSpan,this.visitAll(t.expressions))}visitLiteralMap(t,i){return new am(t.span,t.sourceSpan,t.keys,this.visitAll(t.values))}visitUnary(t,i){switch(t.operator){case"+":return jc.createPlus(t.span,t.sourceSpan,t.expr.visit(this));case"-":return jc.createMinus(t.span,t.sourceSpan,t.expr.visit(this));default:throw new Error(`Unknown unary operator ${t.operator}`)}}visitBinary(t,i){return new ka(t.span,t.sourceSpan,t.operation,t.left.visit(this),t.right.visit(this))}visitPrefixNot(t,i){return new Kh(t.span,t.sourceSpan,t.expression.visit(this))}visitNonNullAssert(t,i){return new Qh(t.span,t.sourceSpan,t.expression.visit(this))}visitConditional(t,i){return new qh(t.span,t.sourceSpan,t.condition.visit(this),t.trueExp.visit(this),t.falseExp.visit(this))}visitPipe(t,i){return new Yh(t.span,t.sourceSpan,t.exp.visit(this),t.name,this.visitAll(t.args),t.nameSpan)}visitKeyedRead(t,i){return new Hc(t.span,t.sourceSpan,t.receiver.visit(this),t.key.visit(this))}visitKeyedWrite(t,i){return new om(t.span,t.sourceSpan,t.receiver.visit(this),t.key.visit(this),t.value.visit(this))}visitCall(t,i){return new Yl(t.span,t.sourceSpan,t.receiver.visit(this),this.visitAll(t.args),t.argumentSpan)}visitSafeCall(t,i){return new Jh(t.span,t.sourceSpan,t.receiver.visit(this),this.visitAll(t.args),t.argumentSpan)}visitAll(t){let i=[];for(let r=0;r<t.length;++r)i[r]=t[r].visit(this);return i}visitChain(t,i){return new Jd(t.span,t.sourceSpan,this.visitAll(t.expressions))}visitSafeKeyedRead(t,i){return new Xh(t.span,t.sourceSpan,t.receiver.visit(this),t.key.visit(this))}},vA=class{visitImplicitReceiver(t,i){return t}visitThisReceiver(t,i){return t}visitInterpolation(t,i){let r=this.visitAll(t.expressions);return r!==t.expressions?new En(t.span,t.sourceSpan,t.strings,r):t}visitLiteralPrimitive(t,i){return t}visitPropertyRead(t,i){let r=t.receiver.visit(this);return r!==t.receiver?new to(t.span,t.sourceSpan,t.nameSpan,r,t.name):t}visitPropertyWrite(t,i){let r=t.receiver.visit(this),n=t.value.visit(this);return r!==t.receiver||n!==t.value?new rm(t.span,t.sourceSpan,t.nameSpan,r,t.name,n):t}visitSafePropertyRead(t,i){let r=t.receiver.visit(this);return r!==t.receiver?new nm(t.span,t.sourceSpan,t.nameSpan,r,t.name):t}visitLiteralArray(t,i){let r=this.visitAll(t.expressions);return r!==t.expressions?new Zh(t.span,t.sourceSpan,r):t}visitLiteralMap(t,i){let r=this.visitAll(t.values);return r!==t.values?new am(t.span,t.sourceSpan,t.keys,r):t}visitUnary(t,i){let r=t.expr.visit(this);if(r!==t.expr)switch(t.operator){case"+":return jc.createPlus(t.span,t.sourceSpan,r);case"-":return jc.createMinus(t.span,t.sourceSpan,r);default:throw new Error(`Unknown unary operator ${t.operator}`)}return t}visitBinary(t,i){let r=t.left.visit(this),n=t.right.visit(this);return r!==t.left||n!==t.right?new ka(t.span,t.sourceSpan,t.operation,r,n):t}visitPrefixNot(t,i){let r=t.expression.visit(this);return r!==t.expression?new Kh(t.span,t.sourceSpan,r):t}visitNonNullAssert(t,i){let r=t.expression.visit(this);return r!==t.expression?new Qh(t.span,t.sourceSpan,r):t}visitConditional(t,i){let r=t.condition.visit(this),n=t.trueExp.visit(this),o=t.falseExp.visit(this);return r!==t.condition||n!==t.trueExp||o!==t.falseExp?new qh(t.span,t.sourceSpan,r,n,o):t}visitPipe(t,i){let r=t.exp.visit(this),n=this.visitAll(t.args);return r!==t.exp||n!==t.args?new Yh(t.span,t.sourceSpan,r,t.name,n,t.nameSpan):t}visitKeyedRead(t,i){let r=t.receiver.visit(this),n=t.key.visit(this);return r!==t.receiver||n!==t.key?new Hc(t.span,t.sourceSpan,r,n):t}visitKeyedWrite(t,i){let r=t.receiver.visit(this),n=t.key.visit(this),o=t.value.visit(this);return r!==t.receiver||n!==t.key||o!==t.value?new om(t.span,t.sourceSpan,r,n,o):t}visitAll(t){let i=[],r=!1;for(let n=0;n<t.length;++n){let o=t[n],a=o.visit(this);i[n]=a,r=r||a!==o}return r?i:t}visitChain(t,i){let r=this.visitAll(t.expressions);return r!==t.expressions?new Jd(t.span,t.sourceSpan,r):t}visitCall(t,i){let r=t.receiver.visit(this),n=this.visitAll(t.args);return r!==t.receiver||n!==t.args?new Yl(t.span,t.sourceSpan,r,n,t.argumentSpan):t}visitSafeCall(t,i){let r=t.receiver.visit(this),n=this.visitAll(t.args);return r!==t.receiver||n!==t.args?new Jh(t.span,t.sourceSpan,r,n,t.argumentSpan):t}visitSafeKeyedRead(t,i){let r=t.receiver.visit(this),n=t.key.visit(this);return r!==t.receiver||n!==t.key?new Xh(t.span,t.sourceSpan,r,n):t}},Fv=class{constructor(t,i,r,n,o,a){this.name=t,this.expression=i,this.type=r,this.sourceSpan=n,this.keySpan=o,this.valueSpan=a,this.isLiteral=this.type===Wd.LITERAL_ATTR,this.isAnimation=this.type===Wd.ANIMATION}},Wd=function(e){return e[e.DEFAULT=0]="DEFAULT",e[e.LITERAL_ATTR=1]="LITERAL_ATTR",e[e.ANIMATION=2]="ANIMATION",e[e.TWO_WAY=3]="TWO_WAY",e}(Wd||{}),Iw=class{constructor(t,i,r,n,o,a,s){this.name=t,this.targetOrPhase=i,this.type=r,this.handler=n,this.sourceSpan=o,this.handlerSpan=a,this.keySpan=s}},_A=class{constructor(t,i,r,n,o){this.name=t,this.value=i,this.sourceSpan=r,this.keySpan=n,this.valueSpan=o}},Mw=class{constructor(t,i,r,n,o,a,s,c){this.name=t,this.type=i,this.securityContext=r,this.value=n,this.unit=o,this.sourceSpan=a,this.keySpan=s,this.valueSpan=c}},eu=class{static{this.event=ft("$event")}};function $ne(e,t,i,r,n,o,a){e??=new a0(a);let s=new ep(e,t,r,!1,n,o),c=[];u1(j6(i).visit(s,ir.Statement),c),$6(s.temporaryCount,r,c),s.usesImplicitReceiver&&e.notifyImplicitReceiverUse();let l=c.length-1;if(l>=0){let d=c[l];d instanceof oo&&(c[l]=new Rn(d.expr))}return c}function Wne(e,t,i,r,n,o,a){e??=new a0(a);let s=new ep(e,t,r,!1,n,o),c=j6(i).visit(s,ir.Statement);if(!(c instanceof oo))throw new Error("Illegal state: unsupported expression in two-way action binding.");c=qne(c.expr).toStmt();let l=[];return u1(c,l),$6(s.temporaryCount,r,l),l.push(new Rn(eu.event)),o?.add(eu.event.name),s.usesImplicitReceiver&&e.notifyImplicitReceiverUse(),l}function Ox(e){return new Lc(T.twoWayBindingSet).callFn([e,eu.event]).or(e.set(eu.event))}function Rx(e){return e instanceof ca||e instanceof ql}function qne(e){if(Rx(e))return Ox(e);if(e instanceof Si&&Rx(e.rhs))return new Si(e.operator,e.lhs,Ox(e.rhs));if(e instanceof ns&&Rx(e.falseCase))return new ns(e.condition,e.trueCase,Ox(e.falseCase));if(e instanceof Bc){let t=e.condition;for(;;)if(t instanceof Bc)t=t.condition;else{if(Rx(t))return Ox(t);break}}throw new Error("Illegal state: unsupported expression in two-way action binding.")}function z6(e,t){return Zne(e,t)}var bA=class{constructor(t,i){this.stmts=t,this.currValExpr=i}};function U6(e,t,i,r){e||(e=new a0);let n=new ep(e,t,r,!1),o=i.visit(n,ir.Expression),a=H6(n,r);return n.usesImplicitReceiver&&e.notifyImplicitReceiverUse(),new bA(a,o)}function Xne(e,t,i,r){let n=z6({createLiteralArrayConverter:()=>s=>ti(s),createLiteralMapConverter:s=>c=>ao(s.map((l,d)=>({key:l.key,value:c[d],quoted:l.quoted}))),createPipeConverter:()=>{throw new Error("Illegal State: Pipes are not allowed in this context")}},e),o=new ep(t,i,r,!1),a=[];return u1(n.visit(o,ir.Statement),a),a}function Yne(e,t,i,r){let n=new ep(e,t,r,!0),o=n.visitInterpolation(i,ir.Expression);n.usesImplicitReceiver&&e.notifyImplicitReceiverUse();let a=H6(n,r),s=o.args;return{stmts:a,args:s}}function H6(e,t){let i=[];for(let r=0;r<e.temporaryCount;r++)i.push(G6(t,r));return i}function Zne(e,t){let i=new xA(e);return t.visit(i)}function j6(e){return z6({createLiteralArrayConverter:()=>i=>ti(i),createLiteralMapConverter:i=>r=>{let n=i.map((o,a)=>({key:o.key,value:r[a],quoted:o.quoted}));return ao(n)},createPipeConverter:i=>{throw new Error(`Illegal State: Actions are not allowed to contain pipes. Pipe: ${i}`)}},e)}function yA(e,t){return`tmp_${e}_${t}`}function G6(e,t){return new Ro(yA(e,t))}function $6(e,t,i){for(let r=e-1;r>=0;r--)i.unshift(G6(t,r))}var ir=function(e){return e[e.Statement=0]="Statement",e[e.Expression=1]="Expression",e}(ir||{});function Kne(e,t){if(e!==ir.Statement)throw new Error(`Expected a statement, but saw ${t}`)}function P8(e,t){if(e!==ir.Expression)throw new Error(`Expected an expression, but saw ${t}`)}function ra(e,t){return e===ir.Statement?t.toStmt():t}var xA=class extends gA{constructor(t){super(),this._converterFactory=t}visitPipe(t,i){let r=[t.exp,...t.args].map(n=>n.visit(this,i));return new Zd(t.span,t.sourceSpan,r,this._converterFactory.createPipeConverter(t.name,r.length))}visitLiteralArray(t,i){let r=t.expressions.map(n=>n.visit(this,i));return new Zd(t.span,t.sourceSpan,r,this._converterFactory.createLiteralArrayConverter(t.expressions.length))}visitLiteralMap(t,i){let r=t.values.map(n=>n.visit(this,i));return new Zd(t.span,t.sourceSpan,r,this._converterFactory.createLiteralMapConverter(t.keys))}},ep=class{constructor(t,i,r,n,o,a){this._localResolver=t,this._implicitReceiver=i,this.bindingId=r,this.supportsInterpolation=n,this.baseSourceSpan=o,this.implicitReceiverAccesses=a,this._nodeMap=new Map,this._resultMap=new Map,this._currentTemporary=0,this.temporaryCount=0,this.usesImplicitReceiver=!1}visitUnary(t,i){let r;switch(t.operator){case"+":r=Fh.Plus;break;case"-":r=Fh.Minus;break;default:throw new Error(`Unsupported operator ${t.operator}`)}return ra(i,new Vh(r,this._visit(t.expr,ir.Expression),void 0,this.convertSourceSpan(t.span)))}visitBinary(t,i){let r;switch(t.operation){case"+":r=et.Plus;break;case"-":r=et.Minus;break;case"*":r=et.Multiply;break;case"/":r=et.Divide;break;case"%":r=et.Modulo;break;case"&&":r=et.And;break;case"||":r=et.Or;break;case"==":r=et.Equals;break;case"!=":r=et.NotEquals;break;case"===":r=et.Identical;break;case"!==":r=et.NotIdentical;break;case"<":r=et.Lower;break;case">":r=et.Bigger;break;case"<=":r=et.LowerEquals;break;case">=":r=et.BiggerEquals;break;case"??":return this.convertNullishCoalesce(t,i);default:throw new Error(`Unsupported operation ${t.operation}`)}return ra(i,new Si(r,this._visit(t.left,ir.Expression),this._visit(t.right,ir.Expression),void 0,this.convertSourceSpan(t.span)))}visitChain(t,i){return Kne(i,t),this.visitAll(t.expressions,i)}visitConditional(t,i){let r=this._visit(t.condition,ir.Expression);return ra(i,r.conditional(this._visit(t.trueExp,ir.Expression),this._visit(t.falseExp,ir.Expression),this.convertSourceSpan(t.span)))}visitPipe(t,i){throw new Error(`Illegal state: Pipes should have been converted into functions. Pipe: ${t.name}`)}visitImplicitReceiver(t,i){return P8(i,t),this.usesImplicitReceiver=!0,this._implicitReceiver}visitThisReceiver(t,i){return this.visitImplicitReceiver(t,i)}visitInterpolation(t,i){if(!this.supportsInterpolation)throw new Error("Unexpected interpolation");P8(i,t);let r=[];for(let o=0;o<t.strings.length-1;o++)r.push(U(t.strings[o])),r.push(this._visit(t.expressions[o],ir.Expression));r.push(U(t.strings[t.strings.length-1]));let n=t.strings;return n.length===2&&n[0]===""&&n[1]===""?r=[r[1]]:t.expressions.length>=9&&(r=[ti(r)]),new wA(r)}visitKeyedRead(t,i){let r=this.leftMostSafeNode(t);return r?this.convertSafeAccess(t,r,i):ra(i,this._visit(t.receiver,ir.Expression).key(this._visit(t.key,ir.Expression)))}visitKeyedWrite(t,i){let r=this._visit(t.receiver,ir.Expression),n=this._visit(t.key,ir.Expression),o=this._visit(t.value,ir.Expression);return r===this._implicitReceiver&&this._localResolver.maybeRestoreView(),ra(i,r.key(n).set(o))}visitLiteralArray(t,i){throw new Error("Illegal State: literal arrays should have been converted into functions")}visitLiteralMap(t,i){throw new Error("Illegal State: literal maps should have been converted into functions")}visitLiteralPrimitive(t,i){let r=t.value===null||t.value===void 0||t.value===!0||t.value===!0?aa:void 0;return ra(i,U(t.value,r,this.convertSourceSpan(t.span)))}_getLocal(t,i){return this._localResolver.globals?.has(t)&&i instanceof Yd?null:this._localResolver.getLocal(t)}visitPrefixNot(t,i){return ra(i,h6(this._visit(t.expression,ir.Expression)))}visitNonNullAssert(t,i){return ra(i,this._visit(t.expression,ir.Expression))}visitPropertyRead(t,i){let r=this.leftMostSafeNode(t);if(r)return this.convertSafeAccess(t,r,i);{let n=null,o=this.usesImplicitReceiver,a=this._visit(t.receiver,ir.Expression);return a===this._implicitReceiver&&(n=this._getLocal(t.name,t.receiver),n&&(this.usesImplicitReceiver=o,this.addImplicitReceiverAccess(t.name))),n==null&&(n=a.prop(t.name,this.convertSourceSpan(t.span))),ra(i,n)}}visitPropertyWrite(t,i){let r=this._visit(t.receiver,ir.Expression),n=this.usesImplicitReceiver,o=null;if(r===this._implicitReceiver){let a=this._getLocal(t.name,t.receiver);if(a)if(a instanceof ca)o=a,this.usesImplicitReceiver=n,this.addImplicitReceiverAccess(t.name);else{let s=t.name,c=t.value instanceof to?t.value.name:void 0;throw new Error(`Cannot assign value "${c}" to template variable "${s}". Template variables are read-only.`)}}return o===null&&(o=r.prop(t.name,this.convertSourceSpan(t.span))),ra(i,o.set(this._visit(t.value,ir.Expression)))}visitSafePropertyRead(t,i){return this.convertSafeAccess(t,this.leftMostSafeNode(t),i)}visitSafeKeyedRead(t,i){return this.convertSafeAccess(t,this.leftMostSafeNode(t),i)}visitAll(t,i){return t.map(r=>this._visit(r,i))}visitCall(t,i){let r=this.leftMostSafeNode(t);if(r)return this.convertSafeAccess(t,r,i);let n=this.visitAll(t.args,ir.Expression);if(t instanceof Zd)return ra(i,t.converter(n));let o=t.receiver;if(o instanceof to&&o.receiver instanceof Po&&!(o.receiver instanceof Yd)&&o.name==="$any"){if(n.length!==1)throw new Error(`Invalid call to $any, expected 1 argument but received ${n.length||"none"}`);return ra(i,n[0])}let a=this._visit(o,ir.Expression).callFn(n,this.convertSourceSpan(t.span));return ra(i,a)}visitSafeCall(t,i){return this.convertSafeAccess(t,this.leftMostSafeNode(t),i)}_visit(t,i){let r=this._resultMap.get(t);return r||(this._nodeMap.get(t)||t).visit(this,i)}convertSafeAccess(t,i,r){let n=this._visit(i.receiver,ir.Expression),o;this.needsTemporaryInSafeAccess(i.receiver)&&(o=this.allocateTemporary(),n=o.set(n),this._resultMap.set(i.receiver,o));let a=n.isBlank();i instanceof Jh?this._nodeMap.set(i,new Yl(i.span,i.sourceSpan,i.receiver,i.args,i.argumentSpan)):i instanceof Xh?this._nodeMap.set(i,new Hc(i.span,i.sourceSpan,i.receiver,i.key)):this._nodeMap.set(i,new to(i.span,i.sourceSpan,i.nameSpan,i.receiver,i.name));let s=this._visit(t,ir.Expression);return this._nodeMap.delete(i),o&&this.releaseTemporary(o),ra(r,a.conditional(zh,s))}convertNullishCoalesce(t,i){let r=this._visit(t.left,ir.Expression),n=this._visit(t.right,ir.Expression),o=this.allocateTemporary();return this.releaseTemporary(o),ra(i,o.set(r).notIdentical(zh).and(o.notIdentical(U(void 0))).conditional(o,n))}leftMostSafeNode(t){let i=(r,n)=>(this._nodeMap.get(n)||n).visit(r);return t.visit({visitUnary(r){return null},visitBinary(r){return null},visitChain(r){return null},visitConditional(r){return null},visitCall(r){return i(this,r.receiver)},visitSafeCall(r){return i(this,r.receiver)||r},visitImplicitReceiver(r){return null},visitThisReceiver(r){return null},visitInterpolation(r){return null},visitKeyedRead(r){return i(this,r.receiver)},visitKeyedWrite(r){return null},visitLiteralArray(r){return null},visitLiteralMap(r){return null},visitLiteralPrimitive(r){return null},visitPipe(r){return null},visitPrefixNot(r){return null},visitNonNullAssert(r){return i(this,r.expression)},visitPropertyRead(r){return i(this,r.receiver)},visitPropertyWrite(r){return null},visitSafePropertyRead(r){return i(this,r.receiver)||r},visitSafeKeyedRead(r){return i(this,r.receiver)||r}})}needsTemporaryInSafeAccess(t){let i=(n,o)=>o&&(this._nodeMap.get(o)||o).visit(n),r=(n,o)=>o.some(a=>i(n,a));return t.visit({visitUnary(n){return i(this,n.expr)},visitBinary(n){return i(this,n.left)||i(this,n.right)},visitChain(n){return!1},visitConditional(n){return i(this,n.condition)||i(this,n.trueExp)||i(this,n.falseExp)},visitCall(n){return!0},visitSafeCall(n){return!0},visitImplicitReceiver(n){return!1},visitThisReceiver(n){return!1},visitInterpolation(n){return r(this,n.expressions)},visitKeyedRead(n){return!1},visitKeyedWrite(n){return!1},visitLiteralArray(n){return!0},visitLiteralMap(n){return!0},visitLiteralPrimitive(n){return!1},visitPipe(n){return!0},visitPrefixNot(n){return i(this,n.expression)},visitNonNullAssert(n){return i(this,n.expression)},visitPropertyRead(n){return!1},visitPropertyWrite(n){return!1},visitSafePropertyRead(n){return!1},visitSafeKeyedRead(n){return!1}})}allocateTemporary(){let t=this._currentTemporary++;return this.temporaryCount=Math.max(this._currentTemporary,this.temporaryCount),new rs(yA(this.bindingId,t))}releaseTemporary(t){if(this._currentTemporary--,t.name!=yA(this.bindingId,this._currentTemporary))throw new Error(`Temporary ${t.name} released out of order`)}convertSourceSpan(t){if(this.baseSourceSpan){let i=this.baseSourceSpan.start.moveBy(t.start),r=this.baseSourceSpan.start.moveBy(t.end),n=this.baseSourceSpan.fullStart.moveBy(t.start);return new pi(i,r,n)}else return null}addImplicitReceiverAccess(t){this.implicitReceiverAccesses&&this.implicitReceiverAccesses.add(t)}};function u1(e,t){Array.isArray(e)?e.forEach(i=>u1(i,t)):t.push(e)}function Fx(){throw new Error("Unsupported operation")}var wA=class extends rr{constructor(t){super(null,null),this.args=t,this.isConstant=Fx,this.isEquivalent=Fx,this.visitExpression=Fx,this.clone=Fx}},a0=class{constructor(t){this.globals=t}notifyImplicitReceiverUse(){}maybeRestoreView(){}getLocal(t){return t===eu.event.name?eu.event:null}},Zd=class extends Yl{constructor(t,i,r,n){super(t,i,new Mo(t,i),r,null),this.converter=n}},Wx;function N8(){return Wx||(Wx={},Lx(Oi.HTML,["iframe|srcdoc","*|innerHTML","*|outerHTML"]),Lx(Oi.STYLE,["*|style"]),Lx(Oi.URL,["*|formAction","area|href","area|ping","audio|src","a|href","a|ping","blockquote|cite","body|background","del|cite","form|action","img|src","input|src","ins|cite","q|cite","source|src","track|src","video|poster","video|src"]),Lx(Oi.RESOURCE_URL,["applet|code","applet|codebase","base|href","embed|src","frame|src","head|profile","html|manifest","iframe|src","link|href","media|src","object|codebase","object|data","script|src"])),Wx}function Lx(e,t){for(let i of t)Wx[i.toLowerCase()]=e}var Qne=new Set(["sandbox","allow","allowfullscreen","referrerpolicy","csp","fetchpriority"]);function VD(e){return Qne.has(e.toLowerCase())}var Jne=new Set(["inherit","initial","revert","unset","alternate","alternate-reverse","normal","reverse","backwards","both","forwards","none","paused","running","ease","ease-in","ease-in-out","ease-out","linear","step-start","step-end","end","jump-both","jump-end","jump-none","jump-start","start"]),eoe=["@media","@supports","@document","@layer","@container","@scope","@starting-style"],EA=class{constructor(){this._animationDeclarationKeyframesRe=/(^|\s+)(?:(?:(['"])((?:\\\\|\\\2|(?!\2).)+)\2)|(-?[A-Za-z][\w\-]*))(?=[,\s]|$)/g}shimCssText(t,i,r=""){let n=[];t=t.replace(uoe,s=>{if(s.match(hoe))n.push(s);else{let c=s.match(doe);n.push((c?.join("")??"")+`
`)}return HD}),t=this._insertDirectives(t);let o=this._scopeCssText(t,i,r),a=0;return o.replace(poe,()=>n[a++])}_insertDirectives(t){return t=this._insertPolyfillDirectivesInCssText(t),this._insertPolyfillRulesInCssText(t)}_scopeKeyframesRelatedCss(t,i){let r=new Set,n=Bx(t,o=>this._scopeLocalKeyframeDeclarations(o,i,r));return Bx(n,o=>this._scopeAnimationRule(o,i,r))}_scopeLocalKeyframeDeclarations(t,i,r){return ve(L({},t),{selector:t.selector.replace(/(^@(?:-webkit-)?keyframes(?:\s+))(['"]?)(.+)\2(\s*)$/,(n,o,a,s,c)=>(r.add(L8(s,a)),`${o}${a}${i}_${s}${a}${c}`))})}_scopeAnimationKeyframe(t,i,r){return t.replace(/^(\s*)(['"]?)(.+?)\2(\s*)$/,(n,o,a,s,c)=>(s=`${r.has(L8(s,a))?i+"_":""}${s}`,`${o}${a}${s}${a}${c}`))}_scopeAnimationRule(t,i,r){let n=t.content.replace(/((?:^|\s+|;)(?:-webkit-)?animation(?:\s*):(?:\s*))([^;]+)/g,(o,a,s)=>a+s.replace(this._animationDeclarationKeyframesRe,(c,l,d="",u,h)=>u?`${l}${this._scopeAnimationKeyframe(`${d}${u}${d}`,i,r)}`:Jne.has(h)?c:`${l}${this._scopeAnimationKeyframe(h,i,r)}`));return n=n.replace(/((?:^|\s+|;)(?:-webkit-)?animation-name(?:\s*):(?:\s*))([^;]+)/g,(o,a,s)=>`${a}${s.split(",").map(c=>this._scopeAnimationKeyframe(c,i,r)).join(",")}`),ve(L({},t),{content:n})}_insertPolyfillDirectivesInCssText(t){return t.replace(toe,function(...i){return i[2]+"{"})}_insertPolyfillRulesInCssText(t){return t.replace(ioe,(...i)=>{let r=i[0].replace(i[1],"").replace(i[2],"");return i[4]+r})}_scopeCssText(t,i,r){let n=this._extractUnscopedRulesFromCssText(t);return t=this._insertPolyfillHostInCssText(t),t=this._convertColonHost(t),t=this._convertColonHostContext(t),t=this._convertShadowDOMSelectors(t),i&&(t=this._scopeKeyframesRelatedCss(t,i),t=this._scopeSelectors(t,i,r)),t=t+`
`+n,t.trim()}_extractUnscopedRulesFromCssText(t){let i="",r;for(O8.lastIndex=0;(r=O8.exec(t))!==null;){let n=r[0].replace(r[2],"").replace(r[1],r[4]);i+=n+`

`}return i}_convertColonHost(t){return t.replace(roe,(i,r,n)=>{if(r){let o=[],a=r.split(",").map(s=>s.trim());for(let s of a){if(!s)break;let c=Ch+s.replace(kw,"")+n;o.push(c)}return o.join(",")}else return Ch+n})}_convertColonHostContext(t){return t.replace(noe,i=>{let r=[[]],n;for(;n=ooe.exec(i);){let o=(n[1]??"").trim().split(",").map(s=>s.trim()).filter(s=>s!==""),a=r.length;Coe(r,o.length);for(let s=0;s<o.length;s++)for(let c=0;c<a;c++)r[c+s*a].push(o[s]);i=n[2]}return r.map(o=>Eoe(o,i)).join(", ")})}_convertShadowDOMSelectors(t){return aoe.reduce((i,r)=>i.replace(r," "),t)}_scopeSelectors(t,i,r){return Bx(t,n=>{let o=n.selector,a=n.content;return n.selector[0]!=="@"?o=this._scopeSelector(n.selector,i,r):eoe.some(s=>n.selector.startsWith(s))?a=this._scopeSelectors(n.content,i,r):(n.selector.startsWith("@font-face")||n.selector.startsWith("@page"))&&(a=this._stripScopingSelectors(n.content)),new s0(o,a)})}_stripScopingSelectors(t){return Bx(t,i=>{let r=i.selector.replace(F8," ").replace(R8," ");return new s0(r,i.content)})}_scopeSelector(t,i,r){return t.split(",").map(n=>n.trim().split(F8)).map(n=>{let[o,...a]=n;return[(c=>this._selectorNeedsScoping(c,i)?this._applySelectorScope(c,i,r):c)(o),...a].join(" ")}).join(", ")}_selectorNeedsScoping(t,i){return!this._makeScopeMatcher(i).test(t)}_makeScopeMatcher(t){let i=/\[/g,r=/\]/g;return t=t.replace(i,"\\[").replace(r,"\\]"),new RegExp("^("+t+")"+soe,"m")}_applySimpleSelectorScope(t,i,r){if(Hf.lastIndex=0,Hf.test(t)){let n=`[${r}]`;return t.replace(R8,(o,a)=>a.replace(/([^:]*)(:*)(.*)/,(s,c,l,d)=>c+n+l+d)).replace(Hf,n+" ")}return i+" "+t}_applySelectorScope(t,i,r){let n=/\[is=([^\]]*)\]/g;i=i.replace(n,(f,...g)=>g[0]);let o="["+i+"]",a=f=>{let g=f.trim();if(!g)return"";if(f.indexOf(Ch)>-1)g=this._applySimpleSelectorScope(f,i,r);else{let v=f.replace(Hf,"");if(v.length>0){let _=v.match(/([^:]*)(:*)(.*)/);_&&(g=_[1]+o+_[2]+_[3])}}return g},s=new CA(t);t=s.content();let c="",l=0,d,u=/( |>|\+|~(?!=))\s*/g,p=!(t.indexOf(Ch)>-1);for(;(d=u.exec(t))!==null;){let f=d[1],g=t.slice(l,d.index).trim();if(g.match(/__esc-ph-(\d+)__/)&&t[d.index+1]?.match(/[a-fA-F\d]/))continue;p=p||g.indexOf(Ch)>-1;let v=p?a(g):g;c+=`${v} ${f} `,l=u.lastIndex}let m=t.substring(l);return p=p||m.indexOf(Ch)>-1,c+=p?a(m):m,s.restore(c)}_insertPolyfillHostInCssText(t){return t.replace(coe,zD).replace(loe,kw)}},CA=class{constructor(t){this.placeholders=[],this.index=0,t=this._escapeRegexMatches(t,/(\[[^\]]*\])/g),t=t.replace(/(\\.)/g,(i,r)=>{let n=`__esc-ph-${this.index}__`;return this.placeholders.push(r),this.index++,n}),this._content=t.replace(/(:nth-[-\w]+)(\([^)]+\))/g,(i,r,n)=>{let o=`__ph-${this.index}__`;return this.placeholders.push(n),this.index++,r+o})}restore(t){return t.replace(/__(?:ph|esc-ph)-(\d+)__/g,(i,r)=>this.placeholders[+r])}content(){return this._content}_escapeRegexMatches(t,i){return t.replace(i,(r,n)=>{let o=`__ph-${this.index}__`;return this.placeholders.push(n),this.index++,o})}},toe=/polyfill-next-selector[^}]*content:[\s]*?(['"])(.*?)\1[;\s]*}([^{]*?){/gim,ioe=/(polyfill-rule)[^}]*(content:[\s]*(['"])(.*?)\3)[;\s]*[^}]*}/gim,O8=/(polyfill-unscoped-rule)[^}]*(content:[\s]*(['"])(.*?)\3)[;\s]*[^}]*}/gim,kw="-shadowcsshost",zD="-shadowcsscontext",UD="(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))?([^,{]*)",roe=new RegExp(kw+UD,"gim"),noe=new RegExp(zD+UD,"gim"),ooe=new RegExp(zD+UD,"im"),Ch=kw+"-no-combinator",R8=/-shadowcsshost-no-combinator([^\s]*)/,aoe=[/::shadow/g,/::content/g,/\/shadow-deep\//g,/\/shadow\//g],F8=/(?:>>>)|(?:\/deep\/)|(?:::ng-deep)/g,soe="([>\\s~+[.,{:][\\s\\S]*)?$",Hf=/-shadowcsshost/gim,loe=/:host/gim,coe=/:host-context/gim,doe=/\r?\n/g,uoe=/\/\*[\s\S]*?\*\//g,hoe=/\/\*\s*#\s*source(Mapping)?URL=/g,HD="%COMMENT%",poe=new RegExp(HD,"g"),bT="%BLOCK%",foe=new RegExp(`(\\s*(?:${HD}\\s*)*)([^;\\{\\}]+?)(\\s*)((?:{%BLOCK%}?\\s*;?)|(?:\\s*;))`,"g"),moe=new Map([["{","}"]]),W6="%COMMA_IN_PLACEHOLDER%",q6="%SEMI_IN_PLACEHOLDER%",X6="%COLON_IN_PLACEHOLDER%",goe=new RegExp(W6,"g"),voe=new RegExp(q6,"g"),_oe=new RegExp(X6,"g"),s0=class{constructor(t,i){this.selector=t,this.content=i}};function Bx(e,t){let i=xoe(e),r=boe(i,moe,bT),n=0,o=r.escapedString.replace(foe,(...a)=>{let s=a[2],c="",l=a[4],d="";l&&l.startsWith("{"+bT)&&(c=r.blocks[n++],l=l.substring(bT.length+1),d="{");let u=t(new s0(s,c));return`${a[1]}${u.selector}${a[3]}${d}${u.content}${l}`});return woe(o)}var SA=class{constructor(t,i){this.escapedString=t,this.blocks=i}};function boe(e,t,i){let r=[],n=[],o=0,a=0,s=-1,c,l;for(let d=0;d<e.length;d++){let u=e[d];u==="\\"?d++:u===l?(o--,o===0&&(n.push(e.substring(s,d)),r.push(i),a=d,s=-1,c=l=void 0)):u===c?o++:o===0&&t.has(u)&&(c=u,l=t.get(u),o=1,s=d+1,r.push(e.substring(a,s)))}return s!==-1?(n.push(e.substring(s)),r.push(i)):r.push(e.substring(a)),new SA(r.join(""),n)}var yoe={";":q6,",":W6,":":X6};function xoe(e){let t=e,i=null;for(let r=0;r<t.length;r++){let n=t[r];if(n==="\\")r++;else if(i!==null)if(n===i)i=null;else{let o=yoe[n];o&&(t=`${t.substr(0,r)}${o}${t.substr(r+1)}`,r+=o.length-1)}else(n==="'"||n==='"')&&(i=n)}return t}function woe(e){let t=e.replace(goe,",");return t=t.replace(voe,";"),t=t.replace(_oe,":"),t}function L8(e,t){return t?e.replace(/((?:^|[^\\])(?:\\\\)*)\\(?=['"])/g,"$1"):e}function Eoe(e,t){let i=Ch;Hf.lastIndex=0;let r=Hf.test(t);if(e.length===0)return i+t;let n=[e.pop()||""];for(;e.length>0;){let o=n.length,a=e.pop();for(let s=0;s<o;s++){let c=n[s];n[o*2+s]=c+" "+a,n[o+s]=a+" "+c,n[s]=a+c}}return n.map(o=>r?`${o}${t}`:`${o}${i}${t}, ${o} ${i}${t}`).join(",")}function Coe(e,t){let i=e.length;for(let r=1;r<t;r++)for(let n=0;n<i;n++)e[n+r*i]=e[n].slice(0)}var k=function(e){return e[e.ListEnd=0]="ListEnd",e[e.Statement=1]="Statement",e[e.Variable=2]="Variable",e[e.ElementStart=3]="ElementStart",e[e.Element=4]="Element",e[e.Template=5]="Template",e[e.ElementEnd=6]="ElementEnd",e[e.ContainerStart=7]="ContainerStart",e[e.Container=8]="Container",e[e.ContainerEnd=9]="ContainerEnd",e[e.DisableBindings=10]="DisableBindings",e[e.Conditional=11]="Conditional",e[e.EnableBindings=12]="EnableBindings",e[e.Text=13]="Text",e[e.Listener=14]="Listener",e[e.InterpolateText=15]="InterpolateText",e[e.Binding=16]="Binding",e[e.Property=17]="Property",e[e.StyleProp=18]="StyleProp",e[e.ClassProp=19]="ClassProp",e[e.StyleMap=20]="StyleMap",e[e.ClassMap=21]="ClassMap",e[e.Advance=22]="Advance",e[e.Pipe=23]="Pipe",e[e.Attribute=24]="Attribute",e[e.ExtractedAttribute=25]="ExtractedAttribute",e[e.Defer=26]="Defer",e[e.DeferOn=27]="DeferOn",e[e.DeferWhen=28]="DeferWhen",e[e.I18nMessage=29]="I18nMessage",e[e.HostProperty=30]="HostProperty",e[e.Namespace=31]="Namespace",e[e.ProjectionDef=32]="ProjectionDef",e[e.Projection=33]="Projection",e[e.RepeaterCreate=34]="RepeaterCreate",e[e.Repeater=35]="Repeater",e[e.TwoWayProperty=36]="TwoWayProperty",e[e.TwoWayListener=37]="TwoWayListener",e[e.I18nStart=38]="I18nStart",e[e.I18n=39]="I18n",e[e.I18nEnd=40]="I18nEnd",e[e.I18nExpression=41]="I18nExpression",e[e.I18nApply=42]="I18nApply",e[e.IcuStart=43]="IcuStart",e[e.IcuEnd=44]="IcuEnd",e[e.IcuPlaceholder=45]="IcuPlaceholder",e[e.I18nContext=46]="I18nContext",e[e.I18nAttributes=47]="I18nAttributes",e}(k||{}),Nt=function(e){return e[e.LexicalRead=0]="LexicalRead",e[e.Context=1]="Context",e[e.TrackContext=2]="TrackContext",e[e.ReadVariable=3]="ReadVariable",e[e.NextContext=4]="NextContext",e[e.Reference=5]="Reference",e[e.GetCurrentView=6]="GetCurrentView",e[e.RestoreView=7]="RestoreView",e[e.ResetView=8]="ResetView",e[e.PureFunctionExpr=9]="PureFunctionExpr",e[e.PureFunctionParameterExpr=10]="PureFunctionParameterExpr",e[e.PipeBinding=11]="PipeBinding",e[e.PipeBindingVariadic=12]="PipeBindingVariadic",e[e.SafePropertyRead=13]="SafePropertyRead",e[e.SafeKeyedRead=14]="SafeKeyedRead",e[e.SafeInvokeFunction=15]="SafeInvokeFunction",e[e.SafeTernaryExpr=16]="SafeTernaryExpr",e[e.EmptyExpr=17]="EmptyExpr",e[e.AssignTemporaryExpr=18]="AssignTemporaryExpr",e[e.ReadTemporaryExpr=19]="ReadTemporaryExpr",e[e.SlotLiteralExpr=20]="SlotLiteralExpr",e[e.ConditionalCase=21]="ConditionalCase",e[e.ConstCollected=22]="ConstCollected",e[e.TwoWayBindingSet=23]="TwoWayBindingSet",e}(Nt||{}),Hl=function(e){return e[e.None=0]="None",e[e.AlwaysInline=1]="AlwaysInline",e}(Hl||{}),io=function(e){return e[e.Context=0]="Context",e[e.Identifier=1]="Identifier",e[e.SavedView=2]="SavedView",e[e.Alias=3]="Alias",e}(io||{}),os=function(e){return e[e.Normal=0]="Normal",e[e.TemplateDefinitionBuilder=1]="TemplateDefinitionBuilder",e}(os||{}),Et=function(e){return e[e.Attribute=0]="Attribute",e[e.ClassName=1]="ClassName",e[e.StyleProperty=2]="StyleProperty",e[e.Property=3]="Property",e[e.Template=4]="Template",e[e.I18n=5]="I18n",e[e.Animation=6]="Animation",e[e.TwoWayProperty=7]="TwoWayProperty",e}(Et||{}),l0=function(e){return e[e.Creation=0]="Creation",e[e.Postproccessing=1]="Postproccessing",e}(l0||{}),gm=function(e){return e[e.I18nText=0]="I18nText",e[e.I18nAttribute=1]="I18nAttribute",e}(gm||{}),Cr=function(e){return e[e.None=0]="None",e[e.ElementTag=1]="ElementTag",e[e.TemplateTag=2]="TemplateTag",e[e.OpenTag=4]="OpenTag",e[e.CloseTag=8]="CloseTag",e[e.ExpressionIndex=16]="ExpressionIndex",e}(Cr||{}),No=function(e){return e[e.HTML=0]="HTML",e[e.SVG=1]="SVG",e[e.Math=2]="Math",e}(No||{}),Vr=function(e){return e[e.Idle=0]="Idle",e[e.Immediate=1]="Immediate",e[e.Timer=2]="Timer",e[e.Hover=3]="Hover",e[e.Interaction=4]="Interaction",e[e.Viewport=5]="Viewport",e}(Vr||{}),Mh=function(e){return e[e.RootI18n=0]="RootI18n",e[e.Icu=1]="Icu",e[e.Attr=2]="Attr",e}(Mh||{}),ts=function(e){return e[e.NgTemplate=0]="NgTemplate",e[e.Structural=1]="Structural",e[e.Block=2]="Block",e}(ts||{}),Y6=Symbol("ConsumesSlot"),Z6=Symbol("DependsOnSlotContext"),A0=Symbol("ConsumesVars"),h1=Symbol("UsesVarOffset"),Yc={[Y6]:!0,numSlotsUsed:1},Gs={[Z6]:!0},ss={[A0]:!0};function vm(e){return e[Y6]===!0}function jD(e){return e[Z6]===!0}function yT(e){return e[A0]===!0}function B8(e){return e[h1]===!0}function Zl(e){return L({kind:k.Statement,statement:e},fi)}function jf(e,t,i,r){return L({kind:k.Variable,xref:e,variable:t,initializer:i,flags:r},fi)}var fi={debugListId:null,prev:null,next:null};function Soe(e,t,i){return L(L(L({kind:k.InterpolateText,target:e,interpolation:t,sourceSpan:i},Gs),ss),fi)}var Cn=class{constructor(t,i,r){if(this.strings=t,this.expressions=i,this.i18nPlaceholders=r,r.length!==0&&r.length!==i.length)throw new Error(`Expected ${i.length} placeholders to match interpolation expression count, but got ${r.length}`)}};function tp(e,t,i,r,n,o,a,s,c,l,d){return L({kind:k.Binding,bindingKind:t,target:e,name:i,expression:r,unit:n,securityContext:o,isTextAttribute:a,isStructuralTemplateAttribute:s,templateKind:c,i18nContext:null,i18nMessage:l,sourceSpan:d},fi)}function Toe(e,t,i,r,n,o,a,s,c,l){return L(L(L({kind:k.Property,target:e,name:t,expression:i,isAnimationTrigger:r,securityContext:n,sanitizer:null,isStructuralTemplateAttribute:o,templateKind:a,i18nContext:s,i18nMessage:c,sourceSpan:l},Gs),ss),fi)}function Aoe(e,t,i,r,n,o,a,s,c){return L(L(L({kind:k.TwoWayProperty,target:e,name:t,expression:i,securityContext:r,sanitizer:null,isStructuralTemplateAttribute:n,templateKind:o,i18nContext:a,i18nMessage:s,sourceSpan:c},Gs),ss),fi)}function Doe(e,t,i,r,n){return L(L(L({kind:k.StyleProp,target:e,name:t,expression:i,unit:r,sourceSpan:n},Gs),ss),fi)}function Ioe(e,t,i,r){return L(L(L({kind:k.ClassProp,target:e,name:t,expression:i,sourceSpan:r},Gs),ss),fi)}function Moe(e,t,i){return L(L(L({kind:k.StyleMap,target:e,expression:t,sourceSpan:i},Gs),ss),fi)}function koe(e,t,i){return L(L(L({kind:k.ClassMap,target:e,expression:t,sourceSpan:i},Gs),ss),fi)}function Poe(e,t,i,r,n,o,a,s,c,l){return L(L(L({kind:k.Attribute,target:e,namespace:t,name:i,expression:r,securityContext:n,sanitizer:null,isTextAttribute:o,isStructuralTemplateAttribute:a,templateKind:s,i18nContext:null,i18nMessage:c,sourceSpan:l},Gs),ss),fi)}function Noe(e,t){return L({kind:k.Advance,delta:e,sourceSpan:t},fi)}function K6(e,t,i,r,n){return L(L(L({kind:k.Conditional,target:e,targetSlot:t,test:i,conditions:r,processed:null,sourceSpan:n,contextValue:null},fi),Gs),ss)}function Ooe(e,t,i,r){return L(L({kind:k.Repeater,target:e,targetSlot:t,collection:i,sourceSpan:r},fi),Gs)}function Roe(e,t,i,r){return L(L(L({kind:k.DeferWhen,target:e,expr:t,prefetch:i,sourceSpan:r},fi),Gs),ss)}function Q6(e,t,i,r,n,o,a,s,c,l,d){return L(L(L({kind:k.I18nExpression,context:e,target:t,i18nOwner:i,handle:r,expression:n,icuPlaceholder:o,i18nPlaceholder:a,resolutionTime:s,usage:c,name:l,sourceSpan:d},fi),ss),Gs)}function Foe(e,t,i){return L({kind:k.I18nApply,owner:e,handle:t,sourceSpan:i},fi)}var V8,z8,U8,H8,j8,G8;function Kl(e){return e instanceof Ir}var Ir=class extends rr{constructor(t=null){super(null,t)}},Ra=class e extends Ir{constructor(t){super(),this.name=t,this.kind=Nt.LexicalRead}visitExpression(t,i){}isEquivalent(t){return this.name===t.name}isConstant(){return!1}transformInternalExpressions(){}clone(){return new e(this.name)}},Pw=class e extends Ir{constructor(t,i,r){super(),this.target=t,this.targetSlot=i,this.offset=r,this.kind=Nt.Reference}visitExpression(){}isEquivalent(t){return t instanceof e&&t.target===this.target}isConstant(){return!1}transformInternalExpressions(){}clone(){return new e(this.target,this.targetSlot,this.offset)}},Gc=class e extends Ir{constructor(t){super(),this.view=t,this.kind=Nt.Context}visitExpression(){}isEquivalent(t){return t instanceof e&&t.view===this.view}isConstant(){return!1}transformInternalExpressions(){}clone(){return new e(this.view)}},Nw=class e extends Ir{constructor(t){super(),this.view=t,this.kind=Nt.TrackContext}visitExpression(){}isEquivalent(t){return t instanceof e&&t.view===this.view}isConstant(){return!1}transformInternalExpressions(){}clone(){return new e(this.view)}},Ow=class e extends Ir{constructor(){super(),this.kind=Nt.NextContext,this.steps=1}visitExpression(){}isEquivalent(t){return t instanceof e&&t.steps===this.steps}isConstant(){return!1}transformInternalExpressions(){}clone(){let t=new e;return t.steps=this.steps,t}},TA=class e extends Ir{constructor(){super(),this.kind=Nt.GetCurrentView}visitExpression(){}isEquivalent(t){return t instanceof e}isConstant(){return!1}transformInternalExpressions(){}clone(){return new e}},Rw=class e extends Ir{constructor(t){super(),this.view=t,this.kind=Nt.RestoreView}visitExpression(t,i){typeof this.view!="number"&&this.view.visitExpression(t,i)}isEquivalent(t){return!(t instanceof e)||typeof t.view!=typeof this.view?!1:typeof this.view=="number"?this.view===t.view:this.view.isEquivalent(t.view)}isConstant(){return!1}transformInternalExpressions(t,i){typeof this.view!="number"&&(this.view=ut(this.view,t,i))}clone(){return new e(this.view instanceof rr?this.view.clone():this.view)}},AA=class e extends Ir{constructor(t){super(),this.expr=t,this.kind=Nt.ResetView}visitExpression(t,i){this.expr.visitExpression(t,i)}isEquivalent(t){return t instanceof e&&this.expr.isEquivalent(t.expr)}isConstant(){return!1}transformInternalExpressions(t,i){this.expr=ut(this.expr,t,i)}clone(){return new e(this.expr.clone())}},Fw=class e extends Ir{constructor(t,i){super(),this.target=t,this.value=i,this.kind=Nt.TwoWayBindingSet}visitExpression(t,i){this.target.visitExpression(t,i),this.value.visitExpression(t,i)}isEquivalent(t){return this.target.isEquivalent(t.target)&&this.value.isEquivalent(t.value)}isConstant(){return!1}transformInternalExpressions(t,i){this.target=ut(this.target,t,i),this.value=ut(this.value,t,i)}clone(){return new e(this.target,this.value)}},$c=class e extends Ir{constructor(t){super(),this.xref=t,this.kind=Nt.ReadVariable,this.name=null}visitExpression(){}isEquivalent(t){return t instanceof e&&t.xref===this.xref}isConstant(){return!1}transformInternalExpressions(){}clone(){let t=new e(this.xref);return t.name=this.name,t}},ip=class e extends Ir{static{V8=A0,z8=h1}constructor(t,i){super(),this.kind=Nt.PureFunctionExpr,this[V8]=!0,this[z8]=!0,this.varOffset=null,this.fn=null,this.body=t,this.args=i}visitExpression(t,i){this.body?.visitExpression(t,i);for(let r of this.args)r.visitExpression(t,i)}isEquivalent(t){return!(t instanceof e)||t.args.length!==this.args.length?!1:t.body!==null&&this.body!==null&&t.body.isEquivalent(this.body)&&t.args.every((i,r)=>i.isEquivalent(this.args[r]))}isConstant(){return!1}transformInternalExpressions(t,i){this.body!==null?this.body=ut(this.body,t,i|nr.InChildOperation):this.fn!==null&&(this.fn=ut(this.fn,t,i));for(let r=0;r<this.args.length;r++)this.args[r]=ut(this.args[r],t,i)}clone(){let t=new e(this.body?.clone()??null,this.args.map(i=>i.clone()));return t.fn=this.fn?.clone()??null,t.varOffset=this.varOffset,t}},sm=class e extends Ir{constructor(t){super(),this.index=t,this.kind=Nt.PureFunctionParameterExpr}visitExpression(){}isEquivalent(t){return t instanceof e&&t.index===this.index}isConstant(){return!0}transformInternalExpressions(){}clone(){return new e(this.index)}},rp=class e extends Ir{static{U8=A0,H8=h1}constructor(t,i,r,n){super(),this.target=t,this.targetSlot=i,this.name=r,this.args=n,this.kind=Nt.PipeBinding,this[U8]=!0,this[H8]=!0,this.varOffset=null}visitExpression(t,i){for(let r of this.args)r.visitExpression(t,i)}isEquivalent(){return!1}isConstant(){return!1}transformInternalExpressions(t,i){for(let r=0;r<this.args.length;r++)this.args[r]=ut(this.args[r],t,i)}clone(){let t=new e(this.target,this.targetSlot,this.name,this.args.map(i=>i.clone()));return t.varOffset=this.varOffset,t}},Lw=class e extends Ir{static{j8=A0,G8=h1}constructor(t,i,r,n,o){super(),this.target=t,this.targetSlot=i,this.name=r,this.args=n,this.numArgs=o,this.kind=Nt.PipeBindingVariadic,this[j8]=!0,this[G8]=!0,this.varOffset=null}visitExpression(t,i){this.args.visitExpression(t,i)}isEquivalent(){return!1}isConstant(){return!1}transformInternalExpressions(t,i){this.args=ut(this.args,t,i)}clone(){let t=new e(this.target,this.targetSlot,this.name,this.args.clone(),this.numArgs);return t.varOffset=this.varOffset,t}},lm=class e extends Ir{constructor(t,i){super(),this.receiver=t,this.name=i,this.kind=Nt.SafePropertyRead}get index(){return this.name}visitExpression(t,i){this.receiver.visitExpression(t,i)}isEquivalent(){return!1}isConstant(){return!1}transformInternalExpressions(t,i){this.receiver=ut(this.receiver,t,i)}clone(){return new e(this.receiver.clone(),this.name)}},cm=class e extends Ir{constructor(t,i,r){super(r),this.receiver=t,this.index=i,this.kind=Nt.SafeKeyedRead}visitExpression(t,i){this.receiver.visitExpression(t,i),this.index.visitExpression(t,i)}isEquivalent(){return!1}isConstant(){return!1}transformInternalExpressions(t,i){this.receiver=ut(this.receiver,t,i),this.index=ut(this.index,t,i)}clone(){return new e(this.receiver.clone(),this.index.clone(),this.sourceSpan)}},tu=class e extends Ir{constructor(t,i){super(),this.receiver=t,this.args=i,this.kind=Nt.SafeInvokeFunction}visitExpression(t,i){this.receiver.visitExpression(t,i);for(let r of this.args)r.visitExpression(t,i)}isEquivalent(){return!1}isConstant(){return!1}transformInternalExpressions(t,i){this.receiver=ut(this.receiver,t,i);for(let r=0;r<this.args.length;r++)this.args[r]=ut(this.args[r],t,i)}clone(){return new e(this.receiver.clone(),this.args.map(t=>t.clone()))}},dm=class e extends Ir{constructor(t,i){super(),this.guard=t,this.expr=i,this.kind=Nt.SafeTernaryExpr}visitExpression(t,i){this.guard.visitExpression(t,i),this.expr.visitExpression(t,i)}isEquivalent(){return!1}isConstant(){return!1}transformInternalExpressions(t,i){this.guard=ut(this.guard,t,i),this.expr=ut(this.expr,t,i)}clone(){return new e(this.guard.clone(),this.expr.clone())}},c0=class e extends Ir{constructor(){super(...arguments),this.kind=Nt.EmptyExpr}visitExpression(t,i){}isEquivalent(t){return t instanceof e}isConstant(){return!0}clone(){return new e}transformInternalExpressions(){}},_l=class e extends Ir{constructor(t,i){super(),this.expr=t,this.xref=i,this.kind=Nt.AssignTemporaryExpr,this.name=null}visitExpression(t,i){this.expr.visitExpression(t,i)}isEquivalent(){return!1}isConstant(){return!1}transformInternalExpressions(t,i){this.expr=ut(this.expr,t,i)}clone(){let t=new e(this.expr.clone(),this.xref);return t.name=this.name,t}},Wc=class e extends Ir{constructor(t){super(),this.xref=t,this.kind=Nt.ReadTemporaryExpr,this.name=null}visitExpression(t,i){}isEquivalent(){return this.xref===this.xref}isConstant(){return!1}transformInternalExpressions(t,i){}clone(){let t=new e(this.xref);return t.name=this.name,t}},Bw=class e extends Ir{constructor(t){super(),this.slot=t,this.kind=Nt.SlotLiteralExpr}visitExpression(t,i){}isEquivalent(t){return t instanceof e&&t.slot===this.slot}isConstant(){return!0}clone(){return new e(this.slot)}transformInternalExpressions(){}},Vw=class e extends Ir{constructor(t,i,r,n=null){super(),this.expr=t,this.target=i,this.targetSlot=r,this.alias=n,this.kind=Nt.ConditionalCase}visitExpression(t,i){this.expr!==null&&this.expr.visitExpression(t,i)}isEquivalent(t){return t instanceof e&&t.expr===this.expr}isConstant(){return!0}clone(){return new e(this.expr,this.target,this.targetSlot)}transformInternalExpressions(t,i){this.expr!==null&&(this.expr=ut(this.expr,t,i))}},d0=class e extends Ir{constructor(t){super(),this.expr=t,this.kind=Nt.ConstCollected}transformInternalExpressions(t,i){this.expr=t(this.expr,i)}visitExpression(t,i){this.expr.visitExpression(t,i)}isEquivalent(t){return t instanceof e?this.expr.isEquivalent(t.expr):!1}isConstant(){return this.expr.isConstant()}clone(){return new e(this.expr)}};function La(e,t){mo(e,(i,r)=>(t(i,r),i),nr.None)}var nr=function(e){return e[e.None=0]="None",e[e.InChildOperation=1]="InChildOperation",e}(nr||{});function xT(e,t,i){for(let r=0;r<e.expressions.length;r++)e.expressions[r]=ut(e.expressions[r],t,i)}function mo(e,t,i){switch(e.kind){case k.StyleProp:case k.StyleMap:case k.ClassProp:case k.ClassMap:case k.Binding:e.expression instanceof Cn?xT(e.expression,t,i):e.expression=ut(e.expression,t,i);break;case k.Property:case k.HostProperty:case k.Attribute:e.expression instanceof Cn?xT(e.expression,t,i):e.expression=ut(e.expression,t,i),e.sanitizer=e.sanitizer&&ut(e.sanitizer,t,i);break;case k.TwoWayProperty:e.expression=ut(e.expression,t,i),e.sanitizer=e.sanitizer&&ut(e.sanitizer,t,i);break;case k.I18nExpression:e.expression=ut(e.expression,t,i);break;case k.InterpolateText:xT(e.interpolation,t,i);break;case k.Statement:zw(e.statement,t,i);break;case k.Variable:e.initializer=ut(e.initializer,t,i);break;case k.Conditional:for(let r of e.conditions)r.expr!==null&&(r.expr=ut(r.expr,t,i));e.processed!==null&&(e.processed=ut(e.processed,t,i)),e.contextValue!==null&&(e.contextValue=ut(e.contextValue,t,i));break;case k.Listener:case k.TwoWayListener:for(let r of e.handlerOps)mo(r,t,i|nr.InChildOperation);break;case k.ExtractedAttribute:e.expression=e.expression&&ut(e.expression,t,i),e.trustedValueFn=e.trustedValueFn&&ut(e.trustedValueFn,t,i);break;case k.RepeaterCreate:e.track=ut(e.track,t,i),e.trackByFn!==null&&(e.trackByFn=ut(e.trackByFn,t,i));break;case k.Repeater:e.collection=ut(e.collection,t,i);break;case k.Defer:e.loadingConfig!==null&&(e.loadingConfig=ut(e.loadingConfig,t,i)),e.placeholderConfig!==null&&(e.placeholderConfig=ut(e.placeholderConfig,t,i)),e.resolverFn!==null&&(e.resolverFn=ut(e.resolverFn,t,i));break;case k.I18nMessage:for(let[r,n]of e.params)e.params.set(r,ut(n,t,i));for(let[r,n]of e.postprocessingParams)e.postprocessingParams.set(r,ut(n,t,i));break;case k.DeferWhen:e.expr=ut(e.expr,t,i);break;case k.Advance:case k.Container:case k.ContainerEnd:case k.ContainerStart:case k.DeferOn:case k.DisableBindings:case k.Element:case k.ElementEnd:case k.ElementStart:case k.EnableBindings:case k.I18n:case k.I18nApply:case k.I18nContext:case k.I18nEnd:case k.I18nStart:case k.IcuEnd:case k.IcuStart:case k.Namespace:case k.Pipe:case k.Projection:case k.ProjectionDef:case k.Template:case k.Text:case k.I18nAttributes:case k.IcuPlaceholder:break;default:throw new Error(`AssertionError: transformExpressionsInOp doesn't handle ${k[e.kind]}`)}}function ut(e,t,i){if(e instanceof Ir)e.transformInternalExpressions(t,i);else if(e instanceof Si)e.lhs=ut(e.lhs,t,i),e.rhs=ut(e.rhs,t,i);else if(e instanceof Vh)e.expr=ut(e.expr,t,i);else if(e instanceof ca)e.receiver=ut(e.receiver,t,i);else if(e instanceof ql)e.receiver=ut(e.receiver,t,i),e.index=ut(e.index,t,i);else if(e instanceof Zf)e.receiver=ut(e.receiver,t,i),e.value=ut(e.value,t,i);else if(e instanceof zv)e.receiver=ut(e.receiver,t,i),e.index=ut(e.index,t,i),e.value=ut(e.value,t,i);else if(e instanceof la){e.fn=ut(e.fn,t,i);for(let r=0;r<e.args.length;r++)e.args[r]=ut(e.args[r],t,i)}else if(e instanceof Hs)for(let r=0;r<e.entries.length;r++)e.entries[r]=ut(e.entries[r],t,i);else if(e instanceof vl)for(let r=0;r<e.entries.length;r++)e.entries[r].value=ut(e.entries[r].value,t,i);else if(e instanceof ns)e.condition=ut(e.condition,t,i),e.trueCase=ut(e.trueCase,t,i),e.falseCase!==null&&(e.falseCase=ut(e.falseCase,t,i));else if(e instanceof Yf)e.expr=ut(e.expr,t,i);else if(e instanceof Jx)e.value=ut(e.value,t,i);else if(e instanceof tw)for(let r=0;r<e.expressions.length;r++)e.expressions[r]=ut(e.expressions[r],t,i);else if(e instanceof Bc)e.condition=ut(e.condition,t,i);else if(e instanceof ew)e.tag=ut(e.tag,t,i),e.template.expressions=e.template.expressions.map(r=>ut(r,t,i));else if(e instanceof Bh)if(Array.isArray(e.body))for(let r=0;r<e.body.length;r++)zw(e.body[r],t,i);else e.body=ut(e.body,t,i);else if(!(e instanceof Ti)){if(!(e instanceof rs||e instanceof Lc||e instanceof no))throw new Error(`Unhandled expression kind: ${e.constructor.name}`)}return t(e,i)}function zw(e,t,i){if(e instanceof oo)e.expr=ut(e.expr,t,i);else if(e instanceof Rn)e.value=ut(e.value,t,i);else if(e instanceof Ro)e.value!==void 0&&(e.value=ut(e.value,t,i));else if(e instanceof rw){e.condition=ut(e.condition,t,i);for(let r of e.trueCase)zw(r,t,i);for(let r of e.falseCase)zw(r,t,i)}else throw new Error(`Unhandled statement kind: ${e.constructor.name}`)}function J6(e){return e instanceof no&&typeof e.value=="string"}var Ie=(()=>{class e{static{this.nextListId=0}constructor(){this.debugListId=e.nextListId++,this.head={kind:k.ListEnd,next:null,prev:null,debugListId:this.debugListId},this.tail={kind:k.ListEnd,next:null,prev:null,debugListId:this.debugListId},this.head.next=this.tail,this.tail.prev=this.head}push(i){if(Array.isArray(i)){for(let n of i)this.push(n);return}e.assertIsNotEnd(i),e.assertIsUnowned(i),i.debugListId=this.debugListId;let r=this.tail.prev;i.prev=r,r.next=i,i.next=this.tail,this.tail.prev=i}prepend(i){if(i.length===0)return;for(let o of i)e.assertIsNotEnd(o),e.assertIsUnowned(o),o.debugListId=this.debugListId;let r=this.head.next,n=this.head;for(let o of i)n.next=o,o.prev=n,n=o;n.next=r,r.prev=n}*[Symbol.iterator](){let i=this.head.next;for(;i!==this.tail;){e.assertIsOwned(i,this.debugListId);let r=i.next;yield i,i=r}}*reversed(){let i=this.tail.prev;for(;i!==this.head;){e.assertIsOwned(i,this.debugListId);let r=i.prev;yield i,i=r}}static replace(i,r){e.assertIsNotEnd(i),e.assertIsNotEnd(r),e.assertIsOwned(i),e.assertIsUnowned(r),r.debugListId=i.debugListId,i.prev!==null&&(i.prev.next=r,r.prev=i.prev),i.next!==null&&(i.next.prev=r,r.next=i.next),i.debugListId=null,i.prev=null,i.next=null}static replaceWithMany(i,r){if(r.length===0){e.remove(i);return}e.assertIsNotEnd(i),e.assertIsOwned(i);let n=i.debugListId;i.debugListId=null;for(let d of r)e.assertIsNotEnd(d),e.assertIsUnowned(d);let{prev:o,next:a}=i;i.prev=null,i.next=null;let s=o;for(let d of r)this.assertIsUnowned(d),d.debugListId=n,s.next=d,d.prev=s,d.next=null,s=d;let c=r[0],l=s;o!==null&&(o.next=c,c.prev=o),a!==null&&(a.prev=l,l.next=a)}static remove(i){e.assertIsNotEnd(i),e.assertIsOwned(i),i.prev.next=i.next,i.next.prev=i.prev,i.debugListId=null,i.prev=null,i.next=null}static insertBefore(i,r){if(Array.isArray(i)){for(let n of i)this.insertBefore(n,r);return}if(e.assertIsOwned(r),r.prev===null)throw new Error("AssertionError: illegal operation on list start");e.assertIsNotEnd(i),e.assertIsUnowned(i),i.debugListId=r.debugListId,i.prev=null,r.prev.next=i,i.prev=r.prev,i.next=r,r.prev=i}static insertAfter(i,r){if(e.assertIsOwned(r),r.next===null)throw new Error("AssertionError: illegal operation on list end");e.assertIsNotEnd(i),e.assertIsUnowned(i),i.debugListId=r.debugListId,r.next.prev=i,i.next=r.next,i.prev=r,r.next=i}static assertIsUnowned(i){if(i.debugListId!==null)throw new Error(`AssertionError: illegal operation on owned node: ${k[i.kind]}`)}static assertIsOwned(i,r){if(i.debugListId===null)throw new Error(`AssertionError: illegal operation on unowned node: ${k[i.kind]}`);if(r!==void 0&&i.debugListId!==r)throw new Error(`AssertionError: node belongs to the wrong list (expected ${r}, actual ${i.debugListId})`)}static assertIsNotEnd(i){if(i.kind===k.ListEnd)throw new Error("AssertionError: illegal operation on list head or tail")}}return e})(),as=class{constructor(){this.slot=null}},Loe=new Set([k.Element,k.ElementStart,k.Container,k.ContainerStart,k.Template,k.RepeaterCreate]);function iu(e){return Loe.has(e.kind)}function Boe(e,t,i,r,n,o){return L(L({kind:k.ElementStart,xref:t,tag:e,handle:new as,attributes:null,localRefs:[],nonBindable:!1,namespace:i,i18nPlaceholder:r,startSourceSpan:n,wholeSourceSpan:o},Yc),fi)}function p1(e,t,i,r,n,o,a,s){return L(L({kind:k.Template,xref:e,templateKind:t,attributes:null,tag:i,handle:new as,functionNameSuffix:r,decls:null,vars:null,localRefs:[],nonBindable:!1,namespace:n,i18nPlaceholder:o,startSourceSpan:a,wholeSourceSpan:s},Yc),fi)}function Voe(e,t,i,r,n,o,a,s,c,l){return ve(L(L(L({kind:k.RepeaterCreate,attributes:null,xref:e,handle:new as,emptyView:t,track:r,trackByFn:null,tag:i,emptyTag:o,emptyAttributes:null,functionNameSuffix:"For",namespace:No.HTML,nonBindable:!1,localRefs:[],decls:null,vars:null,varNames:n,usesComponentInstance:!1,i18nPlaceholder:a,emptyI18nPlaceholder:s,startSourceSpan:c,wholeSourceSpan:l},Yc),fi),ss),{numSlotsUsed:t===null?2:3})}function zoe(e,t){return L({kind:k.ElementEnd,xref:e,sourceSpan:t},fi)}function Uoe(e){return L({kind:k.DisableBindings,xref:e},fi)}function Hoe(e){return L({kind:k.EnableBindings,xref:e},fi)}function ez(e,t,i,r){return L(L({kind:k.Text,xref:e,handle:new as,initialValue:t,icuPlaceholder:i,sourceSpan:r},Yc),fi)}function GD(e,t,i,r,n,o,a,s,c){let l=new Ie;return l.push(n),L({kind:k.Listener,target:e,targetSlot:t,tag:r,hostListener:s,name:i,handlerOps:l,handlerFnName:null,consumesDollarEvent:!1,isAnimationListener:o!==null,animationPhase:o,eventTarget:a,sourceSpan:c},fi)}function tz(e,t,i,r,n,o){let a=new Ie;return a.push(n),L({kind:k.TwoWayListener,target:e,targetSlot:t,tag:r,name:i,handlerOps:a,handlerFnName:null,sourceSpan:o},fi)}function iz(e,t,i){return L(L({kind:k.Pipe,xref:e,handle:t,name:i},fi),Yc)}function joe(e){return L({kind:k.Namespace,active:e},fi)}function Goe(e){return L({kind:k.ProjectionDef,def:e},fi)}function $oe(e,t,i,r){return L(L({kind:k.Projection,xref:e,handle:new as,selector:t,i18nPlaceholder:i,projectionSlotIndex:0,attributes:null,localRefs:[],sourceSpan:r},fi),Yc)}function Vs(e,t,i,r,n,o,a,s){return L({kind:k.ExtractedAttribute,target:e,bindingKind:t,namespace:i,name:r,expression:n,i18nContext:o,i18nMessage:a,securityContext:s,trustedValueFn:null},fi)}function Woe(e,t,i,r,n,o){return ve(L(L({kind:k.Defer,xref:e,handle:new as,mainView:t,mainSlot:i,loadingView:null,loadingSlot:null,loadingConfig:null,loadingMinimumTime:null,loadingAfterTime:null,placeholderView:null,placeholderSlot:null,placeholderConfig:null,placeholderMinimumTime:null,errorView:null,errorSlot:null,metadata:r,resolverFn:n,sourceSpan:o},fi),Yc),{numSlotsUsed:2})}function Eh(e,t,i,r){return L({kind:k.DeferOn,defer:e,trigger:t,prefetch:i,sourceSpan:r},fi)}function qoe(e,t,i,r,n,o,a,s){return L({kind:k.I18nMessage,xref:e,i18nContext:t,i18nBlock:i,message:r,messagePlaceholder:n,params:o,postprocessingParams:a,needsPostprocessing:s,subMessages:[]},fi)}function f1(e,t,i,r){return L(L({kind:k.I18nStart,xref:e,handle:new as,root:i??e,message:t,messageIndex:null,subTemplateIndex:null,context:null,sourceSpan:r},fi),Yc)}function m1(e,t){return L({kind:k.I18nEnd,xref:e,sourceSpan:t},fi)}function Xoe(e,t,i,r){return L({kind:k.IcuStart,xref:e,message:t,messagePlaceholder:i,context:null,sourceSpan:r},fi)}function Yoe(e){return L({kind:k.IcuEnd,xref:e},fi)}function Zoe(e,t,i){return L({kind:k.IcuPlaceholder,xref:e,name:t,strings:i,expressionPlaceholders:[]},fi)}function wT(e,t,i,r,n){if(i===null&&e!==Mh.Attr)throw new Error("AssertionError: i18nBlock must be provided for non-attribute contexts.");return L({kind:k.I18nContext,contextKind:e,xref:t,i18nBlock:i,message:r,sourceSpan:n,params:new Map,postprocessingParams:new Map},fi)}function rz(e,t,i){return L(L({kind:k.I18nAttributes,xref:e,handle:t,target:i,i18nAttributesConfig:null},fi),Yc)}function Koe(e,t,i,r,n,o){return L(L({kind:k.HostProperty,name:e,expression:t,isAnimationTrigger:i,i18nContext:r,securityContext:n,sanitizer:null,sourceSpan:o},ss),fi)}var nz="CTX_REF_MARKER",dt=function(e){return e[e.Tmpl=0]="Tmpl",e[e.Host=1]="Host",e[e.Both=2]="Both",e}(dt||{}),Uw=class{constructor(t,i,r){this.componentName=t,this.pool=i,this.compatibility=r,this.kind=dt.Both,this.nextXrefId=0}allocateXrefId(){return this.nextXrefId++}},u0=class extends Uw{constructor(t,i,r,n,o,a,s){super(t,i,r),this.relativeContextFilePath=n,this.i18nUseExternalIds=o,this.deferBlocksMeta=a,this.allDeferrableDepsFn=s,this.kind=dt.Tmpl,this.fnSuffix="Template",this.views=new Map,this.contentSelectors=null,this.consts=[],this.constsInitializers=[],this.root=new ru(this,this.allocateXrefId(),null),this.views.set(this.root.xref,this.root)}allocateView(t){let i=new ru(this,this.allocateXrefId(),t);return this.views.set(i.xref,i),i}get units(){return this.views.values()}addConst(t,i){for(let n=0;n<this.consts.length;n++)if(this.consts[n].isEquivalent(t))return n;let r=this.consts.length;return this.consts.push(t),i&&this.constsInitializers.push(...i),r}},Hw=class{constructor(t){this.xref=t,this.create=new Ie,this.update=new Ie,this.fnName=null,this.vars=null}*ops(){for(let t of this.create)if(yield t,t.kind===k.Listener||t.kind===k.TwoWayListener)for(let i of t.handlerOps)yield i;for(let t of this.update)yield t}},ru=class extends Hw{constructor(t,i,r){super(i),this.job=t,this.parent=r,this.contextVariables=new Map,this.aliases=new Set,this.decls=null}},jw=class extends Uw{constructor(t,i,r){super(t,i,r),this.kind=dt.Host,this.fnSuffix="HostBindings",this.root=new DA(this)}get units(){return[this.root]}},DA=class extends Hw{constructor(t){super(0),this.job=t,this.attributes=null}};function Qoe(e){for(let t of e.units)for(let i of t.ops())mo(i,Joe,nr.None)}function Joe(e){if(e instanceof la&&e.fn instanceof Ra&&e.fn.name==="$any"){if(e.args.length!==1)throw new Error("The $any builtin function expects exactly one argument.");return e.args[0]}return e}function eae(e){let t=new Map;for(let i of e.units)for(let r of i.create)r.kind===k.I18nContext&&t.set(r.xref,r);for(let i of e.units)for(let r of i.update)r.kind===k.I18nExpression&&tae(t,r)&&Ie.insertAfter(Foe(r.i18nOwner,r.handle,null),r)}function tae(e,t){if(t.next?.kind!==k.I18nExpression)return!0;let i=e.get(t.context),r=e.get(t.next.context);if(i===void 0)throw new Error("AssertionError: expected an I18nContextOp to exist for the I18nExpressionOp's context");if(r===void 0)throw new Error("AssertionError: expected an I18nContextOp to exist for the next I18nExpressionOp's context");return i.i18nBlock!==null?i.i18nBlock!==r.i18nBlock:t.i18nOwner!==t.next.i18nOwner}function iae(e){for(let t of e.units){let i=t.update.head,r=[],n=null;for(let o of t.create){if(o.kind===k.I18nStart)n={blockXref:o.xref,lastSlotConsumer:o.xref};else if(o.kind===k.I18nEnd){for(let a of r)a.target=n.lastSlotConsumer,Ie.insertBefore(a,i);r.length=0,n=null}if(vm(o))for(n!==null&&(n.lastSlotConsumer=o.xref);i.next!==null;){if(n!==null&&i.kind===k.I18nExpression&&i.usage===gm.I18nText&&i.i18nOwner===n.blockXref){let a=i;i=i.next,Ie.remove(a),r.push(a);continue}if(jD(i)&&i.target!==o.xref)break;i=i.next}}}}function $D(e){let t=new Map;for(let i of e.create)vm(i)&&(t.set(i.xref,i),i.kind===k.RepeaterCreate&&i.emptyView!==null&&t.set(i.emptyView,i));return t}function rae(e){for(let t of e.units){let i=$D(t);for(let r of t.ops())switch(r.kind){case k.Attribute:nae(t,r,i);break;case k.Property:if(!r.isAnimationTrigger){let n;r.i18nMessage!==null&&r.templateKind===null?n=Et.I18n:r.isStructuralTemplateAttribute?n=Et.Template:n=Et.Property,Ie.insertBefore(Vs(r.target,n,null,r.name,null,null,null,r.securityContext),Ff(i,r.target))}break;case k.TwoWayProperty:Ie.insertBefore(Vs(r.target,Et.TwoWayProperty,null,r.name,null,null,null,r.securityContext),Ff(i,r.target));break;case k.StyleProp:case k.ClassProp:t.job.compatibility===os.TemplateDefinitionBuilder&&r.expression instanceof c0&&Ie.insertBefore(Vs(r.target,Et.Property,null,r.name,null,null,null,Oi.STYLE),Ff(i,r.target));break;case k.Listener:if(!r.isAnimationListener){let n=Vs(r.target,Et.Property,null,r.name,null,null,null,Oi.NONE);if(e.kind===dt.Host){if(e.compatibility)break;t.create.push(n)}else Ie.insertBefore(n,Ff(i,r.target))}break;case k.TwoWayListener:if(e.kind!==dt.Host){let n=Vs(r.target,Et.Property,null,r.name,null,null,null,Oi.NONE);Ie.insertBefore(n,Ff(i,r.target))}break}}}function Ff(e,t){let i=e.get(t);if(i===void 0)throw new Error("All attributes should have an element-like target.");return i}function nae(e,t,i){if(t.expression instanceof Cn)return;let r=t.isTextAttribute||t.expression.isConstant();if(e.job.compatibility===os.TemplateDefinitionBuilder&&(r&&=t.isTextAttribute),r){let n=Vs(t.target,t.isStructuralTemplateAttribute?Et.Template:Et.Attribute,t.namespace,t.name,t.expression,t.i18nContext,t.i18nMessage,t.securityContext);if(e.job.kind===dt.Host)e.create.push(n);else{let o=Ff(i,t.target);Ie.insertBefore(n,o)}Ie.remove(t)}}function oae(e,t){let i=e.get(t);if(i===void 0)throw new Error("All attributes should have an element-like target.");return i}function aae(e){let t=new Map;for(let i of e.units)for(let r of i.create)iu(r)&&t.set(r.xref,r);for(let i of e.units)for(let r of i.ops())if(r.kind===k.Binding)switch(r.bindingKind){case Et.Attribute:if(r.name==="ngNonBindable"){Ie.remove(r);let n=oae(t,r.target);n.nonBindable=!0}else{let[n,o]=sa(r.name);Ie.replace(r,Poe(r.target,n,o,r.expression,r.securityContext,r.isTextAttribute,r.isStructuralTemplateAttribute,r.templateKind,r.i18nMessage,r.sourceSpan))}break;case Et.Property:case Et.Animation:e.kind===dt.Host?Ie.replace(r,Koe(r.name,r.expression,r.bindingKind===Et.Animation,r.i18nContext,r.securityContext,r.sourceSpan)):Ie.replace(r,Toe(r.target,r.name,r.expression,r.bindingKind===Et.Animation,r.securityContext,r.isStructuralTemplateAttribute,r.templateKind,r.i18nContext,r.i18nMessage,r.sourceSpan));break;case Et.TwoWayProperty:if(!(r.expression instanceof rr))throw new Error(`Expected value of two-way property binding "${r.name}" to be an expression`);Ie.replace(r,Aoe(r.target,r.name,r.expression,r.securityContext,r.isStructuralTemplateAttribute,r.templateKind,r.i18nContext,r.i18nMessage,r.sourceSpan));break;case Et.I18n:case Et.ClassName:case Et.StyleProperty:throw new Error(`Unhandled binding of kind ${Et[r.bindingKind]}`)}}var sae=new Set([T.attribute,T.classProp,T.element,T.elementContainer,T.elementContainerEnd,T.elementContainerStart,T.elementEnd,T.elementStart,T.hostProperty,T.i18nExp,T.listener,T.listener,T.property,T.styleProp,T.stylePropInterpolate1,T.stylePropInterpolate2,T.stylePropInterpolate3,T.stylePropInterpolate4,T.stylePropInterpolate5,T.stylePropInterpolate6,T.stylePropInterpolate7,T.stylePropInterpolate8,T.stylePropInterpolateV,T.syntheticHostListener,T.syntheticHostProperty,T.templateCreate,T.twoWayProperty,T.twoWayListener]);function lae(e){for(let t of e.units)$8(t.create),$8(t.update)}function $8(e){let t=null;for(let i of e){if(i.kind!==k.Statement||!(i.statement instanceof oo)){t=null;continue}if(!(i.statement.expr instanceof la)||!(i.statement.expr.fn instanceof Lc)){t=null;continue}let r=i.statement.expr.fn.value;if(!sae.has(r)){t=null;continue}if(t!==null&&t.instruction===r){let n=t.expression.callFn(i.statement.expr.args,i.statement.expr.sourceSpan,i.statement.expr.pure);t.expression=n,t.op.statement=n.toStmt(),Ie.remove(i)}else t={op:i,instruction:r,expression:i.statement.expr}}}function cae(e){for(let t of e.units)for(let i of t.update)i.kind===k.Attribute&&i.expression instanceof Cn&&i.expression.strings.length===2&&i.expression.strings.every(n=>n==="")&&(i.expression=i.expression.expressions[0])}function dae(e){for(let t of e.units)for(let i of t.ops()){if(i.kind!==k.Conditional)continue;let r,n=i.conditions.findIndex(a=>a.expr===null);if(n>=0){let a=i.conditions.splice(n,1)[0].targetSlot;r=new Bw(a)}else r=U(-1);let o=i.test==null?null:new _l(i.test,e.allocateXrefId());for(let a=i.conditions.length-1;a>=0;a--){let s=i.conditions[a];if(s.expr!==null){if(o!==null){let c=a===0?o:new Wc(o.xref);s.expr=new Si(et.Identical,c,s.expr)}else if(s.alias!==null){let c=e.allocateXrefId();s.expr=new _l(s.expr,c),i.contextValue=new Wc(c)}r=new ns(s.expr,new Bw(s.targetSlot),r)}}i.processed=r,i.conditions=[]}}var uae=new Map([["&&",et.And],[">",et.Bigger],[">=",et.BiggerEquals],["|",et.BitwiseOr],["&",et.BitwiseAnd],["/",et.Divide],["==",et.Equals],["===",et.Identical],["<",et.Lower],["<=",et.LowerEquals],["-",et.Minus],["%",et.Modulo],["*",et.Multiply],["!=",et.NotEquals],["!==",et.NotIdentical],["??",et.NullishCoalesce],["||",et.Or],["+",et.Plus]]);function oz(e){let t=new Map([["svg",No.SVG],["math",No.Math]]);return e===null?No.HTML:t.get(e)??No.HTML}function hae(e){let t=new Map([["svg",No.SVG],["math",No.Math]]);for(let[i,r]of t.entries())if(r===e)return i;return null}function pae(e,t){return t===No.HTML?e:`:${hae(t)}:${e}`}function um(e){return Array.isArray(e)?ti(e.map(um)):U(e)}function fae(e){let t=new Map;for(let i of e.units)for(let r of i.create)if(r.kind===k.ExtractedAttribute){let n=t.get(r.target)||new IA(e.compatibility);t.set(r.target,n),n.add(r.bindingKind,r.name,r.expression,r.namespace,r.trustedValueFn),Ie.remove(r)}if(e instanceof u0)for(let i of e.units)for(let r of i.create)if(r.kind==k.Projection){let n=t.get(r.xref);if(n!==void 0){let o=MA(n);o.entries.length>0&&(r.attributes=o)}}else iu(r)&&(r.attributes=W8(e,t,r.xref),r.kind===k.RepeaterCreate&&r.emptyView!==null&&(r.emptyAttributes=W8(e,t,r.emptyView)));else if(e instanceof jw)for(let[i,r]of t.entries()){if(i!==e.root.xref)throw new Error("An attribute would be const collected into the host binding's template function, but is not associated with the root xref.");let n=MA(r);n.entries.length>0&&(e.root.attributes=n)}}function W8(e,t,i){let r=t.get(i);if(r!==void 0){let n=MA(r);if(n.entries.length>0)return e.addConst(n)}return null}var Mf=Object.freeze([]),IA=class{get attributes(){return this.byKind.get(Et.Attribute)??Mf}get classes(){return this.byKind.get(Et.ClassName)??Mf}get styles(){return this.byKind.get(Et.StyleProperty)??Mf}get bindings(){return this.propertyBindings??Mf}get template(){return this.byKind.get(Et.Template)??Mf}get i18n(){return this.byKind.get(Et.I18n)??Mf}constructor(t){this.compatibility=t,this.known=new Map,this.byKind=new Map,this.propertyBindings=null,this.projectAs=null}isKnown(t,i){let r=this.known.get(t)??new Set;return this.known.set(t,r),r.has(i)?!0:(r.add(i),!1)}add(t,i,r,n,o){if(!(this.compatibility===os.TemplateDefinitionBuilder&&(t===Et.Attribute||t===Et.ClassName||t===Et.StyleProperty))&&this.isKnown(t,i))return;if(i==="ngProjectAs"){if(r===null||!(r instanceof no)||r.value==null||typeof r.value?.toString()!="string")throw Error("ngProjectAs must have a string literal value");this.projectAs=r.value.toString()}let s=this.arrayFor(t);if(s.push(...mae(n,i)),t===Et.Attribute||t===Et.StyleProperty){if(r===null)throw Error("Attribute, i18n attribute, & style element attributes must have a value");if(o!==null){if(!J6(r))throw Error("AssertionError: extracted attribute value should be string literal");s.push(WT(o,new Hv([new jv(r.value)],[]),void 0,r.sourceSpan))}else s.push(r)}}arrayFor(t){return t===Et.Property||t===Et.TwoWayProperty?(this.propertyBindings??=[],this.propertyBindings):(this.byKind.has(t)||this.byKind.set(t,[]),this.byKind.get(t))}};function mae(e,t){let i=U(t);return e?[U(0),U(e),i]:[i]}function MA({attributes:e,bindings:t,classes:i,i18n:r,projectAs:n,styles:o,template:a}){let s=[...e];if(n!==null){let c=b0(n)[0];s.push(U(5),um(c))}return i.length>0&&s.push(U(1),...i),o.length>0&&s.push(U(2),...o),t.length>0&&s.push(U(3),...t),a.length>0&&s.push(U(4),...a),r.length>0&&s.push(U(6),...r),ti(s)}function gae(e){let t=new Map;for(let i of e.units){for(let r of i.create)r.kind===k.I18nAttributes&&t.set(r.target,r);for(let r of i.update)switch(r.kind){case k.Property:case k.Attribute:if(r.i18nContext===null||!(r.expression instanceof Cn))continue;let n=t.get(r.target);if(n===void 0)throw new Error("AssertionError: An i18n attribute binding instruction requires the owning element to have an I18nAttributes create instruction");if(n.target!==r.target)throw new Error("AssertionError: Expected i18nAttributes target element to match binding target element");let o=[];for(let a=0;a<r.expression.expressions.length;a++){let s=r.expression.expressions[a];if(r.expression.i18nPlaceholders.length!==r.expression.expressions.length)throw new Error(`AssertionError: An i18n attribute binding instruction requires the same number of expressions and placeholders, but found ${r.expression.i18nPlaceholders.length} placeholders and ${r.expression.expressions.length} expressions`);o.push(Q6(r.i18nContext,n.target,n.xref,n.handle,s,null,r.expression.i18nPlaceholders[a],l0.Creation,gm.I18nAttribute,r.name,r.sourceSpan))}Ie.replaceWithMany(r,o);break}}}function vae(e){for(let t of e.units)for(let i of t.create)if(i.kind===k.Defer){if(i.metadata.deps.length===0||i.resolverFn!==null)continue;let r=[];for(let a of i.metadata.deps)if(a.isDeferrable){let s=ro([new Dr("m",Xc)],ft("m").prop(a.isDefaultImport?"default":a.symbolName)),c=new Gv(a.importPath).prop("then").callFn([s]);r.push(c)}else r.push(a.type);let n=ro([],ti(r));if(i.handle.slot===null)throw new Error("AssertionError: slot must be assigned bfore extracting defer deps functions");let o=t.fnName?.replace("_Template","");i.resolverFn=e.pool.getSharedFunctionReference(n,`${o}_Defer_${i.handle.slot}_DepsFn`,!1)}}function _ae(e){let t=new Map;for(let n of e.units)for(let o of n.ops())switch(o.kind){case k.Binding:case k.Property:case k.Attribute:case k.ExtractedAttribute:if(o.i18nMessage===null)continue;if(!t.has(o.i18nMessage)){let a=wT(Mh.Attr,e.allocateXrefId(),null,o.i18nMessage,null);n.create.push(a),t.set(o.i18nMessage,a.xref)}o.i18nContext=t.get(o.i18nMessage);break}let i=new Map;for(let n of e.units)for(let o of n.create)switch(o.kind){case k.I18nStart:if(o.xref===o.root){let a=wT(Mh.RootI18n,e.allocateXrefId(),o.xref,o.message,null);n.create.push(a),o.context=a.xref,i.set(o.xref,a)}break}for(let n of e.units)for(let o of n.create)if(o.kind===k.I18nStart&&o.xref!==o.root){let a=i.get(o.root);if(a===void 0)throw Error("AssertionError: Root i18n block i18n context should have been created.");o.context=a.xref,i.set(o.xref,a)}let r=null;for(let n of e.units)for(let o of n.create)switch(o.kind){case k.I18nStart:r=o;break;case k.I18nEnd:r=null;break;case k.IcuStart:if(r===null)throw Error("AssertionError: Unexpected ICU outside of an i18n block.");if(o.message.id!==r.message.id){let a=wT(Mh.Icu,e.allocateXrefId(),r.root,o.message,null);n.create.push(a),o.context=a.xref}else o.context=r.context,i.get(r.xref).contextKind=Mh.Icu;break}}function bae(e){let t=new Map;for(let i of e.units)for(let r of i.update.reversed())if(r.kind===k.Binding&&r.isTextAttribute){let n=t.get(r.target)||new Set;n.has(r.name)&&e.compatibility===os.TemplateDefinitionBuilder&&(r.name==="style"||r.name==="class")&&Ie.remove(r),n.add(r.name),t.set(r.target,n)}}function yae(e){for(let t of e.units)for(let i of t.create)i.kind===k.Defer&&(i.placeholderMinimumTime!==null&&(i.placeholderConfig=new d0(um([i.placeholderMinimumTime]))),(i.loadingMinimumTime!==null||i.loadingAfterTime!==null)&&(i.loadingConfig=new d0(um([i.loadingMinimumTime,i.loadingAfterTime]))))}function xae(e){let t=new Map;function i(n){if(t.has(n.xref))return t.get(n.xref);let o=new kA;for(let a of n.create)if(!(!iu(a)||a.localRefs===null)){if(!Array.isArray(a.localRefs))throw new Error("LocalRefs were already processed, but were needed to resolve defer targets.");for(let s of a.localRefs)s.target===""&&o.targets.set(s.name,{xref:a.xref,slot:a.handle})}return t.set(n.xref,o),o}function r(n,o,a){switch(o.trigger.kind){case Vr.Idle:case Vr.Immediate:case Vr.Timer:return;case Vr.Hover:case Vr.Interaction:case Vr.Viewport:if(o.trigger.targetName===null){if(a===null)throw new Error("defer on trigger with no target name must have a placeholder block");let l=e.views.get(a);if(l==null)throw new Error("AssertionError: could not find placeholder view for defer on trigger");for(let d of l.create)if(vm(d)&&(iu(d)||d.kind===k.Projection)){o.trigger.targetXref=d.xref,o.trigger.targetView=a,o.trigger.targetSlotViewSteps=-1,o.trigger.targetSlot=d.handle;return}return}let s=a!==null?e.views.get(a):n,c=a!==null?-1:0;for(;s!==null;){let l=i(s);if(l.targets.has(o.trigger.targetName)){let{xref:d,slot:u}=l.targets.get(o.trigger.targetName);o.trigger.targetXref=d,o.trigger.targetView=s.xref,o.trigger.targetSlotViewSteps=c,o.trigger.targetSlot=u;return}s=s.parent!==null?e.views.get(s.parent):null,c++}break;default:throw new Error(`Trigger kind ${o.trigger.kind} not handled`)}}for(let n of e.units){let o=new Map;for(let a of n.create)switch(a.kind){case k.Defer:o.set(a.xref,a);break;case k.DeferOn:let s=o.get(a.defer);r(n,a,s.placeholderView);break}}}var kA=class{constructor(){this.targets=new Map}},wae=new Map([[k.ElementEnd,[k.ElementStart,k.Element]],[k.ContainerEnd,[k.ContainerStart,k.Container]],[k.I18nEnd,[k.I18nStart,k.I18n]]]),Eae=new Set([k.Pipe]);function Cae(e){for(let t of e.units)for(let i of t.create){let r=wae.get(i.kind);if(r===void 0)continue;let[n,o]=r,a=i.prev;for(;a!==null&&Eae.has(a.kind);)a=a.prev;a!==null&&a.kind===n&&(a.kind=o,Ie.remove(i))}}function Sae(e){for(let t of e.units)for(let i of t.ops())mo(i,r=>kae(r,{job:e}),nr.None),mo(i,Pae,nr.None)}var PUe=[la,Hs,vl,tu,rp].map(e=>e.constructor.name);function Fs(e){return e instanceof Vh?Fs(e.expr):e instanceof Si?Fs(e.lhs)||Fs(e.rhs):e instanceof ns?e.falseCase&&Fs(e.falseCase)?!0:Fs(e.condition)||Fs(e.trueCase):e instanceof Bc?Fs(e.condition):e instanceof _l?Fs(e.expr):e instanceof ca?Fs(e.receiver):e instanceof ql?Fs(e.receiver)||Fs(e.index):e instanceof la||e instanceof Hs||e instanceof vl||e instanceof tu||e instanceof rp}function Tae(e){let t=new Set;return ut(e,i=>(i instanceof _l&&t.add(i.xref),i),nr.None),t}function Aae(e,t,i){return ut(e,r=>{if(r instanceof _l&&t.has(r.xref)){let n=new Wc(r.xref);return i.job.compatibility===os.TemplateDefinitionBuilder?new _l(n,n.xref):n}return r},nr.None),e}function kf(e,t,i){let r;if(Fs(e)){let n=i.job.allocateXrefId();r=[new _l(e,n),new Wc(n)]}else r=[e,e.clone()],Aae(r[1],Tae(r[0]),i);return new dm(r[0],t(r[1]))}function Dae(e){return e instanceof lm||e instanceof cm||e instanceof tu}function Iae(e){return e instanceof ca||e instanceof ql||e instanceof la}function az(e){return Dae(e)||Iae(e)}function Mae(e){if(az(e)&&e.receiver instanceof dm){let t=e.receiver;for(;t.expr instanceof dm;)t=t.expr;return t}return null}function kae(e,t){if(!az(e))return e;let i=Mae(e);if(i){if(e instanceof la)return i.expr=i.expr.callFn(e.args),e.receiver;if(e instanceof ca)return i.expr=i.expr.prop(e.name),e.receiver;if(e instanceof ql)return i.expr=i.expr.key(e.index),e.receiver;if(e instanceof tu)return i.expr=kf(i.expr,r=>r.callFn(e.args),t),e.receiver;if(e instanceof lm)return i.expr=kf(i.expr,r=>r.prop(e.name),t),e.receiver;if(e instanceof cm)return i.expr=kf(i.expr,r=>r.key(e.index),t),e.receiver}else{if(e instanceof tu)return kf(e.receiver,r=>r.callFn(e.args),t);if(e instanceof lm)return kf(e.receiver,r=>r.prop(e.name),t);if(e instanceof cm)return kf(e.receiver,r=>r.key(e.index),t)}return e}function Pae(e){return e instanceof dm?new ns(new Si(et.Equals,e.guard,zh),zh,e.expr):e}var q8="\uFFFD",Nae="#",Oae="*",Rae="/",Fae=":",Lae="[",Bae="]",Vae="|";function zae(e){let t=new Map,i=new Map,r=new Map;for(let o of e.units)for(let a of o.create)switch(a.kind){case k.I18nContext:let s=Uae(e,a);o.create.push(s),t.set(a.xref,s),r.set(a.xref,a);break;case k.I18nStart:i.set(a.xref,a);break}let n=null;for(let o of e.units)for(let a of o.create)switch(a.kind){case k.IcuStart:n=a,Ie.remove(a);let s=r.get(a.context);if(s.contextKind!==Mh.Icu)continue;let c=i.get(s.i18nBlock);if(c.context===s.xref)continue;let l=i.get(c.root),d=t.get(l.context);if(d===void 0)throw Error("AssertionError: ICU sub-message should belong to a root message.");let u=t.get(s.xref);u.messagePlaceholder=a.messagePlaceholder,d.subMessages.push(u.xref);break;case k.IcuEnd:n=null,Ie.remove(a);break;case k.IcuPlaceholder:if(n===null||n.context==null)throw Error("AssertionError: Unexpected ICU placeholder outside of i18n context");t.get(n.context).postprocessingParams.set(a.name,U(Hae(a))),Ie.remove(a);break}}function Uae(e,t,i){let r=X8(t.params),n=X8(t.postprocessingParams),o=[...t.params.values()].some(a=>a.length>1);return qoe(e.allocateXrefId(),t.xref,t.i18nBlock,t.message,i??null,r,n,o)}function Hae(e){if(e.strings.length!==e.expressionPlaceholders.length+1)throw Error(`AssertionError: Invalid ICU placeholder with ${e.strings.length} strings and ${e.expressionPlaceholders.length} expressions`);let t=e.expressionPlaceholders.map(Gf);return e.strings.flatMap((i,r)=>[i,t[r]||""]).join("")}function X8(e){let t=new Map;for(let[i,r]of e){let n=jae(r);n!==null&&t.set(i,U(n))}return t}function jae(e){if(e.length===0)return null;let t=e.map(i=>Gf(i));return t.length===1?t[0]:`${Lae}${t.join(Vae)}${Bae}`}function Gf(e){if(e.flags&Cr.ElementTag&&e.flags&Cr.TemplateTag){if(typeof e.value!="object")throw Error("AssertionError: Expected i18n param value to have an element and template slot");let n=Gf(ve(L({},e),{value:e.value.element,flags:e.flags&~Cr.TemplateTag})),o=Gf(ve(L({},e),{value:e.value.template,flags:e.flags&~Cr.ElementTag}));return e.flags&Cr.OpenTag&&e.flags&Cr.CloseTag?`${o}${n}${o}`:e.flags&Cr.CloseTag?`${n}${o}`:`${o}${n}`}if(e.flags&Cr.OpenTag&&e.flags&Cr.CloseTag)return`${Gf(ve(L({},e),{flags:e.flags&~Cr.CloseTag}))}${Gf(ve(L({},e),{flags:e.flags&~Cr.OpenTag}))}`;if(e.flags===Cr.None)return`${e.value}`;let t="",i="";e.flags&Cr.ElementTag?t=Nae:e.flags&Cr.TemplateTag&&(t=Oae),t!==""&&(i=e.flags&Cr.CloseTag?Rae:"");let r=e.subTemplateIndex===null?"":`${Fae}${e.subTemplateIndex}`;return`${q8}${i}${t}${e.value}${r}${q8}`}function Gae(e){for(let t of e.units){let i=new Map;for(let n of t.create){if(vm(n)){if(n.handle.slot===null)throw new Error("AssertionError: expected slots to have been allocated before generating advance() calls")}else continue;i.set(n.xref,n.handle.slot)}let r=0;for(let n of t.update){if(jD(n)){if(!i.has(n.target))throw new Error(`AssertionError: reference to unknown slot for target ${n.target}`)}else continue;let o=i.get(n.target);if(r!==o){let a=o-r;if(a<0)throw new Error("AssertionError: slot counter should never need to move backwards");Ie.insertBefore(Noe(a,n.sourceSpan),n),r=o}}}}function $ae(e){let t=e.compatibility===os.TemplateDefinitionBuilder,i=[],r=0;for(let n of e.units)for(let o of n.create)o.kind===k.Projection&&(i.push(o.selector),o.projectionSlotIndex=r++);if(i.length>0){let n=null;if(i.length>1||i[0]!=="*"){let o=i.map(a=>a==="*"?a:b0(a));n=e.pool.getConstLiteral(um(o),t)}e.contentSelectors=e.pool.getConstLiteral(um(i),t),e.root.create.prepend([Goe(n)])}}function Wae(e){qx(e.root,null)}function qx(e,t){let i=qae(e,t);for(let n of e.create)switch(n.kind){case k.Template:qx(e.job.views.get(n.xref),i);break;case k.RepeaterCreate:qx(e.job.views.get(n.xref),i),n.emptyView&&qx(e.job.views.get(n.emptyView),i);break;case k.Listener:case k.TwoWayListener:n.handlerOps.prepend(PA(e,i));break}let r=PA(e,i);e.update.prepend(r)}function qae(e,t){let i={view:e.xref,viewContextVariable:{kind:io.Context,name:null,view:e.xref},contextVariables:new Map,aliases:e.aliases,references:[],parent:t};for(let r of e.contextVariables.keys())i.contextVariables.set(r,{kind:io.Identifier,name:null,identifier:r});for(let r of e.create)switch(r.kind){case k.ElementStart:case k.Template:if(!Array.isArray(r.localRefs))throw new Error("AssertionError: expected localRefs to be an array");for(let n=0;n<r.localRefs.length;n++)i.references.push({name:r.localRefs[n].name,targetId:r.xref,targetSlot:r.handle,offset:n,variable:{kind:io.Identifier,name:null,identifier:r.localRefs[n].name}});break}return i}function PA(e,t){let i=[];t.view!==e.xref&&i.push(jf(e.job.allocateXrefId(),t.viewContextVariable,new Ow,Hl.None));let r=e.job.views.get(t.view);for(let[n,o]of r.contextVariables){let a=new Gc(t.view),s=o===nz?a:new ca(a,o);i.push(jf(e.job.allocateXrefId(),t.contextVariables.get(n),s,Hl.None))}for(let n of r.aliases)i.push(jf(e.job.allocateXrefId(),n,n.expression.clone(),Hl.AlwaysInline));for(let n of t.references)i.push(jf(e.job.allocateXrefId(),n.variable,new Pw(n.targetId,n.targetSlot,n.offset),Hl.None));return t.parent!==null&&i.push(...PA(e,t.parent)),i}function Xae(e){for(let t of e.units)for(let i of t.ops())mo(i,r=>r instanceof d0?U(e.addConst(r.expr)):r,nr.None)}var Y8="style.",Z8="class.",Yae="style!",K8="class!",Q8="!important";function Zae(e){for(let t of e.root.update)if(t.kind===k.Binding&&t.bindingKind===Et.Property)if(t.name.endsWith(Q8)&&(t.name=t.name.substring(0,t.name.length-Q8.length)),t.name.startsWith(Y8)){t.bindingKind=Et.StyleProperty,t.name=t.name.substring(Y8.length),Kae(t.name)||(t.name=Qae(t.name));let{property:i,suffix:r}=ET(t.name);t.name=i,t.unit=r}else t.name.startsWith(Yae)?(t.bindingKind=Et.StyleProperty,t.name="style"):t.name.startsWith(Z8)?(t.bindingKind=Et.ClassName,t.name=ET(t.name.substring(Z8.length)).property):t.name.startsWith(K8)&&(t.bindingKind=Et.ClassName,t.name=ET(t.name.substring(K8.length)).property)}function Kae(e){return e.startsWith("--")}function Qae(e){return e.replace(/[a-z][A-Z]/g,t=>t.charAt(0)+"-"+t.charAt(1)).toLowerCase()}function ET(e){let t=e.indexOf("!important");t!==-1&&(e=t>0?e.substring(0,t):"");let i=null,r=e,n=e.lastIndexOf(".");return n>0&&(i=e.slice(n+1),r=e.substring(0,n)),{property:r,suffix:i}}function h0(e,t=!1){return ao(Object.keys(e).map(i=>({key:i,quoted:t,value:e[i]})))}var NA=class{visitText(t){return t.value}visitContainer(t){return t.children.map(i=>i.visit(this)).join("")}visitIcu(t){let i=Object.keys(t.cases).map(n=>`${n} {${t.cases[n].visit(this)}}`);return`{${t.expressionPlaceholder}, ${t.type}, ${i.join(" ")}}`}visitTagPlaceholder(t){return t.isVoid?this.formatPh(t.startName):`${this.formatPh(t.startName)}${t.children.map(i=>i.visit(this)).join("")}${this.formatPh(t.closeName)}`}visitPlaceholder(t){return this.formatPh(t.name)}visitBlockPlaceholder(t){return`${this.formatPh(t.startName)}${t.children.map(i=>i.visit(this)).join("")}${this.formatPh(t.closeName)}`}visitIcuPlaceholder(t,i){return this.formatPh(t.name)}formatPh(t){return`{${C0(t,!1)}}`}},Jae=new NA;function sz(e){return e.visit(Jae)}var Ci=function(e){return e[e.Character=0]="Character",e[e.Identifier=1]="Identifier",e[e.PrivateIdentifier=2]="PrivateIdentifier",e[e.Keyword=3]="Keyword",e[e.String=4]="String",e[e.Operator=5]="Operator",e[e.Number=6]="Number",e[e.Error=7]="Error",e}(Ci||{}),ese=["var","let","as","null","undefined","true","false","if","else","this"],p0=class{tokenize(t){let i=new OA(t),r=[],n=i.scanToken();for(;n!=null;)r.push(n),n=i.scanToken();return r}},bl=class{constructor(t,i,r,n,o){this.index=t,this.end=i,this.type=r,this.numValue=n,this.strValue=o}isCharacter(t){return this.type==Ci.Character&&this.numValue==t}isNumber(){return this.type==Ci.Number}isString(){return this.type==Ci.String}isOperator(t){return this.type==Ci.Operator&&this.strValue==t}isIdentifier(){return this.type==Ci.Identifier}isPrivateIdentifier(){return this.type==Ci.PrivateIdentifier}isKeyword(){return this.type==Ci.Keyword}isKeywordLet(){return this.type==Ci.Keyword&&this.strValue=="let"}isKeywordAs(){return this.type==Ci.Keyword&&this.strValue=="as"}isKeywordNull(){return this.type==Ci.Keyword&&this.strValue=="null"}isKeywordUndefined(){return this.type==Ci.Keyword&&this.strValue=="undefined"}isKeywordTrue(){return this.type==Ci.Keyword&&this.strValue=="true"}isKeywordFalse(){return this.type==Ci.Keyword&&this.strValue=="false"}isKeywordThis(){return this.type==Ci.Keyword&&this.strValue=="this"}isError(){return this.type==Ci.Error}toNumber(){return this.type==Ci.Number?this.numValue:-1}toString(){switch(this.type){case Ci.Character:case Ci.Identifier:case Ci.Keyword:case Ci.Operator:case Ci.PrivateIdentifier:case Ci.String:case Ci.Error:return this.strValue;case Ci.Number:return this.numValue.toString();default:return null}}};function J8(e,t,i){return new bl(e,t,Ci.Character,i,String.fromCharCode(i))}function tse(e,t,i){return new bl(e,t,Ci.Identifier,0,i)}function ise(e,t,i){return new bl(e,t,Ci.PrivateIdentifier,0,i)}function rse(e,t,i){return new bl(e,t,Ci.Keyword,0,i)}function CT(e,t,i){return new bl(e,t,Ci.Operator,0,i)}function nse(e,t,i){return new bl(e,t,Ci.String,0,i)}function ose(e,t,i){return new bl(e,t,Ci.Number,i,"")}function ase(e,t,i){return new bl(e,t,Ci.Error,0,i)}var ST=new bl(-1,-1,Ci.Character,0,""),OA=class{constructor(t){this.input=t,this.peek=0,this.index=-1,this.length=t.length,this.advance()}advance(){this.peek=++this.index>=this.length?oa:this.input.charCodeAt(this.index)}scanToken(){let t=this.input,i=this.length,r=this.peek,n=this.index;for(;r<=A6;)if(++n>=i){r=oa;break}else r=t.charCodeAt(n);if(this.peek=r,this.index=n,n>=i)return null;if(eV(r))return this.scanIdentifier();if(Mc(r))return this.scanNumber(n);let o=n;switch(r){case Rf:return this.advance(),Mc(this.peek)?this.scanNumber(o):J8(o,this.index,Rf);case Fc:case ml:case Ul:case Pa:case qf:case Uf:case zs:case $d:case gl:return this.scanCharacter(o,r);case i0:case t0:return this.scanString();case D6:return this.scanPrivateIdentifier();case M6:case Ew:case wne:case Pc:case xne:case Ane:return this.scanOperator(o,String.fromCharCode(r));case C8:return this.scanQuestion(o);case Vf:case Gd:return this.scanComplexOperator(o,String.fromCharCode(r),zf,"=");case dA:case zf:return this.scanComplexOperator(o,String.fromCharCode(r),zf,"=",zf,"=");case ww:return this.scanComplexOperator(o,"&",ww,"&");case S8:return this.scanComplexOperator(o,"|",S8,"|");case B6:for(;l1(this.peek);)this.advance();return this.scanToken()}return this.advance(),this.error(`Unexpected character [${String.fromCharCode(r)}]`,0)}scanCharacter(t,i){return this.advance(),J8(t,this.index,i)}scanOperator(t,i){return this.advance(),CT(t,this.index,i)}scanComplexOperator(t,i,r,n,o,a){this.advance();let s=i;return this.peek==r&&(this.advance(),s+=n),o!=null&&this.peek==o&&(this.advance(),s+=a),CT(t,this.index,s)}scanIdentifier(){let t=this.index;for(this.advance();tV(this.peek);)this.advance();let i=this.input.substring(t,this.index);return ese.indexOf(i)>-1?rse(t,this.index,i):tse(t,this.index,i)}scanPrivateIdentifier(){let t=this.index;if(this.advance(),!eV(this.peek))return this.error("Invalid character [#]",-1);for(;tV(this.peek);)this.advance();let i=this.input.substring(t,this.index);return ise(t,this.index,i)}scanNumber(t){let i=this.index===t,r=!1;for(this.advance();;){if(!Mc(this.peek))if(this.peek===s1){if(!Mc(this.input.charCodeAt(this.index-1))||!Mc(this.input.charCodeAt(this.index+1)))return this.error("Invalid numeric separator",0);r=!0}else if(this.peek===Rf)i=!1;else if(sse(this.peek)){if(this.advance(),lse(this.peek)&&this.advance(),!Mc(this.peek))return this.error("Invalid exponent",-1);i=!1}else break;this.advance()}let n=this.input.substring(t,this.index);r&&(n=n.replace(/_/g,""));let o=i?dse(n):parseFloat(n);return ose(t,this.index,o)}scanString(){let t=this.index,i=this.peek;this.advance();let r="",n=this.index,o=this.input;for(;this.peek!=i;)if(this.peek==Cw){r+=o.substring(n,this.index);let s;if(this.advance(),this.peek==R6){let c=o.substring(this.index+1,this.index+5);if(/^[0-9a-f]+$/i.test(c))s=parseInt(c,16);else return this.error(`Invalid unicode escape [\\u${c}]`,0);for(let l=0;l<5;l++)this.advance()}else s=cse(this.peek),this.advance();r+=String.fromCharCode(s),n=this.index}else{if(this.peek==oa)return this.error("Unterminated quote",0);this.advance()}let a=o.substring(n,this.index);return this.advance(),nse(t,this.index,r+a)}scanQuestion(t){this.advance();let i="?";return(this.peek===C8||this.peek===Rf)&&(i+=this.peek===Rf?".":"?",this.advance()),CT(t,this.index,i)}error(t,i){let r=this.index+i;return ase(r,this.index,`Lexer Error: ${t} at column ${r} in expression [${this.input}]`)}};function eV(e){return $h<=e&&e<=T0||mm<=e&&e<=a1||e==s1||e==I6}function tV(e){return c1(e)||Mc(e)||e==s1||e==I6}function sse(e){return e==Ine||e==Cne}function lse(e){return e==Ew||e==M6}function cse(e){switch(e){case P6:return Nh;case BD:return T6;case N6:return FD;case O6:return RD;case F6:return S6;default:return e}}function dse(e){let t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}var RA=class{constructor(t,i,r){this.strings=t,this.expressions=i,this.offsets=r}},FA=class{constructor(t,i,r){this.templateBindings=t,this.warnings=i,this.errors=r}},Gw=class{constructor(t){this._lexer=t,this.errors=[]}parseAction(t,i,r,n=zl){this._checkNoInterpolation(t,i,n);let o=this._stripComments(t),a=this._lexer.tokenize(o),s=new Ah(t,i,r,a,1,this.errors,0).parseChain();return new Oa(s,t,i,r,this.errors)}parseBinding(t,i,r,n=zl){let o=this._parseBindingAst(t,i,r,n);return new Oa(o,t,i,r,this.errors)}checkSimpleExpression(t){let i=new LA;return t.visit(i),i.errors}parseSimpleBinding(t,i,r,n=zl){let o=this._parseBindingAst(t,i,r,n),a=this.checkSimpleExpression(o);return a.length>0&&this._reportError(`Host binding expression cannot contain ${a.join(" ")}`,t,i),new Oa(o,t,i,r,this.errors)}_reportError(t,i,r,n){this.errors.push(new n0(t,i,r,n))}_parseBindingAst(t,i,r,n){this._checkNoInterpolation(t,i,n);let o=this._stripComments(t),a=this._lexer.tokenize(o);return new Ah(t,i,r,a,0,this.errors,0).parseChain()}parseTemplateBindings(t,i,r,n,o){let a=this._lexer.tokenize(i);return new Ah(i,r,o,a,0,this.errors,0).parseTemplateBindings({source:t,span:new es(n,n+t.length)})}parseInterpolation(t,i,r,n,o=zl){let{strings:a,expressions:s,offsets:c}=this.splitInterpolation(t,i,n,o);if(s.length===0)return null;let l=[];for(let d=0;d<s.length;++d){let u=s[d].text,h=this._stripComments(u),p=this._lexer.tokenize(h),m=new Ah(t,i,r,p,0,this.errors,c[d]).parseChain();l.push(m)}return this.createInterpolationAst(a.map(d=>d.text),l,t,i,r)}parseInterpolationExpression(t,i,r){let n=this._stripComments(t),o=this._lexer.tokenize(n),a=new Ah(t,i,r,o,0,this.errors,0).parseChain(),s=["",""];return this.createInterpolationAst(s,[a],t,i,r)}createInterpolationAst(t,i,r,n,o){let a=new Wh(0,r.length),s=new En(a,a.toAbsolute(o),t,i);return new Oa(s,r,n,o,this.errors)}splitInterpolation(t,i,r,n=zl){let o=[],a=[],s=[],c=r?use(r):null,l=0,d=!1,u=!1,{start:h,end:p}=n;for(;l<t.length;)if(d){let m=l,f=m+h.length,g=this._getInterpolationEndIndex(t,p,f);if(g===-1){d=!1,u=!0;break}let v=g+p.length,_=t.substring(f,g);_.trim().length===0&&this._reportError("Blank expressions are not allowed in interpolated strings",t,`at column ${l} in`,i),a.push({text:_,start:m,end:v});let y=(c?.get(m)??m)+h.length;s.push(y),l=v,d=!1}else{let m=l;l=t.indexOf(h,l),l===-1&&(l=t.length);let f=t.substring(m,l);o.push({text:f,start:m,end:l}),d=!0}if(!d)if(u){let m=o[o.length-1];m.text+=t.substring(l),m.end=t.length}else o.push({text:t.substring(l),start:l,end:t.length});return new RA(o,a,s)}wrapLiteralPrimitive(t,i,r){let n=new Wh(0,t==null?0:t.length);return new Oa(new ko(n,n.toAbsolute(r),t),t,i,r,this.errors)}_stripComments(t){let i=this._commentStart(t);return i!=null?t.substring(0,i):t}_commentStart(t){let i=null;for(let r=0;r<t.length-1;r++){let n=t.charCodeAt(r),o=t.charCodeAt(r+1);if(n===Pc&&o==Pc&&i==null)return r;i===n?i=null:i==null&&Sw(n)&&(i=n)}return null}_checkNoInterpolation(t,i,{start:r,end:n}){let o=-1,a=-1;for(let s of this._forEachUnquotedChar(t,0))if(o===-1)t.startsWith(r)&&(o=s);else if(a=this._getInterpolationEndIndex(t,n,s),a>-1)break;o>-1&&a>-1&&this._reportError(`Got interpolation (${r}${n}) where expression was expected`,t,`at column ${o} in`,i)}_getInterpolationEndIndex(t,i,r){for(let n of this._forEachUnquotedChar(t,r)){if(t.startsWith(i,n))return n;if(t.startsWith("//",n))return t.indexOf(i,n)}return-1}*_forEachUnquotedChar(t,i){let r=null,n=0;for(let o=i;o<t.length;o++){let a=t[o];Sw(t.charCodeAt(o))&&(r===null||r===a)&&n%2===0?r=r===null?a:null:r===null&&(yield o),n=a==="\\"?n+1:0}}},Nv=function(e){return e[e.None=0]="None",e[e.Writable=1]="Writable",e}(Nv||{}),Ah=class{constructor(t,i,r,n,o,a,s){this.input=t,this.location=i,this.absoluteOffset=r,this.tokens=n,this.parseFlags=o,this.errors=a,this.offset=s,this.rparensExpected=0,this.rbracketsExpected=0,this.rbracesExpected=0,this.context=Nv.None,this.sourceSpanCache=new Map,this.index=0}peek(t){let i=this.index+t;return i<this.tokens.length?this.tokens[i]:ST}get next(){return this.peek(0)}get atEOF(){return this.index>=this.tokens.length}get inputIndex(){return this.atEOF?this.currentEndIndex:this.next.index+this.offset}get currentEndIndex(){return this.index>0?this.peek(-1).end+this.offset:this.tokens.length===0?this.input.length+this.offset:this.next.index+this.offset}get currentAbsoluteOffset(){return this.absoluteOffset+this.inputIndex}span(t,i){let r=this.currentEndIndex;if(i!==void 0&&i>this.currentEndIndex&&(r=i),t>r){let n=r;r=t,t=n}return new Wh(t,r)}sourceSpan(t,i){let r=`${t}@${this.inputIndex}:${i}`;return this.sourceSpanCache.has(r)||this.sourceSpanCache.set(r,this.span(t,i).toAbsolute(this.absoluteOffset)),this.sourceSpanCache.get(r)}advance(){this.index++}withContext(t,i){this.context|=t;let r=i();return this.context^=t,r}consumeOptionalCharacter(t){return this.next.isCharacter(t)?(this.advance(),!0):!1}peekKeywordLet(){return this.next.isKeywordLet()}peekKeywordAs(){return this.next.isKeywordAs()}expectCharacter(t){this.consumeOptionalCharacter(t)||this.error(`Missing expected ${String.fromCharCode(t)}`)}consumeOptionalOperator(t){return this.next.isOperator(t)?(this.advance(),!0):!1}expectOperator(t){this.consumeOptionalOperator(t)||this.error(`Missing expected operator ${t}`)}prettyPrintToken(t){return t===ST?"end of input":`token ${t}`}expectIdentifierOrKeyword(){let t=this.next;return!t.isIdentifier()&&!t.isKeyword()?(t.isPrivateIdentifier()?this._reportErrorForPrivateIdentifier(t,"expected identifier or keyword"):this.error(`Unexpected ${this.prettyPrintToken(t)}, expected identifier or keyword`),null):(this.advance(),t.toString())}expectIdentifierOrKeywordOrString(){let t=this.next;return!t.isIdentifier()&&!t.isKeyword()&&!t.isString()?(t.isPrivateIdentifier()?this._reportErrorForPrivateIdentifier(t,"expected identifier, keyword or string"):this.error(`Unexpected ${this.prettyPrintToken(t)}, expected identifier, keyword, or string`),""):(this.advance(),t.toString())}parseChain(){let t=[],i=this.inputIndex;for(;this.index<this.tokens.length;){let r=this.parsePipe();if(t.push(r),this.consumeOptionalCharacter(gl))for(this.parseFlags&1||this.error("Binding expression cannot contain chained expression");this.consumeOptionalCharacter(gl););else if(this.index<this.tokens.length){let n=this.index;if(this.error(`Unexpected token '${this.next}'`),this.index===n)break}}if(t.length===0){let r=this.offset,n=this.offset+this.input.length;return new Mo(this.span(r,n),this.sourceSpan(r,n))}return t.length==1?t[0]:new Jd(this.span(i),this.sourceSpan(i),t)}parsePipe(){let t=this.inputIndex,i=this.parseExpression();if(this.consumeOptionalOperator("|")){this.parseFlags&1&&this.error("Cannot have a pipe in an action expression");do{let r=this.inputIndex,n=this.expectIdentifierOrKeyword(),o,a;n!==null?o=this.sourceSpan(r):(n="",a=this.next.index!==-1?this.next.index:this.input.length+this.offset,o=new Wh(a,a).toAbsolute(this.absoluteOffset));let s=[];for(;this.consumeOptionalCharacter($d);)s.push(this.parseExpression());i=new Yh(this.span(t),this.sourceSpan(t,a),i,n,s,o)}while(this.consumeOptionalOperator("|"))}return i}parseExpression(){return this.parseConditional()}parseConditional(){let t=this.inputIndex,i=this.parseLogicalOr();if(this.consumeOptionalOperator("?")){let r=this.parsePipe(),n;if(this.consumeOptionalCharacter($d))n=this.parsePipe();else{let o=this.inputIndex,a=this.input.substring(t,o);this.error(`Conditional expression ${a} requires all 3 expressions`),n=new Mo(this.span(t),this.sourceSpan(t))}return new qh(this.span(t),this.sourceSpan(t),i,r,n)}else return i}parseLogicalOr(){let t=this.inputIndex,i=this.parseLogicalAnd();for(;this.consumeOptionalOperator("||");){let r=this.parseLogicalAnd();i=new ka(this.span(t),this.sourceSpan(t),"||",i,r)}return i}parseLogicalAnd(){let t=this.inputIndex,i=this.parseNullishCoalescing();for(;this.consumeOptionalOperator("&&");){let r=this.parseNullishCoalescing();i=new ka(this.span(t),this.sourceSpan(t),"&&",i,r)}return i}parseNullishCoalescing(){let t=this.inputIndex,i=this.parseEquality();for(;this.consumeOptionalOperator("??");){let r=this.parseEquality();i=new ka(this.span(t),this.sourceSpan(t),"??",i,r)}return i}parseEquality(){let t=this.inputIndex,i=this.parseRelational();for(;this.next.type==Ci.Operator;){let r=this.next.strValue;switch(r){case"==":case"===":case"!=":case"!==":this.advance();let n=this.parseRelational();i=new ka(this.span(t),this.sourceSpan(t),r,i,n);continue}break}return i}parseRelational(){let t=this.inputIndex,i=this.parseAdditive();for(;this.next.type==Ci.Operator;){let r=this.next.strValue;switch(r){case"<":case">":case"<=":case">=":this.advance();let n=this.parseAdditive();i=new ka(this.span(t),this.sourceSpan(t),r,i,n);continue}break}return i}parseAdditive(){let t=this.inputIndex,i=this.parseMultiplicative();for(;this.next.type==Ci.Operator;){let r=this.next.strValue;switch(r){case"+":case"-":this.advance();let n=this.parseMultiplicative();i=new ka(this.span(t),this.sourceSpan(t),r,i,n);continue}break}return i}parseMultiplicative(){let t=this.inputIndex,i=this.parsePrefix();for(;this.next.type==Ci.Operator;){let r=this.next.strValue;switch(r){case"*":case"%":case"/":this.advance();let n=this.parsePrefix();i=new ka(this.span(t),this.sourceSpan(t),r,i,n);continue}break}return i}parsePrefix(){if(this.next.type==Ci.Operator){let t=this.inputIndex,i=this.next.strValue,r;switch(i){case"+":return this.advance(),r=this.parsePrefix(),jc.createPlus(this.span(t),this.sourceSpan(t),r);case"-":return this.advance(),r=this.parsePrefix(),jc.createMinus(this.span(t),this.sourceSpan(t),r);case"!":return this.advance(),r=this.parsePrefix(),new Kh(this.span(t),this.sourceSpan(t),r)}}return this.parseCallChain()}parseCallChain(){let t=this.inputIndex,i=this.parsePrimary();for(;;)if(this.consumeOptionalCharacter(Rf))i=this.parseAccessMember(i,t,!1);else if(this.consumeOptionalOperator("?."))this.consumeOptionalCharacter(Fc)?i=this.parseCall(i,t,!0):i=this.consumeOptionalCharacter(qf)?this.parseKeyedReadOrWrite(i,t,!0):this.parseAccessMember(i,t,!0);else if(this.consumeOptionalCharacter(qf))i=this.parseKeyedReadOrWrite(i,t,!1);else if(this.consumeOptionalCharacter(Fc))i=this.parseCall(i,t,!1);else if(this.consumeOptionalOperator("!"))i=new Qh(this.span(t),this.sourceSpan(t),i);else return i}parsePrimary(){let t=this.inputIndex;if(this.consumeOptionalCharacter(Fc)){this.rparensExpected++;let i=this.parsePipe();return this.rparensExpected--,this.expectCharacter(ml),i}else{if(this.next.isKeywordNull())return this.advance(),new ko(this.span(t),this.sourceSpan(t),null);if(this.next.isKeywordUndefined())return this.advance(),new ko(this.span(t),this.sourceSpan(t),void 0);if(this.next.isKeywordTrue())return this.advance(),new ko(this.span(t),this.sourceSpan(t),!0);if(this.next.isKeywordFalse())return this.advance(),new ko(this.span(t),this.sourceSpan(t),!1);if(this.next.isKeywordThis())return this.advance(),new Yd(this.span(t),this.sourceSpan(t));if(this.consumeOptionalCharacter(qf)){this.rbracketsExpected++;let i=this.parseExpressionList(Uf);return this.rbracketsExpected--,this.expectCharacter(Uf),new Zh(this.span(t),this.sourceSpan(t),i)}else{if(this.next.isCharacter(Ul))return this.parseLiteralMap();if(this.next.isIdentifier())return this.parseAccessMember(new Po(this.span(t),this.sourceSpan(t)),t,!1);if(this.next.isNumber()){let i=this.next.toNumber();return this.advance(),new ko(this.span(t),this.sourceSpan(t),i)}else if(this.next.isString()){let i=this.next.toString();return this.advance(),new ko(this.span(t),this.sourceSpan(t),i)}else return this.next.isPrivateIdentifier()?(this._reportErrorForPrivateIdentifier(this.next,null),new Mo(this.span(t),this.sourceSpan(t))):this.index>=this.tokens.length?(this.error(`Unexpected end of expression: ${this.input}`),new Mo(this.span(t),this.sourceSpan(t))):(this.error(`Unexpected token ${this.next}`),new Mo(this.span(t),this.sourceSpan(t)))}}}parseExpressionList(t){let i=[];do if(!this.next.isCharacter(t))i.push(this.parsePipe());else break;while(this.consumeOptionalCharacter(zs));return i}parseLiteralMap(){let t=[],i=[],r=this.inputIndex;if(this.expectCharacter(Ul),!this.consumeOptionalCharacter(Pa)){this.rbracesExpected++;do{let n=this.inputIndex,o=this.next.isString(),a=this.expectIdentifierOrKeywordOrString();if(t.push({key:a,quoted:o}),o)this.expectCharacter($d),i.push(this.parsePipe());else if(this.consumeOptionalCharacter($d))i.push(this.parsePipe());else{let s=this.span(n),c=this.sourceSpan(n);i.push(new to(s,c,c,new Po(s,c),a))}}while(this.consumeOptionalCharacter(zs)&&!this.next.isCharacter(Pa));this.rbracesExpected--,this.expectCharacter(Pa)}return new am(this.span(r),this.sourceSpan(r),t,i)}parseAccessMember(t,i,r){let n=this.inputIndex,o=this.withContext(Nv.Writable,()=>{let c=this.expectIdentifierOrKeyword()??"";return c.length===0&&this.error("Expected identifier for property access",t.span.end),c}),a=this.sourceSpan(n),s;if(r)this.consumeOptionalOperator("=")?(this.error("The '?.' operator cannot be used in the assignment"),s=new Mo(this.span(i),this.sourceSpan(i))):s=new nm(this.span(i),this.sourceSpan(i),a,t,o);else if(this.consumeOptionalOperator("=")){if(!(this.parseFlags&1))return this.error("Bindings cannot contain assignments"),new Mo(this.span(i),this.sourceSpan(i));let c=this.parseConditional();s=new rm(this.span(i),this.sourceSpan(i),a,t,o,c)}else s=new to(this.span(i),this.sourceSpan(i),a,t,o);return s}parseCall(t,i,r){let n=this.inputIndex;this.rparensExpected++;let o=this.parseCallArguments(),a=this.span(n,this.inputIndex).toAbsolute(this.absoluteOffset);this.expectCharacter(ml),this.rparensExpected--;let s=this.span(i),c=this.sourceSpan(i);return r?new Jh(s,c,t,o,a):new Yl(s,c,t,o,a)}parseCallArguments(){if(this.next.isCharacter(ml))return[];let t=[];do t.push(this.parsePipe());while(this.consumeOptionalCharacter(zs));return t}expectTemplateBindingKey(){let t="",i=!1,r=this.currentAbsoluteOffset;do t+=this.expectIdentifierOrKeywordOrString(),i=this.consumeOptionalOperator("-"),i&&(t+="-");while(i);return{source:t,span:new es(r,r+t.length)}}parseTemplateBindings(t){let i=[];for(i.push(...this.parseDirectiveKeywordBindings(t));this.index<this.tokens.length;){let r=this.parseLetBinding();if(r)i.push(r);else{let n=this.expectTemplateBindingKey(),o=this.parseAsBinding(n);o?i.push(o):(n.source=t.source+n.source.charAt(0).toUpperCase()+n.source.substring(1),i.push(...this.parseDirectiveKeywordBindings(n)))}this.consumeStatementTerminator()}return new FA(i,[],this.errors)}parseKeyedReadOrWrite(t,i,r){return this.withContext(Nv.Writable,()=>{this.rbracketsExpected++;let n=this.parsePipe();if(n instanceof Mo&&this.error("Key access cannot be empty"),this.rbracketsExpected--,this.expectCharacter(Uf),this.consumeOptionalOperator("="))if(r)this.error("The '?.' operator cannot be used in the assignment");else{let o=this.parseConditional();return new om(this.span(i),this.sourceSpan(i),t,n,o)}else return r?new Xh(this.span(i),this.sourceSpan(i),t,n):new Hc(this.span(i),this.sourceSpan(i),t,n);return new Mo(this.span(i),this.sourceSpan(i))})}parseDirectiveKeywordBindings(t){let i=[];this.consumeOptionalCharacter($d);let r=this.getDirectiveBoundTarget(),n=this.currentAbsoluteOffset,o=this.parseAsBinding(t);o||(this.consumeStatementTerminator(),n=this.currentAbsoluteOffset);let a=new es(t.span.start,n);return i.push(new mA(a,t,r)),o&&i.push(o),i}getDirectiveBoundTarget(){if(this.next===ST||this.peekKeywordAs()||this.peekKeywordLet())return null;let t=this.parsePipe(),{start:i,end:r}=t.span,n=this.input.substring(i,r);return new Oa(t,n,this.location,this.absoluteOffset+i,this.errors)}parseAsBinding(t){if(!this.peekKeywordAs())return null;this.advance();let i=this.expectTemplateBindingKey();this.consumeStatementTerminator();let r=new es(t.span.start,this.currentAbsoluteOffset);return new o0(r,i,t)}parseLetBinding(){if(!this.peekKeywordLet())return null;let t=this.currentAbsoluteOffset;this.advance();let i=this.expectTemplateBindingKey(),r=null;this.consumeOptionalOperator("=")&&(r=this.expectTemplateBindingKey()),this.consumeStatementTerminator();let n=new es(t,this.currentAbsoluteOffset);return new o0(n,i,r)}consumeStatementTerminator(){this.consumeOptionalCharacter(gl)||this.consumeOptionalCharacter(zs)}error(t,i=null){this.errors.push(new n0(t,this.input,this.locationText(i),this.location)),this.skip()}locationText(t=null){return t==null&&(t=this.index),t<this.tokens.length?`at column ${this.tokens[t].index+1} in`:"at the end of the expression"}_reportErrorForPrivateIdentifier(t,i){let r=`Private identifiers are not supported. Unexpected private identifier: ${t}`;i!==null&&(r+=`, ${i}`),this.error(r)}skip(){let t=this.next;for(;this.index<this.tokens.length&&!t.isCharacter(gl)&&!t.isOperator("|")&&(this.rparensExpected<=0||!t.isCharacter(ml))&&(this.rbracesExpected<=0||!t.isCharacter(Pa))&&(this.rbracketsExpected<=0||!t.isCharacter(Uf))&&(!(this.context&Nv.Writable)||!t.isOperator("="));)this.next.isError()&&this.errors.push(new n0(this.next.toString(),this.input,this.locationText(),this.location)),this.advance(),t=this.next}},LA=class extends Dw{constructor(){super(...arguments),this.errors=[]}visitPipe(){this.errors.push("pipes")}};function use(e){let t=new Map,i=0,r=0,n=0;for(;n<e.length;){let o=e[n];if(o.type===9){let[a,s]=o.parts;i+=s.length,r+=a.length}else{let a=o.parts.reduce((s,c)=>s+c.length,0);r+=a,i+=a}t.set(r,i),n++}return t}var nu=class{constructor(t,i){this.sourceSpan=t,this.i18n=i}},ou=class extends nu{constructor(t,i,r,n){super(i,n),this.value=t,this.tokens=r}visit(t,i){return t.visitText(this,i)}},hm=class extends nu{constructor(t,i,r,n,o,a){super(n,a),this.switchValue=t,this.type=i,this.cases=r,this.switchValueSourceSpan=o}visit(t,i){return t.visitExpansion(this,i)}},BA=class{constructor(t,i,r,n,o){this.value=t,this.expression=i,this.sourceSpan=r,this.valueSourceSpan=n,this.expSourceSpan=o}visit(t,i){return t.visitExpansionCase(this,i)}},VA=class extends nu{constructor(t,i,r,n,o,a,s){super(r,s),this.name=t,this.value=i,this.keySpan=n,this.valueSpan=o,this.valueTokens=a}visit(t,i){return t.visitAttribute(this,i)}},Ls=class extends nu{constructor(t,i,r,n,o,a=null,s){super(n,s),this.name=t,this.attrs=i,this.children=r,this.startSourceSpan=o,this.endSourceSpan=a}visit(t,i){return t.visitElement(this,i)}},f0=class{constructor(t,i){this.value=t,this.sourceSpan=i}visit(t,i){return t.visitComment(this,i)}},Bs=class extends nu{constructor(t,i,r,n,o,a,s=null,c){super(n,c),this.name=t,this.parameters=i,this.children=r,this.nameSpan=o,this.startSourceSpan=a,this.endSourceSpan=s}visit(t,i){return t.visitBlock(this,i)}},$w=class{constructor(t,i){this.expression=t,this.sourceSpan=i}visit(t,i){return t.visitBlockParameter(this,i)}};function nn(e,t,i=null){let r=[],n=e.visit?o=>e.visit(o,i)||o.visit(e,i):o=>o.visit(e,i);return t.forEach(o=>{let a=n(o);a&&r.push(a)}),r}var zA=class{},hse="boolean",pse="number",fse="string",mse="object",gse=["[Element]|textContent,%ariaAtomic,%ariaAutoComplete,%ariaBusy,%ariaChecked,%ariaColCount,%ariaColIndex,%ariaColSpan,%ariaCurrent,%ariaDescription,%ariaDisabled,%ariaExpanded,%ariaHasPopup,%ariaHidden,%ariaKeyShortcuts,%ariaLabel,%ariaLevel,%ariaLive,%ariaModal,%ariaMultiLine,%ariaMultiSelectable,%ariaOrientation,%ariaPlaceholder,%ariaPosInSet,%ariaPressed,%ariaReadOnly,%ariaRelevant,%ariaRequired,%ariaRoleDescription,%ariaRowCount,%ariaRowIndex,%ariaRowSpan,%ariaSelected,%ariaSetSize,%ariaSort,%ariaValueMax,%ariaValueMin,%ariaValueNow,%ariaValueText,%classList,className,elementTiming,id,innerHTML,*beforecopy,*beforecut,*beforepaste,*fullscreenchange,*fullscreenerror,*search,*webkitfullscreenchange,*webkitfullscreenerror,outerHTML,%part,#scrollLeft,#scrollTop,slot,*message,*mozfullscreenchange,*mozfullscreenerror,*mozpointerlockchange,*mozpointerlockerror,*webglcontextcreationerror,*webglcontextlost,*webglcontextrestored","[HTMLElement]^[Element]|accessKey,autocapitalize,!autofocus,contentEditable,dir,!draggable,enterKeyHint,!hidden,!inert,innerText,inputMode,lang,nonce,*abort,*animationend,*animationiteration,*animationstart,*auxclick,*beforexrselect,*blur,*cancel,*canplay,*canplaythrough,*change,*click,*close,*contextmenu,*copy,*cuechange,*cut,*dblclick,*drag,*dragend,*dragenter,*dragleave,*dragover,*dragstart,*drop,*durationchange,*emptied,*ended,*error,*focus,*formdata,*gotpointercapture,*input,*invalid,*keydown,*keypress,*keyup,*load,*loadeddata,*loadedmetadata,*loadstart,*lostpointercapture,*mousedown,*mouseenter,*mouseleave,*mousemove,*mouseout,*mouseover,*mouseup,*mousewheel,*paste,*pause,*play,*playing,*pointercancel,*pointerdown,*pointerenter,*pointerleave,*pointermove,*pointerout,*pointerover,*pointerrawupdate,*pointerup,*progress,*ratechange,*reset,*resize,*scroll,*securitypolicyviolation,*seeked,*seeking,*select,*selectionchange,*selectstart,*slotchange,*stalled,*submit,*suspend,*timeupdate,*toggle,*transitioncancel,*transitionend,*transitionrun,*transitionstart,*volumechange,*waiting,*webkitanimationend,*webkitanimationiteration,*webkitanimationstart,*webkittransitionend,*wheel,outerText,!spellcheck,%style,#tabIndex,title,!translate,virtualKeyboardPolicy","abbr,address,article,aside,b,bdi,bdo,cite,content,code,dd,dfn,dt,em,figcaption,figure,footer,header,hgroup,i,kbd,main,mark,nav,noscript,rb,rp,rt,rtc,ruby,s,samp,section,small,strong,sub,sup,u,var,wbr^[HTMLElement]|accessKey,autocapitalize,!autofocus,contentEditable,dir,!draggable,enterKeyHint,!hidden,innerText,inputMode,lang,nonce,*abort,*animationend,*animationiteration,*animationstart,*auxclick,*beforexrselect,*blur,*cancel,*canplay,*canplaythrough,*change,*click,*close,*contextmenu,*copy,*cuechange,*cut,*dblclick,*drag,*dragend,*dragenter,*dragleave,*dragover,*dragstart,*drop,*durationchange,*emptied,*ended,*error,*focus,*formdata,*gotpointercapture,*input,*invalid,*keydown,*keypress,*keyup,*load,*loadeddata,*loadedmetadata,*loadstart,*lostpointercapture,*mousedown,*mouseenter,*mouseleave,*mousemove,*mouseout,*mouseover,*mouseup,*mousewheel,*paste,*pause,*play,*playing,*pointercancel,*pointerdown,*pointerenter,*pointerleave,*pointermove,*pointerout,*pointerover,*pointerrawupdate,*pointerup,*progress,*ratechange,*reset,*resize,*scroll,*securitypolicyviolation,*seeked,*seeking,*select,*selectionchange,*selectstart,*slotchange,*stalled,*submit,*suspend,*timeupdate,*toggle,*transitioncancel,*transitionend,*transitionrun,*transitionstart,*volumechange,*waiting,*webkitanimationend,*webkitanimationiteration,*webkitanimationstart,*webkittransitionend,*wheel,outerText,!spellcheck,%style,#tabIndex,title,!translate,virtualKeyboardPolicy","media^[HTMLElement]|!autoplay,!controls,%controlsList,%crossOrigin,#currentTime,!defaultMuted,#defaultPlaybackRate,!disableRemotePlayback,!loop,!muted,*encrypted,*waitingforkey,#playbackRate,preload,!preservesPitch,src,%srcObject,#volume",":svg:^[HTMLElement]|!autofocus,nonce,*abort,*animationend,*animationiteration,*animationstart,*auxclick,*beforexrselect,*blur,*cancel,*canplay,*canplaythrough,*change,*click,*close,*contextmenu,*copy,*cuechange,*cut,*dblclick,*drag,*dragend,*dragenter,*dragleave,*dragover,*dragstart,*drop,*durationchange,*emptied,*ended,*error,*focus,*formdata,*gotpointercapture,*input,*invalid,*keydown,*keypress,*keyup,*load,*loadeddata,*loadedmetadata,*loadstart,*lostpointercapture,*mousedown,*mouseenter,*mouseleave,*mousemove,*mouseout,*mouseover,*mouseup,*mousewheel,*paste,*pause,*play,*playing,*pointercancel,*pointerdown,*pointerenter,*pointerleave,*pointermove,*pointerout,*pointerover,*pointerrawupdate,*pointerup,*progress,*ratechange,*reset,*resize,*scroll,*securitypolicyviolation,*seeked,*seeking,*select,*selectionchange,*selectstart,*slotchange,*stalled,*submit,*suspend,*timeupdate,*toggle,*transitioncancel,*transitionend,*transitionrun,*transitionstart,*volumechange,*waiting,*webkitanimationend,*webkitanimationiteration,*webkitanimationstart,*webkittransitionend,*wheel,%style,#tabIndex",":svg:graphics^:svg:|",":svg:animation^:svg:|*begin,*end,*repeat",":svg:geometry^:svg:|",":svg:componentTransferFunction^:svg:|",":svg:gradient^:svg:|",":svg:textContent^:svg:graphics|",":svg:textPositioning^:svg:textContent|","a^[HTMLElement]|charset,coords,download,hash,host,hostname,href,hreflang,name,password,pathname,ping,port,protocol,referrerPolicy,rel,%relList,rev,search,shape,target,text,type,username","area^[HTMLElement]|alt,coords,download,hash,host,hostname,href,!noHref,password,pathname,ping,port,protocol,referrerPolicy,rel,%relList,search,shape,target,username","audio^media|","br^[HTMLElement]|clear","base^[HTMLElement]|href,target","body^[HTMLElement]|aLink,background,bgColor,link,*afterprint,*beforeprint,*beforeunload,*blur,*error,*focus,*hashchange,*languagechange,*load,*message,*messageerror,*offline,*online,*pagehide,*pageshow,*popstate,*rejectionhandled,*resize,*scroll,*storage,*unhandledrejection,*unload,text,vLink","button^[HTMLElement]|!disabled,formAction,formEnctype,formMethod,!formNoValidate,formTarget,name,type,value","canvas^[HTMLElement]|#height,#width","content^[HTMLElement]|select","dl^[HTMLElement]|!compact","data^[HTMLElement]|value","datalist^[HTMLElement]|","details^[HTMLElement]|!open","dialog^[HTMLElement]|!open,returnValue","dir^[HTMLElement]|!compact","div^[HTMLElement]|align","embed^[HTMLElement]|align,height,name,src,type,width","fieldset^[HTMLElement]|!disabled,name","font^[HTMLElement]|color,face,size","form^[HTMLElement]|acceptCharset,action,autocomplete,encoding,enctype,method,name,!noValidate,target","frame^[HTMLElement]|frameBorder,longDesc,marginHeight,marginWidth,name,!noResize,scrolling,src","frameset^[HTMLElement]|cols,*afterprint,*beforeprint,*beforeunload,*blur,*error,*focus,*hashchange,*languagechange,*load,*message,*messageerror,*offline,*online,*pagehide,*pageshow,*popstate,*rejectionhandled,*resize,*scroll,*storage,*unhandledrejection,*unload,rows","hr^[HTMLElement]|align,color,!noShade,size,width","head^[HTMLElement]|","h1,h2,h3,h4,h5,h6^[HTMLElement]|align","html^[HTMLElement]|version","iframe^[HTMLElement]|align,allow,!allowFullscreen,!allowPaymentRequest,csp,frameBorder,height,loading,longDesc,marginHeight,marginWidth,name,referrerPolicy,%sandbox,scrolling,src,srcdoc,width","img^[HTMLElement]|align,alt,border,%crossOrigin,decoding,#height,#hspace,!isMap,loading,longDesc,lowsrc,name,referrerPolicy,sizes,src,srcset,useMap,#vspace,#width","input^[HTMLElement]|accept,align,alt,autocomplete,!checked,!defaultChecked,defaultValue,dirName,!disabled,%files,formAction,formEnctype,formMethod,!formNoValidate,formTarget,#height,!incremental,!indeterminate,max,#maxLength,min,#minLength,!multiple,name,pattern,placeholder,!readOnly,!required,selectionDirection,#selectionEnd,#selectionStart,#size,src,step,type,useMap,value,%valueAsDate,#valueAsNumber,#width","li^[HTMLElement]|type,#value","label^[HTMLElement]|htmlFor","legend^[HTMLElement]|align","link^[HTMLElement]|as,charset,%crossOrigin,!disabled,href,hreflang,imageSizes,imageSrcset,integrity,media,referrerPolicy,rel,%relList,rev,%sizes,target,type","map^[HTMLElement]|name","marquee^[HTMLElement]|behavior,bgColor,direction,height,#hspace,#loop,#scrollAmount,#scrollDelay,!trueSpeed,#vspace,width","menu^[HTMLElement]|!compact","meta^[HTMLElement]|content,httpEquiv,media,name,scheme","meter^[HTMLElement]|#high,#low,#max,#min,#optimum,#value","ins,del^[HTMLElement]|cite,dateTime","ol^[HTMLElement]|!compact,!reversed,#start,type","object^[HTMLElement]|align,archive,border,code,codeBase,codeType,data,!declare,height,#hspace,name,standby,type,useMap,#vspace,width","optgroup^[HTMLElement]|!disabled,label","option^[HTMLElement]|!defaultSelected,!disabled,label,!selected,text,value","output^[HTMLElement]|defaultValue,%htmlFor,name,value","p^[HTMLElement]|align","param^[HTMLElement]|name,type,value,valueType","picture^[HTMLElement]|","pre^[HTMLElement]|#width","progress^[HTMLElement]|#max,#value","q,blockquote,cite^[HTMLElement]|","script^[HTMLElement]|!async,charset,%crossOrigin,!defer,event,htmlFor,integrity,!noModule,%referrerPolicy,src,text,type","select^[HTMLElement]|autocomplete,!disabled,#length,!multiple,name,!required,#selectedIndex,#size,value","slot^[HTMLElement]|name","source^[HTMLElement]|#height,media,sizes,src,srcset,type,#width","span^[HTMLElement]|","style^[HTMLElement]|!disabled,media,type","caption^[HTMLElement]|align","th,td^[HTMLElement]|abbr,align,axis,bgColor,ch,chOff,#colSpan,headers,height,!noWrap,#rowSpan,scope,vAlign,width","col,colgroup^[HTMLElement]|align,ch,chOff,#span,vAlign,width","table^[HTMLElement]|align,bgColor,border,%caption,cellPadding,cellSpacing,frame,rules,summary,%tFoot,%tHead,width","tr^[HTMLElement]|align,bgColor,ch,chOff,vAlign","tfoot,thead,tbody^[HTMLElement]|align,ch,chOff,vAlign","template^[HTMLElement]|","textarea^[HTMLElement]|autocomplete,#cols,defaultValue,dirName,!disabled,#maxLength,#minLength,name,placeholder,!readOnly,!required,#rows,selectionDirection,#selectionEnd,#selectionStart,value,wrap","time^[HTMLElement]|dateTime","title^[HTMLElement]|text","track^[HTMLElement]|!default,kind,label,src,srclang","ul^[HTMLElement]|!compact,type","unknown^[HTMLElement]|","video^media|!disablePictureInPicture,#height,*enterpictureinpicture,*leavepictureinpicture,!playsInline,poster,#width",":svg:a^:svg:graphics|",":svg:animate^:svg:animation|",":svg:animateMotion^:svg:animation|",":svg:animateTransform^:svg:animation|",":svg:circle^:svg:geometry|",":svg:clipPath^:svg:graphics|",":svg:defs^:svg:graphics|",":svg:desc^:svg:|",":svg:discard^:svg:|",":svg:ellipse^:svg:geometry|",":svg:feBlend^:svg:|",":svg:feColorMatrix^:svg:|",":svg:feComponentTransfer^:svg:|",":svg:feComposite^:svg:|",":svg:feConvolveMatrix^:svg:|",":svg:feDiffuseLighting^:svg:|",":svg:feDisplacementMap^:svg:|",":svg:feDistantLight^:svg:|",":svg:feDropShadow^:svg:|",":svg:feFlood^:svg:|",":svg:feFuncA^:svg:componentTransferFunction|",":svg:feFuncB^:svg:componentTransferFunction|",":svg:feFuncG^:svg:componentTransferFunction|",":svg:feFuncR^:svg:componentTransferFunction|",":svg:feGaussianBlur^:svg:|",":svg:feImage^:svg:|",":svg:feMerge^:svg:|",":svg:feMergeNode^:svg:|",":svg:feMorphology^:svg:|",":svg:feOffset^:svg:|",":svg:fePointLight^:svg:|",":svg:feSpecularLighting^:svg:|",":svg:feSpotLight^:svg:|",":svg:feTile^:svg:|",":svg:feTurbulence^:svg:|",":svg:filter^:svg:|",":svg:foreignObject^:svg:graphics|",":svg:g^:svg:graphics|",":svg:image^:svg:graphics|decoding",":svg:line^:svg:geometry|",":svg:linearGradient^:svg:gradient|",":svg:mpath^:svg:|",":svg:marker^:svg:|",":svg:mask^:svg:|",":svg:metadata^:svg:|",":svg:path^:svg:geometry|",":svg:pattern^:svg:|",":svg:polygon^:svg:geometry|",":svg:polyline^:svg:geometry|",":svg:radialGradient^:svg:gradient|",":svg:rect^:svg:geometry|",":svg:svg^:svg:graphics|#currentScale,#zoomAndPan",":svg:script^:svg:|type",":svg:set^:svg:animation|",":svg:stop^:svg:|",":svg:style^:svg:|!disabled,media,title,type",":svg:switch^:svg:graphics|",":svg:symbol^:svg:|",":svg:tspan^:svg:textPositioning|",":svg:text^:svg:textPositioning|",":svg:textPath^:svg:textContent|",":svg:title^:svg:|",":svg:use^:svg:graphics|",":svg:view^:svg:|#zoomAndPan","data^[HTMLElement]|value","keygen^[HTMLElement]|!autofocus,challenge,!disabled,form,keytype,name","menuitem^[HTMLElement]|type,label,icon,!disabled,!checked,radiogroup,!default","summary^[HTMLElement]|","time^[HTMLElement]|dateTime",":svg:cursor^:svg:|",":math:^[HTMLElement]|!autofocus,nonce,*abort,*animationend,*animationiteration,*animationstart,*auxclick,*beforeinput,*beforematch,*beforetoggle,*beforexrselect,*blur,*cancel,*canplay,*canplaythrough,*change,*click,*close,*contentvisibilityautostatechange,*contextlost,*contextmenu,*contextrestored,*copy,*cuechange,*cut,*dblclick,*drag,*dragend,*dragenter,*dragleave,*dragover,*dragstart,*drop,*durationchange,*emptied,*ended,*error,*focus,*formdata,*gotpointercapture,*input,*invalid,*keydown,*keypress,*keyup,*load,*loadeddata,*loadedmetadata,*loadstart,*lostpointercapture,*mousedown,*mouseenter,*mouseleave,*mousemove,*mouseout,*mouseover,*mouseup,*mousewheel,*paste,*pause,*play,*playing,*pointercancel,*pointerdown,*pointerenter,*pointerleave,*pointermove,*pointerout,*pointerover,*pointerrawupdate,*pointerup,*progress,*ratechange,*reset,*resize,*scroll,*scrollend,*securitypolicyviolation,*seeked,*seeking,*select,*selectionchange,*selectstart,*slotchange,*stalled,*submit,*suspend,*timeupdate,*toggle,*transitioncancel,*transitionend,*transitionrun,*transitionstart,*volumechange,*waiting,*webkitanimationend,*webkitanimationiteration,*webkitanimationstart,*webkittransitionend,*wheel,%style,#tabIndex",":math:math^:math:|",":math:maction^:math:|",":math:menclose^:math:|",":math:merror^:math:|",":math:mfenced^:math:|",":math:mfrac^:math:|",":math:mi^:math:|",":math:mmultiscripts^:math:|",":math:mn^:math:|",":math:mo^:math:|",":math:mover^:math:|",":math:mpadded^:math:|",":math:mphantom^:math:|",":math:mroot^:math:|",":math:mrow^:math:|",":math:ms^:math:|",":math:mspace^:math:|",":math:msqrt^:math:|",":math:mstyle^:math:|",":math:msub^:math:|",":math:msubsup^:math:|",":math:msup^:math:|",":math:mtable^:math:|",":math:mtd^:math:|",":math:mtext^:math:|",":math:mtr^:math:|",":math:munder^:math:|",":math:munderover^:math:|",":math:semantics^:math:|"],lz=new Map(Object.entries({class:"className",for:"htmlFor",formaction:"formAction",innerHtml:"innerHTML",readonly:"readOnly",tabindex:"tabIndex"})),vse=Array.from(lz).reduce((e,[t,i])=>(e.set(t,i),e),new Map),pm=class extends zA{constructor(){super(),this._schema=new Map,this._eventSchema=new Map,gse.forEach(t=>{let i=new Map,r=new Set,[n,o]=t.split("|"),a=o.split(","),[s,c]=n.split("^");s.split(",").forEach(d=>{this._schema.set(d.toLowerCase(),i),this._eventSchema.set(d.toLowerCase(),r)});let l=c&&this._schema.get(c.toLowerCase());if(l){for(let[d,u]of l)i.set(d,u);for(let d of this._eventSchema.get(c.toLowerCase()))r.add(d)}a.forEach(d=>{if(d.length>0)switch(d[0]){case"*":r.add(d.substring(1));break;case"!":i.set(d.substring(1),hse);break;case"#":i.set(d.substring(1),pse);break;case"%":i.set(d.substring(1),mse);break;default:i.set(d,fse)}})})}hasProperty(t,i,r){if(r.some(o=>o.name===r8.name))return!0;if(t.indexOf("-")>-1){if(QT(t)||JT(t))return!1;if(r.some(o=>o.name===i8.name))return!0}return(this._schema.get(t.toLowerCase())||this._schema.get("unknown")).has(i)}hasElement(t,i){return i.some(r=>r.name===r8.name)||t.indexOf("-")>-1&&(QT(t)||JT(t)||i.some(r=>r.name===i8.name))?!0:this._schema.has(t.toLowerCase())}securityContext(t,i,r){r&&(i=this.getMappedPropName(i)),t=t.toLowerCase(),i=i.toLowerCase();let n=N8()[t+"|"+i];return n||(n=N8()["*|"+i],n||Oi.NONE)}getMappedPropName(t){return lz.get(t)??t}getDefaultComponentElementName(){return"ng-component"}validateProperty(t){return t.toLowerCase().startsWith("on")?{error:!0,msg:`Binding to event property '${t}' is disallowed for security reasons, please use (${t.slice(2)})=...
If '${t}' is a directive input, make sure the directive is imported by the current module.`}:{error:!1}}validateAttribute(t){return t.toLowerCase().startsWith("on")?{error:!0,msg:`Binding to event attribute '${t}' is disallowed for security reasons, please use (${t.slice(2)})=...`}:{error:!1}}allKnownElementNames(){return Array.from(this._schema.keys())}allKnownAttributesOfElement(t){let i=this._schema.get(t.toLowerCase())||this._schema.get("unknown");return Array.from(i.keys()).map(r=>vse.get(r)??r)}allKnownEventsOfElement(t){return Array.from(this._eventSchema.get(t.toLowerCase())??[])}normalizeAnimationStyleProperty(t){return Dre(t)}normalizeAnimationStyleValue(t,i,r){let n="",o=r.toString().trim(),a=null;if(_se(t)&&r!==0&&r!=="0")if(typeof r=="number")n="px";else{let s=r.match(/^[+-]?[\d\.]+([a-z]*)$/);s&&s[1].length==0&&(a=`Please provide a CSS unit value for ${i}:${r}`)}return{error:a,value:o+n}}};function _se(e){switch(e){case"width":case"height":case"minWidth":case"minHeight":case"maxWidth":case"maxHeight":case"left":case"top":case"bottom":case"right":case"fontSize":case"outlineWidth":case"outlineOffset":case"paddingTop":case"paddingLeft":case"paddingBottom":case"paddingRight":case"marginTop":case"marginLeft":case"marginBottom":case"marginRight":case"borderRadius":case"borderWidth":case"borderTopWidth":case"borderLeftWidth":case"borderRightWidth":case"borderBottomWidth":case"textIndent":return!0;default:return!1}}var di=class{constructor({closedByChildren:t,implicitNamespacePrefix:i,contentType:r=Vl.PARSABLE_DATA,closedByParent:n=!1,isVoid:o=!1,ignoreFirstLf:a=!1,preventNamespaceInheritance:s=!1,canSelfClose:c=!1}={}){this.closedByChildren={},this.closedByParent=!1,t&&t.length>0&&t.forEach(l=>this.closedByChildren[l]=!0),this.isVoid=o,this.closedByParent=n||o,this.implicitNamespacePrefix=i||null,this.contentType=r,this.ignoreFirstLf=a,this.preventNamespaceInheritance=s,this.canSelfClose=c??o}isClosedByChild(t){return this.isVoid||t.toLowerCase()in this.closedByChildren}getContentType(t){return typeof this.contentType=="object"?(t===void 0?void 0:this.contentType[t])??this.contentType.default:this.contentType}},iV,Pf;function cz(e){return Pf||(iV=new di({canSelfClose:!0}),Pf=Object.assign(Object.create(null),{base:new di({isVoid:!0}),meta:new di({isVoid:!0}),area:new di({isVoid:!0}),embed:new di({isVoid:!0}),link:new di({isVoid:!0}),img:new di({isVoid:!0}),input:new di({isVoid:!0}),param:new di({isVoid:!0}),hr:new di({isVoid:!0}),br:new di({isVoid:!0}),source:new di({isVoid:!0}),track:new di({isVoid:!0}),wbr:new di({isVoid:!0}),p:new di({closedByChildren:["address","article","aside","blockquote","div","dl","fieldset","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","main","nav","ol","p","pre","section","table","ul"],closedByParent:!0}),thead:new di({closedByChildren:["tbody","tfoot"]}),tbody:new di({closedByChildren:["tbody","tfoot"],closedByParent:!0}),tfoot:new di({closedByChildren:["tbody"],closedByParent:!0}),tr:new di({closedByChildren:["tr"],closedByParent:!0}),td:new di({closedByChildren:["td","th"],closedByParent:!0}),th:new di({closedByChildren:["td","th"],closedByParent:!0}),col:new di({isVoid:!0}),svg:new di({implicitNamespacePrefix:"svg"}),foreignObject:new di({implicitNamespacePrefix:"svg",preventNamespaceInheritance:!0}),math:new di({implicitNamespacePrefix:"math"}),li:new di({closedByChildren:["li"],closedByParent:!0}),dt:new di({closedByChildren:["dt","dd"]}),dd:new di({closedByChildren:["dt","dd"],closedByParent:!0}),rb:new di({closedByChildren:["rb","rt","rtc","rp"],closedByParent:!0}),rt:new di({closedByChildren:["rb","rt","rtc","rp"],closedByParent:!0}),rtc:new di({closedByChildren:["rb","rtc","rp"],closedByParent:!0}),rp:new di({closedByChildren:["rb","rt","rtc","rp"],closedByParent:!0}),optgroup:new di({closedByChildren:["optgroup"],closedByParent:!0}),option:new di({closedByChildren:["option","optgroup"],closedByParent:!0}),pre:new di({ignoreFirstLf:!0}),listing:new di({ignoreFirstLf:!0}),style:new di({contentType:Vl.RAW_TEXT}),script:new di({contentType:Vl.RAW_TEXT}),title:new di({contentType:{default:Vl.ESCAPABLE_RAW_TEXT,svg:Vl.PARSABLE_DATA}}),textarea:new di({contentType:Vl.ESCAPABLE_RAW_TEXT,ignoreFirstLf:!0})}),new pm().allKnownElementNames().forEach(t=>{!Pf[t]&&eA(t)===null&&(Pf[t]=new di({canSelfClose:!1}))})),Pf[e]??Pf[e.toLowerCase()]??iV}var rV={A:"LINK",B:"BOLD_TEXT",BR:"LINE_BREAK",EM:"EMPHASISED_TEXT",H1:"HEADING_LEVEL1",H2:"HEADING_LEVEL2",H3:"HEADING_LEVEL3",H4:"HEADING_LEVEL4",H5:"HEADING_LEVEL5",H6:"HEADING_LEVEL6",HR:"HORIZONTAL_RULE",I:"ITALIC_TEXT",LI:"LIST_ITEM",LINK:"MEDIA_LINK",OL:"ORDERED_LIST",P:"PARAGRAPH",Q:"QUOTATION",S:"STRIKETHROUGH_TEXT",SMALL:"SMALL_TEXT",SUB:"SUBSTRIPT",SUP:"SUPERSCRIPT",TBODY:"TABLE_BODY",TD:"TABLE_CELL",TFOOT:"TABLE_FOOTER",TH:"TABLE_HEADER_CELL",THEAD:"TABLE_HEADER",TR:"TABLE_ROW",TT:"MONOSPACED_TEXT",U:"UNDERLINED_TEXT",UL:"UNORDERED_LIST"},UA=class{constructor(){this._placeHolderNameCounts={},this._signatureToName={}}getStartTagPlaceholderName(t,i,r){let n=this._hashTag(t,i,r);if(this._signatureToName[n])return this._signatureToName[n];let o=t.toUpperCase(),a=rV[o]||`TAG_${o}`,s=this._generateUniqueName(r?a:`START_${a}`);return this._signatureToName[n]=s,s}getCloseTagPlaceholderName(t){let i=this._hashClosingTag(t);if(this._signatureToName[i])return this._signatureToName[i];let r=t.toUpperCase(),n=rV[r]||`TAG_${r}`,o=this._generateUniqueName(`CLOSE_${n}`);return this._signatureToName[i]=o,o}getPlaceholderName(t,i){let r=t.toUpperCase(),n=`PH: ${r}=${i}`;if(this._signatureToName[n])return this._signatureToName[n];let o=this._generateUniqueName(r);return this._signatureToName[n]=o,o}getUniquePlaceholder(t){return this._generateUniqueName(t.toUpperCase())}getStartBlockPlaceholderName(t,i){let r=this._hashBlock(t,i);if(this._signatureToName[r])return this._signatureToName[r];let n=this._generateUniqueName(`START_BLOCK_${this._toSnakeCase(t)}`);return this._signatureToName[r]=n,n}getCloseBlockPlaceholderName(t){let i=this._hashClosingBlock(t);if(this._signatureToName[i])return this._signatureToName[i];let r=this._generateUniqueName(`CLOSE_BLOCK_${this._toSnakeCase(t)}`);return this._signatureToName[i]=r,r}_hashTag(t,i,r){let n=`<${t}`,o=Object.keys(i).sort().map(s=>` ${s}=${i[s]}`).join(""),a=r?"/>":`></${t}>`;return n+o+a}_hashClosingTag(t){return this._hashTag(`/${t}`,{},!1)}_hashBlock(t,i){let r=i.length===0?"":` (${i.sort().join("; ")})`;return`@${t}${r} {}`}_hashClosingBlock(t){return this._hashBlock(`close_${t}`,[])}_toSnakeCase(t){return t.toUpperCase().replace(/[^A-Z0-9]/g,"_")}_generateUniqueName(t){if(!this._placeHolderNameCounts.hasOwnProperty(t))return this._placeHolderNameCounts[t]=1,t;let r=this._placeHolderNameCounts[t];return this._placeHolderNameCounts[t]=r+1,`${t}_${r}`}},bse=new Gw(new p0);function yse(e,t){let i=new HA(bse,e,t);return(r,n,o,a,s)=>i.toI18nMessage(r,n,o,a,s)}function xse(e,t){return t}var HA=class{constructor(t,i,r){this._expressionParser=t,this._interpolationConfig=i,this._containerBlocks=r}toI18nMessage(t,i="",r="",n="",o){let a={isIcu:t.length==1&&t[0]instanceof hm,icuDepth:0,placeholderRegistry:new UA,placeholderToContent:{},placeholderToMessage:{},visitNodeFn:o||xse},s=nn(this,t,a);return new Oo(s,a.placeholderToContent,a.placeholderToMessage,i,r,n)}visitElement(t,i){let r=nn(this,t.children,i),n={};t.attrs.forEach(l=>{n[l.name]=l.value});let o=cz(t.name).isVoid,a=i.placeholderRegistry.getStartTagPlaceholderName(t.name,n,o);i.placeholderToContent[a]={text:t.startSourceSpan.toString(),sourceSpan:t.startSourceSpan};let s="";o||(s=i.placeholderRegistry.getCloseTagPlaceholderName(t.name),i.placeholderToContent[s]={text:`</${t.name}>`,sourceSpan:t.endSourceSpan??t.sourceSpan});let c=new Kd(t.name,n,a,s,r,o,t.sourceSpan,t.startSourceSpan,t.endSourceSpan);return i.visitNodeFn(t,c)}visitAttribute(t,i){let r=t.valueTokens===void 0||t.valueTokens.length===1?new Bf(t.value,t.valueSpan||t.sourceSpan):this._visitTextWithInterpolation(t.valueTokens,t.valueSpan||t.sourceSpan,i,t.i18n);return i.visitNodeFn(t,r)}visitText(t,i){let r=t.tokens.length===1?new Bf(t.value,t.sourceSpan):this._visitTextWithInterpolation(t.tokens,t.sourceSpan,i,t.i18n);return i.visitNodeFn(t,r)}visitComment(t,i){return null}visitExpansion(t,i){i.icuDepth++;let r={},n=new _w(t.switchValue,t.type,r,t.sourceSpan);if(t.cases.forEach(s=>{r[s.value]=new jl(s.expression.map(c=>c.visit(this,i)),s.expSourceSpan)}),i.icuDepth--,i.isIcu||i.icuDepth>0){let s=i.placeholderRegistry.getUniquePlaceholder(`VAR_${t.type}`);return n.expressionPlaceholder=s,i.placeholderToContent[s]={text:t.switchValue,sourceSpan:t.switchValueSourceSpan},i.visitNodeFn(t,n)}let o=i.placeholderRegistry.getPlaceholderName("ICU",t.sourceSpan.toString());i.placeholderToMessage[o]=this.toI18nMessage([t],"","","",void 0);let a=new tm(n,o,t.sourceSpan);return i.visitNodeFn(t,a)}visitExpansionCase(t,i){throw new Error("Unreachable code")}visitBlock(t,i){let r=nn(this,t.children,i);if(this._containerBlocks.has(t.name))return new jl(r,t.sourceSpan);let n=t.parameters.map(c=>c.expression),o=i.placeholderRegistry.getStartBlockPlaceholderName(t.name,n),a=i.placeholderRegistry.getCloseBlockPlaceholderName(t.name);i.placeholderToContent[o]={text:t.startSourceSpan.toString(),sourceSpan:t.startSourceSpan},i.placeholderToContent[a]={text:t.endSourceSpan?t.endSourceSpan.toString():"}",sourceSpan:t.endSourceSpan??t.sourceSpan};let s=new Uc(t.name,n,o,a,r,t.sourceSpan,t.startSourceSpan,t.endSourceSpan);return i.visitNodeFn(t,s)}visitBlockParameter(t,i){throw new Error("Unreachable code")}_visitTextWithInterpolation(t,i,r,n){let o=[],a=!1;for(let s of t)switch(s.type){case 8:case 17:a=!0;let c=s.parts[1],l=Tse(c)||"INTERPOLATION",d=r.placeholderRegistry.getPlaceholderName(l,c);r.placeholderToContent[d]={text:s.parts.join(""),sourceSpan:s.sourceSpan},o.push(new Jv(c,d,s.sourceSpan));break;default:if(s.parts[0].length>0){let u=o[o.length-1];u instanceof Bf?(u.value+=s.parts[0],u.sourceSpan=new pi(u.sourceSpan.start,s.sourceSpan.end,u.sourceSpan.fullStart,u.sourceSpan.details)):o.push(new Bf(s.parts[0],s.sourceSpan))}break}return a?(wse(o,n),new jl(o,i)):o[0]}};function wse(e,t){if(t instanceof Oo&&(Ese(t),t=t.nodes[0]),t instanceof jl){Cse(t.children,e);for(let i=0;i<e.length;i++)e[i].sourceSpan=t.children[i].sourceSpan}}function Ese(e){let t=e.nodes;if(t.length!==1||!(t[0]instanceof jl))throw new Error("Unexpected previous i18n message - expected it to consist of only a single `Container` node.")}function Cse(e,t){if(e.length!==t.length)throw new Error("The number of i18n message children changed between first and second pass.");if(e.some((i,r)=>t[r].constructor!==i.constructor))throw new Error("The types of the i18n message children changed between first and second pass.")}var Sse=/\/\/[\s\S]*i18n[\s\S]*\([\s\S]*ph[\s\S]*=[\s\S]*("|')([\s\S]*?)\1[\s\S]*\)/g;function Tse(e){return e.split(Sse)[2]}var jA=class extends si{constructor(t,i){super(t,i)}},Ww={AElig:"\xC6",AMP:"&",amp:"&",Aacute:"\xC1",Abreve:"\u0102",Acirc:"\xC2",Acy:"\u0410",Afr:"\u{1D504}",Agrave:"\xC0",Alpha:"\u0391",Amacr:"\u0100",And:"\u2A53",Aogon:"\u0104",Aopf:"\u{1D538}",ApplyFunction:"\u2061",af:"\u2061",Aring:"\xC5",angst:"\xC5",Ascr:"\u{1D49C}",Assign:"\u2254",colone:"\u2254",coloneq:"\u2254",Atilde:"\xC3",Auml:"\xC4",Backslash:"\u2216",setminus:"\u2216",setmn:"\u2216",smallsetminus:"\u2216",ssetmn:"\u2216",Barv:"\u2AE7",Barwed:"\u2306",doublebarwedge:"\u2306",Bcy:"\u0411",Because:"\u2235",becaus:"\u2235",because:"\u2235",Bernoullis:"\u212C",Bscr:"\u212C",bernou:"\u212C",Beta:"\u0392",Bfr:"\u{1D505}",Bopf:"\u{1D539}",Breve:"\u02D8",breve:"\u02D8",Bumpeq:"\u224E",HumpDownHump:"\u224E",bump:"\u224E",CHcy:"\u0427",COPY:"\xA9",copy:"\xA9",Cacute:"\u0106",Cap:"\u22D2",CapitalDifferentialD:"\u2145",DD:"\u2145",Cayleys:"\u212D",Cfr:"\u212D",Ccaron:"\u010C",Ccedil:"\xC7",Ccirc:"\u0108",Cconint:"\u2230",Cdot:"\u010A",Cedilla:"\xB8",cedil:"\xB8",CenterDot:"\xB7",centerdot:"\xB7",middot:"\xB7",Chi:"\u03A7",CircleDot:"\u2299",odot:"\u2299",CircleMinus:"\u2296",ominus:"\u2296",CirclePlus:"\u2295",oplus:"\u2295",CircleTimes:"\u2297",otimes:"\u2297",ClockwiseContourIntegral:"\u2232",cwconint:"\u2232",CloseCurlyDoubleQuote:"\u201D",rdquo:"\u201D",rdquor:"\u201D",CloseCurlyQuote:"\u2019",rsquo:"\u2019",rsquor:"\u2019",Colon:"\u2237",Proportion:"\u2237",Colone:"\u2A74",Congruent:"\u2261",equiv:"\u2261",Conint:"\u222F",DoubleContourIntegral:"\u222F",ContourIntegral:"\u222E",conint:"\u222E",oint:"\u222E",Copf:"\u2102",complexes:"\u2102",Coproduct:"\u2210",coprod:"\u2210",CounterClockwiseContourIntegral:"\u2233",awconint:"\u2233",Cross:"\u2A2F",Cscr:"\u{1D49E}",Cup:"\u22D3",CupCap:"\u224D",asympeq:"\u224D",DDotrahd:"\u2911",DJcy:"\u0402",DScy:"\u0405",DZcy:"\u040F",Dagger:"\u2021",ddagger:"\u2021",Darr:"\u21A1",Dashv:"\u2AE4",DoubleLeftTee:"\u2AE4",Dcaron:"\u010E",Dcy:"\u0414",Del:"\u2207",nabla:"\u2207",Delta:"\u0394",Dfr:"\u{1D507}",DiacriticalAcute:"\xB4",acute:"\xB4",DiacriticalDot:"\u02D9",dot:"\u02D9",DiacriticalDoubleAcute:"\u02DD",dblac:"\u02DD",DiacriticalGrave:"`",grave:"`",DiacriticalTilde:"\u02DC",tilde:"\u02DC",Diamond:"\u22C4",diam:"\u22C4",diamond:"\u22C4",DifferentialD:"\u2146",dd:"\u2146",Dopf:"\u{1D53B}",Dot:"\xA8",DoubleDot:"\xA8",die:"\xA8",uml:"\xA8",DotDot:"\u20DC",DotEqual:"\u2250",doteq:"\u2250",esdot:"\u2250",DoubleDownArrow:"\u21D3",Downarrow:"\u21D3",dArr:"\u21D3",DoubleLeftArrow:"\u21D0",Leftarrow:"\u21D0",lArr:"\u21D0",DoubleLeftRightArrow:"\u21D4",Leftrightarrow:"\u21D4",hArr:"\u21D4",iff:"\u21D4",DoubleLongLeftArrow:"\u27F8",Longleftarrow:"\u27F8",xlArr:"\u27F8",DoubleLongLeftRightArrow:"\u27FA",Longleftrightarrow:"\u27FA",xhArr:"\u27FA",DoubleLongRightArrow:"\u27F9",Longrightarrow:"\u27F9",xrArr:"\u27F9",DoubleRightArrow:"\u21D2",Implies:"\u21D2",Rightarrow:"\u21D2",rArr:"\u21D2",DoubleRightTee:"\u22A8",vDash:"\u22A8",DoubleUpArrow:"\u21D1",Uparrow:"\u21D1",uArr:"\u21D1",DoubleUpDownArrow:"\u21D5",Updownarrow:"\u21D5",vArr:"\u21D5",DoubleVerticalBar:"\u2225",par:"\u2225",parallel:"\u2225",shortparallel:"\u2225",spar:"\u2225",DownArrow:"\u2193",ShortDownArrow:"\u2193",darr:"\u2193",downarrow:"\u2193",DownArrowBar:"\u2913",DownArrowUpArrow:"\u21F5",duarr:"\u21F5",DownBreve:"\u0311",DownLeftRightVector:"\u2950",DownLeftTeeVector:"\u295E",DownLeftVector:"\u21BD",leftharpoondown:"\u21BD",lhard:"\u21BD",DownLeftVectorBar:"\u2956",DownRightTeeVector:"\u295F",DownRightVector:"\u21C1",rhard:"\u21C1",rightharpoondown:"\u21C1",DownRightVectorBar:"\u2957",DownTee:"\u22A4",top:"\u22A4",DownTeeArrow:"\u21A7",mapstodown:"\u21A7",Dscr:"\u{1D49F}",Dstrok:"\u0110",ENG:"\u014A",ETH:"\xD0",Eacute:"\xC9",Ecaron:"\u011A",Ecirc:"\xCA",Ecy:"\u042D",Edot:"\u0116",Efr:"\u{1D508}",Egrave:"\xC8",Element:"\u2208",in:"\u2208",isin:"\u2208",isinv:"\u2208",Emacr:"\u0112",EmptySmallSquare:"\u25FB",EmptyVerySmallSquare:"\u25AB",Eogon:"\u0118",Eopf:"\u{1D53C}",Epsilon:"\u0395",Equal:"\u2A75",EqualTilde:"\u2242",eqsim:"\u2242",esim:"\u2242",Equilibrium:"\u21CC",rightleftharpoons:"\u21CC",rlhar:"\u21CC",Escr:"\u2130",expectation:"\u2130",Esim:"\u2A73",Eta:"\u0397",Euml:"\xCB",Exists:"\u2203",exist:"\u2203",ExponentialE:"\u2147",ee:"\u2147",exponentiale:"\u2147",Fcy:"\u0424",Ffr:"\u{1D509}",FilledSmallSquare:"\u25FC",FilledVerySmallSquare:"\u25AA",blacksquare:"\u25AA",squarf:"\u25AA",squf:"\u25AA",Fopf:"\u{1D53D}",ForAll:"\u2200",forall:"\u2200",Fouriertrf:"\u2131",Fscr:"\u2131",GJcy:"\u0403",GT:">",gt:">",Gamma:"\u0393",Gammad:"\u03DC",Gbreve:"\u011E",Gcedil:"\u0122",Gcirc:"\u011C",Gcy:"\u0413",Gdot:"\u0120",Gfr:"\u{1D50A}",Gg:"\u22D9",ggg:"\u22D9",Gopf:"\u{1D53E}",GreaterEqual:"\u2265",ge:"\u2265",geq:"\u2265",GreaterEqualLess:"\u22DB",gel:"\u22DB",gtreqless:"\u22DB",GreaterFullEqual:"\u2267",gE:"\u2267",geqq:"\u2267",GreaterGreater:"\u2AA2",GreaterLess:"\u2277",gl:"\u2277",gtrless:"\u2277",GreaterSlantEqual:"\u2A7E",geqslant:"\u2A7E",ges:"\u2A7E",GreaterTilde:"\u2273",gsim:"\u2273",gtrsim:"\u2273",Gscr:"\u{1D4A2}",Gt:"\u226B",NestedGreaterGreater:"\u226B",gg:"\u226B",HARDcy:"\u042A",Hacek:"\u02C7",caron:"\u02C7",Hat:"^",Hcirc:"\u0124",Hfr:"\u210C",Poincareplane:"\u210C",HilbertSpace:"\u210B",Hscr:"\u210B",hamilt:"\u210B",Hopf:"\u210D",quaternions:"\u210D",HorizontalLine:"\u2500",boxh:"\u2500",Hstrok:"\u0126",HumpEqual:"\u224F",bumpe:"\u224F",bumpeq:"\u224F",IEcy:"\u0415",IJlig:"\u0132",IOcy:"\u0401",Iacute:"\xCD",Icirc:"\xCE",Icy:"\u0418",Idot:"\u0130",Ifr:"\u2111",Im:"\u2111",image:"\u2111",imagpart:"\u2111",Igrave:"\xCC",Imacr:"\u012A",ImaginaryI:"\u2148",ii:"\u2148",Int:"\u222C",Integral:"\u222B",int:"\u222B",Intersection:"\u22C2",bigcap:"\u22C2",xcap:"\u22C2",InvisibleComma:"\u2063",ic:"\u2063",InvisibleTimes:"\u2062",it:"\u2062",Iogon:"\u012E",Iopf:"\u{1D540}",Iota:"\u0399",Iscr:"\u2110",imagline:"\u2110",Itilde:"\u0128",Iukcy:"\u0406",Iuml:"\xCF",Jcirc:"\u0134",Jcy:"\u0419",Jfr:"\u{1D50D}",Jopf:"\u{1D541}",Jscr:"\u{1D4A5}",Jsercy:"\u0408",Jukcy:"\u0404",KHcy:"\u0425",KJcy:"\u040C",Kappa:"\u039A",Kcedil:"\u0136",Kcy:"\u041A",Kfr:"\u{1D50E}",Kopf:"\u{1D542}",Kscr:"\u{1D4A6}",LJcy:"\u0409",LT:"<",lt:"<",Lacute:"\u0139",Lambda:"\u039B",Lang:"\u27EA",Laplacetrf:"\u2112",Lscr:"\u2112",lagran:"\u2112",Larr:"\u219E",twoheadleftarrow:"\u219E",Lcaron:"\u013D",Lcedil:"\u013B",Lcy:"\u041B",LeftAngleBracket:"\u27E8",lang:"\u27E8",langle:"\u27E8",LeftArrow:"\u2190",ShortLeftArrow:"\u2190",larr:"\u2190",leftarrow:"\u2190",slarr:"\u2190",LeftArrowBar:"\u21E4",larrb:"\u21E4",LeftArrowRightArrow:"\u21C6",leftrightarrows:"\u21C6",lrarr:"\u21C6",LeftCeiling:"\u2308",lceil:"\u2308",LeftDoubleBracket:"\u27E6",lobrk:"\u27E6",LeftDownTeeVector:"\u2961",LeftDownVector:"\u21C3",dharl:"\u21C3",downharpoonleft:"\u21C3",LeftDownVectorBar:"\u2959",LeftFloor:"\u230A",lfloor:"\u230A",LeftRightArrow:"\u2194",harr:"\u2194",leftrightarrow:"\u2194",LeftRightVector:"\u294E",LeftTee:"\u22A3",dashv:"\u22A3",LeftTeeArrow:"\u21A4",mapstoleft:"\u21A4",LeftTeeVector:"\u295A",LeftTriangle:"\u22B2",vartriangleleft:"\u22B2",vltri:"\u22B2",LeftTriangleBar:"\u29CF",LeftTriangleEqual:"\u22B4",ltrie:"\u22B4",trianglelefteq:"\u22B4",LeftUpDownVector:"\u2951",LeftUpTeeVector:"\u2960",LeftUpVector:"\u21BF",uharl:"\u21BF",upharpoonleft:"\u21BF",LeftUpVectorBar:"\u2958",LeftVector:"\u21BC",leftharpoonup:"\u21BC",lharu:"\u21BC",LeftVectorBar:"\u2952",LessEqualGreater:"\u22DA",leg:"\u22DA",lesseqgtr:"\u22DA",LessFullEqual:"\u2266",lE:"\u2266",leqq:"\u2266",LessGreater:"\u2276",lessgtr:"\u2276",lg:"\u2276",LessLess:"\u2AA1",LessSlantEqual:"\u2A7D",leqslant:"\u2A7D",les:"\u2A7D",LessTilde:"\u2272",lesssim:"\u2272",lsim:"\u2272",Lfr:"\u{1D50F}",Ll:"\u22D8",Lleftarrow:"\u21DA",lAarr:"\u21DA",Lmidot:"\u013F",LongLeftArrow:"\u27F5",longleftarrow:"\u27F5",xlarr:"\u27F5",LongLeftRightArrow:"\u27F7",longleftrightarrow:"\u27F7",xharr:"\u27F7",LongRightArrow:"\u27F6",longrightarrow:"\u27F6",xrarr:"\u27F6",Lopf:"\u{1D543}",LowerLeftArrow:"\u2199",swarr:"\u2199",swarrow:"\u2199",LowerRightArrow:"\u2198",searr:"\u2198",searrow:"\u2198",Lsh:"\u21B0",lsh:"\u21B0",Lstrok:"\u0141",Lt:"\u226A",NestedLessLess:"\u226A",ll:"\u226A",Map:"\u2905",Mcy:"\u041C",MediumSpace:"\u205F",Mellintrf:"\u2133",Mscr:"\u2133",phmmat:"\u2133",Mfr:"\u{1D510}",MinusPlus:"\u2213",mnplus:"\u2213",mp:"\u2213",Mopf:"\u{1D544}",Mu:"\u039C",NJcy:"\u040A",Nacute:"\u0143",Ncaron:"\u0147",Ncedil:"\u0145",Ncy:"\u041D",NegativeMediumSpace:"\u200B",NegativeThickSpace:"\u200B",NegativeThinSpace:"\u200B",NegativeVeryThinSpace:"\u200B",ZeroWidthSpace:"\u200B",NewLine:`
`,Nfr:"\u{1D511}",NoBreak:"\u2060",NonBreakingSpace:"\xA0",nbsp:"\xA0",Nopf:"\u2115",naturals:"\u2115",Not:"\u2AEC",NotCongruent:"\u2262",nequiv:"\u2262",NotCupCap:"\u226D",NotDoubleVerticalBar:"\u2226",npar:"\u2226",nparallel:"\u2226",nshortparallel:"\u2226",nspar:"\u2226",NotElement:"\u2209",notin:"\u2209",notinva:"\u2209",NotEqual:"\u2260",ne:"\u2260",NotEqualTilde:"\u2242\u0338",nesim:"\u2242\u0338",NotExists:"\u2204",nexist:"\u2204",nexists:"\u2204",NotGreater:"\u226F",ngt:"\u226F",ngtr:"\u226F",NotGreaterEqual:"\u2271",nge:"\u2271",ngeq:"\u2271",NotGreaterFullEqual:"\u2267\u0338",ngE:"\u2267\u0338",ngeqq:"\u2267\u0338",NotGreaterGreater:"\u226B\u0338",nGtv:"\u226B\u0338",NotGreaterLess:"\u2279",ntgl:"\u2279",NotGreaterSlantEqual:"\u2A7E\u0338",ngeqslant:"\u2A7E\u0338",nges:"\u2A7E\u0338",NotGreaterTilde:"\u2275",ngsim:"\u2275",NotHumpDownHump:"\u224E\u0338",nbump:"\u224E\u0338",NotHumpEqual:"\u224F\u0338",nbumpe:"\u224F\u0338",NotLeftTriangle:"\u22EA",nltri:"\u22EA",ntriangleleft:"\u22EA",NotLeftTriangleBar:"\u29CF\u0338",NotLeftTriangleEqual:"\u22EC",nltrie:"\u22EC",ntrianglelefteq:"\u22EC",NotLess:"\u226E",nless:"\u226E",nlt:"\u226E",NotLessEqual:"\u2270",nle:"\u2270",nleq:"\u2270",NotLessGreater:"\u2278",ntlg:"\u2278",NotLessLess:"\u226A\u0338",nLtv:"\u226A\u0338",NotLessSlantEqual:"\u2A7D\u0338",nleqslant:"\u2A7D\u0338",nles:"\u2A7D\u0338",NotLessTilde:"\u2274",nlsim:"\u2274",NotNestedGreaterGreater:"\u2AA2\u0338",NotNestedLessLess:"\u2AA1\u0338",NotPrecedes:"\u2280",npr:"\u2280",nprec:"\u2280",NotPrecedesEqual:"\u2AAF\u0338",npre:"\u2AAF\u0338",npreceq:"\u2AAF\u0338",NotPrecedesSlantEqual:"\u22E0",nprcue:"\u22E0",NotReverseElement:"\u220C",notni:"\u220C",notniva:"\u220C",NotRightTriangle:"\u22EB",nrtri:"\u22EB",ntriangleright:"\u22EB",NotRightTriangleBar:"\u29D0\u0338",NotRightTriangleEqual:"\u22ED",nrtrie:"\u22ED",ntrianglerighteq:"\u22ED",NotSquareSubset:"\u228F\u0338",NotSquareSubsetEqual:"\u22E2",nsqsube:"\u22E2",NotSquareSuperset:"\u2290\u0338",NotSquareSupersetEqual:"\u22E3",nsqsupe:"\u22E3",NotSubset:"\u2282\u20D2",nsubset:"\u2282\u20D2",vnsub:"\u2282\u20D2",NotSubsetEqual:"\u2288",nsube:"\u2288",nsubseteq:"\u2288",NotSucceeds:"\u2281",nsc:"\u2281",nsucc:"\u2281",NotSucceedsEqual:"\u2AB0\u0338",nsce:"\u2AB0\u0338",nsucceq:"\u2AB0\u0338",NotSucceedsSlantEqual:"\u22E1",nsccue:"\u22E1",NotSucceedsTilde:"\u227F\u0338",NotSuperset:"\u2283\u20D2",nsupset:"\u2283\u20D2",vnsup:"\u2283\u20D2",NotSupersetEqual:"\u2289",nsupe:"\u2289",nsupseteq:"\u2289",NotTilde:"\u2241",nsim:"\u2241",NotTildeEqual:"\u2244",nsime:"\u2244",nsimeq:"\u2244",NotTildeFullEqual:"\u2247",ncong:"\u2247",NotTildeTilde:"\u2249",nap:"\u2249",napprox:"\u2249",NotVerticalBar:"\u2224",nmid:"\u2224",nshortmid:"\u2224",nsmid:"\u2224",Nscr:"\u{1D4A9}",Ntilde:"\xD1",Nu:"\u039D",OElig:"\u0152",Oacute:"\xD3",Ocirc:"\xD4",Ocy:"\u041E",Odblac:"\u0150",Ofr:"\u{1D512}",Ograve:"\xD2",Omacr:"\u014C",Omega:"\u03A9",ohm:"\u03A9",Omicron:"\u039F",Oopf:"\u{1D546}",OpenCurlyDoubleQuote:"\u201C",ldquo:"\u201C",OpenCurlyQuote:"\u2018",lsquo:"\u2018",Or:"\u2A54",Oscr:"\u{1D4AA}",Oslash:"\xD8",Otilde:"\xD5",Otimes:"\u2A37",Ouml:"\xD6",OverBar:"\u203E",oline:"\u203E",OverBrace:"\u23DE",OverBracket:"\u23B4",tbrk:"\u23B4",OverParenthesis:"\u23DC",PartialD:"\u2202",part:"\u2202",Pcy:"\u041F",Pfr:"\u{1D513}",Phi:"\u03A6",Pi:"\u03A0",PlusMinus:"\xB1",plusmn:"\xB1",pm:"\xB1",Popf:"\u2119",primes:"\u2119",Pr:"\u2ABB",Precedes:"\u227A",pr:"\u227A",prec:"\u227A",PrecedesEqual:"\u2AAF",pre:"\u2AAF",preceq:"\u2AAF",PrecedesSlantEqual:"\u227C",prcue:"\u227C",preccurlyeq:"\u227C",PrecedesTilde:"\u227E",precsim:"\u227E",prsim:"\u227E",Prime:"\u2033",Product:"\u220F",prod:"\u220F",Proportional:"\u221D",prop:"\u221D",propto:"\u221D",varpropto:"\u221D",vprop:"\u221D",Pscr:"\u{1D4AB}",Psi:"\u03A8",QUOT:'"',quot:'"',Qfr:"\u{1D514}",Qopf:"\u211A",rationals:"\u211A",Qscr:"\u{1D4AC}",RBarr:"\u2910",drbkarow:"\u2910",REG:"\xAE",circledR:"\xAE",reg:"\xAE",Racute:"\u0154",Rang:"\u27EB",Rarr:"\u21A0",twoheadrightarrow:"\u21A0",Rarrtl:"\u2916",Rcaron:"\u0158",Rcedil:"\u0156",Rcy:"\u0420",Re:"\u211C",Rfr:"\u211C",real:"\u211C",realpart:"\u211C",ReverseElement:"\u220B",SuchThat:"\u220B",ni:"\u220B",niv:"\u220B",ReverseEquilibrium:"\u21CB",leftrightharpoons:"\u21CB",lrhar:"\u21CB",ReverseUpEquilibrium:"\u296F",duhar:"\u296F",Rho:"\u03A1",RightAngleBracket:"\u27E9",rang:"\u27E9",rangle:"\u27E9",RightArrow:"\u2192",ShortRightArrow:"\u2192",rarr:"\u2192",rightarrow:"\u2192",srarr:"\u2192",RightArrowBar:"\u21E5",rarrb:"\u21E5",RightArrowLeftArrow:"\u21C4",rightleftarrows:"\u21C4",rlarr:"\u21C4",RightCeiling:"\u2309",rceil:"\u2309",RightDoubleBracket:"\u27E7",robrk:"\u27E7",RightDownTeeVector:"\u295D",RightDownVector:"\u21C2",dharr:"\u21C2",downharpoonright:"\u21C2",RightDownVectorBar:"\u2955",RightFloor:"\u230B",rfloor:"\u230B",RightTee:"\u22A2",vdash:"\u22A2",RightTeeArrow:"\u21A6",map:"\u21A6",mapsto:"\u21A6",RightTeeVector:"\u295B",RightTriangle:"\u22B3",vartriangleright:"\u22B3",vrtri:"\u22B3",RightTriangleBar:"\u29D0",RightTriangleEqual:"\u22B5",rtrie:"\u22B5",trianglerighteq:"\u22B5",RightUpDownVector:"\u294F",RightUpTeeVector:"\u295C",RightUpVector:"\u21BE",uharr:"\u21BE",upharpoonright:"\u21BE",RightUpVectorBar:"\u2954",RightVector:"\u21C0",rharu:"\u21C0",rightharpoonup:"\u21C0",RightVectorBar:"\u2953",Ropf:"\u211D",reals:"\u211D",RoundImplies:"\u2970",Rrightarrow:"\u21DB",rAarr:"\u21DB",Rscr:"\u211B",realine:"\u211B",Rsh:"\u21B1",rsh:"\u21B1",RuleDelayed:"\u29F4",SHCHcy:"\u0429",SHcy:"\u0428",SOFTcy:"\u042C",Sacute:"\u015A",Sc:"\u2ABC",Scaron:"\u0160",Scedil:"\u015E",Scirc:"\u015C",Scy:"\u0421",Sfr:"\u{1D516}",ShortUpArrow:"\u2191",UpArrow:"\u2191",uarr:"\u2191",uparrow:"\u2191",Sigma:"\u03A3",SmallCircle:"\u2218",compfn:"\u2218",Sopf:"\u{1D54A}",Sqrt:"\u221A",radic:"\u221A",Square:"\u25A1",squ:"\u25A1",square:"\u25A1",SquareIntersection:"\u2293",sqcap:"\u2293",SquareSubset:"\u228F",sqsub:"\u228F",sqsubset:"\u228F",SquareSubsetEqual:"\u2291",sqsube:"\u2291",sqsubseteq:"\u2291",SquareSuperset:"\u2290",sqsup:"\u2290",sqsupset:"\u2290",SquareSupersetEqual:"\u2292",sqsupe:"\u2292",sqsupseteq:"\u2292",SquareUnion:"\u2294",sqcup:"\u2294",Sscr:"\u{1D4AE}",Star:"\u22C6",sstarf:"\u22C6",Sub:"\u22D0",Subset:"\u22D0",SubsetEqual:"\u2286",sube:"\u2286",subseteq:"\u2286",Succeeds:"\u227B",sc:"\u227B",succ:"\u227B",SucceedsEqual:"\u2AB0",sce:"\u2AB0",succeq:"\u2AB0",SucceedsSlantEqual:"\u227D",sccue:"\u227D",succcurlyeq:"\u227D",SucceedsTilde:"\u227F",scsim:"\u227F",succsim:"\u227F",Sum:"\u2211",sum:"\u2211",Sup:"\u22D1",Supset:"\u22D1",Superset:"\u2283",sup:"\u2283",supset:"\u2283",SupersetEqual:"\u2287",supe:"\u2287",supseteq:"\u2287",THORN:"\xDE",TRADE:"\u2122",trade:"\u2122",TSHcy:"\u040B",TScy:"\u0426",Tab:"	",Tau:"\u03A4",Tcaron:"\u0164",Tcedil:"\u0162",Tcy:"\u0422",Tfr:"\u{1D517}",Therefore:"\u2234",there4:"\u2234",therefore:"\u2234",Theta:"\u0398",ThickSpace:"\u205F\u200A",ThinSpace:"\u2009",thinsp:"\u2009",Tilde:"\u223C",sim:"\u223C",thicksim:"\u223C",thksim:"\u223C",TildeEqual:"\u2243",sime:"\u2243",simeq:"\u2243",TildeFullEqual:"\u2245",cong:"\u2245",TildeTilde:"\u2248",ap:"\u2248",approx:"\u2248",asymp:"\u2248",thickapprox:"\u2248",thkap:"\u2248",Topf:"\u{1D54B}",TripleDot:"\u20DB",tdot:"\u20DB",Tscr:"\u{1D4AF}",Tstrok:"\u0166",Uacute:"\xDA",Uarr:"\u219F",Uarrocir:"\u2949",Ubrcy:"\u040E",Ubreve:"\u016C",Ucirc:"\xDB",Ucy:"\u0423",Udblac:"\u0170",Ufr:"\u{1D518}",Ugrave:"\xD9",Umacr:"\u016A",UnderBar:"_",lowbar:"_",UnderBrace:"\u23DF",UnderBracket:"\u23B5",bbrk:"\u23B5",UnderParenthesis:"\u23DD",Union:"\u22C3",bigcup:"\u22C3",xcup:"\u22C3",UnionPlus:"\u228E",uplus:"\u228E",Uogon:"\u0172",Uopf:"\u{1D54C}",UpArrowBar:"\u2912",UpArrowDownArrow:"\u21C5",udarr:"\u21C5",UpDownArrow:"\u2195",updownarrow:"\u2195",varr:"\u2195",UpEquilibrium:"\u296E",udhar:"\u296E",UpTee:"\u22A5",bot:"\u22A5",bottom:"\u22A5",perp:"\u22A5",UpTeeArrow:"\u21A5",mapstoup:"\u21A5",UpperLeftArrow:"\u2196",nwarr:"\u2196",nwarrow:"\u2196",UpperRightArrow:"\u2197",nearr:"\u2197",nearrow:"\u2197",Upsi:"\u03D2",upsih:"\u03D2",Upsilon:"\u03A5",Uring:"\u016E",Uscr:"\u{1D4B0}",Utilde:"\u0168",Uuml:"\xDC",VDash:"\u22AB",Vbar:"\u2AEB",Vcy:"\u0412",Vdash:"\u22A9",Vdashl:"\u2AE6",Vee:"\u22C1",bigvee:"\u22C1",xvee:"\u22C1",Verbar:"\u2016",Vert:"\u2016",VerticalBar:"\u2223",mid:"\u2223",shortmid:"\u2223",smid:"\u2223",VerticalLine:"|",verbar:"|",vert:"|",VerticalSeparator:"\u2758",VerticalTilde:"\u2240",wr:"\u2240",wreath:"\u2240",VeryThinSpace:"\u200A",hairsp:"\u200A",Vfr:"\u{1D519}",Vopf:"\u{1D54D}",Vscr:"\u{1D4B1}",Vvdash:"\u22AA",Wcirc:"\u0174",Wedge:"\u22C0",bigwedge:"\u22C0",xwedge:"\u22C0",Wfr:"\u{1D51A}",Wopf:"\u{1D54E}",Wscr:"\u{1D4B2}",Xfr:"\u{1D51B}",Xi:"\u039E",Xopf:"\u{1D54F}",Xscr:"\u{1D4B3}",YAcy:"\u042F",YIcy:"\u0407",YUcy:"\u042E",Yacute:"\xDD",Ycirc:"\u0176",Ycy:"\u042B",Yfr:"\u{1D51C}",Yopf:"\u{1D550}",Yscr:"\u{1D4B4}",Yuml:"\u0178",ZHcy:"\u0416",Zacute:"\u0179",Zcaron:"\u017D",Zcy:"\u0417",Zdot:"\u017B",Zeta:"\u0396",Zfr:"\u2128",zeetrf:"\u2128",Zopf:"\u2124",integers:"\u2124",Zscr:"\u{1D4B5}",aacute:"\xE1",abreve:"\u0103",ac:"\u223E",mstpos:"\u223E",acE:"\u223E\u0333",acd:"\u223F",acirc:"\xE2",acy:"\u0430",aelig:"\xE6",afr:"\u{1D51E}",agrave:"\xE0",alefsym:"\u2135",aleph:"\u2135",alpha:"\u03B1",amacr:"\u0101",amalg:"\u2A3F",and:"\u2227",wedge:"\u2227",andand:"\u2A55",andd:"\u2A5C",andslope:"\u2A58",andv:"\u2A5A",ang:"\u2220",angle:"\u2220",ange:"\u29A4",angmsd:"\u2221",measuredangle:"\u2221",angmsdaa:"\u29A8",angmsdab:"\u29A9",angmsdac:"\u29AA",angmsdad:"\u29AB",angmsdae:"\u29AC",angmsdaf:"\u29AD",angmsdag:"\u29AE",angmsdah:"\u29AF",angrt:"\u221F",angrtvb:"\u22BE",angrtvbd:"\u299D",angsph:"\u2222",angzarr:"\u237C",aogon:"\u0105",aopf:"\u{1D552}",apE:"\u2A70",apacir:"\u2A6F",ape:"\u224A",approxeq:"\u224A",apid:"\u224B",apos:"'",aring:"\xE5",ascr:"\u{1D4B6}",ast:"*",midast:"*",atilde:"\xE3",auml:"\xE4",awint:"\u2A11",bNot:"\u2AED",backcong:"\u224C",bcong:"\u224C",backepsilon:"\u03F6",bepsi:"\u03F6",backprime:"\u2035",bprime:"\u2035",backsim:"\u223D",bsim:"\u223D",backsimeq:"\u22CD",bsime:"\u22CD",barvee:"\u22BD",barwed:"\u2305",barwedge:"\u2305",bbrktbrk:"\u23B6",bcy:"\u0431",bdquo:"\u201E",ldquor:"\u201E",bemptyv:"\u29B0",beta:"\u03B2",beth:"\u2136",between:"\u226C",twixt:"\u226C",bfr:"\u{1D51F}",bigcirc:"\u25EF",xcirc:"\u25EF",bigodot:"\u2A00",xodot:"\u2A00",bigoplus:"\u2A01",xoplus:"\u2A01",bigotimes:"\u2A02",xotime:"\u2A02",bigsqcup:"\u2A06",xsqcup:"\u2A06",bigstar:"\u2605",starf:"\u2605",bigtriangledown:"\u25BD",xdtri:"\u25BD",bigtriangleup:"\u25B3",xutri:"\u25B3",biguplus:"\u2A04",xuplus:"\u2A04",bkarow:"\u290D",rbarr:"\u290D",blacklozenge:"\u29EB",lozf:"\u29EB",blacktriangle:"\u25B4",utrif:"\u25B4",blacktriangledown:"\u25BE",dtrif:"\u25BE",blacktriangleleft:"\u25C2",ltrif:"\u25C2",blacktriangleright:"\u25B8",rtrif:"\u25B8",blank:"\u2423",blk12:"\u2592",blk14:"\u2591",blk34:"\u2593",block:"\u2588",bne:"=\u20E5",bnequiv:"\u2261\u20E5",bnot:"\u2310",bopf:"\u{1D553}",bowtie:"\u22C8",boxDL:"\u2557",boxDR:"\u2554",boxDl:"\u2556",boxDr:"\u2553",boxH:"\u2550",boxHD:"\u2566",boxHU:"\u2569",boxHd:"\u2564",boxHu:"\u2567",boxUL:"\u255D",boxUR:"\u255A",boxUl:"\u255C",boxUr:"\u2559",boxV:"\u2551",boxVH:"\u256C",boxVL:"\u2563",boxVR:"\u2560",boxVh:"\u256B",boxVl:"\u2562",boxVr:"\u255F",boxbox:"\u29C9",boxdL:"\u2555",boxdR:"\u2552",boxdl:"\u2510",boxdr:"\u250C",boxhD:"\u2565",boxhU:"\u2568",boxhd:"\u252C",boxhu:"\u2534",boxminus:"\u229F",minusb:"\u229F",boxplus:"\u229E",plusb:"\u229E",boxtimes:"\u22A0",timesb:"\u22A0",boxuL:"\u255B",boxuR:"\u2558",boxul:"\u2518",boxur:"\u2514",boxv:"\u2502",boxvH:"\u256A",boxvL:"\u2561",boxvR:"\u255E",boxvh:"\u253C",boxvl:"\u2524",boxvr:"\u251C",brvbar:"\xA6",bscr:"\u{1D4B7}",bsemi:"\u204F",bsol:"\\",bsolb:"\u29C5",bsolhsub:"\u27C8",bull:"\u2022",bullet:"\u2022",bumpE:"\u2AAE",cacute:"\u0107",cap:"\u2229",capand:"\u2A44",capbrcup:"\u2A49",capcap:"\u2A4B",capcup:"\u2A47",capdot:"\u2A40",caps:"\u2229\uFE00",caret:"\u2041",ccaps:"\u2A4D",ccaron:"\u010D",ccedil:"\xE7",ccirc:"\u0109",ccups:"\u2A4C",ccupssm:"\u2A50",cdot:"\u010B",cemptyv:"\u29B2",cent:"\xA2",cfr:"\u{1D520}",chcy:"\u0447",check:"\u2713",checkmark:"\u2713",chi:"\u03C7",cir:"\u25CB",cirE:"\u29C3",circ:"\u02C6",circeq:"\u2257",cire:"\u2257",circlearrowleft:"\u21BA",olarr:"\u21BA",circlearrowright:"\u21BB",orarr:"\u21BB",circledS:"\u24C8",oS:"\u24C8",circledast:"\u229B",oast:"\u229B",circledcirc:"\u229A",ocir:"\u229A",circleddash:"\u229D",odash:"\u229D",cirfnint:"\u2A10",cirmid:"\u2AEF",cirscir:"\u29C2",clubs:"\u2663",clubsuit:"\u2663",colon:":",comma:",",commat:"@",comp:"\u2201",complement:"\u2201",congdot:"\u2A6D",copf:"\u{1D554}",copysr:"\u2117",crarr:"\u21B5",cross:"\u2717",cscr:"\u{1D4B8}",csub:"\u2ACF",csube:"\u2AD1",csup:"\u2AD0",csupe:"\u2AD2",ctdot:"\u22EF",cudarrl:"\u2938",cudarrr:"\u2935",cuepr:"\u22DE",curlyeqprec:"\u22DE",cuesc:"\u22DF",curlyeqsucc:"\u22DF",cularr:"\u21B6",curvearrowleft:"\u21B6",cularrp:"\u293D",cup:"\u222A",cupbrcap:"\u2A48",cupcap:"\u2A46",cupcup:"\u2A4A",cupdot:"\u228D",cupor:"\u2A45",cups:"\u222A\uFE00",curarr:"\u21B7",curvearrowright:"\u21B7",curarrm:"\u293C",curlyvee:"\u22CE",cuvee:"\u22CE",curlywedge:"\u22CF",cuwed:"\u22CF",curren:"\xA4",cwint:"\u2231",cylcty:"\u232D",dHar:"\u2965",dagger:"\u2020",daleth:"\u2138",dash:"\u2010",hyphen:"\u2010",dbkarow:"\u290F",rBarr:"\u290F",dcaron:"\u010F",dcy:"\u0434",ddarr:"\u21CA",downdownarrows:"\u21CA",ddotseq:"\u2A77",eDDot:"\u2A77",deg:"\xB0",delta:"\u03B4",demptyv:"\u29B1",dfisht:"\u297F",dfr:"\u{1D521}",diamondsuit:"\u2666",diams:"\u2666",digamma:"\u03DD",gammad:"\u03DD",disin:"\u22F2",div:"\xF7",divide:"\xF7",divideontimes:"\u22C7",divonx:"\u22C7",djcy:"\u0452",dlcorn:"\u231E",llcorner:"\u231E",dlcrop:"\u230D",dollar:"$",dopf:"\u{1D555}",doteqdot:"\u2251",eDot:"\u2251",dotminus:"\u2238",minusd:"\u2238",dotplus:"\u2214",plusdo:"\u2214",dotsquare:"\u22A1",sdotb:"\u22A1",drcorn:"\u231F",lrcorner:"\u231F",drcrop:"\u230C",dscr:"\u{1D4B9}",dscy:"\u0455",dsol:"\u29F6",dstrok:"\u0111",dtdot:"\u22F1",dtri:"\u25BF",triangledown:"\u25BF",dwangle:"\u29A6",dzcy:"\u045F",dzigrarr:"\u27FF",eacute:"\xE9",easter:"\u2A6E",ecaron:"\u011B",ecir:"\u2256",eqcirc:"\u2256",ecirc:"\xEA",ecolon:"\u2255",eqcolon:"\u2255",ecy:"\u044D",edot:"\u0117",efDot:"\u2252",fallingdotseq:"\u2252",efr:"\u{1D522}",eg:"\u2A9A",egrave:"\xE8",egs:"\u2A96",eqslantgtr:"\u2A96",egsdot:"\u2A98",el:"\u2A99",elinters:"\u23E7",ell:"\u2113",els:"\u2A95",eqslantless:"\u2A95",elsdot:"\u2A97",emacr:"\u0113",empty:"\u2205",emptyset:"\u2205",emptyv:"\u2205",varnothing:"\u2205",emsp13:"\u2004",emsp14:"\u2005",emsp:"\u2003",eng:"\u014B",ensp:"\u2002",eogon:"\u0119",eopf:"\u{1D556}",epar:"\u22D5",eparsl:"\u29E3",eplus:"\u2A71",epsi:"\u03B5",epsilon:"\u03B5",epsiv:"\u03F5",straightepsilon:"\u03F5",varepsilon:"\u03F5",equals:"=",equest:"\u225F",questeq:"\u225F",equivDD:"\u2A78",eqvparsl:"\u29E5",erDot:"\u2253",risingdotseq:"\u2253",erarr:"\u2971",escr:"\u212F",eta:"\u03B7",eth:"\xF0",euml:"\xEB",euro:"\u20AC",excl:"!",fcy:"\u0444",female:"\u2640",ffilig:"\uFB03",fflig:"\uFB00",ffllig:"\uFB04",ffr:"\u{1D523}",filig:"\uFB01",fjlig:"fj",flat:"\u266D",fllig:"\uFB02",fltns:"\u25B1",fnof:"\u0192",fopf:"\u{1D557}",fork:"\u22D4",pitchfork:"\u22D4",forkv:"\u2AD9",fpartint:"\u2A0D",frac12:"\xBD",half:"\xBD",frac13:"\u2153",frac14:"\xBC",frac15:"\u2155",frac16:"\u2159",frac18:"\u215B",frac23:"\u2154",frac25:"\u2156",frac34:"\xBE",frac35:"\u2157",frac38:"\u215C",frac45:"\u2158",frac56:"\u215A",frac58:"\u215D",frac78:"\u215E",frasl:"\u2044",frown:"\u2322",sfrown:"\u2322",fscr:"\u{1D4BB}",gEl:"\u2A8C",gtreqqless:"\u2A8C",gacute:"\u01F5",gamma:"\u03B3",gap:"\u2A86",gtrapprox:"\u2A86",gbreve:"\u011F",gcirc:"\u011D",gcy:"\u0433",gdot:"\u0121",gescc:"\u2AA9",gesdot:"\u2A80",gesdoto:"\u2A82",gesdotol:"\u2A84",gesl:"\u22DB\uFE00",gesles:"\u2A94",gfr:"\u{1D524}",gimel:"\u2137",gjcy:"\u0453",glE:"\u2A92",gla:"\u2AA5",glj:"\u2AA4",gnE:"\u2269",gneqq:"\u2269",gnap:"\u2A8A",gnapprox:"\u2A8A",gne:"\u2A88",gneq:"\u2A88",gnsim:"\u22E7",gopf:"\u{1D558}",gscr:"\u210A",gsime:"\u2A8E",gsiml:"\u2A90",gtcc:"\u2AA7",gtcir:"\u2A7A",gtdot:"\u22D7",gtrdot:"\u22D7",gtlPar:"\u2995",gtquest:"\u2A7C",gtrarr:"\u2978",gvertneqq:"\u2269\uFE00",gvnE:"\u2269\uFE00",hardcy:"\u044A",harrcir:"\u2948",harrw:"\u21AD",leftrightsquigarrow:"\u21AD",hbar:"\u210F",hslash:"\u210F",planck:"\u210F",plankv:"\u210F",hcirc:"\u0125",hearts:"\u2665",heartsuit:"\u2665",hellip:"\u2026",mldr:"\u2026",hercon:"\u22B9",hfr:"\u{1D525}",hksearow:"\u2925",searhk:"\u2925",hkswarow:"\u2926",swarhk:"\u2926",hoarr:"\u21FF",homtht:"\u223B",hookleftarrow:"\u21A9",larrhk:"\u21A9",hookrightarrow:"\u21AA",rarrhk:"\u21AA",hopf:"\u{1D559}",horbar:"\u2015",hscr:"\u{1D4BD}",hstrok:"\u0127",hybull:"\u2043",iacute:"\xED",icirc:"\xEE",icy:"\u0438",iecy:"\u0435",iexcl:"\xA1",ifr:"\u{1D526}",igrave:"\xEC",iiiint:"\u2A0C",qint:"\u2A0C",iiint:"\u222D",tint:"\u222D",iinfin:"\u29DC",iiota:"\u2129",ijlig:"\u0133",imacr:"\u012B",imath:"\u0131",inodot:"\u0131",imof:"\u22B7",imped:"\u01B5",incare:"\u2105",infin:"\u221E",infintie:"\u29DD",intcal:"\u22BA",intercal:"\u22BA",intlarhk:"\u2A17",intprod:"\u2A3C",iprod:"\u2A3C",iocy:"\u0451",iogon:"\u012F",iopf:"\u{1D55A}",iota:"\u03B9",iquest:"\xBF",iscr:"\u{1D4BE}",isinE:"\u22F9",isindot:"\u22F5",isins:"\u22F4",isinsv:"\u22F3",itilde:"\u0129",iukcy:"\u0456",iuml:"\xEF",jcirc:"\u0135",jcy:"\u0439",jfr:"\u{1D527}",jmath:"\u0237",jopf:"\u{1D55B}",jscr:"\u{1D4BF}",jsercy:"\u0458",jukcy:"\u0454",kappa:"\u03BA",kappav:"\u03F0",varkappa:"\u03F0",kcedil:"\u0137",kcy:"\u043A",kfr:"\u{1D528}",kgreen:"\u0138",khcy:"\u0445",kjcy:"\u045C",kopf:"\u{1D55C}",kscr:"\u{1D4C0}",lAtail:"\u291B",lBarr:"\u290E",lEg:"\u2A8B",lesseqqgtr:"\u2A8B",lHar:"\u2962",lacute:"\u013A",laemptyv:"\u29B4",lambda:"\u03BB",langd:"\u2991",lap:"\u2A85",lessapprox:"\u2A85",laquo:"\xAB",larrbfs:"\u291F",larrfs:"\u291D",larrlp:"\u21AB",looparrowleft:"\u21AB",larrpl:"\u2939",larrsim:"\u2973",larrtl:"\u21A2",leftarrowtail:"\u21A2",lat:"\u2AAB",latail:"\u2919",late:"\u2AAD",lates:"\u2AAD\uFE00",lbarr:"\u290C",lbbrk:"\u2772",lbrace:"{",lcub:"{",lbrack:"[",lsqb:"[",lbrke:"\u298B",lbrksld:"\u298F",lbrkslu:"\u298D",lcaron:"\u013E",lcedil:"\u013C",lcy:"\u043B",ldca:"\u2936",ldrdhar:"\u2967",ldrushar:"\u294B",ldsh:"\u21B2",le:"\u2264",leq:"\u2264",leftleftarrows:"\u21C7",llarr:"\u21C7",leftthreetimes:"\u22CB",lthree:"\u22CB",lescc:"\u2AA8",lesdot:"\u2A7F",lesdoto:"\u2A81",lesdotor:"\u2A83",lesg:"\u22DA\uFE00",lesges:"\u2A93",lessdot:"\u22D6",ltdot:"\u22D6",lfisht:"\u297C",lfr:"\u{1D529}",lgE:"\u2A91",lharul:"\u296A",lhblk:"\u2584",ljcy:"\u0459",llhard:"\u296B",lltri:"\u25FA",lmidot:"\u0140",lmoust:"\u23B0",lmoustache:"\u23B0",lnE:"\u2268",lneqq:"\u2268",lnap:"\u2A89",lnapprox:"\u2A89",lne:"\u2A87",lneq:"\u2A87",lnsim:"\u22E6",loang:"\u27EC",loarr:"\u21FD",longmapsto:"\u27FC",xmap:"\u27FC",looparrowright:"\u21AC",rarrlp:"\u21AC",lopar:"\u2985",lopf:"\u{1D55D}",loplus:"\u2A2D",lotimes:"\u2A34",lowast:"\u2217",loz:"\u25CA",lozenge:"\u25CA",lpar:"(",lparlt:"\u2993",lrhard:"\u296D",lrm:"\u200E",lrtri:"\u22BF",lsaquo:"\u2039",lscr:"\u{1D4C1}",lsime:"\u2A8D",lsimg:"\u2A8F",lsquor:"\u201A",sbquo:"\u201A",lstrok:"\u0142",ltcc:"\u2AA6",ltcir:"\u2A79",ltimes:"\u22C9",ltlarr:"\u2976",ltquest:"\u2A7B",ltrPar:"\u2996",ltri:"\u25C3",triangleleft:"\u25C3",lurdshar:"\u294A",luruhar:"\u2966",lvertneqq:"\u2268\uFE00",lvnE:"\u2268\uFE00",mDDot:"\u223A",macr:"\xAF",strns:"\xAF",male:"\u2642",malt:"\u2720",maltese:"\u2720",marker:"\u25AE",mcomma:"\u2A29",mcy:"\u043C",mdash:"\u2014",mfr:"\u{1D52A}",mho:"\u2127",micro:"\xB5",midcir:"\u2AF0",minus:"\u2212",minusdu:"\u2A2A",mlcp:"\u2ADB",models:"\u22A7",mopf:"\u{1D55E}",mscr:"\u{1D4C2}",mu:"\u03BC",multimap:"\u22B8",mumap:"\u22B8",nGg:"\u22D9\u0338",nGt:"\u226B\u20D2",nLeftarrow:"\u21CD",nlArr:"\u21CD",nLeftrightarrow:"\u21CE",nhArr:"\u21CE",nLl:"\u22D8\u0338",nLt:"\u226A\u20D2",nRightarrow:"\u21CF",nrArr:"\u21CF",nVDash:"\u22AF",nVdash:"\u22AE",nacute:"\u0144",nang:"\u2220\u20D2",napE:"\u2A70\u0338",napid:"\u224B\u0338",napos:"\u0149",natur:"\u266E",natural:"\u266E",ncap:"\u2A43",ncaron:"\u0148",ncedil:"\u0146",ncongdot:"\u2A6D\u0338",ncup:"\u2A42",ncy:"\u043D",ndash:"\u2013",neArr:"\u21D7",nearhk:"\u2924",nedot:"\u2250\u0338",nesear:"\u2928",toea:"\u2928",nfr:"\u{1D52B}",nharr:"\u21AE",nleftrightarrow:"\u21AE",nhpar:"\u2AF2",nis:"\u22FC",nisd:"\u22FA",njcy:"\u045A",nlE:"\u2266\u0338",nleqq:"\u2266\u0338",nlarr:"\u219A",nleftarrow:"\u219A",nldr:"\u2025",nopf:"\u{1D55F}",not:"\xAC",notinE:"\u22F9\u0338",notindot:"\u22F5\u0338",notinvb:"\u22F7",notinvc:"\u22F6",notnivb:"\u22FE",notnivc:"\u22FD",nparsl:"\u2AFD\u20E5",npart:"\u2202\u0338",npolint:"\u2A14",nrarr:"\u219B",nrightarrow:"\u219B",nrarrc:"\u2933\u0338",nrarrw:"\u219D\u0338",nscr:"\u{1D4C3}",nsub:"\u2284",nsubE:"\u2AC5\u0338",nsubseteqq:"\u2AC5\u0338",nsup:"\u2285",nsupE:"\u2AC6\u0338",nsupseteqq:"\u2AC6\u0338",ntilde:"\xF1",nu:"\u03BD",num:"#",numero:"\u2116",numsp:"\u2007",nvDash:"\u22AD",nvHarr:"\u2904",nvap:"\u224D\u20D2",nvdash:"\u22AC",nvge:"\u2265\u20D2",nvgt:">\u20D2",nvinfin:"\u29DE",nvlArr:"\u2902",nvle:"\u2264\u20D2",nvlt:"<\u20D2",nvltrie:"\u22B4\u20D2",nvrArr:"\u2903",nvrtrie:"\u22B5\u20D2",nvsim:"\u223C\u20D2",nwArr:"\u21D6",nwarhk:"\u2923",nwnear:"\u2927",oacute:"\xF3",ocirc:"\xF4",ocy:"\u043E",odblac:"\u0151",odiv:"\u2A38",odsold:"\u29BC",oelig:"\u0153",ofcir:"\u29BF",ofr:"\u{1D52C}",ogon:"\u02DB",ograve:"\xF2",ogt:"\u29C1",ohbar:"\u29B5",olcir:"\u29BE",olcross:"\u29BB",olt:"\u29C0",omacr:"\u014D",omega:"\u03C9",omicron:"\u03BF",omid:"\u29B6",oopf:"\u{1D560}",opar:"\u29B7",operp:"\u29B9",or:"\u2228",vee:"\u2228",ord:"\u2A5D",order:"\u2134",orderof:"\u2134",oscr:"\u2134",ordf:"\xAA",ordm:"\xBA",origof:"\u22B6",oror:"\u2A56",orslope:"\u2A57",orv:"\u2A5B",oslash:"\xF8",osol:"\u2298",otilde:"\xF5",otimesas:"\u2A36",ouml:"\xF6",ovbar:"\u233D",para:"\xB6",parsim:"\u2AF3",parsl:"\u2AFD",pcy:"\u043F",percnt:"%",period:".",permil:"\u2030",pertenk:"\u2031",pfr:"\u{1D52D}",phi:"\u03C6",phiv:"\u03D5",straightphi:"\u03D5",varphi:"\u03D5",phone:"\u260E",pi:"\u03C0",piv:"\u03D6",varpi:"\u03D6",planckh:"\u210E",plus:"+",plusacir:"\u2A23",pluscir:"\u2A22",plusdu:"\u2A25",pluse:"\u2A72",plussim:"\u2A26",plustwo:"\u2A27",pointint:"\u2A15",popf:"\u{1D561}",pound:"\xA3",prE:"\u2AB3",prap:"\u2AB7",precapprox:"\u2AB7",precnapprox:"\u2AB9",prnap:"\u2AB9",precneqq:"\u2AB5",prnE:"\u2AB5",precnsim:"\u22E8",prnsim:"\u22E8",prime:"\u2032",profalar:"\u232E",profline:"\u2312",profsurf:"\u2313",prurel:"\u22B0",pscr:"\u{1D4C5}",psi:"\u03C8",puncsp:"\u2008",qfr:"\u{1D52E}",qopf:"\u{1D562}",qprime:"\u2057",qscr:"\u{1D4C6}",quatint:"\u2A16",quest:"?",rAtail:"\u291C",rHar:"\u2964",race:"\u223D\u0331",racute:"\u0155",raemptyv:"\u29B3",rangd:"\u2992",range:"\u29A5",raquo:"\xBB",rarrap:"\u2975",rarrbfs:"\u2920",rarrc:"\u2933",rarrfs:"\u291E",rarrpl:"\u2945",rarrsim:"\u2974",rarrtl:"\u21A3",rightarrowtail:"\u21A3",rarrw:"\u219D",rightsquigarrow:"\u219D",ratail:"\u291A",ratio:"\u2236",rbbrk:"\u2773",rbrace:"}",rcub:"}",rbrack:"]",rsqb:"]",rbrke:"\u298C",rbrksld:"\u298E",rbrkslu:"\u2990",rcaron:"\u0159",rcedil:"\u0157",rcy:"\u0440",rdca:"\u2937",rdldhar:"\u2969",rdsh:"\u21B3",rect:"\u25AD",rfisht:"\u297D",rfr:"\u{1D52F}",rharul:"\u296C",rho:"\u03C1",rhov:"\u03F1",varrho:"\u03F1",rightrightarrows:"\u21C9",rrarr:"\u21C9",rightthreetimes:"\u22CC",rthree:"\u22CC",ring:"\u02DA",rlm:"\u200F",rmoust:"\u23B1",rmoustache:"\u23B1",rnmid:"\u2AEE",roang:"\u27ED",roarr:"\u21FE",ropar:"\u2986",ropf:"\u{1D563}",roplus:"\u2A2E",rotimes:"\u2A35",rpar:")",rpargt:"\u2994",rppolint:"\u2A12",rsaquo:"\u203A",rscr:"\u{1D4C7}",rtimes:"\u22CA",rtri:"\u25B9",triangleright:"\u25B9",rtriltri:"\u29CE",ruluhar:"\u2968",rx:"\u211E",sacute:"\u015B",scE:"\u2AB4",scap:"\u2AB8",succapprox:"\u2AB8",scaron:"\u0161",scedil:"\u015F",scirc:"\u015D",scnE:"\u2AB6",succneqq:"\u2AB6",scnap:"\u2ABA",succnapprox:"\u2ABA",scnsim:"\u22E9",succnsim:"\u22E9",scpolint:"\u2A13",scy:"\u0441",sdot:"\u22C5",sdote:"\u2A66",seArr:"\u21D8",sect:"\xA7",semi:";",seswar:"\u2929",tosa:"\u2929",sext:"\u2736",sfr:"\u{1D530}",sharp:"\u266F",shchcy:"\u0449",shcy:"\u0448",shy:"\xAD",sigma:"\u03C3",sigmaf:"\u03C2",sigmav:"\u03C2",varsigma:"\u03C2",simdot:"\u2A6A",simg:"\u2A9E",simgE:"\u2AA0",siml:"\u2A9D",simlE:"\u2A9F",simne:"\u2246",simplus:"\u2A24",simrarr:"\u2972",smashp:"\u2A33",smeparsl:"\u29E4",smile:"\u2323",ssmile:"\u2323",smt:"\u2AAA",smte:"\u2AAC",smtes:"\u2AAC\uFE00",softcy:"\u044C",sol:"/",solb:"\u29C4",solbar:"\u233F",sopf:"\u{1D564}",spades:"\u2660",spadesuit:"\u2660",sqcaps:"\u2293\uFE00",sqcups:"\u2294\uFE00",sscr:"\u{1D4C8}",star:"\u2606",sub:"\u2282",subset:"\u2282",subE:"\u2AC5",subseteqq:"\u2AC5",subdot:"\u2ABD",subedot:"\u2AC3",submult:"\u2AC1",subnE:"\u2ACB",subsetneqq:"\u2ACB",subne:"\u228A",subsetneq:"\u228A",subplus:"\u2ABF",subrarr:"\u2979",subsim:"\u2AC7",subsub:"\u2AD5",subsup:"\u2AD3",sung:"\u266A",sup1:"\xB9",sup2:"\xB2",sup3:"\xB3",supE:"\u2AC6",supseteqq:"\u2AC6",supdot:"\u2ABE",supdsub:"\u2AD8",supedot:"\u2AC4",suphsol:"\u27C9",suphsub:"\u2AD7",suplarr:"\u297B",supmult:"\u2AC2",supnE:"\u2ACC",supsetneqq:"\u2ACC",supne:"\u228B",supsetneq:"\u228B",supplus:"\u2AC0",supsim:"\u2AC8",supsub:"\u2AD4",supsup:"\u2AD6",swArr:"\u21D9",swnwar:"\u292A",szlig:"\xDF",target:"\u2316",tau:"\u03C4",tcaron:"\u0165",tcedil:"\u0163",tcy:"\u0442",telrec:"\u2315",tfr:"\u{1D531}",theta:"\u03B8",thetasym:"\u03D1",thetav:"\u03D1",vartheta:"\u03D1",thorn:"\xFE",times:"\xD7",timesbar:"\u2A31",timesd:"\u2A30",topbot:"\u2336",topcir:"\u2AF1",topf:"\u{1D565}",topfork:"\u2ADA",tprime:"\u2034",triangle:"\u25B5",utri:"\u25B5",triangleq:"\u225C",trie:"\u225C",tridot:"\u25EC",triminus:"\u2A3A",triplus:"\u2A39",trisb:"\u29CD",tritime:"\u2A3B",trpezium:"\u23E2",tscr:"\u{1D4C9}",tscy:"\u0446",tshcy:"\u045B",tstrok:"\u0167",uHar:"\u2963",uacute:"\xFA",ubrcy:"\u045E",ubreve:"\u016D",ucirc:"\xFB",ucy:"\u0443",udblac:"\u0171",ufisht:"\u297E",ufr:"\u{1D532}",ugrave:"\xF9",uhblk:"\u2580",ulcorn:"\u231C",ulcorner:"\u231C",ulcrop:"\u230F",ultri:"\u25F8",umacr:"\u016B",uogon:"\u0173",uopf:"\u{1D566}",upsi:"\u03C5",upsilon:"\u03C5",upuparrows:"\u21C8",uuarr:"\u21C8",urcorn:"\u231D",urcorner:"\u231D",urcrop:"\u230E",uring:"\u016F",urtri:"\u25F9",uscr:"\u{1D4CA}",utdot:"\u22F0",utilde:"\u0169",uuml:"\xFC",uwangle:"\u29A7",vBar:"\u2AE8",vBarv:"\u2AE9",vangrt:"\u299C",varsubsetneq:"\u228A\uFE00",vsubne:"\u228A\uFE00",varsubsetneqq:"\u2ACB\uFE00",vsubnE:"\u2ACB\uFE00",varsupsetneq:"\u228B\uFE00",vsupne:"\u228B\uFE00",varsupsetneqq:"\u2ACC\uFE00",vsupnE:"\u2ACC\uFE00",vcy:"\u0432",veebar:"\u22BB",veeeq:"\u225A",vellip:"\u22EE",vfr:"\u{1D533}",vopf:"\u{1D567}",vscr:"\u{1D4CB}",vzigzag:"\u299A",wcirc:"\u0175",wedbar:"\u2A5F",wedgeq:"\u2259",weierp:"\u2118",wp:"\u2118",wfr:"\u{1D534}",wopf:"\u{1D568}",wscr:"\u{1D4CC}",xfr:"\u{1D535}",xi:"\u03BE",xnis:"\u22FB",xopf:"\u{1D569}",xscr:"\u{1D4CD}",yacute:"\xFD",yacy:"\u044F",ycirc:"\u0177",ycy:"\u044B",yen:"\xA5",yfr:"\u{1D536}",yicy:"\u0457",yopf:"\u{1D56A}",yscr:"\u{1D4CE}",yucy:"\u044E",yuml:"\xFF",zacute:"\u017A",zcaron:"\u017E",zcy:"\u0437",zdot:"\u017C",zeta:"\u03B6",zfr:"\u{1D537}",zhcy:"\u0436",zigrarr:"\u21DD",zopf:"\u{1D56B}",zscr:"\u{1D4CF}",zwj:"\u200D",zwnj:"\u200C"},dz="\uE500";Ww.ngsp=dz;var Lv=class extends si{constructor(t,i,r){super(r,t),this.tokenType=i}},GA=class{constructor(t,i,r){this.tokens=t,this.errors=i,this.nonNormalizedIcuExpressions=r}};function Ase(e,t,i,r={}){let n=new WA(new Tw(e,t),i,r);return n.tokenize(),new GA(Fse(n.tokens),n.errors,n.nonNormalizedIcuExpressions)}var Dse=/\r\n?/g;function Dv(e){return`Unexpected character "${e===oa?"EOF":String.fromCharCode(e)}"`}function nV(e){return`Unknown entity "${e}" - use the "&#<decimal>;" or  "&#x<hex>;" syntax`}function Ise(e,t){return`Unable to parse entity "${t}" - ${e} character reference entities must end with ";"`}var $A=function(e){return e.HEX="hexadecimal",e.DEC="decimal",e}($A||{}),Bv=class{constructor(t){this.error=t}},WA=class{constructor(t,i,r){this._getTagDefinition=i,this._currentTokenStart=null,this._currentTokenType=null,this._expansionCaseStack=[],this._inInterpolation=!1,this.tokens=[],this.errors=[],this.nonNormalizedIcuExpressions=[],this._tokenizeIcu=r.tokenizeExpansionForms||!1,this._interpolationConfig=r.interpolationConfig||zl,this._leadingTriviaCodePoints=r.leadingTriviaChars&&r.leadingTriviaChars.map(o=>o.codePointAt(0)||0);let n=r.range||{endPos:t.content.length,startPos:0,startLine:0,startCol:0};this._cursor=r.escapedString?new qA(t,n):new qw(t,n),this._preserveLineEndings=r.preserveLineEndings||!1,this._i18nNormalizeLineEndingsInICUs=r.i18nNormalizeLineEndingsInICUs||!1,this._tokenizeBlocks=r.tokenizeBlocks??!0;try{this._cursor.init()}catch(o){this.handleError(o)}}_processCarriageReturns(t){return this._preserveLineEndings?t:t.replace(Dse,`
`)}tokenize(){for(;this._cursor.peek()!==oa;){let t=this._cursor.clone();try{this._attemptCharCode(Vf)?this._attemptCharCode(dA)?this._attemptCharCode(qf)?this._consumeCdata(t):this._attemptCharCode(Ew)?this._consumeComment(t):this._consumeDocType(t):this._attemptCharCode(Pc)?this._consumeTagClose(t):this._consumeTagOpen(t):this._tokenizeBlocks&&this._attemptCharCode(T8)?this._consumeBlockStart(t):this._tokenizeBlocks&&!this._inInterpolation&&!this._isInExpansionCase()&&!this._isInExpansionForm()&&this._attemptCharCode(Pa)?this._consumeBlockEnd(t):this._tokenizeIcu&&this._tokenizeExpansionForm()||this._consumeWithInterpolation(5,8,()=>this._isTextEnd(),()=>this._isTagStart())}catch(i){this.handleError(i)}}this._beginToken(29),this._endToken([])}_getBlockName(){let t=!1,i=this._cursor.clone();return this._attemptCharCodeUntilFn(r=>l1(r)?!t:Rse(r)?(t=!0,!1):!0),this._cursor.getChars(i).trim()}_consumeBlockStart(t){this._beginToken(24,t);let i=this._endToken([this._getBlockName()]);if(this._cursor.peek()===Fc)if(this._cursor.advance(),this._consumeBlockParameters(),this._attemptCharCodeUntilFn(Io),this._attemptCharCode(ml))this._attemptCharCodeUntilFn(Io);else{i.type=28;return}this._attemptCharCode(Ul)?(this._beginToken(25),this._endToken([])):i.type=28}_consumeBlockEnd(t){this._beginToken(26,t),this._endToken([])}_consumeBlockParameters(){for(this._attemptCharCodeUntilFn(sV);this._cursor.peek()!==ml&&this._cursor.peek()!==oa;){this._beginToken(27);let t=this._cursor.clone(),i=null,r=0;for(;this._cursor.peek()!==gl&&this._cursor.peek()!==oa||i!==null;){let n=this._cursor.peek();if(n===Cw)this._cursor.advance();else if(n===i)i=null;else if(i===null&&Sw(n))i=n;else if(n===Fc&&i===null)r++;else if(n===ml&&i===null){if(r===0)break;r>0&&r--}this._cursor.advance()}this._endToken([this._cursor.getChars(t)]),this._attemptCharCodeUntilFn(sV)}}_tokenizeExpansionForm(){if(this.isExpansionFormStart())return this._consumeExpansionFormStart(),!0;if(Nse(this._cursor.peek())&&this._isInExpansionForm())return this._consumeExpansionCaseStart(),!0;if(this._cursor.peek()===Pa){if(this._isInExpansionCase())return this._consumeExpansionCaseEnd(),!0;if(this._isInExpansionForm())return this._consumeExpansionFormEnd(),!0}return!1}_beginToken(t,i=this._cursor.clone()){this._currentTokenStart=i,this._currentTokenType=t}_endToken(t,i){if(this._currentTokenStart===null)throw new Lv("Programming error - attempted to end a token when there was no start to the token",this._currentTokenType,this._cursor.getSpan(i));if(this._currentTokenType===null)throw new Lv("Programming error - attempted to end a token which has no token type",null,this._cursor.getSpan(this._currentTokenStart));let r={type:this._currentTokenType,parts:t,sourceSpan:(i??this._cursor).getSpan(this._currentTokenStart,this._leadingTriviaCodePoints)};return this.tokens.push(r),this._currentTokenStart=null,this._currentTokenType=null,r}_createError(t,i){this._isInExpansionForm()&&(t+=` (Do you have an unescaped "{" in your template? Use "{{ '{' }}") to escape it.)`);let r=new Lv(t,this._currentTokenType,i);return this._currentTokenStart=null,this._currentTokenType=null,new Bv(r)}handleError(t){if(t instanceof m0&&(t=this._createError(t.msg,this._cursor.getSpan(t.cursor))),t instanceof Bv)this.errors.push(t.error);else throw t}_attemptCharCode(t){return this._cursor.peek()===t?(this._cursor.advance(),!0):!1}_attemptCharCodeCaseInsensitive(t){return Ose(this._cursor.peek(),t)?(this._cursor.advance(),!0):!1}_requireCharCode(t){let i=this._cursor.clone();if(!this._attemptCharCode(t))throw this._createError(Dv(this._cursor.peek()),this._cursor.getSpan(i))}_attemptStr(t){let i=t.length;if(this._cursor.charsLeft()<i)return!1;let r=this._cursor.clone();for(let n=0;n<i;n++)if(!this._attemptCharCode(t.charCodeAt(n)))return this._cursor=r,!1;return!0}_attemptStrCaseInsensitive(t){for(let i=0;i<t.length;i++)if(!this._attemptCharCodeCaseInsensitive(t.charCodeAt(i)))return!1;return!0}_requireStr(t){let i=this._cursor.clone();if(!this._attemptStr(t))throw this._createError(Dv(this._cursor.peek()),this._cursor.getSpan(i))}_attemptCharCodeUntilFn(t){for(;!t(this._cursor.peek());)this._cursor.advance()}_requireCharCodeUntilFn(t,i){let r=this._cursor.clone();if(this._attemptCharCodeUntilFn(t),this._cursor.diff(r)<i)throw this._createError(Dv(this._cursor.peek()),this._cursor.getSpan(r))}_attemptUntilChar(t){for(;this._cursor.peek()!==t;)this._cursor.advance()}_readChar(){let t=String.fromCodePoint(this._cursor.peek());return this._cursor.advance(),t}_consumeEntity(t){this._beginToken(9);let i=this._cursor.clone();if(this._cursor.advance(),this._attemptCharCode(D6)){let r=this._attemptCharCode(L6)||this._attemptCharCode(Tne),n=this._cursor.clone();if(this._attemptCharCodeUntilFn(kse),this._cursor.peek()!=gl){this._cursor.advance();let a=r?$A.HEX:$A.DEC;throw this._createError(Ise(a,this._cursor.getChars(i)),this._cursor.getSpan())}let o=this._cursor.getChars(n);this._cursor.advance();try{let a=parseInt(o,r?16:10);this._endToken([String.fromCharCode(a),this._cursor.getChars(i)])}catch{throw this._createError(nV(this._cursor.getChars(i)),this._cursor.getSpan())}}else{let r=this._cursor.clone();if(this._attemptCharCodeUntilFn(Pse),this._cursor.peek()!=gl)this._beginToken(t,i),this._cursor=r,this._endToken(["&"]);else{let n=this._cursor.getChars(r);this._cursor.advance();let o=Ww[n];if(!o)throw this._createError(nV(n),this._cursor.getSpan(i));this._endToken([o,`&${n};`])}}}_consumeRawText(t,i){this._beginToken(t?6:7);let r=[];for(;;){let n=this._cursor.clone(),o=i();if(this._cursor=n,o)break;t&&this._cursor.peek()===ww?(this._endToken([this._processCarriageReturns(r.join(""))]),r.length=0,this._consumeEntity(6),this._beginToken(6)):r.push(this._readChar())}this._endToken([this._processCarriageReturns(r.join(""))])}_consumeComment(t){this._beginToken(10,t),this._requireCharCode(Ew),this._endToken([]),this._consumeRawText(!1,()=>this._attemptStr("-->")),this._beginToken(11),this._requireStr("-->"),this._endToken([])}_consumeCdata(t){this._beginToken(12,t),this._requireStr("CDATA["),this._endToken([]),this._consumeRawText(!1,()=>this._attemptStr("]]>")),this._beginToken(13),this._requireStr("]]>"),this._endToken([])}_consumeDocType(t){this._beginToken(18,t);let i=this._cursor.clone();this._attemptUntilChar(Gd);let r=this._cursor.getChars(i);this._cursor.advance(),this._endToken([r])}_consumePrefixAndName(){let t=this._cursor.clone(),i="";for(;this._cursor.peek()!==$d&&!Mse(this._cursor.peek());)this._cursor.advance();let r;this._cursor.peek()===$d?(i=this._cursor.getChars(t),this._cursor.advance(),r=this._cursor.clone()):r=t,this._requireCharCodeUntilFn(oV,i===""?0:1);let n=this._cursor.getChars(r);return[i,n]}_consumeTagOpen(t){let i,r,n;try{if(!c1(this._cursor.peek()))throw this._createError(Dv(this._cursor.peek()),this._cursor.getSpan(t));for(n=this._consumeTagOpenStart(t),r=n.parts[0],i=n.parts[1],this._attemptCharCodeUntilFn(Io);this._cursor.peek()!==Pc&&this._cursor.peek()!==Gd&&this._cursor.peek()!==Vf&&this._cursor.peek()!==oa;)this._consumeAttributeName(),this._attemptCharCodeUntilFn(Io),this._attemptCharCode(zf)&&(this._attemptCharCodeUntilFn(Io),this._consumeAttributeValue()),this._attemptCharCodeUntilFn(Io);this._consumeTagOpenEnd()}catch(a){if(a instanceof Bv){n?n.type=4:(this._beginToken(5,t),this._endToken(["<"]));return}throw a}let o=this._getTagDefinition(i).getContentType(r);o===Vl.RAW_TEXT?this._consumeRawTextWithTagClose(r,i,!1):o===Vl.ESCAPABLE_RAW_TEXT&&this._consumeRawTextWithTagClose(r,i,!0)}_consumeRawTextWithTagClose(t,i,r){this._consumeRawText(r,()=>!this._attemptCharCode(Vf)||!this._attemptCharCode(Pc)||(this._attemptCharCodeUntilFn(Io),!this._attemptStrCaseInsensitive(i))?!1:(this._attemptCharCodeUntilFn(Io),this._attemptCharCode(Gd))),this._beginToken(3),this._requireCharCodeUntilFn(n=>n===Gd,3),this._cursor.advance(),this._endToken([t,i])}_consumeTagOpenStart(t){this._beginToken(0,t);let i=this._consumePrefixAndName();return this._endToken(i)}_consumeAttributeName(){let t=this._cursor.peek();if(t===i0||t===t0)throw this._createError(Dv(t),this._cursor.getSpan());this._beginToken(14);let i=this._consumePrefixAndName();this._endToken(i)}_consumeAttributeValue(){if(this._cursor.peek()===i0||this._cursor.peek()===t0){let t=this._cursor.peek();this._consumeQuote(t);let i=()=>this._cursor.peek()===t;this._consumeWithInterpolation(16,17,i,i),this._consumeQuote(t)}else{let t=()=>oV(this._cursor.peek());this._consumeWithInterpolation(16,17,t,t)}}_consumeQuote(t){this._beginToken(15),this._requireCharCode(t),this._endToken([String.fromCodePoint(t)])}_consumeTagOpenEnd(){let t=this._attemptCharCode(Pc)?2:1;this._beginToken(t),this._requireCharCode(Gd),this._endToken([])}_consumeTagClose(t){this._beginToken(3,t),this._attemptCharCodeUntilFn(Io);let i=this._consumePrefixAndName();this._attemptCharCodeUntilFn(Io),this._requireCharCode(Gd),this._endToken(i)}_consumeExpansionFormStart(){this._beginToken(19),this._requireCharCode(Ul),this._endToken([]),this._expansionCaseStack.push(19),this._beginToken(7);let t=this._readUntil(zs),i=this._processCarriageReturns(t);if(this._i18nNormalizeLineEndingsInICUs)this._endToken([i]);else{let n=this._endToken([t]);i!==t&&this.nonNormalizedIcuExpressions.push(n)}this._requireCharCode(zs),this._attemptCharCodeUntilFn(Io),this._beginToken(7);let r=this._readUntil(zs);this._endToken([r]),this._requireCharCode(zs),this._attemptCharCodeUntilFn(Io)}_consumeExpansionCaseStart(){this._beginToken(20);let t=this._readUntil(Ul).trim();this._endToken([t]),this._attemptCharCodeUntilFn(Io),this._beginToken(21),this._requireCharCode(Ul),this._endToken([]),this._attemptCharCodeUntilFn(Io),this._expansionCaseStack.push(21)}_consumeExpansionCaseEnd(){this._beginToken(22),this._requireCharCode(Pa),this._endToken([]),this._attemptCharCodeUntilFn(Io),this._expansionCaseStack.pop()}_consumeExpansionFormEnd(){this._beginToken(23),this._requireCharCode(Pa),this._endToken([]),this._expansionCaseStack.pop()}_consumeWithInterpolation(t,i,r,n){this._beginToken(t);let o=[];for(;!r();){let a=this._cursor.clone();this._interpolationConfig&&this._attemptStr(this._interpolationConfig.start)?(this._endToken([this._processCarriageReturns(o.join(""))],a),o.length=0,this._consumeInterpolation(i,a,n),this._beginToken(t)):this._cursor.peek()===ww?(this._endToken([this._processCarriageReturns(o.join(""))]),o.length=0,this._consumeEntity(t),this._beginToken(t)):o.push(this._readChar())}this._inInterpolation=!1,this._endToken([this._processCarriageReturns(o.join(""))])}_consumeInterpolation(t,i,r){let n=[];this._beginToken(t,i),n.push(this._interpolationConfig.start);let o=this._cursor.clone(),a=null,s=!1;for(;this._cursor.peek()!==oa&&(r===null||!r());){let c=this._cursor.clone();if(this._isTagStart()){this._cursor=c,n.push(this._getProcessedChars(o,c)),this._endToken(n);return}if(a===null)if(this._attemptStr(this._interpolationConfig.end)){n.push(this._getProcessedChars(o,c)),n.push(this._interpolationConfig.end),this._endToken(n);return}else this._attemptStr("//")&&(s=!0);let l=this._cursor.peek();this._cursor.advance(),l===Cw?this._cursor.advance():l===a?a=null:!s&&a===null&&Sw(l)&&(a=l)}n.push(this._getProcessedChars(o,this._cursor)),this._endToken(n)}_getProcessedChars(t,i){return this._processCarriageReturns(i.getChars(t))}_isTextEnd(){return!!(this._isTagStart()||this._cursor.peek()===oa||this._tokenizeIcu&&!this._inInterpolation&&(this.isExpansionFormStart()||this._cursor.peek()===Pa&&this._isInExpansionCase())||this._tokenizeBlocks&&!this._inInterpolation&&!this._isInExpansion()&&(this._cursor.peek()===T8||this._cursor.peek()===Pa))}_isTagStart(){if(this._cursor.peek()===Vf){let t=this._cursor.clone();t.advance();let i=t.peek();if($h<=i&&i<=T0||mm<=i&&i<=a1||i===Pc||i===dA)return!0}return!1}_readUntil(t){let i=this._cursor.clone();return this._attemptUntilChar(t),this._cursor.getChars(i)}_isInExpansion(){return this._isInExpansionCase()||this._isInExpansionForm()}_isInExpansionCase(){return this._expansionCaseStack.length>0&&this._expansionCaseStack[this._expansionCaseStack.length-1]===21}_isInExpansionForm(){return this._expansionCaseStack.length>0&&this._expansionCaseStack[this._expansionCaseStack.length-1]===19}isExpansionFormStart(){if(this._cursor.peek()!==Ul)return!1;if(this._interpolationConfig){let t=this._cursor.clone(),i=this._attemptStr(this._interpolationConfig.start);return this._cursor=t,!i}return!0}};function Io(e){return!l1(e)||e===oa}function oV(e){return l1(e)||e===Gd||e===Vf||e===Pc||e===i0||e===t0||e===zf||e===oa}function Mse(e){return(e<$h||T0<e)&&(e<mm||a1<e)&&(e<LD||e>k6)}function kse(e){return e===gl||e===oa||!kne(e)}function Pse(e){return e===gl||e===oa||!c1(e)}function Nse(e){return e!==Pa}function Ose(e,t){return aV(e)===aV(t)}function aV(e){return e>=$h&&e<=T0?e-$h+mm:e}function Rse(e){return c1(e)||Mc(e)||e===s1}function sV(e){return e!==gl&&Io(e)}function Fse(e){let t=[],i;for(let r=0;r<e.length;r++){let n=e[r];i&&i.type===5&&n.type===5||i&&i.type===16&&n.type===16?(i.parts[0]+=n.parts[0],i.sourceSpan.end=n.sourceSpan.end):(i=n,t.push(i))}return t}var qw=class e{constructor(t,i){if(t instanceof e){this.file=t.file,this.input=t.input,this.end=t.end;let r=t.state;this.state={peek:r.peek,offset:r.offset,line:r.line,column:r.column}}else{if(!i)throw new Error("Programming error: the range argument must be provided with a file argument.");this.file=t,this.input=t.content,this.end=i.endPos,this.state={peek:-1,offset:i.startPos,line:i.startLine,column:i.startCol}}}clone(){return new e(this)}peek(){return this.state.peek}charsLeft(){return this.end-this.state.offset}diff(t){return this.state.offset-t.state.offset}advance(){this.advanceState(this.state)}init(){this.updatePeek(this.state)}getSpan(t,i){t=t||this;let r=t;if(i)for(;this.diff(t)>0&&i.indexOf(t.peek())!==-1;)r===t&&(t=t.clone()),t.advance();let n=this.locationFromCursor(t),o=this.locationFromCursor(this),a=r!==t?this.locationFromCursor(r):n;return new pi(n,o,a)}getChars(t){return this.input.substring(t.state.offset,this.state.offset)}charAt(t){return this.input.charCodeAt(t)}advanceState(t){if(t.offset>=this.end)throw this.state=t,new m0('Unexpected character "EOF"',this);let i=this.charAt(t.offset);i===Nh?(t.line++,t.column=0):V6(i)||t.column++,t.offset++,this.updatePeek(t)}updatePeek(t){t.peek=t.offset>=this.end?oa:this.charAt(t.offset)}locationFromCursor(t){return new r0(t.file,t.state.offset,t.state.line,t.state.column)}},qA=class e extends qw{constructor(t,i){t instanceof e?(super(t),this.internalState=L({},t.internalState)):(super(t,i),this.internalState=this.state)}advance(){this.state=this.internalState,super.advance(),this.processEscapeSequence()}init(){super.init(),this.processEscapeSequence()}clone(){return new e(this)}getChars(t){let i=t.clone(),r="";for(;i.internalState.offset<this.internalState.offset;)r+=String.fromCodePoint(i.peek()),i.advance();return r}processEscapeSequence(){let t=()=>this.internalState.peek;if(t()===Cw)if(this.internalState=L({},this.state),this.advanceState(this.internalState),t()===P6)this.state.peek=Nh;else if(t()===N6)this.state.peek=FD;else if(t()===F6)this.state.peek=S6;else if(t()===O6)this.state.peek=RD;else if(t()===Dne)this.state.peek=yne;else if(t()===BD)this.state.peek=T6;else if(t()===R6)if(this.advanceState(this.internalState),t()===Ul){this.advanceState(this.internalState);let i=this.clone(),r=0;for(;t()!==Pa;)this.advanceState(this.internalState),r++;this.state.peek=this.decodeHexDigits(i,r)}else{let i=this.clone();this.advanceState(this.internalState),this.advanceState(this.internalState),this.advanceState(this.internalState),this.state.peek=this.decodeHexDigits(i,4)}else if(t()===L6){this.advanceState(this.internalState);let i=this.clone();this.advanceState(this.internalState),this.state.peek=this.decodeHexDigits(i,2)}else if(A8(t())){let i="",r=0,n=this.clone();for(;A8(t())&&r<3;)n=this.clone(),i+=String.fromCodePoint(t()),this.advanceState(this.internalState),r++;this.state.peek=parseInt(i,8),this.internalState=n.internalState}else V6(this.internalState.peek)?(this.advanceState(this.internalState),this.state=this.internalState):this.state.peek=this.internalState.peek}decodeHexDigits(t,i){let r=this.input.slice(t.internalState.offset,t.internalState.offset+i),n=parseInt(r,16);if(isNaN(n))throw t.state=t.internalState,new m0("Invalid hexadecimal escape sequence",t);return n}},m0=class{constructor(t,i){this.msg=t,this.cursor=i}},Ma=class e extends si{static create(t,i,r){return new e(t,i,r)}constructor(t,i,r){super(i,r),this.elementName=t}},Xw=class{constructor(t,i){this.rootNodes=t,this.errors=i}},XA=class{constructor(t){this.getTagDefinition=t}parse(t,i,r){let n=Ase(t,i,this.getTagDefinition,r),o=new YA(n.tokens,this.getTagDefinition);return o.build(),new Xw(o.rootNodes,n.errors.concat(o.errors))}},YA=class e{constructor(t,i){this.tokens=t,this.getTagDefinition=i,this._index=-1,this._containerStack=[],this.rootNodes=[],this.errors=[],this._advance()}build(){for(;this._peek.type!==29;)this._peek.type===0||this._peek.type===4?this._consumeStartTag(this._advance()):this._peek.type===3?this._consumeEndTag(this._advance()):this._peek.type===12?(this._closeVoidElement(),this._consumeCdata(this._advance())):this._peek.type===10?(this._closeVoidElement(),this._consumeComment(this._advance())):this._peek.type===5||this._peek.type===7||this._peek.type===6?(this._closeVoidElement(),this._consumeText(this._advance())):this._peek.type===19?this._consumeExpansion(this._advance()):this._peek.type===24?(this._closeVoidElement(),this._consumeBlockOpen(this._advance())):this._peek.type===26?(this._closeVoidElement(),this._consumeBlockClose(this._advance())):this._peek.type===28?(this._closeVoidElement(),this._consumeIncompleteBlock(this._advance())):this._advance();for(let t of this._containerStack)t instanceof Bs&&this.errors.push(Ma.create(t.name,t.sourceSpan,`Unclosed block "${t.name}"`))}_advance(){let t=this._peek;return this._index<this.tokens.length-1&&this._index++,this._peek=this.tokens[this._index],t}_advanceIf(t){return this._peek.type===t?this._advance():null}_consumeCdata(t){this._consumeText(this._advance()),this._advanceIf(13)}_consumeComment(t){let i=this._advanceIf(7),r=this._advanceIf(11),n=i!=null?i.parts[0].trim():null,o=r==null?t.sourceSpan:new pi(t.sourceSpan.start,r.sourceSpan.end,t.sourceSpan.fullStart);this._addToParent(new f0(n,o))}_consumeExpansion(t){let i=this._advance(),r=this._advance(),n=[];for(;this._peek.type===20;){let a=this._parseExpansionCase();if(!a)return;n.push(a)}if(this._peek.type!==23){this.errors.push(Ma.create(null,this._peek.sourceSpan,"Invalid ICU message. Missing '}'."));return}let o=new pi(t.sourceSpan.start,this._peek.sourceSpan.end,t.sourceSpan.fullStart);this._addToParent(new hm(i.parts[0],r.parts[0],n,o,i.sourceSpan)),this._advance()}_parseExpansionCase(){let t=this._advance();if(this._peek.type!==21)return this.errors.push(Ma.create(null,this._peek.sourceSpan,"Invalid ICU message. Missing '{'.")),null;let i=this._advance(),r=this._collectExpansionExpTokens(i);if(!r)return null;let n=this._advance();r.push({type:29,parts:[],sourceSpan:n.sourceSpan});let o=new e(r,this.getTagDefinition);if(o.build(),o.errors.length>0)return this.errors=this.errors.concat(o.errors),null;let a=new pi(t.sourceSpan.start,n.sourceSpan.end,t.sourceSpan.fullStart),s=new pi(i.sourceSpan.start,n.sourceSpan.end,i.sourceSpan.fullStart);return new BA(t.parts[0],o.rootNodes,a,t.sourceSpan,s)}_collectExpansionExpTokens(t){let i=[],r=[21];for(;;){if((this._peek.type===19||this._peek.type===21)&&r.push(this._peek.type),this._peek.type===22)if(lV(r,21)){if(r.pop(),r.length===0)return i}else return this.errors.push(Ma.create(null,t.sourceSpan,"Invalid ICU message. Missing '}'.")),null;if(this._peek.type===23)if(lV(r,19))r.pop();else return this.errors.push(Ma.create(null,t.sourceSpan,"Invalid ICU message. Missing '}'.")),null;if(this._peek.type===29)return this.errors.push(Ma.create(null,t.sourceSpan,"Invalid ICU message. Missing '}'.")),null;i.push(this._advance())}}_consumeText(t){let i=[t],r=t.sourceSpan,n=t.parts[0];if(n.length>0&&n[0]===`
`){let o=this._getContainer();o!=null&&o.children.length===0&&this.getTagDefinition(o.name).ignoreFirstLf&&(n=n.substring(1),i[0]={type:t.type,sourceSpan:t.sourceSpan,parts:[n]})}for(;this._peek.type===8||this._peek.type===5||this._peek.type===9;)t=this._advance(),i.push(t),t.type===8?n+=t.parts.join("").replace(/&([^;]+);/g,cV):t.type===9?n+=t.parts[0]:n+=t.parts.join("");if(n.length>0){let o=t.sourceSpan;this._addToParent(new ou(n,new pi(r.start,o.end,r.fullStart,r.details),i))}}_closeVoidElement(){let t=this._getContainer();t instanceof Ls&&this.getTagDefinition(t.name).isVoid&&this._containerStack.pop()}_consumeStartTag(t){let[i,r]=t.parts,n=[];for(;this._peek.type===14;)n.push(this._consumeAttr(this._advance()));let o=this._getElementFullName(i,r,this._getClosestParentElement()),a=!1;if(this._peek.type===2){this._advance(),a=!0;let h=this.getTagDefinition(o);h.canSelfClose||eA(o)!==null||h.isVoid||this.errors.push(Ma.create(o,t.sourceSpan,`Only void, custom and foreign elements can be self closed "${t.parts[1]}"`))}else this._peek.type===1&&(this._advance(),a=!1);let s=this._peek.sourceSpan.fullStart,c=new pi(t.sourceSpan.start,s,t.sourceSpan.fullStart),l=new pi(t.sourceSpan.start,s,t.sourceSpan.fullStart),d=new Ls(o,n,[],c,l,void 0),u=this._getContainer();this._pushContainer(d,u instanceof Ls&&this.getTagDefinition(u.name).isClosedByChild(d.name)),a?this._popContainer(o,Ls,c):t.type===4&&(this._popContainer(o,Ls,null),this.errors.push(Ma.create(o,c,`Opening tag "${o}" not terminated.`)))}_pushContainer(t,i){i&&this._containerStack.pop(),this._addToParent(t),this._containerStack.push(t)}_consumeEndTag(t){let i=this._getElementFullName(t.parts[0],t.parts[1],this._getClosestParentElement());if(this.getTagDefinition(i).isVoid)this.errors.push(Ma.create(i,t.sourceSpan,`Void elements do not have end tags "${t.parts[1]}"`));else if(!this._popContainer(i,Ls,t.sourceSpan)){let r=`Unexpected closing tag "${i}". It may happen when the tag has already been closed by another tag. For more info see https://www.w3.org/TR/html5/syntax.html#closing-elements-that-have-implied-end-tags`;this.errors.push(Ma.create(i,t.sourceSpan,r))}}_popContainer(t,i,r){let n=!1;for(let o=this._containerStack.length-1;o>=0;o--){let a=this._containerStack[o];if((a.name===t||t===null)&&a instanceof i)return a.endSourceSpan=r,a.sourceSpan.end=r!==null?r.end:a.sourceSpan.end,this._containerStack.splice(o,this._containerStack.length-o),!n;(a instanceof Bs||a instanceof Ls&&!this.getTagDefinition(a.name).closedByParent)&&(n=!0)}return!1}_consumeAttr(t){let i=tA(t.parts[0],t.parts[1]),r=t.sourceSpan.end;this._peek.type===15&&this._advance();let n="",o=[],a,s;if(this._peek.type===16)for(a=this._peek.sourceSpan,s=this._peek.sourceSpan.end;this._peek.type===16||this._peek.type===17||this._peek.type===9;){let d=this._advance();o.push(d),d.type===17?n+=d.parts.join("").replace(/&([^;]+);/g,cV):d.type===9?n+=d.parts[0]:n+=d.parts.join(""),s=r=d.sourceSpan.end}this._peek.type===15&&(r=this._advance().sourceSpan.end);let l=a&&s&&new pi(a.start,s,a.fullStart);return new VA(i,n,new pi(t.sourceSpan.start,r,t.sourceSpan.fullStart),t.sourceSpan,l,o.length>0?o:void 0,void 0)}_consumeBlockOpen(t){let i=[];for(;this._peek.type===27;){let s=this._advance();i.push(new $w(s.parts[0],s.sourceSpan))}this._peek.type===25&&this._advance();let r=this._peek.sourceSpan.fullStart,n=new pi(t.sourceSpan.start,r,t.sourceSpan.fullStart),o=new pi(t.sourceSpan.start,r,t.sourceSpan.fullStart),a=new Bs(t.parts[0],i,[],n,t.sourceSpan,o);this._pushContainer(a,!1)}_consumeBlockClose(t){this._popContainer(null,Bs,t.sourceSpan)||this.errors.push(Ma.create(null,t.sourceSpan,'Unexpected closing block. The block may have been closed earlier. If you meant to write the } character, you should use the "&#125;" HTML entity instead.'))}_consumeIncompleteBlock(t){let i=[];for(;this._peek.type===27;){let s=this._advance();i.push(new $w(s.parts[0],s.sourceSpan))}let r=this._peek.sourceSpan.fullStart,n=new pi(t.sourceSpan.start,r,t.sourceSpan.fullStart),o=new pi(t.sourceSpan.start,r,t.sourceSpan.fullStart),a=new Bs(t.parts[0],i,[],n,t.sourceSpan,o);this._pushContainer(a,!1),this._popContainer(null,Bs,null),this.errors.push(Ma.create(t.parts[0],n,`Incomplete block "${t.parts[0]}". If you meant to write the @ character, you should use the "&#64;" HTML entity instead.`))}_getContainer(){return this._containerStack.length>0?this._containerStack[this._containerStack.length-1]:null}_getClosestParentElement(){for(let t=this._containerStack.length-1;t>-1;t--)if(this._containerStack[t]instanceof Ls)return this._containerStack[t];return null}_addToParent(t){let i=this._getContainer();i===null?this.rootNodes.push(t):i.children.push(t)}_getElementFullName(t,i,r){if(t===""&&(t=this.getTagDefinition(i).implicitNamespacePrefix||"",t===""&&r!=null)){let n=sa(r.name)[1];this.getTagDefinition(n).preventNamespaceInheritance||(t=eA(r.name))}return tA(t,i)}};function lV(e,t){return e.length>0&&e[e.length-1]===t}function cV(e,t){return Ww[t]!==void 0?Ww[t]||e:/^#x[a-f0-9]+$/i.test(t)?String.fromCodePoint(parseInt(t.slice(2),16)):/^#\d+$/.test(t)?String.fromCodePoint(parseInt(t.slice(1),10)):e}var dV=new Set(["iframe|srcdoc","*|innerhtml","*|outerhtml","embed|src","object|codebase","object|data"]);function uz(e,t){return e=e.toLowerCase(),t=t.toLowerCase(),dV.has(e+"|"+t)||dV.has("*|"+t)}var Lse=(e,t)=>(e instanceof nu&&(t instanceof tm&&e.i18n instanceof Oo&&(t.previousMessage=e.i18n),e.i18n=t),t),Yw=class{constructor(t=zl,i=!1,r=!1,n=bne){this.interpolationConfig=t,this.keepI18nAttrs=i,this.enableI18nLegacyMessageIdFormat=r,this.containerBlocks=n,this.hasI18nMeta=!1,this._errors=[]}_generateI18nMessage(t,i="",r){let{meaning:n,description:o,customId:a}=this._parseMetadata(i),c=yse(this.interpolationConfig,this.containerBlocks)(t,n,o,a,r);return this._setMessageId(c,i),this._setLegacyIds(c,i),c}visitAllWithErrors(t){let i=t.map(r=>r.visit(this,null));return new Xw(i,this._errors)}visitElement(t){let i;if(one(t)){this.hasI18nMeta=!0;let r=[],n={};for(let o of t.attrs)if(o.name===b6){let a=t.i18n||o.value;i=this._generateI18nMessage(t.children,a,Lse),i.nodes.length===0&&(i=void 0),t.i18n=i}else if(o.name.startsWith(lA)){let a=o.name.slice(lA.length);uz(t.name,a)?this._reportError(o,`Translating attribute '${a}' is disallowed for security reasons.`):n[a]=o.value}else r.push(o);if(Object.keys(n).length)for(let o of r){let a=n[o.name];a!==void 0&&o.value&&(o.i18n=this._generateI18nMessage([o],o.i18n||a))}this.keepI18nAttrs||(t.attrs=r)}return nn(this,t.children,i),t}visitExpansion(t,i){let r,n=t.i18n;if(this.hasI18nMeta=!0,n instanceof tm){let o=n.name;r=this._generateI18nMessage([t],n);let a=ND(r);a.name=o,i!==null&&(i.placeholderToMessage[o]=r)}else r=this._generateI18nMessage([t],i||n);return t.i18n=r,t}visitText(t){return t}visitAttribute(t){return t}visitComment(t){return t}visitExpansionCase(t){return t}visitBlock(t,i){return nn(this,t.children,i),t}visitBlockParameter(t,i){return t}_parseMetadata(t){return typeof t=="string"?zse(t):t instanceof Oo?t:{}}_setMessageId(t,i){t.id||(t.id=i instanceof Oo&&i.id||are(t))}_setLegacyIds(t,i){if(this.enableI18nLegacyMessageIdFormat)t.legacyIds=[ore(t),l6(t)];else if(typeof i!="string"){let r=i instanceof Oo?i:i instanceof tm?i.previousMessage:void 0;t.legacyIds=r?r.legacyIds:[]}}_reportError(t,i){this._errors.push(new jA(t.sourceSpan,i))}},Bse="|",Vse="@@";function zse(e=""){let t,i,r;if(e=e.trim(),e){let n=e.indexOf(Vse),o=e.indexOf(Bse),a;[a,t]=n>-1?[e.slice(0,n),e.slice(n+2)]:[e,""],[i,r]=o>-1?[a.slice(0,o),a.slice(o+1)]:["",a]}return{customId:t,meaning:i,description:r}}function Use(e){let t=[];return e.description?t.push({tagName:"desc",text:e.description}):t.push({tagName:"suppress",text:"{msgDescriptions}"}),e.meaning&&t.push({tagName:"meaning",text:e.meaning}),yre(t)}var Hse="goog.getMsg";function hz(e,t,i,r){let n=Gse(t),o=[U(n)];Object.keys(r).length&&(o.push(h0(E0(r,!0),!0)),o.push(h0({original_code:ao(Object.keys(r).map(c=>({key:C0(c),quoted:!0,value:t.placeholders[c]?U(t.placeholders[c].sourceSpan.toString()):U(t.placeholderToMessage[c].nodes.map(l=>l.sourceSpan.toString()).join(""))})))})));let a=i.set(ft(Hse).callFn(o)).toConstDecl();a.addLeadingComment(Use(t));let s=new oo(e.set(i));return[a,s]}var ZA=class{formatPh(t){return`{$${C0(t)}}`}visitText(t){return t.value}visitContainer(t){return t.children.map(i=>i.visit(this)).join("")}visitIcu(t){return sz(t)}visitTagPlaceholder(t){return t.isVoid?this.formatPh(t.startName):`${this.formatPh(t.startName)}${t.children.map(i=>i.visit(this)).join("")}${this.formatPh(t.closeName)}`}visitPlaceholder(t){return this.formatPh(t.name)}visitBlockPlaceholder(t){return`${this.formatPh(t.startName)}${t.children.map(i=>i.visit(this)).join("")}${this.formatPh(t.closeName)}`}visitIcuPlaceholder(t,i){return this.formatPh(t.name)}},jse=new ZA;function Gse(e){return e.nodes.map(t=>t.visit(jse,null)).join("")}function pz(e,t,i){let{messageParts:r,placeHolders:n}=$se(t),o=Wse(t),a=n.map(l=>i[l.text]),s=xre(t,r,n,a,o),c=e.set(s);return[new oo(c)]}var KA=class{constructor(t,i){this.placeholderToMessage=t,this.pieces=i}visitText(t){if(this.pieces[this.pieces.length-1]instanceof kh)this.pieces[this.pieces.length-1].text+=t.value;else{let i=new pi(t.sourceSpan.fullStart,t.sourceSpan.end,t.sourceSpan.fullStart,t.sourceSpan.details);this.pieces.push(new kh(t.value,i))}}visitContainer(t){t.children.forEach(i=>i.visit(this))}visitIcu(t){this.pieces.push(new kh(sz(t),t.sourceSpan))}visitTagPlaceholder(t){this.pieces.push(this.createPlaceholderPiece(t.startName,t.startSourceSpan??t.sourceSpan)),t.isVoid||(t.children.forEach(i=>i.visit(this)),this.pieces.push(this.createPlaceholderPiece(t.closeName,t.endSourceSpan??t.sourceSpan)))}visitPlaceholder(t){this.pieces.push(this.createPlaceholderPiece(t.name,t.sourceSpan))}visitBlockPlaceholder(t){this.pieces.push(this.createPlaceholderPiece(t.startName,t.startSourceSpan??t.sourceSpan)),t.children.forEach(i=>i.visit(this)),this.pieces.push(this.createPlaceholderPiece(t.closeName,t.endSourceSpan??t.sourceSpan))}visitIcuPlaceholder(t){this.pieces.push(this.createPlaceholderPiece(t.name,t.sourceSpan,this.placeholderToMessage[t.name]))}createPlaceholderPiece(t,i,r){return new $f(C0(t,!1),i,r)}};function $se(e){let t=[],i=new KA(e.placeholderToMessage,t);return e.nodes.forEach(r=>r.visit(i)),qse(t)}function Wse(e){let t=e.nodes[0],i=e.nodes[e.nodes.length-1];return new pi(t.sourceSpan.fullStart,i.sourceSpan.end,t.sourceSpan.fullStart,t.sourceSpan.details)}function qse(e){let t=[],i=[];e[0]instanceof $f&&t.push(TT(e[0].sourceSpan.start));for(let r=0;r<e.length;r++){let n=e[r];n instanceof kh?t.push(n):(i.push(n),e[r-1]instanceof $f&&t.push(TT(e[r-1].sourceSpan.end)))}return e[e.length-1]instanceof $f&&t.push(TT(e[e.length-1].sourceSpan.end)),{messageParts:t,placeHolders:i}}function TT(e){return new kh("",new pi(e,e))}var uV="ngI18nClosureMode",Xse="i18n_",Yse="I18N_EXP_",hV="\uFFFD";function Zse(e){let t=e.relativeContextFilePath.replace(/[^A-Za-z0-9]/g,"_").toUpperCase()+"_",i=new Map,r=new Map,n=new Map,o=new Map;for(let c of e.units)for(let l of c.ops())if(l.kind===k.ExtractedAttribute&&l.i18nContext!==null){let d=i.get(l.i18nContext)??[];d.push(l),i.set(l.i18nContext,d)}else if(l.kind===k.I18nAttributes)r.set(l.target,l);else if(l.kind===k.I18nExpression&&l.usage===gm.I18nAttribute){let d=n.get(l.target)??[];d.push(l),n.set(l.target,d)}else l.kind===k.I18nMessage&&o.set(l.xref,l);let a=new Map,s=new Map;for(let c of e.units)for(let l of c.create)if(l.kind===k.I18nMessage){if(l.messagePlaceholder===null){let{mainVar:d,statements:u}=fz(e,t,o,l);if(l.i18nBlock!==null){let h=e.addConst(d,u);s.set(l.i18nBlock,h)}else{e.constsInitializers.push(...u),a.set(l.i18nContext,d);let h=i.get(l.i18nContext);if(h!==void 0)for(let p of h)p.expression=d.clone()}}Ie.remove(l)}for(let c of e.units)for(let l of c.create)if(iu(l)){let d=r.get(l.xref);if(d===void 0)continue;let u=n.get(l.xref);if(u===void 0)throw new Error("AssertionError: Could not find any i18n expressions associated with an I18nAttributes instruction");let h=new Set;u=u.filter(m=>{let f=h.has(m.name);return h.add(m.name),!f});let p=u.flatMap(m=>{let f=a.get(m.context);if(f===void 0)throw new Error("AssertionError: Could not find i18n expression's value");return[U(m.name),f]});d.i18nAttributesConfig=e.addConst(new Hs(p))}for(let c of e.units)for(let l of c.create)if(l.kind===k.I18nStart){let d=s.get(l.root);if(d===void 0)throw new Error("AssertionError: Could not find corresponding i18n block index for an i18n message op; was an i18n message incorrectly assumed to correspond to an attribute?");l.messageIndex=d}}function fz(e,t,i,r){let n=[],o=new Map;for(let l of r.subMessages){let d=i.get(l),{mainVar:u,statements:h}=fz(e,t,i,d);n.push(...h);let p=o.get(d.messagePlaceholder)??[];p.push(u),o.set(d.messagePlaceholder,p)}Kse(r,o),r.params=new Map([...r.params.entries()].sort());let a=ft(e.pool.uniqueName(Xse)),s=ele(e.pool,r.message.id,t,e.i18nUseExternalIds),c;if(r.needsPostprocessing||r.postprocessingParams.size>0){let l=Object.fromEntries([...r.postprocessingParams.entries()].sort()),d=E0(l,!1),u=[];r.postprocessingParams.size>0&&u.push(h0(d,!0)),c=h=>Xe(T.i18nPostprocess).callFn([h,...u])}return n.push(...Qse(r.message,a,s,r.params,c)),{mainVar:a,statements:n}}function Kse(e,t){for(let[i,r]of t)r.length===1?e.params.set(i,r[0]):(e.params.set(i,U(`${hV}${Yse}${i}${hV}`)),e.postprocessingParams.set(i,ti(r)))}function Qse(e,t,i,r,n){let o=Object.fromEntries(r),a=[w6(t),w0(Jse(),hz(t,e,i,o),pz(t,e,E0(o,!1)))];return n&&a.push(new oo(t.set(n(t)))),a}function Jse(){return x0(ft(uV)).notIdentical(U("undefined",kD)).and(ft(uV))}function ele(e,t,i,r){let n,o=i;if(r){let a=bw("EXTERNAL_"),s=e.uniqueName(o);n=`${a}${Gl(t)}$$${s}`}else{let a=bw(o);n=e.uniqueName(a)}return ft(n)}function tle(e){for(let t of e.units){let i=null,r=null,n=new Map,o=new Map,a=new Map;for(let s of t.create)switch(s.kind){case k.I18nStart:if(s.context===null)throw Error("I18n op should have its context set.");i=s;break;case k.I18nEnd:i=null;break;case k.IcuStart:if(s.context===null)throw Error("Icu op should have its context set.");r=s;break;case k.IcuEnd:r=null;break;case k.Text:if(i!==null)if(n.set(s.xref,i),o.set(s.xref,r),s.icuPlaceholder!==null){let c=Zoe(e.allocateXrefId(),s.icuPlaceholder,[s.initialValue]);Ie.replace(s,c),a.set(s.xref,c)}else Ie.remove(s);break}for(let s of t.update)switch(s.kind){case k.InterpolateText:if(!n.has(s.target))continue;let c=n.get(s.target),l=o.get(s.target),d=a.get(s.target),u=l?l.context:c.context,h=l?l0.Postproccessing:l0.Creation,p=[];for(let m=0;m<s.interpolation.expressions.length;m++){let f=s.interpolation.expressions[m];p.push(Q6(u,c.xref,c.xref,c.handle,f,d?.xref??null,s.interpolation.i18nPlaceholders[m]??null,h,gm.I18nText,"",f.sourceSpan??s.sourceSpan))}Ie.replaceWithMany(s,p),d!==void 0&&(d.strings=s.interpolation.strings);break}}}function ile(e){for(let t of e.units)for(let i of t.create)switch(i.kind){case k.ElementStart:case k.Template:if(!Array.isArray(i.localRefs))throw new Error("AssertionError: expected localRefs to be an array still");if(i.numSlotsUsed+=i.localRefs.length,i.localRefs.length>0){let r=rle(i.localRefs);i.localRefs=e.addConst(r)}else i.localRefs=null;break}}function rle(e){let t=[];for(let i of e)t.push(U(i.name),U(i.target));return ti(t)}function nle(e){for(let t of e.units){let i=No.HTML;for(let r of t.create)r.kind===k.ElementStart&&r.namespace!==i&&(Ie.insertBefore(joe(r.namespace),r),i=r.namespace)}}function mz(e){let t=[],i=0,r=0,n=0,o=0,a=0,s=null;for(;i<e.length;)switch(e.charCodeAt(i++)){case 40:r++;break;case 41:r--;break;case 39:n===0?n=39:n===39&&e.charCodeAt(i-1)!==92&&(n=0);break;case 34:n===0?n=34:n===34&&e.charCodeAt(i-1)!==92&&(n=0);break;case 58:!s&&r===0&&n===0&&(s=WD(e.substring(a,i-1).trim()),o=i);break;case 59:if(s&&o>0&&r===0&&n===0){let l=e.substring(o,i-1).trim();t.push(s,l),a=i,o=0,s=null}break}if(s&&o){let c=e.slice(o).trim();t.push(s,c)}return t}function WD(e){return e.replace(/[a-z][A-Z]/g,t=>t.charAt(0)+"-"+t.charAt(1)).toLowerCase()}function ole(e){Xx(e.root,e.componentName,{index:0},e.compatibility===os.TemplateDefinitionBuilder)}function Xx(e,t,i,r){e.fnName===null&&(e.fnName=e.job.pool.uniqueName(Gl(`${t}_${e.job.fnSuffix}`),!1));let n=new Map;for(let o of e.ops())switch(o.kind){case k.Property:case k.HostProperty:o.isAnimationTrigger&&(o.name="@"+o.name);break;case k.Listener:if(o.handlerFnName!==null)break;if(!o.hostListener&&o.targetSlot.slot===null)throw new Error("Expected a slot to be assigned");let a="";o.isAnimationListener&&(o.name=`@${o.name}.${o.animationPhase}`,a="animation"),o.hostListener?o.handlerFnName=`${t}_${a}${o.name}_HostBindingHandler`:o.handlerFnName=`${e.fnName}_${o.tag.replace("-","_")}_${a}${o.name}_${o.targetSlot.slot}_listener`,o.handlerFnName=Gl(o.handlerFnName);break;case k.TwoWayListener:if(o.handlerFnName!==null)break;if(o.targetSlot.slot===null)throw new Error("Expected a slot to be assigned");o.handlerFnName=Gl(`${e.fnName}_${o.tag.replace("-","_")}_${o.name}_${o.targetSlot.slot}_listener`);break;case k.Variable:n.set(o.xref,ale(e,o.variable,i));break;case k.RepeaterCreate:if(!(e instanceof ru))throw new Error("AssertionError: must be compiling a component");if(o.handle.slot===null)throw new Error("Expected slot to be assigned");if(o.emptyView!==null){let l=e.job.views.get(o.emptyView);Xx(l,`${t}_${o.functionNameSuffix}Empty_${o.handle.slot+2}`,i,r)}Xx(e.job.views.get(o.xref),`${t}_${o.functionNameSuffix}_${o.handle.slot+1}`,i,r);break;case k.Template:if(!(e instanceof ru))throw new Error("AssertionError: must be compiling a component");let s=e.job.views.get(o.xref);if(o.handle.slot===null)throw new Error("Expected slot to be assigned");let c=o.functionNameSuffix.length===0?"":`_${o.functionNameSuffix}`;Xx(s,`${t}${c}_${o.handle.slot}`,i,r);break;case k.StyleProp:o.name=sle(o.name),r&&(o.name=pV(o.name));break;case k.ClassProp:r&&(o.name=pV(o.name));break}for(let o of e.ops())La(o,a=>{if(!(!(a instanceof $c)||a.name!==null)){if(!n.has(a.xref))throw new Error(`Variable ${a.xref} not yet named`);a.name=n.get(a.xref)}})}function ale(e,t,i){if(t.name===null)switch(t.kind){case io.Context:t.name=`ctx_r${i.index++}`;break;case io.Identifier:if(e.job.compatibility===os.TemplateDefinitionBuilder){let r=t.identifier==="ctx"?"i":"";t.name=`${t.identifier}_${r}r${++i.index}`}else t.name=`${t.identifier}_i${i.index++}`;break;default:t.name=`_r${++i.index}`;break}return t.name}function sle(e){return e.startsWith("--")?e:WD(e)}function pV(e){let t=e.indexOf("!important");return t>-1?e.substring(0,t):e}function lle(e){for(let t of e.units){for(let i of t.create)(i.kind===k.Listener||i.kind===k.TwoWayListener)&&fV(i.handlerOps);fV(t.update)}}function fV(e){for(let t of e){if(t.kind!==k.Statement||!(t.statement instanceof oo)||!(t.statement.expr instanceof Ow))continue;let i=t.statement.expr.steps,r=!0;for(let n=t.next;n.kind!==k.ListEnd&&r;n=n.next)La(n,(o,a)=>{if(!Kl(o))return o;if(r&&!(a&nr.InChildOperation))switch(o.kind){case Nt.NextContext:o.steps+=i,Ie.remove(t),r=!1;break;case Nt.GetCurrentView:case Nt.Reference:r=!1;break}})}}var cle="ng-container";function dle(e){for(let t of e.units){let i=new Set;for(let r of t.create)r.kind===k.ElementStart&&r.tag===cle&&(r.kind=k.ContainerStart,i.add(r.xref)),r.kind===k.ElementEnd&&i.has(r.xref)&&(r.kind=k.ContainerEnd)}}function ule(e,t){let i=e.get(t);if(i===void 0)throw new Error("All attributes should have an element-like target.");return i}function hle(e){let t=new Map;for(let i of e.units)for(let r of i.create)iu(r)&&t.set(r.xref,r);for(let i of e.units)for(let r of i.create)(r.kind===k.ElementStart||r.kind===k.ContainerStart)&&r.nonBindable&&Ie.insertAfter(Uoe(r.xref),r),(r.kind===k.ElementEnd||r.kind===k.ContainerEnd)&&ule(t,r.xref).nonBindable&&Ie.insertBefore(Hoe(r.xref),r)}function ple(e){for(let t of e.units)for(let i of t.ops())mo(i,r=>{if(!(r instanceof Si)||r.operator!==et.NullishCoalesce)return r;let n=new _l(r.lhs.clone(),e.allocateXrefId()),o=new Wc(n.xref);return new ns(new Si(et.And,new Si(et.NotIdentical,n,zh),new Si(et.NotIdentical,o,new no(void 0))),o.clone(),r.rhs)},nr.None)}function Nc(e){return t=>t.kind===e}function Vv(e,t){return i=>i.kind===e&&t===i.expression instanceof Cn}function fle(e){return e.kind===k.Listener&&!(e.hostListener&&e.isAnimationListener)||e.kind===k.TwoWayListener}function mle(e){return(e.kind===k.Property||e.kind===k.TwoWayProperty)&&!(e.expression instanceof Cn)}var gle=[{test:e=>e.kind===k.Listener&&e.hostListener&&e.isAnimationListener},{test:fle}],vle=[{test:Nc(k.StyleMap),transform:Zw},{test:Nc(k.ClassMap),transform:Zw},{test:Nc(k.StyleProp)},{test:Nc(k.ClassProp)},{test:Vv(k.Attribute,!0)},{test:Vv(k.Property,!0)},{test:mle},{test:Vv(k.Attribute,!1)}],_le=[{test:Vv(k.HostProperty,!0)},{test:Vv(k.HostProperty,!1)},{test:Nc(k.Attribute)},{test:Nc(k.StyleMap),transform:Zw},{test:Nc(k.ClassMap),transform:Zw},{test:Nc(k.StyleProp)},{test:Nc(k.ClassProp)}],mV=new Set([k.Listener,k.TwoWayListener,k.StyleMap,k.ClassMap,k.StyleProp,k.ClassProp,k.Property,k.TwoWayProperty,k.HostProperty,k.Attribute]);function ble(e){for(let t of e.units){gV(t.create,gle);let i=t.job.kind===dt.Host?_le:vle;gV(t.update,i)}}function gV(e,t){let i=[],r=null;for(let n of e){let o=jD(n)?n.target:null;(!mV.has(n.kind)||o!==r&&r!==null&&o!==null)&&(Ie.insertBefore(vV(i,t),n),i=[],r=null),mV.has(n.kind)&&(i.push(n),Ie.remove(n),r=o??r)}e.push(vV(i,t))}function vV(e,t){let i=Array.from(t,()=>new Array);for(let r of e){let n=t.findIndex(o=>o.test(r));i[n].push(r)}return i.flatMap((r,n)=>{let o=t[n].transform;return o?o(r):r})}function Zw(e){return e.slice(e.length-1)}function yle(e){let t=new Map;for(let i of e.units)for(let r of i.create)iu(r)&&t.set(r.xref,r);for(let i of e.units)for(let r of i.create)if(r.kind===k.ExtractedAttribute&&r.bindingKind===Et.Attribute&&J6(r.expression)){let n=t.get(r.target);if(n!==void 0&&n.kind===k.Template&&n.templateKind===ts.Structural)continue;if(r.name==="style"){let o=mz(r.expression.value);for(let a=0;a<o.length-1;a+=2)Ie.insertBefore(Vs(r.target,Et.StyleProperty,null,o[a],U(o[a+1]),null,null,Oi.STYLE),r);Ie.remove(r)}else if(r.name==="class"){let o=r.expression.value.trim().split(/\s+/g);for(let a of o)Ie.insertBefore(Vs(r.target,Et.ClassName,null,a,null,null,null,Oi.NONE),r);Ie.remove(r)}}}function xle(e){for(let t of e.units){let i=$D(t);for(let r of t.ops())switch(r.kind){case k.Binding:let n=Ele(i,r.target);wle(r.name)&&n.kind===k.Projection&&Ie.remove(r);break}}}function wle(e){return e.toLowerCase()==="select"}function Ele(e,t){let i=e.get(t);if(i===void 0)throw new Error("All attributes should have an slottable target.");return i}function Cle(e){for(let t of e.units)Sle(t)}function Sle(e){for(let t of e.update)La(t,(i,r)=>{if(Kl(i)&&i.kind===Nt.PipeBinding){if(r&nr.InChildOperation)throw new Error("AssertionError: pipe bindings should not appear in child expressions");if(e.job.compatibility){if(t.target==null)throw new Error("AssertionError: expected slot handle to be assigned for pipe creation");Tle(e,t.target,i)}else e.create.push(iz(i.target,i.targetSlot,i.name))}})}function Tle(e,t,i){for(let r=e.create.head.next;r.kind!==k.ListEnd;r=r.next){if(!vm(r)||r.xref!==t)continue;for(;r.next.kind===k.Pipe;)r=r.next;let n=iz(i.target,i.targetSlot,i.name);Ie.insertBefore(n,r.next);return}throw new Error(`AssertionError: unable to find insertion point for pipe ${i.name}`)}function Ale(e){for(let t of e.units)for(let i of t.update)mo(i,r=>!(r instanceof rp)||r.args.length<=4?r:new Lw(r.target,r.targetSlot,r.name,ti(r.args),r.args.length),nr.None)}function Dle(e){gz(e.root,0)}function gz(e,t){let i=null;for(let r of e.create)switch(r.kind){case k.I18nStart:r.subTemplateIndex=t===0?null:t,i=r;break;case k.I18nEnd:i.subTemplateIndex===null&&(t=0),i=null;break;case k.Template:t=AT(e.job.views.get(r.xref),i,r.i18nPlaceholder,t);break;case k.RepeaterCreate:let n=e.job.views.get(r.xref);t=AT(n,i,r.i18nPlaceholder,t),r.emptyView!==null&&(t=AT(e.job.views.get(r.emptyView),i,r.emptyI18nPlaceholder,t));break}return t}function AT(e,t,i,r){if(i!==void 0){if(t===null)throw Error("Expected template with i18n placeholder to be in an i18n block.");r++,Ile(e,t)}return gz(e,r)}function Ile(e,t){if(e.create.head.next?.kind!==k.I18nStart){let i=e.job.allocateXrefId();Ie.insertAfter(f1(i,t.message,t.root,null),e.create.head),Ie.insertBefore(m1(i,null),e.create.tail)}}function Mle(e){for(let t of e.units)for(let i of t.ops())La(i,r=>{if(!(r instanceof ip)||r.body===null)return;let n=new QA(r.args.length);r.fn=e.pool.getSharedConstant(n,r.body),r.body=null})}var QA=class extends Wf{constructor(t){super(),this.numArgs=t}keyOf(t){return t instanceof sm?`param(${t.index})`:super.keyOf(t)}toSharedConstantDeclaration(t,i){let r=[];for(let o=0;o<this.numArgs;o++)r.push(new Dr("a"+o));let n=ut(i,o=>o instanceof sm?ft("a"+o.index):o,nr.None);return new Ro(t,new Bh(r,n),void 0,po.Final)}};function kle(e){for(let t of e.units)for(let i of t.update)mo(i,(r,n)=>n&nr.InChildOperation?r:r instanceof Hs?Ple(r):r instanceof vl?Nle(r):r,nr.None)}function Ple(e){let t=[],i=[];for(let r of e.entries)if(r.isConstant())t.push(r);else{let n=i.length;i.push(r),t.push(new sm(n))}return new ip(ti(t),i)}function Nle(e){let t=[],i=[];for(let r of e.entries)if(r.value.isConstant())t.push(r);else{let n=i.length;i.push(r.value),t.push(new Kf(r.key,new sm(n),r.quoted))}return new ip(ao(t),i)}function Ole(e,t,i,r,n){return g1(T.element,e,t,i,r,n)}function Rle(e,t,i,r,n){return g1(T.elementStart,e,t,i,r,n)}function g1(e,t,i,r,n,o){let a=[U(t)];return i!==null&&a.push(U(i)),n!==null?a.push(U(r),U(n)):r!==null&&a.push(U(r)),Ri(e,a,o)}function Fle(e){return Ri(T.elementEnd,[],e)}function Lle(e,t,i,r){return g1(T.elementContainerStart,e,null,t,i,r)}function Ble(e,t,i,r){return g1(T.elementContainer,e,null,t,i,r)}function Vle(){return Ri(T.elementContainerEnd,[],null)}function zle(e,t,i,r,n,o,a,s){let c=[U(e),t,U(i),U(r),U(n),U(o)];for(a!==null&&(c.push(U(a)),c.push(Xe(T.templateRefExtractor)));c[c.length-1].isEquivalent(zh);)c.pop();return Ri(T.templateCreate,c,s)}function Ule(){return Ri(T.disableBindings,[],null)}function Hle(){return Ri(T.enableBindings,[],null)}function jle(e,t,i,r,n){let o=[U(e),t];return i!==null&&(o.push(U(!1)),o.push(Xe(i))),Ri(r?T.syntheticHostListener:T.listener,o,n)}function _V(e,t){return Xe(T.twoWayBindingSet).callFn([e,t])}function Gle(e,t,i){return Ri(T.twoWayListener,[U(e),t],i)}function $le(e,t){return Ri(T.pipe,[U(e),U(t)],null)}function Wle(){return Ri(T.namespaceHTML,[],null)}function qle(){return Ri(T.namespaceSVG,[],null)}function Xle(){return Ri(T.namespaceMathML,[],null)}function Yle(e,t){return Ri(T.advance,e>1?[U(e)]:[],t)}function Zle(e){return Xe(T.reference).callFn([U(e)])}function Kle(e){return Xe(T.nextContext).callFn(e===1?[]:[U(e)])}function Qle(){return Xe(T.getCurrentView).callFn([])}function Jle(e){return Xe(T.restoreView).callFn([e])}function ece(e){return Xe(T.resetView).callFn([e])}function tce(e,t,i){let r=[U(e,null)];return t!==""&&r.push(U(t)),Ri(T.text,r,i)}function ice(e,t,i,r,n,o,a,s,c,l){let d=[U(e),U(t),i??U(null),U(r),U(n),U(o),a??U(null),s??U(null),c?Xe(T.deferEnableTimerScheduling):U(null)],u;for(;(u=d[d.length-1])!==null&&u instanceof no&&u.value===null;)d.pop();return Ri(T.defer,d,l)}var rce=new Map([[Vr.Idle,[T.deferOnIdle,T.deferPrefetchOnIdle]],[Vr.Immediate,[T.deferOnImmediate,T.deferPrefetchOnImmediate]],[Vr.Timer,[T.deferOnTimer,T.deferPrefetchOnTimer]],[Vr.Hover,[T.deferOnHover,T.deferPrefetchOnHover]],[Vr.Interaction,[T.deferOnInteraction,T.deferPrefetchOnInteraction]],[Vr.Viewport,[T.deferOnViewport,T.deferPrefetchOnViewport]]]);function nce(e,t,i,r){let n=rce.get(e);if(n===void 0)throw new Error(`Unable to determine instruction for trigger ${e}`);let o=i?n[1]:n[0];return Ri(o,t.map(a=>U(a)),r)}function oce(e){return Ri(T.projectionDef,e?[e]:[],null)}function ace(e,t,i,r){let n=[U(e)];return(t!==0||i!==null)&&(n.push(U(t)),i!==null&&n.push(i)),Ri(T.projection,n,r)}function sce(e,t,i,r){let n=[U(e),U(t)];return i!==null&&n.push(U(i)),Ri(T.i18nStart,n,r)}function lce(e,t,i,r,n,o,a,s,c,l,d,u,h,p){let m=[U(e),ft(t),U(i),U(r),U(n),U(o),a];return(s||c!==null)&&(m.push(U(s)),c!==null&&(m.push(ft(c),U(l),U(d)),(u!==null||h!==null)&&m.push(U(u)),h!==null&&m.push(U(h)))),Ri(T.repeaterCreate,m,p)}function cce(e,t){return Ri(T.repeater,[e],t)}function dce(e,t,i){return Ri(e?T.deferPrefetchWhen:T.deferWhen,[t],i)}function uce(e,t,i,r){let n=[U(e),U(t)];return i&&n.push(U(i)),Ri(T.i18n,n,r)}function hce(e){return Ri(T.i18nEnd,[],e)}function pce(e,t){let i=[U(e),U(t)];return Ri(T.i18nAttributes,i,null)}function fce(e,t,i,r){let n=[U(e),t];return i!==null&&n.push(i),Ri(T.property,n,r)}function mce(e,t,i,r){let n=[U(e),t];return i!==null&&n.push(i),Ri(T.twoWayProperty,n,r)}function gce(e,t,i,r){let n=[U(e),t];return(i!==null||r!==null)&&n.push(i??U(null)),r!==null&&n.push(U(r)),Ri(T.attribute,n,null)}function vce(e,t,i,r){let n=[U(e),t];return i!==null&&n.push(U(i)),Ri(T.styleProp,n,r)}function _ce(e,t,i){return Ri(T.classProp,[U(e),t],i)}function bce(e,t){return Ri(T.styleMap,[e],t)}function yce(e,t){return Ri(T.classMap,[e],t)}var bV=[T.pipeBind1,T.pipeBind2,T.pipeBind3,T.pipeBind4];function xce(e,t,i){if(i.length<1||i.length>bV.length)throw new Error("pipeBind() argument count out of bounds");let r=bV[i.length-1];return Xe(r).callFn([U(e),U(t),...i])}function wce(e,t,i){return Xe(T.pipeBindV).callFn([U(e),U(t),i])}function Ece(e,t,i){if(e.length<1||t.length!==e.length-1)throw new Error("AssertionError: expected specific shape of args for strings/expressions in interpolation");let r=[];if(t.length===1&&e[0]===""&&e[1]==="")r.push(t[0]);else{let n;for(n=0;n<t.length;n++)r.push(U(e[n]),t[n]);r.push(U(e[n]))}return _m(Rce,[],r,[],i)}function Cce(e,t){return Ri(T.i18nExp,[e],t)}function Sce(e,t){return Ri(T.i18nApply,[U(e)],t)}function Tce(e,t,i,r,n){let o=D0(t,i),a=[];return r!==null&&a.push(r),_m(Fce,[U(e)],o,a,n)}function Ace(e,t,i,r,n){let o=D0(t,i),a=[];return r!==null&&a.push(r),_m(Bce,[U(e)],o,a,n)}function Dce(e,t,i,r,n){let o=D0(t,i),a=[];return r!==null&&a.push(U(r)),_m(Lce,[U(e)],o,a,n)}function Ice(e,t,i){let r=D0(e,t);return _m(Vce,[],r,[],i)}function Mce(e,t,i){let r=D0(e,t);return _m(zce,[],r,[],i)}function kce(e,t,i,r){let n=[U(e),t];return i!==null&&n.push(i),Ri(T.hostProperty,n,r)}function Pce(e,t,i){return Ri(T.syntheticHostProperty,[U(e),t],i)}function Nce(e,t,i){return vz(Uce,[U(e),t],i,[],null)}function D0(e,t){if(e.length<1||t.length!==e.length-1)throw new Error("AssertionError: expected specific shape of args for strings/expressions in interpolation");let i=[];if(t.length===1&&e[0]===""&&e[1]==="")i.push(t[0]);else{let r;for(r=0;r<t.length;r++)i.push(U(e[r]),t[r]);i.push(U(e[r]))}return i}function Ri(e,t,i){let r=Xe(e).callFn(t,i);return Zl(new oo(r,i))}function Oce(e,t,i,r){let n=[U(e),t];return i!==null&&n.push(i),Ri(T.conditional,n,r)}var Rce={constant:[T.textInterpolate,T.textInterpolate1,T.textInterpolate2,T.textInterpolate3,T.textInterpolate4,T.textInterpolate5,T.textInterpolate6,T.textInterpolate7,T.textInterpolate8],variable:T.textInterpolateV,mapping:e=>{if(e%2===0)throw new Error("Expected odd number of arguments");return(e-1)/2}},Fce={constant:[T.propertyInterpolate,T.propertyInterpolate1,T.propertyInterpolate2,T.propertyInterpolate3,T.propertyInterpolate4,T.propertyInterpolate5,T.propertyInterpolate6,T.propertyInterpolate7,T.propertyInterpolate8],variable:T.propertyInterpolateV,mapping:e=>{if(e%2===0)throw new Error("Expected odd number of arguments");return(e-1)/2}},Lce={constant:[T.styleProp,T.stylePropInterpolate1,T.stylePropInterpolate2,T.stylePropInterpolate3,T.stylePropInterpolate4,T.stylePropInterpolate5,T.stylePropInterpolate6,T.stylePropInterpolate7,T.stylePropInterpolate8],variable:T.stylePropInterpolateV,mapping:e=>{if(e%2===0)throw new Error("Expected odd number of arguments");return(e-1)/2}},Bce={constant:[T.attribute,T.attributeInterpolate1,T.attributeInterpolate2,T.attributeInterpolate3,T.attributeInterpolate4,T.attributeInterpolate5,T.attributeInterpolate6,T.attributeInterpolate7,T.attributeInterpolate8],variable:T.attributeInterpolateV,mapping:e=>{if(e%2===0)throw new Error("Expected odd number of arguments");return(e-1)/2}},Vce={constant:[T.styleMap,T.styleMapInterpolate1,T.styleMapInterpolate2,T.styleMapInterpolate3,T.styleMapInterpolate4,T.styleMapInterpolate5,T.styleMapInterpolate6,T.styleMapInterpolate7,T.styleMapInterpolate8],variable:T.styleMapInterpolateV,mapping:e=>{if(e%2===0)throw new Error("Expected odd number of arguments");return(e-1)/2}},zce={constant:[T.classMap,T.classMapInterpolate1,T.classMapInterpolate2,T.classMapInterpolate3,T.classMapInterpolate4,T.classMapInterpolate5,T.classMapInterpolate6,T.classMapInterpolate7,T.classMapInterpolate8],variable:T.classMapInterpolateV,mapping:e=>{if(e%2===0)throw new Error("Expected odd number of arguments");return(e-1)/2}},Uce={constant:[T.pureFunction0,T.pureFunction1,T.pureFunction2,T.pureFunction3,T.pureFunction4,T.pureFunction5,T.pureFunction6,T.pureFunction7,T.pureFunction8],variable:T.pureFunctionV,mapping:e=>e};function vz(e,t,i,r,n){let o=e.mapping(i.length);if(o<e.constant.length)return Xe(e.constant[o]).callFn([...t,...i,...r],n);if(e.variable!==null)return Xe(e.variable).callFn([...t,ti(i),...r],n);throw new Error("AssertionError: unable to call variadic function")}function _m(e,t,i,r,n){return Zl(vz(e,t,i,r,n).toStmt())}var Hce=new Map([["window",T.resolveWindow],["document",T.resolveDocument],["body",T.resolveBody]]);function jce(e){for(let t of e.units)Gce(t,t.create),_z(t,t.update)}function Gce(e,t){for(let i of t)switch(mo(i,bz,nr.None),i.kind){case k.Text:Ie.replace(i,tce(i.handle.slot,i.initialValue,i.sourceSpan));break;case k.ElementStart:Ie.replace(i,Rle(i.handle.slot,i.tag,i.attributes,i.localRefs,i.startSourceSpan));break;case k.Element:Ie.replace(i,Ole(i.handle.slot,i.tag,i.attributes,i.localRefs,i.wholeSourceSpan));break;case k.ElementEnd:Ie.replace(i,Fle(i.sourceSpan));break;case k.ContainerStart:Ie.replace(i,Lle(i.handle.slot,i.attributes,i.localRefs,i.startSourceSpan));break;case k.Container:Ie.replace(i,Ble(i.handle.slot,i.attributes,i.localRefs,i.wholeSourceSpan));break;case k.ContainerEnd:Ie.replace(i,Vle());break;case k.I18nStart:Ie.replace(i,sce(i.handle.slot,i.messageIndex,i.subTemplateIndex,i.sourceSpan));break;case k.I18nEnd:Ie.replace(i,hce(i.sourceSpan));break;case k.I18n:Ie.replace(i,uce(i.handle.slot,i.messageIndex,i.subTemplateIndex,i.sourceSpan));break;case k.I18nAttributes:if(i.i18nAttributesConfig===null)throw new Error("AssertionError: i18nAttributesConfig was not set");Ie.replace(i,pce(i.handle.slot,i.i18nAttributesConfig));break;case k.Template:if(!(e instanceof ru))throw new Error("AssertionError: must be compiling a component");if(Array.isArray(i.localRefs))throw new Error("AssertionError: local refs array should have been extracted into a constant");let r=e.job.views.get(i.xref);Ie.replace(i,zle(i.handle.slot,ft(r.fnName),r.decls,r.vars,i.tag,i.attributes,i.localRefs,i.startSourceSpan));break;case k.DisableBindings:Ie.replace(i,Ule());break;case k.EnableBindings:Ie.replace(i,Hle());break;case k.Pipe:Ie.replace(i,$le(i.handle.slot,i.name));break;case k.Listener:let n=yV(e,i.handlerFnName,i.handlerOps,i.consumesDollarEvent),o=i.eventTarget?Hce.get(i.eventTarget):null;if(o===void 0)throw new Error(`Unexpected global target '${i.eventTarget}' defined for '${i.name}' event. Supported list of global targets: window,document,body.`);Ie.replace(i,jle(i.name,n,o,i.hostListener&&i.isAnimationListener,i.sourceSpan));break;case k.TwoWayListener:Ie.replace(i,Gle(i.name,yV(e,i.handlerFnName,i.handlerOps,!0),i.sourceSpan));break;case k.Variable:if(i.variable.name===null)throw new Error(`AssertionError: unnamed variable ${i.xref}`);Ie.replace(i,Zl(new Ro(i.variable.name,i.initializer,void 0,po.Final)));break;case k.Namespace:switch(i.active){case No.HTML:Ie.replace(i,Wle());break;case No.SVG:Ie.replace(i,qle());break;case No.Math:Ie.replace(i,Xle());break}break;case k.Defer:let a=!!i.loadingMinimumTime||!!i.loadingAfterTime||!!i.placeholderMinimumTime;Ie.replace(i,ice(i.handle.slot,i.mainSlot.slot,i.resolverFn,i.loadingSlot?.slot??null,i.placeholderSlot?.slot??null,i.errorSlot?.slot??null,i.loadingConfig,i.placeholderConfig,a,i.sourceSpan));break;case k.DeferOn:let s=[];switch(i.trigger.kind){case Vr.Idle:case Vr.Immediate:break;case Vr.Timer:s=[i.trigger.delay];break;case Vr.Interaction:case Vr.Hover:case Vr.Viewport:if(i.trigger.targetSlot?.slot==null||i.trigger.targetSlotViewSteps===null)throw new Error(`Slot or view steps not set in trigger reification for trigger kind ${i.trigger.kind}`);s=[i.trigger.targetSlot.slot],i.trigger.targetSlotViewSteps!==0&&s.push(i.trigger.targetSlotViewSteps);break;default:throw new Error(`AssertionError: Unsupported reification of defer trigger kind ${i.trigger.kind}`)}Ie.replace(i,nce(i.trigger.kind,s,i.prefetch,i.sourceSpan));break;case k.ProjectionDef:Ie.replace(i,oce(i.def));break;case k.Projection:if(i.handle.slot===null)throw new Error("No slot was assigned for project instruction");Ie.replace(i,ace(i.handle.slot,i.projectionSlotIndex,i.attributes,i.sourceSpan));break;case k.RepeaterCreate:if(i.handle.slot===null)throw new Error("No slot was assigned for repeater instruction");if(!(e instanceof ru))throw new Error("AssertionError: must be compiling a component");let c=e.job.views.get(i.xref);if(c.fnName===null)throw new Error("AssertionError: expected repeater primary view to have been named");let l=null,d=null,u=null;if(i.emptyView!==null){let h=e.job.views.get(i.emptyView);if(h===void 0)throw new Error("AssertionError: repeater had empty view xref, but empty view was not found");if(h.fnName===null||h.decls===null||h.vars===null)throw new Error("AssertionError: expected repeater empty view to have been named and counted");l=h.fnName,d=h.decls,u=h.vars}Ie.replace(i,lce(i.handle.slot,c.fnName,i.decls,i.vars,i.tag,i.attributes,i.trackByFn,i.usesComponentInstance,l,d,u,i.emptyTag,i.emptyAttributes,i.wholeSourceSpan));break;case k.Statement:break;default:throw new Error(`AssertionError: Unsupported reification of create op ${k[i.kind]}`)}}function _z(e,t){for(let i of t)switch(mo(i,bz,nr.None),i.kind){case k.Advance:Ie.replace(i,Yle(i.delta,i.sourceSpan));break;case k.Property:i.expression instanceof Cn?Ie.replace(i,Tce(i.name,i.expression.strings,i.expression.expressions,i.sanitizer,i.sourceSpan)):Ie.replace(i,fce(i.name,i.expression,i.sanitizer,i.sourceSpan));break;case k.TwoWayProperty:Ie.replace(i,mce(i.name,i.expression,i.sanitizer,i.sourceSpan));break;case k.StyleProp:i.expression instanceof Cn?Ie.replace(i,Dce(i.name,i.expression.strings,i.expression.expressions,i.unit,i.sourceSpan)):Ie.replace(i,vce(i.name,i.expression,i.unit,i.sourceSpan));break;case k.ClassProp:Ie.replace(i,_ce(i.name,i.expression,i.sourceSpan));break;case k.StyleMap:i.expression instanceof Cn?Ie.replace(i,Ice(i.expression.strings,i.expression.expressions,i.sourceSpan)):Ie.replace(i,bce(i.expression,i.sourceSpan));break;case k.ClassMap:i.expression instanceof Cn?Ie.replace(i,Mce(i.expression.strings,i.expression.expressions,i.sourceSpan)):Ie.replace(i,yce(i.expression,i.sourceSpan));break;case k.I18nExpression:Ie.replace(i,Cce(i.expression,i.sourceSpan));break;case k.I18nApply:Ie.replace(i,Sce(i.handle.slot,i.sourceSpan));break;case k.InterpolateText:Ie.replace(i,Ece(i.interpolation.strings,i.interpolation.expressions,i.sourceSpan));break;case k.Attribute:i.expression instanceof Cn?Ie.replace(i,Ace(i.name,i.expression.strings,i.expression.expressions,i.sanitizer,i.sourceSpan)):Ie.replace(i,gce(i.name,i.expression,i.sanitizer,i.namespace));break;case k.HostProperty:if(i.expression instanceof Cn)throw new Error("not yet handled");i.isAnimationTrigger?Ie.replace(i,Pce(i.name,i.expression,i.sourceSpan)):Ie.replace(i,kce(i.name,i.expression,i.sanitizer,i.sourceSpan));break;case k.Variable:if(i.variable.name===null)throw new Error(`AssertionError: unnamed variable ${i.xref}`);Ie.replace(i,Zl(new Ro(i.variable.name,i.initializer,void 0,po.Final)));break;case k.Conditional:if(i.processed===null)throw new Error("Conditional test was not set.");if(i.targetSlot.slot===null)throw new Error("Conditional slot was not set.");Ie.replace(i,Oce(i.targetSlot.slot,i.processed,i.contextValue,i.sourceSpan));break;case k.Repeater:Ie.replace(i,cce(i.collection,i.sourceSpan));break;case k.DeferWhen:Ie.replace(i,dce(i.prefetch,i.expr,i.sourceSpan));break;case k.Statement:break;default:throw new Error(`AssertionError: Unsupported reification of update op ${k[i.kind]}`)}}function bz(e){if(!Kl(e))return e;switch(e.kind){case Nt.NextContext:return Kle(e.steps);case Nt.Reference:return Zle(e.targetSlot.slot+1+e.offset);case Nt.LexicalRead:throw new Error(`AssertionError: unresolved LexicalRead of ${e.name}`);case Nt.TwoWayBindingSet:throw new Error("AssertionError: unresolved TwoWayBindingSet");case Nt.RestoreView:if(typeof e.view=="number")throw new Error("AssertionError: unresolved RestoreView");return Jle(e.view);case Nt.ResetView:return ece(e.expr);case Nt.GetCurrentView:return Qle();case Nt.ReadVariable:if(e.name===null)throw new Error(`Read of unnamed variable ${e.xref}`);return ft(e.name);case Nt.ReadTemporaryExpr:if(e.name===null)throw new Error(`Read of unnamed temporary ${e.xref}`);return ft(e.name);case Nt.AssignTemporaryExpr:if(e.name===null)throw new Error(`Assign of unnamed temporary ${e.xref}`);return ft(e.name).set(e.expr);case Nt.PureFunctionExpr:if(e.fn===null)throw new Error("AssertionError: expected PureFunctions to have been extracted");return Nce(e.varOffset,e.fn,e.args);case Nt.PureFunctionParameterExpr:throw new Error("AssertionError: expected PureFunctionParameterExpr to have been extracted");case Nt.PipeBinding:return xce(e.targetSlot.slot,e.varOffset,e.args);case Nt.PipeBindingVariadic:return wce(e.targetSlot.slot,e.varOffset,e.args);case Nt.SlotLiteralExpr:return U(e.slot.slot);default:throw new Error(`AssertionError: Unsupported reification of ir.Expression kind: ${Nt[e.kind]}`)}}function yV(e,t,i,r){_z(e,i);let n=[];for(let a of i){if(a.kind!==k.Statement)throw new Error(`AssertionError: expected reified statements, but found op ${k[a.kind]}`);n.push(a.statement)}let o=[];return r&&o.push(new Dr("$event")),Xl(o,n,void 0,void 0,t)}function $ce(e){for(let t of e.units)for(let i of t.update)switch(i.kind){case k.Attribute:case k.Binding:case k.ClassProp:case k.ClassMap:case k.Property:case k.StyleProp:case k.StyleMap:i.expression instanceof c0&&Ie.remove(i);break}}function Wce(e){for(let t of e.units)for(let i of t.create)switch(i.kind){case k.I18nContext:Ie.remove(i);break;case k.I18nStart:i.context=null;break}}function qce(e){for(let t of e.units){let i=new Set;for(let r of t.update)switch(r.kind){case k.I18nExpression:i.add(r.i18nOwner)}for(let r of t.create)switch(r.kind){case k.I18nAttributes:if(i.has(r.xref))continue;Ie.remove(r)}}}function Xce(e){for(let t of e.units)JA(t,t.create),JA(t,t.update)}function JA(e,t){let i=new Map;i.set(e.xref,ft("ctx"));for(let r of t)switch(r.kind){case k.Variable:switch(r.variable.kind){case io.Context:i.set(r.variable.view,new $c(r.xref));break}break;case k.Listener:case k.TwoWayListener:JA(e,r.handlerOps);break}e===e.job.root&&i.set(e.xref,ft("ctx"));for(let r of t)mo(r,n=>{if(n instanceof Gc){if(!i.has(n.view))throw new Error(`No context found for reference to view ${n.view} from view ${e.xref}`);return i.get(n.view)}else return n},nr.None)}function Yce(e){for(let t of e.units)xV(t.create),xV(t.update)}function xV(e){for(let t of e)(t.kind===k.Listener||t.kind===k.TwoWayListener)&&mo(t,i=>i instanceof Ra&&i.name==="$event"?(t.kind===k.Listener&&(t.consumesDollarEvent=!0),new rs(i.name)):i,nr.InChildOperation)}function Zce(e){let t=new Map,i=new Map;for(let r of e.units)for(let n of r.create)switch(n.kind){case k.I18nContext:t.set(n.xref,n);break;case k.ElementStart:i.set(n.xref,n);break}jd(e,e.root,t,i)}function jd(e,t,i,r,n){let o=null,a=new Map;for(let s of t.create)switch(s.kind){case k.I18nStart:if(!s.context)throw Error("Could not find i18n context for i18n op");o={i18nBlock:s,i18nContext:i.get(s.context)};break;case k.I18nEnd:o=null;break;case k.ElementStart:if(s.i18nPlaceholder!==void 0){if(o===null)throw Error("i18n tag placeholder should only occur inside an i18n block");wV(s,o.i18nContext,o.i18nBlock,n),n&&s.i18nPlaceholder.closeName&&a.set(s.xref,n),n=void 0}break;case k.ElementEnd:let c=r.get(s.xref);if(c&&c.i18nPlaceholder!==void 0){if(o===null)throw Error("AssertionError: i18n tag placeholder should only occur inside an i18n block");EV(c,o.i18nContext,o.i18nBlock,a.get(s.xref)),a.delete(s.xref)}break;case k.Projection:if(s.i18nPlaceholder!==void 0){if(o===null)throw Error("i18n tag placeholder should only occur inside an i18n block");wV(s,o.i18nContext,o.i18nBlock,n),EV(s,o.i18nContext,o.i18nBlock,n),n=void 0}break;case k.Template:let l=e.views.get(s.xref);if(s.i18nPlaceholder===void 0)jd(e,l,i,r);else{if(o===null)throw Error("i18n tag placeholder should only occur inside an i18n block");s.templateKind===ts.Structural?jd(e,l,i,r,s):(DT(e,l,s.handle.slot,s.i18nPlaceholder,o.i18nContext,o.i18nBlock,n),jd(e,l,i,r),IT(e,l,s.handle.slot,s.i18nPlaceholder,o.i18nContext,o.i18nBlock,n),n=void 0)}break;case k.RepeaterCreate:if(n!==void 0)throw Error("AssertionError: Unexpected structural directive associated with @for block");let d=s.handle.slot+1,u=e.views.get(s.xref);if(s.i18nPlaceholder===void 0)jd(e,u,i,r);else{if(o===null)throw Error("i18n tag placeholder should only occur inside an i18n block");DT(e,u,d,s.i18nPlaceholder,o.i18nContext,o.i18nBlock,n),jd(e,u,i,r),IT(e,u,d,s.i18nPlaceholder,o.i18nContext,o.i18nBlock,n),n=void 0}if(s.emptyView!==null){let h=s.handle.slot+2,p=e.views.get(s.emptyView);if(s.emptyI18nPlaceholder===void 0)jd(e,p,i,r);else{if(o===null)throw Error("i18n tag placeholder should only occur inside an i18n block");DT(e,p,h,s.emptyI18nPlaceholder,o.i18nContext,o.i18nBlock,n),jd(e,p,i,r),IT(e,p,h,s.emptyI18nPlaceholder,o.i18nContext,o.i18nBlock,n),n=void 0}}break}}function wV(e,t,i,r){let{startName:n,closeName:o}=e.i18nPlaceholder,a=Cr.ElementTag|Cr.OpenTag,s=e.handle.slot;r!==void 0&&(a|=Cr.TemplateTag,s={element:s,template:r.handle.slot}),o||(a|=Cr.CloseTag),fm(t.params,n,s,i.subTemplateIndex,a)}function EV(e,t,i,r){let{closeName:n}=e.i18nPlaceholder;if(n){let o=Cr.ElementTag|Cr.CloseTag,a=e.handle.slot;r!==void 0&&(o|=Cr.TemplateTag,a={element:a,template:r.handle.slot}),fm(t.params,n,a,i.subTemplateIndex,o)}}function DT(e,t,i,r,n,o,a){let{startName:s,closeName:c}=r,l=Cr.TemplateTag|Cr.OpenTag;c||(l|=Cr.CloseTag),a!==void 0&&fm(n.params,s,a.handle.slot,o.subTemplateIndex,l),fm(n.params,s,i,yz(e,o,t),l)}function IT(e,t,i,r,n,o,a){let{closeName:s}=r,c=Cr.TemplateTag|Cr.CloseTag;s&&(fm(n.params,s,i,yz(e,o,t),c),a!==void 0&&fm(n.params,s,a.handle.slot,o.subTemplateIndex,c))}function yz(e,t,i){for(let r of i.create)if(r.kind===k.I18nStart)return r.subTemplateIndex;return t.subTemplateIndex}function fm(e,t,i,r,n){let o=e.get(t)??[];o.push({value:i,subTemplateIndex:r,flags:n}),e.set(t,o)}function Kce(e){let t=new Map,i=new Map,r=new Map;for(let a of e.units)for(let s of a.create)switch(s.kind){case k.I18nStart:t.set(s.xref,s.subTemplateIndex);break;case k.I18nContext:i.set(s.xref,s);break;case k.IcuPlaceholder:r.set(s.xref,s);break}let n=new Map,o=a=>a.usage===gm.I18nText?a.i18nOwner:a.context;for(let a of e.units)for(let s of a.update)if(s.kind===k.I18nExpression){let c=n.get(o(s))||0,l=t.get(s.i18nOwner)??null,d={value:c,subTemplateIndex:l,flags:Cr.ExpressionIndex};Qce(s,d,i,r),n.set(o(s),c+1)}}function Qce(e,t,i,r){if(e.i18nPlaceholder!==null){let n=i.get(e.context),o=e.resolutionTime===l0.Creation?n.params:n.postprocessingParams,a=o.get(e.i18nPlaceholder)||[];a.push(t),o.set(e.i18nPlaceholder,a)}e.icuPlaceholder!==null&&r.get(e.icuPlaceholder)?.expressionPlaceholders.push(t)}function Jce(e){for(let t of e.units)eD(t,t.create,null),eD(t,t.update,null)}function eD(e,t,i){let r=new Map;for(let n of t)switch(n.kind){case k.Variable:switch(n.variable.kind){case io.Identifier:case io.Alias:if(r.has(n.variable.identifier))continue;r.set(n.variable.identifier,n.xref);break;case io.SavedView:i={view:n.variable.view,variable:n.xref};break}break;case k.Listener:case k.TwoWayListener:eD(e,n.handlerOps,i);break}for(let n of t)n.kind==k.Listener||n.kind===k.TwoWayListener||mo(n,o=>{if(o instanceof Ra)return r.has(o.name)?new $c(r.get(o.name)):new ca(new Gc(e.job.root.xref),o.name);if(o instanceof Rw&&typeof o.view=="number"){if(i===null||i.view!==o.view)throw new Error(`AssertionError: no saved view ${o.view} from view ${e.xref}`);return o.view=new $c(i.variable),o}else return o},nr.None);for(let n of t)La(n,o=>{if(o instanceof Ra)throw new Error(`AssertionError: no lexical reads should remain, but found read of ${o.name}`)})}var ede=new Map([[Oi.HTML,T.sanitizeHtml],[Oi.RESOURCE_URL,T.sanitizeResourceUrl],[Oi.SCRIPT,T.sanitizeScript],[Oi.STYLE,T.sanitizeStyle],[Oi.URL,T.sanitizeUrl]]),tde=new Map([[Oi.HTML,T.trustConstantHtml],[Oi.RESOURCE_URL,T.trustConstantResourceUrl]]);function ide(e){for(let t of e.units){let i=$D(t);if(e.kind!==dt.Host){for(let r of t.create)if(r.kind===k.ExtractedAttribute){let n=tde.get(CV(r.securityContext))??null;r.trustedValueFn=n!==null?Xe(n):null}}for(let r of t.update)switch(r.kind){case k.Property:case k.Attribute:case k.HostProperty:let n=null;if(Array.isArray(r.securityContext)&&r.securityContext.length===2&&r.securityContext.indexOf(Oi.URL)>-1&&r.securityContext.indexOf(Oi.RESOURCE_URL)>-1?n=T.sanitizeUrlOrResourceUrl:n=ede.get(CV(r.securityContext))??null,r.sanitizer=n!==null?Xe(n):null,r.sanitizer===null){let o=!1;if(e.kind===dt.Host||r.kind===k.HostProperty)o=!0;else{let a=i.get(r.target);if(a===void 0||!iu(a))throw Error("Property should have an element-like owner");o=rde(a)}o&&VD(r.name)&&(r.sanitizer=Xe(T.validateIframeAttribute))}break}}}function rde(e){return e.kind===k.ElementStart&&e.tag?.toLowerCase()==="iframe"}function CV(e){if(Array.isArray(e)){if(e.length>1)throw Error("AssertionError: Ambiguous security context");return e[0]||Oi.NONE}return e}function nde(e){for(let t of e.units)for(let i of t.create)i.kind===k.TwoWayListener&&mo(i,r=>r instanceof Fw?ode(r.target,r.value):r,nr.InChildOperation)}function Vx(e,t){return e instanceof $c?_V(e,t):_V(e,t).or(e.set(t))}function zx(e){return e instanceof ca||e instanceof ql||e instanceof $c}function ode(e,t){if(zx(e))return Vx(e,t);if(e instanceof Si&&zx(e.rhs))return new Si(e.operator,e.lhs,Vx(e.rhs,t));if(e instanceof ns&&zx(e.falseCase))return new ns(e.condition,e.trueCase,Vx(e.falseCase,t));if(e instanceof Bc){let i=e.condition;for(;;)if(i instanceof Bc)i=i.condition;else{if(zx(i))return Vx(i,t);break}}throw new Error("Unsupported expression in two-way action binding.")}function ade(e){for(let t of e.units){t.create.prepend([jf(t.job.allocateXrefId(),{kind:io.SavedView,name:null,view:t.xref},new TA,Hl.None)]);for(let i of t.create){if(i.kind!==k.Listener&&i.kind!==k.TwoWayListener)continue;let r=t!==e.root;if(!r)for(let n of i.handlerOps)La(n,o=>{o instanceof Pw&&(r=!0)});r&&sde(t,i)}}}function sde(e,t){t.handlerOps.prepend([jf(e.job.allocateXrefId(),{kind:io.Context,name:null,view:e.xref},new Rw(e.xref),Hl.None)]);for(let i of t.handlerOps)i.kind===k.Statement&&i.statement instanceof Rn&&(i.statement.value=new AA(i.statement.value))}function lde(e){let t=new Map;for(let i of e.units){let r=0;for(let n of i.create)vm(n)&&(n.handle.slot=r,t.set(n.xref,n.handle.slot),r+=n.numSlotsUsed);i.decls=r}for(let i of e.units)for(let r of i.ops())if(r.kind===k.Template||r.kind===k.RepeaterCreate){let n=e.views.get(r.xref);r.decls=n.decls}}function cde(e){for(let t of e.units)for(let i of t.update)if(i.kind===k.Binding)switch(i.bindingKind){case Et.ClassName:if(i.expression instanceof Cn)throw new Error("Unexpected interpolation in ClassName binding");Ie.replace(i,Ioe(i.target,i.name,i.expression,i.sourceSpan));break;case Et.StyleProperty:Ie.replace(i,Doe(i.target,i.name,i.expression,i.unit,i.sourceSpan));break;case Et.Property:case Et.Template:i.name==="style"?Ie.replace(i,Moe(i.target,i.expression,i.sourceSpan)):i.name==="class"&&Ie.replace(i,koe(i.target,i.expression,i.sourceSpan));break}}function dde(e){for(let t of e.units)t.create.prepend(tD(t.create)),t.update.prepend(tD(t.update))}function tD(e){let t=0,i=[];for(let r of e){let n=new Map;La(r,(l,d)=>{d&nr.InChildOperation||l instanceof Wc&&n.set(l.xref,l)});let o=0,a=new Set,s=new Set,c=new Map;La(r,(l,d)=>{d&nr.InChildOperation||(l instanceof _l?(a.has(l.xref)||(a.add(l.xref),c.set(l.xref,`tmp_${t}_${o++}`)),SV(c,l)):l instanceof Wc&&(n.get(l.xref)===l&&(s.add(l.xref),o--),SV(c,l)))}),i.push(...Array.from(new Set(c.values())).map(l=>Zl(new Ro(l)))),t++,(r.kind===k.Listener||r.kind===k.TwoWayListener)&&r.handlerOps.prepend(tD(r.handlerOps))}return i}function SV(e,t){let i=e.get(t.xref);if(i===void 0)throw new Error(`Found xref with unassigned name: ${t.xref}`);t.name=i}function ude(e){for(let t of e.units)for(let i of t.create){if(i.kind!==k.RepeaterCreate||i.trackByFn!==null)continue;let r=!1;i.track=ut(i.track,a=>{if(a instanceof rp||a instanceof Lw)throw new Error("Illegal State: Pipes are not allowed in this context");return a instanceof Nw?(r=!0,ft("this")):a},nr.None);let n,o=[new Dr("$index"),new Dr("$item")];r?n=new Lh(o,[new Rn(i.track)]):n=ro(o,i.track),i.trackByFn=e.pool.getSharedFunctionReference(n,"_forTrack")}}function hde(e){for(let t of e.units)for(let i of t.create)i.kind===k.RepeaterCreate&&(i.track instanceof rs&&i.track.name==="$index"?i.trackByFn=Xe(T.repeaterTrackByIndex):i.track instanceof rs&&i.track.name==="$item"?i.trackByFn=Xe(T.repeaterTrackByIdentity):pde(e.root.xref,i.track)?(i.usesComponentInstance=!0,i.track.receiver.receiver.view===t.xref?i.trackByFn=i.track.receiver:(i.trackByFn=Xe(T.componentInstance).callFn([]).prop(i.track.receiver.name),i.track=i.trackByFn)):i.track=ut(i.track,r=>r instanceof Gc?(i.usesComponentInstance=!0,new Nw(r.view)):r,nr.None))}function pde(e,t){if(!(t instanceof la)||t.args.length!==2||!(t.receiver instanceof ca&&t.receiver.receiver instanceof Gc)||t.receiver.receiver.view!==e)return!1;let[i,r]=t.args;return!(!(i instanceof rs)||i.name!=="$index"||!(r instanceof rs)||r.name!=="$item")}function fde(e){for(let t of e.units)for(let i of t.create)i.kind===k.RepeaterCreate&&(i.track=ut(i.track,r=>{if(r instanceof Ra){if(r.name===i.varNames.$index)return ft("$index");if(r.name===i.varNames.$implicit)return ft("$item")}return r},nr.None))}function mde(e){for(let t of e.units){let i=0;for(let r of t.ops())yT(r)&&(i+=gde(r));for(let r of t.ops())La(r,n=>{Kl(n)&&(e.compatibility===os.TemplateDefinitionBuilder&&n instanceof ip||(B8(n)&&(n.varOffset=i),yT(n)&&(i+=TV(n))))});if(e.compatibility===os.TemplateDefinitionBuilder)for(let r of t.ops())La(r,n=>{!Kl(n)||!(n instanceof ip)||(B8(n)&&(n.varOffset=i),yT(n)&&(i+=TV(n)))});t.vars=i}if(e instanceof u0)for(let t of e.units)for(let i of t.create){if(i.kind!==k.Template&&i.kind!==k.RepeaterCreate)continue;let r=e.views.get(i.xref);i.vars=r.vars}}function gde(e){let t;switch(e.kind){case k.Property:case k.HostProperty:case k.Attribute:return t=1,e.expression instanceof Cn&&!vde(e.expression)&&(t+=e.expression.expressions.length),t;case k.TwoWayProperty:return 1;case k.StyleProp:case k.ClassProp:case k.StyleMap:case k.ClassMap:return t=2,e.expression instanceof Cn&&(t+=e.expression.expressions.length),t;case k.InterpolateText:return e.interpolation.expressions.length;case k.I18nExpression:case k.Conditional:case k.DeferWhen:return 1;case k.RepeaterCreate:return e.emptyView?1:0;default:throw new Error(`Unhandled op: ${k[e.kind]}`)}}function TV(e){switch(e.kind){case Nt.PureFunctionExpr:return 1+e.args.length;case Nt.PipeBinding:return 1+e.args.length;case Nt.PipeBindingVariadic:return 1+e.numArgs;default:throw new Error(`AssertionError: unhandled ConsumesVarsTrait expression ${e.constructor.name}`)}}function vde(e){return!(e.expressions.length!==1||e.strings.length!==2||e.strings[0]!==""||e.strings[1]!=="")}function _de(e){for(let t of e.units){MT(t.create),MT(t.update);for(let i of t.create)(i.kind===k.Listener||i.kind===k.TwoWayListener)&&MT(i.handlerOps);kT(t.create,e.compatibility),kT(t.update,e.compatibility);for(let i of t.create)(i.kind===k.Listener||i.kind===k.TwoWayListener)&&kT(i.handlerOps,e.compatibility)}}var eo=function(e){return e[e.None=0]="None",e[e.ViewContextRead=1]="ViewContextRead",e[e.ViewContextWrite=2]="ViewContextWrite",e[e.SideEffectful=4]="SideEffectful",e}(eo||{});function MT(e){let t=new Map;for(let i of e)i.kind===k.Variable&&i.flags&Hl.AlwaysInline&&(La(i,r=>{if(Kl(r)&&qD(r)!==eo.None)throw new Error("AssertionError: A context-sensitive variable was marked AlwaysInline")}),t.set(i.xref,i)),mo(i,r=>r instanceof $c&&t.has(r.xref)?t.get(r.xref).initializer.clone():r,nr.None);for(let i of t.values())Ie.remove(i)}function kT(e,t){let i=new Map,r=new Map,n=new Set,o=new Map;for(let l of e){if(l.kind===k.Variable){if(i.has(l.xref)||r.has(l.xref))throw new Error(`Should not see two declarations of the same variable: ${l.xref}`);i.set(l.xref,l),r.set(l.xref,0)}o.set(l,bde(l)),yde(l,r,n)}let a=!1;for(let l of e.reversed()){let d=o.get(l);if(l.kind===k.Variable&&r.get(l.xref)===0){if(a&&d.fences&eo.ViewContextWrite||d.fences&eo.SideEffectful){let u=Zl(l.initializer.toStmt());o.set(u,d),Ie.replace(l,u)}else xde(l,r),Ie.remove(l);o.delete(l),i.delete(l.xref),r.delete(l.xref);continue}d.fences&eo.ViewContextRead&&(a=!0)}let s=[];for(let[l,d]of r){let h=!!(i.get(l).flags&Hl.AlwaysInline);d!==1||h||n.has(l)||s.push(l)}let c;for(;c=s.pop();){let l=i.get(c),d=o.get(l);if(!!(l.flags&Hl.AlwaysInline))throw new Error("AssertionError: Found an 'AlwaysInline' variable after the always inlining pass.");for(let h=l.next;h.kind!==k.ListEnd;h=h.next){let p=o.get(h);if(p.variablesUsed.has(c)){if(t===os.TemplateDefinitionBuilder&&!Ede(l,h))break;if(wde(c,l.initializer,h,d.fences)){p.variablesUsed.delete(c);for(let m of d.variablesUsed)p.variablesUsed.add(m);p.fences|=d.fences,i.delete(c),r.delete(c),o.delete(l),Ie.remove(l)}break}if(!xz(p.fences,d.fences))break}}}function qD(e){switch(e.kind){case Nt.NextContext:return eo.ViewContextRead|eo.ViewContextWrite;case Nt.RestoreView:return eo.ViewContextRead|eo.ViewContextWrite|eo.SideEffectful;case Nt.Reference:return eo.ViewContextRead;default:return eo.None}}function bde(e){let t=eo.None,i=new Set;return La(e,r=>{if(Kl(r))switch(r.kind){case Nt.ReadVariable:i.add(r.xref);break;default:t|=qD(r)}}),{fences:t,variablesUsed:i}}function yde(e,t,i){La(e,(r,n)=>{if(!Kl(r)||r.kind!==Nt.ReadVariable)return;let o=t.get(r.xref);o!==void 0&&(t.set(r.xref,o+1),n&nr.InChildOperation&&i.add(r.xref))})}function xde(e,t){La(e,i=>{if(!Kl(i)||i.kind!==Nt.ReadVariable)return;let r=t.get(i.xref);if(r!==void 0){if(r===0)throw new Error(`Inaccurate variable count: ${i.xref} - found another read but count is already 0`);t.set(i.xref,r-1)}})}function xz(e,t){if(e&eo.ViewContextWrite){if(t&eo.ViewContextRead)return!1}else if(e&eo.ViewContextRead&&t&eo.ViewContextWrite)return!1;return!0}function wde(e,t,i,r){let n=!1,o=!0;return mo(i,(a,s)=>{if(!Kl(a)||n||!o)return a;if(s&nr.InChildOperation&&r&eo.ViewContextRead)return a;switch(a.kind){case Nt.ReadVariable:if(a.xref===e)return n=!0,t;break;default:let c=qD(a);o=o&&xz(c,r);break}return a},nr.None),n}function Ede(e,t){switch(e.variable.kind){case io.Identifier:return e.initializer instanceof rs&&e.initializer.name==="ctx";case io.Context:return t.kind===k.Variable;default:return!0}}function Cde(e){for(let t of e.units){let i=null,r=null;for(let n of t.create)switch(n.kind){case k.I18nStart:i=n;break;case k.I18nEnd:i=null;break;case k.IcuStart:i===null&&(r=e.allocateXrefId(),Ie.insertBefore(f1(r,n.message,void 0,null),n));break;case k.IcuEnd:r!==null&&(Ie.insertAfter(m1(r,null),n),r=null);break}}}var Sde=[{kind:dt.Tmpl,fn:xle},{kind:dt.Host,fn:Zae},{kind:dt.Tmpl,fn:nle},{kind:dt.Tmpl,fn:Dle},{kind:dt.Tmpl,fn:Cde},{kind:dt.Both,fn:bae},{kind:dt.Both,fn:cde},{kind:dt.Both,fn:aae},{kind:dt.Both,fn:rae},{kind:dt.Tmpl,fn:_ae},{kind:dt.Both,fn:yle},{kind:dt.Tmpl,fn:$ce},{kind:dt.Both,fn:cae},{kind:dt.Both,fn:ble},{kind:dt.Tmpl,fn:dae},{kind:dt.Tmpl,fn:Cle},{kind:dt.Tmpl,fn:yae},{kind:dt.Tmpl,fn:tle},{kind:dt.Tmpl,fn:gae},{kind:dt.Tmpl,fn:qce},{kind:dt.Tmpl,fn:iae},{kind:dt.Tmpl,fn:eae},{kind:dt.Tmpl,fn:Ale},{kind:dt.Both,fn:kle},{kind:dt.Tmpl,fn:$ae},{kind:dt.Tmpl,fn:Wae},{kind:dt.Tmpl,fn:ade},{kind:dt.Both,fn:Qoe},{kind:dt.Both,fn:Yce},{kind:dt.Tmpl,fn:fde},{kind:dt.Both,fn:Jce},{kind:dt.Tmpl,fn:xae},{kind:dt.Tmpl,fn:nde},{kind:dt.Tmpl,fn:hde},{kind:dt.Both,fn:Xce},{kind:dt.Both,fn:ide},{kind:dt.Tmpl,fn:ile},{kind:dt.Both,fn:ple},{kind:dt.Both,fn:Sae},{kind:dt.Both,fn:dde},{kind:dt.Tmpl,fn:lde},{kind:dt.Tmpl,fn:Zce},{kind:dt.Tmpl,fn:Kce},{kind:dt.Tmpl,fn:zae},{kind:dt.Tmpl,fn:ude},{kind:dt.Tmpl,fn:Zse},{kind:dt.Tmpl,fn:Xae},{kind:dt.Both,fn:fae},{kind:dt.Tmpl,fn:Wce},{kind:dt.Both,fn:mde},{kind:dt.Tmpl,fn:Gae},{kind:dt.Both,fn:_de},{kind:dt.Both,fn:ole},{kind:dt.Tmpl,fn:vae},{kind:dt.Tmpl,fn:lle},{kind:dt.Tmpl,fn:dle},{kind:dt.Tmpl,fn:Cae},{kind:dt.Tmpl,fn:hle},{kind:dt.Both,fn:Mle},{kind:dt.Both,fn:jce},{kind:dt.Both,fn:lae}];function wz(e,t){for(let i of Sde)(i.kind===t||i.kind===dt.Both)&&i.fn(e)}function Tde(e,t){let i=Cz(e.root);return Ez(e.root,t),i}function Ez(e,t){for(let i of e.job.units){if(i.parent!==e.xref)continue;Ez(i,t);let r=Cz(i);t.statements.push(r.toDeclStmt(r.name))}}function Cz(e){if(e.fnName===null)throw new Error(`AssertionError: view ${e.xref} is unnamed`);let t=[];for(let o of e.create){if(o.kind!==k.Statement)throw new Error(`AssertionError: expected all create ops to have been compiled, but got ${k[o.kind]}`);t.push(o.statement)}let i=[];for(let o of e.update){if(o.kind!==k.Statement)throw new Error(`AssertionError: expected all update ops to have been compiled, but got ${k[o.kind]}`);i.push(o.statement)}let r=Kw(1,t),n=Kw(2,i);return Xl([new Dr("rf"),new Dr("ctx")],[...r,...n],void 0,void 0,e.fnName)}function Kw(e,t){return t.length===0?[]:[w0(new Si(et.BitwiseAnd,ft("rf"),U(e)),t)]}function Ade(e){if(e.root.fnName===null)throw new Error("AssertionError: host binding function is unnamed");let t=[];for(let o of e.root.create){if(o.kind!==k.Statement)throw new Error(`AssertionError: expected all create ops to have been compiled, but got ${k[o.kind]}`);t.push(o.statement)}let i=[];for(let o of e.root.update){if(o.kind!==k.Statement)throw new Error(`AssertionError: expected all update ops to have been compiled, but got ${k[o.kind]}`);i.push(o.statement)}if(t.length===0&&i.length===0)return null;let r=Kw(1,t),n=Kw(2,i);return Xl([new Dr("rf"),new Dr("ctx")],[...r,...n],void 0,void 0,e.root.fnName)}var Sz=os.TemplateDefinitionBuilder,Oh=new pm,Rh="ng-template";function Dde(e,t,i,r,n,o,a){let s=new u0(e,i,Sz,r,n,o,a);return au(s.root,t),s}function Ide(e,t,i){let r=new jw(e.componentName,i,Sz);for(let n of e.properties??[]){let o=Et.Property;n.name.startsWith("attr.")&&(n.name=n.name.substring(5),o=Et.Attribute),n.isAnimation&&(o=Et.Animation);let a=t.calcPossibleSecurityContexts(e.componentSelector,n.name,o===Et.Attribute).filter(s=>s!==Oi.NONE);Mde(r,n,o,a)}for(let[n,o]of Object.entries(e.attributes)??[]){let a=t.calcPossibleSecurityContexts(e.componentSelector,n,!0).filter(s=>s!==Oi.NONE);kde(r,n,o,a)}for(let n of e.events??[])Pde(r,n);return r}function Mde(e,t,i,r){let n,o=t.expression.ast;o instanceof En?n=new Cn(o.strings,o.expressions.map(a=>ui(a,e,t.sourceSpan)),[]):n=ui(o,e,t.sourceSpan),e.root.update.push(tp(e.root.xref,i,t.name,n,null,r,!1,!1,null,null,t.sourceSpan))}function kde(e,t,i,r){let n=tp(e.root.xref,Et.Attribute,t,i,null,r,!0,!1,null,null,i.sourceSpan);e.root.update.push(n)}function Pde(e,t){let[i,r]=t.type!==1?[null,t.targetOrPhase]:[t.targetOrPhase,null],n=GD(e.root.xref,new as,t.name,null,XD(e.root,t.handler,t.handlerSpan),i,r,!0,t.sourceSpan);e.root.create.push(n)}function au(e,t){for(let i of t)if(i instanceof da)Nde(e,i);else if(i instanceof Fa)Ode(e,i);else if(i instanceof vw)Rde(e,i);else if(i instanceof Rc)Tz(e,i,null);else if(i instanceof Hh)Az(e,i,null);else if(i instanceof mw)Fde(e,i);else if(i instanceof fw)Lde(e,i);else if(i instanceof jh)Bde(e,i);else if(i instanceof Qv)Vde(e,i);else if(i instanceof em)zde(e,i);else throw new Error(`Unsupported template node: ${i.constructor.name}`)}function Nde(e,t){if(t.i18n!==void 0&&!(t.i18n instanceof Oo||t.i18n instanceof Kd))throw Error(`Unhandled i18n metadata type for element: ${t.i18n.constructor.name}`);let i=e.job.allocateXrefId(),[r,n]=sa(t.name),o=Boe(n,i,oz(r),t.i18n instanceof Kd?t.i18n:void 0,t.startSourceSpan,t.sourceSpan);e.create.push(o),Hde(e,o,t),Mz(o,t);let a=null;t.i18n instanceof Oo&&(a=e.job.allocateXrefId(),e.create.push(f1(a,t.i18n,void 0,t.startSourceSpan))),au(e,t.children);let s=zoe(i,t.endSourceSpan??t.startSourceSpan);e.create.push(s),a!==null&&Ie.insertBefore(m1(a,t.endSourceSpan??t.startSourceSpan),s)}function Ode(e,t){if(t.i18n!==void 0&&!(t.i18n instanceof Oo||t.i18n instanceof Kd))throw Error(`Unhandled i18n metadata type for template: ${t.i18n.constructor.name}`);let i=e.job.allocateView(e.xref),r=t.tagName,n="";t.tagName&&([n,r]=sa(t.tagName));let o=t.i18n instanceof Kd?t.i18n:void 0,a=oz(n),s=r===null?"":pae(r,a),c=Ude(t)?ts.NgTemplate:ts.Structural,l=p1(i.xref,c,r,s,a,o,t.startSourceSpan,t.sourceSpan);e.create.push(l),jde(e,l,t,c),Mz(l,t),au(i,t.children);for(let{name:d,value:u}of t.variables)i.contextVariables.set(d,u!==""?u:"$implicit");if(c===ts.NgTemplate&&t.i18n instanceof Oo){let d=e.job.allocateXrefId();Ie.insertAfter(f1(d,t.i18n,void 0,t.startSourceSpan),i.create.head),Ie.insertBefore(m1(d,t.endSourceSpan??t.startSourceSpan),i.create.tail)}}function Rde(e,t){if(t.i18n!==void 0&&!(t.i18n instanceof Kd))throw Error(`Unhandled i18n metadata type for element: ${t.i18n.constructor.name}`);let i=$oe(e.job.allocateXrefId(),t.selector,t.i18n,t.sourceSpan);for(let r of t.attributes){let n=Oh.securityContext(t.name,r.name,!0);e.update.push(tp(i.xref,Et.Attribute,r.name,U(r.value),null,n,!0,!1,null,Oc(r.i18n),r.sourceSpan))}e.create.push(i)}function Tz(e,t,i){e.create.push(ez(e.job.allocateXrefId(),t.value,i,t.sourceSpan))}function Az(e,t,i){let r=t.value;if(r instanceof Oa&&(r=r.ast),!(r instanceof En))throw new Error(`AssertionError: expected Interpolation for BoundText node, got ${r.constructor.name}`);if(t.i18n!==void 0&&!(t.i18n instanceof jl))throw Error(`Unhandled i18n metadata type for text interpolation: ${t.i18n?.constructor.name}`);let n=t.i18n instanceof jl?t.i18n.children.filter(s=>s instanceof Jv).map(s=>s.name):[];if(n.length>0&&n.length!==r.expressions.length)throw Error(`Unexpected number of i18n placeholders (${r.expressions.length}) for BoundText with ${r.expressions.length} expressions`);let o=e.job.allocateXrefId();e.create.push(ez(o,"",i,t.sourceSpan));let a=e.job.compatibility?null:t.sourceSpan;e.update.push(Soe(o,new Cn(r.strings,r.expressions.map(s=>ui(s,e.job,a)),n),t.sourceSpan))}function Fde(e,t){let i=null,r=null,n=[];for(let a=0;a<t.branches.length;a++){let s=t.branches[a],c=e.job.allocateView(e.xref),l=null;a===0&&(l=rD(e,c.xref,s)),s.expressionAlias!==null&&c.contextVariables.set(s.expressionAlias.name,nz);let d;if(s.i18n!==void 0){if(!(s.i18n instanceof Uc))throw Error(`Unhandled i18n metadata type for if block: ${s.i18n?.constructor.name}`);d=s.i18n}let u=p1(c.xref,ts.Block,l,"Conditional",No.HTML,d,s.startSourceSpan,s.sourceSpan);e.create.push(u),i===null&&(i=c.xref,r=u.handle);let h=s.expression?ui(s.expression,e.job,null):null,p=new Vw(h,u.xref,u.handle,s.expressionAlias);n.push(p),au(c,s.children)}let o=K6(i,r,null,n,t.sourceSpan);e.update.push(o)}function Lde(e,t){if(t.cases.length===0)return;let i=null,r=null,n=[];for(let a of t.cases){let s=e.job.allocateView(e.xref),c;if(a.i18n!==void 0){if(!(a.i18n instanceof Uc))throw Error(`Unhandled i18n metadata type for switch block: ${a.i18n?.constructor.name}`);c=a.i18n}let l=p1(s.xref,ts.Block,null,"Case",No.HTML,c,a.startSourceSpan,a.sourceSpan);e.create.push(l),i===null&&(i=s.xref,r=l.handle);let d=a.expression?ui(a.expression,e.job,t.startSourceSpan):null,u=new Vw(d,l.xref,l.handle);n.push(u),au(s,a.children)}let o=K6(i,r,ui(t.expression,e.job,null),n,t.sourceSpan);e.update.push(o)}function Ux(e,t,i,r,n){if(i!==void 0&&!(i instanceof Uc))throw Error("Unhandled i18n metadata type for defer block");if(r===void 0)return null;let o=e.job.allocateView(e.xref);au(o,r);let a=p1(o.xref,ts.Block,null,`Defer${t}`,No.HTML,i,n,n);return e.create.push(a),a}function Bde(e,t){let i=e.job.deferBlocksMeta.get(t);if(i===void 0)throw new Error("AssertionError: unable to find metadata for deferred block");let r=Ux(e,"",t.i18n,t.children,t.sourceSpan),n=Ux(e,"Loading",t.loading?.i18n,t.loading?.children,t.loading?.sourceSpan),o=Ux(e,"Placeholder",t.placeholder?.i18n,t.placeholder?.children,t.placeholder?.sourceSpan),a=Ux(e,"Error",t.error?.i18n,t.error?.children,t.error?.sourceSpan),s=e.job.allocateXrefId(),c=Woe(s,r.xref,r.handle,i,e.job.allDeferrableDepsFn,t.sourceSpan);c.placeholderView=o?.xref??null,c.placeholderSlot=o?.handle??null,c.loadingSlot=n?.handle??null,c.errorSlot=a?.handle??null,c.placeholderMinimumTime=t.placeholder?.minimumTime??null,c.loadingMinimumTime=t.loading?.minimumTime??null,c.loadingAfterTime=t.loading?.afterTime??null,e.create.push(c);let l=!1,d=[],u=[];for(let h of[t.triggers,t.prefetchTriggers]){if(h.idle!==void 0){let p=Eh(s,{kind:Vr.Idle},l,h.idle.sourceSpan);d.push(p)}if(h.immediate!==void 0){let p=Eh(s,{kind:Vr.Immediate},l,h.immediate.sourceSpan);d.push(p)}if(h.timer!==void 0){let p=Eh(s,{kind:Vr.Timer,delay:h.timer.delay},l,h.timer.sourceSpan);d.push(p)}if(h.hover!==void 0){let p=Eh(s,{kind:Vr.Hover,targetName:h.hover.reference,targetXref:null,targetSlot:null,targetView:null,targetSlotViewSteps:null},l,h.hover.sourceSpan);d.push(p)}if(h.interaction!==void 0){let p=Eh(s,{kind:Vr.Interaction,targetName:h.interaction.reference,targetXref:null,targetSlot:null,targetView:null,targetSlotViewSteps:null},l,h.interaction.sourceSpan);d.push(p)}if(h.viewport!==void 0){let p=Eh(s,{kind:Vr.Viewport,targetName:h.viewport.reference,targetXref:null,targetSlot:null,targetView:null,targetSlotViewSteps:null},l,h.viewport.sourceSpan);d.push(p)}if(h.when!==void 0){if(h.when.value instanceof En)throw new Error("Unexpected interpolation in defer block when trigger");let p=Roe(s,ui(h.when.value,e.job,h.when.sourceSpan),l,h.when.sourceSpan);u.push(p)}d.length===0&&u.length===0&&d.push(Eh(s,{kind:Vr.Idle},!1,null)),l=!0}e.create.push(d),e.update.push(u)}function Vde(e,t){if(t.i18n instanceof Oo&&kv(t.i18n)){let i=e.job.allocateXrefId();e.create.push(Xoe(i,t.i18n,ND(t.i18n).name,null));for(let[r,n]of Object.entries(L(L({},t.vars),t.placeholders)))n instanceof Hh?Az(e,n,r):Tz(e,n,r);e.create.push(Yoe(i))}else throw Error(`Unhandled i18n metadata type for ICU: ${t.i18n?.constructor.name}`)}function zde(e,t){let i=e.job.allocateView(e.xref);i.contextVariables.set(t.item.name,t.item.value),i.contextVariables.set(t.contextVariables.$index.name,t.contextVariables.$index.value),i.contextVariables.set(t.contextVariables.$count.name,t.contextVariables.$count.value);let r=`\u0275${t.contextVariables.$index.name}_${i.xref}`,n=`\u0275${t.contextVariables.$count.name}_${i.xref}`;i.contextVariables.set(r,t.contextVariables.$index.value),i.contextVariables.set(n,t.contextVariables.$count.value),i.aliases.add({kind:io.Alias,name:null,identifier:t.contextVariables.$first.name,expression:new Ra(r).identical(U(0))}),i.aliases.add({kind:io.Alias,name:null,identifier:t.contextVariables.$last.name,expression:new Ra(r).identical(new Ra(n).minus(U(1)))}),i.aliases.add({kind:io.Alias,name:null,identifier:t.contextVariables.$even.name,expression:new Ra(r).modulo(U(2)).identical(U(0))}),i.aliases.add({kind:io.Alias,name:null,identifier:t.contextVariables.$odd.name,expression:new Ra(r).modulo(U(2)).notIdentical(U(0))});let o=ho(t.trackBy.span,t.sourceSpan),a=ui(t.trackBy,e.job,o);au(i,t.children);let s=null,c=null;t.empty!==null&&(s=e.job.allocateView(e.xref),au(s,t.empty.children),c=rD(e,s.xref,t.empty));let l={$index:t.contextVariables.$index.name,$count:t.contextVariables.$count.name,$first:t.contextVariables.$first.name,$last:t.contextVariables.$last.name,$even:t.contextVariables.$even.name,$odd:t.contextVariables.$odd.name,$implicit:t.item.name};if(t.i18n!==void 0&&!(t.i18n instanceof Uc))throw Error("AssertionError: Unhandled i18n metadata type or @for");if(t.empty?.i18n!==void 0&&!(t.empty.i18n instanceof Uc))throw Error("AssertionError: Unhandled i18n metadata type or @empty");let d=t.i18n,u=t.empty?.i18n,h=rD(e,i.xref,t),p=Voe(i.xref,s?.xref??null,h,a,l,c,d,u,t.startSourceSpan,t.sourceSpan);e.create.push(p);let m=ui(t.expression,e.job,ho(t.expression.span,t.sourceSpan)),f=Ooe(p.xref,p.handle,m,t.sourceSpan);e.update.push(f)}function ui(e,t,i){if(e instanceof Oa)return ui(e.ast,t,i);if(e instanceof to){let r=e.receiver instanceof Yd,n=e.receiver instanceof Po&&!(e.receiver instanceof Yd),o=e.name==="$any"||e.name==="$event";return n||r&&!o?new Ra(e.name):new ca(ui(e.receiver,t,i),e.name,null,ho(e.span,i))}else{if(e instanceof rm)return e.receiver instanceof Po?new Zf(new Gc(t.root.xref),e.name,ui(e.value,t,i),null,ho(e.span,i)):new Zf(ui(e.receiver,t,i),e.name,ui(e.value,t,i),void 0,ho(e.span,i));if(e instanceof om)return new zv(ui(e.receiver,t,i),ui(e.key,t,i),ui(e.value,t,i),void 0,ho(e.span,i));if(e instanceof Yl){if(e.receiver instanceof Po)throw new Error("Unexpected ImplicitReceiver");return new la(ui(e.receiver,t,i),e.args.map(r=>ui(r,t,i)),void 0,ho(e.span,i))}else{if(e instanceof ko)return U(e.value,void 0,ho(e.span,i));if(e instanceof jc)switch(e.operator){case"+":return new Vh(Fh.Plus,ui(e.expr,t,i),void 0,ho(e.span,i));case"-":return new Vh(Fh.Minus,ui(e.expr,t,i),void 0,ho(e.span,i));default:throw new Error(`AssertionError: unknown unary operator ${e.operator}`)}else if(e instanceof ka){let r=uae.get(e.operation);if(r===void 0)throw new Error(`AssertionError: unknown binary operator ${e.operation}`);return new Si(r,ui(e.left,t,i),ui(e.right,t,i),void 0,ho(e.span,i))}else{if(e instanceof Yd)return new Gc(t.root.xref);if(e instanceof Hc)return new ql(ui(e.receiver,t,i),ui(e.key,t,i),void 0,ho(e.span,i));if(e instanceof Jd)throw new Error("AssertionError: Chain in unknown context");if(e instanceof am){let r=e.keys.map((n,o)=>{let a=e.values[o];return new Kf(n.key,ui(a,t,i),n.quoted)});return new vl(r,void 0,ho(e.span,i))}else{if(e instanceof Zh)return new Hs(e.expressions.map(r=>ui(r,t,i)));if(e instanceof qh)return new ns(ui(e.condition,t,i),ui(e.trueExp,t,i),ui(e.falseExp,t,i),void 0,ho(e.span,i));if(e instanceof Qh)return ui(e.expression,t,i);if(e instanceof Yh)return new rp(t.allocateXrefId(),new as,e.name,[ui(e.exp,t,i),...e.args.map(r=>ui(r,t,i))]);if(e instanceof Xh)return new cm(ui(e.receiver,t,i),ui(e.key,t,i),ho(e.span,i));if(e instanceof nm)return new lm(ui(e.receiver,t,i),e.name);if(e instanceof Jh)return new tu(ui(e.receiver,t,i),e.args.map(r=>ui(r,t,i)));if(e instanceof Mo)return new c0(ho(e.span,i));if(e instanceof Kh)return h6(ui(e.expression,t,i),ho(e.span,i));throw new Error(`Unhandled expression type "${e.constructor.name}" in file "${i?.start.file.url}"`)}}}}}function iD(e,t,i,r){let n;return t instanceof En?n=new Cn(t.strings,t.expressions.map(o=>ui(o,e,r??null)),Object.keys(Oc(i)?.placeholders??{})):t instanceof _n?n=ui(t,e,r??null):n=U(t),n}var Dz=new Map([[0,Et.Property],[5,Et.TwoWayProperty],[1,Et.Attribute],[2,Et.ClassName],[3,Et.StyleProperty],[4,Et.Animation]]);function Ude(e){return sa(e.tagName??"")[1]===Rh}function Oc(e){if(e==null)return null;if(!(e instanceof Oo))throw Error(`Expected i18n meta to be a Message, but got: ${e.constructor.name}`);return e}function Hde(e,t,i){let r=new Array,n=new Set;for(let o of i.attributes){let a=Oh.securityContext(i.name,o.name,!0);r.push(tp(t.xref,Et.Attribute,o.name,iD(e.job,o.value,o.i18n),null,a,!0,!1,null,Oc(o.i18n),o.sourceSpan)),o.i18n&&n.add(o.name)}for(let o of i.inputs)n.has(o.name)&&console.error(`On component ${e.job.componentName}, the binding ${o.name} is both an i18n attribute and a property. You may want to remove the property binding. This will become a compilation error in future versions of Angular.`),r.push(tp(t.xref,Dz.get(o.type),o.name,iD(e.job,g0(o.value),o.i18n),o.unit,o.securityContext,!1,!1,null,Oc(o.i18n)??null,o.sourceSpan));e.create.push(r.filter(o=>o?.kind===k.ExtractedAttribute)),e.update.push(r.filter(o=>o?.kind===k.Binding));for(let o of i.outputs){if(o.type===1&&o.phase===null)throw Error("Animation listener should have a phase");o.type===2?e.create.push(tz(t.xref,t.handle,o.name,t.tag,Iz(e,o.handler,o.handlerSpan),o.sourceSpan)):e.create.push(GD(t.xref,t.handle,o.name,t.tag,XD(e,o.handler,o.handlerSpan),o.phase,o.target,!1,o.sourceSpan))}r.some(o=>o?.i18nMessage)!==null&&e.create.push(rz(e.job.allocateXrefId(),new as,t.xref))}function jde(e,t,i,r){let n=new Array;for(let o of i.templateAttrs)if(o instanceof Jf){let a=Oh.securityContext(Rh,o.name,!0);n.push(Hx(e,t.xref,1,o.name,o.value,null,a,!0,r,Oc(o.i18n),o.sourceSpan))}else n.push(Hx(e,t.xref,o.type,o.name,g0(o.value),o.unit,o.securityContext,!0,r,Oc(o.i18n),o.sourceSpan));for(let o of i.attributes){let a=Oh.securityContext(Rh,o.name,!0);n.push(Hx(e,t.xref,1,o.name,o.value,null,a,!1,r,Oc(o.i18n),o.sourceSpan))}for(let o of i.inputs)n.push(Hx(e,t.xref,o.type,o.name,g0(o.value),o.unit,o.securityContext,!1,r,Oc(o.i18n),o.sourceSpan));e.create.push(n.filter(o=>o?.kind===k.ExtractedAttribute)),e.update.push(n.filter(o=>o?.kind===k.Binding));for(let o of i.outputs){if(o.type===1&&o.phase===null)throw Error("Animation listener should have a phase");if(r===ts.NgTemplate&&(o.type===2?e.create.push(tz(t.xref,t.handle,o.name,t.tag,Iz(e,o.handler,o.handlerSpan),o.sourceSpan)):e.create.push(GD(t.xref,t.handle,o.name,t.tag,XD(e,o.handler,o.handlerSpan),o.phase,o.target,!1,o.sourceSpan))),r===ts.Structural&&o.type!==1){let a=Oh.securityContext(Rh,o.name,!1);e.create.push(Vs(t.xref,Et.Property,null,o.name,null,null,null,a))}}n.some(o=>o?.i18nMessage)!==null&&e.create.push(rz(e.job.allocateXrefId(),new as,t.xref))}function Hx(e,t,i,r,n,o,a,s,c,l,d){let u=typeof n=="string";if(c===ts.Structural){if(!s)switch(i){case 0:case 2:case 3:return Vs(t,Et.Property,null,r,null,null,l,a);case 5:return Vs(t,Et.TwoWayProperty,null,r,null,null,l,a)}if(!u&&(i===1||i===4))return null}let h=Dz.get(i);return c===ts.NgTemplate&&(i===2||i===3||i===1&&!u)&&(h=Et.Property),tp(t,h,r,iD(e.job,n,l),o,a,u,s,c,l,d)}function XD(e,t,i){t=g0(t);let r=new Array,n=t instanceof Jd?t.expressions:[t];if(n.length===0)throw new Error("Expected listener to have non-empty expression list.");let o=n.map(s=>ui(s,e.job,i)),a=o.pop();return r.push(...o.map(s=>Zl(new oo(s,s.sourceSpan)))),r.push(Zl(new Rn(a,a.sourceSpan))),r}function Iz(e,t,i){t=g0(t);let r=new Array;if(t instanceof Jd)if(t.expressions.length===1)t=t.expressions[0];else throw new Error("Expected two-way listener to have a single expression.");let n=ui(t,e.job,i),o=new Ra("$event"),a=new Fw(n,o);return r.push(Zl(new oo(a))),r.push(Zl(new Rn(o))),r}function g0(e){return e instanceof Oa?e.ast:e}function Mz(e,t){Gde(e.localRefs);for(let{name:i,value:r}of t.references)e.localRefs.push({name:i,target:r})}function Gde(e){if(!Array.isArray(e))throw new Error("AssertionError: expected an array")}function ho(e,t){if(t===null)return null;let i=t.start.moveBy(e.start),r=t.start.moveBy(e.end),n=t.fullStart.moveBy(e.start);return new pi(i,r,n)}function rD(e,t,i){let r=null;for(let n of i.children)if(!(n instanceof Qf)){if(r!==null)return null;(n instanceof da||n instanceof Fa&&n.tagName!==null)&&(r=n)}if(r!==null){for(let o of r.attributes){let a=Oh.securityContext(Rh,o.name,!0);e.update.push(tp(t,Et.Attribute,o.name,U(o.value),null,a,!0,!1,null,Oc(o.i18n),o.sourceSpan))}for(let o of r.inputs)if(o.type!==4&&o.type!==1){let a=Oh.securityContext(Rh,o.name,!0);e.create.push(Vs(t,Et.Property,null,o.name,null,null,null,a))}let n=r instanceof da?r.name:r.tagName;return n===Rh?null:n}return null}var kz=!1,nD=class extends XA{constructor(){super(cz)}parse(t,i,r){return super.parse(t,i,r)}},Pz="ngPreserveWhitespaces",$de=new Set(["pre","template","textarea","script","style"]),Nz=` \f
\r	\v\u1680\u180E\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF`,Wde=new RegExp(`[^${Nz}]`),qde=new RegExp(`[${Nz}]{2,}`,"g");function Xde(e){return e.some(t=>t.name===Pz)}function Oz(e){return e.replace(new RegExp(dz,"g")," ")}var oD=class{visitElement(t,i){return $de.has(t.name)||Xde(t.attrs)?new Ls(t.name,nn(this,t.attrs),t.children,t.sourceSpan,t.startSourceSpan,t.endSourceSpan,t.i18n):new Ls(t.name,t.attrs,AV(this,t.children),t.sourceSpan,t.startSourceSpan,t.endSourceSpan,t.i18n)}visitAttribute(t,i){return t.name!==Pz?t:null}visitText(t,i){let r=t.value.match(Wde),n=i&&(i.prev instanceof hm||i.next instanceof hm);if(r||n){let o=t.tokens.map(s=>s.type===5?Yde(s):s),a=Rz(t.value);return new ou(a,t.sourceSpan,o,t.i18n)}return null}visitComment(t,i){return t}visitExpansion(t,i){return t}visitExpansionCase(t,i){return t}visitBlock(t,i){return new Bs(t.name,t.parameters,AV(this,t.children),t.sourceSpan,t.nameSpan,t.startSourceSpan,t.endSourceSpan)}visitBlockParameter(t,i){return t}};function Yde({type:e,parts:t,sourceSpan:i}){return{type:e,parts:[Rz(t[0])],sourceSpan:i}}function Rz(e){return Oz(e).replace(qde," ")}function AV(e,t){let i=[];return t.forEach((r,n)=>{let o={prev:t[n-1],next:t[n+1]},a=r.visit(e,o);a&&i.push(a)}),i}var DV=".",Zde="attr",Kde="class",Qde="style",Jde="*",PT="animate-",aD=class{constructor(t,i,r,n){this._exprParser=t,this._interpolationConfig=i,this._schemaRegistry=r,this.errors=n}get interpolationConfig(){return this._interpolationConfig}createBoundHostProperties(t,i){let r=[];for(let n of Object.keys(t)){let o=t[n];typeof o=="string"?this.parsePropertyBinding(n,o,!0,!1,i,i.start.offset,void 0,[],r,i):this._reportError(`Value of the host property binding "${n}" needs to be a string representing an expression but got "${o}" (${typeof o})`,i)}return r}createDirectiveHostEventAsts(t,i){let r=[];for(let n of Object.keys(t)){let o=t[n];typeof o=="string"?this.parseEvent(n,o,!1,i,i,[],r,i):this._reportError(`Value of the host listener "${n}" needs to be a string representing an expression but got "${o}" (${typeof o})`,i)}return r}parseInterpolation(t,i,r){let n=i.start.toString(),o=i.fullStart.offset;try{let a=this._exprParser.parseInterpolation(t,n,o,r,this._interpolationConfig);return a&&this._reportExpressionParserErrors(a.errors,i),a}catch(a){return this._reportError(`${a}`,i),this._exprParser.wrapLiteralPrimitive("ERROR",n,o)}}parseInterpolationExpression(t,i){let r=i.start.toString(),n=i.start.offset;try{let o=this._exprParser.parseInterpolationExpression(t,r,n);return o&&this._reportExpressionParserErrors(o.errors,i),o}catch(o){return this._reportError(`${o}`,i),this._exprParser.wrapLiteralPrimitive("ERROR",r,n)}}parseInlineTemplateBinding(t,i,r,n,o,a,s,c){let l=r.start.offset+Jde.length,d=this._parseTemplateBindings(t,i,r,l,n);for(let u of d){let h=zd(r,u.sourceSpan),p=u.key.source,m=zd(r,u.key.span);if(u instanceof o0){let f=u.value?u.value.source:"$implicit",g=u.value?zd(r,u.value.span):void 0;s.push(new _A(p,f,h,m,g))}else if(u.value){let f=c?h:r,g=zd(r,u.value.ast.sourceSpan);this._parsePropertyAst(p,u.value,!1,f,m,g,o,a)}else o.push([p,""]),this.parseLiteralAttr(p,null,m,n,void 0,o,a,m)}}_parseTemplateBindings(t,i,r,n,o){let a=r.start.toString();try{let s=this._exprParser.parseTemplateBindings(t,i,a,n,o);return this._reportExpressionParserErrors(s.errors,r),s.warnings.forEach(c=>{this._reportError(c,r,qd.WARNING)}),s.templateBindings}catch(s){return this._reportError(`${s}`,r),[]}}parseLiteralAttr(t,i,r,n,o,a,s,c){NT(t)?(t=t.substring(1),c!==void 0&&(c=zd(c,new es(c.start.offset+1,c.end.offset))),i&&this._reportError('Assigning animation triggers via @prop="exp" attributes with an expression is invalid. Use property bindings (e.g. [@prop]="exp") or use an attribute without a value (e.g. @prop) instead.',r,qd.ERROR),this._parseAnimation(t,i,r,n,c,o,a,s)):s.push(new Fv(t,this._exprParser.wrapLiteralPrimitive(i,"",n),Wd.LITERAL_ATTR,r,c,o))}parsePropertyBinding(t,i,r,n,o,a,s,c,l,d){t.length===0&&this._reportError("Property name is missing in binding",o);let u=!1;t.startsWith(PT)?(u=!0,t=t.substring(PT.length),d!==void 0&&(d=zd(d,new es(d.start.offset+PT.length,d.end.offset)))):NT(t)&&(u=!0,t=t.substring(1),d!==void 0&&(d=zd(d,new es(d.start.offset+1,d.end.offset)))),u?this._parseAnimation(t,i,o,a,d,s,c,l):this._parsePropertyAst(t,this.parseBinding(i,r,s||o,a),n,o,d,s,c,l)}parsePropertyInterpolation(t,i,r,n,o,a,s,c){let l=this.parseInterpolation(i,n||r,c);return l?(this._parsePropertyAst(t,l,!1,r,s,n,o,a),!0):!1}_parsePropertyAst(t,i,r,n,o,a,s,c){s.push([t,i.source]),c.push(new Fv(t,i,r?Wd.TWO_WAY:Wd.DEFAULT,n,o,a))}_parseAnimation(t,i,r,n,o,a,s,c){t.length===0&&this._reportError("Animation trigger is missing",r);let l=this.parseBinding(i||"undefined",!1,a||r,n);s.push([t,l.source]),c.push(new Fv(t,l,Wd.ANIMATION,r,o,a))}parseBinding(t,i,r,n){let o=(r&&r.start||"(unknown)").toString();try{let a=i?this._exprParser.parseSimpleBinding(t,o,n,this._interpolationConfig):this._exprParser.parseBinding(t,o,n,this._interpolationConfig);return a&&this._reportExpressionParserErrors(a.errors,r),a}catch(a){return this._reportError(`${a}`,r),this._exprParser.wrapLiteralPrimitive("ERROR",o,n)}}createBoundElementProperty(t,i,r=!1,n=!0){if(i.isAnimation)return new Mw(i.name,4,Oi.NONE,i.expression,null,i.sourceSpan,i.keySpan,i.valueSpan);let o=null,a,s=null,c=i.name.split(DV),l;if(c.length>1)if(c[0]==Zde){s=c.slice(1).join(DV),r||this._validatePropertyOrAttributeName(s,i.sourceSpan,!0),l=OT(this._schemaRegistry,t,s,!0);let d=s.indexOf(":");if(d>-1){let u=s.substring(0,d),h=s.substring(d+1);s=tA(u,h)}a=1}else c[0]==Kde?(s=c[1],a=2,l=[Oi.NONE]):c[0]==Qde&&(o=c.length>2?c[2]:null,s=c[1],a=3,l=[Oi.STYLE]);if(s===null){let d=this._schemaRegistry.getMappedPropName(i.name);s=n?d:i.name,l=OT(this._schemaRegistry,t,d,!1),a=i.type===Wd.TWO_WAY?5:0,r||this._validatePropertyOrAttributeName(d,i.sourceSpan,!1)}return new Mw(s,a,l[0],i.expression,o,i.sourceSpan,i.keySpan,i.valueSpan)}parseEvent(t,i,r,n,o,a,s,c){t.length===0&&this._reportError("Event name is missing in binding",n),NT(t)?(t=t.slice(1),c!==void 0&&(c=zd(c,new es(c.start.offset+1,c.end.offset))),this._parseAnimationEvent(t,i,n,o,s,c)):this._parseRegularEvent(t,i,r,n,o,a,s,c)}calcPossibleSecurityContexts(t,i,r){let n=this._schemaRegistry.getMappedPropName(i);return OT(this._schemaRegistry,t,n,r)}_parseAnimationEvent(t,i,r,n,o,a){let s=Mre(t,[t,""]),c=s[0],l=s[1].toLowerCase(),d=this._parseAction(i,n);o.push(new Iw(c,l,1,d,r,n,a)),c.length===0&&this._reportError("Animation event name is missing in binding",r),l?l!=="start"&&l!=="done"&&this._reportError(`The provided animation output phase value "${l}" for "@${c}" is not supported (use start or done)`,r):this._reportError(`The animation trigger output event (@${c}) is missing its phase value name (start or done are currently supported)`,r)}_parseRegularEvent(t,i,r,n,o,a,s,c){let[l,d]=Ire(t,[null,t]),u=this.errors.length,h=this._parseAction(i,o),p=this.errors.length===u;a.push([t,h.source]),r&&p&&!this._isAllowedAssignmentEvent(h)&&this._reportError("Unsupported expression in a two-way binding",n),s.push(new Iw(d,l,r?2:0,h,n,o,c))}_parseAction(t,i){let r=(i&&i.start||"(unknown").toString(),n=i&&i.start?i.start.offset:0;try{let o=this._exprParser.parseAction(t,r,n,this._interpolationConfig);return o&&this._reportExpressionParserErrors(o.errors,i),!o||o.ast instanceof Mo?(this._reportError("Empty expressions are not allowed",i),this._exprParser.wrapLiteralPrimitive("ERROR",r,n)):o}catch(o){return this._reportError(`${o}`,i),this._exprParser.wrapLiteralPrimitive("ERROR",r,n)}}_reportError(t,i,r=qd.ERROR){this.errors.push(new si(i,t,r))}_reportExpressionParserErrors(t,i){for(let r of t)this._reportError(r.message,i)}_validatePropertyOrAttributeName(t,i,r){let n=r?this._schemaRegistry.validateAttribute(t):this._schemaRegistry.validateProperty(t);n.error&&this._reportError(n.msg,i,qd.ERROR)}_isAllowedAssignmentEvent(t){return t instanceof Oa?this._isAllowedAssignmentEvent(t.ast):t instanceof Qh?this._isAllowedAssignmentEvent(t.expression):t instanceof to||t instanceof Hc?!0:t instanceof ka?(t.operation==="&&"||t.operation==="||"||t.operation==="??")&&(t.right instanceof to||t.right instanceof Hc):t instanceof qh||t instanceof Kh}};function NT(e){return e[0]=="@"}function OT(e,t,i,r){let n=[];return Xf.parse(t).forEach(o=>{let a=o.element?[o.element]:e.allKnownElementNames(),s=new Set(o.notSelectors.filter(l=>l.isElementSelector()).map(l=>l.element)),c=a.filter(l=>!s.has(l));n.push(...c.map(l=>e.securityContext(l,i,r)))}),n.length===0?[Oi.NONE]:Array.from(new Set(n)).sort()}function zd(e,t){let i=t.start-e.start.offset,r=t.end-e.end.offset;return new pi(e.start.moveBy(i),e.end.moveBy(r),e.fullStart.moveBy(i),e.details)}function eue(e){if(e==null||e.length===0||e[0]=="/")return!1;let t=e.match(tue);return t===null||t[1]=="package"||t[1]=="asset"}var tue=/^([^:/?#]+):/,iue="select",rue="link",nue="rel",oue="href",aue="stylesheet",sue="style",lue="script",cue="ngNonBindable",due="ngProjectAs";function Fz(e){let t=null,i=null,r=null,n=!1,o="";e.attrs.forEach(c=>{let l=c.name.toLowerCase();l==iue?t=c.value:l==oue?i=c.value:l==nue?r=c.value:c.name==cue?n=!0:c.name==due&&c.value.length>0&&(o=c.value)}),t=uue(t);let a=e.name.toLowerCase(),s=Ja.OTHER;return JT(a)?s=Ja.NG_CONTENT:a==sue?s=Ja.STYLE:a==lue?s=Ja.SCRIPT:a==rue&&r==aue&&(s=Ja.STYLESHEET),new sD(s,t,i,n,o)}var Ja=function(e){return e[e.NG_CONTENT=0]="NG_CONTENT",e[e.STYLE=1]="STYLE",e[e.STYLESHEET=2]="STYLESHEET",e[e.SCRIPT=3]="SCRIPT",e[e.OTHER=4]="OTHER",e}(Ja||{}),sD=class{constructor(t,i,r,n,o){this.type=t,this.selectAttr=i,this.hrefAttr=r,this.nonBindable=n,this.projectAs=o}};function uue(e){return e===null||e.length===0?"*":e}var hue=/^\s*([0-9A-Za-z_$]*)\s+of\s+([\S\s]*)/,pue=/^track\s+([\S\s]*)/,fue=/^(as\s)+(.*)/,YD=/^else[^\S\r\n]+if/,mue=/^let\s+([\S\s]*)/,IV=/(\s*)(\S+)(\s*)/,lD=new Set(["$index","$first","$last","$even","$odd","$count"]);function MV(e){return e==="empty"}function kV(e){return e==="else"||YD.test(e)}function gue(e,t,i,r){let n=xue(t),o=[],a=PV(e,n,r);a!==null&&o.push(new Ph(a.expression,nn(i,e.children,e.children),a.expressionAlias,e.sourceSpan,e.startSourceSpan,e.endSourceSpan,e.nameSpan,e.i18n));for(let u of t)if(YD.test(u.name)){let h=PV(u,n,r);if(h!==null){let p=nn(i,u.children,u.children);o.push(new Ph(h.expression,p,h.expressionAlias,u.sourceSpan,u.startSourceSpan,u.endSourceSpan,u.nameSpan,u.i18n))}}else if(u.name==="else"){let h=nn(i,u.children,u.children);o.push(new Ph(null,h,null,u.sourceSpan,u.startSourceSpan,u.endSourceSpan,u.nameSpan,u.i18n))}let s=o.length>0?o[0].startSourceSpan:e.startSourceSpan,c=o.length>0?o[o.length-1].endSourceSpan:e.endSourceSpan,l=e.sourceSpan,d=o[o.length-1];return d!==void 0&&(l=new pi(s.start,d.sourceSpan.end)),{node:new mw(o,l,e.startSourceSpan,c,e.nameSpan),errors:n}}function vue(e,t,i,r){let n=[],o=bue(e,n,r),a=null,s=null;for(let c of t)c.name==="empty"?s!==null?n.push(new si(c.sourceSpan,"@for loop can only have one @empty block")):c.parameters.length>0?n.push(new si(c.sourceSpan,"@empty block cannot have parameters")):s=new Zv(nn(i,c.children,c.children),c.sourceSpan,c.startSourceSpan,c.endSourceSpan,c.nameSpan,c.i18n):n.push(new si(c.sourceSpan,`Unrecognized @for loop block "${c.name}"`));if(o!==null)if(o.trackBy===null)n.push(new si(e.sourceSpan,'@for loop must have a "track" expression'));else{let c=s?.endSourceSpan??e.endSourceSpan,l=new pi(e.sourceSpan.start,c?.end??e.sourceSpan.end);a=new em(o.itemName,o.expression,o.trackBy.expression,o.trackBy.keywordSpan,o.context,nn(i,e.children,e.children),s,l,e.sourceSpan,e.startSourceSpan,c,e.nameSpan,e.i18n)}return{node:a,errors:n}}function _ue(e,t,i){let r=wue(e),n=e.parameters.length>0?v0(e.parameters[0],i):i.parseBinding("",!1,e.sourceSpan,0),o=[],a=[],s=null;for(let c of e.children){if(!(c instanceof Bs))continue;if((c.name!=="case"||c.parameters.length===0)&&c.name!=="default"){a.push(new gw(c.name,c.sourceSpan,c.nameSpan));continue}let l=c.name==="case"?v0(c.parameters[0],i):null,d=new Yv(l,nn(t,c.children,c.children),c.sourceSpan,c.startSourceSpan,c.endSourceSpan,c.nameSpan,c.i18n);l===null?s=d:o.push(d)}return s!==null&&o.push(s),{node:new fw(n,o,a,e.sourceSpan,e.startSourceSpan,e.endSourceSpan,e.nameSpan),errors:r}}function bue(e,t,i){if(e.parameters.length===0)return t.push(new si(e.sourceSpan,"@for loop does not have an expression")),null;let[r,...n]=e.parameters,o=Eue(r,t)?.match(hue);if(!o||o[2].trim().length===0)return t.push(new si(r.sourceSpan,'Cannot parse expression. @for loop expression must match the pattern "<identifier> of <expression>"')),null;let[,a,s]=o,c=r.expression.split(" ")[0],l=new pi(r.sourceSpan.start,r.sourceSpan.start.moveBy(c.length)),d={itemName:new zc(a,"$implicit",l,l),trackBy:null,expression:v0(r,i,s),context:{}};for(let u of n){let h=u.expression.match(mue);if(h!==null){let m=new pi(u.sourceSpan.start.moveBy(h[0].length-h[1].length),u.sourceSpan.end);yue(u.sourceSpan,h[1],m,d.context,t);continue}let p=u.expression.match(pue);if(p!==null){if(d.trackBy!==null)t.push(new si(u.sourceSpan,'@for loop can only have one "track" expression'));else{let m=v0(u,i,p[1]);m.ast instanceof Mo&&t.push(new si(u.sourceSpan,'@for loop must have a "track" expression'));let f=new pi(u.sourceSpan.start,u.sourceSpan.start.moveBy(5));d.trackBy={expression:m,keywordSpan:f}}continue}t.push(new si(u.sourceSpan,`Unrecognized @for loop paramater "${u.expression}"`))}for(let u of lD)if(!d.context.hasOwnProperty(u)){let h=new pi(e.startSourceSpan.end,e.startSourceSpan.end);d.context[u]=new zc(u,u,h,h)}return d}function yue(e,t,i,r,n){let o=t.split(","),a=i.start;for(let s of o){let c=s.split("="),l=c.length===2?c[0].trim():"",d=c.length===2?c[1].trim():"";if(l.length===0||d.length===0)n.push(new si(e,'Invalid @for loop "let" parameter. Parameter should match the pattern "<name> = <variable name>"'));else if(!lD.has(d))n.push(new si(e,`Unknown "let" parameter variable "${d}". The allowed variables are: ${Array.from(lD).join(", ")}`));else if(r.hasOwnProperty(d))n.push(new si(e,`Duplicate "let" parameter variable "${d}"`));else{let[,u,h]=c[0].match(IV)??[],p=u!==void 0&&c.length===2?new pi(a.moveBy(u.length),a.moveBy(u.length+h.length)):i,m;if(c.length===2){let[,g,v]=c[1].match(IV)??[];m=g!==void 0?new pi(a.moveBy(c[0].length+1+g.length),a.moveBy(c[0].length+1+g.length+v.length)):void 0}let f=new pi(p.start,m?.end??p.end);r[d]=new zc(l,d,f,p,m)}a=a.moveBy(s.length+1)}}function xue(e){let t=[],i=!1;for(let r=0;r<e.length;r++){let n=e[r];n.name==="else"?(i?t.push(new si(n.sourceSpan,"Conditional can only have one @else block")):e.length>1&&r<e.length-1?t.push(new si(n.sourceSpan,"@else block must be last inside the conditional")):n.parameters.length>0&&t.push(new si(n.sourceSpan,"@else block cannot have parameters")),i=!0):YD.test(n.name)||t.push(new si(n.sourceSpan,`Unrecognized conditional block @${n.name}`))}return t}function wue(e){let t=[],i=!1;if(e.parameters.length!==1)return t.push(new si(e.sourceSpan,"@switch block must have exactly one parameter")),t;for(let r of e.children)if(!(r instanceof f0||r instanceof ou&&r.value.trim().length===0)){if(!(r instanceof Bs)||r.name!=="case"&&r.name!=="default"){t.push(new si(r.sourceSpan,"@switch block can only contain @case and @default blocks"));continue}r.name==="default"?(i?t.push(new si(r.sourceSpan,"@switch block can only have one @default block")):r.parameters.length>0&&t.push(new si(r.sourceSpan,"@default block cannot have parameters")),i=!0):r.name==="case"&&r.parameters.length!==1&&t.push(new si(r.sourceSpan,"@case block must have exactly one parameter"))}return t}function v0(e,t,i){let r,n;return typeof i=="string"?(r=Math.max(0,e.expression.lastIndexOf(i)),n=r+i.length):(r=0,n=e.expression.length),t.parseBinding(e.expression.slice(r,n),!1,e.sourceSpan,e.sourceSpan.start.offset+r)}function PV(e,t,i){if(e.parameters.length===0)return t.push(new si(e.sourceSpan,"Conditional block does not have an expression")),null;let r=v0(e.parameters[0],i),n=null;for(let o=1;o<e.parameters.length;o++){let a=e.parameters[o],s=a.expression.match(fue);if(s===null)t.push(new si(a.sourceSpan,`Unrecognized conditional paramater "${a.expression}"`));else if(e.name!=="if")t.push(new si(a.sourceSpan,'"as" expression is only allowed on the primary @if block'));else if(n!==null)t.push(new si(a.sourceSpan,'Conditional can only have one "as" expression'));else{let c=s[2].trim(),l=a.sourceSpan.start.moveBy(s[1].length),d=new pi(l,l.moveBy(c.length));n=new zc(c,c,d,d)}}return{expression:r,expressionAlias:n}}function Eue(e,t){let i=e.expression,r=/^\s$/,n=0,o=0,a=i.length-1;for(let s=0;s<i.length;s++){let c=i[s];if(c==="(")o=s+1,n++;else{if(r.test(c))continue;break}}if(n===0)return i;for(let s=i.length-1;s>-1;s--){let c=i[s];if(c===")"){if(a=s,n--,n===0)break}else{if(r.test(c))continue;break}}return n!==0?(t.push(new si(e.sourceSpan,"Unclosed parentheses in expression")),null):i.slice(o,a)}var Cue=/^\d+\.?\d*(ms|s)?$/,Sue=/^\s$/,NV=new Map([[Ul,Pa],[qf,Uf],[Fc,ml]]),Na=function(e){return e.IDLE="idle",e.TIMER="timer",e.INTERACTION="interaction",e.IMMEDIATE="immediate",e.HOVER="hover",e.VIEWPORT="viewport",e}(Na||{});function OV({expression:e,sourceSpan:t},i,r,n){let o=e.indexOf("when"),a=new pi(t.start.moveBy(o),t.start.moveBy(o+4)),s=Lz(e,t);if(o===-1)n.push(new si(t,'Could not find "when" keyword in expression'));else{let c=_0(e,o+1),l=i.parseBinding(e.slice(c),!1,t,t.start.offset+c);Bz("when",r,n,new iA(l,t,s,a))}}function RV({expression:e,sourceSpan:t},i,r,n){let o=e.indexOf("on"),a=new pi(t.start.moveBy(o),t.start.moveBy(o+2)),s=Lz(e,t);if(o===-1)r.push(new si(t,'Could not find "on" keyword in expression'));else{let c=_0(e,o+1);new cD(e,c,t,i,r,n,s,a).parse()}}function Lz(e,t){return e.startsWith("prefetch")?new pi(t.start,t.start.moveBy(8)):null}var cD=class{constructor(t,i,r,n,o,a,s,c){this.expression=t,this.start=i,this.span=r,this.triggers=n,this.errors=o,this.placeholder=a,this.prefetchSpan=s,this.onSourceSpan=c,this.index=0,this.tokens=new p0().tokenize(t.slice(i))}parse(){for(;this.tokens.length>0&&this.index<this.tokens.length;){let t=this.token();if(!t.isIdentifier()){this.unexpectedToken(t);break}if(this.isFollowedByOrLast(zs))this.consumeTrigger(t,[]),this.advance();else if(this.isFollowedByOrLast(Fc)){this.advance();let i=this.errors.length,r=this.consumeParameters();if(this.errors.length!==i)break;this.consumeTrigger(t,r),this.advance()}else this.index<this.tokens.length-1&&this.unexpectedToken(this.tokens[this.index+1]);this.advance()}}advance(){this.index++}isFollowedByOrLast(t){return this.index===this.tokens.length-1?!0:this.tokens[this.index+1].isCharacter(t)}token(){return this.tokens[Math.min(this.index,this.tokens.length-1)]}consumeTrigger(t,i){let r=this.span.start.moveBy(this.start+t.index-this.tokens[0].index),n=new pi(r,r.moveBy(t.strValue.length)),o=r.moveBy(this.token().end-t.index),a=t.index===0,s=a?this.onSourceSpan:null,c=a?this.prefetchSpan:null,l=new pi(a?this.span.start:r,o);try{switch(t.toString()){case Na.IDLE:this.trackTrigger("idle",Tue(i,n,l,c,s));break;case Na.TIMER:this.trackTrigger("timer",Aue(i,n,l,this.prefetchSpan,this.onSourceSpan));break;case Na.INTERACTION:this.trackTrigger("interaction",Mue(i,n,l,this.prefetchSpan,this.onSourceSpan,this.placeholder));break;case Na.IMMEDIATE:this.trackTrigger("immediate",Due(i,n,l,this.prefetchSpan,this.onSourceSpan));break;case Na.HOVER:this.trackTrigger("hover",Iue(i,n,l,this.prefetchSpan,this.onSourceSpan,this.placeholder));break;case Na.VIEWPORT:this.trackTrigger("viewport",kue(i,n,l,this.prefetchSpan,this.onSourceSpan,this.placeholder));break;default:throw new Error(`Unrecognized trigger type "${t}"`)}}catch(d){this.error(t,d.message)}}consumeParameters(){let t=[];if(!this.token().isCharacter(Fc))return this.unexpectedToken(this.token()),t;this.advance();let i=[],r="";for(;this.index<this.tokens.length;){let n=this.token();if(n.isCharacter(ml)&&i.length===0){r.length&&t.push(r);break}if(n.type===Ci.Character&&NV.has(n.numValue)&&i.push(NV.get(n.numValue)),i.length>0&&n.isCharacter(i[i.length-1])&&i.pop(),i.length===0&&n.isCharacter(zs)&&r.length>0){t.push(r),r="",this.advance();continue}r+=this.tokenText(),this.advance()}return(!this.token().isCharacter(ml)||i.length>0)&&this.error(this.token(),"Unexpected end of expression"),this.index<this.tokens.length-1&&!this.tokens[this.index+1].isCharacter(zs)&&this.unexpectedToken(this.tokens[this.index+1]),t}tokenText(){return this.expression.slice(this.start+this.token().index,this.start+this.token().end)}trackTrigger(t,i){Bz(t,this.triggers,this.errors,i)}error(t,i){let r=this.span.start.moveBy(this.start+t.index),n=r.moveBy(t.end-t.index);this.errors.push(new si(new pi(r,n),i))}unexpectedToken(t){this.error(t,`Unexpected token "${t}"`)}};function Bz(e,t,i,r){t[e]?i.push(new si(r.sourceSpan,`Duplicate "${e}" trigger is not allowed`)):t[e]=r}function Tue(e,t,i,r,n){if(e.length>0)throw new Error(`"${Na.IDLE}" trigger cannot have parameters`);return new rA(t,i,r,n)}function Aue(e,t,i,r,n){if(e.length!==1)throw new Error(`"${Na.TIMER}" trigger must have exactly one parameter`);let o=Qw(e[0]);if(o===null)throw new Error(`Could not parse time value of trigger "${Na.TIMER}"`);return new oA(o,t,i,r,n)}function Due(e,t,i,r,n){if(e.length>0)throw new Error(`"${Na.IMMEDIATE}" trigger cannot have parameters`);return new nA(t,i,r,n)}function Iue(e,t,i,r,n,o){return ZD(Na.HOVER,e,o),new uw(e[0]??null,t,i,r,n)}function Mue(e,t,i,r,n,o){return ZD(Na.INTERACTION,e,o),new hw(e[0]??null,t,i,r,n)}function kue(e,t,i,r,n,o){return ZD(Na.VIEWPORT,e,o),new pw(e[0]??null,t,i,r,n)}function ZD(e,t,i){if(t.length>1)throw new Error(`"${e}" trigger can only have zero or one parameters`);if(t.length===0){if(i===null)throw new Error(`"${e}" trigger with no parameters can only be placed on an @defer that has a @placeholder block`);if(i.children.length!==1||!(i.children[0]instanceof da))throw new Error(`"${e}" trigger with no parameters can only be placed on an @defer that has a @placeholder block with exactly one root element node`)}}function _0(e,t=0){let i=!1;for(let r=t;r<e.length;r++)if(Sue.test(e[r]))i=!0;else if(i)return r;return-1}function Qw(e){let t=e.match(Cue);if(!t)return null;let[i,r]=t;return parseFloat(i)*(r==="s"?1e3:1)}var Pue=/^prefetch\s+when\s/,Nue=/^prefetch\s+on\s/,Vz=/^minimum\s/,Oue=/^after\s/,Rue=/^when\s/,Fue=/^on\s/;function dD(e){return e==="placeholder"||e==="loading"||e==="error"}function Lue(e,t,i,r){let n=[],{placeholder:o,loading:a,error:s}=Bue(t,n,i),{triggers:c,prefetchTriggers:l}=Hue(e.parameters,r,n,o),d=e.endSourceSpan,u=e.sourceSpan.end;if(t.length>0){let m=t[t.length-1];d=m.endSourceSpan,u=m.sourceSpan.end}let h=new pi(e.sourceSpan.start,u);return{node:new jh(nn(i,e.children,e.children),c,l,o,a,s,e.nameSpan,h,e.sourceSpan,e.startSourceSpan,d,e.i18n),errors:n}}function Bue(e,t,i){let r=null,n=null,o=null;for(let a of e)try{if(!dD(a.name)){t.push(new si(a.startSourceSpan,`Unrecognized block "@${a.name}"`));break}switch(a.name){case"placeholder":r!==null?t.push(new si(a.startSourceSpan,"@defer block can only have one @placeholder block")):r=Vue(a,i);break;case"loading":n!==null?t.push(new si(a.startSourceSpan,"@defer block can only have one @loading block")):n=zue(a,i);break;case"error":o!==null?t.push(new si(a.startSourceSpan,"@defer block can only have one @error block")):o=Uue(a,i);break}}catch(s){t.push(new si(a.startSourceSpan,s.message))}return{placeholder:r,loading:n,error:o}}function Vue(e,t){let i=null;for(let r of e.parameters)if(Vz.test(r.expression)){if(i!=null)throw new Error('@placeholder block can only have one "minimum" parameter');let n=Qw(r.expression.slice(_0(r.expression)));if(n===null)throw new Error('Could not parse time value of parameter "minimum"');i=n}else throw new Error(`Unrecognized parameter in @placeholder block: "${r.expression}"`);return new Wv(nn(t,e.children,e.children),i,e.nameSpan,e.sourceSpan,e.startSourceSpan,e.endSourceSpan,e.i18n)}function zue(e,t){let i=null,r=null;for(let n of e.parameters)if(Oue.test(n.expression)){if(i!=null)throw new Error('@loading block can only have one "after" parameter');let o=Qw(n.expression.slice(_0(n.expression)));if(o===null)throw new Error('Could not parse time value of parameter "after"');i=o}else if(Vz.test(n.expression)){if(r!=null)throw new Error('@loading block can only have one "minimum" parameter');let o=Qw(n.expression.slice(_0(n.expression)));if(o===null)throw new Error('Could not parse time value of parameter "minimum"');r=o}else throw new Error(`Unrecognized parameter in @loading block: "${n.expression}"`);return new qv(nn(t,e.children,e.children),i,r,e.nameSpan,e.sourceSpan,e.startSourceSpan,e.endSourceSpan,e.i18n)}function Uue(e,t){if(e.parameters.length>0)throw new Error("@error block cannot have parameters");return new Xv(nn(t,e.children,e.children),e.nameSpan,e.sourceSpan,e.startSourceSpan,e.endSourceSpan,e.i18n)}function Hue(e,t,i,r){let n={},o={};for(let a of e)Rue.test(a.expression)?OV(a,t,n,i):Fue.test(a.expression)?RV(a,n,i,r):Pue.test(a.expression)?OV(a,t,o,i):Nue.test(a.expression)?RV(a,o,i,r):i.push(new si(a.sourceSpan,"Unrecognized trigger"));return{triggers:n,prefetchTriggers:o}}var jue=/^(?:(bind-)|(let-)|(ref-|#)|(on-)|(bindon-)|(@))(.*)$/,FV=1,LV=2,BV=3,VV=4,zV=5,Gue=6,Iv=7,Ud={BANANA_BOX:{start:"[(",end:")]"},PROPERTY:{start:"[",end:"]"},EVENT:{start:"(",end:")"}},UV="*";function $ue(e,t,i){let r=new uD(t,i),n=nn(r,e,e),o=t.errors.concat(r.errors),a={nodes:n,errors:o,styleUrls:r.styleUrls,styles:r.styles,ngContentSelectors:r.ngContentSelectors};return i.collectCommentNodes&&(a.commentNodes=r.commentNodes),a}var uD=class{constructor(t,i){this.bindingParser=t,this.options=i,this.errors=[],this.styles=[],this.styleUrls=[],this.ngContentSelectors=[],this.commentNodes=[],this.inI18nBlock=!1,this.processedNodes=new Set}visitElement(t){let i=e0(t.i18n);i&&(this.inI18nBlock&&this.reportError("Cannot mark an element as translatable inside of a translatable section. Please remove the nested i18n marker.",t.sourceSpan),this.inI18nBlock=!0);let r=Fz(t);if(r.type===Ja.SCRIPT)return null;if(r.type===Ja.STYLE){let g=Yue(t);return g!==null&&this.styles.push(g),null}else if(r.type===Ja.STYLESHEET&&eue(r.hrefAttr))return this.styleUrls.push(r.hrefAttr),null;let n=Kre(t.name),o=[],a=[],s=[],c=[],l=[],d={},u=[],h=[],p=!1;for(let g of t.attrs){let v=!1,_=HV(g.name),b=!1;if(g.i18n&&(d[g.name]=g.i18n),_.startsWith(UV)){p&&this.reportError("Can't have multiple template bindings on one element. Use only one attribute prefixed with *",g.sourceSpan),b=!0,p=!0;let y=g.value,x=_.substring(UV.length),w=[],I=g.valueSpan?g.valueSpan.start.offset:g.sourceSpan.start.offset+g.name.length;this.bindingParser.parseInlineTemplateBinding(x,y,g.sourceSpan,I,[],u,w,!0),h.push(...w.map(S=>new zc(S.name,S.value,S.sourceSpan,S.keySpan,S.valueSpan)))}else v=this.parseAttribute(n,g,[],o,a,s,c);!v&&!b&&l.push(this.visitAttribute(g))}let m;r.nonBindable?m=nn(Wue,t.children).flat(1/0):m=nn(this,t.children,t.children);let f;if(r.type===Ja.NG_CONTENT){t.children&&!t.children.every(_=>que(_)||Xue(_))&&this.reportError("<ng-content> element cannot have content.",t.sourceSpan);let g=r.selectAttr,v=t.attrs.map(_=>this.visitAttribute(_));f=new vw(g,v,t.sourceSpan,t.i18n),this.ngContentSelectors.push(g)}else if(n){let g=this.extractAttributes(t.name,o,d);f=new Fa(t.name,l,g.bound,a,[],m,c,s,t.sourceSpan,t.startSourceSpan,t.endSourceSpan,t.i18n)}else{let g=this.extractAttributes(t.name,o,d);f=new da(t.name,l,g.bound,a,m,c,t.sourceSpan,t.startSourceSpan,t.endSourceSpan,t.i18n)}if(p){let g=this.extractAttributes("ng-template",u,d),v=[];g.literal.forEach(x=>v.push(x)),g.bound.forEach(x=>v.push(x));let _=f instanceof da?{attributes:f.attributes,inputs:f.inputs,outputs:f.outputs}:{attributes:[],inputs:[],outputs:[]},b=n&&i?void 0:t.i18n,y=f instanceof Fa?null:f.name;f=new Fa(y,_.attributes,_.inputs,_.outputs,v,[f],[],h,t.sourceSpan,t.startSourceSpan,t.endSourceSpan,b)}return i&&(this.inI18nBlock=!1),f}visitAttribute(t){return new Jf(t.name,t.value,t.sourceSpan,t.keySpan,t.valueSpan,t.i18n)}visitText(t){return this.processedNodes.has(t)?null:this._visitTextWithInterpolation(t.value,t.sourceSpan,t.tokens,t.i18n)}visitExpansion(t){if(!t.i18n)return null;if(!e0(t.i18n))throw new Error(`Invalid type "${t.i18n.constructor}" for "i18n" property of ${t.sourceSpan.toString()}. Expected a "Message"`);let i=t.i18n,r={},n={};return Object.keys(i.placeholders).forEach(o=>{let a=i.placeholders[o];if(o.startsWith(ine)){let s=o.trim(),c=this.bindingParser.parseInterpolationExpression(a.text,a.sourceSpan);r[s]=new Hh(c,a.sourceSpan)}else n[o]=this._visitTextWithInterpolation(a.text,a.sourceSpan,null)}),new Qv(r,n,t.sourceSpan,i)}visitExpansionCase(t){return null}visitComment(t){return this.options.collectCommentNodes&&this.commentNodes.push(new Qf(t.value||"",t.sourceSpan)),null}visitBlockParameter(){return null}visitBlock(t,i){let r=Array.isArray(i)?i.indexOf(t):-1;if(r===-1)throw new Error("Visitor invoked incorrectly. Expecting visitBlock to be invoked siblings array as its context");if(this.processedNodes.has(t))return null;let n=null;switch(t.name){case"defer":n=Lue(t,this.findConnectedBlocks(r,i,dD),this,this.bindingParser);break;case"switch":n=_ue(t,this,this.bindingParser);break;case"for":n=vue(t,this.findConnectedBlocks(r,i,MV),this,this.bindingParser);break;case"if":n=gue(t,this.findConnectedBlocks(r,i,kV),this,this.bindingParser);break;default:let o;dD(t.name)?(o=`@${t.name} block can only be used after an @defer block.`,this.processedNodes.add(t)):MV(t.name)?(o=`@${t.name} block can only be used after an @for block.`,this.processedNodes.add(t)):kV(t.name)?(o=`@${t.name} block can only be used after an @if or @else if block.`,this.processedNodes.add(t)):o=`Unrecognized block @${t.name}.`,n={node:new gw(t.name,t.sourceSpan,t.nameSpan),errors:[new si(t.sourceSpan,o)]};break}return this.errors.push(...n.errors),n.node}findConnectedBlocks(t,i,r){let n=[];for(let o=t+1;o<i.length;o++){let a=i[o];if(a instanceof ou&&a.value.trim().length===0){this.processedNodes.add(a);continue}if(!(a instanceof Bs)||!r(a.name))break;n.push(a),this.processedNodes.add(a)}return n}extractAttributes(t,i,r){let n=[],o=[];return i.forEach(a=>{let s=r[a.name];if(a.isLiteral)o.push(new Jf(a.name,a.expression.source||"",a.sourceSpan,a.keySpan,a.valueSpan,s));else{let c=this.bindingParser.createBoundElementProperty(t,a,!0,!1);n.push(cw.fromBoundElementProperty(c,s))}}),{bound:n,literal:o}}parseAttribute(t,i,r,n,o,a,s){let c=HV(i.name),l=i.value,d=i.sourceSpan,u=i.valueSpan?i.valueSpan.start.offset:d.start.offset;function h(v,_,b){let y=i.name.length-c.length,x=v.start.moveBy(_.length+y),w=x.moveBy(b.length);return new pi(x,w,x,b)}let p=c.match(jue);if(p){if(p[FV]!=null){let v=p[Iv],_=h(d,p[FV],v);this.bindingParser.parsePropertyBinding(v,l,!1,!1,d,u,i.valueSpan,r,n,_)}else if(p[LV])if(t){let v=p[Iv],_=h(d,p[LV],v);this.parseVariable(v,l,d,_,i.valueSpan,a)}else this.reportError('"let-" is only supported on ng-template elements.',d);else if(p[BV]){let v=p[Iv],_=h(d,p[BV],v);this.parseReference(v,l,d,_,i.valueSpan,s)}else if(p[VV]){let v=[],_=p[Iv],b=h(d,p[VV],_);this.bindingParser.parseEvent(_,l,!1,d,i.valueSpan||d,r,v,b),RT(v,o)}else if(p[zV]){let v=p[Iv],_=h(d,p[zV],v);this.bindingParser.parsePropertyBinding(v,l,!1,!0,d,u,i.valueSpan,r,n,_),this.parseAssignmentEvent(v,l,d,i.valueSpan,r,o,_)}else if(p[Gue]){let v=h(d,"",c);this.bindingParser.parseLiteralAttr(c,l,d,u,i.valueSpan,r,n,v)}return!0}let m=null;if(c.startsWith(Ud.BANANA_BOX.start)?m=Ud.BANANA_BOX:c.startsWith(Ud.PROPERTY.start)?m=Ud.PROPERTY:c.startsWith(Ud.EVENT.start)&&(m=Ud.EVENT),m!==null&&c.endsWith(m.end)&&c.length>m.start.length+m.end.length){let v=c.substring(m.start.length,c.length-m.end.length),_=h(d,m.start,v);if(m.start===Ud.BANANA_BOX.start)this.bindingParser.parsePropertyBinding(v,l,!1,!0,d,u,i.valueSpan,r,n,_),this.parseAssignmentEvent(v,l,d,i.valueSpan,r,o,_);else if(m.start===Ud.PROPERTY.start)this.bindingParser.parsePropertyBinding(v,l,!1,!1,d,u,i.valueSpan,r,n,_);else{let b=[];this.bindingParser.parseEvent(v,l,!1,d,i.valueSpan||d,r,b,_),RT(b,o)}return!0}let f=h(d,"",c);return this.bindingParser.parsePropertyInterpolation(c,l,d,i.valueSpan,r,n,f,i.valueTokens??null)}_visitTextWithInterpolation(t,i,r,n){let o=Oz(t),a=this.bindingParser.parseInterpolation(o,i,r);return a?new Hh(a,i,n):new Rc(o,i)}parseVariable(t,i,r,n,o,a){t.indexOf("-")>-1?this.reportError('"-" is not allowed in variable names',r):t.length===0&&this.reportError("Variable does not have a name",r),a.push(new zc(t,i,r,n,o))}parseReference(t,i,r,n,o,a){t.indexOf("-")>-1?this.reportError('"-" is not allowed in reference names',r):t.length===0?this.reportError("Reference does not have a name",r):a.some(s=>s.name===t)&&this.reportError(`Reference "#${t}" is defined more than once`,r),a.push(new Kv(t,i,r,n,o))}parseAssignmentEvent(t,i,r,n,o,a,s){let c=[];this.bindingParser.parseEvent(`${t}Change`,i,!0,r,n||r,o,c,s),RT(c,a)}reportError(t,i,r=qd.ERROR){this.errors.push(new si(i,t,r))}},hD=class{visitElement(t){let i=Fz(t);if(i.type===Ja.SCRIPT||i.type===Ja.STYLE||i.type===Ja.STYLESHEET)return null;let r=nn(this,t.children,null);return new da(t.name,nn(this,t.attrs),[],[],r,[],t.sourceSpan,t.startSourceSpan,t.endSourceSpan)}visitComment(t){return null}visitAttribute(t){return new Jf(t.name,t.value,t.sourceSpan,t.keySpan,t.valueSpan,t.i18n)}visitText(t){return new Rc(t.value,t.sourceSpan)}visitExpansion(t){return null}visitExpansionCase(t){return null}visitBlock(t,i){let r=[new Rc(t.startSourceSpan.toString(),t.startSourceSpan),...nn(this,t.children)];return t.endSourceSpan!==null&&r.push(new Rc(t.endSourceSpan.toString(),t.endSourceSpan)),r}visitBlockParameter(t,i){return null}},Wue=new hD;function HV(e){return/^data-/i.test(e)?e.substring(5):e}function RT(e,t){t.push(...e.map(i=>dw.fromParsedEvent(i)))}function que(e){return e instanceof ou&&e.value.trim().length==0}function Xue(e){return e instanceof f0}function Yue(e){return e.children.length!==1||!(e.children[0]instanceof ou)?null:e.children[0].value}var Bl=function(e){return e[e.ELEMENT=0]="ELEMENT",e[e.TEMPLATE=1]="TEMPLATE",e}(Bl||{});function Zue(){return{getUniqueId:sne(),icus:new Map}}var pD=class e{constructor(t,i,r=0,n=null,o,a){this.index=t,this.ref=i,this.level=r,this.templateIndex=n,this.meta=o,this.registry=a,this.bindings=new Set,this.placeholders=new Map,this.isEmitted=!1,this._unresolvedCtxCount=0,this._registry=a||Zue(),this.id=this._registry.getUniqueId()}appendTag(t,i,r,n){if(i.isVoid&&n)return;let o=i.isVoid||!n?i.startName:i.closeName,a={type:t,index:r,ctx:this.id,isVoid:i.isVoid,closed:n};Pv(this.placeholders,o,a)}appendBlockPart(t,i,r){let n=r?t.closeName:t.startName,o={type:Bl.TEMPLATE,index:i,ctx:this.id,closed:r};Pv(this.placeholders,n,o)}get icus(){return this._registry.icus}get isRoot(){return this.level===0}get isResolved(){return this._unresolvedCtxCount===0}getSerializedPlaceholders(){let t=new Map;return this.placeholders.forEach((i,r)=>t.set(r,i.map(Kue))),t}appendBinding(t){this.bindings.add(t)}appendIcu(t,i){Pv(this._registry.icus,t,i)}appendBoundText(t){x6(t,this.bindings.size,this.id).forEach((r,n)=>Pv(this.placeholders,n,...r))}appendTemplate(t,i){this.appendTag(Bl.TEMPLATE,t,i,!1),this.appendTag(Bl.TEMPLATE,t,i,!0),this._unresolvedCtxCount++}appendBlock(t,i){this.appendBlockPart(t,i,!1),this.appendBlockPart(t,i,!0),this._unresolvedCtxCount++}appendElement(t,i,r){this.appendTag(Bl.ELEMENT,t,i,r)}appendProjection(t,i){this.appendTag(Bl.ELEMENT,t,i,!1),this.appendTag(Bl.ELEMENT,t,i,!0)}forkChildContext(t,i,r){return new e(t,this.ref,this.level+1,i,r,this._registry)}reconcileChildContext(t){["start","close"].forEach(r=>{let n=t.meta[`${r}Name`],a=(this.placeholders.get(n)||[]).find(GV(this.id,t.templateIndex));a&&(a.ctx=t.id)}),t.placeholders.forEach((r,n)=>{let o=this.placeholders.get(n);if(!o){this.placeholders.set(n,r);return}let a=o.findIndex(GV(t.id,t.templateIndex));if(a>=0){let s=n.startsWith("CLOSE");if(n.endsWith("NG-TEMPLATE"))o.splice(a+(s?0:1),0,...r);else{let l=s?r.length-1:0;r[l].tmpl=o[a],o.splice(a,1,...r)}}else o.push(...r);this.placeholders.set(n,o)}),this._unresolvedCtxCount--}};function FT(e,t,i,r){return o1(`${r?"/":""}${e}${t}`,i)}function jV(e,{index:t,ctx:i,isVoid:r},n){return r?FT(e,t,i)+FT(e,t,i,!0):FT(e,t,i,n)}function GV(e,t){return i=>typeof i=="object"&&i.type===Bl.TEMPLATE&&i.index===t&&i.ctx===e}function Kue(e){let t=(r,n)=>jV("#",r,n),i=(r,n)=>jV("*",r,n);switch(e.type){case Bl.ELEMENT:return e.closed?t(e,!0)+(e.tmpl?i(e.tmpl,!0):""):e.tmpl?i(e.tmpl)+t(e)+(e.isVoid?i(e.tmpl,!0):""):t(e);case Bl.TEMPLATE:return i(e,e.closed);default:return e}}var Que="!important",Jw=2,e1=class{constructor(t){this._directiveExpr=t,this._hasInitialValues=!1,this.hasBindings=!1,this.hasBindingsWithPipes=!1,this._classMapInput=null,this._styleMapInput=null,this._singleStyleInputs=null,this._singleClassInputs=null,this._lastStylingInput=null,this._firstStylingInput=null,this._stylesIndex=new Map,this._classesIndex=new Map,this._initialStyleValues=[],this._initialClassValues=[]}registerBoundInput(t){let i=null,r=t.name;switch(t.type){case 0:i=this.registerInputBasedOnName(r,t.value,t.sourceSpan);break;case 3:i=this.registerStyleInput(r,!1,t.value,t.sourceSpan,t.unit);break;case 2:i=this.registerClassInput(r,!1,t.value,t.sourceSpan);break}return!!i}registerInputBasedOnName(t,i,r){let n=null,o=t.substring(0,6),a=t==="style"||o==="style."||o==="style!";if(a||!a&&(t==="class"||o==="class."||o==="class!")){let c=t.charAt(5)!==".",l=t.slice(c?5:6);a?n=this.registerStyleInput(l,c,i,r):n=this.registerClassInput(l,c,i,r)}return n}registerStyleInput(t,i,r,n,o){if(qV(r))return null;ihe(t)||(t=WD(t));let{property:a,hasOverrideFlag:s,suffix:c}=WV(t);o=typeof o=="string"&&o.length!==0?o:c;let l={name:a,suffix:o,value:r,sourceSpan:n,hasOverrideFlag:s};return i?this._styleMapInput=l:((this._singleStyleInputs=this._singleStyleInputs||[]).push(l),$V(this._stylesIndex,a)),this._lastStylingInput=l,this._firstStylingInput=this._firstStylingInput||l,this._checkForPipes(r),this.hasBindings=!0,l}registerClassInput(t,i,r,n){if(qV(r))return null;let{property:o,hasOverrideFlag:a}=WV(t),s={name:o,value:r,sourceSpan:n,hasOverrideFlag:a,suffix:null};return i?this._classMapInput=s:((this._singleClassInputs=this._singleClassInputs||[]).push(s),$V(this._classesIndex,o)),this._lastStylingInput=s,this._firstStylingInput=this._firstStylingInput||s,this._checkForPipes(r),this.hasBindings=!0,s}_checkForPipes(t){t instanceof Oa&&t.ast instanceof Yh&&(this.hasBindingsWithPipes=!0)}registerStyleAttr(t){this._initialStyleValues=mz(t),this._hasInitialValues=!0}registerClassAttr(t){this._initialClassValues=t.trim().split(/\s+/g),this._hasInitialValues=!0}populateInitialStylingAttrs(t){if(this._initialClassValues.length){t.push(U(1));for(let i=0;i<this._initialClassValues.length;i++)t.push(U(this._initialClassValues[i]))}if(this._initialStyleValues.length){t.push(U(2));for(let i=0;i<this._initialStyleValues.length;i+=2)t.push(U(this._initialStyleValues[i]),U(this._initialStyleValues[i+1]))}}assignHostAttrs(t,i){this._directiveExpr&&(t.length||this._hasInitialValues)&&(this.populateInitialStylingAttrs(t),i.set("hostAttrs",ti(t)))}buildClassMapInstruction(t){return this._classMapInput?this._buildMapBasedInstruction(t,!0,this._classMapInput):null}buildStyleMapInstruction(t){return this._styleMapInput?this._buildMapBasedInstruction(t,!1,this._styleMapInput):null}_buildMapBasedInstruction(t,i,r){let n=Jw,o=r.value.visit(t),a;return o instanceof En?(n+=o.expressions.length,a=i?Jue(o):ehe(o)):a=i?T.classMap:T.styleMap,{reference:a,calls:[{supportsInterpolation:!0,sourceSpan:r.sourceSpan,allocateBindingSlots:n,params:s=>{let c=s(o);return Array.isArray(c)?c:[c]}}]}}_buildSingleInputs(t,i,r,n,o){let a=[];return i.forEach(s=>{let c=a[a.length-1],l=s.value.visit(r),d=t,u=Jw;l instanceof En&&(u+=l.expressions.length,n&&(d=n(l)));let h={sourceSpan:s.sourceSpan,allocateBindingSlots:u,supportsInterpolation:!!n,params:p=>{let m=[];m.push(U(s.name));let f=p(l);return Array.isArray(f)?m.push(...f):m.push(f),!o&&s.suffix!==null&&m.push(U(s.suffix)),m}};c&&c.reference===d?c.calls.push(h):a.push({reference:d,calls:[h]})}),a}_buildClassInputs(t){return this._singleClassInputs?this._buildSingleInputs(T.classProp,this._singleClassInputs,t,null,!0):[]}_buildStyleInputs(t){return this._singleStyleInputs?this._buildSingleInputs(T.styleProp,this._singleStyleInputs,t,the,!1):[]}buildUpdateLevelInstructions(t){let i=[];if(this.hasBindings){let r=this.buildStyleMapInstruction(t);r&&i.push(r);let n=this.buildClassMapInstruction(t);n&&i.push(n),i.push(...this._buildStyleInputs(t)),i.push(...this._buildClassInputs(t))}return i}};function $V(e,t){e.has(t)||e.set(t,e.size)}function WV(e){let t=!1,i=e.indexOf(Que);i!==-1&&(e=i>0?e.substring(0,i):"",t=!0);let r=null,n=e,o=e.lastIndexOf(".");return o>0&&(r=e.slice(o+1),n=e.substring(0,o)),{property:n,suffix:r,hasOverrideFlag:t}}function Jue(e){switch(np(e)){case 1:return T.classMap;case 3:return T.classMapInterpolate1;case 5:return T.classMapInterpolate2;case 7:return T.classMapInterpolate3;case 9:return T.classMapInterpolate4;case 11:return T.classMapInterpolate5;case 13:return T.classMapInterpolate6;case 15:return T.classMapInterpolate7;case 17:return T.classMapInterpolate8;default:return T.classMapInterpolateV}}function ehe(e){switch(np(e)){case 1:return T.styleMap;case 3:return T.styleMapInterpolate1;case 5:return T.styleMapInterpolate2;case 7:return T.styleMapInterpolate3;case 9:return T.styleMapInterpolate4;case 11:return T.styleMapInterpolate5;case 13:return T.styleMapInterpolate6;case 15:return T.styleMapInterpolate7;case 17:return T.styleMapInterpolate8;default:return T.styleMapInterpolateV}}function the(e){switch(np(e)){case 1:return T.styleProp;case 3:return T.stylePropInterpolate1;case 5:return T.stylePropInterpolate2;case 7:return T.stylePropInterpolate3;case 9:return T.stylePropInterpolate4;case 11:return T.stylePropInterpolate5;case 13:return T.stylePropInterpolate6;case 15:return T.stylePropInterpolate7;case 17:return T.stylePropInterpolate8;default:return T.stylePropInterpolateV}}function ihe(e){return e.startsWith("--")}function qV(e){return e instanceof Oa&&(e=e.ast),e instanceof Mo}var rhe="select",nhe="ngProjectAs",fD=new Set(["$event"]),jx="ng-template",LT=new Map([["window",T.resolveWindow],["document",T.resolveDocument],["body",T.resolveBody]]),ohe=[" ",`
`,"\r","	"];function su(e,t){return w0(ft(S0).bitwiseAnd(U(e),null,!1),t)}function zz(e,t=null,i=null){let{type:r,name:n,target:o,phase:a,handler:s}=e;if(o&&!LT.has(o))throw new Error(`Unexpected global target '${o}' defined for '${n}' event.
        Supported list of global targets: ${Array.from(LT.keys())}.`);let c="$event",l=new Set,d=i===null||i.bindingLevel===0?ft(na):i.getOrCreateSharedContextVar(0),u=e.type===2?Wne(i,d,s,"b",e.handlerSpan,l,fD):$ne(i,d,s,"b",e.handlerSpan,l,fD),h=[],p=i?.variableDeclarations(),m=i?.restoreViewStatement();if(p&&h.push(...p),h.push(...u),m){h.unshift(m);let y=h[h.length-1];y instanceof Rn?h[h.length-1]=new Rn(Gh(y.value.sourceSpan,T.resetView,[y.value])):h.push(new oo(Gh(null,T.resetView,[])))}let f=r===1?Vre(n,a):n,g=t&&Gl(t),v=[];l.has(c)&&v.push(new Dr(c,Xc));let _=Xl(v,h,aa,null,g),b=[U(f),_];return o&&b.push(U(!1),Xe(LT.get(o))),b}function ahe(){return{prepareStatements:[],constExpressions:[],i18nVarRefsCache:new Map}}var mD=class{constructor(t,i,r,n){this.name=t,this.index=i,this.scope=r,this.visitor=n}getConstCount(){return this.visitor.getConstCount()}getVarCount(){return this.visitor.getVarCount()}},gD=class e{constructor(t,i,r=0,n,o,a,s,c,l,d,u,h,p,m=ahe()){this.constantPool=t,this.level=r,this.contextName=n,this.i18nContext=o,this.templateIndex=a,this.templateName=s,this._namespace=c,this.i18nUseExternalIds=d,this.deferBlocks=u,this.elementLocations=h,this.allDeferrableDepsFn=p,this._constants=m,this._dataIndex=0,this._bindingContext=0,this._prefixCode=[],this._creationCodeFns=[],this._updateCodeFns=[],this._currentIndex=0,this._tempVariables=[],this._controlFlowTempVariable=null,this._nestedTemplateFns=[],this.i18n=null,this._pureFunctionSlots=0,this._bindingSlots=0,this._ngContentReservedSlots=[],this._ngContentSelectorsOffset=0,this._implicitReceiverExpr=null,this.visitReference=Qa,this.visitVariable=Qa,this.visitTextAttribute=Qa,this.visitBoundAttribute=Qa,this.visitBoundEvent=Qa,this.visitDeferredTrigger=Qa,this.visitDeferredBlockError=Qa,this.visitDeferredBlockLoading=Qa,this.visitDeferredBlockPlaceholder=Qa,this.visitIfBlockBranch=Qa,this.visitSwitchBlockCase=Qa,this.visitForLoopBlockEmpty=Qa,this.visitUnknownBlock=Qa,this._bindingScope=i.nestedScope(r),this.fileBasedI18nSuffix=l.replace(/[^A-Za-z0-9]/g,"_")+"_",this._valueConverter=new t1(t,()=>this.allocateDataSlot(),f=>this.allocatePureFunctionSlots(f),(f,g,v,_)=>{this._bindingScope.set(this.level,g,_),this.creationInstruction(null,T.pipe,[U(v),U(f)])})}buildTemplateFunction(t,i,r=0,n,o){this._ngContentSelectorsOffset=r,this._namespace!==T.namespaceHTML&&this.creationInstruction(null,this._namespace),i.forEach(m=>{let f=o?.[m.name];this.registerContextVariables(m.name,m.value),f&&this.registerContextVariables(f,m.value)});let a=this.i18nContext||e0(n)&&!kv(n)&&!(ghe(t)&&t[0].i18n===n),s=BT(t);if(a&&this.i18nStart(null,n,s),Rv(this,t),this._pureFunctionSlots+=this._bindingSlots,this._valueConverter.updatePipeSlotOffsets(this._bindingSlots),this._nestedTemplateFns.forEach(m=>m()),this.level===0&&this._ngContentReservedSlots.length){let m=[];if(this._ngContentReservedSlots.length>1||this._ngContentReservedSlots[0]!=="*"){let f=this._ngContentReservedSlots.map(g=>g!=="*"?b0(g):g);m.push(this.constantPool.getConstLiteral(fl(f),!0))}this.creationInstruction(null,T.projectionDef,m,!0)}a&&this.i18nEnd(null,s);let c=yw(this._creationCodeFns),l=yw(this._updateCodeFns),d=this._bindingScope.viewSnapshotStatements(),u=this._bindingScope.variableDeclarations().concat(this._tempVariables),h=c.length>0?[su(1,d.concat(c))]:[],p=l.length>0?[su(2,u.concat(l))]:[];return Xl([new Dr(S0,y0),new Dr(na,null)],[...this._prefixCode,...h,...p],aa,null,this.templateName)}getLocal(t){return this._bindingScope.get(t)}notifyImplicitReceiverUse(){this._bindingScope.notifyImplicitReceiverUse()}maybeRestoreView(){this._bindingScope.maybeRestoreView()}i18nTranslate(t,i={},r,n){let o=r||this.i18nGenerateMainBlockVar(),a=this.i18nGenerateClosureVar(t.id),s=bhe(t,o,a,i,n);return this._constants.prepareStatements.push(...s),o}registerContextVariables(t,i){let r=this._bindingScope.freshReferenceName(),n=this.level,o=i===cA,a=ft(t+r);this._bindingScope.set(n,t,s=>o&&s.bindingLevel===n&&!s.isListenerScope()?ft(na):a,1,(s,c)=>{let l;if(s.bindingLevel===n)if(s.isListenerScope()&&s.hasRestoreViewVariable())l=ft(E6),s.notifyRestoredViewContextUse();else{if(o)return[];l=ft(na)}else{let d=s.getSharedContextName(n);l=d||vD(c)}return[a.set(o?l:l.prop(i||dne)).toConstDecl()]})}i18nAppendBindings(t){t.length>0&&t.forEach(i=>this.i18n.appendBinding(i))}i18nBindProps(t){let i={};return Object.keys(t).forEach(r=>{let n=t[r];if(n instanceof Rc)i[r]=U(n.value);else{let o=n.value.visit(this._valueConverter);if(this.allocateBindingSlots(o),o instanceof En){let{strings:a,expressions:s}=o,{id:c,bindings:l}=this.i18n,d=ane(a,l.size,c);this.i18nAppendBindings(s),i[r]=U(d)}}}),i}i18nGenerateMainBlockVar(){return ft(this.constantPool.uniqueName(tne))}i18nGenerateClosureVar(t){let i,r=this.fileBasedI18nSuffix.toUpperCase();if(this.i18nUseExternalIds){let n=bw("EXTERNAL_"),o=this.constantPool.uniqueName(r);i=`${n}${Gl(t)}$$${o}`}else{let n=bw(r);i=this.constantPool.uniqueName(n)}return ft(i)}i18nUpdateRef(t){let{icus:i,meta:r,isRoot:n,isResolved:o,isEmitted:a}=t;if(n&&o&&!a&&!kv(r)){t.isEmitted=!0;let s=t.getSerializedPlaceholders(),c={},l=s.size?v8(s):{};i.size&&i.forEach((h,p)=>{if(h.length===1)l[p]=h[0];else{let m=o1(`${rne}${p}`);l[p]=U(m),c[p]=ti(h)}});let d=Array.from(s.values()).some(h=>h.length>1)||Object.keys(c).length,u;d&&(u=h=>{let p=[h];return Object.keys(c).length&&p.push(h0(c,!0)),Gh(null,T.i18nPostprocess,p)}),this.i18nTranslate(r,l,t.ref,u)}}i18nStart(t=null,i,r){let n=this.allocateDataSlot();this.i18n=this.i18nContext?this.i18nContext.forkChildContext(n,this.templateIndex,i):new pD(n,this.i18nGenerateMainBlockVar(),0,this.templateIndex,i);let{id:o,ref:a}=this.i18n,s=[U(n),this.addToConsts(a)];o>0&&s.push(U(o)),this.creationInstruction(t,r?T.i18n:T.i18nStart,s)}i18nEnd(t=null,i){if(!this.i18n)throw new Error("i18nEnd is executed with no i18n context present");this.i18nContext?(this.i18nContext.reconcileChildContext(this.i18n),this.i18nUpdateRef(this.i18nContext)):this.i18nUpdateRef(this.i18n);let{index:r,bindings:n}=this.i18n;if(n.size){for(let o of n)this.updateInstructionWithAdvance(this.getConstCount()-1,t,T.i18nExp,()=>this.convertPropertyBinding(o));this.updateInstruction(t,T.i18nApply,[U(r)])}i||this.creationInstruction(t,T.i18nEnd),this.i18n=null}i18nAttributesInstruction(t,i,r){let n=!1,o=[];if(i.forEach(a=>{let s=a.i18n,c=a.value.visit(this._valueConverter);if(this.allocateBindingSlots(c),c instanceof En){let l=x6(s),d=v8(l);o.push(U(a.name),this.i18nTranslate(s,d)),c.expressions.forEach(u=>{n=!0,this.updateInstructionWithAdvance(t,r,T.i18nExp,()=>this.convertPropertyBinding(u))})}}),o.length>0){let a=U(this.allocateDataSlot()),s=this.addToConsts(ti(o));this.creationInstruction(r,T.i18nAttributes,[a,s]),n&&this.updateInstruction(r,T.i18nApply,[a])}}getNamespaceInstruction(t){switch(t){case"math":return T.namespaceMathML;case"svg":return T.namespaceSVG;default:return T.namespaceHTML}}addNamespaceInstruction(t,i){this._namespace=t,this.creationInstruction(i.startSourceSpan,t)}interpolatedUpdateInstruction(t,i,r,n,o,a){this.updateInstructionWithAdvance(i,n.sourceSpan,t,()=>[U(r),...this.getUpdateInstructionArguments(o),...a])}visitContent(t){let i=this.allocateDataSlot(),r=this._ngContentSelectorsOffset+this._ngContentReservedSlots.length,n=[U(i)];this._ngContentReservedSlots.push(t.selector);let o=t.attributes.filter(s=>s.name.toLowerCase()!==rhe),a=this.getAttributeExpressions(t.name,o,[],[]);a.length>0?n.push(U(r),ti(a)):r!==0&&n.push(U(r)),this.creationInstruction(t.sourceSpan,T.projection,n),this.i18n&&this.i18n.appendProjection(t.i18n,i)}visitElement(t){let i=this.allocateDataSlot(),r=new e1(null);this.elementLocations.set(t,{index:i,level:this.level});let n=!1,o=e0(t.i18n)&&!kv(t.i18n),a=[],[s,c]=sa(t.name),l=QT(t.name);for(let E of t.attributes){let{name:N,value:M}=E;N===une?n=!0:N==="style"?r.registerStyleAttr(M):N==="class"?r.registerClassAttr(M):a.push(E)}let d=[U(i)];l||d.push(U(c));let u=[],h=[];t.inputs.forEach(E=>{r.registerBoundInput(E)||((E.type===0||E.type===5)&&E.i18n?h.push(E):u.push(E))});let p=this.getAttributeExpressions(t.name,a,u,t.outputs,r,[],h);d.push(this.addAttrsToConsts(p));let m=this.prepareRefsArray(t.references);d.push(this.addToConsts(m));let f=this._namespace,g=this.getNamespaceInstruction(s);g!==f&&this.addNamespaceInstruction(g,t),this.i18n&&this.i18n.appendElement(t.i18n,i);let v=!o&&this.i18n?!BT(t.children):t.children.length>0,_=!r.hasBindingsWithPipes&&t.outputs.length===0&&h.length===0&&!v,b=!_&&BT(t.children);if(_)this.creationInstruction(t.sourceSpan,l?T.elementContainer:T.element,If(d));else{if(this.creationInstruction(t.startSourceSpan,l?T.elementContainerStart:T.elementStart,If(d)),n&&this.creationInstruction(t.startSourceSpan,T.disableBindings),h.length>0&&this.i18nAttributesInstruction(i,h,t.startSourceSpan??t.sourceSpan),t.outputs.length>0)for(let E of t.outputs)this.creationInstruction(E.sourceSpan,E.type===2?T.twoWayListener:T.listener,this.prepareListenerParameter(t.name,E,i));o&&this.i18nStart(t.startSourceSpan,t.i18n,b)}let y=r.buildUpdateLevelInstructions(this._valueConverter),x=y.length-1;for(let E=0;E<=x;E++){let N=y[E];this._bindingSlots+=this.processStylingUpdateInstruction(i,N)}let w=U(void 0),I=[],S=[];u.forEach(E=>{let N=E.type;if(N===4){let M=E.value.visit(this._valueConverter),P=M instanceof ko?!!M.value:!0;this.allocateBindingSlots(M),I.push({span:E.sourceSpan,reference:T.property,paramsOrFn:Gx(()=>P?this.convertPropertyBinding(M):w,v6(E.name))})}else{if(E.i18n)return;let M=E.value.visit(this._valueConverter);if(M!==void 0){let P=[],[$,R]=sa(E.name),j=N===1,B=Hz(E.securityContext,j);if(B||_he(t.name)&&VD(E.name)&&(B=Xe(T.validateIframeAttribute)),B&&P.push(B),$){let te=U($);B?P.push(te):P.push(U(null),te)}if(this.allocateBindingSlots(M),N===0||N===5)M instanceof En?this.interpolatedUpdateInstruction(ZV(M),i,R,E,M,P):I.push({span:E.sourceSpan,reference:N===5?T.twoWayProperty:T.property,paramsOrFn:Gx(()=>this.convertPropertyBinding(M),R,P)});else if(N===1)if(M instanceof En&&np(M)>1)this.interpolatedUpdateInstruction(hhe(M),i,R,E,M,P);else{let te=M instanceof En?M.expressions[0]:M;S.push({span:E.sourceSpan,paramsOrFn:Gx(()=>this.convertPropertyBinding(te),R,P)})}else this.updateInstructionWithAdvance(i,E.sourceSpan,T.classProp,()=>[U(i),U(R),this.convertPropertyBinding(M),...P])}}});for(let E of I)this.updateInstructionWithAdvance(i,E.span,E.reference,E.paramsOrFn);for(let E of S)this.updateInstructionWithAdvance(i,E.span,T.attribute,E.paramsOrFn);if(Rv(this,t.children),!o&&this.i18n&&this.i18n.appendElement(t.i18n,i,!0),!_){let E=t.endSourceSpan??t.sourceSpan;o&&this.i18nEnd(E,b),n&&this.creationInstruction(E,T.enableBindings),this.creationInstruction(E,l?T.elementContainerEnd:T.elementEnd)}}prepareEmbeddedTemplateFn(t,i,r=[],n,o){let a=this.allocateDataSlot();this.i18n&&n&&(n instanceof Uc?this.i18n.appendBlock(n,a):this.i18n.appendTemplate(n,a));let s=`${this.contextName}${i}_${a}`,c=this.constantPool.uniqueName(`${s}_Template`,!1),l=new e(this.constantPool,this._bindingScope,this.level+1,s,this.i18n,a,c,this._namespace,this.fileBasedI18nSuffix,this.i18nUseExternalIds,this.deferBlocks,this.elementLocations,this.allDeferrableDepsFn,this._constants);return this._nestedTemplateFns.push(()=>{let d=l.buildTemplateFunction(t,r,this._ngContentReservedSlots.length+this._ngContentSelectorsOffset,n,o);this.constantPool.statements.push(d.toDeclStmt(c)),l._ngContentReservedSlots.length&&this._ngContentReservedSlots.push(...l._ngContentReservedSlots)}),new mD(c,a,l._bindingScope,l)}createEmbeddedTemplateFn(t,i,r,n,o=[],a,s,c){let l=this.prepareEmbeddedTemplateFn(i,r,o,c),d=[U(l.index),ft(l.name),U(t),this.addAttrsToConsts(a||null)];if(s&&s.length>0){let u=this.prepareRefsArray(s);d.push(this.addToConsts(u)),d.push(Xe(T.templateRefExtractor))}return this.creationInstruction(n,T.templateCreate,()=>(d.splice(2,0,U(l.getConstCount()),U(l.getVarCount())),If(d))),l.index}visitTemplate(t){let i=t.tagName?sa(t.tagName)[1]:t.tagName,r=t.tagName?"_"+Gl(t.tagName):"",n=this.getAttributeExpressions(jx,t.attributes,t.inputs,t.outputs,void 0,t.templateAttrs),o=this.createEmbeddedTemplateFn(i,t.children,r,t.sourceSpan,t.variables,n,t.references,t.i18n);if(this.templatePropertyBindings(o,t.templateAttrs),i===jx){let[a,s]=Pre(t.inputs,nne);a.length>0&&this.i18nAttributesInstruction(o,a,t.startSourceSpan??t.sourceSpan),s.length>0&&this.templatePropertyBindings(o,s);for(let c of t.outputs)this.creationInstruction(c.sourceSpan,c.type===2?T.twoWayListener:T.listener,this.prepareListenerParameter("ng_template",c,o))}}visitBoundText(t){if(this.i18n){let n=t.value.visit(this._valueConverter);this.allocateBindingSlots(n),n instanceof En&&(this.i18n.appendBoundText(t.i18n),this.i18nAppendBindings(n.expressions));return}let i=this.allocateDataSlot();this.creationInstruction(t.sourceSpan,T.text,[U(i)]);let r=t.value.visit(this._valueConverter);this.allocateBindingSlots(r),r instanceof En?this.updateInstructionWithAdvance(i,t.sourceSpan,phe(r),()=>this.getUpdateInstructionArguments(r)):aw("Text nodes should be interpolated and never bound directly.")}visitText(t){this.i18n||this.creationInstruction(t.sourceSpan,T.text,[U(this.allocateDataSlot()),U(t.value)])}visitIcu(t){let i=!1;this.i18n||(i=!0,this.i18nStart(null,t.i18n,!0));let r=this.i18n,n=this.i18nBindProps(t.vars),o=this.i18nBindProps(t.placeholders),a=t.i18n,s=c=>{let l=Object.fromEntries(Object.entries(L(L({},n),o)).sort()),d=E0(l,!1);return Gh(null,T.i18nPostprocess,[c,h0(d,!0)])};if(kv(r.meta))this.i18nTranslate(a,{},r.ref,s);else{let c=this.i18nTranslate(a,{},void 0,s);r.appendIcu(ND(a).name,c)}return i&&this.i18nEnd(null,!0),null}visitIfBlock(t){this.allocateBindingSlots(null);let i=t.branches.map((o,a)=>{let{expression:s,expressionAlias:c,children:l,sourceSpan:d}=o,u=c!==null?[new zc(c.name,cA,c.sourceSpan,c.keySpan)]:void 0,h=null,p;if(a===0){let g=this.inferProjectionDataFromInsertionPoint(o);h=g.tagName,p=g.attrsExprs}let m=this.createEmbeddedTemplateFn(h,l,"_Conditional",d,u,p,void 0,o.i18n),f=s===null?null:s.visit(this._valueConverter);return{index:m,expression:f,alias:c}}),r=i[0].index,n=()=>{let o=null,a=c=>{if(c>i.length-1)return U(-1);let{index:l,expression:d,alias:u}=i[c];if(d===null)return U(l);let h;return u?(o=this.allocateControlFlowTempVariable(),h=o.set(this.convertPropertyBinding(d))):h=this.convertPropertyBinding(d),h.conditional(U(l),a(c+1))},s=[U(r),a(0)];return o!==null&&s.push(o),s};this.updateInstructionWithAdvance(r,t.branches[0].sourceSpan,T.conditional,n)}visitSwitchBlock(t){if(t.cases.length===0)return;let i=t.cases.map(o=>{let a=this.createEmbeddedTemplateFn(null,o.children,"_Case",o.sourceSpan,void 0,void 0,void 0,o.i18n),s=o.expression===null?null:o.expression.visit(this._valueConverter);return{index:a,expression:s}}),r=i[0].index,n=t.expression.visit(this._valueConverter);this.allocateBindingSlots(null),this.updateInstructionWithAdvance(r,t.sourceSpan,T.conditional,()=>{let o=a=>{if(a>i.length-1)return U(-1);let{index:s,expression:c}=i[a];return c===null?U(s):(a===0?this.allocateControlFlowTempVariable().set(this.convertPropertyBinding(n)):this.allocateControlFlowTempVariable()).identical(this.convertPropertyBinding(c)).conditional(U(s),o(a+1))};return[U(r),o(0)]})}visitDeferredBlock(t){let{loading:i,placeholder:r,error:n,triggers:o,prefetchTriggers:a}=t,s=this.deferBlocks.get(t);if(!s)throw new Error("Could not resolve `defer` block metadata. Block may need to be analyzed.");let c=this.createEmbeddedTemplateFn(null,t.children,"_Defer",t.sourceSpan,void 0,void 0,void 0,t.i18n),l=i?this.createEmbeddedTemplateFn(null,i.children,"_DeferLoading",i.sourceSpan,void 0,void 0,void 0,i.i18n):null,d=i?If([U(i.minimumTime),U(i.afterTime)]):null,u=r?this.createEmbeddedTemplateFn(null,r.children,"_DeferPlaceholder",r.sourceSpan,void 0,void 0,void 0,r.i18n):null,h=r&&r.minimumTime!==null?ti([U(r.minimumTime)]):null,p=n?this.createEmbeddedTemplateFn(null,n.children,"_DeferError",n.sourceSpan,void 0,void 0,void 0,n.i18n):null,m=this.allocateDataSlot(),f=`${this.contextName}_Defer_${m}_DepsFn`;this.creationInstruction(t.sourceSpan,T.defer,If([U(m),U(c),this.allDeferrableDepsFn??this.createDeferredDepsFunction(f,s),U(l),U(u),U(p),d?.length?this.addToConsts(ti(d)):Hd,h?this.addToConsts(h):Hd,d?.length||h?Xe(T.deferEnableTimerScheduling):Hd])),this.allocateDataSlot(),this.createDeferTriggerInstructions(m,o,s,!1),this.createDeferTriggerInstructions(m,a,s,!0)}createDeferredDepsFunction(t,i){if(i.deps.length===0)return Hd;let r=[];for(let o of i.deps)if(o.isDeferrable){let a=ro([new Dr("m",Xc)],ft("m").prop(o.isDefaultImport?"default":o.symbolName)),s=new Gv(o.importPath).prop("then").callFn([a]);r.push(s)}else r.push(o.type);let n=ro([],ti(r));return this.constantPool.statements.push(n.toDeclStmt(t,po.Final)),ft(t)}createDeferTriggerInstructions(t,i,r,n){let{when:o,idle:a,immediate:s,timer:c,hover:l,interaction:d,viewport:u}=i;if(o){let h=o.value.visit(this._valueConverter);this.allocateBindingSlots(h),this.updateInstructionWithAdvance(t,o.sourceSpan,n?T.deferPrefetchWhen:T.deferWhen,()=>this.convertPropertyBinding(h))}(a||!n&&Object.keys(i).length===0)&&this.creationInstruction(a?.sourceSpan||null,n?T.deferPrefetchOnIdle:T.deferOnIdle),s&&this.creationInstruction(s.sourceSpan,n?T.deferPrefetchOnImmediate:T.deferOnImmediate),c&&this.creationInstruction(c.sourceSpan,n?T.deferPrefetchOnTimer:T.deferOnTimer,[U(c.delay)]),l&&this.domNodeBasedTrigger("hover",l,r,n?T.deferPrefetchOnHover:T.deferOnHover),d&&this.domNodeBasedTrigger("interaction",d,r,n?T.deferPrefetchOnInteraction:T.deferOnInteraction),u&&this.domNodeBasedTrigger("viewport",u,r,n?T.deferPrefetchOnViewport:T.deferOnViewport)}domNodeBasedTrigger(t,i,r,n){let o=r.triggerElements.get(i);o&&this.creationInstruction(i.sourceSpan,n,()=>{let a=this.elementLocations.get(o);if(!a)throw new Error(`Could not determine location of reference passed into '${t}' trigger. Template may not have been fully analyzed.`);let s=Math.max(this.level-a.level,-1),c=[U(a.index)];return s!==0&&c.push(U(s)),c})}inferProjectionDataFromInsertionPoint(t){let i=null,r=null,n;for(let o of t.children)if(!(o instanceof Qf)){if(i!==null){i=null;break}(o instanceof da||o instanceof Fa&&o.tagName!==null)&&(i=o)}if(i!==null){let o=i instanceof da?i.name:i.tagName;r=o===jx?null:o,n=this.getAttributeExpressions(jx,i.attributes,i.inputs,[])}return{tagName:r,attrsExprs:n}}allocateDataSlot(){return this._dataIndex++}visitForLoopBlock(t){let i=this.allocateDataSlot(),{tagName:r,attrsExprs:n}=this.inferProjectionDataFromInsertionPoint(t),o=this.prepareEmbeddedTemplateFn(t.children,"_For",[t.item,t.contextVariables.$index,t.contextVariables.$count],t.i18n,{[t.contextVariables.$index.name]:this.getLevelSpecificVariableName("$index",this.level+1),[t.contextVariables.$count.name]:this.getLevelSpecificVariableName("$count",this.level+1)}),{expression:a,usesComponentInstance:s}=this.createTrackByFunction(t),c=null,l=null,d;if(t.empty!==null){let h=this.inferProjectionDataFromInsertionPoint(t.empty);l=h.tagName,d=h.attrsExprs,c=this.prepareEmbeddedTemplateFn(t.empty.children,"_ForEmpty",void 0,t.empty.i18n),this.allocateBindingSlots(null)}this.registerComputedLoopVariables(t,o.scope),this.creationInstruction(t.sourceSpan,T.repeaterCreate,()=>{let h=[U(i),ft(o.name),U(o.getConstCount()),U(o.getVarCount()),U(r),this.addAttrsToConsts(n||null),a];return c!==null?h.push(U(s),ft(c.name),U(c.getConstCount()),U(c.getVarCount()),U(l),this.addAttrsToConsts(d||null)):s&&h.push(U(s)),If(h)});let u=t.expression.visit(this._valueConverter);this.updateInstructionWithAdvance(i,t.sourceSpan,T.repeater,()=>[this.convertPropertyBinding(u)])}registerComputedLoopVariables(t,i){let r=i.bindingLevel;i.set(r,t.contextVariables.$odd.name,(n,o)=>this.getLevelSpecificForLoopVariable(t,n,o,"$index").modulo(U(2)).notIdentical(U(0))),i.set(r,t.contextVariables.$even.name,(n,o)=>this.getLevelSpecificForLoopVariable(t,n,o,"$index").modulo(U(2)).identical(U(0))),i.set(r,t.contextVariables.$first.name,(n,o)=>this.getLevelSpecificForLoopVariable(t,n,o,"$index").identical(U(0))),i.set(r,t.contextVariables.$last.name,(n,o)=>{let a=this.getLevelSpecificForLoopVariable(t,n,o,"$index"),s=this.getLevelSpecificForLoopVariable(t,n,o,"$count");return a.identical(s.minus(U(1)))})}getLevelSpecificVariableName(t,i){return`\u0275${t}_${i}`}getLevelSpecificForLoopVariable(t,i,r,n){let o=i.bindingLevel===r?t.contextVariables[n].name:this.getLevelSpecificVariableName(n,r);return i.get(o)}optimizeTrackByFunction(t){let i=t.contextVariables.$index.name,r=t.item.name,n=t.trackBy.ast;if(n instanceof to&&n.receiver instanceof Po&&n.name===i)return{expression:Xe(T.repeaterTrackByIndex),usesComponentInstance:!1};if(n instanceof to&&n.receiver instanceof Po&&n.name===r)return{expression:Xe(T.repeaterTrackByIdentity),usesComponentInstance:!1};if(n instanceof Yl&&n.receiver instanceof to&&n.receiver.receiver instanceof Po&&n.args.length===2){let o=n.args[0]instanceof to&&n.args[0].receiver instanceof Po&&n.args[0].name===i,a=n.args[1]instanceof to&&n.args[1].receiver instanceof Po&&n.args[1].name===r;if(o&&a)return{expression:(this.level===0?ft(na):new Lc(T.componentInstance).callFn([])).prop(n.receiver.name),usesComponentInstance:!1}}return null}createTrackByFunction(t){let i=this.optimizeTrackByFunction(t);if(i!==null)return i;let r=t.contextVariables,n=new _D(this._bindingScope,{[r.$index.name]:"$index",[t.item.name]:"$item",[r.$count.name]:r.$count.name,[r.$first.name]:r.$first.name,[r.$last.name]:r.$last.name,[r.$even.name]:r.$even.name,[r.$odd.name]:r.$odd.name}),o=[new Dr("$index"),new Dr("$item")],a=Xne(t.trackBy.ast,n,ft(na),"track"),s=n.getComponentAccessCount()>0,c;if(!s&&a.length===1&&a[0]instanceof oo)c=ro(o,a[0].expr);else{if(a.length>0){let l=a[a.length-1];l instanceof oo&&(a[a.length-1]=new Rn(l.expr))}c=Xl(o,a)}return{expression:this.constantPool.getSharedFunctionReference(c,"_forTrack"),usesComponentInstance:s}}getConstCount(){return this._dataIndex}getVarCount(){return this._pureFunctionSlots}getConsts(){return this._constants}getNgContentSelectors(){return this._ngContentReservedSlots.length?this.constantPool.getConstLiteral(fl(this._ngContentReservedSlots),!0):null}bindingContext(){return`${this._bindingContext++}`}templatePropertyBindings(t,i){let r=[];for(let n of i){if(!(n instanceof cw))continue;let o=n.value.visit(this._valueConverter);if(o!==void 0)if(this.allocateBindingSlots(o),o instanceof En){let a=[];this.interpolatedUpdateInstruction(ZV(o),t,n.name,n,o,a)}else r.push({span:n.sourceSpan,paramsOrFn:Gx(()=>this.convertPropertyBinding(o),n.name)})}for(let n of r)this.updateInstructionWithAdvance(t,n.span,T.property,n.paramsOrFn)}instructionFn(t,i,r,n,o=!1){t[o?"unshift":"push"]({span:i,reference:r,paramsOrFn:n})}processStylingUpdateInstruction(t,i){let r=0;if(i)for(let n of i.calls)r+=n.allocateBindingSlots,this.updateInstructionWithAdvance(t,n.sourceSpan,i.reference,()=>n.params(o=>n.supportsInterpolation&&o instanceof En?this.getUpdateInstructionArguments(o):this.convertPropertyBinding(o)));return r}creationInstruction(t,i,r,n){this.instructionFn(this._creationCodeFns,t,i,r||[],n)}updateInstructionWithAdvance(t,i,r,n){this.addAdvanceInstructionIfNecessary(t,i),this.updateInstruction(i,r,n)}updateInstruction(t,i,r){this.instructionFn(this._updateCodeFns,t,i,r||[])}addAdvanceInstructionIfNecessary(t,i){if(t!==this._currentIndex){let r=t-this._currentIndex;if(r<1)throw new Error("advance instruction can only go forwards");this.instructionFn(this._updateCodeFns,i,T.advance,r>1?[U(r)]:[]),this._currentIndex=t}}allocatePureFunctionSlots(t){let i=this._pureFunctionSlots;return this._pureFunctionSlots+=t,i}allocateBindingSlots(t){this._bindingSlots+=t instanceof En?t.expressions.length:1}getImplicitReceiverExpr(){return this._implicitReceiverExpr?this._implicitReceiverExpr:this._implicitReceiverExpr=this.level===0?ft(na):this._bindingScope.getOrCreateSharedContextVar(0)}convertPropertyBinding(t){let i=U6(this,this.getImplicitReceiverExpr(),t,this.bindingContext()),r=i.currValExpr;return this._tempVariables.push(...i.stmts),r}getUpdateInstructionArguments(t){let{args:i,stmts:r}=Yne(this,this.getImplicitReceiverExpr(),t,this.bindingContext());return this._tempVariables.push(...r),i}allocateControlFlowTempVariable(){if(this._controlFlowTempVariable===null){let t=`${this.contextName}_contFlowTmp`;this._tempVariables.push(new Ro(t)),this._controlFlowTempVariable=ft(t)}return this._controlFlowTempVariable}getAttributeExpressions(t,i,r,n,o,a=[],s=[]){let c=new Set,l=[],d;for(let h of i)if(h.name===nhe&&(d=h),h.i18n){let{i18nVarRefsCache:p}=this._constants,m;p.has(h.i18n)?m=p.get(h.i18n):(m=this.i18nTranslate(h.i18n),p.set(h.i18n,m)),l.push(U(h.name),m)}else l.push(...YV(h.name),mhe(t,h));d&&l.push(...uhe(d));function u(h,p){typeof h=="string"?c.has(h)||(l.push(...YV(h)),p!==void 0&&l.push(p),c.add(h)):l.push(U(h))}if(o&&o.populateInitialStylingAttrs(l),r.length||n.length){let h=l.length;for(let p=0;p<r.length;p++){let m=r[p];m.type!==4&&m.type!==1&&u(m.name)}for(let p=0;p<n.length;p++){let m=n[p];m.type!==1&&u(m.name)}l.length!==h&&l.splice(h,0,U(3))}return a.length&&(l.push(U(4)),a.forEach(h=>u(h.name))),s.length&&(l.push(U(6)),s.forEach(h=>u(h.name))),l}addToConsts(t){if(p6(t))return Hd;let i=this._constants.constExpressions;for(let r=0;r<i.length;r++)if(i[r].isEquivalent(t))return U(r);return U(i.push(t)-1)}addAttrsToConsts(t){return t!==null&&t.length>0?this.addToConsts(ti(t)):Hd}prepareRefsArray(t){if(!t||t.length===0)return Hd;let i=t.flatMap(r=>{let n=this.allocateDataSlot(),o=this._bindingScope.freshReferenceName(),a=this.level,s=ft(o);return this._bindingScope.set(a,r.name,s,0,(c,l)=>{let d=l>0?[vD(l).toStmt()]:[],u=s.set(Xe(T.reference).callFn([U(n)]));return d.concat(u.toConstDecl())},!0),[r.name,r.value]});return fl(i)}prepareListenerParameter(t,i,r){return()=>{let n=i.name,o=i.type===1?_6(n,i.phase):Gl(n),a=`${this.templateName}_${t}_${o}_${r}_listener`,s=this._bindingScope.nestedScope(this._bindingScope.bindingLevel,fD);return zz(i,a,s)}}},t1=class extends vA{constructor(t,i,r,n){super(),this.constantPool=t,this.allocateSlot=i,this.allocatePureFunctionSlots=r,this.definePipe=n,this._pipeBindExprs=[]}visitPipe(t,i){let r=this.allocateSlot(),n=`PIPE:${r}`,o=this.allocatePureFunctionSlots(2+t.args.length),a=new to(t.span,t.sourceSpan,t.nameSpan,new Po(t.span,t.sourceSpan),n),{identifier:s,isVarLength:c}=lhe(t.args);this.definePipe(t.name,n,r,Xe(s));let l=[t.exp,...t.args],d=c?this.visitAll([new Zh(t.span,t.sourceSpan,l)]):this.visitAll(l),u=new Yl(t.span,t.sourceSpan,a,[new ko(t.span,t.sourceSpan,r),new ko(t.span,t.sourceSpan,o),...d],null);return this._pipeBindExprs.push(u),u}updatePipeSlotOffsets(t){this._pipeBindExprs.forEach(i=>{let r=i.args[1];r.value+=t})}visitLiteralArray(t,i){return new Zd(t.span,t.sourceSpan,this.visitAll(t.expressions),r=>{let n=ti(r);return XV(this.constantPool,n,this.allocatePureFunctionSlots)})}visitLiteralMap(t,i){return new Zd(t.span,t.sourceSpan,this.visitAll(t.values),r=>{let n=ao(r.map((o,a)=>({key:t.keys[a].key,value:o,quoted:t.keys[a].quoted})));return XV(this.constantPool,n,this.allocatePureFunctionSlots)})}},she=[T.pipeBind1,T.pipeBind2,T.pipeBind3,T.pipeBind4];function lhe(e){let t=she[e.length];return{identifier:t||T.pipeBindV,isVarLength:!t}}var che=[T.pureFunction0,T.pureFunction1,T.pureFunction2,T.pureFunction3,T.pureFunction4,T.pureFunction5,T.pureFunction6,T.pureFunction7,T.pureFunction8];function dhe(e){let t=che[e.length];return{identifier:t||T.pureFunctionV,isVarLength:!t}}function vD(e){return Xe(T.nextContext).callFn(e>1?[U(e)]:[])}function XV(e,t,i){let{literalFactory:r,literalFactoryArguments:n}=e.getLiteralFactory(t),o=i(1+n.length),{identifier:a,isVarLength:s}=dhe(n),c=[U(o),r];return s?c.push(ti(n)):c.push(...n),Xe(a).callFn(c)}function YV(e){let[t,i]=sa(e),r=U(i);return t?[U(0),U(t),r]:[r]}var Nf="$$shared_ctx$$",i1=class e{static createRootScope(){return new e}constructor(t=0,i=null,r){if(this.bindingLevel=t,this.parent=i,this.globals=r,this.map=new Map,this.referenceNameIndex=0,this.restoreViewVariable=null,this.usesRestoredViewContext=!1,r!==void 0)for(let n of r)this.set(0,n,ft(n))}get(t){let i=this;for(;i;){let r=i.map.get(t);if(r!=null)return i!==this&&(r={retrievalLevel:r.retrievalLevel,lhs:r.lhs,declareLocalCallback:r.declareLocalCallback,declare:!1,priority:r.priority},this.map.set(t,r),this.maybeGenerateSharedContextVar(r),this.maybeRestoreView()),r.declareLocalCallback&&!r.declare&&(r.declare=!0),typeof r.lhs=="function"?r.lhs(this,r.retrievalLevel):r.lhs;i=i.parent}return this.bindingLevel===0?null:this.getComponentProperty(t)}hasLocal(t){return this.map.has(t)}set(t,i,r,n=0,o,a){if(this.map.has(i)){if(a)return this;aw(`The name ${i} is already defined in scope to be ${this.map.get(i)}`)}return this.map.set(i,{retrievalLevel:t,lhs:r,declare:!1,declareLocalCallback:o,priority:n}),this}getLocal(t){return this.get(t)}notifyImplicitReceiverUse(){this.bindingLevel!==0&&(this.map.get(Nf+0).declare=!0)}nestedScope(t,i){let r=new e(t,this,i);return t>0&&r.generateSharedContextVar(0),r}getOrCreateSharedContextVar(t){let i=Nf+t;return this.map.has(i)||this.generateSharedContextVar(t),this.map.get(i).lhs}getSharedContextName(t){let i=this.map.get(Nf+t);return i&&i.declare?i.lhs:null}maybeGenerateSharedContextVar(t){if(t.priority===1&&t.retrievalLevel<this.bindingLevel){let i=this.map.get(Nf+t.retrievalLevel);i?i.declare=!0:this.generateSharedContextVar(t.retrievalLevel)}}generateSharedContextVar(t){let i=ft(na+this.freshReferenceName());this.map.set(Nf+t,{retrievalLevel:t,lhs:i,declareLocalCallback:(r,n)=>[i.set(vD(n)).toConstDecl()],declare:!1,priority:2})}getComponentProperty(t){let i=this.map.get(Nf+0);i.declare=!0,this.maybeRestoreView();let r=typeof i.lhs=="function"?i.lhs(this,i.retrievalLevel):i.lhs;return t===cA?r:r.prop(t)}maybeRestoreView(){this.isListenerScope()&&(this.parent.restoreViewVariable||(this.parent.restoreViewVariable=ft(this.parent.freshReferenceName())),this.restoreViewVariable=this.parent.restoreViewVariable)}restoreViewStatement(){if(this.restoreViewVariable){let t=Gh(null,T.restoreView,[this.restoreViewVariable]);return this.usesRestoredViewContext?ft(E6).set(t).toConstDecl():t.toStmt()}return null}viewSnapshotStatements(){return this.restoreViewVariable?[this.restoreViewVariable.set(Gh(null,T.getCurrentView,[])).toConstDecl()]:[]}isListenerScope(){return this.parent&&this.parent.bindingLevel===this.bindingLevel}variableDeclarations(){let t=0;return Array.from(this.map.values()).filter(i=>i.declare).sort((i,r)=>r.retrievalLevel-i.retrievalLevel||r.priority-i.priority).reduce((i,r)=>{let n=this.bindingLevel-r.retrievalLevel,o=r.declareLocalCallback(this,n-t);return t=n,i.concat(o)},[])}freshReferenceName(){let t=this;for(;t.parent;)t=t.parent;return`${cne}${t.referenceNameIndex++}`}hasRestoreViewVariable(){return!!this.restoreViewVariable}notifyRestoredViewContextUse(){this.usesRestoredViewContext=!0}},_D=class extends i1{constructor(t,i){super(t.bindingLevel+1,t),this.globalOverrides=i,this.componentAccessCount=0}get(t){if(this.globalOverrides.hasOwnProperty(t))return ft(this.globalOverrides[t]);let i=this.parent;for(;i;){if(i.hasLocal(t))return null;i=i.parent}return this.componentAccessCount++,ft("this").prop(t)}getComponentAccessCount(){return this.componentAccessCount}};function uhe(e){let t=b0(e.value)[0];return[U(5),fl(t)]}function ZV(e){switch(np(e)){case 1:return T.propertyInterpolate;case 3:return T.propertyInterpolate1;case 5:return T.propertyInterpolate2;case 7:return T.propertyInterpolate3;case 9:return T.propertyInterpolate4;case 11:return T.propertyInterpolate5;case 13:return T.propertyInterpolate6;case 15:return T.propertyInterpolate7;case 17:return T.propertyInterpolate8;default:return T.propertyInterpolateV}}function hhe(e){switch(np(e)){case 3:return T.attributeInterpolate1;case 5:return T.attributeInterpolate2;case 7:return T.attributeInterpolate3;case 9:return T.attributeInterpolate4;case 11:return T.attributeInterpolate5;case 13:return T.attributeInterpolate6;case 15:return T.attributeInterpolate7;case 17:return T.attributeInterpolate8;default:return T.attributeInterpolateV}}function phe(e){switch(np(e)){case 1:return T.textInterpolate;case 3:return T.textInterpolate1;case 5:return T.textInterpolate2;case 7:return T.textInterpolate3;case 9:return T.textInterpolate4;case 11:return T.textInterpolate5;case 13:return T.textInterpolate6;case 15:return T.textInterpolate7;case 17:return T.textInterpolate8;default:return T.textInterpolateV}}function fhe(e,t,i={}){let{interpolationConfig:r,preserveWhitespaces:n,enableI18nLegacyMessageIdFormat:o}=i,a=r1(r),c=new nD().parse(e,t,ve(L({leadingTriviaChars:ohe},i),{tokenizeExpansionForms:!0,tokenizeBlocks:i.enableBlockSyntax??!0}));if(!i.alwaysAttemptHtmlToR3AstConversion&&c.errors&&c.errors.length>0){let b={interpolationConfig:r,preserveWhitespaces:n,errors:c.errors,nodes:[],styleUrls:[],styles:[],ngContentSelectors:[]};return i.collectCommentNodes&&(b.commentNodes=[]),b}let l=c.rootNodes,d=new Yw(r,!n,o),u=d.visitAllWithErrors(l);if(!i.alwaysAttemptHtmlToR3AstConversion&&u.errors&&u.errors.length>0){let b={interpolationConfig:r,preserveWhitespaces:n,errors:u.errors,nodes:[],styleUrls:[],styles:[],ngContentSelectors:[]};return i.collectCommentNodes&&(b.commentNodes=[]),b}l=u.rootNodes,n||(l=nn(new oD,l),d.hasI18nMeta&&(l=nn(new Yw(r,!1),l)));let{nodes:h,errors:p,styleUrls:m,styles:f,ngContentSelectors:g,commentNodes:v}=$ue(l,a,{collectCommentNodes:!!i.collectCommentNodes});p.push(...c.errors,...u.errors);let _={interpolationConfig:r,preserveWhitespaces:n,errors:p.length>0?p:null,nodes:h,styleUrls:m,styles:f,ngContentSelectors:g};return i.collectCommentNodes&&(_.commentNodes=v),_}var Uz=new pm;function r1(e=zl){return new aD(new Gw(new p0),e,Uz,[])}function Hz(e,t){switch(e){case Oi.HTML:return Xe(T.sanitizeHtml);case Oi.SCRIPT:return Xe(T.sanitizeScript);case Oi.STYLE:return t?Xe(T.sanitizeStyle):null;case Oi.URL:return Xe(T.sanitizeUrl);case Oi.RESOURCE_URL:return Xe(T.sanitizeResourceUrl);default:return null}}function mhe(e,t){let i=fl(t.value);if(uz(e,t.name))switch(Uz.securityContext(e,t.name,!0)){case Oi.HTML:return WT(Xe(T.trustConstantHtml),new Hv([new jv(t.value)],[]),void 0,t.valueSpan);case Oi.RESOURCE_URL:return WT(Xe(T.trustConstantResourceUrl),new Hv([new jv(t.value)],[]),void 0,t.valueSpan);default:return i}else return i}function ghe(e){return e.length===1&&e[0]instanceof da}function vhe(e){return e instanceof Rc||e instanceof Hh||e instanceof Qv}function _he(e){return e.toLowerCase()==="iframe"}function BT(e){return e.every(vhe)}function Gx(e,t,i){return()=>{let r=e(),n=Array.isArray(r)?r:[r];return i&&n.push(...i),t&&n.unshift(U(t)),n}}var KV="ngI18nClosureMode";function bhe(e,t,i,r={},n){r=Object.fromEntries(Object.entries(r).sort());let o=[w6(t),w0(yhe(),hz(t,e,i,r),pz(t,e,E0(r,!1)))];return n&&o.push(new oo(t.set(n(t)))),o}function yhe(){return x0(ft(KV)).notIdentical(U("undefined",kD)).and(ft(KV))}function xhe(e){return(e.descendants?1:0)|(e.static?2:0)|(e.emitDistinctChangesOnly?4:0)}function whe(e,t){if(Array.isArray(e.predicate)){let i=[];return e.predicate.forEach(r=>{let n=r.split(",").map(o=>U(o.trim()));i.push(...n)}),t.getConstLiteral(ti(i),!0)}else switch(e.predicate.forwardRef){case 0:case 2:return e.predicate.expression;case 1:return Xe(T.resolveForwardRef).callFn([e.predicate.expression])}}function jz(e,t,i,r){let n=[];r!==void 0&&n.push(...r),e.isSignal&&n.push(new ca(ft(na),e.propertyName)),n.push(whe(e,t),U(xhe(e))),e.read&&n.push(e.read);let o=e.isSignal?i.signalBased:i.nonSignal;return Xe(o).callFn(n)}var KD=Symbol("queryAdvancePlaceholder");function Gz(e){let t=[],i=0,r=()=>{i>0&&(t.unshift(Xe(T.queryAdvance).callFn(i===1?[]:[U(i)]).toStmt()),i=0)};for(let n=e.length-1;n>=0;n--){let o=e[n];o===KD?i++:(r(),t.unshift(o))}return r(),t}function Ehe(e,t,i){let r=[],n=[],o=C6(s=>n.push(s),OD);e.forEach(s=>{let c=jz(s,t,{signalBased:T.viewQuerySignal,nonSignal:T.viewQuery});if(r.push(c.toStmt()),s.isSignal){n.push(KD);return}let l=o(),d=Xe(T.loadQuery).callFn([]),u=Xe(T.queryRefresh).callFn([l.set(d)]),h=ft(na).prop(s.propertyName).set(s.first?l.prop("first"):l);n.push(u.and(h).toStmt())});let a=i?`${i}_Query`:null;return Xl([new Dr(S0,y0),new Dr(na,null)],[su(1,r),su(2,Gz(n))],aa,null,a)}function Che(e,t,i){let r=[],n=[],o=C6(s=>n.push(s),OD);for(let s of e){if(r.push(jz(s,t,{nonSignal:T.contentQuery,signalBased:T.contentQuerySignal},[ft("dirIndex")]).toStmt()),s.isSignal){n.push(KD);continue}let c=o(),l=Xe(T.loadQuery).callFn([]),d=Xe(T.queryRefresh).callFn([c.set(l)]),u=ft(na).prop(s.propertyName).set(s.first?c.prop("first"):c);n.push(d.and(u).toStmt())}let a=i?`${i}_ContentQueries`:null;return Xl([new Dr(S0,y0),new Dr(na,null),new Dr("dirIndex",null)],[su(1,r),su(2,Gz(n))],aa,null,a)}var She=/attr\.([^\]]+)/,$z="%COMP%",The=`_nghost-${$z}`,Ahe=`_ngcontent-${$z}`;function Wz(e,t,i){let r=new Qd,n=b0(e.selector);return r.set("type",e.type.value),n.length>0&&r.set("selectors",fl(n)),e.queries.length>0&&r.set("contentQueries",Che(e.queries,t,e.name)),e.viewQueries.length&&r.set("viewQuery",Ehe(e.viewQueries,t,e.name)),r.set("hostBindings",Lhe(e.host,e.typeSourceSpan,i,t,e.selector||"",e.name,r)),r.set("inputs",_8(e.inputs,!0)),r.set("outputs",_8(e.outputs)),e.exportAs!==null&&r.set("exportAs",ti(e.exportAs.map(o=>U(o)))),e.isStandalone&&r.set("standalone",U(!0)),e.isSignal&&r.set("signals",U(!0)),r}function qz(e,t){let i=[],r=t.providers,n=t.viewProviders,o=Object.keys(t.inputs);if(r||n){let a=[r||new Hs([])];n&&a.push(n),i.push(Xe(T.ProvidersFeature).callFn(a))}for(let a of o)if(t.inputs[a].transformFunction!==null){i.push(Xe(T.InputTransformsFeatureFeature));break}t.hostDirectives?.length&&i.push(Xe(T.HostDirectivesFeature).callFn([$he(t.hostDirectives)])),t.usesInheritance&&i.push(Xe(T.InheritDefinitionFeature)),t.fullInheritance&&i.push(Xe(T.CopyDefinitionFeature)),t.lifecycle.usesOnChanges&&i.push(Xe(T.NgOnChangesFeature)),t.hasOwnProperty("template")&&t.isStandalone&&i.push(Xe(T.StandaloneFeature)),i.length&&e.set("features",ti(i))}function Dhe(e,t,i){let r=Wz(e,t,i);qz(r,e);let n=Xe(T.defineDirective).callFn([r.toLiteralMap()],void 0,!0),o=Fhe(e);return{expression:n,type:o,statements:[]}}function Ihe(e,t,i){let r=[];for(let[o,{importPath:a,isDefaultImport:s}]of i){let c=ro([new Dr("m",Xc)],ft("m").prop(s?"default":o)),l=new Gv(a).prop("then").callFn([c]);r.push(l)}let n=ro([],ti(r));return e.statements.push(n.toDeclStmt(t,po.Final)),ft(t)}function Mhe(e,t,i){let r=Wz(e,t,i);qz(r,e);let n=e.selector&&Xf.parse(e.selector),o=n&&n[0];if(o){let u=o.getAttrs();u.length&&r.set("attrs",t.getConstLiteral(ti(u.map(h=>h!=null?U(h):U(void 0))),!0))}let a=e.name,s=a?`${a}_Template`:null,c=null;if(e.deferBlocks.size>0&&e.deferrableTypes.size>0&&e.deferBlockDepsEmitMode===1){let u=`${a}_DeferFn`;c=Ihe(t,u,e.deferrableTypes)}if(!kz&&!e.useTemplatePipeline){let u=e.template,h=new gD(t,i1.createRootScope(),0,a,null,null,s,T.namespaceHTML,e.relativeContextFilePath,e.i18nUseExternalIds,e.deferBlocks,new Map,c),p=h.buildTemplateFunction(u.nodes,[]),m=h.getNgContentSelectors();m&&r.set("ngContentSelectors",m),r.set("decls",U(h.getConstCount())),r.set("vars",U(h.getVarCount()));let{constExpressions:f,prepareStatements:g}=h.getConsts();if(f.length>0){let v=ti(f);g.length>0&&(v=ro([],[...g,new Rn(v)])),r.set("consts",v)}r.set("template",p)}else{let u=Dde(e.name,e.template.nodes,t,e.relativeContextFilePath,e.i18nUseExternalIds,e.deferBlocks,c);wz(u,dt.Tmpl);let h=Tde(u,t);u.contentSelectors!==null&&r.set("ngContentSelectors",u.contentSelectors),r.set("decls",U(u.root.decls)),r.set("vars",U(u.root.vars)),u.consts.length>0&&(u.constsInitializers.length>0?r.set("consts",ro([],[...u.constsInitializers,new Rn(ti(u.consts))])):r.set("consts",ti(u.consts))),r.set("template",h)}if(e.declarationListEmitMode!==3&&e.declarations.length>0)r.set("dependencies",Phe(ti(e.declarations.map(u=>u.type)),e.declarationListEmitMode));else if(e.declarationListEmitMode===3){let u=[e.type.value];e.rawImports&&u.push(e.rawImports),r.set("dependencies",Xe(T.getComponentDepsFactory).callFn(u))}if(e.encapsulation===null&&(e.encapsulation=Sh.Emulated),e.styles&&e.styles.length){let h=(e.encapsulation==Sh.Emulated?Ghe(e.styles,Ahe,The):e.styles).reduce((p,m)=>(m.trim().length>0&&p.push(t.getConstLiteral(U(m))),p),[]);h.length>0&&r.set("styles",ti(h))}else e.encapsulation===Sh.Emulated&&(e.encapsulation=Sh.None);e.encapsulation!==Sh.Emulated&&r.set("encapsulation",U(e.encapsulation)),e.animations!==null&&r.set("data",ao([{key:"animation",value:e.animations,quoted:!1}])),e.changeDetection!==null&&(typeof e.changeDetection=="number"&&e.changeDetection!==ID.Default?r.set("changeDetection",U(e.changeDetection)):typeof e.changeDetection=="object"&&r.set("changeDetection",e.changeDetection));let l=Xe(T.defineComponent).callFn([r.toLiteralMap()],void 0,!0),d=khe(e);return{expression:l,type:d,statements:[]}}function khe(e){let t=Xz(e);return t.push(yD(e.template.ngContentSelectors)),t.push(fo(U(e.isStandalone))),t.push(Yz(e)),e.isSignal&&t.push(fo(U(e.isSignal))),fo(Xe(T.ComponentDeclaration,t))}function Phe(e,t){switch(t){case 0:return e;case 1:return ro([],e);case 2:let i=e.prop("map").callFn([Xe(T.resolveForwardRef)]);return ro([],i);case 3:throw new Error("Unsupported with an array of pre-resolved dependencies")}}function Nhe(e){let t=[];for(let i of Object.getOwnPropertyNames(e)){let r=e[i];t.push(U(i),r)}return t}function Ohe(e){return fo(U(e))}function bD(e){let t=Object.keys(e).map(i=>{let r=Array.isArray(e[i])?e[i][0]:e[i];return{key:i,value:U(r),quoted:!0}});return ao(t)}function yD(e){return e.length>0?fo(ti(e.map(t=>U(t)))):Wl}function Xz(e){let t=e.selector!==null?e.selector.replace(/\n/g,""):null;return[n1(e.type.type,e.typeArgumentCount),t!==null?Ohe(t):Wl,e.exportAs!==null?yD(e.exportAs):Wl,fo(Rhe(e)),fo(bD(e.outputs)),yD(e.queries.map(i=>i.propertyName))]}function Rhe(e){return ao(Object.keys(e.inputs).map(t=>{let i=e.inputs[t],r=[{key:"alias",value:U(i.bindingPropertyName),quoted:!0},{key:"required",value:U(i.required),quoted:!0}];return i.isSignal&&r.push({key:"isSignal",value:U(i.isSignal),quoted:!0}),{key:t,value:ao(r),quoted:!0}}))}function Fhe(e){let t=Xz(e);return t.push(Wl),t.push(fo(U(e.isStandalone))),t.push(Yz(e)),e.isSignal&&t.push(fo(U(e.isSignal))),fo(Xe(T.DirectiveDeclaration,t))}function Lhe(e,t,i,r,n,o,a){let s=i.createBoundHostProperties(e.properties,t),c=i.createDirectiveHostEventAsts(e.listeners,t);if(kz||e.useTemplatePipeline){e.specialAttributes.styleAttr&&(e.attributes.style=U(e.specialAttributes.styleAttr)),e.specialAttributes.classAttr&&(e.attributes.class=U(e.specialAttributes.classAttr));let M=Ide({componentName:o,componentSelector:n,properties:s,events:c,attributes:e.attributes},i,r);wz(M,dt.Host),a.set("hostAttrs",M.root.attributes);let P=M.root.vars;return P!==null&&P>0&&a.set("hostVars",U(P)),Ade(M)}let l=0,d=()=>`${l++}`,u=ft(na),h=new e1(u),{styleAttr:p,classAttr:m}=e.specialAttributes;p!==void 0&&h.registerStyleAttr(p),m!==void 0&&h.registerClassAttr(m);let f=[],g=[],v=[],_=t;c&&c.length&&f.push(...zhe(c,o));let b=[],y=0;s&&s.forEach(M=>{h.registerInputBasedOnName(M.name,M.expression,_)?y+=Jw:(b.push(M),y++)});let x,w=()=>{if(!x){let M=P=>{let $=y;return y+=P,$};x=new t1(r,()=>aw("Unexpected node"),M,()=>aw("Unexpected pipe"))}return x},I=[],S=[],E=[];for(let M of b){let P=M.expression.visit(w()),$=QV(u,P,d),{bindingName:R,instruction:j,isAttribute:B}=Vhe(M),te=i.calcPossibleSecurityContexts(n,R,B).filter(se=>se!==Oi.NONE),Z=null;te.length&&(te.length===2&&te.indexOf(Oi.URL)>-1&&te.indexOf(Oi.RESOURCE_URL)>-1?Z=Xe(T.sanitizeUrlOrResourceUrl):Z=Hz(te[0],B));let ne=[U(R),$.currValExpr];Z?ne.push(Z):VD(R)&&ne.push(Xe(T.validateIframeAttribute)),v.push(...$.stmts),j===T.hostProperty?I.push(ne):j===T.attribute?S.push(ne):j===T.syntheticHostProperty?E.push(ne):g.push({reference:j,paramsOrFn:ne,span:null})}for(let M of I)g.push({reference:T.hostProperty,paramsOrFn:M,span:null});for(let M of S)g.push({reference:T.attribute,paramsOrFn:M,span:null});for(let M of E)g.push({reference:T.syntheticHostProperty,paramsOrFn:M,span:null});let N=Nhe(e.attributes);if(h.assignHostAttrs(N,a),h.hasBindings&&h.buildUpdateLevelInstructions(w()).forEach(M=>{for(let P of M.calls){y+=Math.max(P.allocateBindingSlots-Jw,0);let{params:$,stmts:R}=Bhe(P,u,QV,d);v.push(...R),g.push({reference:M.reference,paramsOrFn:$,span:null})}}),y&&a.set("hostVars",U(y)),f.length>0||g.length>0){let M=o?`${o}_HostBindings`:null,P=[];return f.length>0&&P.push(su(1,yw(f))),g.length>0&&P.push(su(2,v.concat(yw(g)))),Xl([new Dr(S0,y0),new Dr(na,null)],P,aa,null,M)}return null}function QV(e,t,i){return U6(null,e,t,i())}function Bhe(e,t,i,r){let n=[];return{params:e.params(a=>{let s=i(t,a,r);return Array.isArray(s.stmts)&&s.stmts.length>0&&n.push(...s.stmts),s.currValExpr}),stmts:n}}function Vhe(e){let t=e.name,i,r=t.match(She);return r?(t=r[1],i=T.attribute):e.isAnimation?(t=v6(t),i=T.syntheticHostProperty):i=T.hostProperty,{bindingName:t,instruction:i,isAttribute:!!r}}function zhe(e,t){let i=[],r=[],n=[];for(let o of e){let a=o.name&&Gl(o.name),s=o.type===1?_6(a,o.targetOrPhase):a,c=t&&a?`${t}_${s}_HostBindingHandler`:null,l=zz(dw.fromParsedEvent(o),c);o.type==1?r.push(l):i.push(l)}for(let o of r)n.push({reference:T.syntheticHostListener,paramsOrFn:o,span:null});for(let o of i)n.push({reference:T.listener,paramsOrFn:o,span:null});return n}var Uhe=/^(?:\[([^\]]+)\])|(?:\(([^\)]+)\))$/;function Hhe(e){let t={},i={},r={},n={};for(let o of Object.keys(e)){let a=e[o],s=o.match(Uhe);if(s===null)switch(o){case"class":if(typeof a!="string")throw new Error("Class binding must be string");n.classAttr=a;break;case"style":if(typeof a!="string")throw new Error("Style binding must be string");n.styleAttr=a;break;default:typeof a=="string"?t[o]=U(a):t[o]=a}else if(s[1]!=null){if(typeof a!="string")throw new Error("Property binding must be string");r[s[1]]=a}else if(s[2]!=null){if(typeof a!="string")throw new Error("Event binding must be string");i[s[2]]=a}}return{attributes:t,listeners:i,properties:r,specialAttributes:n}}function jhe(e,t){let i=r1();return i.createDirectiveHostEventAsts(e.listeners,t),i.createBoundHostProperties(e.properties,t),i.errors}function Ghe(e,t,i){let r=new EA;return e.map(n=>r.shimCssText(n,t,i))}function Yz(e){return e.hostDirectives?.length?fo(ti(e.hostDirectives.map(t=>ao([{key:"directive",value:x0(t.directive.type),quoted:!1},{key:"inputs",value:bD(t.inputs||{}),quoted:!1},{key:"outputs",value:bD(t.outputs||{}),quoted:!1}])))):Wl}function $he(e){let t=[],i=!1;for(let r of e){if(!r.inputs&&!r.outputs)t.push(r.directive.type);else{let n=[{key:"directive",value:r.directive.type,quoted:!1}];if(r.inputs){let o=JV(r.inputs);o&&n.push({key:"inputs",value:o,quoted:!1})}if(r.outputs){let o=JV(r.outputs);o&&n.push({key:"outputs",value:o,quoted:!1})}t.push(ao(n))}r.isForwardReference&&(i=!0)}return i?new Lh([],[new Rn(ti(t))]):ti(t)}function JV(e){let t=[];for(let i in e)e.hasOwnProperty(i)&&t.push(U(i),U(e[i]));return t.length>0?ti(t):null}var xD=class{constructor(t){this.directiveMatcher=t}bind(t){if(!t.template)throw new Error("Binding without a template not yet supported");let i=wD.apply(t.template),r=Whe(i),{directives:n,eagerDirectives:o,bindings:a,references:s}=ED.apply(t.template,this.directiveMatcher),{expressions:c,symbols:l,nestingLevel:d,usedPipes:u,eagerPipes:h,deferBlocks:p}=CD.applyWithScope(t.template,i);return new SD(t,n,o,a,s,c,l,d,r,u,h,p)}},wD=class e{constructor(t,i){this.parentScope=t,this.rootNode=i,this.namedEntities=new Map,this.elementsInScope=new Set,this.childScopes=new Map,this.isDeferred=t!==null&&t.isDeferred?!0:i instanceof jh}static newRootScope(){return new e(null,null)}static apply(t){let i=e.newRootScope();return i.ingest(t),i}ingest(t){t instanceof Fa?(t.variables.forEach(i=>this.visitVariable(i)),t.children.forEach(i=>i.visit(this))):t instanceof Ph?(t.expressionAlias!==null&&this.visitVariable(t.expressionAlias),t.children.forEach(i=>i.visit(this))):t instanceof em?(this.visitVariable(t.item),Object.values(t.contextVariables).forEach(i=>this.visitVariable(i)),t.children.forEach(i=>i.visit(this))):t instanceof Yv||t instanceof Zv||t instanceof jh||t instanceof Xv||t instanceof Wv||t instanceof qv?t.children.forEach(i=>i.visit(this)):t.forEach(i=>i.visit(this))}visitElement(t){t.references.forEach(i=>this.visitReference(i)),t.children.forEach(i=>i.visit(this)),this.elementsInScope.add(t)}visitTemplate(t){t.references.forEach(i=>this.visitReference(i)),this.ingestScopedNode(t)}visitVariable(t){this.maybeDeclare(t)}visitReference(t){this.maybeDeclare(t)}visitDeferredBlock(t){this.ingestScopedNode(t),t.placeholder?.visit(this),t.loading?.visit(this),t.error?.visit(this)}visitDeferredBlockPlaceholder(t){this.ingestScopedNode(t)}visitDeferredBlockError(t){this.ingestScopedNode(t)}visitDeferredBlockLoading(t){this.ingestScopedNode(t)}visitSwitchBlock(t){t.cases.forEach(i=>i.visit(this))}visitSwitchBlockCase(t){this.ingestScopedNode(t)}visitForLoopBlock(t){this.ingestScopedNode(t),t.empty?.visit(this)}visitForLoopBlockEmpty(t){this.ingestScopedNode(t)}visitIfBlock(t){t.branches.forEach(i=>i.visit(this))}visitIfBlockBranch(t){this.ingestScopedNode(t)}visitContent(t){}visitBoundAttribute(t){}visitBoundEvent(t){}visitBoundText(t){}visitText(t){}visitTextAttribute(t){}visitIcu(t){}visitDeferredTrigger(t){}visitUnknownBlock(t){}maybeDeclare(t){this.namedEntities.has(t.name)||this.namedEntities.set(t.name,t)}lookup(t){return this.namedEntities.has(t)?this.namedEntities.get(t):this.parentScope!==null?this.parentScope.lookup(t):null}getChildScope(t){let i=this.childScopes.get(t);if(i===void 0)throw new Error(`Assertion error: child scope for ${t} not found`);return i}ingestScopedNode(t){let i=new e(this,t);i.ingest(t),this.childScopes.set(t,i)}},ED=class e{constructor(t,i,r,n,o){this.matcher=t,this.directives=i,this.eagerDirectives=r,this.bindings=n,this.references=o,this.isInDeferBlock=!1}static apply(t,i){let r=new Map,n=new Map,o=new Map,a=[];return new e(i,r,a,n,o).ingest(t),{directives:r,eagerDirectives:a,bindings:n,references:o}}ingest(t){t.forEach(i=>i.visit(this))}visitElement(t){this.visitElementOrTemplate(t)}visitTemplate(t){this.visitElementOrTemplate(t)}visitElementOrTemplate(t){let i=fne(t),r=[];this.matcher.match(i,(o,a)=>r.push(...a)),r.length>0&&(this.directives.set(t,r),this.isInDeferBlock||this.eagerDirectives.push(...r)),t.references.forEach(o=>{let a=null;if(o.value.trim()==="")a=r.find(s=>s.isComponent)||null;else if(a=r.find(s=>s.exportAs!==null&&s.exportAs.some(c=>c===o.value))||null,a===null)return;a!==null?this.references.set(o,{directive:a,node:t}):this.references.set(o,t)});let n=(o,a)=>{let s=r.find(l=>l[a].hasBindingPropertyName(o.name)),c=s!==void 0?s:t;this.bindings.set(o,c)};t.inputs.forEach(o=>n(o,"inputs")),t.attributes.forEach(o=>n(o,"inputs")),t instanceof Fa&&t.templateAttrs.forEach(o=>n(o,"inputs")),t.outputs.forEach(o=>n(o,"outputs")),t.children.forEach(o=>o.visit(this))}visitDeferredBlock(t){let i=this.isInDeferBlock;this.isInDeferBlock=!0,t.children.forEach(r=>r.visit(this)),this.isInDeferBlock=i,t.placeholder?.visit(this),t.loading?.visit(this),t.error?.visit(this)}visitDeferredBlockPlaceholder(t){t.children.forEach(i=>i.visit(this))}visitDeferredBlockError(t){t.children.forEach(i=>i.visit(this))}visitDeferredBlockLoading(t){t.children.forEach(i=>i.visit(this))}visitSwitchBlock(t){t.cases.forEach(i=>i.visit(this))}visitSwitchBlockCase(t){t.children.forEach(i=>i.visit(this))}visitForLoopBlock(t){t.item.visit(this),Object.values(t.contextVariables).forEach(i=>i.visit(this)),t.children.forEach(i=>i.visit(this)),t.empty?.visit(this)}visitForLoopBlockEmpty(t){t.children.forEach(i=>i.visit(this))}visitIfBlock(t){t.branches.forEach(i=>i.visit(this))}visitIfBlockBranch(t){t.expressionAlias?.visit(this),t.children.forEach(i=>i.visit(this))}visitContent(t){}visitVariable(t){}visitReference(t){}visitTextAttribute(t){}visitBoundAttribute(t){}visitBoundEvent(t){}visitBoundAttributeOrEvent(t){}visitText(t){}visitBoundText(t){}visitIcu(t){}visitDeferredTrigger(t){}visitUnknownBlock(t){}},CD=class e extends Dw{constructor(t,i,r,n,o,a,s,c,l){super(),this.bindings=t,this.symbols=i,this.usedPipes=r,this.eagerPipes=n,this.deferBlocks=o,this.nestingLevel=a,this.scope=s,this.rootNode=c,this.level=l,this.visitNode=d=>d.visit(this)}visit(t,i){t instanceof _n?t.visit(this,i):t.visit(this)}static applyWithScope(t,i){let r=new Map,n=new Map,o=new Map,a=new Set,s=new Set,c=t instanceof Fa?t:null,l=new Map;return new e(r,n,a,s,l,o,i,c,0).ingest(t),{expressions:r,symbols:n,nestingLevel:o,usedPipes:a,eagerPipes:s,deferBlocks:l}}ingest(t){if(t instanceof Fa)t.variables.forEach(this.visitNode),t.children.forEach(this.visitNode),this.nestingLevel.set(t,this.level);else if(t instanceof Ph)t.expressionAlias!==null&&this.visitNode(t.expressionAlias),t.children.forEach(this.visitNode),this.nestingLevel.set(t,this.level);else if(t instanceof em)this.visitNode(t.item),Object.values(t.contextVariables).forEach(i=>this.visitNode(i)),t.trackBy.visit(this),t.children.forEach(this.visitNode),this.nestingLevel.set(t,this.level);else if(t instanceof jh){if(this.scope.rootNode!==t)throw new Error(`Assertion error: resolved incorrect scope for deferred block ${t}`);this.deferBlocks.set(t,this.scope),t.children.forEach(i=>i.visit(this)),this.nestingLevel.set(t,this.level)}else t instanceof Yv||t instanceof Zv||t instanceof Xv||t instanceof Wv||t instanceof qv?(t.children.forEach(i=>i.visit(this)),this.nestingLevel.set(t,this.level)):t.forEach(this.visitNode)}visitElement(t){t.inputs.forEach(this.visitNode),t.outputs.forEach(this.visitNode),t.children.forEach(this.visitNode),t.references.forEach(this.visitNode)}visitTemplate(t){t.inputs.forEach(this.visitNode),t.outputs.forEach(this.visitNode),t.templateAttrs.forEach(this.visitNode),t.references.forEach(this.visitNode),this.ingestScopedNode(t)}visitVariable(t){this.rootNode!==null&&this.symbols.set(t,this.rootNode)}visitReference(t){this.rootNode!==null&&this.symbols.set(t,this.rootNode)}visitText(t){}visitContent(t){}visitTextAttribute(t){}visitUnknownBlock(t){}visitDeferredTrigger(){}visitIcu(t){Object.keys(t.vars).forEach(i=>t.vars[i].visit(this)),Object.keys(t.placeholders).forEach(i=>t.placeholders[i].visit(this))}visitBoundAttribute(t){t.value.visit(this)}visitBoundEvent(t){t.handler.visit(this)}visitDeferredBlock(t){this.ingestScopedNode(t),t.triggers.when?.value.visit(this),t.prefetchTriggers.when?.value.visit(this),t.placeholder&&this.visitNode(t.placeholder),t.loading&&this.visitNode(t.loading),t.error&&this.visitNode(t.error)}visitDeferredBlockPlaceholder(t){this.ingestScopedNode(t)}visitDeferredBlockError(t){this.ingestScopedNode(t)}visitDeferredBlockLoading(t){this.ingestScopedNode(t)}visitSwitchBlock(t){t.expression.visit(this),t.cases.forEach(this.visitNode)}visitSwitchBlockCase(t){t.expression?.visit(this),this.ingestScopedNode(t)}visitForLoopBlock(t){t.expression.visit(this),this.ingestScopedNode(t),t.empty?.visit(this)}visitForLoopBlockEmpty(t){this.ingestScopedNode(t)}visitIfBlock(t){t.branches.forEach(i=>i.visit(this))}visitIfBlockBranch(t){t.expression?.visit(this),this.ingestScopedNode(t)}visitBoundText(t){t.value.visit(this)}visitPipe(t,i){return this.usedPipes.add(t.name),this.scope.isDeferred||this.eagerPipes.add(t.name),super.visitPipe(t,i)}visitPropertyRead(t,i){return this.maybeMap(t,t.name),super.visitPropertyRead(t,i)}visitSafePropertyRead(t,i){return this.maybeMap(t,t.name),super.visitSafePropertyRead(t,i)}visitPropertyWrite(t,i){return this.maybeMap(t,t.name),super.visitPropertyWrite(t,i)}ingestScopedNode(t){let i=this.scope.getChildScope(t);new e(this.bindings,this.symbols,this.usedPipes,this.eagerPipes,this.deferBlocks,this.nestingLevel,i,t,this.level+1).ingest(t)}maybeMap(t,i){if(!(t.receiver instanceof Po))return;let r=this.scope.lookup(i);r!==null&&this.bindings.set(t,r)}},SD=class{constructor(t,i,r,n,o,a,s,c,l,d,u,h){this.target=t,this.directives=i,this.eagerDirectives=r,this.bindings=n,this.references=o,this.exprTargets=a,this.symbols=s,this.nestingLevel=c,this.scopedNodeEntities=l,this.usedPipes=d,this.eagerPipes=u,this.deferBlocks=h}getEntitiesInScope(t){return this.scopedNodeEntities.get(t)??new Set}getDirectivesOfNode(t){return this.directives.get(t)||null}getReferenceTarget(t){return this.references.get(t)||null}getConsumerOfBinding(t){return this.bindings.get(t)||null}getExpressionTarget(t){return this.exprTargets.get(t)||null}getDefinitionNodeOfSymbol(t){return this.symbols.get(t)||null}getNestingLevel(t){return this.nestingLevel.get(t)||0}getUsedDirectives(){let t=new Set;return this.directives.forEach(i=>i.forEach(r=>t.add(r))),Array.from(t.values())}getEagerlyUsedDirectives(){let t=new Set(this.eagerDirectives);return Array.from(t.values())}getUsedPipes(){return Array.from(this.usedPipes)}getEagerlyUsedPipes(){return Array.from(this.eagerPipes)}getDeferBlocks(){return Array.from(this.deferBlocks.keys())}getDeferredTriggerTarget(t,i){if(!(i instanceof hw)&&!(i instanceof pw)&&!(i instanceof uw))return null;let r=i.reference;if(r===null){let o=null;if(t.placeholder!==null){for(let a of t.placeholder.children)if(!(a instanceof Qf)){if(o!==null)return null;a instanceof da&&(o=a)}}return o}let n=this.findEntityInScope(t,r);if(n instanceof Kv&&this.getDefinitionNodeOfSymbol(n)!==t){let o=this.getReferenceTarget(n);if(o!==null)return this.referenceTargetToElement(o)}if(t.placeholder!==null){let o=this.findEntityInScope(t.placeholder,r),a=o instanceof Kv?this.getReferenceTarget(o):null;if(a!==null)return this.referenceTargetToElement(a)}return null}isDeferred(t){for(let i of this.deferBlocks.values()){let r=[i];for(;r.length>0;){let n=r.pop();if(n.elementsInScope.has(t))return!0;r.push(...n.childScopes.values())}}return!1}findEntityInScope(t,i){let r=this.getEntitiesInScope(t);for(let n of r)if(n.name===i)return n;return null}referenceTargetToElement(t){return t instanceof da?t:t instanceof Fa?null:this.referenceTargetToElement(t.node)}};function Whe(e){let t=new Map;function i(o){if(t.has(o.rootNode))return t.get(o.rootNode);let a=o.namedEntities,s;return o.parentScope!==null?s=new Map([...i(o.parentScope),...a]):s=new Map(a),t.set(o.rootNode,s),s}let r=[e];for(;r.length>0;){let o=r.pop();for(let a of o.childScopes.values())r.push(a);i(o)}let n=new Map;for(let[o,a]of t)n.set(o,new Set(a.values()));return n}var TD=class{},v1=!0,AD=class{constructor(t=new hA){this.jitEvaluator=t,this.FactoryTarget=kc,this.ResourceLoader=TD,this.elementSchemaRegistry=new pm}compilePipe(t,i,r){let n={name:r.name,type:zn(r.type),typeArgumentCount:0,deps:null,pipeName:r.pipeName,pure:r.pure,isStandalone:r.isStandalone},o=k8(n);return this.jitExpression(o.expression,t,i,[])}compilePipeDeclaration(t,i,r){let n=cpe(r),o=k8(n);return this.jitExpression(o.expression,t,i,[])}compileInjectable(t,i,r){let{expression:n,statements:o}=x8({name:r.name,type:zn(r.type),typeArgumentCount:r.typeArgumentCount,providedIn:o6(r.providedIn),useClass:Of(r,"useClass"),useFactory:n6(r,"useFactory"),useValue:Of(r,"useValue"),useExisting:Of(r,"useExisting"),deps:r.deps?.map(Jz)},!0);return this.jitExpression(n,t,i,o)}compileInjectableDeclaration(t,i,r){let{expression:n,statements:o}=x8({name:r.type.name,type:zn(r.type),typeArgumentCount:0,providedIn:o6(r.providedIn),useClass:Of(r,"useClass"),useFactory:n6(r,"useFactory"),useValue:Of(r,"useValue"),useExisting:Of(r,"useExisting"),deps:r.deps?.map(a6)},!0);return this.jitExpression(n,t,i,o)}compileInjector(t,i,r){let n={name:r.name,type:zn(r.type),providers:r.providers&&r.providers.length>0?new Ti(r.providers):null,imports:r.imports.map(a=>new Ti(a))},o=M8(n);return this.jitExpression(o.expression,t,i,[])}compileInjectorDeclaration(t,i,r){let n=dpe(r),o=M8(n);return this.jitExpression(o.expression,t,i,[])}compileNgModule(t,i,r){let n={kind:Xd.Global,type:zn(r.type),bootstrap:r.bootstrap.map(zn),declarations:r.declarations.map(zn),publicDeclarationTypes:null,imports:r.imports.map(zn),includeImportTypes:!0,exports:r.exports.map(zn),selectorScopeMode:Aw.Inline,containsForwardDecls:!1,schemas:r.schemas?r.schemas.map(zn):null,id:r.id?new Ti(r.id):null},o=Vne(n);return this.jitExpression(o.expression,t,i,[])}compileNgModuleDeclaration(t,i,r){let n=zne(r);return this.jitExpression(n,t,i,[])}compileDirective(t,i,r){let n=i6(r);return this.compileDirectiveFromMeta(t,i,n)}compileDirectiveDeclaration(t,i,r){let n=this.createParseSourceSpan("Directive",r.type.name,i),o=Kz(r,n);return this.compileDirectiveFromMeta(t,i,o)}compileDirectiveFromMeta(t,i,r){let n=new ow,o=r1(),a=Dhe(r,n,o);return this.jitExpression(a.expression,t,i,n.statements)}compileComponent(t,i,r){let{template:n,interpolation:o,deferBlocks:a}=Qz(r.template,r.name,i,r.preserveWhitespaces,r.interpolation),s=ve(L(L({},r),i6(r)),{selector:r.selector||this.elementSchemaRegistry.getDefaultComponentElementName(),template:n,declarations:r.declarations.map(Zhe),declarationListEmitMode:0,deferBlocks:a,deferrableTypes:new Map,deferrableDeclToImportDecl:new Map,deferBlockDepsEmitMode:0,styles:[...r.styles,...n.styles],encapsulation:r.encapsulation,interpolation:o,changeDetection:r.changeDetection??null,animations:r.animations!=null?new Ti(r.animations):null,viewProviders:r.viewProviders!=null?new Ti(r.viewProviders):null,relativeContextFilePath:"",i18nUseExternalIds:!0,useTemplatePipeline:v1}),c=`ng:///${r.name}.js`;return this.compileComponentFromMeta(t,c,s)}compileComponentDeclaration(t,i,r){let n=this.createParseSourceSpan("Component",r.type.name,i),o=Yhe(r,n,i);return this.compileComponentFromMeta(t,i,o)}compileComponentFromMeta(t,i,r){let n=new ow,o=r1(r.interpolation),a=Mhe(r,n,o);return this.jitExpression(a.expression,t,i,n.statements)}compileFactory(t,i,r){let n=Th({name:r.name,type:zn(r.type),typeArgumentCount:r.typeArgumentCount,deps:Jhe(r.deps),target:r.target});return this.jitExpression(n.expression,t,i,n.statements)}compileFactoryDeclaration(t,i,r){let n=Th({name:r.type.name,type:zn(r.type),typeArgumentCount:0,deps:Array.isArray(r.deps)?r.deps.map(a6):r.deps,target:r.target});return this.jitExpression(n.expression,t,i,n.statements)}createParseSourceSpan(t,i,r){return Pne(t,i,r)}jitExpression(t,i,r,n){let o=[...n,new Ro("$def",t,void 0,po.Exported)];return this.jitEvaluator.evaluateStatements(r,o,new fA(i),!0).$def}};function e6(e){return ve(L({},e),{isSignal:e.isSignal,predicate:Zz(e.predicate),read:e.read?new Ti(e.read):null,static:e.static,emitDistinctChangesOnly:e.emitDistinctChangesOnly})}function t6(e){return{propertyName:e.propertyName,first:e.first??!1,predicate:Zz(e.predicate),descendants:e.descendants??!1,read:e.read?new Ti(e.read):null,static:e.static??!1,emitDistinctChangesOnly:e.emitDistinctChangesOnly??!0,isSignal:!!e.isSignal}}function Zz(e){return Array.isArray(e)?e:PD(new Ti(e),1)}function i6(e){let t=lpe(e.inputs||[]),i=zT(e.outputs||[]),r=e.propMetadata,n={},o={};for(let s in r)r.hasOwnProperty(s)&&r[s].forEach(c=>{npe(c)?n[s]={bindingPropertyName:c.alias||s,classPropertyName:s,required:c.required||!1,isSignal:!!c.isSignal,transformFunction:c.transform!=null?new Ti(c.transform):null}:ope(c)&&(o[s]=c.alias||s)});let a=e.hostDirectives?.length?e.hostDirectives.map(s=>typeof s=="function"?{directive:zn(s),inputs:null,outputs:null,isForwardReference:!1}:{directive:zn(s.directive),isForwardReference:!1,inputs:s.inputs?zT(s.inputs):null,outputs:s.outputs?zT(s.outputs):null}):null;return ve(L({},e),{typeArgumentCount:0,typeSourceSpan:e.typeSourceSpan,type:zn(e.type),deps:null,host:ve(L({},tpe(e.propMetadata,e.typeSourceSpan,e.host)),{useTemplatePipeline:v1}),inputs:L(L({},t),n),outputs:L(L({},i),o),queries:e.queries.map(e6),providers:e.providers!=null?new Ti(e.providers):null,viewQueries:e.viewQueries.map(e6),fullInheritance:!1,hostDirectives:a})}function Kz(e,t){let i=e.hostDirectives?.length?e.hostDirectives.map(r=>({directive:zn(r.directive),isForwardReference:!1,inputs:r.inputs?r6(r.inputs):null,outputs:r.outputs?r6(r.outputs):null})):null;return{name:e.type.name,type:zn(e.type),typeSourceSpan:t,selector:e.selector??null,inputs:e.inputs?ape(e.inputs):{},outputs:e.outputs??{},host:qhe(e.host),queries:(e.queries??[]).map(t6),viewQueries:(e.viewQueries??[]).map(t6),providers:e.providers!==void 0?new Ti(e.providers):null,exportAs:e.exportAs??null,usesInheritance:e.usesInheritance??!1,lifecycle:{usesOnChanges:e.usesOnChanges??!1},deps:null,typeArgumentCount:0,fullInheritance:!1,isStandalone:e.isStandalone??!1,isSignal:e.isSignal??!1,hostDirectives:i}}function qhe(e={}){return{attributes:Xhe(e.attributes??{}),listeners:e.listeners??{},properties:e.properties??{},specialAttributes:{classAttr:e.classAttribute,styleAttr:e.styleAttribute},useTemplatePipeline:v1}}function r6(e){let t=null;for(let i=1;i<e.length;i+=2)t=t||{},t[e[i-1]]=e[i];return t}function Xhe(e){let t={};for(let i of Object.keys(e))t[i]=new Ti(e[i]);return t}function Yhe(e,t,i){let{template:r,interpolation:n,deferBlocks:o}=Qz(e.template,e.type.name,i,e.preserveWhitespaces??!1,e.interpolation),a=[];if(e.dependencies)for(let s of e.dependencies)switch(s.kind){case"directive":case"component":a.push(VT(s));break;case"pipe":a.push(Qhe(s));break}else(e.components||e.directives||e.pipes)&&(e.components&&a.push(...e.components.map(s=>VT(s,!0))),e.directives&&a.push(...e.directives.map(s=>VT(s))),e.pipes&&a.push(...Khe(e.pipes)));return ve(L({},Kz(e,t)),{template:r,styles:e.styles??[],declarations:a,viewProviders:e.viewProviders!==void 0?new Ti(e.viewProviders):null,animations:e.animations!==void 0?new Ti(e.animations):null,deferBlocks:o,deferrableTypes:new Map,deferrableDeclToImportDecl:new Map,deferBlockDepsEmitMode:0,changeDetection:e.changeDetection??ID.Default,encapsulation:e.encapsulation??Sh.Emulated,interpolation:n,declarationListEmitMode:2,relativeContextFilePath:"",i18nUseExternalIds:!0,useTemplatePipeline:v1})}function Zhe(e){return ve(L({},e),{type:new Ti(e.type)})}function VT(e,t=null){return{kind:d1.Directive,isComponent:t||e.kind==="component",selector:e.selector,type:new Ti(e.type),inputs:e.inputs??[],outputs:e.outputs??[],exportAs:e.exportAs??null}}function Khe(e){return e?Object.keys(e).map(t=>({kind:d1.Pipe,name:t,type:new Ti(e[t])})):[]}function Qhe(e){return{kind:d1.Pipe,name:e.name,type:new Ti(e.type)}}function Qz(e,t,i,r,n){let o=n?xw.fromArray(n):zl,a=fhe(e,i,{preserveWhitespaces:r,interpolationConfig:o});if(a.errors!==null){let l=a.errors.map(d=>d.toString()).join(", ");throw new Error(`Errors during JIT compilation of template for ${t}: ${l}`)}let c=new xD(new Yx).bind({template:a.nodes});return{template:a,interpolation:o,deferBlocks:epe(c)}}function Of(e,t){if(e.hasOwnProperty(t))return PD(new Ti(e[t]),0)}function n6(e,t){if(e.hasOwnProperty(t))return new Ti(e[t])}function o6(e){let t=typeof e=="function"?new Ti(e):new no(e??null);return PD(t,0)}function Jhe(e){return e==null?null:e.map(Jz)}function Jz(e){let t=e.attribute!=null,i=e.token===null?null:new Ti(e.token),r=t?new Ti(e.attribute):i;return eU(r,t,e.host,e.optional,e.self,e.skipSelf)}function a6(e){let t=e.attribute??!1,i=e.token===null?null:new Ti(e.token);return eU(i,t,e.host??!1,e.optional??!1,e.self??!1,e.skipSelf??!1)}function eU(e,t,i,r,n,o){let a=t?U("unknown"):null;return{token:e,attributeNameType:a,host:i,optional:r,self:n,skipSelf:o}}function epe(e){let t=e.getDeferBlocks(),i=new Map;for(let r of t){let n=new Map;s6(r,r.triggers,e,n),s6(r,r.prefetchTriggers,e,n),i.set(r,{deps:[],triggerElements:n})}return i}function s6(e,t,i,r){Object.keys(t).forEach(n=>{let o=t[n];r.set(o,i.getDeferredTriggerTarget(e,o))})}function tpe(e,t,i){let r=Hhe(i||{}),n=jhe(r,t);if(n.length)throw new Error(n.map(o=>o.msg).join(`
`));for(let o in e)e.hasOwnProperty(o)&&e[o].forEach(a=>{ipe(a)?r.properties[a.hostPropertyName||o]=zre("this",o):rpe(a)&&(r.listeners[a.eventName||o]=`${o}(${(a.args||[]).join(",")})`)});return r}function ipe(e){return e.ngMetadataName==="HostBinding"}function rpe(e){return e.ngMetadataName==="HostListener"}function npe(e){return e.ngMetadataName==="Input"}function ope(e){return e.ngMetadataName==="Output"}function ape(e){return Object.keys(e).reduce((t,i)=>{let r=e[i];return typeof r=="string"||Array.isArray(r)?t[i]=spe(r):t[i]={bindingPropertyName:r.publicName,classPropertyName:i,transformFunction:r.transformFunction!==null?new Ti(r.transformFunction):null,required:r.isRequired,isSignal:r.isSignal},t},{})}function spe(e){return typeof e=="string"?{bindingPropertyName:e,classPropertyName:e,transformFunction:null,required:!1,isSignal:!1}:{bindingPropertyName:e[0],classPropertyName:e[1],transformFunction:e[2]?new Ti(e[2]):null,required:!1,isSignal:!1}}function lpe(e){return e.reduce((t,i)=>{if(typeof i=="string"){let[r,n]=tU(i);t[n]={bindingPropertyName:r,classPropertyName:n,required:!1,isSignal:!1,transformFunction:null}}else t[i.name]={bindingPropertyName:i.alias||i.name,classPropertyName:i.name,required:i.required||!1,isSignal:!1,transformFunction:i.transform!=null?new Ti(i.transform):null};return t},{})}function zT(e){return e.reduce((t,i)=>{let[r,n]=tU(i);return t[n]=r,t},{})}function tU(e){let[t,i]=e.split(":",2).map(r=>r.trim());return[i??t,t]}function cpe(e){return{name:e.type.name,type:zn(e.type),typeArgumentCount:0,pipeName:e.name,deps:null,pure:e.pure??!0,isStandalone:e.isStandalone??!1}}function dpe(e){return{name:e.type.name,type:zn(e.type),providers:e.providers!==void 0&&e.providers.length>0?new Ti(e.providers):null,imports:e.imports!==void 0?e.imports.map(t=>new Ti(t)):[]}}function upe(e){let t=e.ng||(e.ng={});t.\u0275compilerFacade=new AD}var NUe=new qT("17.3.12");var DD=class{constructor(){this.closedByParent=!1,this.implicitNamespacePrefix=null,this.isVoid=!1,this.ignoreFirstLf=!1,this.canSelfClose=!0,this.preventNamespaceInheritance=!1}requireExtraParent(t){return!1}isClosedByChild(t){return!1}getContentType(){return Vl.PARSABLE_DATA}},OUe=new DD;upe(Ov);var dU=(()=>{class e{constructor(i,r){this._renderer=i,this._elementRef=r,this.onChange=n=>{},this.onTouched=()=>{}}setProperty(i,r){this._renderer.setProperty(this._elementRef.nativeElement,i,r)}registerOnTouched(i){this.onTouched=i}registerOnChange(i){this.onChange=i}setDisabledState(i){this.setProperty("disabled",i)}static{this.\u0275fac=function(r){return new(r||e)(G(Bg),G(vt))}}static{this.\u0275dir=xt({type:e})}}return e})(),hpe=(()=>{class e extends dU{static{this.\u0275fac=(()=>{let i;return function(n){return(i||(i=Ar(e)))(n||e)}})()}static{this.\u0275dir=xt({type:e,features:[Yt]})}}return e})(),Ql=new Ye("");var ppe={provide:Ql,useExisting:Yo(()=>C1),multi:!0};function fpe(){let e=Ju()?Ju().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}var mpe=new Ye(""),C1=(()=>{class e extends dU{constructor(i,r,n){super(i,r),this._compositionMode=n,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!fpe())}writeValue(i){let r=i??"";this.setProperty("value",r)}_handleInput(i){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(i)}_compositionStart(){this._composing=!0}_compositionEnd(i){this._composing=!1,this._compositionMode&&this.onChange(i)}static{this.\u0275fac=function(r){return new(r||e)(G(Bg),G(vt),G(mpe,8))}}static{this.\u0275dir=xt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,n){r&1&&Y("input",function(a){return n._handleInput(a.target.value)})("blur",function(){return n.onTouched()})("compositionstart",function(){return n._compositionStart()})("compositionend",function(a){return n._compositionEnd(a.target.value)})},features:[Li([ppe]),Yt]})}}return e})();function lu(e){return e==null||(typeof e=="string"||Array.isArray(e))&&e.length===0}function uU(e){return e!=null&&typeof e.length=="number"}var sp=new Ye(""),iI=new Ye(""),gpe=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,ym=class{static min(t){return vpe(t)}static max(t){return _pe(t)}static required(t){return bpe(t)}static requiredTrue(t){return ype(t)}static email(t){return xpe(t)}static minLength(t){return wpe(t)}static maxLength(t){return Epe(t)}static pattern(t){return Cpe(t)}static nullValidator(t){return hU(t)}static compose(t){return _U(t)}static composeAsync(t){return bU(t)}};function vpe(e){return t=>{if(lu(t.value)||lu(e))return null;let i=parseFloat(t.value);return!isNaN(i)&&i<e?{min:{min:e,actual:t.value}}:null}}function _pe(e){return t=>{if(lu(t.value)||lu(e))return null;let i=parseFloat(t.value);return!isNaN(i)&&i>e?{max:{max:e,actual:t.value}}:null}}function bpe(e){return lu(e.value)?{required:!0}:null}function ype(e){return e.value===!0?null:{required:!0}}function xpe(e){return lu(e.value)||gpe.test(e.value)?null:{email:!0}}function wpe(e){return t=>lu(t.value)||!uU(t.value)?null:t.value.length<e?{minlength:{requiredLength:e,actualLength:t.value.length}}:null}function Epe(e){return t=>uU(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}function Cpe(e){if(!e)return hU;let t,i;return typeof e=="string"?(i="",e.charAt(0)!=="^"&&(i+="^"),i+=e,e.charAt(e.length-1)!=="$"&&(i+="$"),t=new RegExp(i)):(i=e.toString(),t=e),r=>{if(lu(r.value))return null;let n=r.value;return t.test(n)?null:{pattern:{requiredPattern:i,actualValue:n}}}}function hU(e){return null}function pU(e){return e!=null}function fU(e){return Hb(e)?Co(e):e}function mU(e){let t={};return e.forEach(i=>{t=i!=null?L(L({},t),i):t}),Object.keys(t).length===0?null:t}function gU(e,t){return t.map(i=>i(e))}function Spe(e){return!e.validate}function vU(e){return e.map(t=>Spe(t)?t:i=>t.validate(i))}function _U(e){if(!e)return null;let t=e.filter(pU);return t.length==0?null:function(i){return mU(gU(i,t))}}function rI(e){return e!=null?_U(vU(e)):null}function bU(e){if(!e)return null;let t=e.filter(pU);return t.length==0?null:function(i){let r=gU(i,t).map(fU);return Nb(r).pipe(Xt(mU))}}function nI(e){return e!=null?bU(vU(e)):null}function iU(e,t){return e===null?[t]:Array.isArray(e)?[...e,t]:[e,t]}function yU(e){return e._rawValidators}function xU(e){return e._rawAsyncValidators}function QD(e){return e?Array.isArray(e)?e:[e]:[]}function b1(e,t){return Array.isArray(e)?e.includes(t):e===t}function rU(e,t){let i=QD(t);return QD(e).forEach(n=>{b1(i,n)||i.push(n)}),i}function nU(e,t){return QD(t).filter(i=>!b1(e,i))}var y1=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=rI(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=nI(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,i){return this.control?this.control.hasError(t,i):!1}getError(t,i){return this.control?this.control.getError(t,i):null}},ap=class extends y1{get formDirective(){return null}get path(){return null}},Zc=class extends y1{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},JD=class{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},Tpe={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},QUe=ve(L({},Tpe),{"[class.ng-submitted]":"isSubmitted"}),so=(()=>{class e extends JD{constructor(i){super(i)}static{this.\u0275fac=function(r){return new(r||e)(G(Zc,2))}}static{this.\u0275dir=xt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,n){r&2&&It("ng-untouched",n.isUntouched)("ng-touched",n.isTouched)("ng-pristine",n.isPristine)("ng-dirty",n.isDirty)("ng-valid",n.isValid)("ng-invalid",n.isInvalid)("ng-pending",n.isPending)},features:[Yt]})}}return e})();var I0="VALID",_1="INVALID",bm="PENDING",M0="DISABLED";function oI(e){return(S1(e)?e.validators:e)||null}function Ape(e){return Array.isArray(e)?rI(e):e||null}function aI(e,t){return(S1(t)?t.asyncValidators:e)||null}function Dpe(e){return Array.isArray(e)?nI(e):e||null}function S1(e){return e!=null&&!Array.isArray(e)&&typeof e=="object"}function wU(e,t,i){let r=e.controls;if(!(t?Object.keys(r):r).length)throw new Tr(1e3,"");if(!r[i])throw new Tr(1001,"")}function EU(e,t,i){e._forEachChild((r,n)=>{if(i[n]===void 0)throw new Tr(1002,"")})}var xm=class{constructor(t,i){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(i)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===I0}get invalid(){return this.status===_1}get pending(){return this.status==bm}get disabled(){return this.status===M0}get enabled(){return this.status!==M0}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(rU(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(rU(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(nU(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(nU(t,this._rawAsyncValidators))}hasValidator(t){return b1(this._rawValidators,t)}hasAsyncValidator(t){return b1(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(i=>{i.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=bm,t.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){let i=this._parentMarkedDirty(t.onlySelf);this.status=M0,this.errors=null,this._forEachChild(r=>{r.disable(ve(L({},t),{onlySelf:!0}))}),this._updateValue(),t.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ve(L({},t),{skipPristineCheck:i})),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){let i=this._parentMarkedDirty(t.onlySelf);this.status=I0,this._forEachChild(r=>{r.enable(ve(L({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(ve(L({},t),{skipPristineCheck:i})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===I0||this.status===bm)&&this._runAsyncValidator(t.emitEvent)),t.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(i=>i._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?M0:I0}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=bm,this._hasOwnPendingAsyncValidator=!0;let i=fU(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,i={}){this.errors=t,this._updateControlsErrors(i.emitEvent!==!1)}get(t){let i=t;return i==null||(Array.isArray(i)||(i=i.split(".")),i.length===0)?null:i.reduce((r,n)=>r&&r._find(n),this)}getError(t,i){let r=i?this.get(i):this;return r&&r.errors?r.errors[t]:null}hasError(t,i){return!!this.getError(t,i)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new We,this.statusChanges=new We}_calculateStatus(){return this._allControlsDisabled()?M0:this.errors?_1:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(bm)?bm:this._anyControlsHaveStatus(_1)?_1:I0}_anyControlsHaveStatus(t){return this._anyControls(i=>i.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){S1(t)&&t.updateOn!=null&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){let i=this._parent&&this._parent.dirty;return!t&&!!i&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=Ape(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=Dpe(this._rawAsyncValidators)}},wm=class extends xm{constructor(t,i,r){super(oI(i),aI(r,i)),this.controls=t,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,i){return this.controls[t]?this.controls[t]:(this.controls[t]=i,i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange),i)}addControl(t,i,r={}){this.registerControl(t,i),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}setControl(t,i,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],i&&this.registerControl(t,i),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,i={}){EU(this,!0,t),Object.keys(t).forEach(r=>{wU(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(t,i={}){t!=null&&(Object.keys(t).forEach(r=>{let n=this.controls[r];n&&n.patchValue(t[r],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(t={},i={}){this._forEachChild((r,n)=>{r.reset(t?t[n]:null,{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i),this._updateTouched(i),this.updateValueAndValidity(i)}getRawValue(){return this._reduceChildren({},(t,i,r)=>(t[r]=i.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(i,r)=>r._syncPendingControls()?!0:i);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(i=>{let r=this.controls[i];r&&t(r,i)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(let[i,r]of Object.entries(this.controls))if(this.contains(i)&&t(r))return!0;return!1}_reduceValue(){let t={};return this._reduceChildren(t,(i,r,n)=>((r.enabled||this.disabled)&&(i[n]=r.value),i))}_reduceChildren(t,i){let r=t;return this._forEachChild((n,o)=>{r=i(r,n,o)}),r}_allControlsDisabled(){for(let t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}};var eI=class extends wm{};var P0=new Ye("CallSetDisabledState",{providedIn:"root",factory:()=>T1}),T1="always";function Ipe(e,t){return[...t.path,e]}function x1(e,t,i=T1){sI(e,t),t.valueAccessor.writeValue(e.value),(e.disabled||i==="always")&&t.valueAccessor.setDisabledState?.(e.disabled),kpe(e,t),Npe(e,t),Ppe(e,t),Mpe(e,t)}function oU(e,t,i=!0){let r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),E1(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(()=>{}))}function w1(e,t){e.forEach(i=>{i.registerOnValidatorChange&&i.registerOnValidatorChange(t)})}function Mpe(e,t){if(t.valueAccessor.setDisabledState){let i=r=>{t.valueAccessor.setDisabledState(r)};e.registerOnDisabledChange(i),t._registerOnDestroy(()=>{e._unregisterOnDisabledChange(i)})}}function sI(e,t){let i=yU(e);t.validator!==null?e.setValidators(iU(i,t.validator)):typeof i=="function"&&e.setValidators([i]);let r=xU(e);t.asyncValidator!==null?e.setAsyncValidators(iU(r,t.asyncValidator)):typeof r=="function"&&e.setAsyncValidators([r]);let n=()=>e.updateValueAndValidity();w1(t._rawValidators,n),w1(t._rawAsyncValidators,n)}function E1(e,t){let i=!1;if(e!==null){if(t.validator!==null){let n=yU(e);if(Array.isArray(n)&&n.length>0){let o=n.filter(a=>a!==t.validator);o.length!==n.length&&(i=!0,e.setValidators(o))}}if(t.asyncValidator!==null){let n=xU(e);if(Array.isArray(n)&&n.length>0){let o=n.filter(a=>a!==t.asyncValidator);o.length!==n.length&&(i=!0,e.setAsyncValidators(o))}}}let r=()=>{};return w1(t._rawValidators,r),w1(t._rawAsyncValidators,r),i}function kpe(e,t){t.valueAccessor.registerOnChange(i=>{e._pendingValue=i,e._pendingChange=!0,e._pendingDirty=!0,e.updateOn==="change"&&CU(e,t)})}function Ppe(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,e.updateOn==="blur"&&e._pendingChange&&CU(e,t),e.updateOn!=="submit"&&e.markAsTouched()})}function CU(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function Npe(e,t){let i=(r,n)=>{t.valueAccessor.writeValue(r),n&&t.viewToModelUpdate(r)};e.registerOnChange(i),t._registerOnDestroy(()=>{e._unregisterOnChange(i)})}function SU(e,t){e==null,sI(e,t)}function Ope(e,t){return E1(e,t)}function Rpe(e,t){if(!e.hasOwnProperty("model"))return!1;let i=e.model;return i.isFirstChange()?!0:!Object.is(t,i.currentValue)}function Fpe(e){return Object.getPrototypeOf(e.constructor)===hpe}function TU(e,t){e._syncPendingControls(),t.forEach(i=>{let r=i.control;r.updateOn==="submit"&&r._pendingChange&&(i.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function Lpe(e,t){if(!t)return null;Array.isArray(t);let i,r,n;return t.forEach(o=>{o.constructor===C1?i=o:Fpe(o)?r=o:n=o}),n||r||i||null}function Bpe(e,t){let i=e.indexOf(t);i>-1&&e.splice(i,1)}var Vpe={provide:ap,useExisting:Yo(()=>N0)},k0=Promise.resolve(),N0=(()=>{class e extends ap{constructor(i,r,n){super(),this.callSetDisabledState=n,this.submitted=!1,this._directives=new Set,this.ngSubmit=new We,this.form=new wm({},rI(i),nI(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(i){k0.then(()=>{let r=this._findContainer(i.path);i.control=r.registerControl(i.name,i.control),x1(i.control,i,this.callSetDisabledState),i.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(i)})}getControl(i){return this.form.get(i.path)}removeControl(i){k0.then(()=>{let r=this._findContainer(i.path);r&&r.removeControl(i.name),this._directives.delete(i)})}addFormGroup(i){k0.then(()=>{let r=this._findContainer(i.path),n=new wm({});SU(n,i),r.registerControl(i.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(i){k0.then(()=>{let r=this._findContainer(i.path);r&&r.removeControl(i.name)})}getFormGroup(i){return this.form.get(i.path)}updateModel(i,r){k0.then(()=>{this.form.get(i.path).setValue(r)})}setValue(i){this.control.setValue(i)}onSubmit(i){return this.submitted=!0,TU(this.form,this._directives),this.ngSubmit.emit(i),i?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(i=void 0){this.form.reset(i),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(i){return i.pop(),i.length?this.form.get(i):this.form}static{this.\u0275fac=function(r){return new(r||e)(G(sp,10),G(iI,10),G(P0,8))}}static{this.\u0275dir=xt({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,n){r&1&&Y("submit",function(a){return n.onSubmit(a)})("reset",function(){return n.onReset()})},inputs:{options:[_e.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Li([Vpe]),Yt]})}}return e})();function aU(e,t){let i=e.indexOf(t);i>-1&&e.splice(i,1)}function sU(e){return typeof e=="object"&&e!==null&&Object.keys(e).length===2&&"value"in e&&"disabled"in e}var op=class extends xm{constructor(t=null,i,r){super(oI(i),aI(r,i)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(i),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),S1(i)&&(i.nonNullable||i.initialValueIsDefault)&&(sU(t)?this.defaultValue=t.value:this.defaultValue=t)}setValue(t,i={}){this.value=this._pendingValue=t,this._onChange.length&&i.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,i.emitViewToModelChange!==!1)),this.updateValueAndValidity(i)}patchValue(t,i={}){this.setValue(t,i)}reset(t=this.defaultValue,i={}){this._applyFormState(t),this.markAsPristine(i),this.markAsUntouched(i),this.setValue(this.value,i),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){aU(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){aU(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(t){sU(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};var zpe=e=>e instanceof op;var Upe={provide:Zc,useExisting:Yo(()=>Un)},lU=Promise.resolve(),Un=(()=>{class e extends Zc{constructor(i,r,n,o,a,s){super(),this._changeDetectorRef=a,this.callSetDisabledState=s,this.control=new op,this._registered=!1,this.name="",this.update=new We,this._parent=i,this._setValidators(r),this._setAsyncValidators(n),this.valueAccessor=Lpe(this,o)}ngOnChanges(i){if(this._checkForErrors(),!this._registered||"name"in i){if(this._registered&&(this._checkName(),this.formDirective)){let r=i.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in i&&this._updateDisabled(i),Rpe(i,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){x1(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(i){lU.then(()=>{this.control.setValue(i,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(i){let r=i.isDisabled.currentValue,n=r!==0&&yt(r);lU.then(()=>{n&&!this.control.disabled?this.control.disable():!n&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(i){return this._parent?Ipe(i,this._parent):[i]}static{this.\u0275fac=function(r){return new(r||e)(G(ap,9),G(sp,10),G(iI,10),G(Ql,10),G(ei,8),G(P0,8))}}static{this.\u0275dir=xt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[_e.None,"disabled","isDisabled"],model:[_e.None,"ngModel","model"],options:[_e.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Li([Upe]),Yt,kr]})}}return e})();var Hpe=new Ye("");var jpe={provide:ap,useExisting:Yo(()=>O0)},O0=(()=>{class e extends ap{constructor(i,r,n){super(),this.callSetDisabledState=n,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new We,this._setValidators(i),this._setAsyncValidators(r)}ngOnChanges(i){this._checkFormPresent(),i.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(E1(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(i){let r=this.form.get(i.path);return x1(r,i,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(i),r}getControl(i){return this.form.get(i.path)}removeControl(i){oU(i.control||null,i,!1),Bpe(this.directives,i)}addFormGroup(i){this._setUpFormContainer(i)}removeFormGroup(i){this._cleanUpFormContainer(i)}getFormGroup(i){return this.form.get(i.path)}addFormArray(i){this._setUpFormContainer(i)}removeFormArray(i){this._cleanUpFormContainer(i)}getFormArray(i){return this.form.get(i.path)}updateModel(i,r){this.form.get(i.path).setValue(r)}onSubmit(i){return this.submitted=!0,TU(this.form,this.directives),this.ngSubmit.emit(i),i?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(i=void 0){this.form.reset(i),this.submitted=!1}_updateDomValue(){this.directives.forEach(i=>{let r=i.control,n=this.form.get(i.path);r!==n&&(oU(r||null,i),zpe(n)&&(x1(n,i,this.callSetDisabledState),i.control=n))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(i){let r=this.form.get(i.path);SU(r,i),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(i){if(this.form){let r=this.form.get(i.path);r&&Ope(r,i)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){sI(this.form,this),this._oldForm&&E1(this._oldForm,this)}_checkFormPresent(){this.form}static{this.\u0275fac=function(r){return new(r||e)(G(sp,10),G(iI,10),G(P0,8))}}static{this.\u0275dir=xt({type:e,selectors:[["","formGroup",""]],hostBindings:function(r,n){r&1&&Y("submit",function(a){return n.onSubmit(a)})("reset",function(){return n.onReset()})},inputs:{form:[_e.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Li([jpe]),Yt,kr]})}}return e})();var AU=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({})}}return e})(),tI=class extends xm{constructor(t,i,r){super(oI(i),aI(r,i)),this.controls=t,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,i={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}insert(t,i,r={}){this.controls.splice(t,0,i),this._registerControl(i),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(t,i={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:i.emitEvent})}setControl(t,i,r={}){let n=this._adjustIndex(t);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),i&&(this.controls.splice(n,0,i),this._registerControl(i)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,i={}){EU(this,!1,t),t.forEach((r,n)=>{wU(this,!1,n),this.at(n).setValue(r,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(t,i={}){t!=null&&(t.forEach((r,n)=>{this.at(n)&&this.at(n).patchValue(r,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(t=[],i={}){this._forEachChild((r,n)=>{r.reset(t[n],{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i),this._updateTouched(i),this.updateValueAndValidity(i)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(i=>i._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((i,r)=>r._syncPendingControls()?!0:i,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((i,r)=>{t(i,r)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(i=>i.enabled&&t(i))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(let t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}};function cU(e){return!!e&&(e.asyncValidators!==void 0||e.validators!==void 0||e.updateOn!==void 0)}var DU=(()=>{class e{constructor(){this.useNonNullable=!1}get nonNullable(){let i=new e;return i.useNonNullable=!0,i}group(i,r=null){let n=this._reduceControls(i),o={};return cU(r)?o=r:r!==null&&(o.validators=r.validator,o.asyncValidators=r.asyncValidator),new wm(n,o)}record(i,r=null){let n=this._reduceControls(i);return new eI(n,r)}control(i,r,n){let o={};return this.useNonNullable?(cU(r)?o=r:(o.validators=r,o.asyncValidators=n),new op(i,ve(L({},o),{nonNullable:!0}))):new op(i,r,n)}array(i,r,n){let o=i.map(a=>this._createControl(a));return new tI(o,r,n)}_reduceControls(i){let r={};return Object.keys(i).forEach(n=>{r[n]=this._createControl(i[n])}),r}_createControl(i){if(i instanceof op)return i;if(i instanceof xm)return i;if(Array.isArray(i)){let r=i[0],n=i.length>1?i[1]:null,o=i.length>2?i[2]:null;return this.control(r,n,o)}else return this.control(i)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var IU=(()=>{class e{static withConfig(i){return{ngModule:e,providers:[{provide:P0,useValue:i.callSetDisabledState??T1}]}}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[AU]})}}return e})(),MU=(()=>{class e{static withConfig(i){return{ngModule:e,providers:[{provide:Hpe,useValue:i.warnOnNgModelWithFormControl??"always"},{provide:P0,useValue:i.callSetDisabledState??T1}]}}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[AU]})}}return e})();var yi="primary",Y0=Symbol("RouteTitle"),hI=class{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){let i=this.params[t];return Array.isArray(i)?i[0]:i}return null}getAll(t){if(this.has(t)){let i=this.params[t];return Array.isArray(i)?i:[i]}return[]}get keys(){return Object.keys(this.params)}};function Am(e){return new hI(e)}function Gpe(e,t,i){let r=i.path.split("/");if(r.length>e.length||i.pathMatch==="full"&&(t.hasChildren()||r.length<e.length))return null;let n={};for(let o=0;o<r.length;o++){let a=r[o],s=e[o];if(a.startsWith(":"))n[a.substring(1)]=s;else if(a!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:n}}function $pe(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!Jl(e[i],t[i]))return!1;return!0}function Jl(e,t){let i=e?pI(e):void 0,r=t?pI(t):void 0;if(!i||!r||i.length!=r.length)return!1;let n;for(let o=0;o<i.length;o++)if(n=i[o],!VU(e[n],t[n]))return!1;return!0}function pI(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function VU(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;let i=[...e].sort(),r=[...t].sort();return i.every((n,o)=>r[o]===n)}else return e===t}function zU(e){return e.length>0?e[e.length-1]:null}function pu(e){return kb(e)?e:Hb(e)?Co(Promise.resolve(e)):Dt(e)}var Wpe={exact:HU,subset:jU},UU={exact:qpe,subset:Xpe,ignored:()=>!0};function kU(e,t,i){return Wpe[i.paths](e.root,t.root,i.matrixParams)&&UU[i.queryParams](e.queryParams,t.queryParams)&&!(i.fragment==="exact"&&e.fragment!==t.fragment)}function qpe(e,t){return Jl(e,t)}function HU(e,t,i){if(!cp(e.segments,t.segments)||!I1(e.segments,t.segments,i)||e.numberOfChildren!==t.numberOfChildren)return!1;for(let r in t.children)if(!e.children[r]||!HU(e.children[r],t.children[r],i))return!1;return!0}function Xpe(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(i=>VU(e[i],t[i]))}function jU(e,t,i){return GU(e,t,t.segments,i)}function GU(e,t,i,r){if(e.segments.length>i.length){let n=e.segments.slice(0,i.length);return!(!cp(n,i)||t.hasChildren()||!I1(n,i,r))}else if(e.segments.length===i.length){if(!cp(e.segments,i)||!I1(e.segments,i,r))return!1;for(let n in t.children)if(!e.children[n]||!jU(e.children[n],t.children[n],r))return!1;return!0}else{let n=i.slice(0,e.segments.length),o=i.slice(e.segments.length);return!cp(e.segments,n)||!I1(e.segments,n,r)||!e.children[yi]?!1:GU(e.children[yi],t,o,r)}}function I1(e,t,i){return t.every((r,n)=>UU[i](e[n].parameters,r.parameters))}var cu=class{constructor(t=new vr([],{}),i={},r=null){this.root=t,this.queryParams=i,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Am(this.queryParams),this._queryParamMap}toString(){return Kpe.serialize(this)}},vr=class{constructor(t,i){this.segments=t,this.children=i,this.parent=null,Object.values(i).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return M1(this)}},lp=class{constructor(t,i){this.path=t,this.parameters=i}get parameterMap(){return this._parameterMap??=Am(this.parameters),this._parameterMap}toString(){return WU(this)}};function Ype(e,t){return cp(e,t)&&e.every((i,r)=>Jl(i.parameters,t[r].parameters))}function cp(e,t){return e.length!==t.length?!1:e.every((i,r)=>i.path===t[r].path)}function Zpe(e,t){let i=[];return Object.entries(e.children).forEach(([r,n])=>{r===yi&&(i=i.concat(t(n,r)))}),Object.entries(e.children).forEach(([r,n])=>{r!==yi&&(i=i.concat(t(n,r)))}),i}var Z0=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:()=>new U0,providedIn:"root"})}}return e})(),U0=class{parse(t){let i=new mI(t);return new cu(i.parseRootSegment(),i.parseQueryParams(),i.parseFragment())}serialize(t){let i=`/${R0(t.root,!0)}`,r=efe(t.queryParams),n=typeof t.fragment=="string"?`#${Qpe(t.fragment)}`:"";return`${i}${r}${n}`}},Kpe=new U0;function M1(e){return e.segments.map(t=>WU(t)).join("/")}function R0(e,t){if(!e.hasChildren())return M1(e);if(t){let i=e.children[yi]?R0(e.children[yi],!1):"",r=[];return Object.entries(e.children).forEach(([n,o])=>{n!==yi&&r.push(`${n}:${R0(o,!1)}`)}),r.length>0?`${i}(${r.join("//")})`:i}else{let i=Zpe(e,(r,n)=>n===yi?[R0(e.children[yi],!1)]:[`${n}:${R0(r,!1)}`]);return Object.keys(e.children).length===1&&e.children[yi]!=null?`${M1(e)}/${i[0]}`:`${M1(e)}/(${i.join("//")})`}}function $U(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function A1(e){return $U(e).replace(/%3B/gi,";")}function Qpe(e){return encodeURI(e)}function fI(e){return $U(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function k1(e){return decodeURIComponent(e)}function PU(e){return k1(e.replace(/\+/g,"%20"))}function WU(e){return`${fI(e.path)}${Jpe(e.parameters)}`}function Jpe(e){return Object.entries(e).map(([t,i])=>`;${fI(t)}=${fI(i)}`).join("")}function efe(e){let t=Object.entries(e).map(([i,r])=>Array.isArray(r)?r.map(n=>`${A1(i)}=${A1(n)}`).join("&"):`${A1(i)}=${A1(r)}`).filter(i=>i);return t.length?`?${t.join("&")}`:""}var tfe=/^[^\/()?;#]+/;function lI(e){let t=e.match(tfe);return t?t[0]:""}var ife=/^[^\/()?;=#]+/;function rfe(e){let t=e.match(ife);return t?t[0]:""}var nfe=/^[^=?&#]+/;function ofe(e){let t=e.match(nfe);return t?t[0]:""}var afe=/^[^&#]+/;function sfe(e){let t=e.match(afe);return t?t[0]:""}var mI=class{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new vr([],{}):new vr([],this.parseChildren())}parseQueryParams(){let t={};if(this.consumeOptional("?"))do this.parseQueryParam(t);while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let i={};this.peekStartsWith("/(")&&(this.capture("/"),i=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(i).length>0)&&(r[yi]=new vr(t,i)),r}parseSegment(){let t=lI(this.remaining);if(t===""&&this.peekStartsWith(";"))throw new Tr(4009,!1);return this.capture(t),new lp(k1(t),this.parseMatrixParams())}parseMatrixParams(){let t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){let i=rfe(this.remaining);if(!i)return;this.capture(i);let r="";if(this.consumeOptional("=")){let n=lI(this.remaining);n&&(r=n,this.capture(r))}t[k1(i)]=k1(r)}parseQueryParam(t){let i=ofe(this.remaining);if(!i)return;this.capture(i);let r="";if(this.consumeOptional("=")){let a=sfe(this.remaining);a&&(r=a,this.capture(r))}let n=PU(i),o=PU(r);if(t.hasOwnProperty(n)){let a=t[n];Array.isArray(a)||(a=[a],t[n]=a),a.push(o)}else t[n]=o}parseParens(t){let i={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=lI(this.remaining),n=this.remaining[r.length];if(n!=="/"&&n!==")"&&n!==";")throw new Tr(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):t&&(o=yi);let a=this.parseChildren();i[o]=Object.keys(a).length===1?a[yi]:new vr([],a),this.consumeOptional("//")}return i}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return this.peekStartsWith(t)?(this.remaining=this.remaining.substring(t.length),!0):!1}capture(t){if(!this.consumeOptional(t))throw new Tr(4011,!1)}};function qU(e){return e.segments.length>0?new vr([],{[yi]:e}):e}function XU(e){let t={};for(let[r,n]of Object.entries(e.children)){let o=XU(n);if(r===yi&&o.segments.length===0&&o.hasChildren())for(let[a,s]of Object.entries(o.children))t[a]=s;else(o.segments.length>0||o.hasChildren())&&(t[r]=o)}let i=new vr(e.segments,t);return lfe(i)}function lfe(e){if(e.numberOfChildren===1&&e.children[yi]){let t=e.children[yi];return new vr(e.segments.concat(t.segments),t.children)}return e}function Dm(e){return e instanceof cu}function cfe(e,t,i=null,r=null){let n=YU(e);return ZU(n,t,i,r)}function YU(e){let t;function i(o){let a={};for(let c of o.children){let l=i(c);a[c.outlet]=l}let s=new vr(o.url,a);return o===e&&(t=s),s}let r=i(e.root),n=qU(r);return t??n}function ZU(e,t,i,r){let n=e;for(;n.parent;)n=n.parent;if(t.length===0)return cI(n,n,n,i,r);let o=dfe(t);if(o.toRoot())return cI(n,n,new vr([],{}),i,r);let a=ufe(o,n,e),s=a.processChildren?B0(a.segmentGroup,a.index,o.commands):QU(a.segmentGroup,a.index,o.commands);return cI(n,a.segmentGroup,s,i,r)}function P1(e){return typeof e=="object"&&e!=null&&!e.outlets&&!e.segmentPath}function H0(e){return typeof e=="object"&&e!=null&&e.outlets}function cI(e,t,i,r,n){let o={};r&&Object.entries(r).forEach(([c,l])=>{o[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let a;e===t?a=i:a=KU(e,t,i);let s=qU(XU(a));return new cu(s,o,n)}function KU(e,t,i){let r={};return Object.entries(e.children).forEach(([n,o])=>{o===t?r[n]=i:r[n]=KU(o,t,i)}),new vr(e.segments,r)}var N1=class{constructor(t,i,r){if(this.isAbsolute=t,this.numberOfDoubleDots=i,this.commands=r,t&&r.length>0&&P1(r[0]))throw new Tr(4003,!1);let n=r.find(H0);if(n&&n!==zU(r))throw new Tr(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function dfe(e){if(typeof e[0]=="string"&&e.length===1&&e[0]==="/")return new N1(!0,0,e);let t=0,i=!1,r=e.reduce((n,o,a)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let s={};return Object.entries(o.outlets).forEach(([c,l])=>{s[c]=typeof l=="string"?l.split("/"):l}),[...n,{outlets:s}]}if(o.segmentPath)return[...n,o.segmentPath]}return typeof o!="string"?[...n,o]:a===0?(o.split("/").forEach((s,c)=>{c==0&&s==="."||(c==0&&s===""?i=!0:s===".."?t++:s!=""&&n.push(s))}),n):[...n,o]},[]);return new N1(i,t,r)}var Sm=class{constructor(t,i,r){this.segmentGroup=t,this.processChildren=i,this.index=r}};function ufe(e,t,i){if(e.isAbsolute)return new Sm(t,!0,0);if(!i)return new Sm(t,!1,NaN);if(i.parent===null)return new Sm(i,!0,0);let r=P1(e.commands[0])?0:1,n=i.segments.length-1+r;return hfe(i,n,e.numberOfDoubleDots)}function hfe(e,t,i){let r=e,n=t,o=i;for(;o>n;){if(o-=n,r=r.parent,!r)throw new Tr(4005,!1);n=r.segments.length}return new Sm(r,!1,n-o)}function pfe(e){return H0(e[0])?e[0].outlets:{[yi]:e}}function QU(e,t,i){if(e??=new vr([],{}),e.segments.length===0&&e.hasChildren())return B0(e,t,i);let r=ffe(e,t,i),n=i.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){let o=new vr(e.segments.slice(0,r.pathIndex),{});return o.children[yi]=new vr(e.segments.slice(r.pathIndex),e.children),B0(o,0,n)}else return r.match&&n.length===0?new vr(e.segments,{}):r.match&&!e.hasChildren()?gI(e,t,i):r.match?B0(e,0,n):gI(e,t,i)}function B0(e,t,i){if(i.length===0)return new vr(e.segments,{});{let r=pfe(i),n={};if(Object.keys(r).some(o=>o!==yi)&&e.children[yi]&&e.numberOfChildren===1&&e.children[yi].segments.length===0){let o=B0(e.children[yi],t,i);return new vr(e.segments,o.children)}return Object.entries(r).forEach(([o,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(n[o]=QU(e.children[o],t,a))}),Object.entries(e.children).forEach(([o,a])=>{r[o]===void 0&&(n[o]=a)}),new vr(e.segments,n)}}function ffe(e,t,i){let r=0,n=t,o={match:!1,pathIndex:0,commandIndex:0};for(;n<e.segments.length;){if(r>=i.length)return o;let a=e.segments[n],s=i[r];if(H0(s))break;let c=`${s}`,l=r<i.length-1?i[r+1]:null;if(n>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!OU(c,l,a))return o;r+=2}else{if(!OU(c,{},a))return o;r++}n++}return{match:!0,pathIndex:n,commandIndex:r}}function gI(e,t,i){let r=e.segments.slice(0,t),n=0;for(;n<i.length;){let o=i[n];if(H0(o)){let c=mfe(o.outlets);return new vr(r,c)}if(n===0&&P1(i[0])){let c=e.segments[t];r.push(new lp(c.path,NU(i[0]))),n++;continue}let a=H0(o)?o.outlets[yi]:`${o}`,s=n<i.length-1?i[n+1]:null;a&&s&&P1(s)?(r.push(new lp(a,NU(s))),n+=2):(r.push(new lp(a,{})),n++)}return new vr(r,{})}function mfe(e){let t={};return Object.entries(e).forEach(([i,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(t[i]=gI(new vr([],{}),0,r))}),t}function NU(e){let t={};return Object.entries(e).forEach(([i,r])=>t[i]=`${r}`),t}function OU(e,t,i){return e==i.path&&Jl(t,i.parameters)}var V0="imperative",lo=function(e){return e[e.NavigationStart=0]="NavigationStart",e[e.NavigationEnd=1]="NavigationEnd",e[e.NavigationCancel=2]="NavigationCancel",e[e.NavigationError=3]="NavigationError",e[e.RoutesRecognized=4]="RoutesRecognized",e[e.ResolveStart=5]="ResolveStart",e[e.ResolveEnd=6]="ResolveEnd",e[e.GuardsCheckStart=7]="GuardsCheckStart",e[e.GuardsCheckEnd=8]="GuardsCheckEnd",e[e.RouteConfigLoadStart=9]="RouteConfigLoadStart",e[e.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",e[e.ChildActivationStart=11]="ChildActivationStart",e[e.ChildActivationEnd=12]="ChildActivationEnd",e[e.ActivationStart=13]="ActivationStart",e[e.ActivationEnd=14]="ActivationEnd",e[e.Scroll=15]="Scroll",e[e.NavigationSkipped=16]="NavigationSkipped",e}(lo||{}),Ws=class{constructor(t,i){this.id=t,this.url=i}},Im=class extends Ws{constructor(t,i,r="imperative",n=null){super(t,i),this.type=lo.NavigationStart,this.navigationTrigger=r,this.restoredState=n}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ec=class extends Ws{constructor(t,i,r){super(t,i),this.urlAfterRedirects=r,this.type=lo.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},cs=function(e){return e[e.Redirect=0]="Redirect",e[e.SupersededByNewNavigation=1]="SupersededByNewNavigation",e[e.NoDataFromResolver=2]="NoDataFromResolver",e[e.GuardRejected=3]="GuardRejected",e}(cs||{}),O1=function(e){return e[e.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",e[e.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",e}(O1||{}),du=class extends Ws{constructor(t,i,r,n){super(t,i),this.reason=r,this.code=n,this.type=lo.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},uu=class extends Ws{constructor(t,i,r,n){super(t,i),this.reason=r,this.code=n,this.type=lo.NavigationSkipped}},j0=class extends Ws{constructor(t,i,r,n){super(t,i),this.error=r,this.target=n,this.type=lo.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},R1=class extends Ws{constructor(t,i,r,n){super(t,i),this.urlAfterRedirects=r,this.state=n,this.type=lo.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},vI=class extends Ws{constructor(t,i,r,n){super(t,i),this.urlAfterRedirects=r,this.state=n,this.type=lo.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},_I=class extends Ws{constructor(t,i,r,n,o){super(t,i),this.urlAfterRedirects=r,this.state=n,this.shouldActivate=o,this.type=lo.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},bI=class extends Ws{constructor(t,i,r,n){super(t,i),this.urlAfterRedirects=r,this.state=n,this.type=lo.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},yI=class extends Ws{constructor(t,i,r,n){super(t,i),this.urlAfterRedirects=r,this.state=n,this.type=lo.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},xI=class{constructor(t){this.route=t,this.type=lo.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},wI=class{constructor(t){this.route=t,this.type=lo.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},EI=class{constructor(t){this.snapshot=t,this.type=lo.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},CI=class{constructor(t){this.snapshot=t,this.type=lo.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},SI=class{constructor(t){this.snapshot=t,this.type=lo.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},TI=class{constructor(t){this.snapshot=t,this.type=lo.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},F1=class{constructor(t,i,r){this.routerEvent=t,this.position=i,this.anchor=r,this.type=lo.Scroll}toString(){let t=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${t}')`}},G0=class{},$0=class{constructor(t){this.url=t}};var AI=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new K0,this.attachRef=null}},K0=(()=>{class e{constructor(){this.contexts=new Map}onChildOutletCreated(i,r){let n=this.getOrCreateContext(i);n.outlet=r,this.contexts.set(i,n)}onChildOutletDestroyed(i){let r=this.getContext(i);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let i=this.contexts;return this.contexts=new Map,i}onOutletReAttached(i){this.contexts=i}getOrCreateContext(i){let r=this.getContext(i);return r||(r=new AI,this.contexts.set(i,r)),r}getContext(i){return this.contexts.get(i)||null}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),L1=class{constructor(t){this._root=t}get root(){return this._root.value}parent(t){let i=this.pathFromRoot(t);return i.length>1?i[i.length-2]:null}children(t){let i=DI(t,this._root);return i?i.children.map(r=>r.value):[]}firstChild(t){let i=DI(t,this._root);return i&&i.children.length>0?i.children[0].value:null}siblings(t){let i=II(t,this._root);return i.length<2?[]:i[i.length-2].children.map(n=>n.value).filter(n=>n!==t)}pathFromRoot(t){return II(t,this._root).map(i=>i.value)}};function DI(e,t){if(e===t.value)return t;for(let i of t.children){let r=DI(e,i);if(r)return r}return null}function II(e,t){if(e===t.value)return[t];for(let i of t.children){let r=II(e,i);if(r.length)return r.unshift(t),r}return[]}var ls=class{constructor(t,i){this.value=t,this.children=i}toString(){return`TreeNode(${this.value})`}};function Cm(e){let t={};return e&&e.children.forEach(i=>t[i.value.outlet]=i),t}var B1=class extends L1{constructor(t,i){super(t),this.snapshot=i,VI(this,t)}toString(){return this.snapshot.toString()}};function JU(e){let t=gfe(e),i=new Eo([new lp("",{})]),r=new Eo({}),n=new Eo({}),o=new Eo({}),a=new Eo(""),s=new dp(i,r,o,a,n,yi,e,t.root);return s.snapshot=t.root,new B1(new ls(s,[]),t)}function gfe(e){let t={},i={},r={},n="",o=new W0([],t,r,n,i,yi,e,null,{});return new V1("",new ls(o,[]))}var dp=class{constructor(t,i,r,n,o,a,s,c){this.urlSubject=t,this.paramsSubject=i,this.queryParamsSubject=r,this.fragmentSubject=n,this.dataSubject=o,this.outlet=a,this.component=s,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Xt(l=>l[Y0]))??Dt(void 0),this.url=t,this.params=i,this.queryParams=r,this.fragment=n,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Xt(t=>Am(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Xt(t=>Am(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function BI(e,t,i="emptyOnly"){let r,{routeConfig:n}=e;return t!==null&&(i==="always"||n?.path===""||!t.component&&!t.routeConfig?.loadComponent)?r={params:L(L({},t.params),e.params),data:L(L({},t.data),e.data),resolve:L(L(L(L({},e.data),t.data),n?.data),e._resolvedData)}:r={params:L({},e.params),data:L({},e.data),resolve:L(L({},e.data),e._resolvedData??{})},n&&t9(n)&&(r.resolve[Y0]=n.title),r}var W0=class{get title(){return this.data?.[Y0]}constructor(t,i,r,n,o,a,s,c,l){this.url=t,this.params=i,this.queryParams=r,this.fragment=n,this.data=o,this.outlet=a,this.component=s,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Am(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Am(this.queryParams),this._queryParamMap}toString(){let t=this.url.map(r=>r.toString()).join("/"),i=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${t}', path:'${i}')`}},V1=class extends L1{constructor(t,i){super(i),this.url=t,VI(this,i)}toString(){return e9(this._root)}};function VI(e,t){t.value._routerState=e,t.children.forEach(i=>VI(e,i))}function e9(e){let t=e.children.length>0?` { ${e.children.map(e9).join(", ")} } `:"";return`${e.value}${t}`}function dI(e){if(e.snapshot){let t=e.snapshot,i=e._futureSnapshot;e.snapshot=i,Jl(t.queryParams,i.queryParams)||e.queryParamsSubject.next(i.queryParams),t.fragment!==i.fragment&&e.fragmentSubject.next(i.fragment),Jl(t.params,i.params)||e.paramsSubject.next(i.params),$pe(t.url,i.url)||e.urlSubject.next(i.url),Jl(t.data,i.data)||e.dataSubject.next(i.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function MI(e,t){let i=Jl(e.params,t.params)&&Ype(e.url,t.url),r=!e.parent!=!t.parent;return i&&!r&&(!e.parent||MI(e.parent,t.parent))}function t9(e){return typeof e.title=="string"||e.title===null}var zI=(()=>{class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=yi,this.activateEvents=new We,this.deactivateEvents=new We,this.attachEvents=new We,this.detachEvents=new We,this.parentContexts=Je(K0),this.location=Je(sl),this.changeDetector=Je(ei),this.environmentInjector=Je(qu),this.inputBinder=Je(G1,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(i){if(i.name){let{firstChange:r,previousValue:n}=i.name;if(r)return;this.isTrackedInParentContexts(n)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(n)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(i){return this.parentContexts.getContext(i)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let i=this.parentContexts.getContext(this.name);i?.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Tr(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Tr(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Tr(4012,!1);this.location.detach();let i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,r){this.activated=i,this._activatedRoute=r,this.location.insert(i.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){let i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,r){if(this.isActivated)throw new Tr(4013,!1);this._activatedRoute=i;let n=this.location,a=i.snapshot.component,s=this.parentContexts.getOrCreateContext(this.name).children,c=new kI(i,s,n.injector);this.activated=n.createComponent(a,{index:n.length,injector:c,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=xt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[kr]})}}return e})(),kI=class e{__ngOutletInjector(t){return new e(this.route,this.childContexts,t)}constructor(t,i,r){this.route=t,this.childContexts=i,this.parent=r}get(t,i){return t===dp?this.route:t===K0?this.childContexts:this.parent.get(t,i)}},G1=new Ye(""),RU=(()=>{class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(i){this.unsubscribeFromRouteData(i),this.subscribeToRouteData(i)}unsubscribeFromRouteData(i){this.outletDataSubscriptions.get(i)?.unsubscribe(),this.outletDataSubscriptions.delete(i)}subscribeToRouteData(i){let{activatedRoute:r}=i,n=Up([r.queryParams,r.params,r.data]).pipe(An(([o,a,s],c)=>(s=L(L(L({},o),a),s),c===0?Dt(s):Promise.resolve(s)))).subscribe(o=>{if(!i.isActivated||!i.activatedComponentRef||i.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(i);return}let a=q3(r.component);if(!a){this.unsubscribeFromRouteData(i);return}for(let{templateName:s}of a.inputs)i.activatedComponentRef.setInput(s,o[s])});this.outletDataSubscriptions.set(i,n)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac})}}return e})();function vfe(e,t,i){let r=q0(e,t._root,i?i._root:void 0);return new B1(r,t)}function q0(e,t,i){if(i&&e.shouldReuseRoute(t.value,i.value.snapshot)){let r=i.value;r._futureSnapshot=t.value;let n=_fe(e,t,i);return new ls(r,n)}else{if(e.shouldAttach(t.value)){let o=e.retrieve(t.value);if(o!==null){let a=o.route;return a.value._futureSnapshot=t.value,a.children=t.children.map(s=>q0(e,s)),a}}let r=bfe(t.value),n=t.children.map(o=>q0(e,o));return new ls(r,n)}}function _fe(e,t,i){return t.children.map(r=>{for(let n of i.children)if(e.shouldReuseRoute(r.value,n.value.snapshot))return q0(e,r,n);return q0(e,r)})}function bfe(e){return new dp(new Eo(e.url),new Eo(e.params),new Eo(e.queryParams),new Eo(e.fragment),new Eo(e.data),e.outlet,e.component,e)}var i9="ngNavigationCancelingError";function r9(e,t){let{redirectTo:i,navigationBehaviorOptions:r}=Dm(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,n=n9(!1,cs.Redirect);return n.url=i,n.navigationBehaviorOptions=r,n}function n9(e,t){let i=new Error(`NavigationCancelingError: ${e||""}`);return i[i9]=!0,i.cancellationCode=t,i}function yfe(e){return o9(e)&&Dm(e.url)}function o9(e){return!!e&&e[i9]}var xfe=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=Le({type:e,selectors:[["ng-component"]],standalone:!0,features:[ci],decls:1,vars:0,template:function(r,n){r&1&&he(0,"router-outlet")},dependencies:[zI],encapsulation:2})}}return e})();function wfe(e,t){return e.providers&&!e._injector&&(e._injector=vC(e.providers,t,`Route: ${e.path}`)),e._injector??t}function UI(e){let t=e.children&&e.children.map(UI),i=t?ve(L({},e),{children:t}):L({},e);return!i.component&&!i.loadComponent&&(t||i.loadChildren)&&i.outlet&&i.outlet!==yi&&(i.component=xfe),i}function tc(e){return e.outlet||yi}function Efe(e,t){let i=e.filter(r=>tc(r)===t);return i.push(...e.filter(r=>tc(r)!==t)),i}function Q0(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let t=e.parent;t;t=t.parent){let i=t.routeConfig;if(i?._loadedInjector)return i._loadedInjector;if(i?._injector)return i._injector}return null}var Cfe=(e,t,i,r)=>Xt(n=>(new PI(t,n.targetRouterState,n.currentRouterState,i,r).activate(e),n)),PI=class{constructor(t,i,r,n,o){this.routeReuseStrategy=t,this.futureState=i,this.currState=r,this.forwardEvent=n,this.inputBindingEnabled=o}activate(t){let i=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(i,r,t),dI(this.futureState.root),this.activateChildRoutes(i,r,t)}deactivateChildRoutes(t,i,r){let n=Cm(i);t.children.forEach(o=>{let a=o.value.outlet;this.deactivateRoutes(o,n[a],r),delete n[a]}),Object.values(n).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(t,i,r){let n=t.value,o=i?i.value:null;if(n===o)if(n.component){let a=r.getContext(n.outlet);a&&this.deactivateChildRoutes(t,i,a.children)}else this.deactivateChildRoutes(t,i,r);else o&&this.deactivateRouteAndItsChildren(i,r)}deactivateRouteAndItsChildren(t,i){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,i):this.deactivateRouteAndOutlet(t,i)}detachAndStoreRouteSubtree(t,i){let r=i.getContext(t.value.outlet),n=r&&t.value.component?r.children:i,o=Cm(t);for(let a of Object.values(o))this.deactivateRouteAndItsChildren(a,n);if(r&&r.outlet){let a=r.outlet.detach(),s=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:a,route:t,contexts:s})}}deactivateRouteAndOutlet(t,i){let r=i.getContext(t.value.outlet),n=r&&t.value.component?r.children:i,o=Cm(t);for(let a of Object.values(o))this.deactivateRouteAndItsChildren(a,n);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(t,i,r){let n=Cm(i);t.children.forEach(o=>{this.activateRoutes(o,n[o.value.outlet],r),this.forwardEvent(new TI(o.value.snapshot))}),t.children.length&&this.forwardEvent(new CI(t.value.snapshot))}activateRoutes(t,i,r){let n=t.value,o=i?i.value:null;if(dI(n),n===o)if(n.component){let a=r.getOrCreateContext(n.outlet);this.activateChildRoutes(t,i,a.children)}else this.activateChildRoutes(t,i,r);else if(n.component){let a=r.getOrCreateContext(n.outlet);if(this.routeReuseStrategy.shouldAttach(n.snapshot)){let s=this.routeReuseStrategy.retrieve(n.snapshot);this.routeReuseStrategy.store(n.snapshot,null),a.children.onOutletReAttached(s.contexts),a.attachRef=s.componentRef,a.route=s.route.value,a.outlet&&a.outlet.attach(s.componentRef,s.route.value),dI(s.route.value),this.activateChildRoutes(t,null,a.children)}else{let s=Q0(n.snapshot);a.attachRef=null,a.route=n,a.injector=s,a.outlet&&a.outlet.activateWith(n,a.injector),this.activateChildRoutes(t,null,a.children)}}else this.activateChildRoutes(t,null,r)}},z1=class{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}},Tm=class{constructor(t,i){this.component=t,this.route=i}};function Sfe(e,t,i){let r=e._root,n=t?t._root:null;return F0(r,n,i,[r.value])}function Tfe(e){let t=e.routeConfig?e.routeConfig.canActivateChild:null;return!t||t.length===0?null:{node:e,guards:t}}function km(e,t){let i=Symbol(),r=t.get(e,i);return r===i?typeof e=="function"&&!u3(e)?e:t.get(e):r}function F0(e,t,i,r,n={canDeactivateChecks:[],canActivateChecks:[]}){let o=Cm(t);return e.children.forEach(a=>{Afe(a,o[a.value.outlet],i,r.concat([a.value]),n),delete o[a.value.outlet]}),Object.entries(o).forEach(([a,s])=>z0(s,i.getContext(a),n)),n}function Afe(e,t,i,r,n={canDeactivateChecks:[],canActivateChecks:[]}){let o=e.value,a=t?t.value:null,s=i?i.getContext(e.value.outlet):null;if(a&&o.routeConfig===a.routeConfig){let c=Dfe(a,o,o.routeConfig.runGuardsAndResolvers);c?n.canActivateChecks.push(new z1(r)):(o.data=a.data,o._resolvedData=a._resolvedData),o.component?F0(e,t,s?s.children:null,r,n):F0(e,t,i,r,n),c&&s&&s.outlet&&s.outlet.isActivated&&n.canDeactivateChecks.push(new Tm(s.outlet.component,a))}else a&&z0(t,s,n),n.canActivateChecks.push(new z1(r)),o.component?F0(e,null,s?s.children:null,r,n):F0(e,null,i,r,n);return n}function Dfe(e,t,i){if(typeof i=="function")return i(e,t);switch(i){case"pathParamsChange":return!cp(e.url,t.url);case"pathParamsOrQueryParamsChange":return!cp(e.url,t.url)||!Jl(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!MI(e,t)||!Jl(e.queryParams,t.queryParams);case"paramsChange":default:return!MI(e,t)}}function z0(e,t,i){let r=Cm(e),n=e.value;Object.entries(r).forEach(([o,a])=>{n.component?t?z0(a,t.children.getContext(o),i):z0(a,null,i):z0(a,t,i)}),n.component?t&&t.outlet&&t.outlet.isActivated?i.canDeactivateChecks.push(new Tm(t.outlet.component,n)):i.canDeactivateChecks.push(new Tm(null,n)):i.canDeactivateChecks.push(new Tm(null,n))}function J0(e){return typeof e=="function"}function Ife(e){return typeof e=="boolean"}function Mfe(e){return e&&J0(e.canLoad)}function kfe(e){return e&&J0(e.canActivate)}function Pfe(e){return e&&J0(e.canActivateChild)}function Nfe(e){return e&&J0(e.canDeactivate)}function Ofe(e){return e&&J0(e.canMatch)}function a9(e){return e instanceof o3||e?.name==="EmptyError"}var D1=Symbol("INITIAL_VALUE");function Mm(){return An(e=>Up(e.map(t=>t.pipe(wn(1),xa(D1)))).pipe(Xt(t=>{for(let i of t)if(i!==!0){if(i===D1)return D1;if(i===!1||i instanceof cu)return i}return!0}),Ji(t=>t!==D1),wn(1)))}function Rfe(e,t){return $a(i=>{let{targetSnapshot:r,currentSnapshot:n,guards:{canActivateChecks:o,canDeactivateChecks:a}}=i;return a.length===0&&o.length===0?Dt(ve(L({},i),{guardsResult:!0})):Ffe(a,r,n,e).pipe($a(s=>s&&Ife(s)?Lfe(r,o,e,t):Dt(s)),Xt(s=>ve(L({},i),{guardsResult:s})))})}function Ffe(e,t,i,r){return Co(e).pipe($a(n=>Hfe(n.component,n.route,i,t,r)),pd(n=>n!==!0,!0))}function Lfe(e,t,i,r){return Co(t).pipe(hd(n=>Pb(Vfe(n.route.parent,r),Bfe(n.route,r),Ufe(e,n.path,i),zfe(e,n.route,i))),pd(n=>n!==!0,!0))}function Bfe(e,t){return e!==null&&t&&t(new SI(e)),Dt(!0)}function Vfe(e,t){return e!==null&&t&&t(new EI(e)),Dt(!0)}function zfe(e,t,i){let r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||r.length===0)return Dt(!0);let n=r.map(o=>kg(()=>{let a=Q0(t)??i,s=km(o,a),c=kfe(s)?s.canActivate(t,e):md(a,()=>s(t,e));return pu(c).pipe(pd())}));return Dt(n).pipe(Mm())}function Ufe(e,t,i){let r=t[t.length-1],o=t.slice(0,t.length-1).reverse().map(a=>Tfe(a)).filter(a=>a!==null).map(a=>kg(()=>{let s=a.guards.map(c=>{let l=Q0(a.node)??i,d=km(c,l),u=Pfe(d)?d.canActivateChild(r,e):md(l,()=>d(r,e));return pu(u).pipe(pd())});return Dt(s).pipe(Mm())}));return Dt(o).pipe(Mm())}function Hfe(e,t,i,r,n){let o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!o||o.length===0)return Dt(!0);let a=o.map(s=>{let c=Q0(t)??n,l=km(s,c),d=Nfe(l)?l.canDeactivate(e,t,i,r):md(c,()=>l(e,t,i,r));return pu(d).pipe(pd())});return Dt(a).pipe(Mm())}function jfe(e,t,i,r){let n=t.canLoad;if(n===void 0||n.length===0)return Dt(!0);let o=n.map(a=>{let s=km(a,e),c=Mfe(s)?s.canLoad(t,i):md(e,()=>s(t,i));return pu(c)});return Dt(o).pipe(Mm(),s9(r))}function s9(e){return r3(an(t=>{if(Dm(t))throw r9(e,t)}),Xt(t=>t===!0))}function Gfe(e,t,i,r){let n=t.canMatch;if(!n||n.length===0)return Dt(!0);let o=n.map(a=>{let s=km(a,e),c=Ofe(s)?s.canMatch(t,i):md(e,()=>s(t,i));return pu(c)});return Dt(o).pipe(Mm(),s9(r))}var X0=class{constructor(t){this.segmentGroup=t||null}},U1=class extends Error{constructor(t){super(),this.urlTree=t}};function Em(e){return Gu(new X0(e))}function $fe(e){return Gu(new Tr(4e3,!1))}function Wfe(e){return Gu(n9(!1,cs.GuardRejected))}var NI=class{constructor(t,i){this.urlSerializer=t,this.urlTree=i}lineralizeSegments(t,i){let r=[],n=i.root;for(;;){if(r=r.concat(n.segments),n.numberOfChildren===0)return Dt(r);if(n.numberOfChildren>1||!n.children[yi])return $fe(t.redirectTo);n=n.children[yi]}}applyRedirectCommands(t,i,r){let n=this.applyRedirectCreateUrlTree(i,this.urlSerializer.parse(i),t,r);if(i.startsWith("/"))throw new U1(n);return n}applyRedirectCreateUrlTree(t,i,r,n){let o=this.createSegmentGroup(t,i.root,r,n);return new cu(o,this.createQueryParams(i.queryParams,this.urlTree.queryParams),i.fragment)}createQueryParams(t,i){let r={};return Object.entries(t).forEach(([n,o])=>{if(typeof o=="string"&&o.startsWith(":")){let s=o.substring(1);r[n]=i[s]}else r[n]=o}),r}createSegmentGroup(t,i,r,n){let o=this.createSegments(t,i.segments,r,n),a={};return Object.entries(i.children).forEach(([s,c])=>{a[s]=this.createSegmentGroup(t,c,r,n)}),new vr(o,a)}createSegments(t,i,r,n){return i.map(o=>o.path.startsWith(":")?this.findPosParam(t,o,n):this.findOrReturn(o,r))}findPosParam(t,i,r){let n=r[i.path.substring(1)];if(!n)throw new Tr(4001,!1);return n}findOrReturn(t,i){let r=0;for(let n of i){if(n.path===t.path)return i.splice(r),n;r++}return t}},OI={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function qfe(e,t,i,r,n){let o=HI(e,t,i);return o.matched?(r=wfe(t,r),Gfe(r,t,i,n).pipe(Xt(a=>a===!0?o:L({},OI)))):Dt(o)}function HI(e,t,i){if(t.path==="**")return Xfe(i);if(t.path==="")return t.pathMatch==="full"&&(e.hasChildren()||i.length>0)?L({},OI):{matched:!0,consumedSegments:[],remainingSegments:i,parameters:{},positionalParamSegments:{}};let n=(t.matcher||Gpe)(i,e,t);if(!n)return L({},OI);let o={};Object.entries(n.posParams??{}).forEach(([s,c])=>{o[s]=c.path});let a=n.consumed.length>0?L(L({},o),n.consumed[n.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:n.consumed,remainingSegments:i.slice(n.consumed.length),parameters:a,positionalParamSegments:n.posParams??{}}}function Xfe(e){return{matched:!0,parameters:e.length>0?zU(e).parameters:{},consumedSegments:e,remainingSegments:[],positionalParamSegments:{}}}function FU(e,t,i,r){return i.length>0&&Kfe(e,i,r)?{segmentGroup:new vr(t,Zfe(r,new vr(i,e.children))),slicedSegments:[]}:i.length===0&&Qfe(e,i,r)?{segmentGroup:new vr(e.segments,Yfe(e,i,r,e.children)),slicedSegments:i}:{segmentGroup:new vr(e.segments,e.children),slicedSegments:i}}function Yfe(e,t,i,r){let n={};for(let o of i)if($1(e,t,o)&&!r[tc(o)]){let a=new vr([],{});n[tc(o)]=a}return L(L({},r),n)}function Zfe(e,t){let i={};i[yi]=t;for(let r of e)if(r.path===""&&tc(r)!==yi){let n=new vr([],{});i[tc(r)]=n}return i}function Kfe(e,t,i){return i.some(r=>$1(e,t,r)&&tc(r)!==yi)}function Qfe(e,t,i){return i.some(r=>$1(e,t,r))}function $1(e,t,i){return(e.hasChildren()||t.length>0)&&i.pathMatch==="full"?!1:i.path===""}function Jfe(e,t,i,r){return tc(e)!==r&&(r===yi||!$1(t,i,e))?!1:HI(t,e,i).matched}function eme(e,t,i){return t.length===0&&!e.children[i]}var RI=class{};function tme(e,t,i,r,n,o,a="emptyOnly"){return new FI(e,t,i,r,n,a,o).recognize()}var ime=31,FI=class{constructor(t,i,r,n,o,a,s){this.injector=t,this.configLoader=i,this.rootComponentType=r,this.config=n,this.urlTree=o,this.paramsInheritanceStrategy=a,this.urlSerializer=s,this.applyRedirects=new NI(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(t){return new Tr(4002,`'${t.segmentGroup}'`)}recognize(){let t=FU(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(t).pipe(Xt(i=>{let r=new W0([],Object.freeze({}),Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,{},yi,this.rootComponentType,null,{}),n=new ls(r,i),o=new V1("",n),a=cfe(r,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(a),this.inheritParamsAndData(o._root,null),{state:o,tree:a}}))}match(t){return this.processSegmentGroup(this.injector,this.config,t,yi).pipe(ud(r=>{if(r instanceof U1)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof X0?this.noMatchError(r):r}))}inheritParamsAndData(t,i){let r=t.value,n=BI(r,i,this.paramsInheritanceStrategy);r.params=Object.freeze(n.params),r.data=Object.freeze(n.data),t.children.forEach(o=>this.inheritParamsAndData(o,r))}processSegmentGroup(t,i,r,n){return r.segments.length===0&&r.hasChildren()?this.processChildren(t,i,r):this.processSegment(t,i,r,r.segments,n,!0).pipe(Xt(o=>o instanceof ls?[o]:[]))}processChildren(t,i,r){let n=[];for(let o of Object.keys(r.children))o==="primary"?n.unshift(o):n.push(o);return Co(n).pipe(hd(o=>{let a=r.children[o],s=Efe(i,o);return this.processSegmentGroup(t,s,a,o)}),s3((o,a)=>(o.push(...a),o)),sC(null),a3(),$a(o=>{if(o===null)return Em(r);let a=l9(o);return rme(a),Dt(a)}))}processSegment(t,i,r,n,o,a){return Co(i).pipe(hd(s=>this.processSegmentAgainstRoute(s._injector??t,i,s,r,n,o,a).pipe(ud(c=>{if(c instanceof X0)return Dt(null);throw c}))),pd(s=>!!s),ud(s=>{if(a9(s))return eme(r,n,o)?Dt(new RI):Em(r);throw s}))}processSegmentAgainstRoute(t,i,r,n,o,a,s){return Jfe(r,n,o,a)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(t,n,r,o,a):this.allowRedirects&&s?this.expandSegmentAgainstRouteUsingRedirect(t,n,i,r,o,a):Em(n):Em(n)}expandSegmentAgainstRouteUsingRedirect(t,i,r,n,o,a){let{matched:s,consumedSegments:c,positionalParamSegments:l,remainingSegments:d}=HI(i,n,o);if(!s)return Em(i);n.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>ime&&(this.allowRedirects=!1));let u=this.applyRedirects.applyRedirectCommands(c,n.redirectTo,l);return this.applyRedirects.lineralizeSegments(n,u).pipe($a(h=>this.processSegment(t,r,i,h.concat(d),a,!1)))}matchSegmentAgainstRoute(t,i,r,n,o){let a=qfe(i,r,n,t,this.urlSerializer);return r.path==="**"&&(i.children={}),a.pipe(An(s=>s.matched?(t=r._injector??t,this.getChildConfig(t,r,n).pipe(An(({routes:c})=>{let l=r._loadedInjector??t,{consumedSegments:d,remainingSegments:u,parameters:h}=s,p=new W0(d,h,Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,ome(r),tc(r),r.component??r._loadedComponent??null,r,ame(r)),{segmentGroup:m,slicedSegments:f}=FU(i,d,u,c);if(f.length===0&&m.hasChildren())return this.processChildren(l,c,m).pipe(Xt(v=>v===null?null:new ls(p,v)));if(c.length===0&&f.length===0)return Dt(new ls(p,[]));let g=tc(r)===o;return this.processSegment(l,c,m,f,g?yi:o,!0).pipe(Xt(v=>new ls(p,v instanceof ls?[v]:[])))}))):Em(i)))}getChildConfig(t,i,r){return i.children?Dt({routes:i.children,injector:t}):i.loadChildren?i._loadedRoutes!==void 0?Dt({routes:i._loadedRoutes,injector:i._loadedInjector}):jfe(t,i,r,this.urlSerializer).pipe($a(n=>n?this.configLoader.loadChildren(t,i).pipe(an(o=>{i._loadedRoutes=o.routes,i._loadedInjector=o.injector})):Wfe(i))):Dt({routes:[],injector:t})}};function rme(e){e.sort((t,i)=>t.value.outlet===yi?-1:i.value.outlet===yi?1:t.value.outlet.localeCompare(i.value.outlet))}function nme(e){let t=e.value.routeConfig;return t&&t.path===""}function l9(e){let t=[],i=new Set;for(let r of e){if(!nme(r)){t.push(r);continue}let n=t.find(o=>r.value.routeConfig===o.value.routeConfig);n!==void 0?(n.children.push(...r.children),i.add(n)):t.push(r)}for(let r of i){let n=l9(r.children);t.push(new ls(r.value,n))}return t.filter(r=>!i.has(r))}function ome(e){return e.data||{}}function ame(e){return e.resolve||{}}function sme(e,t,i,r,n,o){return $a(a=>tme(e,t,i,r,a.extractedUrl,n,o).pipe(Xt(({state:s,tree:c})=>ve(L({},a),{targetSnapshot:s,urlAfterRedirects:c}))))}function lme(e,t){return $a(i=>{let{targetSnapshot:r,guards:{canActivateChecks:n}}=i;if(!n.length)return Dt(i);let o=new Set(n.map(c=>c.route)),a=new Set;for(let c of o)if(!a.has(c))for(let l of c9(c))a.add(l);let s=0;return Co(a).pipe(hd(c=>o.has(c)?cme(c,r,e,t):(c.data=BI(c,c.parent,e).resolve,Dt(void 0))),an(()=>s++),lC(1),$a(c=>s===a.size?Dt(i):ws))})}function c9(e){let t=e.children.map(i=>c9(i)).flat();return[e,...t]}function cme(e,t,i,r){let n=e.routeConfig,o=e._resolve;return n?.title!==void 0&&!t9(n)&&(o[Y0]=n.title),dme(o,e,t,r).pipe(Xt(a=>(e._resolvedData=a,e.data=BI(e,e.parent,i).resolve,null)))}function dme(e,t,i,r){let n=pI(e);if(n.length===0)return Dt({});let o={};return Co(n).pipe($a(a=>ume(e[a],t,i,r).pipe(pd(),an(s=>{o[a]=s}))),lC(1),Pg(o),ud(a=>a9(a)?ws:Gu(a)))}function ume(e,t,i,r){let n=Q0(t)??r,o=km(e,n),a=o.resolve?o.resolve(t,i):md(n,()=>o(t,i));return pu(a)}function uI(e){return An(t=>{let i=e(t);return i?Co(i).pipe(Xt(()=>t)):Dt(t)})}var d9=(()=>{class e{buildTitle(i){let r,n=i.root;for(;n!==void 0;)r=this.getResolvedTitleForRoute(n)??r,n=n.children.find(o=>o.outlet===yi);return r}getResolvedTitleForRoute(i){return i.data[Y0]}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:()=>Je(hme),providedIn:"root"})}}return e})(),hme=(()=>{class e extends d9{constructor(i){super(),this.title=i}updateTitle(i){let r=this.buildTitle(i);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||e)(Ae(RR))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),e_=new Ye("",{providedIn:"root",factory:()=>({})}),H1=new Ye(""),jI=(()=>{class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Je(jb)}loadComponent(i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return Dt(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=pu(i.loadComponent()).pipe(Xt(u9),an(o=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=o}),Wu(()=>{this.componentLoaders.delete(i)})),n=new Mb(r,()=>new Ct).pipe(rC());return this.componentLoaders.set(i,n),n}loadChildren(i,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Dt({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=pme(r,this.compiler,i,this.onLoadEndListener).pipe(Wu(()=>{this.childrenLoaders.delete(r)})),a=new Mb(o,()=>new Ct).pipe(rC());return this.childrenLoaders.set(r,a),a}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function pme(e,t,i,r){return pu(e.loadChildren()).pipe(Xt(u9),$a(n=>n instanceof I3||Array.isArray(n)?Dt(n):Co(t.compileModuleAsync(n))),Xt(n=>{r&&r(e);let o,a,s=!1;return Array.isArray(n)?(a=n,s=!0):(o=n.create(i).injector,a=o.get(H1,[],{optional:!0,self:!0}).flat()),{routes:a.map(UI),injector:o}}))}function fme(e){return e&&typeof e=="object"&&"default"in e}function u9(e){return fme(e)?e.default:e}var GI=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:()=>Je(mme),providedIn:"root"})}}return e})(),mme=(()=>{class e{shouldProcessUrl(i){return!0}extract(i){return i}merge(i,r){return i}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),h9=new Ye(""),p9=new Ye("");function gme(e,t,i){let r=e.get(p9),n=e.get(Bt);return e.get(st).runOutsideAngular(()=>{if(!n.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let o,a=new Promise(l=>{o=l}),s=n.startViewTransition(()=>(o(),vme(e))),{onViewTransitionCreated:c}=r;return c&&md(e,()=>c({transition:s,from:t,to:i})),a})}function vme(e){return new Promise(t=>{mC(t,{injector:e})})}var $I=(()=>{class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ct,this.transitionAbortSubject=new Ct,this.configLoader=Je(jI),this.environmentInjector=Je(qu),this.urlSerializer=Je(Z0),this.rootContexts=Je(K0),this.location=Je(eh),this.inputBindingEnabled=Je(G1,{optional:!0})!==null,this.titleStrategy=Je(d9),this.options=Je(e_,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=Je(GI),this.createViewTransition=Je(h9,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Dt(void 0),this.rootComponentType=null;let i=n=>this.events.next(new xI(n)),r=n=>this.events.next(new wI(n));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=i}complete(){this.transitions?.complete()}handleNavigationRequest(i){let r=++this.navigationId;this.transitions?.next(ve(L(L({},this.transitions.value),i),{id:r}))}setupNavigations(i,r,n){return this.transitions=new Eo({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:V0,restoredState:null,currentSnapshot:n.snapshot,targetSnapshot:null,currentRouterState:n,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ji(o=>o.id!==0),Xt(o=>ve(L({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),An(o=>{let a=!1,s=!1;return Dt(o).pipe(An(c=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",cs.SupersededByNewNavigation),ws;this.currentTransition=o,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?ve(L({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!i.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??i.onSameUrlNavigation;if(!l&&d!=="reload"){let u="";return this.events.next(new uu(c.id,this.urlSerializer.serialize(c.rawUrl),u,O1.IgnoredSameUrlNavigation)),c.resolve(null),ws}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return Dt(c).pipe(An(u=>{let h=this.transitions?.getValue();return this.events.next(new Im(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),h!==this.transitions?.getValue()?ws:Promise.resolve(u)}),sme(this.environmentInjector,this.configLoader,this.rootComponentType,i.config,this.urlSerializer,this.paramsInheritanceStrategy),an(u=>{o.targetSnapshot=u.targetSnapshot,o.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation=ve(L({},this.currentNavigation),{finalUrl:u.urlAfterRedirects});let h=new R1(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:u,extractedUrl:h,source:p,restoredState:m,extras:f}=c,g=new Im(u,this.urlSerializer.serialize(h),p,m);this.events.next(g);let v=JU(this.rootComponentType).snapshot;return this.currentTransition=o=ve(L({},c),{targetSnapshot:v,urlAfterRedirects:h,extras:ve(L({},f),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=h,Dt(o)}else{let u="";return this.events.next(new uu(c.id,this.urlSerializer.serialize(c.extractedUrl),u,O1.IgnoredByUrlHandlingStrategy)),c.resolve(null),ws}}),an(c=>{let l=new vI(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),Xt(c=>(this.currentTransition=o=ve(L({},c),{guards:Sfe(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),Rfe(this.environmentInjector,c=>this.events.next(c)),an(c=>{if(o.guardsResult=c.guardsResult,Dm(c.guardsResult))throw r9(this.urlSerializer,c.guardsResult);let l=new _I(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),Ji(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",cs.GuardRejected),!1)),uI(c=>{if(c.guards.canActivateChecks.length)return Dt(c).pipe(an(l=>{let d=new bI(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),An(l=>{let d=!1;return Dt(l).pipe(lme(this.paramsInheritanceStrategy,this.environmentInjector),an({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",cs.NoDataFromResolver)}}))}),an(l=>{let d=new yI(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),uI(c=>{let l=d=>{let u=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&u.push(this.configLoader.loadComponent(d.routeConfig).pipe(an(h=>{d.component=h}),Xt(()=>{})));for(let h of d.children)u.push(...l(h));return u};return Up(l(c.targetSnapshot.root)).pipe(sC(null),wn(1))}),uI(()=>this.afterPreactivation()),An(()=>{let{currentSnapshot:c,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return d?Co(d).pipe(Xt(()=>o)):Dt(o)}),Xt(c=>{let l=vfe(i.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=ve(L({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),an(()=>{this.events.next(new G0)}),Cfe(this.rootContexts,i.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),wn(1),an({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ec(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),Ui(this.transitionAbortSubject.pipe(an(c=>{throw c}))),Wu(()=>{!a&&!s&&this.cancelNavigationTransition(o,"",cs.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),ud(c=>{if(s=!0,o9(c))this.events.next(new du(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),yfe(c)?this.events.next(new $0(c.url)):o.resolve(!1);else{this.events.next(new j0(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(i.errorHandler(c))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return ws}))}))}cancelNavigationTransition(i,r,n){let o=new du(i.id,this.urlSerializer.serialize(i.extractedUrl),r,n);this.events.next(o),i.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function _me(e){return e!==V0}var bme=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:()=>Je(yme),providedIn:"root"})}}return e})(),LI=class{shouldDetach(t){return!1}store(t,i){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,i){return t.routeConfig===i.routeConfig}},yme=(()=>{class e extends LI{static{this.\u0275fac=(()=>{let i;return function(n){return(i||(i=Ar(e)))(n||e)}})()}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),f9=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:()=>Je(xme),providedIn:"root"})}}return e})(),xme=(()=>{class e extends f9{constructor(){super(...arguments),this.location=Je(eh),this.urlSerializer=Je(Z0),this.options=Je(e_,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=Je(GI),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new cu,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=JU(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(i){return this.location.subscribe(r=>{r.type==="popstate"&&i(r.url,r.state)})}handleRouterEvent(i,r){if(i instanceof Im)this.stateMemento=this.createStateMemento();else if(i instanceof uu)this.rawUrlTree=r.initialUrl;else if(i instanceof R1){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let n=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(n,r)}}else i instanceof G0?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r))):i instanceof du&&(i.code===cs.GuardRejected||i.code===cs.NoDataFromResolver)?this.restoreHistory(r):i instanceof j0?this.restoreHistory(r,!0):i instanceof ec&&(this.lastSuccessfulId=i.id,this.currentPageId=this.browserPageId)}setBrowserUrl(i,r){let n=this.urlSerializer.serialize(i);if(this.location.isCurrentPathEqualTo(n)||r.extras.replaceUrl){let o=this.browserPageId,a=L(L({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(n,"",a)}else{let o=L(L({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(n,"",o)}}restoreHistory(i,r=!1){if(this.canceledNavigationResolution==="computed"){let n=this.browserPageId,o=this.currentPageId-n;o!==0?this.location.historyGo(o):this.currentUrlTree===i.finalUrl&&o===0&&(this.resetState(i),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(i,r){return this.canceledNavigationResolution==="computed"?{navigationId:i,\u0275routerPageId:r}:{navigationId:i}}static{this.\u0275fac=(()=>{let i;return function(n){return(i||(i=Ar(e)))(n||e)}})()}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),L0=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(L0||{});function m9(e,t){e.events.pipe(Ji(i=>i instanceof ec||i instanceof du||i instanceof j0||i instanceof uu),Xt(i=>i instanceof ec||i instanceof uu?L0.COMPLETE:(i instanceof du?i.code===cs.Redirect||i.code===cs.SupersededByNewNavigation:!1)?L0.REDIRECTING:L0.FAILED),Ji(i=>i!==L0.REDIRECTING),wn(1)).subscribe(()=>{t()})}function wme(e){throw e}var Eme={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Cme={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},hu=(()=>{class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=Je(Vb),this.stateManager=Je(f9),this.options=Je(e_,{optional:!0})||{},this.pendingTasks=Je(M3),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=Je($I),this.urlSerializer=Je(Z0),this.location=Je(eh),this.urlHandlingStrategy=Je(GI),this._events=new Ct,this.errorHandler=this.options.errorHandler||wme,this.navigated=!1,this.routeReuseStrategy=Je(bme),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=Je(H1,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!Je(G1,{optional:!0}),this.eventsSubscription=new fn,this.isNgZoneEnabled=Je(st)instanceof st&&st.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:i=>{this.console.warn(i)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let i=this.navigationTransitions.events.subscribe(r=>{try{let n=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(n!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof du&&r.code!==cs.Redirect&&r.code!==cs.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof ec)this.navigated=!0;else if(r instanceof $0){let a=this.urlHandlingStrategy.merge(r.url,n.currentRawUrl),s={info:n.extras.info,skipLocationChange:n.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||_me(n.source)};this.scheduleNavigation(a,V0,null,s,{resolve:n.resolve,reject:n.reject,promise:n.promise})}}Tme(r)&&this._events.next(r)}catch(n){this.navigationTransitions.transitionAbortSubject.next(n)}});this.eventsSubscription.add(i)}resetRootComponentType(i){this.routerState.root.component=i,this.navigationTransitions.rootComponentType=i}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),V0,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((i,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(i,"popstate",r)},0)})}navigateToSyncWithBrowser(i,r,n){let o={replaceUrl:!0},a=n?.navigationId?n:null;if(n){let c=L({},n);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let s=this.parseUrl(i);this.scheduleNavigation(s,r,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(i){this.config=i.map(UI),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(i,r={}){let{relativeTo:n,queryParams:o,fragment:a,queryParamsHandling:s,preserveFragment:c}=r,l=c?this.currentUrlTree.fragment:a,d=null;switch(s){case"merge":d=L(L({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let u;try{let h=n?n.snapshot:this.routerState.snapshot.root;u=YU(h)}catch{(typeof i[0]!="string"||!i[0].startsWith("/"))&&(i=[]),u=this.currentUrlTree.root}return ZU(u,i,d,l??null)}navigateByUrl(i,r={skipLocationChange:!1}){let n=Dm(i)?i:this.parseUrl(i),o=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(o,V0,null,r)}navigate(i,r={skipLocationChange:!1}){return Sme(i),this.navigateByUrl(this.createUrlTree(i,r),r)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){try{return this.urlSerializer.parse(i)}catch{return this.urlSerializer.parse("/")}}isActive(i,r){let n;if(r===!0?n=L({},Eme):r===!1?n=L({},Cme):n=r,Dm(i))return kU(this.currentUrlTree,i,n);let o=this.parseUrl(i);return kU(this.currentUrlTree,o,n)}removeEmptyProps(i){return Object.entries(i).reduce((r,[n,o])=>(o!=null&&(r[n]=o),r),{})}scheduleNavigation(i,r,n,o,a){if(this.disposed)return Promise.resolve(!1);let s,c,l;a?(s=a.resolve,c=a.reject,l=a.promise):l=new Promise((u,h)=>{s=u,c=h});let d=this.pendingTasks.add();return m9(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:i,extras:o,resolve:s,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(u=>Promise.reject(u))}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function Sme(e){for(let t=0;t<e.length;t++)if(e[t]==null)throw new Tr(4008,!1)}function Tme(e){return!(e instanceof G0)&&!(e instanceof $0)}var fu=(()=>{class e{constructor(i,r,n,o,a,s){this.router=i,this.route=r,this.tabIndexAttribute=n,this.renderer=o,this.el=a,this.locationStrategy=s,this.href=null,this.commands=null,this.onChanges=new Ct,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let c=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=i.events.subscribe(l=>{l instanceof ec&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(i){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",i)}ngOnChanges(i){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(i){i!=null?(this.commands=Array.isArray(i)?i:[i],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(i,r,n,o,a){let s=this.urlTree;if(s===null||this.isAnchorElement&&(i!==0||r||n||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(s,c),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let i=this.urlTree;this.href=i!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(i)):null;let r=this.href===null?null:T3(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(i,r){let n=this.renderer,o=this.el.nativeElement;r!==null?n.setAttribute(o,i,r):n.removeAttribute(o,i)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(r){return new(r||e)(G(hu),G(dp),Zo("tabindex"),G(Bg),G(vt),G(Vg))}}static{this.\u0275dir=xt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,n){r&1&&Y("click",function(a){return n.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),r&2&&Zt("target",n.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[_e.HasDecoratorInputTransform,"preserveFragment","preserveFragment",yt],skipLocationChange:[_e.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",yt],replaceUrl:[_e.HasDecoratorInputTransform,"replaceUrl","replaceUrl",yt],routerLink:"routerLink"},standalone:!0,features:[Hi,kr]})}}return e})();var j1=class{};var Ame=(()=>{class e{constructor(i,r,n,o,a){this.router=i,this.injector=n,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Ji(i=>i instanceof ec),hd(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(i,r){let n=[];for(let o of r){o.providers&&!o._injector&&(o._injector=vC(o.providers,i,`Route: ${o.path}`));let a=o._injector??i,s=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&n.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&n.push(this.processRoutes(s,o.children??o._loadedRoutes))}return Co(n).pipe(oC())}preloadConfig(i,r){return this.preloadingStrategy.preload(r,()=>{let n;r.loadChildren&&r.canLoad===void 0?n=this.loader.loadChildren(i,r):n=Dt(null);let o=n.pipe($a(a=>a===null?Dt(void 0):(r._loadedRoutes=a.routes,r._loadedInjector=a.injector,this.processRoutes(a.injector??i,a.routes))));if(r.loadComponent&&!r._loadedComponent){let a=this.loader.loadComponent(r);return Co([o,a]).pipe(oC())}else return o})}static{this.\u0275fac=function(r){return new(r||e)(Ae(hu),Ae(jb),Ae(qu),Ae(j1),Ae(jI))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),g9=new Ye(""),Dme=(()=>{class e{constructor(i,r,n,o,a={}){this.urlSerializer=i,this.transitions=r,this.viewportScroller=n,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=Je(qu),a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(i=>{i instanceof Im?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=i.navigationTrigger,this.restoredId=i.restoredState?i.restoredState.navigationId:0):i instanceof ec?(this.lastId=i.id,this.scheduleScrollEvent(i,this.urlSerializer.parse(i.urlAfterRedirects).fragment)):i instanceof uu&&i.code===O1.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(i,this.urlSerializer.parse(i.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(i=>{i instanceof F1&&(i.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(i.position):i.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(i.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(i,r){this.zone.runOutsideAngular(()=>Qe(this,null,function*(){yield new Promise(n=>{setTimeout(()=>{n()}),mC(()=>{n()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new F1(i,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(r){$p()}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac})}}return e})();function Ime(e){return e.routerState.root}function t_(e,t){return{\u0275kind:e,\u0275providers:t}}function Mme(){let e=Je(Ea);return t=>{let i=e.get(Qu);if(t!==i.components[0])return;let r=e.get(hu),n=e.get(v9);e.get(WI)===1&&r.initialNavigation(),e.get(_9,null,uC.Optional)?.setUpPreloading(),e.get(g9,null,uC.Optional)?.init(),r.resetRootComponentType(i.componentTypes[0]),n.closed||(n.next(),n.complete(),n.unsubscribe())}}var v9=new Ye("",{factory:()=>new Ct}),WI=new Ye("",{providedIn:"root",factory:()=>1});function kme(){return t_(2,[{provide:WI,useValue:0},{provide:bC,multi:!0,deps:[Ea],useFactory:t=>{let i=t.get(Z3,Promise.resolve());return()=>i.then(()=>new Promise(r=>{let n=t.get(hu),o=t.get(v9);m9(n,()=>{r(!0)}),t.get($I).afterPreactivation=()=>(r(!0),o.closed?Dt(void 0):o),n.initialNavigation()}))}}])}function Pme(){return t_(3,[{provide:bC,multi:!0,useFactory:()=>{let t=Je(hu);return()=>{t.setUpLocationChangeListener()}}},{provide:WI,useValue:2}])}var _9=new Ye("");function Nme(e){return t_(0,[{provide:_9,useExisting:Ame},{provide:j1,useExisting:e}])}function Ome(){return t_(8,[RU,{provide:G1,useExisting:RU}])}function Rme(e){let t=[{provide:h9,useValue:gme},{provide:p9,useValue:L({skipNextTransition:!!e?.skipInitialTransition},e)}];return t_(9,t)}var LU=new Ye("ROUTER_FORROOT_GUARD"),Fme=[eh,{provide:Z0,useClass:U0},hu,K0,{provide:dp,useFactory:Ime,deps:[hu]},jI,[]],qI=(()=>{class e{constructor(i){}static forRoot(i,r){return{ngModule:e,providers:[Fme,[],{provide:H1,multi:!0,useValue:i},{provide:LU,useFactory:zme,deps:[[hu,new Rb,new hC]]},{provide:e_,useValue:r||{}},r?.useHash?Bme():Vme(),Lme(),r?.preloadingStrategy?Nme(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?Ume(r):[],r?.bindToComponentInputs?Ome().\u0275providers:[],r?.enableViewTransitions?Rme().\u0275providers:[],Hme()]}}static forChild(i){return{ngModule:e,providers:[{provide:H1,multi:!0,useValue:i}]}}static{this.\u0275fac=function(r){return new(r||e)(Ae(LU,8))}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({})}}return e})();function Lme(){return{provide:g9,useFactory:()=>{let e=Je(iR),t=Je(st),i=Je(e_),r=Je($I),n=Je(Z0);return i.scrollOffset&&e.setOffset(i.scrollOffset),new Dme(n,r,e,t,i)}}}function Bme(){return{provide:Vg,useClass:Q3}}function Vme(){return{provide:Vg,useClass:K3}}function zme(e){return"guarded"}function Ume(e){return[e.initialNavigation==="disabled"?Pme().\u0275providers:[],e.initialNavigation==="enabledBlocking"?kme().\u0275providers:[]]}var BU=new Ye("");function Hme(){return[{provide:BU,useFactory:Mme},{provide:H3,multi:!0,useExisting:BU}]}var jme=["*"],Gme=e=>({"background-image":e}),b9=(()=>{class e{title="";imgURL="";constructor(){}ngOnInit(){}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Le({type:e,selectors:[["app-home-card"]],inputs:{title:"title",imgURL:"imgURL"},ngContentSelectors:jme,decls:6,vars:4,consts:[[1,"card",3,"ngStyle"],[1,"card-content"],[1,"title"],[1,"content"]],template:function(r,n){r&1&&(vi(),C(0,"div",0)(1,"div",1)(2,"h2",2),W(3),A(),C(4,"div",3),gt(5),A()()()),r&2&&(z("ngStyle",Zu(2,Gme,"url("+n.imgURL+")")),O(3),Qr(" ",n.title," "))},dependencies:[Gb],styles:['.card[_ngcontent-%COMP%]{--transition-duration: .25s;--transform-transition: transform var(--transition-duration) ease;color:var(--clr-neutral-100);background-size:cover;width:var(--card-width);aspect-ratio:1;border-radius:.25rem;padding:1rem 0 0;overflow:hidden;position:relative;transition:var(--transform-transition);box-shadow:#00000030 0 10px 20px,#0000003b 0 6px 6px}.card[_ngcontent-%COMP%]:before{content:"";position:absolute;background:#000;opacity:.5;pointer-events:none;width:var(--card-width);aspect-ratio:1;border-radius:.25rem;padding:1rem 0 0;top:0}.card-content[_ngcontent-%COMP%]{--padding: 1.1rem;height:100%;padding:var(--padding);padding-top:3rem;background:linear-gradient(#0000,#000000bf 50%,#000)}.title[_ngcontent-%COMP%]{position:relative;width:max-content;font-size:1rem}.title[_ngcontent-%COMP%]:after{content:"";position:absolute;height:4px;width:calc(100% + var(--padding));left:calc(var(--padding) * -1);bottom:0;background-color:var(--clr-accent-400)}@media (hover){.title[_ngcontent-%COMP%]:after{transform-origin:left;transform:scaleX(0);transition:var(--transform-transition)}.card-content[_ngcontent-%COMP%]{transform:translateY(55%);transition:var(--transform-transition)}.card[_ngcontent-%COMP%]:hover, .card[_ngcontent-%COMP%]:focus-within{transform:scale(1.025)}.card[_ngcontent-%COMP%]:hover:before{opacity:0}.card[_ngcontent-%COMP%]:hover   .title[_ngcontent-%COMP%]:after, .card[_ngcontent-%COMP%]:focus-within   .title[_ngcontent-%COMP%]:after{transform:scaleX(1);transition-delay:var(--transition-duration)}.card[_ngcontent-%COMP%]:hover   .card-content[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]:focus-within   .card-content[_ngcontent-%COMP%]{transform:translateY(0)}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important;transition-delay:0ms!important}}']})}return e})();var y9=(()=>{class e{constructor(){}ngOnInit(){}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Le({type:e,selectors:[["app-home"]],decls:42,vars:0,consts:[[1,"w-full","home"],[1,"flex","flex-row","flex-wrap","gap-4","mx-16","pb-4","section"],["routerLink","/sampling"],["title","Sampling","imgURL","assets/images/home-cards/sampling.png"],["href","https://clementpla.github.io/SegmentationMetricTutorial/main/classification"],["imgURL","assets/images/home-cards/metric.jpg","title","Classification Metrics"],[1,"flex-row","flex","gap-4","flex-wrap","mx-16","pb-4","section"],["routerLink","/PSNR"],["title","Image Quality and Noise","imgURL","assets/image_presets/phantom.png"],["routerLink","/fourierTransform"],["title","Fourier Transform 2D","imgURL","assets/images/home-cards/fourierTransform.jpg"],["routerLink","/spatialFiltering"],["title","Spatial Filtering","imgURL","assets/images/home-cards/spatial_filtering.jpg"],["routerLink","/spectralFiltering"],["title","Spectral Filtering","imgURL","assets/image_presets/CTandstripes.jpeg"],["routerLink","/colorspaces"],["title","Colorspaces","imgURL","assets/images/home-cards/colorspace.jpg"],["routerLink","/morphology"],["title","Morphology","imgURL","assets/images/home-cards/morphology.jpg"],["routerLink","/histogram"],["title","Image Histogram","imgURL","assets/images/home-cards/histogram.jpg"],["href","https://clementpla.github.io/SegmentationMetricTutorial/main/segmentation"],["imgURL","assets/images/home-cards/segmentation_metrics.jpg","title","Segmentation Metrics"],["routerLink","/PCA"],["title","Principal Component Analysis","imgURL","assets/images/home-cards/pca.jpg"],["routerLink","/weightLoss"],["title","Learning & Loss","imgURL","assets/images/home-cards/weight_loss.png"],["routerLink","/regression"],["title","Regression","imgURL","assets/images/home-cards/regression.png"],["routerLink","/optimizer"],["title","Gradient Descent & Optimizers","imgURL","assets/images/home-cards/gradient_descent.png"],["routerLink","/gradientDescent"],["title","Fully Connected Networks","imgURL","assets/images/home-cards/neural_network.png"],["routerLink","/CNN"],["title","A simple CNN Demo","imgURL","assets/images/home-cards/CNN.png"]],template:function(r,n){r&1&&(C(0,"div",0)(1,"h2"),W(2,"1D"),A(),C(3,"div",1)(4,"a",2),he(5,"app-home-card",3),A(),C(6,"a",4),he(7,"app-home-card",5),A()(),C(8,"h2"),W(9,"2D"),A(),C(10,"div",6)(11,"a",7),he(12,"app-home-card",8),A(),C(13,"a",9),he(14,"app-home-card",10),A(),C(15,"a",11),he(16,"app-home-card",12),A(),C(17,"a",13),he(18,"app-home-card",14),A(),C(19,"a",15),he(20,"app-home-card",16),A(),C(21,"a",17),he(22,"app-home-card",18),A(),C(23,"a",19),he(24,"app-home-card",20),A(),C(25,"a",21),he(26,"app-home-card",22),A()(),C(27,"h2"),W(28,"Machine Learning"),A(),C(29,"div",6)(30,"a",23),he(31,"app-home-card",24),A(),C(32,"a",25),he(33,"app-home-card",26),A(),C(34,"a",27),he(35,"app-home-card",28),A(),C(36,"a",29),he(37,"app-home-card",30),A(),C(38,"a",31),he(39,"app-home-card",32),A(),C(40,"a",33),he(41,"app-home-card",34),A()()())},dependencies:[fu,b9],styles:["a[_ngcontent-%COMP%]{color:inherit;text-decoration:inherit}h2[_ngcontent-%COMP%]{border:solid white 2px;width:fit-content;border-radius:2em;padding:0 1em;color:#fff}@media (max-width: 768px){.home-container[_ngcontent-%COMP%]{gap:1em;margin:0 1em}}.home[_ngcontent-%COMP%]{background-color:var(--mat-sidenav-content-background-color)}@keyframes _ngcontent-%COMP%_rotate{0%{transform:rotateY(90deg);opacity:.1}to{transform:rotateY(0);opacity:1}}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(n){animation-name:_ngcontent-%COMP%_rotate;animation-duration:.2s;animation-direction:normal;animation-fill-mode:both;animation-timing-function:ease-out}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(n){animation-delay:.1s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(2n){animation-delay:.2s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(3n){animation-delay:.3s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(4n){animation-delay:.4s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(5n){animation-delay:.5s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(6n){animation-delay:.6s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(7n){animation-delay:.7s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(8n){animation-delay:.8s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(9n){animation-delay:.9s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(10n){animation-delay:1s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(11n){animation-delay:1.1s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(12n){animation-delay:1.2s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(13n){animation-delay:1.3s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(14n){animation-delay:1.4s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(15n){animation-delay:1.5s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(16n){animation-delay:1.6s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(17n){animation-delay:1.7s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(18n){animation-delay:1.8s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(19n){animation-delay:1.9s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(20n){animation-delay:2s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(21n){animation-delay:2.1s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(22n){animation-delay:2.2s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(23n){animation-delay:2.3s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(24n){animation-delay:2.4s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(25n){animation-delay:2.5s}"]})}return e})();var mu=(()=>{class e{leftDrawer=!0;rightDrawer=!0;static \u0275fac=function(r){return new(r||e)};static \u0275dir=xt({type:e,inputs:{leftDrawer:"leftDrawer",rightDrawer:"rightDrawer"}})}return e})();function XI(e,t,i,r){var n=arguments.length,o=n<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(n<3?a(o):n>3?a(t,i,o):a(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o}function x9(e,t){return function(i,r){t(i,r,e)}}function w9(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}var YI=new Ye("OpenCV config object token"),i_=(()=>{let e=class{constructor(i,r){this._ngZone=r,this.cvState=new Eo({ready:!1,error:!1,loading:!0,state:"loading"}),i||(i={}),this.configModule=this.generateConfigModule(i),this.loadOpenCv()}loadOpenCv(){this.cvState.next(this.newState("loading")),window.Module=this.configModule;let i=document.createElement("script");i.setAttribute("async",""),i.setAttribute("type","text/javascript"),i.addEventListener("error",()=>{let n=new Error("Failed to load "+this.configModule.scriptUrl);this.cvState.next(this.newState("error")),this.cvState.error(n)},{passive:!0}),i.src=this.configModule.scriptUrl;let r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(i,r):document.head.appendChild(i)}newState(i){let r={ready:!1,loading:!1,error:!1,state:""};return Object.keys(r).forEach(n=>{n!=="state"&&(n===i?(r[n]=!0,r.state=n):r[n]=!1)}),r}generateConfigModule(i){return{scriptUrl:i.openCVDirPath?`${i.openCVDirPath}/opencv.js`:"/assets/opencv/opencv.js",wasmBinaryFile:"opencv_js.wasm",usingWasm:!0,onRuntimeInitialized:()=>{this._ngZone.run(()=>{console.log("openCV Ready"),this.cvState.next(this.newState("ready")),i.runOnOpenCVInit&&i.runOnOpenCVInit()})}}}};return e.\u0275prov=tt({factory:function(){return new e(Ae(YI),Ae(st))},token:e,providedIn:"root"}),e=XI([m3({providedIn:"root"}),x9(0,h3(YI)),w9("design:paramtypes",[Object,st])],e),e})(),ZI,q1=ZI=class{static forRoot(t){return{ngModule:ZI,providers:[{provide:YI,useValue:t}]}}};q1=ZI=XI([z3({declarations:[],exports:[],providers:[i_]})],q1);var gu=(()=>{class e{showImagePreset=!1;constructor(){}toggleImagePreset(){this.showImagePreset=!this.showImagePreset}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var C9=["outputCanvas"],S9=["inputCanvas"],Fo=(()=>{class e extends mu{ngxOpenCv;uiservice;cdr;cvState;outputCanvasContained;drawCanvasContained;outputCanvas;drawCanvas;profileOptions;sideMenuContext=!0;constructor(i,r,n){super(),this.ngxOpenCv=i,this.uiservice=r,this.cdr=n}ngAfterViewInit(){this.ngxOpenCv.cvState.subscribe(i=>{this.cvState=i,i.error||i.loading||i.ready}),this.cdr.detectChanges()}loadSelectedFileFromPath(i){let r=new Image;r.onerror=n=>{console.log("Loading failed")},r.src=i,r.onload=()=>{this.drawCanvas?this.drawCanvas.drawImage(r):this.drawCanvasContained&&this.drawCanvasContained.drawImage(r)}}loadSelectedFile(i){var r=new FileReader;r.onload=n=>{let o=new Image;o.onerror=a=>{console.log("Loading failed")},o.src=n.target.result,o.onload=()=>{this.drawCanvasContained.drawImage(o)}},r.readAsDataURL(i)}clearCanvas(){this.drawCanvasContained.clearCanvas()}updateProfile(){let i=this.outputCanvas.getProfile();this.profileOptions={legend:{data:["Profile"],align:"left"},tooltip:{},xAxis:{data:Array.from(Array(i.length).keys()),silent:!1,splitLine:{show:!1}},yAxis:[{type:"value",min:0,max:275}],series:[{symbol:"none",name:"profile",type:"line",areaStyle:{},data:i}],animationEasing:"elasticOut",animationDelayUpdate:r=>r*5}}toggleImagePresets(){this.sideMenuContext=!this.sideMenuContext}static \u0275fac=function(r){return new(r||e)(G(i_),G(gu),G(ei))};static \u0275dir=xt({type:e,contentQueries:function(r,n,o){if(r&1&&(Xi(o,C9,5),Xi(o,S9,5)),r&2){let a;Ve(a=ze())&&(n.outputCanvasContained=a.first),Ve(a=ze())&&(n.drawCanvasContained=a.first)}},viewQuery:function(r,n){if(r&1&&(ht(C9,5),ht(S9,5)),r&2){let o;Ve(o=ze())&&(n.outputCanvas=o.first),Ve(o=ze())&&(n.drawCanvas=o.first)}},features:[Yt]})}return e})();var Wme=new Ye("cdk-dir-doc",{providedIn:"root",factory:qme});function qme(){return Je(Bt)}var Xme=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function Yme(e){let t=e?.toLowerCase()||"";return t==="auto"&&typeof navigator<"u"&&navigator?.language?Xme.test(navigator.language)?"rtl":"ltr":t==="rtl"?"rtl":"ltr"}var ds=(()=>{class e{constructor(i){if(this.value="ltr",this.change=new We,i){let r=i.body?i.body.dir:null,n=i.documentElement?i.documentElement.dir:null;this.value=Yme(r||n||"ltr")}}ngOnDestroy(){this.change.complete()}static{this.\u0275fac=function(r){return new(r||e)(Ae(Wme,8))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var vu=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({})}}return e})();var QI;try{QI=typeof Intl<"u"&&Intl.v8BreakIterator}catch{QI=!1}var Pi=(()=>{class e{constructor(i){this._platformId=i,this.isBrowser=this._platformId?$b(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||QI)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static{this.\u0275fac=function(r){return new(r||e)(Ae(mc))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Nm,T9=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function JI(){if(Nm)return Nm;if(typeof document!="object"||!document)return Nm=new Set(T9),Nm;let e=document.createElement("input");return Nm=new Set(T9.filter(t=>(e.setAttribute("type",t),e.type===t))),Nm}var r_;function Zme(){if(r_==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>r_=!0}))}finally{r_=r_||!1}return r_}function _u(e){return Zme()?e:!!e.capture}var yl=function(e){return e[e.NORMAL=0]="NORMAL",e[e.NEGATED=1]="NEGATED",e[e.INVERTED=2]="INVERTED",e}(yl||{}),Y1,up;function Z1(){if(up==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return up=!1,up;if("scrollBehavior"in document.documentElement.style)up=!0;else{let e=Element.prototype.scrollTo;e?up=!/\{\s*\[native code\]\s*\}/.test(e.toString()):up=!1}}return up}function Om(){if(typeof document!="object"||!document)return yl.NORMAL;if(Y1==null){let e=document.createElement("div"),t=e.style;e.dir="rtl",t.width="1px",t.overflow="auto",t.visibility="hidden",t.pointerEvents="none",t.position="absolute";let i=document.createElement("div"),r=i.style;r.width="2px",r.height="1px",e.appendChild(i),document.body.appendChild(e),Y1=yl.NORMAL,e.scrollLeft===0&&(e.scrollLeft=1,Y1=e.scrollLeft===0?yl.NEGATED:yl.INVERTED),e.remove()}return Y1}var KI;function Kme(){if(KI==null){let e=typeof document<"u"?document.head:null;KI=!!(e&&(e.createShadowRoot||e.attachShadow))}return KI}function A9(e){if(Kme()){let t=e.getRootNode?e.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function qs(e){return e.composedPath?e.composedPath()[0]:e.target}function n_(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}var eM=class{constructor(t){this._box=t,this._destroyed=new Ct,this._resizeSubject=new Ct,this._elementObservables=new Map,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(i=>this._resizeSubject.next(i)))}observe(t){return this._elementObservables.has(t)||this._elementObservables.set(t,new al(i=>{let r=this._resizeSubject.subscribe(i);return this._resizeObserver?.observe(t,{box:this._box}),()=>{this._resizeObserver?.unobserve(t),r.unsubscribe(),this._elementObservables.delete(t)}}).pipe(Ji(i=>i.some(r=>r.target===t)),dC({bufferSize:1,refCount:!0}),Ui(this._destroyed))),this._elementObservables.get(t)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},D9=(()=>{class e{constructor(){this._observers=new Map,this._ngZone=Je(st),typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,i]of this._observers)i.destroy();this._observers.clear(),typeof ResizeObserver<"u"}observe(i,r){let n=r?.box||"content-box";return this._observers.has(n)||this._observers.set(n,new eM(n)),this._observers.get(n).observe(i)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function Lo(e){return e!=null&&`${e}`!="false"}function Rm(e){return Array.isArray(e)?e:[e]}function Sn(e){return e==null?"":typeof e=="string"?e:`${e}px`}function Xs(e){return e instanceof vt?e.nativeElement:e}var Qme=(()=>{class e{create(i){return typeof MutationObserver>"u"?null:new MutationObserver(i)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var K1=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({providers:[Qme]})}}return e})();function us(e,...t){return t.length?t.some(i=>e[i]):e.altKey||e.shiftKey||e.ctrlKey||e.metaKey}var I9=new Set,hp,Jme=(()=>{class e{constructor(i,r){this._platform=i,this._nonce=r,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):tge}matchMedia(i){return(this._platform.WEBKIT||this._platform.BLINK)&&ege(i,this._nonce),this._matchMedia(i)}static{this.\u0275fac=function(r){return new(r||e)(Ae(Pi),Ae(Fg,8))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function ege(e,t){if(!I9.has(e))try{hp||(hp=document.createElement("style"),t&&hp.setAttribute("nonce",t),hp.setAttribute("type","text/css"),document.head.appendChild(hp)),hp.sheet&&(hp.sheet.insertRule(`@media ${e} {body{ }}`,0),I9.add(e))}catch(i){console.error(i)}}function tge(e){return{matches:e==="all"||e==="",media:e,addListener:()=>{},removeListener:()=>{}}}var k9=(()=>{class e{constructor(i,r){this._mediaMatcher=i,this._zone=r,this._queries=new Map,this._destroySubject=new Ct}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(i){return M9(Rm(i)).some(n=>this._registerQuery(n).mql.matches)}observe(i){let n=M9(Rm(i)).map(a=>this._registerQuery(a).observable),o=Up(n);return o=Pb(o.pipe(wn(1)),o.pipe(Ob(1),Hp(0))),o.pipe(Xt(a=>{let s={matches:!1,breakpoints:{}};return a.forEach(({matches:c,query:l})=>{s.matches=s.matches||c,s.breakpoints[l]=c}),s}))}_registerQuery(i){if(this._queries.has(i))return this._queries.get(i);let r=this._mediaMatcher.matchMedia(i),o={observable:new al(a=>{let s=c=>this._zone.run(()=>a.next(c));return r.addListener(s),()=>{r.removeListener(s)}}).pipe(xa(r),Xt(({matches:a})=>({query:i,matches:a})),Ui(this._destroySubject)),mql:r};return this._queries.set(i,o),o}static{this.\u0275fac=function(r){return new(r||e)(Ae(Jme),Ae(st))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function M9(e){return e.map(t=>t.split(",")).reduce((t,i)=>t.concat(i)).map(t=>t.trim())}var R9=" ";function F9(e,t,i){let r=L9(e,t);i=i.trim(),!r.some(n=>n.trim()===i)&&(r.push(i),e.setAttribute(t,r.join(R9)))}function aM(e,t,i){let r=L9(e,t);i=i.trim();let n=r.filter(o=>o!==i);n.length?e.setAttribute(t,n.join(R9)):e.removeAttribute(t)}function L9(e,t){return e.getAttribute(t)?.match(/\S+/g)??[]}var e2=class{constructor(t,i){this._items=t,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new Ct,this._typeaheadSubscription=fn.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=r=>r.disabled,this._pressedLetters=[],this.tabOut=new Ct,this.change=new Ct,t instanceof Yu?this._itemChangesSubscription=t.changes.subscribe(r=>this._itemsChanged(r.toArray())):gC(t)&&(this._effectRef=W3(()=>this._itemsChanged(t()),{injector:i}))}skipPredicate(t){return this._skipPredicateFn=t,this}withWrap(t=!0){return this._wrap=t,this}withVerticalOrientation(t=!0){return this._vertical=t,this}withHorizontalOrientation(t){return this._horizontal=t,this}withAllowedModifierKeys(t){return this._allowedModifierKeys=t,this}withTypeAhead(t=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(an(i=>this._pressedLetters.push(i)),Hp(t),Ji(()=>this._pressedLetters.length>0),Xt(()=>this._pressedLetters.join(""))).subscribe(i=>{let r=this._getItemsArray();for(let n=1;n<r.length+1;n++){let o=(this._activeItemIndex+n)%r.length,a=r[o];if(!this._skipPredicateFn(a)&&a.getLabel().toUpperCase().trim().indexOf(i)===0){this.setActiveItem(o);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(t=!0){return this._homeAndEnd=t,this}withPageUpDown(t=!0,i=10){return this._pageUpAndDown={enabled:t,delta:i},this}setActiveItem(t){let i=this._activeItem;this.updateActiveItem(t),this._activeItem!==i&&this.change.next(this._activeItemIndex)}onKeydown(t){let i=t.keyCode,n=["altKey","ctrlKey","metaKey","shiftKey"].every(o=>!t[o]||this._allowedModifierKeys.indexOf(o)>-1);switch(i){case 9:this.tabOut.next();return;case 40:if(this._vertical&&n){this.setNextItemActive();break}else return;case 38:if(this._vertical&&n){this.setPreviousItemActive();break}else return;case 39:if(this._horizontal&&n){this._horizontal==="rtl"?this.setPreviousItemActive():this.setNextItemActive();break}else return;case 37:if(this._horizontal&&n){this._horizontal==="rtl"?this.setNextItemActive():this.setPreviousItemActive();break}else return;case 36:if(this._homeAndEnd&&n){this.setFirstItemActive();break}else return;case 35:if(this._homeAndEnd&&n){this.setLastItemActive();break}else return;case 33:if(this._pageUpAndDown.enabled&&n){let o=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(o>0?o:0,1);break}else return;case 34:if(this._pageUpAndDown.enabled&&n){let o=this._activeItemIndex+this._pageUpAndDown.delta,a=this._getItemsArray().length;this._setActiveItemByIndex(o<a?o:a-1,-1);break}else return;default:(n||us(t,"shiftKey"))&&(t.key&&t.key.length===1?this._letterKeyStream.next(t.key.toLocaleUpperCase()):(i>=65&&i<=90||i>=48&&i<=57)&&this._letterKeyStream.next(String.fromCharCode(i)));return}this._pressedLetters=[],t.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(t){let i=this._getItemsArray(),r=typeof t=="number"?t:i.indexOf(t),n=i[r];this._activeItem=n??null,this._activeItemIndex=r}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(t){this._wrap?this._setActiveInWrapMode(t):this._setActiveInDefaultMode(t)}_setActiveInWrapMode(t){let i=this._getItemsArray();for(let r=1;r<=i.length;r++){let n=(this._activeItemIndex+t*r+i.length)%i.length,o=i[n];if(!this._skipPredicateFn(o)){this.setActiveItem(n);return}}}_setActiveInDefaultMode(t){this._setActiveItemByIndex(this._activeItemIndex+t,t)}_setActiveItemByIndex(t,i){let r=this._getItemsArray();if(r[t]){for(;this._skipPredicateFn(r[t]);)if(t+=i,!r[t])return;this.setActiveItem(t)}}_getItemsArray(){return gC(this._items)?this._items():this._items instanceof Yu?this._items.toArray():this._items}_itemsChanged(t){if(this._activeItem){let i=t.indexOf(this._activeItem);i>-1&&i!==this._activeItemIndex&&(this._activeItemIndex=i)}}},t2=class extends e2{setActiveItem(t){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(t),this.activeItem&&this.activeItem.setActiveStyles()}},i2=class extends e2{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(t){return this._origin=t,this}setActiveItem(t){super.setActiveItem(t),this.activeItem&&this.activeItem.focus(this._origin)}};var sM=(()=>{class e{constructor(i){this._platform=i}isDisabled(i){return i.hasAttribute("disabled")}isVisible(i){return gge(i)&&getComputedStyle(i).visibility==="visible"}isTabbable(i){if(!this._platform.isBrowser)return!1;let r=mge(Cge(i));if(r&&(P9(r)===-1||!this.isVisible(r)))return!1;let n=i.nodeName.toLowerCase(),o=P9(i);return i.hasAttribute("contenteditable")?o!==-1:n==="iframe"||n==="object"||this._platform.WEBKIT&&this._platform.IOS&&!wge(i)?!1:n==="audio"?i.hasAttribute("controls")?o!==-1:!1:n==="video"?o===-1?!1:o!==null?!0:this._platform.FIREFOX||i.hasAttribute("controls"):i.tabIndex>=0}isFocusable(i,r){return Ege(i)&&!this.isDisabled(i)&&(r?.ignoreVisibility||this.isVisible(i))}static{this.\u0275fac=function(r){return new(r||e)(Ae(Pi))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function mge(e){try{return e.frameElement}catch{return null}}function gge(e){return!!(e.offsetWidth||e.offsetHeight||typeof e.getClientRects=="function"&&e.getClientRects().length)}function vge(e){let t=e.nodeName.toLowerCase();return t==="input"||t==="select"||t==="button"||t==="textarea"}function _ge(e){return yge(e)&&e.type=="hidden"}function bge(e){return xge(e)&&e.hasAttribute("href")}function yge(e){return e.nodeName.toLowerCase()=="input"}function xge(e){return e.nodeName.toLowerCase()=="a"}function B9(e){if(!e.hasAttribute("tabindex")||e.tabIndex===void 0)return!1;let t=e.getAttribute("tabindex");return!!(t&&!isNaN(parseInt(t,10)))}function P9(e){if(!B9(e))return null;let t=parseInt(e.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}function wge(e){let t=e.nodeName.toLowerCase(),i=t==="input"&&e.type;return i==="text"||i==="password"||t==="select"||t==="textarea"}function Ege(e){return _ge(e)?!1:vge(e)||bge(e)||e.hasAttribute("contenteditable")||B9(e)}function Cge(e){return e.ownerDocument&&e.ownerDocument.defaultView||window}var iM=class{get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}constructor(t,i,r,n,o=!1){this._element=t,this._checker=i,this._ngZone=r,this._document=n,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,o||this.attachAnchors()}destroy(){let t=this._startAnchor,i=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),i&&(i.removeEventListener("focus",this.endAnchorListener),i.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return this._hasAttached?!0:(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(i=>{this._executeOnStable(()=>i(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(i=>{this._executeOnStable(()=>i(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(i=>{this._executeOnStable(()=>i(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){let i=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return t=="start"?i.length?i[0]:this._getFirstTabbableElement(this._element):i.length?i[i.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){let i=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(i){if(!this._checker.isFocusable(i)){let r=this._getFirstTabbableElement(i);return r?.focus(t),!!r}return i.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){let i=this._getRegionBoundary("start");return i&&i.focus(t),!!i}focusLastTabbableElement(t){let i=this._getRegionBoundary("end");return i&&i.focus(t),!!i}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let i=t.children;for(let r=0;r<i.length;r++){let n=i[r].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(i[r]):null;if(n)return n}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let i=t.children;for(let r=i.length-1;r>=0;r--){let n=i[r].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(i[r]):null;if(n)return n}return null}_createAnchor(){let t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,i){t?i.setAttribute("tabindex","0"):i.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.pipe(wn(1)).subscribe(t)}},V9=(()=>{class e{constructor(i,r,n){this._checker=i,this._ngZone=r,this._document=n}create(i,r=!1){return new iM(i,this._checker,this._ngZone,this._document,r)}static{this.\u0275fac=function(r){return new(r||e)(Ae(sM),Ae(st),Ae(Bt))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function lM(e){return e.buttons===0||e.detail===0}function cM(e){let t=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0];return!!t&&t.identifier===-1&&(t.radiusX==null||t.radiusX===1)&&(t.radiusY==null||t.radiusY===1)}var Sge=new Ye("cdk-input-modality-detector-options"),Tge={ignoreKeys:[18,17,224,91,16]},z9=650,Fm=_u({passive:!0,capture:!0}),Age=(()=>{class e{get mostRecentModality(){return this._modality.value}constructor(i,r,n,o){this._platform=i,this._mostRecentTarget=null,this._modality=new Eo(null),this._lastTouchMs=0,this._onKeydown=a=>{this._options?.ignoreKeys?.some(s=>s===a.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=qs(a))},this._onMousedown=a=>{Date.now()-this._lastTouchMs<z9||(this._modality.next(lM(a)?"keyboard":"mouse"),this._mostRecentTarget=qs(a))},this._onTouchstart=a=>{if(cM(a)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=qs(a)},this._options=L(L({},Tge),o),this.modalityDetected=this._modality.pipe(Ob(1)),this.modalityChanged=this.modalityDetected.pipe($u()),i.isBrowser&&r.runOutsideAngular(()=>{n.addEventListener("keydown",this._onKeydown,Fm),n.addEventListener("mousedown",this._onMousedown,Fm),n.addEventListener("touchstart",this._onTouchstart,Fm)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Fm),document.removeEventListener("mousedown",this._onMousedown,Fm),document.removeEventListener("touchstart",this._onTouchstart,Fm))}static{this.\u0275fac=function(r){return new(r||e)(Ae(Pi),Ae(st),Ae(Bt),Ae(Sge,8))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Dge=new Ye("liveAnnouncerElement",{providedIn:"root",factory:Ige});function Ige(){return null}var Mge=new Ye("LIVE_ANNOUNCER_DEFAULT_OPTIONS"),kge=0,U9=(()=>{class e{constructor(i,r,n,o){this._ngZone=r,this._defaultOptions=o,this._document=n,this._liveElement=i||this._createLiveElement()}announce(i,...r){let n=this._defaultOptions,o,a;return r.length===1&&typeof r[0]=="number"?a=r[0]:[o,a]=r,this.clear(),clearTimeout(this._previousTimeout),o||(o=n&&n.politeness?n.politeness:"polite"),a==null&&n&&(a=n.duration),this._liveElement.setAttribute("aria-live",o),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(s=>this._currentResolve=s)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=i,typeof a=="number"&&(this._previousTimeout=setTimeout(()=>this.clear(),a)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){let i="cdk-live-announcer-element",r=this._document.getElementsByClassName(i),n=this._document.createElement("div");for(let o=0;o<r.length;o++)r[o].remove();return n.classList.add(i),n.classList.add("cdk-visually-hidden"),n.setAttribute("aria-atomic","true"),n.setAttribute("aria-live","polite"),n.id=`cdk-live-announcer-${kge++}`,this._document.body.appendChild(n),n}_exposeAnnouncerToModals(i){let r=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let n=0;n<r.length;n++){let o=r[n],a=o.getAttribute("aria-owns");a?a.indexOf(i)===-1&&o.setAttribute("aria-owns",a+" "+i):o.setAttribute("aria-owns",i)}}static{this.\u0275fac=function(r){return new(r||e)(Ae(Dge,8),Ae(st),Ae(Bt),Ae(Mge,8))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var J1=function(e){return e[e.IMMEDIATE=0]="IMMEDIATE",e[e.EVENTUAL=1]="EVENTUAL",e}(J1||{}),Pge=new Ye("cdk-focus-monitor-default-options"),Q1=_u({passive:!0,capture:!0}),ic=(()=>{class e{constructor(i,r,n,o,a){this._ngZone=i,this._platform=r,this._inputModalityDetector=n,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Ct,this._rootNodeFocusAndBlurListener=s=>{let c=qs(s);for(let l=c;l;l=l.parentElement)s.type==="focus"?this._onFocus(s,l):this._onBlur(s,l)},this._document=o,this._detectionMode=a?.detectionMode||J1.IMMEDIATE}monitor(i,r=!1){let n=Xs(i);if(!this._platform.isBrowser||n.nodeType!==1)return Dt();let o=A9(n)||this._getDocument(),a=this._elementInfo.get(n);if(a)return r&&(a.checkChildren=!0),a.subject;let s={checkChildren:r,subject:new Ct,rootNode:o};return this._elementInfo.set(n,s),this._registerGlobalListeners(s),s.subject}stopMonitoring(i){let r=Xs(i),n=this._elementInfo.get(r);n&&(n.subject.complete(),this._setClasses(r),this._elementInfo.delete(r),this._removeGlobalListeners(n))}focusVia(i,r,n){let o=Xs(i),a=this._getDocument().activeElement;o===a?this._getClosestElementsInfo(o).forEach(([s,c])=>this._originChanged(s,r,c)):(this._setOrigin(r),typeof o.focus=="function"&&o.focus(n))}ngOnDestroy(){this._elementInfo.forEach((i,r)=>this.stopMonitoring(r))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(i){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(i)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:i&&this._isLastInteractionFromInputLabel(i)?"mouse":"program"}_shouldBeAttributedToTouch(i){return this._detectionMode===J1.EVENTUAL||!!i?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(i,r){i.classList.toggle("cdk-focused",!!r),i.classList.toggle("cdk-touch-focused",r==="touch"),i.classList.toggle("cdk-keyboard-focused",r==="keyboard"),i.classList.toggle("cdk-mouse-focused",r==="mouse"),i.classList.toggle("cdk-program-focused",r==="program")}_setOrigin(i,r=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=i,this._originFromTouchInteraction=i==="touch"&&r,this._detectionMode===J1.IMMEDIATE){clearTimeout(this._originTimeoutId);let n=this._originFromTouchInteraction?z9:1;this._originTimeoutId=setTimeout(()=>this._origin=null,n)}})}_onFocus(i,r){let n=this._elementInfo.get(r),o=qs(i);!n||!n.checkChildren&&r!==o||this._originChanged(r,this._getFocusOrigin(o),n)}_onBlur(i,r){let n=this._elementInfo.get(r);!n||n.checkChildren&&i.relatedTarget instanceof Node&&r.contains(i.relatedTarget)||(this._setClasses(r),this._emitOrigin(n,null))}_emitOrigin(i,r){i.subject.observers.length&&this._ngZone.run(()=>i.subject.next(r))}_registerGlobalListeners(i){if(!this._platform.isBrowser)return;let r=i.rootNode,n=this._rootNodeFocusListenerCount.get(r)||0;n||this._ngZone.runOutsideAngular(()=>{r.addEventListener("focus",this._rootNodeFocusAndBlurListener,Q1),r.addEventListener("blur",this._rootNodeFocusAndBlurListener,Q1)}),this._rootNodeFocusListenerCount.set(r,n+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Ui(this._stopInputModalityDetector)).subscribe(o=>{this._setOrigin(o,!0)}))}_removeGlobalListeners(i){let r=i.rootNode;if(this._rootNodeFocusListenerCount.has(r)){let n=this._rootNodeFocusListenerCount.get(r);n>1?this._rootNodeFocusListenerCount.set(r,n-1):(r.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Q1),r.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Q1),this._rootNodeFocusListenerCount.delete(r))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(i,r,n){this._setClasses(i,r),this._emitOrigin(n,r),this._lastFocusOrigin=r}_getClosestElementsInfo(i){let r=[];return this._elementInfo.forEach((n,o)=>{(o===i||n.checkChildren&&o.contains(i))&&r.push([o,n])}),r}_isLastInteractionFromInputLabel(i){let{_mostRecentTarget:r,mostRecentModality:n}=this._inputModalityDetector;if(n!=="mouse"||!r||r===i||i.nodeName!=="INPUT"&&i.nodeName!=="TEXTAREA"||i.disabled)return!1;let o=i.labels;if(o){for(let a=0;a<o.length;a++)if(o[a].contains(r))return!0}return!1}static{this.\u0275fac=function(r){return new(r||e)(Ae(st),Ae(Pi),Ae(Age),Ae(Bt,8),Ae(Pge,8))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var pp=function(e){return e[e.NONE=0]="NONE",e[e.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",e[e.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",e}(pp||{}),N9="cdk-high-contrast-black-on-white",O9="cdk-high-contrast-white-on-black",tM="cdk-high-contrast-active",H9=(()=>{class e{constructor(i,r){this._platform=i,this._document=r,this._breakpointSubscription=Je(k9).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return pp.NONE;let i=this._document.createElement("div");i.style.backgroundColor="rgb(1,2,3)",i.style.position="absolute",this._document.body.appendChild(i);let r=this._document.defaultView||window,n=r&&r.getComputedStyle?r.getComputedStyle(i):null,o=(n&&n.backgroundColor||"").replace(/ /g,"");switch(i.remove(),o){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return pp.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return pp.BLACK_ON_WHITE}return pp.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let i=this._document.body.classList;i.remove(tM,N9,O9),this._hasCheckedHighContrastMode=!0;let r=this.getHighContrastMode();r===pp.BLACK_ON_WHITE?i.add(tM,N9):r===pp.WHITE_ON_BLACK&&i.add(tM,O9)}}static{this.\u0275fac=function(r){return new(r||e)(Ae(Pi),Ae(Bt))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Nge=["text"],Oge=[[["mat-icon"]],"*"],Rge=["mat-icon","*"];function Fge(e,t){if(e&1&&he(0,"mat-pseudo-checkbox",1),e&2){let i=ae();z("disabled",i.disabled)("state",i.selected?"checked":"unchecked")}}function Lge(e,t){if(e&1&&he(0,"mat-pseudo-checkbox",3),e&2){let i=ae();z("disabled",i.disabled)}}function Bge(e,t){if(e&1&&(C(0,"span",4),W(1),A()),e&2){let i=ae();O(),Qr("(",i.group.label,")")}}var Vge=["mat-internal-form-field",""],zge=["*"];function Uge(){return!0}var Hge=new Ye("mat-sanity-checks",{providedIn:"root",factory:Uge}),Ut=(()=>{class e{constructor(i,r,n){this._sanityChecks=r,this._document=n,this._hasDoneGlobalChecks=!1,i._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(i){return n_()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[i]}static{this.\u0275fac=function(r){return new(r||e)(Ae(H9),Ae(Hge,8),Ae(Bt))}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[vu,vu]})}}return e})();var Bm=class{constructor(t,i,r,n,o){this._defaultMatcher=t,this.ngControl=i,this._parentFormGroup=r,this._parentForm=n,this._stateChanges=o,this.errorState=!1}updateErrorState(){let t=this.errorState,i=this._parentFormGroup||this._parentForm,r=this.matcher||this._defaultMatcher,n=this.ngControl?this.ngControl.control:null,o=r?.isErrorState(n,i)??!1;o!==t&&(this.errorState=o,this._stateChanges.next())}};var s2=(()=>{class e{isErrorState(i,r){return!!(i&&i.invalid&&(i.touched||r&&r.submitted))}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var gM=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Ut,Ut]})}}return e})(),ha=function(e){return e[e.FADING_IN=0]="FADING_IN",e[e.VISIBLE=1]="VISIBLE",e[e.FADING_OUT=2]="FADING_OUT",e[e.HIDDEN=3]="HIDDEN",e}(ha||{}),hM=class{constructor(t,i,r,n=!1){this._renderer=t,this.element=i,this.config=r,this._animationForciblyDisabledThroughCss=n,this.state=ha.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},j9=_u({passive:!0,capture:!0}),pM=class{constructor(){this._events=new Map,this._delegateEventHandler=t=>{let i=qs(t);i&&this._events.get(t.type)?.forEach((r,n)=>{(n===i||n.contains(i))&&r.forEach(o=>o.handleEvent(t))})}}addHandler(t,i,r,n){let o=this._events.get(i);if(o){let a=o.get(r);a?a.add(n):o.set(r,new Set([n]))}else this._events.set(i,new Map([[r,new Set([n])]])),t.runOutsideAngular(()=>{document.addEventListener(i,this._delegateEventHandler,j9)})}removeHandler(t,i,r){let n=this._events.get(t);if(!n)return;let o=n.get(i);o&&(o.delete(r),o.size===0&&n.delete(i),n.size===0&&(this._events.delete(t),document.removeEventListener(t,this._delegateEventHandler,j9)))}},G9={enterDuration:225,exitDuration:150},jge=800,$9=_u({passive:!0,capture:!0}),W9=["mousedown","touchstart"],q9=["mouseup","mouseleave","touchend","touchcancel"],a2=class e{static{this._eventManager=new pM}constructor(t,i,r,n){this._target=t,this._ngZone=i,this._platform=n,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,n.isBrowser&&(this._containerElement=Xs(r))}fadeInRipple(t,i,r={}){let n=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),o=L(L({},G9),r.animation);r.centered&&(t=n.left+n.width/2,i=n.top+n.height/2);let a=r.radius||Gge(t,i,n),s=t-n.left,c=i-n.top,l=o.enterDuration,d=document.createElement("div");d.classList.add("mat-ripple-element"),d.style.left=`${s-a}px`,d.style.top=`${c-a}px`,d.style.height=`${a*2}px`,d.style.width=`${a*2}px`,r.color!=null&&(d.style.backgroundColor=r.color),d.style.transitionDuration=`${l}ms`,this._containerElement.appendChild(d);let u=window.getComputedStyle(d),h=u.transitionProperty,p=u.transitionDuration,m=h==="none"||p==="0s"||p==="0s, 0s"||n.width===0&&n.height===0,f=new hM(this,d,r,m);d.style.transform="scale3d(1, 1, 1)",f.state=ha.FADING_IN,r.persistent||(this._mostRecentTransientRipple=f);let g=null;return!m&&(l||o.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let v=()=>this._finishRippleTransition(f),_=()=>this._destroyRipple(f);d.addEventListener("transitionend",v),d.addEventListener("transitioncancel",_),g={onTransitionEnd:v,onTransitionCancel:_}}),this._activeRipples.set(f,g),(m||!l)&&this._finishRippleTransition(f),f}fadeOutRipple(t){if(t.state===ha.FADING_OUT||t.state===ha.HIDDEN)return;let i=t.element,r=L(L({},G9),t.config.animation);i.style.transitionDuration=`${r.exitDuration}ms`,i.style.opacity="0",t.state=ha.FADING_OUT,(t._animationForciblyDisabledThroughCss||!r.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){let i=Xs(t);!this._platform.isBrowser||!i||i===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=i,W9.forEach(r=>{e._eventManager.addHandler(this._ngZone,r,i,this)}))}handleEvent(t){t.type==="mousedown"?this._onMousedown(t):t.type==="touchstart"?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{q9.forEach(i=>{this._triggerElement.addEventListener(i,this,$9)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){t.state===ha.FADING_IN?this._startFadeOutTransition(t):t.state===ha.FADING_OUT&&this._destroyRipple(t)}_startFadeOutTransition(t){let i=t===this._mostRecentTransientRipple,{persistent:r}=t.config;t.state=ha.VISIBLE,!r&&(!i||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){let i=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=ha.HIDDEN,i!==null&&(t.element.removeEventListener("transitionend",i.onTransitionEnd),t.element.removeEventListener("transitioncancel",i.onTransitionCancel)),t.element.remove()}_onMousedown(t){let i=lM(t),r=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+jge;!this._target.rippleDisabled&&!i&&!r&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!cM(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let i=t.changedTouches;if(i)for(let r=0;r<i.length;r++)this.fadeInRipple(i[r].clientX,i[r].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{let i=t.state===ha.VISIBLE||t.config.terminateOnPointerUp&&t.state===ha.FADING_IN;!t.config.persistent&&i&&t.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let t=this._triggerElement;t&&(W9.forEach(i=>e._eventManager.removeHandler(i,t,this)),this._pointerUpEventsRegistered&&(q9.forEach(i=>t.removeEventListener(i,this,$9)),this._pointerUpEventsRegistered=!1))}};function Gge(e,t,i){let r=Math.max(Math.abs(e-i.left),Math.abs(e-i.right)),n=Math.max(Math.abs(t-i.top),Math.abs(t-i.bottom));return Math.sqrt(r*r+n*n)}var o_=new Ye("mat-ripple-global-options"),Ys=(()=>{class e{get disabled(){return this._disabled}set disabled(i){i&&this.fadeOutAllNonPersistent(),this._disabled=i,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(i){this._trigger=i,this._setupTriggerEventsIfEnabled()}constructor(i,r,n,o,a){this._elementRef=i,this._animationMode=a,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=o||{},this._rippleRenderer=new a2(this,r,i,n)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:L(L(L({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(i,r=0,n){return typeof i=="number"?this._rippleRenderer.fadeInRipple(i,r,L(L({},this.rippleConfig),n)):this._rippleRenderer.fadeInRipple(0,0,L(L({},this.rippleConfig),i))}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(st),G(Pi),G(o_,8),G(pr,8))}}static{this.\u0275dir=xt({type:e,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(r,n){r&2&&It("mat-ripple-unbounded",n.unbounded)},inputs:{color:[_e.None,"matRippleColor","color"],unbounded:[_e.None,"matRippleUnbounded","unbounded"],centered:[_e.None,"matRippleCentered","centered"],radius:[_e.None,"matRippleRadius","radius"],animation:[_e.None,"matRippleAnimation","animation"],disabled:[_e.None,"matRippleDisabled","disabled"],trigger:[_e.None,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0})}}return e})(),Kc=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Ut,Ut]})}}return e})(),vM=(()=>{class e{constructor(i){this._animationMode=i,this.state="unchecked",this.disabled=!1,this.appearance="full"}static{this.\u0275fac=function(r){return new(r||e)(G(pr,8))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(r,n){r&2&&It("mat-pseudo-checkbox-indeterminate",n.state==="indeterminate")("mat-pseudo-checkbox-checked",n.state==="checked")("mat-pseudo-checkbox-disabled",n.disabled)("mat-pseudo-checkbox-minimal",n.appearance==="minimal")("mat-pseudo-checkbox-full",n.appearance==="full")("_mat-animation-noopable",n._animationMode==="NoopAnimations")},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},standalone:!0,features:[ci],decls:0,vars:0,template:function(r,n){},styles:['.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-minimal-pseudo-checkbox-selected-checkmark-color)}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color)}.mat-pseudo-checkbox-full{border-color:var(--mat-full-pseudo-checkbox-unselected-icon-color);border-width:2px;border-style:solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-disabled{border-color:var(--mat-full-pseudo-checkbox-disabled-unselected-icon-color)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{background-color:var(--mat-full-pseudo-checkbox-selected-icon-color);border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-full-pseudo-checkbox-selected-checkmark-color)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled{background-color:var(--mat-full-pseudo-checkbox-disabled-selected-icon-color)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-full-pseudo-checkbox-disabled-selected-checkmark-color)}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}'],encapsulation:2,changeDetection:0})}}return e})(),_M=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Ut]})}}return e})(),bM=new Ye("MAT_OPTION_PARENT_COMPONENT");var yM=new Ye("MatOptgroup");var $ge=0,fM=class{constructor(t,i=!1){this.source=t,this.isUserInput=i}},Um=(()=>{class e{get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(i){this._disabled=i}get disableRipple(){return!!(this._parent&&this._parent.disableRipple)}get hideSingleSelectionIndicator(){return!!(this._parent&&this._parent.hideSingleSelectionIndicator)}constructor(i,r,n,o){this._element=i,this._changeDetectorRef=r,this._parent=n,this.group=o,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id=`mat-option-${$ge++}`,this.onSelectionChange=new We,this._stateChanges=new Ct}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(i=!0){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),i&&this._emitSelectionChangeEvent())}deselect(i=!0){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),i&&this._emitSelectionChangeEvent())}focus(i,r){let n=this._getHostElement();typeof n.focus=="function"&&n.focus(r)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(i){(i.keyCode===13||i.keyCode===32)&&!us(i)&&(this._selectViaInteraction(),i.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=this.multiple?!this._selected:!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){let i=this.viewValue;i!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=i)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(i=!1){this.onSelectionChange.emit(new fM(this,i))}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(ei),G(bM,8),G(yM,8))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-option"]],viewQuery:function(r,n){if(r&1&&ht(Nge,7),r&2){let o;Ve(o=ze())&&(n._text=o.first)}},hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(r,n){r&1&&Y("click",function(){return n._selectViaInteraction()})("keydown",function(a){return n._handleKeydown(a)}),r&2&&(Dl("id",n.id),Zt("aria-selected",n.selected)("aria-disabled",n.disabled.toString()),It("mdc-list-item--selected",n.selected)("mat-mdc-option-multiple",n.multiple)("mat-mdc-option-active",n.active)("mdc-list-item--disabled",n.disabled))},inputs:{value:"value",id:"id",disabled:[_e.HasDecoratorInputTransform,"disabled","disabled",yt]},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],standalone:!0,features:[Hi,ci],ngContentSelectors:Rge,decls:8,vars:5,consts:[["text",""],["aria-hidden","true",1,"mat-mdc-option-pseudo-checkbox",3,"disabled","state"],[1,"mdc-list-item__primary-text"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"],["aria-hidden","true","mat-ripple","",1,"mat-mdc-option-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled"]],template:function(r,n){r&1&&(vi(Oge),Be(0,Fge,1,2,"mat-pseudo-checkbox",1),gt(1),C(2,"span",2,0),gt(4,1),A(),Be(5,Lge,1,1,"mat-pseudo-checkbox",3)(6,Bge,2,1,"span",4),he(7,"div",5)),r&2&&(Ni(0,n.multiple?0:-1),O(5),Ni(5,!n.multiple&&n.selected&&!n.hideSingleSelectionIndicator?5:-1),O(),Ni(6,n.group&&n.group._inert?6:-1),O(),z("matRippleTrigger",n._getHostElement())("matRippleDisabled",n.disabled||n.disableRipple))},dependencies:[vM,Ys],styles:['.mat-mdc-option{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:16px;padding-right:16px;-webkit-user-select:none;user-select:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);color:var(--mat-option-label-text-color);font-family:var(--mat-option-label-text-font);line-height:var(--mat-option-label-text-line-height);font-size:var(--mat-option-label-text-size);letter-spacing:var(--mat-option-label-text-tracking);font-weight:var(--mat-option-label-text-weight);min-height:48px}.mat-mdc-option:focus{outline:none}[dir=rtl] .mat-mdc-option,.mat-mdc-option[dir=rtl]{padding-left:16px;padding-right:16px}.mat-mdc-option:hover:not(.mdc-list-item--disabled){background-color:var(--mat-option-hover-state-layer-color)}.mat-mdc-option:focus.mdc-list-item,.mat-mdc-option.mat-mdc-option-active.mdc-list-item{background-color:var(--mat-option-focus-state-layer-color)}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled) .mdc-list-item__primary-text{color:var(--mat-option-selected-state-label-text-color)}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-multiple){background-color:var(--mat-option-selected-state-layer-color)}.mat-mdc-option.mdc-list-item{align-items:center;background:rgba(0,0,0,0)}.mat-mdc-option.mdc-list-item--disabled{cursor:default;pointer-events:none}.mat-mdc-option.mdc-list-item--disabled .mat-mdc-option-pseudo-checkbox,.mat-mdc-option.mdc-list-item--disabled .mdc-list-item__primary-text,.mat-mdc-option.mdc-list-item--disabled>mat-icon{opacity:.38}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}.cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{right:auto;left:16px}.mat-mdc-option-multiple{--mdc-list-list-item-selected-container-color:var(--mdc-list-list-item-container-color, transparent)}.mat-mdc-option-active .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}}return e})();function K9(e,t,i){if(i.length){let r=t.toArray(),n=i.toArray(),o=0;for(let a=0;a<e+1;a++)r[a].group&&r[a].group===n[o]&&o++;return o}return 0}function Q9(e,t,i,r){return e<i?e:e+t>i+r?Math.max(0,e-r+t):i}var xM=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Kc,Ut,_M]})}}return e})(),X9={capture:!0},Y9=["focus","click","mouseenter","touchstart"],dM="mat-ripple-loader-uninitialized",uM="mat-ripple-loader-class-name",Z9="mat-ripple-loader-centered",o2="mat-ripple-loader-disabled",J9=(()=>{class e{constructor(){this._document=Je(Bt,{optional:!0}),this._animationMode=Je(pr,{optional:!0}),this._globalRippleOptions=Je(o_,{optional:!0}),this._platform=Je(Pi),this._ngZone=Je(st),this._hosts=new Map,this._onInteraction=i=>{if(!(i.target instanceof HTMLElement))return;let n=i.target.closest(`[${dM}]`);n&&this._createRipple(n)},this._ngZone.runOutsideAngular(()=>{for(let i of Y9)this._document?.addEventListener(i,this._onInteraction,X9)})}ngOnDestroy(){let i=this._hosts.keys();for(let r of i)this.destroyRipple(r);for(let r of Y9)this._document?.removeEventListener(r,this._onInteraction,X9)}configureRipple(i,r){i.setAttribute(dM,""),(r.className||!i.hasAttribute(uM))&&i.setAttribute(uM,r.className||""),r.centered&&i.setAttribute(Z9,""),r.disabled&&i.setAttribute(o2,"")}getRipple(i){return this._hosts.get(i)||this._createRipple(i)}setDisabled(i,r){let n=this._hosts.get(i);if(n){n.disabled=r;return}r?i.setAttribute(o2,""):i.removeAttribute(o2)}_createRipple(i){if(!this._document)return;let r=this._hosts.get(i);if(r)return r;i.querySelector(".mat-ripple")?.remove();let n=this._document.createElement("span");n.classList.add("mat-ripple",i.getAttribute(uM)),i.append(n);let o=new Ys(new vt(n),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return o._isInitialized=!0,o.trigger=i,o.centered=i.hasAttribute(Z9),o.disabled=i.hasAttribute(o2),this.attachRipple(i,o),o}attachRipple(i,r){i.removeAttribute(dM),this._hosts.set(i,r)}destroyRipple(i){let r=this._hosts.get(i);r&&(r.ngOnDestroy(),this._hosts.delete(i))}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),l2=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=Le({type:e,selectors:[["div","mat-internal-form-field",""]],hostAttrs:[1,"mdc-form-field","mat-internal-form-field"],hostVars:2,hostBindings:function(r,n){r&2&&It("mdc-form-field--align-end",n.labelPosition==="before")},inputs:{labelPosition:"labelPosition"},standalone:!0,features:[ci],attrs:Vge,ngContentSelectors:zge,decls:1,vars:0,template:function(r,n){r&1&&(vi(),gt(0))},styles:[".mdc-form-field{display:inline-flex;align-items:center;vertical-align:middle}.mdc-form-field[hidden]{display:none}.mdc-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{margin-left:auto;margin-right:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{padding-left:0;padding-right:4px}.mdc-form-field--nowrap>label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{padding-left:4px;padding-right:0}.mdc-form-field--space-between{justify-content:space-between}.mdc-form-field--space-between>label{margin:0}[dir=rtl] .mdc-form-field--space-between>label,.mdc-form-field--space-between>label[dir=rtl]{margin:0}.mdc-form-field{font-family:var(--mdc-form-field-label-text-font);line-height:var(--mdc-form-field-label-text-line-height);font-size:var(--mdc-form-field-label-text-size);font-weight:var(--mdc-form-field-label-text-weight);letter-spacing:var(--mdc-form-field-label-text-tracking);color:var(--mdc-form-field-label-text-color)}.mat-internal-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}"],encapsulation:2,changeDetection:0})}}return e})();var Wge=["notch"],qge=["matFormFieldNotchedOutline",""],Xge=["*"],Yge=["textField"],Zge=["iconPrefixContainer"],Kge=["textPrefixContainer"],Qge=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],Jge=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function eve(e,t){e&1&&he(0,"span",17)}function tve(e,t){if(e&1&&(C(0,"label",16),gt(1,1),Be(2,eve,1,0,"span",17),A()),e&2){let i=ae(2);z("floating",i._shouldLabelFloat())("monitorResize",i._hasOutline())("id",i._labelId),Zt("for",i._control.disableAutomaticLabeling?null:i._control.id),O(2),Ni(2,!i.hideRequiredMarker&&i._control.required?2:-1)}}function ive(e,t){if(e&1&&Be(0,tve,3,5,"label",16),e&2){let i=ae();Ni(0,i._hasFloatingLabel()?0:-1)}}function rve(e,t){e&1&&he(0,"div",5)}function nve(e,t){}function ove(e,t){if(e&1&&Be(0,nve,0,0,"ng-template",11),e&2){ae(2);let i=Ft(1);z("ngTemplateOutlet",i)}}function ave(e,t){if(e&1&&(C(0,"div",7),Be(1,ove,1,1,null,11),A()),e&2){let i=ae();z("matFormFieldNotchedOutlineOpen",i._shouldLabelFloat()),O(),Ni(1,i._forceDisplayInfixLabel()?-1:1)}}function sve(e,t){e&1&&(C(0,"div",8,2),gt(2,2),A())}function lve(e,t){e&1&&(C(0,"div",9,3),gt(2,3),A())}function cve(e,t){}function dve(e,t){if(e&1&&Be(0,cve,0,0,"ng-template",11),e&2){ae();let i=Ft(1);z("ngTemplateOutlet",i)}}function uve(e,t){e&1&&(C(0,"div",12),gt(1,4),A())}function hve(e,t){e&1&&(C(0,"div",13),gt(1,5),A())}function pve(e,t){e&1&&he(0,"div",14)}function fve(e,t){if(e&1&&(C(0,"div",18),gt(1,6),A()),e&2){let i=ae();z("@transitionMessages",i._subscriptAnimationState)}}function mve(e,t){if(e&1&&(C(0,"mat-hint",20),W(1),A()),e&2){let i=ae(2);z("id",i._hintLabelId),O(),Pr(i.hintLabel)}}function gve(e,t){if(e&1&&(C(0,"div",19),Be(1,mve,2,2,"mat-hint",20),gt(2,7),he(3,"div",21),gt(4,8),A()),e&2){let i=ae();z("@transitionMessages",i._subscriptAnimationState),O(),Ni(1,i.hintLabel?1:-1)}}var rc=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=xt({type:e,selectors:[["mat-label"]],standalone:!0})}}return e})();var vve=new Ye("MatError");var _ve=0,eH=(()=>{class e{constructor(){this.align="start",this.id=`mat-mdc-hint-${_ve++}`}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=xt({type:e,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(r,n){r&2&&(Dl("id",n.id),Zt("align",null),It("mat-mdc-form-field-hint-end",n.align==="end"))},inputs:{align:"align",id:"id"},standalone:!0})}}return e})(),bve=new Ye("MatPrefix");var yve=new Ye("MatSuffix");var lH=new Ye("FloatingLabelParent"),tH=(()=>{class e{get floating(){return this._floating}set floating(i){this._floating=i,this.monitorResize&&this._handleResize()}get monitorResize(){return this._monitorResize}set monitorResize(i){this._monitorResize=i,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}constructor(i){this._elementRef=i,this._floating=!1,this._monitorResize=!1,this._resizeObserver=Je(D9),this._ngZone=Je(st),this._parent=Je(lH),this._resizeSubscription=new fn}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return xve(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}static{this.\u0275fac=function(r){return new(r||e)(G(vt))}}static{this.\u0275dir=xt({type:e,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(r,n){r&2&&It("mdc-floating-label--float-above",n.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"},standalone:!0})}}return e})();function xve(e){let t=e;if(t.offsetParent!==null)return t.scrollWidth;let i=t.cloneNode(!0);i.style.setProperty("position","absolute"),i.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(i);let r=i.scrollWidth;return i.remove(),r}var iH="mdc-line-ripple--active",d2="mdc-line-ripple--deactivating",rH=(()=>{class e{constructor(i,r){this._elementRef=i,this._handleTransitionEnd=n=>{let o=this._elementRef.nativeElement.classList,a=o.contains(d2);n.propertyName==="opacity"&&a&&o.remove(iH,d2)},r.runOutsideAngular(()=>{i.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){let i=this._elementRef.nativeElement.classList;i.remove(d2),i.add(iH)}deactivate(){this._elementRef.nativeElement.classList.add(d2)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(st))}}static{this.\u0275dir=xt({type:e,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"],standalone:!0})}}return e})(),nH=(()=>{class e{constructor(i,r){this._elementRef=i,this._ngZone=r,this.open=!1}ngAfterViewInit(){let i=this._elementRef.nativeElement.querySelector(".mdc-floating-label");i?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),typeof requestAnimationFrame=="function"&&(i.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>i.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(i){!this.open||!i?this._notch.nativeElement.style.width="":this._notch.nativeElement.style.width=`calc(${i}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(st))}}static{this.\u0275cmp=Le({type:e,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(r,n){if(r&1&&ht(Wge,5),r&2){let o;Ve(o=ze())&&(n._notch=o.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(r,n){r&2&&It("mdc-notched-outline--notched",n.open)},inputs:{open:[_e.None,"matFormFieldNotchedOutlineOpen","open"]},standalone:!0,features:[ci],attrs:qge,ngContentSelectors:Xge,decls:5,vars:0,consts:[["notch",""],[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],[1,"mdc-notched-outline__trailing"]],template:function(r,n){r&1&&(vi(),he(0,"div",1),C(1,"div",2,0),gt(3),A(),he(4,"div",3))},encapsulation:2,changeDetection:0})}}return e})(),wve={transitionMessages:Pl("transitionMessages",[Cs("enter",Ko({opacity:1,transform:"translateY(0%)"})),Ss("void => enter",[Ko({opacity:0,transform:"translateY(-5px)"}),ll("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},a_=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=xt({type:e})}}return e})();var s_=new Ye("MatFormField"),Eve=new Ye("MAT_FORM_FIELD_DEFAULT_OPTIONS"),oH=0,aH="fill",Cve="auto",sH="fixed",Sve="translateY(-50%)",Hm=(()=>{class e{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(i){this._hideRequiredMarker=Lo(i)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||Cve}set floatLabel(i){i!==this._floatLabel&&(this._floatLabel=i,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(i){let r=this._appearance,n=i||this._defaults?.appearance||aH;this._appearance=n,this._appearance==="outline"&&this._appearance!==r&&(this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||sH}set subscriptSizing(i){this._subscriptSizing=i||this._defaults?.subscriptSizing||sH}get hintLabel(){return this._hintLabel}set hintLabel(i){this._hintLabel=i,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(i){this._explicitFormFieldControl=i}constructor(i,r,n,o,a,s,c,l){this._elementRef=i,this._changeDetectorRef=r,this._ngZone=n,this._dir=o,this._platform=a,this._defaults=s,this._animationMode=c,this._hideRequiredMarker=!1,this.color="primary",this._appearance=aH,this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId=`mat-mdc-form-field-label-${oH++}`,this._hintLabelId=`mat-mdc-hint-${oH++}`,this._subscriptAnimationState="",this._destroyed=new Ct,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,s&&(s.appearance&&(this.appearance=s.appearance),this._hideRequiredMarker=!!s?.hideRequiredMarker,s.color&&(this.color=s.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){let i=this._control;i.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${i.controlType}`),i.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),i.ngControl&&i.ngControl.valueChanges&&i.ngControl.valueChanges.pipe(Ui(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(i=>!i._isText),this._hasTextPrefix=!!this._prefixChildren.find(i=>i._isText),this._hasIconSuffix=!!this._suffixChildren.find(i=>!i._isText),this._hasTextSuffix=!!this._suffixChildren.find(i=>i._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),So(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){this._control}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||this._isFocused===null)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(Ui(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe(Ui(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return this.floatLabel==="always"}_hasOutline(){return this.appearance==="outline"}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(i){let r=this._control?this._control.ngControl:null;return r&&r[i]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||!this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(0):this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){this._hintChildren}_syncDescribedByIds(){if(this._control){let i=[];if(this._control.userAriaDescribedBy&&typeof this._control.userAriaDescribedBy=="string"&&i.push(...this._control.userAriaDescribedBy.split(" ")),this._getDisplayedMessages()==="hint"){let r=this._hintChildren?this._hintChildren.find(o=>o.align==="start"):null,n=this._hintChildren?this._hintChildren.find(o=>o.align==="end"):null;r?i.push(r.id):this._hintLabel&&i.push(this._hintLabelId),n&&i.push(n.id)}else this._errorChildren&&i.push(...this._errorChildren.map(r=>r.id));this._control.setDescribedByIds(i)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;let i=this._floatingLabel.element;if(!(this._iconPrefixContainer||this._textPrefixContainer)){i.style.transform="";return}if(!this._isAttachedToDom()){this._needsOutlineLabelOffsetUpdateOnStable=!0;return}let r=this._iconPrefixContainer?.nativeElement,n=this._textPrefixContainer?.nativeElement,o=r?.getBoundingClientRect().width??0,a=n?.getBoundingClientRect().width??0,s=this._dir.value==="rtl"?"-1":"1",c=`${o+a}px`,d=`calc(${s} * (${c} + var(--mat-mdc-form-field-label-offset-x, 0px)))`;i.style.transform=`var(
        --mat-mdc-form-field-label-transform,
        ${Sve} translateX(${d})
    )`}_isAttachedToDom(){let i=this._elementRef.nativeElement;if(i.getRootNode){let r=i.getRootNode();return r&&r!==i}return document.documentElement.contains(i)}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(ei),G(st),G(ds),G(Pi),G(Eve,8),G(pr,8),G(Bt))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-form-field"]],contentQueries:function(r,n,o){if(r&1&&(Xi(o,rc,5),Xi(o,rc,7),Xi(o,a_,5),Xi(o,bve,5),Xi(o,yve,5),Xi(o,vve,5),Xi(o,eH,5)),r&2){let a;Ve(a=ze())&&(n._labelChildNonStatic=a.first),Ve(a=ze())&&(n._labelChildStatic=a.first),Ve(a=ze())&&(n._formFieldControl=a.first),Ve(a=ze())&&(n._prefixChildren=a),Ve(a=ze())&&(n._suffixChildren=a),Ve(a=ze())&&(n._errorChildren=a),Ve(a=ze())&&(n._hintChildren=a)}},viewQuery:function(r,n){if(r&1&&(ht(Yge,5),ht(Zge,5),ht(Kge,5),ht(tH,5),ht(nH,5),ht(rH,5)),r&2){let o;Ve(o=ze())&&(n._textField=o.first),Ve(o=ze())&&(n._iconPrefixContainer=o.first),Ve(o=ze())&&(n._textPrefixContainer=o.first),Ve(o=ze())&&(n._floatingLabel=o.first),Ve(o=ze())&&(n._notchedOutline=o.first),Ve(o=ze())&&(n._lineRipple=o.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(r,n){r&2&&It("mat-mdc-form-field-label-always-float",n._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",n._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",n._hasIconSuffix)("mat-form-field-invalid",n._control.errorState)("mat-form-field-disabled",n._control.disabled)("mat-form-field-autofilled",n._control.autofilled)("mat-form-field-no-animations",n._animationMode==="NoopAnimations")("mat-form-field-appearance-fill",n.appearance=="fill")("mat-form-field-appearance-outline",n.appearance=="outline")("mat-form-field-hide-placeholder",n._hasFloatingLabel()&&!n._shouldLabelFloat())("mat-focused",n._control.focused)("mat-primary",n.color!=="accent"&&n.color!=="warn")("mat-accent",n.color==="accent")("mat-warn",n.color==="warn")("ng-untouched",n._shouldForward("untouched"))("ng-touched",n._shouldForward("touched"))("ng-pristine",n._shouldForward("pristine"))("ng-dirty",n._shouldForward("dirty"))("ng-valid",n._shouldForward("valid"))("ng-invalid",n._shouldForward("invalid"))("ng-pending",n._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],standalone:!0,features:[Li([{provide:s_,useExisting:e},{provide:lH,useExisting:e}]),ci],ngContentSelectors:Jge,decls:18,vars:21,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(r,n){if(r&1){let o=Ze();vi(Qge),Be(0,ive,1,1,"ng-template",null,0,Ku),C(2,"div",4,1),Y("click",function(s){return q(o),X(n._control.onContainerClick(s))}),Be(4,rve,1,0,"div",5),C(5,"div",6),Be(6,ave,2,2,"div",7)(7,sve,3,0,"div",8)(8,lve,3,0,"div",9),C(9,"div",10),Be(10,dve,1,1,null,11),gt(11),A(),Be(12,uve,2,0,"div",12)(13,hve,2,0,"div",13),A(),Be(14,pve,1,0,"div",14),A(),C(15,"div",15),Be(16,fve,2,1)(17,gve,5,2),A()}if(r&2){let o;O(2),It("mdc-text-field--filled",!n._hasOutline())("mdc-text-field--outlined",n._hasOutline())("mdc-text-field--no-label",!n._hasFloatingLabel())("mdc-text-field--disabled",n._control.disabled)("mdc-text-field--invalid",n._control.errorState),O(2),Ni(4,!n._hasOutline()&&!n._control.disabled?4:-1),O(2),Ni(6,n._hasOutline()?6:-1),O(),Ni(7,n._hasIconPrefix?7:-1),O(),Ni(8,n._hasTextPrefix?8:-1),O(2),Ni(10,!n._hasOutline()||n._forceDisplayInfixLabel()?10:-1),O(2),Ni(12,n._hasTextSuffix?12:-1),O(),Ni(13,n._hasIconSuffix?13:-1),O(),Ni(14,n._hasOutline()?-1:14),O(),It("mat-mdc-form-field-subscript-dynamic-size",n.subscriptSizing==="dynamic"),O(),Ni(16,(o=n._getDisplayedMessages())==="error"?16:o==="hint"?17:-1)}},dependencies:[tH,nH,th,rH,eH],styles:['.mdc-text-field{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 96px/0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;pointer-events:none}.mdc-notched-outline__trailing{flex-grow:1}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-top:1px solid;border-bottom:1px solid}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{max-width:calc(100% - 12px*2)}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-text-field--filled{border-top-left-radius:var(--mdc-filled-text-field-container-shape);border-top-right-radius:var(--mdc-filled-text-field-container-shape);border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-caret-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-focus-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-hover-label-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-disabled-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-focus-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-hover-label-text-color)}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font);font-size:var(--mdc-filled-text-field-label-text-size);font-weight:var(--mdc-filled-text-field-label-text-weight);letter-spacing:var(--mdc-filled-text-field-label-text-tracking)}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color)}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color)}.mdc-text-field--filled .mdc-line-ripple::before{border-bottom-width:var(--mdc-filled-text-field-active-indicator-height)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-caret-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-focus-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-hover-label-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-disabled-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-focus-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-hover-label-text-color)}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font);font-size:var(--mdc-outlined-text-field-label-text-size);font-weight:var(--mdc-outlined-text-field-label-text-weight);letter-spacing:var(--mdc-outlined-text-field-label-text-tracking)}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(.75*var(--mdc-outlined-text-field-label-text-size))}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mdc-outlined-text-field-label-text-size)}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-outlined-text-field-container-shape))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-hover-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-focus-outline-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-disabled-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-hover-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-focus-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-outline-width)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-focus-outline-width)}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height);padding-top:var(--mat-form-field-filled-with-label-container-padding-top);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding);padding-bottom:var(--mat-form-field-container-vertical-padding)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color)}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font);line-height:var(--mat-form-field-subscript-text-line-height);font-size:var(--mat-form-field-subscript-text-size);letter-spacing:var(--mat-form-field-subscript-text-tracking);font-weight:var(--mat-form-field-subscript-text-weight)}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color)}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity)}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color)}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color)}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font);line-height:var(--mat-form-field-container-text-line-height);font-size:var(--mat-form-field-container-text-size);letter-spacing:var(--mat-form-field-container-text-tracking);font-weight:var(--mat-form-field-container-text-weight)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color)}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color)}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color)}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color)}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color)}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[wve.transitionMessages]},changeDetection:0})}}return e})(),fp=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Ut,To,K1,Ut]})}}return e})();var jm=class{get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(t=!1,i,r=!0,n){this._multiple=t,this._emitChanges=r,this.compareWith=n,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new Ct,i&&i.length&&(t?i.forEach(o=>this._markSelected(o)):this._markSelected(i[0]),this._selectedToEmit.length=0)}select(...t){this._verifyValueAssignment(t),t.forEach(r=>this._markSelected(r));let i=this._hasQueuedChanges();return this._emitChangeEvent(),i}deselect(...t){this._verifyValueAssignment(t),t.forEach(r=>this._unmarkSelected(r));let i=this._hasQueuedChanges();return this._emitChangeEvent(),i}setSelection(...t){this._verifyValueAssignment(t);let i=this.selected,r=new Set(t);t.forEach(o=>this._markSelected(o)),i.filter(o=>!r.has(this._getConcreteValue(o,r))).forEach(o=>this._unmarkSelected(o));let n=this._hasQueuedChanges();return this._emitChangeEvent(),n}toggle(t){return this.isSelected(t)?this.deselect(t):this.select(t)}clear(t=!0){this._unmarkAll();let i=this._hasQueuedChanges();return t&&this._emitChangeEvent(),i}isSelected(t){return this._selection.has(this._getConcreteValue(t))}isEmpty(){return this._selection.size===0}hasValue(){return!this.isEmpty()}sort(t){this._multiple&&this.selected&&this._selected.sort(t)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(t){t=this._getConcreteValue(t),this.isSelected(t)||(this._multiple||this._unmarkAll(),this.isSelected(t)||this._selection.add(t),this._emitChanges&&this._selectedToEmit.push(t))}_unmarkSelected(t){t=this._getConcreteValue(t),this.isSelected(t)&&(this._selection.delete(t),this._emitChanges&&this._deselectedToEmit.push(t))}_unmarkAll(){this.isEmpty()||this._selection.forEach(t=>this._unmarkSelected(t))}_verifyValueAssignment(t){t.length>1&&this._multiple}_hasQueuedChanges(){return!!(this._deselectedToEmit.length||this._selectedToEmit.length)}_getConcreteValue(t,i){if(this.compareWith){i=i??this._selection;for(let r of i)if(this.compareWith(t,r))return r;return t}else return t}};var h2=(()=>{class e{constructor(){this._listeners=[]}notify(i,r){for(let n of this._listeners)n(i,r)}listen(i){return this._listeners.push(i),()=>{this._listeners=this._listeners.filter(r=>i!==r)}}ngOnDestroy(){this._listeners=[]}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Tve=20,l_=(()=>{class e{constructor(i,r,n){this._ngZone=i,this._platform=r,this._scrolled=new Ct,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=n}register(i){this.scrollContainers.has(i)||this.scrollContainers.set(i,i.elementScrolled().subscribe(()=>this._scrolled.next(i)))}deregister(i){let r=this.scrollContainers.get(i);r&&(r.unsubscribe(),this.scrollContainers.delete(i))}scrolled(i=Tve){return this._platform.isBrowser?new al(r=>{this._globalSubscription||this._addGlobalListener();let n=i>0?this._scrolled.pipe(aC(i)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{n.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Dt()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((i,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(i,r){let n=this.getAncestorScrollContainers(i);return this.scrolled(r).pipe(Ji(o=>!o||n.indexOf(o)>-1))}getAncestorScrollContainers(i){let r=[];return this.scrollContainers.forEach((n,o)=>{this._scrollableContainsElement(o,i)&&r.push(o)}),r}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(i,r){let n=Xs(r),o=i.getElementRef().nativeElement;do if(n==o)return!0;while(n=n.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{let i=this._getWindow();return ya(i.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static{this.\u0275fac=function(r){return new(r||e)(Ae(st),Ae(Pi),Ae(Bt,8))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),p2=(()=>{class e{constructor(i,r,n,o){this.elementRef=i,this.scrollDispatcher=r,this.ngZone=n,this.dir=o,this._destroyed=new Ct,this._elementScrolled=new al(a=>this.ngZone.runOutsideAngular(()=>ya(this.elementRef.nativeElement,"scroll").pipe(Ui(this._destroyed)).subscribe(a)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(i){let r=this.elementRef.nativeElement,n=this.dir&&this.dir.value=="rtl";i.left==null&&(i.left=n?i.end:i.start),i.right==null&&(i.right=n?i.start:i.end),i.bottom!=null&&(i.top=r.scrollHeight-r.clientHeight-i.bottom),n&&Om()!=yl.NORMAL?(i.left!=null&&(i.right=r.scrollWidth-r.clientWidth-i.left),Om()==yl.INVERTED?i.left=i.right:Om()==yl.NEGATED&&(i.left=i.right?-i.right:i.right)):i.right!=null&&(i.left=r.scrollWidth-r.clientWidth-i.right),this._applyScrollToOptions(i)}_applyScrollToOptions(i){let r=this.elementRef.nativeElement;Z1()?r.scrollTo(i):(i.top!=null&&(r.scrollTop=i.top),i.left!=null&&(r.scrollLeft=i.left))}measureScrollOffset(i){let r="left",n="right",o=this.elementRef.nativeElement;if(i=="top")return o.scrollTop;if(i=="bottom")return o.scrollHeight-o.clientHeight-o.scrollTop;let a=this.dir&&this.dir.value=="rtl";return i=="start"?i=a?n:r:i=="end"&&(i=a?r:n),a&&Om()==yl.INVERTED?i==r?o.scrollWidth-o.clientWidth-o.scrollLeft:o.scrollLeft:a&&Om()==yl.NEGATED?i==r?o.scrollLeft+o.scrollWidth-o.clientWidth:-o.scrollLeft:i==r?o.scrollLeft:o.scrollWidth-o.clientWidth-o.scrollLeft}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(l_),G(st),G(ds,8))}}static{this.\u0275dir=xt({type:e,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0})}}return e})(),Ave=20,gp=(()=>{class e{constructor(i,r,n){this._platform=i,this._change=new Ct,this._changeListener=o=>{this._change.next(o)},this._document=n,r.runOutsideAngular(()=>{if(i.isBrowser){let o=this._getWindow();o.addEventListener("resize",this._changeListener),o.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let i=this._getWindow();i.removeEventListener("resize",this._changeListener),i.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let i={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),i}getViewportRect(){let i=this.getViewportScrollPosition(),{width:r,height:n}=this.getViewportSize();return{top:i.top,left:i.left,bottom:i.top+n,right:i.left+r,height:n,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let i=this._document,r=this._getWindow(),n=i.documentElement,o=n.getBoundingClientRect(),a=-o.top||i.body.scrollTop||r.scrollY||n.scrollTop||0,s=-o.left||i.body.scrollLeft||r.scrollX||n.scrollLeft||0;return{top:a,left:s}}change(i=Ave){return i>0?this._change.pipe(aC(i)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let i=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:i.innerWidth,height:i.innerHeight}:{width:0,height:0}}static{this.\u0275fac=function(r){return new(r||e)(Ae(Pi),Ae(st),Ae(Bt,8))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var mp=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({})}}return e})(),wM=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[vu,mp,vu,mp]})}}return e})();var c_=class{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;t!=null&&(this._attachedHost=null,t.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(t){this._attachedHost=t}},CM=class extends c_{constructor(t,i,r,n,o){super(),this.component=t,this.viewContainerRef=i,this.injector=r,this.componentFactoryResolver=n,this.projectableNodes=o}},vp=class extends c_{constructor(t,i,r,n){super(),this.templateRef=t,this.viewContainerRef=i,this.context=r,this.injector=n}get origin(){return this.templateRef.elementRef}attach(t,i=this.context){return this.context=i,super.attach(t)}detach(){return this.context=void 0,super.detach()}},SM=class extends c_{constructor(t){super(),this.element=t instanceof vt?t.nativeElement:t}},f2=class{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){if(t instanceof CM)return this._attachedPortal=t,this.attachComponentPortal(t);if(t instanceof vp)return this._attachedPortal=t,this.attachTemplatePortal(t);if(this.attachDomPortal&&t instanceof SM)return this._attachedPortal=t,this.attachDomPortal(t)}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var m2=class extends f2{constructor(t,i,r,n,o){super(),this.outletElement=t,this._componentFactoryResolver=i,this._appRef=r,this._defaultInjector=n,this.attachDomPortal=a=>{this._document;let s=a.element;s.parentNode;let c=this._document.createComment("dom-portal");s.parentNode.insertBefore(c,s),this.outletElement.appendChild(s),this._attachedPortal=a,super.setDisposeFn(()=>{c.parentNode&&c.parentNode.replaceChild(s,c)})},this._document=o}attachComponentPortal(t){let r=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),n;return t.viewContainerRef?(n=t.viewContainerRef.createComponent(r,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector,t.projectableNodes||void 0),this.setDisposeFn(()=>n.destroy())):(n=r.create(t.injector||this._defaultInjector||Ea.NULL),this._appRef.attachView(n.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(n.hostView),n.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(n)),this._attachedPortal=t,n}attachTemplatePortal(t){let i=t.viewContainerRef,r=i.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return r.rootNodes.forEach(n=>this.outletElement.appendChild(n)),r.detectChanges(),this.setDisposeFn(()=>{let n=i.indexOf(r);n!==-1&&i.remove(n)}),this._attachedPortal=t,r}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}};var dH=(()=>{class e extends f2{constructor(i,r,n){super(),this._componentFactoryResolver=i,this._viewContainerRef=r,this._isInitialized=!1,this.attached=new We,this.attachDomPortal=o=>{this._document;let a=o.element;a.parentNode;let s=this._document.createComment("dom-portal");o.setAttachedHost(this),a.parentNode.insertBefore(s,a),this._getRootNode().appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{s.parentNode&&s.parentNode.replaceChild(a,s)})},this._document=n}get portal(){return this._attachedPortal}set portal(i){this.hasAttached()&&!i&&!this._isInitialized||(this.hasAttached()&&super.detach(),i&&super.attach(i),this._attachedPortal=i||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(i){i.setAttachedHost(this);let r=i.viewContainerRef!=null?i.viewContainerRef:this._viewContainerRef,o=(i.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(i.component),a=r.createComponent(o,r.length,i.injector||r.injector,i.projectableNodes||void 0);return r!==this._viewContainerRef&&this._getRootNode().appendChild(a.hostView.rootNodes[0]),super.setDisposeFn(()=>a.destroy()),this._attachedPortal=i,this._attachedRef=a,this.attached.emit(a),a}attachTemplatePortal(i){i.setAttachedHost(this);let r=this._viewContainerRef.createEmbeddedView(i.templateRef,i.context,{injector:i.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=i,this._attachedRef=r,this.attached.emit(r),r}_getRootNode(){let i=this._viewContainerRef.element.nativeElement;return i.nodeType===i.ELEMENT_NODE?i:i.parentNode}static{this.\u0275fac=function(r){return new(r||e)(G(qp),G(sl),G(Bt))}}static{this.\u0275dir=xt({type:e,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[_e.None,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],standalone:!0,features:[Yt]})}}return e})();var g2=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({})}}return e})();var uH=Z1(),TM=class{constructor(t,i){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=i}attach(){}enable(){if(this._canBeEnabled()){let t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=Sn(-this._previousScrollPosition.left),t.style.top=Sn(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let t=this._document.documentElement,i=this._document.body,r=t.style,n=i.style,o=r.scrollBehavior||"",a=n.scrollBehavior||"";this._isEnabled=!1,r.left=this._previousHTMLStyles.left,r.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),uH&&(r.scrollBehavior=n.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),uH&&(r.scrollBehavior=o,n.scrollBehavior=a)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let i=this._document.body,r=this._viewportRuler.getViewportSize();return i.scrollHeight>r.height||i.scrollWidth>r.width}};var AM=class{constructor(t,i,r,n){this._scrollDispatcher=t,this._ngZone=i,this._viewportRuler=r,this._config=n,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef,this._overlayRef=t}enable(){if(this._scrollSubscription)return;let t=this._scrollDispatcher.scrolled(0).pipe(Ji(i=>!i||!this._overlayRef.overlayElement.contains(i.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{let i=this._viewportRuler.getViewportScrollPosition().top;Math.abs(i-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},v2=class{enable(){}disable(){}attach(){}};function DM(e,t){return t.some(i=>{let r=e.bottom<i.top,n=e.top>i.bottom,o=e.right<i.left,a=e.left>i.right;return r||n||o||a})}function hH(e,t){return t.some(i=>{let r=e.top<i.top,n=e.bottom>i.bottom,o=e.left<i.left,a=e.right>i.right;return r||n||o||a})}var IM=class{constructor(t,i,r,n){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this._config=n,this._scrollSubscription=null}attach(t){this._overlayRef,this._overlayRef=t}enable(){if(!this._scrollSubscription){let t=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(t).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let i=this._overlayRef.overlayElement.getBoundingClientRect(),{width:r,height:n}=this._viewportRuler.getViewportSize();DM(i,[{width:r,height:n,bottom:n,right:r,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},Dve=(()=>{class e{constructor(i,r,n,o){this._scrollDispatcher=i,this._viewportRuler=r,this._ngZone=n,this.noop=()=>new v2,this.close=a=>new AM(this._scrollDispatcher,this._ngZone,this._viewportRuler,a),this.block=()=>new TM(this._viewportRuler,this._document),this.reposition=a=>new IM(this._scrollDispatcher,this._viewportRuler,this._ngZone,a),this._document=o}static{this.\u0275fac=function(r){return new(r||e)(Ae(l_),Ae(gp),Ae(st),Ae(Bt))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),_2=class{constructor(t){if(this.scrollStrategy=new v2,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){let i=Object.keys(t);for(let r of i)t[r]!==void 0&&(this[r]=t[r])}}};var MM=class{constructor(t,i){this.connectionPair=t,this.scrollableViewProperties=i}};var vH=(()=>{class e{constructor(i){this._attachedOverlays=[],this._document=i}ngOnDestroy(){this.detach()}add(i){this.remove(i),this._attachedOverlays.push(i)}remove(i){let r=this._attachedOverlays.indexOf(i);r>-1&&this._attachedOverlays.splice(r,1),this._attachedOverlays.length===0&&this.detach()}static{this.\u0275fac=function(r){return new(r||e)(Ae(Bt))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Ive=(()=>{class e extends vH{constructor(i,r){super(i),this._ngZone=r,this._keydownListener=n=>{let o=this._attachedOverlays;for(let a=o.length-1;a>-1;a--)if(o[a]._keydownEvents.observers.length>0){let s=o[a]._keydownEvents;this._ngZone?this._ngZone.run(()=>s.next(n)):s.next(n);break}}}add(i){super.add(i),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static{this.\u0275fac=function(r){return new(r||e)(Ae(Bt),Ae(st,8))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Mve=(()=>{class e extends vH{constructor(i,r,n){super(i),this._platform=r,this._ngZone=n,this._cursorStyleIsSet=!1,this._pointerDownListener=o=>{this._pointerDownEventTarget=qs(o)},this._clickListener=o=>{let a=qs(o),s=o.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:a;this._pointerDownEventTarget=null;let c=this._attachedOverlays.slice();for(let l=c.length-1;l>-1;l--){let d=c[l];if(d._outsidePointerEvents.observers.length<1||!d.hasAttached())continue;if(d.overlayElement.contains(a)||d.overlayElement.contains(s))break;let u=d._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>u.next(o)):u.next(o)}}}add(i){if(super.add(i),!this._isAttached){let r=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(r)):this._addEventListeners(r),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){let i=this._document.body;i.removeEventListener("pointerdown",this._pointerDownListener,!0),i.removeEventListener("click",this._clickListener,!0),i.removeEventListener("auxclick",this._clickListener,!0),i.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(i.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(i){i.addEventListener("pointerdown",this._pointerDownListener,!0),i.addEventListener("click",this._clickListener,!0),i.addEventListener("auxclick",this._clickListener,!0),i.addEventListener("contextmenu",this._clickListener,!0)}static{this.\u0275fac=function(r){return new(r||e)(Ae(Bt),Ae(Pi),Ae(st,8))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),_H=(()=>{class e{constructor(i,r){this._platform=r,this._document=i}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let i="cdk-overlay-container";if(this._platform.isBrowser||n_()){let n=this._document.querySelectorAll(`.${i}[platform="server"], .${i}[platform="test"]`);for(let o=0;o<n.length;o++)n[o].remove()}let r=this._document.createElement("div");r.classList.add(i),n_()?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}static{this.\u0275fac=function(r){return new(r||e)(Ae(Bt),Ae(Pi))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),kM=class{constructor(t,i,r,n,o,a,s,c,l,d=!1){this._portalOutlet=t,this._host=i,this._pane=r,this._config=n,this._ngZone=o,this._keyboardDispatcher=a,this._document=s,this._location=c,this._outsideClickDispatcher=l,this._animationsDisabled=d,this._backdropElement=null,this._backdropClick=new Ct,this._attachments=new Ct,this._detachments=new Ct,this._locationChanges=fn.EMPTY,this._backdropClickHandler=u=>this._backdropClick.next(u),this._backdropTransitionendHandler=u=>{this._disposeBackdrop(u.target)},this._keydownEvents=new Ct,this._outsidePointerEvents=new Ct,n.scrollStrategy&&(this._scrollStrategy=n.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=n.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let i=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(wn(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof i?.onDestroy=="function"&&i.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),i}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){let t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config=L(L({},this._config),t),this._updateElementSize()}setDirection(t){this._config=ve(L({},this._config),{direction:t}),this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){let t=this._config.direction;return t?typeof t=="string"?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let t=this._pane.style;t.width=Sn(this._config.width),t.height=Sn(this._config.height),t.minWidth=Sn(this._config.minWidth),t.minHeight=Sn(this._config.minHeight),t.maxWidth=Sn(this._config.maxWidth),t.maxHeight=Sn(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){let t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let t=this._backdropElement;if(t){if(this._animationsDisabled){this._disposeBackdrop(t);return}t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500))}}_toggleClasses(t,i,r){let n=Rm(i||[]).filter(o=>!!o);n.length&&(r?t.classList.add(...n):t.classList.remove(...n))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{let t=this._ngZone.onStable.pipe(Ui(So(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){let t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}},pH="cdk-overlay-connected-position-bounding-box",kve=/([A-Za-z%]+)$/,PM=class{get positions(){return this._preferredPositions}constructor(t,i,r,n,o){this._viewportRuler=i,this._document=r,this._platform=n,this._overlayContainer=o,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Ct,this._resizeSubscription=fn.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}attach(t){this._overlayRef&&this._overlayRef,this._validatePositions(),t.hostElement.classList.add(pH),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let t=this._originRect,i=this._overlayRect,r=this._viewportRect,n=this._containerRect,o=[],a;for(let s of this._preferredPositions){let c=this._getOriginPoint(t,n,s),l=this._getOverlayPoint(c,i,s),d=this._getOverlayFit(l,i,r,s);if(d.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(s,c);return}if(this._canFitWithFlexibleDimensions(d,l,r)){o.push({position:s,origin:c,overlayRect:i,boundingBoxRect:this._calculateBoundingBoxRect(c,s)});continue}(!a||a.overlayFit.visibleArea<d.visibleArea)&&(a={overlayFit:d,overlayPoint:l,originPoint:c,position:s,overlayRect:i})}if(o.length){let s=null,c=-1;for(let l of o){let d=l.boundingBoxRect.width*l.boundingBoxRect.height*(l.position.weight||1);d>c&&(c=d,s=l)}this._isPushed=!1,this._applyPosition(s.position,s.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(a.position,a.originPoint);return}this._applyPosition(a.position,a.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&_p(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(pH),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let i=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,i)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,t.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,i,r){let n;if(r.originX=="center")n=t.left+t.width/2;else{let a=this._isRtl()?t.right:t.left,s=this._isRtl()?t.left:t.right;n=r.originX=="start"?a:s}i.left<0&&(n-=i.left);let o;return r.originY=="center"?o=t.top+t.height/2:o=r.originY=="top"?t.top:t.bottom,i.top<0&&(o-=i.top),{x:n,y:o}}_getOverlayPoint(t,i,r){let n;r.overlayX=="center"?n=-i.width/2:r.overlayX==="start"?n=this._isRtl()?-i.width:0:n=this._isRtl()?0:-i.width;let o;return r.overlayY=="center"?o=-i.height/2:o=r.overlayY=="top"?0:-i.height,{x:t.x+n,y:t.y+o}}_getOverlayFit(t,i,r,n){let o=mH(i),{x:a,y:s}=t,c=this._getOffset(n,"x"),l=this._getOffset(n,"y");c&&(a+=c),l&&(s+=l);let d=0-a,u=a+o.width-r.width,h=0-s,p=s+o.height-r.height,m=this._subtractOverflows(o.width,d,u),f=this._subtractOverflows(o.height,h,p),g=m*f;return{visibleArea:g,isCompletelyWithinViewport:o.width*o.height===g,fitsInViewportVertically:f===o.height,fitsInViewportHorizontally:m==o.width}}_canFitWithFlexibleDimensions(t,i,r){if(this._hasFlexibleDimensions){let n=r.bottom-i.y,o=r.right-i.x,a=fH(this._overlayRef.getConfig().minHeight),s=fH(this._overlayRef.getConfig().minWidth),c=t.fitsInViewportVertically||a!=null&&a<=n,l=t.fitsInViewportHorizontally||s!=null&&s<=o;return c&&l}return!1}_pushOverlayOnScreen(t,i,r){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};let n=mH(i),o=this._viewportRect,a=Math.max(t.x+n.width-o.width,0),s=Math.max(t.y+n.height-o.height,0),c=Math.max(o.top-r.top-t.y,0),l=Math.max(o.left-r.left-t.x,0),d=0,u=0;return n.width<=o.width?d=l||-a:d=t.x<this._viewportMargin?o.left-r.left-t.x:0,n.height<=o.height?u=c||-s:u=t.y<this._viewportMargin?o.top-r.top-t.y:0,this._previousPushAmount={x:d,y:u},{x:t.x+d,y:t.y+u}}_applyPosition(t,i){if(this._setTransformOrigin(t),this._setOverlayElementStyles(i,t),this._setBoundingBoxStyles(i,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._positionChanges.observers.length){let r=this._getScrollVisibility();if(t!==this._lastPosition||!this._lastScrollVisibility||!Pve(this._lastScrollVisibility,r)){let n=new MM(t,r);this._positionChanges.next(n)}this._lastScrollVisibility=r}this._lastPosition=t,this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;let i=this._boundingBox.querySelectorAll(this._transformOriginSelector),r,n=t.overlayY;t.overlayX==="center"?r="center":this._isRtl()?r=t.overlayX==="start"?"right":"left":r=t.overlayX==="start"?"left":"right";for(let o=0;o<i.length;o++)i[o].style.transformOrigin=`${r} ${n}`}_calculateBoundingBoxRect(t,i){let r=this._viewportRect,n=this._isRtl(),o,a,s;if(i.overlayY==="top")a=t.y,o=r.height-a+this._viewportMargin;else if(i.overlayY==="bottom")s=r.height-t.y+this._viewportMargin*2,o=r.height-s+this._viewportMargin;else{let p=Math.min(r.bottom-t.y+r.top,t.y),m=this._lastBoundingBoxSize.height;o=p*2,a=t.y-p,o>m&&!this._isInitialRender&&!this._growAfterOpen&&(a=t.y-m/2)}let c=i.overlayX==="start"&&!n||i.overlayX==="end"&&n,l=i.overlayX==="end"&&!n||i.overlayX==="start"&&n,d,u,h;if(l)h=r.width-t.x+this._viewportMargin*2,d=t.x-this._viewportMargin;else if(c)u=t.x,d=r.right-t.x;else{let p=Math.min(r.right-t.x+r.left,t.x),m=this._lastBoundingBoxSize.width;d=p*2,u=t.x-p,d>m&&!this._isInitialRender&&!this._growAfterOpen&&(u=t.x-m/2)}return{top:a,left:u,bottom:s,right:h,width:d,height:o}}_setBoundingBoxStyles(t,i){let r=this._calculateBoundingBoxRect(t,i);!this._isInitialRender&&!this._growAfterOpen&&(r.height=Math.min(r.height,this._lastBoundingBoxSize.height),r.width=Math.min(r.width,this._lastBoundingBoxSize.width));let n={};if(this._hasExactPosition())n.top=n.left="0",n.bottom=n.right=n.maxHeight=n.maxWidth="",n.width=n.height="100%";else{let o=this._overlayRef.getConfig().maxHeight,a=this._overlayRef.getConfig().maxWidth;n.height=Sn(r.height),n.top=Sn(r.top),n.bottom=Sn(r.bottom),n.width=Sn(r.width),n.left=Sn(r.left),n.right=Sn(r.right),i.overlayX==="center"?n.alignItems="center":n.alignItems=i.overlayX==="end"?"flex-end":"flex-start",i.overlayY==="center"?n.justifyContent="center":n.justifyContent=i.overlayY==="bottom"?"flex-end":"flex-start",o&&(n.maxHeight=Sn(o)),a&&(n.maxWidth=Sn(a))}this._lastBoundingBoxSize=r,_p(this._boundingBox.style,n)}_resetBoundingBoxStyles(){_p(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){_p(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,i){let r={},n=this._hasExactPosition(),o=this._hasFlexibleDimensions,a=this._overlayRef.getConfig();if(n){let d=this._viewportRuler.getViewportScrollPosition();_p(r,this._getExactOverlayY(i,t,d)),_p(r,this._getExactOverlayX(i,t,d))}else r.position="static";let s="",c=this._getOffset(i,"x"),l=this._getOffset(i,"y");c&&(s+=`translateX(${c}px) `),l&&(s+=`translateY(${l}px)`),r.transform=s.trim(),a.maxHeight&&(n?r.maxHeight=Sn(a.maxHeight):o&&(r.maxHeight="")),a.maxWidth&&(n?r.maxWidth=Sn(a.maxWidth):o&&(r.maxWidth="")),_p(this._pane.style,r)}_getExactOverlayY(t,i,r){let n={top:"",bottom:""},o=this._getOverlayPoint(i,this._overlayRect,t);if(this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r)),t.overlayY==="bottom"){let a=this._document.documentElement.clientHeight;n.bottom=`${a-(o.y+this._overlayRect.height)}px`}else n.top=Sn(o.y);return n}_getExactOverlayX(t,i,r){let n={left:"",right:""},o=this._getOverlayPoint(i,this._overlayRect,t);this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r));let a;if(this._isRtl()?a=t.overlayX==="end"?"left":"right":a=t.overlayX==="end"?"right":"left",a==="right"){let s=this._document.documentElement.clientWidth;n.right=`${s-(o.x+this._overlayRect.width)}px`}else n.left=Sn(o.x);return n}_getScrollVisibility(){let t=this._getOriginRect(),i=this._pane.getBoundingClientRect(),r=this._scrollables.map(n=>n.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:hH(t,r),isOriginOutsideView:DM(t,r),isOverlayClipped:hH(i,r),isOverlayOutsideView:DM(i,r)}}_subtractOverflows(t,...i){return i.reduce((r,n)=>r-Math.max(n,0),t)}_getNarrowedViewportRect(){let t=this._document.documentElement.clientWidth,i=this._document.documentElement.clientHeight,r=this._viewportRuler.getViewportScrollPosition();return{top:r.top+this._viewportMargin,left:r.left+this._viewportMargin,right:r.left+t-this._viewportMargin,bottom:r.top+i-this._viewportMargin,width:t-2*this._viewportMargin,height:i-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,i){return i==="x"?t.offsetX==null?this._offsetX:t.offsetX:t.offsetY==null?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&Rm(t).forEach(i=>{i!==""&&this._appliedPanelClasses.indexOf(i)===-1&&(this._appliedPanelClasses.push(i),this._pane.classList.add(i))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){let t=this._origin;if(t instanceof vt)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();let i=t.width||0,r=t.height||0;return{top:t.y,bottom:t.y+r,left:t.x,right:t.x+i,height:r,width:i}}};function _p(e,t){for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function fH(e){if(typeof e!="number"&&e!=null){let[t,i]=e.split(kve);return!i||i==="px"?parseFloat(t):null}return e||null}function mH(e){return{top:Math.floor(e.top),right:Math.floor(e.right),bottom:Math.floor(e.bottom),left:Math.floor(e.left),width:Math.floor(e.width),height:Math.floor(e.height)}}function Pve(e,t){return e===t?!0:e.isOriginClipped===t.isOriginClipped&&e.isOriginOutsideView===t.isOriginOutsideView&&e.isOverlayClipped===t.isOverlayClipped&&e.isOverlayOutsideView===t.isOverlayOutsideView}var gH="cdk-global-overlay-wrapper",NM=class{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(t){let i=t.getConfig();this._overlayRef=t,this._width&&!i.width&&t.updateSize({width:this._width}),this._height&&!i.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(gH),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let t=this._overlayRef.overlayElement.style,i=this._overlayRef.hostElement.style,r=this._overlayRef.getConfig(),{width:n,height:o,maxWidth:a,maxHeight:s}=r,c=(n==="100%"||n==="100vw")&&(!a||a==="100%"||a==="100vw"),l=(o==="100%"||o==="100vh")&&(!s||s==="100%"||s==="100vh"),d=this._xPosition,u=this._xOffset,h=this._overlayRef.getConfig().direction==="rtl",p="",m="",f="";c?f="flex-start":d==="center"?(f="center",h?m=u:p=u):h?d==="left"||d==="end"?(f="flex-end",p=u):(d==="right"||d==="start")&&(f="flex-start",m=u):d==="left"||d==="start"?(f="flex-start",p=u):(d==="right"||d==="end")&&(f="flex-end",m=u),t.position=this._cssPosition,t.marginLeft=c?"0":p,t.marginTop=l?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=c?"0":m,i.justifyContent=f,i.alignItems=l?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let t=this._overlayRef.overlayElement.style,i=this._overlayRef.hostElement,r=i.style;i.classList.remove(gH),r.justifyContent=r.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}},Nve=(()=>{class e{constructor(i,r,n,o){this._viewportRuler=i,this._document=r,this._platform=n,this._overlayContainer=o}global(){return new NM}flexibleConnectedTo(i){return new PM(i,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static{this.\u0275fac=function(r){return new(r||e)(Ae(gp),Ae(Bt),Ae(Pi),Ae(_H))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Ove=0,bp=(()=>{class e{constructor(i,r,n,o,a,s,c,l,d,u,h,p){this.scrollStrategies=i,this._overlayContainer=r,this._componentFactoryResolver=n,this._positionBuilder=o,this._keyboardDispatcher=a,this._injector=s,this._ngZone=c,this._document=l,this._directionality=d,this._location=u,this._outsideClickDispatcher=h,this._animationsModuleType=p}create(i){let r=this._createHostElement(),n=this._createPaneElement(r),o=this._createPortalOutlet(n),a=new _2(i);return a.direction=a.direction||this._directionality.value,new kM(o,r,n,a,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations")}position(){return this._positionBuilder}_createPaneElement(i){let r=this._document.createElement("div");return r.id=`cdk-overlay-${Ove++}`,r.classList.add("cdk-overlay-pane"),i.appendChild(r),r}_createHostElement(){let i=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(i),i}_createPortalOutlet(i){return this._appRef||(this._appRef=this._injector.get(Qu)),new m2(i,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static{this.\u0275fac=function(r){return new(r||e)(Ae(Dve),Ae(_H),Ae(qp),Ae(Nve),Ae(Ive),Ae(Ea),Ae(st),Ae(Bt),Ae(ds),Ae(eh),Ae(Mve),Ae(pr,8))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Rve=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],bH=new Ye("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let e=Je(bp);return()=>e.scrollStrategies.reposition()}}),d_=(()=>{class e{constructor(i){this.elementRef=i}static{this.\u0275fac=function(r){return new(r||e)(G(vt))}}static{this.\u0275dir=xt({type:e,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"],standalone:!0})}}return e})(),RM=(()=>{class e{get offsetX(){return this._offsetX}set offsetX(i){this._offsetX=i,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(i){this._offsetY=i,this._position&&this._updatePositionStrategy(this._position)}get disposeOnNavigation(){return this._disposeOnNavigation}set disposeOnNavigation(i){this._disposeOnNavigation=i}constructor(i,r,n,o,a){this._overlay=i,this._dir=a,this._backdropSubscription=fn.EMPTY,this._attachSubscription=fn.EMPTY,this._detachSubscription=fn.EMPTY,this._positionSubscription=fn.EMPTY,this._disposeOnNavigation=!1,this._ngZone=Je(st),this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.hasBackdrop=!1,this.lockPosition=!1,this.flexibleDimensions=!1,this.growAfterOpen=!1,this.push=!1,this.backdropClick=new We,this.positionChange=new We,this.attach=new We,this.detach=new We,this.overlayKeydown=new We,this.overlayOutsideClick=new We,this._templatePortal=new vp(r,n),this._scrollStrategyFactory=o,this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(i){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),i.origin&&this.open&&this._position.apply()),i.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=Rve);let i=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=i.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=i.detachments().subscribe(()=>this.detach.emit()),i.keydownEvents().subscribe(r=>{this.overlayKeydown.next(r),r.keyCode===27&&!this.disableClose&&!us(r)&&(r.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(r=>{let n=this._getOriginElement(),o=qs(r);(!n||n!==o&&!n.contains(o))&&this.overlayOutsideClick.next(r)})}_buildConfig(){let i=this._position=this.positionStrategy||this._createPositionStrategy(),r=new _2({direction:this._dir,positionStrategy:i,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop,disposeOnNavigation:this.disposeOnNavigation});return(this.width||this.width===0)&&(r.width=this.width),(this.height||this.height===0)&&(r.height=this.height),(this.minWidth||this.minWidth===0)&&(r.minWidth=this.minWidth),(this.minHeight||this.minHeight===0)&&(r.minHeight=this.minHeight),this.backdropClass&&(r.backdropClass=this.backdropClass),this.panelClass&&(r.panelClass=this.panelClass),r}_updatePositionStrategy(i){let r=this.positions.map(n=>({originX:n.originX,originY:n.originY,overlayX:n.overlayX,overlayY:n.overlayY,offsetX:n.offsetX||this.offsetX,offsetY:n.offsetY||this.offsetY,panelClass:n.panelClass||void 0}));return i.setOrigin(this._getOrigin()).withPositions(r).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){let i=this._overlay.position().flexibleConnectedTo(this._getOrigin());return this._updatePositionStrategy(i),i}_getOrigin(){return this.origin instanceof d_?this.origin.elementRef:this.origin}_getOriginElement(){return this.origin instanceof d_?this.origin.elementRef.nativeElement:this.origin instanceof vt?this.origin.nativeElement:typeof Element<"u"&&this.origin instanceof Element?this.origin:null}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(i=>{this.backdropClick.emit(i)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(c3(()=>this.positionChange.observers.length>0)).subscribe(i=>{this._ngZone.run(()=>this.positionChange.emit(i)),this.positionChange.observers.length===0&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||e)(G(bp),G(Wp),G(sl),G(bH),G(ds,8))}}static{this.\u0275dir=xt({type:e,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:[_e.None,"cdkConnectedOverlayOrigin","origin"],positions:[_e.None,"cdkConnectedOverlayPositions","positions"],positionStrategy:[_e.None,"cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:[_e.None,"cdkConnectedOverlayOffsetX","offsetX"],offsetY:[_e.None,"cdkConnectedOverlayOffsetY","offsetY"],width:[_e.None,"cdkConnectedOverlayWidth","width"],height:[_e.None,"cdkConnectedOverlayHeight","height"],minWidth:[_e.None,"cdkConnectedOverlayMinWidth","minWidth"],minHeight:[_e.None,"cdkConnectedOverlayMinHeight","minHeight"],backdropClass:[_e.None,"cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:[_e.None,"cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:[_e.None,"cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:[_e.None,"cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:[_e.None,"cdkConnectedOverlayOpen","open"],disableClose:[_e.None,"cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:[_e.None,"cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:[_e.HasDecoratorInputTransform,"cdkConnectedOverlayHasBackdrop","hasBackdrop",yt],lockPosition:[_e.HasDecoratorInputTransform,"cdkConnectedOverlayLockPosition","lockPosition",yt],flexibleDimensions:[_e.HasDecoratorInputTransform,"cdkConnectedOverlayFlexibleDimensions","flexibleDimensions",yt],growAfterOpen:[_e.HasDecoratorInputTransform,"cdkConnectedOverlayGrowAfterOpen","growAfterOpen",yt],push:[_e.HasDecoratorInputTransform,"cdkConnectedOverlayPush","push",yt],disposeOnNavigation:[_e.HasDecoratorInputTransform,"cdkConnectedOverlayDisposeOnNavigation","disposeOnNavigation",yt]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],standalone:!0,features:[Hi,kr]})}}return e})();function Fve(e){return()=>e.scrollStrategies.reposition()}var Lve={provide:bH,deps:[bp],useFactory:Fve},yH=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({providers:[bp,Lve],imports:[vu,g2,wM,wM]})}}return e})();var Bve=["trigger"],Vve=["panel"],zve=[[["mat-select-trigger"]],"*"],Uve=["mat-select-trigger","*"];function Hve(e,t){if(e&1&&(C(0,"span",4),W(1),A()),e&2){let i=ae();O(),Pr(i.placeholder)}}function jve(e,t){e&1&&gt(0)}function Gve(e,t){if(e&1&&(C(0,"span",11),W(1),A()),e&2){let i=ae(2);O(),Pr(i.triggerValue)}}function $ve(e,t){if(e&1&&(C(0,"span",10),Be(1,jve,1,0)(2,Gve,2,1),A()),e&2){let i=ae();O(),Ni(1,i.customTrigger?1:2)}}function Wve(e,t){if(e&1){let i=Ze();C(0,"div",12,1),Y("@transformPanel.done",function(n){q(i);let o=ae();return X(o._panelDoneAnimatingStream.next(n.toState))})("keydown",function(n){q(i);let o=ae();return X(o._handleKeydown(n))}),gt(2,1),A()}if(e&2){let i=ae();Bb("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",i._getPanelTheme(),""),z("ngClass",i.panelClass)("@transformPanel","showing"),Zt("id",i.id+"-panel")("aria-multiselectable",i.multiple)("aria-label",i.ariaLabel||null)("aria-labelledby",i._getPanelAriaLabelledby())}}var qve={transformPanelWrap:Pl("transformPanelWrap",[Ss("* => void",gR("@transformPanel",[mR()],{optional:!0}))]),transformPanel:Pl("transformPanel",[Cs("void",Ko({opacity:0,transform:"scale(1, 0.8)"})),Ss("void => showing",ll("120ms cubic-bezier(0, 0, 0.2, 1)",Ko({opacity:1,transform:"scale(1, 1)"}))),Ss("* => void",ll("100ms linear",Ko({opacity:0})))])};var xH=0,wH=new Ye("mat-select-scroll-strategy",{providedIn:"root",factory:()=>{let e=Je(bp);return()=>e.scrollStrategies.reposition()}});function Xve(e){return()=>e.scrollStrategies.reposition()}var Yve=new Ye("MAT_SELECT_CONFIG"),Zve={provide:wH,deps:[bp],useFactory:Xve},Kve=new Ye("MatSelectTrigger"),FM=class{constructor(t,i){this.source=t,this.value=i}},b2=(()=>{class e{_scrollOptionIntoView(i){let r=this.options.toArray()[i];if(r){let n=this.panel.nativeElement,o=K9(i,this.options,this.optionGroups),a=r._getHostElement();i===0&&o===1?n.scrollTop=0:n.scrollTop=Q9(a.offsetTop,a.offsetHeight,n.scrollTop,n.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(i){return new FM(this,i)}get focused(){return this._focused||this._panelOpen}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(i){this._hideSingleSelectionIndicator=i,this._syncParentProperties()}get placeholder(){return this._placeholder}set placeholder(i){this._placeholder=i,this.stateChanges.next()}get required(){return this._required??this.ngControl?.control?.hasValidator(ym.required)??!1}set required(i){this._required=i,this.stateChanges.next()}get multiple(){return this._multiple}set multiple(i){this._selectionModel,this._multiple=i}get compareWith(){return this._compareWith}set compareWith(i){this._compareWith=i,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(i){this._assignValue(i)&&this._onChange(i)}get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(i){this._errorStateTracker.matcher=i}get id(){return this._id}set id(i){this._id=i||this._uid,this.stateChanges.next()}get errorState(){return this._errorStateTracker.errorState}set errorState(i){this._errorStateTracker.errorState=i}constructor(i,r,n,o,a,s,c,l,d,u,h,p,m,f){this._viewportRuler=i,this._changeDetectorRef=r,this._elementRef=a,this._dir=s,this._parentFormField=d,this.ngControl=u,this._liveAnnouncer=m,this._defaultOptions=f,this._positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}],this._panelOpen=!1,this._compareWith=(g,v)=>g===v,this._uid=`mat-select-${xH++}`,this._triggerAriaLabelledBy=null,this._destroy=new Ct,this.stateChanges=new Ct,this.disableAutomaticLabeling=!0,this._onChange=()=>{},this._onTouched=()=>{},this._valueId=`mat-select-value-${xH++}`,this._panelDoneAnimatingStream=new Ct,this._overlayPanelClass=this._defaultOptions?.overlayPanelClass||"",this._focused=!1,this.controlType="mat-select",this.disabled=!1,this.disableRipple=!1,this.tabIndex=0,this._hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1,this._multiple=!1,this.disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1,this.ariaLabel="",this.panelWidth=this._defaultOptions&&typeof this._defaultOptions.panelWidth<"u"?this._defaultOptions.panelWidth:"auto",this._initialized=new Ct,this.optionSelectionChanges=kg(()=>{let g=this.options;return g?g.changes.pipe(xa(g),An(()=>So(...g.map(v=>v.onSelectionChange)))):this._initialized.pipe(An(()=>this.optionSelectionChanges))}),this.openedChange=new We,this._openedStream=this.openedChange.pipe(Ji(g=>g),Xt(()=>{})),this._closedStream=this.openedChange.pipe(Ji(g=>!g),Xt(()=>{})),this.selectionChange=new We,this.valueChange=new We,this._trackedModal=null,this._skipPredicate=g=>this.panelOpen?!1:g.disabled,this.ngControl&&(this.ngControl.valueAccessor=this),f?.typeaheadDebounceInterval!=null&&(this.typeaheadDebounceInterval=f.typeaheadDebounceInterval),this._errorStateTracker=new Bm(o,u,l,c,this.stateChanges),this._scrollStrategyFactory=p,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(h)||0,this.id=this.id}ngOnInit(){this._selectionModel=new jm(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe($u(),Ui(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen)),this._viewportRuler.change().pipe(Ui(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._changeDetectorRef.detectChanges())})}ngAfterContentInit(){this._initialized.next(),this._initialized.complete(),this._initKeyManager(),this._selectionModel.changed.pipe(Ui(this._destroy)).subscribe(i=>{i.added.forEach(r=>r.select()),i.removed.forEach(r=>r.deselect())}),this.options.changes.pipe(xa(null),Ui(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){let i=this._getTriggerAriaLabelledby(),r=this.ngControl;if(i!==this._triggerAriaLabelledBy){let n=this._elementRef.nativeElement;this._triggerAriaLabelledBy=i,i?n.setAttribute("aria-labelledby",i):n.removeAttribute("aria-labelledby")}r&&(this._previousControl!==r.control&&(this._previousControl!==void 0&&r.disabled!==null&&r.disabled!==this.disabled&&(this.disabled=r.disabled),this._previousControl=r.control),this.updateErrorState())}ngOnChanges(i){(i.disabled||i.userAriaDescribedBy)&&this.stateChanges.next(),i.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this.typeaheadDebounceInterval)}ngOnDestroy(){this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete(),this._clearFromModal()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin()),this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._applyModalPanelOwnership(),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_applyModalPanelOwnership(){let i=this._elementRef.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!i)return;let r=`${this.id}-panel`;this._trackedModal&&aM(this._trackedModal,"aria-owns",r),F9(i,"aria-owns",r),this._trackedModal=i}_clearFromModal(){if(!this._trackedModal)return;let i=`${this.id}-panel`;aM(this._trackedModal,"aria-owns",i),this._trackedModal=null}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched(),this.stateChanges.next())}writeValue(i){this._assignValue(i)}registerOnChange(i){this._onChange=i}registerOnTouched(i){this._onTouched=i}setDisabledState(i){this.disabled=i,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){let i=this._selectionModel.selected.map(r=>r.viewValue);return this._isRtl()&&i.reverse(),i.join(", ")}return this._selectionModel.selected[0].viewValue}updateErrorState(){this._errorStateTracker.updateErrorState()}_isRtl(){return this._dir?this._dir.value==="rtl":!1}_handleKeydown(i){this.disabled||(this.panelOpen?this._handleOpenKeydown(i):this._handleClosedKeydown(i))}_handleClosedKeydown(i){let r=i.keyCode,n=r===40||r===38||r===37||r===39,o=r===13||r===32,a=this._keyManager;if(!a.isTyping()&&o&&!us(i)||(this.multiple||i.altKey)&&n)i.preventDefault(),this.open();else if(!this.multiple){let s=this.selected;a.onKeydown(i);let c=this.selected;c&&s!==c&&this._liveAnnouncer.announce(c.viewValue,1e4)}}_handleOpenKeydown(i){let r=this._keyManager,n=i.keyCode,o=n===40||n===38,a=r.isTyping();if(o&&i.altKey)i.preventDefault(),this.close();else if(!a&&(n===13||n===32)&&r.activeItem&&!us(i))i.preventDefault(),r.activeItem._selectViaInteraction();else if(!a&&this._multiple&&n===65&&i.ctrlKey){i.preventDefault();let s=this.options.some(c=>!c.disabled&&!c.selected);this.options.forEach(c=>{c.disabled||(s?c.select():c.deselect())})}else{let s=r.activeItemIndex;r.onKeydown(i),this._multiple&&o&&i.shiftKey&&r.activeItem&&r.activeItemIndex!==s&&r.activeItem._selectViaInteraction()}}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe(wn(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(i){if(this.options.forEach(r=>r.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&i)Array.isArray(i),i.forEach(r=>this._selectOptionByValue(r)),this._sortValues();else{let r=this._selectOptionByValue(i);r?this._keyManager.updateActiveItem(r):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(i){let r=this.options.find(n=>{if(this._selectionModel.isSelected(n))return!1;try{return n.value!=null&&this._compareWith(n.value,i)}catch{return!1}});return r&&this._selectionModel.select(r),r}_assignValue(i){return i!==this._value||this._multiple&&Array.isArray(i)?(this.options&&this._setSelectionByValue(i),this._value=i,!0):!1}_getOverlayWidth(i){return this.panelWidth==="auto"?(i instanceof d_?i.elementRef:i||this._elementRef).nativeElement.getBoundingClientRect().width:this.panelWidth===null?"":this.panelWidth}_syncParentProperties(){if(this.options)for(let i of this.options)i._changeDetectorRef.markForCheck()}_initKeyManager(){this._keyManager=new t2(this.options).withTypeAhead(this.typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]).skipPredicate(this._skipPredicate),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){let i=So(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(Ui(i)).subscribe(r=>{this._onSelect(r.source,r.isUserInput),r.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),So(...this.options.map(r=>r._stateChanges)).pipe(Ui(i)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(i,r){let n=this._selectionModel.isSelected(i);i.value==null&&!this._multiple?(i.deselect(),this._selectionModel.clear(),this.value!=null&&this._propagateChanges(i.value)):(n!==i.selected&&(i.selected?this._selectionModel.select(i):this._selectionModel.deselect(i)),r&&this._keyManager.setActiveItem(i),this.multiple&&(this._sortValues(),r&&this.focus())),n!==this._selectionModel.isSelected(i)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){let i=this.options.toArray();this._selectionModel.sort((r,n)=>this.sortComparator?this.sortComparator(r,n,i):i.indexOf(r)-i.indexOf(n)),this.stateChanges.next()}}_propagateChanges(i){let r;this.multiple?r=this.selected.map(n=>n.value):r=this.selected?this.selected.value:i,this._value=r,this.valueChange.emit(r),this._onChange(r),this.selectionChange.emit(this._getChangeEvent(r)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){if(this._keyManager)if(this.empty){let i=-1;for(let r=0;r<this.options.length;r++)if(!this.options.get(r).disabled){i=r;break}this._keyManager.setActiveItem(i)}else this._keyManager.setActiveItem(this._selectionModel.selected[0])}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(i){this._elementRef.nativeElement.focus(i)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;let i=this._parentFormField?.getLabelId(),r=i?i+" ":"";return this.ariaLabelledby?r+this.ariaLabelledby:i}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;let i=this._parentFormField?.getLabelId(),r=(i?i+" ":"")+this._valueId;return this.ariaLabelledby&&(r+=" "+this.ariaLabelledby),r}_panelDoneAnimating(i){this.openedChange.emit(i)}setDescribedByIds(i){i.length?this._elementRef.nativeElement.setAttribute("aria-describedby",i.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}static{this.\u0275fac=function(r){return new(r||e)(G(gp),G(ei),G(st),G(s2),G(vt),G(ds,8),G(N0,8),G(O0,8),G(s_,8),G(Zc,10),Zo("tabindex"),G(wH),G(U9),G(Yve,8))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-select"]],contentQueries:function(r,n,o){if(r&1&&(Xi(o,Kve,5),Xi(o,Um,5),Xi(o,yM,5)),r&2){let a;Ve(a=ze())&&(n.customTrigger=a.first),Ve(a=ze())&&(n.options=a),Ve(a=ze())&&(n.optionGroups=a)}},viewQuery:function(r,n){if(r&1&&(ht(Bve,5),ht(Vve,5),ht(RM,5)),r&2){let o;Ve(o=ze())&&(n.trigger=o.first),Ve(o=ze())&&(n.panel=o.first),Ve(o=ze())&&(n._overlayDir=o.first)}},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","listbox",1,"mat-mdc-select"],hostVars:19,hostBindings:function(r,n){r&1&&Y("keydown",function(a){return n._handleKeydown(a)})("focus",function(){return n._onFocus()})("blur",function(){return n._onBlur()}),r&2&&(Zt("id",n.id)("tabindex",n.disabled?-1:n.tabIndex)("aria-controls",n.panelOpen?n.id+"-panel":null)("aria-expanded",n.panelOpen)("aria-label",n.ariaLabel||null)("aria-required",n.required.toString())("aria-disabled",n.disabled.toString())("aria-invalid",n.errorState)("aria-activedescendant",n._getAriaActiveDescendant()),It("mat-mdc-select-disabled",n.disabled)("mat-mdc-select-invalid",n.errorState)("mat-mdc-select-required",n.required)("mat-mdc-select-empty",n.empty)("mat-mdc-select-multiple",n.multiple))},inputs:{userAriaDescribedBy:[_e.None,"aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",disabled:[_e.HasDecoratorInputTransform,"disabled","disabled",yt],disableRipple:[_e.HasDecoratorInputTransform,"disableRipple","disableRipple",yt],tabIndex:[_e.HasDecoratorInputTransform,"tabIndex","tabIndex",i=>i==null?0:sn(i)],hideSingleSelectionIndicator:[_e.HasDecoratorInputTransform,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",yt],placeholder:"placeholder",required:[_e.HasDecoratorInputTransform,"required","required",yt],multiple:[_e.HasDecoratorInputTransform,"multiple","multiple",yt],disableOptionCentering:[_e.HasDecoratorInputTransform,"disableOptionCentering","disableOptionCentering",yt],compareWith:"compareWith",value:"value",ariaLabel:[_e.None,"aria-label","ariaLabel"],ariaLabelledby:[_e.None,"aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:[_e.HasDecoratorInputTransform,"typeaheadDebounceInterval","typeaheadDebounceInterval",sn],sortComparator:"sortComparator",id:"id",panelWidth:"panelWidth"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},exportAs:["matSelect"],standalone:!0,features:[Li([{provide:a_,useExisting:e},{provide:bM,useExisting:e}]),Hi,kr,ci],ngContentSelectors:Uve,decls:11,vars:8,consts:[["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],["panel",""],["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],[1,"mat-mdc-select-value"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false","aria-hidden","true"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"backdropClick","attach","detach","cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth"],[1,"mat-mdc-select-value-text"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"keydown","ngClass"]],template:function(r,n){if(r&1){let o=Ze();vi(zve),C(0,"div",2,0),Y("click",function(){return q(o),X(n.open())}),C(3,"div",3),Be(4,Hve,2,1,"span",4)(5,$ve,3,1),A(),C(6,"div",5)(7,"div",6),wa(),C(8,"svg",7),he(9,"path",8),A()()()(),Be(10,Wve,3,9,"ng-template",9),Y("backdropClick",function(){return q(o),X(n.close())})("attach",function(){return q(o),X(n._onAttached())})("detach",function(){return q(o),X(n.close())})}if(r&2){let o=Ft(1);O(3),Zt("id",n._valueId),O(),Ni(4,n.empty?4:5),O(6),z("cdkConnectedOverlayPanelClass",n._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",n._scrollStrategy)("cdkConnectedOverlayOrigin",n._preferredOverlayOrigin||o)("cdkConnectedOverlayOpen",n.panelOpen)("cdkConnectedOverlayPositions",n._positions)("cdkConnectedOverlayWidth",n._overlayWidth)}},dependencies:[d_,RM,Il],styles:['.mat-mdc-select{display:inline-block;width:100%;outline:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-select-enabled-trigger-text-color);font-family:var(--mat-select-trigger-text-font);line-height:var(--mat-select-trigger-text-line-height);font-size:var(--mat-select-trigger-text-size);font-weight:var(--mat-select-trigger-text-weight);letter-spacing:var(--mat-select-trigger-text-tracking)}div.mat-mdc-select-panel{box-shadow:var(--mat-select-container-elevation-shadow)}.mat-mdc-select-disabled{color:var(--mat-select-disabled-trigger-text-color)}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-invalid .mat-mdc-select-arrow,.mat-form-field-invalid:not(.mat-form-field-disabled) .mat-mdc-form-field-infix::after{color:var(--mat-select-invalid-arrow-color)}.mat-mdc-select-arrow{width:10px;height:5px;position:relative;color:var(--mat-select-enabled-arrow-color)}.mat-mdc-form-field.mat-focused .mat-mdc-select-arrow{color:var(--mat-select-focused-arrow-color)}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-disabled .mat-mdc-select-arrow{color:var(--mat-select-disabled-arrow-color)}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:GrayText}div.mat-mdc-select-panel{width:100%;max-height:275px;outline:0;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-select-panel-background-color)}.cdk-high-contrast-active div.mat-mdc-select-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) div.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above div.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}div.mat-mdc-select-panel .mat-mdc-option{--mdc-list-list-item-container-color: var(--mat-select-panel-background-color)}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1);color:var(--mat-select-placeholder-text-color)}._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper{cursor:pointer}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:var(--mat-select-arrow-transform)}'],encapsulation:2,data:{animation:[qve.transformPanel]},changeDetection:0})}}return e})();var EH=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({providers:[Zve],imports:[To,yH,xM,Ut,mp,fp,xM,Ut]})}}return e})();var Qve=["dialogPopup"],Jve=["hueSlider"],e0e=["alphaSlider"];function t0e(e,t){if(e&1&&he(0,"div"),e&2){let i=ae();Bb("arrow arrow-",i.cpUsePosition,""),li("left",i.cpArrowPosition)("top",i.arrowTop,"px")}}function i0e(e,t){if(e&1){let i=Ze();C(0,"div",28),Y("newValue",function(n){q(i);let o=ae();return X(o.onColorChange(n))})("dragStart",function(){q(i);let n=ae();return X(n.onDragStart("saturation-lightness"))})("dragEnd",function(){q(i);let n=ae();return X(n.onDragEnd("saturation-lightness"))}),he(1,"div",16),A()}if(e&2){let i=ae();li("background-color",i.hueSliderColor),z("rgX",1)("rgY",1),O(),li("top",i.slider==null?null:i.slider.v,"px")("left",i.slider==null?null:i.slider.s,"px")}}function r0e(e,t){e&1&&(wa(),C(0,"svg",29),he(1,"path",30)(2,"path",31),A())}function n0e(e,t){if(e&1){let i=Ze();C(0,"button",32),Y("click",function(n){q(i);let o=ae();return X(o.onAddPresetColor(n,o.selectedColor))}),W(1),A()}if(e&2){let i=ae();Kr(i.cpAddColorButtonClass),z("disabled",i.cpPresetColors&&i.cpPresetColors.length>=i.cpMaxPresetColorsLength),O(),Qr(" ",i.cpAddColorButtonText," ")}}function o0e(e,t){e&1&&he(0,"div",33)}function a0e(e,t){if(e&1){let i=Ze();C(0,"input",39),Y("keyup.enter",function(n){q(i);let o=ae(2);return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae(2);return X(o.onAlphaInput(n))}),A()}if(e&2){let i=ae(2);z("rg",1)("value",i.cmykText==null?null:i.cmykText.a)}}function s0e(e,t){e&1&&(C(0,"div"),W(1,"A"),A())}function l0e(e,t){if(e&1){let i=Ze();C(0,"div",34)(1,"div",35)(2,"input",36),Y("keyup.enter",function(n){q(i);let o=ae();return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae();return X(o.onCyanInput(n))}),A(),C(3,"input",36),Y("keyup.enter",function(n){q(i);let o=ae();return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae();return X(o.onMagentaInput(n))}),A(),C(4,"input",36),Y("keyup.enter",function(n){q(i);let o=ae();return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae();return X(o.onYellowInput(n))}),A(),C(5,"input",36),Y("keyup.enter",function(n){q(i);let o=ae();return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae();return X(o.onBlackInput(n))}),A(),Be(6,a0e,1,2,"input",37),A(),C(7,"div",35)(8,"div"),W(9,"C"),A(),C(10,"div"),W(11,"M"),A(),C(12,"div"),W(13,"Y"),A(),C(14,"div"),W(15,"K"),A(),Be(16,s0e,2,0,"div",38),A()()}if(e&2){let i=ae();li("display",i.format!==3?"none":"block"),O(2),z("rg",100)("value",i.cmykText==null?null:i.cmykText.c),O(),z("rg",100)("value",i.cmykText==null?null:i.cmykText.m),O(),z("rg",100)("value",i.cmykText==null?null:i.cmykText.y),O(),z("rg",100)("value",i.cmykText==null?null:i.cmykText.k),O(),z("ngIf",i.cpAlphaChannel!=="disabled"),O(10),z("ngIf",i.cpAlphaChannel!=="disabled")}}function c0e(e,t){if(e&1){let i=Ze();C(0,"input",39),Y("keyup.enter",function(n){q(i);let o=ae(2);return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae(2);return X(o.onAlphaInput(n))}),A()}if(e&2){let i=ae(2);z("rg",1)("value",i.hslaText==null?null:i.hslaText.a)}}function d0e(e,t){e&1&&(C(0,"div"),W(1,"A"),A())}function u0e(e,t){if(e&1){let i=Ze();C(0,"div",40)(1,"div",35)(2,"input",41),Y("keyup.enter",function(n){q(i);let o=ae();return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae();return X(o.onHueInput(n))}),A(),C(3,"input",36),Y("keyup.enter",function(n){q(i);let o=ae();return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae();return X(o.onSaturationInput(n))}),A(),C(4,"input",36),Y("keyup.enter",function(n){q(i);let o=ae();return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae();return X(o.onLightnessInput(n))}),A(),Be(5,c0e,1,2,"input",37),A(),C(6,"div",35)(7,"div"),W(8,"H"),A(),C(9,"div"),W(10,"S"),A(),C(11,"div"),W(12,"L"),A(),Be(13,d0e,2,0,"div",38),A()()}if(e&2){let i=ae();li("display",i.format!==2?"none":"block"),O(2),z("rg",360)("value",i.hslaText==null?null:i.hslaText.h),O(),z("rg",100)("value",i.hslaText==null?null:i.hslaText.s),O(),z("rg",100)("value",i.hslaText==null?null:i.hslaText.l),O(),z("ngIf",i.cpAlphaChannel!=="disabled"),O(8),z("ngIf",i.cpAlphaChannel!=="disabled")}}function h0e(e,t){if(e&1){let i=Ze();C(0,"input",39),Y("keyup.enter",function(n){q(i);let o=ae(2);return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae(2);return X(o.onAlphaInput(n))}),A()}if(e&2){let i=ae(2);z("rg",1)("value",i.rgbaText==null?null:i.rgbaText.a)}}function p0e(e,t){e&1&&(C(0,"div"),W(1,"A"),A())}function f0e(e,t){if(e&1){let i=Ze();C(0,"div",42)(1,"div",35)(2,"input",43),Y("keyup.enter",function(n){q(i);let o=ae();return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae();return X(o.onRedInput(n))}),A(),C(3,"input",43),Y("keyup.enter",function(n){q(i);let o=ae();return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae();return X(o.onGreenInput(n))}),A(),C(4,"input",43),Y("keyup.enter",function(n){q(i);let o=ae();return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae();return X(o.onBlueInput(n))}),A(),Be(5,h0e,1,2,"input",37),A(),C(6,"div",35)(7,"div"),W(8,"R"),A(),C(9,"div"),W(10,"G"),A(),C(11,"div"),W(12,"B"),A(),Be(13,p0e,2,0,"div",38),A()()}if(e&2){let i=ae();li("display",i.format!==1?"none":"block"),O(2),z("rg",255)("value",i.rgbaText==null?null:i.rgbaText.r),O(),z("rg",255)("value",i.rgbaText==null?null:i.rgbaText.g),O(),z("rg",255)("value",i.rgbaText==null?null:i.rgbaText.b),O(),z("ngIf",i.cpAlphaChannel!=="disabled"),O(8),z("ngIf",i.cpAlphaChannel!=="disabled")}}function m0e(e,t){if(e&1){let i=Ze();C(0,"input",39),Y("keyup.enter",function(n){q(i);let o=ae(2);return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae(2);return X(o.onAlphaInput(n))}),A()}if(e&2){let i=ae(2);z("rg",1)("value",i.hexAlpha)}}function g0e(e,t){e&1&&(C(0,"div"),W(1,"A"),A())}function v0e(e,t){if(e&1){let i=Ze();C(0,"div",44)(1,"div",35)(2,"input",45),Y("blur",function(){q(i);let n=ae();return X(n.onHexInput(null))})("keyup.enter",function(n){q(i);let o=ae();return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae();return X(o.onHexInput(n))}),A(),Be(3,m0e,1,2,"input",37),A(),C(4,"div",35)(5,"div"),W(6,"Hex"),A(),Be(7,g0e,2,0,"div",38),A()()}if(e&2){let i=ae();li("display",i.format!==0?"none":"block"),It("hex-alpha",i.cpAlphaChannel==="forced"),O(2),z("value",i.hexText),O(),z("ngIf",i.cpAlphaChannel==="forced"),O(4),z("ngIf",i.cpAlphaChannel==="forced")}}function _0e(e,t){if(e&1){let i=Ze();C(0,"input",39),Y("keyup.enter",function(n){q(i);let o=ae(2);return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae(2);return X(o.onAlphaInput(n))}),A()}if(e&2){let i=ae(2);z("rg",1)("value",i.hslaText==null?null:i.hslaText.a)}}function b0e(e,t){if(e&1){let i=Ze();C(0,"div",46)(1,"div",35)(2,"input",36),Y("keyup.enter",function(n){q(i);let o=ae();return X(o.onAcceptColor(n))})("newValue",function(n){q(i);let o=ae();return X(o.onValueInput(n))}),A(),Be(3,_0e,1,2,"input",37),A(),C(4,"div",35)(5,"div"),W(6,"V"),A(),C(7,"div"),W(8,"A"),A()()()}if(e&2){let i=ae();O(2),z("rg",100)("value",i.hslaText==null?null:i.hslaText.l),O(),z("ngIf",i.cpAlphaChannel!=="disabled")}}function y0e(e,t){if(e&1){let i=Ze();C(0,"div",47)(1,"span",48),Y("click",function(){q(i);let n=ae();return X(n.onFormatToggle(-1))}),A(),C(2,"span",48),Y("click",function(){q(i);let n=ae();return X(n.onFormatToggle(1))}),A()()}}function x0e(e,t){if(e&1){let i=Ze();C(0,"span",55),Y("click",function(n){q(i);let o=ae().$implicit,a=ae(3);return X(a.onRemovePresetColor(n,o))}),A()}if(e&2){let i=ae(4);Kr(i.cpRemoveColorButtonClass)}}function w0e(e,t){if(e&1){let i=Ze();C(0,"div",53),Y("click",function(){let n=q(i).$implicit,o=ae(3);return X(o.setColorFromString(n))}),Be(1,x0e,1,3,"span",54),A()}if(e&2){let i=t.$implicit,r=ae(3);li("background-color",i),O(),z("ngIf",r.cpAddColorButton)}}function E0e(e,t){if(e&1&&(C(0,"div"),Be(1,w0e,2,3,"div",52),A()),e&2){let i=ae(2);Kr(i.cpPresetColorsClass),O(),z("ngForOf",i.cpPresetColors)}}function C0e(e,t){if(e&1&&(C(0,"div"),W(1),A()),e&2){let i=ae(2);Kr(i.cpPresetEmptyMessageClass),O(),Pr(i.cpPresetEmptyMessage)}}function S0e(e,t){if(e&1&&(C(0,"div",49),he(1,"hr"),C(2,"div",50),W(3),A(),Be(4,E0e,2,4,"div",51)(5,C0e,2,4,"div",51),A()),e&2){let i=ae();O(3),Pr(i.cpPresetLabel),O(),z("ngIf",i.cpPresetColors==null?null:i.cpPresetColors.length),O(),z("ngIf",!(i.cpPresetColors!=null&&i.cpPresetColors.length)&&i.cpAddColorButton)}}function T0e(e,t){if(e&1){let i=Ze();C(0,"button",58),Y("click",function(n){q(i);let o=ae(2);return X(o.onCancelColor(n))}),W(1),A()}if(e&2){let i=ae(2);Kr(i.cpCancelButtonClass),O(),Pr(i.cpCancelButtonText)}}function A0e(e,t){if(e&1){let i=Ze();C(0,"button",58),Y("click",function(n){q(i);let o=ae(2);return X(o.onAcceptColor(n))}),W(1),A()}if(e&2){let i=ae(2);Kr(i.cpOKButtonClass),O(),Pr(i.cpOKButtonText)}}function D0e(e,t){if(e&1&&(C(0,"div",56),Be(1,T0e,2,4,"button",57)(2,A0e,2,4,"button",57),A()),e&2){let i=ae();O(),z("ngIf",i.cpCancelButton),O(),z("ngIf",i.cpOKButton)}}function I0e(e,t){e&1&&Yp(0)}function M0e(e,t){if(e&1&&(C(0,"div",59),Be(1,I0e,1,0,"ng-container",60),A()),e&2){let i=ae();O(),z("ngTemplateOutlet",i.cpExtraTemplate)}}var pa=function(e){return e[e.HEX=0]="HEX",e[e.RGBA=1]="RGBA",e[e.HSLA=2]="HSLA",e[e.CMYK=3]="CMYK",e}(pa||{}),wl=class{r;g;b;a;constructor(t,i,r,n){this.r=t,this.g=i,this.b=r,this.a=n}},Gm=class{h;s;v;a;constructor(t,i,r,n){this.h=t,this.s=i,this.v=r,this.a=n}},Qc=class{h;s;l;a;constructor(t,i,r,n){this.h=t,this.s=i,this.l=r,this.a=n}},yp=class{c;m;y;k;a;constructor(t,i,r,n,o=1){this.c=t,this.m=i,this.y=r,this.k=n,this.a=o}};function k0e(e,t){let i="right",r="bottom",{height:n,width:o}=e,{top:a,left:s}=t,c=a+t.height,l=s+t.width,d=a-n<0,u=c+n>(window.innerHeight||document.documentElement.clientHeight),h=s-o<0,p=l+o>(window.innerWidth||document.documentElement.clientWidth),m=d&&u&&h&&p;return u&&(r="top"),d&&(r="bottom"),h&&(i="right"),p&&(i="left"),m?["left","right","top","bottom"].reduce((g,v)=>e[g]>e[v]?g:v):h&&p?d?"bottom":u||a>c?"top":"bottom":d&&u?h?"right":p||s>l?"left":"right":`${r}-${i}`}function P0e(){let e="";typeof navigator<"u"&&(e=navigator.userAgent.toLowerCase());let t=e.indexOf("msie ");return t>0?parseInt(e.substring(t+5,e.indexOf(".",t)),10):!1}var N0e=(()=>{class e{rg;text;newValue=new We;inputChange(i){let r=i.target.value;if(this.rg===void 0)this.newValue.emit(r);else{let n=parseFloat(r);this.newValue.emit({v:n,rg:this.rg})}}static \u0275fac=function(r){return new(r||e)};static \u0275dir=xt({type:e,selectors:[["","text",""]],hostBindings:function(r,n){r&1&&Y("input",function(a){return n.inputChange(a)})},inputs:{rg:"rg",text:"text"},outputs:{newValue:"newValue"}})}return e})(),O0e=(()=>{class e{elRef;listenerMove;listenerStop;rgX;rgY;slider;dragEnd=new We;dragStart=new We;newValue=new We;mouseDown(i){this.start(i)}touchStart(i){this.start(i)}constructor(i){this.elRef=i,this.listenerMove=r=>this.move(r),this.listenerStop=()=>this.stop()}move(i){i.preventDefault(),this.setCursor(i)}start(i){this.setCursor(i),i.stopPropagation(),document.addEventListener("mouseup",this.listenerStop),document.addEventListener("touchend",this.listenerStop),document.addEventListener("mousemove",this.listenerMove),document.addEventListener("touchmove",this.listenerMove),this.dragStart.emit()}stop(){document.removeEventListener("mouseup",this.listenerStop),document.removeEventListener("touchend",this.listenerStop),document.removeEventListener("mousemove",this.listenerMove),document.removeEventListener("touchmove",this.listenerMove),this.dragEnd.emit()}getX(i){let r=this.elRef.nativeElement.getBoundingClientRect();return(i.pageX!==void 0?i.pageX:i.touches[0].pageX)-r.left-window.pageXOffset}getY(i){let r=this.elRef.nativeElement.getBoundingClientRect();return(i.pageY!==void 0?i.pageY:i.touches[0].pageY)-r.top-window.pageYOffset}setCursor(i){let r=this.elRef.nativeElement.offsetWidth,n=this.elRef.nativeElement.offsetHeight,o=Math.max(0,Math.min(this.getX(i),r)),a=Math.max(0,Math.min(this.getY(i),n));this.rgX!==void 0&&this.rgY!==void 0?this.newValue.emit({s:o/r,v:1-a/n,rgX:this.rgX,rgY:this.rgY}):this.rgX===void 0&&this.rgY!==void 0?this.newValue.emit({v:a/n,rgY:this.rgY}):this.rgX!==void 0&&this.rgY===void 0&&this.newValue.emit({v:o/r,rgX:this.rgX})}static \u0275fac=function(r){return new(r||e)(G(vt))};static \u0275dir=xt({type:e,selectors:[["","slider",""]],hostBindings:function(r,n){r&1&&Y("mousedown",function(a){return n.mouseDown(a)})("touchstart",function(a){return n.touchStart(a)})},inputs:{rgX:"rgX",rgY:"rgY",slider:"slider"},outputs:{dragEnd:"dragEnd",dragStart:"dragStart",newValue:"newValue"}})}return e})(),y2=class{h;s;v;a;constructor(t,i,r,n){this.h=t,this.s=i,this.v=r,this.a=n}},x2=class{h;s;v;a;constructor(t,i,r,n){this.h=t,this.s=i,this.v=r,this.a=n}},TH=(()=>{class e{active=null;setActive(i){this.active&&this.active!==i&&this.active.cpDialogDisplay!=="inline"&&this.active.closeDialog(),this.active=i}hsva2hsla(i){let r=i.h,n=i.s,o=i.v,a=i.a;if(o===0)return new Qc(r,0,0,a);if(n===0&&o===1)return new Qc(r,1,1,a);{let s=o*(2-n)/2;return new Qc(r,o*n/(1-Math.abs(2*s-1)),s,a)}}hsla2hsva(i){let r=Math.min(i.h,1),n=Math.min(i.s,1),o=Math.min(i.l,1),a=Math.min(i.a,1);if(o===0)return new Gm(r,0,0,a);{let s=o+n*(1-Math.abs(2*o-1))/2;return new Gm(r,2*(s-o)/s,s,a)}}hsvaToRgba(i){let r,n,o,a=i.h,s=i.s,c=i.v,l=i.a,d=Math.floor(a*6),u=a*6-d,h=c*(1-s),p=c*(1-u*s),m=c*(1-(1-u)*s);switch(d%6){case 0:r=c,n=m,o=h;break;case 1:r=p,n=c,o=h;break;case 2:r=h,n=c,o=m;break;case 3:r=h,n=p,o=c;break;case 4:r=m,n=h,o=c;break;case 5:r=c,n=h,o=p;break;default:r=0,n=0,o=0}return new wl(r,n,o,l)}cmykToRgb(i){let r=(1-i.c)*(1-i.k),n=(1-i.m)*(1-i.k),o=(1-i.y)*(1-i.k);return new wl(r,n,o,i.a)}rgbaToCmyk(i){let r=1-Math.max(i.r,i.g,i.b);if(r===1)return new yp(0,0,0,1,i.a);{let n=(1-i.r-r)/(1-r),o=(1-i.g-r)/(1-r),a=(1-i.b-r)/(1-r);return new yp(n,o,a,r,i.a)}}rgbaToHsva(i){let r,n,o=Math.min(i.r,1),a=Math.min(i.g,1),s=Math.min(i.b,1),c=Math.min(i.a,1),l=Math.max(o,a,s),d=Math.min(o,a,s),u=l,h=l-d;if(n=l===0?0:h/l,l===d)r=0;else{switch(l){case o:r=(a-s)/h+(a<s?6:0);break;case a:r=(s-o)/h+2;break;case s:r=(o-a)/h+4;break;default:r=0}r/=6}return new Gm(r,n,u,c)}rgbaToHex(i,r){let n="#"+(16777216|i.r<<16|i.g<<8|i.b).toString(16).substr(1);return r&&(n+=(256|Math.round(i.a*255)).toString(16).substr(1)),n}normalizeCMYK(i){return new yp(i.c/100,i.m/100,i.y/100,i.k/100,i.a)}denormalizeCMYK(i){return new yp(Math.floor(i.c*100),Math.floor(i.m*100),Math.floor(i.y*100),Math.floor(i.k*100),i.a)}denormalizeRGBA(i){return new wl(Math.round(i.r*255),Math.round(i.g*255),Math.round(i.b*255),i.a)}stringToHsva(i="",r=!1){let n=null;i=(i||"").toLowerCase();let o=[{re:/(rgb)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return new wl(parseInt(a[2],10)/255,parseInt(a[3],10)/255,parseInt(a[4],10)/255,isNaN(parseFloat(a[5]))?1:parseFloat(a[5]))}},{re:/(hsl)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return new Qc(parseInt(a[2],10)/360,parseInt(a[3],10)/100,parseInt(a[4],10)/100,isNaN(parseFloat(a[5]))?1:parseFloat(a[5]))}}];r?o.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})?$/,parse:function(a){return new wl(parseInt(a[1],16)/255,parseInt(a[2],16)/255,parseInt(a[3],16)/255,parseInt(a[4]||"FF",16)/255)}}):o.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,parse:function(a){return new wl(parseInt(a[1],16)/255,parseInt(a[2],16)/255,parseInt(a[3],16)/255,1)}}),o.push({re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,parse:function(a){return new wl(parseInt(a[1]+a[1],16)/255,parseInt(a[2]+a[2],16)/255,parseInt(a[3]+a[3],16)/255,1)}});for(let a in o)if(o.hasOwnProperty(a)){let s=o[a],c=s.re.exec(i),l=c&&s.parse(c);if(l)return l instanceof wl?n=this.rgbaToHsva(l):l instanceof Qc&&(n=this.hsla2hsva(l)),n}return n}outputFormat(i,r,n){switch(r==="auto"&&(r=i.a<1?"rgba":"hex"),r){case"hsla":let o=this.hsva2hsla(i),a=new Qc(Math.round(o.h*360),Math.round(o.s*100),Math.round(o.l*100),Math.round(o.a*100)/100);return i.a<1||n==="always"?"hsla("+a.h+","+a.s+"%,"+a.l+"%,"+a.a+")":"hsl("+a.h+","+a.s+"%,"+a.l+"%)";case"rgba":let s=this.denormalizeRGBA(this.hsvaToRgba(i));return i.a<1||n==="always"?"rgba("+s.r+","+s.g+","+s.b+","+Math.round(s.a*100)/100+")":"rgb("+s.r+","+s.g+","+s.b+")";default:let c=n==="always"||n==="forced";return this.rgbaToHex(this.denormalizeRGBA(this.hsvaToRgba(i)),c)}}static \u0275fac=function(r){return new(r||e)};static \u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),SH=typeof window<"u"&&"ontouchstart"in window,R0e=(()=>{class e{ngZone;elRef;cdRef;document;platformId;service;isIE10=!1;cmyk;hsva;width;height;cmykColor;outputColor;initialColor;fallbackColor;listenerResize;listenerMouseDown;directiveInstance;sliderH;sliderDimMax;directiveElementRef;dialogArrowSize=10;dialogArrowOffset=15;dialogInputFields=[pa.HEX,pa.RGBA,pa.HSLA,pa.CMYK];useRootViewContainer=!1;show;hidden;top;left;position;format;slider;hexText;hexAlpha;cmykText;hslaText;rgbaText;arrowTop;selectedColor;hueSliderColor;alphaSliderColor;cpWidth;cpHeight;cpColorMode;cpCmykEnabled;cpAlphaChannel;cpOutputFormat;cpDisableInput;cpDialogDisplay;cpIgnoredElements;cpSaveClickOutside;cpCloseClickOutside;cpPosition;cpUsePosition;cpPositionOffset;cpOKButton;cpOKButtonText;cpOKButtonClass;cpCancelButton;cpCancelButtonText;cpCancelButtonClass;cpEyeDropper;eyeDropperSupported;cpPresetLabel;cpPresetColors;cpPresetColorsClass;cpMaxPresetColorsLength;cpPresetEmptyMessage;cpPresetEmptyMessageClass;cpAddColorButton;cpAddColorButtonText;cpAddColorButtonClass;cpRemoveColorButtonClass;cpArrowPosition;cpTriggerElement;cpExtraTemplate;dialogElement;hueSlider;alphaSlider;handleEsc(i){this.show&&this.cpDialogDisplay==="popup"&&this.onCancelColor(i)}handleEnter(i){this.show&&this.cpDialogDisplay==="popup"&&this.onAcceptColor(i)}constructor(i,r,n,o,a,s){this.ngZone=i,this.elRef=r,this.cdRef=n,this.document=o,this.platformId=a,this.service=s,this.eyeDropperSupported=$b(this.platformId)&&"EyeDropper"in this.document.defaultView}ngOnInit(){this.slider=new y2(0,0,0,0);let i=this.hueSlider.nativeElement.offsetWidth||140,r=this.alphaSlider.nativeElement.offsetWidth||140;this.sliderDimMax=new x2(i,this.cpWidth,130,r),this.cpCmykEnabled?this.format=pa.CMYK:this.cpOutputFormat==="rgba"?this.format=pa.RGBA:this.cpOutputFormat==="hsla"?this.format=pa.HSLA:this.format=pa.HEX,this.listenerMouseDown=n=>{this.onMouseDown(n)},this.listenerResize=()=>{this.onResize()},this.openDialog(this.initialColor,!1)}ngOnDestroy(){this.closeDialog()}ngAfterViewInit(){if(this.cpWidth!==230||this.cpDialogDisplay==="inline"){let i=this.hueSlider.nativeElement.offsetWidth||140,r=this.alphaSlider.nativeElement.offsetWidth||140;this.sliderDimMax=new x2(i,this.cpWidth,130,r),this.updateColorPicker(!1),this.cdRef.detectChanges()}}openDialog(i,r=!0){this.service.setActive(this),this.width||(this.cpWidth=this.directiveElementRef.nativeElement.offsetWidth),this.height||(this.height=320),this.setInitialColor(i),this.setColorFromString(i,r),this.openColorPicker()}closeDialog(){this.closeColorPicker()}setupDialog(i,r,n,o,a,s,c,l,d,u,h,p,m,f,g,v,_,b,y,x,w,I,S,E,N,M,P,$,R,j,B,te,Z,ne,se,we,ie,ue){this.setInitialColor(n),this.setColorMode(l),this.isIE10=P0e()===10,this.directiveInstance=i,this.directiveElementRef=r,this.cpDisableInput=p,this.cpCmykEnabled=d,this.cpAlphaChannel=u,this.cpOutputFormat=h,this.cpDialogDisplay=s,this.cpIgnoredElements=m,this.cpSaveClickOutside=f,this.cpCloseClickOutside=g,this.useRootViewContainer=v,this.width=this.cpWidth=parseInt(o,10),this.height=this.cpHeight=parseInt(a,10),this.cpPosition=_,this.cpPositionOffset=parseInt(b,10),this.cpOKButton=M,this.cpOKButtonText=$,this.cpOKButtonClass=P,this.cpCancelButton=R,this.cpCancelButtonText=B,this.cpCancelButtonClass=j,this.cpEyeDropper=we,this.fallbackColor=c||"#fff",this.setPresetConfig(x,w),this.cpPresetColorsClass=I,this.cpMaxPresetColorsLength=S,this.cpPresetEmptyMessage=E,this.cpPresetEmptyMessageClass=N,this.cpAddColorButton=te,this.cpAddColorButtonText=ne,this.cpAddColorButtonClass=Z,this.cpRemoveColorButtonClass=se,this.cpTriggerElement=ie,this.cpExtraTemplate=ue,y||(this.dialogArrowOffset=0),s==="inline"&&(this.dialogArrowSize=0,this.dialogArrowOffset=0),h==="hex"&&u!=="always"&&u!=="forced"&&(this.cpAlphaChannel="disabled")}setColorMode(i){switch(i.toString().toUpperCase()){case"1":case"C":case"COLOR":this.cpColorMode=1;break;case"2":case"G":case"GRAYSCALE":this.cpColorMode=2;break;case"3":case"P":case"PRESETS":this.cpColorMode=3;break;default:this.cpColorMode=1}}setInitialColor(i){this.initialColor=i}setPresetConfig(i,r){this.cpPresetLabel=i,this.cpPresetColors=r}setColorFromString(i,r=!0,n=!0){let o;this.cpAlphaChannel==="always"||this.cpAlphaChannel==="forced"?(o=this.service.stringToHsva(i,!0),!o&&!this.hsva&&(o=this.service.stringToHsva(i,!1))):o=this.service.stringToHsva(i,!1),!o&&!this.hsva&&(o=this.service.stringToHsva(this.fallbackColor,!1)),o&&(this.hsva=o,this.sliderH=this.hsva.h,this.cpOutputFormat==="hex"&&this.cpAlphaChannel==="disabled"&&(this.hsva.a=1),this.updateColorPicker(r,n))}onResize(){this.position==="fixed"?this.setDialogPosition():this.cpDialogDisplay!=="inline"&&this.closeColorPicker()}onDragEnd(i){this.directiveInstance.sliderDragEnd({slider:i,color:this.outputColor})}onDragStart(i){this.directiveInstance.sliderDragStart({slider:i,color:this.outputColor})}onMouseDown(i){this.show&&!this.isIE10&&this.cpDialogDisplay==="popup"&&i.target!==this.directiveElementRef.nativeElement&&!this.isDescendant(this.elRef.nativeElement,i.target)&&!this.isDescendant(this.directiveElementRef.nativeElement,i.target)&&this.cpIgnoredElements.filter(r=>r===i.target).length===0&&this.ngZone.run(()=>{this.cpSaveClickOutside?this.directiveInstance.colorSelected(this.outputColor):(this.hsva=null,this.setColorFromString(this.initialColor,!1),this.cpCmykEnabled&&this.directiveInstance.cmykChanged(this.cmykColor),this.directiveInstance.colorChanged(this.initialColor),this.directiveInstance.colorCanceled()),this.cpCloseClickOutside&&this.closeColorPicker()})}onAcceptColor(i){i.stopPropagation(),this.outputColor&&this.directiveInstance.colorSelected(this.outputColor),this.cpDialogDisplay==="popup"&&this.closeColorPicker()}onCancelColor(i){this.hsva=null,i.stopPropagation(),this.directiveInstance.colorCanceled(),this.setColorFromString(this.initialColor,!0),this.cpDialogDisplay==="popup"&&(this.cpCmykEnabled&&this.directiveInstance.cmykChanged(this.cmykColor),this.directiveInstance.colorChanged(this.initialColor,!0),this.closeColorPicker())}onEyeDropper(){if(!this.eyeDropperSupported)return;new window.EyeDropper().open().then(r=>{this.setColorFromString(r.sRGBHex,!0)})}onFormatToggle(i){let r=this.dialogInputFields.length-(this.cpCmykEnabled?0:1),n=((this.dialogInputFields.indexOf(this.format)+i)%r+r)%r;this.format=this.dialogInputFields[n]}onColorChange(i){this.hsva.s=i.s/i.rgX,this.hsva.v=i.v/i.rgY,this.updateColorPicker(),this.directiveInstance.sliderChanged({slider:"lightness",value:this.hsva.v,color:this.outputColor}),this.directiveInstance.sliderChanged({slider:"saturation",value:this.hsva.s,color:this.outputColor})}onHueChange(i){this.hsva.h=i.v/i.rgX,this.sliderH=this.hsva.h,this.updateColorPicker(),this.directiveInstance.sliderChanged({slider:"hue",value:this.hsva.h,color:this.outputColor})}onValueChange(i){this.hsva.v=i.v/i.rgX,this.updateColorPicker(),this.directiveInstance.sliderChanged({slider:"value",value:this.hsva.v,color:this.outputColor})}onAlphaChange(i){this.hsva.a=i.v/i.rgX,this.updateColorPicker(),this.directiveInstance.sliderChanged({slider:"alpha",value:this.hsva.a,color:this.outputColor})}onHexInput(i){if(i===null)this.updateColorPicker();else{i&&i[0]!=="#"&&(i="#"+i);let r=/^#([a-f0-9]{3}|[a-f0-9]{6})$/gi;this.cpAlphaChannel==="always"&&(r=/^#([a-f0-9]{3}|[a-f0-9]{6}|[a-f0-9]{8})$/gi);let n=r.test(i);n&&(i.length<5&&(i="#"+i.substring(1).split("").map(o=>o+o).join("")),this.cpAlphaChannel==="forced"&&(i+=Math.round(this.hsva.a*255).toString(16)),this.setColorFromString(i,!0,!1)),this.directiveInstance.inputChanged({input:"hex",valid:n,value:i,color:this.outputColor})}}onRedInput(i){let r=this.service.hsvaToRgba(this.hsva),n=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;n&&(r.r=i.v/i.rg,this.hsva=this.service.rgbaToHsva(r),this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"red",valid:n,value:r.r,color:this.outputColor})}onBlueInput(i){let r=this.service.hsvaToRgba(this.hsva),n=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;n&&(r.b=i.v/i.rg,this.hsva=this.service.rgbaToHsva(r),this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"blue",valid:n,value:r.b,color:this.outputColor})}onGreenInput(i){let r=this.service.hsvaToRgba(this.hsva),n=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;n&&(r.g=i.v/i.rg,this.hsva=this.service.rgbaToHsva(r),this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"green",valid:n,value:r.g,color:this.outputColor})}onHueInput(i){let r=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;r&&(this.hsva.h=i.v/i.rg,this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"hue",valid:r,value:this.hsva.h,color:this.outputColor})}onValueInput(i){let r=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;r&&(this.hsva.v=i.v/i.rg,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"value",valid:r,value:this.hsva.v,color:this.outputColor})}onAlphaInput(i){let r=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;r&&(this.hsva.a=i.v/i.rg,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"alpha",valid:r,value:this.hsva.a,color:this.outputColor})}onLightnessInput(i){let r=this.service.hsva2hsla(this.hsva),n=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;n&&(r.l=i.v/i.rg,this.hsva=this.service.hsla2hsva(r),this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"lightness",valid:n,value:r.l,color:this.outputColor})}onSaturationInput(i){let r=this.service.hsva2hsla(this.hsva),n=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;n&&(r.s=i.v/i.rg,this.hsva=this.service.hsla2hsva(r),this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"saturation",valid:n,value:r.s,color:this.outputColor})}onCyanInput(i){!isNaN(i.v)&&i.v>=0&&i.v<=i.rg&&(this.cmyk.c=i.v,this.updateColorPicker(!1,!0,!0)),this.directiveInstance.inputChanged({input:"cyan",valid:!0,value:this.cmyk.c,color:this.outputColor})}onMagentaInput(i){!isNaN(i.v)&&i.v>=0&&i.v<=i.rg&&(this.cmyk.m=i.v,this.updateColorPicker(!1,!0,!0)),this.directiveInstance.inputChanged({input:"magenta",valid:!0,value:this.cmyk.m,color:this.outputColor})}onYellowInput(i){!isNaN(i.v)&&i.v>=0&&i.v<=i.rg&&(this.cmyk.y=i.v,this.updateColorPicker(!1,!0,!0)),this.directiveInstance.inputChanged({input:"yellow",valid:!0,value:this.cmyk.y,color:this.outputColor})}onBlackInput(i){!isNaN(i.v)&&i.v>=0&&i.v<=i.rg&&(this.cmyk.k=i.v,this.updateColorPicker(!1,!0,!0)),this.directiveInstance.inputChanged({input:"black",valid:!0,value:this.cmyk.k,color:this.outputColor})}onAddPresetColor(i,r){i.stopPropagation(),this.cpPresetColors.filter(n=>n===r).length||(this.cpPresetColors=this.cpPresetColors.concat(r),this.directiveInstance.presetColorsChanged(this.cpPresetColors))}onRemovePresetColor(i,r){i.stopPropagation(),this.cpPresetColors=this.cpPresetColors.filter(n=>n!==r),this.directiveInstance.presetColorsChanged(this.cpPresetColors)}openColorPicker(){this.show||(this.show=!0,this.hidden=!0,setTimeout(()=>{this.hidden=!1,this.setDialogPosition(),this.cdRef.detectChanges()},0),this.directiveInstance.stateChanged(!0),this.isIE10||this.ngZone.runOutsideAngular(()=>{SH?document.addEventListener("touchstart",this.listenerMouseDown):document.addEventListener("mousedown",this.listenerMouseDown)}),window.addEventListener("resize",this.listenerResize))}closeColorPicker(){this.show&&(this.show=!1,this.directiveInstance.stateChanged(!1),this.isIE10||(SH?document.removeEventListener("touchstart",this.listenerMouseDown):document.removeEventListener("mousedown",this.listenerMouseDown)),window.removeEventListener("resize",this.listenerResize),this.cdRef.destroyed||this.cdRef.detectChanges())}updateColorPicker(i=!0,r=!0,n=!1){if(this.sliderDimMax){this.cpColorMode===2&&(this.hsva.s=0);let o,a,s,c=this.outputColor;if(a=this.service.hsva2hsla(this.hsva),this.cpCmykEnabled?(n?(s=this.service.cmykToRgb(this.service.normalizeCMYK(this.cmyk)),this.hsva=this.service.rgbaToHsva(s)):(s=this.service.hsvaToRgba(this.hsva),this.cmyk=this.service.denormalizeCMYK(this.service.rgbaToCmyk(s))),s=this.service.denormalizeRGBA(s),this.sliderH=this.hsva.h):s=this.service.denormalizeRGBA(this.service.hsvaToRgba(this.hsva)),o=this.service.denormalizeRGBA(this.service.hsvaToRgba(new Gm(this.sliderH||this.hsva.h,1,1,1))),r){this.hslaText=new Qc(Math.round(a.h*360),Math.round(a.s*100),Math.round(a.l*100),Math.round(a.a*100)/100),this.rgbaText=new wl(s.r,s.g,s.b,Math.round(s.a*100)/100),this.cpCmykEnabled&&(this.cmykText=new yp(this.cmyk.c,this.cmyk.m,this.cmyk.y,this.cmyk.k,Math.round(this.cmyk.a*100)/100));let l=this.cpAlphaChannel==="always";this.hexText=this.service.rgbaToHex(s,l),this.hexAlpha=this.rgbaText.a}if(this.cpOutputFormat==="auto"&&this.format!==pa.RGBA&&this.format!==pa.CMYK&&this.format!==pa.HSLA&&this.hsva.a<1&&(this.format=this.hsva.a<1?pa.RGBA:pa.HEX),this.hueSliderColor="rgb("+o.r+","+o.g+","+o.b+")",this.alphaSliderColor="rgb("+s.r+","+s.g+","+s.b+")",this.outputColor=this.service.outputFormat(this.hsva,this.cpOutputFormat,this.cpAlphaChannel),this.selectedColor=this.service.outputFormat(this.hsva,"rgba",null),this.format!==pa.CMYK)this.cmykColor="";else if(this.cpAlphaChannel==="always"||this.cpAlphaChannel==="enabled"||this.cpAlphaChannel==="forced"){let l=Math.round(this.cmyk.a*100)/100;this.cmykColor=`cmyka(${this.cmyk.c},${this.cmyk.m},${this.cmyk.y},${this.cmyk.k},${l})`}else this.cmykColor=`cmyk(${this.cmyk.c},${this.cmyk.m},${this.cmyk.y},${this.cmyk.k})`;this.slider=new y2((this.sliderH||this.hsva.h)*this.sliderDimMax.h-8,this.hsva.s*this.sliderDimMax.s-8,(1-this.hsva.v)*this.sliderDimMax.v-8,this.hsva.a*this.sliderDimMax.a-8),i&&c!==this.outputColor&&(this.cpCmykEnabled&&this.directiveInstance.cmykChanged(this.cmykColor),this.directiveInstance.colorChanged(this.outputColor))}}setDialogPosition(){if(this.cpDialogDisplay==="inline")this.position="relative";else{let i="static",r="",n,o=null,a=null,s=this.directiveElementRef.nativeElement.parentNode,c=this.dialogElement.nativeElement.offsetHeight;for(;s!==null&&s.tagName!=="HTML";){if(n=window.getComputedStyle(s),i=n.getPropertyValue("position"),r=n.getPropertyValue("transform"),i!=="static"&&o===null&&(o=s),r&&r!=="none"&&a===null&&(a=s),i==="fixed"){o=a;break}s=s.parentNode}let l=this.createDialogBox(this.directiveElementRef.nativeElement,i!=="fixed");if(this.useRootViewContainer||i==="fixed"&&(!o||o instanceof HTMLUnknownElement))this.top=l.top,this.left=l.left;else{o===null&&(o=s);let v=this.createDialogBox(o,i!=="fixed");this.top=l.top-v.top,this.left=l.left-v.left}i==="fixed"&&(this.position="fixed");let d=this.cpPosition,u=this.dialogElement.nativeElement.getBoundingClientRect();if(this.cpPosition==="auto"){let v=this.cpTriggerElement.nativeElement.getBoundingClientRect();d=k0e(u,v)}switch(this.arrowTop=d==="top"?c-1:void 0,this.cpArrowPosition=void 0,d){case"top":this.top-=c+this.dialogArrowSize,this.left+=this.cpPositionOffset/100*l.width-this.dialogArrowOffset;break;case"bottom":this.top+=l.height+this.dialogArrowSize,this.left+=this.cpPositionOffset/100*l.width-this.dialogArrowOffset;break;case"top-left":case"left-top":this.top-=c-l.height+l.height*this.cpPositionOffset/100,this.left-=this.cpWidth+this.dialogArrowSize-2-this.dialogArrowOffset;break;case"top-right":case"right-top":this.top-=c-l.height+l.height*this.cpPositionOffset/100,this.left+=l.width+this.dialogArrowSize-2-this.dialogArrowOffset;break;case"left":case"bottom-left":case"left-bottom":this.top+=l.height*this.cpPositionOffset/100-this.dialogArrowOffset,this.left-=this.cpWidth+this.dialogArrowSize-2;break;case"right":case"bottom-right":case"right-bottom":default:this.top+=l.height*this.cpPositionOffset/100-this.dialogArrowOffset,this.left+=l.width+this.dialogArrowSize-2;break}let h=window.innerHeight,p=window.innerWidth,m=this.elRef.nativeElement.getBoundingClientRect();this.top+u.height>h&&(this.top=h-u.height,this.cpArrowPosition=m.x/2-20),this.left+u.width>p&&(this.left=p-u.width,this.cpArrowPosition=m.x/2-20),this.cpUsePosition=d}}isDescendant(i,r){let n=r.parentNode;for(;n!==null;){if(n===i)return!0;n=n.parentNode}return!1}createDialogBox(i,r){let{top:n,left:o}=i.getBoundingClientRect();return{top:n+(r?window.pageYOffset:0),left:o+(r?window.pageXOffset:0),width:i.offsetWidth,height:i.offsetHeight}}static \u0275fac=function(r){return new(r||e)(G(st),G(vt),G(ei),G(Bt),G(mc),G(TH))};static \u0275cmp=Le({type:e,selectors:[["color-picker"]],viewQuery:function(r,n){if(r&1&&(ht(Qve,7),ht(Jve,7),ht(e0e,7)),r&2){let o;Ve(o=ze())&&(n.dialogElement=o.first),Ve(o=ze())&&(n.hueSlider=o.first),Ve(o=ze())&&(n.alphaSlider=o.first)}},hostBindings:function(r,n){r&1&&Y("keyup.esc",function(a){return n.handleEsc(a)},!1,pC)("keyup.enter",function(a){return n.handleEnter(a)},!1,pC)},decls:30,vars:51,consts:[["dialogPopup",""],["hueSlider",""],["valueSlider",""],["alphaSlider",""],[1,"color-picker",3,"click"],[3,"left","class","top",4,"ngIf"],["class","saturation-lightness",3,"slider","rgX","rgY","background-color","newValue","dragStart","dragEnd",4,"ngIf"],[1,"hue-alpha","box"],[1,"left"],[1,"selected-color-background"],[1,"selected-color",3,"click"],["class","eyedropper-icon","xmlns","http://www.w3.org/2000/svg","height","24px","viewBox","0 0 24 24","width","24px","fill","#000000",4,"ngIf"],["type","button",3,"class","disabled","click",4,"ngIf"],[1,"right"],["style","height: 16px;",4,"ngIf"],[1,"hue",3,"newValue","dragStart","dragEnd","slider","rgX"],[1,"cursor"],[1,"value",3,"newValue","dragStart","dragEnd","slider","rgX"],[1,"alpha",3,"newValue","dragStart","dragEnd","slider","rgX"],["class","cmyk-text",3,"display",4,"ngIf"],["class","hsla-text",3,"display",4,"ngIf"],["class","rgba-text",3,"display",4,"ngIf"],["class","hex-text",3,"hex-alpha","display",4,"ngIf"],["class","value-text",4,"ngIf"],["class","type-policy",4,"ngIf"],["class","preset-area",4,"ngIf"],["class","button-area",4,"ngIf"],["class","extra-template",4,"ngIf"],[1,"saturation-lightness",3,"newValue","dragStart","dragEnd","slider","rgX","rgY"],["xmlns","http://www.w3.org/2000/svg","height","24px","viewBox","0 0 24 24","width","24px","fill","#000000",1,"eyedropper-icon"],["d","M0 0h24v24H0V0z","fill","none"],["d","M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"],["type","button",3,"click","disabled"],[2,"height","16px"],[1,"cmyk-text"],[1,"box"],["type","number","pattern","[0-9]*","min","0","max","100",3,"keyup.enter","newValue","text","rg","value"],["type","number","pattern","[0-9]+([\\.,][0-9]{1,2})?","min","0","max","1","step","0.1",3,"text","rg","value","keyup.enter","newValue",4,"ngIf"],[4,"ngIf"],["type","number","pattern","[0-9]+([\\.,][0-9]{1,2})?","min","0","max","1","step","0.1",3,"keyup.enter","newValue","text","rg","value"],[1,"hsla-text"],["type","number","pattern","[0-9]*","min","0","max","360",3,"keyup.enter","newValue","text","rg","value"],[1,"rgba-text"],["type","number","pattern","[0-9]*","min","0","max","255",3,"keyup.enter","newValue","text","rg","value"],[1,"hex-text"],[3,"blur","keyup.enter","newValue","text","value"],[1,"value-text"],[1,"type-policy"],[1,"type-policy-arrow",3,"click"],[1,"preset-area"],[1,"preset-label"],[3,"class",4,"ngIf"],["class","preset-color",3,"backgroundColor","click",4,"ngFor","ngForOf"],[1,"preset-color",3,"click"],[3,"class","click",4,"ngIf"],[3,"click"],[1,"button-area"],["type","button",3,"class","click",4,"ngIf"],["type","button",3,"click"],[1,"extra-template"],[4,"ngTemplateOutlet"]],template:function(r,n){if(r&1){let o=Ze();C(0,"div",4,0),Y("click",function(s){return q(o),X(s.stopPropagation())}),Be(2,t0e,1,7,"div",5)(3,i0e,2,8,"div",6),C(4,"div",7)(5,"div",8),he(6,"div",9),C(7,"div",10),Y("click",function(){return q(o),X(n.eyeDropperSupported&&n.cpEyeDropper&&n.onEyeDropper())}),Be(8,r0e,3,0,"svg",11),A(),Be(9,n0e,2,5,"button",12),A(),C(10,"div",13),Be(11,o0e,1,0,"div",14),C(12,"div",15,1),Y("newValue",function(s){return q(o),X(n.onHueChange(s))})("dragStart",function(){return q(o),X(n.onDragStart("hue"))})("dragEnd",function(){return q(o),X(n.onDragEnd("hue"))}),he(14,"div",16),A(),C(15,"div",17,2),Y("newValue",function(s){return q(o),X(n.onValueChange(s))})("dragStart",function(){return q(o),X(n.onDragStart("value"))})("dragEnd",function(){return q(o),X(n.onDragEnd("value"))}),he(17,"div",16),A(),C(18,"div",18,3),Y("newValue",function(s){return q(o),X(n.onAlphaChange(s))})("dragStart",function(){return q(o),X(n.onDragStart("alpha"))})("dragEnd",function(){return q(o),X(n.onDragEnd("alpha"))}),he(20,"div",16),A()()(),Be(21,l0e,17,12,"div",19)(22,u0e,14,10,"div",20)(23,f0e,14,10,"div",21)(24,v0e,8,7,"div",22)(25,b0e,9,3,"div",23)(26,y0e,3,0,"div",24)(27,S0e,6,3,"div",25)(28,D0e,3,2,"div",26)(29,M0e,2,1,"div",27),A()}r&2&&(li("display",n.show?"block":"none")("visibility",n.hidden?"hidden":"visible")("top",n.top,"px")("left",n.left,"px")("position",n.position)("height",n.cpHeight,"px")("width",n.cpWidth,"px"),It("open",n.show),O(2),z("ngIf",n.cpDialogDisplay==="popup"),O(),z("ngIf",(n.cpColorMode||1)===1),O(4),li("background-color",n.selectedColor)("cursor",n.eyeDropperSupported&&n.cpEyeDropper?"pointer":null),O(),z("ngIf",n.eyeDropperSupported&&n.cpEyeDropper),O(),z("ngIf",n.cpAddColorButton),O(2),z("ngIf",n.cpAlphaChannel==="disabled"),O(),li("display",(n.cpColorMode||1)===1?"block":"none"),z("rgX",1),O(2),li("left",n.slider==null?null:n.slider.h,"px"),O(),li("display",(n.cpColorMode||1)===2?"block":"none"),z("rgX",1),O(2),li("right",n.slider==null?null:n.slider.v,"px"),O(),li("display",n.cpAlphaChannel==="disabled"?"none":"block")("background-color",n.alphaSliderColor),z("rgX",1),O(2),li("left",n.slider==null?null:n.slider.a,"px"),O(),z("ngIf",!n.cpDisableInput&&(n.cpColorMode||1)===1),O(),z("ngIf",!n.cpDisableInput&&(n.cpColorMode||1)===1),O(),z("ngIf",!n.cpDisableInput&&(n.cpColorMode||1)===1),O(),z("ngIf",!n.cpDisableInput&&(n.cpColorMode||1)===1),O(),z("ngIf",!n.cpDisableInput&&(n.cpColorMode||1)===2),O(),z("ngIf",!n.cpDisableInput&&(n.cpColorMode||1)===1),O(),z("ngIf",(n.cpPresetColors==null?null:n.cpPresetColors.length)||n.cpAddColorButton),O(),z("ngIf",n.cpOKButton||n.cpCancelButton),O(),z("ngIf",n.cpExtraTemplate))},dependencies:[Xn,Yn,th,N0e,O0e],styles:[`.color-picker{position:absolute;z-index:1000;width:230px;height:auto;border:#777 solid 1px;cursor:default;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:#fff}.color-picker *{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;margin:0;font-size:11px}.color-picker input{width:0;height:26px;min-width:0;font-size:13px;text-align:center;color:#000}.color-picker input:invalid,.color-picker input:-moz-ui-invalid,.color-picker input:-moz-submit-invalid{box-shadow:none}.color-picker input::-webkit-inner-spin-button,.color-picker input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none}.color-picker .arrow{position:absolute;z-index:999999;width:0;height:0;border-style:solid}.color-picker .arrow.arrow-top{left:8px;border-width:10px 5px;border-color:#777 rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0)}.color-picker .arrow.arrow-bottom{top:-20px;left:8px;border-width:10px 5px;border-color:rgba(0,0,0,0) rgba(0,0,0,0) #777 rgba(0,0,0,0)}.color-picker .arrow.arrow-top-left,.color-picker .arrow.arrow-left-top{right:-21px;bottom:8px;border-width:5px 10px;border-color:rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0) #777}.color-picker .arrow.arrow-top-right,.color-picker .arrow.arrow-right-top{bottom:8px;left:-20px;border-width:5px 10px;border-color:rgba(0,0,0,0) #777 rgba(0,0,0,0) rgba(0,0,0,0)}.color-picker .arrow.arrow-left,.color-picker .arrow.arrow-left-bottom,.color-picker .arrow.arrow-bottom-left{top:8px;right:-21px;border-width:5px 10px;border-color:rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0) #777}.color-picker .arrow.arrow-right,.color-picker .arrow.arrow-right-bottom,.color-picker .arrow.arrow-bottom-right{top:8px;left:-20px;border-width:5px 10px;border-color:rgba(0,0,0,0) #777 rgba(0,0,0,0) rgba(0,0,0,0)}.color-picker .cursor{position:relative;width:16px;height:16px;border:#222 solid 2px;border-radius:50%;cursor:default}.color-picker .box{display:flex;padding:4px 8px}.color-picker .left{position:relative;padding:16px 8px}.color-picker .right{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;padding:12px 8px}.color-picker .button-area{padding:0 16px 16px;text-align:right}.color-picker .button-area button{margin-left:8px}.color-picker .preset-area{padding:4px 15px}.color-picker .preset-area .preset-label{overflow:hidden;width:100%;padding:4px;font-size:11px;white-space:nowrap;text-align:left;text-overflow:ellipsis;color:#555}.color-picker .preset-area .preset-color{position:relative;display:inline-block;width:18px;height:18px;margin:4px 6px 8px;border:#a9a9a9 solid 1px;border-radius:25%;cursor:pointer}.color-picker .preset-area .preset-empty-message{min-height:18px;margin-top:4px;margin-bottom:8px;font-style:italic;text-align:center}.color-picker .hex-text{width:100%;padding:4px 8px;font-size:11px}.color-picker .hex-text .box{padding:0 24px 8px 8px}.color-picker .hex-text .box div{float:left;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;text-align:center;color:#555;clear:left}.color-picker .hex-text .box input{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;padding:1px;border:#a9a9a9 solid 1px}.color-picker .hex-alpha .box div:first-child,.color-picker .hex-alpha .box input:first-child{flex-grow:3;margin-right:8px}.color-picker .cmyk-text,.color-picker .hsla-text,.color-picker .rgba-text,.color-picker .value-text{width:100%;padding:4px 8px;font-size:11px}.color-picker .cmyk-text .box,.color-picker .hsla-text .box,.color-picker .rgba-text .box{padding:0 24px 8px 8px}.color-picker .value-text .box{padding:0 8px 8px}.color-picker .cmyk-text .box div,.color-picker .hsla-text .box div,.color-picker .rgba-text .box div,.color-picker .value-text .box div{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;margin-right:8px;text-align:center;color:#555}.color-picker .cmyk-text .box div:last-child,.color-picker .hsla-text .box div:last-child,.color-picker .rgba-text .box div:last-child,.color-picker .value-text .box div:last-child{margin-right:0}.color-picker .cmyk-text .box input,.color-picker .hsla-text .box input,.color-picker .rgba-text .box input,.color-picker .value-text .box input{float:left;-webkit-flex:1;-ms-flex:1;flex:1;padding:1px;margin:0 8px 0 0;border:#a9a9a9 solid 1px}.color-picker .cmyk-text .box input:last-child,.color-picker .hsla-text .box input:last-child,.color-picker .rgba-text .box input:last-child,.color-picker .value-text .box input:last-child{margin-right:0}.color-picker .hue-alpha{align-items:center;margin-bottom:3px}.color-picker .hue{direction:ltr;width:100%;height:16px;margin-bottom:16px;border:none;cursor:pointer;background-size:100% 100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAAQCAYAAAD06IYnAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AIWDwkUFWbCCAAAAFxJREFUaN7t0kEKg0AQAME2x83/n2qu5qCgD1iDhCoYdpnbQC9bbY1qVO/jvc6k3ad91s7/7F1/csgPrujuQ17BDYSFsBAWwgJhISyEBcJCWAgLhIWwEBYIi2f7Ar/1TCgFH2X9AAAAAElFTkSuQmCC)}.color-picker .value{direction:rtl;width:100%;height:16px;margin-bottom:16px;border:none;cursor:pointer;background-size:100% 100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAAQCAYAAAD06IYnAAACTklEQVR42u3SYUcrABhA4U2SkmRJMmWSJklKJiWZZpKUJJskKUmaTFImKZOUzMySpGRmliRNJilJSpKSJEtmSpIpmWmSdO736/6D+x7OP3gUCoWCv1cqlSQlJZGcnExKSgqpqamkpaWRnp5ORkYGmZmZqFQqsrKyyM7OJicnh9zcXNRqNXl5eeTn56PRaCgoKKCwsJCioiK0Wi3FxcWUlJRQWlpKWVkZ5eXlVFRUUFlZiU6no6qqiurqampqaqitraWurg69Xk99fT0GgwGj0UhDQwONjY00NTXR3NxMS0sLra2ttLW10d7ejslkwmw209HRQWdnJ11dXXR3d9PT00Nvby99fX309/czMDDA4OAgFouFoaEhrFYrw8PDjIyMMDo6ytjYGDabjfHxcSYmJpicnGRqagq73c709DQzMzPMzs4yNzfH/Pw8DocDp9OJy+XC7XazsLDA4uIiS0tLLC8vs7KywurqKmtra3g8HrxeLz6fD7/fz/r6OhsbG2xubrK1tcX29jaBQICdnR2CwSC7u7vs7e2xv7/PwcEBh4eHHB0dcXx8zMnJCaenp5ydnXF+fs7FxQWXl5dcXV1xfX3Nzc0Nt7e33N3dEQqFuL+/5+HhgXA4TCQS4fHxkaenJ56fn3l5eeH19ZVoNMrb2xvv7+98fHwQi8WIx+N8fn6SSCT4+vri+/ubn58ffn9/+VcKgSWwBJbAElgCS2AJLIElsASWwBJYAktgCSyBJbAElsASWAJLYAksgSWwBJbAElgCS2AJLIElsP4/WH8AmJ5Z6jHS4h8AAAAASUVORK5CYII=)}.color-picker .alpha{direction:ltr;width:100%;height:16px;border:none;cursor:pointer;background-size:100% 100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAAQCAYAAAD06IYnAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AIWDwYQlZMa3gAAAWVJREFUaN7tmEGO6jAQRCsOArHgBpyAJYGjcGocxAm4A2IHpmoWE0eBH+ezmFlNvU06shJ3W6VEelWMUQAIIF9f6qZpimsA1LYtS2uF51/u27YVAFZVRUkEoGHdPV/sIcbIEIIkUdI/9Xa7neyv61+SWFUVAVCSct00TWn2fv6u3+Ecfd3tXzy/0+nEUu+SPjo/kqzrmiQpScN6v98XewfA8/lMkiLJ2WxGSUopcT6fM6U0NX9/frfbjev1WtfrlZfLhYfDQQHG/AIOlnGwjINlHCxjHCzjYJm/TJWdCwquJXseFFzGwDNNeiKMOJTO8xQdDQaeB29+K9efeLaBo9J7vdvtJj1RjFFjfiv7qv95tjx/7leSQgh93e1ffMeIp6O+YQjho/N791t1XVOSSI7N//K+4/GoxWLBx+PB5/Op5XLJ+/3OlJJWqxU3m83ovv5iGf8KjYNlHCxjHCzjYBkHy5gf5gusvQU7U37jTAAAAABJRU5ErkJggg==)}.color-picker .type-policy{position:absolute;top:218px;right:12px;width:16px;height:24px;background-size:8px 16px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAgCAYAAAAffCjxAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACewAAAnsB01CO3AAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIASURBVEiJ7ZY9axRRFIafsxMStrLQJpAgpBFhi+C9w1YSo00I6RZ/g9vZpBf/QOr4GyRgkSKNSrAadsZqQGwCkuAWyRZJsySwvhZ7N/vhzrgbLH3Ld8597jlzz50zJokyxXH8DqDVar0qi6v8BbItqSGpEcfxdlmsFWXkvX8AfAVWg3UKPEnT9GKujMzsAFgZsVaCN1VTQd77XUnrgE1kv+6935268WRpzrnHZvYRWC7YvC3pRZZl3wozqtVqiyH9IgjAspkd1Gq1xUJQtVrdB9ZKIAOthdg/Qc65LUk7wNIMoCVJO865rYFhkqjX6/d7vV4GPJwBMqofURS5JEk6FYBer/eeYb/Mo9WwFnPOvQbeAvfuAAK4BN4sAJtAG/gJIElmNuiJyba3EGNmZiPeZuEVmVell/Y/6N+CzDn3AXhEOOo7Hv/3BeAz8IzQkMPnJbuPx1wC+yYJ7/0nYIP5S/0FHKdp+rwCEEXRS/rf5Hl1Gtb2M0iSpCOpCZzPATmX1EySpHMLAsiy7MjMDoHrGSDXZnaYZdnRwBh7J91utwmczAA6CbG3GgPleX4jqUH/a1CktqRGnuc3hSCAMB32gKspkCtgb3KCQMmkjeP4WNJThrNNZval1WptTIsv7JtQ4tmIdRa8qSoEpWl6YWZNoAN0zKxZNPehpLSBZv2t+Q0CJ9lLnARQLAAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center}.color-picker .type-policy .type-policy-arrow{display:block;width:100%;height:50%}.color-picker .selected-color{position:absolute;top:16px;left:8px;width:40px;height:40px;border:1px solid #a9a9a9;border-radius:50%}.color-picker .selected-color-background{width:40px;height:40px;border-radius:50%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAh0lEQVRYR+2W0QlAMQgD60zdfwOdqa8TmI/wQMr5K0I5bZLIzLOa2nt37VVVbd+dDx5obgCC3KBLwJ2ff4PnVidkf+ucIhw80HQaCLo3DMH3CRK3iFsmAWVl6hPNDwt8EvNE5q+YuEXcMgkonVM6SdyCoEvAnZ8v1Hjx817MilmxSUB5rdLJDycZgUAZUch/AAAAAElFTkSuQmCC)}.color-picker .saturation-lightness{direction:ltr;width:100%;height:130px;border:none;cursor:pointer;touch-action:manipulation;background-size:100% 100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOYAAACCCAYAAABSD7T3AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AIWDwksPWR6lgAAIABJREFUeNrtnVuT47gRrAHN+P//Or/61Y5wONZ7mZ1u3XAeLMjJZGZVgdKsfc5xR3S0RIIUW+CHzCpc2McYo7XGv3ex7UiZd57rjyzzv+v+33X/R/+3r/f7vR386Y+TvKNcf/wdhTLPcv9qU2wZd74uth0t1821jkIZLPcsI/6nWa4XvutquU0Z85mnx80S/ZzgpnLnOtHNt7/ofx1TKXcSNzN/7qbMQ3ju7rNQmMYYd/4s2j9aa+P+gGaMcZrb1M/tdrvf7/d2v99P9/t93O/3cbvdxu12G9frdVwul3E+n8c///nP+2+//Xb66aefxl//+tfx5z//2YK5Al2rgvf4UsbpdGrB52bAvArXpuzjmiqAVSGz5eDmGYXzhbAZmCrnmzddpUU+8Y1dAOYeXCtDUwVwV7YCGH6uAmyMcZ9l5vkUaBPGMUZ7/J5w/792/fvv9Xq93263dr/fTxPECeME8nK5jM/Pz/HTTz/dv337dvrll1/GP/7xj/G3v/1t/OUvfwkVswongjdOp9PzH3U3D3zmWGnZVXn4jCqs7wC2BKP4/8tAzkZsoWx6XrqeHZymvp4ABCBJhTQwKfDT8gzrZCIqi5AhiACjBfEB2rP8/X63MM7f6/V6v9/v7Xa7bYC83W7jcrlsVHIq5ffv30+//fbb+OWXX8ZPP/00/v73v4+ff/75JSvbeu+bL2WMMaFbAlpBNM85QX+ct6qoSqkPAwuQlBVKqGNFSUOAA3Bmu7gC5hNOd15nSwvAOUW7C4giUCV8Sgn5L9hNFIqTsp0GxI0ysioyjAjkY/tGJVEpz+fz+OWXX+7fv38//f777+Pbt2/j119/HT///PP49ddfx8fHRwrmTjV779EXu2px2xhjwtdJZQcAWQIPLPISsMJaSwiD8gzIKrwSyATE5j5nAbR5c1dBUwBlsEWW0h6LqiYsqFPAQxCyRZ3wOSARxmlXMX5k64pQfvv27f75+dk+Pj5OHx8f4/v37+Pbt2/jt99+G9++fRsfHx/jcrmUFLO31gYDWblxRIs/TqfT7ousxJsAxXA2Gc7TA9XdgfdoHbFsj76X2+1WArgI1ageGwA3qupqoHsmcbI6Fu93quggFa9d7LeDtgKfAFHBJ+NEByIkcJ5KervdTmhhGcgJJSZ5vn//fj+fz+18Pp8+Pz/H5+fnmGD+/vvv4/v37+Pj42N8fn6O2+1Ws7JjjP6wraMI5E4RZ8x2vV5TSwkquotV7/d7Tz6HFWsD/qNcdw0CQ3q/321c686TwDVIdbuy73zNldhSHb8I2klZznm+InBS4U6n0302aBFsLhHDAKJVJVglfI9jhvu53W53sLANYNxAiDA6MCeUHx8f9+v12i6XS7tcLqcZW57P5yeY8/fz83Ocz+fnsSmYUyknWEG85WBst9stzSLyMdfr9Qi08iY15UZ0LlDGLhR3o5zK2j7OPUTD0E+nU3tk7Xb/16NFbhloAMuY1zjLUOO3BKeIDe+Z8s3/J4gFo4TM5jPmuRg28foUKKVSwo16TgA5npywcWLHgYl/Pz8/73/605/ab7/91m63W7tcLie0sZj4mao5gTyfz88E0f1+j8EcYzwTPEG2cqjyfHNF0M8fuqEiaOVnRzZZQNh5fwQyHg/HDGfJo89Q1zb/quu5XC6773I2XKfTqd/v9+d3wuqWva/YTdUdEV3fhIv/Viyps6YE3x3r43K5bJQS66zaxVGFsvd+//j4aF+/fm3fv39vt9utff36tf3+++/tdrudvn37ZuNLBaaCMgUzC+rZRiFowxUuJI8YMqcCp9Opq5vagaYU6lGJA1XQqejchw6Cj0Gw5nYBrGw01A2O206n04BGouNNyTfp/FwElhUey6nXrIKw7QQWddxuN2ldL5fL839gSPF8ahu/JvBO48CPSuqMf8Vp9/P53L58+dLu93s7n8/tfr8/39/v9/b5+TkhPJ3P56mQ436/j+/fv+/iSgbzer0+AZx/5+88bv6OMda6S5z6kd21fYC9dxv7cIJJ2d9AOS30fPMzyHiTM8B4DF6XUlYHp4KQW3W+1t77MNB1vGHxWq7Xa7vf78+y5/N5A+H1et29xuP5dbYtyaRu4AksbPq6936fjRzXRxBbPr/b+b18+fKljTHaBBBfn8/n0/1+H1++fBnn8zm0sB8fH5u4cr5GuBhMVk0EEn9RsctgVhM+ixlJtMA23R8B6yysAstBOgFXIKKCMIgToMqNEu2fYMH7ztc732dQKkCj1ytAZtY0Kx8pIr8GGJ+AT3V+2Hirhl++fBmXy2Wz73w+b17P8p+fn8/tUwGVleVkTyUb68DkfayWY4zxNRihU4EpLJPZVrK+u7J4/mgfKqeLW9X2REWlItL1diynbDDb3+jXgYjQqn0rrxWc+NkILP7F7xIbMvx7vV53x40xnlbWJF12ZSag/N0pW6t+ZzmOMzHjajKwDfond78zYTdfq18up97zr2q8v3IioBprRtBl0EZ9og5WBRGOdOHjIjXF7UotFbgOWnXzIJyzYvjG5IYgsmMOxHkz8OsMSrVNWeq5T8DaOcbEv1Od5rbs9aO7YvMet63EkF++fMExq+MRl4/L5bLZN/+ez+fnZ6KazuMqXSQVO5spJXflHAIzes/xJseckRJiDMog9d6VfRrqXMr6KpVV27jRwJacGovOAM1zMdQMnwK1AubK63kdCChvI1C7g0z9nf/D+Xze2Vj8H7Gx4P9duQlsYCrqyN8XqG3Hm/10Oj3jw/n+crlstuM+jPmmxT2dTuPz83Pzt2pn1XsEHX/bnPaVqVmh0xwOt0o6XLLAHePUU203wHfcrspCwmV3TryB5s0Mseeg97x/BwzCjBlbB+pRAPla0BVQuT6V6QHdBlj3d0KG147b+DqxQeUymDO43W4dQar+TIjwmAd0z8/h65vf0/yLv3Pb5XLpru/ydDo9s7ET0I+Pj6dKK9VUEIeKWQWPAOrJ8LKd4vE+t91Y3e7UFlWatg2VwJnb+HPmtvm/sfK59/OaWF3x/eP1UPHvA5DDYDpYXfb0drv1V2DkBkxtw/tEWVVlXWdC9pFYs5/jfh9dS/16vW7s6lTG+TfqsxSJHxkXXq/Xdr1eu4LsfD6P3vsT3N77DkL+zPm5jSdKL4zR3AxQd6rHkLkYlSowsrq7znzu6wSwdsMJOXmA5fBcjxtgMGBYHlr5zokhtsMCTgXLQOW4XC6dEyEMprL8mAQzXRgduix2yZzorxkYsDn3hB1VeMLGsXsVtgl2pW8S3svk0vw7R4hNaHvv4cACl5HFzwIH0Kc6zu4XjDPR/jpAVxWzO1Xk2DDb3vTcxeGU1iWZHkmIDWziWKvirCJ4Dravs6IJ/GG6cTqWdXDy+fArQDVVkLqkVjAoZIITdmmIqXwqa95N3+MGYoZQdRVNO53Y1xRkhO16vY7eu507Ca9lJnbGpxOemQhSw/AQsmmp5zU9BiU8G6wvX76M6/U6Pj4+do0Bz4CpgiknTUeDqwlKBmg3u4OVjrZ1A+rAcgaejWq6eJCvCYFDONSwOgHX4EQRw8lxbzDOdEK6gZ3Hk1b+8g2o1JFtKXyv/fEdTXuWjWXdAZiBp6ADeDrCFiim7B6ZFneeI7Gvm/PMkUDX67W7xI8b0D7/v8dA9qfN5oaCf74WZjH0mf1cmfY1Y0JUFmVrTWu8uzkNcLtEj7u5FXBTkfC6GOA5q8YMxO8KVvF6sAVGdcrUbsKODcQKkLMOMdmlxum642YrPm26AlhZW1YB1R+rrGswE8TaYAWeUMxdf+WjwSvZ2Ef3ytOyfn5+PpVPAaqOn43MtNBqvmjjxbjM4lZjZY4gqNMI5ktaW/sYKNwS+9lFQzGihmMCKPa7+Z0V6Eb0GRmobtpX8JljWu5FMLN5ja6hG9kwQgZqf5+1NH5UxzkFReCdWhJ8XdlGUkxO7HRlYRm4mVO43W7ter12TPJEw/rmEN3L5SKHIWZg9mz+pUoKOYq5bJTJdX2gme1UcxMZQFaEQIlHct32M+Y1BzGkGuzfiyAN9z+ugplZ1symCrDCYYkGxDTpI9RzBy0rHyeDUC1nWaeUaD9n4xkNyYMBDZtzZ3B++fJlY21XFDOcARJlabOyiS3uCpLI9jrZjCDkaVvcCCjwognKShWdzXZWlZMvVTgD8LpqlCLrqgbcB+qYwrgKYpT0ccCqbKyCValkEabn/FynogCrPKfqf51xJ7sGB2ZXcZmxoSOztjx300DZi7a0/2AIR0UlBag9SuDw6KcAzlaB7vHZvWpjK90dyrq6bKyDUZQbR0B05biLQkHIcSUmgIK+SwuqgHCnoio2RQU1yj+BnBy9pphVKLGyC7ZzFK1pxWK+E8IhVCWLN/uLtnUU4ayoYLoaANz8FdtaSvY4pV0BEW2ls61czqllBKpTyKgMAhrZ1cdc1RROtPmvWNkdcKZ7ZKxaWjiPLJMpp7OZKxA+rqG/oJLjxf0pnJlqLoDZo3gyU0mKGys2taKecj/d1C+rJSplBqlTyAqgR+D8KjKlmRL2gtUcAdCtsL+ijCNT1oqqqkH2OHEbG5sDFnUg5Aa+yLou2VU1ptj1S2ZQqv1ORZN9IWzRfgaRBxKoBE8UWyqlJFtrIc0AxNjSjed99CTY/XDfSzCz5M0IZoVEsWnPFNTsl8ooVC1TzbGgqFZNDSgVwKK+1sGDMKqxZCWGVMDysiEr1jVSQJUYwj5iHOlThdHt44SQg9CN+nl8D90NMIgAdgr46JqRiR9I8vRdFvbr17m/yxUMKjNLMiVUADwu2CWGhhi+F55TWM9M9cogzms1dnM4uOF/LAEYWdcqnM7yFmyq3IfwmOROd7Y1iFWtOjoY8To41mTV5IysgFFuRzsbWFGbNIIJCDv1dOo4lZG7jWBwRFtVTKuWyeCByJKOan8oZ3ep9XddNl0tDuaywLz9cXPYeDAA0SpkBO9sbVcTOVWldPv4uyzEkzxHtjvonHoSkFEWNoo1d8DhcQputd2ppNon4BzoAiJ1hBFQg0dVtdbGHHDQWushmNEQukLM2QO1G2Y8bgTXqFhcBJj7EjPgcPts8US8qPpPB/dXznOh5Z438tzH5ec6QgrOKrRRfKmysBmUDB+PhYabMlVPER+GCSITTzr7am2tArH3bgcEzPJm+cr5jJ4NnHNFDVrFXcI5Le9k5Jnw+bedbV+FfRzZIHaOOaOsLY0/7UGs58DjrGwKMIMFIGzOEW1/jGsdAtCN6hEAI4hBe9YXeRROBSVPAVPAqvIM5bx5hVKWAMP6zBRy3iescridVdFBinBxXDnG2GRY2XbCvp1lhvGtO9Bxu5h908XQu42lnSArMFdizMim8uwRCxPGnnOS8lwpnbOiDqTAjsrRN/PcoAScCbaACqVM40ylnjjTBs+bwWlAG23/UKbdkiwKWIQPGzWaczpoSlxPEj822cNWkpS7FyzsDrqpfgpG3jahw2vgbaSQAxuLWZYt7JzyNe8JoZpNAcvDFOdw0wqYT9AK1rZz/DdbSlLPp0ryIxgQJlK9AZlEq7IOXpohg9PIhrCng88JsOxiV4ZWAYfg4sikx/8ky2Z9l862uqwrfscIH8+ugTmVGyiddeVYUgEMn4GZzg14EwIsh9sx2cKKiWXReuOE5gzGOQgdlRKVVdlevqb279Xq0Qnsts2VDaBO0coezsruWtHApu6sKG4IBhN0aGU2kLrMKGRTN3HmbCDwKV14zvkMEDG4QfZVspVlaNU2mhc5TEZ3N1h/zqTheuLpW05ZWTGVjb3dbnNmxKZBnN8JqidaVLKAOyARNLS+MB54Z2+VaqoMLKroVBlngefnTPAcoHNWCSvlfA8CI0HEmBNBnBlXyMrzU7A7WVm94PPqQ2gmqKx+WDGsnvilmcSOBJqOK1nYyAIzuAyesq3UdSK3KfWcYKD95HmfYOU3qser2CtYEUA+FpfqdNvgPBZUBhDrGONRVlQsh8rLcaUCykHG0OOUwTlLBrsh5soEMGezi1E4HRVt1icp5wZEFXdibCkG8Y8vX75sbO4E0iom9z+hjSiOfy3DhpXItpVhE+UGQdvoWjtChmrGHf4YAzKgBNnGtuJxFCeGdhUAfQLLK8kBYAP6gvFJZajMG3Xkycy8KuC0q4Eyymwtwdxdv2M0mIBtK0LKnf640j00Auq4gUkdWGlhs22qJc6dZCsL19oxnlTJG4SYVRIGpD8TPFBuM6OElbS1pldid4mGAyN6ZIupbC5bXJN9fdpbThSxLUaI8IG1XIYBxW3Tjs6KQosKcxfxcQmdnwRGM10GnFcCy2XYunLMyAkdgk4mePiczsLygthcBut6goOqS7YVFXADLjaosB6s6ofcZWAZSIRYqSUkizYwttYab3vUOQ9w2HRxIIg8WwRVeE68xi4UtL3zRphxplzwuZrcqYCq1I3jPI5dnJIygEohMbPqVJSzrwzxBJTs5zN+ReUSgxikPQVF3JVBeNQxbHENrEMNvEdFZVV9lH9+ORGEsNZQpyTNc4C3AG7XF4ngzq+DrO2zbuaaOXgdaFcdkEotoSFBVX2qJ0C8OWZeG4KGlpghA0XfTOPCqV2qqwQ26QWfF2PMLhI2w1lVAa2aPsYd0za25MQRwgcZN6uQDCi+ZxiD4XEM2kZxOT41FnZnaRlcpZouzlRqqdbQVWopQoSB58RV50lBNrHi/AwXS5LrwDVlpY3Fc3ByiYGc52Trist6kOXdwInAQtJpp5QchyaquYOV7Su+fxVMaV3dc0RE2S6mUY0gLt2pMcYqrKIQ9w2l1gpQUMtQYcmmbt5DTNxdhnUCjQqtbK9SUSzvrC0mmhhE1e2FS2+oxypy/ZASutkmtjx3vcBC24PX65nbqkBCRhfjS9kIYPnee8cMagVOhI/3T1fAmdtAWZsCswTJCkQVNa0qWKSKPOpHAUhD9DrbVcyoYkwqhvh17vYAayXLQyKGYdxlUDFp494rBXRjYgO17DDYetNIUj/ezp6S0lnlpEwsWmJMkOwsKXeZKEAjIHn0EQJISaRBcO6UMINz7p/bEjjnw4ft+xmDvksxX4G2rIris7qaeKwAFMP2Oi7n4criuZwtpSUwpfLxSnORSrIqusc5ZFaXysqRWjiZ2DyAWEIL35tVSoQElFACjOeGGSE7AHEQgdo/LSvCOgGBvkxsmDbvlS3Fp5vhaB2TAGqRKrKKMrhLVpaGzEVjZ0OQxDhaCTA+QyRR1d15aQzrJntL3RibsipjG6jlgL4yqbS0sNYg1e84vhbBVrElK64CUcWYXDfKxhpIuxiVJZUxsbMy/uRBKTNRQ4kQ3LdRYLS0rJjRPlTPqY6gdJsEDc+aQXAn+HgsNUCbRuF0Oj0zwnA7bWDkbhO5Ens00qeQhS1laBMl5M/cAaxsLF8rKyql+Tf7ELLEGu/ixiimdCvo0TjfpjKwaggen4eh5v7LokLKbLuyvHhcZG8dhGrEDx7Hg93ZppJF7qBqO3iVveXEDQNInzeoe8Yq6ePaZBZ2JviM3W2UAGotekRCAGq4EkF1X3DOnR11yRsBL1tRa0PVcZiNFXZ2c34FskvomInQQ6lzpJoZbJxk43NwKJFBquJSsrByHydxKOnTxQASBmS3j+JMnsHSla3Ec6K9VWoJVn9zfjwOM7hqYAAqJQwE2a3nA48J2QGegRkpZNivSY+ys3EkKd4oJIwsvIHl3cWgLt5k4NH6OmtLWdpurOkwEMupYc7eMtDRhOcI2ui5JhVIzXzLyto/GAPuZoyo8wkoduVgJglCt7OhGbgID4Mq4si+63zUS1FuFFXFlqyaj2emHlLMcBqYu0FMuR28BbB7lOxRMSiCQXFhCKuwkhZ+pYDiGSgbsKKV8MiSRsuHSIWM9rklRiIlZZuqXjsQK8ooYJMgq3JKWVkhHbhsVxFUzthOWPkYijcbx54IKsSdT+uLr3crGKyoYgFiGR9iBk4kfloUX+JIlQRQqabmpgnhqtpQpb6RVQ1WH5DnrS4hEoGZqaerQ2dhFbz8XePxShmDbo70eISjoorO2vK8SJXI4SUmEU4zWKDzUDtWTYw7xXlbSTEj4FRg7zKnKoGRALv0Gs9Tgc1BpCywGZRQAtqVz2xrBcAMzEpfZwFSa2G5W0QBFjSMapWAEFa3HcGN7CxDzECyIkJ97qwrqWNTWVo876PPsjPkj2wvgroM5lLZKMETKVql/CvnWVFiFa/SzJUQwkoZsr67Y6vlSRV3/2tmNTOY3vnaxYwMuoPKqdzR1w7IqHymlPxaAThfU7Ko2ZXYj4AYJHL+kNdKwRQYESTRa5fsUZ/rVC1TMTyWVyYoqNtuzaHsMyv2tvoarxdfqwYgU1axFo/cnql1FGsqK+uAROV8BX4GU8WcZTATi2q7Qcyi0O0V+GhWBMNRUkn8H1SsWVE5By3Gi0ECqUeJoBfAtDa4amkdXG37AGP5Ggeb84p7UazpoKRzdFzeQ8HkoHGxprKy/Hpm5t12p47J6xTYDEz7uINEXSuxYXvFskYAc+ySxH9sf5ftKzU6IbwVBcUGg5e5FMCEXSErZR0wGayV19woM9guPjTqJdVTqR4uE4nJnLldWVkECCZLd2VLF+xtamex7IpiriSDUpvrpn9lrwGMCHyppMH+ps6LILsuFGUj1XEOXiqbqSHPUKnClpWV68kqtURVNDY4TNaocykoYeTU5ngGEQa/S1DnnE4AeXMcKjHPAmFVjCBENaeyLVNHfr3px8xUstJ94hIpfH4HKE/eDaArK6lSyVVFbdt1gxTIVk3pppVlFXi4pEhVBTObquohU85MLXn1iahvUkHJjSCMc01tLFveVVBx0DodM6jftCu7DOtIzYxrc0qp1JGP2ayYFz2Gb6HvMrO8cnGtV6Gjm3uImSfD2GpWK6uowbZGMxFKQCo1pOMtcMXFpRst+hXGoAomF3sSTBGgTglbBKWwsQ3tZqaYSp0Z1CimRDWFcCJUPYJ00BI5FkKYNoifuQxmN88SWVXWLMaUqqqgC0BmQJR6sk3u9NCf6jYLXxAfqsYEgVLAhRY2AtgtflZNFmFyhxdrLkAdWlk4D88M2ixHyepIdhMHrG/iR1ZGtq0MGpbDbRPYOXeSY1M6Ny4ZstvGSktK+XbFPATj2D371saPEsAMXhXrsZ0km/XStkhhMyBfsa6uXFZe2VCe+YMr1+GKgwrQyNYq1VRrB+EizAow6NsdNKcyVEkYeM73ys6q4kAHp6BiFklTkIrVC5oYV7uzwOGCz4UJ0Stq2lWMJy4wtb+RetL6tZFicnJmBw5UjCvXXMZVJX2MQkbf+XN5EWd78Vz8/JEsMZTBiKNzsm1inLRUQ74H4NidaqI68j5sAFgxcRveC7ieLJXfQYxjZZ2CsiWFewZXJmBIlZ1tdtrX4hSuateKso/RZOtOKW2nmq1oTzeK6dRWAWu2NRVb4hq0SXm1GvtugHrbr5IXqmSktg5CuDE2MSlPwsY5kNE2Wp3AqiZbWVLAxiBF+2iBZbuNj6MB6rsMLC7FyasaYDyo7KkoPyEtw3pEMXfPvxAJi2jAQQgjrz0rLIZSWZlIoNhwd5xK4AR9mYNjWAaLrnuImJeBVN9zBORObVvbr+mTTfFSEJLSRnHo7hEJoIi8MFqjxmvgmF5URZz4zLFgZZ8Ctu2X7ggVccKm9gVxIsOHqxXgNMKnFWZYnf1dBnOhayXq17QwFlWW09eNKyVJFmXqaONGA5aCegMbJ3UUkGY1ic3nKWgjq8qfVYGQG1gRt6rs62a6HiqqUOqdesK5NmX4nGofJoiE1d0dF9lVVkvT1/kEEaaCoYOwFpcVcoLM+7669PxC9rWqktH0sWUYld0VCpuBZ/stVRcGgy9WX2+U1Qthi9SzAqSxzZsy+OiFzBYnySGV6Gku44rD8BCOZBV3BvD5+AKRHNwMEsB6EzHnJpkTAeiUlEGkcECeB6GDZTp5YEJTlvdrknxYjTllMkfNtXwDjM7uVjK5JXUUn43rrqpK2jytaxHW0M5G8DC8rtHMYs7KSgduVQMGTYFqFvVS6rkD3sDJ46afdYFwoq11AOKCBLhvwoUgc8IGANycR6knZrdJPdsuxnyjfd3FovTlRMdEdtOl5CMV5EHsXQBis7TOwvIDZaGj2Vnpbh7cpK63VwYEMLwqbjzyl699sawFFkF1yqjUU31HfC6sW1ZFVFuXVXVgz9keEaw0ys1lWfm+azQAQSWA+hKYVfsZjPncAcUB9oIayy/UZXRNckDGji77GsWbvBo6tPrWPqOyVkBUq+INeqpzNdYs/u0ifh5qmpqIW+33JVSUcwY70KL4U9lYdU6ljtSls7lmfi9g3YzeQfVkaGFaV3ODCnaD2N8wsEDFklE3RzM3ZghdYkWHsszq70FIecnKkVkt8ezMzRq9bkGuKojRLBVSod3Y1yPqKgYW7JRQTPVyy5xIYLjOgxgT52RKJUY1dOrIiRd4futQx/A5AcSmEjz0vFWrkLzvbWAu9HOWbGgxFk1VNTpnBKk6TgwisI/HcxYXP1uAWO72ULFlBTq+aSu2VTUs6hrxM2CF+hEor1VIA9ZmFUaab1lSSgZsVs4sxzHlVLoJHr9H4DhONTkI1XC0/wiY2NoWAG5RlnHFnq6oLccpQddMuJ/O17JVA5OHLi0BqCztq7Y1++ucCd98qLI8MIHBV/cKjxQTme3hFBS3MyCqnDsuym2o80HjvFFTtrURmNaGJsmVahImjTsUXKtQZTAVs7Mvv8/+fzUrZAXcLJ6M4koe6XP0b6SmWWNDzyUpQ8bl+LtWx4tuqZ36cRYV3yuVxPNwvIiqiQCSmu7srgTzR6nkyhpCarXwFy1vGd5iP2cY06lFr5Njhhg1Y6+NB28ftbK83s8rf7kLJbKwDFPbLg25a0AdZJEiqr5phixKMDlRUtcssq1hriLqGoH+zeNgVm9OemjsETV8JdF0NHnkIFxWY1OB4Yrp7rtWJ7NgAAAPXklEQVQ3oNs5nplyVf8u2FoLu1JrHveaZWQjqAkshtFa2gzsSG3Zpkbvg3HafF9slPPlldjFlK80Gysm8Mr4MPhneNWENPGjAIpmilTPATdTRTXlCBYHYAQuPwA36xIpWtGN4q3Y2MhiGsUpuSSnlEJRD8PorC7CFYVw+F51qThgabxsTxWzCGY0ZSsb3lfqAy0OPNjNy8xiQQKsHYFQ2HBZVvVbBuq3m1oWKajqaonsM6uZUr6CjXWNZ0l5E3h3jURma6kP3MJIiy1Lm+kahQq41N2iZja5sjtlLYNZHZrH6qUGm4vMbDp6Rw2CFmvuyFkrBcCyMtFqBaECmsHoK9BZ2LA/lJcRqSaDqnaWbrZdGaz3DLgIvBln4woGztbyJGqslwxkhhHrTjTYFXCtOoKS8uLdofVdAbOylGU6nlYpXWZts4nXBq6WxJitMNokHUJnbnJplQm+aGpY2a5GMV2QD1hRubBPFKdumf5OHkLHz0F9luE5kjBjRa0nFE5CUGqHw32MmjZ6xkgINVnSnZ1VZStK2qKlRaLlQgK7uTq7JFXJwM+3SOEKyhZNI+tJ0I5qMYy9k2qJD7dVWdqKXa0CKNR0Ccjg+B2IYu2fcBZJZkMFgM11r0X92wilghFGgzVnexlqB7xL9mS29SiYUVY2nXOZjNBRsyDsQPRWW5hrZ4XcdC4HVWRbjgJr4sFofK5SzjQ7rhI1UebdPdEbj6sqIvTZQZ5va08rABsAW0UxeWytAk7A2KJ9ZpxzCioB24XFtYAeXYxr6anSqhLgppEqWbGwLunTgrV+IjWlL29ljaAl4EQMGsErp4apeZiquwRXLXAqOCeru32mmydc6oWTSWpFAGdzeTB8RTHVMEtlM90CbbQCYhPjq3egYr1FGdYIQjiuDGZ5zZ/AzobKGOyLxti6c4Rwtv2anyWlLICnlLhxJRXt6A5ebDBWFNONbxWZ2d02mnu4S9YECpeppV1zSWRBWxHYzVIv1CXSouwqqX3jBBBDZdYQbpTQW4ZQlS8r5kH4suSRmg2++3JN10x1PaAmEkmtYlEdeGpJEM6kOuCqCR22oSujj5IV2HdT0zj5prLKTjXFAPjdQlyq7xIBxAQP5yMczG4VxAKw0n6ilZ2QBce2pLulkuxxqnoIzFfgqyqjil9S1VNwBrFmeyeops8yOjZUybZdfS8CuaTIJumzs5tODaNtLpFDQ/PcJGweLhmeL1nB0KqiUDScsiUVD89Di3HtrKtSULw3RLiygZD+7sF8JTObgYsrGvDNUFRGl1iy0Ll1YkUc2aJYMog920I8qW6YDCg1Mqk0JHJFKXkbgbRreI+qpYNOZHrVcDUba7pjsphSJNtK6upgRNAVoOS0mugBeN4bIZgHhuPZ/s1ENaX6KsVr+YNrh1Nb7ipR0PE5zbNRegCbrHRUw6Yf07dLBJl1f8KB9as2V1nNqAsl62LBBhehwalerkHmB1JFIEZKSEusdl5JQj1nJlHXSCF342gJ9CYGrXelknJIXqVP8sD+qtplCR3XH2qfKq0ygMp+KnVkKxNlZ8m2YkIlVMiCnXUwl7qznBKSvQz3m3Pt6oQbXO5b5FixCh/fHxUQW/AEcK6zCNqKQnL9sywqmKuwvqSYzT/aPVNNpVyhvRW21aqciCsjdWvBwILUvh5VyCzbWoC1pJjJ680CWsl+udKB6T5RwG1mlohnlpbg47iz5U9ha0FGtmRLFYBtO99y97Ap0z+ZDTAog6kSLZsMHg/IFkkgp6CpvU2U0cYVSdnmkjwBdOmXbxTWNWzuIbipMioVxEckZEoahSOiy2M3K0jcC1LhVDwaqG0ZvkcWqCnrG4GIxykrqlbWdw6LQyBaZR8HmLRIhQWsHswD42ZXVLNkf9l+FlW0HVQ2lwFsC/Z1FdzlQR0KaPfo+Fdfu+/dwVRICu1CGR7AEIiAhc+AZUF0kOBaPxmUqg4i64vQnU4nFDYJ9Nz+1fVXveH9qmr+kPILx8oKcRV/BFbxbE0JMT0kSD4w6L/lNY8ocsqagVdU3A3MjxhxcGuqzsPH4irpaow1q6OyrVjvp9Npc59E91LldboYVzJWdimWfAW2SNEKcDaX2FmBLLA/uKxlmhh613Is1URQApbKfttwxL02q6Onx5pQxSbPojAg+v5hAnN6LHVRDXIsvKtRjiS0qJUyZTAXVbAK82ElFJWaQdVoqUC1Unt7BVaTQudM6SuqexjQJN4+0icaxv/utbKv83ETbT8H8gjcOKxOJmbUa6OOVXht3dFY6rHv9XoNzFLceEA1o8+pKm0LAHPHZ2rYKjFq0hfZFixsqHJgD3eD5n+U0kb1mFjXkn2lvMSSOsNE/CdIAKF0Sytq6urOHUN5gwg4GZosgbmggM5ucra2qrS2Ig1cbiBBcxYzgzUDNLCvL8GbZXNp6ORy3LmS+Kk83zRIAK6A1ioKa2I9NapIuiUFdfC9766PFZUtqUr6KbWk+zZU1a/ZrIXEztrjTOfz7hwKziCeXIaraHtbZIMz+2pGgazCmw4qWAFvEdhodYp0Xq0pV7G1YWYWbO4qhGq42+Z8BYtrLWvluNPpZAeaFFS1vubPgbgxsqcpnAaszBovKaFoDQ8BGtjfUOl4NAG2nmQV04feJgumvX2fsrQEWZghL0JnVdYkn3DOZIeRN86RqPWCmsvGVqEMRnwxQAxwS8EMYo3IzmY2+BCcLp4MKiuyuhImamlbZFcNoNl7tp+RHd18ZjQIRKyXdFRhN98/hyKqwXWNo7O1wiaXoHN108REZZWEq6grnIfjzeg8jdRf1XEL4kkXa5bBjKxoKaljBjeHlVxQ4GaycpW4lDOAKtnTxHAtOfzOtZwHAM7sqVXkV6yu6kap1nHkXKqWF/4XHqjenNKqBjpR3l1ch3Ejg1+EsgdQhsdG0B4FM9sWAVWpuAyiwTPleZxt9VyZVS2qXfReWqTAilpr9ApoWTjxymit7NwV4JTriZyOA9B0k7HFfULourmKYHVnRQvqGL5HMHdqFcR2qWpmcK6eTwx2dipWrviDilr+fKWq3OWRWdHKwA4eu8wjchbeRzFilqjjZN3ufCpfkJ0/scVpnYk6L0PI77lxdWCZ87WiWm7B/AGquQSnujGKsB8CJmiJq8q1pKIVWyqOiTK66r18BN8r74/AE71fdC3yPS2MxdOpnE1tlVxD9JmVOoggN+r4PjAXVFPa3Eg5jVJGFVUGNolH20GVrUB7BOySWq6WqYQdWR92pcFMYMwckbSgCKCqD67DiiWu1g8MQC9ByfcFqW1L+jL714qNCuznoSxt0da2gtWN1G8F0BK0NN0nuimelUF9dIdAfjO44UT3CjQLoUeLHJFTO3gmpRuIIOvwBQCbqNeo3qtZ9iF6xVK13GRlo4zqimq+CGdTiR1uRY8oqgE02hZBa79kZXPMquxRHKla2saZWN4mRqZUj0vLCKhkjKnqOQHNuSZVJoKvAqS1wpEquvWDC1B2ypwrCPsRMEPVTODMLJMDv6qeKXwi2JYV5Sq4qKyvgGsHCLiuj2jR59V8gMqSJ2FJZRXEHVRHj3sFPrct6OpqlW1GpatQdt0GvwfM6n63InsGVFhJGaBqgqqIV6IsXllZgySPq4R3bnt3wi5cv+cN2yqQLW1T95KYVsWWtKk4cB9W53WQQflQYR6Wl4HaJZjvVE0D5yvq+RKgZCs5qdBEP5sD94cAvQLlSgNaSMAtHx88BuNQ41zdFsX30zKbcs0MLD/ihkpQzl0wiTqKLTfbKmCmyYICnK0IbaieC4CG9iSyLQ7cIMGQwau6TKoq60Apl3WN40LZpca1CKKK9VQyyIEn8w0F8F6CL2h8o3ixGwC7s7EWzCOqmcApYxYD4jsAzVS0sl2t98pA7vrKophCVSonbYpgH6mvSn24pTBV4sdtV3BtMq5k82y+IADvUJ0uAlkCVTxIaPm+UNu/qkV4F1TzHXCGrXIAqItBKypqK99VtAOVs64O4ObX7pHLVCpYHcRmwvLR7TvYAKBBN58LGVzDuFz+hQbWgncQyCZAk+VbsPSouf93261iZgmfCpwRbAvqmSqriU2PwhjaoOyYqtIegVXViTsmyta6bGySpY3gyRrpIyAeaWDDxtpsXwKyalMDKNP7YBXMqEskUsi2uC8FNAPxAKTVfT1o6VzM0E0jF+1rWcUuHvdyg7vgoFplX8HpvHpMCOMRUPHzZkInsqlFKNX/EIO52E0SxSzOwob2VmRLW5D1XIU0rbgM1AzWgyC7fe8G7xUAK/taEBat7luqtyP7EmsaJQOj5F+mrnZfCuYCfBUAWwShyd6pMY/vAHG1UqOYpbI/gy5T0CMKm+UO3gFuC85dgfDVeguPDfITrIBLsLrcgdh3CFgFZjaKJ4Iv3F8ANEqvuxR1tVKOgLoCa1jxboBAkj6v7j/icFbA7f4rfRnQDLRViG13i0vqBQrYVqBbADZT0ZpiHoSzvQpopKIFS3sE1HfBWlHXd0H7LnArqvougMtljHBgZnh3Eoz/BKjLML4Z2Aq0+hEJr9jaVUBbvNzCIUiroC7AWmmFw4o5AK3MtB5VypZMSFgs05JyGVwlwBqsEGAAa2ZU1CjUexXGsE4rKriilBvFzOKKo3AuAroE6QFQU3u8YpNXwS5k+1TZt5UrwouN4KiUEw+k3ZWDp1RXHNRqXb21Ts39945yZSg3VnZFNQ9CF3XeZyr5DgBXKiwCMa2MxeTDYXgP1Fsf9QNKZc0k81RJk3r6EQ3rCmBVyLL75EjZ1pIVDHoFtiOAHoB0BdTVylqBsKKKS+AeBXJVLY+CXASuGvO/Auq7GuEjDfGKg1oKa1z/dmmi9I9SUGNhl0AtfulHAawoYrnSkmNXAVuGEhrEVXvUF+A5Ct2PqNOjDetyna4CmeUolmeXLN4Aq7C5Sj10Q7yjgl+t6CNxSRHmI5X+CpwreYB3Qfdqna4q21KdBuc4GoZsn49ZOOiVinwHqK9WzjvgeweEh2AU5+vtxZ9Cd9Wqkh49V18E5oj6vVyn0RStAyGIO5edXRKd5B0VGVXq2yr3xYp+5Ut+C4QJ4P1N339pQMjRejj4vb/Dcr6rQc3O/0rjmtZpeYCBiCHfCemRbNhbK/pNUPc3wfKy5f2D7OlL3/uPhve/oU4T0F8f+VNM2vyoiv0jK+KHQfdHq+0bncz4oz73/+Y6LbKw1o/5B7eOf1Rl/0du9B9tn/9bvrf/j+v0h6ttn2tp/r/4819y4/zv5391uvzzfwDifz6phT1MPgAAAABJRU5ErkJggg==)}.color-picker .cp-add-color-button-class{position:absolute;display:inline;padding:0;margin:3px -3px;border:0;cursor:pointer;background:transparent}.color-picker .cp-add-color-button-class:hover{text-decoration:underline}.color-picker .cp-add-color-button-class:disabled{cursor:not-allowed;color:#999}.color-picker .cp-add-color-button-class:disabled:hover{text-decoration:none}.color-picker .cp-remove-color-button-class{position:absolute;top:-5px;right:-5px;display:block;width:10px;height:10px;border-radius:50%;cursor:pointer;text-align:center;background:#fff;box-shadow:1px 1px 5px #333}.color-picker .cp-remove-color-button-class:before{content:"x";position:relative;bottom:3.5px;display:inline-block;font-size:10px}.color-picker .eyedropper-icon{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);fill:#fff;mix-blend-mode:exclusion}
`],encapsulation:2})}return e})(),F0e=!1,AH=(()=>{class e{injector;cfr;appRef;vcRef;elRef;_service;dialog;dialogCreated=!1;ignoreChanges=!1;cmpRef;viewAttachedToAppRef=!1;colorPicker;cpWidth="230px";cpHeight="auto";cpToggle=!1;cpDisabled=!1;cpIgnoredElements=[];cpFallbackColor="";cpColorMode="color";cpCmykEnabled=!1;cpOutputFormat="auto";cpAlphaChannel="enabled";cpDisableInput=!1;cpDialogDisplay="popup";cpSaveClickOutside=!0;cpCloseClickOutside=!0;cpUseRootViewContainer=!1;cpPosition="auto";cpPositionOffset="0%";cpPositionRelativeToArrow=!1;cpOKButton=!1;cpOKButtonText="OK";cpOKButtonClass="cp-ok-button-class";cpCancelButton=!1;cpCancelButtonText="Cancel";cpCancelButtonClass="cp-cancel-button-class";cpEyeDropper=!1;cpPresetLabel="Preset colors";cpPresetColors;cpPresetColorsClass="cp-preset-colors-class";cpMaxPresetColorsLength=6;cpPresetEmptyMessage="No colors added";cpPresetEmptyMessageClass="preset-empty-message";cpAddColorButton=!1;cpAddColorButtonText="Add color";cpAddColorButtonClass="cp-add-color-button-class";cpRemoveColorButtonClass="cp-remove-color-button-class";cpArrowPosition=0;cpExtraTemplate;cpInputChange=new We(!0);cpToggleChange=new We(!0);cpSliderChange=new We(!0);cpSliderDragEnd=new We(!0);cpSliderDragStart=new We(!0);colorPickerOpen=new We(!0);colorPickerClose=new We(!0);colorPickerCancel=new We(!0);colorPickerSelect=new We(!0);colorPickerChange=new We(!1);cpCmykColorChange=new We(!0);cpPresetColorsChange=new We(!0);handleClick(){this.inputFocus()}handleFocus(){this.inputFocus()}handleInput(i){this.inputChange(i)}constructor(i,r,n,o,a,s){this.injector=i,this.cfr=r,this.appRef=n,this.vcRef=o,this.elRef=a,this._service=s}ngOnDestroy(){this.cmpRef!=null&&(this.viewAttachedToAppRef&&this.appRef.detachView(this.cmpRef.hostView),this.cmpRef.destroy(),this.cmpRef=null,this.dialog=null)}ngOnChanges(i){i.cpToggle&&!this.cpDisabled&&(i.cpToggle.currentValue?this.openDialog():i.cpToggle.currentValue||this.closeDialog()),i.colorPicker&&(this.dialog&&!this.ignoreChanges&&(this.cpDialogDisplay==="inline"&&this.dialog.setInitialColor(i.colorPicker.currentValue),this.dialog.setColorFromString(i.colorPicker.currentValue,!1),this.cpUseRootViewContainer&&this.cpDialogDisplay!=="inline"&&this.cmpRef.changeDetectorRef.detectChanges()),this.ignoreChanges=!1),(i.cpPresetLabel||i.cpPresetColors)&&this.dialog&&this.dialog.setPresetConfig(this.cpPresetLabel,this.cpPresetColors)}openDialog(){if(this.dialogCreated)this.dialog&&(this.cmpRef.instance.cpAlphaChannel=this.cpAlphaChannel,this.dialog.openDialog(this.colorPicker));else{let i=this.vcRef;if(this.dialogCreated=!0,this.viewAttachedToAppRef=!1,this.cpUseRootViewContainer&&this.cpDialogDisplay!=="inline"){let n=this.appRef.componentTypes[0],o=this.injector.get(n,Ea.NULL);o!==Ea.NULL?(i=o.vcRef||o.viewContainerRef||this.vcRef,F0e&&i===this.vcRef&&console.warn("You are using cpUseRootViewContainer, but the root component is not exposing viewContainerRef!Please expose it by adding 'public vcRef: ViewContainerRef' to the constructor.")):this.viewAttachedToAppRef=!0}let r=this.cfr.resolveComponentFactory(R0e);if(this.viewAttachedToAppRef)this.cmpRef=r.create(this.injector),this.appRef.attachView(this.cmpRef.hostView),document.body.appendChild(this.cmpRef.hostView.rootNodes[0]);else{let n=Ea.create({providers:[],parent:i.injector});this.cmpRef=i.createComponent(r,0,n,[])}this.cmpRef.instance.setupDialog(this,this.elRef,this.colorPicker,this.cpWidth,this.cpHeight,this.cpDialogDisplay,this.cpFallbackColor,this.cpColorMode,this.cpCmykEnabled,this.cpAlphaChannel,this.cpOutputFormat,this.cpDisableInput,this.cpIgnoredElements,this.cpSaveClickOutside,this.cpCloseClickOutside,this.cpUseRootViewContainer,this.cpPosition,this.cpPositionOffset,this.cpPositionRelativeToArrow,this.cpPresetLabel,this.cpPresetColors,this.cpPresetColorsClass,this.cpMaxPresetColorsLength,this.cpPresetEmptyMessage,this.cpPresetEmptyMessageClass,this.cpOKButton,this.cpOKButtonClass,this.cpOKButtonText,this.cpCancelButton,this.cpCancelButtonClass,this.cpCancelButtonText,this.cpAddColorButton,this.cpAddColorButtonClass,this.cpAddColorButtonText,this.cpRemoveColorButtonClass,this.cpEyeDropper,this.elRef,this.cpExtraTemplate),this.dialog=this.cmpRef.instance,this.vcRef!==i&&this.cmpRef.changeDetectorRef.detectChanges()}}closeDialog(){this.dialog&&this.cpDialogDisplay==="popup"&&this.dialog.closeDialog()}cmykChanged(i){this.cpCmykColorChange.emit(i)}stateChanged(i){this.cpToggleChange.emit(i),i?this.colorPickerOpen.emit(this.colorPicker):this.colorPickerClose.emit(this.colorPicker)}colorChanged(i,r=!0){this.ignoreChanges=r,this.colorPickerChange.emit(i)}colorSelected(i){this.colorPickerSelect.emit(i)}colorCanceled(){this.colorPickerCancel.emit()}inputFocus(){let i=this.elRef.nativeElement,r=this.cpIgnoredElements.filter(n=>n===i);!this.cpDisabled&&!r.length&&(typeof document<"u"&&i===document.activeElement?this.openDialog():!this.dialog||!this.dialog.show?this.openDialog():this.closeDialog())}inputChange(i){this.dialog?this.dialog.setColorFromString(i.target.value,!0):(this.colorPicker=i.target.value,this.colorPickerChange.emit(this.colorPicker))}inputChanged(i){this.cpInputChange.emit(i)}sliderChanged(i){this.cpSliderChange.emit(i)}sliderDragEnd(i){this.cpSliderDragEnd.emit(i)}sliderDragStart(i){this.cpSliderDragStart.emit(i)}presetColorsChanged(i){this.cpPresetColorsChange.emit(i)}static \u0275fac=function(r){return new(r||e)(G(Ea),G(qp),G(Qu),G(sl),G(vt),G(TH))};static \u0275dir=xt({type:e,selectors:[["","colorPicker",""]],hostBindings:function(r,n){r&1&&Y("click",function(){return n.handleClick()})("focus",function(){return n.handleFocus()})("input",function(a){return n.handleInput(a)})},inputs:{colorPicker:"colorPicker",cpWidth:"cpWidth",cpHeight:"cpHeight",cpToggle:"cpToggle",cpDisabled:"cpDisabled",cpIgnoredElements:"cpIgnoredElements",cpFallbackColor:"cpFallbackColor",cpColorMode:"cpColorMode",cpCmykEnabled:"cpCmykEnabled",cpOutputFormat:"cpOutputFormat",cpAlphaChannel:"cpAlphaChannel",cpDisableInput:"cpDisableInput",cpDialogDisplay:"cpDialogDisplay",cpSaveClickOutside:"cpSaveClickOutside",cpCloseClickOutside:"cpCloseClickOutside",cpUseRootViewContainer:"cpUseRootViewContainer",cpPosition:"cpPosition",cpPositionOffset:"cpPositionOffset",cpPositionRelativeToArrow:"cpPositionRelativeToArrow",cpOKButton:"cpOKButton",cpOKButtonText:"cpOKButtonText",cpOKButtonClass:"cpOKButtonClass",cpCancelButton:"cpCancelButton",cpCancelButtonText:"cpCancelButtonText",cpCancelButtonClass:"cpCancelButtonClass",cpEyeDropper:"cpEyeDropper",cpPresetLabel:"cpPresetLabel",cpPresetColors:"cpPresetColors",cpPresetColorsClass:"cpPresetColorsClass",cpMaxPresetColorsLength:"cpMaxPresetColorsLength",cpPresetEmptyMessage:"cpPresetEmptyMessage",cpPresetEmptyMessageClass:"cpPresetEmptyMessageClass",cpAddColorButton:"cpAddColorButton",cpAddColorButtonText:"cpAddColorButtonText",cpAddColorButtonClass:"cpAddColorButtonClass",cpRemoveColorButtonClass:"cpRemoveColorButtonClass",cpArrowPosition:"cpArrowPosition",cpExtraTemplate:"cpExtraTemplate"},outputs:{cpInputChange:"cpInputChange",cpToggleChange:"cpToggleChange",cpSliderChange:"cpSliderChange",cpSliderDragEnd:"cpSliderDragEnd",cpSliderDragStart:"cpSliderDragStart",colorPickerOpen:"colorPickerOpen",colorPickerClose:"colorPickerClose",colorPickerCancel:"colorPickerCancel",colorPickerSelect:"colorPickerSelect",colorPickerChange:"colorPickerChange",cpCmykColorChange:"cpCmykColorChange",cpPresetColorsChange:"cpPresetColorsChange"},exportAs:["ngxColorPicker"],features:[kr]})}return e})(),DH=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=rt({type:e});static \u0275inj=it({imports:[To]})}return e})();function IH(e,t,i,r,n){var o=i-e,a=r-t,s=1;o<0&&(s=-1,o=-o);var c=2*o-a,l=e;for(let d=t;d<r;d++)n.push({x:l,y:d}),c>0?(l=l+s,c=c+2*(o-a)):c=c+2*o}function MH(e,t,i,r,n){var o=i-e,a=r-t,s=1;a<0&&(s=-1,a=-a);var c=2*a-o,l=t;for(let d=e;d<i;d++)n.push({x:d,y:l}),c>0?(l=l+s,c=c+2*(a-o)):c=c+2*a}function kH(e,t){let i=new Array;var r=Math.round(e.x),n=Math.round(e.y),o=Math.round(t.x),a=Math.round(t.y);return Math.abs(a-n)<Math.abs(o-r)?r>o?MH(o,a,r,n,i):MH(r,n,o,a,i):n>a?IH(o,a,r,n,i):IH(r,n,o,a,i),i}var V0e=["switch"],z0e=["*"];function U0e(e,t){e&1&&(C(0,"div",10),wa(),C(1,"svg",12),he(2,"path",13),A(),C(3,"svg",14),he(4,"path",15),A()())}var H0e=new Ye("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1,hideIcon:!1})}),j0e={provide:Ql,useExisting:Yo(()=>$m),multi:!0},w2=class{constructor(t,i){this.source=t,this.checked=i}},G0e=0,$m=(()=>{class e{_createChangeEvent(i){return new w2(this,i)}get buttonId(){return`${this.id||this._uniqueId}-button`}focus(){this._switchElement.nativeElement.focus()}get checked(){return this._checked}set checked(i){this._checked=i,this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(i,r,n,o,a,s){this._elementRef=i,this._focusMonitor=r,this._changeDetectorRef=n,this.defaults=a,this._onChange=c=>{},this._onTouched=()=>{},this._validatorOnChange=()=>{},this._checked=!1,this.name=null,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.disabled=!1,this.disableRipple=!1,this.tabIndex=0,this.change=new We,this.toggleChange=new We,this.tabIndex=parseInt(o)||0,this.color=a.color||"accent",this._noopAnimations=s==="NoopAnimations",this.id=this._uniqueId=`mat-mdc-slide-toggle-${++G0e}`,this.hideIcon=a.hideIcon??!1,this._labelId=this._uniqueId+"-label"}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(i=>{i==="keyboard"||i==="program"?(this._focused=!0,this._changeDetectorRef.markForCheck()):i||Promise.resolve().then(()=>{this._focused=!1,this._onTouched(),this._changeDetectorRef.markForCheck()})})}ngOnChanges(i){i.required&&this._validatorOnChange()}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}writeValue(i){this.checked=!!i}registerOnChange(i){this._onChange=i}registerOnTouched(i){this._onTouched=i}validate(i){return this.required&&i.value!==!0?{required:!0}:null}registerOnValidatorChange(i){this._validatorOnChange=i}setDisabledState(i){this.disabled=i,this._changeDetectorRef.markForCheck()}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(this._createChangeEvent(this.checked))}_handleClick(){this.toggleChange.emit(),this.defaults.disableToggleValue||(this.checked=!this.checked,this._onChange(this.checked),this.change.emit(new w2(this,this.checked)))}_getAriaLabelledBy(){return this.ariaLabelledby?this.ariaLabelledby:this.ariaLabel?null:this._labelId}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(ic),G(ei),Zo("tabindex"),G(H0e),G(pr,8))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-slide-toggle"]],viewQuery:function(r,n){if(r&1&&ht(V0e,5),r&2){let o;Ve(o=ze())&&(n._switchElement=o.first)}},hostAttrs:[1,"mat-mdc-slide-toggle"],hostVars:13,hostBindings:function(r,n){r&2&&(Dl("id",n.id),Zt("tabindex",null)("aria-label",null)("name",null)("aria-labelledby",null),Kr(n.color?"mat-"+n.color:""),It("mat-mdc-slide-toggle-focused",n._focused)("mat-mdc-slide-toggle-checked",n.checked)("_mat-animation-noopable",n._noopAnimations))},inputs:{name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:[_e.None,"aria-label","ariaLabel"],ariaLabelledby:[_e.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[_e.None,"aria-describedby","ariaDescribedby"],required:[_e.HasDecoratorInputTransform,"required","required",yt],color:"color",disabled:[_e.HasDecoratorInputTransform,"disabled","disabled",yt],disableRipple:[_e.HasDecoratorInputTransform,"disableRipple","disableRipple",yt],tabIndex:[_e.HasDecoratorInputTransform,"tabIndex","tabIndex",i=>i==null?0:sn(i)],checked:[_e.HasDecoratorInputTransform,"checked","checked",yt],hideIcon:[_e.HasDecoratorInputTransform,"hideIcon","hideIcon",yt]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],standalone:!0,features:[Li([j0e,{provide:sp,useExisting:e,multi:!0}]),Hi,kr,ci],ngContentSelectors:z0e,decls:13,vars:24,consts:[["switch",""],["mat-internal-form-field","",3,"labelPosition"],["role","switch","type","button",1,"mdc-switch",3,"click","tabIndex","disabled"],[1,"mdc-switch__track"],[1,"mdc-switch__handle-track"],[1,"mdc-switch__handle"],[1,"mdc-switch__shadow"],[1,"mdc-elevation-overlay"],[1,"mdc-switch__ripple"],["mat-ripple","",1,"mat-mdc-slide-toggle-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-switch__icons"],[1,"mdc-label",3,"click","for"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--on"],["d","M19.69,5.23L8.96,15.96l-4.23-4.23L2.96,13.5l6,6L21.46,7L19.69,5.23z"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--off"],["d","M20 13H4v-2h16v2z"]],template:function(r,n){if(r&1){let o=Ze();vi(),C(0,"div",1)(1,"button",2,0),Y("click",function(){return q(o),X(n._handleClick())}),he(3,"div",3),C(4,"div",4)(5,"div",5)(6,"div",6),he(7,"div",7),A(),C(8,"div",8),he(9,"div",9),A(),Be(10,U0e,5,0,"div",10),A()()(),C(11,"label",11),Y("click",function(s){return q(o),X(s.stopPropagation())}),gt(12),A()()}if(r&2){let o=Ft(2);z("labelPosition",n.labelPosition),O(),It("mdc-switch--selected",n.checked)("mdc-switch--unselected",!n.checked)("mdc-switch--checked",n.checked)("mdc-switch--disabled",n.disabled),z("tabIndex",n.disabled?-1:n.tabIndex)("disabled",n.disabled),Zt("id",n.buttonId)("name",n.name)("aria-label",n.ariaLabel)("aria-labelledby",n._getAriaLabelledBy())("aria-describedby",n.ariaDescribedby)("aria-required",n.required||null)("aria-checked",n.checked),O(8),z("matRippleTrigger",o)("matRippleDisabled",n.disableRipple||n.disabled)("matRippleCentered",!0),O(),Ni(10,n.hideIcon?-1:10),O(),z("for",n.buttonId),Zt("id",n._labelId)}},dependencies:[Ys,l2],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1);background-color:var(--mdc-elevation-overlay-color)}.mdc-switch{align-items:center;background:none;border:none;cursor:pointer;display:inline-flex;flex-shrink:0;margin:0;outline:none;overflow:visible;padding:0;position:relative}.mdc-switch[hidden]{display:none}.mdc-switch:disabled{cursor:default;pointer-events:none}.mdc-switch__track{overflow:hidden;position:relative;width:100%}.mdc-switch__track::before,.mdc-switch__track::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";height:100%;left:0;position:absolute;width:100%}@media screen and (forced-colors: active){.mdc-switch__track::before,.mdc-switch__track::after{border-color:currentColor}}.mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0)}.mdc-switch__track::after{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(-100%)}[dir=rtl] .mdc-switch__track::after,.mdc-switch__track[dir=rtl]::after{transform:translateX(100%)}.mdc-switch--selected .mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__track::before,.mdc-switch--selected .mdc-switch__track[dir=rtl]::before{transform:translateX(-100%)}.mdc-switch--selected .mdc-switch__track::after{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0)}.mdc-switch__handle-track{height:100%;pointer-events:none;position:absolute;top:0;transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);left:0;right:auto;transform:translateX(0)}[dir=rtl] .mdc-switch__handle-track,.mdc-switch__handle-track[dir=rtl]{left:auto;right:0}.mdc-switch--selected .mdc-switch__handle-track{transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__handle-track,.mdc-switch--selected .mdc-switch__handle-track[dir=rtl]{transform:translateX(-100%)}.mdc-switch__handle{display:flex;pointer-events:auto;position:absolute;top:50%;transform:translateY(-50%);left:0;right:auto}[dir=rtl] .mdc-switch__handle,.mdc-switch__handle[dir=rtl]{left:auto;right:0}.mdc-switch__handle::before,.mdc-switch__handle::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";width:100%;height:100%;left:0;position:absolute;top:0;transition:background-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1),border-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);z-index:-1}@media screen and (forced-colors: active){.mdc-switch__handle::before,.mdc-switch__handle::after{border-color:currentColor}}.mdc-switch__shadow{border-radius:inherit;bottom:0;left:0;position:absolute;right:0;top:0}.mdc-elevation-overlay{bottom:0;left:0;right:0;top:0}.mdc-switch__ripple{left:50%;position:absolute;top:50%;transform:translate(-50%, -50%);z-index:-1}.mdc-switch:disabled .mdc-switch__ripple{display:none}.mdc-switch__icons{height:100%;position:relative;width:100%;z-index:1}.mdc-switch__icon{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;opacity:0;transition:opacity 30ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-switch--selected .mdc-switch__icon--on,.mdc-switch--unselected .mdc-switch__icon--off{opacity:1;transition:opacity 45ms 30ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle .mdc-switch--disabled+label{color:var(--mdc-switch-disabled-label-text-color)}.mdc-switch{width:var(--mdc-switch-track-width)}.mdc-switch.mdc-switch--selected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-selected-handle-color)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-hover-handle-color)}.mdc-switch.mdc-switch--selected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-focus-handle-color)}.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-selected-pressed-handle-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-selected-handle-color)}.mdc-switch.mdc-switch--unselected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-unselected-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-hover-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-focus-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-unselected-pressed-handle-color)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-unselected-handle-color)}.mdc-switch .mdc-switch__handle::before{background:var(--mdc-switch-handle-surface-color)}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation)}.mdc-switch:disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation)}.mdc-switch .mdc-switch__focus-ring-wrapper,.mdc-switch .mdc-switch__handle{height:var(--mdc-switch-handle-height)}.mdc-switch .mdc-switch__handle{border-radius:var(--mdc-switch-handle-shape)}.mdc-switch .mdc-switch__handle{width:var(--mdc-switch-handle-width)}.mdc-switch .mdc-switch__handle-track{width:calc(100% - var(--mdc-switch-handle-width))}.mdc-switch.mdc-switch--selected:enabled .mdc-switch__icon{fill:var(--mdc-switch-selected-icon-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-selected-icon-color)}.mdc-switch.mdc-switch--unselected:enabled .mdc-switch__icon{fill:var(--mdc-switch-unselected-icon-color)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-unselected-icon-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icons{opacity:var(--mdc-switch-disabled-selected-icon-opacity)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icons{opacity:var(--mdc-switch-disabled-unselected-icon-opacity)}.mdc-switch.mdc-switch--selected .mdc-switch__icon{width:var(--mdc-switch-selected-icon-size);height:var(--mdc-switch-selected-icon-size)}.mdc-switch.mdc-switch--unselected .mdc-switch__icon{width:var(--mdc-switch-unselected-icon-size);height:var(--mdc-switch-unselected-icon-size)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-hover-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:focus .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:focus .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-focus-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-pressed-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-hover-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-focus-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-pressed-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus):hover .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus).mdc-ripple-surface--hover .mdc-switch__ripple::before{opacity:var(--mdc-switch-selected-hover-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:focus.mdc-ripple-upgraded--background-focused .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:focus:not(.mdc-ripple-upgraded):focus .mdc-switch__ripple::before{transition-duration:75ms;opacity:var(--mdc-switch-selected-focus-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:active:not(.mdc-ripple-upgraded) .mdc-switch__ripple::after{transition:opacity 150ms linear}.mdc-switch.mdc-switch--selected:enabled:active:not(.mdc-ripple-upgraded):active .mdc-switch__ripple::after{transition-duration:75ms;opacity:var(--mdc-switch-selected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:active.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-switch-selected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus):hover .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus).mdc-ripple-surface--hover .mdc-switch__ripple::before{opacity:var(--mdc-switch-unselected-hover-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:focus.mdc-ripple-upgraded--background-focused .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:focus:not(.mdc-ripple-upgraded):focus .mdc-switch__ripple::before{transition-duration:75ms;opacity:var(--mdc-switch-unselected-focus-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:active:not(.mdc-ripple-upgraded) .mdc-switch__ripple::after{transition:opacity 150ms linear}.mdc-switch.mdc-switch--unselected:enabled:active:not(.mdc-ripple-upgraded):active .mdc-switch__ripple::after{transition-duration:75ms;opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:active.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity)}.mdc-switch .mdc-switch__ripple{height:var(--mdc-switch-state-layer-size);width:var(--mdc-switch-state-layer-size)}.mdc-switch .mdc-switch__track{height:var(--mdc-switch-track-height)}.mdc-switch:disabled .mdc-switch__track{opacity:var(--mdc-switch-disabled-track-opacity)}.mdc-switch:enabled .mdc-switch__track::after{background:var(--mdc-switch-selected-track-color)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-hover-track-color)}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-focus-track-color)}.mdc-switch:enabled:active .mdc-switch__track::after{background:var(--mdc-switch-selected-pressed-track-color)}.mdc-switch:disabled .mdc-switch__track::after{background:var(--mdc-switch-disabled-selected-track-color)}.mdc-switch:enabled .mdc-switch__track::before{background:var(--mdc-switch-unselected-track-color)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-hover-track-color)}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-focus-track-color)}.mdc-switch:enabled:active .mdc-switch__track::before{background:var(--mdc-switch-unselected-pressed-track-color)}.mdc-switch:disabled .mdc-switch__track::before{background:var(--mdc-switch-disabled-unselected-track-color)}.mdc-switch .mdc-switch__track{border-radius:var(--mdc-switch-track-shape)}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation-shadow)}.mdc-switch:disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation-shadow)}.mat-mdc-slide-toggle{display:inline-block;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple,.mat-mdc-slide-toggle .mdc-switch__ripple::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple:not(:empty),.mat-mdc-slide-toggle .mdc-switch__ripple::after:not(:empty){transform:translateZ(0)}.mat-mdc-slide-toggle .mdc-switch__ripple::after{content:"";opacity:0}.mat-mdc-slide-toggle .mdc-switch:hover .mdc-switch__ripple::after{opacity:.04;transition:opacity 75ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mdc-switch .mdc-switch__ripple::after{opacity:.12}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mat-mdc-focus-indicator::before{content:""}.mat-mdc-slide-toggle .mat-ripple-element{opacity:.12}.mat-mdc-slide-toggle .mat-mdc-focus-indicator::before{border-radius:50%}.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle-track,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-elevation-overlay,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__icon,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::after,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::after{transition:none}.mat-mdc-slide-toggle .mdc-switch:enabled+.mdc-label{cursor:pointer}.mdc-switch__handle{transition:width 75ms cubic-bezier(0.4, 0, 0.2, 1),height 75ms cubic-bezier(0.4, 0, 0.2, 1),margin 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-switch--selected .mdc-switch__track::before{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mdc-switch--selected .mdc-switch__track::after{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch--unselected .mdc-switch__track::before{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch--unselected .mdc-switch__track::after{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{width:var(--mat-switch-unselected-handle-size);height:var(--mat-switch-unselected-handle-size)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{width:var(--mat-switch-selected-handle-size);height:var(--mat-switch-selected-handle-size)}.mat-mdc-slide-toggle .mdc-switch__handle:has(.mdc-switch__icons){width:var(--mat-switch-with-icon-handle-size);height:var(--mat-switch-with-icon-handle-size)}.mat-mdc-slide-toggle:active .mdc-switch:not(.mdc-switch--disabled) .mdc-switch__handle{width:var(--mat-switch-pressed-handle-size);height:var(--mat-switch-pressed-handle-size)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{margin:var(--mat-switch-selected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-selected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{margin:var(--mat-switch-unselected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-unselected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle:active .mdc-switch--selected:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-selected-pressed-handle-horizontal-margin)}.mat-mdc-slide-toggle:active .mdc-switch--unselected:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-unselected-pressed-handle-horizontal-margin)}.mdc-switch__track::after,.mdc-switch__track::before{border-width:var(--mat-switch-track-outline-width);border-color:var(--mat-switch-track-outline-color)}.mdc-switch--selected .mdc-switch__track::after,.mdc-switch--selected .mdc-switch__track::before{border-width:var(--mat-switch-selected-track-outline-width)}.mdc-switch--disabled .mdc-switch__track::after,.mdc-switch--disabled .mdc-switch__track::before{border-width:var(--mat-switch-disabled-unselected-track-outline-width);border-color:var(--mat-switch-disabled-unselected-track-outline-color)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-selected-handle-opacity)}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-unselected-handle-opacity)}'],encapsulation:2,changeDetection:0})}}return e})();var PH=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[$m,Ut,Ut]})}}return e})();var $0e=["*"],E2;function W0e(){if(E2===void 0&&(E2=null,typeof window<"u")){let e=window;e.trustedTypes!==void 0&&(E2=e.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return E2}function u_(e){return W0e()?.createHTML(e)||e}function OH(e){return Error(`Unable to find icon with the name "${e}"`)}function q0e(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}function RH(e){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${e}".`)}function FH(e){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${e}".`)}var Jc=class{constructor(t,i,r){this.url=t,this.svgText=i,this.options=r}},X0e=(()=>{class e{constructor(i,r,n,o){this._httpClient=i,this._sanitizer=r,this._errorHandler=o,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=n}addSvgIcon(i,r,n){return this.addSvgIconInNamespace("",i,r,n)}addSvgIconLiteral(i,r,n){return this.addSvgIconLiteralInNamespace("",i,r,n)}addSvgIconInNamespace(i,r,n,o){return this._addSvgIconConfig(i,r,new Jc(n,null,o))}addSvgIconResolver(i){return this._resolvers.push(i),this}addSvgIconLiteralInNamespace(i,r,n,o){let a=this._sanitizer.sanitize(Wa.HTML,n);if(!a)throw FH(n);let s=u_(a);return this._addSvgIconConfig(i,r,new Jc("",s,o))}addSvgIconSet(i,r){return this.addSvgIconSetInNamespace("",i,r)}addSvgIconSetLiteral(i,r){return this.addSvgIconSetLiteralInNamespace("",i,r)}addSvgIconSetInNamespace(i,r,n){return this._addSvgIconSetConfig(i,new Jc(r,null,n))}addSvgIconSetLiteralInNamespace(i,r,n){let o=this._sanitizer.sanitize(Wa.HTML,r);if(!o)throw FH(r);let a=u_(o);return this._addSvgIconSetConfig(i,new Jc("",a,n))}registerFontClassAlias(i,r=i){return this._fontCssClassesByAlias.set(i,r),this}classNameForFontAlias(i){return this._fontCssClassesByAlias.get(i)||i}setDefaultFontSetClass(...i){return this._defaultFontSetClass=i,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(i){let r=this._sanitizer.sanitize(Wa.RESOURCE_URL,i);if(!r)throw RH(i);let n=this._cachedIconsByUrl.get(r);return n?Dt(C2(n)):this._loadSvgIconFromConfig(new Jc(i,null)).pipe(an(o=>this._cachedIconsByUrl.set(r,o)),Xt(o=>C2(o)))}getNamedSvgIcon(i,r=""){let n=LH(r,i),o=this._svgIconConfigs.get(n);if(o)return this._getSvgFromConfig(o);if(o=this._getIconConfigFromResolvers(r,i),o)return this._svgIconConfigs.set(n,o),this._getSvgFromConfig(o);let a=this._iconSetConfigs.get(r);return a?this._getSvgFromIconSetConfigs(i,a):Gu(OH(n))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(i){return i.svgText?Dt(C2(this._svgElementFromConfig(i))):this._loadSvgIconFromConfig(i).pipe(Xt(r=>C2(r)))}_getSvgFromIconSetConfigs(i,r){let n=this._extractIconWithNameFromAnySet(i,r);if(n)return Dt(n);let o=r.filter(a=>!a.svgText).map(a=>this._loadSvgIconSetFromConfig(a).pipe(ud(s=>{let l=`Loading icon set URL: ${this._sanitizer.sanitize(Wa.RESOURCE_URL,a.url)} failed: ${s.message}`;return this._errorHandler.handleError(new Error(l)),Dt(null)})));return Nb(o).pipe(Xt(()=>{let a=this._extractIconWithNameFromAnySet(i,r);if(!a)throw OH(i);return a}))}_extractIconWithNameFromAnySet(i,r){for(let n=r.length-1;n>=0;n--){let o=r[n];if(o.svgText&&o.svgText.toString().indexOf(i)>-1){let a=this._svgElementFromConfig(o),s=this._extractSvgIconFromSet(a,i,o.options);if(s)return s}}return null}_loadSvgIconFromConfig(i){return this._fetchIcon(i).pipe(an(r=>i.svgText=r),Xt(()=>this._svgElementFromConfig(i)))}_loadSvgIconSetFromConfig(i){return i.svgText?Dt(null):this._fetchIcon(i).pipe(an(r=>i.svgText=r))}_extractSvgIconFromSet(i,r,n){let o=i.querySelector(`[id="${r}"]`);if(!o)return null;let a=o.cloneNode(!0);if(a.removeAttribute("id"),a.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(a,n);if(a.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(a),n);let s=this._svgElementFromString(u_("<svg></svg>"));return s.appendChild(a),this._setSvgAttributes(s,n)}_svgElementFromString(i){let r=this._document.createElement("DIV");r.innerHTML=i;let n=r.querySelector("svg");if(!n)throw Error("<svg> tag not found");return n}_toSvgElement(i){let r=this._svgElementFromString(u_("<svg></svg>")),n=i.attributes;for(let o=0;o<n.length;o++){let{name:a,value:s}=n[o];a!=="id"&&r.setAttribute(a,s)}for(let o=0;o<i.childNodes.length;o++)i.childNodes[o].nodeType===this._document.ELEMENT_NODE&&r.appendChild(i.childNodes[o].cloneNode(!0));return r}_setSvgAttributes(i,r){return i.setAttribute("fit",""),i.setAttribute("height","100%"),i.setAttribute("width","100%"),i.setAttribute("preserveAspectRatio","xMidYMid meet"),i.setAttribute("focusable","false"),r&&r.viewBox&&i.setAttribute("viewBox",r.viewBox),i}_fetchIcon(i){let{url:r,options:n}=i,o=n?.withCredentials??!1;if(!this._httpClient)throw q0e();if(r==null)throw Error(`Cannot fetch icon from URL "${r}".`);let a=this._sanitizer.sanitize(Wa.RESOURCE_URL,r);if(!a)throw RH(r);let s=this._inProgressUrlFetches.get(a);if(s)return s;let c=this._httpClient.get(a,{responseType:"text",withCredentials:o}).pipe(Xt(l=>u_(l)),Wu(()=>this._inProgressUrlFetches.delete(a)),l3());return this._inProgressUrlFetches.set(a,c),c}_addSvgIconConfig(i,r,n){return this._svgIconConfigs.set(LH(i,r),n),this}_addSvgIconSetConfig(i,r){let n=this._iconSetConfigs.get(i);return n?n.push(r):this._iconSetConfigs.set(i,[r]),this}_svgElementFromConfig(i){if(!i.svgElement){let r=this._svgElementFromString(i.svgText);this._setSvgAttributes(r,i.options),i.svgElement=r}return i.svgElement}_getIconConfigFromResolvers(i,r){for(let n=0;n<this._resolvers.length;n++){let o=this._resolvers[n](r,i);if(o)return Y0e(o)?new Jc(o.url,null,o.options):new Jc(o,null)}}static{this.\u0275fac=function(r){return new(r||e)(Ae(AR,8),Ae(LC),Ae(Bt,8),Ae(Xu))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function C2(e){return e.cloneNode(!0)}function LH(e,t){return e+":"+t}function Y0e(e){return!!(e.url&&e.options)}var Z0e=new Ye("MAT_ICON_DEFAULT_OPTIONS"),K0e=new Ye("mat-icon-location",{providedIn:"root",factory:Q0e});function Q0e(){let e=Je(Bt),t=e?e.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}var BH=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],J0e=BH.map(e=>`[${e}]`).join(", "),e_e=/^url\(['"]?#(.*?)['"]?\)$/,Bo=(()=>{class e{get color(){return this._color||this._defaultColor}set color(i){this._color=i}get svgIcon(){return this._svgIcon}set svgIcon(i){i!==this._svgIcon&&(i?this._updateSvgIcon(i):this._svgIcon&&this._clearSvgElement(),this._svgIcon=i)}get fontSet(){return this._fontSet}set fontSet(i){let r=this._cleanupFontValue(i);r!==this._fontSet&&(this._fontSet=r,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(i){let r=this._cleanupFontValue(i);r!==this._fontIcon&&(this._fontIcon=r,this._updateFontIconClasses())}constructor(i,r,n,o,a,s){this._elementRef=i,this._iconRegistry=r,this._location=o,this._errorHandler=a,this.inline=!1,this._previousFontSetClass=[],this._currentIconFetch=fn.EMPTY,s&&(s.color&&(this.color=this._defaultColor=s.color),s.fontSet&&(this.fontSet=s.fontSet)),n||i.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(i){if(!i)return["",""];let r=i.split(":");switch(r.length){case 1:return["",r[0]];case 2:return r;default:throw Error(`Invalid icon name: "${i}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let i=this._elementsWithExternalReferences;if(i&&i.size){let r=this._location.getPathname();r!==this._previousPath&&(this._previousPath=r,this._prependPathToReferences(r))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(i){this._clearSvgElement();let r=this._location.getPathname();this._previousPath=r,this._cacheChildrenWithExternalReferences(i),this._prependPathToReferences(r),this._elementRef.nativeElement.appendChild(i)}_clearSvgElement(){let i=this._elementRef.nativeElement,r=i.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();r--;){let n=i.childNodes[r];(n.nodeType!==1||n.nodeName.toLowerCase()==="svg")&&n.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let i=this._elementRef.nativeElement,r=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(n=>n.length>0);this._previousFontSetClass.forEach(n=>i.classList.remove(n)),r.forEach(n=>i.classList.add(n)),this._previousFontSetClass=r,this.fontIcon!==this._previousFontIconClass&&!r.includes("mat-ligature-font")&&(this._previousFontIconClass&&i.classList.remove(this._previousFontIconClass),this.fontIcon&&i.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(i){return typeof i=="string"?i.trim().split(" ")[0]:i}_prependPathToReferences(i){let r=this._elementsWithExternalReferences;r&&r.forEach((n,o)=>{n.forEach(a=>{o.setAttribute(a.name,`url('${i}#${a.value}')`)})})}_cacheChildrenWithExternalReferences(i){let r=i.querySelectorAll(J0e),n=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let o=0;o<r.length;o++)BH.forEach(a=>{let s=r[o],c=s.getAttribute(a),l=c?c.match(e_e):null;if(l){let d=n.get(s);d||(d=[],n.set(s,d)),d.push({name:a,value:l[1]})}})}_updateSvgIcon(i){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),i){let[r,n]=this._splitIconName(i);r&&(this._svgNamespace=r),n&&(this._svgName=n),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(n,r).pipe(wn(1)).subscribe(o=>this._setSvgElement(o),o=>{let a=`Error retrieving icon ${r}:${n}! ${o.message}`;this._errorHandler.handleError(new Error(a))})}}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(X0e),Zo("aria-hidden"),G(K0e),G(Xu),G(Z0e,8))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(r,n){r&2&&(Zt("data-mat-icon-type",n._usingFontIcon()?"font":"svg")("data-mat-icon-name",n._svgName||n.fontIcon)("data-mat-icon-namespace",n._svgNamespace||n.fontSet)("fontIcon",n._usingFontIcon()?n.fontIcon:null),Kr(n.color?"mat-"+n.color:""),It("mat-icon-inline",n.inline)("mat-icon-no-color",n.color!=="primary"&&n.color!=="accent"&&n.color!=="warn"))},inputs:{color:"color",inline:[_e.HasDecoratorInputTransform,"inline","inline",yt],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],standalone:!0,features:[Hi,ci],ngContentSelectors:$0e,decls:1,vars:0,template:function(r,n){r&1&&(vi(),gt(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}}return e})(),VH=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Ut,Ut]})}}return e})();var t_e=(e,t)=>({cornerHandle:e,"anchorHandle animate-pulse":t}),i_e=e=>({hidden:e}),S2=(()=>{class e{handleDrag=!1;handleSize=16;handlePos={x:256,y:-50};handleColor="#7dafff";scale=1;showCoordinates=!0;isAnchor=!1;constructor(){}startHandleDrag(i,r){this.handleDrag=!0}stopHandleDrag(){this.handleDrag=!1}moveTo(i,r,n,o){i=Math.min(Math.max(i,this.handleSize/2),n-this.handleSize/2),r=Math.min(Math.max(r,this.handleSize/2),o-this.handleSize/2),this.handlePos={x:i,y:r}}getLabelCoordinates(){let i=this.handlePos.x*this.scale,r=this.handlePos.y*this.scale;return{x:i.toFixed(0),y:r.toFixed(0)}}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Le({type:e,selectors:[["app-handle"]],inputs:{handleSize:"handleSize",handlePos:"handlePos",handleColor:"handleColor",scale:"scale",showCoordinates:"showCoordinates",isAnchor:"isAnchor"},decls:3,vars:17,consts:[[1,"handle",3,"mousedown","touchstart","touchstop","mouseup","ngClass"],[1,"select-none","pointer-events-none",3,"ngClass"]],template:function(r,n){r&1&&(C(0,"div",0),Y("mousedown",function(a){return n.startHandleDrag(a,1)})("touchstart",function(a){return n.startHandleDrag(a,1)})("touchstop",function(){return n.stopHandleDrag()})("mouseup",function(){return n.stopHandleDrag()}),C(1,"p",1),W(2),A()()),r&2&&(li("top",n.handlePos.y,"px")("left",n.handlePos.x,"px")("--width",n.handleSize,"px")("--color",n.handleColor),z("ngClass",Zp(12,t_e,!n.isAnchor,n.isAnchor)),O(),z("ngClass",Zu(15,i_e,!n.showCoordinates)),O(),F3("(",n.getLabelCoordinates().x,",",n.getLabelCoordinates().y,")"))},dependencies:[Il],styles:[".handle[_ngcontent-%COMP%]{width:var(--width);aspect-ratio:1;position:absolute;cursor:move;border:solid rgba(255,255,255,.25) 1px;transform:translate(-50%,-50%);font-size:smaller;transform-origin:top left;z-index:99;display:flex;justify-content:center;text-align:center;border-radius:100%}.cornerHandle[_ngcontent-%COMP%]{background:radial-gradient(circle at calc(var(--width) / 2) calc(var(--width) / 2),var(--color),#000);box-shadow:#0000004d 0 19px 38px,#00000038 0 15px 12px}.anchorHandle[_ngcontent-%COMP%]{border:solid rgba(255,255,255,.75) 1px;background:#bfbfbf80;z-index:128}.handle[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{position:relative;top:-24px}.handle[_ngcontent-%COMP%]:hover{border:dashed white 1px}"]})}return e})();var r_e=["handle1"],n_e=["handle2"],o_e=["midHandle"],UH=(()=>{class e{cdr;point1={x:0,y:0};point2={x:0,y:0};scale=1;property;handle1;handle2;midHandle;labelPos={x:0,y:0};midPoint={x:0,y:0};constructor(i){this.cdr=i}ngOnInit(){}ngAfterViewInit(){this.update(),this.cdr.detectChanges()}getRectangleCoordinates(){let i=this.point1.x,r=this.point1.y,n=this.point2.x,o=this.point2.y;return{x1:i,y1:r,x2:n,y2:o}}getHandles(){return[this.handle1,this.handle2]}getMidHandle(){return this.midHandle}update(){this.point1=this.handle1.handlePos,this.point2=this.handle2.handlePos,this.midPoint={x:(this.point1.x+this.point2.x)/2,y:(this.point1.y+this.point2.y)/2},this.updateNamePosition()}updateNamePosition(){let i=Math.min(this.handle1.handlePos.y,this.handle2.handlePos.y),r=this.handle1.handlePos.x,n=this.handle2.handlePos.x,o=(r+n)/2;this.labelPos={y:i,x:o}}static \u0275fac=function(r){return new(r||e)(G(ei))};static \u0275cmp=Le({type:e,selectors:[["app-roi"]],viewQuery:function(r,n){if(r&1&&(ht(r_e,5),ht(n_e,5),ht(o_e,5)),r&2){let o;Ve(o=ze())&&(n.handle1=o.first),Ve(o=ze())&&(n.handle2=o.first),Ve(o=ze())&&(n.midHandle=o.first)}},inputs:{point1:"point1",point2:"point2",scale:"scale",property:"property"},decls:8,vars:17,consts:[["handle1",""],["handle2",""],["midHandle",""],[3,"handlePos","scale","handleColor"],[3,"handlePos","scale","handleColor","handleSize","showCoordinates","isAnchor"],[1,"absolute","label","text-sm","select-none","pointer-events-none"]],template:function(r,n){r&1&&(he(0,"app-handle",3,0)(2,"app-handle",3,1)(4,"app-handle",4,2),C(6,"p",5),W(7),A()),r&2&&(z("handlePos",n.point1)("scale",n.scale)("handleColor",n.property.color),O(2),z("handlePos",n.point2)("scale",n.scale)("handleColor",n.property.color),O(2),z("handlePos",n.midPoint)("scale",n.scale)("handleColor","white")("handleSize",12)("showCoordinates",!1)("isAnchor",!0),O(2),li("top",n.labelPos.y,"px")("left",n.labelPos.x,"px"),O(),Pr(n.property.name))},dependencies:[S2],styles:[".label[_ngcontent-%COMP%]{transform:translate(-50%,-100%);transform-origin:top left;z-index:50}"]})}return e})();var s_e=["canvas"],l_e=["canvasUI"],c_e=["handleProfile"],d_e=["ROI"],u_e=e=>({BWFilter:e}),h_e=e=>({hidden:e}),p_e=()=>({x:50,y:100}),f_e=()=>({x:250,y:100});function m_e(e,t){if(e&1&&(C(0,"p",15),W(1),A()),e&2){let i=ae();O(),Pr(i.title)}}function g_e(e,t){if(e&1){let i=Ze();C(0,"span",16)(1,"mat-slide-toggle",17),qt("ngModelChange",function(n){q(i);let o=ae();return jt(o.isBWChecked,n)||(o.isBWChecked=n),X(n)}),Y("change",function(){q(i);let n=ae();return X(n.BWToggle())}),W(2,"B&W"),A()()}if(e&2){let i=ae();O(),Wt("ngModel",i.isBWChecked)}}function v_e(e,t){if(e&1){let i=Ze();C(0,"span",18)(1,"mat-slide-toggle",17),qt("ngModelChange",function(n){q(i);let o=ae();return jt(o.profile,n)||(o.profile=n),X(n)}),Y("change",function(){q(i);let n=ae();return X(n.updateCanvasUI())}),W(2,"profile"),A()()}if(e&2){let i=ae();O(),Wt("ngModel",i.profile)}}function __e(e,t){if(e&1&&(C(0,"div",19,3),he(2,"div",20),C(3,"mat-icon"),W(4,"brush"),A()()),e&2){let i=ae();li("top",i.cursorPosition.y,"px")("left",i.cursorPosition.x,"px")("width",i.getCursorTransform(),"px"),O(2),li("border-color",i.drawColor)}}function b_e(e,t){if(e&1&&he(0,"app-roi",21,4),e&2){let i=t.$implicit,r=ae();z("point1",i.initial1)("point2",i.initial2)("scale",r.getScreenToCanvasScale())("property",i)}}var Vo=(()=>{class e{drawingEnded=new We;canvas;ctx;canvasUI;ctxUI;handles;ROIs;width=256;height=this.width;UIwidth=1024;roi=[];brushRadius=10;drawColor="white";drawable=!0;title="";BWOption=!1;OnlyBW=!1;profileOption=!1;antialiasing=!0;BWSet=new We;profileChanged=new We;roiChanged=new We;profile=!1;isBWChecked=!1;cursorPosition={x:0,y:0};startDrawing=!1;initialPos;profileArray;constructor(){}ngOnInit(){let i=this.canvas.nativeElement;this.ctx=i.getContext("2d",{alpha:!1}),this.ctx.imageSmoothingEnabled=!1,this.height=this.width,i.width=this.width,i.height=this.height,this.ctx.canvas.width=this.width,this.ctx.canvas.height=this.height;let r=this.canvasUI.nativeElement;this.ctxUI=r.getContext("2d",{alpha:!0}),r.width=this.UIwidth,r.height=this.UIwidth,this.drawable&&this.captureEvents(i),this.ctx.fillRect(0,0,this.width,this.height),this.ctx.imageSmoothingEnabled=this.antialiasing}BWToggle(){this.BWSet.emit()}ngAfterViewInit(){this.updateCanvasUI()}setCanvasDimensions(i,r){this.height=r,this.width=i,this.ctx.canvas.width=i,this.ctx.canvas.height=r}getArray(){return this.ctx.getImageData(0,0,this.width,this.height).data}getCanvas(){return this.ctx.canvas}getCtx(){return this.ctx}clearCanvas(){this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.width,this.height),this.drawingEnded.emit()}drawImage(i){this.ctx.drawImage(i,0,0,this.width,this.height),this.updateCanvasUI(),this.drawingEnded.emit()}drawMat(i){cv.imshow(this.getCanvas(),i),this.updateCanvasUI()}drawMatWithoutEvent(i){cv.imshow(this.getCanvas(),i)}drawArray(i,r=this.width,n=this.height,o=0,a=0){var s=new ImageData(i,r,n);this.ctx.putImageData(s,o,a),this.updateCanvasUI(),this.drawingEnded.emit()}drawCroppedArray(i,r=this.width,n=this.height,o=0,a=0,s=0,c=0,l=r,d=n){var u=new ImageData(i,r,n);this.ctx.putImageData(u,o,a,s,c,l,d),this.updateCanvasUI(),this.drawingEnded.emit()}draw(i,r=null){this.ctx.strokeStyle=this.drawColor,this.ctx.lineCap="round",this.ctx.lineWidth=this.brushRadius,this.ctx.fillStyle=this.drawColor,this.antialiasing?(this.ctx.beginPath(),this.ctx.moveTo(i.x,i.y),r?this.ctx.lineTo(r.x,r.y):this.ctx.lineTo(i.x,i.y),this.ctx.stroke()):(r?this.drawLineNoAliasing(this.ctx,i.x,i.y,r.x,r.y):this.drawLineNoAliasing(this.ctx,i.x,i.y,i.x,i.y),this.ctx.fill())}DBP(i,r,n,o){return Math.sqrt((n-i)*(n-i)+(o-r)*(o-r))}getAngle(i,r){return Math.atan(r/(i==0?.01:i))+(i<0?Math.PI:0)}drawLineNoAliasing(i,r,n,o,a){for(var s=this.DBP(r,n,o,a),c=this.getAngle(o-r,a-n),l=0;l<s;l++)i.fillRect(Math.round(r+Math.cos(c)*l)-.5,Math.round(n+Math.sin(c)*l)-.5,this.brushRadius,this.brushRadius)}draw_callback(){this.drawingEnded.emit(!0)}captureEvents(i){let r=ya(i,"touchstart"),n=ya(i,"mousedown"),o=ya(i,"mousemove"),a=So(r,n),s=ya(i,"touchmove"),c=So(s,o),l=ya(i,"touchend"),d=ya(i,"mouseup"),u=ya(i,"mouseleave"),h=So(l,u,d),p=!1;c.subscribe({next:m=>{let f=i.getBoundingClientRect();var g=this.getClientPosition(m);this.cursorPosition.x=g.clientX-f.left,this.cursorPosition.y=g.clientY-f.top}}),a.pipe(An(m=>{let f=i.getBoundingClientRect(),g=this.getCoord(m,f);return p=!0,this.initialPos=g,this.startDrawing=!0,this.draw(g),this.draw_callback(),c.pipe(Ui(h),cC())})).subscribe({next:m=>{let f=i.getBoundingClientRect();var g=this.getCoord(m[0],f);let v=this.getCoord(m[1],f);this.startDrawing&&(this.startDrawing=!1,g=this.initialPos),this.draw(g,v),this.draw_callback()}}),h.subscribe(m=>{p&&(this.updateCanvasUI(),this.draw_callback()),p=!1})}getClientPosition(i){return i.preventDefault(),"touches"in i?{clientX:i.touches[0].clientX,clientY:i.touches[0].clientY}:{clientX:i.clientX,clientY:i.clientY}}getCoord(i,r){var n=this.getClientPosition(i);return{x:(n.clientX-r.left)*(this.width/r.width),y:(n.clientY-r.top)*(this.height/r.height)}}getCursorTransform(){return this.canvas.nativeElement.getBoundingClientRect().width/this.width*this.brushRadius}updateHandleDragPos(i){let n=this.ctxUI.canvas.getBoundingClientRect();var o=this.getClientPosition(i);let a=this.handles.toArray(),s=this.ROIs.toArray(),c=o.clientX-n.left,l=o.clientY-n.top,d=!1,u=c>=n.width||c<=0||l>=n.height||l<=0;a.forEach(h=>{h.handleDrag=u?!1:h.handleDrag,h.handleDrag&&(h.moveTo(c,l,n.width,n.height),d=!0)}),s.forEach(h=>{let p=h.getHandles();p.forEach(f=>{f.handleDrag=u?!1:f.handleDrag,f.handleDrag&&(f.moveTo(c,l,n.width,n.height),h.update(),d=!0)});let m=h.getMidHandle();if(m.handleDrag=u?!1:m.handleDrag,m.handleDrag){let f=c-m.handlePos.x,g=l-m.handlePos.y;p.forEach(v=>{v.moveTo(v.handlePos.x+f,v.handlePos.y+g,n.width,n.height),h.update(),d=!0})}}),this.updateCanvasUI()}updateCanvasUI(){this.ctxUI.clearRect(0,0,this.UIwidth,this.UIwidth),requestAnimationFrame(()=>{this.ROIs.length>0&&this.updateROI(),this.profile&&this.updateProfile()})}transformCoordinatesFromScreenToUISpace(i){let n=this.ctxUI.canvas.getBoundingClientRect(),o=n.width,a=n.height,s=i.x*(this.UIwidth/o),c=i.y*(this.UIwidth/a);return{x:s,y:c}}transformCoordinatesFromScreenToCanvas(i){let n=this.ctx.canvas.getBoundingClientRect(),o=n.width,a=n.height,s=i.x*(this.width/o),c=i.y*(this.height/a);return{x:s,y:c}}getScreenToCanvasScale(){let n=this.ctx.canvas.getBoundingClientRect().width;return this.width/n}getProfile(){return this.profileArray}updateProfile(){this.ctxUI.beginPath();let i=this.handles.toArray(),r=this.transformCoordinatesFromScreenToCanvas(i[0].handlePos),n=this.transformCoordinatesFromScreenToCanvas(i[1].handlePos),o=this.transformCoordinatesFromScreenToUISpace(i[0].handlePos),a=this.transformCoordinatesFromScreenToUISpace(i[1].handlePos);this.ctxUI.moveTo(o.x,o.y),this.ctxUI.lineTo(a.x,a.y),this.ctxUI.lineWidth=3,this.ctxUI.strokeStyle="blue",this.ctxUI.setLineDash([10,20]),this.ctxUI.stroke(),this.recomputeProfile(r,n)}updateROI(){let i=this.ROIs.toArray();this.ctxUI.setLineDash([5,5]),this.ctxUI.lineWidth=2,i.forEach(r=>{let n=r.getHandles(),o=this.transformCoordinatesFromScreenToUISpace(n[0].handlePos),a=this.transformCoordinatesFromScreenToUISpace(n[1].handlePos);this.ctxUI.beginPath(),this.ctxUI.strokeStyle=r.property.color,this.ctxUI.fillStyle=r.property.color,this.ctxUI.strokeRect(o.x,o.y,a.x-o.x,a.y-o.y),this.ctxUI.globalAlpha=.3,this.ctxUI.fillRect(o.x,o.y,a.x-o.x,a.y-o.y),this.ctxUI.fill(),this.ctxUI.globalAlpha=1,this.ctxUI.stroke(),this.recomputeROI(r)})}recomputeProfile(i,r){let n=kH(i,r);this.profileArray=new Array;let o=this.getArray();n.forEach(a=>{let s=a.y,c=a.x,l=(this.width*s+c)*4;this.profileArray.push(o[l])}),this.profileChanged.emit()}recomputeROI(i){let r=i.getHandles(),n=this.transformCoordinatesFromScreenToCanvas(r[0].handlePos),o=this.transformCoordinatesFromScreenToCanvas(r[1].handlePos),a=Math.min(n.x,o.x),s=Math.min(n.y,o.y),c=Math.abs(n.x-o.x),l=Math.abs(n.y-o.y),d=this.ctx.getImageData(a,s,c,l);i.property.data=d,this.roiChanged.emit(i.property)}isBW(){return this.isBWChecked}getValueAtSquare(i,r,n,o){return this.ctx.getImageData(i,r,n,o).data}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Le({type:e,selectors:[["app-draw-canvas"]],viewQuery:function(r,n){if(r&1&&(ht(s_e,7),ht(l_e,7),ht(c_e,5),ht(d_e,5)),r&2){let o;Ve(o=ze())&&(n.canvas=o.first),Ve(o=ze())&&(n.canvasUI=o.first),Ve(o=ze())&&(n.handles=o),Ve(o=ze())&&(n.ROIs=o)}},hostBindings:function(r,n){r&1&&Y("resize",function(a){return n.updateCanvasUI(a)},!1,A3)},inputs:{width:"width",roi:"roi",brushRadius:"brushRadius",drawColor:"drawColor",drawable:"drawable",title:"title",BWOption:"BWOption",OnlyBW:"OnlyBW",profileOption:"profileOption",antialiasing:"antialiasing"},outputs:{drawingEnded:"drawingEnded",BWSet:"BWSet",profileChanged:"profileChanged",roiChanged:"roiChanged"},decls:15,vars:20,consts:[["canvas",""],["canvasUI",""],["handleProfile",""],["cursor",""],["ROI",""],[1,"canvas-container",3,"mousemove"],["class","title select-none",4,"ngIf"],["class","BW-toggle toggle",4,"ngIf"],["class","Profile-toggle toggle",4,"ngIf"],["class","cursor",3,"top","left","width",4,"ngIf"],["id","canvasVisu",3,"ngClass"],["id","canvasUI",1,"pointer-events-none",3,"width"],[3,"ngClass"],[1,"handle",3,"handlePos","scale"],[3,"point1","point2","scale","property",4,"ngFor","ngForOf"],[1,"title","select-none"],[1,"BW-toggle","toggle"],["color","primary",3,"ngModelChange","change","ngModel"],[1,"Profile-toggle","toggle"],[1,"cursor"],[1,"cursor-radius"],[3,"point1","point2","scale","property"]],template:function(r,n){if(r&1){let o=Ze();C(0,"div",5),Y("mousemove",function(s){return q(o),X(n.updateHandleDragPos(s))}),Be(1,m_e,2,1,"p",6)(2,g_e,3,1,"span",7)(3,v_e,3,1,"span",8)(4,__e,5,8,"div",9),he(5,"canvas",10,0)(7,"canvas",11,1),C(9,"div",12),he(10,"app-handle",13,2)(12,"app-handle",13,2),A(),Be(14,b_e,2,4,"app-roi",14),A()}r&2&&(li("cursor",n.drawable?"none":"default"),O(),z("ngIf",n.title),O(),z("ngIf",n.BWOption),O(),z("ngIf",n.profileOption),O(),z("ngIf",n.drawable),O(),z("ngClass",Zu(14,u_e,n.isBWChecked||n.OnlyBW)),O(2),z("width",n.UIwidth),O(2),z("ngClass",Zu(16,h_e,!n.profile)),O(),z("handlePos",gc(18,p_e))("scale",n.getScreenToCanvasScale()),O(2),z("handlePos",gc(19,f_e))("scale",n.getScreenToCanvasScale()),O(2),z("ngForOf",n.roi))},dependencies:[Il,Xn,Yn,so,Un,$m,Bo,S2,UH],styles:[".canvas-container[_ngcontent-%COMP%]{overflow:hidden;position:relative;width:100%;aspect-ratio:1;cursor:none;box-shadow:#0000003d 0 3px 8px}.toggle[_ngcontent-%COMP%]{position:absolute;color:#fff;z-index:10;background-color:#7f7f7f80;border-radius:3px;margin:5px;padding:0 5px}.BW-toggle[_ngcontent-%COMP%]{top:0;right:0}.Profile-toggle[_ngcontent-%COMP%]{bottom:0;right:0}.title[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:10;pointer-events:none;margin:5px;background-color:#7f7f7f80;color:#fff;padding:0 5px;border-radius:3px}.canvas-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{width:100%;aspect-ratio:1}.canvas-container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:absolute;height:inherit}.cursor[_ngcontent-%COMP%]{z-index:5;position:absolute;aspect-ratio:1;transform:translate(-50%,-50%);pointer-events:none;transform-origin:top left}.cursor[_ngcontent-%COMP%] > .cursor-radius[_ngcontent-%COMP%]{position:relative;width:inherit;aspect-ratio:1;border-radius:50%;border-style:dashed;border-width:1px;pointer-events:none;transform-origin:center;animation:_ngcontent-%COMP%_rotation 20s infinite linear;background:radial-gradient(circle,#fff 0% 5%,#64646480 3% 100%)}.cursor[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translateY(-75%)}@keyframes _ngcontent-%COMP%_rotation{0%{transform:rotate(0)}to{transform:rotate(359deg)}}.BWFilter[_ngcontent-%COMP%]{filter:grayscale(1)}"]})}return e})();var y_e=["knob"],x_e=["valueIndicatorContainer"];function w_e(e,t){if(e&1&&(C(0,"div",2,1)(2,"div",5)(3,"span",6),W(4),A()()()),e&2){let i=ae();O(4),Pr(i.valueIndicatorText)}}var E_e=["trackActive"],C_e=["*"];function S_e(e,t){if(e&1&&he(0,"div"),e&2){let i=t.$implicit,r=t.$index,n=ae(3);Kr(i===0?"mdc-slider__tick-mark--active":"mdc-slider__tick-mark--inactive"),li("transform",n._calcTickMarkTransform(r))}}function T_e(e,t){if(e&1&&P3(0,S_e,1,4,"div",8,k3),e&2){let i=ae(2);N3(i._tickMarks)}}function A_e(e,t){if(e&1&&(C(0,"div",6,1),Be(2,T_e,2,0),A()),e&2){let i=ae();O(2),Ni(2,i._cachedWidth?2:-1)}}function D_e(e,t){if(e&1&&he(0,"mat-slider-visual-thumb",7),e&2){let i=ae();z("discrete",i.discrete)("thumbPosition",1)("valueIndicatorText",i.startValueIndicatorText)}}var ni=function(e){return e[e.START=1]="START",e[e.END=2]="END",e}(ni||{}),Wm=function(e){return e[e.ACTIVE=0]="ACTIVE",e[e.INACTIVE=1]="INACTIVE",e}(Wm||{}),LM=new Ye("_MatSlider"),HH=new Ye("_MatSliderThumb"),I_e=new Ye("_MatSliderRangeThumb"),jH=new Ye("_MatSliderVisualThumb");var M_e=(()=>{class e{constructor(i,r,n,o){this._cdr=i,this._ngZone=r,this._slider=o,this._isHovered=!1,this._isActive=!1,this._isValueIndicatorVisible=!1,this._platform=Je(Pi),this._onPointerMove=a=>{if(this._sliderInput._isFocused)return;let s=this._hostElement.getBoundingClientRect(),c=this._slider._isCursorOnSliderThumb(a,s);this._isHovered=c,c?this._showHoverRipple():this._hideRipple(this._hoverRippleRef)},this._onMouseLeave=()=>{this._isHovered=!1,this._hideRipple(this._hoverRippleRef)},this._onFocus=()=>{this._hideRipple(this._hoverRippleRef),this._showFocusRipple(),this._hostElement.classList.add("mdc-slider__thumb--focused")},this._onBlur=()=>{this._isActive||this._hideRipple(this._focusRippleRef),this._isHovered&&this._showHoverRipple(),this._hostElement.classList.remove("mdc-slider__thumb--focused")},this._onDragStart=a=>{a.button===0&&(this._isActive=!0,this._showActiveRipple())},this._onDragEnd=()=>{this._isActive=!1,this._hideRipple(this._activeRippleRef),this._sliderInput._isFocused||this._hideRipple(this._focusRippleRef),this._platform.SAFARI&&this._showHoverRipple()},this._hostElement=n.nativeElement}ngAfterViewInit(){this._ripple.radius=24,this._sliderInput=this._slider._getInput(this.thumbPosition),this._sliderInputEl=this._sliderInput._hostElement;let i=this._sliderInputEl;this._ngZone.runOutsideAngular(()=>{i.addEventListener("pointermove",this._onPointerMove),i.addEventListener("pointerdown",this._onDragStart),i.addEventListener("pointerup",this._onDragEnd),i.addEventListener("pointerleave",this._onMouseLeave),i.addEventListener("focus",this._onFocus),i.addEventListener("blur",this._onBlur)})}ngOnDestroy(){let i=this._sliderInputEl;i&&(i.removeEventListener("pointermove",this._onPointerMove),i.removeEventListener("pointerdown",this._onDragStart),i.removeEventListener("pointerup",this._onDragEnd),i.removeEventListener("pointerleave",this._onMouseLeave),i.removeEventListener("focus",this._onFocus),i.removeEventListener("blur",this._onBlur))}_showHoverRipple(){this._isShowingRipple(this._hoverRippleRef)||(this._hoverRippleRef=this._showRipple({enterDuration:0,exitDuration:0}),this._hoverRippleRef?.element.classList.add("mat-mdc-slider-hover-ripple"))}_showFocusRipple(){this._isShowingRipple(this._focusRippleRef)||(this._focusRippleRef=this._showRipple({enterDuration:0,exitDuration:0},!0),this._focusRippleRef?.element.classList.add("mat-mdc-slider-focus-ripple"))}_showActiveRipple(){this._isShowingRipple(this._activeRippleRef)||(this._activeRippleRef=this._showRipple({enterDuration:225,exitDuration:400}),this._activeRippleRef?.element.classList.add("mat-mdc-slider-active-ripple"))}_isShowingRipple(i){return i?.state===ha.FADING_IN||i?.state===ha.VISIBLE}_showRipple(i,r){if(!this._slider.disabled&&(this._showValueIndicator(),this._slider._isRange&&this._slider._getThumb(this.thumbPosition===ni.START?ni.END:ni.START)._showValueIndicator(),!(this._slider._globalRippleOptions?.disabled&&!r)))return this._ripple.launch({animation:this._slider._noopAnimations?{enterDuration:0,exitDuration:0}:i,centered:!0,persistent:!0})}_hideRipple(i){if(i?.fadeOut(),this._isShowingAnyRipple())return;this._slider._isRange||this._hideValueIndicator();let r=this._getSibling();r._isShowingAnyRipple()||(this._hideValueIndicator(),r._hideValueIndicator())}_showValueIndicator(){this._hostElement.classList.add("mdc-slider__thumb--with-indicator")}_hideValueIndicator(){this._hostElement.classList.remove("mdc-slider__thumb--with-indicator")}_getSibling(){return this._slider._getThumb(this.thumbPosition===ni.START?ni.END:ni.START)}_getValueIndicatorContainer(){return this._valueIndicatorContainer?.nativeElement}_getKnob(){return this._knob.nativeElement}_isShowingAnyRipple(){return this._isShowingRipple(this._hoverRippleRef)||this._isShowingRipple(this._focusRippleRef)||this._isShowingRipple(this._activeRippleRef)}static{this.\u0275fac=function(r){return new(r||e)(G(ei),G(st),G(vt),G(LM))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-slider-visual-thumb"]],viewQuery:function(r,n){if(r&1&&(ht(Ys,5),ht(y_e,5),ht(x_e,5)),r&2){let o;Ve(o=ze())&&(n._ripple=o.first),Ve(o=ze())&&(n._knob=o.first),Ve(o=ze())&&(n._valueIndicatorContainer=o.first)}},hostAttrs:[1,"mdc-slider__thumb","mat-mdc-slider-visual-thumb"],inputs:{discrete:"discrete",thumbPosition:"thumbPosition",valueIndicatorText:"valueIndicatorText"},standalone:!0,features:[Li([{provide:jH,useExisting:e}]),ci],decls:4,vars:2,consts:[["knob",""],["valueIndicatorContainer",""],[1,"mdc-slider__value-indicator-container"],[1,"mdc-slider__thumb-knob"],["matRipple","",1,"mat-mdc-focus-indicator",3,"matRippleDisabled"],[1,"mdc-slider__value-indicator"],[1,"mdc-slider__value-indicator-text"]],template:function(r,n){r&1&&(Be(0,w_e,5,1,"div",2),he(1,"div",3,0)(3,"div",4)),r&2&&(Ni(0,n.discrete?0:-1),O(3),z("matRippleDisabled",!0))},dependencies:[Ys],styles:[".mat-mdc-slider-visual-thumb .mat-ripple{height:100%;width:100%}.mat-mdc-slider .mdc-slider__tick-marks{justify-content:start}.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--inactive{position:absolute;left:2px}"],encapsulation:2,changeDetection:0})}}return e})(),GH=(()=>{class e{get disabled(){return this._disabled}set disabled(i){this._disabled=i;let r=this._getInput(ni.END),n=this._getInput(ni.START);r&&(r.disabled=this._disabled),n&&(n.disabled=this._disabled)}get discrete(){return this._discrete}set discrete(i){this._discrete=i,this._updateValueIndicatorUIs()}get min(){return this._min}set min(i){let r=isNaN(i)?this._min:i;this._min!==r&&this._updateMin(r)}_updateMin(i){let r=this._min;this._min=i,this._isRange?this._updateMinRange({old:r,new:i}):this._updateMinNonRange(i),this._onMinMaxOrStepChange()}_updateMinRange(i){let r=this._getInput(ni.END),n=this._getInput(ni.START),o=r.value,a=n.value;n.min=i.new,r.min=Math.max(i.new,n.value),n.max=Math.min(r.max,r.value),n._updateWidthInactive(),r._updateWidthInactive(),i.new<i.old?this._onTranslateXChangeBySideEffect(r,n):this._onTranslateXChangeBySideEffect(n,r),o!==r.value&&this._onValueChange(r),a!==n.value&&this._onValueChange(n)}_updateMinNonRange(i){let r=this._getInput(ni.END);if(r){let n=r.value;r.min=i,r._updateThumbUIByValue(),this._updateTrackUI(r),n!==r.value&&this._onValueChange(r)}}get max(){return this._max}set max(i){let r=isNaN(i)?this._max:i;this._max!==r&&this._updateMax(r)}_updateMax(i){let r=this._max;this._max=i,this._isRange?this._updateMaxRange({old:r,new:i}):this._updateMaxNonRange(i),this._onMinMaxOrStepChange()}_updateMaxRange(i){let r=this._getInput(ni.END),n=this._getInput(ni.START),o=r.value,a=n.value;r.max=i.new,n.max=Math.min(i.new,r.value),r.min=n.value,r._updateWidthInactive(),n._updateWidthInactive(),i.new>i.old?this._onTranslateXChangeBySideEffect(n,r):this._onTranslateXChangeBySideEffect(r,n),o!==r.value&&this._onValueChange(r),a!==n.value&&this._onValueChange(n)}_updateMaxNonRange(i){let r=this._getInput(ni.END);if(r){let n=r.value;r.max=i,r._updateThumbUIByValue(),this._updateTrackUI(r),n!==r.value&&this._onValueChange(r)}}get step(){return this._step}set step(i){let r=isNaN(i)?this._step:i;this._step!==r&&this._updateStep(r)}_updateStep(i){this._step=i,this._isRange?this._updateStepRange():this._updateStepNonRange(),this._onMinMaxOrStepChange()}_updateStepRange(){let i=this._getInput(ni.END),r=this._getInput(ni.START),n=i.value,o=r.value,a=r.value;i.min=this._min,r.max=this._max,i.step=this._step,r.step=this._step,this._platform.SAFARI&&(i.value=i.value,r.value=r.value),i.min=Math.max(this._min,r.value),r.max=Math.min(this._max,i.value),r._updateWidthInactive(),i._updateWidthInactive(),i.value<a?this._onTranslateXChangeBySideEffect(r,i):this._onTranslateXChangeBySideEffect(i,r),n!==i.value&&this._onValueChange(i),o!==r.value&&this._onValueChange(r)}_updateStepNonRange(){let i=this._getInput(ni.END);if(i){let r=i.value;i.step=this._step,this._platform.SAFARI&&(i.value=i.value),i._updateThumbUIByValue(),r!==i.value&&this._onValueChange(i)}}constructor(i,r,n,o,a,s){this._ngZone=i,this._cdr=r,this._elementRef=n,this._dir=o,this._globalRippleOptions=a,this._disabled=!1,this._discrete=!1,this.showTickMarks=!1,this._min=0,this.disableRipple=!1,this._max=100,this._step=1,this.displayWith=c=>`${c}`,this._rippleRadius=24,this.startValueIndicatorText="",this.endValueIndicatorText="",this._isRange=!1,this._isRtl=!1,this._hasViewInitialized=!1,this._tickMarkTrackWidth=0,this._hasAnimation=!1,this._resizeTimer=null,this._platform=Je(Pi),this._knobRadius=8,this._thumbsOverlap=!1,this._noopAnimations=s==="NoopAnimations",this._dirChangeSubscription=this._dir.change.subscribe(()=>this._onDirChange()),this._isRtl=this._dir.value==="rtl"}ngAfterViewInit(){this._platform.isBrowser&&this._updateDimensions();let i=this._getInput(ni.END),r=this._getInput(ni.START);this._isRange=!!i&&!!r,this._cdr.detectChanges();let n=this._getThumb(ni.END);this._rippleRadius=n._ripple.radius,this._inputPadding=this._rippleRadius-this._knobRadius,this._isRange?this._initUIRange(i,r):this._initUINonRange(i),this._updateTrackUI(i),this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._observeHostResize(),this._cdr.detectChanges()}_initUINonRange(i){i.initProps(),i.initUI(),this._updateValueIndicatorUI(i),this._hasViewInitialized=!0,i._updateThumbUIByValue()}_initUIRange(i,r){i.initProps(),i.initUI(),r.initProps(),r.initUI(),i._updateMinMax(),r._updateMinMax(),i._updateStaticStyles(),r._updateStaticStyles(),this._updateValueIndicatorUIs(),this._hasViewInitialized=!0,i._updateThumbUIByValue(),r._updateThumbUIByValue()}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._resizeObserver?.disconnect(),this._resizeObserver=null}_onDirChange(){this._isRtl=this._dir.value==="rtl",this._isRange?this._onDirChangeRange():this._onDirChangeNonRange(),this._updateTickMarkUI()}_onDirChangeRange(){let i=this._getInput(ni.END),r=this._getInput(ni.START);i._setIsLeftThumb(),r._setIsLeftThumb(),i.translateX=i._calcTranslateXByValue(),r.translateX=r._calcTranslateXByValue(),i._updateStaticStyles(),r._updateStaticStyles(),i._updateWidthInactive(),r._updateWidthInactive(),i._updateThumbUIByValue(),r._updateThumbUIByValue()}_onDirChangeNonRange(){this._getInput(ni.END)._updateThumbUIByValue()}_observeHostResize(){typeof ResizeObserver>"u"||!ResizeObserver||this._ngZone.runOutsideAngular(()=>{this._resizeObserver=new ResizeObserver(()=>{this._isActive()||(this._resizeTimer&&clearTimeout(this._resizeTimer),this._onResize())}),this._resizeObserver.observe(this._elementRef.nativeElement)})}_isActive(){return this._getThumb(ni.START)._isActive||this._getThumb(ni.END)._isActive}_getValue(i=ni.END){let r=this._getInput(i);return r?r.value:this.min}_skipUpdate(){return!!(this._getInput(ni.START)?._skipUIUpdate||this._getInput(ni.END)?._skipUIUpdate)}_updateDimensions(){this._cachedWidth=this._elementRef.nativeElement.offsetWidth,this._cachedLeft=this._elementRef.nativeElement.getBoundingClientRect().left}_setTrackActiveStyles(i){let r=this._trackActive.nativeElement.style;r.left=i.left,r.right=i.right,r.transformOrigin=i.transformOrigin,r.transform=i.transform}_calcTickMarkTransform(i){return`translateX(${i*(this._tickMarkTrackWidth/(this._tickMarks.length-1))}px`}_onTranslateXChange(i){this._hasViewInitialized&&(this._updateThumbUI(i),this._updateTrackUI(i),this._updateOverlappingThumbUI(i))}_onTranslateXChangeBySideEffect(i,r){this._hasViewInitialized&&(i._updateThumbUIByValue(),r._updateThumbUIByValue())}_onValueChange(i){this._hasViewInitialized&&(this._updateValueIndicatorUI(i),this._updateTickMarkUI(),this._cdr.detectChanges())}_onMinMaxOrStepChange(){this._hasViewInitialized&&(this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.markForCheck())}_onResize(){if(this._hasViewInitialized){if(this._updateDimensions(),this._isRange){let i=this._getInput(ni.END),r=this._getInput(ni.START);i._updateThumbUIByValue(),r._updateThumbUIByValue(),i._updateStaticStyles(),r._updateStaticStyles(),i._updateMinMax(),r._updateMinMax(),i._updateWidthInactive(),r._updateWidthInactive()}else{let i=this._getInput(ni.END);i&&i._updateThumbUIByValue()}this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.detectChanges()}}_areThumbsOverlapping(){let i=this._getInput(ni.START),r=this._getInput(ni.END);return!i||!r?!1:r.translateX-i.translateX<20}_updateOverlappingThumbClassNames(i){let r=i.getSibling(),n=this._getThumb(i.thumbPosition);this._getThumb(r.thumbPosition)._hostElement.classList.remove("mdc-slider__thumb--top"),n._hostElement.classList.toggle("mdc-slider__thumb--top",this._thumbsOverlap)}_updateOverlappingThumbUI(i){!this._isRange||this._skipUpdate()||this._thumbsOverlap!==this._areThumbsOverlapping()&&(this._thumbsOverlap=!this._thumbsOverlap,this._updateOverlappingThumbClassNames(i))}_updateThumbUI(i){if(this._skipUpdate())return;let r=this._getThumb(i.thumbPosition===ni.END?ni.END:ni.START);r._hostElement.style.transform=`translateX(${i.translateX}px)`}_updateValueIndicatorUI(i){if(this._skipUpdate())return;let r=this.displayWith(i.value);if(this._hasViewInitialized?i._valuetext.set(r):i._hostElement.setAttribute("aria-valuetext",r),this.discrete){i.thumbPosition===ni.START?this.startValueIndicatorText=r:this.endValueIndicatorText=r;let n=this._getThumb(i.thumbPosition);r.length<3?n._hostElement.classList.add("mdc-slider__thumb--short-value"):n._hostElement.classList.remove("mdc-slider__thumb--short-value")}}_updateValueIndicatorUIs(){let i=this._getInput(ni.END),r=this._getInput(ni.START);i&&this._updateValueIndicatorUI(i),r&&this._updateValueIndicatorUI(r)}_updateTickMarkTrackUI(){if(!this.showTickMarks||this._skipUpdate())return;let i=this._step&&this._step>0?this._step:1,n=(Math.floor(this.max/i)*i-this.min)/(this.max-this.min);this._tickMarkTrackWidth=this._cachedWidth*n-6}_updateTrackUI(i){this._skipUpdate()||(this._isRange?this._updateTrackUIRange(i):this._updateTrackUINonRange(i))}_updateTrackUIRange(i){let r=i.getSibling();if(!r||!this._cachedWidth)return;let n=Math.abs(r.translateX-i.translateX)/this._cachedWidth;i._isLeftThumb&&this._cachedWidth?this._setTrackActiveStyles({left:"auto",right:`${this._cachedWidth-r.translateX}px`,transformOrigin:"right",transform:`scaleX(${n})`}):this._setTrackActiveStyles({left:`${r.translateX}px`,right:"auto",transformOrigin:"left",transform:`scaleX(${n})`})}_updateTrackUINonRange(i){this._isRtl?this._setTrackActiveStyles({left:"auto",right:"0px",transformOrigin:"right",transform:`scaleX(${1-i.fillPercentage})`}):this._setTrackActiveStyles({left:"0px",right:"auto",transformOrigin:"left",transform:`scaleX(${i.fillPercentage})`})}_updateTickMarkUI(){if(!this.showTickMarks||this.step===void 0||this.min===void 0||this.max===void 0)return;let i=this.step>0?this.step:1;this._isRange?this._updateTickMarkUIRange(i):this._updateTickMarkUINonRange(i),this._isRtl&&this._tickMarks.reverse()}_updateTickMarkUINonRange(i){let r=this._getValue(),n=Math.max(Math.floor((r-this.min)/i),0),o=Math.max(Math.floor((this.max-r)/i),0);this._isRtl?n++:o++,this._tickMarks=Array(n).fill(Wm.ACTIVE).concat(Array(o).fill(Wm.INACTIVE))}_updateTickMarkUIRange(i){let r=this._getValue(),n=this._getValue(ni.START),o=Math.max(Math.floor((n-this.min)/i),0),a=Math.max(Math.floor((r-n)/i)+1,0),s=Math.max(Math.floor((this.max-r)/i),0);this._tickMarks=Array(o).fill(Wm.INACTIVE).concat(Array(a).fill(Wm.ACTIVE),Array(s).fill(Wm.INACTIVE))}_getInput(i){if(i===ni.END&&this._input)return this._input;if(this._inputs?.length)return i===ni.START?this._inputs.first:this._inputs.last}_getThumb(i){return i===ni.END?this._thumbs?.last:this._thumbs?.first}_setTransition(i){this._hasAnimation=!this._platform.IOS&&i&&!this._noopAnimations,this._elementRef.nativeElement.classList.toggle("mat-mdc-slider-with-animation",this._hasAnimation)}_isCursorOnSliderThumb(i,r){let n=r.width/2,o=r.x+n,a=r.y+n,s=i.clientX-o,c=i.clientY-a;return Math.pow(s,2)+Math.pow(c,2)<Math.pow(n,2)}static{this.\u0275fac=function(r){return new(r||e)(G(st),G(ei),G(vt),G(ds,8),G(o_,8),G(pr,8))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-slider"]],contentQueries:function(r,n,o){if(r&1&&(Xi(o,HH,5),Xi(o,I_e,4)),r&2){let a;Ve(a=ze())&&(n._input=a.first),Ve(a=ze())&&(n._inputs=a)}},viewQuery:function(r,n){if(r&1&&(ht(E_e,5),ht(jH,5)),r&2){let o;Ve(o=ze())&&(n._trackActive=o.first),Ve(o=ze())&&(n._thumbs=o)}},hostAttrs:[1,"mat-mdc-slider","mdc-slider"],hostVars:12,hostBindings:function(r,n){r&2&&(Kr("mat-"+(n.color||"primary")),It("mdc-slider--range",n._isRange)("mdc-slider--disabled",n.disabled)("mdc-slider--discrete",n.discrete)("mdc-slider--tick-marks",n.showTickMarks)("_mat-animation-noopable",n._noopAnimations))},inputs:{disabled:[_e.HasDecoratorInputTransform,"disabled","disabled",yt],discrete:[_e.HasDecoratorInputTransform,"discrete","discrete",yt],showTickMarks:[_e.HasDecoratorInputTransform,"showTickMarks","showTickMarks",yt],min:[_e.HasDecoratorInputTransform,"min","min",sn],color:"color",disableRipple:[_e.HasDecoratorInputTransform,"disableRipple","disableRipple",yt],max:[_e.HasDecoratorInputTransform,"max","max",sn],step:[_e.HasDecoratorInputTransform,"step","step",sn],displayWith:"displayWith"},exportAs:["matSlider"],standalone:!0,features:[Li([{provide:LM,useExisting:e}]),Hi,ci],ngContentSelectors:C_e,decls:9,vars:5,consts:[["trackActive",""],["tickMarkContainer",""],[1,"mdc-slider__track"],[1,"mdc-slider__track--inactive"],[1,"mdc-slider__track--active"],[1,"mdc-slider__track--active_fill"],[1,"mdc-slider__tick-marks"],[3,"discrete","thumbPosition","valueIndicatorText"],[3,"class","transform"]],template:function(r,n){r&1&&(vi(),gt(0),C(1,"div",2),he(2,"div",3),C(3,"div",4),he(4,"div",5,0),A(),Be(6,A_e,3,1,"div",6),A(),Be(7,D_e,1,3,"mat-slider-visual-thumb",7),he(8,"mat-slider-visual-thumb",7)),r&2&&(O(6),Ni(6,n.showTickMarks?6:-1),O(),Ni(7,n._isRange?7:-1),O(),z("discrete",n.discrete)("thumbPosition",2)("valueIndicatorText",n.endValueIndicatorText))},dependencies:[M_e],styles:['.mdc-slider{cursor:pointer;height:48px;margin:0 24px;position:relative;touch-action:pan-y}.mdc-slider .mdc-slider__track{position:absolute;top:50%;transform:translateY(-50%);width:100%}.mdc-slider .mdc-slider__track--active,.mdc-slider .mdc-slider__track--inactive{display:flex;height:100%;position:absolute;width:100%}.mdc-slider .mdc-slider__track--active{overflow:hidden}.mdc-slider .mdc-slider__track--active_fill{border-top-style:solid;box-sizing:border-box;height:100%;width:100%;position:relative;-webkit-transform-origin:left;transform-origin:left}[dir=rtl] .mdc-slider .mdc-slider__track--active_fill,.mdc-slider .mdc-slider__track--active_fill[dir=rtl]{-webkit-transform-origin:right;transform-origin:right}.mdc-slider .mdc-slider__track--inactive{left:0;top:0}.mdc-slider .mdc-slider__track--inactive::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-slider .mdc-slider__track--inactive::before{border-color:CanvasText}}.mdc-slider .mdc-slider__value-indicator-container{bottom:44px;left:50%;left:var(--slider-value-indicator-container-left, 50%);pointer-events:none;position:absolute;right:var(--slider-value-indicator-container-right);transform:translateX(-50%);transform:var(--slider-value-indicator-container-transform, translateX(-50%))}.mdc-slider .mdc-slider__value-indicator{transition:transform 100ms 0ms cubic-bezier(0.4, 0, 1, 1);align-items:center;border-radius:4px;display:flex;height:32px;padding:0 12px;transform:scale(0);transform-origin:bottom}.mdc-slider .mdc-slider__value-indicator::before{border-left:6px solid rgba(0,0,0,0);border-right:6px solid rgba(0,0,0,0);border-top:6px solid;bottom:-5px;content:"";height:0;left:50%;left:var(--slider-value-indicator-caret-left, 50%);position:absolute;right:var(--slider-value-indicator-caret-right);transform:translateX(-50%);transform:var(--slider-value-indicator-caret-transform, translateX(-50%));width:0}.mdc-slider .mdc-slider__value-indicator::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-slider .mdc-slider__value-indicator::after{border-color:CanvasText}}.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator-container{pointer-events:auto}.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:transform 100ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale(1)}@media(prefers-reduced-motion){.mdc-slider .mdc-slider__value-indicator,.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:none}}.mdc-slider .mdc-slider__thumb{display:flex;left:-24px;outline:none;position:absolute;user-select:none;height:48px;width:48px}.mdc-slider .mdc-slider__thumb--top{z-index:1}.mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-style:solid;border-width:1px;box-sizing:content-box}.mdc-slider .mdc-slider__thumb-knob{box-sizing:border-box;left:50%;position:absolute;top:50%;transform:translate(-50%, -50%)}.mdc-slider .mdc-slider__tick-marks{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:space-between;padding:0 1px;position:absolute;width:100%}.mdc-slider--discrete .mdc-slider__thumb,.mdc-slider--discrete .mdc-slider__track--active_fill{transition:transform 80ms ease}@media(prefers-reduced-motion){.mdc-slider--discrete .mdc-slider__thumb,.mdc-slider--discrete .mdc-slider__track--active_fill{transition:none}}.mdc-slider--disabled{cursor:auto}.mdc-slider--disabled .mdc-slider__thumb{pointer-events:none}.mdc-slider__input{cursor:pointer;left:2px;margin:0;height:44px;opacity:0;pointer-events:none;position:absolute;top:2px;width:44px}.mat-mdc-slider{display:inline-block;box-sizing:border-box;outline:none;vertical-align:middle;margin-left:8px;margin-right:8px;width:auto;min-width:112px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-slider .mdc-slider__thumb-knob{background-color:var(--mdc-slider-handle-color);border-color:var(--mdc-slider-handle-color)}.mat-mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb-knob{background-color:var(--mdc-slider-disabled-handle-color);border-color:var(--mdc-slider-disabled-handle-color)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb::before,.mat-mdc-slider .mdc-slider__thumb::after{background-color:var(--mdc-slider-handle-color)}.mat-mdc-slider .mdc-slider__thumb:hover::before,.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-surface--hover::before{opacity:var(--mdc-ripple-hover-opacity)}.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-upgraded--background-focused::before,.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:var(--mdc-ripple-focus-opacity)}.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:var(--mdc-ripple-press-opacity)}.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity)}.mat-mdc-slider .mdc-slider__track--active_fill{border-color:var(--mdc-slider-active-track-color)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__track--active_fill{border-color:var(--mdc-slider-disabled-active-track-color)}.mat-mdc-slider .mdc-slider__track--inactive{background-color:var(--mdc-slider-inactive-track-color);opacity:.24}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__track--inactive{background-color:var(--mdc-slider-disabled-inactive-track-color);opacity:.24}.mat-mdc-slider .mdc-slider__tick-mark--active{background-color:var(--mdc-slider-with-tick-marks-active-container-color);opacity:var(--mdc-slider-with-tick-marks-active-container-opacity)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__tick-mark--active{background-color:var(--mdc-slider-with-tick-marks-active-container-color);opacity:var(--mdc-slider-with-tick-marks-active-container-opacity)}.mat-mdc-slider .mdc-slider__tick-mark--inactive{background-color:var(--mdc-slider-with-tick-marks-inactive-container-color);opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__tick-mark--inactive{background-color:var(--mdc-slider-with-tick-marks-disabled-container-color);opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity)}.mat-mdc-slider .mdc-slider__value-indicator{background-color:var(--mdc-slider-label-container-color);opacity:1}.mat-mdc-slider .mdc-slider__value-indicator::before{border-top-color:var(--mdc-slider-label-container-color)}.mat-mdc-slider .mdc-slider__value-indicator{color:var(--mdc-slider-label-label-text-color)}.mat-mdc-slider .mdc-slider__track{height:var(--mdc-slider-inactive-track-height)}.mat-mdc-slider .mdc-slider__track--active{height:var(--mdc-slider-active-track-height);top:calc((var(--mdc-slider-inactive-track-height) - var(--mdc-slider-active-track-height)) / 2)}.mat-mdc-slider .mdc-slider__track--active_fill{border-top-width:var(--mdc-slider-active-track-height)}.mat-mdc-slider .mdc-slider__track--inactive{height:var(--mdc-slider-inactive-track-height)}.mat-mdc-slider .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-mark--inactive{height:var(--mdc-slider-with-tick-marks-container-size);width:var(--mdc-slider-with-tick-marks-container-size)}.mat-mdc-slider.mdc-slider--disabled{opacity:0.38}.mat-mdc-slider .mdc-slider__value-indicator-text{letter-spacing:var(--mdc-slider-label-label-text-tracking);font-size:var(--mdc-slider-label-label-text-size);font-family:var(--mdc-slider-label-label-text-font);font-weight:var(--mdc-slider-label-label-text-weight);line-height:var(--mdc-slider-label-label-text-line-height)}.mat-mdc-slider .mdc-slider__track--active{border-radius:var(--mdc-slider-active-track-shape)}.mat-mdc-slider .mdc-slider__track--inactive{border-radius:var(--mdc-slider-inactive-track-shape)}.mat-mdc-slider .mdc-slider__thumb-knob{border-radius:var(--mdc-slider-handle-shape);width:var(--mdc-slider-handle-width);height:var(--mdc-slider-handle-height);border-style:solid;border-width:calc(var(--mdc-slider-handle-height) / 2) calc(var(--mdc-slider-handle-width) / 2)}.mat-mdc-slider .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-mark--inactive{border-radius:var(--mdc-slider-with-tick-marks-container-shape)}.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb-knob{background-color:var(--mdc-slider-hover-handle-color);border-color:var(--mdc-slider-hover-handle-color)}.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb-knob{background-color:var(--mdc-slider-focus-handle-color);border-color:var(--mdc-slider-focus-handle-color)}.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:var(--mdc-slider-with-overlap-handle-outline-color);border-width:var(--mdc-slider-with-overlap-handle-outline-width)}.mat-mdc-slider .mdc-slider__thumb-knob{box-shadow:var(--mdc-slider-handle-elevation)}.mat-mdc-slider .mdc-slider__input{box-sizing:content-box;pointer-events:auto}.mat-mdc-slider .mdc-slider__input.mat-mdc-slider-input-no-pointer-events{pointer-events:none}.mat-mdc-slider .mdc-slider__input.mat-slider__right-input{left:auto;right:0}.mat-mdc-slider .mdc-slider__thumb,.mat-mdc-slider .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider.mdc-slider--discrete .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider .mdc-slider__track,.mat-mdc-slider .mdc-slider__thumb{pointer-events:none}.mat-mdc-slider .mdc-slider__value-indicator-container{transform:var(--mat-slider-value-indicator-container-transform)}.mat-mdc-slider .mdc-slider__value-indicator{width:var(--mat-slider-value-indicator-width);height:var(--mat-slider-value-indicator-height);padding:var(--mat-slider-value-indicator-padding);opacity:var(--mat-slider-value-indicator-opacity);border-radius:var(--mat-slider-value-indicator-border-radius)}.mat-mdc-slider .mdc-slider__value-indicator::before{display:var(--mat-slider-value-indicator-caret-display)}.mat-mdc-slider .mdc-slider__value-indicator-text{width:var(--mat-slider-value-indicator-width);transform:var(--mat-slider-value-indicator-text-transform)}.mat-mdc-slider .mat-ripple .mat-ripple-element{background-color:var(--mat-slider-ripple-color)}.mat-mdc-slider .mat-ripple .mat-mdc-slider-hover-ripple{background-color:var(--mat-slider-hover-state-layer-color)}.mat-mdc-slider .mat-ripple .mat-mdc-slider-focus-ripple,.mat-mdc-slider .mat-ripple .mat-mdc-slider-active-ripple{background-color:var(--mat-slider-focus-state-layer-color)}.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__track--active_fill,.mat-mdc-slider._mat-animation-noopable .mdc-slider__value-indicator{transition:none}.mat-mdc-slider .mat-mdc-focus-indicator::before{border-radius:50%}.mat-mdc-slider .mdc-slider__value-indicator{word-break:normal}.mat-mdc-slider .mdc-slider__value-indicator-text{text-align:center}.mdc-slider__thumb--focused .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}}return e})();var k_e={provide:Ql,useExisting:Yo(()=>BM),multi:!0};var BM=(()=>{class e{get value(){return sn(this._hostElement.value,0)}set value(i){i=isNaN(i)?0:i;let r=i+"";if(!this._hasSetInitialValue){this._initialValue=r;return}this._isActive||this._setValue(r)}_setValue(i){this._hostElement.value=i,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges(),this._slider._cdr.markForCheck()}get translateX(){return this._slider.min>=this._slider.max?(this._translateX=this._tickMarkOffset,this._translateX):(this._translateX===void 0&&(this._translateX=this._calcTranslateXByValue()),this._translateX)}set translateX(i){this._translateX=i}get min(){return sn(this._hostElement.min,0)}set min(i){this._hostElement.min=i+"",this._cdr.detectChanges()}get max(){return sn(this._hostElement.max,0)}set max(i){this._hostElement.max=i+"",this._cdr.detectChanges()}get step(){return sn(this._hostElement.step,0)}set step(i){this._hostElement.step=i+"",this._cdr.detectChanges()}get disabled(){return yt(this._hostElement.disabled)}set disabled(i){this._hostElement.disabled=i,this._cdr.detectChanges(),this._slider.disabled!==this.disabled&&(this._slider.disabled=this.disabled)}get percentage(){return this._slider.min>=this._slider.max?this._slider._isRtl?1:0:(this.value-this._slider.min)/(this._slider.max-this._slider.min)}get fillPercentage(){return this._slider._cachedWidth?this._translateX===0?0:this.translateX/this._slider._cachedWidth:this._slider._isRtl?1:0}_setIsFocused(i){this._isFocused=i}constructor(i,r,n,o){this._ngZone=i,this._elementRef=r,this._cdr=n,this._slider=o,this.valueChange=new We,this.dragStart=new We,this.dragEnd=new We,this.thumbPosition=ni.END,this._valuetext=D3(""),this._knobRadius=8,this._tickMarkOffset=3,this._isActive=!1,this._isFocused=!1,this._hasSetInitialValue=!1,this._destroyed=new Ct,this._skipUIUpdate=!1,this._onTouchedFn=()=>{},this._isControlInitialized=!1,this._platform=Je(Pi),this._hostElement=r.nativeElement,this._ngZone.runOutsideAngular(()=>{this._hostElement.addEventListener("pointerdown",this._onPointerDown.bind(this)),this._hostElement.addEventListener("pointermove",this._onPointerMove.bind(this)),this._hostElement.addEventListener("pointerup",this._onPointerUp.bind(this))})}ngOnDestroy(){this._hostElement.removeEventListener("pointerdown",this._onPointerDown),this._hostElement.removeEventListener("pointermove",this._onPointerMove),this._hostElement.removeEventListener("pointerup",this._onPointerUp),this._destroyed.next(),this._destroyed.complete(),this.dragStart.complete(),this.dragEnd.complete()}initProps(){this._updateWidthInactive(),this.disabled!==this._slider.disabled&&(this._slider.disabled=!0),this.step=this._slider.step,this.min=this._slider.min,this.max=this._slider.max,this._initValue()}initUI(){this._updateThumbUIByValue()}_initValue(){this._hasSetInitialValue=!0,this._initialValue===void 0?this.value=this._getDefaultValue():(this._hostElement.value=this._initialValue,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges())}_getDefaultValue(){return this.min}_onBlur(){this._setIsFocused(!1),this._onTouchedFn()}_onFocus(){this._slider._setTransition(!1),this._slider._updateTrackUI(this),this._setIsFocused(!0)}_onChange(){this.valueChange.emit(this.value),this._isActive&&this._updateThumbUIByValue({withAnimation:!0})}_onInput(){this._onChangeFn?.(this.value),(this._slider.step||!this._isActive)&&this._updateThumbUIByValue({withAnimation:!0}),this._slider._onValueChange(this)}_onNgControlValueChange(){(!this._isActive||!this._isFocused)&&(this._slider._onValueChange(this),this._updateThumbUIByValue()),this._slider.disabled=this._formControl.disabled}_onPointerDown(i){if(!(this.disabled||i.button!==0)){if(this._platform.IOS){let r=this._slider._isCursorOnSliderThumb(i,this._slider._getThumb(this.thumbPosition)._hostElement.getBoundingClientRect());this._isActive=r,this._updateWidthActive(),this._slider._updateDimensions();return}this._isActive=!0,this._setIsFocused(!0),this._updateWidthActive(),this._slider._updateDimensions(),this._slider.step||this._updateThumbUIByPointerEvent(i,{withAnimation:!0}),this.disabled||(this._handleValueCorrection(i),this.dragStart.emit({source:this,parent:this._slider,value:this.value}))}}_handleValueCorrection(i){this._skipUIUpdate=!0,setTimeout(()=>{this._skipUIUpdate=!1,this._fixValue(i)},0)}_fixValue(i){let r=i.clientX-this._slider._cachedLeft,n=this._slider._cachedWidth,o=this._slider.step===0?1:this._slider.step,a=Math.floor((this._slider.max-this._slider.min)/o),s=this._slider._isRtl?1-r/n:r/n,l=Math.round(s*a)/a*(this._slider.max-this._slider.min)+this._slider.min,d=Math.round(l/o)*o,u=this.value;if(d===u){this._slider._onValueChange(this),this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(i,{withAnimation:this._slider._hasAnimation});return}this.value=d,this.valueChange.emit(this.value),this._onChangeFn?.(this.value),this._slider._onValueChange(this),this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(i,{withAnimation:this._slider._hasAnimation})}_onPointerMove(i){!this._slider.step&&this._isActive&&this._updateThumbUIByPointerEvent(i)}_onPointerUp(){this._isActive&&(this._isActive=!1,this._platform.SAFARI&&this._setIsFocused(!1),this.dragEnd.emit({source:this,parent:this._slider,value:this.value}),setTimeout(()=>this._updateWidthInactive(),this._platform.IOS?10:0))}_clamp(i){let r=this._tickMarkOffset,n=this._slider._cachedWidth-this._tickMarkOffset;return Math.max(Math.min(i,n),r)}_calcTranslateXByValue(){return this._slider._isRtl?(1-this.percentage)*(this._slider._cachedWidth-this._tickMarkOffset*2)+this._tickMarkOffset:this.percentage*(this._slider._cachedWidth-this._tickMarkOffset*2)+this._tickMarkOffset}_calcTranslateXByPointerEvent(i){return i.clientX-this._slider._cachedLeft}_updateWidthActive(){}_updateWidthInactive(){this._hostElement.style.padding=`0 ${this._slider._inputPadding}px`,this._hostElement.style.width=`calc(100% + ${this._slider._inputPadding-this._tickMarkOffset*2}px)`,this._hostElement.style.left=`-${this._slider._rippleRadius-this._tickMarkOffset}px`}_updateThumbUIByValue(i){this.translateX=this._clamp(this._calcTranslateXByValue()),this._updateThumbUI(i)}_updateThumbUIByPointerEvent(i,r){this.translateX=this._clamp(this._calcTranslateXByPointerEvent(i)),this._updateThumbUI(r)}_updateThumbUI(i){this._slider._setTransition(!!i?.withAnimation),this._slider._onTranslateXChange(this)}writeValue(i){(this._isControlInitialized||i!==null)&&(this.value=i)}registerOnChange(i){this._onChangeFn=i,this._isControlInitialized=!0}registerOnTouched(i){this._onTouchedFn=i}setDisabledState(i){this.disabled=i}focus(){this._hostElement.focus()}blur(){this._hostElement.blur()}static{this.\u0275fac=function(r){return new(r||e)(G(st),G(vt),G(ei),G(LM))}}static{this.\u0275dir=xt({type:e,selectors:[["input","matSliderThumb",""]],hostAttrs:["type","range",1,"mdc-slider__input"],hostVars:1,hostBindings:function(r,n){r&1&&Y("change",function(){return n._onChange()})("input",function(){return n._onInput()})("blur",function(){return n._onBlur()})("focus",function(){return n._onFocus()}),r&2&&Zt("aria-valuetext",n._valuetext())},inputs:{value:[_e.HasDecoratorInputTransform,"value","value",sn]},outputs:{valueChange:"valueChange",dragStart:"dragStart",dragEnd:"dragEnd"},exportAs:["matSliderThumb"],standalone:!0,features:[Li([k_e,{provide:HH,useExisting:e}]),Hi]})}}return e})();var $H=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Ut,Kc]})}}return e})();var WH=_u({passive:!0}),qH=(()=>{class e{constructor(i,r){this._platform=i,this._ngZone=r,this._monitoredElements=new Map}monitor(i){if(!this._platform.isBrowser)return ws;let r=Xs(i),n=this._monitoredElements.get(r);if(n)return n.subject;let o=new Ct,a="cdk-text-field-autofilled",s=c=>{c.animationName==="cdk-text-field-autofill-start"&&!r.classList.contains(a)?(r.classList.add(a),this._ngZone.run(()=>o.next({target:c.target,isAutofilled:!0}))):c.animationName==="cdk-text-field-autofill-end"&&r.classList.contains(a)&&(r.classList.remove(a),this._ngZone.run(()=>o.next({target:c.target,isAutofilled:!1})))};return this._ngZone.runOutsideAngular(()=>{r.addEventListener("animationstart",s,WH),r.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(r,{subject:o,unlisten:()=>{r.removeEventListener("animationstart",s,WH)}}),o}stopMonitoring(i){let r=Xs(i),n=this._monitoredElements.get(r);n&&(n.unlisten(),n.subject.complete(),r.classList.remove("cdk-text-field-autofill-monitored"),r.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(r))}ngOnDestroy(){this._monitoredElements.forEach((i,r)=>this.stopMonitoring(r))}static{this.\u0275fac=function(r){return new(r||e)(Ae(Pi),Ae(st))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var XH=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({})}}return e})();var O_e=new Ye("MAT_INPUT_VALUE_ACCESSOR"),R_e=["button","checkbox","file","hidden","image","radio","range","reset","submit"],F_e=0,YH=(()=>{class e{get disabled(){return this._disabled}set disabled(i){this._disabled=Lo(i),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(i){this._id=i||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(ym.required)??!1}set required(i){this._required=Lo(i)}get type(){return this._type}set type(i){this._type=i||"text",this._validateType(),!this._isTextarea&&JI().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(i){this._errorStateTracker.matcher=i}get value(){return this._inputValueAccessor.value}set value(i){i!==this.value&&(this._inputValueAccessor.value=i,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(i){this._readonly=Lo(i)}get errorState(){return this._errorStateTracker.errorState}set errorState(i){this._errorStateTracker.errorState=i}constructor(i,r,n,o,a,s,c,l,d,u){this._elementRef=i,this._platform=r,this.ngControl=n,this._autofillMonitor=l,this._formField=u,this._uid=`mat-input-${F_e++}`,this.focused=!1,this.stateChanges=new Ct,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(m=>JI().has(m)),this._iOSKeyupListener=m=>{let f=m.target;!f.value&&f.selectionStart===0&&f.selectionEnd===0&&(f.setSelectionRange(1,1),f.setSelectionRange(0,0))};let h=this._elementRef.nativeElement,p=h.nodeName.toLowerCase();this._inputValueAccessor=c||h,this._previousNativeValue=this.value,this.id=this.id,r.IOS&&d.runOutsideAngular(()=>{i.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._errorStateTracker=new Bm(s,n,a,o,this.stateChanges),this._isServer=!this._platform.isBrowser,this._isNativeSelect=p==="select",this._isTextarea=p==="textarea",this._isInFormField=!!u,this._isNativeSelect&&(this.controlType=h.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(i=>{this.autofilled=i.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==null&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(i){this._elementRef.nativeElement.focus(i)}updateErrorState(){this._errorStateTracker.updateErrorState()}_focusChanged(i){i!==this.focused&&(this.focused=i,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){let i=this._elementRef.nativeElement.value;this._previousNativeValue!==i&&(this._previousNativeValue=i,this.stateChanges.next())}_dirtyCheckPlaceholder(){let i=this._getPlaceholder();if(i!==this._previousPlaceholder){let r=this._elementRef.nativeElement;this._previousPlaceholder=i,i?r.setAttribute("placeholder",i):r.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){R_e.indexOf(this._type)>-1}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let i=this._elementRef.nativeElement.validity;return i&&i.badInput}get empty(){return!this._isNeverEmpty()&&!this._elementRef.nativeElement.value&&!this._isBadInput()&&!this.autofilled}get shouldLabelFloat(){if(this._isNativeSelect){let i=this._elementRef.nativeElement,r=i.options[0];return this.focused||i.multiple||!this.empty||!!(i.selectedIndex>-1&&r&&r.label)}else return this.focused||!this.empty}setDescribedByIds(i){i.length?this._elementRef.nativeElement.setAttribute("aria-describedby",i.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){let i=this._elementRef.nativeElement;return this._isNativeSelect&&(i.multiple||i.size>1)}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(Pi),G(Zc,10),G(N0,8),G(O0,8),G(s2),G(O_e,10),G(qH),G(st),G(s_,8))}}static{this.\u0275dir=xt({type:e,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(r,n){r&1&&Y("focus",function(){return n._focusChanged(!0)})("blur",function(){return n._focusChanged(!1)})("input",function(){return n._onInput()}),r&2&&(Dl("id",n.id)("disabled",n.disabled)("required",n.required),Zt("name",n.name||null)("readonly",n.readonly&&!n._isNativeSelect||null)("aria-invalid",n.empty&&n.required?null:n.errorState)("aria-required",n.required)("id",n.id),It("mat-input-server",n._isServer)("mat-mdc-form-field-textarea-control",n._isInFormField&&n._isTextarea)("mat-mdc-form-field-input-control",n._isInFormField)("mdc-text-field__input",n._isInFormField)("mat-mdc-native-select-inline",n._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:[_e.None,"aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],standalone:!0,features:[Li([{provide:a_,useExisting:e}]),kr]})}}return e})(),ZH=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Ut,fp,fp,XH,Ut]})}}return e})();var Mr=(()=>{class e{cdr;min=1;max=100;step=1;value=15;title="";valueChange=new We;constructor(i){this.cdr=i}ngOnInit(){}ngAfterContentInit(){this.cdr.detectChanges()}ngAfterViewInit(){this.cdr.detectChanges()}onChange(i){this.valueChange.emit(i)}static \u0275fac=function(r){return new(r||e)(G(ei))};static \u0275cmp=Le({type:e,selectors:[["app-labelled-sliders"]],inputs:{min:"min",max:"max",step:"step",value:"value",title:"title"},outputs:{valueChange:"valueChange"},decls:9,vars:6,consts:[["slider",""],[1,"vertical-flex"],["appearance","fill"],["matInput","","type","text","readonly","true",3,"ngModelChange","ngModel"],["thumbLabel","","tickInterval","auto",3,"min","max","step"],["matSliderThumb","",3,"ngModelChange","valueChange","ngModel"]],template:function(r,n){if(r&1){let o=Ze();C(0,"div",1)(1,"mat-form-field",2)(2,"mat-label"),W(3),A(),C(4,"input",3),qt("ngModelChange",function(s){return q(o),jt(n.value,s)||(n.value=s),X(s)}),A()(),C(5,"mat-slider",4,0)(7,"input",5,0),qt("ngModelChange",function(s){return q(o),jt(n.value,s)||(n.value=s),X(s)}),Y("valueChange",function(s){return q(o),X(n.onChange(s))}),A()()()}r&2&&(O(3),Pr(n.title),O(),Wt("ngModel",n.value),O(),z("min",n.min)("max",n.max)("step",n.step),O(2),Wt("ngModel",n.value))},dependencies:[Hm,rc,BM,C1,so,Un,YH,GH]})}return e})();var KH=["*"],B_e=["content"],V_e=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],z_e=["mat-drawer","mat-drawer-content","*"];function U_e(e,t){if(e&1){let i=Ze();C(0,"div",1),Y("click",function(){q(i);let n=ae();return X(n._onBackdropClicked())}),A()}if(e&2){let i=ae();It("mat-drawer-shown",i._isShowingBackdrop())}}function H_e(e,t){e&1&&(C(0,"mat-drawer-content"),gt(1,2),A())}var j_e={transformDrawer:Pl("transform",[Cs("open, open-instant",Ko({transform:"none",visibility:"visible"})),Cs("void",Ko({"box-shadow":"none",visibility:"hidden"})),Ss("void => open-instant",ll("0ms")),Ss("void <=> open, open-instant => void",ll("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])};var G_e=new Ye("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:$_e}),QH=new Ye("MAT_DRAWER_CONTAINER");function $_e(){return!1}var VM=(()=>{class e extends p2{constructor(i,r,n,o,a){super(n,o,a),this._changeDetectorRef=i,this._container=r}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}static{this.\u0275fac=function(r){return new(r||e)(G(ei),G(Yo(()=>p_)),G(vt),G(l_),G(st))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(r,n){r&2&&li("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},standalone:!0,features:[Li([{provide:p2,useExisting:e}]),Yt,ci],ngContentSelectors:KH,decls:1,vars:0,template:function(r,n){r&1&&(vi(),gt(0))},encapsulation:2,changeDetection:0})}}return e})(),h_=(()=>{class e{get position(){return this._position}set position(i){i=i==="end"?"end":"start",i!==this._position&&(this._isAttached&&this._updatePositionInParent(i),this._position=i,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(i){this._mode=i,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(i){this._disableClose=Lo(i)}get autoFocus(){let i=this._autoFocus;return i??(this.mode==="side"?"dialog":"first-tabbable")}set autoFocus(i){(i==="true"||i==="false"||i==null)&&(i=Lo(i)),this._autoFocus=i}get opened(){return this._opened}set opened(i){this.toggle(Lo(i))}constructor(i,r,n,o,a,s,c,l){this._elementRef=i,this._focusTrapFactory=r,this._focusMonitor=n,this._platform=o,this._ngZone=a,this._interactivityChecker=s,this._doc=c,this._container=l,this._focusTrap=null,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new Ct,this._animationEnd=new Ct,this._animationState="void",this.openedChange=new We(!0),this._openedStream=this.openedChange.pipe(Ji(d=>d),Xt(()=>{})),this.openedStart=this._animationStarted.pipe(Ji(d=>d.fromState!==d.toState&&d.toState.indexOf("open")===0),Pg(void 0)),this._closedStream=this.openedChange.pipe(Ji(d=>!d),Xt(()=>{})),this.closedStart=this._animationStarted.pipe(Ji(d=>d.fromState!==d.toState&&d.toState==="void"),Pg(void 0)),this._destroyed=new Ct,this.onPositionChanged=new We,this._modeChanged=new Ct,this.openedChange.subscribe(d=>{d?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{ya(this._elementRef.nativeElement,"keydown").pipe(Ji(d=>d.keyCode===27&&!this.disableClose&&!us(d)),Ui(this._destroyed)).subscribe(d=>this._ngZone.run(()=>{this.close(),d.stopPropagation(),d.preventDefault()}))}),this._animationEnd.pipe($u((d,u)=>d.fromState===u.fromState&&d.toState===u.toState)).subscribe(d=>{let{fromState:u,toState:h}=d;(h.indexOf("open")===0&&u==="void"||h==="void"&&u.indexOf("open")===0)&&this.openedChange.emit(this._opened)})}_forceFocus(i,r){this._interactivityChecker.isFocusable(i)||(i.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{let n=()=>{i.removeEventListener("blur",n),i.removeEventListener("mousedown",n),i.removeAttribute("tabindex")};i.addEventListener("blur",n),i.addEventListener("mousedown",n)})),i.focus(r)}_focusByCssSelector(i,r){let n=this._elementRef.nativeElement.querySelector(i);n&&this._forceFocus(n,r)}_takeFocus(){if(!this._focusTrap)return;let i=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(r=>{!r&&typeof this._elementRef.nativeElement.focus=="function"&&i.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus);break}}_restoreFocus(i){this.autoFocus!=="dialog"&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,i):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){let i=this._doc.activeElement;return!!i&&this._elementRef.nativeElement.contains(i)}ngAfterViewInit(){this._isAttached=!0,this._position==="end"&&this._updatePositionInParent("end"),this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState())}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap?.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(i){return this.toggle(!0,i)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(i=!this.opened,r){i&&r&&(this._openedVia=r);let n=this._setOpen(i,!i&&this._isFocusWithinDrawer(),this._openedVia||"program");return i||(this._openedVia=null),n}_setOpen(i,r,n){return this._opened=i,i?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",r&&this._restoreFocus(n)),this._updateFocusTrapState(),new Promise(o=>{this.openedChange.pipe(wn(1)).subscribe(a=>o(a?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=!!this._container?.hasBackdrop)}_updatePositionInParent(i){if(!this._platform.isBrowser)return;let r=this._elementRef.nativeElement,n=r.parentNode;i==="end"?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),n.insertBefore(this._anchor,r)),n.appendChild(r)):this._anchor&&this._anchor.parentNode.insertBefore(r,this._anchor)}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(V9),G(ic),G(Pi),G(st),G(sM),G(Bt,8),G(QH,8))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-drawer"]],viewQuery:function(r,n){if(r&1&&ht(B_e,5),r&2){let o;Ve(o=ze())&&(n._content=o.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(r,n){r&1&&R3("@transform.start",function(a){return n._animationStarted.next(a)})("@transform.done",function(a){return n._animationEnd.next(a)}),r&2&&(O3("@transform",n._animationState),Zt("align",null),It("mat-drawer-end",n.position==="end")("mat-drawer-over",n.mode==="over")("mat-drawer-push",n.mode==="push")("mat-drawer-side",n.mode==="side")("mat-drawer-opened",n.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],standalone:!0,features:[ci],ngContentSelectors:KH,decls:3,vars:0,consts:[["content",""],["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(r,n){r&1&&(vi(),C(0,"div",1,0),gt(2),A())},dependencies:[p2],encapsulation:2,data:{animation:[j_e.transformDrawer]},changeDetection:0})}}return e})(),p_=(()=>{class e{get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(i){this._autosize=Lo(i)}get hasBackdrop(){return this._drawerHasBackdrop(this._start)||this._drawerHasBackdrop(this._end)}set hasBackdrop(i){this._backdropOverride=i==null?null:Lo(i)}get scrollable(){return this._userContent||this._content}constructor(i,r,n,o,a,s=!1,c){this._dir=i,this._element=r,this._ngZone=n,this._changeDetectorRef=o,this._animationMode=c,this._drawers=new Yu,this.backdropClick=new We,this._destroyed=new Ct,this._doCheckSubject=new Ct,this._contentMargins={left:null,right:null},this._contentMarginChanges=new Ct,i&&i.change.pipe(Ui(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),a.change().pipe(Ui(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=s}ngAfterContentInit(){this._allDrawers.changes.pipe(xa(this._allDrawers),Ui(this._destroyed)).subscribe(i=>{this._drawers.reset(i.filter(r=>!r._container||r._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(xa(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(i=>{this._watchDrawerToggle(i),this._watchDrawerPosition(i),this._watchDrawerMode(i)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(Hp(10),Ui(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(i=>i.open())}close(){this._drawers.forEach(i=>i.close())}updateContentMargins(){let i=0,r=0;if(this._left&&this._left.opened){if(this._left.mode=="side")i+=this._left._getWidth();else if(this._left.mode=="push"){let n=this._left._getWidth();i+=n,r-=n}}if(this._right&&this._right.opened){if(this._right.mode=="side")r+=this._right._getWidth();else if(this._right.mode=="push"){let n=this._right._getWidth();r+=n,i-=n}}i=i||null,r=r||null,(i!==this._contentMargins.left||r!==this._contentMargins.right)&&(this._contentMargins={left:i,right:r},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(i){i._animationStarted.pipe(Ji(r=>r.fromState!==r.toState),Ui(this._drawers.changes)).subscribe(r=>{r.toState!=="open-instant"&&this._animationMode!=="NoopAnimations"&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),i.mode!=="side"&&i.openedChange.pipe(Ui(this._drawers.changes)).subscribe(()=>this._setContainerClass(i.opened))}_watchDrawerPosition(i){i&&i.onPositionChanged.pipe(Ui(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(wn(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(i){i&&i._modeChanged.pipe(Ui(So(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(i){let r=this._element.nativeElement.classList,n="mat-drawer-container-has-open";i?r.add(n):r.remove(n)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(i=>{i.position=="end"?(this._end!=null,this._end=i):(this._start!=null,this._start=i)}),this._right=this._left=null,this._dir&&this._dir.value==="rtl"?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&this._start.mode!="over"||this._isDrawerOpen(this._end)&&this._end.mode!="over"}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(i=>i&&!i.disableClose&&this._drawerHasBackdrop(i)).forEach(i=>i._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._drawerHasBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._drawerHasBackdrop(this._end)}_isDrawerOpen(i){return i!=null&&i.opened}_drawerHasBackdrop(i){return this._backdropOverride==null?!!i&&i.mode!=="side":this._backdropOverride}static{this.\u0275fac=function(r){return new(r||e)(G(ds,8),G(vt),G(st),G(ei),G(gp),G(G_e),G(pr,8))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-drawer-container"]],contentQueries:function(r,n,o){if(r&1&&(Xi(o,VM,5),Xi(o,h_,5)),r&2){let a;Ve(a=ze())&&(n._content=a.first),Ve(a=ze())&&(n._allDrawers=a)}},viewQuery:function(r,n){if(r&1&&ht(VM,5),r&2){let o;Ve(o=ze())&&(n._userContent=o.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(r,n){r&2&&It("mat-drawer-container-explicit-backdrop",n._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],standalone:!0,features:[Li([{provide:QH,useExisting:e}]),ci],ngContentSelectors:z_e,decls:4,vars:2,consts:[[1,"mat-drawer-backdrop",3,"mat-drawer-shown"],[1,"mat-drawer-backdrop",3,"click"]],template:function(r,n){r&1&&(vi(V_e),Be(0,U_e,1,2,"div",0),gt(1),gt(2,1),Be(3,H_e,2,0,"mat-drawer-content")),r&2&&(Ni(0,n.hasBackdrop?0:-1),O(3),Ni(3,n._content?-1:3))},dependencies:[VM],styles:['.mat-drawer-container{position:relative;z-index:1;color:var(--mat-sidenav-content-text-color);background-color:var(--mat-sidenav-content-background-color);box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible;background-color:var(--mat-sidenav-scrim-color)}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;color:var(--mat-sidenav-container-text-color);box-shadow:var(--mat-sidenav-container-elevation-shadow);background-color:var(--mat-sidenav-container-background-color);border-top-right-radius:var(--mat-sidenav-container-shape);border-bottom-right-radius:var(--mat-sidenav-container-shape);width:var(--mat-sidenav-container-width);display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0);border-top-left-radius:var(--mat-sidenav-container-shape);border-bottom-left-radius:var(--mat-sidenav-container-shape);border-top-right-radius:0;border-bottom-right-radius:0}[dir=rtl] .mat-drawer{border-top-left-radius:var(--mat-sidenav-container-shape);border-bottom-left-radius:var(--mat-sidenav-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{border-top-right-radius:var(--mat-sidenav-container-shape);border-bottom-right-radius:var(--mat-sidenav-container-shape);border-top-left-radius:0;border-bottom-left-radius:0;left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-side{box-shadow:none;border-right-color:var(--mat-sidenav-container-divider-color);border-right-width:1px;border-right-style:solid}.mat-drawer-side.mat-drawer-end{border-left-color:var(--mat-sidenav-container-divider-color);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side{border-left-color:var(--mat-sidenav-container-divider-color);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side.mat-drawer-end{border-right-color:var(--mat-sidenav-container-divider-color);border-right-width:1px;border-right-style:solid;border-left:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0})}}return e})();var JH=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Ut,mp,mp,Ut]})}}return e})();var W_e=["mat-button",""],ij=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],rj=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"];var q_e=".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}";var X_e=["mat-mini-fab",""],Y_e='.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-fab{position:relative;display:inline-flex;position:relative;align-items:center;justify-content:center;box-sizing:border-box;width:56px;height:56px;padding:0;border:none;fill:currentColor;text-decoration:none;cursor:pointer;user-select:none;-moz-appearance:none;-webkit-appearance:none;overflow:visible;transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1),opacity 15ms linear 30ms,transform 270ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-fab .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-fab[hidden]{display:none}.mdc-fab::-moz-focus-inner{padding:0;border:0}.mdc-fab .mdc-fab__focus-ring{position:absolute}.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{border-color:CanvasText}}.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{border-color:CanvasText}}.mdc-fab:active,.mdc-fab:focus{outline:none}.mdc-fab:hover{cursor:pointer}.mdc-fab>svg{width:100%}.mdc-fab--mini{width:40px;height:40px}.mdc-fab--extended{border-radius:24px;padding-left:20px;padding-right:20px;width:auto;max-width:100%;height:48px;line-height:normal}.mdc-fab--extended .mdc-fab__ripple{border-radius:24px}.mdc-fab--extended .mdc-fab__icon{margin-left:calc(12px - 20px);margin-right:12px}[dir=rtl] .mdc-fab--extended .mdc-fab__icon,.mdc-fab--extended .mdc-fab__icon[dir=rtl]{margin-left:12px;margin-right:calc(12px - 20px)}.mdc-fab--extended .mdc-fab__label+.mdc-fab__icon{margin-left:12px;margin-right:calc(12px - 20px)}[dir=rtl] .mdc-fab--extended .mdc-fab__label+.mdc-fab__icon,.mdc-fab--extended .mdc-fab__label+.mdc-fab__icon[dir=rtl]{margin-left:calc(12px - 20px);margin-right:12px}.mdc-fab--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-fab--touch .mdc-fab__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-fab::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-fab::before{border-color:CanvasText}}.mdc-fab__label{justify-content:flex-start;text-overflow:ellipsis;white-space:nowrap;overflow-x:hidden;overflow-y:visible}.mdc-fab__icon{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}.mdc-fab .mdc-fab__icon{display:inline-flex;align-items:center;justify-content:center}.mdc-fab--exited{transform:scale(0);opacity:0;transition:opacity 15ms linear 150ms,transform 180ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-fab--exited .mdc-fab__icon{transform:scale(0);transition:transform 135ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mat-mdc-fab{background-color:var(--mdc-fab-container-color)}.mat-mdc-fab .mdc-fab__icon{width:var(--mdc-fab-icon-size);height:var(--mdc-fab-icon-size);font-size:var(--mdc-fab-icon-size)}.mat-mdc-fab:not(.mdc-fab--extended){border-radius:var(--mdc-fab-container-shape)}.mat-mdc-fab:not(.mdc-fab--extended) .mdc-fab__ripple{border-radius:var(--mdc-fab-container-shape)}.mat-mdc-mini-fab{background-color:var(--mdc-fab-small-container-color)}.mat-mdc-mini-fab .mdc-fab__icon{width:var(--mdc-fab-small-icon-size);height:var(--mdc-fab-small-icon-size);font-size:var(--mdc-fab-small-icon-size)}.mat-mdc-mini-fab:not(.mdc-fab--extended){border-radius:var(--mdc-fab-small-container-shape)}.mat-mdc-mini-fab:not(.mdc-fab--extended) .mdc-fab__ripple{border-radius:var(--mdc-fab-small-container-shape)}.mat-mdc-extended-fab{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mdc-extended-fab-container-height);border-radius:var(--mdc-extended-fab-container-shape);font-family:var(--mdc-extended-fab-label-text-font);font-size:var(--mdc-extended-fab-label-text-size);font-weight:var(--mdc-extended-fab-label-text-weight);letter-spacing:var(--mdc-extended-fab-label-text-tracking)}.mat-mdc-extended-fab .mdc-fab__ripple{border-radius:var(--mdc-extended-fab-container-shape)}.mat-mdc-fab,.mat-mdc-mini-fab{-webkit-tap-highlight-color:rgba(0,0,0,0);flex-shrink:0}.mat-mdc-fab .mat-mdc-button-ripple,.mat-mdc-fab .mat-mdc-button-persistent-ripple,.mat-mdc-fab .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab .mat-mdc-button-ripple,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-fab .mat-mdc-button-ripple,.mat-mdc-mini-fab .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-fab .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-fab .mdc-button__label,.mat-mdc-mini-fab .mdc-button__label{z-index:1}.mat-mdc-fab .mat-mdc-focus-indicator,.mat-mdc-mini-fab .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-fab:focus .mat-mdc-focus-indicator::before,.mat-mdc-mini-fab:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-fab._mat-animation-noopable,.mat-mdc-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-fab:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-mini-fab:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}.mat-mdc-fab .mat-icon,.mat-mdc-fab .material-icons,.mat-mdc-mini-fab .mat-icon,.mat-mdc-mini-fab .material-icons{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}.mat-mdc-fab .mat-mdc-focus-indicator::before,.mat-mdc-mini-fab .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-fab[disabled],.mat-mdc-fab.mat-mdc-button-disabled,.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none}.mat-mdc-fab[disabled],.mat-mdc-fab[disabled]:focus,.mat-mdc-fab.mat-mdc-button-disabled,.mat-mdc-fab.mat-mdc-button-disabled:focus,.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab[disabled]:focus,.mat-mdc-mini-fab.mat-mdc-button-disabled,.mat-mdc-mini-fab.mat-mdc-button-disabled:focus{box-shadow:none}.mat-mdc-fab.mat-mdc-button-disabled-interactive,.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-fab{color:var(--mat-fab-foreground-color, inherit);box-shadow:var(--mdc-fab-container-elevation-shadow)}.mat-mdc-fab .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-fab-touch-target-display)}.mat-mdc-fab .mat-ripple-element{background-color:var(--mat-fab-ripple-color)}.mat-mdc-fab .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-state-layer-color)}.mat-mdc-fab.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-disabled-state-layer-color)}.mat-mdc-fab:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-hover-state-layer-opacity)}.mat-mdc-fab.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-fab.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-fab.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-focus-state-layer-opacity)}.mat-mdc-fab:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-pressed-state-layer-opacity)}.mat-mdc-fab:hover{box-shadow:var(--mdc-fab-hover-container-elevation-shadow)}.mat-mdc-fab:focus{box-shadow:var(--mdc-fab-focus-container-elevation-shadow)}.mat-mdc-fab:active,.mat-mdc-fab:focus:active{box-shadow:var(--mdc-fab-pressed-container-elevation-shadow)}.mat-mdc-fab[disabled],.mat-mdc-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-fab-disabled-state-foreground-color);background-color:var(--mat-fab-disabled-state-container-color)}.mat-mdc-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-mini-fab{color:var(--mat-fab-small-foreground-color, inherit);box-shadow:var(--mdc-fab-small-container-elevation-shadow)}.mat-mdc-mini-fab .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-fab-small-touch-target-display)}.mat-mdc-mini-fab .mat-ripple-element{background-color:var(--mat-fab-small-ripple-color)}.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-small-state-layer-color)}.mat-mdc-mini-fab.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-small-disabled-state-layer-color)}.mat-mdc-mini-fab:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-hover-state-layer-opacity)}.mat-mdc-mini-fab.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-focus-state-layer-opacity)}.mat-mdc-mini-fab:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-pressed-state-layer-opacity)}.mat-mdc-mini-fab:hover{box-shadow:var(--mdc-fab-small-hover-container-elevation-shadow)}.mat-mdc-mini-fab:focus{box-shadow:var(--mdc-fab-small-focus-container-elevation-shadow)}.mat-mdc-mini-fab:active,.mat-mdc-mini-fab:focus:active{box-shadow:var(--mdc-fab-small-pressed-container-elevation-shadow)}.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-fab-small-disabled-state-foreground-color);background-color:var(--mat-fab-small-disabled-state-container-color)}.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-extended-fab{box-shadow:var(--mdc-extended-fab-container-elevation-shadow)}.mat-mdc-extended-fab:hover{box-shadow:var(--mdc-extended-fab-hover-container-elevation-shadow)}.mat-mdc-extended-fab:focus{box-shadow:var(--mdc-extended-fab-focus-container-elevation-shadow)}.mat-mdc-extended-fab:active,.mat-mdc-extended-fab:focus:active{box-shadow:var(--mdc-extended-fab-pressed-container-elevation-shadow)}.mat-mdc-extended-fab[disabled],.mat-mdc-extended-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none}.mat-mdc-extended-fab[disabled],.mat-mdc-extended-fab[disabled]:focus,.mat-mdc-extended-fab.mat-mdc-button-disabled,.mat-mdc-extended-fab.mat-mdc-button-disabled:focus{box-shadow:none}.mat-mdc-extended-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-extended-fab>.mat-icon,.mat-mdc-extended-fab>.material-icons{margin-left:calc(12px - 20px);margin-right:12px}[dir=rtl] .mat-mdc-extended-fab>.mat-icon,[dir=rtl] .mat-mdc-extended-fab>.material-icons,.mat-mdc-extended-fab>.mat-icon[dir=rtl],.mat-mdc-extended-fab>.material-icons[dir=rtl]{margin-left:12px;margin-right:calc(12px - 20px)}.mat-mdc-extended-fab .mat-mdc-button-touch-target{width:100%}.mat-mdc-extended-fab .mdc-button__label+.mat-icon,.mat-mdc-extended-fab .mdc-button__label+.material-icons{margin-left:12px;margin-right:calc(12px - 20px)}[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.material-icons,.mat-mdc-extended-fab .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-extended-fab .mdc-button__label+.material-icons[dir=rtl]{margin-left:calc(12px - 20px);margin-right:12px}',Z_e=["mat-icon-button",""],K_e=["*"];var Q_e=new Ye("MAT_BUTTON_CONFIG");var J_e=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],zM=(()=>{class e{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(i){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,i)}get disableRipple(){return this._disableRipple}set disableRipple(i){this._disableRipple=i,this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(i){this._disabled=i,this._updateRippleDisabled()}constructor(i,r,n,o){this._elementRef=i,this._platform=r,this._ngZone=n,this._animationMode=o,this._focusMonitor=Je(ic),this._rippleLoader=Je(J9),this._isFab=!1,this._disableRipple=!1,this._disabled=!1;let a=Je(Q_e,{optional:!0}),s=i.nativeElement,c=s.classList;this.disabledInteractive=a?.disabledInteractive??!1,this._rippleLoader?.configureRipple(s,{className:"mat-mdc-button-ripple"});for(let{attribute:l,mdcClasses:d}of J_e)s.hasAttribute(l)&&c.add(...d)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(i="program",r){i?this._focusMonitor.focusVia(this._elementRef.nativeElement,i,r):this._elementRef.nativeElement.focus(r)}_getAriaDisabled(){return this.ariaDisabled!=null?this.ariaDisabled:this.disabled&&this.disabledInteractive?!0:null}_getDisabledAttribute(){return this.disabledInteractive||!this.disabled?null:!0}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static{this.\u0275fac=function(r){$p()}}static{this.\u0275dir=xt({type:e,inputs:{color:"color",disableRipple:[_e.HasDecoratorInputTransform,"disableRipple","disableRipple",yt],disabled:[_e.HasDecoratorInputTransform,"disabled","disabled",yt],ariaDisabled:[_e.HasDecoratorInputTransform,"aria-disabled","ariaDisabled",yt],disabledInteractive:[_e.HasDecoratorInputTransform,"disabledInteractive","disabledInteractive",yt]},features:[Hi]})}}return e})();var on=(()=>{class e extends zM{constructor(i,r,n,o){super(i,r,n,o)}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(Pi),G(st),G(pr,8))}}static{this.\u0275cmp=Le({type:e,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(r,n){r&2&&(Zt("disabled",n._getDisabledAttribute())("aria-disabled",n._getAriaDisabled()),Kr(n.color?"mat-"+n.color:""),It("mat-mdc-button-disabled",n.disabled)("mat-mdc-button-disabled-interactive",n.disabledInteractive)("_mat-animation-noopable",n._animationMode==="NoopAnimations")("mat-unthemed",!n.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[Yt,ci],attrs:W_e,ngContentSelectors:rj,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(r,n){r&1&&(vi(ij),he(0,"span",0),gt(1),C(2,"span",1),gt(3,1),A(),gt(4,2),he(5,"span",2)(6,"span",3)),r&2&&It("mdc-button__ripple",!n._isFab)("mdc-fab__ripple",n._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px);display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{font-family:var(--mdc-text-button-label-text-font);font-size:var(--mdc-text-button-label-text-size);letter-spacing:var(--mdc-text-button-label-text-tracking);font-weight:var(--mdc-text-button-label-text-weight);text-transform:var(--mdc-text-button-label-text-transform);height:var(--mdc-text-button-container-height);border-radius:var(--mdc-text-button-container-shape);padding:0 var(--mat-text-button-horizontal-padding, 8px)}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape)}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 8px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color)}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color)}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color)}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity)}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity)}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity)}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display)}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-unelevated-button{font-family:var(--mdc-filled-button-label-text-font);font-size:var(--mdc-filled-button-label-text-size);letter-spacing:var(--mdc-filled-button-label-text-tracking);font-weight:var(--mdc-filled-button-label-text-weight);text-transform:var(--mdc-filled-button-label-text-transform);height:var(--mdc-filled-button-container-height);border-radius:var(--mdc-filled-button-container-shape);padding:0 var(--mat-filled-button-horizontal-padding, 16px)}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color)}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color)}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color)}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity)}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity)}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity)}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display)}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color);background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{font-family:var(--mdc-protected-button-label-text-font);font-size:var(--mdc-protected-button-label-text-size);letter-spacing:var(--mdc-protected-button-label-text-tracking);font-weight:var(--mdc-protected-button-label-text-weight);text-transform:var(--mdc-protected-button-label-text-transform);height:var(--mdc-protected-button-container-height);border-radius:var(--mdc-protected-button-container-shape);padding:0 var(--mat-protected-button-horizontal-padding, 16px);box-shadow:var(--mdc-protected-button-container-elevation-shadow)}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color)}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color)}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color)}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color)}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity)}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity)}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity)}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display)}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow)}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow)}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow)}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color);background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow)}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{font-family:var(--mdc-outlined-button-label-text-font);font-size:var(--mdc-outlined-button-label-text-size);letter-spacing:var(--mdc-outlined-button-label-text-tracking);font-weight:var(--mdc-outlined-button-label-text-weight);text-transform:var(--mdc-outlined-button-label-text-transform);height:var(--mdc-outlined-button-container-height);border-radius:var(--mdc-outlined-button-container-shape);padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width);padding:0 var(--mat-outlined-button-horizontal-padding, 15px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color)}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape)}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color)}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width))}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color)}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color)}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity)}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity)}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity)}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display)}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color);border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button-base{text-decoration:none}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px)*-1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}}return e})();var ebe=new Ye("mat-mdc-fab-default-options",{providedIn:"root",factory:nj});function nj(){return{color:"accent"}}var tj=nj();var qm=(()=>{class e extends zM{constructor(i,r,n,o,a){super(i,r,n,o),this._options=a,this._isFab=!0,this._options=this._options||tj,this.color=this._options.color||tj.color}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(Pi),G(st),G(pr,8),G(ebe,8))}}static{this.\u0275cmp=Le({type:e,selectors:[["button","mat-mini-fab",""]],hostVars:14,hostBindings:function(r,n){r&2&&(Zt("disabled",n._getDisabledAttribute())("aria-disabled",n._getAriaDisabled()),Kr(n.color?"mat-"+n.color:""),It("mat-mdc-button-disabled",n.disabled)("mat-mdc-button-disabled-interactive",n.disabledInteractive)("_mat-animation-noopable",n._animationMode==="NoopAnimations")("mat-unthemed",!n.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[Yt,ci],attrs:X_e,ngContentSelectors:rj,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(r,n){r&1&&(vi(ij),he(0,"span",0),gt(1),C(2,"span",1),gt(3,1),A(),gt(4,2),he(5,"span",2)(6,"span",3)),r&2&&It("mdc-button__ripple",!n._isFab)("mdc-fab__ripple",n._isFab)},styles:[Y_e],encapsulation:2,changeDetection:0})}}return e})();var T2=(()=>{class e extends zM{constructor(i,r,n,o){super(i,r,n,o),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(Pi),G(st),G(pr,8))}}static{this.\u0275cmp=Le({type:e,selectors:[["button","mat-icon-button",""]],hostVars:14,hostBindings:function(r,n){r&2&&(Zt("disabled",n._getDisabledAttribute())("aria-disabled",n._getAriaDisabled()),Kr(n.color?"mat-"+n.color:""),It("mat-mdc-button-disabled",n.disabled)("mat-mdc-button-disabled-interactive",n.disabledInteractive)("_mat-animation-noopable",n._animationMode==="NoopAnimations")("mat-unthemed",!n.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[Yt,ci],attrs:Z_e,ngContentSelectors:K_e,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(r,n){r&1&&(vi(),he(0,"span",0),gt(1),he(2,"span",1)(3,"span",2))},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{color:var(--mdc-icon-button-icon-color)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{border-radius:50%;flex-shrink:0;text-align:center;width:var(--mdc-icon-button-state-layer-size, 48px);height:var(--mdc-icon-button-state-layer-size, 48px);padding:calc(calc(var(--mdc-icon-button-state-layer-size, 48px) - var(--mdc-icon-button-icon-size, 24px)) / 2);font-size:var(--mdc-icon-button-icon-size);-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled],.mat-mdc-icon-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-icon-button-ripple-color)}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-state-layer-color)}.mat-mdc-icon-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-disabled-state-layer-color)}.mat-mdc-icon-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-hover-state-layer-opacity)}.mat-mdc-icon-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-focus-state-layer-opacity)}.mat-mdc-icon-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-pressed-state-layer-opacity)}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-icon-button-touch-target-display)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',q_e],encapsulation:2,changeDetection:0})}}return e})();var oj=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Ut,Kc,Ut]})}}return e})();var tbe=["*",[["mat-toolbar-row"]]],ibe=["*","mat-toolbar-row"],f_=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=xt({type:e,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"],standalone:!0})}}return e})(),Xm=(()=>{class e{constructor(i,r,n){this._elementRef=i,this._platform=r,this._document=n}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(Pi),G(Bt))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-toolbar"]],contentQueries:function(r,n,o){if(r&1&&Xi(o,f_,5),r&2){let a;Ve(a=ze())&&(n._toolbarRows=a)}},hostAttrs:[1,"mat-toolbar"],hostVars:6,hostBindings:function(r,n){r&2&&(Kr(n.color?"mat-"+n.color:""),It("mat-toolbar-multiple-rows",n._toolbarRows.length>0)("mat-toolbar-single-row",n._toolbarRows.length===0))},inputs:{color:"color"},exportAs:["matToolbar"],standalone:!0,features:[ci],ngContentSelectors:ibe,decls:2,vars:0,template:function(r,n){r&1&&(vi(tbe),gt(0),gt(1,1))},styles:[".mat-toolbar{background:var(--mat-toolbar-container-background-color);color:var(--mat-toolbar-container-text-color)}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font);font-size:var(--mat-toolbar-title-text-size);line-height:var(--mat-toolbar-title-text-line-height);font-weight:var(--mat-toolbar-title-text-weight);letter-spacing:var(--mat-toolbar-title-text-tracking);margin:0}.cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color:var(--mat-toolbar-container-text-color);--mdc-outlined-button-label-text-color:var(--mat-toolbar-container-text-color)}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height)}}"],encapsulation:2,changeDetection:0})}}return e})();var aj=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Ut,Ut]})}}return e})();var rbe=["*",[["","drawerLeft",""]],[["","drawerRight",""]],[["","centerContent",""]]],nbe=["*","[drawerLeft]","[drawerRight]","[centerContent]"];function obe(e,t){if(e&1){let i=Ze();C(0,"button",10),Y("click",function(){q(i),ae();let n=Ft(12);return X(n.toggle())}),C(1,"mat-icon"),W(2,"menu"),A()()}}function abe(e,t){if(e&1){let i=Ze();C(0,"button",10),Y("click",function(){q(i),ae();let n=Ft(16);return X(n.toggle())}),C(1,"mat-icon"),W(2,"menu"),A()()}}var zo=(()=>{class e{leftDrawer=!0;rightDrawer=!0;constructor(){}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Le({type:e,selectors:[["app-tutorial-template"]],inputs:{leftDrawer:"leftDrawer",rightDrawer:"rightDrawer"},ngContentSelectors:nbe,decls:21,vars:4,consts:[["drawerLeft",""],["drawerRight",""],["color","primary"],["mat-icon-button","","class","example-icon",3,"click",4,"ngIf"],["routerLink","/home",1,"show-smallscreen"],["mat-icon-button","",1,"example-icon"],["mode","side",3,"opened"],[1,"vertical-flex","drawer"],["mode","side","position","end",3,"opened"],[1,"horizontal-flex","drawer-container"],["mat-icon-button","",1,"example-icon",3,"click"]],template:function(r,n){r&1&&(vi(rbe),C(0,"mat-toolbar",2)(1,"mat-toolbar-row"),Be(2,obe,3,0,"button",3),C(3,"a",4)(4,"button",5)(5,"mat-icon"),W(6,"home"),A()()(),C(7,"span"),gt(8),A(),Be(9,abe,3,0,"button",3),A()(),C(10,"mat-drawer-container")(11,"mat-drawer",6,0)(13,"div",7),gt(14,1),A()(),C(15,"mat-drawer",8,1),he(17,"div",7),gt(18,2),A(),C(19,"div",9),gt(20,3),A()()),r&2&&(O(2),z("ngIf",n.leftDrawer),O(7),z("ngIf",n.rightDrawer),O(2),z("opened",n.leftDrawer),O(4),z("opened",n.rightDrawer))},dependencies:[Yn,h_,p_,T2,Xm,f_,Bo,fu],styles:["mat-drawer[_ngcontent-%COMP%]{max-width:50vw}mat-toolbar-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:100%;text-align:center}.loading[_ngcontent-%COMP%]{position:fixed;z-index:100;top:50%;left:50%;transform:translate(-50%,-50%);background-color:#000c;width:100vw;height:100vh;justify-content:center;align-items:center;display:flex}.drawer[_ngcontent-%COMP%]{padding:1em .25em;align-items:center}.drawer-container[_ngcontent-%COMP%]{gap:1em;justify-content:center;align-items:center;margin-top:1em}[_nghost-%COMP%]     h2{text-align:center;margin:1ch}"]})}return e})();var sbe=["determinateSpinner"];function lbe(e,t){if(e&1&&(wa(),C(0,"svg",11),he(1,"circle",12),A()),e&2){let i=ae();Zt("viewBox",i._viewBox()),O(),li("stroke-dasharray",i._strokeCircumference(),"px")("stroke-dashoffset",i._strokeCircumference()/2,"px")("stroke-width",i._circleStrokeWidth(),"%"),Zt("r",i._circleRadius())}}var cbe=new Ye("mat-progress-spinner-default-options",{providedIn:"root",factory:dbe});function dbe(){return{diameter:sj}}var sj=100,ube=10,lj=(()=>{class e{get color(){return this._color||this._defaultColor}set color(i){this._color=i}constructor(i,r,n){this._elementRef=i,this._defaultColor="primary",this._value=0,this._diameter=sj,this._noopAnimations=r==="NoopAnimations"&&!!n&&!n._forceAnimations,this.mode=i.nativeElement.nodeName.toLowerCase()==="mat-spinner"?"indeterminate":"determinate",n&&(n.color&&(this.color=this._defaultColor=n.color),n.diameter&&(this.diameter=n.diameter),n.strokeWidth&&(this.strokeWidth=n.strokeWidth))}get value(){return this.mode==="determinate"?this._value:0}set value(i){this._value=Math.max(0,Math.min(100,i||0))}get diameter(){return this._diameter}set diameter(i){this._diameter=i||0}get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(i){this._strokeWidth=i||0}_circleRadius(){return(this.diameter-ube)/2}_viewBox(){let i=this._circleRadius()*2+this.strokeWidth;return`0 0 ${i} ${i}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return this.mode==="determinate"?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(pr,8),G(cbe))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(r,n){if(r&1&&ht(sbe,5),r&2){let o;Ve(o=ze())&&(n._determinateCircle=o.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:18,hostBindings:function(r,n){r&2&&(Zt("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow",n.mode==="determinate"?n.value:null)("mode",n.mode),Kr("mat-"+n.color),li("width",n.diameter,"px")("height",n.diameter,"px")("--mdc-circular-progress-size",n.diameter+"px")("--mdc-circular-progress-active-indicator-width",n.diameter+"px"),It("_mat-animation-noopable",n._noopAnimations)("mdc-circular-progress--indeterminate",n.mode==="indeterminate"))},inputs:{color:"color",mode:"mode",value:[_e.HasDecoratorInputTransform,"value","value",sn],diameter:[_e.HasDecoratorInputTransform,"diameter","diameter",sn],strokeWidth:[_e.HasDecoratorInputTransform,"strokeWidth","strokeWidth",sn]},exportAs:["matProgressSpinner"],standalone:!0,features:[Hi,ci],decls:14,vars:11,consts:[["circle",""],["determinateSpinner",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(r,n){if(r&1&&(Be(0,lbe,2,8,"ng-template",null,0,Ku),C(2,"div",2,1),wa(),C(4,"svg",3),he(5,"circle",4),A()(),Og(),C(6,"div",5)(7,"div",6)(8,"div",7),Yp(9,8),A(),C(10,"div",9),Yp(11,8),A(),C(12,"div",10),Yp(13,8),A()()()),r&2){let o=Ft(1);O(4),Zt("viewBox",n._viewBox()),O(),li("stroke-dasharray",n._strokeCircumference(),"px")("stroke-dashoffset",n._strokeDashOffset(),"px")("stroke-width",n._circleStrokeWidth(),"%"),Zt("r",n._circleRadius()),O(4),z("ngTemplateOutlet",o),O(2),z("ngTemplateOutlet",o),O(2),z("ngTemplateOutlet",o)}},dependencies:[th],styles:["@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-color-1-fade-in-out{from{opacity:.99}25%{opacity:.99}26%{opacity:0}89%{opacity:0}90%{opacity:.99}to{opacity:.99}}@keyframes mdc-circular-progress-color-2-fade-in-out{from{opacity:0}15%{opacity:0}25%{opacity:.99}50%{opacity:.99}51%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-3-fade-in-out{from{opacity:0}40%{opacity:0}50%{opacity:.99}75%{opacity:.99}76%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-4-fade-in-out{from{opacity:0}65%{opacity:0}75%{opacity:.99}90%{opacity:.99}to{opacity:0}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}.mdc-circular-progress{display:inline-flex;position:relative;direction:ltr;line-height:0;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-1{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-1-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-2{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-2-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-3{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-3-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-4{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-4-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--closed{opacity:0}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color)}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width)}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-1 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-2 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-3 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-4 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mat-mdc-progress-spinner .mdc-circular-progress{width:var(--mdc-circular-progress-size) !important;height:var(--mdc-circular-progress-size) !important}.mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}"],encapsulation:2,changeDetection:0})}}return e})();var cj=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[To,Ut]})}}return e})();var dj=(()=>{class e{uiservice;loadingEvent=new We;showPresetEvent=new We;constructor(i){this.uiservice=i}ngOnInit(){}loading(i){i.target.files&&i.target.files[0]&&this.loadingEvent.emit(i.target.files[0])}toggleShowImagePreset(){this.uiservice.toggleImagePreset()}static \u0275fac=function(r){return new(r||e)(G(gu))};static \u0275cmp=Le({type:e,selectors:[["app-loading-buttons"]],outputs:{loadingEvent:"loadingEvent",showPresetEvent:"showPresetEvent"},decls:6,vars:0,consts:[["fileInput",""],["type","button","mat-raised-button","","color","primary",3,"click"],["hidden","","type","file","accept","images/*",3,"change"]],template:function(r,n){if(r&1){let o=Ze();C(0,"button",1),Y("click",function(){return q(o),X(n.toggleShowImagePreset())}),W(1,"Show preset"),A(),C(2,"button",1),Y("click",function(){q(o);let s=Ft(5);return X(s.click())}),W(3,` Load image
`),A(),C(4,"input",2,0),Y("change",function(s){return q(o),X(n.loading(s))}),A()}},dependencies:[on]})}return e})();var uj=[{name:"Fourier Transform",content:[{name:"House",url:"assets/image_presets/House.jpeg"},{name:"Moon",url:"assets/image_presets/Moon.jpeg"},{name:"CT Scan",url:"assets/image_presets/CTandstripes.jpeg"},{name:"X Ray",url:"assets/image_presets/XrayBar.jpeg"}]},{name:"Morphological Operations",content:[{name:"Hello",url:"assets/image_presets/Hello.jpeg"},{name:"Tree",url:"assets/image_presets/arbre_binaire.jpeg"},{name:"Little Guy",url:"assets/image_presets/bonhomme_morpho.jpeg"}]},{name:"Miscellaneous",content:[{name:"Phantom",url:"assets/image_presets/phantom.png"}]},{name:"Color images",content:[{name:"Peppers",url:"assets/image_presets/poivron.jpeg"},{name:"Butterfly",url:"assets/image_presets/papillon.jpg"},{name:"Homomorphic Flower",url:"assets/image_presets/hibiscus_homomorphic.jpg"}]}];function mbe(e,t){if(e&1){let i=Ze();C(0,"div",3)(1,"button",4),Y("click",function(){let n=q(i).$implicit,o=ae(2);return X(o.loadSelectedImage(n.url))}),W(2),A(),he(3,"div",5)(4,"img",6),A()}if(e&2){let i=t.$implicit;O(2),Qr(" ",i.name," "),O(2),z("src",i.url,S3)}}function gbe(e,t){if(e&1&&(C(0,"div")(1,"p"),W(2),A(),Be(3,mbe,5,2,"div",2),A()),e&2){let i=t.$implicit;O(2),Pr(i.name),O(),z("ngForOf",i.content)}}var hj=(()=>{class e{uiservice;presetEvent=new We;images_presets=uj;constructor(i){this.uiservice=i}ngOnInit(){}loadSelectedImage(i){this.uiservice.toggleImagePreset(),this.presetEvent.emit(i)}static \u0275fac=function(r){return new(r||e)(G(gu))};static \u0275cmp=Le({type:e,selectors:[["app-image-presets"]],outputs:{presetEvent:"presetEvent"},decls:5,vars:1,consts:[["mat-button","","color","primary",3,"click"],[4,"ngFor","ngForOf"],["class","horizontal-align",4,"ngFor","ngForOf"],[1,"horizontal-align"],["mat-button","",3,"click"],[1,"filler"],["alt","image.name","width","32px","height","32px",1,"rounded",3,"src"]],template:function(r,n){r&1&&(C(0,"button",0),Y("click",function(){return n.uiservice.toggleImagePreset()}),W(1,`
Close `),C(2,"mat-icon"),W(3,"close"),A()(),Be(4,gbe,4,2,"div",1)),r&2&&(O(4),z("ngForOf",n.images_presets))},dependencies:[Xn,on,Bo],styles:[".horizontal-align[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row}.horizontal-align[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:first-child{align-self:flex-start}.filler[_ngcontent-%COMP%]{flex-grow:1}.horizontal-align[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:last-child{align-self:flex-end}.rounded[_ngcontent-%COMP%]{border-radius:50%}"]})}return e})();var _be=["inputCanvas"],bbe=["*",[["","drawerRight",""]],[["","centerContent",""]],[["","drawerLeft",""]]],ybe=["*","[drawerRight]","[centerContent]","[drawerLeft]"];function xbe(e,t){e&1&&(C(0,"div",12),he(1,"mat-spinner",13),A()),e&2&&(O(),z("diameter",300))}function wbe(e,t){if(e&1){let i=Ze();C(0,"button",14),Y("click",function(){q(i),ae();let n=Ft(13);return X(n.toggle())}),C(1,"mat-icon"),W(2,"menu"),A()()}}function Ebe(e,t){if(e&1){let i=Ze();C(0,"button",14),Y("click",function(){q(i),ae();let n=Ft(18);return X(n.toggle())}),C(1,"mat-icon"),W(2,"menu"),A()()}}function Cbe(e,t){if(e&1){let i=Ze();Ot(0),C(1,"app-loading-buttons",15),Y("loadingEvent",function(n){q(i);let o=ae();return X(o.loadSelectedFile(n))}),A(),he(2,"hr"),C(3,"button",16),Y("click",function(){q(i);let n=ae();return X(n.drawCanvasContained.clearCanvas())}),W(4," Clear "),A(),he(5,"hr"),gt(6,3),Rt()}}function Sbe(e,t){if(e&1){let i=Ze();Ot(0),C(1,"app-image-presets",17),Y("presetEvent",function(n){q(i);let o=ae();return X(o.loadSelectedFileFromPath(n))}),A(),Rt()}}var Va=(()=>{class e extends zo{ngxOpenCv;uiservice;cdr;cvState;drawCanvasContained;profileOptions;sideMenuContext=!0;constructor(i,r,n){super(),this.ngxOpenCv=i,this.uiservice=r,this.cdr=n}ngAfterViewInit(){this.ngxOpenCv.cvState.subscribe(i=>{console.log("OpenCV.js is ready",i),this.cvState=i.toString()}),this.cdr.detectChanges()}loadSelectedFileFromPath(i){let r=new Image;r.onerror=n=>{console.log("Loading failed")},r.src=i,r.onload=()=>{this.drawCanvasContained&&this.drawCanvasContained.drawImage(r)}}loadSelectedFile(i){var r=new FileReader;r.onload=n=>{let o=new Image;o.onerror=a=>{console.log("Loading failed")},o.src=n.target.result,o.onload=()=>{this.drawCanvasContained.drawImage(o)}},r.readAsDataURL(i)}toggleImagePresets(){this.sideMenuContext=!this.sideMenuContext}static \u0275fac=function(r){return new(r||e)(G(i_),G(gu),G(ei))};static \u0275cmp=Le({type:e,selectors:[["app-tutorial-template-images"]],contentQueries:function(r,n,o){if(r&1&&Xi(o,_be,5),r&2){let a;Ve(a=ze())&&(n.drawCanvasContained=a.first)}},features:[Yt],ngContentSelectors:ybe,decls:23,vars:7,consts:[["drawerLeft",""],["drawerRight",""],["class","loading",4,"ngIf"],["color","primary"],["mat-icon-button","","class","example-icon",3,"click",4,"ngIf"],["routerLink","/home",1,"show-smallscreen"],["mat-icon-button","",1,"example-icon"],["mode","side",3,"opened"],[1,"vertical-flex","drawer"],[4,"ngIf"],["mode","side","position","end",3,"opened"],[1,"horizontal-flex","drawer-container"],[1,"loading"],["color","primary",3,"diameter"],["mat-icon-button","",1,"example-icon",3,"click"],[3,"loadingEvent"],["mat-raised-button","","color","warn",1,"fillWidth",3,"click"],[3,"presetEvent"]],template:function(r,n){r&1&&(vi(bbe),Be(0,xbe,2,1,"div",2),C(1,"mat-toolbar",3)(2,"mat-toolbar-row"),Be(3,wbe,3,0,"button",4),C(4,"a",5)(5,"button",6)(6,"mat-icon"),W(7,"home"),A()()(),C(8,"span"),gt(9),A(),Be(10,Ebe,3,0,"button",4),A()(),C(11,"mat-drawer-container")(12,"mat-drawer",7,0)(14,"div",8),Be(15,Cbe,7,0,"ng-container",9)(16,Sbe,2,0,"ng-container",9),A()(),C(17,"mat-drawer",10,1),he(19,"div",8),gt(20,1),A(),C(21,"div",11),gt(22,2),A()()),r&2&&(z("ngIf",n.cvState=="loading"),O(3),z("ngIf",n.leftDrawer),O(7),z("ngIf",n.rightDrawer),O(2),z("opened",n.leftDrawer),O(3),z("ngIf",!n.uiservice.showImagePreset),O(),z("ngIf",n.uiservice.showImagePreset),O(),z("opened",n.rightDrawer))},dependencies:[lj,Yn,h_,p_,on,T2,Xm,f_,Bo,fu,dj,hj],styles:["mat-drawer[_ngcontent-%COMP%]{max-width:50vw}mat-toolbar-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:100%;text-align:center}.loading[_ngcontent-%COMP%]{position:fixed;z-index:100;top:50%;left:50%;transform:translate(-50%,-50%);background-color:#000c;width:100vw;height:100vh;justify-content:center;align-items:center;display:flex}.drawer[_ngcontent-%COMP%]{padding:1em .25em;align-items:center}.drawer-container[_ngcontent-%COMP%]{gap:1em;justify-content:center;align-items:center;margin-top:1em}[_nghost-%COMP%]     h2{text-align:center;margin:1ch}"]})}return e})();var Tbe=["canvas1"],Abe=["canvas2"],Dbe=["canvas3"],pj=(()=>{class e extends Fo{canvas1;canvas2;canvas3;color="#ffffff";colorCtr=new op(null);colorspace="RGB";ngAfterViewInit(){super.ngAfterViewInit,this.updateColorSpace()}updateInput(){let i=cv.imread(this.canvas1.getCanvas(),cv.IMREAD_GRAYSCALE),r=cv.imread(this.canvas2.getCanvas(),cv.IMREAD_GRAYSCALE),n=cv.imread(this.canvas3.getCanvas(),cv.IMREAD_GRAYSCALE);cv.cvtColor(i,i,cv.COLOR_RGB2GRAY),cv.cvtColor(r,r,cv.COLOR_RGB2GRAY),cv.cvtColor(n,n,cv.COLOR_RGB2GRAY);let o=new cv.MatVector,a=new cv.Mat;switch(this.colorspace){case"RGB":{o.push_back(i),o.push_back(r),o.push_back(n),cv.merge(o,a);break}case"YCrCb":{o.push_back(i),o.push_back(r),o.push_back(n),cv.merge(o,a),cv.cvtColor(a,a,cv.COLOR_YCrCb2RGB);break}case"LAB":{o.push_back(i),o.push_back(r),o.push_back(n),cv.merge(o,a),cv.cvtColor(a,a,cv.COLOR_Lab2RGB);break}case"HSV":{i.convertTo(i,cv.CV_32FC1),cv.convertScaleAbs(i,i,179/255,0),o.push_back(i),o.push_back(r),o.push_back(n),cv.merge(o,a),cv.cvtColor(a,a,cv.COLOR_HSV2RGB);break}}cv.imshow(this.drawCanvas.getCanvas(),a),i.delete(),r.delete(),n.delete(),a.delete(),o.delete(),this.updateColorSpace()}updateColorSpace(){let i=cv.imread(this.drawCanvas.getCanvas()),r=new cv.MatVector;switch(this.colorspace){case"RGB":{this.canvas1.title="R",this.canvas2.title="G",this.canvas3.title="B";break}case"LAB":{this.canvas1.title="L",this.canvas2.title="A",this.canvas3.title="B",cv.cvtColor(i,i,cv.COLOR_RGB2Lab);break}case"HSV":{this.canvas1.title="H",this.canvas2.title="S",this.canvas3.title="V",cv.cvtColor(i,i,cv.COLOR_RGB2HSV);break}case"YCrCb":{this.canvas1.title="Y",this.canvas2.title="Cr",this.canvas3.title="Cb",cv.cvtColor(i,i,cv.COLOR_RGB2YCrCb);break}}cv.split(i,r),this.colorspace=="HSV"&&cv.convertScaleAbs(r.get(0),r.get(0),1.42),cv.imshow(this.canvas1.getCanvas(),r.get(0)),cv.imshow(this.canvas2.getCanvas(),r.get(1)),cv.imshow(this.canvas3.getCanvas(),r.get(2)),i.delete(),r.delete()}static \u0275fac=(()=>{let i;return function(n){return(i||(i=Ar(e)))(n||e)}})();static \u0275cmp=Le({type:e,selectors:[["app-color-spaces"]],viewQuery:function(r,n){if(r&1&&(ht(Tbe,5),ht(Abe,5),ht(Dbe,5)),r&2){let o;Ve(o=ze())&&(n.canvas1=o.first),Ve(o=ze())&&(n.canvas2=o.first),Ve(o=ze())&&(n.canvas3=o.first)}},features:[Yt],decls:34,vars:26,consts:[["brushSizeSlider",""],["inputCanvas",""],["canvas1",""],["canvas2",""],["canvas3",""],[3,"rightDrawer"],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["title","Brush Size"],[3,"colorPickerChange","colorPicker","cpDialogDisplay","cpToggle","cpFallbackColor","cpDisableInput"],[1,"fillWidth"],[3,"ngModelChange","colorPickerChange","ngModel"],["value","RGB"],["value","HSV"],["value","LAB"],["value","YCrCb"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["title","Canvas",1,"main-canvas",3,"drawingEnded","width","drawColor","drawable","brushRadius","BWOption"],[1,"horizontal-flex","canvas-grid"],["title","Red",1,"grid-item",3,"drawingEnded","width","drawColor","drawable","brushRadius"],["title","Green",1,"grid-item",3,"drawingEnded","width","drawColor","drawable","brushRadius"],["title","Blue",1,"grid-item",3,"drawingEnded","width","drawColor","drawable","brushRadius"]],template:function(r,n){if(r&1){let o=Ze();C(0,"app-tutorial-template-images",5),W(1," Colorspaces "),Ot(2,6),he(3,"app-labelled-sliders",7,0)(5,"hr"),C(6,"h2"),W(7,"Brush color"),A(),C(8,"input",8),qt("colorPickerChange",function(s){return q(o),jt(n.color,s)||(n.color=s),X(s)}),A(),he(9,"hr"),C(10,"h2"),W(11,"Colorspace"),A(),C(12,"mat-form-field",9)(13,"mat-label"),W(14,"Choose a colorspace"),A(),C(15,"mat-select",10),qt("ngModelChange",function(s){return q(o),jt(n.colorspace,s)||(n.colorspace=s),X(s)}),Y("colorPickerChange",function(){return q(o),X(n.updateColorSpace())}),C(16,"mat-option",11),W(17,"RGB"),A(),C(18,"mat-option",12),W(19,"HSV"),A(),C(20,"mat-option",13),W(21,"LAB"),A(),C(22,"mat-option",14),W(23,"YCrCb"),A()()(),Rt(),Ot(24,15),C(25,"app-draw-canvas",16,1),Y("drawingEnded",function(){return q(o),X(n.updateColorSpace())}),A(),C(27,"div",17)(28,"app-draw-canvas",18,2),Y("drawingEnded",function(){return q(o),X(n.updateInput())}),A(),C(30,"app-draw-canvas",19,3),Y("drawingEnded",function(){return q(o),X(n.updateInput())}),A(),C(32,"app-draw-canvas",20,4),Y("drawingEnded",function(){return q(o),X(n.updateInput())}),A()(),Rt(),A()}if(r&2){let o=Ft(4);z("rightDrawer",!1),O(8),li("background",n.color),Wt("colorPicker",n.color),z("cpDialogDisplay","inline")("cpToggle",!0)("cpFallbackColor","#ffffff")("cpDisableInput",!0),O(7),Wt("ngModel",n.colorspace),O(10),z("width",256)("drawColor",n.color)("drawable",!0)("brushRadius",o.value)("BWOption",!0),O(3),z("width",256)("drawColor",n.color)("drawable",!0)("brushRadius",o.value),O(2),z("width",256)("drawColor",n.color)("drawable",!0)("brushRadius",o.value),O(2),z("width",256)("drawColor",n.color)("drawable",!0)("brushRadius",o.value)}},dependencies:[Hm,rc,b2,Um,so,Un,AH,Vo,Mr,Va],styles:[".options-bar[_ngcontent-%COMP%]{gap:2em;align-items:center;padding:0 2em}.options-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:80%}.brush-slider[_ngcontent-%COMP%]{font-size:small}.main-canvas[_ngcontent-%COMP%]{border:solid 1px white;margin:1em;border-radius:.25em;overflow:hidden;aspect-ratio:1;min-width:256px;width:33%;box-shadow:#00000040 0 54px 55px,#0000001f 0 -12px 30px,#0000001f 0 4px 6px,#0000002b 0 12px 13px,#00000017 0 -3px 5px}.grid-item[_ngcontent-%COMP%]{margin:auto;min-width:256px;box-shadow:#26394d 0 20px 30px -10px}.canvas-grid[_ngcontent-%COMP%]{gap:.5em;flex-direction:row;flex-wrap:wrap}"]})}return e})();var Ibe=["button"],Mbe=["*"];function kbe(e,t){if(e&1&&he(0,"mat-pseudo-checkbox",3),e&2){let i=ae();z("disabled",i.disabled)}}function Pbe(e,t){if(e&1&&he(0,"mat-pseudo-checkbox",3),e&2){let i=ae();z("disabled",i.disabled)}}var fj=new Ye("MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS",{providedIn:"root",factory:Nbe});function Nbe(){return{hideSingleSelectionIndicator:!1,hideMultipleSelectionIndicator:!1}}var mj=new Ye("MatButtonToggleGroup"),Obe={provide:Ql,useExisting:Yo(()=>hs),multi:!0},gj=0,A2=class{constructor(t,i){this.source=t,this.value=i}},hs=(()=>{class e{get name(){return this._name}set name(i){this._name=i,this._markButtonsForCheck()}get value(){let i=this._selectionModel?this._selectionModel.selected:[];return this.multiple?i.map(r=>r.value):i[0]?i[0].value:void 0}set value(i){this._setSelectionByValue(i),this.valueChange.emit(this.value)}get selected(){let i=this._selectionModel?this._selectionModel.selected:[];return this.multiple?i:i[0]||null}get multiple(){return this._multiple}set multiple(i){this._multiple=i,this._markButtonsForCheck()}get disabled(){return this._disabled}set disabled(i){this._disabled=i,this._markButtonsForCheck()}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(i){this._hideSingleSelectionIndicator=i,this._markButtonsForCheck()}get hideMultipleSelectionIndicator(){return this._hideMultipleSelectionIndicator}set hideMultipleSelectionIndicator(i){this._hideMultipleSelectionIndicator=i,this._markButtonsForCheck()}constructor(i,r){this._changeDetector=i,this._multiple=!1,this._disabled=!1,this._controlValueAccessorChangeFn=()=>{},this._onTouched=()=>{},this._name=`mat-button-toggle-group-${gj++}`,this.valueChange=new We,this.change=new We,this.appearance=r&&r.appearance?r.appearance:"standard",this.hideSingleSelectionIndicator=r?.hideSingleSelectionIndicator??!1,this.hideMultipleSelectionIndicator=r?.hideMultipleSelectionIndicator??!1}ngOnInit(){this._selectionModel=new jm(this.multiple,void 0,!1)}ngAfterContentInit(){this._selectionModel.select(...this._buttonToggles.filter(i=>i.checked))}writeValue(i){this.value=i,this._changeDetector.markForCheck()}registerOnChange(i){this._controlValueAccessorChangeFn=i}registerOnTouched(i){this._onTouched=i}setDisabledState(i){this.disabled=i}_emitChangeEvent(i){let r=new A2(i,this.value);this._rawValue=r.value,this._controlValueAccessorChangeFn(r.value),this.change.emit(r)}_syncButtonToggle(i,r,n=!1,o=!1){!this.multiple&&this.selected&&!i.checked&&(this.selected.checked=!1),this._selectionModel?r?this._selectionModel.select(i):this._selectionModel.deselect(i):o=!0,o?Promise.resolve().then(()=>this._updateModelValue(i,n)):this._updateModelValue(i,n)}_isSelected(i){return this._selectionModel&&this._selectionModel.isSelected(i)}_isPrechecked(i){return typeof this._rawValue>"u"?!1:this.multiple&&Array.isArray(this._rawValue)?this._rawValue.some(r=>i.value!=null&&r===i.value):i.value===this._rawValue}_setSelectionByValue(i){this._rawValue=i,this._buttonToggles&&(this.multiple&&i?(Array.isArray(i),this._clearSelection(),i.forEach(r=>this._selectValue(r))):(this._clearSelection(),this._selectValue(i)))}_clearSelection(){this._selectionModel.clear(),this._buttonToggles.forEach(i=>i.checked=!1)}_selectValue(i){let r=this._buttonToggles.find(n=>n.value!=null&&n.value===i);r&&(r.checked=!0,this._selectionModel.select(r))}_updateModelValue(i,r){r&&this._emitChangeEvent(i),this.valueChange.emit(this.value)}_markButtonsForCheck(){this._buttonToggles?.forEach(i=>i._markForCheck())}static{this.\u0275fac=function(r){return new(r||e)(G(ei),G(fj,8))}}static{this.\u0275dir=xt({type:e,selectors:[["mat-button-toggle-group"]],contentQueries:function(r,n,o){if(r&1&&Xi(o,za,5),r&2){let a;Ve(a=ze())&&(n._buttonToggles=a)}},hostAttrs:["role","group",1,"mat-button-toggle-group"],hostVars:5,hostBindings:function(r,n){r&2&&(Zt("aria-disabled",n.disabled),It("mat-button-toggle-vertical",n.vertical)("mat-button-toggle-group-appearance-standard",n.appearance==="standard"))},inputs:{appearance:"appearance",name:"name",vertical:[_e.HasDecoratorInputTransform,"vertical","vertical",yt],value:"value",multiple:[_e.HasDecoratorInputTransform,"multiple","multiple",yt],disabled:[_e.HasDecoratorInputTransform,"disabled","disabled",yt],hideSingleSelectionIndicator:[_e.HasDecoratorInputTransform,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",yt],hideMultipleSelectionIndicator:[_e.HasDecoratorInputTransform,"hideMultipleSelectionIndicator","hideMultipleSelectionIndicator",yt]},outputs:{valueChange:"valueChange",change:"change"},exportAs:["matButtonToggleGroup"],standalone:!0,features:[Li([Obe,{provide:mj,useExisting:e}]),Hi]})}}return e})(),za=(()=>{class e{get buttonId(){return`${this.id}-button`}get appearance(){return this.buttonToggleGroup?this.buttonToggleGroup.appearance:this._appearance}set appearance(i){this._appearance=i}get checked(){return this.buttonToggleGroup?this.buttonToggleGroup._isSelected(this):this._checked}set checked(i){i!==this._checked&&(this._checked=i,this.buttonToggleGroup&&this.buttonToggleGroup._syncButtonToggle(this,this._checked),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled||this.buttonToggleGroup&&this.buttonToggleGroup.disabled}set disabled(i){this._disabled=i}constructor(i,r,n,o,a,s){this._changeDetectorRef=r,this._elementRef=n,this._focusMonitor=o,this._checked=!1,this.ariaLabelledby=null,this._disabled=!1,this.change=new We;let c=Number(a);this.tabIndex=c||c===0?c:null,this.buttonToggleGroup=i,this.appearance=s&&s.appearance?s.appearance:"standard"}ngOnInit(){let i=this.buttonToggleGroup;this.id=this.id||`mat-button-toggle-${gj++}`,i&&(i._isPrechecked(this)?this.checked=!0:i._isSelected(this)!==this._checked&&i._syncButtonToggle(this,this._checked))}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){let i=this.buttonToggleGroup;this._focusMonitor.stopMonitoring(this._elementRef),i&&i._isSelected(this)&&i._syncButtonToggle(this,!1,!1,!0)}focus(i){this._buttonElement.nativeElement.focus(i)}_onButtonClick(){let i=this._isSingleSelector()?!0:!this._checked;i!==this._checked&&(this._checked=i,this.buttonToggleGroup&&(this.buttonToggleGroup._syncButtonToggle(this,this._checked,!0),this.buttonToggleGroup._onTouched())),this.change.emit(new A2(this,this.value))}_markForCheck(){this._changeDetectorRef.markForCheck()}_getButtonName(){return this._isSingleSelector()?this.buttonToggleGroup.name:this.name||null}_isSingleSelector(){return this.buttonToggleGroup&&!this.buttonToggleGroup.multiple}static{this.\u0275fac=function(r){return new(r||e)(G(mj,8),G(ei),G(vt),G(ic),Zo("tabindex"),G(fj,8))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-button-toggle"]],viewQuery:function(r,n){if(r&1&&ht(Ibe,5),r&2){let o;Ve(o=ze())&&(n._buttonElement=o.first)}},hostAttrs:["role","presentation",1,"mat-button-toggle"],hostVars:12,hostBindings:function(r,n){r&1&&Y("focus",function(){return n.focus()}),r&2&&(Zt("aria-label",null)("aria-labelledby",null)("id",n.id)("name",null),It("mat-button-toggle-standalone",!n.buttonToggleGroup)("mat-button-toggle-checked",n.checked)("mat-button-toggle-disabled",n.disabled)("mat-button-toggle-appearance-standard",n.appearance==="standard"))},inputs:{ariaLabel:[_e.None,"aria-label","ariaLabel"],ariaLabelledby:[_e.None,"aria-labelledby","ariaLabelledby"],id:"id",name:"name",value:"value",tabIndex:"tabIndex",disableRipple:[_e.HasDecoratorInputTransform,"disableRipple","disableRipple",yt],appearance:"appearance",checked:[_e.HasDecoratorInputTransform,"checked","checked",yt],disabled:[_e.HasDecoratorInputTransform,"disabled","disabled",yt]},outputs:{change:"change"},exportAs:["matButtonToggle"],standalone:!0,features:[Hi,ci],ngContentSelectors:Mbe,decls:8,vars:11,consts:[["button",""],["type","button",1,"mat-button-toggle-button","mat-focus-indicator",3,"click","id","disabled"],[1,"mat-button-toggle-label-content"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"mat-button-toggle-focus-overlay"],["matRipple","",1,"mat-button-toggle-ripple",3,"matRippleTrigger","matRippleDisabled"]],template:function(r,n){if(r&1){let o=Ze();vi(),C(0,"button",1,0),Y("click",function(){return q(o),X(n._onButtonClick())}),C(2,"span",2),Be(3,kbe,1,1,"mat-pseudo-checkbox",3)(4,Pbe,1,1,"mat-pseudo-checkbox",3),gt(5),A()(),he(6,"span",4)(7,"span",5)}if(r&2){let o=Ft(1);z("id",n.buttonId)("disabled",n.disabled||null),Zt("tabindex",n.disabled?-1:n.tabIndex)("aria-pressed",n.checked)("name",n._getButtonName())("aria-label",n.ariaLabel)("aria-labelledby",n.ariaLabelledby),O(3),Ni(3,n.buttonToggleGroup&&n.checked&&!n.buttonToggleGroup.multiple&&!n.buttonToggleGroup.hideSingleSelectionIndicator?3:-1),O(),Ni(4,n.buttonToggleGroup&&n.checked&&n.buttonToggleGroup.multiple&&!n.buttonToggleGroup.hideMultipleSelectionIndicator?4:-1),O(3),z("matRippleTrigger",o)("matRippleDisabled",n.disableRipple||n.disabled)}},dependencies:[Ys,vM],styles:[".mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;-webkit-tap-highlight-color:rgba(0,0,0,0);transform:translateZ(0);border-radius:var(--mat-legacy-button-toggle-shape)}.mat-button-toggle-standalone:not([class*=mat-elevation-z]),.mat-button-toggle-group:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.cdk-high-contrast-active .mat-button-toggle-standalone,.cdk-high-contrast-active .mat-button-toggle-group{outline:solid 1px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:var(--mat-standard-button-toggle-shape);border:solid 1px var(--mat-standard-button-toggle-divider-color)}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard .mat-pseudo-checkbox,.mat-button-toggle-group-appearance-standard .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-selected-checkmark-color: var( --mat-standard-button-toggle-selected-state-text-color )}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard:not([class*=mat-elevation-z]),.mat-button-toggle-group-appearance-standard:not([class*=mat-elevation-z]){box-shadow:none}.cdk-high-contrast-active .mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.cdk-high-contrast-active .mat-button-toggle-group-appearance-standard{outline:0}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative;color:var(--mat-legacy-button-toggle-text-color);font-family:var(--mat-legacy-button-toggle-label-text-font);font-size:var(--mat-legacy-button-toggle-label-text-size);line-height:var(--mat-legacy-button-toggle-label-text-line-height);font-weight:var(--mat-legacy-button-toggle-label-text-weight);letter-spacing:var(--mat-legacy-button-toggle-label-text-tracking);--mat-minimal-pseudo-checkbox-selected-checkmark-color: var( --mat-legacy-button-toggle-selected-state-text-color )}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:var(--mat-legacy-button-toggle-focus-state-layer-opacity)}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle .mat-pseudo-checkbox{margin-right:12px}[dir=rtl] .mat-button-toggle .mat-pseudo-checkbox{margin-right:0;margin-left:12px}.mat-button-toggle-checked{color:var(--mat-legacy-button-toggle-selected-state-text-color);background-color:var(--mat-legacy-button-toggle-selected-state-background-color)}.mat-button-toggle-disabled{color:var(--mat-legacy-button-toggle-disabled-state-text-color);background-color:var(--mat-legacy-button-toggle-disabled-state-background-color);--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color: var( --mat-legacy-button-toggle-disabled-state-text-color )}.mat-button-toggle-disabled.mat-button-toggle-checked{background-color:var(--mat-legacy-button-toggle-disabled-selected-state-background-color)}.mat-button-toggle-appearance-standard{color:var(--mat-standard-button-toggle-text-color);background-color:var(--mat-standard-button-toggle-background-color);font-family:var(--mat-standard-button-toggle-label-text-font);font-size:var(--mat-standard-button-toggle-label-text-size);line-height:var(--mat-standard-button-toggle-label-text-line-height);font-weight:var(--mat-standard-button-toggle-label-text-weight);letter-spacing:var(--mat-standard-button-toggle-label-text-tracking)}.mat-button-toggle-group-appearance-standard .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:solid 1px var(--mat-standard-button-toggle-divider-color)}[dir=rtl] .mat-button-toggle-group-appearance-standard .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:none;border-right:solid 1px var(--mat-standard-button-toggle-divider-color)}.mat-button-toggle-group-appearance-standard.mat-button-toggle-vertical .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:none;border-right:none;border-top:solid 1px var(--mat-standard-button-toggle-divider-color)}.mat-button-toggle-appearance-standard.mat-button-toggle-checked{color:var(--mat-standard-button-toggle-selected-state-text-color);background-color:var(--mat-standard-button-toggle-selected-state-background-color)}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled{color:var(--mat-standard-button-toggle-disabled-state-text-color);background-color:var(--mat-standard-button-toggle-disabled-state-background-color)}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color: var( --mat-standard-button-toggle-disabled-selected-state-text-color )}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled.mat-button-toggle-checked{color:var(--mat-standard-button-toggle-disabled-selected-state-text-color);background-color:var(--mat-standard-button-toggle-disabled-selected-state-background-color)}.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{background-color:var(--mat-standard-button-toggle-state-layer-color)}.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:var(--mat-standard-button-toggle-hover-state-layer-opacity)}.mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:var(--mat-standard-button-toggle-focus-state-layer-opacity)}@media(hover: none){.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;user-select:none;display:inline-block;padding:0 16px;line-height:var(--mat-legacy-button-toggle-height);position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px;line-height:var(--mat-standard-button-toggle-height)}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;pointer-events:none;opacity:0;background-color:var(--mat-legacy-button-toggle-state-layer-color)}.cdk-high-contrast-active .mat-button-toggle-checked .mat-button-toggle-focus-overlay{border-bottom:solid 500px;opacity:.5;height:0}.cdk-high-contrast-active .mat-button-toggle-checked:hover .mat-button-toggle-focus-overlay{opacity:.6}.cdk-high-contrast-active .mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard{--mat-focus-indicator-border-radius:var(--mat-standard-button-toggle-shape)}.mat-button-toggle-group-appearance-standard .mat-button-toggle:last-of-type .mat-button-toggle-button::before{border-top-right-radius:var(--mat-standard-button-toggle-shape);border-bottom-right-radius:var(--mat-standard-button-toggle-shape)}.mat-button-toggle-group-appearance-standard .mat-button-toggle:first-of-type .mat-button-toggle-button::before{border-top-left-radius:var(--mat-standard-button-toggle-shape);border-bottom-left-radius:var(--mat-standard-button-toggle-shape)}"],encapsulation:2,changeDetection:0})}}return e})(),vj=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Ut,Kc,za,Ut]})}}return e})();function Rbe(e,t){if(e&1){let i=Ze();Ot(0),C(1,"app-labelled-sliders",21),qt("valueChange",function(n){q(i);let o=ae();return jt(o.gaussStdX,n)||(o.gaussStdX=n),X(n)}),Y("valueChange",function(){q(i);let n=ae();return X(n.drawGaussian())}),A(),C(2,"app-labelled-sliders",22),qt("valueChange",function(n){q(i);let o=ae();return jt(o.gaussStdY,n)||(o.gaussStdY=n),X(n)}),Y("valueChange",function(){q(i);let n=ae();return X(n.drawGaussian())}),A(),Rt()}if(e&2){let i=ae();O(),z("min",.5)("max",128)("step",.5),Wt("value",i.gaussStdX),O(),z("min",.5)("max",128)("step",.5),Wt("value",i.gaussStdY)}}function Fbe(e,t){if(e&1){let i=Ze();C(0,"app-labelled-sliders",23),qt("valueChange",function(n){q(i);let o=ae();return jt(o.gaussStdY,n)||(o.gaussStdY=n),X(n)})("valueChange",function(n){q(i);let o=ae();return jt(o.gaussStdX,n)||(o.gaussStdX=n),X(n)}),Y("valueChange",function(){q(i);let n=ae();return X(n.drawGaussian())}),A()}if(e&2){let i=ae();z("min",.5)("max",128)("step",.5),Wt("value",i.gaussStdY)("value",i.gaussStdX)}}var _j=(()=>{class e extends Fo{angle=0;frequency=25;magLog=!0;brushSize=10;gaussStdX=10;gaussStdY=10;repsentationNorm="logAmplitudeOne";drawGaussian(){var i=this.drawCanvas.width,r=this.drawCanvas.height,n=new Uint8ClampedArray(i*r*4);for(let o=0;o<r;o++)for(let a=0;a<i;a++){let s=(o*i+a)*4,c=255*Math.exp(-Math.pow((a-r/2)/(Math.sqrt(2)*this.gaussStdY),2)+-Math.pow((o-i/2)/(Math.sqrt(2)*this.gaussStdX),2));n[s]=c,n[s+1]=c,n[s+2]=c,n[s+3]=255}this.drawCanvas.drawArray(n)}drawSin(){var i=this.drawCanvas.width,r=this.drawCanvas.height,n=new Uint8ClampedArray(i*r*4);for(let o=0;o<r;o++)for(let a=0;a<i;a++){let s=(o*i+a)*4,c=Math.PI*this.angle/180,l=o*Math.cos(c)*this.frequency/r+a*Math.sin(c)*this.frequency/i,d=Math.round((1+Math.sin(Math.PI*2*l))*127);n[s]=d,n[s+1]=d,n[s+2]=d,n[s+3]=255}this.drawCanvas.drawArray(n)}updateFFT(){let i=cv.imread(this.drawCanvas.getCanvas());cv.cvtColor(i,i,cv.COLOR_RGBA2GRAY,0);let r=cv.getOptimalDFTSize(i.rows),n=cv.getOptimalDFTSize(i.cols),o=cv.Scalar.all(0),a=new cv.Mat;cv.copyMakeBorder(i,a,0,r-i.rows,0,n-i.cols,cv.BORDER_CONSTANT,o);let s=new cv.Mat;a.convertTo(s,cv.CV_32F);let c=new cv.MatVector,l=new cv.Mat,d=new cv.Mat.zeros(a.rows,a.cols,cv.CV_32F);c.push_back(s),c.push_back(d),cv.merge(c,l),cv.dft(l,l,cv.DFT_SCALE),cv.split(l,c),cv.magnitude(c.get(0),c.get(1),c.get(0));let u=c.get(0),h=new cv.Mat.ones(u.rows,u.cols,u.type());switch(this.repsentationNorm){case"logAmplitudeOne":cv.add(u,h,u),cv.log(u,u);break;case"logAmplitude":cv.log(u,u);break;case"amplitude":break}let p=new cv.Rect(0,0,u.cols&-2,u.rows&-2);u=u.roi(p);let m=u.cols/2,f=u.rows/2,g=new cv.Mat,v=new cv.Rect(0,0,m,f),_=new cv.Rect(m,0,m,f),b=new cv.Rect(0,f,m,f),y=new cv.Rect(m,f,m,f),x=u.roi(v),w=u.roi(_),I=u.roi(b),S=u.roi(y);x.copyTo(g),S.copyTo(x),g.copyTo(S),w.copyTo(g),I.copyTo(w),g.copyTo(I),cv.normalize(u,u,0,1,cv.NORM_MINMAX),this.outputCanvas.drawMat(u),i.delete(),a.delete(),c.delete(),l.delete(),h.delete(),g.delete()}static \u0275fac=(()=>{let i;return function(n){return(i||(i=Ar(e)))(n||e)}})();static \u0275cmp=Le({type:e,selectors:[["app-fast-fourier-transform"]],features:[Yt],decls:36,vars:18,consts:[["brushSizeSlider",""],["toggleAxis",""],["singleGaussAxis",""],["inputCanvas",""],["outputCanvas",""],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["name","representationNorm",3,"ngModelChange","change","ngModel"],["value","amplitude"],["value","logAmplitude"],["value","logAmplitudeOne"],["title","Brush Size"],["mat-raised-button","","color","primary",1,"fillWidth",3,"click"],["color","primary","labelPosition","before",1,"example-margin"],[4,"ngIf","ngIfElse"],["title","Angle","thumbLabel","","tickInterval","auto",3,"valueChange","min","max","step","value"],["title","Frequency","thumbLabel","","tickInterval","auto",3,"valueChange","min","max","step","value"],["ngProjectAs","[drawerRight]",5,["","drawerRight",""]],["echarts","",1,"profile-graph",3,"options"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["title","Canvas",1,"canvas",3,"drawingEnded","width","drawable","OnlyBW","brushRadius"],["title","Fourier Transform",1,"canvas",3,"profileChanged","drawable","profileOption"],["title","Gaussian STD X","thumbLabel","","tickInterval","auto",3,"valueChange","min","max","step","value"],["title","Gaussian STD Y","thumbLabel","","tickInterval","auto",3,"valueChange","min","max","step","value"],["title","Gaussian STD","thumbLabel","","tickInterval","auto",3,"valueChange","min","max","step","value"]],template:function(r,n){if(r&1){let o=Ze();C(0,"app-tutorial-template-images"),W(1," Fourier Transform "),Ot(2,5),C(3,"mat-button-toggle-group",6),qt("ngModelChange",function(s){return q(o),jt(n.repsentationNorm,s)||(n.repsentationNorm=s),X(s)}),Y("change",function(){return q(o),X(n.updateFFT())}),C(4,"mat-button-toggle",7),W(5,"A"),A(),C(6,"mat-button-toggle",8),W(7,"log(A)"),A(),C(8,"mat-button-toggle",9),W(9,"log(1+A)"),A()(),he(10,"hr")(11,"app-labelled-sliders",10,0)(13,"hr"),C(14,"button",11),Y("click",function(){return q(o),X(n.drawGaussian())}),W(15," Draw Gaussian "),A(),C(16,"mat-slide-toggle",12,1),W(18," Independant axis "),A(),Be(19,Rbe,3,8,"ng-container",13)(20,Fbe,1,5,"ng-template",null,2,Ku),he(22,"hr"),C(23,"button",11),Y("click",function(){return q(o),X(n.drawSin())}),W(24," Draw sin(x) "),A(),C(25,"app-labelled-sliders",14),qt("valueChange",function(s){return q(o),jt(n.angle,s)||(n.angle=s),X(s)}),Y("valueChange",function(){return q(o),X(n.drawSin())}),A(),C(26,"app-labelled-sliders",15),qt("valueChange",function(s){return q(o),jt(n.frequency,s)||(n.frequency=s),X(s)}),Y("valueChange",function(){return q(o),X(n.drawSin())}),A(),Rt(),Ot(27,16),C(28,"h2"),W(29,"Profile"),A(),he(30,"div",17),Rt(),Ot(31,18),C(32,"app-draw-canvas",19,3),Y("drawingEnded",function(){return q(o),X(n.updateFFT())}),A(),C(34,"app-draw-canvas",20,4),Y("profileChanged",function(){return q(o),X(n.updateProfile())}),A(),Rt(),A()}if(r&2){let o=Ft(12),a=Ft(17),s=Ft(21);O(3),Wt("ngModel",n.repsentationNorm),O(16),z("ngIf",a.checked)("ngIfElse",s),O(6),z("min",0)("max",180)("step",2.5),Wt("value",n.angle),O(),z("min",0)("max",256)("step",1),Wt("value",n.frequency),O(4),z("options",n.profileOptions),O(2),z("width",256)("drawable",!0)("OnlyBW",!0)("brushRadius",o.value),O(2),z("drawable",!1)("profileOption",!0)}},dependencies:[Jn,hs,za,Yn,so,Un,$m,on,Vo,Mr,Va],styles:[".drawer-content[_ngcontent-%COMP%]{margin:1em auto;gap:1em}.canvas[_ngcontent-%COMP%]{width:45%;min-width:256px}.profile-graph[_ngcontent-%COMP%]{width:256px}"]})}return e})();var bj=(()=>{class e extends Fo{inputHistoOptions;outputHistoOptions;tileGridSize=8;clipLimit=20;colorspace="LAB";updateHistogram(){let i=cv.imread(this.drawCanvas.getCanvas());if(this.outputCanvas.isBWChecked=this.drawCanvas.isBW(),this.drawCanvas.isBW()){cv.cvtColor(i,i,cv.COLOR_RGBA2GRAY);var r=this.getHistogramFromGrayMat(i)}else var r=this.getHistogramFromColorMat(i);this.inputHistoOptions=this.updateHistoChart(r),i.delete();let n=cv.imread(this.outputCanvas.getCanvas());if(this.outputCanvas.isBW()){cv.cvtColor(n,n,cv.COLOR_RGBA2GRAY);var r=this.getHistogramFromGrayMat(n)}else var r=this.getHistogramFromColorMat(n);this.outputHistoOptions=this.updateHistoChart(r),n.delete()}updateHistoChart(i){let r={legend:{data:["Histogram"],align:"left",textStyle:{color:"white"}},tooltip:{},xAxis:{data:Array.from(Array(i[0].length).keys()),silent:!1,splitLine:{show:!1}},yAxis:{},animationEasing:"exponentialIn",animationDuration:500};return i.length==1?r.series=[{name:"Histogram",type:"line",symbol:"none",areaStyle:{color:new Dn.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(220, 220, 220)"},{offset:1,color:"rgb(150, 150, 150)"}])},data:i[0],dimensions:["R"],itemStyle:{color:"rgb(220, 220, 220)"}}]:(r.legend={data:["R","G","B"],align:"left",textStyle:{color:"white"}},r.series=[{name:"R",type:"line",symbol:"none",itemStyle:{color:"rgb(220, 100, 100)"},areaStyle:{color:new Dn.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(255, 68, 100)"},{offset:1,color:"rgb(180, 68, 100)"}])},data:i[0]},{name:"G",type:"line",symbol:"none",itemStyle:{color:"rgb(100, 220, 100)"},areaStyle:{color:new Dn.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(68, 255, 100)"},{offset:1,color:"rgb(68, 180, 100)"}])},data:i[1]},{name:"B",type:"line",symbol:"none",itemStyle:{color:"rgb(100, 100, 220)"},areaStyle:{color:new Dn.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(68, 100, 255)"},{offset:1,color:"rgb(68, 100, 180)"}])},data:i[2]}]),r}getHistogramFromColorMat(i){let r=new Array,n=new cv.MatVector;cv.split(i,n);let o=new cv.Mat,a=new cv.Mat,s=new cv.Mat,c=[256],l=[0,255],d=new cv.Mat;cv.calcHist(n,[0],d,o,c,l,!1),cv.calcHist(n,[1],d,a,c,l,!1),cv.calcHist(n,[2],d,s,c,l,!1),r.push(o.data32F),r.push(a.data32F),r.push(s.data32F);for(let u=0;u<3;u++)for(let h=0;h<256;h++){let p=r[u];p[h]/=i.rows*i.cols,r[u]=Array.from(p)}return d.delete(),n.delete(),o.delete(),a.delete(),s.delete(),r}getHistogramFromGrayMat(i){let r=new Array,n=new cv.MatVector;n.push_back(i);let o=new cv.Mat,a=[256],s=[0,255],c=new cv.Mat;cv.calcHist(n,[0],c,o,a,s,!1),r.push(o.data32F);for(let l=0;l<256;l++){let d=r[0];d[l]/=i.rows*i.cols,r[0]=Array.from(d)}return c.delete(),n.delete(),o.delete(),r}equalizeHistogram(){let i=cv.imread(this.drawCanvas.getCanvas());if(this.drawCanvas.isBW())cv.cvtColor(i,i,cv.COLOR_RGB2GRAY),cv.equalizeHist(i,i);else switch(this.colorspace){case"RGB":{let r=new cv.MatVector;cv.split(i,r),cv.equalizeHist(r.get(0),r.get(0)),cv.equalizeHist(r.get(1),r.get(1)),cv.equalizeHist(r.get(2),r.get(2)),cv.merge(r,i),r.delete();break}case"LAB":{cv.cvtColor(i,i,cv.COLOR_RGB2Lab);let r=new cv.MatVector;cv.split(i,r),cv.equalizeHist(r.get(0),r.get(0)),cv.merge(r,i),cv.cvtColor(i,i,cv.COLOR_Lab2RGB),r.delete();break}case"HSV":{cv.cvtColor(i,i,cv.COLOR_RGB2HSV);let r=new cv.MatVector;cv.split(i,r),cv.equalizeHist(r.get(2),r.get(2)),cv.merge(r,i),cv.cvtColor(i,i,cv.COLOR_HSV2RGB),r.delete();break}}this.outputCanvas.drawMat(i),this.updateHistogram(),i.delete()}CLAHE(){let i=cv.imread(this.drawCanvas.getCanvas()),r=new cv.Size(this.tileGridSize,this.tileGridSize),n=new cv.CLAHE(this.clipLimit,r);if(this.drawCanvas.isBW())cv.cvtColor(i,i,cv.COLOR_RGB2GRAY),n.apply(i,i);else switch(this.colorspace){case"RGB":{let o=new cv.MatVector;cv.split(i,o),n.apply(o.get(0),o.get(0)),n.apply(o.get(1),o.get(1)),n.apply(o.get(2),o.get(2)),cv.merge(o,i),o.delete();break}case"LAB":{cv.cvtColor(i,i,cv.COLOR_RGB2Lab);let o=new cv.MatVector;cv.split(i,o),n.apply(o.get(0),o.get(0)),cv.merge(o,i),cv.cvtColor(i,i,cv.COLOR_Lab2RGB),o.delete();break}case"HSV":{cv.cvtColor(i,i,cv.COLOR_RGB2HSV);let o=new cv.MatVector;cv.split(i,o),n.apply(o.get(2),o.get(2)),cv.merge(o,i),cv.cvtColor(i,i,cv.COLOR_HSV2RGB),o.delete();break}}this.outputCanvas.drawMat(i),this.updateHistogram(),i.delete(),n.delete()}ngAfterViewInit(){super.ngAfterViewInit(),this.ngxOpenCv.cvState.subscribe(i=>{this.cvState=i,i.ready&&this.updateHistogram()})}static \u0275fac=(()=>{let i;return function(n){return(i||(i=Ar(e)))(n||e)}})();static \u0275cmp=Le({type:e,selectors:[["app-image-histogram"]],features:[Yt],decls:41,vars:19,consts:[["inputCanvas",""],["outputCanvas",""],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["name","Colorspace","aria-label","Color space",3,"ngModelChange","ngModel"],["value","RGB"],["value","LAB"],["value","HSV"],["mat-raised-button","","color","primary",1,"fillWidth",3,"click"],[3,"valueChange","min","max","step","title","value"],["ngProjectAs","[drawerRight]",5,["","drawerRight",""]],["echarts","",1,"histo-graph",3,"options"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["title","Image",1,"canvas",3,"drawingEnded","BWSet","width","drawable","BWOption"],["title","Result",1,"canvas",3,"BWSet","width","drawable","BWOption"]],template:function(r,n){if(r&1){let o=Ze();C(0,"app-tutorial-template-images"),W(1," Histogram and equalization "),Ot(2,2),C(3,"h3"),W(4,"Colorspace"),A(),C(5,"mat-button-toggle-group",3),qt("ngModelChange",function(s){return q(o),jt(n.colorspace,s)||(n.colorspace=s),X(s)}),C(6,"mat-button-toggle",4)(7,"b"),W(8,"RGB"),A()(),C(9,"mat-button-toggle",5)(10,"b"),W(11,"L"),A(),W(12,"AB"),A(),C(13,"mat-button-toggle",6),W(14,"HS"),C(15,"b"),W(16,"V"),A()()(),he(17,"hr"),C(18,"button",7),Y("click",function(){return q(o),X(n.equalizeHistogram())}),W(19," Histogram equalization "),A(),he(20,"hr"),C(21,"h3"),W(22," Contrast Limited "),he(23,"br"),W(24," Adaptive Histogram "),he(25,"br"),W(26," Equalization "),A(),C(27,"app-labelled-sliders",8),qt("valueChange",function(s){return q(o),jt(n.tileGridSize,s)||(n.tileGridSize=s),X(s)}),Y("valueChange",function(){return q(o),X(n.CLAHE())}),A(),C(28,"app-labelled-sliders",8),qt("valueChange",function(s){return q(o),jt(n.clipLimit,s)||(n.clipLimit=s),X(s)}),Y("valueChange",function(){return q(o),X(n.CLAHE())}),A(),C(29,"button",7),Y("click",function(){return q(o),X(n.CLAHE())}),W(30," CLAHE "),A(),Rt(),Ot(31,9),he(32,"div",10),C(33,"h2"),W(34,"Result canvas"),A(),he(35,"div",10),Rt(),Ot(36,11),C(37,"app-draw-canvas",12,0),Y("drawingEnded",function(){return q(o),X(n.updateHistogram())})("BWSet",function(){return q(o),X(n.updateHistogram())}),A(),C(39,"app-draw-canvas",13,1),Y("BWSet",function(){return q(o),X(n.updateHistogram())}),A(),Rt(),A()}r&2&&(O(5),Wt("ngModel",n.colorspace),O(22),z("min",4)("max",48)("step",2)("title","Tile Grid size"),Wt("value",n.tileGridSize),O(),z("min",4)("max",48)("step",2)("title","Clip Limit"),Wt("value",n.clipLimit),O(4),z("options",n.inputHistoOptions),O(3),z("options",n.outputHistoOptions),O(2),z("width",1024)("drawable",!1)("BWOption",!0),O(2),z("width",1024)("drawable",!1)("BWOption",!0))},dependencies:[Jn,hs,za,so,Un,on,Vo,Mr,Va],styles:[".canvas[_ngcontent-%COMP%]{width:45%;min-width:256px}.histo-graph[_ngcontent-%COMP%]{min-width:350px;aspect-ratio:1}"]})}return e})();function HM(e,t){let i=e.length,r=e[0].length,n=new Array(i).fill(0).map(()=>new Array(r).fill(0));for(let o=0;o<i;o++)for(let a=0;a<r;a++)for(let s=0;s<i;s++)n[o][a]+=e[o][s]*t[s][a];return n}function jM(e){let t=e.length,i=e[0].length,r=new Array(i).fill(0).map(()=>new Array(t).fill(0));for(let n=0;n<t;n++)for(let o=0;o<i;o++)r[o][n]=e[n][o];return r}function nc(){return nc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},nc.apply(null,arguments)}var GM={relTol:1e-12,absTol:1e-15,matrix:"Matrix",number:"number",numberFallback:"number",precision:64,predictable:!1,randomSeed:null};function yj(e,t){if(m_(e,t))return e[t];throw typeof e[t]=="function"&&Lbe(e,t)?new Error('Cannot access method "'+t+'" as a property'):new Error('No access to property "'+t+'"')}function xj(e,t,i){if(m_(e,t))return e[t]=i,i;throw new Error('No access to property "'+t+'"')}function m_(e,t){return!Bbe(e)&&!Array.isArray(e)?!1:Zm(Vbe,t)?!0:!(t in Object.prototype||t in Function.prototype)}function Lbe(e,t){return e==null||typeof e[t]!="function"||Zm(e,t)&&Object.getPrototypeOf&&t in Object.getPrototypeOf(e)?!1:Zm(zbe,t)?!0:!(t in Object.prototype||t in Function.prototype)}function Bbe(e){return typeof e=="object"&&e&&e.constructor===Object}var Vbe={length:!0,name:!0},zbe={toString:!0,valueOf:!0,toLocaleString:!0};var D2=class{constructor(t){this.wrappedObject=t,this[Symbol.iterator]=this.entries}keys(){return Object.keys(this.wrappedObject).filter(t=>this.has(t)).values()}get(t){return yj(this.wrappedObject,t)}set(t,i){return xj(this.wrappedObject,t,i),this}has(t){return m_(this.wrappedObject,t)&&t in this.wrappedObject}entries(){return Ube(this.keys(),t=>[t,this.get(t)])}forEach(t){for(var i of this.keys())t(this.get(i),i,this)}delete(t){m_(this.wrappedObject,t)&&delete this.wrappedObject[t]}clear(){for(var t of this.keys())this.delete(t)}get size(){return Object.keys(this.wrappedObject).length}};function Ube(e,t){return{next:()=>{var i=e.next();return i.done?i:{value:t(i.value),done:!1}}}}function Vi(e){return typeof e=="number"}function Gi(e){return!e||typeof e!="object"||typeof e.constructor!="function"?!1:e.isBigNumber===!0&&typeof e.constructor.prototype=="object"&&e.constructor.prototype.isBigNumber===!0||typeof e.constructor.isDecimal=="function"&&e.constructor.isDecimal(e)===!0}function wj(e){return typeof e=="bigint"}function g_(e){return e&&typeof e=="object"&&Object.getPrototypeOf(e).isComplex===!0||!1}function v_(e){return e&&typeof e=="object"&&Object.getPrototypeOf(e).isFraction===!0||!1}function I2(e){return e&&e.constructor.prototype.isUnit===!0||!1}function go(e){return typeof e=="string"}var or=Array.isArray;function Di(e){return e&&e.constructor.prototype.isMatrix===!0||!1}function Ep(e){return Array.isArray(e)||Di(e)}function M2(e){return e&&e.isDenseMatrix&&e.constructor.prototype.isMatrix===!0||!1}function k2(e){return e&&e.isSparseMatrix&&e.constructor.prototype.isMatrix===!0||!1}function P2(e){return e&&e.constructor.prototype.isRange===!0||!1}function Km(e){return e&&e.constructor.prototype.isIndex===!0||!1}function Ej(e){return typeof e=="boolean"}function Cj(e){return e&&e.constructor.prototype.isResultSet===!0||!1}function Sj(e){return e&&e.constructor.prototype.isHelp===!0||!1}function Tj(e){return typeof e=="function"}function Aj(e){return e instanceof Date}function Dj(e){return e instanceof RegExp}function Qm(e){return!!(e&&typeof e=="object"&&e.constructor===Object&&!g_(e)&&!v_(e))}function Ij(e){return e?e instanceof Map||e instanceof D2||typeof e.set=="function"&&typeof e.get=="function"&&typeof e.keys=="function"&&typeof e.has=="function":!1}function Mj(e){return e===null}function kj(e){return e===void 0}function Pj(e){return e&&e.isAccessorNode===!0&&e.constructor.prototype.isNode===!0||!1}function Nj(e){return e&&e.isArrayNode===!0&&e.constructor.prototype.isNode===!0||!1}function Oj(e){return e&&e.isAssignmentNode===!0&&e.constructor.prototype.isNode===!0||!1}function Rj(e){return e&&e.isBlockNode===!0&&e.constructor.prototype.isNode===!0||!1}function Fj(e){return e&&e.isConditionalNode===!0&&e.constructor.prototype.isNode===!0||!1}function Lj(e){return e&&e.isConstantNode===!0&&e.constructor.prototype.isNode===!0||!1}function Bj(e){return e&&e.isFunctionAssignmentNode===!0&&e.constructor.prototype.isNode===!0||!1}function Vj(e){return e&&e.isFunctionNode===!0&&e.constructor.prototype.isNode===!0||!1}function zj(e){return e&&e.isIndexNode===!0&&e.constructor.prototype.isNode===!0||!1}function Uj(e){return e&&e.isNode===!0&&e.constructor.prototype.isNode===!0||!1}function Hj(e){return e&&e.isObjectNode===!0&&e.constructor.prototype.isNode===!0||!1}function jj(e){return e&&e.isOperatorNode===!0&&e.constructor.prototype.isNode===!0||!1}function Gj(e){return e&&e.isParenthesisNode===!0&&e.constructor.prototype.isNode===!0||!1}function $j(e){return e&&e.isRangeNode===!0&&e.constructor.prototype.isNode===!0||!1}function Wj(e){return e&&e.isRelationalNode===!0&&e.constructor.prototype.isNode===!0||!1}function qj(e){return e&&e.isSymbolNode===!0&&e.constructor.prototype.isNode===!0||!1}function Xj(e){return e&&e.constructor.prototype.isChain===!0||!1}function Hn(e){var t=typeof e;return t==="object"?e===null?"null":Gi(e)?"BigNumber":e.constructor&&e.constructor.name?e.constructor.name:"Object":t}function hi(e){var t=typeof e;if(t==="number"||t==="bigint"||t==="string"||t==="boolean"||e===null||e===void 0)return e;if(typeof e.clone=="function")return e.clone();if(Array.isArray(e))return e.map(function(i){return hi(i)});if(e instanceof Date)return new Date(e.valueOf());if(Gi(e))return e;if(Qm(e))return Hbe(e,hi);throw new TypeError("Cannot clone: unknown type of value (value: ".concat(e,")"))}function Hbe(e,t){var i={};for(var r in e)Zm(e,r)&&(i[r]=t(e[r]));return i}function Yj(e,t){for(var i in t)Zm(t,i)&&(e[i]=t[i]);return e}function Zs(e,t){var i,r,n;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(r=0,n=e.length;r<n;r++)if(!Zs(e[r],t[r]))return!1;return!0}else{if(typeof e=="function")return e===t;if(e instanceof Object){if(Array.isArray(t)||!(t instanceof Object))return!1;for(i in e)if(!(i in t)||!Zs(e[i],t[i]))return!1;for(i in t)if(!(i in e))return!1;return!0}else return e===t}}function Zm(e,t){return e&&Object.hasOwnProperty.call(e,t)}function Zj(e,t){for(var i={},r=0;r<t.length;r++){var n=t[r],o=e[n];o!==void 0&&(i[n]=o)}return i}var Kj=["Matrix","Array"],Qj=["number","BigNumber","Fraction"];var ma=function(t){if(t)throw new Error(`The global config is readonly. 
Please create a mathjs instance if you want to change the default configuration. 
Example:

  import { create, all } from 'mathjs';
  const mathjs = create(all);
  mathjs.config({ number: 'BigNumber' });
`);return Object.freeze(GM)};nc(ma,GM,{MATRIX_OPTIONS:Kj,NUMBER_OPTIONS:Qj});var ZM=i3(qM(),1);function le(e,t,i,r){function n(o){var a=Zj(o,t.map($be));return jbe(e,t,o),i(a)}return n.isFactory=!0,n.fn=e,n.dependencies=t.slice().sort(),r&&(n.meta=r),n}function jbe(e,t,i){var r=t.filter(o=>!Gbe(o)).every(o=>i[o]!==void 0);if(!r){var n=t.filter(o=>i[o]===void 0);throw new Error('Cannot create function "'.concat(e,'", ')+"some dependencies are missing: ".concat(n.map(o=>'"'.concat(o,'"')).join(", "),"."))}}function Gbe(e){return e&&e[0]==="?"}function $be(e){return e&&e[0]==="?"?e.slice(1):e}function xi(e){return typeof e=="boolean"?!0:isFinite(e)?e===Math.round(e):!1}var tG=Math.sign||function(e){return e>0?1:e<0?-1:0},iG=Math.log2||function(t){return Math.log(t)/Math.LN2},rG=Math.log10||function(t){return Math.log(t)/Math.LN10},nG=Math.log1p||function(e){return Math.log(e+1)},oG=Math.cbrt||function(t){if(t===0)return t;var i=t<0,r;return i&&(t=-t),isFinite(t)?(r=Math.exp(Math.log(t)/3),r=(t/(r*r)+2*r)/3):r=t,i?-r:r},aG=Math.expm1||function(t){return t>=2e-4||t<=-2e-4?Math.exp(t)-1:t+t*t/2+t*t*t/6};function XM(e,t,i){var r={2:"0b",8:"0o",16:"0x"},n=r[t],o="";if(i){if(i<1)throw new Error("size must be in greater than 0");if(!xi(i))throw new Error("size must be an integer");if(e>2**(i-1)-1||e<-(2**(i-1)))throw new Error("Value must be in range [-2^".concat(i-1,", 2^").concat(i-1,"-1]"));if(!xi(e))throw new Error("Value must be an integer");e<0&&(e=e+2**i),o="i".concat(i)}var a="";return e<0&&(e=-e,a="-"),"".concat(a).concat(n).concat(e.toString(t)).concat(o)}function __(e,t){if(typeof t=="function")return t(e);if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity";if(isNaN(e))return"NaN";var{notation:i,precision:r,wordSize:n}=YM(t);switch(i){case"fixed":return sG(e,r);case"exponential":return lG(e,r);case"engineering":return Wbe(e,r);case"bin":return XM(e,2,n);case"oct":return XM(e,8,n);case"hex":return XM(e,16,n);case"auto":return qbe(e,r,t).replace(/((\.\d*?)(0+))($|e)/,function(){var o=arguments[2],a=arguments[4];return o!=="."?o+a:a});default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function YM(e){var t="auto",i,r;if(e!==void 0)if(Vi(e))i=e;else if(Gi(e))i=e.toNumber();else if(Qm(e))e.precision!==void 0&&(i=Jj(e.precision,()=>{throw new Error('Option "precision" must be a number or BigNumber')})),e.wordSize!==void 0&&(r=Jj(e.wordSize,()=>{throw new Error('Option "wordSize" must be a number or BigNumber')})),e.notation&&(t=e.notation);else throw new Error("Unsupported type of options, number, BigNumber, or object expected");return{notation:t,precision:i,wordSize:r}}function N2(e){var t=String(e).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!t)throw new SyntaxError("Invalid number "+e);var i=t[1],r=t[2],n=parseFloat(t[4]||"0"),o=r.indexOf(".");n+=o!==-1?o-1:r.length-1;var a=r.replace(".","").replace(/^0*/,function(s){return n-=s.length,""}).replace(/0*$/,"").split("").map(function(s){return parseInt(s)});return a.length===0&&(a.push(0),n++),{sign:i,coefficients:a,exponent:n}}function Wbe(e,t){if(isNaN(e)||!isFinite(e))return String(e);var i=N2(e),r=O2(i,t),n=r.exponent,o=r.coefficients,a=n%3===0?n:n<0?n-3-n%3:n-n%3;if(Vi(t))for(;t>o.length||n-a+1>o.length;)o.push(0);else for(var s=Math.abs(n-a)-(o.length-1),c=0;c<s;c++)o.push(0);for(var l=Math.abs(n-a),d=1;l>0;)d++,l--;var u=o.slice(d).join(""),h=Vi(t)&&u.length||u.match(/[1-9]/)?"."+u:"",p=o.slice(0,d).join("")+h+"e"+(n>=0?"+":"")+a.toString();return r.sign+p}function sG(e,t){if(isNaN(e)||!isFinite(e))return String(e);var i=N2(e),r=typeof t=="number"?O2(i,i.exponent+1+t):i,n=r.coefficients,o=r.exponent+1,a=o+(t||0);return n.length<a&&(n=n.concat(Jm(a-n.length))),o<0&&(n=Jm(-o+1).concat(n),o=1),o<n.length&&n.splice(o,0,o===0?"0.":"."),r.sign+n.join("")}function lG(e,t){if(isNaN(e)||!isFinite(e))return String(e);var i=N2(e),r=t?O2(i,t):i,n=r.coefficients,o=r.exponent;n.length<t&&(n=n.concat(Jm(t-n.length)));var a=n.shift();return r.sign+a+(n.length>0?"."+n.join(""):"")+"e"+(o>=0?"+":"")+o}function qbe(e,t,i){if(isNaN(e)||!isFinite(e))return String(e);var r=eG(i?.lowerExp,-3),n=eG(i?.upperExp,5),o=N2(e),a=t?O2(o,t):o;if(a.exponent<r||a.exponent>=n)return lG(e,t);var s=a.coefficients,c=a.exponent;s.length<t&&(s=s.concat(Jm(t-s.length))),s=s.concat(Jm(c-s.length+1+(s.length<t?t-s.length:0))),s=Jm(-c).concat(s);var l=c>0?c:0;return l<s.length-1&&s.splice(l+1,0,"."),a.sign+s.join("")}function O2(e,t){for(var i={sign:e.sign,coefficients:e.coefficients,exponent:e.exponent},r=i.coefficients;t<=0;)r.unshift(0),i.exponent++,t++;if(r.length>t){var n=r.splice(t,r.length-t);if(n[0]>=5){var o=t-1;for(r[o]++;r[o]===10;)r.pop(),o===0&&(r.unshift(0),i.exponent++,o++),o--,r[o]++}}return i}function Jm(e){for(var t=[],i=0;i<e;i++)t.push(0);return t}function cG(e){return e.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}var $We=Number.EPSILON||2220446049250313e-31;function Uo(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e-8,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(i<=0)throw new Error("Relative tolerance must be greater than 0");if(r<0)throw new Error("Absolute tolerance must be at least 0");return isNaN(e)||isNaN(t)?!1:!isFinite(e)||!isFinite(t)?e===t:e===t?!0:Math.abs(e-t)<=Math.max(i*Math.max(Math.abs(e),Math.abs(t)),r)}function Jj(e,t){if(Vi(e))return e;if(Gi(e))return e.toNumber();t()}function eG(e,t){return Vi(e)?e:Gi(e)?e.toNumber():t}var dG=function(){return dG=ZM.default.create,ZM.default},Xbe=["?BigNumber","?Complex","?DenseMatrix","?Fraction"],KM=le("typed",Xbe,function(t){var{BigNumber:i,Complex:r,DenseMatrix:n,Fraction:o}=t,a=dG();return a.clear(),a.addTypes([{name:"number",test:Vi},{name:"Complex",test:g_},{name:"BigNumber",test:Gi},{name:"bigint",test:wj},{name:"Fraction",test:v_},{name:"Unit",test:I2},{name:"identifier",test:s=>go&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(s)},{name:"string",test:go},{name:"Chain",test:Xj},{name:"Array",test:or},{name:"Matrix",test:Di},{name:"DenseMatrix",test:M2},{name:"SparseMatrix",test:k2},{name:"Range",test:P2},{name:"Index",test:Km},{name:"boolean",test:Ej},{name:"ResultSet",test:Cj},{name:"Help",test:Sj},{name:"function",test:Tj},{name:"Date",test:Aj},{name:"RegExp",test:Dj},{name:"null",test:Mj},{name:"undefined",test:kj},{name:"AccessorNode",test:Pj},{name:"ArrayNode",test:Nj},{name:"AssignmentNode",test:Oj},{name:"BlockNode",test:Rj},{name:"ConditionalNode",test:Fj},{name:"ConstantNode",test:Lj},{name:"FunctionNode",test:Vj},{name:"FunctionAssignmentNode",test:Bj},{name:"IndexNode",test:zj},{name:"Node",test:Uj},{name:"ObjectNode",test:Hj},{name:"OperatorNode",test:jj},{name:"ParenthesisNode",test:Gj},{name:"RangeNode",test:$j},{name:"RelationalNode",test:Wj},{name:"SymbolNode",test:qj},{name:"Map",test:Ij},{name:"Object",test:Qm}]),a.addConversions([{from:"number",to:"BigNumber",convert:function(c){if(i||R2(c),cG(c)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+c+"). Use function bignumber(x) to convert to BigNumber.");return new i(c)}},{from:"number",to:"Complex",convert:function(c){return r||F2(c),new r(c,0)}},{from:"BigNumber",to:"Complex",convert:function(c){return r||F2(c),new r(c.toNumber(),0)}},{from:"bigint",to:"number",convert:function(c){if(c>Number.MAX_SAFE_INTEGER)throw new TypeError("Cannot implicitly convert bigint to number: value exceeds the max safe integer value (value: "+c+")");return Number(c)}},{from:"bigint",to:"BigNumber",convert:function(c){return i||R2(c),new i(c.toString())}},{from:"bigint",to:"Fraction",convert:function(c){return o||L2(c),new o(c.toString())}},{from:"Fraction",to:"BigNumber",convert:function(c){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(c){return r||F2(c),new r(c.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(c){o||L2(c);var l=new o(c);if(l.valueOf()!==c)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+c+"). Use function fraction(x) to convert to Fraction.");return l}},{from:"string",to:"number",convert:function(c){var l=Number(c);if(isNaN(l))throw new Error('Cannot convert "'+c+'" to a number');return l}},{from:"string",to:"BigNumber",convert:function(c){i||R2(c);try{return new i(c)}catch{throw new Error('Cannot convert "'+c+'" to BigNumber')}}},{from:"string",to:"bigint",convert:function(c){try{return BigInt(c)}catch{throw new Error('Cannot convert "'+c+'" to BigInt')}}},{from:"string",to:"Fraction",convert:function(c){o||L2(c);try{return new o(c)}catch{throw new Error('Cannot convert "'+c+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(c){r||F2(c);try{return new r(c)}catch{throw new Error('Cannot convert "'+c+'" to Complex')}}},{from:"boolean",to:"number",convert:function(c){return+c}},{from:"boolean",to:"BigNumber",convert:function(c){return i||R2(c),new i(+c)}},{from:"boolean",to:"bigint",convert:function(c){return BigInt(+c)}},{from:"boolean",to:"Fraction",convert:function(c){return o||L2(c),new o(+c)}},{from:"boolean",to:"string",convert:function(c){return String(c)}},{from:"Array",to:"Matrix",convert:function(c){return n||Ybe(),new n(c)}},{from:"Matrix",to:"Array",convert:function(c){return c.valueOf()}}]),a.onMismatch=(s,c,l)=>{var d=a.createError(s,c,l);if(["wrongType","mismatch"].includes(d.data.category)&&c.length===1&&Ep(c[0])&&l.some(h=>!h.params.includes(","))){var u=new TypeError("Function '".concat(s,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(s,")'."));throw u.data=d.data,u}throw d},a.onMismatch=(s,c,l)=>{var d=a.createError(s,c,l);if(["wrongType","mismatch"].includes(d.data.category)&&c.length===1&&Ep(c[0])&&l.some(h=>!h.params.includes(","))){var u=new TypeError("Function '".concat(s,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(s,")'."));throw u.data=d.data,u}throw d},a});function R2(e){throw new Error("Cannot convert value ".concat(e," into a BigNumber: no class 'BigNumber' provided"))}function F2(e){throw new Error("Cannot convert value ".concat(e," into a Complex number: no class 'Complex' provided"))}function Ybe(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}function L2(e){throw new Error("Cannot convert value ".concat(e," into a Fraction, no class 'Fraction' provided."))}var eg=9e15,Cu=1e9,QM="0123456789abcdef",V2="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",z2="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",JM={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-eg,maxE:eg,crypto:!1},fG,ed,ii=!0,H2="[DecimalError] ",Eu=H2+"Invalid argument: ",mG=H2+"Precision limit exceeded",gG=H2+"crypto unavailable",vG="[object Decimal]",Ho=Math.floor,jn=Math.pow,Zbe=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Kbe=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Qbe=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,_G=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Cl=1e7,Gt=7,Jbe=9007199254740991,eye=V2.length-1,ek=z2.length-1,ke={toStringTag:vG};ke.absoluteValue=ke.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),kt(e)};ke.ceil=function(){return kt(new this.constructor(this),this.e+1,2)};ke.clampedTo=ke.clamp=function(e,t){var i,r=this,n=r.constructor;if(e=new n(e),t=new n(t),!e.s||!t.s)return new n(NaN);if(e.gt(t))throw Error(Eu+t);return i=r.cmp(e),i<0?e:r.cmp(t)>0?t:new n(r)};ke.comparedTo=ke.cmp=function(e){var t,i,r,n,o=this,a=o.d,s=(e=new o.constructor(e)).d,c=o.s,l=e.s;if(!a||!s)return!c||!l?NaN:c!==l?c:a===s?0:!a^c<0?1:-1;if(!a[0]||!s[0])return a[0]?c:s[0]?-l:0;if(c!==l)return c;if(o.e!==e.e)return o.e>e.e^c<0?1:-1;for(r=a.length,n=s.length,t=0,i=r<n?r:n;t<i;++t)if(a[t]!==s[t])return a[t]>s[t]^c<0?1:-1;return r===n?0:r>n^c<0?1:-1};ke.cosine=ke.cos=function(){var e,t,i=this,r=i.constructor;return i.d?i.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(i.e,i.sd())+Gt,r.rounding=1,i=tye(r,EG(r,i)),r.precision=e,r.rounding=t,kt(ed==2||ed==3?i.neg():i,e,t,!0)):new r(1):new r(NaN)};ke.cubeRoot=ke.cbrt=function(){var e,t,i,r,n,o,a,s,c,l,d=this,u=d.constructor;if(!d.isFinite()||d.isZero())return new u(d);for(ii=!1,o=d.s*jn(d.s*d,1/3),!o||Math.abs(o)==1/0?(i=vo(d.d),e=d.e,(o=(e-i.length+1)%3)&&(i+=o==1||o==-2?"0":"00"),o=jn(i,1/3),e=Ho((e+1)/3)-(e%3==(e<0?-1:2)),o==1/0?i="5e"+e:(i=o.toExponential(),i=i.slice(0,i.indexOf("e")+1)+e),r=new u(i),r.s=d.s):r=new u(o.toString()),a=(e=u.precision)+3;;)if(s=r,c=s.times(s).times(s),l=c.plus(d),r=Or(l.plus(d).times(s),l.plus(c),a+2,1),vo(s.d).slice(0,a)===(i=vo(r.d)).slice(0,a))if(i=i.slice(a-3,a+1),i=="9999"||!n&&i=="4999"){if(!n&&(kt(s,e+1,0),s.times(s).times(s).eq(d))){r=s;break}a+=4,n=1}else{(!+i||!+i.slice(1)&&i.charAt(0)=="5")&&(kt(r,e+1,1),t=!r.times(r).times(r).eq(d));break}return ii=!0,kt(r,e,u.rounding,t)};ke.decimalPlaces=ke.dp=function(){var e,t=this.d,i=NaN;if(t){if(e=t.length-1,i=(e-Ho(this.e/Gt))*Gt,e=t[e],e)for(;e%10==0;e/=10)i--;i<0&&(i=0)}return i};ke.dividedBy=ke.div=function(e){return Or(this,new this.constructor(e))};ke.dividedToIntegerBy=ke.divToInt=function(e){var t=this,i=t.constructor;return kt(Or(t,new i(e),0,1,1),i.precision,i.rounding)};ke.equals=ke.eq=function(e){return this.cmp(e)===0};ke.floor=function(){return kt(new this.constructor(this),this.e+1,3)};ke.greaterThan=ke.gt=function(e){return this.cmp(e)>0};ke.greaterThanOrEqualTo=ke.gte=function(e){var t=this.cmp(e);return t==1||t===0};ke.hyperbolicCosine=ke.cosh=function(){var e,t,i,r,n,o=this,a=o.constructor,s=new a(1);if(!o.isFinite())return new a(o.s?1/0:NaN);if(o.isZero())return s;i=a.precision,r=a.rounding,a.precision=i+Math.max(o.e,o.sd())+4,a.rounding=1,n=o.d.length,n<32?(e=Math.ceil(n/3),t=(1/G2(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),o=tg(a,1,o.times(t),new a(1),!0);for(var c,l=e,d=new a(8);l--;)c=o.times(o),o=s.minus(c.times(d.minus(c.times(d))));return kt(o,a.precision=i,a.rounding=r,!0)};ke.hyperbolicSine=ke.sinh=function(){var e,t,i,r,n=this,o=n.constructor;if(!n.isFinite()||n.isZero())return new o(n);if(t=o.precision,i=o.rounding,o.precision=t+Math.max(n.e,n.sd())+4,o.rounding=1,r=n.d.length,r<3)n=tg(o,2,n,n,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:e|0,n=n.times(1/G2(5,e)),n=tg(o,2,n,n,!0);for(var a,s=new o(5),c=new o(16),l=new o(20);e--;)a=n.times(n),n=n.times(s.plus(a.times(c.times(a).plus(l))))}return o.precision=t,o.rounding=i,kt(n,t,i,!0)};ke.hyperbolicTangent=ke.tanh=function(){var e,t,i=this,r=i.constructor;return i.isFinite()?i.isZero()?new r(i):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,Or(i.sinh(),i.cosh(),r.precision=e,r.rounding=t)):new r(i.s)};ke.inverseCosine=ke.acos=function(){var e,t=this,i=t.constructor,r=t.abs().cmp(1),n=i.precision,o=i.rounding;return r!==-1?r===0?t.isNeg()?El(i,n,o):new i(0):new i(NaN):t.isZero()?El(i,n+4,o).times(.5):(i.precision=n+6,i.rounding=1,t=t.asin(),e=El(i,n+4,o).times(.5),i.precision=n,i.rounding=o,e.minus(t))};ke.inverseHyperbolicCosine=ke.acosh=function(){var e,t,i=this,r=i.constructor;return i.lte(1)?new r(i.eq(1)?0:NaN):i.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(i.e),i.sd())+4,r.rounding=1,ii=!1,i=i.times(i).minus(1).sqrt().plus(i),ii=!0,r.precision=e,r.rounding=t,i.ln()):new r(i)};ke.inverseHyperbolicSine=ke.asinh=function(){var e,t,i=this,r=i.constructor;return!i.isFinite()||i.isZero()?new r(i):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(i.e),i.sd())+6,r.rounding=1,ii=!1,i=i.times(i).plus(1).sqrt().plus(i),ii=!0,r.precision=e,r.rounding=t,i.ln())};ke.inverseHyperbolicTangent=ke.atanh=function(){var e,t,i,r,n=this,o=n.constructor;return n.isFinite()?n.e>=0?new o(n.abs().eq(1)?n.s/0:n.isZero()?n:NaN):(e=o.precision,t=o.rounding,r=n.sd(),Math.max(r,e)<2*-n.e-1?kt(new o(n),e,t,!0):(o.precision=i=r-n.e,n=Or(n.plus(1),new o(1).minus(n),i+e,1),o.precision=e+4,o.rounding=1,n=n.ln(),o.precision=e,o.rounding=t,n.times(.5))):new o(NaN)};ke.inverseSine=ke.asin=function(){var e,t,i,r,n=this,o=n.constructor;return n.isZero()?new o(n):(t=n.abs().cmp(1),i=o.precision,r=o.rounding,t!==-1?t===0?(e=El(o,i+4,r).times(.5),e.s=n.s,e):new o(NaN):(o.precision=i+6,o.rounding=1,n=n.div(new o(1).minus(n.times(n)).sqrt().plus(1)).atan(),o.precision=i,o.rounding=r,n.times(2)))};ke.inverseTangent=ke.atan=function(){var e,t,i,r,n,o,a,s,c,l=this,d=l.constructor,u=d.precision,h=d.rounding;if(l.isFinite()){if(l.isZero())return new d(l);if(l.abs().eq(1)&&u+4<=ek)return a=El(d,u+4,h).times(.25),a.s=l.s,a}else{if(!l.s)return new d(NaN);if(u+4<=ek)return a=El(d,u+4,h).times(.5),a.s=l.s,a}for(d.precision=s=u+10,d.rounding=1,i=Math.min(28,s/Gt+2|0),e=i;e;--e)l=l.div(l.times(l).plus(1).sqrt().plus(1));for(ii=!1,t=Math.ceil(s/Gt),r=1,c=l.times(l),a=new d(l),n=l;e!==-1;)if(n=n.times(c),o=a.minus(n.div(r+=2)),n=n.times(c),a=o.plus(n.div(r+=2)),a.d[t]!==void 0)for(e=t;a.d[e]===o.d[e]&&e--;);return i&&(a=a.times(2<<i-1)),ii=!0,kt(a,d.precision=u,d.rounding=h,!0)};ke.isFinite=function(){return!!this.d};ke.isInteger=ke.isInt=function(){return!!this.d&&Ho(this.e/Gt)>this.d.length-2};ke.isNaN=function(){return!this.s};ke.isNegative=ke.isNeg=function(){return this.s<0};ke.isPositive=ke.isPos=function(){return this.s>0};ke.isZero=function(){return!!this.d&&this.d[0]===0};ke.lessThan=ke.lt=function(e){return this.cmp(e)<0};ke.lessThanOrEqualTo=ke.lte=function(e){return this.cmp(e)<1};ke.logarithm=ke.log=function(e){var t,i,r,n,o,a,s,c,l=this,d=l.constructor,u=d.precision,h=d.rounding,p=5;if(e==null)e=new d(10),t=!0;else{if(e=new d(e),i=e.d,e.s<0||!i||!i[0]||e.eq(1))return new d(NaN);t=e.eq(10)}if(i=l.d,l.s<0||!i||!i[0]||l.eq(1))return new d(i&&!i[0]?-1/0:l.s!=1?NaN:i?0:1/0);if(t)if(i.length>1)o=!0;else{for(n=i[0];n%10===0;)n/=10;o=n!==1}if(ii=!1,s=u+p,a=wu(l,s),r=t?U2(d,s+10):wu(e,s),c=Or(a,r,s,1),b_(c.d,n=u,h))do if(s+=10,a=wu(l,s),r=t?U2(d,s+10):wu(e,s),c=Or(a,r,s,1),!o){+vo(c.d).slice(n+1,n+15)+1==1e14&&(c=kt(c,u+1,0));break}while(b_(c.d,n+=10,h));return ii=!0,kt(c,u,h)};ke.minus=ke.sub=function(e){var t,i,r,n,o,a,s,c,l,d,u,h,p=this,m=p.constructor;if(e=new m(e),!p.d||!e.d)return!p.s||!e.s?e=new m(NaN):p.d?e.s=-e.s:e=new m(e.d||p.s!==e.s?p:NaN),e;if(p.s!=e.s)return e.s=-e.s,p.plus(e);if(l=p.d,h=e.d,s=m.precision,c=m.rounding,!l[0]||!h[0]){if(h[0])e.s=-e.s;else if(l[0])e=new m(p);else return new m(c===3?-0:0);return ii?kt(e,s,c):e}if(i=Ho(e.e/Gt),d=Ho(p.e/Gt),l=l.slice(),o=d-i,o){for(u=o<0,u?(t=l,o=-o,a=h.length):(t=h,i=d,a=l.length),r=Math.max(Math.ceil(s/Gt),a)+2,o>r&&(o=r,t.length=1),t.reverse(),r=o;r--;)t.push(0);t.reverse()}else{for(r=l.length,a=h.length,u=r<a,u&&(a=r),r=0;r<a;r++)if(l[r]!=h[r]){u=l[r]<h[r];break}o=0}for(u&&(t=l,l=h,h=t,e.s=-e.s),a=l.length,r=h.length-a;r>0;--r)l[a++]=0;for(r=h.length;r>o;){if(l[--r]<h[r]){for(n=r;n&&l[--n]===0;)l[n]=Cl-1;--l[n],l[r]+=Cl}l[r]-=h[r]}for(;l[--a]===0;)l.pop();for(;l[0]===0;l.shift())--i;return l[0]?(e.d=l,e.e=j2(l,i),ii?kt(e,s,c):e):new m(c===3?-0:0)};ke.modulo=ke.mod=function(e){var t,i=this,r=i.constructor;return e=new r(e),!i.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||i.d&&!i.d[0]?kt(new r(i),r.precision,r.rounding):(ii=!1,r.modulo==9?(t=Or(i,e.abs(),0,3,1),t.s*=e.s):t=Or(i,e,0,r.modulo,1),t=t.times(e),ii=!0,i.minus(t))};ke.naturalExponential=ke.exp=function(){return tk(this)};ke.naturalLogarithm=ke.ln=function(){return wu(this)};ke.negated=ke.neg=function(){var e=new this.constructor(this);return e.s=-e.s,kt(e)};ke.plus=ke.add=function(e){var t,i,r,n,o,a,s,c,l,d,u=this,h=u.constructor;if(e=new h(e),!u.d||!e.d)return!u.s||!e.s?e=new h(NaN):u.d||(e=new h(e.d||u.s===e.s?u:NaN)),e;if(u.s!=e.s)return e.s=-e.s,u.minus(e);if(l=u.d,d=e.d,s=h.precision,c=h.rounding,!l[0]||!d[0])return d[0]||(e=new h(u)),ii?kt(e,s,c):e;if(o=Ho(u.e/Gt),r=Ho(e.e/Gt),l=l.slice(),n=o-r,n){for(n<0?(i=l,n=-n,a=d.length):(i=d,r=o,a=l.length),o=Math.ceil(s/Gt),a=o>a?o+1:a+1,n>a&&(n=a,i.length=1),i.reverse();n--;)i.push(0);i.reverse()}for(a=l.length,n=d.length,a-n<0&&(n=a,i=d,d=l,l=i),t=0;n;)t=(l[--n]=l[n]+d[n]+t)/Cl|0,l[n]%=Cl;for(t&&(l.unshift(t),++r),a=l.length;l[--a]==0;)l.pop();return e.d=l,e.e=j2(l,r),ii?kt(e,s,c):e};ke.precision=ke.sd=function(e){var t,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Eu+e);return i.d?(t=bG(i.d),e&&i.e+1>t&&(t=i.e+1)):t=NaN,t};ke.round=function(){var e=this,t=e.constructor;return kt(new t(e),e.e+1,t.rounding)};ke.sine=ke.sin=function(){var e,t,i=this,r=i.constructor;return i.isFinite()?i.isZero()?new r(i):(e=r.precision,t=r.rounding,r.precision=e+Math.max(i.e,i.sd())+Gt,r.rounding=1,i=rye(r,EG(r,i)),r.precision=e,r.rounding=t,kt(ed>2?i.neg():i,e,t,!0)):new r(NaN)};ke.squareRoot=ke.sqrt=function(){var e,t,i,r,n,o,a=this,s=a.d,c=a.e,l=a.s,d=a.constructor;if(l!==1||!s||!s[0])return new d(!l||l<0&&(!s||s[0])?NaN:s?a:1/0);for(ii=!1,l=Math.sqrt(+a),l==0||l==1/0?(t=vo(s),(t.length+c)%2==0&&(t+="0"),l=Math.sqrt(t),c=Ho((c+1)/2)-(c<0||c%2),l==1/0?t="5e"+c:(t=l.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),r=new d(t)):r=new d(l.toString()),i=(c=d.precision)+3;;)if(o=r,r=o.plus(Or(a,o,i+2,1)).times(.5),vo(o.d).slice(0,i)===(t=vo(r.d)).slice(0,i))if(t=t.slice(i-3,i+1),t=="9999"||!n&&t=="4999"){if(!n&&(kt(o,c+1,0),o.times(o).eq(a))){r=o;break}i+=4,n=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(kt(r,c+1,1),e=!r.times(r).eq(a));break}return ii=!0,kt(r,c,d.rounding,e)};ke.tangent=ke.tan=function(){var e,t,i=this,r=i.constructor;return i.isFinite()?i.isZero()?new r(i):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,i=i.sin(),i.s=1,i=Or(i,new r(1).minus(i.times(i)).sqrt(),e+10,0),r.precision=e,r.rounding=t,kt(ed==2||ed==4?i.neg():i,e,t,!0)):new r(NaN)};ke.times=ke.mul=function(e){var t,i,r,n,o,a,s,c,l,d=this,u=d.constructor,h=d.d,p=(e=new u(e)).d;if(e.s*=d.s,!h||!h[0]||!p||!p[0])return new u(!e.s||h&&!h[0]&&!p||p&&!p[0]&&!h?NaN:!h||!p?e.s/0:e.s*0);for(i=Ho(d.e/Gt)+Ho(e.e/Gt),c=h.length,l=p.length,c<l&&(o=h,h=p,p=o,a=c,c=l,l=a),o=[],a=c+l,r=a;r--;)o.push(0);for(r=l;--r>=0;){for(t=0,n=c+r;n>r;)s=o[n]+p[r]*h[n-r-1]+t,o[n--]=s%Cl|0,t=s/Cl|0;o[n]=(o[n]+t)%Cl|0}for(;!o[--a];)o.pop();return t?++i:o.shift(),e.d=o,e.e=j2(o,i),ii?kt(e,u.precision,u.rounding):e};ke.toBinary=function(e,t){return rk(this,2,e,t)};ke.toDecimalPlaces=ke.toDP=function(e,t){var i=this,r=i.constructor;return i=new r(i),e===void 0?i:(Ua(e,0,Cu),t===void 0?t=r.rounding:Ua(t,0,8),kt(i,e+i.e+1,t))};ke.toExponential=function(e,t){var i,r=this,n=r.constructor;return e===void 0?i=oc(r,!0):(Ua(e,0,Cu),t===void 0?t=n.rounding:Ua(t,0,8),r=kt(new n(r),e+1,t),i=oc(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+i:i};ke.toFixed=function(e,t){var i,r,n=this,o=n.constructor;return e===void 0?i=oc(n):(Ua(e,0,Cu),t===void 0?t=o.rounding:Ua(t,0,8),r=kt(new o(n),e+n.e+1,t),i=oc(r,!1,e+r.e+1)),n.isNeg()&&!n.isZero()?"-"+i:i};ke.toFraction=function(e){var t,i,r,n,o,a,s,c,l,d,u,h,p=this,m=p.d,f=p.constructor;if(!m)return new f(p);if(l=i=new f(1),r=c=new f(0),t=new f(r),o=t.e=bG(m)-p.e-1,a=o%Gt,t.d[0]=jn(10,a<0?Gt+a:a),e==null)e=o>0?t:l;else{if(s=new f(e),!s.isInt()||s.lt(l))throw Error(Eu+s);e=s.gt(t)?o>0?t:l:s}for(ii=!1,s=new f(vo(m)),d=f.precision,f.precision=o=m.length*Gt*2;u=Or(s,t,0,1,1),n=i.plus(u.times(r)),n.cmp(e)!=1;)i=r,r=n,n=l,l=c.plus(u.times(n)),c=n,n=t,t=s.minus(u.times(n)),s=n;return n=Or(e.minus(i),r,0,1,1),c=c.plus(n.times(l)),i=i.plus(n.times(r)),c.s=l.s=p.s,h=Or(l,r,o,1).minus(p).abs().cmp(Or(c,i,o,1).minus(p).abs())<1?[l,r]:[c,i],f.precision=d,ii=!0,h};ke.toHexadecimal=ke.toHex=function(e,t){return rk(this,16,e,t)};ke.toNearest=function(e,t){var i=this,r=i.constructor;if(i=new r(i),e==null){if(!i.d)return i;e=new r(1),t=r.rounding}else{if(e=new r(e),t===void 0?t=r.rounding:Ua(t,0,8),!i.d)return e.s?i:e;if(!e.d)return e.s&&(e.s=i.s),e}return e.d[0]?(ii=!1,i=Or(i,e,0,t,1).times(e),ii=!0,kt(i)):(e.s=i.s,i=e),i};ke.toNumber=function(){return+this};ke.toOctal=function(e,t){return rk(this,8,e,t)};ke.toPower=ke.pow=function(e){var t,i,r,n,o,a,s=this,c=s.constructor,l=+(e=new c(e));if(!s.d||!e.d||!s.d[0]||!e.d[0])return new c(jn(+s,l));if(s=new c(s),s.eq(1))return s;if(r=c.precision,o=c.rounding,e.eq(1))return kt(s,r,o);if(t=Ho(e.e/Gt),t>=e.d.length-1&&(i=l<0?-l:l)<=Jbe)return n=yG(c,s,i,r),e.s<0?new c(1).div(n):kt(n,r,o);if(a=s.s,a<0){if(t<e.d.length-1)return new c(NaN);if(e.d[t]&1||(a=1),s.e==0&&s.d[0]==1&&s.d.length==1)return s.s=a,s}return i=jn(+s,l),t=i==0||!isFinite(i)?Ho(l*(Math.log("0."+vo(s.d))/Math.LN10+s.e+1)):new c(i+"").e,t>c.maxE+1||t<c.minE-1?new c(t>0?a/0:0):(ii=!1,c.rounding=s.s=1,i=Math.min(12,(t+"").length),n=tk(e.times(wu(s,r+i)),r),n.d&&(n=kt(n,r+5,1),b_(n.d,r,o)&&(t=r+10,n=kt(tk(e.times(wu(s,t+i)),t),t+5,1),+vo(n.d).slice(r+1,r+15)+1==1e14&&(n=kt(n,r+1,0)))),n.s=a,ii=!0,c.rounding=o,kt(n,r,o))};ke.toPrecision=function(e,t){var i,r=this,n=r.constructor;return e===void 0?i=oc(r,r.e<=n.toExpNeg||r.e>=n.toExpPos):(Ua(e,1,Cu),t===void 0?t=n.rounding:Ua(t,0,8),r=kt(new n(r),e,t),i=oc(r,e<=r.e||r.e<=n.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+i:i};ke.toSignificantDigits=ke.toSD=function(e,t){var i=this,r=i.constructor;return e===void 0?(e=r.precision,t=r.rounding):(Ua(e,1,Cu),t===void 0?t=r.rounding:Ua(t,0,8)),kt(new r(i),e,t)};ke.toString=function(){var e=this,t=e.constructor,i=oc(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+i:i};ke.truncated=ke.trunc=function(){return kt(new this.constructor(this),this.e+1,1)};ke.valueOf=ke.toJSON=function(){var e=this,t=e.constructor,i=oc(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+i:i};function vo(e){var t,i,r,n=e.length-1,o="",a=e[0];if(n>0){for(o+=a,t=1;t<n;t++)r=e[t]+"",i=Gt-r.length,i&&(o+=xu(i)),o+=r;a=e[t],r=a+"",i=Gt-r.length,i&&(o+=xu(i))}else if(a===0)return"0";for(;a%10===0;)a/=10;return o+a}function Ua(e,t,i){if(e!==~~e||e<t||e>i)throw Error(Eu+e)}function b_(e,t,i,r){var n,o,a,s;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=Gt,n=0):(n=Math.ceil((t+1)/Gt),t%=Gt),o=jn(10,Gt-t),s=e[n]%o|0,r==null?t<3?(t==0?s=s/100|0:t==1&&(s=s/10|0),a=i<4&&s==99999||i>3&&s==49999||s==5e4||s==0):a=(i<4&&s+1==o||i>3&&s+1==o/2)&&(e[n+1]/o/100|0)==jn(10,t-2)-1||(s==o/2||s==0)&&(e[n+1]/o/100|0)==0:t<4?(t==0?s=s/1e3|0:t==1?s=s/100|0:t==2&&(s=s/10|0),a=(r||i<4)&&s==9999||!r&&i>3&&s==4999):a=((r||i<4)&&s+1==o||!r&&i>3&&s+1==o/2)&&(e[n+1]/o/1e3|0)==jn(10,t-3)-1,a}function B2(e,t,i){for(var r,n=[0],o,a=0,s=e.length;a<s;){for(o=n.length;o--;)n[o]*=t;for(n[0]+=QM.indexOf(e.charAt(a++)),r=0;r<n.length;r++)n[r]>i-1&&(n[r+1]===void 0&&(n[r+1]=0),n[r+1]+=n[r]/i|0,n[r]%=i)}return n.reverse()}function tye(e,t){var i,r,n;if(t.isZero())return t;r=t.d.length,r<32?(i=Math.ceil(r/3),n=(1/G2(4,i)).toString()):(i=16,n="2.3283064365386962890625e-10"),e.precision+=i,t=tg(e,1,t.times(n),new e(1));for(var o=i;o--;){var a=t.times(t);t=a.times(a).minus(a).times(8).plus(1)}return e.precision-=i,t}var Or=function(){function e(r,n,o){var a,s=0,c=r.length;for(r=r.slice();c--;)a=r[c]*n+s,r[c]=a%o|0,s=a/o|0;return s&&r.unshift(s),r}function t(r,n,o,a){var s,c;if(o!=a)c=o>a?1:-1;else for(s=c=0;s<o;s++)if(r[s]!=n[s]){c=r[s]>n[s]?1:-1;break}return c}function i(r,n,o,a){for(var s=0;o--;)r[o]-=s,s=r[o]<n[o]?1:0,r[o]=s*a+r[o]-n[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,n,o,a,s,c){var l,d,u,h,p,m,f,g,v,_,b,y,x,w,I,S,E,N,M,P,$=r.constructor,R=r.s==n.s?1:-1,j=r.d,B=n.d;if(!j||!j[0]||!B||!B[0])return new $(!r.s||!n.s||(j?B&&j[0]==B[0]:!B)?NaN:j&&j[0]==0||!B?R*0:R/0);for(c?(p=1,d=r.e-n.e):(c=Cl,p=Gt,d=Ho(r.e/p)-Ho(n.e/p)),M=B.length,E=j.length,v=new $(R),_=v.d=[],u=0;B[u]==(j[u]||0);u++);if(B[u]>(j[u]||0)&&d--,o==null?(w=o=$.precision,a=$.rounding):s?w=o+(r.e-n.e)+1:w=o,w<0)_.push(1),m=!0;else{if(w=w/p+2|0,u=0,M==1){for(h=0,B=B[0],w++;(u<E||h)&&w--;u++)I=h*c+(j[u]||0),_[u]=I/B|0,h=I%B|0;m=h||u<E}else{for(h=c/(B[0]+1)|0,h>1&&(B=e(B,h,c),j=e(j,h,c),M=B.length,E=j.length),S=M,b=j.slice(0,M),y=b.length;y<M;)b[y++]=0;P=B.slice(),P.unshift(0),N=B[0],B[1]>=c/2&&++N;do h=0,l=t(B,b,M,y),l<0?(x=b[0],M!=y&&(x=x*c+(b[1]||0)),h=x/N|0,h>1?(h>=c&&(h=c-1),f=e(B,h,c),g=f.length,y=b.length,l=t(f,b,g,y),l==1&&(h--,i(f,M<g?P:B,g,c))):(h==0&&(l=h=1),f=B.slice()),g=f.length,g<y&&f.unshift(0),i(b,f,y,c),l==-1&&(y=b.length,l=t(B,b,M,y),l<1&&(h++,i(b,M<y?P:B,y,c))),y=b.length):l===0&&(h++,b=[0]),_[u++]=h,l&&b[0]?b[y++]=j[S]||0:(b=[j[S]],y=1);while((S++<E||b[0]!==void 0)&&w--);m=b[0]!==void 0}_[0]||_.shift()}if(p==1)v.e=d,fG=m;else{for(u=1,h=_[0];h>=10;h/=10)u++;v.e=u+d*p-1,kt(v,s?o+v.e+1:o,a,m)}return v}}();function kt(e,t,i,r){var n,o,a,s,c,l,d,u,h,p=e.constructor;e:if(t!=null){if(u=e.d,!u)return e;for(n=1,s=u[0];s>=10;s/=10)n++;if(o=t-n,o<0)o+=Gt,a=t,d=u[h=0],c=d/jn(10,n-a-1)%10|0;else if(h=Math.ceil((o+1)/Gt),s=u.length,h>=s)if(r){for(;s++<=h;)u.push(0);d=c=0,n=1,o%=Gt,a=o-Gt+1}else break e;else{for(d=s=u[h],n=1;s>=10;s/=10)n++;o%=Gt,a=o-Gt+n,c=a<0?0:d/jn(10,n-a-1)%10|0}if(r=r||t<0||u[h+1]!==void 0||(a<0?d:d%jn(10,n-a-1)),l=i<4?(c||r)&&(i==0||i==(e.s<0?3:2)):c>5||c==5&&(i==4||r||i==6&&(o>0?a>0?d/jn(10,n-a):0:u[h-1])%10&1||i==(e.s<0?8:7)),t<1||!u[0])return u.length=0,l?(t-=e.e+1,u[0]=jn(10,(Gt-t%Gt)%Gt),e.e=-t||0):u[0]=e.e=0,e;if(o==0?(u.length=h,s=1,h--):(u.length=h+1,s=jn(10,Gt-o),u[h]=a>0?(d/jn(10,n-a)%jn(10,a)|0)*s:0),l)for(;;)if(h==0){for(o=1,a=u[0];a>=10;a/=10)o++;for(a=u[0]+=s,s=1;a>=10;a/=10)s++;o!=s&&(e.e++,u[0]==Cl&&(u[0]=1));break}else{if(u[h]+=s,u[h]!=Cl)break;u[h--]=0,s=1}for(o=u.length;u[--o]===0;)u.pop()}return ii&&(e.e>p.maxE?(e.d=null,e.e=NaN):e.e<p.minE&&(e.e=0,e.d=[0])),e}function oc(e,t,i){if(!e.isFinite())return wG(e);var r,n=e.e,o=vo(e.d),a=o.length;return t?(i&&(r=i-a)>0?o=o.charAt(0)+"."+o.slice(1)+xu(r):a>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(e.e<0?"e":"e+")+e.e):n<0?(o="0."+xu(-n-1)+o,i&&(r=i-a)>0&&(o+=xu(r))):n>=a?(o+=xu(n+1-a),i&&(r=i-n-1)>0&&(o=o+"."+xu(r))):((r=n+1)<a&&(o=o.slice(0,r)+"."+o.slice(r)),i&&(r=i-a)>0&&(n+1===a&&(o+="."),o+=xu(r))),o}function j2(e,t){var i=e[0];for(t*=Gt;i>=10;i/=10)t++;return t}function U2(e,t,i){if(t>eye)throw ii=!0,i&&(e.precision=i),Error(mG);return kt(new e(V2),t,1,!0)}function El(e,t,i){if(t>ek)throw Error(mG);return kt(new e(z2),t,i,!0)}function bG(e){var t=e.length-1,i=t*Gt+1;if(t=e[t],t){for(;t%10==0;t/=10)i--;for(t=e[0];t>=10;t/=10)i++}return i}function xu(e){for(var t="";e--;)t+="0";return t}function yG(e,t,i,r){var n,o=new e(1),a=Math.ceil(r/Gt+4);for(ii=!1;;){if(i%2&&(o=o.times(t),hG(o.d,a)&&(n=!0)),i=Ho(i/2),i===0){i=o.d.length-1,n&&o.d[i]===0&&++o.d[i];break}t=t.times(t),hG(t.d,a)}return ii=!0,o}function uG(e){return e.d[e.d.length-1]&1}function xG(e,t,i){for(var r,n=new e(t[0]),o=0;++o<t.length;)if(r=new e(t[o]),r.s)n[i](r)&&(n=r);else{n=r;break}return n}function tk(e,t){var i,r,n,o,a,s,c,l=0,d=0,u=0,h=e.constructor,p=h.rounding,m=h.precision;if(!e.d||!e.d[0]||e.e>17)return new h(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(t==null?(ii=!1,c=m):c=t,s=new h(.03125);e.e>-2;)e=e.times(s),u+=5;for(r=Math.log(jn(2,u))/Math.LN10*2+5|0,c+=r,i=o=a=new h(1),h.precision=c;;){if(o=kt(o.times(e),c,1),i=i.times(++d),s=a.plus(Or(o,i,c,1)),vo(s.d).slice(0,c)===vo(a.d).slice(0,c)){for(n=u;n--;)a=kt(a.times(a),c,1);if(t==null)if(l<3&&b_(a.d,c-r,p,l))h.precision=c+=10,i=o=s=new h(1),d=0,l++;else return kt(a,h.precision=m,p,ii=!0);else return h.precision=m,a}a=s}}function wu(e,t){var i,r,n,o,a,s,c,l,d,u,h,p=1,m=10,f=e,g=f.d,v=f.constructor,_=v.rounding,b=v.precision;if(f.s<0||!g||!g[0]||!f.e&&g[0]==1&&g.length==1)return new v(g&&!g[0]?-1/0:f.s!=1?NaN:g?0:f);if(t==null?(ii=!1,d=b):d=t,v.precision=d+=m,i=vo(g),r=i.charAt(0),Math.abs(o=f.e)<15e14){for(;r<7&&r!=1||r==1&&i.charAt(1)>3;)f=f.times(e),i=vo(f.d),r=i.charAt(0),p++;o=f.e,r>1?(f=new v("0."+i),o++):f=new v(r+"."+i.slice(1))}else return l=U2(v,d+2,b).times(o+""),f=wu(new v(r+"."+i.slice(1)),d-m).plus(l),v.precision=b,t==null?kt(f,b,_,ii=!0):f;for(u=f,c=a=f=Or(f.minus(1),f.plus(1),d,1),h=kt(f.times(f),d,1),n=3;;){if(a=kt(a.times(h),d,1),l=c.plus(Or(a,new v(n),d,1)),vo(l.d).slice(0,d)===vo(c.d).slice(0,d))if(c=c.times(2),o!==0&&(c=c.plus(U2(v,d+2,b).times(o+""))),c=Or(c,new v(p),d,1),t==null)if(b_(c.d,d-m,_,s))v.precision=d+=m,l=a=f=Or(u.minus(1),u.plus(1),d,1),h=kt(f.times(f),d,1),n=s=1;else return kt(c,v.precision=b,_,ii=!0);else return v.precision=b,c;c=l,n+=2}}function wG(e){return String(e.s*e.s/0)}function ik(e,t){var i,r,n;for((i=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(i<0&&(i=r),i+=+t.slice(r+1),t=t.substring(0,r)):i<0&&(i=t.length),r=0;t.charCodeAt(r)===48;r++);for(n=t.length;t.charCodeAt(n-1)===48;--n);if(t=t.slice(r,n),t){if(n-=r,e.e=i=i-r-1,e.d=[],r=(i+1)%Gt,i<0&&(r+=Gt),r<n){for(r&&e.d.push(+t.slice(0,r)),n-=Gt;r<n;)e.d.push(+t.slice(r,r+=Gt));t=t.slice(r),r=Gt-t.length}else r-=n;for(;r--;)t+="0";e.d.push(+t),ii&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function iye(e,t){var i,r,n,o,a,s,c,l,d;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),_G.test(t))return ik(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(Kbe.test(t))i=16,t=t.toLowerCase();else if(Zbe.test(t))i=2;else if(Qbe.test(t))i=8;else throw Error(Eu+t);for(o=t.search(/p/i),o>0?(c=+t.slice(o+1),t=t.substring(2,o)):t=t.slice(2),o=t.indexOf("."),a=o>=0,r=e.constructor,a&&(t=t.replace(".",""),s=t.length,o=s-o,n=yG(r,new r(i),o,o*2)),l=B2(t,i,Cl),d=l.length-1,o=d;l[o]===0;--o)l.pop();return o<0?new r(e.s*0):(e.e=j2(l,d),e.d=l,ii=!1,a&&(e=Or(e,n,s*4)),c&&(e=e.times(Math.abs(c)<54?jn(2,c):y_.pow(2,c))),ii=!0,e)}function rye(e,t){var i,r=t.d.length;if(r<3)return t.isZero()?t:tg(e,2,t,t);i=1.4*Math.sqrt(r),i=i>16?16:i|0,t=t.times(1/G2(5,i)),t=tg(e,2,t,t);for(var n,o=new e(5),a=new e(16),s=new e(20);i--;)n=t.times(t),t=t.times(o.plus(n.times(a.times(n).minus(s))));return t}function tg(e,t,i,r,n){var o,a,s,c,l=1,d=e.precision,u=Math.ceil(d/Gt);for(ii=!1,c=i.times(i),s=new e(r);;){if(a=Or(s.times(c),new e(t++*t++),d,1),s=n?r.plus(a):r.minus(a),r=Or(a.times(c),new e(t++*t++),d,1),a=s.plus(r),a.d[u]!==void 0){for(o=u;a.d[o]===s.d[o]&&o--;);if(o==-1)break}o=s,s=r,r=a,a=o,l++}return ii=!0,a.d.length=u+1,a}function G2(e,t){for(var i=e;--t;)i*=e;return i}function EG(e,t){var i,r=t.s<0,n=El(e,e.precision,1),o=n.times(.5);if(t=t.abs(),t.lte(o))return ed=r?4:1,t;if(i=t.divToInt(n),i.isZero())ed=r?3:2;else{if(t=t.minus(i.times(n)),t.lte(o))return ed=uG(i)?r?2:3:r?4:1,t;ed=uG(i)?r?1:4:r?3:2}return t.minus(n).abs()}function rk(e,t,i,r){var n,o,a,s,c,l,d,u,h,p=e.constructor,m=i!==void 0;if(m?(Ua(i,1,Cu),r===void 0?r=p.rounding:Ua(r,0,8)):(i=p.precision,r=p.rounding),!e.isFinite())d=wG(e);else{for(d=oc(e),a=d.indexOf("."),m?(n=2,t==16?i=i*4-3:t==8&&(i=i*3-2)):n=t,a>=0&&(d=d.replace(".",""),h=new p(1),h.e=d.length-a,h.d=B2(oc(h),10,n),h.e=h.d.length),u=B2(d,10,n),o=c=u.length;u[--c]==0;)u.pop();if(!u[0])d=m?"0p+0":"0";else{if(a<0?o--:(e=new p(e),e.d=u,e.e=o,e=Or(e,h,i,r,0,n),u=e.d,o=e.e,l=fG),a=u[i],s=n/2,l=l||u[i+1]!==void 0,l=r<4?(a!==void 0||l)&&(r===0||r===(e.s<0?3:2)):a>s||a===s&&(r===4||l||r===6&&u[i-1]&1||r===(e.s<0?8:7)),u.length=i,l)for(;++u[--i]>n-1;)u[i]=0,i||(++o,u.unshift(1));for(c=u.length;!u[c-1];--c);for(a=0,d="";a<c;a++)d+=QM.charAt(u[a]);if(m){if(c>1)if(t==16||t==8){for(a=t==16?4:3,--c;c%a;c++)d+="0";for(u=B2(d,n,t),c=u.length;!u[c-1];--c);for(a=1,d="1.";a<c;a++)d+=QM.charAt(u[a])}else d=d.charAt(0)+"."+d.slice(1);d=d+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)d="0"+d;d="0."+d}else if(++o>c)for(o-=c;o--;)d+="0";else o<c&&(d=d.slice(0,o)+"."+d.slice(o))}d=(t==16?"0x":t==2?"0b":t==8?"0o":"")+d}return e.s<0?"-"+d:d}function hG(e,t){if(e.length>t)return e.length=t,!0}function nye(e){return new this(e).abs()}function oye(e){return new this(e).acos()}function aye(e){return new this(e).acosh()}function sye(e,t){return new this(e).plus(t)}function lye(e){return new this(e).asin()}function cye(e){return new this(e).asinh()}function dye(e){return new this(e).atan()}function uye(e){return new this(e).atanh()}function hye(e,t){e=new this(e),t=new this(t);var i,r=this.precision,n=this.rounding,o=r+4;return!e.s||!t.s?i=new this(NaN):!e.d&&!t.d?(i=El(this,o,1).times(t.s>0?.25:.75),i.s=e.s):!t.d||e.isZero()?(i=t.s<0?El(this,r,n):new this(0),i.s=e.s):!e.d||t.isZero()?(i=El(this,o,1).times(.5),i.s=e.s):t.s<0?(this.precision=o,this.rounding=1,i=this.atan(Or(e,t,o,1)),t=El(this,o,1),this.precision=r,this.rounding=n,i=e.s<0?i.minus(t):i.plus(t)):i=this.atan(Or(e,t,o,1)),i}function pye(e){return new this(e).cbrt()}function fye(e){return kt(e=new this(e),e.e+1,2)}function mye(e,t,i){return new this(e).clamp(t,i)}function gye(e){if(!e||typeof e!="object")throw Error(H2+"Object expected");var t,i,r,n=e.defaults===!0,o=["precision",1,Cu,"rounding",0,8,"toExpNeg",-eg,0,"toExpPos",0,eg,"maxE",0,eg,"minE",-eg,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(i=o[t],n&&(this[i]=JM[i]),(r=e[i])!==void 0)if(Ho(r)===r&&r>=o[t+1]&&r<=o[t+2])this[i]=r;else throw Error(Eu+i+": "+r);if(i="crypto",n&&(this[i]=JM[i]),(r=e[i])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[i]=!0;else throw Error(gG);else this[i]=!1;else throw Error(Eu+i+": "+r);return this}function vye(e){return new this(e).cos()}function _ye(e){return new this(e).cosh()}function CG(e){var t,i,r;function n(o){var a,s,c,l=this;if(!(l instanceof n))return new n(o);if(l.constructor=n,pG(o)){l.s=o.s,ii?!o.d||o.e>n.maxE?(l.e=NaN,l.d=null):o.e<n.minE?(l.e=0,l.d=[0]):(l.e=o.e,l.d=o.d.slice()):(l.e=o.e,l.d=o.d?o.d.slice():o.d);return}if(c=typeof o,c==="number"){if(o===0){l.s=1/o<0?-1:1,l.e=0,l.d=[0];return}if(o<0?(o=-o,l.s=-1):l.s=1,o===~~o&&o<1e7){for(a=0,s=o;s>=10;s/=10)a++;ii?a>n.maxE?(l.e=NaN,l.d=null):a<n.minE?(l.e=0,l.d=[0]):(l.e=a,l.d=[o]):(l.e=a,l.d=[o]);return}else if(o*0!==0){o||(l.s=NaN),l.e=NaN,l.d=null;return}return ik(l,o.toString())}else if(c!=="string")throw Error(Eu+o);return(s=o.charCodeAt(0))===45?(o=o.slice(1),l.s=-1):(s===43&&(o=o.slice(1)),l.s=1),_G.test(o)?ik(l,o):iye(l,o)}if(n.prototype=ke,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.EUCLID=9,n.config=n.set=gye,n.clone=CG,n.isDecimal=pG,n.abs=nye,n.acos=oye,n.acosh=aye,n.add=sye,n.asin=lye,n.asinh=cye,n.atan=dye,n.atanh=uye,n.atan2=hye,n.cbrt=pye,n.ceil=fye,n.clamp=mye,n.cos=vye,n.cosh=_ye,n.div=bye,n.exp=yye,n.floor=xye,n.hypot=wye,n.ln=Eye,n.log=Cye,n.log10=Tye,n.log2=Sye,n.max=Aye,n.min=Dye,n.mod=Iye,n.mul=Mye,n.pow=kye,n.random=Pye,n.round=Nye,n.sign=Oye,n.sin=Rye,n.sinh=Fye,n.sqrt=Lye,n.sub=Bye,n.sum=Vye,n.tan=zye,n.tanh=Uye,n.trunc=Hye,e===void 0&&(e={}),e&&e.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<r.length;)e.hasOwnProperty(i=r[t++])||(e[i]=this[i]);return n.config(e),n}function bye(e,t){return new this(e).div(t)}function yye(e){return new this(e).exp()}function xye(e){return kt(e=new this(e),e.e+1,3)}function wye(){var e,t,i=new this(0);for(ii=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)i.d&&(i=i.plus(t.times(t)));else{if(t.s)return ii=!0,new this(1/0);i=t}return ii=!0,i.sqrt()}function pG(e){return e instanceof y_||e&&e.toStringTag===vG||!1}function Eye(e){return new this(e).ln()}function Cye(e,t){return new this(e).log(t)}function Sye(e){return new this(e).log(2)}function Tye(e){return new this(e).log(10)}function Aye(){return xG(this,arguments,"lt")}function Dye(){return xG(this,arguments,"gt")}function Iye(e,t){return new this(e).mod(t)}function Mye(e,t){return new this(e).mul(t)}function kye(e,t){return new this(e).pow(t)}function Pye(e){var t,i,r,n,o=0,a=new this(1),s=[];if(e===void 0?e=this.precision:Ua(e,1,Cu),r=Math.ceil(e/Gt),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));o<r;)n=t[o],n>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:s[o++]=n%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(r*=4);o<r;)n=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((t[o+3]&127)<<24),n>=214e7?crypto.randomBytes(4).copy(t,o):(s.push(n%1e7),o+=4);o=r/4}else throw Error(gG);else for(;o<r;)s[o++]=Math.random()*1e7|0;for(r=s[--o],e%=Gt,r&&e&&(n=jn(10,Gt-e),s[o]=(r/n|0)*n);s[o]===0;o--)s.pop();if(o<0)i=0,s=[0];else{for(i=-1;s[0]===0;i-=Gt)s.shift();for(r=1,n=s[0];n>=10;n/=10)r++;r<Gt&&(i-=Gt-r)}return a.e=i,a.d=s,a}function Nye(e){return kt(e=new this(e),e.e+1,this.rounding)}function Oye(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function Rye(e){return new this(e).sin()}function Fye(e){return new this(e).sinh()}function Lye(e){return new this(e).sqrt()}function Bye(e,t){return new this(e).sub(t)}function Vye(){var e=0,t=arguments,i=new this(t[e]);for(ii=!1;i.s&&++e<t.length;)i=i.plus(t[e]);return ii=!0,kt(i,this.precision,this.rounding)}function zye(e){return new this(e).tan()}function Uye(e){return new this(e).tanh()}function Hye(e){return kt(e=new this(e),e.e+1,1)}ke[Symbol.for("nodejs.util.inspect.custom")]=ke.toString;ke[Symbol.toStringTag]="Decimal";var y_=ke.constructor=CG(JM);V2=new y_(V2);z2=new y_(z2);var nk=y_;var jye="BigNumber",Gye=["?on","config"],ok=le(jye,Gye,e=>{var{on:t,config:i}=e,r=nk.clone({precision:i.precision,modulo:nk.EUCLID});return r.prototype=Object.create(r.prototype),r.prototype.type="BigNumber",r.prototype.isBigNumber=!0,r.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},r.fromJSON=function(n){return new r(n.value)},t&&t("config",function(n,o){n.precision!==o.precision&&r.config({precision:n.precision})}),r},{isClass:!0});var jo=Math.cosh||function(e){return Math.abs(e)<1e-9?1-e:(Math.exp(e)+Math.exp(-e))*.5},Ks=Math.sinh||function(e){return Math.abs(e)<1e-9?e:(Math.exp(e)-Math.exp(-e))*.5},$ye=function(e){var t=Math.PI/4;if(-t>e||e>t)return Math.cos(e)-1;var i=e*e;return i*(i*(i*(i*(i*(i*(i*(i/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},Wye=function(e,t){var i=Math.abs(e),r=Math.abs(t);return i<3e3&&r<3e3?Math.sqrt(i*i+r*r):(i<r?(i=r,r=e/t):r=t/e,i*Math.sqrt(1+r*r))},ig=function(){throw SyntaxError("Invalid Param")};function ak(e,t){var i=Math.abs(e),r=Math.abs(t);return e===0?Math.log(r):t===0?Math.log(i):i<3e3&&r<3e3?Math.log(e*e+t*t)*.5:(e=e/2,t=t/2,.5*Math.log(e*e+t*t)+Math.LN2)}var qye=function(e,t){var i={re:0,im:0};if(e==null)i.re=i.im=0;else if(t!==void 0)i.re=e,i.im=t;else switch(typeof e){case"object":if("im"in e&&"re"in e)i.re=e.re,i.im=e.im;else if("abs"in e&&"arg"in e){if(!Number.isFinite(e.abs)&&Number.isFinite(e.arg))return ge.INFINITY;i.re=e.abs*Math.cos(e.arg),i.im=e.abs*Math.sin(e.arg)}else if("r"in e&&"phi"in e){if(!Number.isFinite(e.r)&&Number.isFinite(e.phi))return ge.INFINITY;i.re=e.r*Math.cos(e.phi),i.im=e.r*Math.sin(e.phi)}else e.length===2?(i.re=e[0],i.im=e[1]):ig();break;case"string":i.im=i.re=0;var r=e.replace(/_/g,"").match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),n=1,o=0;r===null&&ig();for(var a=0;a<r.length;a++){var s=r[a];s===" "||s==="	"||s===`
`||(s==="+"?n++:s==="-"?o++:s==="i"||s==="I"?(n+o===0&&ig(),r[a+1]!==" "&&!isNaN(r[a+1])?(i.im+=parseFloat((o%2?"-":"")+r[a+1]),a++):i.im+=parseFloat((o%2?"-":"")+"1"),n=o=0):((n+o===0||isNaN(s))&&ig(),r[a+1]==="i"||r[a+1]==="I"?(i.im+=parseFloat((o%2?"-":"")+s),a++):i.re+=parseFloat((o%2?"-":"")+s),n=o=0))}n+o>0&&ig();break;case"number":i.im=0,i.re=e;break;default:ig()}return isNaN(i.re)||isNaN(i.im),i};function ge(e,t){if(!(this instanceof ge))return new ge(e,t);var i=qye(e,t);this.re=i.re,this.im=i.im}ge.prototype={re:0,im:0,sign:function(){var e=this.abs();return new ge(this.re/e,this.im/e)},add:function(e,t){var i=new ge(e,t);return this.isInfinite()&&i.isInfinite()?ge.NAN:this.isInfinite()||i.isInfinite()?ge.INFINITY:new ge(this.re+i.re,this.im+i.im)},sub:function(e,t){var i=new ge(e,t);return this.isInfinite()&&i.isInfinite()?ge.NAN:this.isInfinite()||i.isInfinite()?ge.INFINITY:new ge(this.re-i.re,this.im-i.im)},mul:function(e,t){var i=new ge(e,t);return this.isInfinite()&&i.isZero()||this.isZero()&&i.isInfinite()?ge.NAN:this.isInfinite()||i.isInfinite()?ge.INFINITY:i.im===0&&this.im===0?new ge(this.re*i.re,0):new ge(this.re*i.re-this.im*i.im,this.re*i.im+this.im*i.re)},div:function(e,t){var i=new ge(e,t);if(this.isZero()&&i.isZero()||this.isInfinite()&&i.isInfinite())return ge.NAN;if(this.isInfinite()||i.isZero())return ge.INFINITY;if(this.isZero()||i.isInfinite())return ge.ZERO;e=this.re,t=this.im;var r=i.re,n=i.im,o,a;return n===0?new ge(e/r,t/r):Math.abs(r)<Math.abs(n)?(a=r/n,o=r*a+n,new ge((e*a+t)/o,(t*a-e)/o)):(a=n/r,o=n*a+r,new ge((e+t*a)/o,(t-e*a)/o))},pow:function(e,t){var i=new ge(e,t);if(e=this.re,t=this.im,i.isZero())return ge.ONE;if(i.im===0){if(t===0&&e>0)return new ge(Math.pow(e,i.re),0);if(e===0)switch((i.re%4+4)%4){case 0:return new ge(Math.pow(t,i.re),0);case 1:return new ge(0,Math.pow(t,i.re));case 2:return new ge(-Math.pow(t,i.re),0);case 3:return new ge(0,-Math.pow(t,i.re))}}if(e===0&&t===0&&i.re>0&&i.im>=0)return ge.ZERO;var r=Math.atan2(t,e),n=ak(e,t);return e=Math.exp(i.re*n-i.im*r),t=i.im*n+i.re*r,new ge(e*Math.cos(t),e*Math.sin(t))},sqrt:function(){var e=this.re,t=this.im,i=this.abs(),r,n;if(e>=0){if(t===0)return new ge(Math.sqrt(e),0);r=.5*Math.sqrt(2*(i+e))}else r=Math.abs(t)/Math.sqrt(2*(i-e));return e<=0?n=.5*Math.sqrt(2*(i-e)):n=Math.abs(t)/Math.sqrt(2*(i+e)),new ge(r,t<0?-n:n)},exp:function(){var e=Math.exp(this.re);return this.im,new ge(e*Math.cos(this.im),e*Math.sin(this.im))},expm1:function(){var e=this.re,t=this.im;return new ge(Math.expm1(e)*Math.cos(t)+$ye(t),Math.exp(e)*Math.sin(t))},log:function(){var e=this.re,t=this.im;return t===0&&e>0,new ge(ak(e,t),Math.atan2(t,e))},abs:function(){return Wye(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var e=this.re,t=this.im;return new ge(Math.sin(e)*jo(t),Math.cos(e)*Ks(t))},cos:function(){var e=this.re,t=this.im;return new ge(Math.cos(e)*jo(t),-Math.sin(e)*Ks(t))},tan:function(){var e=2*this.re,t=2*this.im,i=Math.cos(e)+jo(t);return new ge(Math.sin(e)/i,Ks(t)/i)},cot:function(){var e=2*this.re,t=2*this.im,i=Math.cos(e)-jo(t);return new ge(-Math.sin(e)/i,Ks(t)/i)},sec:function(){var e=this.re,t=this.im,i=.5*jo(2*t)+.5*Math.cos(2*e);return new ge(Math.cos(e)*jo(t)/i,Math.sin(e)*Ks(t)/i)},csc:function(){var e=this.re,t=this.im,i=.5*jo(2*t)-.5*Math.cos(2*e);return new ge(Math.sin(e)*jo(t)/i,-Math.cos(e)*Ks(t)/i)},asin:function(){var e=this.re,t=this.im,i=new ge(t*t-e*e+1,-2*e*t).sqrt(),r=new ge(i.re-t,i.im+e).log();return new ge(r.im,-r.re)},acos:function(){var e=this.re,t=this.im,i=new ge(t*t-e*e+1,-2*e*t).sqrt(),r=new ge(i.re-t,i.im+e).log();return new ge(Math.PI/2-r.im,r.re)},atan:function(){var e=this.re,t=this.im;if(e===0){if(t===1)return new ge(0,1/0);if(t===-1)return new ge(0,-1/0)}var i=e*e+(1-t)*(1-t),r=new ge((1-t*t-e*e)/i,-2*e/i).log();return new ge(-.5*r.im,.5*r.re)},acot:function(){var e=this.re,t=this.im;if(t===0)return new ge(Math.atan2(1,e),0);var i=e*e+t*t;return i!==0?new ge(e/i,-t/i).atan():new ge(e!==0?e/0:0,t!==0?-t/0:0).atan()},asec:function(){var e=this.re,t=this.im;if(e===0&&t===0)return new ge(0,1/0);var i=e*e+t*t;return i!==0?new ge(e/i,-t/i).acos():new ge(e!==0?e/0:0,t!==0?-t/0:0).acos()},acsc:function(){var e=this.re,t=this.im;if(e===0&&t===0)return new ge(Math.PI/2,1/0);var i=e*e+t*t;return i!==0?new ge(e/i,-t/i).asin():new ge(e!==0?e/0:0,t!==0?-t/0:0).asin()},sinh:function(){var e=this.re,t=this.im;return new ge(Ks(e)*Math.cos(t),jo(e)*Math.sin(t))},cosh:function(){var e=this.re,t=this.im;return new ge(jo(e)*Math.cos(t),Ks(e)*Math.sin(t))},tanh:function(){var e=2*this.re,t=2*this.im,i=jo(e)+Math.cos(t);return new ge(Ks(e)/i,Math.sin(t)/i)},coth:function(){var e=2*this.re,t=2*this.im,i=jo(e)-Math.cos(t);return new ge(Ks(e)/i,-Math.sin(t)/i)},csch:function(){var e=this.re,t=this.im,i=Math.cos(2*t)-jo(2*e);return new ge(-2*Ks(e)*Math.cos(t)/i,2*jo(e)*Math.sin(t)/i)},sech:function(){var e=this.re,t=this.im,i=Math.cos(2*t)+jo(2*e);return new ge(2*jo(e)*Math.cos(t)/i,-2*Ks(e)*Math.sin(t)/i)},asinh:function(){var e=this.im;this.im=-this.re,this.re=e;var t=this.asin();return this.re=-this.im,this.im=e,e=t.re,t.re=-t.im,t.im=e,t},acosh:function(){var e=this.acos();if(e.im<=0){var t=e.re;e.re=-e.im,e.im=t}else{var t=e.im;e.im=-e.re,e.re=t}return e},atanh:function(){var e=this.re,t=this.im,i=e>1&&t===0,r=1-e,n=1+e,o=r*r+t*t,a=o!==0?new ge((n*r-t*t)/o,(t*r+n*t)/o):new ge(e!==-1?e/0:0,t!==0?t/0:0),s=a.re;return a.re=ak(a.re,a.im)/2,a.im=Math.atan2(a.im,s)/2,i&&(a.im=-a.im),a},acoth:function(){var e=this.re,t=this.im;if(e===0&&t===0)return new ge(0,Math.PI/2);var i=e*e+t*t;return i!==0?new ge(e/i,-t/i).atanh():new ge(e!==0?e/0:0,t!==0?-t/0:0).atanh()},acsch:function(){var e=this.re,t=this.im;if(t===0)return new ge(e!==0?Math.log(e+Math.sqrt(e*e+1)):1/0,0);var i=e*e+t*t;return i!==0?new ge(e/i,-t/i).asinh():new ge(e!==0?e/0:0,t!==0?-t/0:0).asinh()},asech:function(){var e=this.re,t=this.im;if(this.isZero())return ge.INFINITY;var i=e*e+t*t;return i!==0?new ge(e/i,-t/i).acosh():new ge(e!==0?e/0:0,t!==0?-t/0:0).acosh()},inverse:function(){if(this.isZero())return ge.INFINITY;if(this.isInfinite())return ge.ZERO;var e=this.re,t=this.im,i=e*e+t*t;return new ge(e/i,-t/i)},conjugate:function(){return new ge(this.re,-this.im)},neg:function(){return new ge(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new ge(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new ge(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new ge(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,t){var i=new ge(e,t);return Math.abs(i.re-this.re)<=ge.EPSILON&&Math.abs(i.im-this.im)<=ge.EPSILON},clone:function(){return new ge(this.re,this.im)},toString:function(){var e=this.re,t=this.im,i="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(e)<ge.EPSILON&&(e=0),Math.abs(t)<ge.EPSILON&&(t=0),t===0?i+e:(e!==0?(i+=e,i+=" ",t<0?(t=-t,i+="-"):i+="+",i+=" "):t<0&&(t=-t,i+="-"),t!==1&&(i+=t),i+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}};ge.ZERO=new ge(0,0);ge.ONE=new ge(1,0);ge.I=new ge(0,1);ge.PI=new ge(Math.PI,0);ge.E=new ge(Math.E,0);ge.INFINITY=new ge(1/0,1/0);ge.NAN=new ge(NaN,NaN);ge.EPSILON=1e-15;var Xye="Complex",Yye=[],sk=le(Xye,Yye,()=>(Object.defineProperty(ge,"name",{value:"Complex"}),ge.prototype.constructor=ge,ge.prototype.type="Complex",ge.prototype.isComplex=!0,ge.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},ge.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},ge.prototype.format=function(e){var t="",i=this.im,r=this.re,n=__(this.re,e),o=__(this.im,e),a=Vi(e)?e:e?e.precision:null;if(a!==null){var s=Math.pow(10,-a);Math.abs(r/i)<s&&(r=0),Math.abs(i/r)<s&&(i=0)}return i===0?t=n:r===0?i===1?t="i":i===-1?t="-i":t=o+"i":i<0?i===-1?t=n+" - i":t=n+" - "+o.substring(1)+"i":i===1?t=n+" + i":t=n+" + "+o+"i",t},ge.fromPolar=function(e){switch(arguments.length){case 1:{var t=arguments[0];if(typeof t=="object")return ge(t);throw new TypeError("Input has to be an object with r and phi keys.")}case 2:{var i=arguments[0],r=arguments[1];if(Vi(i)){if(I2(r)&&r.hasBase("ANGLE")&&(r=r.toNumber("rad")),Vi(r))return new ge({r:i,phi:r});throw new TypeError("Phi is not a number nor an angle unit.")}else throw new TypeError("Radius r is not a number.")}default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},ge.prototype.valueOf=ge.prototype.toString,ge.fromJSON=function(e){return new ge(e)},ge.compare=function(e,t){return e.re>t.re?1:e.re<t.re?-1:e.im>t.im?1:e.im<t.im?-1:0},ge),{isClass:!0});var Zye=2e3,Tt={s:1,n:0,d:1};function td(e,t){if(isNaN(e=parseInt(e,10)))throw $2();return e*t}function cn(e,t){if(t===0)throw lk();var i=Object.create(co.prototype);i.s=e<0?-1:1,e=e<0?-e:e;var r=rg(e,t);return i.n=e/r,i.d=t/r,i}function SG(e){for(var t={},i=e,r=2,n=4;n<=i;){for(;i%r===0;)i/=r,t[r]=(t[r]||0)+1;n+=1+2*r++}return i!==e?i>1&&(t[i]=(t[i]||0)+1):t[e]=(t[e]||0)+1,t}var ps=function(e,t){var i=0,r=1,n=1,o=0,a=0,s=0,c=1,l=1,d=0,u=1,h=1,p=1,m=1e7,f;if(e!=null)if(t!==void 0){if(i=e,r=t,n=i*r,i%1!==0||r%1!==0)throw exe()}else switch(typeof e){case"object":{if("d"in e&&"n"in e)i=e.n,r=e.d,"s"in e&&(i*=e.s);else if(0 in e)i=e[0],1 in e&&(r=e[1]);else throw $2();n=i*r;break}case"number":{if(e<0&&(n=e,e=-e),e%1===0)i=e;else if(e>0){for(e>=1&&(l=Math.pow(10,Math.floor(1+Math.log(e)/Math.LN10)),e/=l);u<=m&&p<=m;)if(f=(d+h)/(u+p),e===f){u+p<=m?(i=d+h,r=u+p):p>u?(i=h,r=p):(i=d,r=u);break}else e>f?(d+=h,u+=p):(h+=d,p+=u),u>m?(i=h,r=p):(i=d,r=u);i*=l}else(isNaN(e)||isNaN(t))&&(r=i=NaN);break}case"string":{if(u=e.match(/\d+|./g),u===null)throw $2();if(u[d]==="-"?(n=-1,d++):u[d]==="+"&&d++,u.length===d+1?a=td(u[d++],n):u[d+1]==="."||u[d]==="."?(u[d]!=="."&&(o=td(u[d++],n)),d++,(d+1===u.length||u[d+1]==="("&&u[d+3]===")"||u[d+1]==="'"&&u[d+3]==="'")&&(a=td(u[d],n),c=Math.pow(10,u[d].length),d++),(u[d]==="("&&u[d+2]===")"||u[d]==="'"&&u[d+2]==="'")&&(s=td(u[d+1],n),l=Math.pow(10,u[d+1].length)-1,d+=3)):u[d+1]==="/"||u[d+1]===":"?(a=td(u[d],n),c=td(u[d+2],1),d+=3):u[d+3]==="/"&&u[d+1]===" "&&(o=td(u[d],n),a=td(u[d+2],n),c=td(u[d+4],1),d+=5),u.length<=d){r=c*l,n=i=s+r*o+l*a;break}}default:throw $2()}if(r===0)throw lk();Tt.s=n<0?-1:1,Tt.n=Math.abs(i),Tt.d=Math.abs(r)};function Kye(e,t,i){for(var r=1;t>0;e=e*e%i,t>>=1)t&1&&(r=r*e%i);return r}function Qye(e,t){for(;t%2===0;t/=2);for(;t%5===0;t/=5);if(t===1)return 0;for(var i=10%t,r=1;i!==1;r++)if(i=i*10%t,r>Zye)return 0;return r}function Jye(e,t,i){for(var r=1,n=Kye(10,i,t),o=0;o<300;o++){if(r===n)return o;r=r*10%t,n=n*10%t}return 0}function rg(e,t){if(!e)return t;if(!t)return e;for(;;){if(e%=t,!e)return t;if(t%=e,!t)return e}}function co(e,t){if(ps(e,t),this instanceof co)e=rg(Tt.d,Tt.n),this.s=Tt.s,this.n=Tt.n/e,this.d=Tt.d/e;else return cn(Tt.s*Tt.n,Tt.d)}var lk=function(){return new Error("Division by Zero")},$2=function(){return new Error("Invalid argument")},exe=function(){return new Error("Parameters must be integer")};co.prototype={s:1,n:0,d:1,abs:function(){return cn(this.n,this.d)},neg:function(){return cn(-this.s*this.n,this.d)},add:function(e,t){return ps(e,t),cn(this.s*this.n*Tt.d+Tt.s*this.d*Tt.n,this.d*Tt.d)},sub:function(e,t){return ps(e,t),cn(this.s*this.n*Tt.d-Tt.s*this.d*Tt.n,this.d*Tt.d)},mul:function(e,t){return ps(e,t),cn(this.s*Tt.s*this.n*Tt.n,this.d*Tt.d)},div:function(e,t){return ps(e,t),cn(this.s*Tt.s*this.n*Tt.d,this.d*Tt.n)},clone:function(){return cn(this.s*this.n,this.d)},mod:function(e,t){if(isNaN(this.n)||isNaN(this.d))return new co(NaN);if(e===void 0)return cn(this.s*this.n%this.d,1);if(ps(e,t),Tt.n===0&&this.d===0)throw lk();return cn(this.s*(Tt.d*this.n)%(Tt.n*this.d),Tt.d*this.d)},gcd:function(e,t){return ps(e,t),cn(rg(Tt.n,this.n)*rg(Tt.d,this.d),Tt.d*this.d)},lcm:function(e,t){return ps(e,t),Tt.n===0&&this.n===0?cn(0,1):cn(Tt.n*this.n,rg(Tt.n,this.n)*rg(Tt.d,this.d))},ceil:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new co(NaN):cn(Math.ceil(e*this.s*this.n/this.d),e)},floor:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new co(NaN):cn(Math.floor(e*this.s*this.n/this.d),e)},round:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new co(NaN):cn(Math.round(e*this.s*this.n/this.d),e)},roundTo:function(e,t){return ps(e,t),cn(this.s*Math.round(this.n*Tt.d/(this.d*Tt.n))*Tt.n,Tt.d)},inverse:function(){return cn(this.s*this.d,this.n)},pow:function(e,t){if(ps(e,t),Tt.d===1)return Tt.s<0?cn(Math.pow(this.s*this.d,Tt.n),Math.pow(this.n,Tt.n)):cn(Math.pow(this.s*this.n,Tt.n),Math.pow(this.d,Tt.n));if(this.s<0)return null;var i=SG(this.n),r=SG(this.d),n=1,o=1;for(var a in i)if(a!=="1"){if(a==="0"){n=0;break}if(i[a]*=Tt.n,i[a]%Tt.d===0)i[a]/=Tt.d;else return null;n*=Math.pow(a,i[a])}for(var a in r)if(a!=="1"){if(r[a]*=Tt.n,r[a]%Tt.d===0)r[a]/=Tt.d;else return null;o*=Math.pow(a,r[a])}return Tt.s<0?cn(o,n):cn(n,o)},equals:function(e,t){return ps(e,t),this.s*this.n*Tt.d===Tt.s*Tt.n*this.d},compare:function(e,t){ps(e,t);var i=this.s*this.n*Tt.d-Tt.s*Tt.n*this.d;return(0<i)-(i<0)},simplify:function(e){if(isNaN(this.n)||isNaN(this.d))return this;e=e||.001;for(var t=this.abs(),i=t.toContinued(),r=1;r<i.length;r++){for(var n=cn(i[r-1],1),o=r-2;o>=0;o--)n=n.inverse().add(i[o]);if(Math.abs(n.sub(t).valueOf())<e)return n.mul(this.s)}return this},divisible:function(e,t){return ps(e,t),!(!(Tt.n*this.d)||this.n*Tt.d%(Tt.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(e){var t,i="",r=this.n,n=this.d;return this.s<0&&(i+="-"),n===1?i+=r:(e&&(t=Math.floor(r/n))>0&&(i+=t,i+=" ",r%=n),i+=r,i+="/",i+=n),i},toLatex:function(e){var t,i="",r=this.n,n=this.d;return this.s<0&&(i+="-"),n===1?i+=r:(e&&(t=Math.floor(r/n))>0&&(i+=t,r%=n),i+="\\frac{",i+=r,i+="}{",i+=n,i+="}"),i},toContinued:function(){var e,t=this.n,i=this.d,r=[];if(isNaN(t)||isNaN(i))return r;do r.push(Math.floor(t/i)),e=t%i,t=i,i=e;while(t!==1);return r},toString:function(e){var t=this.n,i=this.d;if(isNaN(t)||isNaN(i))return"NaN";e=e||15;var r=Qye(t,i),n=Jye(t,i,r),o=this.s<0?"-":"";if(o+=t/i|0,t%=i,t*=10,t&&(o+="."),r){for(var a=n;a--;)o+=t/i|0,t%=i,t*=10;o+="(";for(var a=r;a--;)o+=t/i|0,t%=i,t*=10;o+=")"}else for(var a=e;t&&a--;)o+=t/i|0,t%=i,t*=10;return o}};var txe="Fraction",ixe=[],ck=le(txe,ixe,()=>(Object.defineProperty(co,"name",{value:"Fraction"}),co.prototype.constructor=co,co.prototype.type="Fraction",co.prototype.isFraction=!0,co.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},co.fromJSON=function(e){return new co(e)},co),{isClass:!0});var rxe="Matrix",nxe=[],dk=le(rxe,nxe,()=>{function e(){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator")}return e.prototype.type="Matrix",e.prototype.isMatrix=!0,e.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},e.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},e.prototype.create=function(t,i){throw new Error("Cannot invoke create on a Matrix interface")},e.prototype.subset=function(t,i,r){throw new Error("Cannot invoke subset on a Matrix interface")},e.prototype.get=function(t){throw new Error("Cannot invoke get on a Matrix interface")},e.prototype.set=function(t,i,r){throw new Error("Cannot invoke set on a Matrix interface")},e.prototype.resize=function(t,i){throw new Error("Cannot invoke resize on a Matrix interface")},e.prototype.reshape=function(t,i){throw new Error("Cannot invoke reshape on a Matrix interface")},e.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},e.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},e.prototype.map=function(t,i){throw new Error("Cannot invoke map on a Matrix interface")},e.prototype.forEach=function(t){throw new Error("Cannot invoke forEach on a Matrix interface")},e.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},e.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},e.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},e.prototype.format=function(t){throw new Error("Cannot invoke format on a Matrix interface")},e.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},e},{isClass:!0});function uk(e,t,i){var r=e.constructor,n=new r(2),o="";if(i){if(i<1)throw new Error("size must be in greater than 0");if(!xi(i))throw new Error("size must be an integer");if(e.greaterThan(n.pow(i-1).sub(1))||e.lessThan(n.pow(i-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(i-1,", 2^").concat(i-1,"-1]"));if(!e.isInteger())throw new Error("Value must be an integer");e.lessThan(0)&&(e=e.add(n.pow(i))),o="i".concat(i)}switch(t){case 2:return"".concat(e.toBinary()).concat(o);case 8:return"".concat(e.toOctal()).concat(o);case 16:return"".concat(e.toHexadecimal()).concat(o);default:throw new Error("Base ".concat(t," not supported "))}}function DG(e,t){if(typeof t=="function")return t(e);if(!e.isFinite())return e.isNaN()?"NaN":e.gt(0)?"Infinity":"-Infinity";var{notation:i,precision:r,wordSize:n}=YM(t);switch(i){case"fixed":return axe(e,r);case"exponential":return TG(e,r);case"engineering":return oxe(e,r);case"bin":return uk(e,2,n);case"oct":return uk(e,8,n);case"hex":return uk(e,16,n);case"auto":{var o=AG(t?.lowerExp,-3),a=AG(t?.upperExp,5);if(e.isZero())return"0";var s,c=e.toSignificantDigits(r),l=c.e;return l>=o&&l<a?s=c.toFixed():s=TG(e,r),s.replace(/((\.\d*?)(0+))($|e)/,function(){var d=arguments[2],u=arguments[4];return d!=="."?d+u:u})}default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function oxe(e,t){var i=e.e,r=i%3===0?i:i<0?i-3-i%3:i-i%3,n=e.mul(Math.pow(10,-r)),o=n.toPrecision(t);if(o.includes("e")){var a=e.constructor;o=new a(o).toFixed()}return o+"e"+(i>=0?"+":"")+r.toString()}function TG(e,t){return t!==void 0?e.toExponential(t-1):e.toExponential()}function axe(e,t){return e.toFixed(t)}function AG(e,t){return Vi(e)?e:Gi(e)?e.toNumber():t}function Zi(e,t){var i=sxe(e,t);return t&&typeof t=="object"&&"truncate"in t&&i.length>t.truncate?i.substring(0,t.truncate-3)+"...":i}function sxe(e,t){if(typeof e=="number")return __(e,t);if(Gi(e))return DG(e,t);if(lxe(e))return!t||t.fraction!=="decimal"?e.s*e.n+"/"+e.d:e.toString();if(Array.isArray(e))return kG(e,t);if(go(e))return IG(e);if(typeof e=="function")return e.syntax?String(e.syntax):"function";if(e&&typeof e=="object"){if(typeof e.format=="function")return e.format(t);if(e&&e.toString(t)!=={}.toString())return e.toString(t);var i=Object.keys(e).map(r=>IG(r)+": "+Zi(e[r],t));return"{"+i.join(", ")+"}"}return String(e)}function IG(e){for(var t=String(e),i="",r=0;r<t.length;){var n=t.charAt(r);i+=n in MG?MG[n]:n,r++}return'"'+i+'"'}var MG={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"};function kG(e,t){if(Array.isArray(e)){for(var i="[",r=e.length,n=0;n<r;n++)n!==0&&(i+=", "),i+=kG(e[n],t);return i+="]",i}else return Zi(e,t)}function lxe(e){return e&&typeof e=="object"&&typeof e.s=="number"&&typeof e.n=="number"&&typeof e.d=="number"||!1}function wi(e,t,i){if(!(this instanceof wi))throw new SyntaxError("Constructor must be called with the new operator");this.actual=e,this.expected=t,this.relation=i,this.message="Dimension mismatch ("+(Array.isArray(e)?"["+e.join(", ")+"]":e)+" "+(this.relation||"!=")+" "+(Array.isArray(t)?"["+t.join(", ")+"]":t)+")",this.stack=new Error().stack}wi.prototype=new RangeError;wi.prototype.constructor=RangeError;wi.prototype.name="DimensionError";wi.prototype.isDimensionError=!0;function id(e,t,i){if(!(this instanceof id))throw new SyntaxError("Constructor must be called with the new operator");this.index=e,arguments.length<3?(this.min=0,this.max=t):(this.min=t,this.max=i),this.min!==void 0&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":this.max!==void 0&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=new Error().stack}id.prototype=new RangeError;id.prototype.constructor=RangeError;id.prototype.name="IndexError";id.prototype.isIndexError=!0;function dr(e){for(var t=[];Array.isArray(e);)t.push(e.length),e=e[0];return t}function PG(e,t,i){var r,n=e.length;if(n!==t[i])throw new wi(n,t[i]);if(i<t.length-1){var o=i+1;for(r=0;r<n;r++){var a=e[r];if(!Array.isArray(a))throw new wi(t.length-1,t.length,"<");PG(e[r],t,o)}}else for(r=0;r<n;r++)if(Array.isArray(e[r]))throw new wi(t.length+1,t.length,">")}function pk(e,t){var i=t.length===0;if(i){if(Array.isArray(e))throw new wi(e.length,0)}else PG(e,t,0)}function zr(e,t){if(e!==void 0){if(!Vi(e)||!xi(e))throw new TypeError("Index must be an integer (value: "+e+")");if(e<0||typeof t=="number"&&e>=t)throw new id(e,t)}}function Cp(e,t,i){if(!Array.isArray(t))throw new TypeError("Array expected");if(t.length===0)throw new Error("Resizing to scalar is not supported");t.forEach(function(n){if(!Vi(n)||!xi(n)||n<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Zi(t)+")")}),(Vi(e)||Gi(e))&&(e=[e]);var r=i!==void 0?i:0;return hk(e,t,0,r),e}function hk(e,t,i,r){var n,o,a=e.length,s=t[i],c=Math.min(a,s);if(e.length=s,i<t.length-1){var l=i+1;for(n=0;n<c;n++)o=e[n],Array.isArray(o)||(o=[o],e[n]=o),hk(o,t,l,r);for(n=c;n<s;n++)o=[],e[n]=o,hk(o,t,l,r)}else{for(n=0;n<c;n++)for(;Array.isArray(e[n]);)e[n]=e[n][0];for(n=c;n<s;n++)e[n]=r}}function x_(e,t){var i=q2(e),r=i.length;if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("Array expected");if(t.length===0)throw new wi(0,r,"!=");t=w_(t,r);var n=NG(t);if(r!==n)throw new wi(n,r,"!=");try{return cxe(i,t)}catch(o){throw o instanceof wi?new wi(n,r,"!="):o}}function w_(e,t){var i=NG(e),r=e.slice(),n=-1,o=e.indexOf(n),a=e.indexOf(n,o+1)>=0;if(a)throw new Error("More than one wildcard in sizes");var s=o>=0,c=t%i===0;if(s)if(c)r[o]=-t/i;else throw new Error("Could not replace wildcard, since "+t+" is no multiple of "+-i);return r}function NG(e){return e.reduce((t,i)=>t*i,1)}function cxe(e,t){for(var i=e,r,n=t.length-1;n>0;n--){var o=t[n];r=[];for(var a=i.length/o,s=0;s<a;s++)r.push(i.slice(s*o,(s+1)*o));i=r}return i}function W2(e,t,i,r){var n=r||dr(e);if(i)for(var o=0;o<i;o++)e=[e],n.unshift(1);for(e=OG(e,t,0);n.length<t;)n.push(1);return e}function OG(e,t,i){var r,n;if(Array.isArray(e)){var o=i+1;for(r=0,n=e.length;r<n;r++)e[r]=OG(e[r],t,o)}else for(var a=i;a<t;a++)e=[e];return e}function q2(e){if(!Array.isArray(e))return e;var t=[];return e.forEach(function i(r){Array.isArray(r)?r.forEach(i):t.push(r)}),t}function Sp(e,t){for(var i,r=0,n=0;n<e.length;n++){var o=e[n],a=Array.isArray(o);if(n===0&&a&&(r=o.length),a&&o.length!==r)return;var s=a?Sp(o,t):t(o);if(i===void 0)i=s;else if(i!==s)return"mixed"}return i}function RG(e,t,i,r){if(r<i){if(e.length!==t.length)throw new wi(e.length,t.length);for(var n=[],o=0;o<e.length;o++)n[o]=RG(e[o],t[o],i,r+1);return n}else return e.concat(t)}function fk(){var e=Array.prototype.slice.call(arguments,0,-1),t=Array.prototype.slice.call(arguments,-1);if(e.length===1)return e[0];if(e.length>1)return e.slice(1).reduce(function(i,r){return RG(i,r,t,0)},e[0]);throw new Error("Wrong number of arguments in function concat")}function mk(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];for(var r=t.map(h=>h.length),n=Math.max(...r),o=new Array(n).fill(null),a=0;a<t.length;a++)for(var s=t[a],c=r[a],l=0;l<c;l++){var d=n-c+l;s[l]>o[d]&&(o[d]=s[l])}for(var u=0;u<t.length;u++)FG(t[u],o);return o}function FG(e,t){for(var i=t.length,r=e.length,n=0;n<r;n++){var o=i-r+n;if(e[n]<t[o]&&e[n]>1||e[n]>t[o])throw new Error("shape missmatch: missmatch is found in arg with shape (".concat(e,") not possible to broadcast dimension ").concat(r," with size ").concat(e[n]," to size ").concat(t[o]))}}function E_(e,t){var i=dr(e);if(Zs(i,t))return e;FG(i,t);var r=mk(i,t),n=r.length,o=[...Array(n-i.length).fill(1),...i],a=uxe(e);i.length<n&&(a=x_(a,o),i=dr(a));for(var s=0;s<n;s++)i[s]<r[s]&&(a=dxe(a,r[s],s),i=dr(a));return a}function dxe(e,t,i){return fk(...Array(t).fill(e),i)}function X2(e,t){if(!Array.isArray(e))throw new Error("Array expected");var i=dr(e);if(t.length!==i.length)throw new wi(t.length,i.length);for(var r=0;r<t.length;r++)zr(t[r],i[r]);return t.reduce((n,o)=>n[o],e)}function uxe(e){return nc([],e)}var gk=i3(qM(),1);function ng(e,t,i){if(gk.default.isTypedFunction(e)){var r=(t.isMatrix?t.size():dr(t)).map(()=>0),n=t.isMatrix?t.get(r):X2(t,r),o=Object.keys(e.signatures).length===1,a=hxe(e,n,r,t),s=o?Object.values(e.signatures)[0]:e;return a>=1&&a<=3?function(){for(var c=arguments.length,l=new Array(c),d=0;d<c;d++)l[d]=arguments[d];return LG(s,l.slice(0,a),i,e.name)}:function(){for(var c=arguments.length,l=new Array(c),d=0;d<c;d++)l[d]=arguments[d];return LG(s,l,i,e.name)}}return e}function hxe(e,t,i,r){for(var n=[t,i,r],o=3;o>0;o--){var a=n.slice(0,o);if(gk.default.resolve(e,a)!==null)return o}}function LG(e,t,i,r){try{return e(...t)}catch(n){pxe(n,t,i,r)}}function pxe(e,t,i,r){var n;if(e instanceof TypeError&&((n=e.data)===null||n===void 0?void 0:n.category)==="wrongType"){var o=[];throw o.push("value: ".concat(Hn(t[0]))),t.length>=2&&o.push("index: ".concat(Hn(t[1]))),t.length>=3&&o.push("array: ".concat(Hn(t[2]))),new TypeError("Function ".concat(i," cannot apply callback arguments ")+"".concat(r,"(").concat(o.join(", "),") at index ").concat(JSON.stringify(t[1])))}else throw new TypeError("Function ".concat(i," cannot apply callback arguments ")+"to function ".concat(r,": ").concat(e.message))}var fxe="DenseMatrix",mxe=["Matrix"],vk=le(fxe,mxe,e=>{var{Matrix:t}=e;function i(d,u){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(u&&!go(u))throw new Error("Invalid datatype: "+u);if(Di(d))d.type==="DenseMatrix"?(this._data=hi(d._data),this._size=hi(d._size),this._datatype=u||d._datatype):(this._data=d.toArray(),this._size=d.size(),this._datatype=u||d._datatype);else if(d&&or(d.data)&&or(d.size))this._data=d.data,this._size=d.size,pk(this._data,this._size),this._datatype=u||d.datatype;else if(or(d))this._data=l(d),this._size=dr(this._data),pk(this._data,this._size),this._datatype=u;else{if(d)throw new TypeError("Unsupported type of data ("+Hn(d)+")");this._data=[],this._size=[0],this._datatype=u}}i.prototype=new t,i.prototype.createDenseMatrix=function(d,u){return new i(d,u)},Object.defineProperty(i,"name",{value:"DenseMatrix"}),i.prototype.constructor=i,i.prototype.type="DenseMatrix",i.prototype.isDenseMatrix=!0,i.prototype.getDataType=function(){return Sp(this._data,Hn)},i.prototype.storage=function(){return"dense"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(d,u){return new i(d,u)},i.prototype.subset=function(d,u,h){switch(arguments.length){case 1:return r(this,d);case 2:case 3:return o(this,d,u,h);default:throw new SyntaxError("Wrong number of arguments")}},i.prototype.get=function(d){return X2(this._data,d)},i.prototype.set=function(d,u,h){if(!or(d))throw new TypeError("Array expected");if(d.length<this._size.length)throw new wi(d.length,this._size.length,"<");var p,m,f,g=d.map(function(_){return _+1});c(this,g,h);var v=this._data;for(p=0,m=d.length-1;p<m;p++)f=d[p],zr(f,v.length),v=v[f];return f=d[d.length-1],zr(f,v.length),v[f]=u,this};function r(d,u){if(!Km(u))throw new TypeError("Invalid index");var h=u.isScalar();if(h)return d.get(u.min());var p=u.size();if(p.length!==d._size.length)throw new wi(p.length,d._size.length);for(var m=u.min(),f=u.max(),g=0,v=d._size.length;g<v;g++)zr(m[g],d._size[g]),zr(f[g],d._size[g]);return new i(n(d._data,u,p.length,0),d._datatype)}function n(d,u,h,p){var m=p===h-1,f=u.dimension(p);return m?f.map(function(g){return zr(g,d.length),d[g]}).valueOf():f.map(function(g){zr(g,d.length);var v=d[g];return n(v,u,h,p+1)}).valueOf()}function o(d,u,h,p){if(!u||u.isIndex!==!0)throw new TypeError("Invalid index");var m=u.size(),f=u.isScalar(),g;if(Di(h)?(g=h.size(),h=h.valueOf()):g=dr(h),f){if(g.length!==0)throw new TypeError("Scalar expected");d.set(u.min(),h,p)}else{if(!Zs(g,m))try{g.length===0?h=E_([h],m):h=E_(h,m),g=dr(h)}catch{}if(m.length<d._size.length)throw new wi(m.length,d._size.length,"<");if(g.length<m.length){for(var v=0,_=0;m[v]===1&&g[v]===1;)v++;for(;m[v]===1;)_++,v++;h=W2(h,m.length,_,g)}if(!Zs(m,g))throw new wi(m,g,">");var b=u.max().map(function(w){return w+1});c(d,b,p);var y=m.length,x=0;a(d._data,u,h,y,x)}return d}function a(d,u,h,p,m){var f=m===p-1,g=u.dimension(m);f?g.forEach(function(v,_){zr(v),d[v]=h[_[0]]}):g.forEach(function(v,_){zr(v),a(d[v],u,h[_[0]],p,m+1)})}i.prototype.resize=function(d,u,h){if(!Ep(d))throw new TypeError("Array or Matrix expected");var p=d.valueOf().map(f=>Array.isArray(f)&&f.length===1?f[0]:f),m=h?this.clone():this;return s(m,p,u)};function s(d,u,h){if(u.length===0){for(var p=d._data;or(p);)p=p[0];return p}return d._size=u.slice(0),d._data=Cp(d._data,d._size,h),d}i.prototype.reshape=function(d,u){var h=u?this.clone():this;h._data=x_(h._data,d);var p=h._size.reduce((m,f)=>m*f);return h._size=w_(d,p),h};function c(d,u,h){for(var p=d._size.slice(0),m=!1;p.length<u.length;)p.push(0),m=!0;for(var f=0,g=u.length;f<g;f++)u[f]>p[f]&&(p[f]=u[f],m=!0);m&&s(d,p,h)}i.prototype.clone=function(){var d=new i({data:hi(this._data),size:hi(this._size),datatype:this._datatype});return d},i.prototype.size=function(){return this._size.slice(0)},i.prototype._forEach=function(d){var u=this,h=u.size();if(h.length===1){for(var p=0;p<h[0];p++)d(u._data,p,[p]);return}var m=Array(h.length).fill(0),f=Array(h.length-1),g=f.length-1;f[0]=u._data[0];for(var v=0;v<g;v++)f[v+1]=f[v][0];for(m[g]=-1;;){var _=void 0;for(_=g;_>=0;_--){if(m[_]++,m[_]===h[_]){m[_]=0;continue}f[_]=_===0?u._data[m[_]]:f[_-1][m[_]];for(var b=_;b<g;b++)f[b+1]=f[b][0];for(var y=0;y<h[f.length];y++)m[f.length]=y,d(f[g],y,m.slice(0));break}if(_===-1)break}},i.prototype.map=function(d){var u=this,h=new i(u),p=ng(d,u._data,"map");return h._forEach(function(m,f,g){m[f]=p(m[f],g,u)}),h},i.prototype.forEach=function(d){var u=this,h=ng(d,u._data,"map");u._forEach(function(p,m,f){h(p[m],f,u)})},i.prototype[Symbol.iterator]=function*(){var d=function*(h,p){if(or(h))for(var m=0;m<h.length;m++)yield*iC(d(h[m],p.concat(m)));else yield{value:h,index:p}};yield*iC(d(this._data,[]))},i.prototype.rows=function(){var d=[],u=this.size();if(u.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");var h=this._data;for(var p of h)d.push(new i([p],this._datatype));return d},i.prototype.columns=function(){var d=this,u=[],h=this.size();if(h.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var p=this._data,m=function(v){var _=p.map(b=>[b[v]]);u.push(new i(_,d._datatype))},f=0;f<h[1];f++)m(f);return u},i.prototype.toArray=function(){return hi(this._data)},i.prototype.valueOf=function(){return this._data},i.prototype.format=function(d){return Zi(this._data,d)},i.prototype.toString=function(){return Zi(this._data)},i.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(d){if(d){if(Gi(d)&&(d=d.toNumber()),!Vi(d)||!xi(d))throw new TypeError("The parameter k must be an integer number")}else d=0;for(var u=d>0?d:0,h=d<0?-d:0,p=this._size[0],m=this._size[1],f=Math.min(p-h,m-u),g=[],v=0;v<f;v++)g[v]=this._data[v+h][v+u];return new i({data:g,size:[f],datatype:this._datatype})},i.diagonal=function(d,u,h,p){if(!or(d))throw new TypeError("Array expected, size parameter");if(d.length!==2)throw new Error("Only two dimensions matrix are supported");if(d=d.map(function(I){if(Gi(I)&&(I=I.toNumber()),!Vi(I)||!xi(I)||I<1)throw new Error("Size values must be positive integers");return I}),h){if(Gi(h)&&(h=h.toNumber()),!Vi(h)||!xi(h))throw new TypeError("The parameter k must be an integer number")}else h=0;var m=h>0?h:0,f=h<0?-h:0,g=d[0],v=d[1],_=Math.min(g-f,v-m),b;if(or(u)){if(u.length!==_)throw new Error("Invalid value array length");b=function(S){return u[S]}}else if(Di(u)){var y=u.size();if(y.length!==1||y[0]!==_)throw new Error("Invalid matrix length");b=function(S){return u.get([S])}}else b=function(){return u};p||(p=Gi(b(0))?b(0).mul(0):0);var x=[];if(d.length>0){x=Cp(x,d,p);for(var w=0;w<_;w++)x[w+f][w+m]=b(w)}return new i({data:x,size:[g,v]})},i.fromJSON=function(d){return new i(d)},i.prototype.swapRows=function(d,u){if(!Vi(d)||!xi(d)||!Vi(u)||!xi(u))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return zr(d,this._size[0]),zr(u,this._size[0]),i._swapRows(d,u,this._data),this},i._swapRows=function(d,u,h){var p=h[d];h[d]=h[u],h[u]=p};function l(d){return Di(d)?l(d.valueOf()):or(d)?d.map(l):d}return i},{isClass:!0});function Rr(e,t,i){return e&&typeof e.map=="function"?e.map(function(r){return Rr(r,t,i)}):t(e)}var BG="isInteger",gxe=["typed"],_k=le(BG,gxe,e=>{var{typed:t}=e;return t(BG,{number:xi,BigNumber:function(r){return r.isInt()},bigint:function(r){return!0},Fraction:function(r){return r.d===1&&isFinite(r.n)},"Array | Matrix":t.referToSelf(i=>r=>Rr(r,i))})});var Ha="number",rd="number, number";function bk(e){return Math.abs(e)}bk.signature=Ha;function yk(e,t){return e+t}yk.signature=rd;function xk(e,t){return e-t}xk.signature=rd;function wk(e,t){return e*t}wk.signature=rd;function vxe(e,t){return e/t}vxe.signature=rd;function Ek(e){return-e}Ek.signature=Ha;function _xe(e){return e}_xe.signature=Ha;function bxe(e){return oG(e)}bxe.signature=Ha;function yxe(e){return e*e*e}yxe.signature=Ha;function xxe(e){return Math.exp(e)}xxe.signature=Ha;function wxe(e){return aG(e)}wxe.signature=Ha;function Exe(e,t){if(!xi(e)||!xi(t))throw new Error("Parameters in function gcd must be integer numbers");for(var i;t!==0;)i=e%t,e=t,t=i;return e<0?-e:e}Exe.signature=rd;function Cxe(e,t){if(!xi(e)||!xi(t))throw new Error("Parameters in function lcm must be integer numbers");if(e===0||t===0)return 0;for(var i,r=e*t;t!==0;)i=t,t=e%i,e=i;return Math.abs(r/e)}Cxe.signature=rd;function Sxe(e){return rG(e)}Sxe.signature=Ha;function Txe(e){return iG(e)}Txe.signature=Ha;function Axe(e){return nG(e)}Axe.signature=Ha;function Dxe(e,t){return t===0?e:e-t*Math.floor(e/t)}Dxe.signature=rd;function Y2(e){return tG(e)}Y2.signature=Ha;function Ixe(e){return Math.sqrt(e)}Ixe.signature=Ha;function Mxe(e){return e*e}Mxe.signature=Ha;function kxe(e,t){var i,r,n,o=0,a=1,s=1,c=0;if(!xi(e)||!xi(t))throw new Error("Parameters in function xgcd must be integer numbers");for(;t;)r=Math.floor(e/t),n=e-r*t,i=o,o=a-r*o,a=i,i=s,s=c-r*s,c=i,e=t,t=n;var l;return e<0?l=[-e,-a,-c]:l=[e,e?a:0,c],l}kxe.signature=rd;function Pxe(e,t){return e*e<1&&t===1/0||e*e>1&&t===-1/0?0:Math.pow(e,t)}Pxe.signature=rd;function Nxe(e){return Math.abs(e)}Nxe.signature=Ha;var C_="number";function Oxe(e){return xi(e)}Oxe.signature=C_;function Rxe(e){return e<0}Rxe.signature=C_;function Ck(e){return e>0}Ck.signature=C_;function Fxe(e){return e===0}Fxe.signature=C_;function Lxe(e){return Number.isNaN(e)}Lxe.signature=C_;function Qs(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e-9,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(i<=0)throw new Error("Relative tolerance must be greater than 0");if(r<0)throw new Error("Absolute tolerance must be at least 0");return e.isNaN()||t.isNaN()?!1:!e.isFinite()||!t.isFinite()?e.eq(t):e.eq(t)?!0:e.minus(t).abs().lte(e.constructor.max(e.constructor.max(e.abs(),t.abs()).mul(i),r))}var VG="isPositive",Bxe=["typed","config"],Sk=le(VG,Bxe,e=>{var{typed:t,config:i}=e;return t(VG,{number:r=>Uo(r,0,i.relTol,i.absTol)?!1:Ck(r),BigNumber:r=>Qs(r,new r.constructor(0),i.relTol,i.absTol)?!1:!r.isNeg()&&!r.isZero()&&!r.isNaN(),bigint:r=>r>0n,Fraction:r=>r.s>0&&r.n>0,Unit:t.referToSelf(r=>n=>t.find(r,n.valueType())(n.value)),"Array | Matrix":t.referToSelf(r=>n=>Rr(n,r))})});var zG="isZero",Vxe=["typed","equalScalar"],Tk=le(zG,Vxe,e=>{var{typed:t,equalScalar:i}=e;return t(zG,{"number | BigNumber | Complex | Fraction":r=>i(r,0),bigint:r=>r===0n,Unit:t.referToSelf(r=>n=>t.find(r,n.valueType())(n.value)),"Array | Matrix":t.referToSelf(r=>n=>Rr(n,r))})});function UG(e,t,i,r){return Uo(e.re,t.re,i,r)&&Uo(e.im,t.im,i,r)}var ac=le("compareUnits",["typed"],e=>{var{typed:t}=e;return{"Unit, Unit":t.referToSelf(i=>(r,n)=>{if(!r.equalBase(n))throw new Error("Cannot compare units with different base");return t.find(i,[r.valueType(),n.valueType()])(r.value,n.value)})}});var Z2="equalScalar",zxe=["typed","config"],Ak=le(Z2,zxe,e=>{var{typed:t,config:i}=e,r=ac({typed:t});return t(Z2,{"boolean, boolean":function(o,a){return o===a},"number, number":function(o,a){return Uo(o,a,i.relTol,i.absTol)},"BigNumber, BigNumber":function(o,a){return o.eq(a)||Qs(o,a,i.relTol,i.absTol)},"bigint, bigint":function(o,a){return o===a},"Fraction, Fraction":function(o,a){return o.equals(a)},"Complex, Complex":function(o,a){return UG(o,a,i.relTol,i.absTol)}},r)}),vXe=le(Z2,["typed","config"],e=>{var{typed:t,config:i}=e;return t(Z2,{"number, number":function(n,o){return Uo(n,o,i.relTol,i.absTol)}})});var Uxe="SparseMatrix",Hxe=["typed","equalScalar","Matrix"],Dk=le(Uxe,Hxe,e=>{var{typed:t,equalScalar:i,Matrix:r}=e;function n(f,g){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(g&&!go(g))throw new Error("Invalid datatype: "+g);if(Di(f))o(this,f,g);else if(f&&or(f.index)&&or(f.ptr)&&or(f.size))this._values=f.values,this._index=f.index,this._ptr=f.ptr,this._size=f.size,this._datatype=g||f.datatype;else if(or(f))a(this,f,g);else{if(f)throw new TypeError("Unsupported type of data ("+Hn(f)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=g}}function o(f,g,v){g.type==="SparseMatrix"?(f._values=g._values?hi(g._values):void 0,f._index=hi(g._index),f._ptr=hi(g._ptr),f._size=hi(g._size),f._datatype=v||g._datatype):a(f,g.valueOf(),v||g._datatype)}function a(f,g,v){f._values=[],f._index=[],f._ptr=[],f._datatype=v;var _=g.length,b=0,y=i,x=0;if(go(v)&&(y=t.find(i,[v,v])||i,x=t.convert(0,v)),_>0){var w=0;do{f._ptr.push(f._index.length);for(var I=0;I<_;I++){var S=g[I];if(or(S)){if(w===0&&b<S.length&&(b=S.length),w<S.length){var E=S[w];y(E,x)||(f._values.push(E),f._index.push(I))}}else w===0&&b<1&&(b=1),y(S,x)||(f._values.push(S),f._index.push(I))}w++}while(w<b)}f._ptr.push(f._index.length),f._size=[_,b]}n.prototype=new r,n.prototype.createSparseMatrix=function(f,g){return new n(f,g)},Object.defineProperty(n,"name",{value:"SparseMatrix"}),n.prototype.constructor=n,n.prototype.type="SparseMatrix",n.prototype.isSparseMatrix=!0,n.prototype.getDataType=function(){return Sp(this._values,Hn)},n.prototype.storage=function(){return"sparse"},n.prototype.datatype=function(){return this._datatype},n.prototype.create=function(f,g){return new n(f,g)},n.prototype.density=function(){var f=this._size[0],g=this._size[1];return f!==0&&g!==0?this._index.length/(f*g):0},n.prototype.subset=function(f,g,v){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return s(this,f);case 2:case 3:return c(this,f,g,v);default:throw new SyntaxError("Wrong number of arguments")}};function s(f,g){if(!Km(g))throw new TypeError("Invalid index");var v=g.isScalar();if(v)return f.get(g.min());var _=g.size();if(_.length!==f._size.length)throw new wi(_.length,f._size.length);var b,y,x,w,I=g.min(),S=g.max();for(b=0,y=f._size.length;b<y;b++)zr(I[b],f._size[b]),zr(S[b],f._size[b]);var E=f._values,N=f._index,M=f._ptr,P=g.dimension(0),$=g.dimension(1),R=[],j=[];P.forEach(function(ne,se){j[ne]=se[0],R[ne]=!0});var B=E?[]:void 0,te=[],Z=[];return $.forEach(function(ne){for(Z.push(te.length),x=M[ne],w=M[ne+1];x<w;x++)b=N[x],R[b]===!0&&(te.push(j[b]),B&&B.push(E[x]))}),Z.push(te.length),new n({values:B,index:te,ptr:Z,size:_,datatype:f._datatype})}function c(f,g,v,_){if(!g||g.isIndex!==!0)throw new TypeError("Invalid index");var b=g.size(),y=g.isScalar(),x;if(Di(v)?(x=v.size(),v=v.toArray()):x=dr(v),y){if(x.length!==0)throw new TypeError("Scalar expected");f.set(g.min(),v,_)}else{if(b.length!==1&&b.length!==2)throw new wi(b.length,f._size.length,"<");if(x.length<b.length){for(var w=0,I=0;b[w]===1&&x[w]===1;)w++;for(;b[w]===1;)I++,w++;v=W2(v,b.length,I,x)}if(!Zs(b,x))throw new wi(b,x,">");if(b.length===1){var S=g.dimension(0);S.forEach(function(M,P){zr(M),f.set([M,0],v[P[0]],_)})}else{var E=g.dimension(0),N=g.dimension(1);E.forEach(function(M,P){zr(M),N.forEach(function($,R){zr($),f.set([M,$],v[P[0]][R[0]],_)})})}}return f}n.prototype.get=function(f){if(!or(f))throw new TypeError("Array expected");if(f.length!==this._size.length)throw new wi(f.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var g=f[0],v=f[1];zr(g,this._size[0]),zr(v,this._size[1]);var _=l(g,this._ptr[v],this._ptr[v+1],this._index);return _<this._ptr[v+1]&&this._index[_]===g?this._values[_]:0},n.prototype.set=function(f,g,v){if(!or(f))throw new TypeError("Array expected");if(f.length!==this._size.length)throw new wi(f.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var _=f[0],b=f[1],y=this._size[0],x=this._size[1],w=i,I=0;go(this._datatype)&&(w=t.find(i,[this._datatype,this._datatype])||i,I=t.convert(0,this._datatype)),(_>y-1||b>x-1)&&(h(this,Math.max(_+1,y),Math.max(b+1,x),v),y=this._size[0],x=this._size[1]),zr(_,y),zr(b,x);var S=l(_,this._ptr[b],this._ptr[b+1],this._index);return S<this._ptr[b+1]&&this._index[S]===_?w(g,I)?d(S,b,this._values,this._index,this._ptr):this._values[S]=g:w(g,I)||u(S,_,b,g,this._values,this._index,this._ptr),this};function l(f,g,v,_){if(v-g===0)return v;for(var b=g;b<v;b++)if(_[b]===f)return b;return g}function d(f,g,v,_,b){v.splice(f,1),_.splice(f,1);for(var y=g+1;y<b.length;y++)b[y]--}function u(f,g,v,_,b,y,x){b.splice(f,0,_),y.splice(f,0,g);for(var w=v+1;w<x.length;w++)x[w]++}n.prototype.resize=function(f,g,v){if(!Ep(f))throw new TypeError("Array or Matrix expected");var _=f.valueOf().map(y=>Array.isArray(y)&&y.length===1?y[0]:y);if(_.length!==2)throw new Error("Only two dimensions matrix are supported");_.forEach(function(y){if(!Vi(y)||!xi(y)||y<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Zi(_)+")")});var b=v?this.clone():this;return h(b,_[0],_[1],g)};function h(f,g,v,_){var b=_||0,y=i,x=0;go(f._datatype)&&(y=t.find(i,[f._datatype,f._datatype])||i,x=t.convert(0,f._datatype),b=t.convert(b,f._datatype));var w=!y(b,x),I=f._size[0],S=f._size[1],E,N,M;if(v>S){for(N=S;N<v;N++)if(f._ptr[N]=f._values.length,w)for(E=0;E<I;E++)f._values.push(b),f._index.push(E);f._ptr[v]=f._values.length}else v<S&&(f._ptr.splice(v+1,S-v),f._values.splice(f._ptr[v],f._values.length),f._index.splice(f._ptr[v],f._index.length));if(S=v,g>I){if(w){var P=0;for(N=0;N<S;N++){f._ptr[N]=f._ptr[N]+P,M=f._ptr[N+1]+P;var $=0;for(E=I;E<g;E++,$++)f._values.splice(M+$,0,b),f._index.splice(M+$,0,E),P++}f._ptr[S]=f._values.length}}else if(g<I){var R=0;for(N=0;N<S;N++){f._ptr[N]=f._ptr[N]-R;var j=f._ptr[N],B=f._ptr[N+1]-R;for(M=j;M<B;M++)E=f._index[M],E>g-1&&(f._values.splice(M,1),f._index.splice(M,1),R++)}f._ptr[N]=f._values.length}return f._size[0]=g,f._size[1]=v,f}n.prototype.reshape=function(f,g){if(!or(f))throw new TypeError("Array expected");if(f.length!==2)throw new Error("Sparse matrices can only be reshaped in two dimensions");f.forEach(function(ne){if(!Vi(ne)||!xi(ne)||ne<=-2||ne===0)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+Zi(f)+")")});var v=this._size[0]*this._size[1];f=w_(f,v);var _=f[0]*f[1];if(v!==_)throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var b=g?this.clone():this;if(this._size[0]===f[0]&&this._size[1]===f[1])return b;for(var y=[],x=0;x<b._ptr.length;x++)for(var w=0;w<b._ptr[x+1]-b._ptr[x];w++)y.push(x);for(var I=b._values.slice(),S=b._index.slice(),E=0;E<b._index.length;E++){var N=S[E],M=y[E],P=N*b._size[1]+M;y[E]=P%f[1],S[E]=Math.floor(P/f[1])}b._values.length=0,b._index.length=0,b._ptr.length=f[1]+1,b._size=f.slice();for(var $=0;$<b._ptr.length;$++)b._ptr[$]=0;for(var R=0;R<I.length;R++){var j=S[R],B=y[R],te=I[R],Z=l(j,b._ptr[B],b._ptr[B+1],b._index);u(Z,j,B,te,b._values,b._index,b._ptr)}return b},n.prototype.clone=function(){var f=new n({values:this._values?hi(this._values):void 0,index:hi(this._index),ptr:hi(this._ptr),size:hi(this._size),datatype:this._datatype});return f},n.prototype.size=function(){return this._size.slice(0)},n.prototype.map=function(f,g){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var v=this,_=this._size[0],b=this._size[1],y=ng(f,v,"map"),x=function(I,S,E){return y(I,[S,E],v)};return p(this,0,_-1,0,b-1,x,g)};function p(f,g,v,_,b,y,x){var w=[],I=[],S=[],E=i,N=0;go(f._datatype)&&(E=t.find(i,[f._datatype,f._datatype])||i,N=t.convert(0,f._datatype));for(var M=function(ue,Ee,ye){var Te=y(ue,Ee,ye);E(Te,N)||(w.push(Te),I.push(Ee))},P=_;P<=b;P++){S.push(w.length);var $=f._ptr[P],R=f._ptr[P+1];if(x)for(var j=$;j<R;j++){var B=f._index[j];B>=g&&B<=v&&M(f._values[j],B-g,P-_)}else{for(var te={},Z=$;Z<R;Z++){var ne=f._index[Z];te[ne]=f._values[Z]}for(var se=g;se<=v;se++){var we=se in te?te[se]:0;M(we,se-g,P-_)}}}return S.push(w.length),new n({values:w,index:I,ptr:S,size:[v-g+1,b-_+1]})}n.prototype.forEach=function(f,g){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var v=this,_=this._size[0],b=this._size[1],y=ng(f,v,"forEach"),x=0;x<b;x++){var w=this._ptr[x],I=this._ptr[x+1];if(g)for(var S=w;S<I;S++){var E=this._index[S];y(this._values[S],[E,x],v)}else{for(var N={},M=w;M<I;M++){var P=this._index[M];N[P]=this._values[M]}for(var $=0;$<_;$++){var R=$ in N?N[$]:0;y(R,[$,x],v)}}}},n.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var f=this._size[1],g=0;g<f;g++)for(var v=this._ptr[g],_=this._ptr[g+1],b=v;b<_;b++){var y=this._index[b];yield{value:this._values[b],index:[y,g]}}},n.prototype.toArray=function(){return m(this._values,this._index,this._ptr,this._size,!0)},n.prototype.valueOf=function(){return m(this._values,this._index,this._ptr,this._size,!1)};function m(f,g,v,_,b){var y=_[0],x=_[1],w=[],I,S;for(I=0;I<y;I++)for(w[I]=[],S=0;S<x;S++)w[I][S]=0;for(S=0;S<x;S++)for(var E=v[S],N=v[S+1],M=E;M<N;M++)I=g[M],w[I][S]=f?b?hi(f[M]):f[M]:1;return w}return n.prototype.format=function(f){for(var g=this._size[0],v=this._size[1],_=this.density(),b="Sparse Matrix ["+Zi(g,f)+" x "+Zi(v,f)+"] density: "+Zi(_,f)+`
`,y=0;y<v;y++)for(var x=this._ptr[y],w=this._ptr[y+1],I=x;I<w;I++){var S=this._index[I];b+=`
    (`+Zi(S,f)+", "+Zi(y,f)+") ==> "+(this._values?Zi(this._values[I],f):"X")}return b},n.prototype.toString=function(){return Zi(this.toArray())},n.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},n.prototype.diagonal=function(f){if(f){if(Gi(f)&&(f=f.toNumber()),!Vi(f)||!xi(f))throw new TypeError("The parameter k must be an integer number")}else f=0;var g=f>0?f:0,v=f<0?-f:0,_=this._size[0],b=this._size[1],y=Math.min(_-v,b-g),x=[],w=[],I=[];I[0]=0;for(var S=g;S<b&&x.length<y;S++)for(var E=this._ptr[S],N=this._ptr[S+1],M=E;M<N;M++){var P=this._index[M];if(P===S-g+v){x.push(this._values[M]),w[x.length-1]=P-v;break}}return I.push(x.length),new n({values:x,index:w,ptr:I,size:[y,1]})},n.fromJSON=function(f){return new n(f)},n.diagonal=function(f,g,v,_,b){if(!or(f))throw new TypeError("Array expected, size parameter");if(f.length!==2)throw new Error("Only two dimensions matrix are supported");if(f=f.map(function(ne){if(Gi(ne)&&(ne=ne.toNumber()),!Vi(ne)||!xi(ne)||ne<1)throw new Error("Size values must be positive integers");return ne}),v){if(Gi(v)&&(v=v.toNumber()),!Vi(v)||!xi(v))throw new TypeError("The parameter k must be an integer number")}else v=0;var y=i,x=0;go(b)&&(y=t.find(i,[b,b])||i,x=t.convert(0,b));var w=v>0?v:0,I=v<0?-v:0,S=f[0],E=f[1],N=Math.min(S-I,E-w),M;if(or(g)){if(g.length!==N)throw new Error("Invalid value array length");M=function(se){return g[se]}}else if(Di(g)){var P=g.size();if(P.length!==1||P[0]!==N)throw new Error("Invalid matrix length");M=function(se){return g.get([se])}}else M=function(){return g};for(var $=[],R=[],j=[],B=0;B<E;B++){j.push($.length);var te=B-w;if(te>=0&&te<N){var Z=M(te);y(Z,x)||(R.push(te+I),$.push(Z))}}return j.push($.length),new n({values:$,index:R,ptr:j,size:[S,E]})},n.prototype.swapRows=function(f,g){if(!Vi(f)||!xi(f)||!Vi(g)||!xi(g))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return zr(f,this._size[0]),zr(g,this._size[0]),n._swapRows(f,g,this._size[1],this._values,this._index,this._ptr),this},n._forEachRow=function(f,g,v,_,b){for(var y=_[f],x=_[f+1],w=y;w<x;w++)b(v[w],g[w])},n._swapRows=function(f,g,v,_,b,y){for(var x=0;x<v;x++){var w=y[x],I=y[x+1],S=l(f,w,I,b),E=l(g,w,I,b);if(S<I&&E<I&&b[S]===f&&b[E]===g){if(_){var N=_[S];_[S]=_[E],_[E]=N}continue}if(S<I&&b[S]===f&&(E>=I||b[E]!==g)){var M=_?_[S]:void 0;b.splice(E,0,g),_&&_.splice(E,0,M),b.splice(E<=S?S+1:S,1),_&&_.splice(E<=S?S+1:S,1);continue}if(E<I&&b[E]===g&&(S>=I||b[S]!==f)){var P=_?_[E]:void 0;b.splice(S,0,f),_&&_.splice(S,0,P),b.splice(S<=E?E+1:E,1),_&&_.splice(S<=E?E+1:E,1)}}},n},{isClass:!0});var jxe="number",Gxe=["typed"];function $xe(e){var t=e.match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/);if(t){var i={"0b":2,"0o":8,"0x":16}[t[1]],r=t[2],n=t[3];return{input:e,radix:i,integerPart:r,fractionalPart:n}}else return null}function Wxe(e){for(var t=parseInt(e.integerPart,e.radix),i=0,r=0;r<e.fractionalPart.length;r++){var n=parseInt(e.fractionalPart[r],e.radix);i+=n/Math.pow(e.radix,r+1)}var o=t+i;if(isNaN(o))throw new SyntaxError('String "'+e.input+'" is not a valid number');return o}var Ik=le(jxe,Gxe,e=>{var{typed:t}=e,i=t("number",{"":function(){return 0},number:function(n){return n},string:function(n){if(n==="NaN")return NaN;var o=$xe(n);if(o)return Wxe(o);var a=0,s=n.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);s&&(a=Number(s[2]),n=s[1]);var c=Number(n);if(isNaN(c))throw new SyntaxError('String "'+n+'" is not a valid number');if(s){if(c>2**a-1)throw new SyntaxError('String "'.concat(n,'" is out of range'));c>=2**(a-1)&&(c=c-2**a)}return c},BigNumber:function(n){return n.toNumber()},bigint:function(n){return Number(n)},Fraction:function(n){return n.valueOf()},Unit:t.referToSelf(r=>n=>{var o=n.clone();return o.value=r(n.value),o}),null:function(n){return 0},"Unit, string | Unit":function(n,o){return n.toNumber(o)},"Array | Matrix":t.referToSelf(r=>n=>Rr(n,r))});return i.fromJSON=function(r){return parseFloat(r.value)},i});var qxe="bignumber",Xxe=["typed","BigNumber"],Mk=le(qxe,Xxe,e=>{var{typed:t,BigNumber:i}=e;return t("bignumber",{"":function(){return new i(0)},number:function(n){return new i(n+"")},string:function(n){var o=n.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(o){var a=o[2],s=i(o[1]),c=new i(2).pow(Number(a));if(s.gt(c.sub(1)))throw new SyntaxError('String "'.concat(n,'" is out of range'));var l=new i(2).pow(Number(a)-1);return s.gte(l)?s.sub(c):s}return new i(n)},BigNumber:function(n){return n},bigint:function(n){return new i(n.toString())},Unit:t.referToSelf(r=>n=>{var o=n.clone();return o.value=r(n.value),o}),Fraction:function(n){return new i(n.n).div(n.d).times(n.s)},null:function(n){return new i(0)},"Array | Matrix":t.referToSelf(r=>n=>Rr(n,r))})});var Yxe="complex",Zxe=["typed","Complex"],kk=le(Yxe,Zxe,e=>{var{typed:t,Complex:i}=e;return t("complex",{"":function(){return i.ZERO},number:function(n){return new i(n,0)},"number, number":function(n,o){return new i(n,o)},"BigNumber, BigNumber":function(n,o){return new i(n.toNumber(),o.toNumber())},Fraction:function(n){return new i(n.valueOf(),0)},Complex:function(n){return n.clone()},string:function(n){return i(n)},null:function(n){return i(0)},Object:function(n){if("re"in n&&"im"in n)return new i(n.re,n.im);if("r"in n&&"phi"in n||"abs"in n&&"arg"in n)return new i(n);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":t.referToSelf(r=>n=>Rr(n,r))})});var Kxe="fraction",Qxe=["typed","Fraction"],Pk=le(Kxe,Qxe,e=>{var{typed:t,Fraction:i}=e;return t("fraction",{number:function(n){if(!isFinite(n)||isNaN(n))throw new Error(n+" cannot be represented as a fraction");return new i(n)},string:function(n){return new i(n)},"number, number":function(n,o){return new i(n,o)},null:function(n){return new i(0)},BigNumber:function(n){return new i(n.toString())},bigint:function(n){return new i(n.toString())},Fraction:function(n){return n},Unit:t.referToSelf(r=>n=>{var o=n.clone();return o.value=r(n.value),o}),Object:function(n){return new i(n)},"Array | Matrix":t.referToSelf(r=>n=>Rr(n,r))})});var HG="matrix",Jxe=["typed","Matrix","DenseMatrix","SparseMatrix"],Nk=le(HG,Jxe,e=>{var{typed:t,Matrix:i,DenseMatrix:r,SparseMatrix:n}=e;return t(HG,{"":function(){return o([])},string:function(s){return o([],s)},"string, string":function(s,c){return o([],s,c)},Array:function(s){return o(s)},Matrix:function(s){return o(s,s.storage())},"Array | Matrix, string":o,"Array | Matrix, string, string":o});function o(a,s,c){if(s==="dense"||s==="default"||s===void 0)return new r(a,c);if(s==="sparse")return new n(a,c);throw new TypeError("Unknown matrix type "+JSON.stringify(s)+".")}});var jG="matrixFromColumns",ewe=["typed","matrix","flatten","size"],Ok=le(jG,ewe,e=>{var{typed:t,matrix:i,flatten:r,size:n}=e;return t(jG,{"...Array":function(c){return o(c)},"...Matrix":function(c){return i(o(c.map(l=>l.toArray())))}});function o(s){if(s.length===0)throw new TypeError("At least one column is needed to construct a matrix.");for(var c=a(s[0]),l=[],d=0;d<c;d++)l[d]=[];for(var u of s){var h=a(u);if(h!==c)throw new TypeError("The vectors had different length: "+(c|0)+" \u2260 "+(h|0));for(var p=r(u),m=0;m<c;m++)l[m].push(p[m])}return l}function a(s){var c=n(s);if(c.length===1)return c[0];if(c.length===2){if(c[0]===1)return c[1];if(c[1]===1)return c[0];throw new TypeError("At least one of the arguments is not a vector.")}else throw new TypeError("Only one- or two-dimensional vectors are supported.")}});var GG="unaryMinus",twe=["typed"],Rk=le(GG,twe,e=>{var{typed:t}=e;return t(GG,{number:Ek,"Complex | BigNumber | Fraction":i=>i.neg(),bigint:i=>-i,Unit:t.referToSelf(i=>r=>{var n=r.clone();return n.value=t.find(i,n.valueType())(r.value),n}),"Array | Matrix":t.referToSelf(i=>r=>Rr(r,i,!0))})});var $G="abs",iwe=["typed"],Fk=le($G,iwe,e=>{var{typed:t}=e;return t($G,{number:bk,"Complex | BigNumber | Fraction | Unit":i=>i.abs(),bigint:i=>i<0n?-i:i,"Array | Matrix":t.referToSelf(i=>r=>Rr(r,i,!0))})});var WG="addScalar",rwe=["typed"],Lk=le(WG,rwe,e=>{var{typed:t}=e;return t(WG,{"number, number":yk,"Complex, Complex":function(r,n){return r.add(n)},"BigNumber, BigNumber":function(r,n){return r.plus(n)},"bigint, bigint":function(r,n){return r+n},"Fraction, Fraction":function(r,n){return r.add(n)},"Unit, Unit":t.referToSelf(i=>(r,n)=>{if(r.value===null||r.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(n.value===null||n.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(n))throw new Error("Units do not match");var o=r.clone();return o.value=t.find(i,[o.valueType(),n.valueType()])(o.value,n.value),o.fixPrefix=!1,o})})});var qG="subtractScalar",nwe=["typed"],Bk=le(qG,nwe,e=>{var{typed:t}=e;return t(qG,{"number, number":xk,"Complex, Complex":function(r,n){return r.sub(n)},"BigNumber, BigNumber":function(r,n){return r.minus(n)},"bigint, bigint":function(r,n){return r-n},"Fraction, Fraction":function(r,n){return r.sub(n)},"Unit, Unit":t.referToSelf(i=>(r,n)=>{if(r.value===null||r.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(n.value===null||n.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(n))throw new Error("Units do not match");var o=r.clone();return o.value=t.find(i,[o.valueType(),n.valueType()])(o.value,n.value),o.fixPrefix=!1,o})})});var owe="matAlgo11xS0s",awe=["typed","equalScalar"],XG=le(owe,awe,e=>{var{typed:t,equalScalar:i}=e;return function(n,o,a,s){var c=n._values,l=n._index,d=n._ptr,u=n._size,h=n._datatype;if(!c)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var p=u[0],m=u[1],f,g=i,v=0,_=a;typeof h=="string"&&(f=h,g=t.find(i,[f,f]),v=t.convert(0,f),o=t.convert(o,f),_=t.find(a,[f,f]));for(var b=[],y=[],x=[],w=0;w<m;w++){x[w]=y.length;for(var I=d[w],S=d[w+1],E=I;E<S;E++){var N=l[E],M=s?_(o,c[E]):_(c[E],o);g(M,v)||(y.push(N),b.push(M))}}return x[m]=y.length,n.createSparseMatrix({values:b,index:y,ptr:x,size:[p,m],datatype:f})}});var swe="matAlgo12xSfs",lwe=["typed","DenseMatrix"],Js=le(swe,lwe,e=>{var{typed:t,DenseMatrix:i}=e;return function(n,o,a,s){var c=n._values,l=n._index,d=n._ptr,u=n._size,h=n._datatype;if(!c)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var p=u[0],m=u[1],f,g=a;typeof h=="string"&&(f=h,o=t.convert(o,f),g=t.find(a,[f,f]));for(var v=[],_=[],b=[],y=0;y<m;y++){for(var x=y+1,w=d[y],I=d[y+1],S=w;S<I;S++){var E=l[S];_[E]=c[S],b[E]=x}for(var N=0;N<p;N++)y===0&&(v[N]=[]),b[N]===x?v[N][y]=s?g(o,_[N]):g(_[N],o):v[N][y]=s?g(o,0):g(0,o)}return new i({data:v,size:[p,m],datatype:f})}});var cwe="matAlgo14xDs",dwe=["typed"],K2=le(cwe,dwe,e=>{var{typed:t}=e;return function(n,o,a,s){var c=n._data,l=n._size,d=n._datatype,u,h=a;typeof d=="string"&&(u=d,o=t.convert(o,u),h=t.find(a,[u,u]));var p=l.length>0?i(h,0,l,l[0],c,o,s):[];return n.createDenseMatrix({data:p,size:hi(l),datatype:u})};function i(r,n,o,a,s,c,l){var d=[];if(n===o.length-1)for(var u=0;u<a;u++)d[u]=l?r(c,s[u]):r(s[u],c);else for(var h=0;h<a;h++)d[h]=i(r,n+1,o,o[n+1],s[h],c,l);return d}});var uwe="matAlgo03xDSf",hwe=["typed"],el=le(uwe,hwe,e=>{var{typed:t}=e;return function(r,n,o,a){var s=r._data,c=r._size,l=r._datatype||r.getDataType(),d=n._values,u=n._index,h=n._ptr,p=n._size,m=n._datatype||n._data===void 0?n._datatype:n.getDataType();if(c.length!==p.length)throw new wi(c.length,p.length);if(c[0]!==p[0]||c[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+p+")");if(!d)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var f=c[0],g=c[1],v,_=0,b=o;typeof l=="string"&&l===m&&l!=="mixed"&&(v=l,_=t.convert(0,v),b=t.find(o,[v,v]));for(var y=[],x=0;x<f;x++)y[x]=[];for(var w=[],I=[],S=0;S<g;S++){for(var E=S+1,N=h[S],M=h[S+1],P=N;P<M;P++){var $=u[P];w[$]=a?b(d[P],s[$][S]):b(s[$][S],d[P]),I[$]=E}for(var R=0;R<f;R++)I[R]===E?y[R][S]=w[R]:y[R][S]=a?b(_,s[R][S]):b(s[R][S],_)}return r.createDenseMatrix({data:y,size:[f,g],datatype:l===r._datatype&&m===n._datatype?v:void 0})}});var pwe="matAlgo05xSfSf",fwe=["typed","equalScalar"],YG=le(pwe,fwe,e=>{var{typed:t,equalScalar:i}=e;return function(n,o,a){var s=n._values,c=n._index,l=n._ptr,d=n._size,u=n._datatype||n._data===void 0?n._datatype:n.getDataType(),h=o._values,p=o._index,m=o._ptr,f=o._size,g=o._datatype||o._data===void 0?o._datatype:o.getDataType();if(d.length!==f.length)throw new wi(d.length,f.length);if(d[0]!==f[0]||d[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+d+") must match Matrix B ("+f+")");var v=d[0],_=d[1],b,y=i,x=0,w=a;typeof u=="string"&&u===g&&u!=="mixed"&&(b=u,y=t.find(i,[b,b]),x=t.convert(0,b),w=t.find(a,[b,b]));var I=s&&h?[]:void 0,S=[],E=[],N=I?[]:void 0,M=I?[]:void 0,P=[],$=[],R,j,B,te;for(j=0;j<_;j++){E[j]=S.length;var Z=j+1;for(B=l[j],te=l[j+1];B<te;B++)R=c[B],S.push(R),P[R]=Z,N&&(N[R]=s[B]);for(B=m[j],te=m[j+1];B<te;B++)R=p[B],P[R]!==Z&&S.push(R),$[R]=Z,M&&(M[R]=h[B]);if(I)for(B=E[j];B<S.length;){R=S[B];var ne=P[R],se=$[R];if(ne===Z||se===Z){var we=ne===Z?N[R]:x,ie=se===Z?M[R]:x,ue=w(we,ie);y(ue,x)?S.splice(B,1):(I.push(ue),B++)}}}return E[_]=S.length,n.createSparseMatrix({values:I,index:S,ptr:E,size:[v,_],datatype:u===n._datatype&&g===o._datatype?b:void 0})}});var mwe="matAlgo13xDD",gwe=["typed"],ZG=le(mwe,gwe,e=>{var{typed:t}=e;return function(n,o,a){var s=n._data,c=n._size,l=n._datatype,d=o._data,u=o._size,h=o._datatype,p=[];if(c.length!==u.length)throw new wi(c.length,u.length);for(var m=0;m<c.length;m++){if(c[m]!==u[m])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+u+")");p[m]=c[m]}var f,g=a;typeof l=="string"&&l===h&&(f=l,g=t.find(a,[f,f]));var v=p.length>0?i(g,0,p,p[0],s,d):[];return n.createDenseMatrix({data:v,size:p,datatype:f})};function i(r,n,o,a,s,c){var l=[];if(n===o.length-1)for(var d=0;d<a;d++)l[d]=r(s[d],c[d]);else for(var u=0;u<a;u++)l[u]=i(r,n+1,o,o[n+1],s[u],c[u]);return l}});function Gn(e,t){if(Zs(e.size(),t.size()))return[e,t];var i=mk(e.size(),t.size());return[e,t].map(r=>vwe(r,i))}function vwe(e,t){return Zs(e.size(),t)?e:e.create(E_(e.valueOf(),t),e.datatype())}var _we="matrixAlgorithmSuite",bwe=["typed","matrix"],ja=le(_we,bwe,e=>{var{typed:t,matrix:i}=e,r=ZG({typed:t}),n=K2({typed:t});return function(a){var s=a.elop,c=a.SD||a.DS,l;s?(l={"DenseMatrix, DenseMatrix":(p,m)=>r(...Gn(p,m),s),"Array, Array":(p,m)=>r(...Gn(i(p),i(m)),s).valueOf(),"Array, DenseMatrix":(p,m)=>r(...Gn(i(p),m),s),"DenseMatrix, Array":(p,m)=>r(...Gn(p,i(m)),s)},a.SS&&(l["SparseMatrix, SparseMatrix"]=(p,m)=>a.SS(...Gn(p,m),s,!1)),a.DS&&(l["DenseMatrix, SparseMatrix"]=(p,m)=>a.DS(...Gn(p,m),s,!1),l["Array, SparseMatrix"]=(p,m)=>a.DS(...Gn(i(p),m),s,!1)),c&&(l["SparseMatrix, DenseMatrix"]=(p,m)=>c(...Gn(m,p),s,!0),l["SparseMatrix, Array"]=(p,m)=>c(...Gn(i(m),p),s,!0))):(l={"DenseMatrix, DenseMatrix":t.referToSelf(p=>(m,f)=>r(...Gn(m,f),p)),"Array, Array":t.referToSelf(p=>(m,f)=>r(...Gn(i(m),i(f)),p).valueOf()),"Array, DenseMatrix":t.referToSelf(p=>(m,f)=>r(...Gn(i(m),f),p)),"DenseMatrix, Array":t.referToSelf(p=>(m,f)=>r(...Gn(m,i(f)),p))},a.SS&&(l["SparseMatrix, SparseMatrix"]=t.referToSelf(p=>(m,f)=>a.SS(...Gn(m,f),p,!1))),a.DS&&(l["DenseMatrix, SparseMatrix"]=t.referToSelf(p=>(m,f)=>a.DS(...Gn(m,f),p,!1)),l["Array, SparseMatrix"]=t.referToSelf(p=>(m,f)=>a.DS(...Gn(i(m),f),p,!1))),c&&(l["SparseMatrix, DenseMatrix"]=t.referToSelf(p=>(m,f)=>c(...Gn(f,m),p,!0)),l["SparseMatrix, Array"]=t.referToSelf(p=>(m,f)=>c(...Gn(i(f),m),p,!0))));var d=a.scalar||"any",u=a.Ds||a.Ss;u&&(s?(l["DenseMatrix,"+d]=(p,m)=>n(p,m,s,!1),l[d+", DenseMatrix"]=(p,m)=>n(m,p,s,!0),l["Array,"+d]=(p,m)=>n(i(p),m,s,!1).valueOf(),l[d+", Array"]=(p,m)=>n(i(m),p,s,!0).valueOf()):(l["DenseMatrix,"+d]=t.referToSelf(p=>(m,f)=>n(m,f,p,!1)),l[d+", DenseMatrix"]=t.referToSelf(p=>(m,f)=>n(f,m,p,!0)),l["Array,"+d]=t.referToSelf(p=>(m,f)=>n(i(m),f,p,!1).valueOf()),l[d+", Array"]=t.referToSelf(p=>(m,f)=>n(i(f),m,p,!0).valueOf())));var h=a.sS!==void 0?a.sS:a.Ss;return s?(a.Ss&&(l["SparseMatrix,"+d]=(p,m)=>a.Ss(p,m,s,!1)),h&&(l[d+", SparseMatrix"]=(p,m)=>h(m,p,s,!0))):(a.Ss&&(l["SparseMatrix,"+d]=t.referToSelf(p=>(m,f)=>a.Ss(m,f,p,!1))),h&&(l[d+", SparseMatrix"]=t.referToSelf(p=>(m,f)=>h(f,m,p,!0)))),s&&s.signatures&&Yj(l,s.signatures),l}});var ywe="matAlgo01xDSid",xwe=["typed"],Q2=le(ywe,xwe,e=>{var{typed:t}=e;return function(r,n,o,a){var s=r._data,c=r._size,l=r._datatype||r.getDataType(),d=n._values,u=n._index,h=n._ptr,p=n._size,m=n._datatype||n._data===void 0?n._datatype:n.getDataType();if(c.length!==p.length)throw new wi(c.length,p.length);if(c[0]!==p[0]||c[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+p+")");if(!d)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var f=c[0],g=c[1],v=typeof l=="string"&&l!=="mixed"&&l===m?l:void 0,_=v?t.find(o,[v,v]):o,b,y,x=[];for(b=0;b<f;b++)x[b]=[];var w=[],I=[];for(y=0;y<g;y++){for(var S=y+1,E=h[y],N=h[y+1],M=E;M<N;M++)b=u[M],w[b]=a?_(d[M],s[b][y]):_(s[b][y],d[M]),I[b]=S;for(b=0;b<f;b++)I[b]===S?x[b][y]=w[b]:x[b][y]=s[b][y]}return r.createDenseMatrix({data:x,size:[f,g],datatype:l===r._datatype&&m===n._datatype?v:void 0})}});var wwe="matAlgo04xSidSid",Ewe=["typed","equalScalar"],KG=le(wwe,Ewe,e=>{var{typed:t,equalScalar:i}=e;return function(n,o,a){var s=n._values,c=n._index,l=n._ptr,d=n._size,u=n._datatype||n._data===void 0?n._datatype:n.getDataType(),h=o._values,p=o._index,m=o._ptr,f=o._size,g=o._datatype||o._data===void 0?o._datatype:o.getDataType();if(d.length!==f.length)throw new wi(d.length,f.length);if(d[0]!==f[0]||d[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+d+") must match Matrix B ("+f+")");var v=d[0],_=d[1],b,y=i,x=0,w=a;typeof u=="string"&&u===g&&u!=="mixed"&&(b=u,y=t.find(i,[b,b]),x=t.convert(0,b),w=t.find(a,[b,b]));var I=s&&h?[]:void 0,S=[],E=[],N=s&&h?[]:void 0,M=s&&h?[]:void 0,P=[],$=[],R,j,B,te,Z;for(j=0;j<_;j++){E[j]=S.length;var ne=j+1;for(te=l[j],Z=l[j+1],B=te;B<Z;B++)R=c[B],S.push(R),P[R]=ne,N&&(N[R]=s[B]);for(te=m[j],Z=m[j+1],B=te;B<Z;B++)if(R=p[B],P[R]===ne){if(N){var se=w(N[R],h[B]);y(se,x)?P[R]=null:N[R]=se}}else S.push(R),$[R]=ne,M&&(M[R]=h[B]);if(N&&M)for(B=E[j];B<S.length;)R=S[B],P[R]===ne?(I[B]=N[R],B++):$[R]===ne?(I[B]=M[R],B++):S.splice(B,1)}return E[_]=S.length,n.createSparseMatrix({values:I,index:S,ptr:E,size:[v,_],datatype:u===n._datatype&&g===o._datatype?b:void 0})}});var Cwe="matAlgo10xSids",Swe=["typed","DenseMatrix"],J2=le(Cwe,Swe,e=>{var{typed:t,DenseMatrix:i}=e;return function(n,o,a,s){var c=n._values,l=n._index,d=n._ptr,u=n._size,h=n._datatype;if(!c)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var p=u[0],m=u[1],f,g=a;typeof h=="string"&&(f=h,o=t.convert(o,f),g=t.find(a,[f,f]));for(var v=[],_=[],b=[],y=0;y<m;y++){for(var x=y+1,w=d[y],I=d[y+1],S=w;S<I;S++){var E=l[S];_[E]=c[S],b[E]=x}for(var N=0;N<p;N++)y===0&&(v[N]=[]),b[N]===x?v[N][y]=s?g(o,_[N]):g(_[N],o):v[N][y]=o}return new i({data:v,size:[p,m],datatype:f})}});var Twe="multiplyScalar",Awe=["typed"],Vk=le(Twe,Awe,e=>{var{typed:t}=e;return t("multiplyScalar",{"number, number":wk,"Complex, Complex":function(r,n){return r.mul(n)},"BigNumber, BigNumber":function(r,n){return r.times(n)},"bigint, bigint":function(r,n){return r*n},"Fraction, Fraction":function(r,n){return r.mul(n)},"number | Fraction | BigNumber | Complex, Unit":(i,r)=>r.multiply(i),"Unit, number | Fraction | BigNumber | Complex | Unit":(i,r)=>i.multiply(r)})});var QG="multiply",Dwe=["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],zk=le(QG,Dwe,e=>{var{typed:t,matrix:i,addScalar:r,multiplyScalar:n,equalScalar:o,dot:a}=e,s=XG({typed:t,equalScalar:o}),c=K2({typed:t});function l(x,w){switch(x.length){case 1:switch(w.length){case 1:if(x[0]!==w[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(x[0]!==w[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+x[0]+") must match Matrix rows ("+w[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+w.length+" dimensions)")}break;case 2:switch(w.length){case 1:if(x[1]!==w[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+x[1]+") must match Vector length ("+w[0]+")");break;case 2:if(x[1]!==w[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+x[1]+") must match Matrix B rows ("+w[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+w.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+x.length+" dimensions)")}}function d(x,w,I){if(I===0)throw new Error("Cannot multiply two empty vectors");return a(x,w)}function u(x,w){if(w.storage()!=="dense")throw new Error("Support for SparseMatrix not implemented");return h(x,w)}function h(x,w){var I=x._data,S=x._size,E=x._datatype||x.getDataType(),N=w._data,M=w._size,P=w._datatype||w.getDataType(),$=S[0],R=M[1],j,B=r,te=n;E&&P&&E===P&&typeof E=="string"&&E!=="mixed"&&(j=E,B=t.find(r,[j,j]),te=t.find(n,[j,j]));for(var Z=[],ne=0;ne<R;ne++){for(var se=te(I[0],N[0][ne]),we=1;we<$;we++)se=B(se,te(I[we],N[we][ne]));Z[ne]=se}return x.createDenseMatrix({data:Z,size:[R],datatype:E===x._datatype&&P===w._datatype?j:void 0})}var p=t("_multiplyMatrixVector",{"DenseMatrix, any":f,"SparseMatrix, any":_}),m=t("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":g,"DenseMatrix, SparseMatrix":v,"SparseMatrix, DenseMatrix":b,"SparseMatrix, SparseMatrix":y});function f(x,w){var I=x._data,S=x._size,E=x._datatype||x.getDataType(),N=w._data,M=w._datatype||w.getDataType(),P=S[0],$=S[1],R,j=r,B=n;E&&M&&E===M&&typeof E=="string"&&E!=="mixed"&&(R=E,j=t.find(r,[R,R]),B=t.find(n,[R,R]));for(var te=[],Z=0;Z<P;Z++){for(var ne=I[Z],se=B(ne[0],N[0]),we=1;we<$;we++)se=j(se,B(ne[we],N[we]));te[Z]=se}return x.createDenseMatrix({data:te,size:[P],datatype:E===x._datatype&&M===w._datatype?R:void 0})}function g(x,w){var I=x._data,S=x._size,E=x._datatype||x.getDataType(),N=w._data,M=w._size,P=w._datatype||w.getDataType(),$=S[0],R=S[1],j=M[1],B,te=r,Z=n;E&&P&&E===P&&typeof E=="string"&&E!=="mixed"&&E!=="mixed"&&(B=E,te=t.find(r,[B,B]),Z=t.find(n,[B,B]));for(var ne=[],se=0;se<$;se++){var we=I[se];ne[se]=[];for(var ie=0;ie<j;ie++){for(var ue=Z(we[0],N[0][ie]),Ee=1;Ee<R;Ee++)ue=te(ue,Z(we[Ee],N[Ee][ie]));ne[se][ie]=ue}}return x.createDenseMatrix({data:ne,size:[$,j],datatype:E===x._datatype&&P===w._datatype?B:void 0})}function v(x,w){var I=x._data,S=x._size,E=x._datatype||x.getDataType(),N=w._values,M=w._index,P=w._ptr,$=w._size,R=w._datatype||w._data===void 0?w._datatype:w.getDataType();if(!N)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var j=S[0],B=$[1],te,Z=r,ne=n,se=o,we=0;E&&R&&E===R&&typeof E=="string"&&E!=="mixed"&&(te=E,Z=t.find(r,[te,te]),ne=t.find(n,[te,te]),se=t.find(o,[te,te]),we=t.convert(0,te));for(var ie=[],ue=[],Ee=[],ye=w.createSparseMatrix({values:ie,index:ue,ptr:Ee,size:[j,B],datatype:E===x._datatype&&R===w._datatype?te:void 0}),Te=0;Te<B;Te++){Ee[Te]=ue.length;var pe=P[Te],be=P[Te+1];if(be>pe)for(var De=0,fe=0;fe<j;fe++){for(var Ne=fe+1,Pe=void 0,Ke=pe;Ke<be;Ke++){var At=M[Ke];De!==Ne?(Pe=ne(I[fe][At],N[Ke]),De=Ne):Pe=Z(Pe,ne(I[fe][At],N[Ke]))}De===Ne&&!se(Pe,we)&&(ue.push(fe),ie.push(Pe))}}return Ee[B]=ue.length,ye}function _(x,w){var I=x._values,S=x._index,E=x._ptr,N=x._datatype||x._data===void 0?x._datatype:x.getDataType();if(!I)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var M=w._data,P=w._datatype||w.getDataType(),$=x._size[0],R=w._size[0],j=[],B=[],te=[],Z,ne=r,se=n,we=o,ie=0;N&&P&&N===P&&typeof N=="string"&&N!=="mixed"&&(Z=N,ne=t.find(r,[Z,Z]),se=t.find(n,[Z,Z]),we=t.find(o,[Z,Z]),ie=t.convert(0,Z));var ue=[],Ee=[];te[0]=0;for(var ye=0;ye<R;ye++){var Te=M[ye];if(!we(Te,ie))for(var pe=E[ye],be=E[ye+1],De=pe;De<be;De++){var fe=S[De];Ee[fe]?ue[fe]=ne(ue[fe],se(Te,I[De])):(Ee[fe]=!0,B.push(fe),ue[fe]=se(Te,I[De]))}}for(var Ne=B.length,Pe=0;Pe<Ne;Pe++){var Ke=B[Pe];j[Pe]=ue[Ke]}return te[1]=B.length,x.createSparseMatrix({values:j,index:B,ptr:te,size:[$,1],datatype:N===x._datatype&&P===w._datatype?Z:void 0})}function b(x,w){var I=x._values,S=x._index,E=x._ptr,N=x._datatype||x._data===void 0?x._datatype:x.getDataType();if(!I)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var M=w._data,P=w._datatype||w.getDataType(),$=x._size[0],R=w._size[0],j=w._size[1],B,te=r,Z=n,ne=o,se=0;N&&P&&N===P&&typeof N=="string"&&N!=="mixed"&&(B=N,te=t.find(r,[B,B]),Z=t.find(n,[B,B]),ne=t.find(o,[B,B]),se=t.convert(0,B));for(var we=[],ie=[],ue=[],Ee=x.createSparseMatrix({values:we,index:ie,ptr:ue,size:[$,j],datatype:N===x._datatype&&P===w._datatype?B:void 0}),ye=[],Te=[],pe=0;pe<j;pe++){ue[pe]=ie.length;for(var be=pe+1,De=0;De<R;De++){var fe=M[De][pe];if(!ne(fe,se))for(var Ne=E[De],Pe=E[De+1],Ke=Ne;Ke<Pe;Ke++){var At=S[Ke];Te[At]!==be?(Te[At]=be,ie.push(At),ye[At]=Z(fe,I[Ke])):ye[At]=te(ye[At],Z(fe,I[Ke]))}}for(var bt=ue[pe],Kt=ie.length,zi=bt;zi<Kt;zi++){var Ki=ie[zi];we[zi]=ye[Ki]}}return ue[j]=ie.length,Ee}function y(x,w){var I=x._values,S=x._index,E=x._ptr,N=x._datatype||x._data===void 0?x._datatype:x.getDataType(),M=w._values,P=w._index,$=w._ptr,R=w._datatype||w._data===void 0?w._datatype:w.getDataType(),j=x._size[0],B=w._size[1],te=I&&M,Z,ne=r,se=n;N&&R&&N===R&&typeof N=="string"&&N!=="mixed"&&(Z=N,ne=t.find(r,[Z,Z]),se=t.find(n,[Z,Z]));for(var we=te?[]:void 0,ie=[],ue=[],Ee=x.createSparseMatrix({values:we,index:ie,ptr:ue,size:[j,B],datatype:N===x._datatype&&R===w._datatype?Z:void 0}),ye=te?[]:void 0,Te=[],pe,be,De,fe,Ne,Pe,Ke,At,bt=0;bt<B;bt++){ue[bt]=ie.length;var Kt=bt+1;for(Ne=$[bt],Pe=$[bt+1],fe=Ne;fe<Pe;fe++)if(At=P[fe],te)for(be=E[At],De=E[At+1],pe=be;pe<De;pe++)Ke=S[pe],Te[Ke]!==Kt?(Te[Ke]=Kt,ie.push(Ke),ye[Ke]=se(M[fe],I[pe])):ye[Ke]=ne(ye[Ke],se(M[fe],I[pe]));else for(be=E[At],De=E[At+1],pe=be;pe<De;pe++)Ke=S[pe],Te[Ke]!==Kt&&(Te[Ke]=Kt,ie.push(Ke));if(te)for(var zi=ue[bt],Ki=ie.length,br=zi;br<Ki;br++){var Wi=ie[br];we[br]=ye[Wi]}}return ue[B]=ie.length,Ee}return t(QG,n,{"Array, Array":t.referTo("Matrix, Matrix",x=>(w,I)=>{l(dr(w),dr(I));var S=x(i(w),i(I));return Di(S)?S.valueOf():S}),"Matrix, Matrix":function(w,I){var S=w.size(),E=I.size();return l(S,E),S.length===1?E.length===1?d(w,I,S[0]):u(w,I):E.length===1?p(w,I):m(w,I)},"Matrix, Array":t.referTo("Matrix,Matrix",x=>(w,I)=>x(w,i(I))),"Array, Matrix":t.referToSelf(x=>(w,I)=>x(i(w,I.storage()),I)),"SparseMatrix, any":function(w,I){return s(w,I,n,!1)},"DenseMatrix, any":function(w,I){return c(w,I,n,!1)},"any, SparseMatrix":function(w,I){return s(I,w,n,!0)},"any, DenseMatrix":function(w,I){return c(I,w,n,!0)},"Array, any":function(w,I){return c(i(w),I,n,!1).valueOf()},"any, Array":function(w,I){return c(i(I),w,n,!0).valueOf()},"any, any":n,"any, any, ...any":t.referToSelf(x=>(w,I,S)=>{for(var E=x(w,I),N=0;N<S.length;N++)E=x(E,S[N]);return E})})});var JG="sign",Iwe=["typed","BigNumber","Fraction","complex"],Uk=le(JG,Iwe,e=>{var{typed:t,BigNumber:i,complex:r,Fraction:n}=e;return t(JG,{number:Y2,Complex:function(a){return a.im===0?r(Y2(a.re)):a.sign()},BigNumber:function(a){return new i(a.cmp(0))},bigint:function(a){return a>0n?1n:a<0n?-1n:0n},Fraction:function(a){return new n(a.s,1)},"Array | Matrix":t.referToSelf(o=>a=>Rr(a,o,!0)),Unit:t.referToSelf(o=>a=>{if(!a._isDerived()&&a.units[0].unit.offset!==0)throw new TypeError("sign is ambiguous for units with offset");return t.find(o,a.valueType())(a.value)})})});var Mwe="sqrt",kwe=["config","typed","Complex"],Hk=le(Mwe,kwe,e=>{var{config:t,typed:i,Complex:r}=e;return i("sqrt",{number:n,Complex:function(a){return a.sqrt()},BigNumber:function(a){return!a.isNegative()||t.predictable?a.sqrt():n(a.toNumber())},Unit:function(a){return a.pow(.5)}});function n(o){return isNaN(o)?NaN:o>=0||t.predictable?Math.sqrt(o):new r(o,0).sqrt()}});var e$="subtract",Pwe=["typed","matrix","equalScalar","subtractScalar","unaryMinus","DenseMatrix","concat"],jk=le(e$,Pwe,e=>{var{typed:t,matrix:i,equalScalar:r,subtractScalar:n,unaryMinus:o,DenseMatrix:a,concat:s}=e,c=Q2({typed:t}),l=el({typed:t}),d=YG({typed:t,equalScalar:r}),u=J2({typed:t,DenseMatrix:a}),h=Js({typed:t,DenseMatrix:a}),p=ja({typed:t,matrix:i,concat:s});return t(e$,{"any, any":n},p({elop:n,SS:d,DS:c,SD:l,Ss:h,sS:u}))});var Nwe="matAlgo07xSSf",Owe=["typed","DenseMatrix"],sc=le(Nwe,Owe,e=>{var{typed:t,DenseMatrix:i}=e;return function(o,a,s){var c=o._size,l=o._datatype||o._data===void 0?o._datatype:o.getDataType(),d=a._size,u=a._datatype||a._data===void 0?a._datatype:a.getDataType();if(c.length!==d.length)throw new wi(c.length,d.length);if(c[0]!==d[0]||c[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+d+")");var h=c[0],p=c[1],m,f=0,g=s;typeof l=="string"&&l===u&&l!=="mixed"&&(m=l,f=t.convert(0,m),g=t.find(s,[m,m]));var v,_,b=[];for(v=0;v<h;v++)b[v]=[];var y=[],x=[],w=[],I=[];for(_=0;_<p;_++){var S=_+1;for(r(o,_,w,y,S),r(a,_,I,x,S),v=0;v<h;v++){var E=w[v]===S?y[v]:f,N=I[v]===S?x[v]:f;b[v][_]=g(E,N)}}return new i({data:b,size:[h,p],datatype:l===o._datatype&&u===a._datatype?m:void 0})};function r(n,o,a,s,c){for(var l=n._values,d=n._index,u=n._ptr,h=u[o],p=u[o+1];h<p;h++){var m=d[h];a[m]=c,s[m]=l[h]}}});var t$="conj",Rwe=["typed"],Gk=le(t$,Rwe,e=>{var{typed:t}=e;return t(t$,{"number | BigNumber | Fraction":i=>i,Complex:i=>i.conjugate(),"Array | Matrix":t.referToSelf(i=>r=>Rr(r,i))})});var i$="im",Fwe=["typed"],$k=le(i$,Fwe,e=>{var{typed:t}=e;return t(i$,{number:()=>0,"BigNumber | Fraction":i=>i.mul(0),Complex:i=>i.im,"Array | Matrix":t.referToSelf(i=>r=>Rr(r,i))})});var r$="re",Lwe=["typed"],Wk=le(r$,Lwe,e=>{var{typed:t}=e;return t(r$,{"number | BigNumber | Fraction":i=>i,Complex:i=>i.re,"Array | Matrix":t.referToSelf(i=>r=>Rr(r,i))})});var n$="concat",Bwe=["typed","matrix","isInteger"],qk=le(n$,Bwe,e=>{var{typed:t,matrix:i,isInteger:r}=e;return t(n$,{"...Array | Matrix | number | BigNumber":function(o){var a,s=o.length,c=-1,l,d=!1,u=[];for(a=0;a<s;a++){var h=o[a];if(Di(h)&&(d=!0),Vi(h)||Gi(h)){if(a!==s-1)throw new Error("Dimension must be specified as last argument");if(l=c,c=h.valueOf(),!r(c))throw new TypeError("Integer number expected for dimension");if(c<0||a>0&&c>l)throw new id(c,l+1)}else{var p=hi(h).valueOf(),m=dr(p);if(u[a]=p,l=c,c=m.length-1,a>0&&c!==l)throw new wi(l+1,c+1)}}if(u.length===0)throw new SyntaxError("At least one matrix expected");for(var f=u.shift();u.length;)f=fk(f,u.shift(),c);return d?i(f):f},"...string":function(o){return o.join("")}})});var o$="column",Vwe=["typed","Index","matrix","range"],Xk=le(o$,Vwe,e=>{var{typed:t,Index:i,matrix:r,range:n}=e;return t(o$,{"Matrix, number":o,"Array, number":function(s,c){return o(r(hi(s)),c).valueOf()}});function o(a,s){if(a.size().length!==2)throw new Error("Only two dimensional matrix is supported");zr(s,a.size()[1]);var c=n(0,a.size()[0]),l=new i(c,s),d=a.subset(l);return Di(d)?d:r([[d]])}});var a$="diag",zwe=["typed","matrix","DenseMatrix","SparseMatrix"],Yk=le(a$,zwe,e=>{var{typed:t,matrix:i,DenseMatrix:r,SparseMatrix:n}=e;return t(a$,{Array:function(l){return o(l,0,dr(l),null)},"Array, number":function(l,d){return o(l,d,dr(l),null)},"Array, BigNumber":function(l,d){return o(l,d.toNumber(),dr(l),null)},"Array, string":function(l,d){return o(l,0,dr(l),d)},"Array, number, string":function(l,d,u){return o(l,d,dr(l),u)},"Array, BigNumber, string":function(l,d,u){return o(l,d.toNumber(),dr(l),u)},Matrix:function(l){return o(l,0,l.size(),l.storage())},"Matrix, number":function(l,d){return o(l,d,l.size(),l.storage())},"Matrix, BigNumber":function(l,d){return o(l,d.toNumber(),l.size(),l.storage())},"Matrix, string":function(l,d){return o(l,0,l.size(),d)},"Matrix, number, string":function(l,d,u){return o(l,d,l.size(),u)},"Matrix, BigNumber, string":function(l,d,u){return o(l,d.toNumber(),l.size(),u)}});function o(c,l,d,u){if(!xi(l))throw new TypeError("Second parameter in function diag must be an integer");var h=l>0?l:0,p=l<0?-l:0;switch(d.length){case 1:return a(c,l,u,d[0],p,h);case 2:return s(c,l,u,d,p,h)}throw new RangeError("Matrix for function diag must be 2 dimensional")}function a(c,l,d,u,h,p){var m=[u+h,u+p];if(d&&d!=="sparse"&&d!=="dense")throw new TypeError("Unknown matrix type ".concat(d,'"'));var f=d==="sparse"?n.diagonal(m,c,l):r.diagonal(m,c,l);return d!==null?f:f.valueOf()}function s(c,l,d,u,h,p){if(Di(c)){var m=c.diagonal(l);return d!==null?d!==m.storage()?i(m,d):m:m.valueOf()}for(var f=Math.min(u[0]-h,u[1]-p),g=[],v=0;v<f;v++)g[v]=c[v+h][v+p];return d!==null?i(g):g}});var s$="flatten",Uwe=["typed"],Zk=le(s$,Uwe,e=>{var{typed:t}=e;return t(s$,{Array:function(r){return q2(r)},Matrix:function(r){return r.create(q2(r.toArray()),r.datatype())}})});var l$="getMatrixDataType",Hwe=["typed"],Kk=le(l$,Hwe,e=>{var{typed:t}=e;return t(l$,{Array:function(r){return Sp(r,Hn)},Matrix:function(r){return r.getDataType()}})});var c$="identity",jwe=["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],Qk=le(c$,jwe,e=>{var{typed:t,config:i,matrix:r,BigNumber:n,DenseMatrix:o,SparseMatrix:a}=e;return t(c$,{"":function(){return i.matrix==="Matrix"?r([]):[]},string:function(d){return r(d)},"number | BigNumber":function(d){return c(d,d,i.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, string":function(d,u){return c(d,d,u)},"number | BigNumber, number | BigNumber":function(d,u){return c(d,u,i.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(d,u,h){return c(d,u,h)},Array:function(d){return s(d)},"Array, string":function(d,u){return s(d,u)},Matrix:function(d){return s(d.valueOf(),d.storage())},"Matrix, string":function(d,u){return s(d.valueOf(),u)}});function s(l,d){switch(l.length){case 0:return d?r(d):[];case 1:return c(l[0],l[0],d);case 2:return c(l[0],l[1],d);default:throw new Error("Vector containing two values expected")}}function c(l,d,u){var h=Gi(l)||Gi(d)?n:null;if(Gi(l)&&(l=l.toNumber()),Gi(d)&&(d=d.toNumber()),!xi(l)||l<1)throw new Error("Parameters in function identity must be positive integers");if(!xi(d)||d<1)throw new Error("Parameters in function identity must be positive integers");var p=h?new n(1):1,m=h?new h(0):0,f=[l,d];if(u){if(u==="sparse")return a.diagonal(f,p,0,m);if(u==="dense")return o.diagonal(f,p,0,m);throw new TypeError('Unknown matrix type "'.concat(u,'"'))}for(var g=Cp([],f,m),v=l<d?l:d,_=0;_<v;_++)g[_][_]=p;return g}});function eE(){throw new Error('No "bignumber" implementation available')}function d$(){throw new Error('No "fraction" implementation available')}function tE(){throw new Error('No "matrix" implementation available')}var u$="range",Gwe=["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],Jk=le(u$,Gwe,e=>{var{typed:t,config:i,matrix:r,bignumber:n,smaller:o,smallerEq:a,larger:s,largerEq:c,add:l,isPositive:d}=e;return t(u$,{string:h,"string, boolean":h,"number, number":function(g,v){return u(p(g,v,1,!1))},"number, number, number":function(g,v,_){return u(p(g,v,_,!1))},"number, number, boolean":function(g,v,_){return u(p(g,v,1,_))},"number, number, number, boolean":function(g,v,_,b){return u(p(g,v,_,b))},"BigNumber, BigNumber":function(g,v){var _=g.constructor;return u(p(g,v,new _(1),!1))},"BigNumber, BigNumber, BigNumber":function(g,v,_){return u(p(g,v,_,!1))},"BigNumber, BigNumber, boolean":function(g,v,_){var b=g.constructor;return u(p(g,v,new b(1),_))},"BigNumber, BigNumber, BigNumber, boolean":function(g,v,_,b){return u(p(g,v,_,b))},"Unit, Unit, Unit":function(g,v,_){return u(p(g,v,_,!1))},"Unit, Unit, Unit, boolean":function(g,v,_,b){return u(p(g,v,_,b))}});function u(f){return i.matrix==="Matrix"?r?r(f):tE():f}function h(f,g){var v=m(f);if(!v)throw new SyntaxError('String "'+f+'" is no valid range');return i.number==="BigNumber"?(n===void 0&&eE(),u(p(n(v.start),n(v.end),n(v.step)),g)):u(p(v.start,v.end,v.step,g))}function p(f,g,v,_){for(var b=[],y=d(v)?_?a:o:_?c:s,x=f;y(x,g);)b.push(x),x=l(x,v);return b}function m(f){var g=f.split(":"),v=g.map(function(b){return Number(b)}),_=v.some(function(b){return isNaN(b)});if(_)return null;switch(v.length){case 2:return{start:v[0],end:v[1],step:1};case 3:return{start:v[0],end:v[2],step:v[1]};default:return null}}});var h$="reshape",$we=["typed","isInteger","matrix"],eP=le(h$,$we,e=>{var{typed:t,isInteger:i}=e;return t(h$,{"Matrix, Array":function(n,o){return n.reshape(o,!0)},"Array, Array":function(n,o){return o.forEach(function(a){if(!i(a))throw new TypeError("Invalid size for dimension: "+a)}),x_(n,o)}})});var p$="size",Wwe=["typed","config","?matrix"],tP=le(p$,Wwe,e=>{var{typed:t,config:i,matrix:r}=e;return t(p$,{Matrix:function(o){return o.create(o.size(),"number")},Array:dr,string:function(o){return i.matrix==="Array"?[o.length]:r([o.length],"dense","number")},"number | Complex | BigNumber | Unit | boolean | null":function(o){return i.matrix==="Array"?[]:r?r([],"dense","number"):tE()}})});var f$="transpose",qwe=["typed","matrix"],iP=le(f$,qwe,e=>{var{typed:t,matrix:i}=e;return t(f$,{Array:a=>r(i(a)).valueOf(),Matrix:r,any:hi});function r(a){var s=a.size(),c;switch(s.length){case 1:c=a.clone();break;case 2:{var l=s[0],d=s[1];if(d===0)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+Zi(s)+")");switch(a.storage()){case"dense":c=n(a,l,d);break;case"sparse":c=o(a,l,d);break}}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+Zi(s)+")")}return c}function n(a,s,c){for(var l=a._data,d=[],u,h=0;h<c;h++){u=d[h]=[];for(var p=0;p<s;p++)u[p]=hi(l[p][h])}return a.createDenseMatrix({data:d,size:[c,s],datatype:a._datatype})}function o(a,s,c){for(var l=a._values,d=a._index,u=a._ptr,h=l?[]:void 0,p=[],m=[],f=[],g=0;g<s;g++)f[g]=0;var v,_,b;for(v=0,_=d.length;v<_;v++)f[d[v]]++;for(var y=0,x=0;x<s;x++)m.push(y),y+=f[x],f[x]=m[x];for(m.push(y),b=0;b<c;b++)for(var w=u[b],I=u[b+1],S=w;S<I;S++){var E=f[d[S]]++;p[E]=b,l&&(h[E]=hi(l[S]))}return a.createSparseMatrix({values:h,index:p,ptr:m,size:[c,s],datatype:a._datatype})}});var m$="zeros",Xwe=["typed","config","matrix","BigNumber"],rP=le(m$,Xwe,e=>{var{typed:t,config:i,matrix:r,BigNumber:n}=e;return t(m$,{"":function(){return i.matrix==="Array"?o([]):o([],"default")},"...number | BigNumber | string":function(l){var d=l[l.length-1];if(typeof d=="string"){var u=l.pop();return o(l,u)}else return i.matrix==="Array"?o(l):o(l,"default")},Array:o,Matrix:function(l){var d=l.storage();return o(l.valueOf(),d)},"Array | Matrix, string":function(l,d){return o(l.valueOf(),d)}});function o(c,l){var d=a(c),u=d?new n(0):0;if(s(c),l){var h=r(l);return c.length>0?h.resize(c,u):h}else{var p=[];return c.length>0?Cp(p,c,u):p}}function a(c){var l=!1;return c.forEach(function(d,u,h){Gi(d)&&(l=!0,h[u]=d.toNumber())}),l}function s(c){c.forEach(function(l){if(typeof l!="number"||!xi(l)||l<0)throw new Error("Parameters in function zeros must be positive integers")})}});var Ywe="numeric",Zwe=["number","?bignumber","?fraction"],nP=le(Ywe,Zwe,e=>{var{number:t,bignumber:i,fraction:r}=e,n={string:!0,number:!0,BigNumber:!0,Fraction:!0},o={number:a=>t(a),BigNumber:i?a=>i(a):eE,bigint:a=>BigInt(a),Fraction:r?a=>r(a):d$};return function(s){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"number",l=arguments.length>2?arguments[2]:void 0;if(l!==void 0)throw new SyntaxError("numeric() takes one or two arguments");var d=Hn(s);if(!(d in n))throw new TypeError("Cannot convert "+s+' of type "'+d+'"; valid input types are '+Object.keys(n).join(", "));if(!(c in o))throw new TypeError("Cannot convert "+s+' to type "'+c+'"; valid output types are '+Object.keys(o).join(", "));return c===d?s:o[c](s)}});var g$="divideScalar",Kwe=["typed","numeric"],oP=le(g$,Kwe,e=>{var{typed:t,numeric:i}=e;return t(g$,{"number, number":function(n,o){return n/o},"Complex, Complex":function(n,o){return n.div(o)},"BigNumber, BigNumber":function(n,o){return n.div(o)},"bigint, bigint":function(n,o){return n/o},"Fraction, Fraction":function(n,o){return n.div(o)},"Unit, number | Complex | Fraction | BigNumber | Unit":(r,n)=>r.divide(n),"number | Fraction | Complex | BigNumber, Unit":(r,n)=>n.divideInto(r)})});function iE(e){var{DenseMatrix:t}=e;return function(r,n,o){var a=r.size();if(a.length!==2)throw new RangeError("Matrix must be two dimensional (size: "+Zi(a)+")");var s=a[0],c=a[1];if(s!==c)throw new RangeError("Matrix must be square (size: "+Zi(a)+")");var l=[];if(Di(n)){var d=n.size(),u=n._data;if(d.length===1){if(d[0]!==s)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var h=0;h<s;h++)l[h]=[u[h]];return new t({data:l,size:[s,1],datatype:n._datatype})}if(d.length===2){if(d[0]!==s||d[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(M2(n)){if(o){l=[];for(var p=0;p<s;p++)l[p]=[u[p][0]];return new t({data:l,size:[s,1],datatype:n._datatype})}return n}if(k2(n)){for(var m=0;m<s;m++)l[m]=[0];for(var f=n._values,g=n._index,v=n._ptr,_=v[1],b=v[0];b<_;b++){var y=g[b];l[y][0]=f[b]}return new t({data:l,size:[s,1],datatype:n._datatype})}}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(or(n)){var x=dr(n);if(x.length===1){if(x[0]!==s)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var w=0;w<s;w++)l[w]=[n[w]];return new t({data:l,size:[s,1]})}if(x.length===2){if(x[0]!==s||x[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var I=0;I<s;I++)l[I]=[n[I][0]];return new t({data:l,size:[s,1]})}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}var v$="usolve",Qwe=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],aP=le(v$,Qwe,e=>{var{typed:t,matrix:i,divideScalar:r,multiplyScalar:n,subtractScalar:o,equalScalar:a,DenseMatrix:s}=e,c=iE({DenseMatrix:s});return t(v$,{"SparseMatrix, Array | Matrix":function(h,p){return d(h,p)},"DenseMatrix, Array | Matrix":function(h,p){return l(h,p)},"Array, Array | Matrix":function(h,p){var m=i(h),f=l(m,p);return f.valueOf()}});function l(u,h){h=c(u,h,!0);for(var p=h._data,m=u._size[0],f=u._size[1],g=[],v=u._data,_=f-1;_>=0;_--){var b=p[_][0]||0,y=void 0;if(a(b,0))y=0;else{var x=v[_][_];if(a(x,0))throw new Error("Linear system cannot be solved since matrix is singular");y=r(b,x);for(var w=_-1;w>=0;w--)p[w]=[o(p[w][0]||0,n(y,v[w][_]))]}g[_]=[y]}return new s({data:g,size:[m,1]})}function d(u,h){h=c(u,h,!0);for(var p=h._data,m=u._size[0],f=u._size[1],g=u._values,v=u._index,_=u._ptr,b=[],y=f-1;y>=0;y--){var x=p[y][0]||0;if(a(x,0))b[y]=[0];else{for(var w=0,I=[],S=[],E=_[y],N=_[y+1],M=N-1;M>=E;M--){var P=v[M];P===y?w=g[M]:P<y&&(I.push(g[M]),S.push(P))}if(a(w,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var $=r(x,w),R=0,j=S.length;R<j;R++){var B=S[R];p[B]=[o(p[B][0],n($,I[R]))]}b[y]=[$]}}return new s({data:b,size:[m,1]})}});var _$="usolveAll",Jwe=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],sP=le(_$,Jwe,e=>{var{typed:t,matrix:i,divideScalar:r,multiplyScalar:n,subtractScalar:o,equalScalar:a,DenseMatrix:s}=e,c=iE({DenseMatrix:s});return t(_$,{"SparseMatrix, Array | Matrix":function(h,p){return d(h,p)},"DenseMatrix, Array | Matrix":function(h,p){return l(h,p)},"Array, Array | Matrix":function(h,p){var m=i(h),f=l(m,p);return f.map(g=>g.valueOf())}});function l(u,h){for(var p=[c(u,h,!0)._data.map(S=>S[0])],m=u._data,f=u._size[0],g=u._size[1],v=g-1;v>=0;v--)for(var _=p.length,b=0;b<_;b++){var y=p[b];if(a(m[v][v],0))if(a(y[v],0)){if(b===0){var w=[...y];w[v]=1;for(var I=v-1;I>=0;I--)w[I]=o(w[I],m[I][v]);p.push(w)}}else{if(b===0)return[];p.splice(b,1),b-=1,_-=1}else{y[v]=r(y[v],m[v][v]);for(var x=v-1;x>=0;x--)y[x]=o(y[x],n(y[v],m[x][v]))}}return p.map(S=>new s({data:S.map(E=>[E]),size:[f,1]}))}function d(u,h){for(var p=[c(u,h,!0)._data.map(we=>we[0])],m=u._size[0],f=u._size[1],g=u._values,v=u._index,_=u._ptr,b=f-1;b>=0;b--)for(var y=p.length,x=0;x<y;x++){for(var w=p[x],I=[],S=[],E=_[b],N=_[b+1],M=0,P=N-1;P>=E;P--){var $=v[P];$===b?M=g[P]:$<b&&(I.push(g[P]),S.push($))}if(a(M,0))if(a(w[b],0)){if(x===0){var te=[...w];te[b]=1;for(var Z=0,ne=S.length;Z<ne;Z++){var se=S[Z];te[se]=o(te[se],I[Z])}p.push(te)}}else{if(x===0)return[];p.splice(x,1),x-=1,y-=1}else{w[b]=r(w[b],M);for(var R=0,j=S.length;R<j;R++){var B=S[R];w[B]=o(w[B],n(w[b],I[R]))}}}return p.map(we=>new s({data:we.map(ie=>[ie]),size:[m,1]}))}});var rE="equal",e1e=["typed","matrix","equalScalar","DenseMatrix","concat"],lP=le(rE,e1e,e=>{var{typed:t,matrix:i,equalScalar:r,DenseMatrix:n,concat:o}=e,a=el({typed:t}),s=sc({typed:t,DenseMatrix:n}),c=Js({typed:t,DenseMatrix:n}),l=ja({typed:t,matrix:i,concat:o});return t(rE,t1e({typed:t,equalScalar:r}),l({elop:r,SS:s,DS:a,Ss:c}))}),t1e=le(rE,["typed","equalScalar"],e=>{var{typed:t,equalScalar:i}=e;return t(rE,{"any, any":function(n,o){return n===null?o===null:o===null?n===null:n===void 0?o===void 0:o===void 0?n===void 0:i(n,o)}})});var nE="smaller",i1e=["typed","config","matrix","DenseMatrix","concat"],cP=le(nE,i1e,e=>{var{typed:t,config:i,matrix:r,DenseMatrix:n,concat:o}=e,a=el({typed:t}),s=sc({typed:t,DenseMatrix:n}),c=Js({typed:t,DenseMatrix:n}),l=ja({typed:t,matrix:r,concat:o}),d=ac({typed:t});return t(nE,r1e({typed:t,config:i}),{"boolean, boolean":(u,h)=>u<h,"BigNumber, BigNumber":function(h,p){return h.lt(p)&&!Qs(h,p,i.relTol,i.absTol)},"bigint, bigint":(u,h)=>u<h,"Fraction, Fraction":(u,h)=>u.compare(h)===-1,"Complex, Complex":function(h,p){throw new TypeError("No ordering relation is defined for complex numbers")}},d,l({SS:s,DS:a,Ss:c}))}),r1e=le(nE,["typed","config"],e=>{var{typed:t,config:i}=e;return t(nE,{"number, number":function(n,o){return n<o&&!Uo(n,o,i.relTol,i.absTol)}})});var oE="smallerEq",n1e=["typed","config","matrix","DenseMatrix","concat"],dP=le(oE,n1e,e=>{var{typed:t,config:i,matrix:r,DenseMatrix:n,concat:o}=e,a=el({typed:t}),s=sc({typed:t,DenseMatrix:n}),c=Js({typed:t,DenseMatrix:n}),l=ja({typed:t,matrix:r,concat:o}),d=ac({typed:t});return t(oE,o1e({typed:t,config:i}),{"boolean, boolean":(u,h)=>u<=h,"BigNumber, BigNumber":function(h,p){return h.lte(p)||Qs(h,p,i.relTol,i.absTol)},"bigint, bigint":(u,h)=>u<=h,"Fraction, Fraction":(u,h)=>u.compare(h)!==1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},d,l({SS:s,DS:a,Ss:c}))}),o1e=le(oE,["typed","config"],e=>{var{typed:t,config:i}=e;return t(oE,{"number, number":function(n,o){return n<=o||Uo(n,o,i.relTol,i.absTol)}})});var aE="larger",a1e=["typed","config","matrix","DenseMatrix","concat"],uP=le(aE,a1e,e=>{var{typed:t,config:i,matrix:r,DenseMatrix:n,concat:o}=e,a=el({typed:t}),s=sc({typed:t,DenseMatrix:n}),c=Js({typed:t,DenseMatrix:n}),l=ja({typed:t,matrix:r,concat:o}),d=ac({typed:t});return t(aE,s1e({typed:t,config:i}),{"boolean, boolean":(u,h)=>u>h,"BigNumber, BigNumber":function(h,p){return h.gt(p)&&!Qs(h,p,i.relTol,i.absTol)},"bigint, bigint":(u,h)=>u>h,"Fraction, Fraction":(u,h)=>u.compare(h)===1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},d,l({SS:s,DS:a,Ss:c}))}),s1e=le(aE,["typed","config"],e=>{var{typed:t,config:i}=e;return t(aE,{"number, number":function(n,o){return n>o&&!Uo(n,o,i.relTol,i.absTol)}})});var sE="largerEq",l1e=["typed","config","matrix","DenseMatrix","concat"],hP=le(sE,l1e,e=>{var{typed:t,config:i,matrix:r,DenseMatrix:n,concat:o}=e,a=el({typed:t}),s=sc({typed:t,DenseMatrix:n}),c=Js({typed:t,DenseMatrix:n}),l=ja({typed:t,matrix:r,concat:o}),d=ac({typed:t});return t(sE,c1e({typed:t,config:i}),{"boolean, boolean":(u,h)=>u>=h,"BigNumber, BigNumber":function(h,p){return h.gte(p)||Qs(h,p,i.relTol,i.absTol)},"bigint, bigint":function(h,p){return h>=p},"Fraction, Fraction":(u,h)=>u.compare(h)!==-1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},d,l({SS:s,DS:a,Ss:c}))}),c1e=le(sE,["typed","config"],e=>{var{typed:t,config:i}=e;return t(sE,{"number, number":function(n,o){return n>=o||Uo(n,o,i.relTol,i.absTol)}})});var d1e="ImmutableDenseMatrix",u1e=["smaller","DenseMatrix"],pP=le(d1e,u1e,e=>{var{smaller:t,DenseMatrix:i}=e;function r(n,o){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(o&&!go(o))throw new Error("Invalid datatype: "+o);if(Di(n)||or(n)){var a=new i(n,o);this._data=a._data,this._size=a._size,this._datatype=a._datatype,this._min=null,this._max=null}else if(n&&or(n.data)&&or(n.size))this._data=n.data,this._size=n.size,this._datatype=n.datatype,this._min=typeof n.min<"u"?n.min:null,this._max=typeof n.max<"u"?n.max:null;else{if(n)throw new TypeError("Unsupported type of data ("+Hn(n)+")");this._data=[],this._size=[0],this._datatype=o,this._min=null,this._max=null}}return r.prototype=new i,r.prototype.type="ImmutableDenseMatrix",r.prototype.isImmutableDenseMatrix=!0,r.prototype.subset=function(n){switch(arguments.length){case 1:{var o=i.prototype.subset.call(this,n);return Di(o)?new r({data:o._data,size:o._size,datatype:o._datatype}):o}case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},r.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},r.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},r.prototype.clone=function(){return new r({data:hi(this._data),size:hi(this._size),datatype:this._datatype})},r.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.fromJSON=function(n){return new r(n)},r.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},r.prototype.min=function(){if(this._min===null){var n=null;this.forEach(function(o){(n===null||t(o,n))&&(n=o)}),this._min=n!==null?n:void 0}return this._min},r.prototype.max=function(){if(this._max===null){var n=null;this.forEach(function(o){(n===null||t(n,o))&&(n=o)}),this._max=n!==null?n:void 0}return this._max},r},{isClass:!0});var h1e="Index",p1e=["ImmutableDenseMatrix","getMatrixDataType"],fP=le(h1e,p1e,e=>{var{ImmutableDenseMatrix:t,getMatrixDataType:i}=e;function r(o){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._sourceSize=[],this._isScalar=!0;for(var a=0,s=arguments.length;a<s;a++){var c=arguments[a],l=or(c),d=Di(c),u=null;if(P2(c))this._dimensions.push(c),this._isScalar=!1;else if(l||d){var h=void 0;i(c)==="boolean"?(l&&(h=n(b$(c).valueOf())),d&&(h=n(b$(c._data).valueOf())),u=c.valueOf().length):h=n(c.valueOf()),this._dimensions.push(h);var p=h.size();(p.length!==1||p[0]!==1||u!==null)&&(this._isScalar=!1)}else if(typeof c=="number")this._dimensions.push(n([c]));else if(typeof c=="string")this._dimensions.push(c);else throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._sourceSize.push(u)}}r.prototype.type="Index",r.prototype.isIndex=!0;function n(o){for(var a=0,s=o.length;a<s;a++)if(typeof o[a]!="number"||!xi(o[a]))throw new TypeError("Index parameters must be positive integer numbers");return new t(o)}return r.prototype.clone=function(){var o=new r;return o._dimensions=hi(this._dimensions),o._isScalar=this._isScalar,o._sourceSize=this._sourceSize,o},r.create=function(o){var a=new r;return r.apply(a,o),a},r.prototype.size=function(){for(var o=[],a=0,s=this._dimensions.length;a<s;a++){var c=this._dimensions[a];o[a]=typeof c=="string"?1:c.size()[0]}return o},r.prototype.max=function(){for(var o=[],a=0,s=this._dimensions.length;a<s;a++){var c=this._dimensions[a];o[a]=typeof c=="string"?c:c.max()}return o},r.prototype.min=function(){for(var o=[],a=0,s=this._dimensions.length;a<s;a++){var c=this._dimensions[a];o[a]=typeof c=="string"?c:c.min()}return o},r.prototype.forEach=function(o){for(var a=0,s=this._dimensions.length;a<s;a++)o(this._dimensions[a],a,this)},r.prototype.dimension=function(o){return this._dimensions[o]||null},r.prototype.isObjectProperty=function(){return this._dimensions.length===1&&typeof this._dimensions[0]=="string"},r.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},r.prototype.isScalar=function(){return this._isScalar},r.prototype.toArray=function(){for(var o=[],a=0,s=this._dimensions.length;a<s;a++){var c=this._dimensions[a];o.push(typeof c=="string"?c:c.toArray())}return o},r.prototype.valueOf=r.prototype.toArray,r.prototype.toString=function(){for(var o=[],a=0,s=this._dimensions.length;a<s;a++){var c=this._dimensions[a];typeof c=="string"?o.push(JSON.stringify(c)):o.push(c.toString())}return"["+o.join(", ")+"]"},r.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},r.fromJSON=function(o){return r.create(o.dimensions)},r},{isClass:!0});function b$(e){var t=[];return e.forEach((i,r)=>{i&&t.push(r)}),t}var f1e="atan",m1e=["typed"],mP=le(f1e,m1e,e=>{var{typed:t}=e;return t("atan",{number:function(r){return Math.atan(r)},Complex:function(r){return r.atan()},BigNumber:function(r){return r.atan()}})});var lE=le("trigUnit",["typed"],e=>{var{typed:t}=e;return{Unit:t.referToSelf(i=>r=>{if(!r.hasBase(r.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return t.find(i,r.valueType())(r.value)})}});var y$="cos",g1e=["typed"],gP=le(y$,g1e,e=>{var{typed:t}=e,i=lE({typed:t});return t(y$,{number:Math.cos,"Complex | BigNumber":r=>r.cos()},i)});var x$="sin",v1e=["typed"],vP=le(x$,v1e,e=>{var{typed:t}=e,i=lE({typed:t});return t(x$,{number:Math.sin,"Complex | BigNumber":r=>r.sin()},i)});var w$="add",_1e=["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],_P=le(w$,_1e,e=>{var{typed:t,matrix:i,addScalar:r,equalScalar:n,DenseMatrix:o,SparseMatrix:a,concat:s}=e,c=Q2({typed:t}),l=KG({typed:t,equalScalar:n}),d=J2({typed:t,DenseMatrix:o}),u=ja({typed:t,matrix:i,concat:s});return t(w$,{"any, any":r,"any, any, ...any":t.referToSelf(h=>(p,m,f)=>{for(var g=h(p,m),v=0;v<f.length;v++)g=h(g,f[v]);return g})},u({elop:r,DS:c,SS:l,Ss:d}))});var E$="dot",b1e=["typed","addScalar","multiplyScalar","conj","size"],bP=le(E$,b1e,e=>{var{typed:t,addScalar:i,multiplyScalar:r,conj:n,size:o}=e;return t(E$,{"Array | DenseMatrix, Array | DenseMatrix":s,"SparseMatrix, SparseMatrix":c});function a(d,u){var h=l(d),p=l(u),m,f;if(h.length===1)m=h[0];else if(h.length===2&&h[1]===1)m=h[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+h.join(", ")+")");if(p.length===1)f=p[0];else if(p.length===2&&p[1]===1)f=p[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+p.join(", ")+")");if(m!==f)throw new RangeError("Vectors must have equal length ("+m+" != "+f+")");if(m===0)throw new RangeError("Cannot calculate the dot product of empty vectors");return m}function s(d,u){var h=a(d,u),p=Di(d)?d._data:d,m=Di(d)?d._datatype||d.getDataType():void 0,f=Di(u)?u._data:u,g=Di(u)?u._datatype||u.getDataType():void 0,v=l(d).length===2,_=l(u).length===2,b=i,y=r;if(m&&g&&m===g&&typeof m=="string"&&m!=="mixed"){var x=m;b=t.find(i,[x,x]),y=t.find(r,[x,x])}if(!v&&!_){for(var w=y(n(p[0]),f[0]),I=1;I<h;I++)w=b(w,y(n(p[I]),f[I]));return w}if(!v&&_){for(var S=y(n(p[0]),f[0][0]),E=1;E<h;E++)S=b(S,y(n(p[E]),f[E][0]));return S}if(v&&!_){for(var N=y(n(p[0][0]),f[0]),M=1;M<h;M++)N=b(N,y(n(p[M][0]),f[M]));return N}if(v&&_){for(var P=y(n(p[0][0]),f[0][0]),$=1;$<h;$++)P=b(P,y(n(p[$][0]),f[$][0]));return P}}function c(d,u){a(d,u);for(var h=d._index,p=d._values,m=u._index,f=u._values,g=0,v=i,_=r,b=0,y=0;b<h.length&&y<m.length;){var x=h[b],w=m[y];if(x<w){b++;continue}if(x>w){y++;continue}x===w&&(g=v(g,_(p[b],f[y])),b++,y++)}return g}function l(d){return Di(d)?d.size():o(d)}});var C$="qr",y1e=["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtractScalar","complex"],yP=le(C$,y1e,e=>{var{typed:t,matrix:i,zeros:r,identity:n,isZero:o,equal:a,sign:s,sqrt:c,conj:l,unaryMinus:d,addScalar:u,divideScalar:h,multiplyScalar:p,subtractScalar:m,complex:f}=e;return nc(t(C$,{DenseMatrix:function(y){return v(y)},SparseMatrix:function(y){return _(y)},Array:function(y){var x=i(y),w=v(x);return{Q:w.Q.valueOf(),R:w.R.valueOf()}}}),{_denseQRimpl:g});function g(b){var y=b._size[0],x=b._size[1],w=n([y],"dense"),I=w._data,S=b.clone(),E=S._data,N,M,P,$=r([y],"");for(P=0;P<Math.min(x,y);++P){var R=E[P][P],j=d(a(R,0)?1:s(R)),B=l(j),te=0;for(N=P;N<y;N++)te=u(te,p(E[N][P],l(E[N][P])));var Z=p(j,c(te));if(!o(Z)){var ne=m(R,Z);for($[P]=1,N=P+1;N<y;N++)$[N]=h(E[N][P],ne);var se=d(l(h(ne,Z))),we=void 0;for(M=P;M<x;M++){for(we=0,N=P;N<y;N++)we=u(we,p(l($[N]),E[N][M]));for(we=p(we,se),N=P;N<y;N++)E[N][M]=p(m(E[N][M],p($[N],we)),B)}for(N=0;N<y;N++){for(we=0,M=P;M<y;M++)we=u(we,p(I[N][M],$[M]));for(we=p(we,se),M=P;M<y;++M)I[N][M]=h(m(I[N][M],p(we,l($[M]))),B)}}}return{Q:w,R:S,toString:function(){return"Q: "+this.Q.toString()+`
R: `+this.R.toString()}}}function v(b){var y=g(b),x=y.R._data;if(b._data.length>0)for(var w=x[0][0].type==="Complex"?f(0):0,I=0;I<x.length;++I)for(var S=0;S<I&&S<(x[0]||[]).length;++S)x[I][S]=w;return y}function _(b){throw new Error("qr not implemented for sparse matrices yet")}});var S$="det",x1e=["typed","matrix","subtractScalar","multiply","divideScalar","isZero","unaryMinus"],xP=le(S$,x1e,e=>{var{typed:t,matrix:i,subtractScalar:r,multiply:n,divideScalar:o,isZero:a,unaryMinus:s}=e;return t(S$,{any:function(d){return hi(d)},"Array | Matrix":function(d){var u;switch(Di(d)?u=d.size():Array.isArray(d)?(d=i(d),u=d.size()):u=[],u.length){case 0:return hi(d);case 1:if(u[0]===1)return hi(d.valueOf()[0]);if(u[0]===0)return 1;throw new RangeError("Matrix must be square (size: "+Zi(u)+")");case 2:{var h=u[0],p=u[1];if(h===p)return c(d.clone().valueOf(),h,p);if(p===0)return 1;throw new RangeError("Matrix must be square (size: "+Zi(u)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+Zi(u)+")")}}});function c(l,d,u){if(d===1)return hi(l[0][0]);if(d===2)return r(n(l[0][0],l[1][1]),n(l[1][0],l[0][1]));for(var h=!1,p=new Array(d).fill(0).map((I,S)=>S),m=0;m<d;m++){var f=p[m];if(a(l[f][m])){var g=void 0;for(g=m+1;g<d;g++)if(!a(l[p[g]][m])){f=p[g],p[g]=p[m],p[m]=f,h=!h;break}if(g===d)return l[f][m]}for(var v=l[f][m],_=m===0?1:l[p[m-1]][m-1],b=m+1;b<d;b++)for(var y=p[b],x=m+1;x<d;x++)l[y][x]=o(r(n(l[y][x],v),n(l[y][m],l[f][x])),_)}var w=l[p[d-1]][d-1];return h?s(w):w}});var T$="inv",w1e=["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],wP=le(T$,w1e,e=>{var{typed:t,matrix:i,divideScalar:r,addScalar:n,multiply:o,unaryMinus:a,det:s,identity:c,abs:l}=e;return t(T$,{"Array | Matrix":function(h){var p=Di(h)?h.size():dr(h);switch(p.length){case 1:if(p[0]===1)return Di(h)?i([r(1,h.valueOf()[0])]):[r(1,h[0])];throw new RangeError("Matrix must be square (size: "+Zi(p)+")");case 2:{var m=p[0],f=p[1];if(m===f)return Di(h)?i(d(h.valueOf(),m,f),h.storage()):d(h,m,f);throw new RangeError("Matrix must be square (size: "+Zi(p)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+Zi(p)+")")}},any:function(h){return r(1,h)}});function d(u,h,p){var m,f,g,v,_;if(h===1){if(v=u[0][0],v===0)throw Error("Cannot calculate inverse, determinant is zero");return[[r(1,v)]]}else if(h===2){var b=s(u);if(b===0)throw Error("Cannot calculate inverse, determinant is zero");return[[r(u[1][1],b),r(a(u[0][1]),b)],[r(a(u[1][0]),b),r(u[0][0],b)]]}else{var y=u.concat();for(m=0;m<h;m++)y[m]=y[m].concat();for(var x=c(h).valueOf(),w=0;w<p;w++){var I=l(y[w][w]),S=w;for(m=w+1;m<h;)l(y[m][w])>I&&(I=l(y[m][w]),S=m),m++;if(I===0)throw Error("Cannot calculate inverse, determinant is zero");m=S,m!==w&&(_=y[w],y[w]=y[m],y[m]=_,_=x[w],x[w]=x[m],x[m]=_);var E=y[w],N=x[w];for(m=0;m<h;m++){var M=y[m],P=x[m];if(m!==w){if(M[w]!==0){for(g=r(a(M[w]),E[w]),f=w;f<p;f++)M[f]=n(M[f],o(g,E[f]));for(f=0;f<p;f++)P[f]=n(P[f],o(g,N[f]))}}else{for(g=E[w],f=w;f<p;f++)M[f]=r(M[f],g);for(f=0;f<p;f++)P[f]=r(P[f],g)}}}return x}}});function A$(e){var{addScalar:t,subtract:i,flatten:r,multiply:n,multiplyScalar:o,divideScalar:a,sqrt:s,abs:c,bignumber:l,diag:d,size:u,reshape:h,inv:p,qr:m,usolve:f,usolveAll:g,equal:v,complex:_,larger:b,smaller:y,matrixFromColumns:x,dot:w}=e;function I(ie,ue,Ee,ye){var Te=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,pe=S(ie,ue,Ee,ye,Te);E(ie,ue,Ee,ye,Te,pe);var{values:be,C:De}=N(ie,ue,Ee,ye,Te);if(Te){var fe=M(ie,ue,De,pe,be,Ee,ye);return{values:be,eigenvectors:fe}}return{values:be}}function S(ie,ue,Ee,ye,Te){var pe=ye==="BigNumber",be=ye==="Complex",De=pe?l(0):0,fe=pe?l(1):be?_(1):1,Ne=pe?l(1):1,Pe=pe?l(10):2,Ke=o(Pe,Pe),At;Te&&(At=Array(ue).fill(fe));for(var bt=!1;!bt;){bt=!0;for(var Kt=0;Kt<ue;Kt++){for(var zi=De,Ki=De,br=0;br<ue;br++)Kt!==br&&(zi=t(zi,c(ie[br][Kt])),Ki=t(Ki,c(ie[Kt][br])));if(!v(zi,0)&&!v(Ki,0)){for(var Wi=Ne,Qi=zi,hn=a(Ki,Pe),gi=o(Ki,Pe);y(Qi,hn);)Qi=o(Qi,Ke),Wi=o(Wi,Pe);for(;b(Qi,gi);)Qi=a(Qi,Ke),Wi=a(Wi,Pe);var Zr=y(a(t(Qi,Ki),Wi),o(t(zi,Ki),.95));if(Zr){bt=!1;for(var ys=a(1,Wi),Wn=0;Wn<ue;Wn++)Kt!==Wn&&(ie[Kt][Wn]=o(ie[Kt][Wn],ys),ie[Wn][Kt]=o(ie[Wn][Kt],Wi));Te&&(At[Kt]=o(At[Kt],ys))}}}}return Te?d(At):null}function E(ie,ue,Ee,ye,Te,pe){var be=ye==="BigNumber",De=ye==="Complex",fe=be?l(0):De?_(0):0;be&&(Ee=l(Ee));for(var Ne=0;Ne<ue-2;Ne++){for(var Pe=0,Ke=fe,At=Ne+1;At<ue;At++){var bt=ie[At][Ne];y(c(Ke),c(bt))&&(Ke=bt,Pe=At)}if(!y(c(Ke),Ee)){if(Pe!==Ne+1){var Kt=ie[Pe];ie[Pe]=ie[Ne+1],ie[Ne+1]=Kt;for(var zi=0;zi<ue;zi++){var Ki=ie[zi][Pe];ie[zi][Pe]=ie[zi][Ne+1],ie[zi][Ne+1]=Ki}if(Te){var br=pe[Pe];pe[Pe]=pe[Ne+1],pe[Ne+1]=br}}for(var Wi=Ne+2;Wi<ue;Wi++){var Qi=a(ie[Wi][Ne],Ke);if(Qi!==0){for(var hn=0;hn<ue;hn++)ie[Wi][hn]=i(ie[Wi][hn],o(Qi,ie[Ne+1][hn]));for(var gi=0;gi<ue;gi++)ie[gi][Ne+1]=t(ie[gi][Ne+1],o(Qi,ie[gi][Wi]));if(Te)for(var Zr=0;Zr<ue;Zr++)pe[Wi][Zr]=i(pe[Wi][Zr],o(Qi,pe[Ne+1][Zr]))}}}}return pe}function N(ie,ue,Ee,ye,Te){var pe=ye==="BigNumber",be=ye==="Complex",De=pe?l(1):be?_(1):1;pe&&(Ee=l(Ee));for(var fe=hi(ie),Ne=[],Pe=ue,Ke=[],At=Te?d(Array(ue).fill(De)):void 0,bt=Te?d(Array(Pe).fill(De)):void 0,Kt=0;Kt<=100;){Kt+=1;for(var zi=fe[Pe-1][Pe-1],Ki=0;Ki<Pe;Ki++)fe[Ki][Ki]=i(fe[Ki][Ki],zi);var{Q:br,R:Wi}=m(fe);fe=n(Wi,br);for(var Qi=0;Qi<Pe;Qi++)fe[Qi][Qi]=t(fe[Qi][Qi],zi);if(Te&&(bt=n(bt,br)),Pe===1||y(c(fe[Pe-1][Pe-2]),Ee)){Kt=0,Ne.push(fe[Pe-1][Pe-1]),Te&&(Ke.unshift([[1]]),R(bt,ue),At=n(At,bt),Pe>1&&(bt=d(Array(Pe-1).fill(De)))),Pe-=1,fe.pop();for(var hn=0;hn<Pe;hn++)fe[hn].pop()}else if(Pe===2||y(c(fe[Pe-2][Pe-3]),Ee)){Kt=0;var gi=P(fe[Pe-2][Pe-2],fe[Pe-2][Pe-1],fe[Pe-1][Pe-2],fe[Pe-1][Pe-1]);Ne.push(...gi),Te&&(Ke.unshift($(fe[Pe-2][Pe-2],fe[Pe-2][Pe-1],fe[Pe-1][Pe-2],fe[Pe-1][Pe-1],gi[0],gi[1],Ee,ye)),R(bt,ue),At=n(At,bt),Pe>2&&(bt=d(Array(Pe-2).fill(De)))),Pe-=2,fe.pop(),fe.pop();for(var Zr=0;Zr<Pe;Zr++)fe[Zr].pop(),fe[Zr].pop()}if(Pe===0)break}if(Ne.sort((qo,Tn)=>+i(c(qo),c(Tn))),Kt>100){var ys=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+Ne.join(", "));throw ys.values=Ne,ys.vectors=[],ys}var Wn=Te?n(At,j(Ke,ue)):void 0;return{values:Ne,C:Wn}}function M(ie,ue,Ee,ye,Te,pe,be){var De=p(Ee),fe=n(De,ie,Ee),Ne=be==="BigNumber",Pe=be==="Complex",Ke=Ne?l(0):Pe?_(0):0,At=Ne?l(1):Pe?_(1):1,bt=[],Kt=[];for(var zi of Te){var Ki=B(bt,zi,v);Ki===-1?(bt.push(zi),Kt.push(1)):Kt[Ki]+=1}for(var br=[],Wi=bt.length,Qi=Array(ue).fill(Ke),hn=d(Array(ue).fill(At)),gi=function(){var Wn=bt[Zr],qo=i(fe,n(Wn,hn)),Tn=g(qo,Qi);for(Tn.shift();Tn.length<Kt[Zr];){var H=te(qo,ue,Tn,pe,be);if(H===null)break;Tn.push(H)}var ee=n(p(ye),Ee);Tn=Tn.map(ce=>n(ee,ce)),br.push(...Tn.map(ce=>({value:Wn,vector:r(ce)})))},Zr=0;Zr<Wi;Zr++)gi();return br}function P(ie,ue,Ee,ye){var Te=t(ie,ye),pe=i(o(ie,ye),o(ue,Ee)),be=o(Te,.5),De=o(s(i(o(Te,Te),o(4,pe))),.5);return[t(be,De),i(be,De)]}function $(ie,ue,Ee,ye,Te,pe,be,De){var fe=De==="BigNumber",Ne=De==="Complex",Pe=fe?l(0):Ne?_(0):0,Ke=fe?l(1):Ne?_(1):1;if(y(c(Ee),be))return[[Ke,Pe],[Pe,Ke]];if(b(c(i(Te,pe)),be))return[[i(Te,ye),i(pe,ye)],[Ee,Ee]];var At=i(ie,Te),bt=i(ye,Te);return y(c(ue),be)&&y(c(bt),be)?[[At,Ke],[Ee,Pe]]:[[ue,Pe],[bt,Ke]]}function R(ie,ue){for(var Ee=0;Ee<ie.length;Ee++)ie[Ee].push(...Array(ue-ie[Ee].length).fill(0));for(var ye=ie.length;ye<ue;ye++)ie.push(Array(ue).fill(0)),ie[ye][ye]=1;return ie}function j(ie,ue){for(var Ee=[],ye=0;ye<ue;ye++)Ee[ye]=Array(ue).fill(0);var Te=0;for(var pe of ie){for(var be=pe.length,De=0;De<be;De++)for(var fe=0;fe<be;fe++)Ee[Te+De][Te+fe]=pe[De][fe];Te+=be}return Ee}function B(ie,ue,Ee){for(var ye=0;ye<ie.length;ye++)if(Ee(ie[ye],ue))return ye;return-1}function te(ie,ue,Ee,ye,Te){for(var pe=Te==="BigNumber"?l(1e3):1e3,be,De=0;De<5;++De){be=Z(ue,Ee,Te);try{be=f(ie,be)}catch{continue}if(b(se(be),pe))break}if(De>=5)return null;for(De=0;;){var fe=f(ie,be);if(y(se(ne(be,[fe])),ye))break;if(++De>=10)return null;be=we(fe)}return be}function Z(ie,ue,Ee){var ye=Ee==="BigNumber",Te=Ee==="Complex",pe=Array(ie).fill(0).map(be=>2*Math.random()-1);return ye&&(pe=pe.map(be=>l(be))),Te&&(pe=pe.map(be=>_(be))),pe=ne(pe,ue),we(pe,Ee)}function ne(ie,ue){var Ee=u(ie);for(var ye of ue)ye=h(ye,Ee),ie=i(ie,n(a(w(ye,ie),w(ye,ye)),ye));return ie}function se(ie){return c(s(w(ie,ie)))}function we(ie,ue){var Ee=ue==="BigNumber",ye=ue==="Complex",Te=Ee?l(1):ye?_(1):1;return n(a(Te,se(ie)),ie)}return I}function D$(e){var{config:t,addScalar:i,subtract:r,abs:n,atan:o,cos:a,sin:s,multiplyScalar:c,inv:l,bignumber:d,multiply:u,add:h}=e;function p(E,N){var M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.relTol,P=arguments.length>3?arguments[3]:void 0,$=arguments.length>4?arguments[4]:void 0;if(P==="number")return m(E,M,$);if(P==="BigNumber")return f(E,M,$);throw TypeError("Unsupported data type: "+P)}function m(E,N,M){var P=E.length,$=Math.abs(N/P),R,j;if(M){j=new Array(P);for(var B=0;B<P;B++)j[B]=Array(P).fill(0),j[B][B]=1}for(var te=w(E);Math.abs(te[1])>=Math.abs($);){var Z=te[0][0],ne=te[0][1];R=g(E[Z][Z],E[ne][ne],E[Z][ne]),E=x(E,R,Z,ne),M&&(j=_(j,R,Z,ne)),te=w(E)}for(var se=Array(P).fill(0),we=0;we<P;we++)se[we]=E[we][we];return S(hi(se),j,M)}function f(E,N,M){var P=E.length,$=n(N/P),R,j;if(M){j=new Array(P);for(var B=0;B<P;B++)j[B]=Array(P).fill(0),j[B][B]=1}for(var te=I(E);n(te[1])>=n($);){var Z=te[0][0],ne=te[0][1];R=v(E[Z][Z],E[ne][ne],E[Z][ne]),E=y(E,R,Z,ne),M&&(j=b(j,R,Z,ne)),te=I(E)}for(var se=Array(P).fill(0),we=0;we<P;we++)se[we]=E[we][we];return S(hi(se),j,M)}function g(E,N,M){var P=N-E;return Math.abs(P)<=t.relTol?Math.PI/4:.5*Math.atan(2*M/(N-E))}function v(E,N,M){var P=r(N,E);return n(P)<=t.relTol?d(-1).acos().div(4):c(.5,o(u(2,M,l(P))))}function _(E,N,M,P){for(var $=E.length,R=Math.cos(N),j=Math.sin(N),B=Array($).fill(0),te=Array($).fill(0),Z=0;Z<$;Z++)B[Z]=R*E[Z][M]-j*E[Z][P],te[Z]=j*E[Z][M]+R*E[Z][P];for(var ne=0;ne<$;ne++)E[ne][M]=B[ne],E[ne][P]=te[ne];return E}function b(E,N,M,P){for(var $=E.length,R=a(N),j=s(N),B=Array($).fill(d(0)),te=Array($).fill(d(0)),Z=0;Z<$;Z++)B[Z]=r(c(R,E[Z][M]),c(j,E[Z][P])),te[Z]=i(c(j,E[Z][M]),c(R,E[Z][P]));for(var ne=0;ne<$;ne++)E[ne][M]=B[ne],E[ne][P]=te[ne];return E}function y(E,N,M,P){for(var $=E.length,R=d(a(N)),j=d(s(N)),B=c(R,R),te=c(j,j),Z=Array($).fill(d(0)),ne=Array($).fill(d(0)),se=u(d(2),R,j,E[M][P]),we=i(r(c(B,E[M][M]),se),c(te,E[P][P])),ie=h(c(te,E[M][M]),se,c(B,E[P][P])),ue=0;ue<$;ue++)Z[ue]=r(c(R,E[M][ue]),c(j,E[P][ue])),ne[ue]=i(c(j,E[M][ue]),c(R,E[P][ue]));E[M][M]=we,E[P][P]=ie,E[M][P]=d(0),E[P][M]=d(0);for(var Ee=0;Ee<$;Ee++)Ee!==M&&Ee!==P&&(E[M][Ee]=Z[Ee],E[Ee][M]=Z[Ee],E[P][Ee]=ne[Ee],E[Ee][P]=ne[Ee]);return E}function x(E,N,M,P){for(var $=E.length,R=Math.cos(N),j=Math.sin(N),B=R*R,te=j*j,Z=Array($).fill(0),ne=Array($).fill(0),se=B*E[M][M]-2*R*j*E[M][P]+te*E[P][P],we=te*E[M][M]+2*R*j*E[M][P]+B*E[P][P],ie=0;ie<$;ie++)Z[ie]=R*E[M][ie]-j*E[P][ie],ne[ie]=j*E[M][ie]+R*E[P][ie];E[M][M]=se,E[P][P]=we,E[M][P]=0,E[P][M]=0;for(var ue=0;ue<$;ue++)ue!==M&&ue!==P&&(E[M][ue]=Z[ue],E[ue][M]=Z[ue],E[P][ue]=ne[ue],E[ue][P]=ne[ue]);return E}function w(E){for(var N=E.length,M=0,P=[0,1],$=0;$<N;$++)for(var R=$+1;R<N;R++)Math.abs(M)<Math.abs(E[$][R])&&(M=Math.abs(E[$][R]),P=[$,R]);return[P,M]}function I(E){for(var N=E.length,M=0,P=[0,1],$=0;$<N;$++)for(var R=$+1;R<N;R++)n(M)<n(E[$][R])&&(M=n(E[$][R]),P=[$,R]);return[P,M]}function S(E,N,M){var P=E.length,$=Array(P),R;if(M){R=Array(P);for(var j=0;j<P;j++)R[j]=Array(P)}for(var B=0;B<P;B++){for(var te=0,Z=E[0],ne=0;ne<E.length;ne++)n(E[ne])<n(Z)&&(te=ne,Z=E[te]);if($[B]=E.splice(te,1)[0],M)for(var se=0;se<P;se++)R[B][se]=N[se][te],N[se].splice(te,1)}if(!M)return{values:$};var we=R.map((ie,ue)=>({value:$[ue],vector:ie}));return{values:$,eigenvectors:we}}return p}var E1e="eigs",C1e=["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","size","reshape","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],EP=le(E1e,C1e,e=>{var{config:t,typed:i,matrix:r,addScalar:n,subtract:o,equal:a,abs:s,atan:c,cos:l,sin:d,multiplyScalar:u,divideScalar:h,inv:p,bignumber:m,multiply:f,add:g,larger:v,column:_,flatten:b,number:y,complex:x,sqrt:w,diag:I,size:S,reshape:E,qr:N,usolve:M,usolveAll:P,im:$,re:R,smaller:j,matrixFromColumns:B,dot:te}=e,Z=D$({config:t,addScalar:n,subtract:o,column:_,flatten:b,equal:a,abs:s,atan:c,cos:l,sin:d,multiplyScalar:u,inv:p,bignumber:m,complex:x,multiply:f,add:g}),ne=A$({config:t,addScalar:n,subtract:o,multiply:f,multiplyScalar:u,flatten:b,divideScalar:h,sqrt:w,abs:s,bignumber:m,diag:I,size:S,reshape:E,qr:N,inv:p,usolve:M,usolveAll:P,equal:a,complex:x,larger:v,smaller:j,matrixFromColumns:B,dot:te});return i("eigs",{Array:function(pe){return se(r(pe))},"Array, number|BigNumber":function(pe,be){return se(r(pe),{precision:be})},"Array, Object"(Te,pe){return se(r(Te),pe)},Matrix:function(pe){return se(pe,{matricize:!0})},"Matrix, number|BigNumber":function(pe,be){return se(pe,{precision:be,matricize:!0})},"Matrix, Object":function(pe,be){var De={matricize:!0};return nc(De,be),se(pe,De)}});function se(Te){var pe,be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},De="eigenvectors"in be?be.eigenvectors:!0,fe=(pe=be.precision)!==null&&pe!==void 0?pe:t.relTol,Ne=we(Te,fe,De);return be.matricize&&(Ne.values=r(Ne.values),De&&(Ne.eigenvectors=Ne.eigenvectors.map(Pe=>{var{value:Ke,vector:At}=Pe;return{value:Ke,vector:r(At)}}))),De&&Object.defineProperty(Ne,"vectors",{enumerable:!1,get:()=>{throw new Error("eigs(M).vectors replaced with eigs(M).eigenvectors")}}),Ne}function we(Te,pe,be){var De=Te.toArray(),fe=Te.size();if(fe.length!==2||fe[0]!==fe[1])throw new RangeError("Matrix must be square (size: ".concat(Zi(fe),")"));var Ne=fe[0];if(ue(De,Ne,pe)&&(Ee(De,Ne),ie(De,Ne,pe))){var Pe=ye(Te,De,Ne);return Z(De,Ne,pe,Pe,be)}var Ke=ye(Te,De,Ne);return ne(De,Ne,pe,Ke,be)}function ie(Te,pe,be){for(var De=0;De<pe;De++)for(var fe=De;fe<pe;fe++)if(v(m(s(o(Te[De][fe],Te[fe][De]))),be))return!1;return!0}function ue(Te,pe,be){for(var De=0;De<pe;De++)for(var fe=0;fe<pe;fe++)if(v(m(s($(Te[De][fe]))),be))return!1;return!0}function Ee(Te,pe){for(var be=0;be<pe;be++)for(var De=0;De<pe;De++)Te[be][De]=R(Te[be][De])}function ye(Te,pe,be){var De=Te.datatype();if(De==="number"||De==="BigNumber"||De==="Complex")return De;for(var fe=!1,Ne=!1,Pe=!1,Ke=0;Ke<be;Ke++)for(var At=0;At<be;At++){var bt=pe[Ke][At];if(Vi(bt)||v_(bt))fe=!0;else if(Gi(bt))Ne=!0;else if(g_(bt))Pe=!0;else throw TypeError("Unsupported type in Matrix: "+Hn(bt))}if(Ne&&Pe&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),Pe){for(var Kt=0;Kt<be;Kt++)for(var zi=0;zi<be;zi++)pe[Kt][zi]=x(pe[Kt][zi]);return"Complex"}if(Ne){for(var Ki=0;Ki<be;Ki++)for(var br=0;br<be;br++)pe[Ki][br]=m(pe[Ki][br]);return"BigNumber"}if(fe){for(var Wi=0;Wi<be;Wi++)for(var Qi=0;Qi<be;Qi++)pe[Wi][Qi]=y(pe[Wi][Qi]);return"number"}else throw TypeError("Matrix contains unsupported types only.")}});var S_=ok({config:ma}),CP=sk({});var SP=ck({});var TP=dk({});var Ga=vk({Matrix:TP});var $t=KM({BigNumber:S_,Complex:CP,DenseMatrix:Ga,Fraction:SP});var I$=Fk({typed:$t});var og=Lk({typed:$t});var S1e=mP({typed:$t});var AP=kk({Complex:CP,typed:$t}),M$=Gk({typed:$t}),T1e=gP({typed:$t});var Su=Ak({config:ma,typed:$t});var k$=Zk({typed:$t});var A1e=Kk({typed:$t});var D1e=$k({typed:$t}),P$=_k({typed:$t});var I1e=Sk({config:ma,typed:$t}),N$=Tk({equalScalar:Su,typed:$t});var ag=Vk({typed:$t});var O$=Ik({typed:$t});var M1e=Wk({typed:$t});var k1e=Uk({BigNumber:S_,Fraction:SP,complex:AP,typed:$t}),P1e=vP({typed:$t}),cE=Dk({Matrix:TP,equalScalar:Su,typed:$t});var T_=Bk({typed:$t});var DP=Mk({BigNumber:S_,typed:$t});var R$=Hk({Complex:CP,config:ma,typed:$t});var dE=Rk({typed:$t});var N1e=Pk({Fraction:SP,typed:$t});var Ur=Nk({DenseMatrix:Ga,Matrix:TP,SparseMatrix:cE,typed:$t});var O1e=nP({bignumber:DP,fraction:N1e,number:O$});var R1e=eP({isInteger:P$,matrix:Ur,typed:$t}),IP=tP({matrix:Ur,config:ma,typed:$t}),F$=iP({matrix:Ur,typed:$t});var F1e=rP({BigNumber:S_,config:ma,matrix:Ur,typed:$t});var Tp=qk({isInteger:P$,matrix:Ur,typed:$t});var L1e=Yk({DenseMatrix:Ga,SparseMatrix:cE,matrix:Ur,typed:$t}),sg=oP({numeric:O1e,typed:$t});var L$=lP({DenseMatrix:Ga,concat:Tp,equalScalar:Su,matrix:Ur,typed:$t});var B$=Qk({BigNumber:S_,DenseMatrix:Ga,SparseMatrix:cE,config:ma,matrix:Ur,typed:$t});var B1e=hP({DenseMatrix:Ga,concat:Tp,config:ma,matrix:Ur,typed:$t});var V1e=Ok({flatten:k$,matrix:Ur,size:IP,typed:$t});var z1e=yP({addScalar:og,complex:AP,conj:M$,divideScalar:sg,equal:L$,identity:B$,isZero:N$,matrix:Ur,multiplyScalar:ag,sign:k1e,sqrt:R$,subtractScalar:T_,typed:$t,unaryMinus:dE,zeros:F1e});var MP=cP({DenseMatrix:Ga,concat:Tp,config:ma,matrix:Ur,typed:$t}),U1e=jk({DenseMatrix:Ga,concat:Tp,equalScalar:Su,matrix:Ur,subtractScalar:T_,typed:$t,unaryMinus:dE});var H1e=aP({DenseMatrix:Ga,divideScalar:sg,equalScalar:Su,matrix:Ur,multiplyScalar:ag,subtractScalar:T_,typed:$t});var V$=_P({DenseMatrix:Ga,SparseMatrix:cE,addScalar:og,concat:Tp,equalScalar:Su,matrix:Ur,typed:$t});var z$=bP({addScalar:og,conj:M$,multiplyScalar:ag,size:IP,typed:$t});var j1e=pP({DenseMatrix:Ga,smaller:MP}),G1e=fP({ImmutableDenseMatrix:j1e,getMatrixDataType:A1e}),U$=uP({DenseMatrix:Ga,concat:Tp,config:ma,matrix:Ur,typed:$t});var lg=zk({addScalar:og,dot:z$,equalScalar:Su,matrix:Ur,multiplyScalar:ag,typed:$t});var $1e=sP({DenseMatrix:Ga,divideScalar:sg,equalScalar:Su,matrix:Ur,multiplyScalar:ag,subtractScalar:T_,typed:$t});var W1e=xP({divideScalar:sg,isZero:N$,matrix:Ur,multiply:lg,subtractScalar:T_,typed:$t,unaryMinus:dE});var q1e=dP({DenseMatrix:Ga,concat:Tp,config:ma,matrix:Ur,typed:$t});var X1e=Jk({bignumber:DP,matrix:Ur,add:V$,config:ma,isPositive:I1e,larger:U$,largerEq:B1e,smaller:MP,smallerEq:q1e,typed:$t});var Y1e=Xk({Index:G1e,matrix:Ur,range:X1e,typed:$t}),Z1e=wP({abs:I$,addScalar:og,det:W1e,divideScalar:sg,identity:B$,matrix:Ur,multiply:lg,typed:$t,unaryMinus:dE});var H$=EP({abs:I$,add:V$,addScalar:og,atan:S1e,bignumber:DP,column:Y1e,complex:AP,config:ma,cos:T1e,diag:L1e,divideScalar:sg,dot:z$,equal:L$,flatten:k$,im:D1e,inv:Z1e,larger:U$,matrix:Ur,matrixFromColumns:V1e,multiply:lg,multiplyScalar:ag,number:O$,qr:z1e,re:M1e,reshape:R1e,sin:P1e,size:IP,smaller:MP,sqrt:R$,subtract:U1e,typed:$t,usolve:H1e,usolveAll:$1e});function j$(e){let t=e.length,i=e[0].length;if(t!=2||i!=2)throw new Error("Only 2x2 matrices are supported for MMt_solution");let r=HM(e,jM(e)),n=K1e(r),o=n.vectors,a=[[Math.sqrt(n.values[0]),0],[0,Math.sqrt(n.values[1])]];return HM(jM(o),a)}function K1e(e){let t=e.length,i=new Array(t).fill(0).map(()=>new Array(t).fill(0)),r=1,n=-1*(e[0][0]+e[1][1]),o=e[0][0]*e[1][1]-e[0][1]*e[1][0],a=Math.sqrt(n*n-4*r*o),s=(-n+a)/(2*r),c=(-n-a)/(2*r);e[0][0]-s==0||e[0][0]-c==0?(i[0]=[1,-e[1][0]/(e[1][1]-s)],i[1]=[1,-e[1][0]/(e[1][1]-c)]):(i[0]=[-e[0][1]/(e[0][0]-s),1],i[1]=[-e[0][1]/(e[0][0]-c),1]);let l=Math.sqrt(i[0][0]**2+i[0][1]**2),d=Math.sqrt(i[1][0]**2+i[1][1]**2);return i[0]=[i[0][0]/l,i[0][1]/l],i[1]=[i[1][0]/d,i[1][1]/d],s>c?{values:[s,c],vectors:i}:{values:[c,s],vectors:[i[1],i[0]]}}function G$(e){let t=e.length,i=e[0].length,r=new Array(i).fill(0);e.forEach(h=>{h.forEach((p,m)=>{r[m]+=p})}),r=r.map(h=>h/t);let n=e.map(h=>h.map((p,m)=>p-r[m])),o=Ur(n),a=lg(F$(o),o),c=H$(a).eigenvectors,l=new Array;for(let h=0;h<c.length;h++)l.push(c[h].vector.valueOf());let d=new Array(t);for(let h=0;h<t;h++)d[h]=lg(l,n[h]).valueOf();let u=new Array(i).fill(0);d.forEach(h=>{h.forEach((p,m)=>{u[m]+=p**2})}),u=u.map(h=>h/t),u=u.map(h=>h);for(let h=0;h<i;h++)for(let p=0;p<i;p++)l[h][p]*=u[h];return{data:d,mean:r,U:l}}function Q1e(e,t){let i=e.length;for(let n=0;n<i;n++){let o=n;for(let a=n+1;a<i;a++)Math.abs(e[a][n])>Math.abs(e[o][n])&&(o=a);[e[n],e[o]]=[e[o],e[n]],[t[n],t[o]]=[t[o],t[n]];for(let a=n+1;a<i;a++){let s=e[a][n]/e[n][n];for(let c=n;c<i;c++)e[a][c]-=s*e[n][c];t[a]-=s*t[n]}}let r=new Array(i).fill(0);for(let n=i-1;n>=0;n--){let o=t[n];for(let a=n+1;a<i;a++)o-=e[n][a]*r[a];r[n]=o/e[n][n]}return r}function $$(e,t,i){let r=e.length,n=i,o=[],a=[];for(let c=0;c<=n;c++){o[c]=[];for(let d=0;d<=n;d++){let u=0;for(let h=0;h<r;h++)u+=Math.pow(e[h],c+d);o[c][d]=u}let l=0;for(let d=0;d<r;d++)l+=t[d]*Math.pow(e[d],c);a[c]=l}return Q1e(o,a)}function cg(e=0,t=1){let i=1-Math.random(),r=Math.random();return Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*r)*t+e}function Ap(e,t={x:0,y:0},i={x:1,y:1}){let r=new Array(e);if(i instanceof Array){if(i[1][0]===0)for(let n=0;n<e;n++)r[n]={x:cg(t.x,i[0][0]),y:cg(t.y,i[1][1])};else{let n=j$(i);for(let o=0;o<e;o++){let a=cg(0,1),s=cg(0,1);r[o]={x:t.x+n[0][0]*a+n[0][1]*s,y:t.y+n[1][0]*a+n[1][1]*s}}}return r}for(let n=0;n<e;n++)r[n]={x:cg(t.x,i.x),y:cg(t.y,i.y)};return r}function A_(e,t,i){return Math.min(Math.max(e,t),i)}function W$(e,t){let i=e.length;if(t==null){let r=e.reduce((n,o)=>n+o)/i}return Math.sqrt(e.map(r=>Math.pow(r-t,2)).reduce((r,n)=>r+n)/i)}function kP(e){return e.reduce((t,i)=>t+i)/e.length}function q$(e=0,t=1){let i=1-Math.random(),r=Math.random();return Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*r)*t+e}function X$(e,t,i){let r=[];for(let n=e;n<t;n+=i)r.push(n);return r}function D_(e,t,i){let r=(t-e)/(i-1);return X$(e,t+r,r)}function PP(e,t,i=!1){let r=[],n=X$(0,e.length,1);if(i)for(let o=0;o<t;o++)r.push(e[n[Math.floor(Math.random()*n.length)]]);else for(let o=0;o<t;o++){let a=Math.floor(Math.random()*n.length);r.push(e[a]),n.splice(a,1)}return r}var Y$=(()=>{class e{x_range=[-10,10];y_range=[-10,10];w_max=5;w_min=0;b_max=20;b_min=-20;lin_separability=!0;positiveBorder=[[this.x_range[0],this.y_range[0]],[this.x_range[1],this.y_range[1]],[this.x_range[1],this.y_range[0]],[this.x_range[0],this.y_range[0]]];negativeBorder=[[this.x_range[0],this.y_range[0]],[this.x_range[1],this.y_range[1]],[this.x_range[1],this.y_range[1]],[this.x_range[0],this.y_range[1]],[this.x_range[0],this.y_range[0]]];w=1;b=0;echartInstance;echartInstance3D;loss_3d_data;data_chart={legend:{align:"left"},tooltip:{},xAxis:{min:this.x_range[0],max:this.x_range[1]},yAxis:{min:this.y_range[0],max:this.y_range[1]},series:[{type:"scatter",encode:{tooltip:[0,1]},symbolSize:5,color:"green"},{type:"scatter",encode:{tooltip:[0,1]},symbolSize:5,color:"red"},{type:"line",data:this.positiveBorder,showSymbol:!1,areaStyle:{color:"green",opacity:.3},color:"black",z:-1},{type:"line",data:this.negativeBorder,showSymbol:!1,areaStyle:{color:"red",opacity:.3},lineStyle:{width:0},z:-1}],animationEasing:"elasticOut",animationDelayUpdate:i=>i};option_3d_graph={tooltip:{},visualMap:{show:!0,dimension:2,min:0,max:75,inRange:{color:["#313695","#4575b4","#74add1","#abd9e9","#fee090","#fdae61","#f46d43","#d73027","#a50026"]}},xAxis3D:{type:"value",name:"W"},yAxis3D:{type:"value",name:"b"},zAxis3D:{type:"value",name:"loss",axisLabel:{show:!1}},grid3D:{viewControl:{projection:"orthographic"}},series:[{type:"surface",tooltip:{show:!1},wireframe:{show:!0},data:[]},{type:"scatter3D",data:[[this.w,this.b,this.compute_loss(this.w,this.b)]],symbolSize:20}]};ptClass1;ptClass2;nPoints=100;constructor(){}ngOnInit(){this.distribute_points(),this.update_fx()}distribute_points(){this.lin_separability?(this.ptClass1=Ap(this.nPoints,{x:5,y:-5},{x:4,y:4}),this.ptClass2=Ap(this.nPoints,{x:-5,y:5},{x:4,y:4})):(this.ptClass1=Ap(this.nPoints,{x:0,y:0},{x:1,y:1}),this.ptClass2=Ap(this.nPoints,{x:0,y:0},{x:.1,y:.1}),this.ptClass2.forEach(n=>{let o=Math.sqrt(n.x*n.x+n.y*n.y);n.x=n.x*(5+5/o),n.y=n.y*(5+5/o)}));let i={data:this.ptClass1.map(n=>({value:[A_(n.x,this.x_range[0],this.x_range[1]),A_(n.y,this.y_range[0],this.y_range[1])]}))},r={data:this.ptClass2.map(n=>({value:[A_(n.x,this.x_range[0],this.x_range[1]),A_(n.y,this.y_range[0],this.y_range[1])]}))};Array.isArray(this.data_chart.series)&&(this.data_chart.series[0].data=i.data,this.data_chart.series[1].data=r.data),this.loss_3d_data=this.get_3D_data(),this.option_3d_graph.series[0].data=this.loss_3d_data,this.update_charts()}update_charts(){this.echartInstance?.setOption(this.data_chart),this.echartInstance3D?.setOption(this.option_3d_graph)}get_3D_data(){let i=new Array,r=50;for(let n=0;n<=r;n++)for(let o=0;o<=r;o++){let a=this.w_min+n*(this.w_max-this.w_min)/r,s=this.b_min+o*(this.b_max-this.b_min)/r,c=this.compute_loss(a,s);i.push([a,s,c])}return i}onChartInit(i){this.echartInstance=i}onChartInit3D(i){this.echartInstance3D=i}update_b(i){this.b=i,this.update_fx()}update_w(i){this.w=i,this.update_fx()}update_fx(){let i=[this.x_range[0],this.w*this.x_range[0]+this.b],r=[this.x_range[1],this.w*this.x_range[1]+this.b];this.positiveBorder[0]=i,this.positiveBorder[1]=r,this.negativeBorder[0]=i,this.negativeBorder[1]=r,this.option_3d_graph.series[1].data=[[this.w,this.b,this.compute_loss(this.w,this.b)]],this.update_charts()}compute_loss_v2(i,r){let n=0,o=Math.sqrt(1+i*i);for(let a=0;a<this.nPoints;a++){let s=this.ptClass1[a],c=this.ptClass2[a];n+=Math.abs(s.y+s.x*i+r)/o,n+=Math.abs(c.y+c.x*i+r)/o}return n/this.nPoints}compute_loss(i,r){let n=0,o=Math.sqrt(1+i*i);for(let a=0;a<this.nPoints;a++){let s=this.ptClass1[a],c=this.ptClass2[a];n+=+(s.y-s.x*i-r>0),n+=+(c.y-c.x*i-r<0)}return 100*n/(this.nPoints*2)}change_points_distributions(i){this.lin_separability=i.value=="linear",this.distribute_points(),this.update_fx()}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Le({type:e,selectors:[["app-weights-loss"]],decls:16,vars:12,consts:[[3,"rightDrawer"],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["title","Slope",3,"valueChange","max","min","step","value"],["title","Intercept",3,"valueChange","max","min","step","value"],["name","fontStyle","aria-label","Font Style",3,"change"],["value","linear",3,"checked"],["value","non_linear"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["echarts","",1,"graph",3,"chartInit","options"]],template:function(r,n){r&1&&(C(0,"app-tutorial-template",0),Ot(1,1),C(2,"h3"),W(3," Tunable parameters "),A(),C(4,"app-labelled-sliders",2),Y("valueChange",function(a){return n.update_w(a)}),A(),C(5,"app-labelled-sliders",3),Y("valueChange",function(a){return n.update_b(a)}),A(),C(6,"h3"),W(7," Samples distribution "),A(),C(8,"mat-button-toggle-group",4),Y("change",function(a){return n.change_points_distributions(a)}),C(9,"mat-button-toggle",5),W(10,"Linear"),A(),C(11,"mat-button-toggle",6),W(12,"Circular"),A()(),Rt(),Ot(13,7),C(14,"div",8),Y("chartInit",function(a){return n.onChartInit(a)}),A(),C(15,"div",8),Y("chartInit",function(a){return n.onChartInit3D(a)}),A(),Rt(),A()),r&2&&(z("rightDrawer",!1),O(4),z("max",n.w_max)("min",n.w_min)("step",.1)("value",n.w),O(),z("max",n.b_max)("min",n.b_min)("step",.1)("value",n.b),O(4),z("checked",n.lin_separability),O(5),z("options",n.data_chart),O(),z("options",n.option_3d_graph))},dependencies:[Jn,hs,za,Mr,zo],styles:[".graph[_ngcontent-%COMP%]{aspect-ratio:1;width:30vw;background-color:#fff;border-radius:.25em;border-color:#000;margin:5%}.label-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin:0 20px}.parameter-adjusting[_ngcontent-%COMP%]{margin:5px;border-radius:.5em;box-shadow:#0e1e251f 0 2px 4px,#0e1e2552 0 2px 16px}"]})}return e})();var J1e=0,NP=new Ye("CdkAccordion"),Z$=(()=>{class e{constructor(){this._stateChanges=new Ct,this._openCloseAllActions=new Ct,this.id=`cdk-accordion-${J1e++}`,this.multi=!1}openAll(){this.multi&&this._openCloseAllActions.next(!0)}closeAll(){this._openCloseAllActions.next(!1)}ngOnChanges(i){this._stateChanges.next(i)}ngOnDestroy(){this._stateChanges.complete(),this._openCloseAllActions.complete()}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=xt({type:e,selectors:[["cdk-accordion"],["","cdkAccordion",""]],inputs:{multi:[_e.HasDecoratorInputTransform,"multi","multi",yt]},exportAs:["cdkAccordion"],standalone:!0,features:[Li([{provide:NP,useExisting:e}]),Hi,kr]})}}return e})(),e2e=0,K$=(()=>{class e{get expanded(){return this._expanded}set expanded(i){if(this._expanded!==i){if(this._expanded=i,this.expandedChange.emit(i),i){this.opened.emit();let r=this.accordion?this.accordion.id:this.id;this._expansionDispatcher.notify(this.id,r)}else this.closed.emit();this._changeDetectorRef.markForCheck()}}constructor(i,r,n){this.accordion=i,this._changeDetectorRef=r,this._expansionDispatcher=n,this._openCloseAllSubscription=fn.EMPTY,this.closed=new We,this.opened=new We,this.destroyed=new We,this.expandedChange=new We,this.id=`cdk-accordion-child-${e2e++}`,this._expanded=!1,this.disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=n.listen((o,a)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===a&&this.id!==o&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(i=>{this.disabled||(this.expanded=i)})}static{this.\u0275fac=function(r){return new(r||e)(G(NP,12),G(ei),G(h2))}}static{this.\u0275dir=xt({type:e,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:[_e.HasDecoratorInputTransform,"expanded","expanded",yt],disabled:[_e.HasDecoratorInputTransform,"disabled","disabled",yt]},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],standalone:!0,features:[Li([{provide:NP,useValue:void 0}]),Hi]})}}return e})(),Q$=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({})}}return e})();var t2e=["body"],i2e=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],r2e=["mat-expansion-panel-header","*","mat-action-row"];function n2e(e,t){}var o2e=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],a2e=["mat-panel-title","mat-panel-description","*"];function s2e(e,t){if(e&1&&(C(0,"span",1),wa(),C(1,"svg",2),he(2,"path",3),A()()),e&2){let i=ae();z("@indicatorRotate",i._getExpandedState())}}var OP=new Ye("MAT_ACCORDION"),J$="225ms cubic-bezier(0.4,0.0,0.2,1)",t7={indicatorRotate:Pl("indicatorRotate",[Cs("collapsed, void",Ko({transform:"rotate(0deg)"})),Cs("expanded",Ko({transform:"rotate(180deg)"})),Ss("expanded <=> collapsed, void => collapsed",ll(J$))]),bodyExpansion:Pl("bodyExpansion",[Cs("collapsed, void",Ko({height:"0px",visibility:"hidden"})),Cs("expanded",Ko({height:"*",visibility:""})),Ss("expanded <=> collapsed, void => collapsed",ll(J$))])},i7=new Ye("MAT_EXPANSION_PANEL"),l2e=(()=>{class e{constructor(i,r){this._template=i,this._expansionPanel=r}static{this.\u0275fac=function(r){return new(r||e)(G(Wp),G(i7,8))}}static{this.\u0275dir=xt({type:e,selectors:[["ng-template","matExpansionPanelContent",""]],standalone:!0})}}return e})(),c2e=0,r7=new Ye("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS"),nd=(()=>{class e extends K${get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(i){this._hideToggle=i}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(i){this._togglePosition=i}constructor(i,r,n,o,a,s,c){super(i,r,n),this._viewContainerRef=o,this._animationMode=s,this._hideToggle=!1,this.afterExpand=new We,this.afterCollapse=new We,this._inputChanges=new Ct,this._headerId=`mat-expansion-panel-header-${c2e++}`,this.accordion=i,this._document=a,this._animationsDisabled=s==="NoopAnimations",c&&(this.hideToggle=c.hideToggle)}_hasSpacing(){return this.accordion?this.expanded&&this.accordion.displayMode==="default":!1}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this._lazyContent._expansionPanel===this&&this.opened.pipe(xa(null),Ji(()=>this.expanded&&!this._portal),wn(1)).subscribe(()=>{this._portal=new vp(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(i){this._inputChanges.next(i)}ngOnDestroy(){super.ngOnDestroy(),this._inputChanges.complete()}_containsFocus(){if(this._body){let i=this._document.activeElement,r=this._body.nativeElement;return i===r||r.contains(i)}return!1}_animationStarted(i){!e7(i)&&!this._animationsDisabled&&this._body&&this._body?.nativeElement.setAttribute("inert","")}_animationDone(i){e7(i)||(i.toState==="expanded"?this.afterExpand.emit():i.toState==="collapsed"&&this.afterCollapse.emit(),!this._animationsDisabled&&this._body&&this._body.nativeElement.removeAttribute("inert"))}static{this.\u0275fac=function(r){return new(r||e)(G(OP,12),G(ei),G(h2),G(sl),G(Bt),G(pr,8),G(r7,8))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-expansion-panel"]],contentQueries:function(r,n,o){if(r&1&&Xi(o,l2e,5),r&2){let a;Ve(a=ze())&&(n._lazyContent=a.first)}},viewQuery:function(r,n){if(r&1&&ht(t2e,5),r&2){let o;Ve(o=ze())&&(n._body=o.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(r,n){r&2&&It("mat-expanded",n.expanded)("_mat-animation-noopable",n._animationsDisabled)("mat-expansion-panel-spacing",n._hasSpacing())},inputs:{hideToggle:[_e.HasDecoratorInputTransform,"hideToggle","hideToggle",yt],togglePosition:"togglePosition"},outputs:{afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],standalone:!0,features:[Li([{provide:OP,useValue:void 0},{provide:i7,useExisting:e}]),Hi,Yt,kr,ci],ngContentSelectors:r2e,decls:7,vars:4,consts:[["body",""],["role","region",1,"mat-expansion-panel-content",3,"id"],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(r,n){if(r&1){let o=Ze();vi(i2e),gt(0),C(1,"div",1,0),Y("@bodyExpansion.start",function(s){return q(o),X(n._animationStarted(s))})("@bodyExpansion.done",function(s){return q(o),X(n._animationDone(s))}),C(3,"div",2),gt(4,1),Be(5,n2e,0,0,"ng-template",3),A(),gt(6,2),A()}r&2&&(O(),z("@bodyExpansion",n._getExpandedState())("id",n.id),Zt("aria-labelledby",n._headerId),O(4),z("cdkPortalOutlet",n._portal))},dependencies:[dH],styles:['.mat-expansion-panel{box-sizing:content-box;display:block;margin:0;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative;background:var(--mat-expansion-container-background-color);color:var(--mat-expansion-container-text-color);border-radius:var(--mat-expansion-container-shape)}.mat-expansion-panel:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:var(--mat-expansion-container-shape);border-top-left-radius:var(--mat-expansion-container-shape)}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:var(--mat-expansion-container-shape);border-bottom-left-radius:var(--mat-expansion-container-shape)}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible;font-family:var(--mat-expansion-container-text-font);font-size:var(--mat-expansion-container-text-size);font-weight:var(--mat-expansion-container-text-weight);line-height:var(--mat-expansion-container-text-line-height);letter-spacing:var(--mat-expansion-container-text-tracking)}.mat-expansion-panel-content[style*="visibility: hidden"] *{visibility:hidden !important}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px;border-top-color:var(--mat-expansion-actions-divider-color)}.mat-action-row .mat-button-base,.mat-action-row .mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row .mat-button-base,[dir=rtl] .mat-action-row .mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2,data:{animation:[t7.bodyExpansion]},changeDetection:0})}}return e})();function e7(e){return e.fromState==="void"}var od=(()=>{class e{constructor(i,r,n,o,a,s,c){this.panel=i,this._element=r,this._focusMonitor=n,this._changeDetectorRef=o,this._animationMode=s,this._parentChangeSubscription=fn.EMPTY,this.tabIndex=0;let l=i.accordion?i.accordion._stateChanges.pipe(Ji(d=>!!(d.hideToggle||d.togglePosition))):ws;this.tabIndex=parseInt(c||"")||0,this._parentChangeSubscription=So(i.opened,i.closed,l,i._inputChanges.pipe(Ji(d=>!!(d.hideToggle||d.disabled||d.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),i.closed.pipe(Ji(()=>i._containsFocus())).subscribe(()=>n.focusVia(r,"program")),a&&(this.expandedHeight=a.expandedHeight,this.collapsedHeight=a.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){let i=this._isExpanded();return i&&this.expandedHeight?this.expandedHeight:!i&&this.collapsedHeight?this.collapsedHeight:null}_keydown(i){switch(i.keyCode){case 32:case 13:us(i)||(i.preventDefault(),this._toggle());break;default:this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(i);return}}focus(i,r){i?this._focusMonitor.focusVia(this._element,i,r):this._element.nativeElement.focus(r)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(i=>{i&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}static{this.\u0275fac=function(r){return new(r||e)(G(nd,1),G(vt),G(ic),G(ei),G(r7,8),G(pr,8),Zo("tabindex"))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(r,n){r&1&&Y("click",function(){return n._toggle()})("keydown",function(a){return n._keydown(a)}),r&2&&(Zt("id",n.panel._headerId)("tabindex",n.disabled?-1:n.tabIndex)("aria-controls",n._getPanelId())("aria-expanded",n._isExpanded())("aria-disabled",n.panel.disabled),li("height",n._getHeaderHeight()),It("mat-expanded",n._isExpanded())("mat-expansion-toggle-indicator-after",n._getTogglePosition()==="after")("mat-expansion-toggle-indicator-before",n._getTogglePosition()==="before")("_mat-animation-noopable",n._animationMode==="NoopAnimations"))},inputs:{expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight",tabIndex:[_e.HasDecoratorInputTransform,"tabIndex","tabIndex",i=>i==null?0:sn(i)]},standalone:!0,features:[Hi,ci],ngContentSelectors:a2e,decls:5,vars:3,consts:[[1,"mat-content"],[1,"mat-expansion-indicator"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-hidden","true","focusable","false"],["d","M480-345 240-585l56-56 184 184 184-184 56 56-240 240Z"]],template:function(r,n){r&1&&(vi(o2e),C(0,"span",0),gt(1),gt(2,1),gt(3,2),A(),Be(4,s2e,3,1,"span",1)),r&2&&(It("mat-content-hide-toggle",!n._showToggle()),O(4),Ni(4,n._showToggle()?4:-1))},styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-expansion-header-collapsed-state-height);font-family:var(--mat-expansion-header-text-font);font-size:var(--mat-expansion-header-text-size);font-weight:var(--mat-expansion-header-text-weight);line-height:var(--mat-expansion-header-text-line-height);letter-spacing:var(--mat-expansion-header-text-tracking)}.mat-expansion-panel-header.mat-expanded{height:var(--mat-expansion-header-expanded-state-height)}.mat-expansion-panel-header[aria-disabled=true]{color:var(--mat-expansion-header-disabled-state-text-color)}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-header-hover-state-layer-color)}@media(hover: none){.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-container-background-color)}}.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-keyboard-focused,.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-program-focused{background:var(--mat-expansion-header-focus-state-layer-color)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-content.mat-content-hide-toggle{margin-right:8px}[dir=rtl] .mat-content.mat-content-hide-toggle{margin-right:0;margin-left:8px}.mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-left:24px;margin-right:0}[dir=rtl] .mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-right:24px;margin-left:0}.mat-expansion-panel-header-title{color:var(--mat-expansion-header-text-color)}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;flex-basis:0;margin-right:16px;align-items:center}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-title,.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-description{color:inherit}.mat-expansion-panel-header-description{flex-grow:2;color:var(--mat-expansion-header-description-color)}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle;color:var(--mat-expansion-header-indicator-color);display:inline-block;display:var(--mat-expansion-legacy-header-indicator-display, inline-block)}.mat-expansion-indicator svg{width:24px;height:24px;margin:0 -8px;vertical-align:middle;fill:var(--mat-expansion-header-indicator-color);display:none;display:var(--mat-expansion-header-indicator-display, none)}.cdk-high-contrast-active .mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}'],encapsulation:2,data:{animation:[t7.indicatorRotate]},changeDetection:0})}}return e})();var Tu=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=xt({type:e,selectors:[["mat-panel-title"]],hostAttrs:[1,"mat-expansion-panel-header-title"],standalone:!0})}}return e})(),n7=(()=>{class e extends Z${constructor(){super(...arguments),this._ownHeaders=new Yu,this.hideToggle=!1,this.displayMode="default",this.togglePosition="after"}ngAfterContentInit(){this._headers.changes.pipe(xa(this._headers)).subscribe(i=>{this._ownHeaders.reset(i.filter(r=>r.panel.accordion===this)),this._ownHeaders.notifyOnChanges()}),this._keyManager=new i2(this._ownHeaders).withWrap().withHomeAndEnd()}_handleHeaderKeydown(i){this._keyManager.onKeydown(i)}_handleHeaderFocus(i){this._keyManager.updateActiveItem(i)}ngOnDestroy(){super.ngOnDestroy(),this._keyManager?.destroy(),this._ownHeaders.destroy()}static{this.\u0275fac=(()=>{let i;return function(n){return(i||(i=Ar(e)))(n||e)}})()}static{this.\u0275dir=xt({type:e,selectors:[["mat-accordion"]],contentQueries:function(r,n,o){if(r&1&&Xi(o,od,5),r&2){let a;Ve(a=ze())&&(n._headers=a)}},hostAttrs:[1,"mat-accordion"],hostVars:2,hostBindings:function(r,n){r&2&&It("mat-accordion-multi",n.multi)},inputs:{hideToggle:[_e.HasDecoratorInputTransform,"hideToggle","hideToggle",yt],displayMode:"displayMode",togglePosition:"togglePosition"},exportAs:["matAccordion"],standalone:!0,features:[Li([{provide:OP,useExisting:e}]),Hi,Yt]})}}return e})(),o7=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Ut,Q$,g2]})}}return e})();var d2e=["canvas"],u2e=(e,t)=>({activated:e,deactivated:t}),a7=()=>[];function h2e(e,t){e&1&&(C(0,"mat-icon"),W(1,"visibility"),A())}function p2e(e,t){e&1&&(C(0,"mat-icon"),W(1,"visibility_off"),A())}function f2e(e,t){if(e&1&&(C(0,"td"),W(1),A()),e&2){let i=t.index,r=ae().index,n=ae();O(),Qr(" ",n.getFormattedValue(r,i)," ")}}function m2e(e,t){if(e&1&&(C(0,"tr"),Be(1,f2e,2,1,"td",18),A()),e&2){let i=ae();O(),z("ngForOf",gc(1,a7).constructor(i.kernel.size))}}var s7=(()=>{class e{kernel;updateFilters=new We;canvas;ctx;ngOnInit(){this.kernel.delete=!1;let i=this.canvas.nativeElement;this.ctx=i.getContext("2d",{alpha:!1}),i.width=this.kernel.size,i.height=this.kernel.size,this.ctx.canvas.width=this.kernel.size,this.ctx.canvas.height=this.kernel.size,this.drawFilter()}delete(i){i.stopPropagation(),this.kernel.delete=!0,this.updateFilters.emit()}toggleActive(i){i.stopPropagation(),this.kernel.active=!this.kernel.active,this.updateFilters.emit()}drawFilter(){let i=new Uint8ClampedArray(this.kernel.size*this.kernel.size*4);for(let n=0;n<this.kernel.size;n++)for(let o=0;o<this.kernel.size;o++){let a=this.kernel.element[n*this.kernel.size+o];i[4*n*this.kernel.size+o*4]=a,i[4*n*this.kernel.size+o*4+1]=a,i[4*n*this.kernel.size+o*4+2]=a,i[4*n*this.kernel.size+o*4+3]=255}let r=new ImageData(i,this.kernel.size,this.kernel.size);this.ctx.putImageData(r,0,0)}getFormattedValue(i,r){let n=i*this.kernel.size+r;return(this.kernel.element[n]/255).toFixed(0)}updateFilter(){this.updateFilters.emit(!0)}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Le({type:e,selectors:[["app-structural-element"]],viewQuery:function(r,n){if(r&1&&ht(d2e,7),r&2){let o;Ve(o=ze())&&(n.canvas=o.first)}},inputs:{kernel:"kernel"},outputs:{updateFilters:"updateFilters"},decls:35,vars:9,consts:[["panelH",""],["canvas",""],[3,"ngClass"],["mat-mini-fab","","color","accent",1,"action-button",3,"click"],[4,"ngIf"],["appearance","fill",3,"click"],[3,"ngModelChange","ngModel"],["value","erosion"],["value","dilation"],["value","opening"],["value","closing"],["value","tophat"],["value","gradient"],["value","skeletonize"],["mat-mini-fab","","color","warn",1,"action-button",3,"click"],[1,"vertical-flex","center"],[1,"rounded-table"],[3,"mouseenter"],[4,"ngFor","ngForOf"]],template:function(r,n){if(r&1){let o=Ze();C(0,"mat-expansion-panel",2,0)(2,"mat-expansion-panel-header")(3,"mat-panel-title")(4,"button",3),Y("click",function(s){return q(o),X(n.toggleActive(s))}),Be(5,h2e,2,0,"mat-icon",4)(6,p2e,2,0,"mat-icon",4),A(),C(7,"span")(8,"mat-form-field",5),Y("click",function(){q(o);let s=Ft(1);return X(s.toggle())}),C(9,"mat-label"),W(10,"Operation"),A(),C(11,"mat-select",6),qt("ngModelChange",function(s){return q(o),jt(n.kernel.morphOp,s)||(n.kernel.morphOp=s),X(s)}),Y("ngModelChange",function(){return q(o),X(n.updateFilter())}),C(12,"mat-option",7),W(13,"Erosion"),A(),C(14,"mat-option",8),W(15,"Dilation"),A(),C(16,"mat-option",9),W(17,"Opening"),A(),C(18,"mat-option",10),W(19,"Closing"),A(),C(20,"mat-option",11),W(21,"Top Hat"),A(),C(22,"mat-option",12),W(23,"Gradient"),A(),C(24,"mat-option",13),W(25,"Skeletonize"),A()()()(),C(26,"button",14),Y("click",function(s){return q(o),X(n.delete(s))}),C(27,"mat-icon"),W(28,"close"),A()()()(),C(29,"div",15)(30,"div",16)(31,"table",17),Y("mouseenter",function(){return q(o),X(n.drawFilter())}),Be(32,m2e,2,2,"tr",18),A()(),he(33,"canvas",null,1),A()()}r&2&&(z("ngClass",Zp(5,u2e,n.kernel.active,!n.kernel.active)),O(5),z("ngIf",n.kernel.active),O(),z("ngIf",!n.kernel.active),O(5),Wt("ngModel",n.kernel.morphOp),O(21),z("ngForOf",gc(8,a7).constructor(n.kernel.size)))},dependencies:[Hm,rc,b2,Um,Il,Xn,Yn,so,Un,nd,od,Tu,qm,Bo],styles:["mat-expansion-panel-header[_ngcontent-%COMP%]{height:fit-content}canvas[_ngcontent-%COMP%]{width:128px;aspect-ratio:1;image-rendering:-moz-crisp-edges;image-rendering:-webkit-crisp-edges;image-rendering:pixelated;image-rendering:crisp-edges;box-shadow:#0000001f 0 1px 3px,#0000003d 0 1px 2px;border-radius:.5em}.title-span[_ngcontent-%COMP%]{margin:auto}tr[_ngcontent-%COMP%]:nth-child(odd){background-color:#646464}.horizontal-flex[_ngcontent-%COMP%]{width:100%}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#6f9b75}td[_ngcontent-%COMP%]{font-size:small}.center[_ngcontent-%COMP%]{align-items:center;gap:1em}.deactivated[_ngcontent-%COMP%]:not(button){filter:brightness(.7);border:solid white 1px}.rounded-table[_ngcontent-%COMP%]{overflow:hidden;box-shadow:#0000001f 0 1px 3px,#0000003d 0 1px 2px;aspect-ratio:1;overflow:scroll}button[_ngcontent-%COMP%]{transform:scale(.5)}"]})}return e})();var v2e=["elementCanvasVisu"];function _2e(e,t){if(e&1){let i=Ze();C(0,"app-structural-element",19),Y("updateFilters",function(){q(i);let n=ae();return X(n.updateFilters())}),A()}if(e&2){let i=t.$implicit;z("kernel",i)}}var l7=(()=>{class e extends Fo{eltCanvasVisu;listKernels=new Array;ksize=3;structuralElementType="circle";width=256;ngAfterViewInit(){super.ngAfterViewInit(),this.cleanFilterList(),this.updateVisu()}updateVisu(){this.ngxOpenCv.cvState.subscribe(i=>{if(this.cvState=i,i.ready){let r=this.getStructuringMat(this.ksize,this.structuralElementType);cv.convertScaleAbs(r,r,255);let n=32-this.ksize;cv.copyMakeBorder(r,r,n,n,n,n,cv.BORDER_CONSTANT),cv.imshow(this.eltCanvasVisu.nativeElement,r),r.delete()}})}applyFilter(){let i=cv.imread(this.drawCanvas.getCanvas()),r=new cv.Point(-1,-1),n=new cv.Mat;cv.cvtColor(i,n,cv.COLOR_RGB2GRAY),this.listKernels.forEach(o=>{if(!o.active)return;let a=o.size,s=cv.matFromArray(a,a,cv.CV_8UC1,o.element);switch(o.morphOp){case"erosion":{cv.erode(n,n,s,r,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue());break}case"dilation":{cv.dilate(n,n,s,r,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue());break}case"opening":{cv.morphologyEx(n,n,cv.MORPH_OPEN,s,r,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue());break}case"closing":{cv.morphologyEx(n,n,cv.MORPH_CLOSE,s);break}case"gradient":{cv.morphologyEx(n,n,cv.MORPH_GRADIENT,s);break}case"tophat":{cv.morphologyEx(n,n,cv.MORPH_TOPHAT,s);break}case"skeletonize":{for(var c=new cv.Mat(this.width,this.width,cv.CV_8UC1,new cv.Scalar(0)),l=new cv.Mat,d=new cv.Mat,u=!1,h=50;!u&&h>0;)cv.erode(n,d,s),cv.dilate(d,l,s),cv.subtract(n,l,l),cv.bitwise_or(c,l,c),d.copyTo(n),u=cv.norm(n)==0,h--;c.copyTo(n),c.delete(),l.delete(),d.delete();break}}s.delete()}),this.outputCanvas.drawMat(n),n.delete(),i.delete()}updateFilters(){this.listKernels=this.listKernels.filter(i=>!i.delete),this.applyFilter()}cleanFilterList(){this.listKernels=new Array}getStructuringMat(i,r){let n=new cv.Size(i,i);switch(r){case"circle":{var o=cv.getStructuringElement(cv.MORPH_ELLIPSE,n);break}case"square":{var o=cv.getStructuringElement(cv.MORPH_RECT,n);break}case"cross":{var o=cv.getStructuringElement(cv.MORPH_CROSS,n);break}}return o}addFilter(){let i=this.getStructuringMat(this.ksize,this.structuralElementType);cv.convertScaleAbs(i,i,255);let r="erosion",n=this.listKernels.length;n>0&&(r=this.listKernels[n-1].morphOp);let o=new Uint8ClampedArray(i.data,i.cols,i.rows),a={morphOp:r,size:this.ksize,element:o,active:!0,delete:!1};this.listKernels.push(a),i.delete(),this.updateFilters()}static \u0275fac=(()=>{let i;return function(n){return(i||(i=Ar(e)))(n||e)}})();static \u0275cmp=Le({type:e,selectors:[["app-morpho-tools"]],viewQuery:function(r,n){if(r&1&&ht(v2e,7),r&2){let o;Ve(o=ze())&&(n.eltCanvasVisu=o.first)}},features:[Yt],decls:35,vars:16,consts:[["brushSizeSlider",""],["elementCanvasVisu",""],["inputCanvas",""],["outputCanvas",""],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["title","Brush Size"],[3,"valueChange","min","max","step","title","value"],[3,"ngModelChange","change","ngModel"],["value","circle"],["value","square"],["value","cross"],[1,"structuralElementVisu"],["mat-raised-button","","color","primary",1,"fillWidth",3,"click"],["ngProjectAs","[drawerRight]",5,["","drawerRight",""]],["echarts","",1,"profile-graph",3,"options"],[3,"kernel","updateFilters",4,"ngFor","ngForOf"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["title","Canvas",1,"canvas",3,"drawingEnded","width","drawable","BWOption","OnlyBW","brushRadius"],["title","Result",1,"canvas",3,"profileChanged","width","profileOption","drawable"],[3,"updateFilters","kernel"]],template:function(r,n){if(r&1){let o=Ze();C(0,"app-tutorial-template-images"),W(1," Morphological Transformations "),Ot(2,4),he(3,"app-labelled-sliders",5,0)(5,"hr"),C(6,"app-labelled-sliders",6),qt("valueChange",function(s){return q(o),jt(n.ksize,s)||(n.ksize=s),X(s)}),Y("valueChange",function(){return q(o),X(n.updateVisu())}),A(),C(7,"span")(8,"mat-button-toggle-group",7),qt("ngModelChange",function(s){return q(o),jt(n.structuralElementType,s)||(n.structuralElementType=s),X(s)}),Y("change",function(){return q(o),X(n.updateVisu())}),C(9,"mat-button-toggle",8)(10,"mat-icon"),W(11,"toll"),A()(),C(12,"mat-button-toggle",9)(13,"mat-icon"),W(14,"crop_square"),A()(),C(15,"mat-button-toggle",10)(16,"mat-icon"),W(17,"games"),A()()()(),he(18,"canvas",11,1),C(20,"button",12),Y("click",function(){return q(o),X(n.addFilter())}),W(21," Add "),A(),Rt(),Ot(22,13),C(23,"h2"),W(24,"Profile"),A(),he(25,"div",14),C(26,"h2"),W(27,"Active filters"),A(),he(28,"hr"),Be(29,_2e,1,1,"app-structural-element",15),Rt(),Ot(30,16),C(31,"app-draw-canvas",17,2),Y("drawingEnded",function(){return q(o),X(n.applyFilter())}),A(),C(33,"app-draw-canvas",18,3),Y("profileChanged",function(){return q(o),X(n.updateProfile())}),A(),Rt(),A()}if(r&2){let o=Ft(4);O(6),z("min",3)("max",25)("step",2)("title","Element size"),Wt("value",n.ksize),O(2),Wt("ngModel",n.structuralElementType),O(17),z("options",n.profileOptions),O(4),z("ngForOf",n.listKernels),O(2),z("width",n.width)("drawable",!0)("BWOption",!1)("OnlyBW",!0)("brushRadius",o.value),O(2),z("width",n.width)("profileOption",!0)("drawable",!1)}},dependencies:[Jn,hs,za,Xn,so,Un,on,Bo,Vo,Mr,s7,Va],styles:[".canvas[_ngcontent-%COMP%]{width:45%;min-width:256px;image-rendering:-moz-crisp-edges;image-rendering:-webkit-crisp-edges;image-rendering:pixelated;image-rendering:crisp-edges}.structuralElementVisu[_ngcontent-%COMP%]{width:128px;aspect-ratio:1;image-rendering:-moz-crisp-edges;image-rendering:-webkit-crisp-edges;image-rendering:pixelated;image-rendering:crisp-edges;margin:1em}.profile-graph[_ngcontent-%COMP%]{min-width:300px;padding:0 .5em}"]})}return e})();function RP(e){let t=Array(e.length).fill(0);pE(e,t);let i=new Array(e.length);for(let r=0;r<i.length;r++){let n=e[r],o=t[r];i[r]=2*Math.sqrt(n*n+o*o)/e.length}return i}function pE(e,t){let i=e.length;if(i!=t.length)throw new RangeError("Mismatched lengths");i!=0&&(i&i-1?x2e(e,t):y2e(e,t))}function b2e(e,t){pE(t,e)}function y2e(e,t){let i=e.length;if(i!=t.length)throw new RangeError("Mismatched lengths");if(i==1)return;let r=-1;for(let s=0;s<32;s++)1<<s==i&&(r=s);if(r==-1)throw new RangeError("Length is not a power of 2");let n=new Array(i/2),o=new Array(i/2);for(let s=0;s<i/2;s++)n[s]=Math.cos(2*Math.PI*s/i),o[s]=Math.sin(2*Math.PI*s/i);for(let s=0;s<i;s++){let c=a(s,r);if(c>s){let l=e[s];e[s]=e[c],e[c]=l,l=t[s],t[s]=t[c],t[c]=l}}for(let s=2;s<=i;s*=2){let c=s/2,l=i/s;for(let d=0;d<i;d+=s)for(let u=d,h=0;u<d+c;u++,h+=l){let p=u+c,m=e[p]*n[h]+t[p]*o[h],f=-e[p]*o[h]+t[p]*n[h];e[p]=e[u]-m,t[p]=t[u]-f,e[u]+=m,t[u]+=f}}function a(s,c){let l=0;for(let d=0;d<c;d++)l=l<<1|s&1,s>>>=1;return l}}function x2e(e,t){let i=e.length;if(i!=t.length)throw new RangeError("Mismatched lengths");let r=1;for(;r<i*2+1;)r*=2;let n=new Array(i),o=new Array(i);for(let h=0;h<i;h++){let p=h*h%(i*2);n[h]=Math.cos(Math.PI*p/i),o[h]=Math.sin(Math.PI*p/i)}let a=hE(r),s=hE(r);for(let h=0;h<i;h++)a[h]=e[h]*n[h]+t[h]*o[h],s[h]=-e[h]*o[h]+t[h]*n[h];let c=hE(r),l=hE(r);c[0]=n[0],l[0]=o[0];for(let h=1;h<i;h++)c[h]=c[r-h]=n[h],l[h]=l[r-h]=o[h];let d=new Array(r),u=new Array(r);w2e(a,s,c,l,d,u);for(let h=0;h<i;h++)e[h]=d[h]*n[h]+u[h]*o[h],t[h]=-d[h]*o[h]+u[h]*n[h]}function w2e(e,t,i,r,n,o){let a=e.length;if(a!=t.length||a!=i.length||a!=r.length||a!=n.length||a!=o.length)throw new RangeError("Mismatched lengths");e=e.slice(),t=t.slice(),i=i.slice(),r=r.slice(),pE(e,t),pE(i,r);for(let s=0;s<a;s++){let c=e[s]*i[s]-t[s]*r[s];t[s]=t[s]*i[s]+e[s]*r[s],e[s]=c}b2e(e,t);for(let s=0;s<a;s++)n[s]=e[s]/a,o[s]=t[s]/a}function hE(e){return Array(e).fill(0)}var E2e=["input"],C2e=["label"],S2e=["*"],T2e=new Ye("mat-checkbox-default-options",{providedIn:"root",factory:d7});function d7(){return{color:"accent",clickAction:"check-indeterminate"}}var Go=function(e){return e[e.Init=0]="Init",e[e.Checked=1]="Checked",e[e.Unchecked=2]="Unchecked",e[e.Indeterminate=3]="Indeterminate",e}(Go||{}),A2e={provide:Ql,useExisting:Yo(()=>Au),multi:!0},FP=class{},D2e=0,c7=d7(),Au=(()=>{class e{focus(){this._inputElement.nativeElement.focus()}_createChangeEvent(i){let r=new FP;return r.source=this,r.checked=i,r}_getAnimationTargetElement(){return this._inputElement?.nativeElement}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(i,r,n,o,a,s){this._elementRef=i,this._changeDetectorRef=r,this._ngZone=n,this._animationMode=a,this._options=s,this._animationClasses={uncheckedToChecked:"mdc-checkbox--anim-unchecked-checked",uncheckedToIndeterminate:"mdc-checkbox--anim-unchecked-indeterminate",checkedToUnchecked:"mdc-checkbox--anim-checked-unchecked",checkedToIndeterminate:"mdc-checkbox--anim-checked-indeterminate",indeterminateToChecked:"mdc-checkbox--anim-indeterminate-checked",indeterminateToUnchecked:"mdc-checkbox--anim-indeterminate-unchecked"},this.ariaLabel="",this.ariaLabelledby=null,this.labelPosition="after",this.name=null,this.change=new We,this.indeterminateChange=new We,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=Go.Init,this._controlValueAccessorChangeFn=()=>{},this._validatorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||c7,this.color=this._options.color||c7.color,this.tabIndex=parseInt(o)||0,this.id=this._uniqueId=`mat-mdc-checkbox-${++D2e}`}ngOnChanges(i){i.required&&this._validatorChangeFn()}ngAfterViewInit(){this._syncIndeterminate(this._indeterminate)}get checked(){return this._checked}set checked(i){i!=this.checked&&(this._checked=i,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(i){i!==this.disabled&&(this._disabled=i,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(i){let r=i!=this._indeterminate;this._indeterminate=i,r&&(this._indeterminate?this._transitionCheckState(Go.Indeterminate):this._transitionCheckState(this.checked?Go.Checked:Go.Unchecked),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(i){this.checked=!!i}registerOnChange(i){this._controlValueAccessorChangeFn=i}registerOnTouched(i){this._onTouched=i}setDisabledState(i){this.disabled=i}validate(i){return this.required&&i.value!==!0?{required:!0}:null}registerOnValidatorChange(i){this._validatorChangeFn=i}_transitionCheckState(i){let r=this._currentCheckState,n=this._getAnimationTargetElement();if(!(r===i||!n)&&(this._currentAnimationClass&&n.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(r,i),this._currentCheckState=i,this._currentAnimationClass.length>0)){n.classList.add(this._currentAnimationClass);let o=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{n.classList.remove(o)},1e3)})}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.checked),this.change.emit(this._createChangeEvent(this.checked)),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_handleInputClick(){let i=this._options?.clickAction;!this.disabled&&i!=="noop"?(this.indeterminate&&i!=="check"&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?Go.Checked:Go.Unchecked),this._emitChangeEvent()):!this.disabled&&i==="noop"&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate)}_onInteractionEvent(i){i.stopPropagation()}_onBlur(){Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}_getAnimationClassForCheckStateTransition(i,r){if(this._animationMode==="NoopAnimations")return"";switch(i){case Go.Init:if(r===Go.Checked)return this._animationClasses.uncheckedToChecked;if(r==Go.Indeterminate)return this._checked?this._animationClasses.checkedToIndeterminate:this._animationClasses.uncheckedToIndeterminate;break;case Go.Unchecked:return r===Go.Checked?this._animationClasses.uncheckedToChecked:this._animationClasses.uncheckedToIndeterminate;case Go.Checked:return r===Go.Unchecked?this._animationClasses.checkedToUnchecked:this._animationClasses.checkedToIndeterminate;case Go.Indeterminate:return r===Go.Checked?this._animationClasses.indeterminateToChecked:this._animationClasses.indeterminateToUnchecked}return""}_syncIndeterminate(i){let r=this._inputElement;r&&(r.nativeElement.indeterminate=i)}_onInputClick(){this._handleInputClick()}_onTouchTargetClick(){this._handleInputClick(),this.disabled||this._inputElement.nativeElement.focus()}_preventBubblingFromLabel(i){i.target&&this._labelElement.nativeElement.contains(i.target)&&i.stopPropagation()}static{this.\u0275fac=function(r){return new(r||e)(G(vt),G(ei),G(st),Zo("tabindex"),G(pr,8),G(T2e,8))}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-checkbox"]],viewQuery:function(r,n){if(r&1&&(ht(E2e,5),ht(C2e,5),ht(Ys,5)),r&2){let o;Ve(o=ze())&&(n._inputElement=o.first),Ve(o=ze())&&(n._labelElement=o.first),Ve(o=ze())&&(n.ripple=o.first)}},hostAttrs:[1,"mat-mdc-checkbox"],hostVars:14,hostBindings:function(r,n){r&2&&(Dl("id",n.id),Zt("tabindex",null)("aria-label",null)("aria-labelledby",null),Kr(n.color?"mat-"+n.color:"mat-accent"),It("_mat-animation-noopable",n._animationMode==="NoopAnimations")("mdc-checkbox--disabled",n.disabled)("mat-mdc-checkbox-disabled",n.disabled)("mat-mdc-checkbox-checked",n.checked))},inputs:{ariaLabel:[_e.None,"aria-label","ariaLabel"],ariaLabelledby:[_e.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[_e.None,"aria-describedby","ariaDescribedby"],id:"id",required:[_e.HasDecoratorInputTransform,"required","required",yt],labelPosition:"labelPosition",name:"name",value:"value",disableRipple:[_e.HasDecoratorInputTransform,"disableRipple","disableRipple",yt],tabIndex:[_e.HasDecoratorInputTransform,"tabIndex","tabIndex",i=>i==null?void 0:sn(i)],color:"color",checked:[_e.HasDecoratorInputTransform,"checked","checked",yt],disabled:[_e.HasDecoratorInputTransform,"disabled","disabled",yt],indeterminate:[_e.HasDecoratorInputTransform,"indeterminate","indeterminate",yt]},outputs:{change:"change",indeterminateChange:"indeterminateChange"},exportAs:["matCheckbox"],standalone:!0,features:[Li([A2e,{provide:sp,useExisting:e,multi:!0}]),Hi,kr,ci],ngContentSelectors:S2e,decls:15,vars:19,consts:[["checkbox",""],["input",""],["label",""],["mat-internal-form-field","",3,"click","labelPosition"],[1,"mdc-checkbox"],[1,"mat-mdc-checkbox-touch-target",3,"click"],["type","checkbox",1,"mdc-checkbox__native-control",3,"blur","click","change","checked","indeterminate","disabled","id","required","tabIndex"],[1,"mdc-checkbox__ripple"],[1,"mdc-checkbox__background"],["focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mdc-checkbox__checkmark"],["fill","none","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-checkbox__checkmark-path"],[1,"mdc-checkbox__mixedmark"],["mat-ripple","",1,"mat-mdc-checkbox-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-label",3,"for"]],template:function(r,n){if(r&1){let o=Ze();vi(),C(0,"div",3),Y("click",function(s){return q(o),X(n._preventBubblingFromLabel(s))}),C(1,"div",4,0)(3,"div",5),Y("click",function(){return q(o),X(n._onTouchTargetClick())}),A(),C(4,"input",6,1),Y("blur",function(){return q(o),X(n._onBlur())})("click",function(){return q(o),X(n._onInputClick())})("change",function(s){return q(o),X(n._onInteractionEvent(s))}),A(),he(6,"div",7),C(7,"div",8),wa(),C(8,"svg",9),he(9,"path",10),A(),Og(),he(10,"div",11),A(),he(11,"div",12),A(),C(12,"label",13,2),gt(14),A()()}if(r&2){let o=Ft(2);z("labelPosition",n.labelPosition),O(4),It("mdc-checkbox--selected",n.checked),z("checked",n.checked)("indeterminate",n.indeterminate)("disabled",n.disabled)("id",n.inputId)("required",n.required)("tabIndex",n.disabled?-1:n.tabIndex),Zt("aria-label",n.ariaLabel||null)("aria-labelledby",n.ariaLabelledby)("aria-describedby",n.ariaDescribedby)("aria-checked",n.indeterminate?"mixed":null)("name",n.name)("value",n.value),O(7),z("matRippleTrigger",o)("matRippleDisabled",n.disableRipple||n.disabled)("matRippleCentered",!0),O(),z("for",n.inputId)}},dependencies:[Ys,l2],styles:['.mdc-touch-target-wrapper{display:inline}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:mdc-animation-deceleration-curve-timing-function;transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom}.mdc-checkbox[hidden]{display:none}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{border-color:CanvasText}}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{border-color:CanvasText}}@media all and (-ms-high-contrast: none){.mdc-checkbox .mdc-checkbox__focus-ring{display:none}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-checkbox__mixedmark{margin:0 1px}}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:rgba(0,0,0,0);pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--upgraded .mdc-checkbox__checkmark{opacity:1}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear 0s;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear 0s;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background{transition:border-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit}.mdc-checkbox__native-control:disabled{cursor:default;pointer-events:none}.mdc-checkbox--touch{margin:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2)}.mdc-checkbox--touch .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);right:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);width:var(--mdc-checkbox-state-layer-size);height:var(--mdc-checkbox-state-layer-size)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 180ms 0ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark-path,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__mixedmark{transition:none}.mdc-checkbox{padding:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2);margin:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2)}.mdc-checkbox .mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color);background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background{border-color:transparent;background-color:var(--mdc-checkbox-disabled-selected-icon-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}@keyframes mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}}@keyframes mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}}.mdc-checkbox.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}@keyframes mdc-checkbox-fade-in-background-FF212121FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}}@keyframes mdc-checkbox-fade-out-background-FF212121FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}}.mdc-checkbox:hover.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:hover.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-FF212121FFF4433600000000FFF44336}.mdc-checkbox:hover.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:hover.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-FF212121FFF4433600000000FFF44336}.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}@keyframes mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}}@keyframes mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}}.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox .mdc-checkbox__background{top:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2)}.mdc-checkbox .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);right:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);width:var(--mdc-checkbox-state-layer-size);height:var(--mdc-checkbox-state-layer-size)}.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:focus:not(:checked):not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-focus-icon-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-focus-icon-color);background-color:var(--mdc-checkbox-selected-focus-icon-color)}.mdc-checkbox:hover .mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox:hover .mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}.mat-mdc-checkbox{display:inline-block;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-checkbox .mdc-checkbox__background{-webkit-print-color-adjust:exact;color-adjust:exact}.mat-mdc-checkbox._mat-animation-noopable *,.mat-mdc-checkbox._mat-animation-noopable *::before{transition:none !important;animation:none !important}.mat-mdc-checkbox label{cursor:pointer}.mat-mdc-checkbox.mat-mdc-checkbox-disabled label{cursor:default;color:var(--mat-checkbox-disabled-label-color)}.mat-mdc-checkbox label:empty{display:none}.cdk-high-contrast-active .mat-mdc-checkbox.mat-mdc-checkbox-disabled{opacity:.5}.cdk-high-contrast-active .mat-mdc-checkbox .mdc-checkbox__checkmark{--mdc-checkbox-selected-checkmark-color: CanvasText;--mdc-checkbox-disabled-selected-checkmark-color: CanvasText}.mat-mdc-checkbox .mdc-checkbox__ripple{opacity:0}.mat-mdc-checkbox-ripple,.mdc-checkbox__ripple{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-checkbox-ripple:not(:empty),.mdc-checkbox__ripple:not(:empty){transform:translateZ(0)}.mat-mdc-checkbox-ripple .mat-ripple-element{opacity:.1}.mat-mdc-checkbox-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-checkbox-touch-target-display)}.mat-mdc-checkbox-ripple::before{border-radius:50%}.mdc-checkbox__native-control:focus~.mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}}return e})();var u7=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Au,Ut,Ut]})}}return e})();var h7=(()=>{class e{formBuilder;n_points=1024;t_start=0;t_stop=8;fe=2;y1=!0;y2=!0;y3=!0;y1Phase=0;y2Phase=2;y3Phase=4;original_data=Array(this.n_points);sampled_data=Array(this.n_points);original_fft=Array(this.n_points);sampled_fft=Array(this.n_points);original_graph;sampled_graph;original_fft_graph;sampled_fft_graph;echartInstanceSampledGraph;echartsInstanceOriginalGraph;echartsInstanceOriginalFFTGraph;echartsInstanceSampledFFTGraph;constructor(i){this.formBuilder=i,this.createData(),this.update_fft_chart(),this.initialize_echarts()}ngAfterViewInit(){this.update_fe(this.fe),this.update_fft_chart()}initialize_echarts(){let i={xAxis:{min:this.t_start,max:this.t_stop},yAxis:{min:-7,max:7}};this.original_graph=Object.assign({},i),this.original_graph.series=[{data:this.original_data,type:"line",showSymbol:!1,animation:!1},{data:this.sampled_data,type:"bar",barWidth:2}],this.original_graph.title={text:"Original Signal"},this.sampled_graph=Object.assign({},i),this.sampled_graph.title={text:"Sampled Signal"},this.sampled_graph.series=[{data:this.sampled_data,type:"line",showSymbol:!0}],this.sampled_fft_graph=Object.assign({},i),this.sampled_fft_graph.title={text:"Sampled Signal FFT"},this.original_fft_graph=Object.assign({},i),this.original_fft_graph.title={text:"Original Signal FFT"}}createData(){let i=D_(this.t_start,this.t_stop,this.n_points);this.original_data=new Array(this.n_points);for(let r=0;r<this.n_points;r++){let n=i[r];this.original_data[r]=[n,this.signal(n)]}this.resample_signal(),this.original_graph&&Array.isArray(this.original_graph.series)&&(this.original_graph.series[0].data=this.original_data,this.echartsInstanceOriginalGraph?.setOption(this.original_graph)),this.update_fft_chart()}resample_signal(){let i=1/this.fe,r=Math.round(this.t_stop/i),n=D_(this.t_start,this.t_stop,r+1);this.sampled_data=new Array(r+1);for(let o=0;o<=r;o++){let a=n[o];this.sampled_data[o]=[a,this.signal(a)]}}recompute(){this.createData(),this.update_fe(this.fe)}signal(i){let r=this.y1?Math.sin(2*Math.PI*.5*i-this.y1Phase)*4:0,n=this.y2?Math.sin(2*Math.PI*1*i+2-this.y2Phase)*2:0,o=this.y3?Math.sin(2*Math.PI*4*i+4-this.y3Phase)*1:0;return r+n+o}update_fft_chart(){let i=RP(this.original_data.map(o=>o[1])),r=this.n_points/(this.t_stop-this.t_start),n={xAxis:{min:0,max:5},yAxis:{min:0,max:5},series:[{data:i.map((o,a)=>[a*r/this.n_points,o]),type:"bar"}]};this.original_fft_graph=Object.assign({},n),this.original_fft_graph.title={text:"Fourier Transform of the original signal"},this.echartsInstanceOriginalFFTGraph?.setOption(this.original_fft_graph),this.update_sampled_fft_chart()}update_sampled_fft_chart(){if(this.sampled_data.length==0)return;let i=new Array(this.n_points),r=this.n_points/(this.t_stop-this.t_start),n=this.sampled_data.length,o=1/this.fe;for(let l=0;l<this.n_points;l++){let d=n/this.n_points*l,u=Math.floor(d);if(u==n-1)i[l]=this.sampled_data[n-1];else{let h=d-u;i[l]=[this.t_start+l/r,(1-h)*this.sampled_data[u][1]+h*this.sampled_data[u+1][1]]}}let a=RP(i.map(l=>l[1])),s=a.length/(this.t_stop-this.t_start),c={xAxis:{min:0,max:5},yAxis:{min:0,max:5},series:[{data:a.map((l,d)=>[d*s/a.length,l]),type:"bar"}]};this.sampled_fft_graph=Object.assign({},c),this.sampled_fft_graph.title={text:"Fourier Transform of the sampled signal"},this.echartsInstanceSampledFFTGraph?.setOption(this.sampled_fft_graph)}onSampledChartInit(i){this.echartInstanceSampledGraph=i}onOriginalChartInit(i){this.echartsInstanceOriginalGraph=i}onFFTChartInit(i){this.echartsInstanceOriginalFFTGraph=i}onSampledFFTChartInit(i){this.echartsInstanceSampledFFTGraph=i}update_fe(i){i&&(this.fe=i,this.resample_signal(),Array.isArray(this.sampled_graph.series)&&(this.sampled_graph.series[0].data=this.sampled_data,this.sampled_graph.title={text:`Sampled Signal fe = ${this.fe}, N = ${this.sampled_data.length}`},this.echartInstanceSampledGraph?.setOption(this.sampled_graph),Array.isArray(this.original_graph.series)&&(this.original_graph.series[1].data=this.sampled_data,this.echartsInstanceOriginalGraph?.setOption(this.original_graph))),this.update_fft_chart())}static \u0275fac=function(r){return new(r||e)(G(DU))};static \u0275cmp=Le({type:e,selectors:[["app-sampling"]],decls:26,vars:24,consts:[[3,"rightDrawer"],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],[3,"change","checked"],[3,"valueChange","change","value","min","max","step"],[1,"w-64"],["title","Sub sampling frequency",3,"valueChange","value","max","min","step"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],[1,"grid","md:grid-cols-2","w-full","gap-2","p-2"],["echarts","",1,"bg-white",3,"chartInit","options"]],template:function(r,n){r&1&&(C(0,"app-tutorial-template",0),W(1," Sampling Frequency and Nyquist-Shannon Theorem "),Ot(2,1),C(3,"mat-label"),W(4,"Components"),A(),C(5,"p")(6,"mat-checkbox",2),Y("change",function(){return n.y1=!n.y1,n.recompute()}),W(7,"Y1"),A(),C(8,"app-labelled-sliders",3),qt("valueChange",function(a){return jt(n.y1Phase,a)||(n.y1Phase=a),a}),Y("change",function(){return n.recompute()}),A()(),C(9,"p")(10,"mat-checkbox",2),Y("change",function(){return n.y2=!n.y2,n.recompute()}),W(11,"Y2"),A(),C(12,"app-labelled-sliders",3),qt("valueChange",function(a){return jt(n.y2Phase,a)||(n.y2Phase=a),a}),Y("change",function(){return n.recompute()}),A()(),C(13,"p")(14,"mat-checkbox",2),Y("change",function(){return n.y3=!n.y3,n.recompute()}),W(15,"Y3"),A(),C(16,"app-labelled-sliders",3),qt("valueChange",function(a){return jt(n.y3Phase,a)||(n.y3Phase=a),a}),Y("change",function(){return n.recompute()}),A()(),C(17,"p",4),W(18," The Nyquist-Shannon theorem states that a signal must be sampled at a rate of at least twice the highest frequency component in the signal in order to be able to reconstruct the original signal from the samples. This is known as the Nyquist rate. "),A(),C(19,"app-labelled-sliders",5),Y("valueChange",function(a){return n.update_fe(a)}),A(),Rt(),Ot(20,6),C(21,"div",7)(22,"div",8),Y("chartInit",function(a){return n.onOriginalChartInit(a)}),A(),C(23,"div",8),Y("chartInit",function(a){return n.onSampledChartInit(a)}),A(),C(24,"div",8),Y("chartInit",function(a){return n.onFFTChartInit(a)}),A(),C(25,"div",8),Y("chartInit",function(a){return n.onSampledFFTChartInit(a)}),A()(),Rt(),A()),r&2&&(z("rightDrawer",!1),O(6),z("checked",n.y1),O(2),Wt("value",n.y1Phase),z("min",0)("max",6.28)("step",.05),O(2),z("checked",n.y2),O(2),Wt("value",n.y2Phase),z("min",0)("max",6.28)("step",.05),O(2),z("checked",n.y3),O(2),Wt("value",n.y3Phase),z("min",0)("max",6.28)("step",.05),O(3),z("value",n.fe)("max",64)("min",0)("step",.1),O(3),z("options",n.original_graph),O(),z("options",n.sampled_graph),O(),z("options",n.original_fft_graph),O(),z("options",n.sampled_fft_graph))},dependencies:[Jn,Au,rc,Mr,zo]})}return e})();var lc=class{static getGaussianKernel(t,i,r=1,n=1){t=t%2==0?t+1:t,i=i%2==0?i+1:i;let o=(t-1)/2,a=(i-1)/2,s=Math.sqrt(2),c=new Array;for(let d=0;d<t;d++)for(let u=0;u<i;u++){let h=Math.exp(-Math.pow((d-o)/(s*r),2)-Math.pow((u-a)/(s*n),2));c.push(h)}let l=c.reduce((d,u)=>d+u,0);return c=c.map(d=>d/l),{width:t,height:i,active:!0,mat:[c],name:"Gaussian"}}static getMeanKernel(t,i){let r=new Array(t*i).fill(1/(t*i));return{width:t,height:i,active:!0,mat:[r],name:"Mean"}}static getSobelKernels(){return{width:3,height:3,active:!0,mat:[[1,0,-1,2,0,-2,1,0,-1],[1,2,1,0,0,0,-1,-2,-1]],name:"Sobel"}}static getPrewittKernels(){return{width:3,height:3,active:!0,mat:[[1,0,-1,1,0,-1,1,0,-1],[1,1,1,0,0,0,-1,-1,-1]],name:"Prewitt"}}static getLaplacianKernel(){return{width:3,height:3,active:!0,mat:[[-1,-1,-1,-1,8,-1,-1,-1,-1]],name:"Laplacian"}}static getAdditiveKernel(t){return{width:1,height:1,active:!0,mat:[[t]],name:"Add"}}static getMultiplicativeKernel(t){return{width:1,height:1,active:!0,mat:[[t]],name:"Multiply"}}};var I2e=["canvas"],M2e=(e,t)=>({activated:e,deactivated:t}),p7=()=>[];function k2e(e,t){e&1&&(C(0,"mat-icon"),W(1,"visibility"),A())}function P2e(e,t){e&1&&(C(0,"mat-icon"),W(1,"visibility_off"),A())}function N2e(e,t){if(e&1&&(C(0,"td"),W(1),A()),e&2){let i=t.index,r=ae().index,n=ae().$implicit,o=ae();O(),Qr(" ",n[r*o.kernel.width+i].toFixed(2)," ")}}function O2e(e,t){if(e&1&&(C(0,"tr"),Be(1,N2e,2,1,"td",10),A()),e&2){let i=ae(2);O(),z("ngForOf",gc(1,p7).constructor(i.kernel.width))}}function R2e(e,t){if(e&1){let i=Ze();C(0,"div",8)(1,"table",9),Y("mouseenter",function(){let n=q(i).$implicit,o=ae();return X(o.drawFilter(n))}),Be(2,O2e,2,2,"tr",10),A()()}if(e&2){let i=ae();O(2),z("ngForOf",gc(1,p7).constructor(i.kernel.height))}}var f7=(()=>{class e{kernel;updateFilters=new We;width;height;canvas;ctx;constructor(){}ngOnInit(){this.kernel.delete=!1;let i=this.canvas.nativeElement;this.ctx=i.getContext("2d"),this.width=this.kernel.width,this.height=this.kernel.height,i.width=this.width,i.height=this.height,this.ctx.canvas.width=this.width,this.ctx.canvas.height=this.height,this.drawFilter(this.kernel.mat[0])}delete(i){i.stopPropagation(),this.kernel.delete=!0,this.updateFilters.emit()}toggleActive(i){i.stopPropagation(),this.kernel.active=!this.kernel.active,this.updateFilters.emit()}drawFilter(i){let r=new Uint8ClampedArray(4*i.length),n=i.reduce(function(s,c){return s>c?s:c}),o=i.reduce(function(s,c){return s<c?s:c});o==n&&(o=0,n=1);for(let s=0;s<i.length;s++){let c=s*4,l=Math.round(255*(i[s]-o)/(n-o));r[c]=l,r[c+1]=l,r[c+2]=l,r[c+3]=255}let a=new ImageData(r,this.kernel.width,this.kernel.height);this.ctx.putImageData(a,0,0)}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Le({type:e,selectors:[["app-kernel-element"]],viewQuery:function(r,n){if(r&1&&ht(I2e,7),r&2){let o;Ve(o=ze())&&(n.canvas=o.first)}},inputs:{kernel:"kernel"},outputs:{updateFilters:"updateFilters"},decls:15,vars:8,consts:[["canvas",""],[3,"ngClass"],["mat-mini-fab","","color","accent",1,"action-button",3,"click"],[4,"ngIf"],[1,"title-span"],["mat-mini-fab","","color","warn",1,"action-button",3,"click"],[1,"vertical-flex","center"],["class","rounded-table",4,"ngFor","ngForOf"],[1,"rounded-table"],[3,"mouseenter"],[4,"ngFor","ngForOf"]],template:function(r,n){if(r&1){let o=Ze();C(0,"mat-expansion-panel",1)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"button",2),Y("click",function(s){return q(o),X(n.toggleActive(s))}),Be(4,k2e,2,0,"mat-icon",3)(5,P2e,2,0,"mat-icon",3),A(),C(6,"span",4),W(7),A(),C(8,"button",5),Y("click",function(s){return q(o),X(n.delete(s))}),C(9,"mat-icon"),W(10,"close"),A()()()(),C(11,"div",6),Be(12,R2e,3,2,"div",7),he(13,"canvas",null,0),A()()}r&2&&(z("ngClass",Zp(5,M2e,n.kernel.active,!n.kernel.active)),O(4),z("ngIf",n.kernel.active),O(),z("ngIf",!n.kernel.active),O(2),Qr(" ",n.kernel.name," "),O(5),z("ngForOf",n.kernel.mat))},dependencies:[Il,Xn,Yn,nd,od,Tu,qm,Bo],styles:["canvas[_ngcontent-%COMP%]{width:128px;aspect-ratio:1;image-rendering:-moz-crisp-edges;image-rendering:-webkit-crisp-edges;image-rendering:pixelated;image-rendering:crisp-edges;box-shadow:#0000001f 0 1px 3px,#0000003d 0 1px 2px;border-radius:.5em}.title-span[_ngcontent-%COMP%]{margin:auto}tr[_ngcontent-%COMP%]:nth-child(odd){background-color:#646464}.horizontal-flex[_ngcontent-%COMP%]{width:100%}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#6f9b75}td[_ngcontent-%COMP%]{font-size:small}.center[_ngcontent-%COMP%]{align-items:center;gap:1em}.deactivated[_ngcontent-%COMP%]:not(button){filter:brightness(.7);border:solid white 1px}.rounded-table[_ngcontent-%COMP%]{border-radius:.75em;overflow:hidden;box-shadow:#0000001f 0 1px 3px,#0000003d 0 1px 2px}button[_ngcontent-%COMP%]{transform:scale(.5)}"]})}return e})();function L2e(e,t){if(e&1){let i=Ze();C(0,"button",25),Y("click",function(){q(i);let n=ae();return X(n.cleanFilterList())}),W(1," Clear "),A()}}function B2e(e,t){if(e&1){let i=Ze();C(0,"app-kernel-element",26),Y("updateFilters",function(){q(i);let n=ae();return X(n.updateFilters())}),A()}if(e&2){let i=t.$implicit;z("kernel",i)}}var m7=(()=>{class e extends Fo{listKernels;updateFilters(){this.listKernels=this.listKernels.filter(i=>!i.delete),this.applyFilter()}ngAfterContentInit(){this.listKernels=new Array}laplacianFilter(){this.listKernels.push(lc.getLaplacianKernel()),this.applyFilter()}gaussianBlur(i,r,n){this.listKernels.push(lc.getGaussianKernel(i,i,r,n)),this.applyFilter()}meanFilter(i){this.listKernels.push(lc.getMeanKernel(i,i)),this.applyFilter()}prewittFilter(){this.listKernels.push(lc.getPrewittKernels()),this.applyFilter()}sobelFilter(){this.listKernels.push(lc.getSobelKernels()),this.applyFilter()}additiveFilter(i){this.listKernels.push(lc.getAdditiveKernel(i)),this.applyFilter()}multiplyFilter(i){this.listKernels.push(lc.getMultiplicativeKernel(i)),this.applyFilter()}cleanFilterList(){this.listKernels=new Array,this.applyFilter()}applyFilter(){let i=cv.imread(this.drawCanvas.getCanvas()),r=new cv.Mat;i.convertTo(r,cv.CV_32F,1/255),cv.cvtColor(r,r,cv.COLOR_RGB2GRAY),this.listKernels.forEach(n=>{if(n.active)if(n.name=="Add")r.convertTo(r,-1,1,n.mat[0][0]);else if(n.name=="Multiply")r.convertTo(r,-1,n.mat[0][0],0);else if(n.mat.length==2){let o=cv.matFromArray(n.width,n.height,cv.CV_32F,n.mat[0]),a=new cv.Mat;cv.filter2D(r,a,-1,o),cv.pow(a,2,a),o=cv.matFromArray(n.width,n.height,cv.CV_32F,n.mat[1]);let s=new cv.Mat;cv.filter2D(r,s,-1,o),cv.pow(s,2,s),cv.add(a,s,r),cv.pow(r,.5,r),o.delete(),a.delete(),s.delete()}else{let o=cv.matFromArray(n.width,n.height,cv.CV_32F,n.mat[0]);cv.filter2D(r,r,-1,o),o.delete()}}),cv.convertScaleAbs(r,r,255),cv.imshow(this.outputCanvas.getCanvas(),r),i.delete(),r.delete()}static \u0275fac=(()=>{let i;return function(n){return(i||(i=Ar(e)))(n||e)}})();static \u0275cmp=Le({type:e,selectors:[["app-spatial-filtering"]],features:[Yt],decls:99,vars:32,consts:[["brushSizeSlider",""],["additiveFilterSlider",""],["multiplyFilterSlider",""],["meanFilterSlider",""],["gaussSizeSlider",""],["gaussSTDSliderX",""],["gaussSDTSliderY",""],["inputCanvas",""],["outputCanvas",""],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["title","Brush Size"],[1,"filter-name"],["mat-mini-fab","","color","accent",1,"action-button",3,"click"],["title","Addition factor",3,"max","min","value","step"],["mat-raised-button","","color","primary",1,"add-button",3,"click"],["title","Multiplication factor",3,"max","min","value","step"],["title","Kernel size",3,"max","min","value","step"],["title","STD X",3,"max","min","value","step"],["title","STD Y",3,"max","min","value","step"],["ngProjectAs","[drawerRight]",5,["","drawerRight",""]],["mat-raised-button","","color","warn","class","fillWidth",3,"click",4,"ngIf"],[3,"kernel","updateFilters",4,"ngFor","ngForOf"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["title","Canvas",1,"canvas",3,"drawingEnded","width","drawable","BWOption","brushRadius"],["title","Filtered canvas",1,"canvas",3,"width","drawable"],["mat-raised-button","","color","warn",1,"fillWidth",3,"click"],[3,"updateFilters","kernel"]],template:function(r,n){if(r&1){let o=Ze();C(0,"app-tutorial-template-images"),W(1," Spatial filtering "),Ot(2,9),he(3,"app-labelled-sliders",10,0)(5,"hr"),C(6,"mat-expansion-panel")(7,"mat-expansion-panel-header")(8,"mat-panel-title")(9,"span",11)(10,"button",12),Y("click",function(s){q(o);let c=Ft(15);return n.additiveFilter(c.value),X(s.stopPropagation())}),C(11,"mat-icon"),W(12," add "),A()(),W(13," Brightness "),A()()(),he(14,"app-labelled-sliders",13,1),C(16,"button",14),Y("click",function(){q(o);let s=Ft(15);return X(n.additiveFilter(s.value))}),W(17," Add "),A()(),C(18,"mat-expansion-panel")(19,"mat-expansion-panel-header")(20,"mat-panel-title")(21,"span",11)(22,"button",12),Y("click",function(s){q(o);let c=Ft(27);return n.multiplyFilter(c.value),X(s.stopPropagation())}),C(23,"mat-icon"),W(24," add "),A()(),W(25," Contrast "),A()()(),he(26,"app-labelled-sliders",15,2),C(28,"button",14),Y("click",function(){q(o);let s=Ft(27);return X(n.multiplyFilter(s.value))}),W(29," Add "),A()(),C(30,"mat-expansion-panel")(31,"mat-expansion-panel-header")(32,"mat-panel-title")(33,"span",11)(34,"button",12),Y("click",function(s){q(o);let c=Ft(39);return n.meanFilter(c.value),X(s.stopPropagation())}),C(35,"mat-icon"),W(36," add "),A()(),W(37," Mean blur "),A()()(),he(38,"app-labelled-sliders",16,3),C(40,"button",14),Y("click",function(){q(o);let s=Ft(39);return X(n.meanFilter(s.value))}),W(41," Add "),A()(),C(42,"mat-expansion-panel")(43,"mat-expansion-panel-header")(44,"mat-panel-title")(45,"span",11)(46,"button",12),Y("click",function(s){q(o);let c=Ft(51),l=Ft(53),d=Ft(55);return n.gaussianBlur(c.value,l.value,d.value),X(s.stopPropagation())}),C(47,"mat-icon"),W(48," add "),A()(),W(49," Gaussian blur "),A()()(),he(50,"app-labelled-sliders",16,4)(52,"app-labelled-sliders",17,5)(54,"app-labelled-sliders",18,6),C(56,"button",14),Y("click",function(){q(o);let s=Ft(51),c=Ft(53),l=Ft(55);return X(n.gaussianBlur(s.value,c.value,l.value))}),W(57," Add "),A()(),C(58,"mat-expansion-panel")(59,"mat-expansion-panel-header")(60,"mat-panel-title")(61,"span",11)(62,"button",12),Y("click",function(s){return q(o),n.prewittFilter(),X(s.stopPropagation())}),C(63,"mat-icon"),W(64," add "),A()(),W(65," Prewitt Filter "),A()()(),C(66,"button",14),Y("click",function(){return q(o),X(n.prewittFilter())}),W(67," Add "),A()(),C(68,"mat-expansion-panel")(69,"mat-expansion-panel-header")(70,"mat-panel-title")(71,"span",11)(72,"button",12),Y("click",function(s){return q(o),n.sobelFilter(),X(s.stopPropagation())}),C(73,"mat-icon"),W(74," add "),A()(),W(75," Sobel Filter "),A()()(),C(76,"button",14),Y("click",function(){return q(o),X(n.sobelFilter())}),W(77," Add "),A()(),C(78,"mat-expansion-panel")(79,"mat-expansion-panel-header")(80,"mat-panel-title")(81,"span",11)(82,"button",12),Y("click",function(s){return q(o),n.laplacianFilter(),X(s.stopPropagation())}),C(83,"mat-icon"),W(84," add "),A()(),W(85," Laplacian Filter "),A()()(),C(86,"button",14),Y("click",function(){return q(o),X(n.laplacianFilter())}),W(87," Add "),A()(),Rt(),Ot(88,19),C(89,"h2"),W(90,"Active filters"),A(),Be(91,L2e,2,0,"button",20),he(92,"hr"),Be(93,B2e,1,1,"app-kernel-element",21),Rt(),Ot(94,22),C(95,"app-draw-canvas",23,7),Y("drawingEnded",function(){return q(o),X(n.applyFilter())}),A(),he(97,"app-draw-canvas",24,8),Rt(),A()}if(r&2){let o=Ft(4);O(14),z("max",1)("min",-1)("value",0)("step",.1),O(12),z("max",5)("min",0)("value",1)("step",.1),O(12),z("max",9)("min",3)("value",3)("step",2),O(12),z("max",15)("min",3)("value",9)("step",2),O(2),z("max",15)("min",0)("value",2)("step",.5),O(2),z("max",15)("min",0)("value",2)("step",.5),O(37),z("ngIf",n.listKernels.length),O(2),z("ngForOf",n.listKernels),O(2),z("width",512)("drawable",!0)("BWOption",!0)("brushRadius",o.value),O(2),z("width",512)("drawable",!1)}},dependencies:[Xn,Yn,nd,od,Tu,on,qm,Bo,Vo,f7,Mr,Va],styles:[".filter-name[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transform:scale(.5)}.add-button[_ngcontent-%COMP%]{width:100%}mat-expansion-panel[_ngcontent-%COMP%]{width:100%}.canvas[_ngcontent-%COMP%]{width:45%;min-width:256px}"]})}return e})();var g7=(()=>{class e extends Fo{width=256;updateFFT(){let i=cv.imread(this.drawCanvas.getCanvas());cv.cvtColor(i,i,cv.COLOR_RGBA2GRAY,0);let r=cv.getOptimalDFTSize(i.rows),n=cv.getOptimalDFTSize(i.cols),o=cv.Scalar.all(0),a=new cv.Mat;cv.copyMakeBorder(i,a,0,r-i.rows,0,n-i.cols,cv.BORDER_CONSTANT,o);let s=new cv.Mat;a.convertTo(s,cv.CV_32F);let c=new cv.MatVector,l=new cv.Mat,d=new cv.Mat.zeros(a.rows,a.cols,cv.CV_32F);c.push_back(s),c.push_back(d),cv.merge(c,l),cv.dft(l,l,cv.DFT_SCALE),cv.split(l,c),cv.magnitude(c.get(0),c.get(1),c.get(0));let u=c.get(0),h=new cv.Mat.ones(u.rows,u.cols,u.type());cv.add(u,h,u),cv.log(u,u);let p=new cv.Rect(0,0,u.cols&-2,u.rows&-2);u=u.roi(p);let m=u.cols/2,f=u.rows/2,g=new cv.Mat,v=new cv.Rect(0,0,m,f),_=new cv.Rect(m,0,m,f),b=new cv.Rect(0,f,m,f),y=new cv.Rect(m,f,m,f),x=u.roi(v),w=u.roi(_),I=u.roi(b),S=u.roi(y);x.copyTo(g),S.copyTo(x),g.copyTo(S),w.copyTo(g),I.copyTo(w),g.copyTo(I),cv.normalize(u,u,0,1,cv.NORM_MINMAX),this.outputCanvas.drawMat(u),i.delete(),a.delete(),c.delete(),l.delete(),h.delete(),g.delete()}updateIFFT(){let i=cv.imread(this.drawCanvas.getCanvas());cv.cvtColor(i,i,cv.COLOR_RGBA2GRAY,0);let r=cv.getOptimalDFTSize(i.rows),n=cv.getOptimalDFTSize(i.cols),o=cv.Scalar.all(0),a=new cv.Mat;cv.copyMakeBorder(i,a,0,r-i.rows,0,n-i.cols,cv.BORDER_CONSTANT,o);let s=new cv.Mat;a.convertTo(s,cv.CV_32F);let c=new cv.MatVector,l=new cv.Mat,d=new cv.Mat.zeros(a.rows,a.cols,cv.CV_32F);c.push_back(s),c.push_back(d),cv.merge(c,l),cv.dft(l,l);let u=cv.imread(this.outputCanvas.getCanvas());cv.cvtColor(u,u,cv.COLOR_RGBA2GRAY,0);let h=new cv.Rect(0,0,u.cols&-2,u.rows&-2);u=u.roi(h);let p=u.cols/2,m=u.rows/2,f=new cv.Mat,g=new cv.Rect(0,0,p,m),v=new cv.Rect(p,0,p,m),_=new cv.Rect(0,m,p,m),b=new cv.Rect(p,m,p,m),y=u.roi(g),x=u.roi(v),w=u.roi(_),I=u.roi(b);y.copyTo(f),I.copyTo(y),f.copyTo(I),x.copyTo(f),w.copyTo(x),f.copyTo(w);let S=new cv.Mat;cv.threshold(u,S,0,1,cv.THRESH_BINARY),S.convertTo(S,cv.CV_32F),cv.split(l,c),console.log(l.type(),S.type()),cv.multiply(c.get(0),S,c.get(0)),cv.multiply(c.get(1),S,c.get(1)),cv.merge(c,l),cv.dft(l,l,cv.DFT_INVERSE),cv.split(l,c),cv.magnitude(c.get(0),c.get(1),c.get(0));let E=c.get(0);cv.normalize(E,E,0,1,cv.NORM_MINMAX),this.drawCanvas.drawMat(E)}static \u0275fac=(()=>{let i;return function(n){return(i||(i=Ar(e)))(n||e)}})();static \u0275cmp=Le({type:e,selectors:[["app-spectral-filtering"]],features:[Yt],decls:11,vars:8,consts:[["brushSizeSlider",""],["inputCanvas",""],["outputCanvas",""],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["title","Brush Size"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["title","Canvas",1,"canvas",3,"drawingEnded","width","drawable","BWOption","brushRadius"],["title","Fourier space",1,"canvas",3,"drawingEnded","width","drawColor","drawable","brushRadius"]],template:function(r,n){if(r&1){let o=Ze();C(0,"app-tutorial-template-images"),W(1," Spectral filtering "),Ot(2,3),he(3,"app-labelled-sliders",4,0)(5,"hr"),Rt(),Ot(6,5),C(7,"app-draw-canvas",6,1),Y("drawingEnded",function(){return q(o),X(n.updateFFT())}),A(),C(9,"app-draw-canvas",7,2),Y("drawingEnded",function(){return q(o),X(n.updateIFFT())}),A(),Rt(),A()}if(r&2){let o=Ft(4);O(7),z("width",n.width)("drawable",!0)("BWOption",!0)("brushRadius",o.value),O(2),z("width",n.width)("drawColor","black")("drawable",!0)("brushRadius",o.value)}},dependencies:[Vo,Mr,Va],styles:[".canvas[_ngcontent-%COMP%]{width:45%;min-width:256px}"]})}return e})();var fE=(()=>{class e{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(i){this._vertical=Lo(i)}get inset(){return this._inset}set inset(i){this._inset=Lo(i)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=Le({type:e,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(r,n){r&2&&(Zt("aria-orientation",n.vertical?"vertical":"horizontal"),It("mat-divider-vertical",n.vertical)("mat-divider-horizontal",!n.vertical)("mat-divider-inset",n.inset))},inputs:{vertical:"vertical",inset:"inset"},standalone:!0,features:[ci],decls:0,vars:0,template:function(r,n){},styles:[".mat-divider{display:block;margin:0;border-top-style:solid;border-top-color:var(--mat-divider-color);border-top-width:var(--mat-divider-width)}.mat-divider.mat-divider-vertical{border-top:0;border-right-style:solid;border-right-color:var(--mat-divider-color);border-right-width:var(--mat-divider-width)}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}"],encapsulation:2,changeDetection:0})}}return e})(),mE=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Ut,Ut]})}}return e})();var V2e=["foreground"],z2e=["background"],_7=(()=>{class e extends Fo{viewerSize=256;foregroundCanvas;backgroundCanvas;backgroundData;foregroundData;meanBG=0;meanFG=0;psnr=0;localcontrast=0;rois=[{name:"Background",color:"#f55d42",initial1:{x:256,y:256},initial2:{x:400,y:400}},{name:"Foreground",color:"#44ad52",initial1:{x:128,y:128},initial2:{x:256,y:256}}];pepperSaltNoise=.1;gaussianNoise=5;ngOnInit(){}ngAfterViewInit(){super.ngAfterViewInit(),super.loadSelectedFileFromPath("assets/image_presets/phantom.png")}updateCanvasROI(i){return Qe(this,null,function*(){let r=i.data;if(r==null)return;if(i.name=="Background"){var n=this.backgroundCanvas.nativeElement.getContext("2d");this.backgroundData=new Array(r.data.length/4);for(let s=0;s<r.data.length;s+=4)this.backgroundData[s/4]=(r.data[s]+r.data[s+1]+r.data[s+2])/3}else{var n=this.foregroundCanvas.nativeElement.getContext("2d");this.foregroundData=new Array(r.data.length/4);for(let c=0;c<r.data.length;c+=4)this.foregroundData[c/4]=(r.data[c]+r.data[c+1]+r.data[c+2])/3}let o={width:this.viewerSize,height:this.viewerSize},a=yield window.createImageBitmap(r,0,0,r.width,r.height,{resizeHeight:o.height,resizeWidth:o.width});requestAnimationFrame(()=>{n!=null&&r!=null&&(n.clearRect(0,0,n.canvas.width,n.canvas.height),n.canvas.width=this.viewerSize,n.canvas.height=this.viewerSize,n.drawImage(a,0,0),this.updateStats())})})}updateStats(){let i=this.backgroundData,r=this.foregroundData;this.meanBG=kP(i),this.meanFG=kP(r);let n=W$(i,this.meanBG);this.psnr=(this.meanFG-this.meanBG)/n,this.localcontrast=(this.meanFG-this.meanBG)/this.meanBG}addPepperSaltNoise(){let i=this.drawCanvas.getCtx().getImageData(0,0,this.drawCanvas.getCtx().canvas.width,this.drawCanvas.getCtx().canvas.height).data;for(let r=0;r<i.length;r+=4)Math.random()<this.pepperSaltNoise&&(Math.random()<.5?(i[r]=0,i[r+1]=0,i[r+2]=0):(i[r]=255,i[r+1]=255,i[r+2]=255));this.drawCanvas.drawArray(i)}addGaussianNoise(){let i=this.drawCanvas.getCtx().getImageData(0,0,this.drawCanvas.getCtx().canvas.width,this.drawCanvas.getCtx().canvas.height).data;for(let r=0;r<i.length;r+=4){let n=q$(0,this.gaussianNoise);i[r]+=n,i[r+1]+=n,i[r+2]+=n}this.drawCanvas.drawArray(i)}static \u0275fac=(()=>{let i;return function(n){return(i||(i=Ar(e)))(n||e)}})();static \u0275cmp=Le({type:e,selectors:[["app-psnr"]],viewQuery:function(r,n){if(r&1&&(ht(V2e,5),ht(z2e,5)),r&2){let o;Ve(o=ze())&&(n.foregroundCanvas=o.first),Ve(o=ze())&&(n.backgroundCanvas=o.first)}},features:[Yt],decls:51,vars:23,consts:[["brushSizeSlider",""],["inputCanvas",""],["background",""],["foreground",""],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["title","Brush Size"],["title","Probability",3,"valueChange","value","min","max","step"],["mat-raised-button","","color","primary",3,"click"],["title","Gaussian Noise",3,"valueChange","value","min","max","step"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["title","Canvas",1,"w-1/2",3,"roiChanged","width","drawable","roi","brushRadius","BWOption","profileOption"],["ngProjectAs","[drawerRight]",5,["","drawerRight",""]],[1,"flex","flex-col","gap-2","mx-4"],[1,"w-64","aspect-square","border"],[1,"flex","justify-between"],[1,"flex","flex-col","gap-2"]],template:function(r,n){if(r&1){let o=Ze();C(0,"app-tutorial-template-images"),W(1," Image Quality "),Ot(2,4),he(3,"app-labelled-sliders",5,0)(5,"hr"),C(6,"app-labelled-sliders",6),qt("valueChange",function(s){return q(o),jt(n.pepperSaltNoise,s)||(n.pepperSaltNoise=s),X(s)}),Y("valueChange",function(s){return q(o),X(n.pepperSaltNoise=s)}),A(),C(7,"button",7),Y("click",function(){return q(o),X(n.addPepperSaltNoise())}),W(8,"Add pepper & salt noise"),A(),he(9,"hr"),C(10,"app-labelled-sliders",8),qt("valueChange",function(s){return q(o),jt(n.gaussianNoise,s)||(n.gaussianNoise=s),X(s)}),Y("valueChange",function(s){return q(o),X(n.gaussianNoise=s)}),A(),C(11,"button",7),Y("click",function(){return q(o),X(n.addGaussianNoise())}),W(12,"Add Gaussian noise"),A(),Rt(),Ot(13,9),C(14,"app-draw-canvas",10,1),Y("roiChanged",function(s){return q(o),X(n.updateCanvasROI(s))}),A(),Rt(),Ot(16,11),C(17,"div",12)(18,"h3"),W(19,"Background"),A(),he(20,"canvas",13,2),C(22,"div",14)(23,"p"),W(24,"Mean"),A(),C(25,"p"),W(26),A()(),he(27,"mat-divider"),C(28,"h3"),W(29,"Foreground"),A(),he(30,"canvas",13,3),C(32,"div",14)(33,"p"),W(34,"Mean"),A(),C(35,"p"),W(36),A()(),he(37,"mat-divider"),C(38,"h3"),W(39,"Statistics"),A(),C(40,"div",15)(41,"div",14)(42,"p"),W(43,"SNR Differential"),A(),C(44,"p"),W(45),A()(),C(46,"div",14)(47,"p"),W(48,"Local contrast"),A(),C(49,"p"),W(50),A()()()(),Rt(),A()}if(r&2){let o=Ft(4);O(6),Wt("value",n.pepperSaltNoise),z("min",0)("max",1)("step",.01),O(4),Wt("value",n.gaussianNoise),z("min",0)("max",75)("step",.5),O(4),z("width",512)("drawable",!1)("roi",n.rois)("drawable",!0)("brushRadius",o.value)("BWOption",!0)("profileOption",!1),O(6),li("border-color",n.rois[0].color),O(6),Pr(n.meanBG.toFixed(3)),O(4),li("border-color",n.rois[1].color),O(6),Pr(n.meanFG.toFixed(3)),O(9),Pr(n.psnr.toFixed(3)),O(5),Pr(n.localcontrast.toFixed(3))}},dependencies:[fE,on,Vo,Mr,Va]})}return e})();var cc=class{ctx;name;constructor(){this.ctx=[]}parameters(){return null}getName(){return this.name}description(){return[]}};function b7(e){let t=e.shape[0],i=e.shape[1],r=new dn([t,1]);for(let n=0;n<t;n++){let o=-1/0,a=0;for(let s=0;s<i;s++)e.data[n*i+s]>o&&(o=e.data[n*i+s],a=s);r.data[n]=a}return r}function y7(e,t,i){let r=e.shape[0],n=e.shape[1];if(n!==t.shape[0])throw new Error("Matrix dimensions do not match, got "+n+" and "+t.shape[0]);let o=t.shape[1],a=new dn([r,o]);for(let s=0;s<r;s++)for(let c=0;c<o;c++){for(let l=0;l<n;l++)a.data[s*o+c]+=e.data[s*n+l]*t.data[l*o+c];i!==void 0&&(a.data[s*o+c]+=i.data[c])}return a}function x7(e,t,i){for(let r=0;r<e.length();r++)e.grad[r]=Math.min(i,Math.max(t,e.grad[r]));return e}var dn=class e{data;shape;grad;require_grad=!0;constructor(t,i=!0){this.require_grad=i,this.data=new Array(t.reduce((r,n)=>r*n)).fill(0),this.shape=t,this.grad=new Array(t.reduce((r,n)=>r*n)).fill(0)}length(){return this.data.length}at(t){return this.data[t]}clone(){let t=new e(this.shape);return t.data=this.data.slice(),t.grad=this.grad.slice(),t}matmul(t,i){return y7(this,t,i)}transpose(){let[t,i]=this.shape,r=new e([i,t]);for(let n=0;n<t;n++)for(let o=0;o<i;o++)r.data[o*t+n]=this.data[n*i+o],r.grad[o*t+n]=this.grad[n*i+o];return r}T(){return this.transpose()}new_like(){return new e(this.shape)}argmax(){return b7(this)}norm(){let t=0;for(let i=0;i<this.data.length;i++)t+=this.data[i]**2;return Math.sqrt(t)}};var fs=class extends cc{weights;bias;hasBias;constructor(t,i,r=!0){super(),this.weights=new dn([t,i]);let n=Math.sqrt(2/(t+i));this.weights.data=this.weights.data.map(()=>n*(2*Math.random()-1)),this.hasBias=r,this.hasBias&&(this.bias=new dn([i])),this.name="FullyConnected"}forward(t){this.ctx=[];let i=t.matmul(this.weights,this.hasBias?this.bias:void 0);return this.ctx.push(t),i}backward(t){let i=this.ctx[0],r=t.shape[0],n=t.shape[1],o=t.new_like();if(o.data=t.grad,i.require_grad){let a=o.matmul(this.weights.T(),void 0);i.grad=a.data}if(this.weights.grad=o.T().matmul(i,void 0).T().data,this.hasBias)for(let a=0;a<r;a++)for(let s=0;s<n;s++)this.bias.grad[s]+=t.grad[a*n+s];return i}parameters(){return this.hasBias?[this.weights,this.bias]:[this.weights]}description(){return[`Input shape: ${this.weights.shape[0]}`,`Output shape: ${this.weights.shape[1]}`]}getName(){return`Fully connected (${this.weights.shape[0]} \u2192 ${this.weights.shape[1]})`}};var ad=class extends cc{name="Activation";forward(t){throw new Error("Method not implemented.")}backward(t){throw new Error("Method not implemented.")}},Du=class extends ad{name="RELU";forward(t){let i=t.new_like();this.ctx=[],this.ctx.push(t);for(let r=0;r<i.data.length;r++)i.data[r]=Math.max(0,t.data[r]);return i}backward(t){let i=this.ctx[0];for(let r=0;r<i.data.length;r++)i.grad[r]=i.data[r]>0?t.grad[r]:0;return i}},dg=class extends ad{name="Sigmoid";forward(t){let i=t.new_like();this.ctx=[],this.ctx.push(t),this.ctx.push(i);for(let r=0;r<i.data.length;r++)i.data[r]=1/(1+Math.exp(-t.data[r]));return i}backward(t){let i=this.ctx[0],r=this.ctx[1];for(let n=0;n<r.data.length;n++)i.grad[n]=t.grad[n]*r.data[n]*(1-r.data[n]);return i}},ug=class extends ad{name="TanH";forward(t){let i=t.new_like();this.ctx=[];for(let r=0;r<i.data.length;r++)i.data[r]=Math.tanh(t.data[r]);return this.ctx.push(t),this.ctx.push(i),i}backward(t){let i=this.ctx[0],r=this.ctx[1];for(let n=0;n<i.data.length;n++)i.grad[n]=t.grad[n]*(1-r.data[n]*r.data[n]);return i}},hg=class extends ad{name="Identity";forward(t){return t}backward(t){return t}},gE=class extends ad{name="Softmax";forward(t){let i=t.new_like(),r=t.shape[0],n=t.shape[1];this.ctx=[],this.ctx.push(t);let o=new dn([r]);for(let a=0;a<r;a++){let s=0;for(let c=0;c<n;c++)i.data[a*n+c]=Math.exp(t.data[a*n+c]),s+=i.data[a*n+c];for(let c=0;c<n;c++)i.data[a*n+c]/=s;o.data[a]=s}return this.ctx.push(o),i}backward(t){let i=this.ctx[0],r=this.ctx[1],n=i.shape[0],o=i.shape[1],a=new dn(i.shape);for(let s=0;s<n;s++)for(let c=0;c<o;c++)a.data[s*o+c]=t.data[s*o+c]*(r.data[s]-Math.exp(i.data[s*o+c]))/(r.data[s]*r.data[s]);return i.grad=a.data,i}};var pg=class{layers;is_regression;constructor(t=!1){this.is_regression=t,this.layers=[]}addLayer(t){this.layers.push(t)}addLayerAtPosition(t,i){this.layers.splice(i,0,t)}removeLayerAtPosition(t){this.layers.splice(t,1)}forward(t){let i=t;for(let r=0;r<this.layers.length;r++)i=this.layers[r].forward(i);if(i instanceof Array&&(i=i[0]),i===null)throw new Error("Activations cannot be null");return i}inference(t){let i=this.forward(t);if(this.is_regression)return i;{let r=i.shape[0],n=i.shape[1],o=new dn([r]);for(let a=0;a<r;a++)o.data[a]=i.data[a*n+1];return o}}backward(t){for(let i=this.layers.length-1;i>=0;i--)t=this.layers[i].backward(t)}parameters(){let t=new Array;for(let i=0;i<this.layers.length;i++){let r=this.layers[i].parameters();r&&(t=t.concat(r))}return t}zero_grad(){for(let t=0;t<this.layers.length;t++){let i=this.layers[t].parameters();if(i)for(let r=0;r<i.length;r++)i[r].grad.fill(0)}}changeActivation(t){for(let i=0;i<this.layers.length;i++)if(this.layers[i]instanceof ad){let r;t==="sigmoid"?r=new dg:t==="tanh"?r=new ug:t==="identity"?r=new hg:r=new Du,this.layers[i]=r}}n_fc_layers(){let t=0;for(let i=0;i<this.layers.length;i++)this.layers[i]instanceof fs&&t++;return t}n_hidden_fc_layers(){return this.n_fc_layers()-2}swap_fc_layers(t,i){let r=0;for(let n=0;n<this.layers.length;n++){let o=this.layers[n];if(o instanceof fs){if(r===t){let a=Math.min(o.weights.shape[0],i.weights.shape[0]),s=Math.min(o.weights.shape[1],i.weights.shape[1]);for(let c=0;c<a;c++)for(let l=0;l<s;l++)i.weights.data[c*i.weights.shape[1]+l]=o.weights.data[c*o.weights.shape[1]+l],i.bias.data[c]=o.bias.data[c];this.layers[n]=i;return}r++}}}getParamsNorms(t){let i=this.layers[t].parameters();if(!i)return;let r=new Array(i.length);for(let n=0;n<i.length;n++)r[n]=i[n].norm();return r}trainableLayers(){let t=[];for(let i=0;i<this.layers.length;i++)this.layers[i].parameters()&&t.push(this.layers[i]);return t}};var Iu=class{x;y;label;constructor(t,i,r){this.x=t,this.y=i,this.label=r}},I_=class{data=[];class1Color="#313695";class2Color="#a50026";constructor(){}get(t){return this.data[t]}length(){return this.data.length}shuffle(){this.data=this.data.sort(()=>Math.random()-.5)}getBatch(t,i){let r=[];for(let a=0;a<i;a++)t*i+a>=this.data.length&&(t=0),r.push(this.data[t*i+a]);let n=new dn([i,2],!1);n.data=r.map(a=>[a.x,a.y]).flat();let o=new dn([i,1],!1);return o.data=r.map(a=>a.label),[n,o]}getCSSForPoint(t){let i=(this.data[t].x+1)/2*100,r=(this.data[t].y+1)/2*100;return{left:i+"%",top:r+"%","background-color":this.data[t].label?this.class1Color:this.class2Color}}createLinearlySeparable(t){let i=[];for(let r=0;r<t;r++){let n=Math.random()*2-1,o=Math.random()*2-1,a=n>o?1:0;i.push(new Iu(n,o,a))}this.data=i}createSpiralPoints(t,i=1){let r=[];for(let n=0;n<t/2;n++){let o=n/(t/2),a=i*n/t*4*Math.PI,s=i*n/t*4*Math.PI+Math.PI,c=o*Math.sin(a)+Math.random()*.25,l=o*Math.cos(a)+Math.random()*.25;c=Math.max(Math.min(1,c),-1),l=Math.max(Math.min(1,l),-1);let d=1;r.push(new Iu(c,l,d)),c=o*Math.sin(s)+Math.random()*.25,l=o*Math.cos(s)+Math.random()*.25,c=Math.max(Math.min(1,c),-1),l=Math.max(Math.min(1,l),-1),d=0,r.push(new Iu(c,l,d))}this.data=r}createCircularPoints(t){let i=[];for(let r=0;r<t;r++){let n=Math.random()*2-1,o=Math.random()*2-1,a=Math.sqrt(n*n+o*o)<.5?1:0;i.push(new Iu(n,o,a))}this.data=i}};var M_=class{lr;weight_decay;model;momentum;momentums},dc=class extends M_{nesterov;constructor(t,i,r=0,n=0,o=!1){super(),this.model=t,this.lr=i,this.weight_decay=r,this.momentum=n,this.nesterov=o}reset_momentums(){if(this.momentum!=0){this.momentums=[];let t=this.model.parameters();for(let i=0;i<t.length;i++)this.momentums.push(new Array(t[i].length()).fill(0))}}step(){let t=this.model.parameters();for(let i=0;i<t.length;i++){let r=t[i];if(r=x7(r,-10,10),this.weight_decay!=0)for(let n=0;n<r.length();n++)r.grad[n]+=this.weight_decay*r.data[n];if(this.momentums)if(this.momentums[i]=r.grad,this.nesterov)for(let n=0;n<r.length();n++)r.grad[n]+=this.momentum*this.momentums[i][n];else r.grad=this.momentums[i];for(let n=0;n<r.length();n++)r.data[n]-=this.lr*r.grad[n]}}zero_grad(){this.model.zero_grad()}},fg=class extends M_{beta1;beta2;epsilon;velocities;constructor(t,i,r=0,n=.9,o=.999,a=1e-8){super(),this.model=t,this.lr=i,this.weight_decay=r,this.beta1=n,this.beta2=o,this.epsilon=a}reset_momentums(){if(this.momentum!=0){this.momentums=[],this.velocities=[];let t=this.model.parameters();for(let i=0;i<t.length;i++)this.momentums.push(new Array(t[i].length()).fill(0)),this.velocities.push(new Array(t[i].length()).fill(0))}}step(){let t=this.model.parameters();for(let i=0;i<t.length;i++){let r=t[i];if(this.weight_decay!=0)for(let n=0;n<r.length();n++)r.grad[n]+=this.weight_decay*r.data[n];if(this.momentums&&this.velocities){this.momentums[i]=this.momentums[i].map((a,s)=>this.beta1*a+(1-this.beta1)*r.grad[s]),this.velocities[i]=this.velocities[i].map((a,s)=>this.beta2*a+(1-this.beta2)*r.grad[s]*r.grad[s]);let n=this.momentums[i].map(a=>a/(1-Math.pow(this.beta1,1))),o=this.velocities[i].map(a=>a/(1-Math.pow(this.beta2,1)));for(let a=0;a<r.length();a++)r.data[a]-=this.lr*n[a]/(Math.sqrt(o[a])+this.epsilon)}}}zero_grad(){this.model.zero_grad()}},mg=class extends M_{rho;epsilon;squared_gradients;constructor(t,i,r,n=.9,o=1e-8){super(),this.model=t,this.lr=i,this.weight_decay=r,this.rho=n,this.epsilon=o}reset_momentums(){this.squared_gradients=[];let t=this.model.parameters();for(let i=0;i<t.length;i++)this.squared_gradients.push(new Array(t[i].length()).fill(0))}step(){let t=this.model.parameters();for(let i=0;i<t.length;i++){let r=t[i];if(this.weight_decay!=0)for(let n=0;n<r.length();n++)r.grad[n]+=this.weight_decay*r.data[n];this.squared_gradients[i]=this.squared_gradients[i].map((n,o)=>(n=this.rho*n+(1-this.rho)*r.grad[o]*r.grad[o],r.data[o]-=this.lr*r.grad[o]/(Math.sqrt(n)+this.epsilon),n))}}zero_grad(){this.model.zero_grad()}};var k_=class{model;dataset;loss;optimizer;currentEpoch=0;losses=[];trainTimeout;constructor(t,i,r){this.model=t,this.loss=i,this.optimizer=r}setDataset(t){this.dataset=t}train(t){if(!this.dataset)return;let i=0,r=0;this.trainTimeout=setInterval(()=>{if(i<this.dataset.length()/t){let n=this.dataset.getBatch(i,t);r+=this.train_step(n).data[0],i++}else this.currentEpoch++,this.losses.push(r/i),r=0,i=0},0)}train_step(t){this.optimizer.zero_grad();let i=t[0],r=t[1],n=this.model.forward(i),o=this.loss.forward([n,r]),a=this.loss.backward();return this.model.backward(a),this.optimizer.step(),o}stopTraining(){this.trainTimeout&&clearInterval(this.trainTimeout)}changeOptimizer(t,i,r){t==="adam"?this.optimizer=new fg(this.model,i,r):t==="sgd"?this.optimizer=new dc(this.model,i,r):this.optimizer=new mg(this.model,i,r),this.optimizer.reset_momentums()}correctlyPredicted(){let t=0,i=this.dataset.getBatch(0,this.dataset.length()),r=i[0],n=i[1],o=this.model.forward(r).argmax(),a=r.shape[0];for(let s=0;s<a;s++)o.at(s)==n.at(s)&&t++;return t}};var P_=class extends cc{is_logits;constructor(t=!0){super(),this.is_logits=t}forward(t){let i=t[0],r=t[1],n=i.shape[0],o=i.shape[1];this.ctx=t;let a=new dn([1]);this.is_logits&&(i=new gE().forward(i)),a.data=[0];for(let s=0;s<n;s++)for(let c=0;c<o;c++)a.data[0]+=+(r.at(s)==c)*Math.log(i.at(s*o+c)+1e-10);return a.data[0]/=-Math.max(n,1),a}backward(){let t=this.ctx[0],i=this.ctx[1],r=t.shape[0],n=t.shape[1];for(let o=0;o<r;o++){let a=i.at(o);for(let s=0;s<n;s++)s===a?t.grad[o*n+s]=(t.at(o*n+s)-1)/r:t.grad[o*n+s]=t.at(o*n+s)/r}return t}};var vE=[[.61960784,.00392157,.25882353,1],[.63652441,.02268358,.26282199,1],[.66189927,.05082661,.26881968,1],[.67881584,.06958862,.27281815,1],[.7041907,.09773164,.27881584,1],[.72110727,.11649366,.2828143,1],[.74648212,.14463668,.288812,1],[.77185698,.1727797,.29480969,1],[.78877355,.19154171,.29880815,1],[.8141484,.21968474,.30480584,1],[.83106498,.23844675,.30880431,1],[.84721261,.26120723,.30519031,1],[.8615148,.2828912,.29965398,1],[.8710496,.29734717,.29596309,1],[.88535179,.31903114,.29042676,1],[.89488658,.33348712,.28673587,1],[.90918877,.35517109,.28119954,1],[.91872357,.36962707,.27750865,1],[.93302576,.39131103,.27197232,1],[.94732795,.412995,.26643599,1],[.95686275,.42745098,.2627451,1],[.96101499,.45743945,.27658593,1],[.96378316,.47743176,.28581315,1],[.96793541,.50742022,.29965398,1],[.97208766,.53740869,.31349481,1],[.97485582,.557401,.32272203,1],[.97900807,.58738947,.33656286,1],[.98177624,.60738178,.34579008,1],[.98592849,.63737024,.35963091,1],[.98869666,.65736255,.36885813,1],[.99223376,.68619762,.38362168,1],[.99269512,.70926567,.40299885,1],[.99300269,.72464437,.41591696,1],[.99346405,.74771242,.43529412,1],[.99377163,.76309112,.44821223,1],[.99423299,.78615917,.46758939,1],[.99469435,.80922722,.48696655,1],[.99500192,.82460592,.49988466,1],[.99546328,.84767397,.51926182,1],[.99577086,.86305267,.53217993,1],[.99623222,.88319877,.55309496,1],[.99669358,.89750096,.57708574,1],[.99700115,.90703576,.59307958,1],[.99746251,.92133795,.61707036,1],[.99777009,.93087274,.63306421,1],[.99823145,.94517493,.65705498,1],[.99853902,.95470973,.67304883,1],[.99900038,.96901192,.6970396,1],[.99946175,.98331411,.72103037,1],[.99976932,.9928489,.73702422,1],[.99423299,.99769319,.74002307,1],[.98654364,.99461745,.72802768,1],[.97500961,.99000384,.7100346,1],[.96347559,.98539023,.69204152,1],[.95578624,.98231449,.68004614,1],[.94425221,.97770088,.66205306,1],[.93656286,.97462514,.65005767,1],[.92502884,.97001153,.63206459,1],[.91733948,.96693579,.6200692,1],[.90580546,.96232218,.60207612,1],[.88381392,.95340254,.59976932,1],[.86566705,.94602076,.60346021,1],[.83844675,.9349481,.60899654,1],[.82029988,.92756632,.61268743,1],[.79307958,.91649366,.61822376,1],[.76585928,.90542099,.62376009,1],[.74771242,.89803922,.62745098,1],[.72049212,.88696655,.63298731,1],[.70234525,.87958478,.6366782,1],[.67512495,.86851211,.64221453,1],[.64405998,.85628604,.64352172,1],[.62283737,.84798155,.6438293,1],[.59100346,.8355248,.64429066,1],[.56978085,.8272203,.64459823,1],[.53794694,.81476355,.64505959,1],[.51672434,.80645905,.64536717,1],[.48489043,.79400231,.64582853,1],[.45305652,.78154556,.64628989,1],[.43183391,.77324106,.64659746,1],[.4,.76078431,.64705882,1],[.38400615,.74294502,.6544406,1],[.36001538,.71618608,.66551326,1],[.33602461,.68942714,.67658593,1],[.32003076,.67158785,.6839677,1],[.29603998,.64482891,.69504037,1],[.28004614,.62698962,.70242215,1],[.25605536,.60023068,.71349481,1],[.24006151,.58239139,.72087659,1],[.21607074,.55563245,.73194925,1],[.19946175,.5289504,.73910035,1],[.212995,.51141869,.73079585,1],[.23329489,.48512111,.7183391,1],[.24682814,.46758939,.7100346,1],[.26712803,.44129181,.69757785,1],[.28742791,.41499423,.68512111,1],[.30096117,.39746251,.67681661,1],[.32126105,.37116494,.66435986,1],[.33479431,.35363322,.65605536,1],[.35509419,.32733564,.64359862,1],[.36862745,.30980392,.63529412,1]];var U2e=["heatmapCanvas"],H2e=["legendHeatmap"];function j2e(e,t){if(e&1){let i=Ze();C(0,"div",42,2),Y("chartInit",function(n){q(i);let o=ae(3);return X(o.paramsNormsEcharts.push(n))}),A()}if(e&2){let i=ae(2).index,r=ae();z("options",r.allParamsNorms[r.getClosestLayer(i)])}}function G2e(e,t){if(e&1&&(Ot(0),Be(1,j2e,2,1,"div",41),Rt()),e&2){let i=ae(2);O(),z("ngIf",i.allParamsNorms)}}function $2e(e,t){if(e&1&&(C(0,"mat-expansion-panel",40)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),W(3),A()(),C(4,"div",9),Be(5,G2e,2,1,"ng-container",37),A()()),e&2){let i=t.$implicit;z("hideToggle",i.description().length==0)("disabled",i.description().length===0),O(3),Qr(" ",i.getName()," "),O(2),z("ngIf",i.description().length>0)}}function W2e(e,t){if(e&1){let i=Ze();Ot(0),C(1,"div",43),Y("click",function(n){let o=q(i).index,a=ae();return X(a.removePoint(n,o))}),A(),Rt()}if(e&2){let i=t.index,r=ae();O(),z("ngStyle",r.dataset.getCSSForPoint(i))}}function q2e(e,t){if(e&1&&(C(0,"span"),W(1),A()),e&2){let i=ae();O(),L3(" ",i.correctlyClassified," / ",i.getDatasetLength()," points accurately classified (",(100*i.correctlyClassified/i.getDatasetLength()).toFixed(1),"%)")}}var w7=(()=>{class e extends mu{cdr;heatmapCanvas;legendHeatmap;paramsNormsEcharts=[];ctx;model;dataset=new I_;gridResolution=15;trainer;correctlyClassified=0;trainTimeout;n_points=150;n_layers=2;n_neurons=32;allParamsNorms;datasetType="linear";optimizerType="sgd";currentActivation="relu";isTraining=!1;batch_size=Math.trunc(this.n_points/2);heatmap;lr=.1;weight_decay=.001;heatmapOptions;lossOptions;constructor(i){super(),this.cdr=i}ngOnInit(){this.buildModel();let i=new dc(this.model,this.lr,1e-5,.1,!0);this.trainer=new k_(this.model,new P_,i)}buildModel(i=!0){let r=new pg(!1);r.addLayer(new fs(2,this.n_neurons)),r.addLayer(new Du);for(let n=0;n<this.n_layers;n++)r.addLayer(new fs(this.n_neurons,this.n_neurons)),r.addLayer(new Du);if(r.addLayer(new fs(this.n_neurons,2,!0)),this.model=r,this.model.changeActivation(this.currentActivation),i){this.allParamsNorms=[];for(let n=0;n<this.n_layers+2;n++)this.allParamsNorms.push({legend:{show:!0,backgroundColor:"rgba(255, 255, 255, 0.5)"},tooltip:{},xAxis:{type:"value",name:"Epochs",min:0},yAxis:{type:"value",name:"Norm"},series:[{data:[],type:"line"}]})}}ngAfterViewInit(){this.ctx=this.heatmapCanvas.nativeElement.getContext("2d"),this.buildHeatmapLegend(),this.resetDataset(),this.updateParamsNormsView(),setInterval(()=>{this.isTraining&&this.updateChart()},75),setInterval(()=>{this.isTraining&&this.updateParamsNormsView()},1e3)}getClosestLayer(i){return Math.floor(i/2)}buildHeatmapLegend(){let i=this.legendHeatmap.nativeElement.getContext("2d"),r=vE.length;for(let n=0;n<this.gridResolution;n++)i.fillStyle=this.colormap(n/this.gridResolution),i.fillRect(n,0,1,1)}updateParamsNormsView(){if(!this.allParamsNorms)return;let i=this.model.trainableLayers(),r=this.trainer.currentEpoch;i.forEach((n,o)=>{let a=n.parameters();if(!a)return;let s=this.allParamsNorms[o];if(!s)return;a.forEach((l,d)=>{let u=l.norm();if(!s.series)s.series=[{data:[[r,u]],type:"line",name:d==0?"Weights":"Bias"}];else if(Array.isArray(s.series))if(s.series.length<=d)s.series.push({data:[[r,u]],type:"line",name:d==0?"Weights":"Bias"});else{let h=s.series[d].data;s.series[d].name=d==0?"Weights":"Bias",h.push([r,u])}});let c=s.xAxis;c.max=r+10,this.allParamsNorms[o]=s,this.paramsNormsEcharts[o]&&this.paramsNormsEcharts[o].setOption(s)}),this.cdr.detectChanges()}changeNumberLayer(){if(!this.model)return;this.isTraining&&this.trainer.stopTraining();let i=this.model.n_fc_layers()-2;if(this.model.n_fc_layers()!=this.n_layers){if(this.n_layers>i)for(let r=0;r<this.n_layers-i;r++)this.allParamsNorms.push({legend:{show:!0,backgroundColor:"rgba(255, 255, 255, 0.5)"},tooltip:{},xAxis:{type:"value",name:"Epochs",min:0,max:this.trainer.currentEpoch+10},yAxis:{type:"value",name:"Norm"},series:[{data:[[0,0]],type:"line"}]}),this.model.addLayerAtPosition(new fs(this.n_neurons,this.n_neurons),-1),this.currentActivation=="relu"?this.model.addLayerAtPosition(new Du,-1):this.currentActivation=="sigmoid"?this.model.addLayerAtPosition(new dg,-1):this.currentActivation=="tanh"?this.model.addLayerAtPosition(new ug,-1):this.model.addLayerAtPosition(new hg,-1);else{let r=this.model.n_hidden_fc_layers();for(;r>this.n_layers;)this.allParamsNorms.pop(),this.paramsNormsEcharts.splice(-1,1),this.model.removeLayerAtPosition(-2),this.model.removeLayerAtPosition(-2),r--}this.trainer.optimizer.reset_momentums(),this.isTraining&&this.trainer.train(this.batch_size),this.cdr.detectChanges()}}changeNumberNeurons(){if(!this.n_neurons||!this.model)return;this.pauseTraining(),this.model.layers[0]=new fs(2,this.n_neurons);let i=this.model.n_fc_layers()-2;for(let r=0;r<i;r++)this.model.swap_fc_layers(r+1,new fs(this.n_neurons,this.n_neurons));this.model.swap_fc_layers(this.n_layers+1,new fs(this.n_neurons,2,!0)),this.trainer.optimizer.reset_momentums(),this.isTraining&&this.trainer.train(this.batch_size),this.cdr.detectChanges()}resetEchartsNorms(){this.allParamsNorms=[];for(let i=0;i<this.n_layers+2;i++)this.allParamsNorms.push({legend:{show:!0,backgroundColor:"rgba(255, 255, 255, 0.5)"},tooltip:{},xAxis:{type:"value",name:"Epochs",min:0},yAxis:{type:"value",name:"Norm"},series:[{data:[],type:"line"}]}),this.paramsNormsEcharts[i]&&this.paramsNormsEcharts[i].setOption(this.allParamsNorms[i])}changeLearningRate(){this.trainer.optimizer.lr=this.lr}changeWeightDecay(){this.trainer.optimizer.weight_decay=this.weight_decay}changeOptimizer(){this.pauseTraining(),this.trainer.changeOptimizer(this.optimizerType,this.lr,this.weight_decay),this.isTraining&&this.restartTraining()}pauseTraining(){this.trainer.stopTraining()}restartTraining(){this.trainer.train(this.batch_size),this.isTraining=!0}changeActivation(){this.currentActivation&&this.model&&(this.pauseTraining(),this.model.changeActivation(this.currentActivation),this.trainer.optimizer.reset_momentums(),this.isTraining&&this.trainer.train(this.batch_size),this.cdr.detectChanges())}addPoint(i){let r=this.isTraining;this.isTraining=!1,this.trainer.stopTraining();let n=this.heatmapCanvas.nativeElement.getBoundingClientRect(),o=2*(i.clientX-n.left)/n.width-1,a=2*(i.clientY-n.top)/n.height-1,s=i.shiftKey?1:0;this.dataset.data.push(new Iu(o,a,s)),this.n_points++,this.updateChart(!1),this.isTraining&&this.trainer.train(this.batch_size),this.isTraining=r,this.cdr.detectChanges()}removePoint(i,r){if(!i.ctrlKey)return;let n=this.isTraining;this.isTraining=!1,this.trainer.stopTraining(),r!=-1&&(this.dataset.data.splice(r,1),this.n_points--,this.updateChart(!1),this.isTraining&&this.trainer.train(this.batch_size),this.isTraining=n,this.cdr.detectChanges())}resetModel(){this.paramsNormsEcharts=[],this.buildModel(!0),this.resetEchartsNorms();let i=new dc(this.model,this.lr,1e-5,.1,!0);this.trainer=new k_(this.model,new P_,i),this.trainer.setDataset(this.dataset),this.updateChart()}evalMap(){this.pauseTraining();let i=[],r=new dn([this.gridResolution*this.gridResolution,2],!1);for(let s=0;s<this.gridResolution;s++)for(let c=0;c<this.gridResolution;c++){let l=s/this.gridResolution*2-1,d=c/this.gridResolution*2-1;i.push([l,d])}r.data=i.flat();let n=[],o=this.model.inference(r),a=o.shape[0];for(let s=0;s<a;s++){let c=o.data[s],l={x:i[s][0],y:i[s][1],label:c};n.push(l)}return this.isTraining&&this.restartTraining(),n}updateBatchSize(){this.batch_size&&this.isTraining&&(this.trainer.stopTraining(),setTimeout(()=>{this.restartTraining()},0))}resetDataset(){if(this.n_points===void 0||this.batch_size===void 0)return;this.batch_size=Math.min(this.n_points,this.batch_size);let i=new I_;this.datasetType=="circular"?i.createCircularPoints(this.n_points):this.datasetType=="linear"?i.createLinearlySeparable(this.n_points):this.datasetType=="spiral"&&i.createSpiralPoints(this.n_points),this.trainer&&(this.trainer.stopTraining(),this.trainer.setDataset(i),this.dataset=i,this.isTraining&&this.trainer.train(this.batch_size)),this.model&&this.updateChart(),this.cdr.detectChanges()}switchTraining(){this.isTraining?(this.isTraining=!1,this.trainer.stopTraining()):(this.isTraining=!0,this.trainer.train(this.batch_size))}colormap(i){isNaN(i)&&(i=0);let r=vE.length,n=Math.floor(i*r);n=Math.min(r-1,n),n=Math.max(0,n);let o=vE[n];return`rgb(${o[0]*255}, ${o[1]*255}, ${o[2]*255})`}getDatasetLength(){return this.dataset?this.dataset.data.length:0}updateChart(i=!0){i&&(this.heatmap=this.evalMap(),this.correctlyClassified=this.trainer.correctlyPredicted());for(let r=0;r<this.gridResolution;r++)for(let n=0;n<this.gridResolution;n++){let o=this.heatmap[n*this.gridResolution+r].label;this.ctx.fillStyle=this.colormap(o),this.ctx.fillRect(n,r,1,1)}this.lossOptions={xAxis:{type:"value",name:"Epochs",min:0,max:this.trainer.losses.length+10},yAxis:{type:"value",name:"Loss"},series:[{data:this.trainer.losses.map((r,n)=>[n,r]),type:"line"}]},this.cdr.detectChanges()}static \u0275fac=function(r){return new(r||e)(G(ei))};static \u0275cmp=Le({type:e,selectors:[["app-gradient-descent"]],viewQuery:function(r,n){if(r&1&&(ht(U2e,5),ht(H2e,5)),r&2){let o;Ve(o=ze())&&(n.heatmapCanvas=o.first),Ve(o=ze())&&(n.legendHeatmap=o.first)}},features:[Yt],decls:96,vars:40,consts:[["heatmapCanvas",""],["legendHeatmap",""],["paramsNorms",""],[3,"rightDrawer"],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],[1,"flex","flex-col","gap-2"],["mat-raised-button","","color","primary",1,"w-full",3,"click"],["multi",""],["expanded",""],[1,"flex","flex-col","gap-1"],[1,"w-full","justify-stretch",3,"ngModelChange","change","ngModel"],["value","circular",1,"flex-1"],["value","linear",1,"flex-1"],["value","spiral",1,"flex-1"],[3,"valueChange","min","max","step","title","value"],[3,"valueChange","min","max","title","value"],[3,"ngModelChange","change","ngModel"],["value","tanh"],["value","relu"],["value","sigmoid"],["value","identity"],[1,"mb-2",3,"ngModelChange","change","ngModel"],["value","sgd",1,"flex-1"],["value","adam",1,"flex-1"],["value","RMSPROP",1,"flex-1"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],[1,"flex","gap-2","items-center"],[1,"w-1/2","m-4"],[3,"hideToggle","disabled",4,"ngFor","ngForOf"],[1,"flex","flex-col","items-center","gap-4"],[1,"italic"],[1,"relative","canvasContainer","w-full"],[4,"ngFor","ngForOf"],[1,"w-full","aspect-square","absolute",3,"click","width","height"],[1,"font-semibold"],[1,"w-full","flex","flex-row","gap-1","items-center"],[1,"w-full","h-[32px]",3,"width","height"],[4,"ngIf"],["ngProjectAs","[drawerRight]",5,["","drawerRight",""]],["echarts","",1,"w-80","aspect-square",3,"options"],[3,"hideToggle","disabled"],["echarts","",3,"options","chartInit",4,"ngIf"],["echarts","",3,"chartInit","options"],[1,"absolute","datapoint",3,"click","ngStyle"]],template:function(r,n){if(r&1){let o=Ze();C(0,"app-tutorial-template",3),Ot(1,4),C(2,"div",5)(3,"button",6),Y("click",function(){return q(o),X(n.switchTraining())}),W(4),A(),C(5,"button",6),Y("click",function(){return q(o),X(n.resetModel())}),W(6," Reset model "),A(),C(7,"mat-accordion",7)(8,"mat-expansion-panel",8)(9,"mat-expansion-panel-header")(10,"mat-panel-title"),W(11," Data "),A()(),C(12,"div",9)(13,"span"),W(14,"Distribution"),A(),C(15,"mat-button-toggle-group",10),qt("ngModelChange",function(s){return q(o),jt(n.datasetType,s)||(n.datasetType=s),X(s)}),Y("change",function(){return q(o),X(n.resetDataset())}),C(16,"mat-button-toggle",11),W(17," Circular "),A(),C(18,"mat-button-toggle",12),W(19," Linear "),A(),C(20,"mat-button-toggle",13),W(21," Spiral "),A()(),C(22,"app-labelled-sliders",14),qt("valueChange",function(s){return q(o),jt(n.n_points,s)||(n.n_points=s),X(s)}),Y("valueChange",function(){return q(o),X(n.resetDataset())}),A(),C(23,"app-labelled-sliders",15),qt("valueChange",function(s){return q(o),jt(n.batch_size,s)||(n.batch_size=s),X(s)}),Y("valueChange",function(){return q(o),X(n.updateBatchSize())}),A()()(),C(24,"mat-expansion-panel",8)(25,"mat-expansion-panel-header")(26,"mat-panel-title"),W(27," Network "),A()(),C(28,"div",9)(29,"app-labelled-sliders",15),qt("valueChange",function(s){return q(o),jt(n.n_layers,s)||(n.n_layers=s),X(s)}),Y("valueChange",function(){return q(o),X(n.changeNumberLayer())}),A(),C(30,"app-labelled-sliders",15),qt("valueChange",function(s){return q(o),jt(n.n_neurons,s)||(n.n_neurons=s),X(s)}),Y("valueChange",function(){return q(o),X(n.changeNumberNeurons())}),A(),C(31,"div",9)(32,"span"),W(33,"Activation function"),A(),C(34,"mat-button-toggle-group",16),qt("ngModelChange",function(s){return q(o),jt(n.currentActivation,s)||(n.currentActivation=s),X(s)}),Y("change",function(){return q(o),X(n.changeActivation())}),C(35,"mat-button-toggle",17),W(36," TanH "),A(),C(37,"mat-button-toggle",18),W(38," RELU "),A(),C(39,"mat-button-toggle",19),W(40," Sigmoid "),A(),C(41,"mat-button-toggle",20),W(42," Identity "),A()()()()(),C(43,"mat-expansion-panel",8)(44,"mat-expansion-panel-header")(45,"mat-panel-title"),W(46," Training "),A()(),C(47,"div",9)(48,"app-labelled-sliders",14),qt("valueChange",function(s){return q(o),jt(n.lr,s)||(n.lr=s),X(s)}),Y("valueChange",function(){return q(o),X(n.changeLearningRate())}),A(),C(49,"app-labelled-sliders",14),qt("valueChange",function(s){return q(o),jt(n.weight_decay,s)||(n.weight_decay=s),X(s)}),Y("valueChange",function(){return q(o),X(n.changeWeightDecay())}),A(),C(50,"span"),W(51,"Optimizer"),A(),C(52,"mat-button-toggle-group",21),qt("ngModelChange",function(s){return q(o),jt(n.optimizerType,s)||(n.optimizerType=s),X(s)}),Y("change",function(){return q(o),X(n.changeOptimizer())}),C(53,"mat-button-toggle",22),W(54," SGD "),A(),C(55,"mat-button-toggle",23),W(56," Adam "),A(),C(57,"mat-button-toggle",24),W(58," RMSPROP "),A()(),C(59,"button",6),Y("click",function(){return q(o),X(n.trainer.optimizer.reset_momentums())}),W(60," Reset momentums "),A()()()()(),Rt(),Ot(61,25),C(62,"div",26)(63,"div",27)(64,"h2"),W(65,"Context"),A(),C(66,"p"),W(67," In this setup, each datapoint lies in a 2D space. The color of the datapoint represents the class it belongs to. The goal of the neural network is to learn the decision boundary that separates the two classes in the 2D space. "),A(),C(68,"p"),W(69," The neural network receives the 2D coordinates of the datapoint as input and outputs the probability of the datapoint belonging to the blue class. The datapoints are randomly generated following different distributions: circular, linear or spiral. "),A(),C(70,"p"),W(71," The neural network is trained using the gradient descent algorithm. The loss function is the binary cross entropy loss. The network is trained using the backpropagation algorithm. "),A(),C(72,"h2"),W(73,"Model"),A(),C(74,"p"),W(75," You can visualize the weight's norms of the network's layers evolving over time. "),A(),C(76,"mat-accordion"),Be(77,$2e,6,4,"mat-expansion-panel",28),A()(),C(78,"div",29)(79,"span",30),W(80," Left click: Add a red point, Shift+Left Click: Add a blue point, Ctrl+Click: remove a point."),A(),C(81,"div",31),Be(82,W2e,2,1,"ng-container",32),C(83,"canvas",33,0),Y("click",function(s){return q(o),X(n.addPoint(s))}),W(85," Your browser does not support the HTML5 canvas tag. "),A()(),C(86,"span",34),W(87,"Probability of belonging to the blue class"),A(),C(88,"div",35),W(89," p=0 "),he(90,"canvas",36,1),W(92," p=1.0 "),A(),Be(93,q2e,2,3,"span",37),A()(),Rt(),Ot(94,38),he(95,"div",39),Rt(),A()}r&2&&(z("rightDrawer",!0),O(4),Qr(" ",n.isTraining?"Pause training":"Start training"," "),O(11),Wt("ngModel",n.datasetType),O(7),z("min",2)("max",256)("step",1)("title","Number of points"),Wt("value",n.n_points),O(),z("min",1)("max",n.n_points)("title","Batch size"),Wt("value",n.batch_size),O(6),z("min",0)("max",6)("title","Number of hidden layers"),Wt("value",n.n_layers),O(),z("min",4)("max",64)("title","Number of neurons per layer"),Wt("value",n.n_neurons),O(4),Wt("ngModel",n.currentActivation),O(14),z("min",1e-4)("max",.5)("step",.001)("title","Learning rate"),Wt("value",n.lr),O(),z("min",0)("max",.1)("step",1e-5)("title","Weight decay"),Wt("value",n.weight_decay),O(3),Wt("ngModel",n.optimizerType),O(25),z("ngForOf",n.model.layers),O(5),z("ngForOf",n.dataset.data),O(),z("width",n.gridResolution)("height",n.gridResolution),O(7),z("width",n.gridResolution)("height","1px"),O(3),z("ngIf",n.dataset),O(2),z("options",n.lossOptions))},dependencies:[Jn,hs,za,Xn,Yn,Gb,so,Un,n7,nd,od,Tu,on,Mr,zo],styles:[".datapoint[_ngcontent-%COMP%]{border-radius:100%;width:.75em;z-index:250;aspect-ratio:1;transform:translate(-50%,-50%);border:rgb(192,192,192) solid 1px;box-shadow:#00000040 0 54px 55px,#0000001f 0 -12px 30px,#0000001f 0 4px 6px,#0000002b 0 12px 13px,#00000017 0 -3px 5px}.datapoint[_ngcontent-%COMP%]:hover{scale:1.5;transform-origin:top left;filter:brightness(1.5)}.canvasContainer[_ngcontent-%COMP%]{aspect-ratio:1;border-radius:1em;overflow:hidden;border:solid white 1px;box-shadow:#26394d 0 20px 30px -10px}"]})}return e})();var BP=class extends cc{pos=new dn([2]);out=new dn([1]);constructor(){super(),this.name="ToyLayer",this.pos.data=[0,0]}forward(){let t=this.pos.data[0],i=this.pos.data[1],r=this.equation(t,i);return this.out.data[0]=r,this.out}backward(){let t=this.pos.data[0],i=this.pos.data[1],r=this.derivative_x(t,i),n=this.derivative_y(t,i);return this.pos.grad[0]=r,this.pos.grad[1]=n,this.pos}parameters(){return[this.pos]}equation(t,i){return Math.sin(t*3)*Math.cos(i*3)}derivative_x(t,i){return 3*Math.cos(t*3)*Math.cos(i*3)}derivative_y(t,i){return-3*Math.sin(t*3)*Math.sin(i*3)}},_E=class extends pg{layer1=new BP;constructor(){super(),this.layers.push(this.layer1)}forward(){return this.layer1.forward()}backward(){return this.layer1.backward()}currentXY(){return this.layer1.pos.data}currentZ(){return this.forward().data[0]}currentXYZ(t=0){let i=this.currentXY(),r=this.currentZ();return r+=t,[i[0],i[1],r]}noisify_gradient(t=.1){this.layer1.pos.grad[0]+=Math.random()*t-t/2,this.layer1.pos.grad[1]+=Math.random()*t-t/2}equation(t,i){return this.layer1.equation(t,i)}parameters(){return this.layer1.parameters()}bound_check(t=-1,i=1){let r=this.layer1.pos.data[0],n=this.layer1.pos.data[1];this.layer1.pos.data[0]=Math.min(i,Math.max(t,r)),this.layer1.pos.data[1]=Math.min(i,Math.max(t,n))}};var E7=(()=>{class e extends mu{cdr;max_steps=100;simu_speed=50;max_history=25;step_size=.02;current_step=0;initial_xy=[.5,0];min=-1;max=1;noisyGradient=!1;isTraining=!1;trainer;lr=.01;wc=.1;echartInstance;echartLossPlotInstance;_isUpdating=!1;optimizerType="sgd";history=[];model=new _E;optim;option={grid:{},animation:!1,visualMap:{show:!1,dimension:2,seriesIndex:[0,2],min:this.min,max:this.max,inRange:{symbolSize:[.5,15],color:["#313695","#4575b4","#74add1","#abd9e9","#abd9e9","#abd9e9","#fee090","#fdae61","#f46d43","#d73027","#a50026"]}},xAxis3D:{type:"value",min:this.min,max:this.max},yAxis3D:{type:"value",min:this.min,max:this.max},zAxis3D:{type:"value",show:!1,min:-1,max:1},grid3D:{show:!0,postEffect:{enable:!1}}};lossPlot={xAxis:{type:"value"},yAxis:{type:"value"},series:[{type:"line",data:[]}]};data={series:[{type:"line3D",data:this.history,visualMap:!0,lineStyle:{width:2,border:"black"}},{type:"scatter3D",zlevel:10,data:[this.model.currentXYZ()],symbol:"circle",symbolSize:10,itemStyle:{color:"black",opacity:.5}},{type:"surface",wireframe:{show:!1},dataShape:[Math.round((this.max-this.min)/this.step_size),Math.round((this.max-this.min)/this.step_size)]}]};constructor(i){super(),this.cdr=i,this.model.layer1.pos.data=[...this.initial_xy],this.changeOptimizer()}ngOnInit(){}ngAfterViewInit(){}onChartInit(i){this.echartInstance=i;let r=this.min,n=this.max,o=this.step_size,a=[];for(let s=r;s<n;s+=o)for(let c=r;c<n;c+=o)a.push([s,c,this.model.equation(s,c)]);this.data.series[2].data=a,requestAnimationFrame(()=>{this.updateOption()})}onLossChartInit(i){this.echartLossPlotInstance=i}onChartClick(i){if(this.isTraining&&this.pauseTraining(),i.seriesType==="surface"){let r=i.value[0],n=i.value[1];this.initial_xy=[r,n],this.resetToInitialPoint()}this.isTraining&&this.startTraining()}changeLearningRate(i){this.isTraining&&this.pauseTraining(),this.lr=i,this.optim=new dc(this.model,this.lr,this.wc),this.isTraining&&this.startTraining()}changeOptimizer(){this.isTraining&&this.pauseTraining(),this.optimizerType==="sgd"?this.optim=new dc(this.model,this.lr,this.wc):this.optimizerType==="Adam"?this.optim=new fg(this.model,this.lr,this.wc):this.optim=new mg(this.model,this.lr,this.wc),this.optim.reset_momentums(),this.isTraining&&this.startTraining()}switchTraining(){this.isTraining=!this.isTraining,this.isTraining?this.startTraining():clearInterval(this.trainer)}pauseTraining(){clearInterval(this.trainer)}startTraining(){this.trainer=setInterval(()=>{this.runTraining()},this.simu_speed)}runTraining(){if(!this.isTraining){clearInterval(this.trainer);return}this.step()}step(){if(this.current_step>=this.max_steps){this.resetToInitialPoint();return}this.model.backward(),this.noisyGradient&&this.model.noisify_gradient(5),this.optim.step(),this.model.bound_check(this.min,this.max),this.history.push(this.model.currentXYZ(.05)),this.current_step+=1,this.updateOption()}resetToInitialPoint(){this.model.layer1.pos.data=[...this.initial_xy],this.optim.reset_momentums(),this.current_step=0,this.history=[],this.updateOption()}updateOption(){this.data.series[1].data=[this.model.currentXYZ(.05)];let i=[];for(let o=this.history.length-this.max_history;o<this.history.length;o++)i.push(this.history[o]);this.data.series[0].data=i;let r={series:[this.data.series[0],this.data.series[1]]},n=[];this.history.forEach((o,a)=>{n.push([a,o[2]])}),this.echartInstance.setOption(r,{notMerge:!1,lazyUpdate:!0,silent:!0}),this.echartLossPlotInstance.setOption({series:[{data:n}]})}static \u0275fac=function(r){return new(r||e)(G(ei))};static \u0275cmp=Le({type:e,selectors:[["app-optimizer"]],features:[Yt],decls:28,vars:12,consts:[[3,"rightDrawer"],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],[1,"flex","flex-col","gap-2"],["mat-raised-button","","color","primary",1,"w-full",3,"click"],[3,"valueChange","min","max","step","value","title"],[1,"mb-2",3,"ngModelChange","change","ngModel"],["value","sgd",1,"flex-1"],["value","adam",1,"flex-1"],["value","RMSPROP",1,"flex-1"],[3,"ngModelChange","ngModel"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],[1,"grid","grid-cols-2","w-full"],["echarts","",1,"graph",3,"chartClick","chartInit","options","merge"],["echarts","",1,"graph",3,"chartInit","options"]],template:function(r,n){r&1&&(C(0,"app-tutorial-template",0),Ot(1,1),C(2,"div",2)(3,"button",3),Y("click",function(){return n.switchTraining()}),W(4),A(),C(5,"button",3),Y("click",function(){return n.resetToInitialPoint()}),W(6," Reset "),A(),he(7,"mat-divider"),C(8,"app-labelled-sliders",4),Y("valueChange",function(a){return n.changeLearningRate(a)}),A(),he(9,"mat-divider"),C(10,"span"),W(11,"Optimizer"),A(),C(12,"mat-button-toggle-group",5),qt("ngModelChange",function(a){return jt(n.optimizerType,a)||(n.optimizerType=a),a}),Y("change",function(){return n.changeOptimizer()}),C(13,"mat-button-toggle",6),W(14," SGD "),A(),C(15,"mat-button-toggle",7),W(16," Adam "),A(),C(17,"mat-button-toggle",8),W(18," RMSPROP "),A()(),C(19,"button",3),Y("click",function(){return n.optim.reset_momentums()}),W(20," Reset momentums "),A(),he(21,"mat-divider"),C(22,"mat-checkbox",9),qt("ngModelChange",function(a){return jt(n.noisyGradient,a)||(n.noisyGradient=a),a}),W(23," Noisy gradient "),A()(),Rt(),Ot(24,10),C(25,"div",11)(26,"div",12),Y("chartClick",function(a){return n.onChartClick(a)})("chartInit",function(a){return n.onChartInit(a)}),A(),C(27,"div",13),Y("chartInit",function(a){return n.onLossChartInit(a)}),A()(),Rt(),A()),r&2&&(z("rightDrawer",!0),O(4),Qr(" ",n.isTraining?"Pause training":"Start training"," "),O(4),z("min",0)("max",.3)("step",.001)("value",n.lr)("title","Learning rate"),O(4),Wt("ngModel",n.optimizerType),O(10),Wt("ngModel",n.noisyGradient),O(4),z("options",n.option)("merge",n.data),O(),z("options",n.lossPlot))},dependencies:[Jn,Au,hs,za,so,Un,fE,on,Mr,zo],styles:[".graph[_ngcontent-%COMP%]{min-width:256px;border-color:#000;margin:5%;background:linear-gradient(#ffffff1a,#ffffff80);border-radius:2em}"]})}return e})();var C7=(()=>{class e extends mu{echartInstance;distribution=null;option={xAxis:{type:"value",min:-1,max:1},yAxis:{type:"value",min:-1,max:1},series:[{}]};covariance=1;constructor(){super()}ngOnInit(){}onChartInit(i){this.echartInstance=i,this.generateData()}generateData(){console.log(this.covariance);let i=Ap(1e3,{x:0,y:0},[[1,this.covariance],[this.covariance,1]]),r=G$(i.map(s=>[s.x,s.y])),n=0,o=0;i.forEach(s=>{n=Math.min(n,s.x,s.y),o=Math.max(o,s.x,s.y)});let a=Math.max(Math.abs(n),Math.abs(o));this.option.xAxis={type:"value",min:-a,max:a},this.option.yAxis={type:"value",min:-a,max:a},this.option.series=[{type:"scatter",data:i.map(s=>[s.x,s.y]),symbolSize:5},{type:"line",data:[[0,0],[r.U[0][0],r.U[0][1]]]},{type:"line",data:[[0,0],[r.U[1][0],r.U[1][1]]]}],this.echartInstance.setOption(this.option)}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Le({type:e,selectors:[["app-principal-component-analysis"]],features:[Yt],decls:6,vars:6,consts:[[3,"rightDrawer"],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],[3,"valueChange","value","min","max","step"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],[1,"grid","grid-cols-2"],["echarts","",1,"aspect-square","max-w-[512px]","w-full",3,"chartInit","options"]],template:function(r,n){r&1&&(C(0,"app-tutorial-template",0),Ot(1,1),C(2,"app-labelled-sliders",2),qt("valueChange",function(a){return jt(n.covariance,a)||(n.covariance=a),a}),Y("valueChange",function(){return n.generateData()}),A(),Rt(),Ot(3,3),C(4,"div",4)(5,"div",5),Y("chartInit",function(a){return n.onChartInit(a)}),A()(),Rt(),A()),r&2&&(z("rightDrawer",!1),O(2),Wt("value",n.covariance),z("min",-5)("max",5)("step",.1),O(3),z("options",n.option))},dependencies:[Jn,Mr,zo]})}return e})();var S7=(()=>{class e{graphData;charts;T=2;degree=5;polyCoefs=Array(this.degree+1).fill(0);xs=D_(0,this.T*2*Math.PI,1e3);equation;noise=.5;xi=PP(this.xs,50);yi=this.xi.map(i=>this.noisyTrueFunction(i));constructor(){this.graphData={xAxis:{type:"value",min:0,max:this.T*2*Math.PI},yAxis:{type:"value",min:-2,max:2},legend:{show:!0,orient:"vertical",backgroundColor:"#ccc"},series:[{name:"Polynomial regression",type:"line",showSymbol:!1,data:this.xs.map(i=>[i,this.evaluatePolynomial(i,this.polyCoefs)])},{name:"True Function",type:"line",showSymbol:!1,data:this.xs.map(i=>[i,this.trueFunction(i)]),lineStyle:{opacity:.5,type:"dashed"}},{name:"Data",type:"scatter",data:this.xi.map((i,r)=>[i,this.yi[r]]),animation:!1}]}}ngOnInit(){}chartInit(i){this.charts=i,this.updatePolynomial()}trueFunction(i){return Math.sin(i)}noisyTrueFunction(i){return this.trueFunction(i)+this.noise*(Math.random()-.5)}evaluatePolynomial(i,r){let n=0;for(let o=0;o<r.length;o++)n+=r[o]*Math.pow(i,o);return n}updatePolynomial(){this.polyCoefs=$$(this.xi,this.yi,this.degree),Array.isArray(this.graphData.series)&&(this.graphData.series[0].data=this.xs.map(r=>[r,this.evaluatePolynomial(r,this.polyCoefs)])),this.charts.setOption(this.graphData);let i=this.polyCoefs.map((r,n)=>{let o=Math.abs(r).toFixed(1);return r===0?"":n===0?`${r>0?"":"-"}${o}`:n===1?`${r>0?"+":"-"} ${o}x`:`${r>0?"+":"-"} ${o}x^${n}`}).join(" ");this.equation=`y = ${i}`}resamplePoints(){this.xi=PP(this.xs,25),this.yi=this.xi.map(i=>this.noisyTrueFunction(i)),Array.isArray(this.graphData.series)&&(this.graphData.series[2].data=this.xi.map((i,r)=>[i,this.yi[r]])),this.updatePolynomial()}rmse(){let i=this.xs.map(o=>this.evaluatePolynomial(o,this.polyCoefs)),r=this.xs.map(o=>this.trueFunction(o)),n=0;for(let o=0;o<i.length;o++)n+=Math.pow(i[o]-r[o],2);return Math.sqrt(n/i.length)}training_rmse(){let i=this.xi.map(n=>this.evaluatePolynomial(n,this.polyCoefs)),r=0;for(let n=0;n<i.length;n++)r+=Math.pow(i[n]-this.yi[n],2);return Math.sqrt(r/i.length)}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Le({type:e,selectors:[["app-regression"]],decls:13,vars:13,consts:[["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],[1,"flex","flex-col","m-2"],[3,"valueChange","title","value","max","min","step"],["mat-raised-button","","color","primary",3,"click"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["echarts","",1,"w-full",3,"chartInit","options"]],template:function(r,n){r&1&&(C(0,"app-tutorial-template"),Ot(1,0),C(2,"div",1)(3,"app-labelled-sliders",2),qt("valueChange",function(a){return jt(n.degree,a)||(n.degree=a),a}),Y("valueChange",function(){return n.updatePolynomial()}),A(),C(4,"app-labelled-sliders",2),qt("valueChange",function(a){return jt(n.noise,a)||(n.noise=a),a}),Y("valueChange",function(){return n.resamplePoints()}),A(),C(5,"button",3),Y("click",function(){return n.resamplePoints()}),W(6,"Resample"),A()(),Rt(),Ot(7,4),C(8,"div",5),Y("chartInit",function(a){return n.chartInit(a)}),A(),C(9,"div"),W(10),A(),C(11,"div"),W(12),A(),Rt(),A()),r&2&&(O(3),z("title","Polynomial degree"),Wt("value",n.degree),z("max",40)("min",0)("step",1),O(),z("title","Noise level"),Wt("value",n.noise),z("max",5)("min",0)("step",.01),O(4),z("options",n.graphData),O(2),Qr(" Training RMSE: ",n.training_rmse().toFixed(3)," "),O(2),Qr(" RMSE: ",n.rmse().toFixed(3),""))},dependencies:[Jn,on,Mr,zo]})}return e})();var X2e=Object.create,FE=Object.defineProperty,Y2e=Object.getOwnPropertyDescriptor,Z2e=Object.getOwnPropertyNames,K2e=Object.getPrototypeOf,Q2e=Object.prototype.hasOwnProperty,J2e=(e=>typeof ju<"u"?ju:typeof Proxy<"u"?new Proxy(e,{get:(t,i)=>(typeof ju<"u"?ju:t)[i]}):e)(function(e){if(typeof ju<"u")return ju.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),Ce=(e,t)=>()=>(e&&(t=e(e=0)),t),Fn=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ob=(e,t)=>{for(var i in t)FE(e,i,{get:t[i],enumerable:!0})},aX=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Z2e(t))!Q2e.call(e,n)&&n!==i&&FE(e,n,{get:()=>t[n],enumerable:!(r=Y2e(t,n))||r.enumerable});return e},bg=(e,t,i)=>(i=e!=null?X2e(K2e(e)):{},aX(t||!e||!e.__esModule?FE(i,"default",{value:e,enumerable:!0}):i,e)),IE=e=>aX(FE({},"__esModule",{value:!0}),e),N_,Mu,tb,T7,dO,uO=Ce(()=>{"use strict";N_=new Map,Mu=[],tb=(e,t,i)=>{if(t&&typeof t.init=="function"&&typeof t.createInferenceSessionHandler=="function"){let r=N_.get(e);if(r===void 0)N_.set(e,{backend:t,priority:i});else{if(r.priority>i)return;if(r.priority===i&&r.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${i}`)}if(i>=0){let n=Mu.indexOf(e);n!==-1&&Mu.splice(n,1);for(let o=0;o<Mu.length;o++)if(N_.get(Mu[o]).priority<=i){Mu.splice(o,0,e);return}Mu.push(e)}return}throw new TypeError("not a valid backend")},T7=e=>Qe(void 0,null,function*(){let t=N_.get(e);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{let i=!!t.initPromise;try{return i||(t.initPromise=t.backend.init(e)),yield t.initPromise,t.initialized=!0,t.backend}catch(r){return i||(t.error=`${r}`,t.aborted=!0),t.error}finally{delete t.initPromise}}}),dO=e=>Qe(void 0,null,function*(){let t=e.executionProviders||[],i=t.map(c=>typeof c=="string"?c:c.name),r=i.length===0?Mu:i,n,o=[],a=new Set;for(let c of r){let l=yield T7(c);typeof l=="string"?o.push({name:c,err:l}):(n||(n=l),n===l&&a.add(c))}if(!n)throw new Error(`no available backend found. ERR: ${o.map(c=>`[${c.name}] ${c.err}`).join(", ")}`);for(let{name:c,err:l}of o)i.includes(c)&&console.warn(`removing requested execution provider "${c}" from session options because it is not available: ${l}`);let s=t.filter(c=>a.has(typeof c=="string"?c:c.name));return[n,new Proxy(e,{get:(c,l)=>l==="executionProviders"?s:Reflect.get(c,l)})]})}),eEe=Ce(()=>{"use strict";uO()}),sX,tEe=Ce(()=>{"use strict";sX="1.19.2"}),VP,il,lX=Ce(()=>{"use strict";tEe(),VP="warning",il={wasm:{},webgl:{},webgpu:{},versions:{common:sX},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);VP=e}},get logLevel(){return VP}},Object.defineProperty(il,"logLevel",{enumerable:!0})}),Ii,iEe=Ce(()=>{"use strict";lX(),Ii=il}),cX,dX,rEe=Ce(()=>{"use strict";cX=(e,t)=>{let i=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);i.width=e.dims[3],i.height=e.dims[2];let r=i.getContext("2d");if(r!=null){let n,o;t?.tensorLayout!==void 0&&t.tensorLayout==="NHWC"?(n=e.dims[2],o=e.dims[3]):(n=e.dims[3],o=e.dims[2]);let a=t?.format!==void 0?t.format:"RGB",s=t?.norm,c,l;s===void 0||s.mean===void 0?c=[255,255,255,255]:typeof s.mean=="number"?c=[s.mean,s.mean,s.mean,s.mean]:(c=[s.mean[0],s.mean[1],s.mean[2],0],s.mean[3]!==void 0&&(c[3]=s.mean[3])),s===void 0||s.bias===void 0?l=[0,0,0,0]:typeof s.bias=="number"?l=[s.bias,s.bias,s.bias,s.bias]:(l=[s.bias[0],s.bias[1],s.bias[2],0],s.bias[3]!==void 0&&(l[3]=s.bias[3]));let d=o*n,u=0,h=d,p=d*2,m=-1;a==="RGBA"?(u=0,h=d,p=d*2,m=d*3):a==="RGB"?(u=0,h=d,p=d*2):a==="RBG"&&(u=0,p=d,h=d*2);for(let f=0;f<o;f++)for(let g=0;g<n;g++){let v=(e.data[u++]-l[0])*c[0],_=(e.data[h++]-l[1])*c[1],b=(e.data[p++]-l[2])*c[2],y=m===-1?255:(e.data[m++]-l[3])*c[3];r.fillStyle="rgba("+v+","+_+","+b+","+y+")",r.fillRect(g,f,1,1)}if("toDataURL"in i)return i.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},dX=(e,t)=>{let i=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),r;if(i!=null){let n,o,a;t?.tensorLayout!==void 0&&t.tensorLayout==="NHWC"?(n=e.dims[2],o=e.dims[1],a=e.dims[3]):(n=e.dims[3],o=e.dims[2],a=e.dims[1]);let s=t!==void 0&&t.format!==void 0?t.format:"RGB",c=t?.norm,l,d;c===void 0||c.mean===void 0?l=[255,255,255,255]:typeof c.mean=="number"?l=[c.mean,c.mean,c.mean,c.mean]:(l=[c.mean[0],c.mean[1],c.mean[2],255],c.mean[3]!==void 0&&(l[3]=c.mean[3])),c===void 0||c.bias===void 0?d=[0,0,0,0]:typeof c.bias=="number"?d=[c.bias,c.bias,c.bias,c.bias]:(d=[c.bias[0],c.bias[1],c.bias[2],0],c.bias[3]!==void 0&&(d[3]=c.bias[3]));let u=o*n;if(t!==void 0&&(t.format!==void 0&&a===4&&t.format!=="RGBA"||a===3&&t.format!=="RGB"&&t.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let h=4,p=0,m=1,f=2,g=3,v=0,_=u,b=u*2,y=-1;s==="RGBA"?(v=0,_=u,b=u*2,y=u*3):s==="RGB"?(v=0,_=u,b=u*2):s==="RBG"&&(v=0,b=u,_=u*2),r=i.createImageData(n,o);for(let x=0;x<o*n;p+=h,m+=h,f+=h,g+=h,x++)r.data[p]=(e.data[v++]-d[0])*l[0],r.data[m]=(e.data[_++]-d[1])*l[1],r.data[f]=(e.data[b++]-d[2])*l[2],r.data[g]=y===-1?255:(e.data[y++]-d[3])*l[3]}else throw new Error("Can not access image data");return r}}),bE,uX,hX,pX,fX,nEe=Ce(()=>{"use strict";hO(),bE=(e,t)=>{if(e===void 0)throw new Error("Image buffer must be defined");if(t.height===void 0||t.width===void 0)throw new Error("Image height and width must be defined");if(t.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:i,width:r}=t,n=t.norm??{mean:255,bias:0},o,a;typeof n.mean=="number"?o=[n.mean,n.mean,n.mean,n.mean]:o=[n.mean[0],n.mean[1],n.mean[2],n.mean[3]??255],typeof n.bias=="number"?a=[n.bias,n.bias,n.bias,n.bias]:a=[n.bias[0],n.bias[1],n.bias[2],n.bias[3]??0];let s=t.format!==void 0?t.format:"RGBA",c=t.tensorFormat!==void 0&&t.tensorFormat!==void 0?t.tensorFormat:"RGB",l=i*r,d=c==="RGBA"?new Float32Array(l*4):new Float32Array(l*3),u=4,h=0,p=1,m=2,f=3,g=0,v=l,_=l*2,b=-1;s==="RGB"&&(u=3,h=0,p=1,m=2,f=-1),c==="RGBA"?b=l*3:c==="RBG"?(g=0,_=l,v=l*2):c==="BGR"&&(_=0,v=l,g=l*2);for(let y=0;y<l;y++,h+=u,m+=u,p+=u,f+=u)d[g++]=(e[h]+a[0])/o[0],d[v++]=(e[p]+a[1])/o[1],d[_++]=(e[m]+a[2])/o[2],b!==-1&&f!==-1&&(d[b++]=(e[f]+a[3])/o[3]);return c==="RGBA"?new Tl("float32",d,[1,4,i,r]):new Tl("float32",d,[1,3,i,r])},uX=(e,t)=>Qe(void 0,null,function*(){let i=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,r=typeof ImageData<"u"&&e instanceof ImageData,n=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,o=typeof e=="string",a,s=t??{},c=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},l=d=>d instanceof HTMLCanvasElement||d instanceof OffscreenCanvas?d.getContext("2d"):null;if(i){let d=c();d.width=e.width,d.height=e.height;let u=l(d);if(u!=null){let h=e.height,p=e.width;if(t!==void 0&&t.resizedHeight!==void 0&&t.resizedWidth!==void 0&&(h=t.resizedHeight,p=t.resizedWidth),t!==void 0){if(s=t,t.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");s.tensorFormat="RGBA",s.height=h,s.width=p}else s.tensorFormat="RGBA",s.height=h,s.width=p;u.drawImage(e,0,0),a=u.getImageData(0,0,p,h).data}else throw new Error("Can not access image data")}else if(r){let d,u;if(t!==void 0&&t.resizedWidth!==void 0&&t.resizedHeight!==void 0?(d=t.resizedHeight,u=t.resizedWidth):(d=e.height,u=e.width),t!==void 0&&(s=t),s.format="RGBA",s.height=d,s.width=u,t!==void 0){let h=c();h.width=u,h.height=d;let p=l(h);if(p!=null)p.putImageData(e,0,0),a=p.getImageData(0,0,u,d).data;else throw new Error("Can not access image data")}else a=e.data}else if(n){if(t===void 0)throw new Error("Please provide image config with format for Imagebitmap");let d=c();d.width=e.width,d.height=e.height;let u=l(d);if(u!=null){let h=e.height,p=e.width;return u.drawImage(e,0,0,p,h),a=u.getImageData(0,0,p,h).data,s.height=h,s.width=p,bE(a,s)}else throw new Error("Can not access image data")}else{if(o)return new Promise((d,u)=>{let h=c(),p=l(h);if(!e||!p)return u();let m=new Image;m.crossOrigin="Anonymous",m.src=e,m.onload=()=>{h.width=m.width,h.height=m.height,p.drawImage(m,0,0,h.width,h.height);let f=p.getImageData(0,0,h.width,h.height);s.height=h.height,s.width=h.width,d(bE(f.data,s))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(a!==void 0)return bE(a,s);throw new Error("Input data provided is not supported - aborted tensor creation")}),hX=(e,t)=>{let{width:i,height:r,download:n,dispose:o}=t,a=[1,r,i,4];return new Tl({location:"texture",type:"float32",texture:e,dims:a,download:n,dispose:o})},pX=(e,t)=>{let{dataType:i,dims:r,download:n,dispose:o}=t;return new Tl({location:"gpu-buffer",type:i??"float32",gpuBuffer:e,dims:r,download:n,dispose:o})},fX=(e,t,i)=>new Tl({location:"cpu-pinned",type:e,data:t,dims:i??[t.length]})}),Op,G_,zP,mX,oEe=Ce(()=>{"use strict";Op=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),G_=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),zP=!1,mX=()=>{if(!zP){zP=!0;let e=typeof BigInt64Array<"u"&&BigInt64Array.from,t=typeof BigUint64Array<"u"&&BigUint64Array.from,i=typeof Float16Array<"u"&&Float16Array.from;e&&(Op.set("int64",BigInt64Array),G_.set(BigInt64Array,"int64")),t&&(Op.set("uint64",BigUint64Array),G_.set(BigUint64Array,"uint64")),i?(Op.set("float16",Float16Array),G_.set(Float16Array,"float16")):Op.set("float16",Uint16Array)}}}),gX,vX,aEe=Ce(()=>{"use strict";hO(),gX=e=>{let t=1;for(let i=0;i<e.length;i++){let r=e[i];if(typeof r!="number"||!Number.isSafeInteger(r))throw new TypeError(`dims[${i}] must be an integer, got: ${r}`);if(r<0)throw new RangeError(`dims[${i}] must be a non-negative integer, got: ${r}`);t*=r}return t},vX=(e,t)=>{switch(e.location){case"cpu":return new Tl(e.type,e.data,t);case"cpu-pinned":return new Tl({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new Tl({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new Tl({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}}}),Tl,hO=Ce(()=>{"use strict";rEe(),nEe(),oEe(),aEe(),Tl=class{constructor(e,t,i){mX();let r,n;if(typeof e=="object"&&"location"in e)switch(this.dataLocation=e.location,r=e.type,n=e.dims,e.location){case"cpu-pinned":{let a=Op.get(r);if(!a)throw new TypeError(`unsupported type "${r}" to create tensor from pinned buffer`);if(!(e.data instanceof a))throw new TypeError(`buffer should be of type ${a.name}`);this.cpuData=e.data;break}case"texture":{if(r!=="float32")throw new TypeError(`unsupported type "${r}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break}case"gpu-buffer":{if(r!=="float32"&&r!=="float16"&&r!=="int32"&&r!=="int64"&&r!=="uint32"&&r!=="uint8"&&r!=="bool")throw new TypeError(`unsupported type "${r}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let a,s;if(typeof e=="string")if(r=e,s=i,e==="string"){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");a=t}else{let c=Op.get(e);if(c===void 0)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if(e==="float16"&&c===Uint16Array)throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");e==="uint64"||e==="int64"?a=c.from(t,BigInt):a=c.from(t)}else if(t instanceof c)a=t;else throw new TypeError(`A ${r} tensor's data must be type of ${c}`)}else if(s=t,Array.isArray(e)){if(e.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let c=typeof e[0];if(c==="string")r="string",a=e;else if(c==="boolean")r="bool",a=Uint8Array.from(e);else throw new TypeError(`Invalid element type of data array: ${c}.`)}else{let c=G_.get(e.constructor);if(c===void 0)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);r=c,a=e}if(s===void 0)s=[a.length];else if(!Array.isArray(s))throw new TypeError("A tensor's dims must be a number array");n=s,this.cpuData=a,this.dataLocation="cpu"}let o=gX(n);if(this.cpuData&&o!==this.cpuData.length)throw new Error(`Tensor's size(${o}) does not match data length(${this.cpuData.length}).`);this.type=r,this.dims=n,this.size=o}static fromImage(e,t){return Qe(this,null,function*(){return uX(e,t)})}static fromTexture(e,t){return hX(e,t)}static fromGpuBuffer(e,t){return pX(e,t)}static fromPinnedBuffer(e,t,i){return fX(e,t,i)}toDataURL(e){return cX(this,e)}toImageData(e){return dX(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}getData(e){return Qe(this,null,function*(){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let t=yield this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}})}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return vX(this,e)}}}),bo,pO=Ce(()=>{"use strict";hO(),bo=Tl}),DN,UP,yg,xg,_X=Ce(()=>{"use strict";lX(),DN=(e,t)=>{(typeof il.trace>"u"?!il.wasm.trace:!il.trace)||console.timeStamp(`${e}::ORT::${t}`)},UP=(e,t)=>{let i=new Error().stack?.split(/\r\n|\r|\n/g)||[],r=!1;for(let n=0;n<i.length;n++){if(r&&!i[n].includes("TRACE_FUNC")){let o=`FUNC_${e}::${i[n].trim().split(" ")[1]}`;t&&(o+=`::${t}`),DN("CPU",o);return}i[n].includes("TRACE_FUNC")&&(r=!0)}},yg=e=>{(typeof il.trace>"u"?!il.wasm.trace:!il.trace)||UP("BEGIN",e)},xg=e=>{(typeof il.trace>"u"?!il.wasm.trace:!il.trace)||UP("END",e)}}),bX,sEe=Ce(()=>{"use strict";uO(),pO(),_X(),bX=class yX{constructor(t){this.handler=t}run(t,i,r){return Qe(this,null,function*(){yg();let n={},o={};if(typeof t!="object"||t===null||t instanceof bo||Array.isArray(t))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let a=!0;if(typeof i=="object"){if(i===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(i instanceof bo)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(i)){if(i.length===0)throw new TypeError("'fetches' cannot be an empty array.");a=!1;for(let l of i){if(typeof l!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(l)===-1)throw new RangeError(`'fetches' contains invalid output name: ${l}.`);n[l]=null}if(typeof r=="object"&&r!==null)o=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{let l=!1,d=Object.getOwnPropertyNames(i);for(let u of this.outputNames)if(d.indexOf(u)!==-1){let h=i[u];(h===null||h instanceof bo)&&(l=!0,a=!1,n[u]=h)}if(l){if(typeof r=="object"&&r!==null)o=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else o=i}}else if(typeof i<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let l of this.inputNames)if(typeof t[l]>"u")throw new Error(`input '${l}' is missing in 'feeds'.`);if(a)for(let l of this.outputNames)n[l]=null;let s=yield this.handler.run(t,n,o),c={};for(let l in s)if(Object.hasOwnProperty.call(s,l)){let d=s[l];d instanceof bo?c[l]=d:c[l]=new bo(d.type,d.data,d.dims)}return xg(),c})}release(){return Qe(this,null,function*(){return this.handler.dispose()})}static create(t,i,r,n){return Qe(this,null,function*(){yg();let o,a={};if(typeof t=="string"){if(o=t,typeof i=="object"&&i!==null)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(o=t,typeof i=="object"&&i!==null)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer){let d=t,u=0,h=t.byteLength;if(typeof i=="object"&&i!==null)a=i;else if(typeof i=="number"){if(u=i,!Number.isSafeInteger(u))throw new RangeError("'byteOffset' must be an integer.");if(u<0||u>=d.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${d.byteLength}).`);if(h=t.byteLength-u,typeof r=="number"){if(h=r,!Number.isSafeInteger(h))throw new RangeError("'byteLength' must be an integer.");if(h<=0||u+h>d.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${d.byteLength-u}].`);if(typeof n=="object"&&n!==null)a=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(typeof r<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof i<"u")throw new TypeError("'options' must be an object.");o=new Uint8Array(d,u,h)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[s,c]=yield dO(a),l=yield s.createInferenceSessionHandler(o,c);return xg(),new yX(l)})}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}}),LE,lEe=Ce(()=>{"use strict";sEe(),LE=bX}),cEe=Ce(()=>{"use strict"}),dEe=Ce(()=>{"use strict"}),uEe=Ce(()=>{"use strict"}),hEe=Ce(()=>{"use strict"}),A7,xX,pEe=Ce(()=>{"use strict";uO(),pO(),A7="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",xX=class wX{constructor(t,i,r){this.handler=t,this.hasOptimizerModel=i,this.hasEvalModel=r}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static create(t,i){return Qe(this,null,function*(){let r=t.evalModel||"",n=t.optimizerModel||"",o=i||{},[a,s]=yield dO(o);if(a.createTrainingSessionHandler){let c=yield a.createTrainingSessionHandler(t.checkpointState,t.trainModel,r,n,s);return new wX(c,!!t.optimizerModel,!!t.evalModel)}else throw new Error(A7)})}typeNarrowingForRunStep(t,i,r,n,o){let a={},s={};if(typeof r!="object"||r===null||r instanceof bo||Array.isArray(r))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let c=!0;if(typeof n=="object"){if(n===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof bo)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(n.length===0)throw new TypeError("'fetches' cannot be an empty array.");c=!1;for(let l of n){if(typeof l!="string")throw new TypeError("'fetches' must be a string array or an object.");if(i.indexOf(l)===-1)throw new RangeError(`'fetches' contains invalid output name: ${l}.`);a[l]=null}if(typeof o=="object"&&o!==null)s=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else{let l=!1,d=Object.getOwnPropertyNames(n);for(let u of i)if(d.indexOf(u)!==-1){let h=n[u];(h===null||h instanceof bo)&&(l=!0,c=!1,a[u]=h)}if(l){if(typeof o=="object"&&o!==null)s=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else s=n}}else if(typeof n<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let l of t)if(typeof r[l]>"u")throw new Error(`input '${l}' is missing in 'feeds'.`);if(c)for(let l of i)a[l]=null;return[a,s]}convertHandlerReturnTypeToMapOfTensors(t){let i={};for(let r in t)if(Object.hasOwnProperty.call(t,r)){let n=t[r];n instanceof bo?i[r]=n:i[r]=new bo(n.type,n.data,n.dims)}return i}lazyResetGrad(){return Qe(this,null,function*(){yield this.handler.lazyResetGrad()})}runTrainStep(t,i,r){return Qe(this,null,function*(){let[n,o]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,t,i,r),a=yield this.handler.runTrainStep(t,n,o);return this.convertHandlerReturnTypeToMapOfTensors(a)})}runOptimizerStep(t){return Qe(this,null,function*(){if(this.hasOptimizerModel)yield this.handler.runOptimizerStep(t||{});else throw new Error("This TrainingSession has no OptimizerModel loaded.")})}runEvalStep(t,i,r){return Qe(this,null,function*(){if(this.hasEvalModel){let[n,o]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,t,i,r),a=yield this.handler.runEvalStep(t,n,o);return this.convertHandlerReturnTypeToMapOfTensors(a)}else throw new Error("This TrainingSession has no EvalModel loaded.")})}getParametersSize(t=!0){return Qe(this,null,function*(){return this.handler.getParametersSize(t)})}loadParametersBuffer(t,i=!0){return Qe(this,null,function*(){let r=yield this.getParametersSize(i);if(t.length!==4*r)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(t,i)})}getContiguousParameters(t=!0){return Qe(this,null,function*(){return this.handler.getContiguousParameters(t)})}release(){return Qe(this,null,function*(){return this.handler.dispose()})}}}),EX,fEe=Ce(()=>{"use strict";pEe(),EX=xX}),CX={};ob(CX,{InferenceSession:()=>LE,TRACE:()=>DN,TRACE_FUNC_BEGIN:()=>yg,TRACE_FUNC_END:()=>xg,Tensor:()=>bo,TrainingSession:()=>EX,env:()=>Ii,registerBackend:()=>tb});var fc=Ce(()=>{"use strict";eEe(),iEe(),lEe(),pO(),cEe(),dEe(),_X(),uEe(),hEe(),fEe()});function Rp(e,t,i,r){if(t===void 0)return mEe(e);if(i===void 0)yE(e,t,1);else if(typeof i=="number"&&r===void 0)yE(e,t,i);else if(typeof i=="string"&&r===void 0)yE(e,i,1,t);else if(typeof i=="string"&&typeof r=="number")yE(e,i,r,t);else throw new TypeError("input is valid")}function mEe(e){return{verbose:Rp.verbose.bind(null,e),info:Rp.info.bind(null,e),warning:Rp.warning.bind(null,e),error:Rp.error.bind(null,e),fatal:Rp.fatal.bind(null,e)}}function yE(e,t,i,r){let n=_g[r||""]||_g[""];IN[e]<IN[n.minimalSeverity]||(n.logDateTime&&(t=`${new Date().toISOString()}|${t}`),n.logSourceLocation,SX[n.provider].log(e,t,r))}var D7,I7,IN,SX,HP,_g,yn,jP,GP,TX,O_,Al=Ce(()=>{"use strict";D7=class{log(e,t,i){}},I7=class{log(e,t,i){console.log(`${this.color(e)} ${i?"\x1B[35m"+i+"\x1B[0m ":""}${t}`)}color(e){switch(e){case"verbose":return"\x1B[34;40mv\x1B[0m";case"info":return"\x1B[32mi\x1B[0m";case"warning":return"\x1B[30;43mw\x1B[0m";case"error":return"\x1B[31;40me\x1B[0m";case"fatal":return"\x1B[101mf\x1B[0m";default:throw new Error(`unsupported severity: ${e}`)}}},IN={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},SX={none:new D7,console:new I7},HP={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1},_g={"":HP},(e=>{function t(l,d){e("verbose",l,d)}e.verbose=t;function i(l,d){e("info",l,d)}e.info=i;function r(l,d){e("warning",l,d)}e.warning=r;function n(l,d){e("error",l,d)}e.error=n;function o(l,d){e("fatal",l,d)}e.fatal=o;function a(l){_g={},s("",l||{})}e.reset=a;function s(l,d){if(l==="*")a(d);else{let u=_g[l]||HP;_g[l]={provider:d.provider||u.provider,minimalSeverity:d.minimalSeverity||u.minimalSeverity,logDateTime:d.logDateTime===void 0?u.logDateTime:d.logDateTime,logSourceLocation:d.logSourceLocation===void 0?u.logSourceLocation:d.logSourceLocation}}}e.set=s;function c(l){let d={};l.logLevel&&(d.minimalSeverity=l.logLevel),s("",d)}e.setWithEnv=c})(Rp||={}),yn=Rp,jP=class{constructor(e,t,i,r,n,o){this.category=e,this.name=t,this.startTime=i,this.endCallback=r,this.timer=n,this.ctx=o}end(){return Qe(this,null,function*(){return this.endCallback(this)})}checkTimer(){return Qe(this,null,function*(){if(this.ctx===void 0||this.timer===void 0)throw new Error("No webgl timer found");return this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)})}},GP=class{constructor(e,t,i,r){this.category=e,this.name=t,this.startTime=i,this.endTime=r}},TX=class{constructor(e,t,i){this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=e===void 0?1e4:e,this._flushBatchSize=t===void 0?10:t,this._flushIntervalInMilliseconds=i===void 0?5e3:i}static create(e){return e===void 0?new this:new this(e.maxNumberEvents,e.flushBatchSize,e.flushIntervalInMilliseconds)}start(){this._started=!0,this._timingEvents=[],this._flushTime=O_(),this._flushPointer=0}stop(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])}event(e,t,i,r){let n=this._started?this.begin(e,t,r):void 0,o=!1,a=i();if(a&&typeof a.then=="function")return o=!0,new Promise((s,c)=>{a.then(l=>Qe(this,null,function*(){n&&(yield n.end()),s(l)}),l=>Qe(this,null,function*(){n&&(yield n.end()),c(l)}))});if(!o&&n){let s=n.end();if(s&&typeof s.then=="function")return new Promise((c,l)=>{s.then(()=>{c(a)},d=>{l(d)})})}return a}begin(e,t,i){if(!this._started)throw new Error("profiler is not started yet");if(i===void 0){let r=O_();return this.flush(r),new jP(e,t,r,n=>this.endSync(n))}else{let r=i.beginTimer();return new jP(e,t,0,n=>Qe(this,null,function*(){return this.end(n)}),r,i)}}end(e){return Qe(this,null,function*(){let t=yield e.checkTimer();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new GP(e.category,e.name,e.startTime,t)),this.flush(t))})}endSync(e){let t=O_();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new GP(e.category,e.name,e.startTime,t)),this.flush(t))}logOneEvent(e){yn.verbose(`Profiler.${e.category}`,`${(e.endTime-e.startTime).toFixed(2)}ms on event '${e.name}' at ${e.endTime.toFixed(2)}`)}flush(e){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||e-this._flushTime>=this._flushIntervalInMilliseconds){for(let t=this._flushPointer;this._flushPointer<t+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=O_()}}get started(){return this._started}},O_=typeof performance<"u"&&performance.now?()=>performance.now():Date.now});function gEe(e,t,i){for(let r of i){let n=r[0],o=r[1],a=r[2],s=r[3],c=r[4];if(e.opType===n){for(let l of t)if((l.domain===o||l.domain==="ai.onnx"&&o==="")&&vEe(l.version,a))return{opImpl:s,opInit:c}}}throw new TypeError(`cannot resolve operator '${e.opType}' with opsets: ${t.map(r=>`${r.domain||"ai.onnx"} v${r.version}`).join(", ")}`)}function vEe(e,t){if(t.endsWith("+")){let i=Number.parseInt(t.substring(0,t.length-1),10);return!isNaN(i)&&i<=e}else if(t.split("-").length===2){let i=t.split("-"),r=Number.parseInt(i[0],10),n=Number.parseInt(i[1],10);return!isNaN(r)&&!isNaN(n)&&r<=e&&e<=n}else return Number.parseInt(t,10)===e}var _Ee=Ce(()=>{"use strict"}),bEe=Fn(e=>{"use strict";e.__esModule=!0;var t=function(){function i(r){if(!r)throw new TypeError("Invalid argument; `value` has no value.");this.value=i.EMPTY,r&&i.isGuid(r)&&(this.value=r)}return i.isGuid=function(r){var n=r.toString();return r&&(r instanceof i||i.validator.test(n))},i.create=function(){return new i([i.gen(2),i.gen(1),i.gen(1),i.gen(1),i.gen(3)].join("-"))},i.createEmpty=function(){return new i("emptyguid")},i.parse=function(r){return new i(r)},i.raw=function(){return[i.gen(2),i.gen(1),i.gen(1),i.gen(1),i.gen(3)].join("-")},i.gen=function(r){for(var n="",o=0;o<r;o++)n+=((1+Math.random())*65536|0).toString(16).substring(1);return n},i.prototype.equals=function(r){return i.isGuid(r)&&this.value===r.toString()},i.prototype.isEmpty=function(){return this.value===i.EMPTY},i.prototype.toString=function(){return this.value},i.prototype.toJSON=function(){return{value:this.value}},i.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),i.EMPTY="00000000-0000-0000-0000-000000000000",i}();e.Guid=t});function jr(e,t,i){this.low=e|0,this.high=t|0,this.unsigned=!!i}function $o(e){return(e&&e.__isLong__)===!0}function M7(e){var t=Math.clz32(e&-e);return e?31-t:t}function Dp(e,t){var i,r,n;return t?(e>>>=0,(n=0<=e&&e<256)&&(r=kN[e],r)?r:(i=ar(e,0,!0),n&&(kN[e]=i),i)):(e|=0,(n=-128<=e&&e<128)&&(r=MN[e],r)?r:(i=ar(e,e<0?-1:0,!1),n&&(MN[e]=i),i))}function nl(e,t){if(isNaN(e))return t?uc:rl;if(t){if(e<0)return uc;if(e>=PN)return RN}else{if(e<=-NN)return ga;if(e+1>=NN)return ON}return e<0?nl(-e,t).neg():ar(e%Fp|0,e/Fp|0,t)}function ar(e,t,i){return new jr(e,t,i)}function fO(e,t,i){if(e.length===0)throw Error("empty string");if(typeof t=="number"?(i=t,t=!1):t=!!t,e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return t?uc:rl;if(i=i||10,i<2||36<i)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return fO(e.substring(1),t,i).neg();for(var n=nl(K_(i,8)),o=rl,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),c=parseInt(e.substring(a,a+s),i);if(s<8){var l=nl(K_(i,s));o=o.mul(l).add(nl(c))}else o=o.mul(n),o=o.add(nl(c))}return o.unsigned=t,o}function Sl(e,t){return typeof e=="number"?nl(e,t):typeof e=="string"?fO(e,t):ar(e.low,e.high,typeof t=="boolean"?t:e.unsigned)}var ms,MN,kN,K_,$P,k7,Fp,PN,NN,WP,rl,uc,Ip,qP,xE,ON,RN,ga,$e,Ru,AX=Ce(()=>{ms=null;try{ms=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}jr.prototype.__isLong__,Object.defineProperty(jr.prototype,"__isLong__",{value:!0}),jr.isLong=$o,MN={},kN={},jr.fromInt=Dp,jr.fromNumber=nl,jr.fromBits=ar,K_=Math.pow,jr.fromString=fO,jr.fromValue=Sl,$P=65536,k7=1<<24,Fp=$P*$P,PN=Fp*Fp,NN=PN/2,WP=Dp(k7),rl=Dp(0),jr.ZERO=rl,uc=Dp(0,!0),jr.UZERO=uc,Ip=Dp(1),jr.ONE=Ip,qP=Dp(1,!0),jr.UONE=qP,xE=Dp(-1),jr.NEG_ONE=xE,ON=ar(-1,2147483647,!1),jr.MAX_VALUE=ON,RN=ar(-1,-1,!0),jr.MAX_UNSIGNED_VALUE=RN,ga=ar(0,-2147483648,!1),jr.MIN_VALUE=ga,$e=jr.prototype,$e.toInt=function(){return this.unsigned?this.low>>>0:this.low},$e.toNumber=function(){return this.unsigned?(this.high>>>0)*Fp+(this.low>>>0):this.high*Fp+(this.low>>>0)},$e.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ga)){var t=nl(e),i=this.div(t),r=i.mul(t).sub(this);return i.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var n=nl(K_(e,6),this.unsigned),o=this,a="";;){var s=o.div(n),c=o.sub(s.mul(n)).toInt()>>>0,l=c.toString(e);if(o=s,o.isZero())return l+a;for(;l.length<6;)l="0"+l;a=""+l+a}},$e.getHighBits=function(){return this.high},$e.getHighBitsUnsigned=function(){return this.high>>>0},$e.getLowBits=function(){return this.low},$e.getLowBitsUnsigned=function(){return this.low>>>0},$e.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ga)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1},$e.isZero=function(){return this.high===0&&this.low===0},$e.eqz=$e.isZero,$e.isNegative=function(){return!this.unsigned&&this.high<0},$e.isPositive=function(){return this.unsigned||this.high>=0},$e.isOdd=function(){return(this.low&1)===1},$e.isEven=function(){return(this.low&1)===0},$e.equals=function(e){return $o(e)||(e=Sl(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low},$e.eq=$e.equals,$e.notEquals=function(e){return!this.eq(e)},$e.neq=$e.notEquals,$e.ne=$e.notEquals,$e.lessThan=function(e){return this.comp(e)<0},$e.lt=$e.lessThan,$e.lessThanOrEqual=function(e){return this.comp(e)<=0},$e.lte=$e.lessThanOrEqual,$e.le=$e.lessThanOrEqual,$e.greaterThan=function(e){return this.comp(e)>0},$e.gt=$e.greaterThan,$e.greaterThanOrEqual=function(e){return this.comp(e)>=0},$e.gte=$e.greaterThanOrEqual,$e.ge=$e.greaterThanOrEqual,$e.compare=function(e){if($o(e)||(e=Sl(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},$e.comp=$e.compare,$e.negate=function(){return!this.unsigned&&this.eq(ga)?ga:this.not().add(Ip)},$e.neg=$e.negate,$e.add=function(e){$o(e)||(e=Sl(e));var t=this.high>>>16,i=this.high&65535,r=this.low>>>16,n=this.low&65535,o=e.high>>>16,a=e.high&65535,s=e.low>>>16,c=e.low&65535,l=0,d=0,u=0,h=0;return h+=n+c,u+=h>>>16,h&=65535,u+=r+s,d+=u>>>16,u&=65535,d+=i+a,l+=d>>>16,d&=65535,l+=t+o,l&=65535,ar(u<<16|h,l<<16|d,this.unsigned)},$e.subtract=function(e){return $o(e)||(e=Sl(e)),this.add(e.neg())},$e.sub=$e.subtract,$e.multiply=function(e){if(this.isZero())return this;if($o(e)||(e=Sl(e)),ms){var t=ms.mul(this.low,this.high,e.low,e.high);return ar(t,ms.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?uc:rl;if(this.eq(ga))return e.isOdd()?ga:rl;if(e.eq(ga))return this.isOdd()?ga:rl;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(WP)&&e.lt(WP))return nl(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,r=this.high&65535,n=this.low>>>16,o=this.low&65535,a=e.high>>>16,s=e.high&65535,c=e.low>>>16,l=e.low&65535,d=0,u=0,h=0,p=0;return p+=o*l,h+=p>>>16,p&=65535,h+=n*l,u+=h>>>16,h&=65535,h+=o*c,u+=h>>>16,h&=65535,u+=r*l,d+=u>>>16,u&=65535,u+=n*c,d+=u>>>16,u&=65535,u+=o*s,d+=u>>>16,u&=65535,d+=i*l+r*c+n*s+o*a,d&=65535,ar(h<<16|p,d<<16|u,this.unsigned)},$e.mul=$e.multiply,$e.divide=function(e){if($o(e)||(e=Sl(e)),e.isZero())throw Error("division by zero");if(ms){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?ms.div_u:ms.div_s)(this.low,this.high,e.low,e.high);return ar(t,ms.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?uc:rl;var i,r,n;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return uc;if(e.gt(this.shru(1)))return qP;n=uc}else{if(this.eq(ga)){if(e.eq(Ip)||e.eq(xE))return ga;if(e.eq(ga))return Ip;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(rl)?e.isNegative()?Ip:xE:(r=this.sub(e.mul(i)),n=i.add(r.div(e)),n)}else if(e.eq(ga))return this.unsigned?uc:rl;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();n=rl}for(r=this;r.gte(e);){i=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),s=a<=48?1:K_(2,a-48),c=nl(i),l=c.mul(e);l.isNegative()||l.gt(r);)i-=s,c=nl(i,this.unsigned),l=c.mul(e);c.isZero()&&(c=Ip),n=n.add(c),r=r.sub(l)}return n},$e.div=$e.divide,$e.modulo=function(e){if($o(e)||(e=Sl(e)),ms){var t=(this.unsigned?ms.rem_u:ms.rem_s)(this.low,this.high,e.low,e.high);return ar(t,ms.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))},$e.mod=$e.modulo,$e.rem=$e.modulo,$e.not=function(){return ar(~this.low,~this.high,this.unsigned)},$e.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},$e.clz=$e.countLeadingZeros,$e.countTrailingZeros=function(){return this.low?M7(this.low):M7(this.high)+32},$e.ctz=$e.countTrailingZeros,$e.and=function(e){return $o(e)||(e=Sl(e)),ar(this.low&e.low,this.high&e.high,this.unsigned)},$e.or=function(e){return $o(e)||(e=Sl(e)),ar(this.low|e.low,this.high|e.high,this.unsigned)},$e.xor=function(e){return $o(e)||(e=Sl(e)),ar(this.low^e.low,this.high^e.high,this.unsigned)},$e.shiftLeft=function(e){return $o(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?ar(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):ar(0,this.low<<e-32,this.unsigned)},$e.shl=$e.shiftLeft,$e.shiftRight=function(e){return $o(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?ar(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):ar(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},$e.shr=$e.shiftRight,$e.shiftRightUnsigned=function(e){return $o(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?ar(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?ar(this.high,0,this.unsigned):ar(this.high>>>e-32,0,this.unsigned)},$e.shru=$e.shiftRightUnsigned,$e.shr_u=$e.shiftRightUnsigned,$e.rotateLeft=function(e){var t;return $o(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?ar(this.high,this.low,this.unsigned):e<32?(t=32-e,ar(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,ar(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},$e.rotl=$e.rotateLeft,$e.rotateRight=function(e){var t;return $o(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?ar(this.high,this.low,this.unsigned):e<32?(t=32-e,ar(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,ar(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},$e.rotr=$e.rotateRight,$e.toSigned=function(){return this.unsigned?ar(this.low,this.high,!1):this},$e.toUnsigned=function(){return this.unsigned?this:ar(this.low,this.high,!0)},$e.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},$e.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]},$e.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]},jr.fromBytes=function(e,t,i){return i?jr.fromBytesLE(e,t):jr.fromBytesBE(e,t)},jr.fromBytesLE=function(e,t){return new jr(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},jr.fromBytesBE=function(e,t){return new jr(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)},Ru=jr}),oe,mO=Ce(()=>{oe={},oe.Offset,oe.Table,oe.SIZEOF_SHORT=2,oe.SIZEOF_INT=4,oe.FILE_IDENTIFIER_LENGTH=4,oe.SIZE_PREFIX_LENGTH=4,oe.Encoding={UTF8_BYTES:1,UTF16_STRING:2},oe.int32=new Int32Array(2),oe.float32=new Float32Array(oe.int32.buffer),oe.float64=new Float64Array(oe.int32.buffer),oe.isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1,oe.Long=function(e,t){this.low=e|0,this.high=t|0},oe.Long.create=function(e,t){return e==0&&t==0?oe.Long.ZERO:new oe.Long(e,t)},oe.Long.prototype.toFloat64=function(){return(this.low>>>0)+this.high*4294967296},oe.Long.prototype.equals=function(e){return this.low==e.low&&this.high==e.high},oe.Long.ZERO=new oe.Long(0,0),oe.Builder=function(e){if(e)var t=e;else var t=1024;this.bb=oe.ByteBuffer.allocate(t),this.space=t,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},oe.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},oe.Builder.prototype.forceDefaults=function(e){this.force_defaults=e},oe.Builder.prototype.dataBuffer=function(){return this.bb},oe.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},oe.Builder.prototype.prep=function(e,t){e>this.minalign&&(this.minalign=e);for(var i=~(this.bb.capacity()-this.space+t)+1&e-1;this.space<i+e+t;){var r=this.bb.capacity();this.bb=oe.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-r}this.pad(i)},oe.Builder.prototype.pad=function(e){for(var t=0;t<e;t++)this.bb.writeInt8(--this.space,0)},oe.Builder.prototype.writeInt8=function(e){this.bb.writeInt8(this.space-=1,e)},oe.Builder.prototype.writeInt16=function(e){this.bb.writeInt16(this.space-=2,e)},oe.Builder.prototype.writeInt32=function(e){this.bb.writeInt32(this.space-=4,e)},oe.Builder.prototype.writeInt64=function(e){this.bb.writeInt64(this.space-=8,e)},oe.Builder.prototype.writeFloat32=function(e){this.bb.writeFloat32(this.space-=4,e)},oe.Builder.prototype.writeFloat64=function(e){this.bb.writeFloat64(this.space-=8,e)},oe.Builder.prototype.addInt8=function(e){this.prep(1,0),this.writeInt8(e)},oe.Builder.prototype.addInt16=function(e){this.prep(2,0),this.writeInt16(e)},oe.Builder.prototype.addInt32=function(e){this.prep(4,0),this.writeInt32(e)},oe.Builder.prototype.addInt64=function(e){this.prep(8,0),this.writeInt64(e)},oe.Builder.prototype.addFloat32=function(e){this.prep(4,0),this.writeFloat32(e)},oe.Builder.prototype.addFloat64=function(e){this.prep(8,0),this.writeFloat64(e)},oe.Builder.prototype.addFieldInt8=function(e,t,i){(this.force_defaults||t!=i)&&(this.addInt8(t),this.slot(e))},oe.Builder.prototype.addFieldInt16=function(e,t,i){(this.force_defaults||t!=i)&&(this.addInt16(t),this.slot(e))},oe.Builder.prototype.addFieldInt32=function(e,t,i){(this.force_defaults||t!=i)&&(this.addInt32(t),this.slot(e))},oe.Builder.prototype.addFieldInt64=function(e,t,i){(this.force_defaults||!t.equals(i))&&(this.addInt64(t),this.slot(e))},oe.Builder.prototype.addFieldFloat32=function(e,t,i){(this.force_defaults||t!=i)&&(this.addFloat32(t),this.slot(e))},oe.Builder.prototype.addFieldFloat64=function(e,t,i){(this.force_defaults||t!=i)&&(this.addFloat64(t),this.slot(e))},oe.Builder.prototype.addFieldOffset=function(e,t,i){(this.force_defaults||t!=i)&&(this.addOffset(t),this.slot(e))},oe.Builder.prototype.addFieldStruct=function(e,t,i){t!=i&&(this.nested(t),this.slot(e))},oe.Builder.prototype.nested=function(e){if(e!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},oe.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},oe.Builder.prototype.slot=function(e){this.vtable[e]=this.offset()},oe.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},oe.Builder.growByteBuffer=function(e){var t=e.capacity();if(t&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var i=t<<1,r=oe.ByteBuffer.allocate(i);return r.setPosition(i-t),r.bytes().set(e.bytes(),i-t),r},oe.Builder.prototype.addOffset=function(e){this.prep(oe.SIZEOF_INT,0),this.writeInt32(this.offset()-e+oe.SIZEOF_INT)},oe.Builder.prototype.startObject=function(e){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=e;for(var t=0;t<e;t++)this.vtable[t]=0;this.isNested=!0,this.object_start=this.offset()},oe.Builder.prototype.endObject=function(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var e=this.offset(),t=this.vtable_in_use-1;t>=0&&this.vtable[t]==0;t--);for(var i=t+1;t>=0;t--)this.addInt16(this.vtable[t]!=0?e-this.vtable[t]:0);var r=2;this.addInt16(e-this.object_start);var n=(i+r)*oe.SIZEOF_SHORT;this.addInt16(n);var o=0,a=this.space;e:for(t=0;t<this.vtables.length;t++){var s=this.bb.capacity()-this.vtables[t];if(n==this.bb.readInt16(s)){for(var c=oe.SIZEOF_SHORT;c<n;c+=oe.SIZEOF_SHORT)if(this.bb.readInt16(a+c)!=this.bb.readInt16(s+c))continue e;o=this.vtables[t];break}}return o?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,o-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e},oe.Builder.prototype.finish=function(e,t,i){var r=i?oe.SIZE_PREFIX_LENGTH:0;if(t){var n=t;if(this.prep(this.minalign,oe.SIZEOF_INT+oe.FILE_IDENTIFIER_LENGTH+r),n.length!=oe.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+oe.FILE_IDENTIFIER_LENGTH);for(var o=oe.FILE_IDENTIFIER_LENGTH-1;o>=0;o--)this.writeInt8(n.charCodeAt(o))}this.prep(this.minalign,oe.SIZEOF_INT+r),this.addOffset(e),r&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},oe.Builder.prototype.finishSizePrefixed=function(e,t){this.finish(e,t,!0)},oe.Builder.prototype.requiredField=function(e,t){var i=this.bb.capacity()-e,r=i-this.bb.readInt32(i),n=this.bb.readInt16(r+t)!=0;if(!n)throw new Error("FlatBuffers: field "+t+" must be set")},oe.Builder.prototype.startVector=function(e,t,i){this.notNested(),this.vector_num_elems=t,this.prep(oe.SIZEOF_INT,e*t),this.prep(i,e*t)},oe.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},oe.Builder.prototype.createString=function(e){if(e instanceof Uint8Array)var t=e;else for(var t=[],i=0;i<e.length;){var r,n=e.charCodeAt(i++);if(n<55296||n>=56320)r=n;else{var o=e.charCodeAt(i++);r=(n<<10)+o+-56613888}r<128?t.push(r):(r<2048?t.push(r>>6&31|192):(r<65536?t.push(r>>12&15|224):t.push(r>>18&7|240,r>>12&63|128),t.push(r>>6&63|128)),t.push(r&63|128))}this.addInt8(0),this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length);for(var i=0,a=this.space,s=this.bb.bytes();i<t.length;i++)s[a++]=t[i];return this.endVector()},oe.Builder.prototype.createLong=function(e,t){return oe.Long.create(e,t)},oe.ByteBuffer=function(e){this.bytes_=e,this.position_=0},oe.ByteBuffer.allocate=function(e){return new oe.ByteBuffer(new Uint8Array(e))},oe.ByteBuffer.prototype.clear=function(){this.position_=0},oe.ByteBuffer.prototype.bytes=function(){return this.bytes_},oe.ByteBuffer.prototype.position=function(){return this.position_},oe.ByteBuffer.prototype.setPosition=function(e){this.position_=e},oe.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},oe.ByteBuffer.prototype.readInt8=function(e){return this.readUint8(e)<<24>>24},oe.ByteBuffer.prototype.readUint8=function(e){return this.bytes_[e]},oe.ByteBuffer.prototype.readInt16=function(e){return this.readUint16(e)<<16>>16},oe.ByteBuffer.prototype.readUint16=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8},oe.ByteBuffer.prototype.readInt32=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24},oe.ByteBuffer.prototype.readUint32=function(e){return this.readInt32(e)>>>0},oe.ByteBuffer.prototype.readInt64=function(e){return new oe.Long(this.readInt32(e),this.readInt32(e+4))},oe.ByteBuffer.prototype.readUint64=function(e){return new oe.Long(this.readUint32(e),this.readUint32(e+4))},oe.ByteBuffer.prototype.readFloat32=function(e){return oe.int32[0]=this.readInt32(e),oe.float32[0]},oe.ByteBuffer.prototype.readFloat64=function(e){return oe.int32[oe.isLittleEndian?0:1]=this.readInt32(e),oe.int32[oe.isLittleEndian?1:0]=this.readInt32(e+4),oe.float64[0]},oe.ByteBuffer.prototype.writeInt8=function(e,t){this.bytes_[e]=t},oe.ByteBuffer.prototype.writeUint8=function(e,t){this.bytes_[e]=t},oe.ByteBuffer.prototype.writeInt16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8},oe.ByteBuffer.prototype.writeUint16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8},oe.ByteBuffer.prototype.writeInt32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24},oe.ByteBuffer.prototype.writeUint32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24},oe.ByteBuffer.prototype.writeInt64=function(e,t){this.writeInt32(e,t.low),this.writeInt32(e+4,t.high)},oe.ByteBuffer.prototype.writeUint64=function(e,t){this.writeUint32(e,t.low),this.writeUint32(e+4,t.high)},oe.ByteBuffer.prototype.writeFloat32=function(e,t){oe.float32[0]=t,this.writeInt32(e,oe.int32[0])},oe.ByteBuffer.prototype.writeFloat64=function(e,t){oe.float64[0]=t,this.writeInt32(e,oe.int32[oe.isLittleEndian?0:1]),this.writeInt32(e+4,oe.int32[oe.isLittleEndian?1:0])},oe.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+oe.SIZEOF_INT+oe.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var e="",t=0;t<oe.FILE_IDENTIFIER_LENGTH;t++)e+=String.fromCharCode(this.readInt8(this.position_+oe.SIZEOF_INT+t));return e},oe.ByteBuffer.prototype.__offset=function(e,t){var i=e-this.readInt32(e);return t<this.readInt16(i)?this.readInt16(i+t):0},oe.ByteBuffer.prototype.__union=function(e,t){return e.bb_pos=t+this.readInt32(t),e.bb=this,e},oe.ByteBuffer.prototype.__string=function(e,t){e+=this.readInt32(e);var i=this.readInt32(e),r="",n=0;if(e+=oe.SIZEOF_INT,t===oe.Encoding.UTF8_BYTES)return this.bytes_.subarray(e,e+i);for(;n<i;){var o,a=this.readUint8(e+n++);if(a<192)o=a;else{var s=this.readUint8(e+n++);if(a<224)o=(a&31)<<6|s&63;else{var c=this.readUint8(e+n++);if(a<240)o=(a&15)<<12|(s&63)<<6|c&63;else{var l=this.readUint8(e+n++);o=(a&7)<<18|(s&63)<<12|(c&63)<<6|l&63}}}o<65536?r+=String.fromCharCode(o):(o-=65536,r+=String.fromCharCode((o>>10)+55296,(o&1023)+56320))}return r},oe.ByteBuffer.prototype.__indirect=function(e){return e+this.readInt32(e)},oe.ByteBuffer.prototype.__vector=function(e){return e+this.readInt32(e)+oe.SIZEOF_INT},oe.ByteBuffer.prototype.__vector_len=function(e){return this.readInt32(e+this.readInt32(e))},oe.ByteBuffer.prototype.__has_identifier=function(e){if(e.length!=oe.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+oe.FILE_IDENTIFIER_LENGTH);for(var t=0;t<oe.FILE_IDENTIFIER_LENGTH;t++)if(e.charCodeAt(t)!=this.readInt8(this.position_+oe.SIZEOF_INT+t))return!1;return!0},oe.ByteBuffer.prototype.createLong=function(e,t){return oe.Long.create(e,t)}}),_r,BE=Ce(()=>{"use strict";mO(),(e=>{let t;(i=>{let r;(n=>{let o;(a=>(a[a.UNDEFINED=0]="UNDEFINED",a[a.FLOAT=1]="FLOAT",a[a.INT=2]="INT",a[a.STRING=3]="STRING",a[a.TENSOR=4]="TENSOR",a[a.GRAPH=5]="GRAPH",a[a.FLOATS=6]="FLOATS",a[a.INTS=7]="INTS",a[a.STRINGS=8]="STRINGS",a[a.TENSORS=9]="TENSORS",a[a.GRAPHS=10]="GRAPHS",a[a.SPARSE_TENSOR=11]="SPARSE_TENSOR",a[a.SPARSE_TENSORS=12]="SPARSE_TENSORS"))(o=n.AttributeType||={})})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{let o;(a=>(a[a.UNKNOWN=0]="UNKNOWN",a[a.VALUE=1]="VALUE",a[a.PARAM=2]="PARAM"))(o=n.DimensionValueType||={})})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{let o;(a=>(a[a.UNDEFINED=0]="UNDEFINED",a[a.FLOAT=1]="FLOAT",a[a.UINT8=2]="UINT8",a[a.INT8=3]="INT8",a[a.UINT16=4]="UINT16",a[a.INT16=5]="INT16",a[a.INT32=6]="INT32",a[a.INT64=7]="INT64",a[a.STRING=8]="STRING",a[a.BOOL=9]="BOOL",a[a.FLOAT16=10]="FLOAT16",a[a.DOUBLE=11]="DOUBLE",a[a.UINT32=12]="UINT32",a[a.UINT64=13]="UINT64",a[a.COMPLEX64=14]="COMPLEX64",a[a.COMPLEX128=15]="COMPLEX128",a[a.BFLOAT16=16]="BFLOAT16",a[a.FLOAT8E4M3FN=17]="FLOAT8E4M3FN",a[a.FLOAT8E4M3FNUZ=18]="FLOAT8E4M3FNUZ",a[a.FLOAT8E5M2=19]="FLOAT8E5M2",a[a.FLOAT8E5M2FNUZ=20]="FLOAT8E5M2FNUZ"))(o=n.TensorDataType||={})})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{let o;(a=>(a[a.Primitive=0]="Primitive",a[a.Fused=1]="Fused"))(o=n.NodeType||={})})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{let o;(a=>(a[a.NONE=0]="NONE",a[a.tensor_type=1]="tensor_type",a[a.sequence_type=2]="sequence_type",a[a.map_type=3]="map_type"))(o=n.TypeInfoValue||={})})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsShape(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsShape(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}dim(s,c){let l=this.bb.__offset(this.bb_pos,4);return l?(c||new e.experimental.fbs.Dimension).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+l)+s*4),this.bb):null}dimLength(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.__vector_len(this.bb_pos+s):0}static startShape(s){s.startObject(1)}static addDim(s,c){s.addFieldOffset(0,c,0)}static createDimVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startDimVector(s,c){s.startVector(4,c,4)}static endShape(s){return s.endObject()}static createShape(s,c){return o.startShape(s),o.addDim(s,c),o.endShape(s)}}n.Shape=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsDimension(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsDimension(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}value(s){let c=this.bb.__offset(this.bb_pos,4);return c?(s||new e.experimental.fbs.DimensionValue).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}denotation(s){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,s):null}static startDimension(s){s.startObject(2)}static addValue(s,c){s.addFieldOffset(0,c,0)}static addDenotation(s,c){s.addFieldOffset(1,c,0)}static endDimension(s){return s.endObject()}static createDimension(s,c,l){return o.startDimension(s),o.addValue(s,c),o.addDenotation(s,l),o.endDimension(s)}}n.Dimension=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsDimensionValue(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsDimensionValue(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}dimType(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt8(this.bb_pos+s):0}dimValue(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}dimParam(s){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.__string(this.bb_pos+c,s):null}static startDimensionValue(s){s.startObject(3)}static addDimType(s,c){s.addFieldInt8(0,c,0)}static addDimValue(s,c){s.addFieldInt64(1,c,s.createLong(0,0))}static addDimParam(s,c){s.addFieldOffset(2,c,0)}static endDimensionValue(s){return s.endObject()}static createDimensionValue(s,c,l,d){return o.startDimensionValue(s),o.addDimType(s,c),o.addDimValue(s,l),o.addDimParam(s,d),o.endDimensionValue(s)}}n.DimensionValue=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsTensorTypeAndShape(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsTensorTypeAndShape(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}elemType(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt32(this.bb_pos+s):0}shape(s){let c=this.bb.__offset(this.bb_pos,6);return c?(s||new e.experimental.fbs.Shape).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startTensorTypeAndShape(s){s.startObject(2)}static addElemType(s,c){s.addFieldInt32(0,c,0)}static addShape(s,c){s.addFieldOffset(1,c,0)}static endTensorTypeAndShape(s){return s.endObject()}static createTensorTypeAndShape(s,c,l){return o.startTensorTypeAndShape(s),o.addElemType(s,c),o.addShape(s,l),o.endTensorTypeAndShape(s)}}n.TensorTypeAndShape=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsMapType(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsMapType(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}keyType(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt32(this.bb_pos+s):0}valueType(s){let c=this.bb.__offset(this.bb_pos,6);return c?(s||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startMapType(s){s.startObject(2)}static addKeyType(s,c){s.addFieldInt32(0,c,0)}static addValueType(s,c){s.addFieldOffset(1,c,0)}static endMapType(s){return s.endObject()}static createMapType(s,c,l){return o.startMapType(s),o.addKeyType(s,c),o.addValueType(s,l),o.endMapType(s)}}n.MapType=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsSequenceType(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsSequenceType(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}elemType(s){let c=this.bb.__offset(this.bb_pos,4);return c?(s||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startSequenceType(s){s.startObject(1)}static addElemType(s,c){s.addFieldOffset(0,c,0)}static endSequenceType(s){return s.endObject()}static createSequenceType(s,c){return o.startSequenceType(s),o.addElemType(s,c),o.endSequenceType(s)}}n.SequenceType=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}nodeIndex(){return this.bb.readUint32(this.bb_pos)}srcArgIndex(){return this.bb.readInt32(this.bb_pos+4)}dstArgIndex(){return this.bb.readInt32(this.bb_pos+8)}static createEdgeEnd(s,c,l,d){return s.prep(4,12),s.writeInt32(d),s.writeInt32(l),s.writeInt32(c),s.offset()}}n.EdgeEnd=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsNodeEdge(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsNodeEdge(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}nodeIndex(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readUint32(this.bb_pos+s):0}inputEdges(s,c){let l=this.bb.__offset(this.bb_pos,6);return l?(c||new e.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+l)+s*12,this.bb):null}inputEdgesLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}outputEdges(s,c){let l=this.bb.__offset(this.bb_pos,8);return l?(c||new e.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+l)+s*12,this.bb):null}outputEdgesLength(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.__vector_len(this.bb_pos+s):0}static startNodeEdge(s){s.startObject(3)}static addNodeIndex(s,c){s.addFieldInt32(0,c,0)}static addInputEdges(s,c){s.addFieldOffset(1,c,0)}static startInputEdgesVector(s,c){s.startVector(12,c,4)}static addOutputEdges(s,c){s.addFieldOffset(2,c,0)}static startOutputEdgesVector(s,c){s.startVector(12,c,4)}static endNodeEdge(s){return s.endObject()}static createNodeEdge(s,c,l,d){return o.startNodeEdge(s),o.addNodeIndex(s,c),o.addInputEdges(s,l),o.addOutputEdges(s,d),o.endNodeEdge(s)}}n.NodeEdge=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsNode(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsNode(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}name(s){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,s):null}docString(s){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,s):null}domain(s){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.__string(this.bb_pos+c,s):null}sinceVersion(){let s=this.bb.__offset(this.bb_pos,10);return s?this.bb.readInt32(this.bb_pos+s):0}index(){let s=this.bb.__offset(this.bb_pos,12);return s?this.bb.readUint32(this.bb_pos+s):0}opType(s){let c=this.bb.__offset(this.bb_pos,14);return c?this.bb.__string(this.bb_pos+c,s):null}type(){let s=this.bb.__offset(this.bb_pos,16);return s?this.bb.readInt32(this.bb_pos+s):0}executionProviderType(s){let c=this.bb.__offset(this.bb_pos,18);return c?this.bb.__string(this.bb_pos+c,s):null}inputs(s,c){let l=this.bb.__offset(this.bb_pos,20);return l?this.bb.__string(this.bb.__vector(this.bb_pos+l)+s*4,c):null}inputsLength(){let s=this.bb.__offset(this.bb_pos,20);return s?this.bb.__vector_len(this.bb_pos+s):0}outputs(s,c){let l=this.bb.__offset(this.bb_pos,22);return l?this.bb.__string(this.bb.__vector(this.bb_pos+l)+s*4,c):null}outputsLength(){let s=this.bb.__offset(this.bb_pos,22);return s?this.bb.__vector_len(this.bb_pos+s):0}attributes(s,c){let l=this.bb.__offset(this.bb_pos,24);return l?(c||new e.experimental.fbs.Attribute).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+l)+s*4),this.bb):null}attributesLength(){let s=this.bb.__offset(this.bb_pos,24);return s?this.bb.__vector_len(this.bb_pos+s):0}inputArgCounts(s){let c=this.bb.__offset(this.bb_pos,26);return c?this.bb.readInt32(this.bb.__vector(this.bb_pos+c)+s*4):0}inputArgCountsLength(){let s=this.bb.__offset(this.bb_pos,26);return s?this.bb.__vector_len(this.bb_pos+s):0}inputArgCountsArray(){let s=this.bb.__offset(this.bb_pos,26);return s?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+s),this.bb.__vector_len(this.bb_pos+s)):null}implicitInputs(s,c){let l=this.bb.__offset(this.bb_pos,28);return l?this.bb.__string(this.bb.__vector(this.bb_pos+l)+s*4,c):null}implicitInputsLength(){let s=this.bb.__offset(this.bb_pos,28);return s?this.bb.__vector_len(this.bb_pos+s):0}static startNode(s){s.startObject(13)}static addName(s,c){s.addFieldOffset(0,c,0)}static addDocString(s,c){s.addFieldOffset(1,c,0)}static addDomain(s,c){s.addFieldOffset(2,c,0)}static addSinceVersion(s,c){s.addFieldInt32(3,c,0)}static addIndex(s,c){s.addFieldInt32(4,c,0)}static addOpType(s,c){s.addFieldOffset(5,c,0)}static addType(s,c){s.addFieldInt32(6,c,0)}static addExecutionProviderType(s,c){s.addFieldOffset(7,c,0)}static addInputs(s,c){s.addFieldOffset(8,c,0)}static createInputsVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startInputsVector(s,c){s.startVector(4,c,4)}static addOutputs(s,c){s.addFieldOffset(9,c,0)}static createOutputsVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startOutputsVector(s,c){s.startVector(4,c,4)}static addAttributes(s,c){s.addFieldOffset(10,c,0)}static createAttributesVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startAttributesVector(s,c){s.startVector(4,c,4)}static addInputArgCounts(s,c){s.addFieldOffset(11,c,0)}static createInputArgCountsVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addInt32(c[l]);return s.endVector()}static startInputArgCountsVector(s,c){s.startVector(4,c,4)}static addImplicitInputs(s,c){s.addFieldOffset(12,c,0)}static createImplicitInputsVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startImplicitInputsVector(s,c){s.startVector(4,c,4)}static endNode(s){return s.endObject()}static createNode(s,c,l,d,u,h,p,m,f,g,v,_,b,y){return o.startNode(s),o.addName(s,c),o.addDocString(s,l),o.addDomain(s,d),o.addSinceVersion(s,u),o.addIndex(s,h),o.addOpType(s,p),o.addType(s,m),o.addExecutionProviderType(s,f),o.addInputs(s,g),o.addOutputs(s,v),o.addAttributes(s,_),o.addInputArgCounts(s,b),o.addImplicitInputs(s,y),o.endNode(s)}}n.Node=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsValueInfo(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsValueInfo(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}name(s){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,s):null}docString(s){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,s):null}type(s){let c=this.bb.__offset(this.bb_pos,8);return c?(s||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startValueInfo(s){s.startObject(3)}static addName(s,c){s.addFieldOffset(0,c,0)}static addDocString(s,c){s.addFieldOffset(1,c,0)}static addType(s,c){s.addFieldOffset(2,c,0)}static endValueInfo(s){return s.endObject()}static createValueInfo(s,c,l,d){return o.startValueInfo(s),o.addName(s,c),o.addDocString(s,l),o.addType(s,d),o.endValueInfo(s)}}n.ValueInfo=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsTypeInfo(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsTypeInfo(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}denotation(s){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,s):null}valueType(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.readUint8(this.bb_pos+s):0}value(s){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.__union(s,this.bb_pos+c):null}static startTypeInfo(s){s.startObject(3)}static addDenotation(s,c){s.addFieldOffset(0,c,0)}static addValueType(s,c){s.addFieldInt8(1,c,0)}static addValue(s,c){s.addFieldOffset(2,c,0)}static endTypeInfo(s){return s.endObject()}static createTypeInfo(s,c,l,d){return o.startTypeInfo(s),o.addDenotation(s,c),o.addValueType(s,l),o.addValue(s,d),o.endTypeInfo(s)}}n.TypeInfo=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsOperatorSetId(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsOperatorSetId(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}domain(s){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,s):null}version(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}static startOperatorSetId(s){s.startObject(2)}static addDomain(s,c){s.addFieldOffset(0,c,0)}static addVersion(s,c){s.addFieldInt64(1,c,s.createLong(0,0))}static endOperatorSetId(s){return s.endObject()}static createOperatorSetId(s,c,l){return o.startOperatorSetId(s),o.addDomain(s,c),o.addVersion(s,l),o.endOperatorSetId(s)}}n.OperatorSetId=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsTensor(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsTensor(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}name(s){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,s):null}docString(s){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,s):null}dims(s){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.readInt64(this.bb.__vector(this.bb_pos+c)+s*8):this.bb.createLong(0,0)}dimsLength(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.__vector_len(this.bb_pos+s):0}dataType(){let s=this.bb.__offset(this.bb_pos,10);return s?this.bb.readInt32(this.bb_pos+s):0}rawData(s){let c=this.bb.__offset(this.bb_pos,12);return c?this.bb.readUint8(this.bb.__vector(this.bb_pos+c)+s):0}rawDataLength(){let s=this.bb.__offset(this.bb_pos,12);return s?this.bb.__vector_len(this.bb_pos+s):0}rawDataArray(){let s=this.bb.__offset(this.bb_pos,12);return s?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+s),this.bb.__vector_len(this.bb_pos+s)):null}stringData(s,c){let l=this.bb.__offset(this.bb_pos,14);return l?this.bb.__string(this.bb.__vector(this.bb_pos+l)+s*4,c):null}stringDataLength(){let s=this.bb.__offset(this.bb_pos,14);return s?this.bb.__vector_len(this.bb_pos+s):0}static startTensor(s){s.startObject(6)}static addName(s,c){s.addFieldOffset(0,c,0)}static addDocString(s,c){s.addFieldOffset(1,c,0)}static addDims(s,c){s.addFieldOffset(2,c,0)}static createDimsVector(s,c){s.startVector(8,c.length,8);for(let l=c.length-1;l>=0;l--)s.addInt64(c[l]);return s.endVector()}static startDimsVector(s,c){s.startVector(8,c,8)}static addDataType(s,c){s.addFieldInt32(3,c,0)}static addRawData(s,c){s.addFieldOffset(4,c,0)}static createRawDataVector(s,c){s.startVector(1,c.length,1);for(let l=c.length-1;l>=0;l--)s.addInt8(c[l]);return s.endVector()}static startRawDataVector(s,c){s.startVector(1,c,1)}static addStringData(s,c){s.addFieldOffset(5,c,0)}static createStringDataVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startStringDataVector(s,c){s.startVector(4,c,4)}static endTensor(s){return s.endObject()}static createTensor(s,c,l,d,u,h,p){return o.startTensor(s),o.addName(s,c),o.addDocString(s,l),o.addDims(s,d),o.addDataType(s,u),o.addRawData(s,h),o.addStringData(s,p),o.endTensor(s)}}n.Tensor=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsSparseTensor(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsSparseTensor(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}values(s){let c=this.bb.__offset(this.bb_pos,4);return c?(s||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}indices(s){let c=this.bb.__offset(this.bb_pos,6);return c?(s||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}dims(s){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.readInt64(this.bb.__vector(this.bb_pos+c)+s*8):this.bb.createLong(0,0)}dimsLength(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.__vector_len(this.bb_pos+s):0}static startSparseTensor(s){s.startObject(3)}static addValues(s,c){s.addFieldOffset(0,c,0)}static addIndices(s,c){s.addFieldOffset(1,c,0)}static addDims(s,c){s.addFieldOffset(2,c,0)}static createDimsVector(s,c){s.startVector(8,c.length,8);for(let l=c.length-1;l>=0;l--)s.addInt64(c[l]);return s.endVector()}static startDimsVector(s,c){s.startVector(8,c,8)}static endSparseTensor(s){return s.endObject()}static createSparseTensor(s,c,l,d){return o.startSparseTensor(s),o.addValues(s,c),o.addIndices(s,l),o.addDims(s,d),o.endSparseTensor(s)}}n.SparseTensor=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsAttribute(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsAttribute(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}name(s){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,s):null}docString(s){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,s):null}type(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.readInt32(this.bb_pos+s):0}f(){let s=this.bb.__offset(this.bb_pos,10);return s?this.bb.readFloat32(this.bb_pos+s):0}i(){let s=this.bb.__offset(this.bb_pos,12);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}s(s){let c=this.bb.__offset(this.bb_pos,14);return c?this.bb.__string(this.bb_pos+c,s):null}t(s){let c=this.bb.__offset(this.bb_pos,16);return c?(s||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}g(s){let c=this.bb.__offset(this.bb_pos,18);return c?(s||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}floats(s){let c=this.bb.__offset(this.bb_pos,20);return c?this.bb.readFloat32(this.bb.__vector(this.bb_pos+c)+s*4):0}floatsLength(){let s=this.bb.__offset(this.bb_pos,20);return s?this.bb.__vector_len(this.bb_pos+s):0}floatsArray(){let s=this.bb.__offset(this.bb_pos,20);return s?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+s),this.bb.__vector_len(this.bb_pos+s)):null}ints(s){let c=this.bb.__offset(this.bb_pos,22);return c?this.bb.readInt64(this.bb.__vector(this.bb_pos+c)+s*8):this.bb.createLong(0,0)}intsLength(){let s=this.bb.__offset(this.bb_pos,22);return s?this.bb.__vector_len(this.bb_pos+s):0}strings(s,c){let l=this.bb.__offset(this.bb_pos,24);return l?this.bb.__string(this.bb.__vector(this.bb_pos+l)+s*4,c):null}stringsLength(){let s=this.bb.__offset(this.bb_pos,24);return s?this.bb.__vector_len(this.bb_pos+s):0}tensors(s,c){let l=this.bb.__offset(this.bb_pos,26);return l?(c||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+l)+s*4),this.bb):null}tensorsLength(){let s=this.bb.__offset(this.bb_pos,26);return s?this.bb.__vector_len(this.bb_pos+s):0}graphs(s,c){let l=this.bb.__offset(this.bb_pos,28);return l?(c||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+l)+s*4),this.bb):null}graphsLength(){let s=this.bb.__offset(this.bb_pos,28);return s?this.bb.__vector_len(this.bb_pos+s):0}static startAttribute(s){s.startObject(13)}static addName(s,c){s.addFieldOffset(0,c,0)}static addDocString(s,c){s.addFieldOffset(1,c,0)}static addType(s,c){s.addFieldInt32(2,c,0)}static addF(s,c){s.addFieldFloat32(3,c,0)}static addI(s,c){s.addFieldInt64(4,c,s.createLong(0,0))}static addS(s,c){s.addFieldOffset(5,c,0)}static addT(s,c){s.addFieldOffset(6,c,0)}static addG(s,c){s.addFieldOffset(7,c,0)}static addFloats(s,c){s.addFieldOffset(8,c,0)}static createFloatsVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addFloat32(c[l]);return s.endVector()}static startFloatsVector(s,c){s.startVector(4,c,4)}static addInts(s,c){s.addFieldOffset(9,c,0)}static createIntsVector(s,c){s.startVector(8,c.length,8);for(let l=c.length-1;l>=0;l--)s.addInt64(c[l]);return s.endVector()}static startIntsVector(s,c){s.startVector(8,c,8)}static addStrings(s,c){s.addFieldOffset(10,c,0)}static createStringsVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startStringsVector(s,c){s.startVector(4,c,4)}static addTensors(s,c){s.addFieldOffset(11,c,0)}static createTensorsVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startTensorsVector(s,c){s.startVector(4,c,4)}static addGraphs(s,c){s.addFieldOffset(12,c,0)}static createGraphsVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startGraphsVector(s,c){s.startVector(4,c,4)}static endAttribute(s){return s.endObject()}static createAttribute(s,c,l,d,u,h,p,m,f,g,v,_,b,y){return o.startAttribute(s),o.addName(s,c),o.addDocString(s,l),o.addType(s,d),o.addF(s,u),o.addI(s,h),o.addS(s,p),o.addT(s,m),o.addG(s,f),o.addFloats(s,g),o.addInts(s,v),o.addStrings(s,_),o.addTensors(s,b),o.addGraphs(s,y),o.endAttribute(s)}}n.Attribute=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsGraph(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsGraph(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}initializers(s,c){let l=this.bb.__offset(this.bb_pos,4);return l?(c||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+l)+s*4),this.bb):null}initializersLength(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.__vector_len(this.bb_pos+s):0}nodeArgs(s,c){let l=this.bb.__offset(this.bb_pos,6);return l?(c||new e.experimental.fbs.ValueInfo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+l)+s*4),this.bb):null}nodeArgsLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}nodes(s,c){let l=this.bb.__offset(this.bb_pos,8);return l?(c||new e.experimental.fbs.Node).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+l)+s*4),this.bb):null}nodesLength(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.__vector_len(this.bb_pos+s):0}maxNodeIndex(){let s=this.bb.__offset(this.bb_pos,10);return s?this.bb.readUint32(this.bb_pos+s):0}nodeEdges(s,c){let l=this.bb.__offset(this.bb_pos,12);return l?(c||new e.experimental.fbs.NodeEdge).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+l)+s*4),this.bb):null}nodeEdgesLength(){let s=this.bb.__offset(this.bb_pos,12);return s?this.bb.__vector_len(this.bb_pos+s):0}inputs(s,c){let l=this.bb.__offset(this.bb_pos,14);return l?this.bb.__string(this.bb.__vector(this.bb_pos+l)+s*4,c):null}inputsLength(){let s=this.bb.__offset(this.bb_pos,14);return s?this.bb.__vector_len(this.bb_pos+s):0}outputs(s,c){let l=this.bb.__offset(this.bb_pos,16);return l?this.bb.__string(this.bb.__vector(this.bb_pos+l)+s*4,c):null}outputsLength(){let s=this.bb.__offset(this.bb_pos,16);return s?this.bb.__vector_len(this.bb_pos+s):0}sparseInitializers(s,c){let l=this.bb.__offset(this.bb_pos,18);return l?(c||new e.experimental.fbs.SparseTensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+l)+s*4),this.bb):null}sparseInitializersLength(){let s=this.bb.__offset(this.bb_pos,18);return s?this.bb.__vector_len(this.bb_pos+s):0}static startGraph(s){s.startObject(8)}static addInitializers(s,c){s.addFieldOffset(0,c,0)}static createInitializersVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startInitializersVector(s,c){s.startVector(4,c,4)}static addNodeArgs(s,c){s.addFieldOffset(1,c,0)}static createNodeArgsVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startNodeArgsVector(s,c){s.startVector(4,c,4)}static addNodes(s,c){s.addFieldOffset(2,c,0)}static createNodesVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startNodesVector(s,c){s.startVector(4,c,4)}static addMaxNodeIndex(s,c){s.addFieldInt32(3,c,0)}static addNodeEdges(s,c){s.addFieldOffset(4,c,0)}static createNodeEdgesVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startNodeEdgesVector(s,c){s.startVector(4,c,4)}static addInputs(s,c){s.addFieldOffset(5,c,0)}static createInputsVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startInputsVector(s,c){s.startVector(4,c,4)}static addOutputs(s,c){s.addFieldOffset(6,c,0)}static createOutputsVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startOutputsVector(s,c){s.startVector(4,c,4)}static addSparseInitializers(s,c){s.addFieldOffset(7,c,0)}static createSparseInitializersVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startSparseInitializersVector(s,c){s.startVector(4,c,4)}static endGraph(s){return s.endObject()}static createGraph(s,c,l,d,u,h,p,m,f){return o.startGraph(s),o.addInitializers(s,c),o.addNodeArgs(s,l),o.addNodes(s,d),o.addMaxNodeIndex(s,u),o.addNodeEdges(s,h),o.addInputs(s,p),o.addOutputs(s,m),o.addSparseInitializers(s,f),o.endGraph(s)}}n.Graph=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsModel(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsModel(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}irVersion(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}opsetImport(s,c){let l=this.bb.__offset(this.bb_pos,6);return l?(c||new e.experimental.fbs.OperatorSetId).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+l)+s*4),this.bb):null}opsetImportLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}producerName(s){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.__string(this.bb_pos+c,s):null}producerVersion(s){let c=this.bb.__offset(this.bb_pos,10);return c?this.bb.__string(this.bb_pos+c,s):null}domain(s){let c=this.bb.__offset(this.bb_pos,12);return c?this.bb.__string(this.bb_pos+c,s):null}modelVersion(){let s=this.bb.__offset(this.bb_pos,14);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}docString(s){let c=this.bb.__offset(this.bb_pos,16);return c?this.bb.__string(this.bb_pos+c,s):null}graph(s){let c=this.bb.__offset(this.bb_pos,18);return c?(s||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}graphDocString(s){let c=this.bb.__offset(this.bb_pos,20);return c?this.bb.__string(this.bb_pos+c,s):null}static startModel(s){s.startObject(9)}static addIrVersion(s,c){s.addFieldInt64(0,c,s.createLong(0,0))}static addOpsetImport(s,c){s.addFieldOffset(1,c,0)}static createOpsetImportVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startOpsetImportVector(s,c){s.startVector(4,c,4)}static addProducerName(s,c){s.addFieldOffset(2,c,0)}static addProducerVersion(s,c){s.addFieldOffset(3,c,0)}static addDomain(s,c){s.addFieldOffset(4,c,0)}static addModelVersion(s,c){s.addFieldInt64(5,c,s.createLong(0,0))}static addDocString(s,c){s.addFieldOffset(6,c,0)}static addGraph(s,c){s.addFieldOffset(7,c,0)}static addGraphDocString(s,c){s.addFieldOffset(8,c,0)}static endModel(s){return s.endObject()}static createModel(s,c,l,d,u,h,p,m,f,g){return o.startModel(s),o.addIrVersion(s,c),o.addOpsetImport(s,l),o.addProducerName(s,d),o.addProducerVersion(s,u),o.addDomain(s,h),o.addModelVersion(s,p),o.addDocString(s,m),o.addGraph(s,f),o.addGraphDocString(s,g),o.endModel(s)}}n.Model=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsKernelCreateInfos(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsKernelCreateInfos(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}nodeIndices(s){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.readUint32(this.bb.__vector(this.bb_pos+c)+s*4):0}nodeIndicesLength(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.__vector_len(this.bb_pos+s):0}nodeIndicesArray(){let s=this.bb.__offset(this.bb_pos,4);return s?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+s),this.bb.__vector_len(this.bb_pos+s)):null}kernelDefHashes(s){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.readUint64(this.bb.__vector(this.bb_pos+c)+s*8):this.bb.createLong(0,0)}kernelDefHashesLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}static startKernelCreateInfos(s){s.startObject(2)}static addNodeIndices(s,c){s.addFieldOffset(0,c,0)}static createNodeIndicesVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addInt32(c[l]);return s.endVector()}static startNodeIndicesVector(s,c){s.startVector(4,c,4)}static addKernelDefHashes(s,c){s.addFieldOffset(1,c,0)}static createKernelDefHashesVector(s,c){s.startVector(8,c.length,8);for(let l=c.length-1;l>=0;l--)s.addInt64(c[l]);return s.endVector()}static startKernelDefHashesVector(s,c){s.startVector(8,c,8)}static endKernelCreateInfos(s){return s.endObject()}static createKernelCreateInfos(s,c,l){return o.startKernelCreateInfos(s),o.addNodeIndices(s,c),o.addKernelDefHashes(s,l),o.endKernelCreateInfos(s)}}n.KernelCreateInfos=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsSubGraphSessionState(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsSubGraphSessionState(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}graphId(s){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,s):null}sessionState(s){let c=this.bb.__offset(this.bb_pos,6);return c?(s||new e.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startSubGraphSessionState(s){s.startObject(2)}static addGraphId(s,c){s.addFieldOffset(0,c,0)}static addSessionState(s,c){s.addFieldOffset(1,c,0)}static endSubGraphSessionState(s){let c=s.endObject();return s.requiredField(c,4),c}static createSubGraphSessionState(s,c,l){return o.startSubGraphSessionState(s),o.addGraphId(s,c),o.addSessionState(s,l),o.endSubGraphSessionState(s)}}n.SubGraphSessionState=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsSessionState(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsSessionState(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}kernels(s){let c=this.bb.__offset(this.bb_pos,4);return c?(s||new e.experimental.fbs.KernelCreateInfos).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}subGraphSessionStates(s,c){let l=this.bb.__offset(this.bb_pos,6);return l?(c||new e.experimental.fbs.SubGraphSessionState).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+l)+s*4),this.bb):null}subGraphSessionStatesLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}static startSessionState(s){s.startObject(2)}static addKernels(s,c){s.addFieldOffset(0,c,0)}static addSubGraphSessionStates(s,c){s.addFieldOffset(1,c,0)}static createSubGraphSessionStatesVector(s,c){s.startVector(4,c.length,4);for(let l=c.length-1;l>=0;l--)s.addOffset(c[l]);return s.endVector()}static startSubGraphSessionStatesVector(s,c){s.startVector(4,c,4)}static endSessionState(s){return s.endObject()}static createSessionState(s,c,l){return o.startSessionState(s),o.addKernels(s,c),o.addSubGraphSessionStates(s,l),o.endSessionState(s)}}n.SessionState=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={}),(e=>{let t;(i=>{let r;(n=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsInferenceSession(s,c){return(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsInferenceSession(s,c){return s.setPosition(s.position()+oe.SIZE_PREFIX_LENGTH),(c||new o).__init(s.readInt32(s.position())+s.position(),s)}static bufferHasIdentifier(s){return s.__has_identifier("ORTM")}ortVersion(s){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,s):null}model(s){let c=this.bb.__offset(this.bb_pos,6);return c?(s||new e.experimental.fbs.Model).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}sessionState(s){let c=this.bb.__offset(this.bb_pos,8);return c?(s||new e.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startInferenceSession(s){s.startObject(3)}static addOrtVersion(s,c){s.addFieldOffset(0,c,0)}static addModel(s,c){s.addFieldOffset(1,c,0)}static addSessionState(s,c){s.addFieldOffset(2,c,0)}static endInferenceSession(s){return s.endObject()}static finishInferenceSessionBuffer(s,c){s.finish(c,"ORTM")}static finishSizePrefixedInferenceSessionBuffer(s,c){s.finish(c,"ORTM",!0)}static createInferenceSession(s,c,l,d){return o.startInferenceSession(s),o.addOrtVersion(s,c),o.addModel(s,l),o.addSessionState(s,d),o.endInferenceSession(s)}}n.InferenceSession=o})(r=i.fbs||={})})(t=e.experimental||={})})(_r||={})}),yEe=Fn((e,t)=>{"use strict";t.exports=i;function i(r,n){for(var o=new Array(arguments.length-1),a=0,s=2,c=!0;s<arguments.length;)o[a++]=arguments[s++];return new Promise(function(l,d){o[a]=function(u){if(c)if(c=!1,u)d(u);else{for(var h=new Array(arguments.length-1),p=0;p<h.length;)h[p++]=arguments[p];l.apply(null,h)}};try{r.apply(n||null,o)}catch(u){c&&(c=!1,d(u))}})}}),xEe=Fn(e=>{"use strict";var t=e;t.length=function(a){var s=a.length;if(!s)return 0;for(var c=0;--s%4>1&&a.charAt(s)==="=";)++c;return Math.ceil(a.length*3)/4-c};var i=new Array(64),r=new Array(123);for(n=0;n<64;)r[i[n]=n<26?n+65:n<52?n+71:n<62?n-4:n-59|43]=n++;var n;t.encode=function(a,s,c){for(var l=null,d=[],u=0,h=0,p;s<c;){var m=a[s++];switch(h){case 0:d[u++]=i[m>>2],p=(m&3)<<4,h=1;break;case 1:d[u++]=i[p|m>>4],p=(m&15)<<2,h=2;break;case 2:d[u++]=i[p|m>>6],d[u++]=i[m&63],h=0;break}u>8191&&((l||(l=[])).push(String.fromCharCode.apply(String,d)),u=0)}return h&&(d[u++]=i[p],d[u++]=61,h===1&&(d[u++]=61)),l?(u&&l.push(String.fromCharCode.apply(String,d.slice(0,u))),l.join("")):String.fromCharCode.apply(String,d.slice(0,u))};var o="invalid encoding";t.decode=function(a,s,c){for(var l=c,d=0,u,h=0;h<a.length;){var p=a.charCodeAt(h++);if(p===61&&d>1)break;if((p=r[p])===void 0)throw Error(o);switch(d){case 0:u=p,d=1;break;case 1:s[c++]=u<<2|(p&48)>>4,u=p,d=2;break;case 2:s[c++]=(u&15)<<4|(p&60)>>2,u=p,d=3;break;case 3:s[c++]=(u&3)<<6|p,d=0;break}}if(d===1)throw Error(o);return c-l},t.test=function(a){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(a)}}),wEe=Fn((e,t)=>{"use strict";t.exports=i;function i(){this._listeners={}}i.prototype.on=function(r,n,o){return(this._listeners[r]||(this._listeners[r]=[])).push({fn:n,ctx:o||this}),this},i.prototype.off=function(r,n){if(r===void 0)this._listeners={};else if(n===void 0)this._listeners[r]=[];else for(var o=this._listeners[r],a=0;a<o.length;)o[a].fn===n?o.splice(a,1):++a;return this},i.prototype.emit=function(r){var n=this._listeners[r];if(n){for(var o=[],a=1;a<arguments.length;)o.push(arguments[a++]);for(a=0;a<n.length;)n[a].fn.apply(n[a++].ctx,o)}return this}}),EEe=Fn((e,t)=>{"use strict";t.exports=i(i);function i(s){return typeof Float32Array<"u"?function(){var c=new Float32Array([-0]),l=new Uint8Array(c.buffer),d=l[3]===128;function u(f,g,v){c[0]=f,g[v]=l[0],g[v+1]=l[1],g[v+2]=l[2],g[v+3]=l[3]}function h(f,g,v){c[0]=f,g[v]=l[3],g[v+1]=l[2],g[v+2]=l[1],g[v+3]=l[0]}s.writeFloatLE=d?u:h,s.writeFloatBE=d?h:u;function p(f,g){return l[0]=f[g],l[1]=f[g+1],l[2]=f[g+2],l[3]=f[g+3],c[0]}function m(f,g){return l[3]=f[g],l[2]=f[g+1],l[1]=f[g+2],l[0]=f[g+3],c[0]}s.readFloatLE=d?p:m,s.readFloatBE=d?m:p}():function(){function c(d,u,h,p){var m=u<0?1:0;if(m&&(u=-u),u===0)d(1/u>0?0:2147483648,h,p);else if(isNaN(u))d(2143289344,h,p);else if(u>34028234663852886e22)d((m<<31|2139095040)>>>0,h,p);else if(u<11754943508222875e-54)d((m<<31|Math.round(u/1401298464324817e-60))>>>0,h,p);else{var f=Math.floor(Math.log(u)/Math.LN2),g=Math.round(u*Math.pow(2,-f)*8388608)&8388607;d((m<<31|f+127<<23|g)>>>0,h,p)}}s.writeFloatLE=c.bind(null,r),s.writeFloatBE=c.bind(null,n);function l(d,u,h){var p=d(u,h),m=(p>>31)*2+1,f=p>>>23&255,g=p&8388607;return f===255?g?NaN:m*(1/0):f===0?m*1401298464324817e-60*g:m*Math.pow(2,f-150)*(g+8388608)}s.readFloatLE=l.bind(null,o),s.readFloatBE=l.bind(null,a)}(),typeof Float64Array<"u"?function(){var c=new Float64Array([-0]),l=new Uint8Array(c.buffer),d=l[7]===128;function u(f,g,v){c[0]=f,g[v]=l[0],g[v+1]=l[1],g[v+2]=l[2],g[v+3]=l[3],g[v+4]=l[4],g[v+5]=l[5],g[v+6]=l[6],g[v+7]=l[7]}function h(f,g,v){c[0]=f,g[v]=l[7],g[v+1]=l[6],g[v+2]=l[5],g[v+3]=l[4],g[v+4]=l[3],g[v+5]=l[2],g[v+6]=l[1],g[v+7]=l[0]}s.writeDoubleLE=d?u:h,s.writeDoubleBE=d?h:u;function p(f,g){return l[0]=f[g],l[1]=f[g+1],l[2]=f[g+2],l[3]=f[g+3],l[4]=f[g+4],l[5]=f[g+5],l[6]=f[g+6],l[7]=f[g+7],c[0]}function m(f,g){return l[7]=f[g],l[6]=f[g+1],l[5]=f[g+2],l[4]=f[g+3],l[3]=f[g+4],l[2]=f[g+5],l[1]=f[g+6],l[0]=f[g+7],c[0]}s.readDoubleLE=d?p:m,s.readDoubleBE=d?m:p}():function(){function c(d,u,h,p,m,f){var g=p<0?1:0;if(g&&(p=-p),p===0)d(0,m,f+u),d(1/p>0?0:2147483648,m,f+h);else if(isNaN(p))d(0,m,f+u),d(2146959360,m,f+h);else if(p>17976931348623157e292)d(0,m,f+u),d((g<<31|2146435072)>>>0,m,f+h);else{var v;if(p<22250738585072014e-324)v=p/5e-324,d(v>>>0,m,f+u),d((g<<31|v/4294967296)>>>0,m,f+h);else{var _=Math.floor(Math.log(p)/Math.LN2);_===1024&&(_=1023),v=p*Math.pow(2,-_),d(v*4503599627370496>>>0,m,f+u),d((g<<31|_+1023<<20|v*1048576&1048575)>>>0,m,f+h)}}}s.writeDoubleLE=c.bind(null,r,0,4),s.writeDoubleBE=c.bind(null,n,4,0);function l(d,u,h,p,m){var f=d(p,m+u),g=d(p,m+h),v=(g>>31)*2+1,_=g>>>20&2047,b=4294967296*(g&1048575)+f;return _===2047?b?NaN:v*(1/0):_===0?v*5e-324*b:v*Math.pow(2,_-1075)*(b+4503599627370496)}s.readDoubleLE=l.bind(null,o,0,4),s.readDoubleBE=l.bind(null,a,4,0)}(),s}function r(s,c,l){c[l]=s&255,c[l+1]=s>>>8&255,c[l+2]=s>>>16&255,c[l+3]=s>>>24}function n(s,c,l){c[l]=s>>>24,c[l+1]=s>>>16&255,c[l+2]=s>>>8&255,c[l+3]=s&255}function o(s,c){return(s[c]|s[c+1]<<8|s[c+2]<<16|s[c+3]<<24)>>>0}function a(s,c){return(s[c]<<24|s[c+1]<<16|s[c+2]<<8|s[c+3])>>>0}}),CEe=Fn((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}}),SEe=Fn(e=>{"use strict";var t=e;t.length=function(i){for(var r=0,n=0,o=0;o<i.length;++o)n=i.charCodeAt(o),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(i.charCodeAt(o+1)&64512)===56320?(++o,r+=4):r+=3;return r},t.read=function(i,r,n){var o=n-r;if(o<1)return"";for(var a=null,s=[],c=0,l;r<n;)l=i[r++],l<128?s[c++]=l:l>191&&l<224?s[c++]=(l&31)<<6|i[r++]&63:l>239&&l<365?(l=((l&7)<<18|(i[r++]&63)<<12|(i[r++]&63)<<6|i[r++]&63)-65536,s[c++]=55296+(l>>10),s[c++]=56320+(l&1023)):s[c++]=(l&15)<<12|(i[r++]&63)<<6|i[r++]&63,c>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,s)),c=0);return a?(c&&a.push(String.fromCharCode.apply(String,s.slice(0,c))),a.join("")):String.fromCharCode.apply(String,s.slice(0,c))},t.write=function(i,r,n){for(var o=n,a,s,c=0;c<i.length;++c)a=i.charCodeAt(c),a<128?r[n++]=a:a<2048?(r[n++]=a>>6|192,r[n++]=a&63|128):(a&64512)===55296&&((s=i.charCodeAt(c+1))&64512)===56320?(a=65536+((a&1023)<<10)+(s&1023),++c,r[n++]=a>>18|240,r[n++]=a>>12&63|128,r[n++]=a>>6&63|128,r[n++]=a&63|128):(r[n++]=a>>12|224,r[n++]=a>>6&63|128,r[n++]=a&63|128);return n-o}}),TEe=Fn((e,t)=>{"use strict";t.exports=i;function i(r,n,o){var a=o||8192,s=a>>>1,c=null,l=a;return function(d){if(d<1||d>s)return r(d);l+d>a&&(c=r(a),l=0);var u=n.call(c,l,l+=d);return l&7&&(l=(l|7)+1),u}}}),AEe=Fn((e,t)=>{"use strict";t.exports=r;var i=Lp();function r(s,c){this.lo=s>>>0,this.hi=c>>>0}var n=r.zero=new r(0,0);n.toNumber=function(){return 0},n.zzEncode=n.zzDecode=function(){return this},n.length=function(){return 1};var o=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(s){if(s===0)return n;var c=s<0;c&&(s=-s);var l=s>>>0,d=(s-l)/4294967296>>>0;return c&&(d=~d>>>0,l=~l>>>0,++l>4294967295&&(l=0,++d>4294967295&&(d=0))),new r(l,d)},r.from=function(s){if(typeof s=="number")return r.fromNumber(s);if(i.isString(s))if(i.Long)s=i.Long.fromString(s);else return r.fromNumber(parseInt(s,10));return s.low||s.high?new r(s.low>>>0,s.high>>>0):n},r.prototype.toNumber=function(s){if(!s&&this.hi>>>31){var c=~this.lo+1>>>0,l=~this.hi>>>0;return c||(l=l+1>>>0),-(c+l*4294967296)}return this.lo+this.hi*4294967296},r.prototype.toLong=function(s){return i.Long?new i.Long(this.lo|0,this.hi|0,!!s):{low:this.lo|0,high:this.hi|0,unsigned:!!s}};var a=String.prototype.charCodeAt;r.fromHash=function(s){return s===o?n:new r((a.call(s,0)|a.call(s,1)<<8|a.call(s,2)<<16|a.call(s,3)<<24)>>>0,(a.call(s,4)|a.call(s,5)<<8|a.call(s,6)<<16|a.call(s,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var s=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^s)>>>0,this.lo=(this.lo<<1^s)>>>0,this},r.prototype.zzDecode=function(){var s=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^s)>>>0,this.hi=(this.hi>>>1^s)>>>0,this},r.prototype.length=function(){var s=this.lo,c=(this.lo>>>28|this.hi<<4)>>>0,l=this.hi>>>24;return l===0?c===0?s<16384?s<128?1:2:s<2097152?3:4:c<16384?c<128?5:6:c<2097152?7:8:l<128?9:10}}),Lp=Fn(e=>{"use strict";var t=e;t.asPromise=yEe(),t.base64=xEe(),t.EventEmitter=wEe(),t.float=EEe(),t.inquire=CEe(),t.utf8=SEe(),t.pool=TEe(),t.LongBits=AEe(),t.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node),t.global=t.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||e,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(n){return typeof n=="number"&&isFinite(n)&&Math.floor(n)===n},t.isString=function(n){return typeof n=="string"||n instanceof String},t.isObject=function(n){return n&&typeof n=="object"},t.isset=t.isSet=function(n,o){var a=n[o];return a!=null&&n.hasOwnProperty(o)?typeof a!="object"||(Array.isArray(a)?a.length:Object.keys(a).length)>0:!1},t.Buffer=function(){try{var n=t.inquire("buffer").Buffer;return n.prototype.utf8Write?n:null}catch{return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(n){return typeof n=="number"?t.Buffer?t._Buffer_allocUnsafe(n):new t.Array(n):t.Buffer?t._Buffer_from(n):typeof Uint8Array>"u"?n:new Uint8Array(n)},t.Array=typeof Uint8Array<"u"?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(n){return n?t.LongBits.from(n).toHash():t.LongBits.zeroHash},t.longFromHash=function(n,o){var a=t.LongBits.fromHash(n);return t.Long?t.Long.fromBits(a.lo,a.hi,o):a.toNumber(!!o)};function i(n,o,a){for(var s=Object.keys(o),c=0;c<s.length;++c)(n[s[c]]===void 0||!a)&&(n[s[c]]=o[s[c]]);return n}t.merge=i,t.lcFirst=function(n){return n.charAt(0).toLowerCase()+n.substring(1)};function r(n){function o(a,s){if(!(this instanceof o))return new o(a,s);Object.defineProperty(this,"message",{get:function(){return a}}),Error.captureStackTrace?Error.captureStackTrace(this,o):Object.defineProperty(this,"stack",{value:new Error().stack||""}),s&&i(this,s)}return o.prototype=Object.create(Error.prototype,{constructor:{value:o,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return n},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),o}t.newError=r,t.ProtocolError=r("ProtocolError"),t.oneOfGetter=function(n){for(var o={},a=0;a<n.length;++a)o[n[a]]=1;return function(){for(var s=Object.keys(this),c=s.length-1;c>-1;--c)if(o[s[c]]===1&&this[s[c]]!==void 0&&this[s[c]]!==null)return s[c]}},t.oneOfSetter=function(n){return function(o){for(var a=0;a<n.length;++a)n[a]!==o&&delete this[n[a]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var n=t.Buffer;if(!n){t._Buffer_from=t._Buffer_allocUnsafe=null;return}t._Buffer_from=n.from!==Uint8Array.from&&n.from||function(o,a){return new n(o,a)},t._Buffer_allocUnsafe=n.allocUnsafe||function(o){return new n(o)}}}),DX=Fn((e,t)=>{"use strict";t.exports=d;var i=Lp(),r,n=i.LongBits,o=i.base64,a=i.utf8;function s(_,b,y){this.fn=_,this.len=b,this.next=void 0,this.val=y}function c(){}function l(_){this.head=_.head,this.tail=_.tail,this.len=_.len,this.next=_.states}function d(){this.len=0,this.head=new s(c,0,0),this.tail=this.head,this.states=null}var u=function(){return i.Buffer?function(){return(d.create=function(){return new r})()}:function(){return new d}};d.create=u(),d.alloc=function(_){return new i.Array(_)},i.Array!==Array&&(d.alloc=i.pool(d.alloc,i.Array.prototype.subarray)),d.prototype._push=function(_,b,y){return this.tail=this.tail.next=new s(_,b,y),this.len+=b,this};function h(_,b,y){b[y]=_&255}function p(_,b,y){for(;_>127;)b[y++]=_&127|128,_>>>=7;b[y]=_}function m(_,b){this.len=_,this.next=void 0,this.val=b}m.prototype=Object.create(s.prototype),m.prototype.fn=p,d.prototype.uint32=function(_){return this.len+=(this.tail=this.tail.next=new m((_=_>>>0)<128?1:_<16384?2:_<2097152?3:_<268435456?4:5,_)).len,this},d.prototype.int32=function(_){return _<0?this._push(f,10,n.fromNumber(_)):this.uint32(_)},d.prototype.sint32=function(_){return this.uint32((_<<1^_>>31)>>>0)};function f(_,b,y){for(;_.hi;)b[y++]=_.lo&127|128,_.lo=(_.lo>>>7|_.hi<<25)>>>0,_.hi>>>=7;for(;_.lo>127;)b[y++]=_.lo&127|128,_.lo=_.lo>>>7;b[y++]=_.lo}d.prototype.uint64=function(_){var b=n.from(_);return this._push(f,b.length(),b)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(_){var b=n.from(_).zzEncode();return this._push(f,b.length(),b)},d.prototype.bool=function(_){return this._push(h,1,_?1:0)};function g(_,b,y){b[y]=_&255,b[y+1]=_>>>8&255,b[y+2]=_>>>16&255,b[y+3]=_>>>24}d.prototype.fixed32=function(_){return this._push(g,4,_>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(_){var b=n.from(_);return this._push(g,4,b.lo)._push(g,4,b.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(_){return this._push(i.float.writeFloatLE,4,_)},d.prototype.double=function(_){return this._push(i.float.writeDoubleLE,8,_)};var v=i.Array.prototype.set?function(_,b,y){b.set(_,y)}:function(_,b,y){for(var x=0;x<_.length;++x)b[y+x]=_[x]};d.prototype.bytes=function(_){var b=_.length>>>0;if(!b)return this._push(h,1,0);if(i.isString(_)){var y=d.alloc(b=o.length(_));o.decode(_,y,0),_=y}return this.uint32(b)._push(v,b,_)},d.prototype.string=function(_){var b=a.length(_);return b?this.uint32(b)._push(a.write,b,_):this._push(h,1,0)},d.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new s(c,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new s(c,0,0),this.len=0),this},d.prototype.ldelim=function(){var _=this.head,b=this.tail,y=this.len;return this.reset().uint32(y),y&&(this.tail.next=_.next,this.tail=b,this.len+=y),this},d.prototype.finish=function(){for(var _=this.head.next,b=this.constructor.alloc(this.len),y=0;_;)_.fn(_.val,b,y),y+=_.len,_=_.next;return b},d._configure=function(_){r=_,d.create=u(),r._configure()}}),DEe=Fn((e,t)=>{"use strict";t.exports=n;var i=DX();(n.prototype=Object.create(i.prototype)).constructor=n;var r=Lp();function n(){i.call(this)}n._configure=function(){n.alloc=r._Buffer_allocUnsafe,n.writeBytesBuffer=r.Buffer&&r.Buffer.prototype instanceof Uint8Array&&r.Buffer.prototype.set.name==="set"?function(a,s,c){s.set(a,c)}:function(a,s,c){if(a.copy)a.copy(s,c,0,a.length);else for(var l=0;l<a.length;)s[c++]=a[l++]}},n.prototype.bytes=function(a){r.isString(a)&&(a=r._Buffer_from(a,"base64"));var s=a.length>>>0;return this.uint32(s),s&&this._push(n.writeBytesBuffer,s,a),this};function o(a,s,c){a.length<40?r.utf8.write(a,s,c):s.utf8Write?s.utf8Write(a,c):s.write(a,c)}n.prototype.string=function(a){var s=r.Buffer.byteLength(a);return this.uint32(s),s&&this._push(o,s,a),this},n._configure()}),IX=Fn((e,t)=>{"use strict";t.exports=s;var i=Lp(),r,n=i.LongBits,o=i.utf8;function a(p,m){return RangeError("index out of range: "+p.pos+" + "+(m||1)+" > "+p.len)}function s(p){this.buf=p,this.pos=0,this.len=p.length}var c=typeof Uint8Array<"u"?function(p){if(p instanceof Uint8Array||Array.isArray(p))return new s(p);throw Error("illegal buffer")}:function(p){if(Array.isArray(p))return new s(p);throw Error("illegal buffer")},l=function(){return i.Buffer?function(p){return(s.create=function(m){return i.Buffer.isBuffer(m)?new r(m):c(m)})(p)}:c};s.create=l(),s.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,s.prototype.uint32=function(){var p=4294967295;return function(){if(p=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(p=(p|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(p=(p|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(p=(p|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(p=(p|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return p;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return p}}(),s.prototype.int32=function(){return this.uint32()|0},s.prototype.sint32=function(){var p=this.uint32();return p>>>1^-(p&1)|0};function d(){var p=new n(0,0),m=0;if(this.len-this.pos>4){for(;m<4;++m)if(p.lo=(p.lo|(this.buf[this.pos]&127)<<m*7)>>>0,this.buf[this.pos++]<128)return p;if(p.lo=(p.lo|(this.buf[this.pos]&127)<<28)>>>0,p.hi=(p.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return p;m=0}else{for(;m<3;++m){if(this.pos>=this.len)throw a(this);if(p.lo=(p.lo|(this.buf[this.pos]&127)<<m*7)>>>0,this.buf[this.pos++]<128)return p}return p.lo=(p.lo|(this.buf[this.pos++]&127)<<m*7)>>>0,p}if(this.len-this.pos>4){for(;m<5;++m)if(p.hi=(p.hi|(this.buf[this.pos]&127)<<m*7+3)>>>0,this.buf[this.pos++]<128)return p}else for(;m<5;++m){if(this.pos>=this.len)throw a(this);if(p.hi=(p.hi|(this.buf[this.pos]&127)<<m*7+3)>>>0,this.buf[this.pos++]<128)return p}throw Error("invalid varint encoding")}s.prototype.bool=function(){return this.uint32()!==0};function u(p,m){return(p[m-4]|p[m-3]<<8|p[m-2]<<16|p[m-1]<<24)>>>0}s.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return u(this.buf,this.pos+=4)},s.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return u(this.buf,this.pos+=4)|0};function h(){if(this.pos+8>this.len)throw a(this,8);return new n(u(this.buf,this.pos+=4),u(this.buf,this.pos+=4))}s.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var p=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,p},s.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var p=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,p},s.prototype.bytes=function(){var p=this.uint32(),m=this.pos,f=this.pos+p;if(f>this.len)throw a(this,p);if(this.pos+=p,Array.isArray(this.buf))return this.buf.slice(m,f);if(m===f){var g=i.Buffer;return g?g.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,m,f)},s.prototype.string=function(){var p=this.bytes();return o.read(p,0,p.length)},s.prototype.skip=function(p){if(typeof p=="number"){if(this.pos+p>this.len)throw a(this,p);this.pos+=p}else do if(this.pos>=this.len)throw a(this);while(this.buf[this.pos++]&128);return this},s.prototype.skipType=function(p){switch(p){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(p=this.uint32()&7)!==4;)this.skipType(p);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+p+" at offset "+this.pos)}return this},s._configure=function(p){r=p,s.create=l(),r._configure();var m=i.Long?"toLong":"toNumber";i.merge(s.prototype,{int64:function(){return d.call(this)[m](!1)},uint64:function(){return d.call(this)[m](!0)},sint64:function(){return d.call(this).zzDecode()[m](!1)},fixed64:function(){return h.call(this)[m](!0)},sfixed64:function(){return h.call(this)[m](!1)}})}}),IEe=Fn((e,t)=>{"use strict";t.exports=n;var i=IX();(n.prototype=Object.create(i.prototype)).constructor=n;var r=Lp();function n(o){i.call(this,o)}n._configure=function(){r.Buffer&&(n.prototype._slice=r.Buffer.prototype.slice)},n.prototype.string=function(){var o=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+o,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+o,this.len))},n._configure()}),MEe=Fn((e,t)=>{"use strict";t.exports=r;var i=Lp();(r.prototype=Object.create(i.EventEmitter.prototype)).constructor=r;function r(n,o,a){if(typeof n!="function")throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=n,this.requestDelimited=!!o,this.responseDelimited=!!a}r.prototype.rpcCall=function n(o,a,s,c,l){if(!c)throw TypeError("request must be specified");var d=this;if(!l)return i.asPromise(n,d,o,a,s,c);if(!d.rpcImpl){setTimeout(function(){l(Error("already ended"))},0);return}try{return d.rpcImpl(o,a[d.requestDelimited?"encodeDelimited":"encode"](c).finish(),function(u,h){if(u)return d.emit("error",u,o),l(u);if(h===null){d.end(!0);return}if(!(h instanceof s))try{h=s[d.responseDelimited?"decodeDelimited":"decode"](h)}catch(p){return d.emit("error",p,o),l(p)}return d.emit("data",h,o),l(null,h)})}catch(u){d.emit("error",u,o),setTimeout(function(){l(u)},0);return}},r.prototype.end=function(n){return this.rpcImpl&&(n||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}}),kEe=Fn(e=>{"use strict";var t=e;t.Service=MEe()}),PEe=Fn((e,t)=>{"use strict";t.exports={}}),NEe=Fn(e=>{"use strict";var t=e;t.build="minimal",t.Writer=DX(),t.BufferWriter=DEe(),t.Reader=IX(),t.BufferReader=IEe(),t.util=Lp(),t.rpc=kEe(),t.roots=PEe(),t.configure=i;function i(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}i()}),OEe=Fn((e,t)=>{"use strict";t.exports=NEe()}),ab=Fn((e,t)=>{"use strict";var i=OEe(),r=i.Reader,n=i.Writer,o=i.util,a=i.roots.default||(i.roots.default={});a.onnx=function(){var s={};return s.Version=function(){var c={},l=Object.create(c);return l[c[0]="_START_VERSION"]=0,l[c[1]="IR_VERSION_2017_10_10"]=1,l[c[2]="IR_VERSION_2017_10_30"]=2,l[c[3]="IR_VERSION_2017_11_3"]=3,l[c[4]="IR_VERSION_2019_1_22"]=4,l[c[5]="IR_VERSION_2019_3_18"]=5,l[c[6]="IR_VERSION_2019_9_19"]=6,l[c[7]="IR_VERSION_2020_5_8"]=7,l[c[8]="IR_VERSION_2021_7_30"]=8,l[c[9]="IR_VERSION"]=9,l}(),s.AttributeProto=function(){function c(l){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],this.sparseTensors=[],this.typeProtos=[],l)for(var d=Object.keys(l),u=0;u<d.length;++u)l[d[u]]!=null&&(this[d[u]]=l[d[u]])}return c.prototype.name="",c.prototype.refAttrName="",c.prototype.docString="",c.prototype.type=0,c.prototype.f=0,c.prototype.i=o.Long?o.Long.fromBits(0,0,!1):0,c.prototype.s=o.newBuffer([]),c.prototype.t=null,c.prototype.g=null,c.prototype.sparseTensor=null,c.prototype.tp=null,c.prototype.floats=o.emptyArray,c.prototype.ints=o.emptyArray,c.prototype.strings=o.emptyArray,c.prototype.tensors=o.emptyArray,c.prototype.graphs=o.emptyArray,c.prototype.sparseTensors=o.emptyArray,c.prototype.typeProtos=o.emptyArray,c.create=function(l){return new c(l)},c.encode=function(l,d){if(d||(d=n.create()),l.name!=null&&Object.hasOwnProperty.call(l,"name")&&d.uint32(10).string(l.name),l.f!=null&&Object.hasOwnProperty.call(l,"f")&&d.uint32(21).float(l.f),l.i!=null&&Object.hasOwnProperty.call(l,"i")&&d.uint32(24).int64(l.i),l.s!=null&&Object.hasOwnProperty.call(l,"s")&&d.uint32(34).bytes(l.s),l.t!=null&&Object.hasOwnProperty.call(l,"t")&&a.onnx.TensorProto.encode(l.t,d.uint32(42).fork()).ldelim(),l.g!=null&&Object.hasOwnProperty.call(l,"g")&&a.onnx.GraphProto.encode(l.g,d.uint32(50).fork()).ldelim(),l.floats!=null&&l.floats.length){d.uint32(58).fork();for(var u=0;u<l.floats.length;++u)d.float(l.floats[u]);d.ldelim()}if(l.ints!=null&&l.ints.length){d.uint32(66).fork();for(var u=0;u<l.ints.length;++u)d.int64(l.ints[u]);d.ldelim()}if(l.strings!=null&&l.strings.length)for(var u=0;u<l.strings.length;++u)d.uint32(74).bytes(l.strings[u]);if(l.tensors!=null&&l.tensors.length)for(var u=0;u<l.tensors.length;++u)a.onnx.TensorProto.encode(l.tensors[u],d.uint32(82).fork()).ldelim();if(l.graphs!=null&&l.graphs.length)for(var u=0;u<l.graphs.length;++u)a.onnx.GraphProto.encode(l.graphs[u],d.uint32(90).fork()).ldelim();if(l.docString!=null&&Object.hasOwnProperty.call(l,"docString")&&d.uint32(106).string(l.docString),l.tp!=null&&Object.hasOwnProperty.call(l,"tp")&&a.onnx.TypeProto.encode(l.tp,d.uint32(114).fork()).ldelim(),l.typeProtos!=null&&l.typeProtos.length)for(var u=0;u<l.typeProtos.length;++u)a.onnx.TypeProto.encode(l.typeProtos[u],d.uint32(122).fork()).ldelim();if(l.type!=null&&Object.hasOwnProperty.call(l,"type")&&d.uint32(160).int32(l.type),l.refAttrName!=null&&Object.hasOwnProperty.call(l,"refAttrName")&&d.uint32(170).string(l.refAttrName),l.sparseTensor!=null&&Object.hasOwnProperty.call(l,"sparseTensor")&&a.onnx.SparseTensorProto.encode(l.sparseTensor,d.uint32(178).fork()).ldelim(),l.sparseTensors!=null&&l.sparseTensors.length)for(var u=0;u<l.sparseTensors.length;++u)a.onnx.SparseTensorProto.encode(l.sparseTensors[u],d.uint32(186).fork()).ldelim();return d},c.encodeDelimited=function(l,d){return this.encode(l,d).ldelim()},c.decode=function(l,d){l instanceof r||(l=r.create(l));for(var u=d===void 0?l.len:l.pos+d,h=new a.onnx.AttributeProto;l.pos<u;){var p=l.uint32();switch(p>>>3){case 1:{h.name=l.string();break}case 21:{h.refAttrName=l.string();break}case 13:{h.docString=l.string();break}case 20:{h.type=l.int32();break}case 2:{h.f=l.float();break}case 3:{h.i=l.int64();break}case 4:{h.s=l.bytes();break}case 5:{h.t=a.onnx.TensorProto.decode(l,l.uint32());break}case 6:{h.g=a.onnx.GraphProto.decode(l,l.uint32());break}case 22:{h.sparseTensor=a.onnx.SparseTensorProto.decode(l,l.uint32());break}case 14:{h.tp=a.onnx.TypeProto.decode(l,l.uint32());break}case 7:{if(h.floats&&h.floats.length||(h.floats=[]),(p&7)===2)for(var m=l.uint32()+l.pos;l.pos<m;)h.floats.push(l.float());else h.floats.push(l.float());break}case 8:{if(h.ints&&h.ints.length||(h.ints=[]),(p&7)===2)for(var m=l.uint32()+l.pos;l.pos<m;)h.ints.push(l.int64());else h.ints.push(l.int64());break}case 9:{h.strings&&h.strings.length||(h.strings=[]),h.strings.push(l.bytes());break}case 10:{h.tensors&&h.tensors.length||(h.tensors=[]),h.tensors.push(a.onnx.TensorProto.decode(l,l.uint32()));break}case 11:{h.graphs&&h.graphs.length||(h.graphs=[]),h.graphs.push(a.onnx.GraphProto.decode(l,l.uint32()));break}case 23:{h.sparseTensors&&h.sparseTensors.length||(h.sparseTensors=[]),h.sparseTensors.push(a.onnx.SparseTensorProto.decode(l,l.uint32()));break}case 15:{h.typeProtos&&h.typeProtos.length||(h.typeProtos=[]),h.typeProtos.push(a.onnx.TypeProto.decode(l,l.uint32()));break}default:l.skipType(p&7);break}}return h},c.decodeDelimited=function(l){return l instanceof r||(l=new r(l)),this.decode(l,l.uint32())},c.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.name!=null&&l.hasOwnProperty("name")&&!o.isString(l.name))return"name: string expected";if(l.refAttrName!=null&&l.hasOwnProperty("refAttrName")&&!o.isString(l.refAttrName))return"refAttrName: string expected";if(l.docString!=null&&l.hasOwnProperty("docString")&&!o.isString(l.docString))return"docString: string expected";if(l.type!=null&&l.hasOwnProperty("type"))switch(l.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 11:case 13:case 6:case 7:case 8:case 9:case 10:case 12:case 14:break}if(l.f!=null&&l.hasOwnProperty("f")&&typeof l.f!="number")return"f: number expected";if(l.i!=null&&l.hasOwnProperty("i")&&!o.isInteger(l.i)&&!(l.i&&o.isInteger(l.i.low)&&o.isInteger(l.i.high)))return"i: integer|Long expected";if(l.s!=null&&l.hasOwnProperty("s")&&!(l.s&&typeof l.s.length=="number"||o.isString(l.s)))return"s: buffer expected";if(l.t!=null&&l.hasOwnProperty("t")){var d=a.onnx.TensorProto.verify(l.t);if(d)return"t."+d}if(l.g!=null&&l.hasOwnProperty("g")){var d=a.onnx.GraphProto.verify(l.g);if(d)return"g."+d}if(l.sparseTensor!=null&&l.hasOwnProperty("sparseTensor")){var d=a.onnx.SparseTensorProto.verify(l.sparseTensor);if(d)return"sparseTensor."+d}if(l.tp!=null&&l.hasOwnProperty("tp")){var d=a.onnx.TypeProto.verify(l.tp);if(d)return"tp."+d}if(l.floats!=null&&l.hasOwnProperty("floats")){if(!Array.isArray(l.floats))return"floats: array expected";for(var u=0;u<l.floats.length;++u)if(typeof l.floats[u]!="number")return"floats: number[] expected"}if(l.ints!=null&&l.hasOwnProperty("ints")){if(!Array.isArray(l.ints))return"ints: array expected";for(var u=0;u<l.ints.length;++u)if(!o.isInteger(l.ints[u])&&!(l.ints[u]&&o.isInteger(l.ints[u].low)&&o.isInteger(l.ints[u].high)))return"ints: integer|Long[] expected"}if(l.strings!=null&&l.hasOwnProperty("strings")){if(!Array.isArray(l.strings))return"strings: array expected";for(var u=0;u<l.strings.length;++u)if(!(l.strings[u]&&typeof l.strings[u].length=="number"||o.isString(l.strings[u])))return"strings: buffer[] expected"}if(l.tensors!=null&&l.hasOwnProperty("tensors")){if(!Array.isArray(l.tensors))return"tensors: array expected";for(var u=0;u<l.tensors.length;++u){var d=a.onnx.TensorProto.verify(l.tensors[u]);if(d)return"tensors."+d}}if(l.graphs!=null&&l.hasOwnProperty("graphs")){if(!Array.isArray(l.graphs))return"graphs: array expected";for(var u=0;u<l.graphs.length;++u){var d=a.onnx.GraphProto.verify(l.graphs[u]);if(d)return"graphs."+d}}if(l.sparseTensors!=null&&l.hasOwnProperty("sparseTensors")){if(!Array.isArray(l.sparseTensors))return"sparseTensors: array expected";for(var u=0;u<l.sparseTensors.length;++u){var d=a.onnx.SparseTensorProto.verify(l.sparseTensors[u]);if(d)return"sparseTensors."+d}}if(l.typeProtos!=null&&l.hasOwnProperty("typeProtos")){if(!Array.isArray(l.typeProtos))return"typeProtos: array expected";for(var u=0;u<l.typeProtos.length;++u){var d=a.onnx.TypeProto.verify(l.typeProtos[u]);if(d)return"typeProtos."+d}}return null},c.fromObject=function(l){if(l instanceof a.onnx.AttributeProto)return l;var d=new a.onnx.AttributeProto;switch(l.name!=null&&(d.name=String(l.name)),l.refAttrName!=null&&(d.refAttrName=String(l.refAttrName)),l.docString!=null&&(d.docString=String(l.docString)),l.type){default:if(typeof l.type=="number"){d.type=l.type;break}break;case"UNDEFINED":case 0:d.type=0;break;case"FLOAT":case 1:d.type=1;break;case"INT":case 2:d.type=2;break;case"STRING":case 3:d.type=3;break;case"TENSOR":case 4:d.type=4;break;case"GRAPH":case 5:d.type=5;break;case"SPARSE_TENSOR":case 11:d.type=11;break;case"TYPE_PROTO":case 13:d.type=13;break;case"FLOATS":case 6:d.type=6;break;case"INTS":case 7:d.type=7;break;case"STRINGS":case 8:d.type=8;break;case"TENSORS":case 9:d.type=9;break;case"GRAPHS":case 10:d.type=10;break;case"SPARSE_TENSORS":case 12:d.type=12;break;case"TYPE_PROTOS":case 14:d.type=14;break}if(l.f!=null&&(d.f=Number(l.f)),l.i!=null&&(o.Long?(d.i=o.Long.fromValue(l.i)).unsigned=!1:typeof l.i=="string"?d.i=parseInt(l.i,10):typeof l.i=="number"?d.i=l.i:typeof l.i=="object"&&(d.i=new o.LongBits(l.i.low>>>0,l.i.high>>>0).toNumber())),l.s!=null&&(typeof l.s=="string"?o.base64.decode(l.s,d.s=o.newBuffer(o.base64.length(l.s)),0):l.s.length>=0&&(d.s=l.s)),l.t!=null){if(typeof l.t!="object")throw TypeError(".onnx.AttributeProto.t: object expected");d.t=a.onnx.TensorProto.fromObject(l.t)}if(l.g!=null){if(typeof l.g!="object")throw TypeError(".onnx.AttributeProto.g: object expected");d.g=a.onnx.GraphProto.fromObject(l.g)}if(l.sparseTensor!=null){if(typeof l.sparseTensor!="object")throw TypeError(".onnx.AttributeProto.sparseTensor: object expected");d.sparseTensor=a.onnx.SparseTensorProto.fromObject(l.sparseTensor)}if(l.tp!=null){if(typeof l.tp!="object")throw TypeError(".onnx.AttributeProto.tp: object expected");d.tp=a.onnx.TypeProto.fromObject(l.tp)}if(l.floats){if(!Array.isArray(l.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");d.floats=[];for(var u=0;u<l.floats.length;++u)d.floats[u]=Number(l.floats[u])}if(l.ints){if(!Array.isArray(l.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");d.ints=[];for(var u=0;u<l.ints.length;++u)o.Long?(d.ints[u]=o.Long.fromValue(l.ints[u])).unsigned=!1:typeof l.ints[u]=="string"?d.ints[u]=parseInt(l.ints[u],10):typeof l.ints[u]=="number"?d.ints[u]=l.ints[u]:typeof l.ints[u]=="object"&&(d.ints[u]=new o.LongBits(l.ints[u].low>>>0,l.ints[u].high>>>0).toNumber())}if(l.strings){if(!Array.isArray(l.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");d.strings=[];for(var u=0;u<l.strings.length;++u)typeof l.strings[u]=="string"?o.base64.decode(l.strings[u],d.strings[u]=o.newBuffer(o.base64.length(l.strings[u])),0):l.strings[u].length>=0&&(d.strings[u]=l.strings[u])}if(l.tensors){if(!Array.isArray(l.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");d.tensors=[];for(var u=0;u<l.tensors.length;++u){if(typeof l.tensors[u]!="object")throw TypeError(".onnx.AttributeProto.tensors: object expected");d.tensors[u]=a.onnx.TensorProto.fromObject(l.tensors[u])}}if(l.graphs){if(!Array.isArray(l.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");d.graphs=[];for(var u=0;u<l.graphs.length;++u){if(typeof l.graphs[u]!="object")throw TypeError(".onnx.AttributeProto.graphs: object expected");d.graphs[u]=a.onnx.GraphProto.fromObject(l.graphs[u])}}if(l.sparseTensors){if(!Array.isArray(l.sparseTensors))throw TypeError(".onnx.AttributeProto.sparseTensors: array expected");d.sparseTensors=[];for(var u=0;u<l.sparseTensors.length;++u){if(typeof l.sparseTensors[u]!="object")throw TypeError(".onnx.AttributeProto.sparseTensors: object expected");d.sparseTensors[u]=a.onnx.SparseTensorProto.fromObject(l.sparseTensors[u])}}if(l.typeProtos){if(!Array.isArray(l.typeProtos))throw TypeError(".onnx.AttributeProto.typeProtos: array expected");d.typeProtos=[];for(var u=0;u<l.typeProtos.length;++u){if(typeof l.typeProtos[u]!="object")throw TypeError(".onnx.AttributeProto.typeProtos: object expected");d.typeProtos[u]=a.onnx.TypeProto.fromObject(l.typeProtos[u])}}return d},c.toObject=function(l,d){d||(d={});var u={};if((d.arrays||d.defaults)&&(u.floats=[],u.ints=[],u.strings=[],u.tensors=[],u.graphs=[],u.typeProtos=[],u.sparseTensors=[]),d.defaults){if(u.name="",u.f=0,o.Long){var h=new o.Long(0,0,!1);u.i=d.longs===String?h.toString():d.longs===Number?h.toNumber():h}else u.i=d.longs===String?"0":0;d.bytes===String?u.s="":(u.s=[],d.bytes!==Array&&(u.s=o.newBuffer(u.s))),u.t=null,u.g=null,u.docString="",u.tp=null,u.type=d.enums===String?"UNDEFINED":0,u.refAttrName="",u.sparseTensor=null}if(l.name!=null&&l.hasOwnProperty("name")&&(u.name=l.name),l.f!=null&&l.hasOwnProperty("f")&&(u.f=d.json&&!isFinite(l.f)?String(l.f):l.f),l.i!=null&&l.hasOwnProperty("i")&&(typeof l.i=="number"?u.i=d.longs===String?String(l.i):l.i:u.i=d.longs===String?o.Long.prototype.toString.call(l.i):d.longs===Number?new o.LongBits(l.i.low>>>0,l.i.high>>>0).toNumber():l.i),l.s!=null&&l.hasOwnProperty("s")&&(u.s=d.bytes===String?o.base64.encode(l.s,0,l.s.length):d.bytes===Array?Array.prototype.slice.call(l.s):l.s),l.t!=null&&l.hasOwnProperty("t")&&(u.t=a.onnx.TensorProto.toObject(l.t,d)),l.g!=null&&l.hasOwnProperty("g")&&(u.g=a.onnx.GraphProto.toObject(l.g,d)),l.floats&&l.floats.length){u.floats=[];for(var p=0;p<l.floats.length;++p)u.floats[p]=d.json&&!isFinite(l.floats[p])?String(l.floats[p]):l.floats[p]}if(l.ints&&l.ints.length){u.ints=[];for(var p=0;p<l.ints.length;++p)typeof l.ints[p]=="number"?u.ints[p]=d.longs===String?String(l.ints[p]):l.ints[p]:u.ints[p]=d.longs===String?o.Long.prototype.toString.call(l.ints[p]):d.longs===Number?new o.LongBits(l.ints[p].low>>>0,l.ints[p].high>>>0).toNumber():l.ints[p]}if(l.strings&&l.strings.length){u.strings=[];for(var p=0;p<l.strings.length;++p)u.strings[p]=d.bytes===String?o.base64.encode(l.strings[p],0,l.strings[p].length):d.bytes===Array?Array.prototype.slice.call(l.strings[p]):l.strings[p]}if(l.tensors&&l.tensors.length){u.tensors=[];for(var p=0;p<l.tensors.length;++p)u.tensors[p]=a.onnx.TensorProto.toObject(l.tensors[p],d)}if(l.graphs&&l.graphs.length){u.graphs=[];for(var p=0;p<l.graphs.length;++p)u.graphs[p]=a.onnx.GraphProto.toObject(l.graphs[p],d)}if(l.docString!=null&&l.hasOwnProperty("docString")&&(u.docString=l.docString),l.tp!=null&&l.hasOwnProperty("tp")&&(u.tp=a.onnx.TypeProto.toObject(l.tp,d)),l.typeProtos&&l.typeProtos.length){u.typeProtos=[];for(var p=0;p<l.typeProtos.length;++p)u.typeProtos[p]=a.onnx.TypeProto.toObject(l.typeProtos[p],d)}if(l.type!=null&&l.hasOwnProperty("type")&&(u.type=d.enums===String?a.onnx.AttributeProto.AttributeType[l.type]===void 0?l.type:a.onnx.AttributeProto.AttributeType[l.type]:l.type),l.refAttrName!=null&&l.hasOwnProperty("refAttrName")&&(u.refAttrName=l.refAttrName),l.sparseTensor!=null&&l.hasOwnProperty("sparseTensor")&&(u.sparseTensor=a.onnx.SparseTensorProto.toObject(l.sparseTensor,d)),l.sparseTensors&&l.sparseTensors.length){u.sparseTensors=[];for(var p=0;p<l.sparseTensors.length;++p)u.sparseTensors[p]=a.onnx.SparseTensorProto.toObject(l.sparseTensors[p],d)}return u},c.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},c.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.AttributeProto"},c.AttributeType=function(){var l={},d=Object.create(l);return d[l[0]="UNDEFINED"]=0,d[l[1]="FLOAT"]=1,d[l[2]="INT"]=2,d[l[3]="STRING"]=3,d[l[4]="TENSOR"]=4,d[l[5]="GRAPH"]=5,d[l[11]="SPARSE_TENSOR"]=11,d[l[13]="TYPE_PROTO"]=13,d[l[6]="FLOATS"]=6,d[l[7]="INTS"]=7,d[l[8]="STRINGS"]=8,d[l[9]="TENSORS"]=9,d[l[10]="GRAPHS"]=10,d[l[12]="SPARSE_TENSORS"]=12,d[l[14]="TYPE_PROTOS"]=14,d}(),c}(),s.ValueInfoProto=function(){function c(l){if(l)for(var d=Object.keys(l),u=0;u<d.length;++u)l[d[u]]!=null&&(this[d[u]]=l[d[u]])}return c.prototype.name="",c.prototype.type=null,c.prototype.docString="",c.create=function(l){return new c(l)},c.encode=function(l,d){return d||(d=n.create()),l.name!=null&&Object.hasOwnProperty.call(l,"name")&&d.uint32(10).string(l.name),l.type!=null&&Object.hasOwnProperty.call(l,"type")&&a.onnx.TypeProto.encode(l.type,d.uint32(18).fork()).ldelim(),l.docString!=null&&Object.hasOwnProperty.call(l,"docString")&&d.uint32(26).string(l.docString),d},c.encodeDelimited=function(l,d){return this.encode(l,d).ldelim()},c.decode=function(l,d){l instanceof r||(l=r.create(l));for(var u=d===void 0?l.len:l.pos+d,h=new a.onnx.ValueInfoProto;l.pos<u;){var p=l.uint32();switch(p>>>3){case 1:{h.name=l.string();break}case 2:{h.type=a.onnx.TypeProto.decode(l,l.uint32());break}case 3:{h.docString=l.string();break}default:l.skipType(p&7);break}}return h},c.decodeDelimited=function(l){return l instanceof r||(l=new r(l)),this.decode(l,l.uint32())},c.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.name!=null&&l.hasOwnProperty("name")&&!o.isString(l.name))return"name: string expected";if(l.type!=null&&l.hasOwnProperty("type")){var d=a.onnx.TypeProto.verify(l.type);if(d)return"type."+d}return l.docString!=null&&l.hasOwnProperty("docString")&&!o.isString(l.docString)?"docString: string expected":null},c.fromObject=function(l){if(l instanceof a.onnx.ValueInfoProto)return l;var d=new a.onnx.ValueInfoProto;if(l.name!=null&&(d.name=String(l.name)),l.type!=null){if(typeof l.type!="object")throw TypeError(".onnx.ValueInfoProto.type: object expected");d.type=a.onnx.TypeProto.fromObject(l.type)}return l.docString!=null&&(d.docString=String(l.docString)),d},c.toObject=function(l,d){d||(d={});var u={};return d.defaults&&(u.name="",u.type=null,u.docString=""),l.name!=null&&l.hasOwnProperty("name")&&(u.name=l.name),l.type!=null&&l.hasOwnProperty("type")&&(u.type=a.onnx.TypeProto.toObject(l.type,d)),l.docString!=null&&l.hasOwnProperty("docString")&&(u.docString=l.docString),u},c.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},c.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.ValueInfoProto"},c}(),s.NodeProto=function(){function c(l){if(this.input=[],this.output=[],this.attribute=[],l)for(var d=Object.keys(l),u=0;u<d.length;++u)l[d[u]]!=null&&(this[d[u]]=l[d[u]])}return c.prototype.input=o.emptyArray,c.prototype.output=o.emptyArray,c.prototype.name="",c.prototype.opType="",c.prototype.domain="",c.prototype.attribute=o.emptyArray,c.prototype.docString="",c.create=function(l){return new c(l)},c.encode=function(l,d){if(d||(d=n.create()),l.input!=null&&l.input.length)for(var u=0;u<l.input.length;++u)d.uint32(10).string(l.input[u]);if(l.output!=null&&l.output.length)for(var u=0;u<l.output.length;++u)d.uint32(18).string(l.output[u]);if(l.name!=null&&Object.hasOwnProperty.call(l,"name")&&d.uint32(26).string(l.name),l.opType!=null&&Object.hasOwnProperty.call(l,"opType")&&d.uint32(34).string(l.opType),l.attribute!=null&&l.attribute.length)for(var u=0;u<l.attribute.length;++u)a.onnx.AttributeProto.encode(l.attribute[u],d.uint32(42).fork()).ldelim();return l.docString!=null&&Object.hasOwnProperty.call(l,"docString")&&d.uint32(50).string(l.docString),l.domain!=null&&Object.hasOwnProperty.call(l,"domain")&&d.uint32(58).string(l.domain),d},c.encodeDelimited=function(l,d){return this.encode(l,d).ldelim()},c.decode=function(l,d){l instanceof r||(l=r.create(l));for(var u=d===void 0?l.len:l.pos+d,h=new a.onnx.NodeProto;l.pos<u;){var p=l.uint32();switch(p>>>3){case 1:{h.input&&h.input.length||(h.input=[]),h.input.push(l.string());break}case 2:{h.output&&h.output.length||(h.output=[]),h.output.push(l.string());break}case 3:{h.name=l.string();break}case 4:{h.opType=l.string();break}case 7:{h.domain=l.string();break}case 5:{h.attribute&&h.attribute.length||(h.attribute=[]),h.attribute.push(a.onnx.AttributeProto.decode(l,l.uint32()));break}case 6:{h.docString=l.string();break}default:l.skipType(p&7);break}}return h},c.decodeDelimited=function(l){return l instanceof r||(l=new r(l)),this.decode(l,l.uint32())},c.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.input!=null&&l.hasOwnProperty("input")){if(!Array.isArray(l.input))return"input: array expected";for(var d=0;d<l.input.length;++d)if(!o.isString(l.input[d]))return"input: string[] expected"}if(l.output!=null&&l.hasOwnProperty("output")){if(!Array.isArray(l.output))return"output: array expected";for(var d=0;d<l.output.length;++d)if(!o.isString(l.output[d]))return"output: string[] expected"}if(l.name!=null&&l.hasOwnProperty("name")&&!o.isString(l.name))return"name: string expected";if(l.opType!=null&&l.hasOwnProperty("opType")&&!o.isString(l.opType))return"opType: string expected";if(l.domain!=null&&l.hasOwnProperty("domain")&&!o.isString(l.domain))return"domain: string expected";if(l.attribute!=null&&l.hasOwnProperty("attribute")){if(!Array.isArray(l.attribute))return"attribute: array expected";for(var d=0;d<l.attribute.length;++d){var u=a.onnx.AttributeProto.verify(l.attribute[d]);if(u)return"attribute."+u}}return l.docString!=null&&l.hasOwnProperty("docString")&&!o.isString(l.docString)?"docString: string expected":null},c.fromObject=function(l){if(l instanceof a.onnx.NodeProto)return l;var d=new a.onnx.NodeProto;if(l.input){if(!Array.isArray(l.input))throw TypeError(".onnx.NodeProto.input: array expected");d.input=[];for(var u=0;u<l.input.length;++u)d.input[u]=String(l.input[u])}if(l.output){if(!Array.isArray(l.output))throw TypeError(".onnx.NodeProto.output: array expected");d.output=[];for(var u=0;u<l.output.length;++u)d.output[u]=String(l.output[u])}if(l.name!=null&&(d.name=String(l.name)),l.opType!=null&&(d.opType=String(l.opType)),l.domain!=null&&(d.domain=String(l.domain)),l.attribute){if(!Array.isArray(l.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");d.attribute=[];for(var u=0;u<l.attribute.length;++u){if(typeof l.attribute[u]!="object")throw TypeError(".onnx.NodeProto.attribute: object expected");d.attribute[u]=a.onnx.AttributeProto.fromObject(l.attribute[u])}}return l.docString!=null&&(d.docString=String(l.docString)),d},c.toObject=function(l,d){d||(d={});var u={};if((d.arrays||d.defaults)&&(u.input=[],u.output=[],u.attribute=[]),d.defaults&&(u.name="",u.opType="",u.docString="",u.domain=""),l.input&&l.input.length){u.input=[];for(var h=0;h<l.input.length;++h)u.input[h]=l.input[h]}if(l.output&&l.output.length){u.output=[];for(var h=0;h<l.output.length;++h)u.output[h]=l.output[h]}if(l.name!=null&&l.hasOwnProperty("name")&&(u.name=l.name),l.opType!=null&&l.hasOwnProperty("opType")&&(u.opType=l.opType),l.attribute&&l.attribute.length){u.attribute=[];for(var h=0;h<l.attribute.length;++h)u.attribute[h]=a.onnx.AttributeProto.toObject(l.attribute[h],d)}return l.docString!=null&&l.hasOwnProperty("docString")&&(u.docString=l.docString),l.domain!=null&&l.hasOwnProperty("domain")&&(u.domain=l.domain),u},c.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},c.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.NodeProto"},c}(),s.TrainingInfoProto=function(){function c(l){if(this.initializationBinding=[],this.updateBinding=[],l)for(var d=Object.keys(l),u=0;u<d.length;++u)l[d[u]]!=null&&(this[d[u]]=l[d[u]])}return c.prototype.initialization=null,c.prototype.algorithm=null,c.prototype.initializationBinding=o.emptyArray,c.prototype.updateBinding=o.emptyArray,c.create=function(l){return new c(l)},c.encode=function(l,d){if(d||(d=n.create()),l.initialization!=null&&Object.hasOwnProperty.call(l,"initialization")&&a.onnx.GraphProto.encode(l.initialization,d.uint32(10).fork()).ldelim(),l.algorithm!=null&&Object.hasOwnProperty.call(l,"algorithm")&&a.onnx.GraphProto.encode(l.algorithm,d.uint32(18).fork()).ldelim(),l.initializationBinding!=null&&l.initializationBinding.length)for(var u=0;u<l.initializationBinding.length;++u)a.onnx.StringStringEntryProto.encode(l.initializationBinding[u],d.uint32(26).fork()).ldelim();if(l.updateBinding!=null&&l.updateBinding.length)for(var u=0;u<l.updateBinding.length;++u)a.onnx.StringStringEntryProto.encode(l.updateBinding[u],d.uint32(34).fork()).ldelim();return d},c.encodeDelimited=function(l,d){return this.encode(l,d).ldelim()},c.decode=function(l,d){l instanceof r||(l=r.create(l));for(var u=d===void 0?l.len:l.pos+d,h=new a.onnx.TrainingInfoProto;l.pos<u;){var p=l.uint32();switch(p>>>3){case 1:{h.initialization=a.onnx.GraphProto.decode(l,l.uint32());break}case 2:{h.algorithm=a.onnx.GraphProto.decode(l,l.uint32());break}case 3:{h.initializationBinding&&h.initializationBinding.length||(h.initializationBinding=[]),h.initializationBinding.push(a.onnx.StringStringEntryProto.decode(l,l.uint32()));break}case 4:{h.updateBinding&&h.updateBinding.length||(h.updateBinding=[]),h.updateBinding.push(a.onnx.StringStringEntryProto.decode(l,l.uint32()));break}default:l.skipType(p&7);break}}return h},c.decodeDelimited=function(l){return l instanceof r||(l=new r(l)),this.decode(l,l.uint32())},c.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.initialization!=null&&l.hasOwnProperty("initialization")){var d=a.onnx.GraphProto.verify(l.initialization);if(d)return"initialization."+d}if(l.algorithm!=null&&l.hasOwnProperty("algorithm")){var d=a.onnx.GraphProto.verify(l.algorithm);if(d)return"algorithm."+d}if(l.initializationBinding!=null&&l.hasOwnProperty("initializationBinding")){if(!Array.isArray(l.initializationBinding))return"initializationBinding: array expected";for(var u=0;u<l.initializationBinding.length;++u){var d=a.onnx.StringStringEntryProto.verify(l.initializationBinding[u]);if(d)return"initializationBinding."+d}}if(l.updateBinding!=null&&l.hasOwnProperty("updateBinding")){if(!Array.isArray(l.updateBinding))return"updateBinding: array expected";for(var u=0;u<l.updateBinding.length;++u){var d=a.onnx.StringStringEntryProto.verify(l.updateBinding[u]);if(d)return"updateBinding."+d}}return null},c.fromObject=function(l){if(l instanceof a.onnx.TrainingInfoProto)return l;var d=new a.onnx.TrainingInfoProto;if(l.initialization!=null){if(typeof l.initialization!="object")throw TypeError(".onnx.TrainingInfoProto.initialization: object expected");d.initialization=a.onnx.GraphProto.fromObject(l.initialization)}if(l.algorithm!=null){if(typeof l.algorithm!="object")throw TypeError(".onnx.TrainingInfoProto.algorithm: object expected");d.algorithm=a.onnx.GraphProto.fromObject(l.algorithm)}if(l.initializationBinding){if(!Array.isArray(l.initializationBinding))throw TypeError(".onnx.TrainingInfoProto.initializationBinding: array expected");d.initializationBinding=[];for(var u=0;u<l.initializationBinding.length;++u){if(typeof l.initializationBinding[u]!="object")throw TypeError(".onnx.TrainingInfoProto.initializationBinding: object expected");d.initializationBinding[u]=a.onnx.StringStringEntryProto.fromObject(l.initializationBinding[u])}}if(l.updateBinding){if(!Array.isArray(l.updateBinding))throw TypeError(".onnx.TrainingInfoProto.updateBinding: array expected");d.updateBinding=[];for(var u=0;u<l.updateBinding.length;++u){if(typeof l.updateBinding[u]!="object")throw TypeError(".onnx.TrainingInfoProto.updateBinding: object expected");d.updateBinding[u]=a.onnx.StringStringEntryProto.fromObject(l.updateBinding[u])}}return d},c.toObject=function(l,d){d||(d={});var u={};if((d.arrays||d.defaults)&&(u.initializationBinding=[],u.updateBinding=[]),d.defaults&&(u.initialization=null,u.algorithm=null),l.initialization!=null&&l.hasOwnProperty("initialization")&&(u.initialization=a.onnx.GraphProto.toObject(l.initialization,d)),l.algorithm!=null&&l.hasOwnProperty("algorithm")&&(u.algorithm=a.onnx.GraphProto.toObject(l.algorithm,d)),l.initializationBinding&&l.initializationBinding.length){u.initializationBinding=[];for(var h=0;h<l.initializationBinding.length;++h)u.initializationBinding[h]=a.onnx.StringStringEntryProto.toObject(l.initializationBinding[h],d)}if(l.updateBinding&&l.updateBinding.length){u.updateBinding=[];for(var h=0;h<l.updateBinding.length;++h)u.updateBinding[h]=a.onnx.StringStringEntryProto.toObject(l.updateBinding[h],d)}return u},c.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},c.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.TrainingInfoProto"},c}(),s.ModelProto=function(){function c(l){if(this.opsetImport=[],this.metadataProps=[],this.trainingInfo=[],this.functions=[],l)for(var d=Object.keys(l),u=0;u<d.length;++u)l[d[u]]!=null&&(this[d[u]]=l[d[u]])}return c.prototype.irVersion=o.Long?o.Long.fromBits(0,0,!1):0,c.prototype.opsetImport=o.emptyArray,c.prototype.producerName="",c.prototype.producerVersion="",c.prototype.domain="",c.prototype.modelVersion=o.Long?o.Long.fromBits(0,0,!1):0,c.prototype.docString="",c.prototype.graph=null,c.prototype.metadataProps=o.emptyArray,c.prototype.trainingInfo=o.emptyArray,c.prototype.functions=o.emptyArray,c.create=function(l){return new c(l)},c.encode=function(l,d){if(d||(d=n.create()),l.irVersion!=null&&Object.hasOwnProperty.call(l,"irVersion")&&d.uint32(8).int64(l.irVersion),l.producerName!=null&&Object.hasOwnProperty.call(l,"producerName")&&d.uint32(18).string(l.producerName),l.producerVersion!=null&&Object.hasOwnProperty.call(l,"producerVersion")&&d.uint32(26).string(l.producerVersion),l.domain!=null&&Object.hasOwnProperty.call(l,"domain")&&d.uint32(34).string(l.domain),l.modelVersion!=null&&Object.hasOwnProperty.call(l,"modelVersion")&&d.uint32(40).int64(l.modelVersion),l.docString!=null&&Object.hasOwnProperty.call(l,"docString")&&d.uint32(50).string(l.docString),l.graph!=null&&Object.hasOwnProperty.call(l,"graph")&&a.onnx.GraphProto.encode(l.graph,d.uint32(58).fork()).ldelim(),l.opsetImport!=null&&l.opsetImport.length)for(var u=0;u<l.opsetImport.length;++u)a.onnx.OperatorSetIdProto.encode(l.opsetImport[u],d.uint32(66).fork()).ldelim();if(l.metadataProps!=null&&l.metadataProps.length)for(var u=0;u<l.metadataProps.length;++u)a.onnx.StringStringEntryProto.encode(l.metadataProps[u],d.uint32(114).fork()).ldelim();if(l.trainingInfo!=null&&l.trainingInfo.length)for(var u=0;u<l.trainingInfo.length;++u)a.onnx.TrainingInfoProto.encode(l.trainingInfo[u],d.uint32(162).fork()).ldelim();if(l.functions!=null&&l.functions.length)for(var u=0;u<l.functions.length;++u)a.onnx.FunctionProto.encode(l.functions[u],d.uint32(202).fork()).ldelim();return d},c.encodeDelimited=function(l,d){return this.encode(l,d).ldelim()},c.decode=function(l,d){l instanceof r||(l=r.create(l));for(var u=d===void 0?l.len:l.pos+d,h=new a.onnx.ModelProto;l.pos<u;){var p=l.uint32();switch(p>>>3){case 1:{h.irVersion=l.int64();break}case 8:{h.opsetImport&&h.opsetImport.length||(h.opsetImport=[]),h.opsetImport.push(a.onnx.OperatorSetIdProto.decode(l,l.uint32()));break}case 2:{h.producerName=l.string();break}case 3:{h.producerVersion=l.string();break}case 4:{h.domain=l.string();break}case 5:{h.modelVersion=l.int64();break}case 6:{h.docString=l.string();break}case 7:{h.graph=a.onnx.GraphProto.decode(l,l.uint32());break}case 14:{h.metadataProps&&h.metadataProps.length||(h.metadataProps=[]),h.metadataProps.push(a.onnx.StringStringEntryProto.decode(l,l.uint32()));break}case 20:{h.trainingInfo&&h.trainingInfo.length||(h.trainingInfo=[]),h.trainingInfo.push(a.onnx.TrainingInfoProto.decode(l,l.uint32()));break}case 25:{h.functions&&h.functions.length||(h.functions=[]),h.functions.push(a.onnx.FunctionProto.decode(l,l.uint32()));break}default:l.skipType(p&7);break}}return h},c.decodeDelimited=function(l){return l instanceof r||(l=new r(l)),this.decode(l,l.uint32())},c.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.irVersion!=null&&l.hasOwnProperty("irVersion")&&!o.isInteger(l.irVersion)&&!(l.irVersion&&o.isInteger(l.irVersion.low)&&o.isInteger(l.irVersion.high)))return"irVersion: integer|Long expected";if(l.opsetImport!=null&&l.hasOwnProperty("opsetImport")){if(!Array.isArray(l.opsetImport))return"opsetImport: array expected";for(var d=0;d<l.opsetImport.length;++d){var u=a.onnx.OperatorSetIdProto.verify(l.opsetImport[d]);if(u)return"opsetImport."+u}}if(l.producerName!=null&&l.hasOwnProperty("producerName")&&!o.isString(l.producerName))return"producerName: string expected";if(l.producerVersion!=null&&l.hasOwnProperty("producerVersion")&&!o.isString(l.producerVersion))return"producerVersion: string expected";if(l.domain!=null&&l.hasOwnProperty("domain")&&!o.isString(l.domain))return"domain: string expected";if(l.modelVersion!=null&&l.hasOwnProperty("modelVersion")&&!o.isInteger(l.modelVersion)&&!(l.modelVersion&&o.isInteger(l.modelVersion.low)&&o.isInteger(l.modelVersion.high)))return"modelVersion: integer|Long expected";if(l.docString!=null&&l.hasOwnProperty("docString")&&!o.isString(l.docString))return"docString: string expected";if(l.graph!=null&&l.hasOwnProperty("graph")){var u=a.onnx.GraphProto.verify(l.graph);if(u)return"graph."+u}if(l.metadataProps!=null&&l.hasOwnProperty("metadataProps")){if(!Array.isArray(l.metadataProps))return"metadataProps: array expected";for(var d=0;d<l.metadataProps.length;++d){var u=a.onnx.StringStringEntryProto.verify(l.metadataProps[d]);if(u)return"metadataProps."+u}}if(l.trainingInfo!=null&&l.hasOwnProperty("trainingInfo")){if(!Array.isArray(l.trainingInfo))return"trainingInfo: array expected";for(var d=0;d<l.trainingInfo.length;++d){var u=a.onnx.TrainingInfoProto.verify(l.trainingInfo[d]);if(u)return"trainingInfo."+u}}if(l.functions!=null&&l.hasOwnProperty("functions")){if(!Array.isArray(l.functions))return"functions: array expected";for(var d=0;d<l.functions.length;++d){var u=a.onnx.FunctionProto.verify(l.functions[d]);if(u)return"functions."+u}}return null},c.fromObject=function(l){if(l instanceof a.onnx.ModelProto)return l;var d=new a.onnx.ModelProto;if(l.irVersion!=null&&(o.Long?(d.irVersion=o.Long.fromValue(l.irVersion)).unsigned=!1:typeof l.irVersion=="string"?d.irVersion=parseInt(l.irVersion,10):typeof l.irVersion=="number"?d.irVersion=l.irVersion:typeof l.irVersion=="object"&&(d.irVersion=new o.LongBits(l.irVersion.low>>>0,l.irVersion.high>>>0).toNumber())),l.opsetImport){if(!Array.isArray(l.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");d.opsetImport=[];for(var u=0;u<l.opsetImport.length;++u){if(typeof l.opsetImport[u]!="object")throw TypeError(".onnx.ModelProto.opsetImport: object expected");d.opsetImport[u]=a.onnx.OperatorSetIdProto.fromObject(l.opsetImport[u])}}if(l.producerName!=null&&(d.producerName=String(l.producerName)),l.producerVersion!=null&&(d.producerVersion=String(l.producerVersion)),l.domain!=null&&(d.domain=String(l.domain)),l.modelVersion!=null&&(o.Long?(d.modelVersion=o.Long.fromValue(l.modelVersion)).unsigned=!1:typeof l.modelVersion=="string"?d.modelVersion=parseInt(l.modelVersion,10):typeof l.modelVersion=="number"?d.modelVersion=l.modelVersion:typeof l.modelVersion=="object"&&(d.modelVersion=new o.LongBits(l.modelVersion.low>>>0,l.modelVersion.high>>>0).toNumber())),l.docString!=null&&(d.docString=String(l.docString)),l.graph!=null){if(typeof l.graph!="object")throw TypeError(".onnx.ModelProto.graph: object expected");d.graph=a.onnx.GraphProto.fromObject(l.graph)}if(l.metadataProps){if(!Array.isArray(l.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");d.metadataProps=[];for(var u=0;u<l.metadataProps.length;++u){if(typeof l.metadataProps[u]!="object")throw TypeError(".onnx.ModelProto.metadataProps: object expected");d.metadataProps[u]=a.onnx.StringStringEntryProto.fromObject(l.metadataProps[u])}}if(l.trainingInfo){if(!Array.isArray(l.trainingInfo))throw TypeError(".onnx.ModelProto.trainingInfo: array expected");d.trainingInfo=[];for(var u=0;u<l.trainingInfo.length;++u){if(typeof l.trainingInfo[u]!="object")throw TypeError(".onnx.ModelProto.trainingInfo: object expected");d.trainingInfo[u]=a.onnx.TrainingInfoProto.fromObject(l.trainingInfo[u])}}if(l.functions){if(!Array.isArray(l.functions))throw TypeError(".onnx.ModelProto.functions: array expected");d.functions=[];for(var u=0;u<l.functions.length;++u){if(typeof l.functions[u]!="object")throw TypeError(".onnx.ModelProto.functions: object expected");d.functions[u]=a.onnx.FunctionProto.fromObject(l.functions[u])}}return d},c.toObject=function(l,d){d||(d={});var u={};if((d.arrays||d.defaults)&&(u.opsetImport=[],u.metadataProps=[],u.trainingInfo=[],u.functions=[]),d.defaults){if(o.Long){var h=new o.Long(0,0,!1);u.irVersion=d.longs===String?h.toString():d.longs===Number?h.toNumber():h}else u.irVersion=d.longs===String?"0":0;if(u.producerName="",u.producerVersion="",u.domain="",o.Long){var h=new o.Long(0,0,!1);u.modelVersion=d.longs===String?h.toString():d.longs===Number?h.toNumber():h}else u.modelVersion=d.longs===String?"0":0;u.docString="",u.graph=null}if(l.irVersion!=null&&l.hasOwnProperty("irVersion")&&(typeof l.irVersion=="number"?u.irVersion=d.longs===String?String(l.irVersion):l.irVersion:u.irVersion=d.longs===String?o.Long.prototype.toString.call(l.irVersion):d.longs===Number?new o.LongBits(l.irVersion.low>>>0,l.irVersion.high>>>0).toNumber():l.irVersion),l.producerName!=null&&l.hasOwnProperty("producerName")&&(u.producerName=l.producerName),l.producerVersion!=null&&l.hasOwnProperty("producerVersion")&&(u.producerVersion=l.producerVersion),l.domain!=null&&l.hasOwnProperty("domain")&&(u.domain=l.domain),l.modelVersion!=null&&l.hasOwnProperty("modelVersion")&&(typeof l.modelVersion=="number"?u.modelVersion=d.longs===String?String(l.modelVersion):l.modelVersion:u.modelVersion=d.longs===String?o.Long.prototype.toString.call(l.modelVersion):d.longs===Number?new o.LongBits(l.modelVersion.low>>>0,l.modelVersion.high>>>0).toNumber():l.modelVersion),l.docString!=null&&l.hasOwnProperty("docString")&&(u.docString=l.docString),l.graph!=null&&l.hasOwnProperty("graph")&&(u.graph=a.onnx.GraphProto.toObject(l.graph,d)),l.opsetImport&&l.opsetImport.length){u.opsetImport=[];for(var p=0;p<l.opsetImport.length;++p)u.opsetImport[p]=a.onnx.OperatorSetIdProto.toObject(l.opsetImport[p],d)}if(l.metadataProps&&l.metadataProps.length){u.metadataProps=[];for(var p=0;p<l.metadataProps.length;++p)u.metadataProps[p]=a.onnx.StringStringEntryProto.toObject(l.metadataProps[p],d)}if(l.trainingInfo&&l.trainingInfo.length){u.trainingInfo=[];for(var p=0;p<l.trainingInfo.length;++p)u.trainingInfo[p]=a.onnx.TrainingInfoProto.toObject(l.trainingInfo[p],d)}if(l.functions&&l.functions.length){u.functions=[];for(var p=0;p<l.functions.length;++p)u.functions[p]=a.onnx.FunctionProto.toObject(l.functions[p],d)}return u},c.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},c.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.ModelProto"},c}(),s.StringStringEntryProto=function(){function c(l){if(l)for(var d=Object.keys(l),u=0;u<d.length;++u)l[d[u]]!=null&&(this[d[u]]=l[d[u]])}return c.prototype.key="",c.prototype.value="",c.create=function(l){return new c(l)},c.encode=function(l,d){return d||(d=n.create()),l.key!=null&&Object.hasOwnProperty.call(l,"key")&&d.uint32(10).string(l.key),l.value!=null&&Object.hasOwnProperty.call(l,"value")&&d.uint32(18).string(l.value),d},c.encodeDelimited=function(l,d){return this.encode(l,d).ldelim()},c.decode=function(l,d){l instanceof r||(l=r.create(l));for(var u=d===void 0?l.len:l.pos+d,h=new a.onnx.StringStringEntryProto;l.pos<u;){var p=l.uint32();switch(p>>>3){case 1:{h.key=l.string();break}case 2:{h.value=l.string();break}default:l.skipType(p&7);break}}return h},c.decodeDelimited=function(l){return l instanceof r||(l=new r(l)),this.decode(l,l.uint32())},c.verify=function(l){return typeof l!="object"||l===null?"object expected":l.key!=null&&l.hasOwnProperty("key")&&!o.isString(l.key)?"key: string expected":l.value!=null&&l.hasOwnProperty("value")&&!o.isString(l.value)?"value: string expected":null},c.fromObject=function(l){if(l instanceof a.onnx.StringStringEntryProto)return l;var d=new a.onnx.StringStringEntryProto;return l.key!=null&&(d.key=String(l.key)),l.value!=null&&(d.value=String(l.value)),d},c.toObject=function(l,d){d||(d={});var u={};return d.defaults&&(u.key="",u.value=""),l.key!=null&&l.hasOwnProperty("key")&&(u.key=l.key),l.value!=null&&l.hasOwnProperty("value")&&(u.value=l.value),u},c.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},c.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.StringStringEntryProto"},c}(),s.TensorAnnotation=function(){function c(l){if(this.quantParameterTensorNames=[],l)for(var d=Object.keys(l),u=0;u<d.length;++u)l[d[u]]!=null&&(this[d[u]]=l[d[u]])}return c.prototype.tensorName="",c.prototype.quantParameterTensorNames=o.emptyArray,c.create=function(l){return new c(l)},c.encode=function(l,d){if(d||(d=n.create()),l.tensorName!=null&&Object.hasOwnProperty.call(l,"tensorName")&&d.uint32(10).string(l.tensorName),l.quantParameterTensorNames!=null&&l.quantParameterTensorNames.length)for(var u=0;u<l.quantParameterTensorNames.length;++u)a.onnx.StringStringEntryProto.encode(l.quantParameterTensorNames[u],d.uint32(18).fork()).ldelim();return d},c.encodeDelimited=function(l,d){return this.encode(l,d).ldelim()},c.decode=function(l,d){l instanceof r||(l=r.create(l));for(var u=d===void 0?l.len:l.pos+d,h=new a.onnx.TensorAnnotation;l.pos<u;){var p=l.uint32();switch(p>>>3){case 1:{h.tensorName=l.string();break}case 2:{h.quantParameterTensorNames&&h.quantParameterTensorNames.length||(h.quantParameterTensorNames=[]),h.quantParameterTensorNames.push(a.onnx.StringStringEntryProto.decode(l,l.uint32()));break}default:l.skipType(p&7);break}}return h},c.decodeDelimited=function(l){return l instanceof r||(l=new r(l)),this.decode(l,l.uint32())},c.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.tensorName!=null&&l.hasOwnProperty("tensorName")&&!o.isString(l.tensorName))return"tensorName: string expected";if(l.quantParameterTensorNames!=null&&l.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(l.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var d=0;d<l.quantParameterTensorNames.length;++d){var u=a.onnx.StringStringEntryProto.verify(l.quantParameterTensorNames[d]);if(u)return"quantParameterTensorNames."+u}}return null},c.fromObject=function(l){if(l instanceof a.onnx.TensorAnnotation)return l;var d=new a.onnx.TensorAnnotation;if(l.tensorName!=null&&(d.tensorName=String(l.tensorName)),l.quantParameterTensorNames){if(!Array.isArray(l.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");d.quantParameterTensorNames=[];for(var u=0;u<l.quantParameterTensorNames.length;++u){if(typeof l.quantParameterTensorNames[u]!="object")throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");d.quantParameterTensorNames[u]=a.onnx.StringStringEntryProto.fromObject(l.quantParameterTensorNames[u])}}return d},c.toObject=function(l,d){d||(d={});var u={};if((d.arrays||d.defaults)&&(u.quantParameterTensorNames=[]),d.defaults&&(u.tensorName=""),l.tensorName!=null&&l.hasOwnProperty("tensorName")&&(u.tensorName=l.tensorName),l.quantParameterTensorNames&&l.quantParameterTensorNames.length){u.quantParameterTensorNames=[];for(var h=0;h<l.quantParameterTensorNames.length;++h)u.quantParameterTensorNames[h]=a.onnx.StringStringEntryProto.toObject(l.quantParameterTensorNames[h],d)}return u},c.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},c.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.TensorAnnotation"},c}(),s.GraphProto=function(){function c(l){if(this.node=[],this.initializer=[],this.sparseInitializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],l)for(var d=Object.keys(l),u=0;u<d.length;++u)l[d[u]]!=null&&(this[d[u]]=l[d[u]])}return c.prototype.node=o.emptyArray,c.prototype.name="",c.prototype.initializer=o.emptyArray,c.prototype.sparseInitializer=o.emptyArray,c.prototype.docString="",c.prototype.input=o.emptyArray,c.prototype.output=o.emptyArray,c.prototype.valueInfo=o.emptyArray,c.prototype.quantizationAnnotation=o.emptyArray,c.create=function(l){return new c(l)},c.encode=function(l,d){if(d||(d=n.create()),l.node!=null&&l.node.length)for(var u=0;u<l.node.length;++u)a.onnx.NodeProto.encode(l.node[u],d.uint32(10).fork()).ldelim();if(l.name!=null&&Object.hasOwnProperty.call(l,"name")&&d.uint32(18).string(l.name),l.initializer!=null&&l.initializer.length)for(var u=0;u<l.initializer.length;++u)a.onnx.TensorProto.encode(l.initializer[u],d.uint32(42).fork()).ldelim();if(l.docString!=null&&Object.hasOwnProperty.call(l,"docString")&&d.uint32(82).string(l.docString),l.input!=null&&l.input.length)for(var u=0;u<l.input.length;++u)a.onnx.ValueInfoProto.encode(l.input[u],d.uint32(90).fork()).ldelim();if(l.output!=null&&l.output.length)for(var u=0;u<l.output.length;++u)a.onnx.ValueInfoProto.encode(l.output[u],d.uint32(98).fork()).ldelim();if(l.valueInfo!=null&&l.valueInfo.length)for(var u=0;u<l.valueInfo.length;++u)a.onnx.ValueInfoProto.encode(l.valueInfo[u],d.uint32(106).fork()).ldelim();if(l.quantizationAnnotation!=null&&l.quantizationAnnotation.length)for(var u=0;u<l.quantizationAnnotation.length;++u)a.onnx.TensorAnnotation.encode(l.quantizationAnnotation[u],d.uint32(114).fork()).ldelim();if(l.sparseInitializer!=null&&l.sparseInitializer.length)for(var u=0;u<l.sparseInitializer.length;++u)a.onnx.SparseTensorProto.encode(l.sparseInitializer[u],d.uint32(122).fork()).ldelim();return d},c.encodeDelimited=function(l,d){return this.encode(l,d).ldelim()},c.decode=function(l,d){l instanceof r||(l=r.create(l));for(var u=d===void 0?l.len:l.pos+d,h=new a.onnx.GraphProto;l.pos<u;){var p=l.uint32();switch(p>>>3){case 1:{h.node&&h.node.length||(h.node=[]),h.node.push(a.onnx.NodeProto.decode(l,l.uint32()));break}case 2:{h.name=l.string();break}case 5:{h.initializer&&h.initializer.length||(h.initializer=[]),h.initializer.push(a.onnx.TensorProto.decode(l,l.uint32()));break}case 15:{h.sparseInitializer&&h.sparseInitializer.length||(h.sparseInitializer=[]),h.sparseInitializer.push(a.onnx.SparseTensorProto.decode(l,l.uint32()));break}case 10:{h.docString=l.string();break}case 11:{h.input&&h.input.length||(h.input=[]),h.input.push(a.onnx.ValueInfoProto.decode(l,l.uint32()));break}case 12:{h.output&&h.output.length||(h.output=[]),h.output.push(a.onnx.ValueInfoProto.decode(l,l.uint32()));break}case 13:{h.valueInfo&&h.valueInfo.length||(h.valueInfo=[]),h.valueInfo.push(a.onnx.ValueInfoProto.decode(l,l.uint32()));break}case 14:{h.quantizationAnnotation&&h.quantizationAnnotation.length||(h.quantizationAnnotation=[]),h.quantizationAnnotation.push(a.onnx.TensorAnnotation.decode(l,l.uint32()));break}default:l.skipType(p&7);break}}return h},c.decodeDelimited=function(l){return l instanceof r||(l=new r(l)),this.decode(l,l.uint32())},c.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.node!=null&&l.hasOwnProperty("node")){if(!Array.isArray(l.node))return"node: array expected";for(var d=0;d<l.node.length;++d){var u=a.onnx.NodeProto.verify(l.node[d]);if(u)return"node."+u}}if(l.name!=null&&l.hasOwnProperty("name")&&!o.isString(l.name))return"name: string expected";if(l.initializer!=null&&l.hasOwnProperty("initializer")){if(!Array.isArray(l.initializer))return"initializer: array expected";for(var d=0;d<l.initializer.length;++d){var u=a.onnx.TensorProto.verify(l.initializer[d]);if(u)return"initializer."+u}}if(l.sparseInitializer!=null&&l.hasOwnProperty("sparseInitializer")){if(!Array.isArray(l.sparseInitializer))return"sparseInitializer: array expected";for(var d=0;d<l.sparseInitializer.length;++d){var u=a.onnx.SparseTensorProto.verify(l.sparseInitializer[d]);if(u)return"sparseInitializer."+u}}if(l.docString!=null&&l.hasOwnProperty("docString")&&!o.isString(l.docString))return"docString: string expected";if(l.input!=null&&l.hasOwnProperty("input")){if(!Array.isArray(l.input))return"input: array expected";for(var d=0;d<l.input.length;++d){var u=a.onnx.ValueInfoProto.verify(l.input[d]);if(u)return"input."+u}}if(l.output!=null&&l.hasOwnProperty("output")){if(!Array.isArray(l.output))return"output: array expected";for(var d=0;d<l.output.length;++d){var u=a.onnx.ValueInfoProto.verify(l.output[d]);if(u)return"output."+u}}if(l.valueInfo!=null&&l.hasOwnProperty("valueInfo")){if(!Array.isArray(l.valueInfo))return"valueInfo: array expected";for(var d=0;d<l.valueInfo.length;++d){var u=a.onnx.ValueInfoProto.verify(l.valueInfo[d]);if(u)return"valueInfo."+u}}if(l.quantizationAnnotation!=null&&l.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(l.quantizationAnnotation))return"quantizationAnnotation: array expected";for(var d=0;d<l.quantizationAnnotation.length;++d){var u=a.onnx.TensorAnnotation.verify(l.quantizationAnnotation[d]);if(u)return"quantizationAnnotation."+u}}return null},c.fromObject=function(l){if(l instanceof a.onnx.GraphProto)return l;var d=new a.onnx.GraphProto;if(l.node){if(!Array.isArray(l.node))throw TypeError(".onnx.GraphProto.node: array expected");d.node=[];for(var u=0;u<l.node.length;++u){if(typeof l.node[u]!="object")throw TypeError(".onnx.GraphProto.node: object expected");d.node[u]=a.onnx.NodeProto.fromObject(l.node[u])}}if(l.name!=null&&(d.name=String(l.name)),l.initializer){if(!Array.isArray(l.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");d.initializer=[];for(var u=0;u<l.initializer.length;++u){if(typeof l.initializer[u]!="object")throw TypeError(".onnx.GraphProto.initializer: object expected");d.initializer[u]=a.onnx.TensorProto.fromObject(l.initializer[u])}}if(l.sparseInitializer){if(!Array.isArray(l.sparseInitializer))throw TypeError(".onnx.GraphProto.sparseInitializer: array expected");d.sparseInitializer=[];for(var u=0;u<l.sparseInitializer.length;++u){if(typeof l.sparseInitializer[u]!="object")throw TypeError(".onnx.GraphProto.sparseInitializer: object expected");d.sparseInitializer[u]=a.onnx.SparseTensorProto.fromObject(l.sparseInitializer[u])}}if(l.docString!=null&&(d.docString=String(l.docString)),l.input){if(!Array.isArray(l.input))throw TypeError(".onnx.GraphProto.input: array expected");d.input=[];for(var u=0;u<l.input.length;++u){if(typeof l.input[u]!="object")throw TypeError(".onnx.GraphProto.input: object expected");d.input[u]=a.onnx.ValueInfoProto.fromObject(l.input[u])}}if(l.output){if(!Array.isArray(l.output))throw TypeError(".onnx.GraphProto.output: array expected");d.output=[];for(var u=0;u<l.output.length;++u){if(typeof l.output[u]!="object")throw TypeError(".onnx.GraphProto.output: object expected");d.output[u]=a.onnx.ValueInfoProto.fromObject(l.output[u])}}if(l.valueInfo){if(!Array.isArray(l.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");d.valueInfo=[];for(var u=0;u<l.valueInfo.length;++u){if(typeof l.valueInfo[u]!="object")throw TypeError(".onnx.GraphProto.valueInfo: object expected");d.valueInfo[u]=a.onnx.ValueInfoProto.fromObject(l.valueInfo[u])}}if(l.quantizationAnnotation){if(!Array.isArray(l.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");d.quantizationAnnotation=[];for(var u=0;u<l.quantizationAnnotation.length;++u){if(typeof l.quantizationAnnotation[u]!="object")throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");d.quantizationAnnotation[u]=a.onnx.TensorAnnotation.fromObject(l.quantizationAnnotation[u])}}return d},c.toObject=function(l,d){d||(d={});var u={};if((d.arrays||d.defaults)&&(u.node=[],u.initializer=[],u.input=[],u.output=[],u.valueInfo=[],u.quantizationAnnotation=[],u.sparseInitializer=[]),d.defaults&&(u.name="",u.docString=""),l.node&&l.node.length){u.node=[];for(var h=0;h<l.node.length;++h)u.node[h]=a.onnx.NodeProto.toObject(l.node[h],d)}if(l.name!=null&&l.hasOwnProperty("name")&&(u.name=l.name),l.initializer&&l.initializer.length){u.initializer=[];for(var h=0;h<l.initializer.length;++h)u.initializer[h]=a.onnx.TensorProto.toObject(l.initializer[h],d)}if(l.docString!=null&&l.hasOwnProperty("docString")&&(u.docString=l.docString),l.input&&l.input.length){u.input=[];for(var h=0;h<l.input.length;++h)u.input[h]=a.onnx.ValueInfoProto.toObject(l.input[h],d)}if(l.output&&l.output.length){u.output=[];for(var h=0;h<l.output.length;++h)u.output[h]=a.onnx.ValueInfoProto.toObject(l.output[h],d)}if(l.valueInfo&&l.valueInfo.length){u.valueInfo=[];for(var h=0;h<l.valueInfo.length;++h)u.valueInfo[h]=a.onnx.ValueInfoProto.toObject(l.valueInfo[h],d)}if(l.quantizationAnnotation&&l.quantizationAnnotation.length){u.quantizationAnnotation=[];for(var h=0;h<l.quantizationAnnotation.length;++h)u.quantizationAnnotation[h]=a.onnx.TensorAnnotation.toObject(l.quantizationAnnotation[h],d)}if(l.sparseInitializer&&l.sparseInitializer.length){u.sparseInitializer=[];for(var h=0;h<l.sparseInitializer.length;++h)u.sparseInitializer[h]=a.onnx.SparseTensorProto.toObject(l.sparseInitializer[h],d)}return u},c.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},c.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.GraphProto"},c}(),s.TensorProto=function(){function c(l){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],l)for(var d=Object.keys(l),u=0;u<d.length;++u)l[d[u]]!=null&&(this[d[u]]=l[d[u]])}return c.prototype.dims=o.emptyArray,c.prototype.dataType=0,c.prototype.segment=null,c.prototype.floatData=o.emptyArray,c.prototype.int32Data=o.emptyArray,c.prototype.stringData=o.emptyArray,c.prototype.int64Data=o.emptyArray,c.prototype.name="",c.prototype.docString="",c.prototype.rawData=o.newBuffer([]),c.prototype.externalData=o.emptyArray,c.prototype.dataLocation=0,c.prototype.doubleData=o.emptyArray,c.prototype.uint64Data=o.emptyArray,c.create=function(l){return new c(l)},c.encode=function(l,d){if(d||(d=n.create()),l.dims!=null&&l.dims.length){d.uint32(10).fork();for(var u=0;u<l.dims.length;++u)d.int64(l.dims[u]);d.ldelim()}if(l.dataType!=null&&Object.hasOwnProperty.call(l,"dataType")&&d.uint32(16).int32(l.dataType),l.segment!=null&&Object.hasOwnProperty.call(l,"segment")&&a.onnx.TensorProto.Segment.encode(l.segment,d.uint32(26).fork()).ldelim(),l.floatData!=null&&l.floatData.length){d.uint32(34).fork();for(var u=0;u<l.floatData.length;++u)d.float(l.floatData[u]);d.ldelim()}if(l.int32Data!=null&&l.int32Data.length){d.uint32(42).fork();for(var u=0;u<l.int32Data.length;++u)d.int32(l.int32Data[u]);d.ldelim()}if(l.stringData!=null&&l.stringData.length)for(var u=0;u<l.stringData.length;++u)d.uint32(50).bytes(l.stringData[u]);if(l.int64Data!=null&&l.int64Data.length){d.uint32(58).fork();for(var u=0;u<l.int64Data.length;++u)d.int64(l.int64Data[u]);d.ldelim()}if(l.name!=null&&Object.hasOwnProperty.call(l,"name")&&d.uint32(66).string(l.name),l.rawData!=null&&Object.hasOwnProperty.call(l,"rawData")&&d.uint32(74).bytes(l.rawData),l.doubleData!=null&&l.doubleData.length){d.uint32(82).fork();for(var u=0;u<l.doubleData.length;++u)d.double(l.doubleData[u]);d.ldelim()}if(l.uint64Data!=null&&l.uint64Data.length){d.uint32(90).fork();for(var u=0;u<l.uint64Data.length;++u)d.uint64(l.uint64Data[u]);d.ldelim()}if(l.docString!=null&&Object.hasOwnProperty.call(l,"docString")&&d.uint32(98).string(l.docString),l.externalData!=null&&l.externalData.length)for(var u=0;u<l.externalData.length;++u)a.onnx.StringStringEntryProto.encode(l.externalData[u],d.uint32(106).fork()).ldelim();return l.dataLocation!=null&&Object.hasOwnProperty.call(l,"dataLocation")&&d.uint32(112).int32(l.dataLocation),d},c.encodeDelimited=function(l,d){return this.encode(l,d).ldelim()},c.decode=function(l,d){l instanceof r||(l=r.create(l));for(var u=d===void 0?l.len:l.pos+d,h=new a.onnx.TensorProto;l.pos<u;){var p=l.uint32();switch(p>>>3){case 1:{if(h.dims&&h.dims.length||(h.dims=[]),(p&7)===2)for(var m=l.uint32()+l.pos;l.pos<m;)h.dims.push(l.int64());else h.dims.push(l.int64());break}case 2:{h.dataType=l.int32();break}case 3:{h.segment=a.onnx.TensorProto.Segment.decode(l,l.uint32());break}case 4:{if(h.floatData&&h.floatData.length||(h.floatData=[]),(p&7)===2)for(var m=l.uint32()+l.pos;l.pos<m;)h.floatData.push(l.float());else h.floatData.push(l.float());break}case 5:{if(h.int32Data&&h.int32Data.length||(h.int32Data=[]),(p&7)===2)for(var m=l.uint32()+l.pos;l.pos<m;)h.int32Data.push(l.int32());else h.int32Data.push(l.int32());break}case 6:{h.stringData&&h.stringData.length||(h.stringData=[]),h.stringData.push(l.bytes());break}case 7:{if(h.int64Data&&h.int64Data.length||(h.int64Data=[]),(p&7)===2)for(var m=l.uint32()+l.pos;l.pos<m;)h.int64Data.push(l.int64());else h.int64Data.push(l.int64());break}case 8:{h.name=l.string();break}case 12:{h.docString=l.string();break}case 9:{h.rawData=l.bytes();break}case 13:{h.externalData&&h.externalData.length||(h.externalData=[]),h.externalData.push(a.onnx.StringStringEntryProto.decode(l,l.uint32()));break}case 14:{h.dataLocation=l.int32();break}case 10:{if(h.doubleData&&h.doubleData.length||(h.doubleData=[]),(p&7)===2)for(var m=l.uint32()+l.pos;l.pos<m;)h.doubleData.push(l.double());else h.doubleData.push(l.double());break}case 11:{if(h.uint64Data&&h.uint64Data.length||(h.uint64Data=[]),(p&7)===2)for(var m=l.uint32()+l.pos;l.pos<m;)h.uint64Data.push(l.uint64());else h.uint64Data.push(l.uint64());break}default:l.skipType(p&7);break}}return h},c.decodeDelimited=function(l){return l instanceof r||(l=new r(l)),this.decode(l,l.uint32())},c.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.dims!=null&&l.hasOwnProperty("dims")){if(!Array.isArray(l.dims))return"dims: array expected";for(var d=0;d<l.dims.length;++d)if(!o.isInteger(l.dims[d])&&!(l.dims[d]&&o.isInteger(l.dims[d].low)&&o.isInteger(l.dims[d].high)))return"dims: integer|Long[] expected"}if(l.dataType!=null&&l.hasOwnProperty("dataType")&&!o.isInteger(l.dataType))return"dataType: integer expected";if(l.segment!=null&&l.hasOwnProperty("segment")){var u=a.onnx.TensorProto.Segment.verify(l.segment);if(u)return"segment."+u}if(l.floatData!=null&&l.hasOwnProperty("floatData")){if(!Array.isArray(l.floatData))return"floatData: array expected";for(var d=0;d<l.floatData.length;++d)if(typeof l.floatData[d]!="number")return"floatData: number[] expected"}if(l.int32Data!=null&&l.hasOwnProperty("int32Data")){if(!Array.isArray(l.int32Data))return"int32Data: array expected";for(var d=0;d<l.int32Data.length;++d)if(!o.isInteger(l.int32Data[d]))return"int32Data: integer[] expected"}if(l.stringData!=null&&l.hasOwnProperty("stringData")){if(!Array.isArray(l.stringData))return"stringData: array expected";for(var d=0;d<l.stringData.length;++d)if(!(l.stringData[d]&&typeof l.stringData[d].length=="number"||o.isString(l.stringData[d])))return"stringData: buffer[] expected"}if(l.int64Data!=null&&l.hasOwnProperty("int64Data")){if(!Array.isArray(l.int64Data))return"int64Data: array expected";for(var d=0;d<l.int64Data.length;++d)if(!o.isInteger(l.int64Data[d])&&!(l.int64Data[d]&&o.isInteger(l.int64Data[d].low)&&o.isInteger(l.int64Data[d].high)))return"int64Data: integer|Long[] expected"}if(l.name!=null&&l.hasOwnProperty("name")&&!o.isString(l.name))return"name: string expected";if(l.docString!=null&&l.hasOwnProperty("docString")&&!o.isString(l.docString))return"docString: string expected";if(l.rawData!=null&&l.hasOwnProperty("rawData")&&!(l.rawData&&typeof l.rawData.length=="number"||o.isString(l.rawData)))return"rawData: buffer expected";if(l.externalData!=null&&l.hasOwnProperty("externalData")){if(!Array.isArray(l.externalData))return"externalData: array expected";for(var d=0;d<l.externalData.length;++d){var u=a.onnx.StringStringEntryProto.verify(l.externalData[d]);if(u)return"externalData."+u}}if(l.dataLocation!=null&&l.hasOwnProperty("dataLocation"))switch(l.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:break}if(l.doubleData!=null&&l.hasOwnProperty("doubleData")){if(!Array.isArray(l.doubleData))return"doubleData: array expected";for(var d=0;d<l.doubleData.length;++d)if(typeof l.doubleData[d]!="number")return"doubleData: number[] expected"}if(l.uint64Data!=null&&l.hasOwnProperty("uint64Data")){if(!Array.isArray(l.uint64Data))return"uint64Data: array expected";for(var d=0;d<l.uint64Data.length;++d)if(!o.isInteger(l.uint64Data[d])&&!(l.uint64Data[d]&&o.isInteger(l.uint64Data[d].low)&&o.isInteger(l.uint64Data[d].high)))return"uint64Data: integer|Long[] expected"}return null},c.fromObject=function(l){if(l instanceof a.onnx.TensorProto)return l;var d=new a.onnx.TensorProto;if(l.dims){if(!Array.isArray(l.dims))throw TypeError(".onnx.TensorProto.dims: array expected");d.dims=[];for(var u=0;u<l.dims.length;++u)o.Long?(d.dims[u]=o.Long.fromValue(l.dims[u])).unsigned=!1:typeof l.dims[u]=="string"?d.dims[u]=parseInt(l.dims[u],10):typeof l.dims[u]=="number"?d.dims[u]=l.dims[u]:typeof l.dims[u]=="object"&&(d.dims[u]=new o.LongBits(l.dims[u].low>>>0,l.dims[u].high>>>0).toNumber())}if(l.dataType!=null&&(d.dataType=l.dataType|0),l.segment!=null){if(typeof l.segment!="object")throw TypeError(".onnx.TensorProto.segment: object expected");d.segment=a.onnx.TensorProto.Segment.fromObject(l.segment)}if(l.floatData){if(!Array.isArray(l.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");d.floatData=[];for(var u=0;u<l.floatData.length;++u)d.floatData[u]=Number(l.floatData[u])}if(l.int32Data){if(!Array.isArray(l.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");d.int32Data=[];for(var u=0;u<l.int32Data.length;++u)d.int32Data[u]=l.int32Data[u]|0}if(l.stringData){if(!Array.isArray(l.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");d.stringData=[];for(var u=0;u<l.stringData.length;++u)typeof l.stringData[u]=="string"?o.base64.decode(l.stringData[u],d.stringData[u]=o.newBuffer(o.base64.length(l.stringData[u])),0):l.stringData[u].length>=0&&(d.stringData[u]=l.stringData[u])}if(l.int64Data){if(!Array.isArray(l.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");d.int64Data=[];for(var u=0;u<l.int64Data.length;++u)o.Long?(d.int64Data[u]=o.Long.fromValue(l.int64Data[u])).unsigned=!1:typeof l.int64Data[u]=="string"?d.int64Data[u]=parseInt(l.int64Data[u],10):typeof l.int64Data[u]=="number"?d.int64Data[u]=l.int64Data[u]:typeof l.int64Data[u]=="object"&&(d.int64Data[u]=new o.LongBits(l.int64Data[u].low>>>0,l.int64Data[u].high>>>0).toNumber())}if(l.name!=null&&(d.name=String(l.name)),l.docString!=null&&(d.docString=String(l.docString)),l.rawData!=null&&(typeof l.rawData=="string"?o.base64.decode(l.rawData,d.rawData=o.newBuffer(o.base64.length(l.rawData)),0):l.rawData.length>=0&&(d.rawData=l.rawData)),l.externalData){if(!Array.isArray(l.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");d.externalData=[];for(var u=0;u<l.externalData.length;++u){if(typeof l.externalData[u]!="object")throw TypeError(".onnx.TensorProto.externalData: object expected");d.externalData[u]=a.onnx.StringStringEntryProto.fromObject(l.externalData[u])}}switch(l.dataLocation){default:if(typeof l.dataLocation=="number"){d.dataLocation=l.dataLocation;break}break;case"DEFAULT":case 0:d.dataLocation=0;break;case"EXTERNAL":case 1:d.dataLocation=1;break}if(l.doubleData){if(!Array.isArray(l.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");d.doubleData=[];for(var u=0;u<l.doubleData.length;++u)d.doubleData[u]=Number(l.doubleData[u])}if(l.uint64Data){if(!Array.isArray(l.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");d.uint64Data=[];for(var u=0;u<l.uint64Data.length;++u)o.Long?(d.uint64Data[u]=o.Long.fromValue(l.uint64Data[u])).unsigned=!0:typeof l.uint64Data[u]=="string"?d.uint64Data[u]=parseInt(l.uint64Data[u],10):typeof l.uint64Data[u]=="number"?d.uint64Data[u]=l.uint64Data[u]:typeof l.uint64Data[u]=="object"&&(d.uint64Data[u]=new o.LongBits(l.uint64Data[u].low>>>0,l.uint64Data[u].high>>>0).toNumber(!0))}return d},c.toObject=function(l,d){d||(d={});var u={};if((d.arrays||d.defaults)&&(u.dims=[],u.floatData=[],u.int32Data=[],u.stringData=[],u.int64Data=[],u.doubleData=[],u.uint64Data=[],u.externalData=[]),d.defaults&&(u.dataType=0,u.segment=null,u.name="",d.bytes===String?u.rawData="":(u.rawData=[],d.bytes!==Array&&(u.rawData=o.newBuffer(u.rawData))),u.docString="",u.dataLocation=d.enums===String?"DEFAULT":0),l.dims&&l.dims.length){u.dims=[];for(var h=0;h<l.dims.length;++h)typeof l.dims[h]=="number"?u.dims[h]=d.longs===String?String(l.dims[h]):l.dims[h]:u.dims[h]=d.longs===String?o.Long.prototype.toString.call(l.dims[h]):d.longs===Number?new o.LongBits(l.dims[h].low>>>0,l.dims[h].high>>>0).toNumber():l.dims[h]}if(l.dataType!=null&&l.hasOwnProperty("dataType")&&(u.dataType=l.dataType),l.segment!=null&&l.hasOwnProperty("segment")&&(u.segment=a.onnx.TensorProto.Segment.toObject(l.segment,d)),l.floatData&&l.floatData.length){u.floatData=[];for(var h=0;h<l.floatData.length;++h)u.floatData[h]=d.json&&!isFinite(l.floatData[h])?String(l.floatData[h]):l.floatData[h]}if(l.int32Data&&l.int32Data.length){u.int32Data=[];for(var h=0;h<l.int32Data.length;++h)u.int32Data[h]=l.int32Data[h]}if(l.stringData&&l.stringData.length){u.stringData=[];for(var h=0;h<l.stringData.length;++h)u.stringData[h]=d.bytes===String?o.base64.encode(l.stringData[h],0,l.stringData[h].length):d.bytes===Array?Array.prototype.slice.call(l.stringData[h]):l.stringData[h]}if(l.int64Data&&l.int64Data.length){u.int64Data=[];for(var h=0;h<l.int64Data.length;++h)typeof l.int64Data[h]=="number"?u.int64Data[h]=d.longs===String?String(l.int64Data[h]):l.int64Data[h]:u.int64Data[h]=d.longs===String?o.Long.prototype.toString.call(l.int64Data[h]):d.longs===Number?new o.LongBits(l.int64Data[h].low>>>0,l.int64Data[h].high>>>0).toNumber():l.int64Data[h]}if(l.name!=null&&l.hasOwnProperty("name")&&(u.name=l.name),l.rawData!=null&&l.hasOwnProperty("rawData")&&(u.rawData=d.bytes===String?o.base64.encode(l.rawData,0,l.rawData.length):d.bytes===Array?Array.prototype.slice.call(l.rawData):l.rawData),l.doubleData&&l.doubleData.length){u.doubleData=[];for(var h=0;h<l.doubleData.length;++h)u.doubleData[h]=d.json&&!isFinite(l.doubleData[h])?String(l.doubleData[h]):l.doubleData[h]}if(l.uint64Data&&l.uint64Data.length){u.uint64Data=[];for(var h=0;h<l.uint64Data.length;++h)typeof l.uint64Data[h]=="number"?u.uint64Data[h]=d.longs===String?String(l.uint64Data[h]):l.uint64Data[h]:u.uint64Data[h]=d.longs===String?o.Long.prototype.toString.call(l.uint64Data[h]):d.longs===Number?new o.LongBits(l.uint64Data[h].low>>>0,l.uint64Data[h].high>>>0).toNumber(!0):l.uint64Data[h]}if(l.docString!=null&&l.hasOwnProperty("docString")&&(u.docString=l.docString),l.externalData&&l.externalData.length){u.externalData=[];for(var h=0;h<l.externalData.length;++h)u.externalData[h]=a.onnx.StringStringEntryProto.toObject(l.externalData[h],d)}return l.dataLocation!=null&&l.hasOwnProperty("dataLocation")&&(u.dataLocation=d.enums===String?a.onnx.TensorProto.DataLocation[l.dataLocation]===void 0?l.dataLocation:a.onnx.TensorProto.DataLocation[l.dataLocation]:l.dataLocation),u},c.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},c.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.TensorProto"},c.DataType=function(){var l={},d=Object.create(l);return d[l[0]="UNDEFINED"]=0,d[l[1]="FLOAT"]=1,d[l[2]="UINT8"]=2,d[l[3]="INT8"]=3,d[l[4]="UINT16"]=4,d[l[5]="INT16"]=5,d[l[6]="INT32"]=6,d[l[7]="INT64"]=7,d[l[8]="STRING"]=8,d[l[9]="BOOL"]=9,d[l[10]="FLOAT16"]=10,d[l[11]="DOUBLE"]=11,d[l[12]="UINT32"]=12,d[l[13]="UINT64"]=13,d[l[14]="COMPLEX64"]=14,d[l[15]="COMPLEX128"]=15,d[l[16]="BFLOAT16"]=16,d[l[17]="FLOAT8E4M3FN"]=17,d[l[18]="FLOAT8E4M3FNUZ"]=18,d[l[19]="FLOAT8E5M2"]=19,d[l[20]="FLOAT8E5M2FNUZ"]=20,d}(),c.Segment=function(){function l(d){if(d)for(var u=Object.keys(d),h=0;h<u.length;++h)d[u[h]]!=null&&(this[u[h]]=d[u[h]])}return l.prototype.begin=o.Long?o.Long.fromBits(0,0,!1):0,l.prototype.end=o.Long?o.Long.fromBits(0,0,!1):0,l.create=function(d){return new l(d)},l.encode=function(d,u){return u||(u=n.create()),d.begin!=null&&Object.hasOwnProperty.call(d,"begin")&&u.uint32(8).int64(d.begin),d.end!=null&&Object.hasOwnProperty.call(d,"end")&&u.uint32(16).int64(d.end),u},l.encodeDelimited=function(d,u){return this.encode(d,u).ldelim()},l.decode=function(d,u){d instanceof r||(d=r.create(d));for(var h=u===void 0?d.len:d.pos+u,p=new a.onnx.TensorProto.Segment;d.pos<h;){var m=d.uint32();switch(m>>>3){case 1:{p.begin=d.int64();break}case 2:{p.end=d.int64();break}default:d.skipType(m&7);break}}return p},l.decodeDelimited=function(d){return d instanceof r||(d=new r(d)),this.decode(d,d.uint32())},l.verify=function(d){return typeof d!="object"||d===null?"object expected":d.begin!=null&&d.hasOwnProperty("begin")&&!o.isInteger(d.begin)&&!(d.begin&&o.isInteger(d.begin.low)&&o.isInteger(d.begin.high))?"begin: integer|Long expected":d.end!=null&&d.hasOwnProperty("end")&&!o.isInteger(d.end)&&!(d.end&&o.isInteger(d.end.low)&&o.isInteger(d.end.high))?"end: integer|Long expected":null},l.fromObject=function(d){if(d instanceof a.onnx.TensorProto.Segment)return d;var u=new a.onnx.TensorProto.Segment;return d.begin!=null&&(o.Long?(u.begin=o.Long.fromValue(d.begin)).unsigned=!1:typeof d.begin=="string"?u.begin=parseInt(d.begin,10):typeof d.begin=="number"?u.begin=d.begin:typeof d.begin=="object"&&(u.begin=new o.LongBits(d.begin.low>>>0,d.begin.high>>>0).toNumber())),d.end!=null&&(o.Long?(u.end=o.Long.fromValue(d.end)).unsigned=!1:typeof d.end=="string"?u.end=parseInt(d.end,10):typeof d.end=="number"?u.end=d.end:typeof d.end=="object"&&(u.end=new o.LongBits(d.end.low>>>0,d.end.high>>>0).toNumber())),u},l.toObject=function(d,u){u||(u={});var h={};if(u.defaults){if(o.Long){var p=new o.Long(0,0,!1);h.begin=u.longs===String?p.toString():u.longs===Number?p.toNumber():p}else h.begin=u.longs===String?"0":0;if(o.Long){var p=new o.Long(0,0,!1);h.end=u.longs===String?p.toString():u.longs===Number?p.toNumber():p}else h.end=u.longs===String?"0":0}return d.begin!=null&&d.hasOwnProperty("begin")&&(typeof d.begin=="number"?h.begin=u.longs===String?String(d.begin):d.begin:h.begin=u.longs===String?o.Long.prototype.toString.call(d.begin):u.longs===Number?new o.LongBits(d.begin.low>>>0,d.begin.high>>>0).toNumber():d.begin),d.end!=null&&d.hasOwnProperty("end")&&(typeof d.end=="number"?h.end=u.longs===String?String(d.end):d.end:h.end=u.longs===String?o.Long.prototype.toString.call(d.end):u.longs===Number?new o.LongBits(d.end.low>>>0,d.end.high>>>0).toNumber():d.end),h},l.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},l.getTypeUrl=function(d){return d===void 0&&(d="type.googleapis.com"),d+"/onnx.TensorProto.Segment"},l}(),c.DataLocation=function(){var l={},d=Object.create(l);return d[l[0]="DEFAULT"]=0,d[l[1]="EXTERNAL"]=1,d}(),c}(),s.SparseTensorProto=function(){function c(l){if(this.dims=[],l)for(var d=Object.keys(l),u=0;u<d.length;++u)l[d[u]]!=null&&(this[d[u]]=l[d[u]])}return c.prototype.values=null,c.prototype.indices=null,c.prototype.dims=o.emptyArray,c.create=function(l){return new c(l)},c.encode=function(l,d){if(d||(d=n.create()),l.values!=null&&Object.hasOwnProperty.call(l,"values")&&a.onnx.TensorProto.encode(l.values,d.uint32(10).fork()).ldelim(),l.indices!=null&&Object.hasOwnProperty.call(l,"indices")&&a.onnx.TensorProto.encode(l.indices,d.uint32(18).fork()).ldelim(),l.dims!=null&&l.dims.length){d.uint32(26).fork();for(var u=0;u<l.dims.length;++u)d.int64(l.dims[u]);d.ldelim()}return d},c.encodeDelimited=function(l,d){return this.encode(l,d).ldelim()},c.decode=function(l,d){l instanceof r||(l=r.create(l));for(var u=d===void 0?l.len:l.pos+d,h=new a.onnx.SparseTensorProto;l.pos<u;){var p=l.uint32();switch(p>>>3){case 1:{h.values=a.onnx.TensorProto.decode(l,l.uint32());break}case 2:{h.indices=a.onnx.TensorProto.decode(l,l.uint32());break}case 3:{if(h.dims&&h.dims.length||(h.dims=[]),(p&7)===2)for(var m=l.uint32()+l.pos;l.pos<m;)h.dims.push(l.int64());else h.dims.push(l.int64());break}default:l.skipType(p&7);break}}return h},c.decodeDelimited=function(l){return l instanceof r||(l=new r(l)),this.decode(l,l.uint32())},c.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.values!=null&&l.hasOwnProperty("values")){var d=a.onnx.TensorProto.verify(l.values);if(d)return"values."+d}if(l.indices!=null&&l.hasOwnProperty("indices")){var d=a.onnx.TensorProto.verify(l.indices);if(d)return"indices."+d}if(l.dims!=null&&l.hasOwnProperty("dims")){if(!Array.isArray(l.dims))return"dims: array expected";for(var u=0;u<l.dims.length;++u)if(!o.isInteger(l.dims[u])&&!(l.dims[u]&&o.isInteger(l.dims[u].low)&&o.isInteger(l.dims[u].high)))return"dims: integer|Long[] expected"}return null},c.fromObject=function(l){if(l instanceof a.onnx.SparseTensorProto)return l;var d=new a.onnx.SparseTensorProto;if(l.values!=null){if(typeof l.values!="object")throw TypeError(".onnx.SparseTensorProto.values: object expected");d.values=a.onnx.TensorProto.fromObject(l.values)}if(l.indices!=null){if(typeof l.indices!="object")throw TypeError(".onnx.SparseTensorProto.indices: object expected");d.indices=a.onnx.TensorProto.fromObject(l.indices)}if(l.dims){if(!Array.isArray(l.dims))throw TypeError(".onnx.SparseTensorProto.dims: array expected");d.dims=[];for(var u=0;u<l.dims.length;++u)o.Long?(d.dims[u]=o.Long.fromValue(l.dims[u])).unsigned=!1:typeof l.dims[u]=="string"?d.dims[u]=parseInt(l.dims[u],10):typeof l.dims[u]=="number"?d.dims[u]=l.dims[u]:typeof l.dims[u]=="object"&&(d.dims[u]=new o.LongBits(l.dims[u].low>>>0,l.dims[u].high>>>0).toNumber())}return d},c.toObject=function(l,d){d||(d={});var u={};if((d.arrays||d.defaults)&&(u.dims=[]),d.defaults&&(u.values=null,u.indices=null),l.values!=null&&l.hasOwnProperty("values")&&(u.values=a.onnx.TensorProto.toObject(l.values,d)),l.indices!=null&&l.hasOwnProperty("indices")&&(u.indices=a.onnx.TensorProto.toObject(l.indices,d)),l.dims&&l.dims.length){u.dims=[];for(var h=0;h<l.dims.length;++h)typeof l.dims[h]=="number"?u.dims[h]=d.longs===String?String(l.dims[h]):l.dims[h]:u.dims[h]=d.longs===String?o.Long.prototype.toString.call(l.dims[h]):d.longs===Number?new o.LongBits(l.dims[h].low>>>0,l.dims[h].high>>>0).toNumber():l.dims[h]}return u},c.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},c.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.SparseTensorProto"},c}(),s.TensorShapeProto=function(){function c(l){if(this.dim=[],l)for(var d=Object.keys(l),u=0;u<d.length;++u)l[d[u]]!=null&&(this[d[u]]=l[d[u]])}return c.prototype.dim=o.emptyArray,c.create=function(l){return new c(l)},c.encode=function(l,d){if(d||(d=n.create()),l.dim!=null&&l.dim.length)for(var u=0;u<l.dim.length;++u)a.onnx.TensorShapeProto.Dimension.encode(l.dim[u],d.uint32(10).fork()).ldelim();return d},c.encodeDelimited=function(l,d){return this.encode(l,d).ldelim()},c.decode=function(l,d){l instanceof r||(l=r.create(l));for(var u=d===void 0?l.len:l.pos+d,h=new a.onnx.TensorShapeProto;l.pos<u;){var p=l.uint32();switch(p>>>3){case 1:{h.dim&&h.dim.length||(h.dim=[]),h.dim.push(a.onnx.TensorShapeProto.Dimension.decode(l,l.uint32()));break}default:l.skipType(p&7);break}}return h},c.decodeDelimited=function(l){return l instanceof r||(l=new r(l)),this.decode(l,l.uint32())},c.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.dim!=null&&l.hasOwnProperty("dim")){if(!Array.isArray(l.dim))return"dim: array expected";for(var d=0;d<l.dim.length;++d){var u=a.onnx.TensorShapeProto.Dimension.verify(l.dim[d]);if(u)return"dim."+u}}return null},c.fromObject=function(l){if(l instanceof a.onnx.TensorShapeProto)return l;var d=new a.onnx.TensorShapeProto;if(l.dim){if(!Array.isArray(l.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");d.dim=[];for(var u=0;u<l.dim.length;++u){if(typeof l.dim[u]!="object")throw TypeError(".onnx.TensorShapeProto.dim: object expected");d.dim[u]=a.onnx.TensorShapeProto.Dimension.fromObject(l.dim[u])}}return d},c.toObject=function(l,d){d||(d={});var u={};if((d.arrays||d.defaults)&&(u.dim=[]),l.dim&&l.dim.length){u.dim=[];for(var h=0;h<l.dim.length;++h)u.dim[h]=a.onnx.TensorShapeProto.Dimension.toObject(l.dim[h],d)}return u},c.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},c.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.TensorShapeProto"},c.Dimension=function(){function l(u){if(u)for(var h=Object.keys(u),p=0;p<h.length;++p)u[h[p]]!=null&&(this[h[p]]=u[h[p]])}l.prototype.dimValue=null,l.prototype.dimParam=null,l.prototype.denotation="";var d;return Object.defineProperty(l.prototype,"value",{get:o.oneOfGetter(d=["dimValue","dimParam"]),set:o.oneOfSetter(d)}),l.create=function(u){return new l(u)},l.encode=function(u,h){return h||(h=n.create()),u.dimValue!=null&&Object.hasOwnProperty.call(u,"dimValue")&&h.uint32(8).int64(u.dimValue),u.dimParam!=null&&Object.hasOwnProperty.call(u,"dimParam")&&h.uint32(18).string(u.dimParam),u.denotation!=null&&Object.hasOwnProperty.call(u,"denotation")&&h.uint32(26).string(u.denotation),h},l.encodeDelimited=function(u,h){return this.encode(u,h).ldelim()},l.decode=function(u,h){u instanceof r||(u=r.create(u));for(var p=h===void 0?u.len:u.pos+h,m=new a.onnx.TensorShapeProto.Dimension;u.pos<p;){var f=u.uint32();switch(f>>>3){case 1:{m.dimValue=u.int64();break}case 2:{m.dimParam=u.string();break}case 3:{m.denotation=u.string();break}default:u.skipType(f&7);break}}return m},l.decodeDelimited=function(u){return u instanceof r||(u=new r(u)),this.decode(u,u.uint32())},l.verify=function(u){if(typeof u!="object"||u===null)return"object expected";var h={};if(u.dimValue!=null&&u.hasOwnProperty("dimValue")&&(h.value=1,!o.isInteger(u.dimValue)&&!(u.dimValue&&o.isInteger(u.dimValue.low)&&o.isInteger(u.dimValue.high))))return"dimValue: integer|Long expected";if(u.dimParam!=null&&u.hasOwnProperty("dimParam")){if(h.value===1)return"value: multiple values";if(h.value=1,!o.isString(u.dimParam))return"dimParam: string expected"}return u.denotation!=null&&u.hasOwnProperty("denotation")&&!o.isString(u.denotation)?"denotation: string expected":null},l.fromObject=function(u){if(u instanceof a.onnx.TensorShapeProto.Dimension)return u;var h=new a.onnx.TensorShapeProto.Dimension;return u.dimValue!=null&&(o.Long?(h.dimValue=o.Long.fromValue(u.dimValue)).unsigned=!1:typeof u.dimValue=="string"?h.dimValue=parseInt(u.dimValue,10):typeof u.dimValue=="number"?h.dimValue=u.dimValue:typeof u.dimValue=="object"&&(h.dimValue=new o.LongBits(u.dimValue.low>>>0,u.dimValue.high>>>0).toNumber())),u.dimParam!=null&&(h.dimParam=String(u.dimParam)),u.denotation!=null&&(h.denotation=String(u.denotation)),h},l.toObject=function(u,h){h||(h={});var p={};return h.defaults&&(p.denotation=""),u.dimValue!=null&&u.hasOwnProperty("dimValue")&&(typeof u.dimValue=="number"?p.dimValue=h.longs===String?String(u.dimValue):u.dimValue:p.dimValue=h.longs===String?o.Long.prototype.toString.call(u.dimValue):h.longs===Number?new o.LongBits(u.dimValue.low>>>0,u.dimValue.high>>>0).toNumber():u.dimValue,h.oneofs&&(p.value="dimValue")),u.dimParam!=null&&u.hasOwnProperty("dimParam")&&(p.dimParam=u.dimParam,h.oneofs&&(p.value="dimParam")),u.denotation!=null&&u.hasOwnProperty("denotation")&&(p.denotation=u.denotation),p},l.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},l.getTypeUrl=function(u){return u===void 0&&(u="type.googleapis.com"),u+"/onnx.TensorShapeProto.Dimension"},l}(),c}(),s.TypeProto=function(){function c(d){if(d)for(var u=Object.keys(d),h=0;h<u.length;++h)d[u[h]]!=null&&(this[u[h]]=d[u[h]])}c.prototype.tensorType=null,c.prototype.sequenceType=null,c.prototype.mapType=null,c.prototype.optionalType=null,c.prototype.sparseTensorType=null,c.prototype.denotation="";var l;return Object.defineProperty(c.prototype,"value",{get:o.oneOfGetter(l=["tensorType","sequenceType","mapType","optionalType","sparseTensorType"]),set:o.oneOfSetter(l)}),c.create=function(d){return new c(d)},c.encode=function(d,u){return u||(u=n.create()),d.tensorType!=null&&Object.hasOwnProperty.call(d,"tensorType")&&a.onnx.TypeProto.Tensor.encode(d.tensorType,u.uint32(10).fork()).ldelim(),d.sequenceType!=null&&Object.hasOwnProperty.call(d,"sequenceType")&&a.onnx.TypeProto.Sequence.encode(d.sequenceType,u.uint32(34).fork()).ldelim(),d.mapType!=null&&Object.hasOwnProperty.call(d,"mapType")&&a.onnx.TypeProto.Map.encode(d.mapType,u.uint32(42).fork()).ldelim(),d.denotation!=null&&Object.hasOwnProperty.call(d,"denotation")&&u.uint32(50).string(d.denotation),d.sparseTensorType!=null&&Object.hasOwnProperty.call(d,"sparseTensorType")&&a.onnx.TypeProto.SparseTensor.encode(d.sparseTensorType,u.uint32(66).fork()).ldelim(),d.optionalType!=null&&Object.hasOwnProperty.call(d,"optionalType")&&a.onnx.TypeProto.Optional.encode(d.optionalType,u.uint32(74).fork()).ldelim(),u},c.encodeDelimited=function(d,u){return this.encode(d,u).ldelim()},c.decode=function(d,u){d instanceof r||(d=r.create(d));for(var h=u===void 0?d.len:d.pos+u,p=new a.onnx.TypeProto;d.pos<h;){var m=d.uint32();switch(m>>>3){case 1:{p.tensorType=a.onnx.TypeProto.Tensor.decode(d,d.uint32());break}case 4:{p.sequenceType=a.onnx.TypeProto.Sequence.decode(d,d.uint32());break}case 5:{p.mapType=a.onnx.TypeProto.Map.decode(d,d.uint32());break}case 9:{p.optionalType=a.onnx.TypeProto.Optional.decode(d,d.uint32());break}case 8:{p.sparseTensorType=a.onnx.TypeProto.SparseTensor.decode(d,d.uint32());break}case 6:{p.denotation=d.string();break}default:d.skipType(m&7);break}}return p},c.decodeDelimited=function(d){return d instanceof r||(d=new r(d)),this.decode(d,d.uint32())},c.verify=function(d){if(typeof d!="object"||d===null)return"object expected";var u={};if(d.tensorType!=null&&d.hasOwnProperty("tensorType")){u.value=1;{var h=a.onnx.TypeProto.Tensor.verify(d.tensorType);if(h)return"tensorType."+h}}if(d.sequenceType!=null&&d.hasOwnProperty("sequenceType")){if(u.value===1)return"value: multiple values";u.value=1;{var h=a.onnx.TypeProto.Sequence.verify(d.sequenceType);if(h)return"sequenceType."+h}}if(d.mapType!=null&&d.hasOwnProperty("mapType")){if(u.value===1)return"value: multiple values";u.value=1;{var h=a.onnx.TypeProto.Map.verify(d.mapType);if(h)return"mapType."+h}}if(d.optionalType!=null&&d.hasOwnProperty("optionalType")){if(u.value===1)return"value: multiple values";u.value=1;{var h=a.onnx.TypeProto.Optional.verify(d.optionalType);if(h)return"optionalType."+h}}if(d.sparseTensorType!=null&&d.hasOwnProperty("sparseTensorType")){if(u.value===1)return"value: multiple values";u.value=1;{var h=a.onnx.TypeProto.SparseTensor.verify(d.sparseTensorType);if(h)return"sparseTensorType."+h}}return d.denotation!=null&&d.hasOwnProperty("denotation")&&!o.isString(d.denotation)?"denotation: string expected":null},c.fromObject=function(d){if(d instanceof a.onnx.TypeProto)return d;var u=new a.onnx.TypeProto;if(d.tensorType!=null){if(typeof d.tensorType!="object")throw TypeError(".onnx.TypeProto.tensorType: object expected");u.tensorType=a.onnx.TypeProto.Tensor.fromObject(d.tensorType)}if(d.sequenceType!=null){if(typeof d.sequenceType!="object")throw TypeError(".onnx.TypeProto.sequenceType: object expected");u.sequenceType=a.onnx.TypeProto.Sequence.fromObject(d.sequenceType)}if(d.mapType!=null){if(typeof d.mapType!="object")throw TypeError(".onnx.TypeProto.mapType: object expected");u.mapType=a.onnx.TypeProto.Map.fromObject(d.mapType)}if(d.optionalType!=null){if(typeof d.optionalType!="object")throw TypeError(".onnx.TypeProto.optionalType: object expected");u.optionalType=a.onnx.TypeProto.Optional.fromObject(d.optionalType)}if(d.sparseTensorType!=null){if(typeof d.sparseTensorType!="object")throw TypeError(".onnx.TypeProto.sparseTensorType: object expected");u.sparseTensorType=a.onnx.TypeProto.SparseTensor.fromObject(d.sparseTensorType)}return d.denotation!=null&&(u.denotation=String(d.denotation)),u},c.toObject=function(d,u){u||(u={});var h={};return u.defaults&&(h.denotation=""),d.tensorType!=null&&d.hasOwnProperty("tensorType")&&(h.tensorType=a.onnx.TypeProto.Tensor.toObject(d.tensorType,u),u.oneofs&&(h.value="tensorType")),d.sequenceType!=null&&d.hasOwnProperty("sequenceType")&&(h.sequenceType=a.onnx.TypeProto.Sequence.toObject(d.sequenceType,u),u.oneofs&&(h.value="sequenceType")),d.mapType!=null&&d.hasOwnProperty("mapType")&&(h.mapType=a.onnx.TypeProto.Map.toObject(d.mapType,u),u.oneofs&&(h.value="mapType")),d.denotation!=null&&d.hasOwnProperty("denotation")&&(h.denotation=d.denotation),d.sparseTensorType!=null&&d.hasOwnProperty("sparseTensorType")&&(h.sparseTensorType=a.onnx.TypeProto.SparseTensor.toObject(d.sparseTensorType,u),u.oneofs&&(h.value="sparseTensorType")),d.optionalType!=null&&d.hasOwnProperty("optionalType")&&(h.optionalType=a.onnx.TypeProto.Optional.toObject(d.optionalType,u),u.oneofs&&(h.value="optionalType")),h},c.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},c.getTypeUrl=function(d){return d===void 0&&(d="type.googleapis.com"),d+"/onnx.TypeProto"},c.Tensor=function(){function d(u){if(u)for(var h=Object.keys(u),p=0;p<h.length;++p)u[h[p]]!=null&&(this[h[p]]=u[h[p]])}return d.prototype.elemType=0,d.prototype.shape=null,d.create=function(u){return new d(u)},d.encode=function(u,h){return h||(h=n.create()),u.elemType!=null&&Object.hasOwnProperty.call(u,"elemType")&&h.uint32(8).int32(u.elemType),u.shape!=null&&Object.hasOwnProperty.call(u,"shape")&&a.onnx.TensorShapeProto.encode(u.shape,h.uint32(18).fork()).ldelim(),h},d.encodeDelimited=function(u,h){return this.encode(u,h).ldelim()},d.decode=function(u,h){u instanceof r||(u=r.create(u));for(var p=h===void 0?u.len:u.pos+h,m=new a.onnx.TypeProto.Tensor;u.pos<p;){var f=u.uint32();switch(f>>>3){case 1:{m.elemType=u.int32();break}case 2:{m.shape=a.onnx.TensorShapeProto.decode(u,u.uint32());break}default:u.skipType(f&7);break}}return m},d.decodeDelimited=function(u){return u instanceof r||(u=new r(u)),this.decode(u,u.uint32())},d.verify=function(u){if(typeof u!="object"||u===null)return"object expected";if(u.elemType!=null&&u.hasOwnProperty("elemType")&&!o.isInteger(u.elemType))return"elemType: integer expected";if(u.shape!=null&&u.hasOwnProperty("shape")){var h=a.onnx.TensorShapeProto.verify(u.shape);if(h)return"shape."+h}return null},d.fromObject=function(u){if(u instanceof a.onnx.TypeProto.Tensor)return u;var h=new a.onnx.TypeProto.Tensor;if(u.elemType!=null&&(h.elemType=u.elemType|0),u.shape!=null){if(typeof u.shape!="object")throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");h.shape=a.onnx.TensorShapeProto.fromObject(u.shape)}return h},d.toObject=function(u,h){h||(h={});var p={};return h.defaults&&(p.elemType=0,p.shape=null),u.elemType!=null&&u.hasOwnProperty("elemType")&&(p.elemType=u.elemType),u.shape!=null&&u.hasOwnProperty("shape")&&(p.shape=a.onnx.TensorShapeProto.toObject(u.shape,h)),p},d.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},d.getTypeUrl=function(u){return u===void 0&&(u="type.googleapis.com"),u+"/onnx.TypeProto.Tensor"},d}(),c.Sequence=function(){function d(u){if(u)for(var h=Object.keys(u),p=0;p<h.length;++p)u[h[p]]!=null&&(this[h[p]]=u[h[p]])}return d.prototype.elemType=null,d.create=function(u){return new d(u)},d.encode=function(u,h){return h||(h=n.create()),u.elemType!=null&&Object.hasOwnProperty.call(u,"elemType")&&a.onnx.TypeProto.encode(u.elemType,h.uint32(10).fork()).ldelim(),h},d.encodeDelimited=function(u,h){return this.encode(u,h).ldelim()},d.decode=function(u,h){u instanceof r||(u=r.create(u));for(var p=h===void 0?u.len:u.pos+h,m=new a.onnx.TypeProto.Sequence;u.pos<p;){var f=u.uint32();switch(f>>>3){case 1:{m.elemType=a.onnx.TypeProto.decode(u,u.uint32());break}default:u.skipType(f&7);break}}return m},d.decodeDelimited=function(u){return u instanceof r||(u=new r(u)),this.decode(u,u.uint32())},d.verify=function(u){if(typeof u!="object"||u===null)return"object expected";if(u.elemType!=null&&u.hasOwnProperty("elemType")){var h=a.onnx.TypeProto.verify(u.elemType);if(h)return"elemType."+h}return null},d.fromObject=function(u){if(u instanceof a.onnx.TypeProto.Sequence)return u;var h=new a.onnx.TypeProto.Sequence;if(u.elemType!=null){if(typeof u.elemType!="object")throw TypeError(".onnx.TypeProto.Sequence.elemType: object expected");h.elemType=a.onnx.TypeProto.fromObject(u.elemType)}return h},d.toObject=function(u,h){h||(h={});var p={};return h.defaults&&(p.elemType=null),u.elemType!=null&&u.hasOwnProperty("elemType")&&(p.elemType=a.onnx.TypeProto.toObject(u.elemType,h)),p},d.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},d.getTypeUrl=function(u){return u===void 0&&(u="type.googleapis.com"),u+"/onnx.TypeProto.Sequence"},d}(),c.Map=function(){function d(u){if(u)for(var h=Object.keys(u),p=0;p<h.length;++p)u[h[p]]!=null&&(this[h[p]]=u[h[p]])}return d.prototype.keyType=0,d.prototype.valueType=null,d.create=function(u){return new d(u)},d.encode=function(u,h){return h||(h=n.create()),u.keyType!=null&&Object.hasOwnProperty.call(u,"keyType")&&h.uint32(8).int32(u.keyType),u.valueType!=null&&Object.hasOwnProperty.call(u,"valueType")&&a.onnx.TypeProto.encode(u.valueType,h.uint32(18).fork()).ldelim(),h},d.encodeDelimited=function(u,h){return this.encode(u,h).ldelim()},d.decode=function(u,h){u instanceof r||(u=r.create(u));for(var p=h===void 0?u.len:u.pos+h,m=new a.onnx.TypeProto.Map;u.pos<p;){var f=u.uint32();switch(f>>>3){case 1:{m.keyType=u.int32();break}case 2:{m.valueType=a.onnx.TypeProto.decode(u,u.uint32());break}default:u.skipType(f&7);break}}return m},d.decodeDelimited=function(u){return u instanceof r||(u=new r(u)),this.decode(u,u.uint32())},d.verify=function(u){if(typeof u!="object"||u===null)return"object expected";if(u.keyType!=null&&u.hasOwnProperty("keyType")&&!o.isInteger(u.keyType))return"keyType: integer expected";if(u.valueType!=null&&u.hasOwnProperty("valueType")){var h=a.onnx.TypeProto.verify(u.valueType);if(h)return"valueType."+h}return null},d.fromObject=function(u){if(u instanceof a.onnx.TypeProto.Map)return u;var h=new a.onnx.TypeProto.Map;if(u.keyType!=null&&(h.keyType=u.keyType|0),u.valueType!=null){if(typeof u.valueType!="object")throw TypeError(".onnx.TypeProto.Map.valueType: object expected");h.valueType=a.onnx.TypeProto.fromObject(u.valueType)}return h},d.toObject=function(u,h){h||(h={});var p={};return h.defaults&&(p.keyType=0,p.valueType=null),u.keyType!=null&&u.hasOwnProperty("keyType")&&(p.keyType=u.keyType),u.valueType!=null&&u.hasOwnProperty("valueType")&&(p.valueType=a.onnx.TypeProto.toObject(u.valueType,h)),p},d.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},d.getTypeUrl=function(u){return u===void 0&&(u="type.googleapis.com"),u+"/onnx.TypeProto.Map"},d}(),c.Optional=function(){function d(u){if(u)for(var h=Object.keys(u),p=0;p<h.length;++p)u[h[p]]!=null&&(this[h[p]]=u[h[p]])}return d.prototype.elemType=null,d.create=function(u){return new d(u)},d.encode=function(u,h){return h||(h=n.create()),u.elemType!=null&&Object.hasOwnProperty.call(u,"elemType")&&a.onnx.TypeProto.encode(u.elemType,h.uint32(10).fork()).ldelim(),h},d.encodeDelimited=function(u,h){return this.encode(u,h).ldelim()},d.decode=function(u,h){u instanceof r||(u=r.create(u));for(var p=h===void 0?u.len:u.pos+h,m=new a.onnx.TypeProto.Optional;u.pos<p;){var f=u.uint32();switch(f>>>3){case 1:{m.elemType=a.onnx.TypeProto.decode(u,u.uint32());break}default:u.skipType(f&7);break}}return m},d.decodeDelimited=function(u){return u instanceof r||(u=new r(u)),this.decode(u,u.uint32())},d.verify=function(u){if(typeof u!="object"||u===null)return"object expected";if(u.elemType!=null&&u.hasOwnProperty("elemType")){var h=a.onnx.TypeProto.verify(u.elemType);if(h)return"elemType."+h}return null},d.fromObject=function(u){if(u instanceof a.onnx.TypeProto.Optional)return u;var h=new a.onnx.TypeProto.Optional;if(u.elemType!=null){if(typeof u.elemType!="object")throw TypeError(".onnx.TypeProto.Optional.elemType: object expected");h.elemType=a.onnx.TypeProto.fromObject(u.elemType)}return h},d.toObject=function(u,h){h||(h={});var p={};return h.defaults&&(p.elemType=null),u.elemType!=null&&u.hasOwnProperty("elemType")&&(p.elemType=a.onnx.TypeProto.toObject(u.elemType,h)),p},d.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},d.getTypeUrl=function(u){return u===void 0&&(u="type.googleapis.com"),u+"/onnx.TypeProto.Optional"},d}(),c.SparseTensor=function(){function d(u){if(u)for(var h=Object.keys(u),p=0;p<h.length;++p)u[h[p]]!=null&&(this[h[p]]=u[h[p]])}return d.prototype.elemType=0,d.prototype.shape=null,d.create=function(u){return new d(u)},d.encode=function(u,h){return h||(h=n.create()),u.elemType!=null&&Object.hasOwnProperty.call(u,"elemType")&&h.uint32(8).int32(u.elemType),u.shape!=null&&Object.hasOwnProperty.call(u,"shape")&&a.onnx.TensorShapeProto.encode(u.shape,h.uint32(18).fork()).ldelim(),h},d.encodeDelimited=function(u,h){return this.encode(u,h).ldelim()},d.decode=function(u,h){u instanceof r||(u=r.create(u));for(var p=h===void 0?u.len:u.pos+h,m=new a.onnx.TypeProto.SparseTensor;u.pos<p;){var f=u.uint32();switch(f>>>3){case 1:{m.elemType=u.int32();break}case 2:{m.shape=a.onnx.TensorShapeProto.decode(u,u.uint32());break}default:u.skipType(f&7);break}}return m},d.decodeDelimited=function(u){return u instanceof r||(u=new r(u)),this.decode(u,u.uint32())},d.verify=function(u){if(typeof u!="object"||u===null)return"object expected";if(u.elemType!=null&&u.hasOwnProperty("elemType")&&!o.isInteger(u.elemType))return"elemType: integer expected";if(u.shape!=null&&u.hasOwnProperty("shape")){var h=a.onnx.TensorShapeProto.verify(u.shape);if(h)return"shape."+h}return null},d.fromObject=function(u){if(u instanceof a.onnx.TypeProto.SparseTensor)return u;var h=new a.onnx.TypeProto.SparseTensor;if(u.elemType!=null&&(h.elemType=u.elemType|0),u.shape!=null){if(typeof u.shape!="object")throw TypeError(".onnx.TypeProto.SparseTensor.shape: object expected");h.shape=a.onnx.TensorShapeProto.fromObject(u.shape)}return h},d.toObject=function(u,h){h||(h={});var p={};return h.defaults&&(p.elemType=0,p.shape=null),u.elemType!=null&&u.hasOwnProperty("elemType")&&(p.elemType=u.elemType),u.shape!=null&&u.hasOwnProperty("shape")&&(p.shape=a.onnx.TensorShapeProto.toObject(u.shape,h)),p},d.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},d.getTypeUrl=function(u){return u===void 0&&(u="type.googleapis.com"),u+"/onnx.TypeProto.SparseTensor"},d}(),c}(),s.OperatorSetIdProto=function(){function c(l){if(l)for(var d=Object.keys(l),u=0;u<d.length;++u)l[d[u]]!=null&&(this[d[u]]=l[d[u]])}return c.prototype.domain="",c.prototype.version=o.Long?o.Long.fromBits(0,0,!1):0,c.create=function(l){return new c(l)},c.encode=function(l,d){return d||(d=n.create()),l.domain!=null&&Object.hasOwnProperty.call(l,"domain")&&d.uint32(10).string(l.domain),l.version!=null&&Object.hasOwnProperty.call(l,"version")&&d.uint32(16).int64(l.version),d},c.encodeDelimited=function(l,d){return this.encode(l,d).ldelim()},c.decode=function(l,d){l instanceof r||(l=r.create(l));for(var u=d===void 0?l.len:l.pos+d,h=new a.onnx.OperatorSetIdProto;l.pos<u;){var p=l.uint32();switch(p>>>3){case 1:{h.domain=l.string();break}case 2:{h.version=l.int64();break}default:l.skipType(p&7);break}}return h},c.decodeDelimited=function(l){return l instanceof r||(l=new r(l)),this.decode(l,l.uint32())},c.verify=function(l){return typeof l!="object"||l===null?"object expected":l.domain!=null&&l.hasOwnProperty("domain")&&!o.isString(l.domain)?"domain: string expected":l.version!=null&&l.hasOwnProperty("version")&&!o.isInteger(l.version)&&!(l.version&&o.isInteger(l.version.low)&&o.isInteger(l.version.high))?"version: integer|Long expected":null},c.fromObject=function(l){if(l instanceof a.onnx.OperatorSetIdProto)return l;var d=new a.onnx.OperatorSetIdProto;return l.domain!=null&&(d.domain=String(l.domain)),l.version!=null&&(o.Long?(d.version=o.Long.fromValue(l.version)).unsigned=!1:typeof l.version=="string"?d.version=parseInt(l.version,10):typeof l.version=="number"?d.version=l.version:typeof l.version=="object"&&(d.version=new o.LongBits(l.version.low>>>0,l.version.high>>>0).toNumber())),d},c.toObject=function(l,d){d||(d={});var u={};if(d.defaults)if(u.domain="",o.Long){var h=new o.Long(0,0,!1);u.version=d.longs===String?h.toString():d.longs===Number?h.toNumber():h}else u.version=d.longs===String?"0":0;return l.domain!=null&&l.hasOwnProperty("domain")&&(u.domain=l.domain),l.version!=null&&l.hasOwnProperty("version")&&(typeof l.version=="number"?u.version=d.longs===String?String(l.version):l.version:u.version=d.longs===String?o.Long.prototype.toString.call(l.version):d.longs===Number?new o.LongBits(l.version.low>>>0,l.version.high>>>0).toNumber():l.version),u},c.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},c.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.OperatorSetIdProto"},c}(),s.OperatorStatus=function(){var c={},l=Object.create(c);return l[c[0]="EXPERIMENTAL"]=0,l[c[1]="STABLE"]=1,l}(),s.FunctionProto=function(){function c(l){if(this.input=[],this.output=[],this.attribute=[],this.attributeProto=[],this.node=[],this.opsetImport=[],l)for(var d=Object.keys(l),u=0;u<d.length;++u)l[d[u]]!=null&&(this[d[u]]=l[d[u]])}return c.prototype.name="",c.prototype.input=o.emptyArray,c.prototype.output=o.emptyArray,c.prototype.attribute=o.emptyArray,c.prototype.attributeProto=o.emptyArray,c.prototype.node=o.emptyArray,c.prototype.docString="",c.prototype.opsetImport=o.emptyArray,c.prototype.domain="",c.create=function(l){return new c(l)},c.encode=function(l,d){if(d||(d=n.create()),l.name!=null&&Object.hasOwnProperty.call(l,"name")&&d.uint32(10).string(l.name),l.input!=null&&l.input.length)for(var u=0;u<l.input.length;++u)d.uint32(34).string(l.input[u]);if(l.output!=null&&l.output.length)for(var u=0;u<l.output.length;++u)d.uint32(42).string(l.output[u]);if(l.attribute!=null&&l.attribute.length)for(var u=0;u<l.attribute.length;++u)d.uint32(50).string(l.attribute[u]);if(l.node!=null&&l.node.length)for(var u=0;u<l.node.length;++u)a.onnx.NodeProto.encode(l.node[u],d.uint32(58).fork()).ldelim();if(l.docString!=null&&Object.hasOwnProperty.call(l,"docString")&&d.uint32(66).string(l.docString),l.opsetImport!=null&&l.opsetImport.length)for(var u=0;u<l.opsetImport.length;++u)a.onnx.OperatorSetIdProto.encode(l.opsetImport[u],d.uint32(74).fork()).ldelim();if(l.domain!=null&&Object.hasOwnProperty.call(l,"domain")&&d.uint32(82).string(l.domain),l.attributeProto!=null&&l.attributeProto.length)for(var u=0;u<l.attributeProto.length;++u)a.onnx.AttributeProto.encode(l.attributeProto[u],d.uint32(90).fork()).ldelim();return d},c.encodeDelimited=function(l,d){return this.encode(l,d).ldelim()},c.decode=function(l,d){l instanceof r||(l=r.create(l));for(var u=d===void 0?l.len:l.pos+d,h=new a.onnx.FunctionProto;l.pos<u;){var p=l.uint32();switch(p>>>3){case 1:{h.name=l.string();break}case 4:{h.input&&h.input.length||(h.input=[]),h.input.push(l.string());break}case 5:{h.output&&h.output.length||(h.output=[]),h.output.push(l.string());break}case 6:{h.attribute&&h.attribute.length||(h.attribute=[]),h.attribute.push(l.string());break}case 11:{h.attributeProto&&h.attributeProto.length||(h.attributeProto=[]),h.attributeProto.push(a.onnx.AttributeProto.decode(l,l.uint32()));break}case 7:{h.node&&h.node.length||(h.node=[]),h.node.push(a.onnx.NodeProto.decode(l,l.uint32()));break}case 8:{h.docString=l.string();break}case 9:{h.opsetImport&&h.opsetImport.length||(h.opsetImport=[]),h.opsetImport.push(a.onnx.OperatorSetIdProto.decode(l,l.uint32()));break}case 10:{h.domain=l.string();break}default:l.skipType(p&7);break}}return h},c.decodeDelimited=function(l){return l instanceof r||(l=new r(l)),this.decode(l,l.uint32())},c.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.name!=null&&l.hasOwnProperty("name")&&!o.isString(l.name))return"name: string expected";if(l.input!=null&&l.hasOwnProperty("input")){if(!Array.isArray(l.input))return"input: array expected";for(var d=0;d<l.input.length;++d)if(!o.isString(l.input[d]))return"input: string[] expected"}if(l.output!=null&&l.hasOwnProperty("output")){if(!Array.isArray(l.output))return"output: array expected";for(var d=0;d<l.output.length;++d)if(!o.isString(l.output[d]))return"output: string[] expected"}if(l.attribute!=null&&l.hasOwnProperty("attribute")){if(!Array.isArray(l.attribute))return"attribute: array expected";for(var d=0;d<l.attribute.length;++d)if(!o.isString(l.attribute[d]))return"attribute: string[] expected"}if(l.attributeProto!=null&&l.hasOwnProperty("attributeProto")){if(!Array.isArray(l.attributeProto))return"attributeProto: array expected";for(var d=0;d<l.attributeProto.length;++d){var u=a.onnx.AttributeProto.verify(l.attributeProto[d]);if(u)return"attributeProto."+u}}if(l.node!=null&&l.hasOwnProperty("node")){if(!Array.isArray(l.node))return"node: array expected";for(var d=0;d<l.node.length;++d){var u=a.onnx.NodeProto.verify(l.node[d]);if(u)return"node."+u}}if(l.docString!=null&&l.hasOwnProperty("docString")&&!o.isString(l.docString))return"docString: string expected";if(l.opsetImport!=null&&l.hasOwnProperty("opsetImport")){if(!Array.isArray(l.opsetImport))return"opsetImport: array expected";for(var d=0;d<l.opsetImport.length;++d){var u=a.onnx.OperatorSetIdProto.verify(l.opsetImport[d]);if(u)return"opsetImport."+u}}return l.domain!=null&&l.hasOwnProperty("domain")&&!o.isString(l.domain)?"domain: string expected":null},c.fromObject=function(l){if(l instanceof a.onnx.FunctionProto)return l;var d=new a.onnx.FunctionProto;if(l.name!=null&&(d.name=String(l.name)),l.input){if(!Array.isArray(l.input))throw TypeError(".onnx.FunctionProto.input: array expected");d.input=[];for(var u=0;u<l.input.length;++u)d.input[u]=String(l.input[u])}if(l.output){if(!Array.isArray(l.output))throw TypeError(".onnx.FunctionProto.output: array expected");d.output=[];for(var u=0;u<l.output.length;++u)d.output[u]=String(l.output[u])}if(l.attribute){if(!Array.isArray(l.attribute))throw TypeError(".onnx.FunctionProto.attribute: array expected");d.attribute=[];for(var u=0;u<l.attribute.length;++u)d.attribute[u]=String(l.attribute[u])}if(l.attributeProto){if(!Array.isArray(l.attributeProto))throw TypeError(".onnx.FunctionProto.attributeProto: array expected");d.attributeProto=[];for(var u=0;u<l.attributeProto.length;++u){if(typeof l.attributeProto[u]!="object")throw TypeError(".onnx.FunctionProto.attributeProto: object expected");d.attributeProto[u]=a.onnx.AttributeProto.fromObject(l.attributeProto[u])}}if(l.node){if(!Array.isArray(l.node))throw TypeError(".onnx.FunctionProto.node: array expected");d.node=[];for(var u=0;u<l.node.length;++u){if(typeof l.node[u]!="object")throw TypeError(".onnx.FunctionProto.node: object expected");d.node[u]=a.onnx.NodeProto.fromObject(l.node[u])}}if(l.docString!=null&&(d.docString=String(l.docString)),l.opsetImport){if(!Array.isArray(l.opsetImport))throw TypeError(".onnx.FunctionProto.opsetImport: array expected");d.opsetImport=[];for(var u=0;u<l.opsetImport.length;++u){if(typeof l.opsetImport[u]!="object")throw TypeError(".onnx.FunctionProto.opsetImport: object expected");d.opsetImport[u]=a.onnx.OperatorSetIdProto.fromObject(l.opsetImport[u])}}return l.domain!=null&&(d.domain=String(l.domain)),d},c.toObject=function(l,d){d||(d={});var u={};if((d.arrays||d.defaults)&&(u.input=[],u.output=[],u.attribute=[],u.node=[],u.opsetImport=[],u.attributeProto=[]),d.defaults&&(u.name="",u.docString="",u.domain=""),l.name!=null&&l.hasOwnProperty("name")&&(u.name=l.name),l.input&&l.input.length){u.input=[];for(var h=0;h<l.input.length;++h)u.input[h]=l.input[h]}if(l.output&&l.output.length){u.output=[];for(var h=0;h<l.output.length;++h)u.output[h]=l.output[h]}if(l.attribute&&l.attribute.length){u.attribute=[];for(var h=0;h<l.attribute.length;++h)u.attribute[h]=l.attribute[h]}if(l.node&&l.node.length){u.node=[];for(var h=0;h<l.node.length;++h)u.node[h]=a.onnx.NodeProto.toObject(l.node[h],d)}if(l.docString!=null&&l.hasOwnProperty("docString")&&(u.docString=l.docString),l.opsetImport&&l.opsetImport.length){u.opsetImport=[];for(var h=0;h<l.opsetImport.length;++h)u.opsetImport[h]=a.onnx.OperatorSetIdProto.toObject(l.opsetImport[h],d)}if(l.domain!=null&&l.hasOwnProperty("domain")&&(u.domain=l.domain),l.attributeProto&&l.attributeProto.length){u.attributeProto=[];for(var h=0;h<l.attributeProto.length;++h)u.attributeProto[h]=a.onnx.AttributeProto.toObject(l.attributeProto[h],d)}return u},c.prototype.toJSON=function(){return this.constructor.toObject(this,i.util.toJSONOptions)},c.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.FunctionProto"},c}(),s}(),t.exports=a});function ME(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function FN(e){return new TextDecoder().decode(e)}var Hr,$_,P7,pc,MX,_s,hc,mi,LN,kE,ib,rb,ur=Ce(()=>{"use strict";mO(),AX(),Hr=bg(ab()),Eg(),$_=class{static arraysEqual(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}},P7=class{static preprocessInputShapes(e,t){let i=e.length===1?[1,e[0]]:e,r=t.length===1?[t[0],1]:t;return[i,r]}static postprocessOutputShape(e,t,i){t===1&&e.splice(e.length-2,1),i===1&&e.pop()}static calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}},pc=class W_{static calcShape(t,i,r=!1){let n=t.length,o=i.length;if(n===0)return i;if(o===0)return t;let a=Math.max(t.length,i.length),s=new Array(a);if(r){if(n<2||o<2)return;let c=P7.calcMatMulShape([t[n-2],t[n-1]],[i[o-2],i[o-1]]);if(c===void 0)return;[s[a-2],s[a-1]]=c}for(let c=r?3:1;c<=a;c++){let l=n-c<0?1:t[n-c],d=o-c<0?1:i[o-c];if(l!==d&&l>1&&d>1)return;s[a-c]=Math.max(l,d)}return s}static index(t,i){let r=new Array(i.length);return W_.fillIndex(t,i,r),r}static fillIndex(t,i,r){let n=t.length-i.length;for(let o=0;o<i.length;o++)r[o]=t[n+o]%i[o]}static calc(t,i,r,n,o){let a=W_.calcShape(t.dims,i.dims);if(a){if(n&&!mi.areEqual(a,t.dims))return;let s=mi.size(a),c=n?t:new bs(a,o||t.type);if(a.length===0)c.set([],r(t.get([]),i.get([])));else{let l=new Array(a.length),d=new Array(t.dims.length),u=new Array(i.dims.length),h=0,p=0,m=!1,f=!1;t.dims.length===0&&(h=t.get([]),m=!0),i.dims.length===0&&(p=i.get([]),f=!0);let g;for(let v=0;v<s;v++){g=v;for(let _=a.length-1;_>=0;_--)l[_]=g%a[_],g=Math.floor(g/a[_]);m||(W_.fillIndex(l,t.dims,d),h=t.get(d)),f||(W_.fillIndex(l,i.dims,u),p=i.get(u)),c.set(l,r(h,p))}}return c}}static isValidBroadcast(t,i){let r=t.length,n=i.length;if(r>n)return!1;for(let o=1;o<=r;o++)if(t[r-o]!==1&&t[r-o]!==i[n-o])return!1;return!0}static getBroadcastDims(t,i){let r=t.length,n=[];for(let o=0;o<r;o++){let a=r-1-o,s=t[a]||1;(i[i.length-1-o]||1)>1&&s===1&&n.unshift(a)}return n}},MX=class{static getShapeOfGemmResult(e,t,i,r,n){if(e.length!==2||i.length!==2)throw new Error("shape need to be of size 2");let o,a,s;t?(o=e[1],a=e[0]):(o=e[0],a=e[1]);let c=-1;if(r?(s=i[0],c=1):(s=i[1],c=0),i[c]!==a)throw new Error("dimension mismatch");if(o<=0||s<=0||a<=0)throw new Error("invalid shape specified");if(n&&!pc.isValidBroadcast(n,[o,s]))throw new Error("gemm: invalid bias shape for broadcast");return[o,s,a]}},_s=class BN{static tensorDataTypeFromProto(t){switch(t){case Hr.onnx.TensorProto.DataType.INT8:return"int8";case Hr.onnx.TensorProto.DataType.UINT8:return"uint8";case Hr.onnx.TensorProto.DataType.BOOL:return"bool";case Hr.onnx.TensorProto.DataType.INT16:return"int16";case Hr.onnx.TensorProto.DataType.UINT16:return"uint16";case Hr.onnx.TensorProto.DataType.INT32:return"int32";case Hr.onnx.TensorProto.DataType.UINT32:return"uint32";case Hr.onnx.TensorProto.DataType.FLOAT:return"float32";case Hr.onnx.TensorProto.DataType.DOUBLE:return"float64";case Hr.onnx.TensorProto.DataType.STRING:return"string";case Hr.onnx.TensorProto.DataType.INT64:return"int32";case Hr.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error(`unsupported data type: ${Hr.onnx.TensorProto.DataType[t]}`)}}static tensorDataTypeStringToEnum(t){switch(t){case"int8":return Hr.onnx.TensorProto.DataType.INT8;case"uint8":return Hr.onnx.TensorProto.DataType.UINT8;case"bool":return Hr.onnx.TensorProto.DataType.BOOL;case"int16":return Hr.onnx.TensorProto.DataType.INT16;case"uint16":return Hr.onnx.TensorProto.DataType.UINT16;case"int32":return Hr.onnx.TensorProto.DataType.INT32;case"uint32":return Hr.onnx.TensorProto.DataType.UINT32;case"float32":return Hr.onnx.TensorProto.DataType.FLOAT;case"float64":return Hr.onnx.TensorProto.DataType.DOUBLE;case"string":return Hr.onnx.TensorProto.DataType.STRING;case"int64":return Hr.onnx.TensorProto.DataType.INT64;case"uint64":return Hr.onnx.TensorProto.DataType.UINT64;default:throw new Error(`unsupported data type: ${t}`)}}static tensorDimsFromProto(t){return t.map(i=>Ru.isLong(i)?i.toNumber():i)}static tensorValueTypeFromProto(t){return{tensorType:BN.tensorDataTypeFromProto(t.elemType),shape:{dims:BN.tensorDimsFromProto(t.shape.dim.map(i=>i.dimValue))}}}static tensorDimsFromORTFormat(t){let i=[];for(let r=0;r<t.dimsLength();r++)i.push(hc.longToNumber(t.dims(r)));return i}static tensorAttributesFromORTFormat(t){let i=[];for(let r=0;r<t.attributesLength();r++)i.push(t.attributes(r));return i}},hc=class{static longToNumber(e,t){return Ru.isLong(e)?e.toNumber():e instanceof oe.Long?Ru.fromValue({low:e.low,high:e.high,unsigned:t??!1}).toNumber():e}static isLong(e){return Ru.isLong(e)||e instanceof oe.Long}},mi=class Nu{static size(t){return Nu.getSizeFromDimensionRange(t,0,t.length)}static sizeFromDimension(t,i){if(i<0||i>t.length)throw new Error(`invalid dimension of ${i} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return Nu.getSizeFromDimensionRange(t,i,t.length)}static sizeToDimension(t,i){if(i<0||i>t.length)throw new Error(`invalid dimension of ${i} for sizeToDimension as Tensor has ${t.length} dimensions.`);return Nu.getSizeFromDimensionRange(t,0,i)}static getSizeFromDimensionRange(t,i,r){let n=1;for(let o=i;o<r;o++){if(t[o]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");n*=t[o]}return n}static computeStrides(t){let i=t.length;if(i===0)return[];if(i===1)return[1];let r=new Array(i);r[i-1]=1,r[i-2]=t[i-1];for(let n=i-3;n>=0;--n)r[n]=r[n+1]*t[n+1];return r}static transpose(t){return t.slice().reverse()}static indicesToOffset(t,i,r){r===void 0&&(r=t.length);let n=0;for(let o=0;o<r;++o)n+=i[o]*t[o];return n}static offsetToIndices(t,i){let r=i.length;if(r===0)return[];if(r===1)return[t*i[0]];let n=new Array(i.length);for(let o=0;o<n.length-1;++o)n[o]=Math.floor(t/i[o]),t-=n[o]*i[o];return n[n.length-1]=t,n}static normalizeAxis(t,i){if(t<-i&&t>=i)throw new Error("unsupported axis for this operation.");return t<0?t+i:t}static normalizeAxes(t,i){return t.map(r=>this.normalizeAxis(r,i))}static incrementIndex(t,i,r){if(i.length===0||t.length===0)throw new Error("Index incrementing unsupported for scalar Tensor");if(r===void 0)r=i.length;else if(r<=0||r>i.length)throw new Error("Incorrect axis to increment on");for(let n=r-1;n>=0&&(t[n]++,!(t[n]<i[n]));--n)t[n]=0}static calculateReshapedDims(t,i){if(i.length===0){if(t.length===0||Nu.size(t)===1)return[];throw new Error("cannot reshape to a scalar Tensor")}let r=i.length,n=new Array(r),o=-1,a=1;for(let c=0;c<r;c++){if(i[c]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(i[c]===-1){if(o!==-1)throw new Error("at most one dimension in shape hints can be -1");o=c}else{if(i[c]===0){if(c>=t.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");n[c]=t[c]}else n[c]=i[c];a*=n[c]}}let s=Nu.size(t);if(o!==-1){if(s%a!==0)throw new Error(`the input tensor cannot be reshaped to the requested shape. Input shape: [${t}] Output shape: [${i}]`);n[o]=s/a}else if(a!==s)throw new Error("reshapedDims and originalDims don't have matching sizes");return n}static sortBasedOnPerm(t,i){return i?i.map(r=>t[r]):t.slice().reverse()}static padShape(t,i){let r=t.length;return t.map((n,o)=>n+i[o]+i[o+r])}static areEqual(t,i){return t.length!==i.length?!1:t.every((r,n)=>r===i[n])}static validateDimsAndCalcSize(t){if(t.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");let i=1;for(let r of t){if(!Number.isInteger(r))throw new TypeError(`Invalid shape: ${r} is not an integer`);if(r<0||r>2147483647)throw new TypeError(`Invalid shape: length ${r} is not allowed`);i*=r}return i}static flattenShape(t,i){i<0&&(i+=t.length);let r=t.reduce((o,a)=>o*a,1),n=t.slice(i).reduce((o,a)=>o*a,1);return[r/n,n]}static squeezeShape(t,i){let r=new Array;i=Nu.normalizeAxes(i,t.length);for(let n=0;n<t.length;n++){let o=i.indexOf(n)>=0;if(o&&t[n]!==1)throw new Error("squeeze an axis of size different than 1");(i.length===0&&t[n]>1||i.length>0&&!o)&&r.push(t[n])}return r}static unsqueezeShape(t,i){let r=new Array(t.length+i.length);r.fill(0);for(let o=0;o<i.length;o++){let a=Nu.normalizeAxis(i[o],r.length);if(a>=r.length)throw new Error("'axes' has an out of range axis");if(r[a]!==0)throw new Error("'axes' has a duplicate axis");r[a]=1}let n=0;for(let o=0;o<r.length;o++)r[o]===0&&(r[o]=t[n++]);if(n!==t.length)throw new Error("the unsqueezed dimension could not be established");return r}},LN=class kX{static splitShape(t,i,r,n){if(r.length===0){if(!n)throw new Error("need to know number of outputs when the 'split' attribute is not specified");kX.determineSplit(t[i],n,r)}let o=[],a=[0];for(let s=0;s<r.length;++s){s!==0&&a.push(a[s-1]+r[s-1]);let c=t.slice();c[i]=r[s],o.push(c)}return[o,a]}static determineSplit(t,i,r){if(t%i!==0)throw new Error("cannot split tensor to equal sized parts");for(let n=0;n<i;++n)r.push(t/i)}},kE=class q_{static adjustPoolAttributes(t,i,r,n,o,a){if(!t&&r.length!==i.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(t)for(let s=0;s<i.length-2;s++)s>=r.length?r.push(i[s+2]):r[s]=i[s+2];for(let s=0;s<r.length;s++)if(s<n.length){if(n[s]<0)throw new Error("strides should be greater than or equal to 1")}else n.push(1);for(let s=0;s<r.length;s++)if(s<o.length){if(o[s]<0)throw new Error("dilations should be greater than or equal to 1")}else o.push(1);for(let s=0;s<r.length*2;s++)if(s<a.length){if(a[s]<0)throw new Error("pad should be greater than or equal to 1")}else a.push(0);for(let s=0;s<r.length;s++){if(r[s]<=0)throw new Error("kernel shapes need to be greater than 0");if(a[s]>=r[s]||a[s+r.length]>=r[s])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,i,r,n,o,a){if(a){if(o.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(i.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(n.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let s=0;s<t.length-2;s++)q_.adjustPadAndReturnShape(t[s+2],i[s],r[s],n[s],o,s,s+t.length-2,a)}}static computePoolOutputShape(t,i,r,n,o,a,s){if(i.length<=0)throw new Error("input shape must be of size greater than 0");let c=[i[0],i[1]];return q_.computeShapeHelper(t,i,c,r,n,o,a,s),c}static computeConvOutputShape(t,i,r,n,o,a,s){if(t.length<=0||i.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let c=[t[0],i[0]];return q_.computeShapeHelper(!1,t,c,r,n,o,a,s),c}static computeShapeHelper(t,i,r,n,o,a,s,c){if(t)for(let l=0;l<i.length-2;l++)r.push(1);else for(let l=0;l<i.length-2;l++)r.push(q_.adjustPadAndReturnShape(i[l+2],n[l],o[l],a[l],s,l,l+i.length-2,c))}static adjustPadAndReturnShape(t,i,r,n,o,a,s,c){let l=r*(n-1)+1;if(c&&c!=="NOTSET")switch(c){case"VALID":return o[a]=0,o[s]=0,Math.floor((t-l)/i+1);case"SAME_LOWER":case"SAME_UPPER":if(r!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let d=((t+i-1)/i-1)*i+n-t;return o[a]=Math.floor(c==="SAME_LOWER"?(d+1)/2:d/2),o[s]=d-o[a],Math.floor((t+d-n)/i+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((t+o[a]+o[s]-l)/i+1)}},ib=-34028234663852886e22,rb=34028234663852886e22});function REe(e){switch(e){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error(`cannot calculate sizeof() on type ${e}`)}}function N7(e){switch(e){case Ai.onnx.TensorProto.DataType.UINT8:case Ai.onnx.TensorProto.DataType.INT8:case Ai.onnx.TensorProto.DataType.BOOL:return 1;case Ai.onnx.TensorProto.DataType.UINT16:case Ai.onnx.TensorProto.DataType.INT16:return 2;case Ai.onnx.TensorProto.DataType.FLOAT:case Ai.onnx.TensorProto.DataType.INT32:case Ai.onnx.TensorProto.DataType.UINT32:return 4;case Ai.onnx.TensorProto.DataType.INT64:case Ai.onnx.TensorProto.DataType.DOUBLE:case Ai.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error(`cannot calculate sizeof() on type ${Ai.onnx.TensorProto.DataType[e]}`)}}function FEe(e,t){return new(PX(t))(e)}function PX(e){switch(e){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error")}}function VN(e,t){if(t===Ai.onnx.TensorProto.DataType.INT64||t===AE.TensorDataType.INT64){if(e.greaterThanOrEqual(2147483648)||e.lessThan(-2147483648))throw new TypeError("int64 is not supported")}else if(t===Ai.onnx.TensorProto.DataType.UINT32||t===AE.TensorDataType.UINT32||t===Ai.onnx.TensorProto.DataType.UINT64||t===AE.TensorDataType.UINT64){if(e.greaterThanOrEqual(4294967296)||e.lessThan(0))throw new TypeError("uint64 is not supported")}else throw new TypeError(`not a LONG type: ${Ai.onnx.TensorProto.DataType[t]}`);return e.toNumber()}function O7(e,t,i){switch(t){case Ai.onnx.TensorProto.DataType.BOOL:case Ai.onnx.TensorProto.DataType.UINT8:return e.getUint8(i);case Ai.onnx.TensorProto.DataType.INT8:return e.getInt8(i);case Ai.onnx.TensorProto.DataType.UINT16:return e.getUint16(i,!0);case Ai.onnx.TensorProto.DataType.INT16:return e.getInt16(i,!0);case Ai.onnx.TensorProto.DataType.FLOAT:return e.getFloat32(i,!0);case Ai.onnx.TensorProto.DataType.INT32:return e.getInt32(i,!0);case Ai.onnx.TensorProto.DataType.UINT32:return e.getUint32(i,!0);case Ai.onnx.TensorProto.DataType.INT64:return VN(Ru.fromBits(e.getUint32(i,!0),e.getUint32(i+4,!0),!1),t);case Ai.onnx.TensorProto.DataType.DOUBLE:return e.getFloat64(i,!0);case Ai.onnx.TensorProto.DataType.UINT64:return VN(Ru.fromBits(e.getUint32(i,!0),e.getUint32(i+4,!0),!0),t);default:throw new Error(`cannot read from DataView for type ${Ai.onnx.TensorProto.DataType[t]}`)}}var R7,Ai,AE,bs,Eg=Ce(()=>{"use strict";R7=bg(bEe()),AX(),BE(),Ai=bg(ab()),ur(),AE=_r.experimental.fbs,bs=class DE{constructor(t,i,r,n,o,a=R7.Guid.create()){this.dims=t,this.type=i,this.dataProvider=r,this.asyncDataProvider=n,this.cache=o,this.dataId=a,this.size=mi.validateDimsAndCalcSize(t);let s=this.size,c=r===void 0&&n===void 0&&o===void 0;if(o!==void 0&&o.length!==s)throw new RangeError("Input dims doesn't match data length.");if(i==="string"){if(o!==void 0&&(!Array.isArray(o)||!o.every(l=>typeof l=="string")))throw new TypeError("cache should be a string array");c&&(this.cache=new Array(s))}else{if(o!==void 0){let l=PX(i);if(!(o instanceof l))throw new TypeError(`cache should be type ${l.name}`)}if(c){let l=new ArrayBuffer(s*REe(i));this.cache=FEe(l,i)}}}get data(){if(this.cache===void 0){let t=this.dataProvider(this.dataId);if(t.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=t}return this.cache}get stringData(){if(this.type!=="string")throw new TypeError("data type is not string");return this.data}get integerData(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}}get floatData(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)")}}get numberData(){if(this.type!=="string")return this.data;throw new TypeError("type cannot be non-number (string)")}get(t){return this.data[mi.indicesToOffset(t,this.strides)]}set(t,i){this.data[mi.indicesToOffset(t,this.strides)]=i}getData(){return Qe(this,null,function*(){return this.cache===void 0&&(this.cache=yield this.asyncDataProvider(this.dataId)),this.cache})}get strides(){return this._strides||(this._strides=mi.computeStrides(this.dims)),this._strides}static fromProto(t){if(!t)throw new Error("cannot construct Value from an empty tensor");let i=_s.tensorDataTypeFromProto(t.dataType),r=_s.tensorDimsFromProto(t.dims),n=new DE(r,i);if(i==="string")t.stringData.forEach((o,a)=>{n.data[a]=FN(o)});else if(t.rawData&&typeof t.rawData.byteLength=="number"&&t.rawData.byteLength>0){let o=n.data,a=new DataView(t.rawData.buffer,t.rawData.byteOffset,t.rawData.byteLength),s=N7(t.dataType),c=t.rawData.byteLength/s;if(t.rawData.byteLength%s!==0)throw new Error("invalid buffer length");if(o.length!==c)throw new Error("buffer length mismatch");for(let l=0;l<c;l++){let d=O7(a,t.dataType,l*s);o[l]=d}}else{let o;switch(t.dataType){case Ai.onnx.TensorProto.DataType.FLOAT:o=t.floatData;break;case Ai.onnx.TensorProto.DataType.INT32:case Ai.onnx.TensorProto.DataType.INT16:case Ai.onnx.TensorProto.DataType.UINT16:case Ai.onnx.TensorProto.DataType.INT8:case Ai.onnx.TensorProto.DataType.UINT8:case Ai.onnx.TensorProto.DataType.BOOL:o=t.int32Data;break;case Ai.onnx.TensorProto.DataType.INT64:o=t.int64Data;break;case Ai.onnx.TensorProto.DataType.DOUBLE:o=t.doubleData;break;case Ai.onnx.TensorProto.DataType.UINT32:case Ai.onnx.TensorProto.DataType.UINT64:o=t.uint64Data;break;default:throw new Error("unspecific error")}if(o==null)throw new Error("failed to populate data from a tensorproto value");let a=n.data;if(a.length!==o.length)throw new Error("array length mismatch");for(let s=0;s<o.length;s++){let c=o[s];Ru.isLong(c)?a[s]=VN(c,t.dataType):a[s]=c}}return n}static fromData(t,i,r){return new DE(i,r,void 0,void 0,t)}static fromOrtTensor(t){if(!t)throw new Error("cannot construct Value from an empty tensor");let i=_s.tensorDimsFromORTFormat(t),r=_s.tensorDataTypeFromProto(t.dataType()),n=new DE(i,r);if(r==="string")for(let o=0;o<t.stringDataLength();o++)n.data[o]=t.stringData(o);else if(t.rawDataArray()&&typeof t.rawDataLength()=="number"&&t.rawDataLength()>0){let o=n.data,a=new DataView(t.rawDataArray().buffer,t.rawDataArray().byteOffset,t.rawDataLength()),s=N7(t.dataType()),c=t.rawDataLength()/s;if(t.rawDataLength()%s!==0)throw new Error("invalid buffer length");if(o.length!==c)throw new Error("buffer length mismatch");for(let l=0;l<c;l++){let d=O7(a,t.dataType(),l*s);o[l]=d}}return n}}});function $i(e){return e===1?NX:OX}function LEe(e){let t=$i(e);return`${t.version}
      precision highp float;
      ${t.attribute} vec3 position;
      ${t.attribute} vec2 textureCoord;

      ${t.varyingVertex} vec2 TexCoords;

      void main()
      {
          gl_Position = vec4(position, 1.0);
          TexCoords = textureCoord;
      }`}function BEe(e){let t=$i(e);return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFrag} vec2 TexCoords;
    ${t.outputDeclaration}
    const vec2 halfCR = vec2(0.5, 0.5);

    // Custom vector types to handle higher dimenalities.
    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    `}function VEe(e,t){let i=$i(e);return`
  void main() {
    int indices[${t}];
    toVec(TexCoords, indices);
    vec4 result = vec4(process(indices));
    ${i.output} = result;
  }
  `}var NX,OX,un=Ce(()=>{"use strict";NX={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},OX={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"}}),qi=Ce(()=>{"use strict"});function F7(e,t=r=>0,i){return Qe(this,null,function*(){return new Promise((r,n)=>{let o=0,a=()=>{if(e()){r();return}o++;let s=t(o);if(i!=null&&o>=i){n();return}setTimeout(a,s)};a()})})}function XP(e){return ME(typeof e<"u"&&e.length!==0,()=>"empty string found for sampler name"),"get"+e.charAt(0).toUpperCase()+e.slice(1)}function zEe(e){return ME(typeof e<"u"&&e.length!==0,()=>"empty string found for sampler name"),"get"+e.charAt(0).toUpperCase()+e.slice(1)+"AtOutCoords"}function R_(e,t){let i=JSON.parse(JSON.stringify(e));return i=t,i}function F_(e,t){return t.map(i=>e[i]).join(", ")}function Fu(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function wg(e=6){return["x","y","z","w","u","v"].slice(0,e)}var ld=Ce(()=>{"use strict";ur()});function UEe(e,t){return wg(t).map(i=>`${e}.${i}`)}function gO(e,t){return t===1?[e]:UEe(e,t)}function sb(){return`
    float getChannel(vec4 frag, int dim) {
      int modCoord = imod(dim, 2);
      return modCoord == 0 ? frag.r : frag.g;
    }

    float getChannel(vec4 frag, vec2 innerDims) {
      vec2 modCoord = mod(innerDims, 2.);
      return modCoord.x == 0. ?
        (modCoord.y == 0. ? frag.r : frag.g) :
        (modCoord.y == 0. ? frag.b : frag.a);
    }
  `}var Cg=Ce(()=>{"use strict";ld()});function HEe(e,t,i){if(e===0)return"false";if(e===1)return`rc > ${t[0]}`;let r="";for(let n=e-2;n<e;n++)r+=`${i[n]} >= ${t[n-e+2]}`,n<e-1&&(r+="||");return r}function jEe(e,t){let i=e.length;if(i===0)return"getA(), 0, 0, 0";if(i===1)return`getA(rc),
            rc + 1 >= ${e[0]} ? 0. : getA(rc + 1),
            0, 0`;let r="r, c",n="r, cp1",o="rp1, c",a="rp1, cp1",s="";if(i>2)for(let c=0;c<i-2;++c)s=s+`${t[c]},`;return`getA(${s}${r}),
          rEdge ? 0. : getA(${s}${o}),
          cEdge ? 0. : getA(${s}${n}),
          rEdge || cEdge ? 0. : getA(${s}${a})`}function GEe(e,t,i,r){return e===0||e===1?"":`
    int r = ${t[e-2]};
    int c = ${t[e-1]};
    int rp1 = ${t[e-2]} + 1;
    int cp1 = ${t[e-1]} + 1;
    bool rEdge = rp1 >= ${r};
    bool cEdge = cp1 >= ${i};
    `}var YP,L7,RX,$Ee=Ce(()=>{"use strict";un(),qi(),ld(),Cg(),YP={name:"pack",inputNames:["A"],inputTypes:[1]},L7=(e,t)=>{let i=$i(e.session.backend.glContext.version),r=t.dims,n=r.length,o=t.dims.length,a=Fu(o),s=gO("rc",o),c=GEe(o,s,r[r.length-2],r[r.length-1]),l;n===0?l=[1,1]:n===1?l=[r[0],1]:l=[r[o-1],r[o-2]];let d=HEe(o,l,s),u=jEe(r,s),h=`
        void main() {
          ${a} rc = getOutputCoords();

          if(${d}) {
            ${i.output} = vec4(0);
          } else {
            ${c}

            ${i.output} = vec4(${u});
          }
        }
      `;return ve(L({},YP),{hasMain:!0,output:{dims:t.dims,type:t.type,textureType:2},shaderSource:h})},RX=(e,t)=>ve(L({},YP),{get:()=>L7(e,t)})});function B7(e){if(e.length===0)return[1,1,1];let t=1;for(let i=0;i<e.length-2;++i)t*=e[i];return[t,e.length>1?e[e.length-2]:1,e[e.length-1]]}function WEe(e,t){let i=!1;return e.length===0||t.length===0?i=!0:e.length<2||t.length<2?i=e[e.length-1]===t[t.length-1]:i=e[e.length-1]===t[t.length-1]&&e[e.length-2]===t[t.length-2],i}function qEe(e){let t=mi.computeStrides(e),i=["b","r","c"],r="index";return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t.map((n,o)=>{let a=`int ${i[o]} = ${r} / ${n}`,s=o===t.length-1?`int ${i[o+1]} = ${r} - ${i[o]} * ${n}`:`index -= ${i[o]} * ${n}`;return`${a}; ${s};`}).join("")}
      return ivec3(b, r, c);
    }
  `}function XEe(e){let t=mi.computeStrides(e);return`
  int getFlattenedIndex(ivec3 coords) {
    // reverse y, z order
    return coords.x * ${t[0]} + coords.z * ${t[1]} + coords.y;
  }
`}var V7,z7,FX,YEe=Ce(()=>{"use strict";ur(),un(),qi(),Cg(),V7=e=>({name:"Reshape (packed)",inputTypes:[2],inputNames:["A"],cacheHint:`${e}`}),z7=(e,t,i,r)=>{let n=t.dims,o=r,a="";for(let l=0;l<4;l++){let d="";switch(l){case 0:d="outputCoords = rc;";break;case 1:d="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:d="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:d="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw new Error}a+=`
        ${d}
        ${l>0?"if(outputCoords.y < rows && outputCoords.z < cols){":""}
          int flattenedIndex = getFlattenedIndex(outputCoords);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);
          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${l}] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);

        ${l>0?"}":""}
      `}let s=$i(e.session.backend.glContext.version),c=`
      ${qEe(n)}
      ${XEe(o)}
      ${sb()}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.0);

        ivec3 outputCoords;
        int rows = ${o[2]};
        int cols = ${o[1]};

        ${a}
        ${s.output} = result;
      }
    `;return ve(L({},i),{output:{dims:o,type:t.type,textureType:2},shaderSource:c,hasMain:!0})},FX=(e,t,i)=>{let r=V7(i);return ve(L({},r),{get:()=>z7(e,t,r,i)})}}),zN,ZEe=Ce(()=>{"use strict";un(),qi(),zN=(e,t)=>{let i=t.shape,r=$i(e.session.backend.glContext.version),n=`
    const float FLOAT_MAX = 1.70141184e38;
    const float FLOAT_MIN = 1.17549435e-38;

    bool isNaN(float val) {
      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;
    }

    highp vec4 encodeAsUint8(highp float v) {
      if (isNaN(v)) {
        return vec4(255, 255, 255, 255);
      }

      highp float av = abs(v);

      if(av < FLOAT_MIN) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      } else if(v > FLOAT_MAX) {
        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
      } else if(v < -FLOAT_MAX) {
        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
      }

      highp vec4 c = vec4(0,0,0,0);

      highp float e = floor(log2(av));
      highp float m = exp2(fract(log2(av))) - 1.0;

      c[2] = floor(128.0 * m);
      m -= c[2] / 128.0;
      c[1] = floor(32768.0 * m);
      m -= c[1] / 32768.0;
      c[0] = floor(8388608.0 * m);

      highp float ebias = e + 127.0;
      c[3] = floor(ebias / 2.0);
      ebias -= c[3] * 2.0;
      c[2] += floor(ebias) * 128.0;

      c[3] += 128.0 * step(0.0, -v);

      return c / 255.0;
    }

    void main() {
      float value = ${r.texture2D}(X,TexCoords).r;
      ${r.output} = encodeAsUint8(value);
    }`,o={name:"Uint8Encode",inputTypes:[0],inputNames:["X"],output:{dims:i,type:t.tensor.type,textureType:3},shaderSource:n,hasMain:!0};return e.executeProgram(o,[t.tensor])}});function KEe(e,t){if(e===1)return"rc";let i="";for(let r=0;r<e;r++)i+=t[r],r<e-1&&(i+=",");return i}var ZP,U7,LX,QEe=Ce(()=>{"use strict";un(),qi(),ld(),Cg(),ZP={name:"unpack",inputNames:["A"],inputTypes:[2]},U7=(e,t)=>{let i=t.dims.length,r=gO("rc",i),n=r.slice(-2),o=Fu(i),a=sb(),s=t.dims.length===0?"":KEe(i,r),c=i<=1?"rc":`vec2(${n.join(",")})`,l=$i(e.session.backend.glContext.version),d=`
    ${a}
    void main() {
      ${o} rc = getOutputCoords();

       // Sample the texture with the coords to get the rgba channel value.
       vec4 packedInput = getA(${s});

       ${l.output} = vec4(getChannel(packedInput, ${c}), 0, 0, 0);
     }
   `;return ve(L({},ZP),{hasMain:!0,output:{dims:t.dims,type:t.type,textureType:0},shaderSource:d})},LX=(e,t)=>ve(L({},ZP),{get:()=>U7(e,t)})}),BX,UN,VX,PE=Ce(()=>{"use strict";Al(),BX=class{constructor(e,t=1){if(t===1)this.internalFormat=e.R32F,this.format=e.RED,this.textureType=e.FLOAT,this.channelSize=t;else if(t===4)this.internalFormat=e.RGBA32F,this.format=e.RGBA,this.textureType=e.FLOAT,this.channelSize=t;else throw new Error(`Invalid number of channels: ${t}`)}encode(e,t){let i,r;return e.constructor!==Float32Array&&(yn.warning("Encoder","data was not of type Float32; creating new Float32Array"),r=new Float32Array(e)),t*this.channelSize>e.length?(yn.warning("Encoder","Source data too small. Allocating larger array"),r=e,i=this.allocate(t*this.channelSize),r.forEach((n,o)=>i[o]=n)):(r=e,i=r),i}allocate(e){return new Float32Array(e*4)}decode(e,t){return this.channelSize===1?e.filter((i,r)=>r%4===0).subarray(0,t):e.subarray(0,t)}},UN=class{constructor(e,t=1,i){if(t!==1&&t!==4)throw new Error(`Invalid number of channels: ${t}`);this.internalFormat=e.RGBA,this.format=e.RGBA,this.channelSize=t,this.textureType=i||e.FLOAT}encode(e,t){let i=e;return this.channelSize===1&&(yn.verbose("Encoder","Exploding into a larger array"),i=this.allocate(t),e.forEach((r,n)=>i[n*4]=r)),i}allocate(e){return new Float32Array(e*4)}decode(e,t){return this.channelSize===1?e.filter((i,r)=>r%4===0).subarray(0,t):e.subarray(0,t)}},VX=class{constructor(e,t=1){if(this.channelSize=4,t===1)this.internalFormat=e.ALPHA,this.format=e.ALPHA,this.textureType=e.UNSIGNED_BYTE,this.channelSize=t;else if(t===4)this.internalFormat=e.RGBA,this.format=e.RGBA,this.textureType=e.UNSIGNED_BYTE,this.channelSize=t;else throw new Error(`Invalid number of channels: ${t}`)}encode(e,t){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}allocate(e){return new Uint8Array(e*this.channelSize)}decode(e,t){if(e instanceof Uint8Array)return e.subarray(0,t);throw new Error(`Invalid array type: ${e.constructor}`)}}}),Q_,zX,HN,JEe=Ce(()=>{"use strict";ur(),qi(),Q_=(e,t,i)=>{let r=i===0||i===1?1:4,n=i===2,o=i===1||i===2,a=i===4?t.length-1:void 0,s=i===4?t.map((c,l)=>l===t.length-1?c*4:c):void 0;return HN(e,t,r,s,{isPacked:n,reverseWH:o,breakAxis:a})},zX=(e,t,i)=>{let r=Q_(e,t,i);return[r.width,r.height]},HN=(e,t,i=1,r,n)=>{let o=!!(n&&n.isPacked),[a,s]=e.computeTextureWH(o&&r||t,n),c=t.length,l=t.slice(0);if(c===0&&(l=[1]),i===1)r=t;else if(o){if(i!==4)throw new Error("a packed texture must be 4-channel");r=t,c>0&&(l[c-1]=Math.ceil(l[c-1]/2)),c>1&&(l[c-2]=Math.ceil(l[c-2]/2))}else if(!r)throw new Error("Unpacked shape is needed when using channels > 1");return{width:a,height:s,channels:i,isPacked:o,shape:l,strides:mi.computeStrides(l),unpackedShape:r,reversedWH:n&&n.reverseWH}}}),H7,UX,eCe=Ce(()=>{"use strict";Al(),Eg(),ur(),$Ee(),YEe(),ZEe(),QEe(),PE(),JEe(),qi(),H7=(e,t)=>{let i=t.map(n=>`${n.unpackedShape.join(",")};${n.width}x${n.height}`).join("_"),r=e.name;return e.cacheHint&&(r+="["+e.cacheHint+"]"),r+=":"+i,r},UX=class{constructor(e){this.session=e,this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map}calculateTextureWidthAndHeight(e,t){return zX(this.session.layoutStrategy,e,t)}executeProgram(e,t){if(t.length<e.inputNames.length)throw new Error(`Input size mustn't be less than ${e.inputNames.length}.`);if(e.inputNames.length!==e.inputTypes.length)throw new Error("input names size does not match input types");let i=[];for(let c=0;c<e.inputNames.length;++c)i[c]=this.getOrCreateTextureData(t[c],e.inputTypes[c]);let r=H7(e,i),n=this.session.programManager.getArtifact(r),o=n?n.programInfo:typeof e.get=="function"?e.get():e,a=Q_(this.session.layoutStrategy,o.output.dims,o.output.textureType),s=this.createTextureData(a,o.output.type);return n||(n=this.session.programManager.build(o,i,s),this.session.programManager.setArtifact(r,n)),this.runProgram(n,i,s),s}run(e,t){return this.executeProgram(e,t).tensor}runProgram(e,t,i){for(let r=0;r<t.length;++r)if(!!t[r].isPacked!=(e.programInfo.inputTypes[r]===2))throw new Error(`input[${r}] property packed inconsistent`);if(!!i.isPacked!=(e.programInfo.output.textureType===2))throw new Error("output property packed inconsistent");this.session.programManager.run(e,t,i)}getOrCreateTextureData(e,t){let i=this.getTextureData(e.dataId,t===2);if(!i&&(i=this.getTextureData(e.dataId,t!==2),i))return t===2?this.pack(i):this.unpack(i);if(!i){let r=Q_(this.session.layoutStrategy,e.dims,t);if(t===4){let n=e.dims;if(n.length===4){let o=[n[0],Math.ceil(n[1]*n[2]*n[3]/4)],a=Q_(this.session.layoutStrategy,o,t),s=e.numberData;if(n[1]*n[2]*n[3]%4!==0){let c=n[0],l=n[1]*n[2]*n[3],d=Math.ceil(l*1/4)*4,u=c*d;s=new Float32Array(u);for(let h=0;h<c;++h){let p=h*l,m=h*d+h%1*l;s.set(e.numberData.subarray(p,p+l),m)}}return this.createTextureData(a,e.type,s,e,1)}}if(t===2){let n=HN(this.session.layoutStrategy,e.dims,1,[],{reverseWH:!0}),o=this.createTextureData(n,e.type,e.numberData,e,1);i=this.pack(o)}else i=this.createTextureData(r,e.type,e.numberData,e,1)}return i}createTextureDataFromLayoutBindTensor(e,t,i,r){return this.createTextureData(e,t,i,r,1)}createTextureData(e,t,i,r,n){yn.verbose("InferenceHandler",`Creating TextureData: layout:[${JSON.stringify(e)}]`);let o=this.session.textureManager.createTextureFromLayout(t,e,i,n);return this.createTextureDataFromTexture(e,t,o,r)}reshapeUnpacked(e,t){let i=this.getOrCreateTextureData(e,0),r={channels:i.channels,height:i.height,width:i.width,shape:t.length!==0?t:[1],strides:mi.computeStrides(t),unpackedShape:t};return this.createTextureDataFromTexture(r,e.type,i.texture).tensor}reshapePacked(e,t){let i=this.getOrCreateTextureData(e,2);if(WEe(e.dims,t)){let s={channels:i.channels,height:i.height,width:i.width,shape:t.length!==0?t:[1],strides:mi.computeStrides(t),unpackedShape:t,isPacked:!0};return this.createTextureDataFromTexture(s,e.type,i.texture).tensor}let r=B7(e.dims),n=B7(t),o=this.reshapePacked(e,r),a=this.run(FX(this,o,n),[o]);return this.reshapePacked(a,t)}cast(e,t){let i=this.getOrCreateTextureData(e,0);return this.createTextureDataFromTexture(i,t,i.texture).tensor}createTextureDataFromTexture(e,t,i,r,n){let o=ve(L({},e),{tensor:r||new bs(e.unpackedShape,t,a=>this.readTexture(o),a=>Qe(this,null,function*(){return this.readTextureAsync(o)}),void 0,n),texture:i});return this.setTextureData(o.tensor.dataId,o,e.isPacked),o}getTextureData(e,t=!1){return this.session.isInitializer(e)?this.session.getTextureData(e,t):t?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}setTextureData(e,t,i=!1){this.session.isInitializer(e)?this.session.setTextureData(e,t,i):(i?this.packedTextureDataCache:this.unpackedTextureDataCache).set(e,t)}isTextureLayoutCached(e,t=!1){return!!this.getTextureData(e.dataId,t)}dispose(){this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(e=>this.session.textureManager.releaseTexture(e)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(e=>this.session.textureManager.releaseTexture(e)),this.unpackedTextureDataCache=new Map}readTexture(e){return e.isPacked?this.readTexture(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat(zN(this,e))}readTextureAsync(e){return Qe(this,null,function*(){return e.isPacked?this.readTextureAsync(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat(zN(this,e))})}pack(e){return this.executeProgram(RX(this,e.tensor),[e.tensor])}unpack(e){return this.executeProgram(LX(this,e.tensor),[e.tensor])}}}),j7,Gr,yo=Ce(()=>{"use strict";j7=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(e=>`${this[e]}`).join(";")),this.key}},Gr=e=>new j7(e)}),KP,HX,jX,G7,$7,tCe=Ce(()=>{"use strict";yo(),un(),qi(),KP={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[0,0,0,0,0]},HX=(e,t,i)=>($7(t),[e.run(ve(L({},KP),{cacheHint:i.cacheKey,get:()=>G7(e,t,i)}),t)]),jX=e=>{let t=e.attributes.getFloat("epsilon",1e-5),i=e.attributes.getFloat("momentum",.9),r=e.attributes.getInt("spatial",1);return Gr({epsilon:t,momentum:i,spatial:r})},G7=(e,t,i)=>{let r=$i(e.session.backend.glContext.version),n=t[0].dims.length,[o,a]=e.calculateTextureWidthAndHeight(t[1].dims,0),s=`
  float process(int[${n}] indices) {
    vec2 position = offsetToCoords(indices[1], ${o}, ${a});
    float scale = getColorAsFloat(${r.texture2D}(Scale, position));
    float mean = getColorAsFloat(${r.texture2D}(Mean, position));
    float variance = getColorAsFloat(${r.texture2D}(Variance, position));
    float b = getColorAsFloat(${r.texture2D}(B, position));

    return scale * ( (_A(indices) - mean) / sqrt(variance + float(${i.epsilon})) ) + b;
  }`;return ve(L({},KP),{output:{dims:t[0].dims,type:t[0].type,textureType:0},shaderSource:s})},$7=e=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs.");let t=e[0],i=e[1],r=e[2],n=e[3],o=e[4];if(t.dims.length<3||i.dims.length!==1||r.dims.length!==1||n.dims.length!==1||o.dims.length!==1)throw new Error("invalid input shape.");if(i.dims[0]!==t.dims[1]||r.dims[0]!==t.dims[1]||n.dims[0]!==t.dims[1]||o.dims[0]!==t.dims[1])throw new Error("invalid input shape.");if(t.type!=="float32"&&t.type!=="float64"||i.type!=="float32"&&i.type!=="float64"||r.type!=="float32"&&r.type!=="float64"||n.type!=="float32"&&n.type!=="float64"||o.type!=="float32"&&o.type!=="float64")throw new Error("invalid input tensor types.")}}),GX,Sg,pt,jN,$X,Lu=Ce(()=>{"use strict";GX=class{constructor(e,t,i,r){this.glContext=e,this.programInfo=t,this.inputTextureLayouts=i,this.outputTextureLayout=r}},Sg=class{constructor(e){this.context=e}},pt=class{constructor(e,t){this.routineBody=e,this.dependencies=t}},jN=class{constructor(e,t,i){this.name=e,i?this.dependencies=i:this.dependencies=[],t&&(this.routineBody=t)}addDependency(e){e&&this.dependencies.push(e)}},$X=class{static returnOrderedNodes(e){if(!e||e.length===0)return[];if(e.length===1)return e;let t=new Set,i=new Set,r=new Array;return this.createOrderedNodes(e,t,i,r),r}static createOrderedNodes(e,t,i,r){for(let n=0;n<e.length;++n)this.dfsTraverse(e[n],t,i,r)}static dfsTraverse(e,t,i,r){if(!e||i.has(e.name))return;if(t.has(e.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");t.add(e.name);let n=e.dependencies;if(n&&n.length>0)for(let o=0;o<n.length;++o)this.dfsTraverse(n[o],t,i,r);r.push(e),i.add(e.name),t.delete(e.name)}}});function iCe(){let e="add_";return{body:`
  float ${e}(float a, float b) {
    return a + b;
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return v1 + v2;
  }
  `,name:e,type:0}}function rCe(){let e="div_";return{body:`
  float ${e}(float a, float b) {
    return a / b;
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return v1 / v2;
  }
  `,name:e,type:0}}function nCe(){let e="mul_";return{body:`
  float ${e}(float a, float b) {
    return a * b;
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return v1 * v2;
  }
  `,name:e,type:0}}function oCe(){let e="sub_";return{body:`
  float ${e}(float a, float b) {
    return a - b;
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return v1 - v2;
  }
  `,name:e,type:0}}function aCe(){let e="equal_";return{body:`
  float ${e}(float a, float b) {
    return float(a == b);
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return vec4(equal(v1, v2));
  }
  `,name:e,type:0}}function sCe(){let e="greater_";return{body:`
  float ${e}(float a, float b) {
    return float(a > b);
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return vec4( v1.r > v2.r ,
      v1.g > v2.g,
      v1.b > v2.b,
      v1.a > v2.a );
  }
  `,name:e,type:0}}function lCe(){let e="less_";return{body:`
  float ${e}(float a, float b) {
    return float(a < b);
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return vec4( v1.r < v2.r ,
                v1.g < v2.g,
                v1.b < v2.b,
                v1.a < v2.a );
  }
  `,name:e,type:0}}function cCe(){let e="and_";return{body:`
  float ${e}(float a, float b) {
    return float( bool(a) && bool(b) );
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r && b2.r ,
                b1.g && b2.g,
                b1.b && b2.b,
                b1.a && b2.a );
  }
  `,name:e,type:0}}function dCe(){let e="or_";return{body:`
  float ${e}(float a, float b) {
    return float( bool(a) || bool(b) );
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r || b2.r ,
                b1.g || b2.g,
                b1.b || b2.b,
                b1.a || b2.a );
  }
  `,name:e,type:0}}function uCe(){let e="xor_";return{body:`
  float ${e}(float a, float b) {
    return float( bool(a) ^^ bool(b) );
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r ^^ b2.r ,
                b1.g ^^ b2.g,
                b1.b ^^ b2.b,
                b1.a ^^ b2.a );
  }
  `,name:e,type:0}}function hCe(){return fCe("pow")}function pCe(){let e="prelu_";return{body:`
  float ${e}(float a, float b) {
    return a < 0.0 ? a * b: a;
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return vec4(
      v1.r < 0.0 ? v1.r * v2.r: v1.r,
      v1.g < 0.0 ? v1.g * v2.g: v1.g,
      v1.b < 0.0 ? v1.b * v2.b: v1.b,
      v1.a < 0.0 ? v1.a * v2.a: v1.a
      );
  }
  `,name:e,type:0}}function fCe(e){let t=`${e}_`;return{body:`
  float ${t}(float a, float b) {
    return ${e}(a, b);
  }
  vec4 ${t}(vec4 v1, vec4 v2) {
    return ${e}(v1, v2);
  }
  `,name:t,type:0}}var gs,W7,WX,qX,XX,YX,ZX,KX,QX,JX,eY,tY,iY,rY,mCe=Ce(()=>{"use strict";ur(),Lu(),un(),qi(),gs=(e,t,i,r=t[0].type,n)=>{let o=e.session.pack?2:0;return{name:i.name,inputNames:["A","B"],inputTypes:[o,o],cacheHint:n,get:()=>W7(e,t,i,r)}},W7=(e,t,i,r=t[0].type)=>{let n=e.session.pack?2:0,o=!mi.areEqual(t[0].dims,t[1].dims),a=t[0].dims,s=e.session.pack;if(o){let d=pc.calcShape(t[0].dims,t[1].dims,!1);if(!d)throw new Error("Can't perform binary op on the given tensors");a=d;let u=a.length,h=t[0].dims.length!==0?t[0].dims.length:1,p=t[1].dims.length!==0?t[1].dims.length:1,m=t[0].dims.length!==0?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",f=t[1].dims.length!==0?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",g=$i(e.session.backend.glContext.version),v=s?`
      ${i.body}
      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();
        vec4 result = ${i.name}(a, b);
        ${g.output} = result;
      }`:`
      ${i.body}
      float process(int indices[${u}]) {
        int aindices[${h}];
        int bindices[${p}];
        ${m}
        ${f}
        return ${i.name}(_A(aindices), _B(bindices));
      }`;return{name:i.name,inputNames:["A","B"],inputTypes:[n,n],output:{dims:a,type:r,textureType:n},shaderSource:v,hasMain:s}}let c=$i(e.session.backend.glContext.version),l=`
    ${i.body}
    void main() {
      vec4 v1 = ${c.texture2D}(A, TexCoords);
      vec4 v2 = ${c.texture2D}(B, TexCoords);
      vec4 result = ${i.name}(v1, v2);
      ${c.output} = result;
    }
    `;return{name:i.name,inputNames:["A","B"],inputTypes:[n,n],output:{dims:t[0].dims,type:r,textureType:n},shaderSource:l,hasMain:!0}},WX=(e,t)=>[e.run(gs(e,t,iCe()),t)],qX=(e,t)=>[e.run(gs(e,t,cCe(),"bool"),t)],XX=(e,t)=>[e.run(gs(e,t,rCe()),t)],YX=(e,t)=>[e.run(gs(e,t,aCe(),"bool"),t)],ZX=(e,t)=>[e.run(gs(e,t,sCe(),"bool"),t)],KX=(e,t)=>[e.run(gs(e,t,lCe(),"bool"),t)],QX=(e,t)=>[e.run(gs(e,t,nCe()),t)],JX=(e,t)=>[e.run(gs(e,t,dCe(),"bool"),t)],eY=(e,t)=>[e.run(gs(e,t,hCe()),t)],tY=(e,t)=>[e.run(gs(e,t,pCe()),t)],iY=(e,t)=>[e.run(gs(e,t,oCe()),t)],rY=(e,t)=>[e.run(gs(e,t,uCe(),"bool"),t)]}),nY,oY,q7,gCe=Ce(()=>{"use strict";ur(),nY=(e,t,i)=>(q7(t),[e.cast(t[0],i)]),oY=e=>_s.tensorDataTypeFromProto(e.attributes.getInt("to")),q7=e=>{if(!e||e.length!==1)throw new Error("Cast requires 1 input.");if(e[0].type==="string")throw new Error("Invalid input type.")}}),X7,Y7,aY,L_,vCe=Ce(()=>{"use strict";un(),qi(),ld(),Cg(),X7=(e,t)=>({name:"Concat (packed)",inputNames:Array.from({length:e},(i,r)=>`X${r}`),inputTypes:Array(e).fill(2),cacheHint:t}),Y7=(e,t,i,r)=>{let n=i[0].dims.slice();if(r>=n.length||r<-1*n.length)throw new Error("axis specified for concat doesn't match input dimensionality");r<0&&(r=n.length+r);let o=n.slice(0);for(let x=1;x<i.length;x++){let w=i[x].dims.slice();for(let I=0;I<n.length;I++)if(I===r)o[r]+=w[I];else if(n[I]!==w[I])throw new Error("non concat dimensions must match")}let a=o.length,s=gO("coords",a),c=Fu(a),l=sb(),d=i.map(x=>x.dims),u=wg(a),h=new Array(d.length-1);h[0]=d[0][r];for(let x=1;x<h.length;x++)h[x]=h[x-1]+d[x][r];let p=u[r],m=u.slice(-2),f=u.join(),g=`if (${p} < ${h[0]}) {
        return getChannel(
            getX0(${f}), vec2(${m.join()}));
        }`;for(let x=1;x<h.length;x++){let w=h[x-1];g+=`
            if (${p} < ${h[x]}  && ${p} >= ${h[x-1]}) {
              return getChannel(
                getX${x}(${L_(u,p,w)}),
                vec2(${L_(m,p,w)}));
            }`}let v=h.length,_=h[h.length-1];g+=`
            return getChannel(
              getX${v}(${L_(u,p,_)}),
              vec2(${L_(m,p,_)}));`;let b=$i(e.session.backend.glContext.version),y=`
          ${l}
          float getValue(${u.map(x=>"int "+x)}) {
            ${g}
          }

          void main() {
            ${c} coords = getOutputCoords();
            int lastDim = coords.${u[a-1]};
            coords.${u[a-1]} = coords.${u[a-2]};
            coords.${u[a-2]} = lastDim;

            vec4 result = vec4(getValue(${s}), 0., 0., 0.);

            ${s[a-1]} = ${s[a-1]} + 1;
            if (${s[a-1]} < ${o[a-1]}) {
              result.g = getValue(${s});
            }

            ${s[a-2]} = ${s[a-2]} + 1;
            if (${s[a-2]} < ${o[a-2]}) {
              result.a = getValue(${s});
            }

            ${s[a-1]} = ${s[a-1]} - 1;
            if (${s[a-2]} < ${o[a-2]} &&
                ${s[a-1]} < ${o[a-1]}) {
              result.b = getValue(${s});
            }
            ${b.output} = result;
          }
        `;return ve(L({},t),{output:{dims:o,type:i[0].type,textureType:2},shaderSource:y,hasMain:!0})},aY=(e,t,i)=>{let r=X7(t.length,i.cacheKey);return ve(L({},r),{get:()=>Y7(e,r,t,i.axis)})},L_=(e,t,i)=>{let r=e.indexOf(t);return e.map((n,o)=>o===r?`${n} - ${i}`:n).join()}}),sY,Z7,K7,Q7,QP,J7,eW,tW,lY,iW,_Ce=Ce(()=>{"use strict";yo(),qi(),vCe(),sY=(e,t,i)=>(iW(t),e.session.pack&&t[0].dims.length>1?[e.run(aY(e,t,i),t)]:[e.run(Q7(e,t,i),t)]),Z7=(e,t)=>({name:"Concat",inputNames:Array.from({length:e},(i,r)=>`X${r}`),inputTypes:Array(e).fill(0),cacheHint:t}),K7=(e,t,i,r)=>{let n=i[0].dims.slice();if(r>=n.length||r<-1*n.length)throw new Error("axis specified for concat doesn't match input dimensionality");r<0&&(r=n.length+r);let o=n.slice(0);for(let p=1;p<i.length;p++){let m=i[p].dims.slice();for(let f=0;f<n.length;f++)if(f===r)o[r]+=m[f];else if(n[f]!==m[f])throw new Error("non concat dimensions must match")}let a=o.length,s=new Array(i.length),c=0;for(let p=0;p<s.length;++p)c+=i[p].dims[r],s[p]=c;let l="";i.length<5?l=QP(s):l=J7(s);let d=eW(i.length,a),u=tW(s),h=`
        ${d}
        ${u}
        ${l}
        float process(int indices[${a}]) {
          int textureIndex = getTextureWhereDataResides (indices[${r}]);

          if(textureIndex != 0) {
            indices[${r}] = indices[${r}] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));
          }

          return fetchDataFromCorrectTexture(textureIndex, indices);
        }`;return ve(L({},t),{output:{dims:o,type:i[0].type,textureType:0},shaderSource:h})},Q7=(e,t,i)=>{let r=Z7(t.length,i.cacheKey);return ve(L({},r),{get:()=>K7(e,r,t,i.axis)})},QP=e=>`int getTextureWhereDataResides(int index) {
      ${e.map((t,i)=>`if(index<${t}) {return ${i};}
`).join("")}
    }`,J7=e=>QP(e),eW=(e,t)=>{let i=[`float fetchDataFromCorrectTexture(int textureIndex, int indices[${t}]) {`];for(let r=0;r<e;++r)r===0?i.push(`	if (textureIndex == ${r}) { return _X${r}(indices); }`):r===e-1?i.push(`	else { return _X${r}(indices); }`):i.push(`	else if (textureIndex == ${r}) { return _X${r}(indices); }`);return i.push("	}"),i.join(`
`)},tW=e=>{let t=["int getSizeInConcatAxisValueFromIndex(int index) {"];for(let i=0;i<e.length;++i)i===0?t.push(`	if (index == ${i}) { return ${e[i]}; }`):i===e.length-1?t.push(`	else { return ${e[i]}; }`):t.push(`	else if (index == ${i}) { return ${e[i]}; }`);return t.push("	}"),t.join(`
`)},lY=e=>Gr({axis:e.attributes.getInt("axis")}),iW=e=>{if(!e||e.length<1)throw new Error("too few inputs");let t=e[0].type,i=e[0].dims.length;if(t==="string")throw new Error("string tensor is not supported yet");for(let r of e){if(r.type!==t)throw new Error("input tensors should be one type");if(r.dims.length!==i)throw new Error("input tensors should have the same shape")}}});function bCe(){return ol("abs")}function yCe(){return ol("acos")}function xCe(){return ol("asin")}function wCe(){return ol("atan")}function ECe(){return ol("ceil")}function CCe(){return ol("cos")}function SCe(e){let t="elu";return{body:`
  const float alpha = float(${e});

  float ${t}_(float a) {
    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;
  }
  vec4 ${t}_(vec4 v) {
    return vec4(${t}_(v.x), ${t}_(v.y), ${t}_(v.z), ${t}_(v.w));
  }
  `,name:t,type:0}}function TCe(){return ol("exp")}function ACe(){return ol("floor")}function cY(e,t){let i="clip";return{body:`
  const float min = float(${e});
  const float max = float(${t});

  float ${i}_(float a) {
    return clamp(a, min, max);
  }
  vec4 ${i}_(vec4 v) {
    return clamp(v, min, max);
  }
  `,name:i,type:0}}function DCe(){let e="indentity";return{body:`
  float ${e}_(float a) {
    return a;
  }
  vec4 ${e}_(vec4 v) {
    return v;
  }
  `,name:e,type:0}}function ICe(e){let t="leakyRelu";return{body:`
  const float alpha = float(${e});

  float ${t}_(float a) {
    return a < 0.0 ? a * alpha : a;
  }
  vec4 ${t}_(vec4 v) {
    return vec4(${t}_(v.x), ${t}_(v.y), ${t}_(v.z), ${t}_(v.w));
  }
  `,name:t,type:0}}function MCe(){return ol("log")}function kCe(){let e="neg";return{body:`
  float ${e}_(float a) {
    return -a;
  }
  vec4 ${e}_(vec4 v) {
    return -v;
  }
  `,name:e,type:0}}function PCe(){let e="not";return{body:`
  float ${e}_(float a) {
    return float( ! bool(a) );
  }
  bool ${e}_(bool a) {
    return !a;
  }
  vec4 ${e}_(vec4 v) {
    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));
  }
  bvec4 ${e}_(bvec4 v) {
    return bvec4(!v.x, !v.y, !v.z, !v.w);
  }
  `,name:e,type:0}}function NCe(){return ol("sin")}function dY(){let e="relu";return{body:`
  float ${e}_(float a) {
    return max( a, 0.0 );
  }
  vec4 ${e}_(vec4 v) {
    return max( v, 0.0 );
  }
  `,name:e,type:0}}function uY(){let e="sigmoid";return{body:`
  float ${e}_(float a) {
    return 1.0 / (1.0 + exp(-a));
  }
  vec4 ${e}_(vec4 v) {
    return 1.0 / (1.0 + exp(-v));
  }
  `,name:e,type:0}}function OCe(){return ol("sqrt")}function RCe(){return ol("tan")}function FCe(){let e="tanh";return{body:`
  float ${e}_(float a) {
    a = clamp(a, -10., 10.);
    a = exp(2.*a);
    return (a - 1.) / (a + 1.);
  }
  vec4 ${e}_(vec4 v) {
    v = clamp(v, -10., 10.);
    v = exp(2.*v);
    return (v - 1.) / (v + 1.);
  }
  `,name:e,type:0}}function ol(e){return{body:`
  float ${e}_(float a) {
    return ${e}(a);
  }
  vec4 ${e}_(vec4 v) {
    return ${e}(v);
  }
  `,name:e,type:0}}var rW,bn,hY,pY,fY,mY,GN,gY,vY,nW,_Y,bY,yY,xY,wY,EY,$N,CY,SY,TY,AY,DY,IY,MY,kY,PY,NY,OY,RY=Ce(()=>{"use strict";yo(),ur(),Lu(),un(),qi(),rW=(e,t,i,r)=>{let n=e.session.pack?2:0,o=$i(e.session.backend.glContext.version);return ve(L({},t),{output:{dims:i.dims,type:i.type,textureType:n},shaderSource:`
     ${r.body}
     void main() {
       vec4 v = ${o.texture2D}(A, TexCoords);
       v = ${r.name}_(v);
       ${o.output} = v;
     }
     `,hasMain:!0})},bn=(e,t,i,r)=>{let n=e.session.pack?2:0,o={name:i.name,inputTypes:[n],inputNames:["A"],cacheHint:r};return ve(L({},o),{get:()=>rW(e,o,t,i)})},hY=(e,t)=>[e.run(bn(e,t[0],bCe()),t)],pY=(e,t)=>[e.run(bn(e,t[0],yCe()),t)],fY=(e,t)=>[e.run(bn(e,t[0],xCe()),t)],mY=(e,t)=>[e.run(bn(e,t[0],wCe()),t)],GN=(e,t,i)=>[e.run(bn(e,t[0],cY(i.min,i.max),i.cacheKey),t)],gY=e=>Gr({min:e.attributes.getFloat("min",ib),max:e.attributes.getFloat("max",rb)}),vY=(e,t)=>{let i=nW(e,t);return GN(e,[t[0]],i)},nW=(e,t)=>{if(t.length>=3&&(!e.session.isInitializer(t[1].dataId)||!e.session.isInitializer(t[2].dataId)))throw new Error("dynamic clip attributes are not allowed");let i=t.length>=3?t[1].numberData[0]:ib,r=t.length>=3?t[2].numberData[0]:rb;return Gr({min:i,max:r})},_Y=(e,t)=>[e.run(bn(e,t[0],ECe()),t)],bY=(e,t)=>[e.run(bn(e,t[0],CCe()),t)],yY=(e,t,i)=>[e.run(bn(e,t[0],SCe(i.alpha),i.cacheKey),t)],xY=e=>Gr({alpha:e.attributes.getFloat("alpha",1)}),wY=(e,t)=>[e.run(bn(e,t[0],TCe()),t)],EY=(e,t)=>[e.run(bn(e,t[0],ACe()),t)],$N=(e,t)=>[e.run(bn(e,t[0],DCe()),t)],CY=(e,t,i)=>[e.run(bn(e,t[0],ICe(i.alpha),i.cacheKey),t)],SY=e=>Gr({alpha:e.attributes.getFloat("alpha",.01)}),TY=(e,t)=>[e.run(bn(e,t[0],MCe()),t)],AY=(e,t)=>[e.run(bn(e,t[0],kCe()),t)],DY=(e,t)=>[e.run(bn(e,t[0],PCe()),t)],IY=(e,t)=>[e.run(bn(e,t[0],dY()),t)],MY=(e,t)=>[e.run(bn(e,t[0],uY()),t)],kY=(e,t)=>[e.run(bn(e,t[0],NCe()),t)],PY=(e,t)=>[e.run(bn(e,t[0],OCe()),t)],NY=(e,t)=>[e.run(bn(e,t[0],RCe()),t)],OY=(e,t)=>[e.run(bn(e,t[0],FCe()),t)]});function lb(e){let t;switch(e.activation){case"Relu":t=dY();break;case"Sigmoid":t=uY();break;case"Clip":t=cY(e.clipMin,e.clipMax);break;default:return{activationFunction:"",applyActivation:""}}let i=t.name,r=t.body,n=`value = ${i}_(value);`;return{activationFunction:r,applyActivation:n}}var VE,Tg=Ce(()=>{"use strict";ur(),RY(),VE=e=>{let t=e.getString("activation","");if(t==="Clip"){let[i,r]=e.getFloats("activation_params",[ib,rb]);return{activation:t,clipMax:r,clipMin:i,activationCacheKey:`${t}:${i},${r}`}}return{activation:t,activationCacheKey:t}}}),oW,aW,FY,LCe=Ce(()=>{"use strict";Al(),un(),qi(),bO(),Tg(),oW=(e,t)=>({name:"GroupedConv",inputNames:e?["X","W","Bias"]:["X","W"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t}),aW=(e,t,i,r)=>{let n=t.length>2?"value += getBias(output_channel);":"",o=t[0].dims.slice(),a=t[1].dims.slice(),s=a[0]/r.group;yn.verbose("GroupedConv",`autpPad:${r.autoPad}, dilations:${r.dilations}, group:${r.group}, kernelShape:${r.kernelShape}, pads:${r.pads}, strides:${r.strides}`);let c=J_(o,a,r.dilations,r.pads,r.strides),l=$i(e.session.backend.glContext.version),{activationFunction:d,applyActivation:u}=lb(r),h=`
  const ivec2 strides = ivec2(${r.strides[0]}, ${r.strides[1]});
  const ivec2 pads = ivec2(${r.pads[0]}, ${r.pads[1]});
  ${d}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;
    ivec2 xRCCorner = coords.zw * strides - pads;
    int group_id = output_channel / ${s};

    float value = 0.0;
    for (int wInChannel = 0; wInChannel < ${a[1]}; wInChannel++) {
      int input_channel = group_id * ${a[1]} + wInChannel;
      for (int wHeight = 0; wHeight < ${a[2]}; wHeight++) {
        int xHeight = xRCCorner.x + wHeight * ${r.dilations[0]};

        if (xHeight < 0 || xHeight >= ${o[2]}) {
          continue;
        }

        for (int wWidth = 0; wWidth < ${a[3]}; wWidth++) {
          int xWidth = xRCCorner.y + wWidth * ${r.dilations[1]};
          if (xWidth < 0 || xWidth >= ${o[3]}) {
            continue;
          }

          float xVal = getX(batch, input_channel, xWidth, xHeight);
          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);
          value += xVal*wVal;
        }
      }
    }
    ${n}
    ${u}
    ${l.output} = vec4(value, .0, .0, .0);
  }
`;return ve(L({},i),{output:{dims:c,type:t[0].type,textureType:0},shaderSource:h,hasMain:!0})},FY=(e,t,i)=>{let r=oW(t.length>2,i.cacheKey);return ve(L({},r),{get:()=>aW(e,t,r,i)})}}),sW,lW,LY,BCe=Ce(()=>{"use strict";un(),qi(),Cg(),sW=e=>({name:"Im2Col (packed)",inputNames:["A"],inputTypes:[2],cacheHint:e}),lW=(e,t,i,r,n,o)=>{let a=i.dims,s=r.dims,c=2,l=3,d=n.length,u=[s[1]*s[2]*s[3],n[2]*n[3]],h=s[2]*s[3],p=sb(),m=$i(e.session.backend.glContext.version),f="";for(let v=0;v<=1;v++)for(let _=0;_<=1;_++)f+=`
            blockIndex = rc.x + ${_};
            pos = rc.y + ${v};

            if(blockIndex < ${u[1]} && pos < ${u[0]}) {
              offsetY = int(blockIndex / (${n[d-1]})) * ${o.strides[0]} -
                ${o.pads[0]};
              d0 = offsetY + ${o.dilations[0]} * (imod(pos, ${h}) / ${s[2]});

              if(d0 < ${a[c]} && d0 >= 0) {
                offsetX = imod(blockIndex, ${n[d-1]}) * ${o.strides[1]} -
                  ${o.pads[1]};
                d1 = offsetX + ${o.dilations[1]} * imod(imod(pos, ${h}), ${s[2]});

                if(d1 < ${a[l]} && d1 >= 0) {

                  ch = int(float(pos)/ ${h}.);
                    innerDims = vec2(d0, d1);
                    result[${v*2+_}] = getChannel(
                      getA(0, ch, int(innerDims.x),
                      int(innerDims.y)), innerDims);
                }
              }
            }

          `;let g=`
      ${p}

      void main() {
        ivec2 rc = getOutputCoords();
          vec4 result = vec4(0.0);
          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
          vec2 innerDims;
          ${f}
          ${m.output} = result;
      }
            `;return ve(L({},t),{output:{dims:u,type:i.type,textureType:2},shaderSource:g,hasMain:!0})},LY=(e,t,i,r,n)=>{let o=sW(n.cacheKey);return ve(L({},o),{get:()=>lW(e,o,t,i,r,n)})}});function VCe(e,t,i){let r=t[0].dims,n=t[1].dims,o=pc.calcShape(r,n,!0);if(!o)throw new Error("Can't use matmul on the given tensors");let a=Fu(o.length),s=wg(),{activationFunction:c,applyActivation:l}=lb(i),d=t.length>2,u=d?"value += getBiasForMatmul();":"",h=d?`${VY(a,s,t[2].dims,o,!1)}`:"",p=o.length,m=r.length,f=n.length,g=r[r.length-1],v=`
    ${c}
    ${h}
    float process(int indices[${p}]) {
        int a[${m}];
        int b[${f}];
        bcastMatmulIndices_A(indices, a);
        bcastMatmulIndices_B(indices, b);

        float value;
        for (int k=0; k<${g}; ++k) {
            a[${m-1}] = k;
            b[${f-2}] = k;
            value += _A(a) * _B(b);
        }
        ${u}
        ${l}
        return value;
    }`;return ve(L({},e),{output:{dims:o,type:t[0].type,textureType:0},shaderSource:v})}function BY(e,t){let i=HY(e.length>2,t.activationCacheKey);return ve(L({},i),{get:()=>VCe(i,e,t)})}function VY(e,t,i,r,n){let o="",a=i.length,s=r.length,c=s-a;s<2&&a>0?o="coords":o=i.map((h,p)=>`coords.${t[p+c]}`).join(", ");let l=pc.getBroadcastDims(i,r).map(h=>`coords.${t[h+c]} = 0;`).join(`
`),d=mi.size(i)===1,u="vec4(outputValue.xx, outputValue.yy)";return d&&(u="vec4(outputValue.x)"),n?`
vec4 getBiasForMatmul() {
  ${e} coords = getOutputCoords();
  ${l}
  vec4 outputValue = getBias(${o});
  return ${u};
}`:`
float getBiasForMatmul() {
  ${e} coords = getOutputCoords();
  ${l}
  return getBias(coords.x);
}`}var zY,UY,HY,cW,vO=Ce(()=>{"use strict";ur(),qi(),ld(),Tg(),jY(),zY=(e,t,i)=>(cW(t),e.session.pack?[e.run(_O(e,t,i),t)]:[e.run(BY(t,i),t)]),UY=e=>VE(e.attributes),HY=(e,t)=>({name:"MatMul",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t}),cW=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.");if(e[0].type!=="float32"&&e[0].type!=="float64"||e[1].type!=="float32"&&e[1].type!=="float64")throw new Error("inputs should be float type");if(e[0].type!==e[1].type)throw new Error("inputs types should match")}});function zCe(e,t,i,r){let n=[],o=[],a=i[0].dims,s=i[1].dims,c=a.length,l=s.length,d=r.length,u=d-c,h=d-l;n=a.map((_,b)=>`coords.${t[b+u]}`),n[c-1]="i*2",n.join(", "),o=s.map((_,b)=>`coords.${t[b+h]}`),o[l-2]="i*2",o.join(", ");let p=pc.getBroadcastDims(a,r),m=pc.getBroadcastDims(s,r),f=p.map(_=>`coords.${t[_+u]} = 0;`).join(`
`),g=m.map(_=>`coords.${t[_+h]} = 0;`).join(`
`),v=`int lastDim = coords.${t[d-1]};
  coords.${t[d-1]} = coords.${t[d-2]};
  coords.${t[d-2]} = lastDim;`;return`
vec4 getAAtOutCoordsMatmul(int i) {
  ${e} coords = getOutputCoords();
  ${v}
  ${f}
  vec4 outputValue = getA(${n});
  return outputValue;
}

vec4 getBAtOutCoordsMatmul(int i) {
  ${e} coords = getOutputCoords();
  ${v}
  ${g}
  vec4 outputValue = getB(${o});
  return outputValue;
}`}function UCe(e,t){let i="";for(let r=0;r<t-2;r++)i+=`rc.${e[r]}, `;return i+=`rc.${e[t-2]}, i*2`,i}function HCe(e,t){let i="";for(let r=0;r<t-2;r++)i+=`rc.${e[r]}, `;return i+=`i*2, rc.${e[t-1]}`,i}var dW,uW,_O,jY=Ce(()=>{"use strict";ur(),un(),qi(),ld(),Tg(),vO(),dW=(e,t)=>({name:"MatMul (packed)",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[2,2,2]:[2,2],cacheHint:t}),uW=(e,t,i,r)=>{let n=i.length>2,o=n?"value += getBiasForMatmul();":"",a=i[0].dims,s=i[1].dims,c=pc.calcShape(a,s,!0),l=!mi.areEqual(i[0].dims,i[1].dims);if(!c)throw new Error("Can't use matmul on the given tensors");let d=a[a.length-1],u=Math.ceil(d/2),h=a.length,p=s.length,m=$i(e.session.backend.glContext.version),f=Fu(c.length),g=c.length,v=wg(),{activationFunction:_,applyActivation:b}=lb(r),y=n?`${VY(f,v,i[2].dims,c,!0)}`:"",x=l?`${zCe(f,v,i,c)}`:"",w=l?"getAAtOutCoordsMatmul(i)":`getA(${UCe(v,h)})`,I=l?"getBAtOutCoordsMatmul(i)":`getB(${HCe(v,p)})`,S=l?"":`${f} rc =
          getOutputCoords(); int lastDim = rc.${v[g-1]}; rc.${v[g-1]} =
          rc.${v[g-2]}; rc.${v[g-2]} = lastDim;
      `,E=`
            ${x}
            ${y}
            ${_}
            void main() {
              ${S}

              vec4 value = vec4(0);
              for (int i = 0; i < ${u}; i++) {
                vec4 a = ${w};
                vec4 b = ${I};

                value += (a.rrbb * b.rgrg);
                value += (a.ggaa * b.baba);
              }
              ${o}
              ${b}
              ${m.output} = value;
            }`;return ve(L({},t),{output:{dims:c,type:i[0].type,textureType:2},shaderSource:E,hasMain:!0})},_O=(e,t,i)=>{let r=dW(t.length>2,i.activationCacheKey);return ve(L({},r),{get:()=>uW(e,r,t,i)})}}),GY,jCe=Ce(()=>{"use strict";bO(),BCe(),jY(),GY=(e,t,i)=>{let r=t[0].dims,n=t[1].dims,o=J_(r,n,i.dilations,i.pads,i.strides),a=e.run(LY(e,t[0],t[1],o,i),[t[0]]),s=e.reshapePacked(t[1],[n[0],n[1]*n[2]*n[3]]),c=t.length===3?[s,a,t[2]]:[s,a],l=e.run(_O(e,c,i),c);return e.reshapePacked(l,o)}}),hW,pW,$Y,WN,WY=Ce(()=>{"use strict";qi(),hW=e=>({name:"Im2Col",inputNames:["X"],inputTypes:[0],cacheHint:e}),pW=(e,t,i,r,n,o)=>{let a=i.dims,s=r.dims,c=n.length,l=WN(a,s,n,4),d=`
        const int XC = ${a[1]};
        const int XH = ${a[2]};
        const int XW = ${a[3]};
        const int KH = ${o.kernelShape[0]};
        const int KW = ${o.kernelShape[1]};
        const int dilationH = ${o.dilations[0]};
        const int dilationW = ${o.dilations[1]};
        const int strideH = ${o.strides[0]};
        const int strideW = ${o.strides[1]};
        const int padH = ${o.pads[0]};
        const int padW = ${o.pads[1]};
        const int KHKW = KH*KW;
        const int XCKHKW = XC * KHKW;
        const int outputChannels = 4;
        vec4 process(int indices[${c}]) {
          int b  = indices[0]; // batch size
          int oh = indices[1] * strideH - padH; //output height
          int ow = indices[2] * strideW - padW; //output width
          int p = indices[3] * outputChannels; //patch
          vec4 value = vec4(0.0);
          for(int i=0; i < outputChannels; ++i) {
            if(p < XCKHKW) {
              int patchC = p / KHKW;
              int patchH = (p - patchC*KHKW) / KW;
              int patchW = (p - patchC*KHKW) - patchH * KW;
              int xh2 = oh + patchH * dilationH;
              int xw2 = ow + patchW * dilationW;
              int x[${a.length}];
              x[0] = b;
              x[1] = patchC;
              x[2] = xh2;
              x[3] = xw2;
              if(xh2 >= 0 &&
                  xh2 < XH &&
                  xw2 >= 0 &&
                  xw2 < XW) {
                value[i] = _X(x);
              }
            }
            ++p;
          }
          return value;
        }
        `;return ve(L({},t),{output:{dims:l,type:i.type,textureType:4},shaderSource:d})},$Y=(e,t,i,r,n)=>{let o=hW(n.cacheKey);return ve(L({},o),{get:()=>pW(e,o,t,i,r,n)})},WN=(e,t,i,r=4)=>[i[0],i[2],i[3],Math.ceil(e[1]*t[2]*t[3]/r)]}),fW,mW,qY,GCe=Ce(()=>{"use strict";ur(),un(),qi(),Tg(),WY(),fW=(e,t)=>({name:"ConvDotProduct",inputNames:e?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:e?[0,4,0]:[0,4],cacheKey:t.activationCacheKey}),mW=(e,t,i,r,n)=>{let o=i[0].dims,a=i[1].dims,s=[a[0],Math.ceil(o[1]*a[2]*a[3]/4)],c=WN(o,a,r),[l,d]=e.calculateTextureWidthAndHeight(s,4),u=mi.computeStrides(c),[h,p]=e.calculateTextureWidthAndHeight(c,4),m=r.length,f=i.length<3?"0.0":"_B(b)",g=Math.ceil(o[1]*a[2]*a[3]/4),{activationFunction:v,applyActivation:_}=lb(n),b=$i(e.session.backend.glContext.version),y=`
${v}
float process(int indices[${m}]) {
  int b[1];
  b[0] = indices[1];
  int im2col[4];
  im2col[0] = indices[0];
  im2col[1] = indices[2];
  im2col[2] = indices[3];
  int im2colOffset = im2col[0] * ${u[0]} + im2col[1] * ${u[1]} + im2col[2] * ${u[2]};
  int kernelOffset = indices[1] * ${s[1]};
  float value = ${f};
  for (int i = 0; i < ${g}; ++i) {
    vec2 im2colCoords = offsetToCoords(im2colOffset, ${h}, ${p});
    vec2 kernelCoords = offsetToCoords(kernelOffset, ${l}, ${d});
    value += dot(${b.texture2D}(Im2Col, im2colCoords), ${b.texture2D}(K, kernelCoords));
    ++im2colOffset;
    ++kernelOffset;
  }
  ${_}
  return value;
}`;return ve(L({},t),{output:{dims:r,type:i[0].type,textureType:0},shaderSource:y})},qY=(e,t,i,r)=>{let n=fW(t.length>2,r);return ve(L({},n),{get:()=>mW(e,n,t,i,r)})}}),J_,qN,gW,vW,_W,bW,XN,yW,bO=Ce(()=>{"use strict";yo(),ur(),LCe(),jCe(),GCe(),Tg(),WY(),vO(),J_=(e,t,i,r,n)=>{let o=e[0],a=e.slice(2),s=a.length,c=t[0],l=t.slice(2).map((u,h)=>u+(u-1)*(i[h]-1)),d=a.map((u,h)=>u+r[h]+r[h+s]).map((u,h)=>Math.floor((u-l[h]+n[h])/n[h]));return[o,c].concat(...d)},qN=(e,t,i)=>(yW(t,i),gW(e,t,i)),gW=(e,t,i)=>{let r=bW(i,t),n=e.session.pack,o=r.kernelShape[0]===1&&r.kernelShape[1]===1;return r.group>1?[e.run(FY(e,t,r),t)]:o&&n?[vW(e,t,r)]:n&&t[0].dims.length===4&&t[0].dims[0]===1&&!o?[GY(e,t,r)]:[_W(e,t,r)]},vW=(e,t,i)=>{let r=t[0].dims,n=t[1].dims,o=J_(r,n,i.dilations,i.pads,i.strides),a=e.reshapeUnpacked(t[0],[r[1],r[2]*r[3]]),s=e.reshapeUnpacked(t[1],[n[0],n[1]]),c=t.length>2?[s,a,t[2]]:[s,a],l=e.run(BY(c,i),c);return e.reshapeUnpacked(l,o)},_W=(e,t,i)=>{let r=t[0].dims,n=t[1].dims,o=J_(r,n,i.dilations,i.pads,i.strides),a=e.run($Y(e,t[0],t[1],o,i),[t[0]]),s=t.length===3?[a,t[1],t[2]]:[a,t[1]];return e.run(qY(e,t,o,i),s)},bW=(e,t)=>{let i=e.kernelShape.slice();if(e.kernelShape.length===0)for(let o=2;o<t[1].dims.length;++o)i.push(t[1].dims[o]);let r=e.pads.slice();kE.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,i,r,e.autoPad);let n=Object.assign({},e);return Object.assign(n,{kernelShape:i,pads:r,cacheKey:e.cacheKey}),n},XN=e=>{let t=e.attributes,i=VE(t),r=t.getString("auto_pad","NOTSET"),n=t.getInts("dilations",[1,1]),o=t.getInt("group",1),a=t.getInts("kernel_shape",[]),s=t.getInts("pads",[0,0,0,0]),c=t.getInts("strides",[1,1]);return Gr(L({autoPad:r,dilations:n,group:o,kernelShape:a,pads:s,strides:c},i))},yW=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4||e[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");let i=e[0].dims[1],r=e[1].dims[1]*t.group;if(i!==r)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let n=e[0].dims.length-2;if(t.dilations.length!==n)throw new Error(`dilations should be ${n}D`);if(t.strides.length!==n)throw new Error(`strides should be ${n}D`);if(t.pads.length!==n*2)throw new Error(`pads should be ${n*2}D`);if(t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(e[0].type!=="float32"||e[1].type!=="float32")throw new Error("Conv input(X,W) should be float tensor");if(e.length===3&&e[2].type!=="float32")throw new Error("Conv input(bias) should be float tensor")}}),xW,wW,EW,XY,CW,SW,TW,AW,DW,IW,YY,MW,$Ce=Ce(()=>{"use strict";yo(),un(),qi(),Tg(),xW=(e,t,i,r,n,o)=>(e-1)*t+i+(r-1)*n+1-o,wW=(e,t,i,r,n)=>{let o=Math.floor(e/2);t==="SAME_UPPER"?(i[r]=o,i[n]=e-o):t==="SAME_LOWER"&&(i[r]=e-o,i[n]=o)},EW=(e,t,i,r,n,o,a,s)=>{let c=e.length-2,l=s.length===0;for(let d=0;d<c;++d){let u=l?e[d+2]*o[d]:s[d],h=xW(e[d+2],o[d],n[d],t[d],i[d],u);wW(h,r,n,d,d+c),l&&s.push(o[d]*(e[d+2]-1)+a[d]+(t[d]-1)*i[d]+1-n[d]-n[d+c])}},XY=(e,t,i)=>(MW(t,i),CW(e,t,i)),CW=(e,t,i)=>{let r=IW(i,t);return[DW(e,t,r)]},SW=(e,t)=>({name:"ConvTranspose",inputNames:e?["X","W","B"]:["X","W"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t}),TW=(e,t,i,r)=>{let n=t.length>2?"getB(output_channel)":"0.0",o=t[0].dims,a=t[1].dims,s=a[1],c=a[0]/r.group,l=[t[0].dims[0],t[1].dims[1]*r.group,...r.outputShape],d=$i(e.session.backend.glContext.version),{activationFunction:u,applyActivation:h}=lb(r),p=`
  const ivec2 strides = ivec2(${r.strides[0]}, ${r.strides[1]});
  const ivec2 pads = ivec2(${r.pads[0]}, ${r.pads[1]});
  ${u}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;

    ivec2 loc = coords.zw + pads;

    int group_id = output_channel / ${s};
    int wOutChannel = output_channel - group_id * ${s};

    float value = ${n};
    for (int inChannelOffset = 0; inChannelOffset < ${c}; inChannelOffset++) {
      int input_channel = group_id * ${c} + inChannelOffset;
      for (int wWOff = 0; wWOff < ${a[2]}; wWOff++) {
        for (int wHOff = 0; wHOff < ${a[3]}; wHOff++) {
          ivec2 wOff = ivec2(wWOff * ${r.dilations[0]}, wHOff * ${r.dilations[1]});
          ivec2 wLoc = loc - wOff;
          ivec2 wLocIn = wLoc / strides;
          if (
            wLocIn * strides == wLoc &&
            wLocIn.x >= 0 && wLocIn.x < ${o[2]} &&
            wLocIn.y >= 0 && wLocIn.y < ${o[3]}
          ) {
            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);
            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);
            value += xVal * wVal;
          }
        }
      }
    }
    ${h}
    ${d.output} = vec4(value, .0, .0, .0);
  }
`;return ve(L({},i),{output:{dims:l,type:t[0].type,textureType:0},shaderSource:p,hasMain:!0})},AW=(e,t,i)=>{let r=SW(t.length>2,i.cacheKey);return ve(L({},r),{get:()=>TW(e,t,r,i)})},DW=(e,t,i)=>e.run(AW(e,t,i),t),IW=(e,t)=>{let i=e.kernelShape.slice();if(e.kernelShape.length===0)for(let s=2;s<t[1].dims.length;++s)i.push(t[1].dims[s]);let r=e.pads.slice(),n=e.outputShape.slice(),o=t[0].dims;EW(o,i,e.dilations,e.autoPad,r,e.strides,e.outputPadding,n);let a=Object.assign({},e);return Object.assign(a,{kernelShape:i,pads:r,outputShape:n,cacheKey:e.cacheKey}),a},YY=e=>{let t=e.attributes,i=VE(t),r=t.getString("auto_pad","NOTSET"),n=t.getInts("dilations",[1,1]),o=t.getInt("group",1),a=t.getInts("kernel_shape",[]),s=t.getInts("output_padding",[0,0]),c=t.getInts("output_shape",[]),l=t.getInts("pads",[0,0,0,0]),d=t.getInts("strides",[1,1]);return Gr(L({autoPad:r,dilations:n,group:o,kernelShape:a,outputPadding:s,outputShape:c,pads:l,strides:d},i))},MW=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4||e[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");let i=e[0].dims[1],r=e[1].dims[0];if(i!==r)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let n=e[1].dims[1]*t.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==n))throw new Error("invalid bias");let o=e[0].dims.length-2;if(t.dilations.length!==o)throw new Error(`dilations should be ${o}D`);if(t.strides.length!==o)throw new Error(`strides should be ${o}D`);if(t.pads.length!==o*2)throw new Error(`pads should be ${o*2}D`);if(t.outputPadding.length!==o)throw new Error(`output_padding should be ${o}D`);if(t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(t.outputShape.length!==0&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape");if(e[0].type!=="float32"||e[1].type!=="float32")throw new Error("ConvTranspose input(X,W) should be float tensor");if(e.length===3&&e[2].type!=="float32")throw new Error("ConvTranspose input(bias) should be float tensor")}}),JP,nb,ZY,kW,eN,PW,NW,OW,yO=Ce(()=>{"use strict";yo(),ur(),qi(),JP={name:"Transpose",inputNames:["A"],inputTypes:[0]},nb=(e,t,i)=>(OW(t),[e.run(ve(L({},JP),{cacheHint:i.cacheKey,get:()=>kW(e,t[0],i.perm)}),t)]),ZY=e=>Gr({perm:e.attributes.getInts("perm",[])}),kW=(e,t,i)=>{let r=t.dims;i=eN(r,i);let n=PW(r,i),o=r.length,a=`
      ${NW("perm",i,o)}
      float process(int indices[${o}]) {
        int a[${o}];
        perm(a, indices);
        return _A(a);
      }`;return ve(L({},JP),{output:{dims:n,type:t.type,textureType:0},shaderSource:a})},eN=(e,t)=>(t&&t.length!==e.length&&(t=[...e.keys()].reverse()),t),PW=(e,t)=>(t=eN(e,t),mi.sortBasedOnPerm(e,t)),NW=(e,t,i)=>{let r=[];r.push(`void ${e}(out int a[${i}], int src[${i}]) {`);for(let n=0;n<i;++n)r.push(`	a[${t[n]}]=src[${n}];`);return r.push("	}"),r.join(`
`)},OW=e=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.");if(e[0].type!=="float32"&&e[0].type!=="float64")throw new Error("input should be float tensor")}}),KY,QY,RW,WCe=Ce(()=>{"use strict";yO(),KY=(e,t,i)=>{RW(t);let r=i.blocksize,n=r*r,o=i.mode==="DCR"?[0,3,4,1,5,2]:[0,1,4,2,5,3],a=i.mode==="DCR"?[t[0].dims[0],r,r,t[0].dims[1]/n,t[0].dims[2],t[0].dims[3]]:[t[0].dims[0],t[0].dims[1]/n,r,r,t[0].dims[2],t[0].dims[3]],s=e.reshapeUnpacked(t[0],a),c={perm:o,cacheKey:`${o}`},[l]=nb(e,[s],c),d=[t[0].dims[0],t[0].dims[1]/n,t[0].dims[2]*r,t[0].dims[3]*r];return[e.reshapeUnpacked(l,d)]},QY=e=>{let t=e.attributes.getInt("blocksize");if(t<1)throw new Error(`blocksize must be >= 1, but got : ${t} for DepthToSpace`);let i=e.attributes.getString("mode","DCR");if(i!=="DCR"&&i!=="CRD")throw new Error(`unrecognized mode: ${i} for DepthToSpace`);return{mode:i,blocksize:t}},RW=e=>{if(e.length!==1)throw new Error(`DepthToSpace expect 1 inputs, but got ${e.length}`);if(e[0].type==="string"||e[0].dims.length!==4)throw new TypeError("DepthToSpace input should be a 4-D numeric tensor")}}),JY,eZ,FW,qCe=Ce(()=>{"use strict";ur(),JY=(e,t,i)=>{FW(t,i);let r=mi.flattenShape(t[0].dims,i);return[e.reshapeUnpacked(t[0],r)]},eZ=e=>e.attributes.getInt("axis",1),FW=(e,t)=>{if(!e||e.length!==1)throw new Error("Flatten requires 1 input.");let i=e[0].dims.length;if(i===0)throw new Error("scalar tensor is not supported.");if(t<-i||t>i)throw new Error("Invalid axis");if(e[0].type==="string")throw new Error("string tensor is not supported.")}}),cb,zE=Ce(()=>{"use strict";cb=["float32","float64","int32","int16","int8","uint16","uint32","uint8"]}),tZ,iZ,LW,BW,VW,zW,XCe=Ce(()=>{"use strict";yo(),zE(),ur(),qi(),tZ=(e,t,i)=>(zW(t,i.axis),[e.run(VW(e,t,i),t)]),iZ=e=>Gr({axis:e.attributes.getInt("axis",0)}),LW={name:"Gather",inputNames:["A","B"],inputTypes:[0,0]},BW=(e,t,i,r)=>{let n=i[0].dims.slice(),o=i[1].dims.slice(),a=new Array(n.length+o.length-1);r=mi.normalizeAxis(r,n.length);let s=[];for(let h=0;h<a.length;h++)h<r?(a[h]=n[h],s.push(`inputIdx[${h}] = outputIdx[${h}];`)):h<r+o.length?(a[h]=o[h-r],s.push(`indexDataIdx[${h-r}] = outputIdx[${h}];`)):(a[h]=n[h-o.length+1],s.push(`inputIdx[${h-o.length+1}] = outputIdx[${h}];`));let c=a.length||1,l=n.length,d=o.length||1,u=`
      float process(int outputIdx[${c}]) {
        int inputIdx[${l}];
        int indexDataIdx[${d}];
        indexDataIdx[0] = 0;
        ${s.join(`
        `)}
        int idx = int(_B(indexDataIdx));
        inputIdx[${r}] = idx < 0 ? idx + ${n[r]} : idx;
        return _A(inputIdx);
      }`;return ve(L({},t),{output:{dims:a,type:i[0].type,textureType:0},shaderSource:u})},VW=(e,t,i)=>{let r=ve(L({},LW),{cacheHint:i.cacheKey});return ve(L({},r),{get:()=>BW(e,r,t,i.axis)})},zW=(e,t)=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.");let i=e[0].dims.length;if(i<1)throw new Error("Invalid input shape.");if(t<-i||t>i-1)throw new Error("Invalid axis.");if(cb.indexOf(e[0].type)===-1)throw new Error("Invaid input type.");if(e[1].type!=="int32"&&e[1].type!=="int16")throw new Error("Invaid input type.")}}),YN,tN,rZ,nZ,UW,HW,jW,YCe=Ce(()=>{"use strict";yo(),ur(),qi(),YN=(e,t,i)=>(jW(t,i),[e.run(UW(t,i),t)]),tN=(e,t)=>{let i=e.attributes.getInt("transA",0)!==0,r=e.attributes.getInt("transB",0)!==0,n=e.attributes.getFloat("alpha",1),o=e.attributes.getFloat("beta",1);return Gr({transA:i,transB:r,alpha:n,beta:o,isOptionalC:t})},rZ=e=>tN(e,!1),nZ=e=>tN(e,!0),UW=(e,t)=>{let i={name:"Gemm",inputNames:e.length===3?["A","B","C"]:["A","B"],inputTypes:e.length===3?[0,0,0]:[0,0],key:t.cacheKey};return ve(L({},i),{get:()=>HW(i,e,t)})},HW=(e,t,i)=>{let r=t[0].dims.slice(),n=t[1].dims.slice(),[o,a]=MX.getShapeOfGemmResult(r,i.transA,n,i.transB,t.length===3?t[2].dims:void 0),s=[o,a];if(!s)throw new Error("Can't use gemm on the given tensors");let c=r[r.length-1],l="";i.transA&&(c=r[0]),i.transA&&i.transB?l="value += _A_T(a) * _B_T(b);":i.transA&&!i.transB?l="value += _A_T(a) * _B(b);":!i.transA&&i.transB?l="value += _A(a) * _B_T(b);":!i.transA&&!i.transB&&(l="value += _A(a) * _B(b);");let d=s.length,u=t.length===3?`int c[${t[2].dims.length}];`:"",h=t.length===3?"bcastIndices_C(indices, c);":"",p=t.length===3?"value += beta * _C(c);":"",m=`
      float process(int indices[${d}]) {
          int a[${d}];
          int b[${d}];
          ${u}

          copyVec(indices, a);
          copyVec(indices, b);
          ${h}

          float value = 0.0;
          for (int k=0; k<${c}; ++k) {
              a[${d-1}] = k;
              b[${d-2}] = k;
              ${l}
          }

          value = value * alpha;
          ${p}
          return value;
      }`;return ve(L({},e),{output:{dims:s,type:t[0].type,textureType:0},variables:[{name:"alpha",type:"float",data:i.alpha},{name:"beta",type:"float",data:i.beta}],shaderSource:m})},jW=(e,t)=>{if(!e)throw new Error("Input is missing");if(t.isOptionalC&&(e.length<2||e.length>3))throw new Error("Invaid input shape.");if(!t.isOptionalC&&e.length!==3)throw new Error("Gemm requires 3 inputs");if(e.length===3&&e[2].dims.length!==1&&e[2].dims.length!==2)throw new Error("Invalid input shape of C");if(e[0].type!=="float32"&&e[0].type!=="float64"||e[1].type!=="float32"&&e[1].type!=="float64"||e.length===3&&e[2].type!=="float32"&&e[2].type!=="float64")throw new Error("Invalid input type.");if(e[0].type!==e[1].type||e.length===3&&e[0].type!==e[2].type)throw new Error("Input types are mismatched")}}),oZ,aZ,GW,$W,WW,qW,XW,ZCe=Ce(()=>{"use strict";yo(),qi(),oZ=(e,t,i)=>(XW(t),[e.run(WW(e,t,i),t)]),aZ=e=>{let t=e.attributes.getFloat("scale"),i=e.attributes.getFloats("bias");return Gr({scale:t,bias:i})},GW={name:"ImageScaler",inputNames:["X"],inputTypes:[0]},$W=(e,t,i,r)=>{let n=i[0].dims.slice(),o=n.length,a=`
      ${qW(r.bias.length)}
      float process(int indices[${o}]) {
        return _X(indices) * scale + getBias(bias, indices[1]);
      }`;return ve(L({},t),{output:{dims:n,type:i[0].type,textureType:0},variables:[{name:"bias",type:"float",arrayLength:r.bias.length,data:r.bias},{name:"scale",type:"float",data:r.scale}],shaderSource:a})},WW=(e,t,i)=>{let r=ve(L({},GW),{cacheHint:i.cacheKey});return ve(L({},r),{get:()=>$W(e,r,t,i)})},qW=e=>{let t=[`float getBias(float bias[${e}], int channel) {`];for(let i=0;i<e;++i)i===0?t.push(`	if (channel == ${i}) { return bias[${i}]; }`):i===e-1?t.push(`	else { return bias[${i}]; }`):t.push(`	else if (channel == ${i}) { return bias[${i}]; }`);return t.push("	}"),t.join(`
`)},XW=e=>{if(!e||e.length!==1)throw new Error("ImageScaler requires 1 input.");if(e[0].dims.length!==4)throw new Error("Invalid input shape.");if(e[0].type!=="float32"&&e[0].type!=="float64")throw new Error("Invalid input type.")}}),sZ,lZ,iN,YW,ZW,KW,QW,JW,eq,KCe=Ce(()=>{"use strict";un(),qi(),sZ=(e,t,i)=>{eq(t);let r=e.run(ZW(t[0]),t);return[e.run(JW(e,t[0],i,r.dims),[t[0],r,t[1],t[2]])]},lZ=e=>e.attributes.getFloat("epsilon",1e-5),iN={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[0]},YW=(e,t)=>{let i=t.dims.slice(),r=i[1],n=i[2]*i[3],o=[i[0],r],a=`
      vec4 process(int[2] indices) {
        vec4 v = vec4(0.0);
        int a[4];
        a[0] = indices[0];
        a[1] = indices[1];
        float temp = 0.0;
        for(int a2=0; a2<${i[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${i[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += x;
          }
        }
        float mean = temp / float(${n});
        temp = 0.0;
        for(int a2=0; a2<${i[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${i[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += (x - mean) * (x - mean);
          }
        }
        v.r = mean;
        v.g = temp / float(${n});

        return v;
      }`;return ve(L({},e),{output:{dims:o,type:t.type,textureType:4},shaderSource:a})},ZW=e=>ve(L({},iN),{get:()=>YW(iN,e)}),KW={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[0,4,0,0]},QW=(e,t,i,r,n)=>{let o=$i(e.session.backend.glContext.version),[a,s]=e.calculateTextureWidthAndHeight(n,4),[c,l]=[a/4,s],d=`
      vec4 get_MeanAndVariance(int[2] mv) {
        int offset = indicesToOffset_MeanAndVariance(mv);
        vec2 coords = offsetToCoords(offset, ${c}, ${l});
        return ${o.texture2D}(MeanAndVariance, coords);
      }

      float process(int[4] indices) {
        int mv[2];
        mv[0] = indices[0];
        mv[1] = indices[1];
        vec4 mean_and_variance = get_MeanAndVariance(mv);
        float mean = mean_and_variance.r;
        float variance = mean_and_variance.g;

        int sb[1];
        sb[0] = indices[1];
        float scale = _Scale(sb);
        float b = _B(sb);

        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;
      }`;return ve(L({},t),{output:{dims:i.dims,type:i.type,textureType:0},variables:[{name:"epsilon",type:"float",data:r}],shaderSource:d})},JW=(e,t,i,r)=>{let n=ve(L({},KW),{cacheHint:`${i}`});return ve(L({},n),{get:()=>QW(e,n,t,i,r)})},eq=e=>{if(!e||e.length!==3)throw new Error("InstanceNormalization requires 3 inputs.");let t=e[0],i=e[1],r=e[2];if(t.dims.length<3||i.dims.length!==1||r.dims.length!==1)throw new Error("Invalid input shape.");if(i.dims[0]!==t.dims[1]||r.dims[0]!==t.dims[1])throw new Error("Input shapes are mismatched.");if(t.type!=="float32"&&t.type!=="float64"||i.type!=="float32"&&i.type!=="float64"||r.type!=="float32"&&r.type!=="float64")throw new Error("Invalid input type.");if(e[0].dims.length!==4)throw new Error("Only support 4-D input shape.")}});function QCe(e,t){let i=e[0].dims[1],r=e[0].dims.length,n=-Math.floor((t.size-1)/2),o=Math.ceil((t.size-1)/2),a=`float(${t.alpha}) / float(${t.size})`,s=`float(${t.bias})`,c=`float(${t.beta})`,l=`
    float process(int indices[${r}]) {
        int c = indices[1];
        float x = _X(indices);
        float square_sum = 0.0;

        for (int i = ${n}; i <= ${o}; i++) {
          int idx = c + i;
          if (c >= 0 && c < ${i}) {
            indices[1] = idx;
            float j = _X(indices);
            square_sum += j * j;
          }
        }
        return x / pow(${s} + ${a} * square_sum, ${c});
    }`;return ve(L({},xO),{cacheHint:t.cacheKey,output:{dims:e[0].dims,type:e[0].type,textureType:0},shaderSource:l})}function JCe(e,t){return ve(L({},xO),{cacheHint:t.cacheKey,get:()=>QCe(e,t)})}var cZ,dZ,xO,tq,eSe=Ce(()=>{"use strict";yo(),qi(),cZ=(e,t,i)=>(tq(t),[e.run(JCe(t,i),t)]),dZ=e=>{let t=e.attributes.getFloat("alpha",1e-4),i=e.attributes.getFloat("beta",.75),r=e.attributes.getFloat("bias",1),n=e.attributes.getInt("size");return Gr({alpha:t,beta:i,bias:r,size:n})},xO={name:"LRN",inputNames:["X"],inputTypes:[0]},tq=e=>{if(!e||e.length!==1)throw new Error("LRN requires 1 input.");if(e[0].dims.length!==4)throw new Error('currently only support LRN for input with "NCHW" format');if(e[0].type!=="float32")throw new Error("input should be float type")}}),iq,ZN,uZ,hZ,pZ,rq,nq,oq,aq,sq,lq,cq,dq,tSe=Ce(()=>{"use strict";yo(),ur(),un(),qi(),iq={name:"Pad",inputNames:["A"],inputTypes:[0]},ZN=(e,t,i)=>(oq(t),[e.run(ve(L({},iq),{cacheHint:i.cacheKey,get:()=>nq(e,t[0],i)}),t)]),uZ=e=>{let t=e.attributes.getString("mode","constant"),i=e.attributes.getFloat("value",0),r=e.attributes.getInts("pads");return Gr({mode:t,value:i,pads:r})},hZ=(e,t,i)=>{aq(t);let r=rq(e,t,i);return ZN(e,[t[0]],r)},pZ=e=>e.attributes.getString("mode","constant"),rq=(e,t,i)=>{if(!e.session.isInitializer(t[1].dataId)||t.length>=3&&!e.session.isInitializer(t[2].dataId))throw new Error("dynamic pad attributes are not allowed");let r=Array.from(t[1].integerData),n=t.length>=3?t[2].floatData[0]:0;return Gr({mode:i,pads:r,value:n})},nq=(e,t,i)=>{let r=mi.padShape(t.dims.slice(),i.pads),n=r.length,o=`
      ${sq(e,t,i)}
      float process(int[${n}] indices) {
          return padA(indices);
      }`;return{name:"Pad",inputNames:["A"],inputTypes:[0],output:{dims:r,type:t.type,textureType:0},shaderSource:o}},oq=e=>{if(!e||e.length!==1)throw new Error("Pad requires 1 input");if(e[0].type!=="float32"&&e[0].type!=="float64")throw new Error("Invalid input type.")},aq=e=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Pad requires 2 or 3 inputs");if(e[1].type!=="int32")throw new Error("Invalid input type.");if(e.length>=3&&e[2].type==="string")throw new Error("Invalid input type.")},sq=(e,t,i)=>{let r=$i(e.session.backend.glContext.version),[n,o]=e.calculateTextureWidthAndHeight(t.dims,0),a=mi.computeStrides(t.dims);switch(i.mode){case"constant":return lq(r,t.dims,a,n,o,i.pads,i.value);case"reflect":return cq(r,t.dims,a,n,o,i.pads);case"edge":return dq(r,t.dims,a,n,o,i.pads);default:throw new Error("Invalid mode")}},lq=(e,t,i,r,n,o,a)=>{let s=t.length,c="";for(let l=s-1;l>=0;--l)c+=`
        k = m[${l}] - ${o[l]};
        if (k < 0)  return constant;
        if (k >= ${t[l]}) return constant;
        offset += k * ${i[l]};
        `;return`
      float padA(int m[${s}]) {
        const float constant = float(${a});
        int offset = 0;
        int k = 0;
        ${c}
        vec2 coords = offsetToCoords(offset, ${r}, ${n});
        float value = getColorAsFloat(${e.texture2D}(A, coords));
        return value;
      }
      `},cq=(e,t,i,r,n,o)=>{let a=t.length,s="";for(let c=a-1;c>=0;--c)s+=`
        k = m[${c}] - ${o[c]};
        if (k < 0) { k = -k; }
        {
          const int _2n_1 = ${2*(t[c]-1)};
          k = int( mod( float(k), float(_2n_1) ) ) ;
          if(k >= ${t[c]}) { k = _2n_1 - k; }
        }
        offset += k * ${i[c]};
        `;return`
      float padA(int m[${a}]) {
        int offset = 0;
        int k = 0;
        ${s}
        vec2 coords = offsetToCoords(offset, ${r}, ${n});
        float value = getColorAsFloat(${e.texture2D}(A, coords));
        return value;
      }
      `},dq=(e,t,i,r,n,o)=>{let a=t.length,s="";for(let c=a-1;c>=0;--c)s+=`
        k = m[${c}] - ${o[c]};
        if (k < 0)  k = 0;
        if (k >= ${t[c]}) k = ${t[c]-1};
        offset += k * ${i[c]};
      `;return`
      float padA(int m[${a}]) {
        int offset = 0;
        int k = 0;
        ${s}
        vec2 coords = offsetToCoords(offset, ${r}, ${n});
        float value = getColorAsFloat(${e.texture2D}(A, coords));
        return value;
      }
      `}}),fZ,mZ,rN,gZ,vZ,_Z,bZ,nN,oN,uq,aN,yZ,B_,sN,V_,hq,iSe=Ce(()=>{"use strict";yo(),ur(),qi(),fZ=(e,t,i)=>{B_(t);let r={name:"AveragePool",inputNames:["X"],inputTypes:[0],cacheHint:i.cacheKey};return[e.run(ve(L({},r),{get:()=>rN(t,r,!1,i)}),t)]},mZ=e=>{let t=e.attributes.getString("auto_pad","NOTSET"),i=e.attributes.getInt("ceil_mode",0),r=e.attributes.getInt("count_include_pad",0)!==0,n=e.attributes.getInts("kernel_shape"),o=e.attributes.getInts("strides",[]),a=e.attributes.getInts("pads",[]);if(i!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return Gr({autoPad:t,ceilMode:i,countIncludePad:r,kernelShape:n,strides:o,pads:a})},rN=(e,t,i,r)=>{let[n,o]=oN(e,r,i),a=mi.size(n.kernelShape),s="value += _X(x);",c="";n.countIncludePad?c+=`value /= float(${a});`:c+=`value /= float(${a} - pad);`;let l=`
        ${sN(e[0].dims,n,s,c,"0.0")}
      `;return ve(L({},t),{output:{dims:o,type:e[0].type,textureType:0},shaderSource:l})},gZ=(e,t,i)=>{B_(t);let r={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[0],cacheHint:`${i.countIncludePad}`};return[e.run(ve(L({},r),{get:()=>rN(t,r,!0,i)}),t)]},vZ=e=>{let t=e.attributes.getInt("count_include_pad",0)!==0;return Gr({autoPad:"",ceilMode:0,countIncludePad:t,kernelShape:[],strides:[],pads:[]})},_Z=(e,t,i)=>{B_(t);let r={name:"MaxPool",inputNames:["X"],inputTypes:[0],cacheHint:i.cacheKey};return[e.run(ve(L({},r),{get:()=>nN(t,r,!1,i)}),t)]},bZ=e=>{let t=e.attributes.getString("auto_pad","NOTSET"),i=e.attributes.getInt("ceil_mode",0),r=e.attributes.getInts("kernel_shape"),n=e.attributes.getInts("strides",[]),o=e.attributes.getInts("pads",[]),a=e.attributes.getInt("storage_order",0),s=e.attributes.getInts("dilations",[]);if(a!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(i!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return Gr({autoPad:t,ceilMode:i,countIncludePad:!1,kernelShape:r,strides:n,pads:o,storageOrder:a,dilations:s})},nN=(e,t,i,r)=>{let[n,o]=oN(e,r,i),a=`
      value = max(_X(x), value);
    `,s="",c=`
      ${sN(e[0].dims,n,a,s,"-1e5")}
    `;return ve(L({},t),{output:{dims:o,type:e[0].type,textureType:0},shaderSource:c})},oN=(e,t,i)=>{let r=e[0].dims.slice(),n=Object.hasOwnProperty.call(t,"dilations"),o=t.kernelShape.slice(),a=t.strides.slice(),s=n?t.dilations.slice():[],c=t.pads.slice();kE.adjustPoolAttributes(i,r,o,a,s,c);let l=kE.computePoolOutputShape(i,r,a,s,o,c,t.autoPad),d=Object.assign({},t);return n?Object.assign(d,{kernelShape:o,strides:a,pads:c,dilations:s,cacheKey:t.cacheKey}):Object.assign(d,{kernelShape:o,strides:a,pads:c,cacheKey:t.cacheKey}),[d,l]},uq={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},aN={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[0]},yZ=(e,t)=>(B_(t),[e.run(ve(L({},aN),{get:()=>nN(t,aN,!0,uq)}),t)]),B_=e=>{if(!e||e.length!==1)throw new Error("Pool ops requires 1 input.");if(e[0].type!=="float32"&&e[0].type!=="float64")throw new Error("Invalid input type.")},sN=(e,t,i,r,n)=>{let o=e.length;if(t.kernelShape.length<=2){let a=t.kernelShape[t.kernelShape.length-1],s=t.strides[t.strides.length-1],c=t.pads[t.pads.length/2-1],l=t.pads[t.pads.length-1],d=e[o-1],u="",h="",p="";if(c+l!==0?u=`
          for (int i = 0; i < ${a}; i++) {
            x[${o} - 1] = indices[${o} - 1] * ${s} - ${c} + i;
            if (x[${o} - 1] < 0 || x[${o} - 1] >= ${d}) {
              pad++;
              continue;
            }
            ${i}
          }`:u=`
          for (int i = 0; i < ${a}; i++) {
            x[${o} - 1] = indices[${o} - 1] * ${s} - ${c} + i;
            ${i}
          }`,t.kernelShape.length===2){let m=t.kernelShape[t.kernelShape.length-2],f=t.strides[t.strides.length-2],g=t.pads[t.pads.length/2-2],v=t.pads[t.pads.length-2],_=e[o-2];g+v!==0?h=`
            for (int j = 0; j < ${m}; j++) {
              x[${o} - 2] = indices[${o} - 2] * ${f} - ${g} + j;
              if (x[${o} - 2] < 0 || x[${o} - 2] >= ${_}) {
                pad+= ${a};
                continue;
              }
          `:h=`
            for (int j = 0; j < ${m}; j++) {
              x[${o} - 2] = indices[${o} - 2] * ${f} - ${g} + j;
            `,p=`
          }
        `}return`
        float process(int indices[${o}]) {
          int x[${o}];
          copyVec(indices, x);

          float value = ${n};
          int pad = 0;
          ${h}
          ${u}
          ${p}
          ${r}
          return value;
        }
      `}else{let a=mi.size(t.kernelShape),s=mi.computeStrides(t.kernelShape),c=s.length,l=t.pads.length,d=hq(c),u=V_(e,"inputDims"),h=V_(t.pads,"pads"),p=V_(s,"kernelStrides"),m=V_(t.strides,"strides"),f=t.pads.reduce((v,_)=>v+_),g="";return f?g=`
            if (x[j] >= inputDims[j] || x[j] < 0) {
              pad++;
              isPad = true;
              break;
            }
          }
          if (!isPad) {
            ${i}
          }`:g=`
          }
          ${i}
        `,`
        ${d}
        float process(int indices[${o}]) {
          int x[${o}];
          copyVec(indices, x);
          int offset[${c}];
          int pads[${l}];
          int inputDims[${o}];
          int kernelStrides[${c}];
          int strides[${c}];
          ${h}
          ${u}
          ${m}
          ${p}

          float value = ${n};
          int pad = 0;
          bool isPad = false;
          for (int i = 0; i < ${a}; i++) {
            offsetToIndices(i, kernelStrides, offset);
            isPad = false;
            for (int j = ${o} - ${c}; j < ${o}; j++) {
              x[j] = indices[j] * strides[j - ${o} + ${c}]
                + offset[j - ${o} + ${c}] - pads[j - 2];
              ${g}
          }
          ${r}

          return value;
        }
      `}},V_=(e,t)=>{let i="";for(let r=0;r<e.length;r++)i+=`
      ${t}[${r}] = ${e[r]};
    `;return i},hq=e=>`
  void offsetToIndices(int offset, int[${e}] strides, out int[${e}] indices) {
    if (${e} == 0) {
      return;
    }
    for (int i = 0; i < ${e} - 1; ++i) {
      indices[i] = offset / strides[i];
      offset -= indices[i] * strides[i];
    }
    indices[${e} - 1] = offset;
  }`}),ku,Ou,pq,fq,xZ,wZ,EZ,CZ,SZ,TZ,AZ,rSe=Ce(()=>{"use strict";yo(),zE(),ur(),qi(),ku=(e,t,i,r,n)=>{fq(t);let o={name:r,inputNames:["A"],inputTypes:[0]};return[e.run(ve(L({},o),{cacheHint:i.cacheKey,get:()=>pq(e,t,i,r,n,o)}),t)]},Ou=e=>{let t=e.attributes.getInts("axes",[]),i=e.attributes.getInt("keepdims",1)===1;return Gr({axes:t,keepDims:i})},pq=(e,t,i,r,n,o)=>{let a=[],s=t[0].dims.length||1,c=[],l=mi.normalizeAxes(i.axes,t[0].dims.length),d=n(t,l),u=d[1];for(let p=0;p<t[0].dims.length;p++)l.indexOf(p)>=0||l.length===0?(i.keepDims&&a.push(1),u=`
          for(int j${p} = 0; j${p} < ${t[0].dims[p]}; j${p}++) {
            inputIdx[${p}] = j${p};
            ${u}
          }`):(c.push(`inputIdx[${p}] = outputIdx[${a.length}];`),a.push(t[0].dims[p]));let h=`
      float process(int outputIdx[${a.length||1}]) {
        float value;                 // final result
        int inputIdx[${s}];      // addressing input data
        ${c.join(`
`)}
        ${d[0]}       // init ops for reduce max/min
        ${u}
        ${d[2]}       // final computation for reduce mean
        return value;
      }`;return ve(L({},o),{output:{dims:a,type:t[0].type,textureType:0},shaderSource:h})},fq=e=>{if(!e||e.length!==1)throw new Error("Reduce op requires 1 input.");if(cb.indexOf(e[0].type)===-1)throw new Error("Invalid input type.")},xZ=(e,t,i)=>ku(e,t,i,"ReduceSum",()=>["value = 0.0;","value += _A(inputIdx);",""]),wZ=(e,t,i)=>ku(e,t,i,"ReduceMean",(r,n)=>{let o=1;for(let a=0;a<r[0].dims.length;a++)(n.indexOf(a)>=0||n.length===0)&&(o*=r[0].dims[a]);return["value = 0.0;","value += _A(inputIdx);",`value /= ${o}.;`]}),EZ=(e,t,i)=>ku(e,t,i,"ReduceMax",(r,n)=>{let o=[];for(let a=0;a<r[0].dims.length;a++)(n.indexOf(a)>=0||n.length===0)&&o.push(`inputIdx[${a}] = 0;`);return[`${o.join(`
`)}
value = _A(inputIdx);`,"value = max(value, _A(inputIdx));",""]}),CZ=(e,t,i)=>ku(e,t,i,"ReduceMin",(r,n)=>{let o=[];for(let a=0;a<r[0].dims.length;a++)(n.indexOf(a)>=0||n.length===0)&&o.push(`inputIdx[${a}] = 0;`);return[`${o.join(`
`)}
value = _A(inputIdx);`,"value = min(value, _A(inputIdx));",""]}),SZ=(e,t,i)=>ku(e,t,i,"ReduceProd",()=>["value = 1.0;","value *= _A(inputIdx);",""]),TZ=(e,t,i)=>ku(e,t,i,"ReduceLogSum",()=>["value = 0.0;","value += _A(inputIdx);","value = log(value);"]),AZ=(e,t,i)=>ku(e,t,i,"ReduceLogSumSquare",()=>["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""])}),DZ,nSe=Ce(()=>{"use strict";ur(),DZ=(e,t)=>{let i=mi.calculateReshapedDims(t[0].dims,t[1].integerData);return e.session.pack?[e.reshapePacked(t[0],i)]:[e.reshapeUnpacked(t[0],i)]}}),lN,KN,IZ,MZ,eb,mq,QN,NE,kZ=Ce(()=>{"use strict";yo(),un(),qi(),lN={name:"Upsample",inputNames:["X"],inputTypes:[0]},KN=(e,t,i)=>(QN(t,i),[e.run(ve(L({},lN),{cacheHint:i.cacheKey,get:()=>mq(e,t,i)}),t)]),IZ=e=>eb(e,7),MZ=e=>eb(e,9),eb=(e,t)=>{let i=t>=10,r=e.attributes.getString("mode","nearest");if(r!=="nearest"&&r!=="linear"&&(t<11||r!=="cubic"))throw new Error(`unrecognized mode: ${r}`);let n=[];t<9&&(n=e.attributes.getFloats("scales"),NE(n,r,i));let o=e.attributes.getFloat("extrapolation_value",0),a=t>10?e.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(a)===-1)throw new Error(`coordinate_transform_mode '${a}' is not supported`);let s=a==="tf_crop_and_resize",c=s,l=r==="nearest"&&t>=11?e.attributes.getString("nearest_mode","round_prefer_floor"):"";if(["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(l)===-1)throw new Error(`nearest_mode '${l}' is not supported`);let d=e.attributes.getFloat("cubic_coeff_a",-.75),u=e.attributes.getInt("exclude_outside",0)!==0;if(u&&r!=="cubic")throw new Error("exclude_outside can be set to 1 only when mode is CUBIC.");let h=t<11?!0:r==="nearest"&&a==="asymmetric"&&l==="floor",p=0,m=0,f=0;return t>10?e.inputs.length>2?(p=1,m=2,f=3):(m=1,f=2):t===9&&(m=1),Gr({opset:t,isResize:i,mode:r,scales:n,extrapolationValue:o,coordinateTransformMode:a,useExtrapolation:c,needRoiInput:s,nearestMode:l,cubicCoefficientA:d,excludeOutside:u,useNearest2xOptimization:h,roiInputIdx:p,scalesInputIdx:m,sizesInputIdx:f})},mq=(e,t,i)=>{let r=$i(e.session.backend.glContext.version),[n,o]=e.calculateTextureWidthAndHeight(t[0].dims,0),a=t[0].dims.map((f,g)=>Math.floor(f*i.scales[g])),[s,c]=e.calculateTextureWidthAndHeight(a,0),l=a.length,d=new Array(l),u=new Array(l),h=`
      int output_pitches[${l}];
      int input_pitches[${l}];
      `;for(let f=l-1;f>=0;f--)d[f]=f===l-1?1:d[f+1]*a[f+1],u[f]=f===l-1?1:u[f+1]*t[0].dims[f+1],h+=`
        output_pitches[${f}] = ${d[f]};
        input_pitches[${f}] = ${u[f]};
        `;let p=`
      float getInputFloat(int index) {
        vec2 coords = offsetToCoords(index, ${n}, ${o});
        float value = getColorAsFloat(${r.texture2D}(X, coords));
        return value;
      }
      `,m=i.mode==="nearest"?`
    ${p}
    float process(int indices[${l}]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${s}, ${c});

      ${h}

      int d, m;
      for (int dim = 0; dim < ${l}; ++dim) {
        d = output_index / output_pitches[dim];
        m = output_index - d * output_pitches[dim];
        output_index = m;

        if (scales[dim] != 1 && d > 0) {
          int d2 = d / scales[dim];
          m = d - d2 * scales[dim];
          d = d2;
        }
        input_index += input_pitches[dim] * d;
      }

      return getInputFloat(input_index);
    }`:l===4?`
    ${p}
    float process(int indices[4]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${s}, ${c});

      ${h}

      int m;
      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m / output_pitches[1];
      m = m - index_of_dim1 * output_pitches[1];
      index_of_dim2 = m / output_pitches[2];
      m = m - index_of_dim2 * output_pitches[2];
      index_of_dim3 = m;

      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;
      index_of_input_dim2 = index_of_dim2 / scales[2];
      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];
      index_of_input_dim3 = index_of_dim3 / scales[3];
      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];

      input_index = index_of_dim0 * input_pitches[0] +
            index_of_dim1 * input_pitches[1] +
            index_of_input_dim2 * input_pitches[2] +
            index_of_input_dim3;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim2 = false;
      if (index_of_input_dim2 == (${t[0].dims[2]} - 1)) {
        // It's the end in dimension 2
        x01 = x00;
        end_of_dim2 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[2]);
      }

      if (index_of_input_dim3 == (input_pitches[2] - 1)) {
        // It's the end in dimension 3
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);
    }`:`
    ${p}
    float process(int indices[2]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${s}, ${c});

      ${h}

      int m;
      int index_of_dim0, index_of_dim1;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m;

      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;
      index_of_input_dim0 = index_of_dim0 / scales[0];
      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];
      index_of_input_dim1 = index_of_dim1 / scales[1];
      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];

      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim0 = false;
      if (index_of_input_dim0 == (${t[0].dims[0]} - 1)) {
        // It's the end in dimension 0
        x01 = x00;
        end_of_dim0 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[0]);
      }

      if (index_of_input_dim1 == (input_pitches[0] - 1)) {
        // It's the end in dimension 1
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);
    }`;return ve(L({},lN),{output:{dims:a,type:t[0].type,textureType:0},shaderSource:m,variables:[{name:"scales",type:"int",arrayLength:i.scales.length,data:i.scales.map(f=>Math.ceil(f))}]})},QN=(e,t)=>{if(!e||t.opset<9&&e.length!==1||t.opset>=9&&t.opset<11&&e.length!==2||t.opset>=11&&e.length<2)throw new Error("invalid inputs.");if(t.scales.length>0&&e[0].dims.length!==t.scales.length)throw new Error("Invalid input shape.");if(e[0].type==="string")throw new Error("Invalid input tensor types.")},NE=(e,t,i)=>{if(i){for(let r of e)if(r<=0)throw new Error("Scale value should be greater than 0.")}else for(let r of e)if(r<1)throw new Error("Scale value should be greater than or equal to 1.");if((t==="linear"||t==="cubic")&&e.length!==2&&(e.length!==4||e[0]!==1||e[1]!==1))throw new Error(`'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ${i?"Resize":"Upsample"} opeartor.`)}}),wE,JN,PZ,NZ,gq,vq,_q,bq,oSe=Ce(()=>{"use strict";un(),qi(),ld(),Cg(),kZ(),wE={name:"Resize",inputNames:["A"],inputTypes:[2]},JN=(e,t,i)=>(QN(t,i),[e.run(ve(L({},wE),{cacheHint:i.cacheKey,get:()=>gq(e,t,i)}),t)]),PZ=e=>eb(e,10),NZ=e=>eb(e,11),gq=(e,t,i)=>{let r=$i(e.session.backend.glContext.version),[n,o]=vq(t,i);if(n.every(_=>_===1)&&i.coordinateTransformMode!=="tf_crop_and_resize")return ve(L({},wE),{output:{dims:o,type:t[0].type,textureType:2},hasMain:!0,shaderSource:`void main() {
                    vec4 v = ${r.texture2D}(X, TexCoords);
                    ${r.output} = v;
                }`});let a=o.length;if(a<2)throw new Error(`output dimension should be at least 2, but got ${a}`);let s=o[a-2],c=o[a-1],l=t[0].dims;if(a!==l.length)throw new Error(`output dimension should match input ${l.length}, but got ${a}`);let d=l[a-2],u=l[a-1],h=n[a-2],p=n[a-1],m="";if(i.mode!=="linear")throw new Error(`resize (packed) does not support mode: '${i.mode}'`);switch(i.coordinateTransformMode){case"asymmetric":m=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return vec4(coords) / scaleWHWH;
                    }
                `;break;case"half_pixel":m=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;
                    }
                `;break;case"pytorch_half_pixel":m=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 fcoords = vec4(coords);
                        return vec4(
                            ${c}.0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,
                            ${s}.0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,
                            ${c}.0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,
                            ${s}.0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0
                          );
                    }
                `;break;case"align_corners":m=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 resized = vec4(${c}.0 - 1.0, ${s}.0 - 1.0, ${c}.0 - 1.0,
                            ${s}.0 - 1.0);
                        vec4 original = vec4(${u}.0 - 1.0, ${d}.0 - 1.0, ${u}.0 - 1.0,
                            ${d}.0 - 1.0);
                        vec4 new_scale = original / resized;
                        return vec4(coords) * new_scale;
                    }
                `;break;default:throw new Error(`resize (packed) does not support coordinateTransformMode:                                 '${i.coordinateTransformMode}'`)}let f=Fu(a),g=sb(),v=`
            const vec2 inputWH = vec2(${d}.0, ${u}.0);
            const vec4 scaleWHWH = vec4(float(${h}), float(${p}), float(${h}), float(${p}));
            ${g}
            ${m}
            float getAValue(int x10, int r, int c, int d) {
                return getChannel(getA(x10, r, c, d), vec2(c, d));
            }
            void main() {
                ${f} rc = getOutputCoords();

                int batch = rc[0];
                int depth = rc[1];

                // retrieve the 4 coordinates that is used in the 4 packed output values.
                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);

                // calculate the source index in fraction
                vec4 sourceFrac = getSourceFracIndex(coords);

                // get the lower and upper bound of the 4 values that will be packed into one texel.
                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));
                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));
                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));
                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));

                bool hasNextRow = rc.w < ${s-1};
                bool hasNextCol = rc.z < ${c-1};

                // pack x00, x01, x10, x11's top-left corner into one vec4 structure
                vec4 topLeft = vec4(
                    getAValue(batch, depth, x00.x, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);

                // pack x00, x01, x10, x11's top-right corner into one vec4 structure
                vec4 topRight = vec4(
                    getAValue(batch, depth, x00.x, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);

                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure
                vec4 bottomLeft = vec4(
                    getAValue(batch, depth, x00.z, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);

                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure
                vec4 bottomRight = vec4(
                    getAValue(batch, depth, x00.z, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);

                // calculate the interpolation fraction on u and v direction
                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);
                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));

                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);
                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);
                vec4 newValue = mix(top, bottom, clampFrac.xxzz);

                ${r.output} = vec4(newValue);
            }
        `;return ve(L({},wE),{output:{dims:o,type:t[0].type,textureType:2},hasMain:!0,shaderSource:v})},vq=(e,t)=>{let i=e[0].dims,r=t.scales,n;if(r.length===0){let a=e[t.scalesInputIdx];if(a&&a.size!==0){if(e[t.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");r=_q(a,t.mode,t.isResize)}else{let s=e[t.sizesInputIdx];if(!s||s.size===0)throw new Error("Either scales or sizes MUST be provided as input.");n=Array.from(s.integerData),r=bq(n,i,t.mode,t.isResize)}}else if(e[t.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");let o=n||i.map((a,s)=>Math.floor(a*r[s]));return[r,o]},_q=(e,t,i)=>{let r=Array.from(e.floatData);return NE(r,t,i),r},bq=(e,t,i,r)=>{let n=t.length,o=new Array(n);for(let a=0,s=n;a<s;a++)if(t[a]===0){if(e[a]!==0)throw new Error("Input dim is zero but required output dim is non-zero.");o[a]=1}else o[a]=e[a]/t[a];return NE(o,i,r),o}}),OZ,yq,aSe=Ce(()=>{"use strict";Eg(),OZ=(e,t)=>(yq(t),[new bs([t[0].dims.length],"int32",void 0,void 0,new Int32Array(t[0].dims))]),yq=e=>{if(!e||e.length!==1)throw new Error("Shape requires 1 input.")}}),EE,RZ,FZ,cN,xq,LZ,wq,Eq,sSe=Ce(()=>{"use strict";yo(),zE(),ur(),qi(),EE={name:"Slice",inputNames:["A"],inputTypes:[0]},RZ=(e,t,i)=>(xq(t),[e.run(ve(L({},EE),{cacheHint:i.cacheKey,get:()=>cN(e,t[0],i)}),t)]),FZ=e=>{let t=e.attributes.getInts("starts"),i=e.attributes.getInts("ends"),r=e.attributes.getInts("axes",[]);return Gr({starts:t,ends:i,axes:r})},cN=(e,t,i)=>{let r=i.axes.length===0?t.dims.slice(0).map((d,u)=>u):i.axes,n=mi.normalizeAxes(r,t.dims.length),o=i.starts.map((d,u)=>d>t.dims[n[u]]-1?t.dims[n[u]]:mi.normalizeAxis(d,t.dims[n[u]])),a=i.ends.map((d,u)=>d>t.dims[n[u]]-1?t.dims[n[u]]:mi.normalizeAxis(d,t.dims[n[u]])),s=t.dims.slice(),c=[];for(let d=0;d<n.length;d++)s[n[d]]=a[d]-o[d],o[d]>0&&c.push(`outputIdx[${n[d]}] += ${o[d]};`);let l=`
      float process(int outputIdx[${s.length}]) {
        ${c.join(`
      `)}
        return _A(outputIdx);
      }`;return ve(L({},EE),{output:{dims:s,type:t.type,textureType:0},shaderSource:l})},xq=e=>{if(!e||e.length!==1)throw new Error("Slice requires 1 input.");if(cb.indexOf(e[0].type)===-1)throw new Error("Invalid input type.")},LZ=(e,t)=>{Eq(t);let i=wq(e,t);return[e.run(ve(L({},EE),{cacheHint:i.cacheKey,get:()=>cN(e,t[0],i)}),[t[0]])]},wq=(e,t)=>{if(!e.session.isInitializer(t[1].dataId)||!e.session.isInitializer(t[2].dataId)||t.length>=4&&!e.session.isInitializer(t[3].dataId)||t.length>=5&&!e.session.isInitializer(t[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(t.length>=5&&t[4].integerData.some(a=>a!==1))throw new Error("currently non-1 steps is not supported for Slice");let i=Array.from(t[1].integerData),r=Array.from(t[2].integerData),n=t.length>=4?Array.from(t[3].integerData):[],o=`${n};${i};${r}`;return{starts:i,ends:r,axes:n,cacheKey:o}},Eq=e=>{if(!e||e.length<3||e.length>5)throw new Error("Invalid input number.");if(e[1].type!=="int32"||e[1].dims.length!==1)throw new Error("Invalid input type.");if(e[2].type!=="int32"||e[2].dims.length!==1)throw new Error("Invalid input type.");if(e.length>=4&&(e[3].type!=="int32"||e[3].dims.length!==1))throw new Error("Invalid input type.");if(e.length>=5&&(e[4].type!=="int32"||e[4].dims.length!==1))throw new Error("Invalid input type.")}}),dN,uN,hN,BZ,VZ,zZ,UZ,pN,Cq,Sq,Tq,fN,lSe=Ce(()=>{"use strict";yo(),ur(),un(),qi(),yO(),dN={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[0]},uN={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[0,0]},hN={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[0,0,0]},BZ=(e,t,i)=>{fN(t);let r=t[0].dims.slice(),n=mi.normalizeAxis(i.axis,r.length),o=mi.sizeToDimension(r,n),a=mi.sizeFromDimension(r,n);return pN(e,t,i,o,a)},VZ=e=>Gr({axis:e.attributes.getInt("axis",1)}),zZ=e=>Gr({axis:e.attributes.getInt("axis",-1)}),UZ=(e,t,i)=>{fN(t);let r=t[0].dims.slice(),n=mi.normalizeAxis(i.axis,r.length),o=r.length,a=n!==o-1,s=[],c=[],l=[],d;a&&(c=Array.from({length:o}).map((m,f)=>f),c[n]=o-1,c[o-1]=n,c.map(m=>s.push(r[m])),d=Gr({perm:c}),l=nb(e,t,d));let u=a?mi.sizeToDimension(s,o-1):mi.sizeToDimension(r,o-1),h=a?mi.sizeFromDimension(s,o-1):mi.sizeFromDimension(r,o-1),p=pN(e,a?l:t,i,u,h);return a?nb(e,p,d):p},pN=(e,t,i,r,n)=>{let o=Cq(e,t[0],r,n,[r]),a=e.run(ve(L({},dN),{cacheHint:i.cacheKey,get:()=>o}),t),s=Sq(e,t[0],r,n,o.output.dims,[r]),c=e.run(ve(L({},uN),{cacheHint:i.cacheKey,get:()=>s}),[t[0],a]),l=Tq(e,t[0],r,n,o.output.dims,s.output.dims);return[e.run(ve(L({},hN),{cacheHint:i.cacheKey,get:()=>l}),[t[0],a,c])]},Cq=(e,t,i,r,n)=>{let[o,a]=e.calculateTextureWidthAndHeight(t.dims,0),s=n.length;if(i<1||r<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(n.length!==1)throw new Error("Dimensionality of the output should be 1");if(n[0]!==i)throw new Error("Shape of the output should be equal to logical row count");let c=$i(e.session.backend.glContext.version),l=`
      float process(int[${s}] indices) {
        int logical_row_start_offset = indices[0] * ${r};

        float max = getColorAsFloat(${c.texture2D}(A, offsetToCoords(logical_row_start_offset, ${o},
        ${a} )));
        for(int i=1; i<${r}; ++i)
        {
          float current = getColorAsFloat(${c.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${o}, ${a})));
          if(current > max)
          max = current;
        }

        return max;
      }`;return ve(L({},dN),{output:{dims:n,type:t.type,textureType:0},shaderSource:l})},Sq=(e,t,i,r,n,o)=>{let[a,s]=e.calculateTextureWidthAndHeight(t.dims,0),c=o.length;if(i<1||r<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(o.length!==1)throw new Error("Dimensionality of the output should be 1");if(o[0]!==i)throw new Error("Shape of the output should be equal to logical row count");if(n.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(n[0]!==i)throw new Error("Shape of the intermediate results should be equal to logical row count");let l=$i(e.session.backend.glContext.version),d=`
      float process(int[${c}] indices) {
        int logical_row_start_offset = indices[0] * ${r};

        float norm_factor = 0.0;
        float max = _Max(indices);
        for(int i=0; i<${r}; ++i)
        {
          norm_factor += exp(getColorAsFloat(${l.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${a}, ${s}))) - max);
        }

        return norm_factor;
      }`;return ve(L({},uN),{output:{dims:o,type:t.type,textureType:0},shaderSource:d})},Tq=(e,t,i,r,n,o)=>{let[a,s]=e.calculateTextureWidthAndHeight(t.dims,0),c=t.dims.length;if(i<1||r<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(n.length!==1||o.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(n[0]!==i||o[0]!==i)throw new Error("Shape of the intermediate results should be equal to logical row count");let l=`
      float process(int[${c}] indices) {

      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)
      int offset = coordsToOffset(TexCoords, ${a}, ${s});

      //determine the logical row for this index
      int logical_row_index[1];
      logical_row_index[0] = offset / ${r};

      float norm_factor = _Norm(logical_row_index);

      // avoid possible division by 0
      // if norm_facor is 0, all elements are zero
      // if so, return 0
      if(norm_factor == 0.0)
        return 0.0;

      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;
    }`;return ve(L({},hN),{output:{dims:t.dims,type:t.type,textureType:0},shaderSource:l})},fN=e=>{if(!e||e.length!==1)throw new Error("Softmax requires 1 input.");if(e[0].type!=="float32"&&e[0].type!=="float64")throw new Error("Invalid input type")}}),mN,HZ,jZ,Aq,Dq,Iq,cSe=Ce(()=>{"use strict";yo(),ur(),qi(),mN={name:"Split",inputNames:["A"],inputTypes:[0]},HZ=(e,t,i)=>{Iq(t);let r=mi.normalizeAxis(i.axis,t[0].dims.length),n=Aq(e,t,r,i),o=[];for(let a=0;a<n;++a)o.push(e.run(ve(L({},mN),{cacheHint:`${i.cacheKey};${a}`,get:()=>Dq(e,t[0],i,r,a)}),t));return o},jZ=e=>{let t=e.attributes.getInt("axis",0),i=e.attributes.getInts("split",[]),r=e.outputs.length;return Gr({axis:t,split:i,numOutputs:r})},Aq=(e,t,i,r)=>{let[,n]=LN.splitShape(t[0].dims,i,r.split,r.numOutputs);return n.length},Dq=(e,t,i,r,n)=>{let[o,a]=LN.splitShape(t.dims,r,i.split,i.numOutputs),s=a[n],c=o[n],l=`
      float process(int indices[${c.length}]) {
        indices[${r}] += ${s};
        return _A(indices);
      }
    `;return ve(L({},mN),{cacheHint:`${i.cacheKey}:${n}`,output:{dims:c,type:t.type,textureType:0},shaderSource:l})},Iq=e=>{if(!e||e.length!==1)throw new Error("Split requires one input.");if(e[0].type!=="int8"&&e[0].type!=="uint8"&&e[0].type!=="int16"&&e[0].type!=="uint16"&&e[0].type!=="int32"&&e[0].type!=="uint32"&&e[0].type!=="float32"&&e[0].type!=="float64"&&e[0].type!=="bool")throw new Error("Invalid input type.")}}),eO,GZ,$Z,Mq,kq,dSe=Ce(()=>{"use strict";ur(),eO=(e,t,i)=>{Mq(t);let r=mi.squeezeShape(t[0].dims,i);return[e.reshapeUnpacked(t[0],r)]},GZ=(e,t)=>(kq(t),eO(e,[t[0]],Array.from(t[1].integerData))),$Z=e=>e.attributes.getInts("axes"),Mq=e=>{if(!e||e.length!==1)throw new Error("Squeeze requires 1 input.");if(e[0].type==="string")throw new Error("invalid input tensor types.")},kq=e=>{if(!e||e.length!==2)throw new Error("Squeeze requires 2 inputs.");if(e[1].type!=="int32")throw new Error("Invalid input type.")}}),WZ,Pq,Nq,uSe=Ce(()=>{"use strict";un(),qi(),WZ=(e,t)=>{Nq(t);let i={name:"Sum",inputNames:t.map((r,n)=>`X${n}`),inputTypes:new Array(t.length).fill(0)};return[e.run(ve(L({},i),{get:()=>Pq(e,t,i)}),t)]},Pq=(e,t,i)=>{let r=$i(e.session.backend.glContext.version),n=t[0].dims.slice(),o=`
      void main() {
        vec4 result = ${t.map((a,s)=>`${r.texture2D}(X${s},TexCoords)`).join(" + ")};
        ${r.output} = result;
      }
    `;return ve(L({},i),{output:{dims:n,type:t[0].type,textureType:0},hasMain:!0,shaderSource:o})},Nq=e=>{if(!e||e.length===0)throw new Error("Sum requires inputs.");let t=e[0].dims.length;for(let i=1;i<e.length;i++){if(t!==e[i].dims.length)throw new Error("Input shapes are mismatched.");for(let r=0;r<t;r++)if(e[0].dims[r]!==e[i].dims[r])throw new Error("Input shapes are not matched.")}if(e[0].type!=="float32"&&e[0].type!=="float64")throw new Error("Invalid input type.");for(let i=1;i<e.length;i++)if(e[0].type!==e[i].type)throw new Error("Input types are not matched.")}}),qZ,Oq,Rq,hSe=Ce(()=>{"use strict";zE(),qi(),qZ=(e,t)=>{Rq(t);let i={name:"Tile",inputNames:["A"],inputTypes:[0]};return[e.run(ve(L({},i),{get:()=>Oq(e,t,i)}),t)]},Oq=(e,t,i)=>{let r=t[0].dims.slice(),n=new Array(r.length),o=[];for(let c=0;c<r.length;c++)n[c]=r[c]*t[1].numberData[c],o.push(`inputIdx[${c}] = int(mod(float(outputIdx[${c}]), ${r[c]}.));`);let a=n.length,s=`
      float process(int outputIdx[${a}]) {
        int inputIdx[${a}];
        ${o.join(`
`)}
        return _A(inputIdx);
      }
    `;return ve(L({},i),{output:{dims:n,type:t[0].type,textureType:0},shaderSource:s})},Rq=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 input.");if(e[1].dims.length!==1)throw new Error("The second input shape must 1 dimension.");if(e[1].dims[0]!==e[0].dims.length)throw new Error("Invalid input shape.");if(cb.indexOf(e[0].type)===-1)throw new Error("Invalid input type.");if(e[1].type!=="int32"&&e[1].type!=="int16")throw new Error("Invalid repeat type.")}}),tO,XZ,YZ,Fq,Lq,pSe=Ce(()=>{"use strict";ur(),tO=(e,t,i)=>{Fq(t);let r=mi.unsqueezeShape(t[0].dims,i);return[e.reshapeUnpacked(t[0],r)]},XZ=(e,t)=>(Lq(t),tO(e,[t[0]],Array.from(t[1].integerData))),YZ=e=>e.attributes.getInts("axes"),Fq=e=>{if(!e||e.length!==1)throw new Error("Unsqueeze requires 1 input.");if(e[0].type==="string")throw new Error("invalid input tensor types.")},Lq=e=>{if(!e||e.length!==2)throw new Error("Unsqueeze requires 2 inputs.");if(e[1].type!=="int32")throw new Error("Invalid input type.")}}),ZZ,fSe=Ce(()=>{"use strict";tCe(),mCe(),gCe(),_Ce(),bO(),$Ce(),WCe(),qCe(),XCe(),YCe(),ZCe(),KCe(),eSe(),vO(),tSe(),iSe(),rSe(),nSe(),oSe(),aSe(),sSe(),lSe(),cSe(),dSe(),uSe(),hSe(),yO(),RY(),pSe(),kZ(),ZZ=[["Abs","","6+",hY],["Acos","","7+",pY],["Add","","7+",WX],["And","","7+",qX],["Asin","","7+",fY],["Atan","","7+",mY],["AveragePool","","7+",fZ,mZ],["BatchNormalization","","7+",HX,jX],["Cast","","6+",nY,oY],["Ceil","","6+",_Y],["Clip","","6-10",GN,gY],["Clip","","11+",vY],["Concat","","4+",sY,lY],["Conv","","1+",qN,XN],["ConvTranspose","","1+",XY,YY],["Cos","","7+",bY],["Div","","7+",XX],["Dropout","","7+",$N],["DepthToSpace","","1+",KY,QY],["Equal","","7+",YX],["Elu","","6+",yY,xY],["Exp","","6+",wY],["Flatten","","1+",JY,eZ],["Floor","","6+",EY],["FusedConv","com.microsoft","1+",qN,XN],["Gather","","1+",tZ,iZ],["Gemm","","7-10",YN,rZ],["Gemm","","11+",YN,nZ],["GlobalAveragePool","","1+",gZ,vZ],["GlobalMaxPool","","1+",yZ],["Greater","","7+",ZX],["Identity","","1+",$N],["ImageScaler","","1+",oZ,aZ],["InstanceNormalization","","6+",sZ,lZ],["LeakyRelu","","6+",CY,SY],["Less","","7+",KX],["LRN","","1+",cZ,dZ],["Log","","6+",TY],["MatMul","","1+",zY,UY],["MaxPool","","1+",_Z,bZ],["Mul","","7+",QX],["Neg","","6+",AY],["Not","","1+",DY],["Or","","7+",JX],["Pad","","2-10",ZN,uZ],["Pad","","11+",hZ,pZ],["Pow","","7+",eY],["PRelu","","7+",tY],["ReduceLogSum","","1+",TZ,Ou],["ReduceMax","","1+",EZ,Ou],["ReduceMean","","1+",wZ,Ou],["ReduceMin","","1+",CZ,Ou],["ReduceProd","","1+",SZ,Ou],["ReduceSum","","1-12",xZ,Ou],["ReduceSumSquare","","1+",AZ,Ou],["Relu","","6+",IY],["Reshape","","5+",DZ],["Resize","","10",JN,PZ],["Resize","","11+",JN,NZ],["Shape","","1+",OZ],["Sigmoid","","6+",MY],["Sin","","7+",kY],["Slice","","10+",LZ],["Slice","","1-9",RZ,FZ],["Softmax","","1-12",BZ,VZ],["Softmax","","13+",UZ,zZ],["Split","","2-12",HZ,jZ],["Sqrt","","6+",PY],["Squeeze","","1-12",eO,$Z],["Squeeze","","13+",GZ],["Sub","","7+",iY],["Sum","","6+",WZ],["Tan","","7+",NY],["Tanh","","6+",OY],["Tile","","6+",qZ],["Transpose","","1+",nb,ZY],["Upsample","","7-8",KN,IZ],["Upsample","","9",KN,MZ],["Unsqueeze","","1-12",tO,YZ],["Unsqueeze","","13+",XZ],["Xor","","7+",rY]]});function mSe(e){let t={},i;for(;(i=iO.exec(e))!==null;){let r=i[3].split(",").map(n=>{let o=n.trim().split(" ");return o&&o.length===2?{type:o[0],name:o[1]}:null}).filter(n=>n!==null);t[i[2]]={params:r,body:i[4]}}for(let r in t){let n=KZ.replace("__FUNC__",r),o=new RegExp(n,"gm");for(;(i=o.exec(e))!==null;){let a=i[1],s=i[2],c=i[3].split(","),l=a?`${a} ${s};`:"",d=t[r].body,u="";t[r].params.forEach((p,m)=>{p&&(u+=`${p.type} ${p.name} = ${c[m]};
`)}),d=`${u}
 ${d}`,d=d.replace("return",`${s} = `);let h=`
      ${l}
      {
        ${d}
      }
      `;e=e.replace(i[0],h)}}return e=e.replace(iO,""),e}var iO,KZ,gSe=Ce(()=>{"use strict";iO=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm,KZ="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;"});function X_(e,t){let i=[],r=[],n=t!=null&&Array.isArray(t)&&t.length===0,o=t==null||n?null:vSe(t,e).sort(),a=0;for(let s=0;s<e.length;++s){if(o!=null){if(o[a]===s&&e[s]!==1)throw new Error(`Can't squeeze axis ${s} since its dim '${e[s]}' is not 1`);(o[a]==null||o[a]>s)&&e[s]===1&&(i.push(e[s]),r.push(s)),o[a]<=s&&a++}e[s]!==1&&(i.push(e[s]),r.push(s))}return{newShape:i,keptDims:r}}function vSe(e,t){let i=t.length;return e=e==null?t.map((r,n)=>n):[].concat(e),ME(e.every(r=>r>=-i&&r<i),()=>`All values in axis param must be in range [-${i}, ${i}) but got axis ${e}`),ME(e.every(_Se),()=>`All values in axis param must be integers but got axis ${e}`),e.map(r=>r<0?i+r:r)}function _Se(e){return e%1===0}function bSe(e){if(e.length===0)return 1;let t=e[0];for(let i=1;i<e.length;i++)t*=e[i];return t}function Bq(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}var QZ,JZ=Ce(()=>{"use strict";Al(),ur(),QZ=class{constructor(e){this.maxTextureSize=e}computeTextureWH(e,t){let i=this.computeTexture(e,t);return t&&t.isPacked&&(i[0]/=2,i[1]/=2),t&&t.reverseWH?[i[1],i[0]]:i}computeTexture(e,t){let i=t&&t.isPacked;if(e.length===0)return i?[2,2]:[1,1];let r=this.maxTextureSize;if(t&&t.breakAxis!==void 0){let a=t.breakAxis>=e.length?1:e.slice(t.breakAxis).reduce((c,l)=>c*l),s=t.breakAxis<=0?1:e.slice(0,t.breakAxis).reduce((c,l)=>c*l);if(a>r||s>r)yn.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${e}, breakAxis:${t.breakAxis}`);else return[a,s]}let n=e.slice(0);i&&(r=r*2,n=n.map((a,s)=>s>=n.length-2?n[s]%2===0?n[s]:n[s]+1:n[s]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=X_(n).newShape);let o=bSe(n);return n.length<=1&&o<=r?[1,o]:n.length===2&&n[0]<=r&&n[1]<=r?n:n.length===3&&n[0]*n[1]<=r&&n[2]<=r?[n[0]*n[1],n[2]]:n.length===3&&n[0]<=r&&n[1]*n[2]<=r?[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=r&&n[3]<=r?[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=r&&n[1]*n[2]*n[3]<=r?[n[0],n[1]*n[2]*n[3]]:i?Bq(o/4).map(a=>a*2):Bq(o)}}}),eK,ySe=Ce(()=>{"use strict";ur(),Lu(),un(),JZ(),ld(),eK=class extends Sg{constructor(e){super(e)}getFunctions(){return L(L(L(L(L(L(L({},this.offsetToCoords()),this.coordsToOffset()),this.toVec()),this.valueFrom()),this.getCommonUtilFuncs()),this.getInputsSamplingSnippets()),this.getOutputSamplingSnippet())}getCustomTypes(){return{}}offsetToCoords(){let e="offsetToCoords";return{offsetToCoords:new pt(`
      vec2 ${e}(int offset, int width, int height) {
        int t = offset / width;
        int s = offset - t*width;
        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);
        return coords;
      }
      `)}}coordsToOffset(){let e="coordsToOffset";return{coordsToOffset:new pt(`
      int ${e}(vec2 coords, int width, int height) {
        float s = coords.s * float(width);
        float t = coords.t * float(height);
        int offset = int(t) * width + int(s);
        return offset;
      }
      `)}}getOutputSamplingSnippet(){let e=this.context.outputTextureLayout;return e.isPacked?this.getPackedOutputSamplingSnippet(e):this.getUnpackedOutputSamplingSnippet(e)}getPackedOutputSamplingSnippet(e){let t=e.unpackedShape,i=[e.width,e.height],r={},n="getOutputCoords";switch(t.length){case 0:r[n]=this.getOutputScalarCoords();break;case 1:r[n]=this.getOutputPacked1DCoords(t,i);break;case 2:r[n]=this.getOutputPacked2DCoords(t,i);break;case 3:r[n]=this.getOutputPacked3DCoords(t,i);break;default:r[n]=this.getOutputPackedNDCoords(t,i)}let o=`
      void setOutput(vec4 val) {
        ${$i(this.context.glContext.version).output} = val;
      }
    `,a="floatTextureSetRGBA";return r[a]=new pt(o),r}getUnpackedOutputSamplingSnippet(e){let t=e.unpackedShape,i=[e.width,e.height],r={},n="getOutputCoords";switch(t.length){case 0:r[n]=this.getOutputScalarCoords();break;case 1:r[n]=this.getOutputUnpacked1DCoords(t,i);break;case 2:r[n]=this.getOutputUnpacked2DCoords(t,i);break;case 3:r[n]=this.getOutputUnpacked3DCoords(t,i);break;case 4:r[n]=this.getOutputUnpacked4DCoords(t,i);break;case 5:r[n]=this.getOutputUnpacked5DCoords(t,i);break;case 6:r[n]=this.getOutputUnpacked6DCoords(t,i);break;default:throw new Error(`Unsupported output dimensionality: ${t.length}`)}let o=`
        void setOutput(float val) {
          ${$i(this.context.glContext.version).output} = vec4(val, 0, 0, 0);
        }
    `,a="floatTextureSetR";return r[a]=new pt(o),r}getOutputScalarCoords(){return new pt(`
      int getOutputCoords() {
        return 0;
      }
    `)}getOutputPacked1DCoords(e,t){let i=t,r="";return i[0]===1?(r=`
          int getOutputCoords() {
            return 2 * int(TexCoords.y * ${i[1]}.0);
          }
        `,new pt(r)):i[1]===1?(r=`
          int getOutputCoords() {
            return 2 * int(TexCoords.x * ${i[0]}.0);
          }
        `,new pt(r)):(r=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                 vec2(${i[0]}, ${i[1]}));
          return 2 * (resTexRC.y * ${i[0]} + resTexRC.x);
        }
      `,new pt(r))}getOutputPacked2DCoords(e,t){let i="";if($_.arraysEqual(e,t))return i=`
        ivec2 getOutputCoords() {
          return 2 * ivec2(TexCoords.xy * vec2(${t[0]}, ${t[1]}));
        }
      `,new pt(i);let r=t,n=Math.ceil(e[1]/2);return i=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${r[0]}, ${r[1]}));

          int index = resTexRC.y * ${r[0]} + resTexRC.x;

          // reverse r and c order for packed texture
          int r = imod(index, ${n}) * 2;
          int c = 2 * (index / ${n});

          return ivec2(r, c);
        }
      `,new pt(i)}getOutputPacked3DCoords(e,t){let i=[t[0],t[1]],r=Math.ceil(e[2]/2),n=r*Math.ceil(e[1]/2),o=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${i[0]}, ${i[1]}));
          int index = resTexRC.y * ${i[0]} + resTexRC.x;

          int b = index / ${n};
          index -= b * ${n};

          // reverse r and c order for packed texture
          int r = imod(index, ${r}) * 2;
          int c = 2 * (index / ${r});

          return ivec3(b, r, c);
        }
      `;return new pt(o)}getOutputPackedNDCoords(e,t){let i=[t[0],t[1]],r=Math.ceil(e[e.length-1]/2),n=r*Math.ceil(e[e.length-2]/2),o=n,a="",s="b, r, c";for(let l=2;l<e.length-1;l++)o*=e[e.length-l-1],a=`
      int b${l} = index / ${o};
      index -= b${l} * ${o};
    `+a,s=`b${l}, `+s;let c=`
      ivec${e.length} getOutputCoords() {
        ivec2 resTexRC = ivec2(TexCoords.xy *
                              vec2(${i[0]}, ${i[1]}));
        int index = resTexRC.y * ${i[0]} + resTexRC.x;

        ${a}

        int b = index / ${n};
        index -= b * ${n};

        // reverse r and c order for packed texture
        int r = imod(index, ${r}) * 2;
        int c = 2 * (index / ${r});

        return ivec${e.length}(${s});
      }
    `;return new pt(c)}getOutputUnpacked1DCoords(e,t){let i=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${t[0]}, ${t[1]}));
          return resTexRC.y * ${t[0]} + resTexRC.x;
        }
      `;return new pt(i)}getOutputUnpacked2DCoords(e,t){let i=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${t[0]}, ${t[1]}));
          int index = resTexRC.y * ${t[0]} + resTexRC.x;
          int r = index / ${e[1]};
          int c = index - r * ${e[1]};
          return ivec2(r, c);
        }
      `;return new pt(i)}getOutputUnpacked3DCoords(e,t){let i="",r=e.length,n=null;r<2&&(n=[]),n=new Array(r-1),n[r-2]=e[r-1];for(let s=r-3;s>=0;--s)n[s]=n[s+1]*e[s+1];let o=["r","c","d"],a=n.map((s,c)=>{let l=`int ${o[c]} = index / ${s}`,d=c===n.length-1?`int ${o[c+1]} = index - ${o[c]} * ${s}`:`index -= ${o[c]} * ${s}`;return`${l}; ${d};`}).join("");return i=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${t[0]}, ${t[1]}));
          int index = resTexRC.y * ${t[0]} + resTexRC.x;
          ${a}
          return ivec3(r, c, d);
        }
      `,new pt(i)}getOutputUnpacked4DCoords(e,t){let i="",r=e.length,n=null;r<2&&(n=[]),n=new Array(r-1),n[r-2]=e[r-1];for(let s=r-3;s>=0;--s)n[s]=n[s+1]*e[s+1];let o=["r","c","d","d2"],a=n.map((s,c)=>{let l=`int ${o[c]} = index / ${s}`,d=c===n.length-1?`int ${o[c+1]} = index - ${o[c]} * ${s}`:`index -= ${o[c]} * ${s}`;return`${l}; ${d};`}).join("");return i=`
      ivec4 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${t[0]}, ${t[1]}));
          int index = resTexRC.y * ${t[0]} + resTexRC.x;
          ${a}
          return ivec4(r, c, d, d2);
        }
      `,new pt(i)}getOutputUnpacked5DCoords(e,t){let i="",r=e.length,n=null;r<2&&(n=[]),n=new Array(r-1),n[r-2]=e[r-1];for(let s=r-3;s>=0;--s)n[s]=n[s+1]*e[s+1];let o=["r","c","d","d2","d3"],a=n.map((s,c)=>{let l=`int ${o[c]} = index / ${s}`,d=c===n.length-1?`int ${o[c+1]} = index - ${o[c]} * ${s}`:`index -= ${o[c]} * ${s}`;return`${l}; ${d};`}).join("");return i=`
      ivec5 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${t[0]}, ${t[1]}));
          int index = resTexRC.y * ${t[0]} + resTexRC.x;
          ${a}
          return ivec5(r, c, d, d2, d3);
        }
      `,new pt(i)}getOutputUnpacked6DCoords(e,t){let i="",r=e.length,n=null;r<2&&(n=[]),n=new Array(r-1),n[r-2]=e[r-1];for(let s=r-3;s>=0;--s)n[s]=n[s+1]*e[s+1];let o=["r","c","d","d2","d3","d4"],a=n.map((s,c)=>{let l=`int ${o[c]} = index / ${s}`,d=c===n.length-1?`int ${o[c+1]} = index - ${o[c]} * ${s}`:`index -= ${o[c]} * ${s}`;return`${l}; ${d};`}).join("");return i=`
     ivec6 getOutputCoords() {
         ivec2 resTexRC = ivec2(TexCoords.xy *
                               vec2(${t[0]}, ${t[1]}));
         int index = resTexRC.y * ${t[0]} + resTexRC.x;
         ${a}
         return ivec6(r, c, d, d2, d3, d4);
       }
     `,new pt(i)}getCommonUtilFuncs(){let e={},t="uvFromFlat";e[t]=new pt(`
    vec2 uvFromFlat(int texNumR, int texNumC, int index) {
      int texC = index / texNumR;
      int texR = index - texC * texNumR;
      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to
      //       v.
      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);
    }
    `),t="packedUVfrom1D",e[t]=new pt(`
      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
        int texelIndex = index / 2;
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),t="packedUVfrom2D",e[t]=new pt(`
      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {
        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),t="packedUVfrom3D",e[t]=new pt(`
      vec2 packedUVfrom3D(int texNumR, int texNumC,
          int texelsInBatch, int texelsInLogicalRow, int b,
          int row, int col) {
        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = index / texNumC;
        int texC = index - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),t="sampleTexture";let i=$i(this.context.glContext.version);return e[t]=new pt(`
        float sampleTexture(sampler2D textureSampler, vec2 uv) {
            return ${i.texture2D}(textureSampler, uv).r;
        }`),e}getInputsSamplingSnippets(){let e={},t=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach((i,r)=>{let n=this.context.inputTextureLayouts[r],o=XP(i);n.isPacked?e[o]=this.getPackedSamplerFromInput(o,i,n):e[o]=this.getUnpackedSamplerFromInput(o,i,n);let a=zEe(i);n.unpackedShape.length<=t.unpackedShape.length&&(n.isPacked?e[a]=this.getPackedSamplerAtOutputCoords(a,n,t,i):e[a]=this.getUnpackedSamplerAtOutputCoords(a,n,t,i))}),e}getPackedSamplerAtOutputCoords(e,t,i,r){let n=t.unpackedShape,o=i.unpackedShape,a=XP(r),s=n.length,c=o.length,l=pc.getBroadcastDims(n,o),d=Fu(c),u=c-s,h,p=wg();s===0?h="":c<2&&l.length>=1?h="coords = 0;":h=l.map(y=>`coords.${p[y+u]} = 0;`).join(`
`);let m="";c<2&&s>0?m="coords":m=n.map((y,x)=>`coords.${p[x+u]}`).join(", ");let f="return outputValue;",g=mi.size(n)===1,v=mi.size(o)===1;if(s===1&&!g&&!v)f=`
        return vec4(outputValue.xy, outputValue.xy);
      `;else if(g&&!v)c===1?f=`
          return vec4(outputValue.x, outputValue.x, 0., 0.);
        `:f=`
          return vec4(outputValue.x);
        `;else if(l.length){let y=s-2,x=s-1;l.indexOf(y)>-1&&l.indexOf(x)>-1?f="return vec4(outputValue.x);":l.indexOf(y)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(x)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}let _=`
        int lastDim = coords.${p[c-1]};
        coords.${p[c-1]} = coords.${p[c-2]};
        coords.${p[c-2]} = lastDim;
      `,b=`
      vec4 ${e}() {
        ${d} coords = getOutputCoords();
        ${_}
        ${h}
        vec4 outputValue = ${a}(${m});
        ${f}
      }
    `;return new pt(b,["coordinates.getOutputCoords"])}getUnpackedSamplerAtOutputCoords(e,t,i,r){let n=[i.width,i.height],o=[t.width,t.height],a=t.unpackedShape.length,s=i.unpackedShape.length,c=t.unpackedShape,l=i.unpackedShape,d=XP(r);if(a===s&&$_.arraysEqual(o,n)){let _=`
          float ${e}() {
            return sampleTexture(${r}, TexCoords);
          }
        `;return new pt(_,["coordinates.sampleTexture"])}let u=Fu(s),h=pc.getBroadcastDims(c,l),p=s-a,m,f=wg();a===0?m="":s<2&&h.length>=1?m="coords = 0;":m=h.map(_=>`coords.${f[_+p]} = 0;`).join(`
`);let g="";s<2&&a>0?g="coords":g=t.unpackedShape.map((_,b)=>`coords.${f[b+p]}`).join(", ");let v=`
        float ${e}() {
          ${u} coords = getOutputCoords();
          ${m}
          return ${d}(${g});
        }
      `;return new pt(v,["coordinates.getOutputCoords"])}getPackedSamplerFromInput(e,t,i){switch(i.unpackedShape.length){case 0:return this.getPackedSamplerScalar(e,t);case 1:return this.getPackedSampler1D(e,t,i);case 2:return this.getPackedSampler2D(e,t,i);case 3:return this.getPackedSampler3D(e,t,i);default:return this.getPackedSamplerND(e,t,i)}}getUnpackedSamplerFromInput(e,t,i){let r=i.unpackedShape;switch(r.length){case 0:return this.getUnpackedSamplerScalar(e,t,i);case 1:return this.getUnpackedSampler1D(e,t,i);case 2:return this.getUnpackedSampler2D(e,t,i);case 3:return this.getUnpackedSampler3D(e,t,i);case 4:return this.getUnpackedSampler4D(e,t,i);case 5:return this.getUnpackedSampler5D(e,t,i);case 6:return this.getUnpackedSampler6D(e,t,i);default:throw new Error(`Unsupported dimension ${r.length}-D`)}}getPackedSamplerScalar(e,t){let i=$i(this.context.glContext.version),r=`
          vec4 ${e}() {
            return ${i.texture2D}(${t}, halfCR);
          }
        `;return new pt(r)}getPackedSampler1D(e,t,i){let r=[i.width,i.height],n=[r[1],r[0]],o=$i(this.context.glContext.version),a=`vec4 ${e}(int index) {
      vec2 uv = packedUVfrom1D(
      ${n[0]}, ${n[1]}, index);
      return ${o.texture2D}(${t}, uv);
    }`;return new pt(a,["coordinates.packedUVfrom1D"])}getPackedSampler2D(e,t,i){let r=i.unpackedShape,n=[i.width,i.height],o=$i(this.context.glContext.version),a=n[0],s=n[1];if(n!=null&&$_.arraysEqual(r,n)){let u=`vec4 ${e}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}.0, ${a}.0);
        return ${o.texture2D}(${t}, uv);
      }`;return new pt(u)}let c=n,l=Math.ceil(r[1]/2),d=`vec4 ${e}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c[1]}, ${c[0]}, ${l}, row, col);
      return ${o.texture2D}(${t}, uv);
    }`;return new pt(d,["coordinates.packedUVfrom2D"])}getPackedSampler3D(e,t,i){let r=i.unpackedShape,n=[i.width,i.height],o=[n[0],n[1]],a=$i(this.context.glContext.version);if(r[0]===1){let h=r.slice(1),p=[1,2],m=R_(r,h),f=["b","row","col"],g=JSON.parse(JSON.stringify(i));g.unpackedShape=m;let v=this.getPackedSamplerFromInput(e,t,g),_=`${v.routineBody}
      vec4 ${e}(int b, int row, int col) {
        return ${e}(${F_(f,p)});
      } `;return new pt(_,v.dependencies)}let s=o[0],c=o[1],l=Math.ceil(r[2]/2),d=l*Math.ceil(r[1]/2),u=`vec4 ${e}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${c}, ${s}, ${d}, ${l}, b, row, col);
      return ${a.texture2D}(${t}, uv);}`;return new pt(u,["coordinates.packedUVfrom3D"])}getPackedSamplerND(e,t,i){let r=i.unpackedShape,n=r.length,o=[i.width,i.height],a=$i(this.context.glContext.version),s=[o[0],o[1]],c=s[1],l=s[0],d=Math.ceil(r[n-1]/2),u=d*Math.ceil(r[n-2]/2),h="int b, int row, int col",p=`b * ${u} + (row / 2) * ${d} + (col / 2)`;for(let f=2;f<n-1;f++)h=`int b${f}, `+h,u*=r[n-f-1],p=`b${f} * ${u} + `+p;let m=`vec4 ${e}(${h}) {
      int index = ${p};
      int texR = index / ${l};
      int texC = index - texR * ${l};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${l}, ${c});
      return ${a.texture2D}(${t}, uv);
    }`;return new pt(m)}getUnpackedSamplerScalar(e,t,i){let[r,n]=[i.width,i.height];if(r===1&&n===1){let a=`
          float ${e}() {
            return sampleTexture(${t}, halfCR);
          }
        `;return new pt(a,["coordinates.sampleTexture"])}let o=`
        float ${e}() {
          int offset_${t} = coordsToOffset(TexCoords, ${r}, ${n});
          vec2 uv = uvFromFlat(${r}, ${n}, offset_${t});
          return sampleTexture(${t}, uv);
        }
      `;return new pt(o,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler1D(e,t,i){let r=i.width,n=i.height;if(n===1&&r===1){let a=`
        float ${e}(int index) {
          return sampleTexture(${t}, halfCR);
        }
      `;return new pt(a,["coordinates.sampleTexture"])}if(n===1){let a=`
          float ${e}(int index) {
            vec2 uv = vec2((float(index) + 0.5) / ${r}.0, 0.5);
            return sampleTexture(${t}, uv);
          }
        `;return new pt(a,["coordinates.sampleTexture"])}if(r===1){let a=`
          float ${e}(int index) {
            vec2 uv = vec2(0.5, (float(index) + 0.5) / ${n}.0);
            return sampleTexture(${t}, uv);
          }
        `;return new pt(a,["coordinates.sampleTexture"])}let o=`
        float ${e}(int index) {
          vec2 uv = uvFromFlat(${r}, ${n}, index);
          return sampleTexture(${t}, uv);
        }
      `;return new pt(o,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler2D(e,t,i){let r=i.unpackedShape,n=[i.height,i.width];if(n!=null&&$_.arraysEqual(r,n)){let u=n[1],h=n[0],p=`
          float ${e}(int row, int col) {
            vec2 uv = (vec2(row, col) + halfCR) / vec2(${u}.0, ${h}.0);
            return sampleTexture(${t}, uv);
          }
        `;return new pt(p,["coordinates.sampleTexture"])}let{newShape:o,keptDims:a}=X_(r),s=o;if(s.length<r.length){let u=R_(r,s),h=JSON.parse(JSON.stringify(i));h.unpackedShape=u;let p=["col","row"],m=`
          ${this.getUnpackedSamplerFromInput(e,t,h).routineBody}
          float ${e}(int row, int col) {
            return ${e}(${F_(p,a)});
          }
        `;return new pt(m,["coordinates.sampleTexture"])}let c=n[1],l=n[0];if(l===1){let u=`
          float ${e}(int row, int col) {
            int offset_${t} = coordsToOffset(TexCoords, ${c}, ${l});
            float index = dot(vec3(row, col, offset_${t}), vec3(${r[1]}, 1, 1));
            vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
            return sampleTexture(${t}, uv);
          }
        `;return new pt(u,["coordinates.sampleTexture","coordinates.coordsToOffset"])}if(c===1){let u=`
          float ${e}(int row, int col) {
            int offset_${t} = coordsToOffset(TexCoords, ${c}, ${l});
            float index = dot(vec3(row, col, offset_${t}), vec3(${r[1]}, 1, 1));
            vec2 uv = vec2((index + 0.5) / ${l}.0, 0.5);
            return sampleTexture(${t}, uv);
          }
        `;return new pt(u,["coordinates.sampleTexture","coordinates.coordsToOffset"])}let d=`
        float ${e}(int row, int col) {
          int index = col * ${r[1]} + row;
          vec2 uv = uvFromFlat(${c}, ${l}, index);
          return sampleTexture(${t}, uv);
        }
      `;return new pt(d,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler3D(e,t,i){let r=i.unpackedShape,n=r[1]*r[2],o=r[2],{newShape:a,keptDims:s}=X_(r),c=a;if(c.length<r.length){let h=R_(r,c),p=["batch","col","row"],m=JSON.parse(JSON.stringify(i));m.unpackedShape=h;let f=this.getUnpackedSamplerFromInput(e,t,m),g=s.reverse(),v=`
          ${f.routineBody}
          float ${e}(int batch, int row, int col) {
            return ${e}(${F_(p,g)});
          }
        `;return new pt(v,f.dependencies)}let l=i.width,d=i.height,u=`
          float ${e}(int depth, int row, int col) {
            // Explicitly use integer operations as dot() only works on floats.
            int index = depth * ${n} + col * ${o} + row;
            vec2 uv = uvFromFlat(${l}, ${d}, index);
            return sampleTexture(${t}, uv);
          }
      `;return new pt(u,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler4D(e,t,i){let r=i.unpackedShape,n=r[3],o=r[2]*n,a=r[1]*o,s=i.width,c=i.height,l=`
        float ${e}(int row, int col, int depth, int depth2) {
          int index = row * ${a} + col * ${o} +
              depth2 * ${n} + depth;
          vec2 uv = uvFromFlat(${s}, ${c}, index);
          return sampleTexture(${t}, uv);
        }
      `;return new pt(l,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler5D(e,t,i){let r=i.unpackedShape,n=r[4],o=r[3]*n,a=r[2]*o,s=r[1]*a,{newShape:c,keptDims:l}=X_(r);if(c.length<r.length){let p=R_(r,c),m=["row","col","depth","depth2","depth3"],f=JSON.parse(JSON.stringify(i));f.unpackedShape=p;let g=`
          ${this.getUnpackedSamplerFromInput(e,t,f).routineBody}
          float ${e}(int row, int col, int depth, int depth2, int depth3) {
            return ${e}(${F_(m,l)});
          }
        `;return new pt(g,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let d=i.width,u=i.height,h=`
        float ${e}(int row, int col, int depth, int depth2, int depth3) {
          int index = row * ${s} + col * ${a} + depth * ${o} +
          depth3 * ${n} + depth2;
          vec2 uv = uvFromFlat(${d}, ${u}, index);
          return sampleTexture(${t}, uv);
        }
      `;return new pt(h,["coordinates.sampleTexture","coordinates.uvFromFlat"])}getUnpackedSampler6D(e,t,i){let r=i.unpackedShape,n=r[5],o=r[4]*n,a=r[3]*o,s=r[2]*a,c=r[1]*s,{newShape:l,keptDims:d}=X_(r);if(l.length<r.length){let m=R_(r,l),f=["row","col","depth","depth2","depth3","depth4"],g=JSON.parse(JSON.stringify(i));g.unpackedShape=m;let v=`
            ${this.getUnpackedSamplerFromInput(e,t,g).routineBody}
            float ${e}(int row, int col, int depth,
              int depth2, int depth3, int depth4) {
              return ${e}(${F_(f,d)});
            }
          `;return new pt(v,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let u=i.width,h=i.height,p=`
          float ${e}(int row, int col, int depth,
            int depth2, int depth3, int depth4) {
            int index = row * ${c} + col * ${s} + depth * ${a} +
            depth2 * ${o} + depth3 * ${n} + depth4;
            vec2 uv = uvFromFlat(${u}, ${h}, index);
            return sampleTexture(${t}, uv);
          }
        `;return new pt(p,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}toVec(){let e=this.context.outputTextureLayout,t=e.shape.length,i=e.strides,r=e.width,n=e.height,o=[];for(let s=0;s<t-1;++s)o.push(`
        c[${s}] = offset / ${i[s]};`),o.push(`
        offset -= c[${s}] * ${i[s]};`);o.push(`
        c[${t-1}] = offset;`);let a=`
      void toVec(vec2 texCoords, out int c[${t}]) {
        int offset = coordsToOffset(texCoords, ${r}, ${n});
        ${o.join("")}
      }
      void toVec(int offset, out int c[${t}]) {
        ${o.join("")}
      }
    `;return{toVec:new pt(a,["coordinates.coordsToOffset"])}}valueFrom(){let e={};return this.context.programInfo.inputNames.forEach((t,i)=>{let r=this.context.inputTextureLayouts[i],n=(r.unpackedShape.length>0?r.unpackedShape:r.shape).length,o=`_${t}`;e[o]=new pt(this.getValueFromSingle(t,n,r.width,r.height,!1),[`shapeUtils.indicesToOffset${o}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),o=o+"_T",e[o]=new pt(this.getValueFromSingle(t,n,r.width,r.height,!0),[`shapeUtils.indicesToOffset${o}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])}),e}getValueFromSingle(e,t,i,r,n){let o=`_${e}`;n&&(o=o+"_T");let a=$i(this.context.glContext.version);return`
        float ${o}(int m[${t}]) {
          int offset = indicesToOffset${o}(m);
          vec2 coords = offsetToCoords(offset, ${i}, ${r});
          float value = getColorAsFloat(${a.texture2D}(${e}, coords));
          return value;
        }
        `}getPackedValueFrom(e,t,i,r,n){let o=`_${e}_Pack`;n&&(o=o+"_T");let a=$i(this.context.glContext.version);return`
        vec4 ${o}(int m[${t}]) {
          int offset = indicesToOffset_${e}(m);
          vec2 coords = offsetToCoords(offset, ${i}, ${r});
          return ${a.texture2D}(${e}, coords);
        }
        `}}}),tK,xSe=Ce(()=>{"use strict";Lu(),tK=class rO extends Sg{constructor(t){super(t)}getFunctions(){return L(L({},this.encodeFloat32()),this.decodeFloat32())}getCustomTypes(){return{}}encodeFloat32(){return{encode:new pt(`highp vec4 encode(highp float f) {
        return vec4(f, 0.0, 0.0, 0.0);
      }
        `)}}decodeFloat32(){return{decode:new pt(`highp float decode(highp vec4 rgba) {
        return rgba.r;
      }
        `)}}encodeUint8(){let t=rO.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new pt(`
      highp vec4 encode(highp float f) {
        highp float F = abs(f);
        highp float Sign = step(0.0,-f);
        highp float Exponent = floor(log2(F));
        highp float Mantissa = (exp2(- Exponent) * F);
        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));
        highp vec4 rgba;
        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));
        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);
        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));
        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));
        ${t}
        rgba = rgba / 255.0; // values need to be normalized to [0,1]
        return rgba;
    }
        `)}}decodeUint8(){let t=rO.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new pt(`
        highp float decode(highp vec4 rgba) {
          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]
          ${t}
          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;
          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;
          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);
          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));
          return Result;
      }
        `)}}static isLittleEndian(){let t=new ArrayBuffer(4),i=new Uint32Array(t),r=new Uint8Array(t);if(i[0]=3735928559,r[0]===239)return!0;if(r[0]===222)return!1;throw new Error("unknown endianness")}}}),iK,wSe=Ce(()=>{"use strict";Lu(),un(),iK=class extends Sg{constructor(e){super(e)}getFunctions(){return L(L({},this.setFragColor()),this.getColorAsFloat())}getCustomTypes(){return{}}setFragColor(){let e=$i(this.context.glContext.version);return{setFragColor:new pt(`
        void setFragColor(float value) {
            ${e.output} = encode(value);
        }
        `,["encoding.encode"])}}getColorAsFloat(){return{getColorAsFloat:new pt(`
        float getColorAsFloat(vec4 color) {
            return decode(color);
        }
        `,["encoding.decode"])}}}}),rK,ESe=Ce(()=>{"use strict";Lu(),rK=class Y_ extends Sg{constructor(t){super(t)}getFunctions(){return L(L(L(L(L({},this.bcastIndex()),this.bcastMatmulIndex()),this.offsetToIndices()),this.indicesToOffset()),this.incrementIndices())}getCustomTypes(){return{}}bcastIndex(){let t=this.context.outputTextureLayout.shape.length,i={};return this.context.programInfo.inputNames.forEach((r,n)=>{let o=this.context.inputTextureLayouts[n].unpackedShape;if(o.length<=t){let a=o.length,s=t-a,c=`bcastIndices_${r}`,l="";for(let u=0;u<a;++u)l+=`
          realIndices[${u}] = int( mod(float(bcastedIndices[${s+u}]), ${o[u]}.0) );
          `;let d=`
        void ${c} (int bcastedIndices[${t}], out int realIndices[${a}]) {
          ${l}
        }
        `;i[c]=new pt(d)}}),i}bcastMatmulIndex(){let t=this.context.outputTextureLayout.shape.length,i={};return this.context.programInfo.inputNames.forEach((r,n)=>{let o=this.context.inputTextureLayouts[n].shape;if(!(o.length<2||o.length>t)){let a=o.length,s=t-a,c=`bcastMatmulIndices_${r}`,l="";for(let u=0;u<a-2;++u)l+=`
          realIndices[${u}] = int( mod(float(bcastedIndices[${s+u}]), ${o[u]}.0) );
          `;let d=`
        void ${c}(int bcastedIndices[${t}], out int realIndices[${a}]) {
          ${l}
          realIndices[${a-1}] = bcastedIndices[${t-1}];
          realIndices[${a-2}] = bcastedIndices[${t-2}];
        }
        `;i[c]=new pt(d)}}),i}indicesToOffset(){let t={};return this.context.programInfo.inputNames.forEach((i,r)=>{let n=this.context.inputTextureLayouts[r].shape,o=this.context.inputTextureLayouts[r].strides,a=n.length,s=`indicesToOffset_${i}`;t[s]=new pt(Y_.indexToOffsetSingle(s,a,o)),s=`indicesToOffset_${i}_T`,t[s]=new pt(Y_.indexToOffsetSingle(s,a,o.slice().reverse()))}),t}static indexToOffsetSingle(t,i,r){let n="";for(let o=i-1;o>=0;--o)n+=`
        offset += indices[${o}] * ${r[o]};
        `;return`
      int ${t}(int indices[${i}]) {
        int offset = 0;
        ${n}
        return offset;
      }
      `}offsetToIndices(){let t={};return this.context.programInfo.inputNames.forEach((i,r)=>{let n=this.context.inputTextureLayouts[r].shape,o=this.context.inputTextureLayouts[r].strides,a=n.length,s=`offsetToIndices_${i}`;t[s]=new pt(Y_.offsetToIndicesSingle(s,a,o)),s=`offsetToIndices_${i}_T`,t[s]=new pt(Y_.offsetToIndicesSingle(s,a,o.slice().reverse()))}),t}static offsetToIndicesSingle(t,i,r){let n=[];for(let o=0;o<i-1;++o)n.push(`
      indices[${o}] = offset / ${r[o]};`),n.push(`
        offset -= indices[${o}] * ${r[o]};`);return n.push(`
      indices[${i-1}] = offset;`),`
      void ${t}(int offset, out int indices[${i}]) {
        ${n.join("")}
      }
      `}incrementIndices(){let t={};return this.context.programInfo.inputNames.forEach((i,r)=>{let n=this.context.inputTextureLayouts[r].shape,o=n.length,a=`incrementIndices_${i}`,s="";for(let l=0;l<o;++l)s+=`
        shape[${l}] = ${n[l]};`;let c=`
        void ${a}(int axis, out int indices[${o}]) {
          int shape[${o}];
          ${s};
          for(int i = ${o} -1 ; i >= 0; --i) {
            if(i > axis) continue;
            indices[i] += 1;
            if(indices[i] < shape[i]) {
              break;
            }
            indices[i] = 0;
          }
        }
        `;t[a]=new pt(c)}),t}}}),nK,CSe=Ce(()=>{"use strict";Lu(),nK=class extends Sg{constructor(e){super(e)}getCustomTypes(){return{}}getFunctions(){return L(L(L(L({},this.binaryVecFunctions()),this.copyVec()),this.setVecItem()),this.getVecItem())}binaryVecFunctions(){let e=this.context.outputTextureLayout.shape.length,t={add:"+=",sub:"-=",mul:"*=",div:"/="},i={};for(let r in t){let n=`${r}Vec`,o="";for(let s=0;s<e;++s)o+=`
          dest[${s}] ${t[r]} src[${s}];
          `;let a=`
        void ${n}(int src[${e}], out int dest[${e}]) {
          ${o}
        }
        `;i[n]=new pt(a)}return i}copyVec(){let e=this.context.outputTextureLayout.shape.length,t="";for(let r=0;r<e;++r)t+=`
        dest[${r}] = src[${r}];
        `;let i=`
      void copyVec(int src[${e}], out int dest[${e}]) {
        ${t}
      }
      `;return{copyVec:new pt(i)}}setVecItem(){let e=this.context.outputTextureLayout.shape.length,t=`
        if(index < 0)
            index =${e} + index;
        if (index == 0)
            m[0] = value;
        `;for(let r=1;r<e-1;++r)t+=`
        else if (index == ${r})
            m[${r}] = value;
            `;t+=`
        else
            m[${e-1}] = value;
        `;let i=`
      void setVecItem(out int m[${e}], int index, int value) {
        ${t}
      }
        `;return{setVecItem:new pt(i)}}getVecItem(){let e=this.context.outputTextureLayout.shape.length,t=`
        if(index < 0)
            index = ${e} + index;
        if (index == 0)
            return m[0];
      `;for(let r=1;r<e-1;++r)t+=`
        else if (index == ${r})
            return m[${r}];
      `;t+=`
        else
            return m[${e-1}];
        `;let i=`
      int getVecItem(int m[${e}], int index) {
        ${t}
      }
    `;return{getVecItem:new pt(i)}}}}),nO,SSe=Ce(()=>{"use strict";ySe(),xSe(),wSe(),ESe(),CSe(),nO={encoding:tK,fragcolor:iK,vec:nK,shapeUtils:rK,coordinates:eK}}),oK,TSe=Ce(()=>{"use strict";Lu(),gSe(),SSe(),un(),oK=class{constructor(e,t,i,r){this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new GX(e,t,i,r),Object.keys(nO).forEach(o=>{let a=new nO[o](this.context);this.libs[o]=a});let n=this.glslLibRoutineDependencyGraph;for(let o in this.libs){let a=this.libs[o].getFunctions();for(let s in a){let c=o+"."+s,l;n[c]?(l=n[c],l.routineBody=a[s].routineBody):(l=new jN(c,a[s].routineBody),n[c]=l);let d=a[s].dependencies;if(d)for(let u=0;u<d.length;++u)if(n[d[u]])l.addDependency(n[d[u]]);else{let h=new jN(d[u]);n[d[u]]=h,l.addDependency(h)}}}}preprocess(){let e=this.context.programInfo,t=e.shaderSource;return this.context.programInfo.hasMain||(t=`${t}
      ${VEe(this.context.glContext.version,this.context.outputTextureLayout.shape.length)}`),t=mSe(t),`${BEe(this.context.glContext.version)}
    ${this.getUniforms(e.inputNames,e.variables)}
    ${this.getImports(t)}
    ${t}`}getImports(e){let t=this.selectGlslLibRoutinesToBeIncluded(e);if(t.length===0)return"";let i="";for(let r=0;r<t.length;++r)if(t[r].routineBody)i+=t[r].routineBody+`
`;else throw new Error(`Missing body for the Glsl Library routine: ${t[r].name}`);return i}selectGlslLibRoutinesToBeIncluded(e){let t=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach(i=>{let r=i.split(".")[1];e.indexOf(r)!==-1&&t.push(this.glslLibRoutineDependencyGraph[i])}),$X.returnOrderedNodes(t)}getUniforms(e,t){let i=[];if(e)for(let r of e)i.push(`uniform sampler2D ${r};`);if(t)for(let r of t)i.push(`uniform ${r.type} ${r.name}${r.arrayLength?`[${r.arrayLength}]`:""};`);return i.join(`
`)}}}),aK,ASe=Ce(()=>{"use strict";fc(),Al(),TSe(),un(),aK=class{constructor(e,t,i){this.profiler=e,this.glContext=t,this.textureLayoutStrategy=i,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,t){this.repo.set(e,t)}run(e,t,i){this.profiler.event("op",`ProgramManager.run ${e.programInfo.name??"unknown kernel"}`,()=>{let r=this.glContext.gl,n=e.program;r.useProgram(n);try{this.bindOutput(i),this.attributesBound||this.bindAttributes(e.attribLocations),this.bindUniforms(e.uniformLocations,e.programInfo.variables??[],t)}catch(o){throw yn.error("ProgramManager",e.programInfo.shaderSource),o}this.profiler.event("backend","GlContext.draw()",()=>{this.glContext.draw()})},this.glContext)}dispose(){this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach(e=>this.glContext.deleteProgram(e.program))}build(e,t,i){return this.profiler.event("backend","ProgramManager.build",()=>{let r=new oK(this.glContext,e,t,i),n=r.preprocess(),o=this.compile(n);return{programInfo:e,program:o,uniformLocations:this.getUniformLocations(o,r.context.programInfo.inputNames,r.context.programInfo.variables),attribLocations:this.getAttribLocations(o)}})}compile(e){if(!this.vertexShader){yn.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");let r=LEe(this.glContext.version);this.vertexShader=this.glContext.compileShader(r,this.glContext.gl.VERTEX_SHADER)}Ii.debug&&yn.verbose("ProrgramManager",`FragShader:
${e}
`);let t=this.glContext.compileShader(e,this.glContext.gl.FRAGMENT_SHADER),i=this.glContext.createProgram(this.vertexShader,t);return this.glContext.deleteShader(t),i}bindOutput(e){let t=e.width,i=e.height;yn.verbose("ProrgramManager",`Binding output texture to Framebuffer: w/h=${t}/${i}, shape=${e.shape}, type=${e.tensor.type}`),this.glContext.attachFramebuffer(e.texture,t,i)}bindAttributes(e){let t=e.position,i=e.textureCoord;this.glContext.setVertexAttributes(t,i),this.attributesBound=!0}bindUniforms(e,t,i){let r=this.glContext.gl,n=0;for(let{name:o,type:a,location:s,arrayLength:c}of e){let l=t.find(d=>d.name===o)?.data;if(a!=="sampler2D"&&!l)throw new Error(`variable '${o}' does not have data defined in program info`);switch(a){case"sampler2D":this.bindTexture(i[n],s,n),n++;break;case"float":c?r.uniform1fv(s,l):r.uniform1f(s,l);break;case"int":c?r.uniform1iv(s,l):r.uniform1i(s,l);break;default:throw new Error(`Uniform not implemented: ${a}`)}}}bindTexture(e,t,i){this.glContext.bindTextureToUniform(e.texture,i,t)}getAttribLocations(e){return{position:this.getAttribLocation(e,"position"),textureCoord:this.getAttribLocation(e,"textureCoord")}}getUniformLocations(e,t,i){let r=[];if(t)for(let n of t)r.push({name:n,type:"sampler2D",location:this.getUniformLocation(e,n)});if(i)for(let n of i)r.push(ve(L({},n),{location:this.getUniformLocation(e,n.name)}));return r}getUniformLocation(e,t){let i=this.glContext.gl.getUniformLocation(e,t);if(i===null)throw new Error(`Uniform ${t} not found.`);return i}getAttribLocation(e,t){return this.glContext.gl.getAttribLocation(e,t)}}}),sK,DSe=Ce(()=>{"use strict";Al(),PE(),sK=class{constructor(e,t,i,r){this.glContext=e,this.layoutStrategy=t,this.profiler=i,this.config=r,this.pendingRead=new Map,r.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}createTextureFromLayout(e,t,i,r){let n=this.toEncoderType(e),o=this.glContext.getEncoder(n,t.channels||1,r);if(t.isPacked&&r===1)throw new Error("not implemented");let a=t.width,s=t.height,c,l;if(this.config.reuseTextures){c=`${a}x${s}_${o.format}_${o.internalFormat}_${o.textureType}`,l=this.inUseTextures.get(c),l||(l=[],this.inUseTextures.set(c,l));let u=this.idleTextures.get(c);if(u&&u.length>0){let h=u.pop();return l.push(h),r===1&&this.glContext.updateTexture(h,a,s,o,this.toTextureData(e,i)),h}}yn.verbose("TextureManager",`Creating new texture of size ${t.width}x${t.height}`);let d=this.glContext.allocateTexture(a,s,o,this.toTextureData(e,i));return this.config.reuseTextures&&(l.push(d),this.textureLookup.set(d,c)),d}readTexture(e,t,i){return i||(i=1),this.profiler.event("backend","TextureManager.readTexture",()=>{let r=e.shape.reduce((o,a)=>o*a)*i,n=this.glContext.readTexture(e.texture,e.width,e.height,r,this.toEncoderType(t),i);return this.toTensorData(t,n)})}readTextureAsync(e,t,i){return Qe(this,null,function*(){let r=e.tensor.dataId;if(i||(i=1),this.pendingRead.has(r)){let n=this.pendingRead.get(r);return new Promise(o=>n?.push(o))}return this.profiler.event("backend","TextureManager.readTextureAsync",()=>Qe(this,null,function*(){this.pendingRead.set(r,[]);let n=e.shape.reduce((c,l)=>c*l)*i;yield this.glContext.createAndWaitForFence();let o=this.glContext.readTexture(e.texture,e.width,e.height,n,this.toEncoderType(t),i),a=this.toTensorData(t,o),s=this.pendingRead.get(r);return this.pendingRead.delete(r),s?.forEach(c=>c(a)),a}))})}readUint8TextureAsFloat(e){return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",()=>{let t=e.shape.reduce((r,n)=>r*n),i=this.glContext.readTexture(e.texture,e.width,e.height,t*4,"byte",4);return new Float32Array(i.buffer,i.byteOffset,t)})}releaseTexture(e,t){let i;if(this.config.reuseTextures&&(i=this.textureLookup.get(e.texture),i)){t&&this.textureLookup.delete(i);let r=this.inUseTextures.get(i);if(r){let n=r.indexOf(e.texture);if(n!==-1){r.splice(n,1);let o=this.idleTextures.get(i);o||(o=[],this.idleTextures.set(i,o)),o.push(e.texture)}}}(!i||t)&&(yn.verbose("TextureManager",`Deleting texture of size ${e.width}x${e.height}`),this.glContext.deleteTexture(e.texture))}toTensorData(e,t){switch(e){case"int16":return t instanceof Int16Array?t:Int16Array.from(t);case"int32":return t instanceof Int32Array?t:Int32Array.from(t);case"int8":return t instanceof Int8Array?t:Int8Array.from(t);case"uint16":return t instanceof Uint16Array?t:Uint16Array.from(t);case"uint32":return t instanceof Uint32Array?t:Uint32Array.from(t);case"uint8":case"bool":return t instanceof Uint8Array?t:Uint8Array.from(t);case"float32":return t instanceof Float32Array?t:Float32Array.from(t);case"float64":return t instanceof Float64Array?t:Float64Array.from(t);default:throw new Error(`TensorData type ${e} is not supported`)}}toTextureData(e,t){if(t)return t instanceof Float32Array?t:new Float32Array(t)}toEncoderType(e){return"float"}clearActiveTextures(){this.glContext.clearActiveTextures()}}}),lK,ISe=Ce(()=>{"use strict";Al(),_Ee(),eCe(),fSe(),ASe(),JZ(),DSe(),lK=class{constructor(e,t){this.backend=e,this.context=t,this.layoutStrategy=new QZ(e.glContext.maxTextureSize),this.programManager=new aK(this.context.profiler,e.glContext,this.layoutStrategy),this.textureManager=new sK(e.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:e.textureCacheMode==="full"}),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map,this.pack=e.pack,this.pack2unpackMap=new Map,this.unpack2packMap=new Map}createInferenceHandler(){return new UX(this)}onGraphInitialized(e){let t=e.getValues().filter(i=>i.from===-1&&i.tensor).map(i=>i.tensor.dataId);this.initializers=new Set(t)}isInitializer(e){return this.initializers?this.initializers.has(e):!1}addInitializer(e){this.initializers.add(e)}getTextureData(e,t){return t?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}setTextureData(e,t,i=!1){yn.verbose("WebGLSessionHandler","Storing Texture data in cache"),i?this.packedTextureDataCache.set(e,t):this.unpackedTextureDataCache.set(e,t)}dispose(){this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(e=>this.textureManager.releaseTexture(e,!0)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(e=>this.textureManager.releaseTexture(e,!0)),this.unpackedTextureDataCache=new Map}resolve(e,t,i){let r=gEe(e,t,ZZ);return{impl:r.opImpl,context:r.opInit?r.opInit(e,i):e}}}});function MSe(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}var oO,kSe=Ce(()=>{"use strict";fc(),PE(),PE(),ld(),oO=class{constructor(e,t){this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=e,this.version=t,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}allocateTexture(e,t,i,r){let n=this.gl,o=n.createTexture();n.bindTexture(n.TEXTURE_2D,o),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);let a=r?i.encode(r,e*t):null;return n.texImage2D(n.TEXTURE_2D,0,i.internalFormat,e,t,0,i.format,i.textureType,a),this.checkError(),o}updateTexture(e,t,i,r,n){let o=this.gl;o.bindTexture(o.TEXTURE_2D,e);let a=r.encode(n,t*i);o.texSubImage2D(o.TEXTURE_2D,0,0,0,t,i,r.format,r.textureType,a),this.checkError()}attachFramebuffer(e,t,i){let r=this.gl;r.bindTexture(r.TEXTURE_2D,e),r.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),this.checkError(),r.viewport(0,0,t,i),r.scissor(0,0,t,i)}readTexture(e,t,i,r,n,o){let a=this.gl;o||(o=1),this.frameBufferBound||this.attachFramebuffer(e,t,i);let s=this.getEncoder(n,o),c=s.allocate(t*i);return a.bindTexture(a.TEXTURE_2D,e),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),a.readPixels(0,0,t,i,a.RGBA,s.textureType,c),this.checkError(),s.decode(c,r)}isFramebufferReady(){return!0}getActiveTexture(){let e=this.gl;return`TEXTURE${e.getParameter(this.gl.ACTIVE_TEXTURE)-e.TEXTURE0}`}getTextureBinding(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)}getFramebufferBinding(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)}setVertexAttributes(e,t){let i=this.gl;i.vertexAttribPointer(e,3,i.FLOAT,!1,20,0),i.enableVertexAttribArray(e),t!==-1&&(i.vertexAttribPointer(t,2,i.FLOAT,!1,20,12),i.enableVertexAttribArray(t)),this.checkError()}createProgram(e,t){let i=this.gl,r=i.createProgram();return i.attachShader(r,e),i.attachShader(r,t),i.linkProgram(r),r}compileShader(e,t){let i=this.gl,r=i.createShader(t);if(!r)throw new Error(`createShader() returned null with type ${t}`);if(i.shaderSource(r,e),i.compileShader(r),i.getShaderParameter(r,i.COMPILE_STATUS)===!1)throw new Error(`Failed to compile shader: ${i.getShaderInfoLog(r)}
Shader source:
${e}`);return r}deleteShader(e){this.gl.deleteShader(e)}bindTextureToUniform(e,t,i){let r=this.gl;r.activeTexture(r.TEXTURE0+t),this.checkError(),r.bindTexture(r.TEXTURE_2D,e),this.checkError(),r.uniform1i(i,t),this.checkError()}draw(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()}checkError(){if(Ii.debug){let e=this.gl,t=e.getError(),i="";switch(t){case e.NO_ERROR:return;case e.INVALID_ENUM:i="INVALID_ENUM";break;case e.INVALID_VALUE:i="INVALID_VALUE";break;case e.INVALID_OPERATION:i="INVALID_OPERATION";break;case e.INVALID_FRAMEBUFFER_OPERATION:i="INVALID_FRAMEBUFFER_OPERATION";break;case e.OUT_OF_MEMORY:i="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:i="CONTEXT_LOST_WEBGL";break;default:i=`Unknown WebGL Error: ${t.toString(16)}`}throw new Error(i)}}deleteTexture(e){this.gl.deleteTexture(e)}deleteProgram(e){this.gl.deleteProgram(e)}getEncoder(e,t,i=0){if(this.version===2)return new BX(this.gl,t);switch(e){case"float":return i===1||this.isRenderFloat32Supported?new UN(this.gl,t):new UN(this.gl,t,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new VX(this.gl,t);default:throw new Error(`Invalid dataType: ${e}`)}}clearActiveTextures(){let e=this.gl;for(let t=0;t<this.maxTextureImageUnits;++t)e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,null)}dispose(){if(this.disposed)return;let e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(this.framebuffer),e.bindBuffer(e.ARRAY_BUFFER,null),e.deleteBuffer(this.vertexbuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.finish(),this.disposed=!0}createDefaultGeometry(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])}createVertexbuffer(){let e=this.gl,t=e.createBuffer();if(!t)throw new Error("createBuffer() returned null");let i=this.createDefaultGeometry();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW),this.checkError(),t}createFramebuffer(){let e=this.gl.createFramebuffer();if(!e)throw new Error("createFramebuffer returned null");return e}queryVitalParameters(){let e=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),this.version===1&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.version}getExtensions(){this.version===2?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))}checkFloatTextureAttachableToFrameBuffer(){let e=this.gl,t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);let i=this.version===2?e.RGBA32F:e.RGBA;e.texImage2D(e.TEXTURE_2D,0,i,1,1,0,e.RGBA,e.FLOAT,null);let r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0);let n=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(t),e.deleteFramebuffer(r),n}checkRenderFloat32(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Download(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension||!this.gl.getExtension("WEBGL_color_buffer_float"))return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Blend(){let e=this.gl,t,i,r,n,o;try{t=e.createTexture(),i=e.createFramebuffer(),e.bindTexture(e.TEXTURE_2D,t);let a=this.version===2?e.RGBA32F:e.RGBA;return e.texImage2D(e.TEXTURE_2D,0,a,1,1,0,e.RGBA,e.FLOAT,null),e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),e.enable(e.BLEND),r=e.createShader(e.VERTEX_SHADER),!r||(e.shaderSource(r,"void main(){}"),e.compileShader(r),n=e.createShader(e.FRAGMENT_SHADER),!n)||(e.shaderSource(n,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),e.compileShader(n),o=e.createProgram(),!o)?!1:(e.attachShader(o,r),e.attachShader(o,n),e.linkProgram(o),e.useProgram(o),e.drawArrays(e.POINTS,0,1),e.getError()===e.NO_ERROR)}finally{e.disable(e.BLEND),o&&e.deleteProgram(o),r&&e.deleteShader(r),n&&e.deleteShader(n),i&&(e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(i)),t&&(e.bindTexture(e.TEXTURE_2D,null),e.deleteTexture(t))}}beginTimer(){if(this.version===2&&this.disjointTimerQueryWebgl2Extension){let e=this.gl,t=this.disjointTimerQueryWebgl2Extension,i=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,i),i}else throw new Error("WebGL1 profiling currently not supported.")}endTimer(){if(this.version===2&&this.disjointTimerQueryWebgl2Extension){let e=this.gl,t=this.disjointTimerQueryWebgl2Extension;e.endQuery(t.TIME_ELAPSED_EXT);return}else throw new Error("WebGL1 profiling currently not supported")}isTimerResultAvailable(e){let t=!1,i=!1;if(this.version===2&&this.disjointTimerQueryWebgl2Extension){let r=this.gl,n=this.disjointTimerQueryWebgl2Extension;t=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE),i=r.getParameter(n.GPU_DISJOINT_EXT)}else throw new Error("WebGL1 profiling currently not supported");return t&&!i}getTimerResult(e){let t=0;if(this.version===2){let i=this.gl;t=i.getQueryParameter(e,i.QUERY_RESULT),i.deleteQuery(e)}else throw new Error("WebGL1 profiling currently not supported");return t/1e6}waitForQueryAndGetTime(e){return Qe(this,null,function*(){return yield F7(()=>this.isTimerResultAvailable(e)),this.getTimerResult(e)})}createAndWaitForFence(){return Qe(this,null,function*(){let e=this.createFence(this.gl);return this.pollFence(e)})}createFence(e){let t,i=e,r=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),r===null?t=()=>!0:t=()=>{let n=i.clientWaitSync(r,0,0);return n===i.ALREADY_SIGNALED||n===i.CONDITION_SATISFIED},{query:r,isFencePassed:t}}pollFence(e){return Qe(this,null,function*(){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})})}pollItems(){let e=MSe(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){let{resolveFn:i}=this.itemsToPoll[t];i()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){return Qe(this,null,function*(){this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),!(this.itemsToPoll.length>1)&&(yield F7(()=>(this.pollItems(),this.itemsToPoll.length===0)))})}}});function cK(e){let t;if((!e||e==="webgl2")&&"webgl2"in Np?t=Np.webgl2:(!e||e==="webgl")&&"webgl"in Np&&(t=Np.webgl),!t)try{let r=NSe();t=Vq(r,e)}catch{let r=PSe();t=Vq(r,e)}e=e||t.version===1?"webgl":"webgl2";let i=t.gl;return Np[e]=t,i.isContextLost()?(delete Np[e],cK(e)):(i.disable(i.DEPTH_TEST),i.disable(i.STENCIL_TEST),i.disable(i.BLEND),i.disable(i.DITHER),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SAMPLE_COVERAGE),i.enable(i.SCISSOR_TEST),i.enable(i.CULL_FACE),i.cullFace(i.BACK),t)}function Vq(e,t){let i={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1},r,n=i;if((!t||t==="webgl2")&&(r=e.getContext("webgl2",n),r))try{return new oO(r,2)}catch(o){yn.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl2'. Error: ${o}`)}if((!t||t==="webgl")&&(r=e.getContext("webgl",n)||e.getContext("experimental-webgl",n),r))try{return new oO(r,1)}catch(o){yn.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ${o}`)}throw new Error("WebGL is not supported")}function PSe(){if(typeof document>"u")throw new TypeError("failed to create canvas: document is not supported");let e=document.createElement("canvas");return e.width=1,e.height=1,e}function NSe(){if(typeof OffscreenCanvas>"u")throw new TypeError("failed to create offscreen canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1)}var Np,OSe=Ce(()=>{"use strict";Al(),kSe(),Np={}}),dK,RSe=Ce(()=>{"use strict";fc(),Al(),ISe(),OSe(),dK=class{get contextId(){return Ii.webgl.contextId}set contextId(e){Ii.webgl.contextId=e}get matmulMaxBatchSize(){return Ii.webgl.matmulMaxBatchSize}set matmulMaxBatchSize(e){Ii.webgl.matmulMaxBatchSize=e}get textureCacheMode(){return Ii.webgl.textureCacheMode}set textureCacheMode(e){Ii.webgl.textureCacheMode=e}get pack(){return Ii.webgl.pack}set pack(e){Ii.webgl.pack=e}get async(){return Ii.webgl.async}set async(e){Ii.webgl.async=e}initialize(){try{return this.glContext=cK(this.contextId),typeof this.matmulMaxBatchSize!="number"&&(this.matmulMaxBatchSize=16),typeof this.textureCacheMode!="string"&&(this.textureCacheMode="full"),typeof this.pack!="boolean"&&(this.pack=!1),typeof this.async!="boolean"&&(this.async=!1),yn.setWithEnv(Ii),Ii.webgl.context||Object.defineProperty(Ii.webgl,"context",{value:this.glContext.gl}),yn.verbose("WebGLBackend",`Created WebGLContext: ${typeof this.glContext} with matmulMaxBatchSize: ${this.matmulMaxBatchSize}; textureCacheMode: ${this.textureCacheMode}; pack: ${this.pack}; async: ${this.async}.`),!0}catch(e){return yn.warning("WebGLBackend",`Unable to initialize WebGLBackend. ${e}`),!1}}createSessionHandler(e){return new lK(this,e)}dispose(){this.glContext.dispose()}}});function uK(e){return Qe(this,null,function*(){if(e){let t=typeof e=="string"?[e]:e;for(let i of t){let r=wO.get(i);if(r)return r;let n=yield FSe(i);if(n)return n}}else return uK(["webgl"]);throw new Error("no available backend to use")})}function FSe(e){return Qe(this,null,function*(){let t=hK;if(typeof t[e]<"u"&&LSe(t[e])){let i=t[e],r=i.initialize();if(typeof r=="object"&&"then"in r&&(r=yield r),r)return wO.set(e,i),i}})}function LSe(e){let t=e;return"initialize"in t&&typeof t.initialize=="function"&&"createSessionHandler"in t&&typeof t.createSessionHandler=="function"&&"dispose"in t&&typeof t.dispose=="function"}var wO,hK,BSe=Ce(()=>{"use strict";RSe(),wO=new Map,hK={webgl:new dK}}),zq,pK,VSe=Ce(()=>{"use strict";Al(),zq=class{constructor(e,t){this.op=e,this.node=t}},pK=class{constructor(e,t,i){this.graph=e,this.profiler=i,this.initialize(t)}initialize(e){this.profiler.event("session","ExecutionPlan.initialize",()=>{let t=this.graph.getNodes();if(t.length!==e.length)throw new Error("The size of nodes and OPs do not match.");this._ops=e.map((i,r)=>new zq(i,t[r])),this.reset(),this._starter=[],this._ops.forEach((i,r)=>{let n=!0;for(let o of i.node.inputs)if(!this._values[o]&&this.graph.getInputIndices().indexOf(o)===-1){n=!1;break}n&&this._starter.push(r)})})}reset(){this._values=this.graph.getValues().map(e=>e.tensor)}execute(e,t){return Qe(this,null,function*(){return this.profiler.event("session","ExecutionPlan.execute",()=>Qe(this,null,function*(){this.reset();let i=e.createInferenceHandler(),r=this.graph.getInputIndices();if(t.length!==r.length)throw new Error(`number of input tensors don't match the number of inputs to the model: actual: ${t.length} expected: ${r.length}`);t.forEach((l,d)=>{let u=r[d];this._values[u]=l});let n=this._starter.slice(0),o=this.graph.getValues(),a=this.graph.getNodes(),s=0;for(;s<n.length;){let l=n[s++],d=this._ops[l],u=d.node.inputs.map(f=>this._values[f]);if(u.indexOf(void 0)!==-1)throw new Error(`unresolved input detected: op: ${d.node}`);let h=u;yn.verbose("ExecPlan",`Running op:${d.node.name} (${h.map((f,g)=>`'${d.node.inputs[g]}': ${f.type}[${f.dims.join(",")}]`).join(", ")})`);let p=yield this.profiler.event("node",d.node.name,()=>Qe(this,null,function*(){return d.op.impl(i,h,d.op.context)}));if(p.length!==d.node.outputs.length)throw new Error("the size of output does not match model definition.");p.forEach((f,g)=>{let v=d.node.outputs[g];if(this._values[v])throw new Error(`output [${v}] already has value: op:${d.node.name}`);this._values[v]=f});let m=new Set;p.forEach((f,g)=>{let v=d.node.outputs[g];for(let _ of o[v].to){let b=a[_],y=!0;for(let x of b.inputs)if(!this._values[x]){y=!1;break}y&&m.add(_)}}),n.push(...m)}let c=[];for(let l=0;l<this.graph.getOutputIndices().length;l++){let d=this.graph.getOutputIndices()[l],u=this._values[d];if(u===void 0)throw new Error(`required output [${d}] does not have value`);d===0?yield u.getData():u.data,c.push(u)}return yn.verbose("ExecPlan","disposing of inferenceHandler"),i.dispose(),c}))})}}}),Fi,vs,aO,zSe=Ce(()=>{"use strict";BE(),Fi=bg(ab()),Eg(),ur(),vs=_r.experimental.fbs,aO=class Z_{constructor(t){if(this._attributes=new Map,t!=null){for(let i of t)i instanceof Fi.onnx.AttributeProto?this._attributes.set(i.name,[Z_.getValue(i),Z_.getType(i)]):i instanceof vs.Attribute&&this._attributes.set(i.name(),[Z_.getValue(i),Z_.getType(i)]);if(this._attributes.size<t.length)throw new Error("duplicated attribute names")}}set(t,i,r){this._attributes.set(t,[r,i])}delete(t){this._attributes.delete(t)}getFloat(t,i){return this.get(t,"float",i)}getInt(t,i){return this.get(t,"int",i)}getString(t,i){return this.get(t,"string",i)}getTensor(t,i){return this.get(t,"tensor",i)}getFloats(t,i){return this.get(t,"floats",i)}getInts(t,i){return this.get(t,"ints",i)}getStrings(t,i){return this.get(t,"strings",i)}getTensors(t,i){return this.get(t,"tensors",i)}get(t,i,r){let n=this._attributes.get(t);if(n===void 0){if(r!==void 0)return r;throw new Error(`required attribute not found: ${t}`)}if(n[1]!==i)throw new Error(`type mismatch: expected ${i} but got ${n[1]}`);return n[0]}static getType(t){let i=t instanceof Fi.onnx.AttributeProto?t.type:t.type();switch(i){case Fi.onnx.AttributeProto.AttributeType.FLOAT:return"float";case Fi.onnx.AttributeProto.AttributeType.INT:return"int";case Fi.onnx.AttributeProto.AttributeType.STRING:return"string";case Fi.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case Fi.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case Fi.onnx.AttributeProto.AttributeType.INTS:return"ints";case Fi.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case Fi.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error(`attribute type is not supported yet: ${Fi.onnx.AttributeProto.AttributeType[i]}`)}}static getValue(t){let i=t instanceof Fi.onnx.AttributeProto?t.type:t.type();if(i===Fi.onnx.AttributeProto.AttributeType.GRAPH||i===Fi.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");let r=this.getValueNoCheck(t);if(i===Fi.onnx.AttributeProto.AttributeType.INT&&hc.isLong(r))return hc.longToNumber(r);if(i===Fi.onnx.AttributeProto.AttributeType.INTS){let n=r,o=new Array(n.length);for(let a=0;a<n.length;a++){let s=n[a];o[a]=hc.longToNumber(s)}return o}if(i===Fi.onnx.AttributeProto.AttributeType.TENSOR)return t instanceof Fi.onnx.AttributeProto?bs.fromProto(r):bs.fromOrtTensor(r);if(i===Fi.onnx.AttributeProto.AttributeType.TENSORS){if(t instanceof Fi.onnx.AttributeProto)return r.map(n=>bs.fromProto(n));if(t instanceof vs.Attribute)return r.map(n=>bs.fromOrtTensor(n))}return i===Fi.onnx.AttributeProto.AttributeType.STRING&&t instanceof Fi.onnx.AttributeProto?FN(r):i===Fi.onnx.AttributeProto.AttributeType.STRINGS&&t instanceof Fi.onnx.AttributeProto?r.map(FN):r}static getValueNoCheck(t){return t instanceof Fi.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(t):this.getValueNoCheckFromOrtFormat(t)}static getValueNoCheckFromOnnxFormat(t){switch(t.type){case Fi.onnx.AttributeProto.AttributeType.FLOAT:return t.f;case Fi.onnx.AttributeProto.AttributeType.INT:return t.i;case Fi.onnx.AttributeProto.AttributeType.STRING:return t.s;case Fi.onnx.AttributeProto.AttributeType.TENSOR:return t.t;case Fi.onnx.AttributeProto.AttributeType.GRAPH:return t.g;case Fi.onnx.AttributeProto.AttributeType.FLOATS:return t.floats;case Fi.onnx.AttributeProto.AttributeType.INTS:return t.ints;case Fi.onnx.AttributeProto.AttributeType.STRINGS:return t.strings;case Fi.onnx.AttributeProto.AttributeType.TENSORS:return t.tensors;case Fi.onnx.AttributeProto.AttributeType.GRAPHS:return t.graphs;default:throw new Error(`unsupported attribute type: ${Fi.onnx.AttributeProto.AttributeType[t.type]}`)}}static getValueNoCheckFromOrtFormat(t){switch(t.type()){case vs.AttributeType.FLOAT:return t.f();case vs.AttributeType.INT:return t.i();case vs.AttributeType.STRING:return t.s();case vs.AttributeType.TENSOR:return t.t();case vs.AttributeType.GRAPH:return t.g();case vs.AttributeType.FLOATS:return t.floatsArray();case vs.AttributeType.INTS:{let i=[];for(let r=0;r<t.intsLength();r++)i.push(t.ints(r));return i}case vs.AttributeType.STRINGS:{let i=[];for(let r=0;r<t.stringsLength();r++)i.push(t.strings(r));return i}case vs.AttributeType.TENSORS:{let i=[];for(let r=0;r<t.tensorsLength();r++)i.push(t.tensors(r));return i}default:throw new Error(`unsupported attribute type: ${vs.AttributeType[t.type()]}`)}}}}),gN,z_,sO,sd,vN,Uq,USe=Ce(()=>{"use strict";zSe(),BE(),gN=bg(ab()),Eg(),ur(),z_=_r.experimental.fbs,sO={from:(e,t)=>new Uq(e,t)},sd=class{constructor(e){this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,e&&(this.type=_s.tensorValueTypeFromProto(e.type.tensorType))}get from(){return this._from}get to(){return this._to}},vN=class{constructor(e,t){e instanceof gN.onnx.NodeProto?(this.name=e.name,this.opType=e.opType,this.attributes=new aO(e.attribute)):e instanceof z_.Node&&(this.name=t??e.name(),this.opType=e.opType(),this.attributes=new aO(_s.tensorAttributesFromORTFormat(e))),this.inputs=[],this.outputs=[],this.executeNode=!0}},Uq=class{constructor(e,t){if(!e)throw new TypeError("graph is empty");this.buildGraph(e),this.transformGraph(t),this.checkIsAcyclic()}getInputIndices(){return this._allInputIndices}getInputNames(){return this._allInputNames}getOutputIndices(){return this._allOutputIndices}getOutputNames(){return this._allOutputNames}getValues(){return this._allData}getNodes(){return this._nodes}buildGraph(e){if(e instanceof gN.onnx.GraphProto)this.buildGraphFromOnnxFormat(e);else if(e instanceof z_.Graph)this.buildGraphFromOrtFormat(e);else throw new TypeError("Graph type is not supported.")}buildGraphFromOnnxFormat(e){let t=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let i=new Map;if(!e.input)throw new Error("missing information in graph: input");let r=[];for(let n of e.input){if(t.has(n.name))throw new Error(`duplicated input name: ${n.name}`);let o=this._allData.push(new sd(n))-1;t.set(n.name,o),r.push(n.name)}if(!e.initializer)throw new Error("missing information in graph: initializer");for(let n of e.initializer){let o=t.get(n.name);if(o===void 0){let a=new sd;a.type={shape:{dims:_s.tensorDimsFromProto(n.dims)},tensorType:_s.tensorDataTypeFromProto(n.dataType)},o=this._allData.push(a)-1,t.set(n.name,o)}this._allData[o]._from=-1,this._allData[o].tensor=bs.fromProto(n)}for(let n=0;n<this._allData.length;n++)this._allData[n].tensor||(this._allInputIndices.push(n),this._allInputNames.push(r[n]));if(!e.output)throw new Error("missing information in graph: output");for(let n of e.output){if(t.has(n.name))throw new Error(`duplicated output name: ${n.name}`);let o=this._allData.push(new sd(n))-1;t.set(n.name,o),this._allOutputIndices.push(o),this._allOutputNames.push(n.name)}if(!e.node)throw new Error("missing information in graph: node");for(let n of e.node){if(!n.name)for(let a=0;;a++){let s=`unnamed_${n.opType}_${a}`;if(!i.has(s)){n.name=s;break}}if(i.has(n.name))throw new Error(`duplicated node name: ${n.name}`);let o=this._nodes.push(new vN(n))-1;i.set(n.name,o)}for(let n=0;n<this._nodes.length;n++){let o=this._nodes[n],a=e.node[n];if(!a.output)throw new Error(`missing output for node: ${a.name}`);for(let s of a.output){let c=t.get(s);if(typeof c>"u"&&(c=this._allData.push(new sd)-1,t.set(s,c)),o.outputs.push(c),this._allData[c]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${c}`);if(this._allData[c]._from=n,a.opType==="Constant"){if(!a.attribute||a.attribute.length!==1||!a.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!a.output||a.output.length!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");o.outputs.pop(),o.executeNode=!1,this._allData[c]._from=-1,this._allData[c].tensor=bs.fromProto(a.attribute[0].t)}}}for(let n=0;n<this._nodes.length;n++){let o=this._nodes[n],a=e.node[n];if(!a.input)throw new Error(`missing input for node: ${a.name}`);for(let s of a.input){let c=t.get(s);if(typeof c>"u"){if(s===""&&(a.input.length===3||a.input.length===4)&&a.opType==="Resize")continue;throw new Error(`unrecognized input '${s}' for node: ${a.name}`)}o.inputs.push(c),this._allData[c]._to.push(n)}}return!0}buildGraphFromOrtFormat(e){let t=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let i=new Map,r=[];for(let n=0;n<e.inputsLength();n++){let o=e.inputs(n);if(t.has(o))throw new Error(`duplicated input name: ${o}`);for(let a=0;a<e.nodeArgsLength();a++)if(e.nodeArgs(a)?.name()===o){let s=new sd;if(e.nodeArgs(a)?.type()?.valueType()!==z_.TypeInfoValue.tensor_type)throw new Error("Unexpected value type for the nodeArg.");let c=e.nodeArgs(a).type().value(new z_.TensorTypeAndShape),l=_s.tensorDataTypeFromProto(c.elemType()),d=c.shape(),u=[];for(let p=0;p<d.dimLength();p++)u.push(hc.longToNumber(d.dim(p).value().dimValue()));s.type={shape:{dims:u},tensorType:l};let h=this._allData.push(s)-1;t.set(o,h),r.push(o)}}for(let n=0;n<e.initializersLength();n++){let o=e.initializers(n),a=t.get(o.name());if(a===void 0){let s=new sd,c=_s.tensorDimsFromORTFormat(o),l=_s.tensorDataTypeFromProto(o.dataType());s.type={shape:{dims:c},tensorType:l},a=this._allData.push(s)-1,t.set(o.name(),a)}this._allData[a]._from=-1,this._allData[a].tensor=bs.fromOrtTensor(o)}for(let n=0;n<this._allData.length;n++)this._allData[n].tensor||(this._allInputIndices.push(n),this._allInputNames.push(r[n]));for(let n=0;n<e.outputsLength();n++){let o=e.outputs(n);if(t.has(o))throw new Error(`duplicated output name: ${o}`);let a=this._allData.push(new sd)-1;t.set(o,a),this._allOutputIndices.push(a),this._allOutputNames.push(o)}if(!e.nodes)throw new Error("missing information in graph: node");for(let n=0;n<e.nodesLength();n++){let o=e.nodes(n),a=o.name();if(!a)for(let c=0;a=`unnamed_${o.opType()}_${c}`,!!i.has(a);c++);if(i.has(a))throw new Error(`duplicated node name: ${a}`);let s=this._nodes.push(new vN(o,a))-1;i.set(a,s)}for(let n=0;n<this._nodes.length;n++){let o=this._nodes[n],a=e.nodes(n);if(a==null)throw new Error(`No node exists at index ${n}`);if(a?.outputsLength()===0)throw new Error(`missing output for node: ${a.name}`);for(let s=0;s<a?.outputsLength();s++){let c=a?.outputs(s),l=t.get(c);if(typeof l>"u"&&(l=this._allData.push(new sd)-1,t.set(c,l)),o.outputs.push(l),this._allData[l]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${l}`);if(this._allData[l]._from=n,a.opType()==="Constant"){if(a.attributesLength()!==1||!a.attributes(0).t())throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(a.outputsLength()!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");o.outputs.pop(),o.executeNode=!1,this._allData[l]._from=-1,this._allData[l].tensor=bs.fromOrtTensor(a.attributes(0).t())}}}for(let n=0;n<this._nodes.length;n++){let o=this._nodes[n],a=e.nodes(n);if(a.inputsLength()===0)throw new Error(`missing input for node: ${a.name}`);for(let s=0;s<a.inputsLength();s++){let c=a.inputs(s),l=t.get(c);if(typeof l>"u")throw new Error(`unrecognized input '${c}' for node: ${a.name()}`);o.inputs.push(l),this._allData[l]._to.push(n)}}}checkIsAcyclic(){let e=new Set;this._allInputIndices.forEach(r=>{this._allData[r]._to.forEach(n=>{e.add(n)})});let t=Array.from(e),i=new Array(this._nodes.length).fill("white");for(;t.length>0;){let r=t.pop();i[r]==="gray"?i[r]="black":(t.push(r),i[r]="gray",this._nodes[r].outputs.forEach(n=>{let o=this._allData[n];if(typeof o.tensor<"u")throw new Error("node outputs should not be initialized");if(o._from!==r)throw new Error("from property of the Value object doesn't match index of Node being processed");o._to.forEach(a=>{if(i[a]==="gray")throw new Error("model graph is cyclic");i[a]==="white"&&t.push(a)})}))}}transformGraph(e){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),e&&e.transformGraph(this),this.finalizeGraph()}finalizeGraph(){let e=0,t=new Array(this._nodes.length,0),i=0;for(let r=0;r<this._nodes.length;r++)t[r]=i,this._nodes[r].executeNode?(i!==r&&(this._nodes[i]=this._nodes[r]),i++):this._nodes[r].outputs.forEach(n=>{this._allData[n]._from=-2});this._nodes.splice(i,this._nodes.length-i);for(let r=0;r<this._allData.length;r++){let n=this._allData[r];n._from!==void 0&&n._from!==-1&&n._from!==-2&&(n._from=t[n._from]);for(let o=0;o<n._to.length;o++)if(n._to[o]>=0)n._to[o]=t[n._to[o]];else throw new Error("Trying to update a removed node")}e=0;for(let r=0;r<this._allData.length;r++){if(this._allData[r].from===-2&&this._allOutputIndices.indexOf(r+e)===-1){e++,this._allData.splice(r,1),r--;continue}if(e>0){let n=-1;this._allData[r].from!==void 0&&this._allData[r].from!==-1?(n=this._nodes[this._allData[r].from].outputs.indexOf(r+e),n!==-1&&(this._nodes[this._allData[r].from].outputs[n]=r)):(n=this._allInputIndices.indexOf(r+e),n!==-1&&(this._allInputIndices[n]=r)),this._allData[r].to.forEach(o=>{n=this._nodes[o].inputs.indexOf(r+e),n!==-1&&(this._nodes[o].inputs[n]=r)}),this._allData[r].to.length===0&&(n=this._allOutputIndices.indexOf(r+e),n!==-1&&(this._allOutputIndices[n]=r))}}}deleteNode(e){let t=this._nodes[e];if(t.outputs.length>1){for(let a=1;a<t.outputs.length;a++)if(this._allData[t.outputs[a]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ")}t.executeNode=!1;let i=t.inputs[0],r=t.outputs[0],n=this._allData[r].to;for(let a=0;a<t.inputs.length;a++){let s=this._allData[t.inputs[a]].to.indexOf(e);if(s===-1)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[t.inputs[a]].to.splice(s,1)}this._allData[r]._to=[];let o=this._allOutputIndices.indexOf(r);if(o!==-1&&(this._allOutputIndices[o]=i),n&&n.length>0)for(let a of n){let s=this._nodes[a].inputs.indexOf(r);if(s===-1)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[a].inputs[s]=i,this._allData[i].to.push(a)}}removeAllDropoutNodes(){let e=0;for(let t of this._nodes){if(t.opType==="Dropout"){if(t.inputs.length!==1)throw new Error("Dropout nodes should only contain one input. ");if(t.outputs.length!==1&&t.outputs.length!==2)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(t.outputs.length===2&&this._allData[t.outputs[1]]._to.length!==0)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(e)}e++}}removeAllIdentityNodes(){let e=0;for(let t of this._nodes)t.opType==="Identity"&&this.deleteNode(e),e++}isActivation(e){switch(e.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1}}fuseConvActivationNodes(){for(let e of this._nodes)if(e.opType==="Conv"){let t=this._allData[e.outputs[0]]._to;if(t.length===1&&this.isActivation(this._nodes[t[0]])){let i=this._nodes[t[0]];if(i.opType==="Clip")if(i.inputs.length===1)try{e.attributes.set("activation_params","floats",[i.attributes.getFloat("min"),i.attributes.getFloat("max")])}catch{e.attributes.set("activation_params","floats",[ib,rb])}else if(i.inputs.length>=3&&this._allData[i.inputs[1]].tensor!==void 0&&this._allData[i.inputs[2]].tensor!==void 0)e.attributes.set("activation_params","floats",[this._allData[i.inputs[1]].tensor.floatData[0],this._allData[i.inputs[2]].tensor.floatData[0]]);else continue;e.attributes.set("activation","string",i.opType),this.deleteNode(t[0])}}}}}),Hq,jq,fK,HSe=Ce(()=>{"use strict";mO(),USe(),BE(),Hq=bg(ab()),ur(),jq=_r.experimental.fbs,fK=class{constructor(){}load(e,t,i){let r;if(!i)try{this.loadFromOnnxFormat(e,t);return}catch(n){if(i!==void 0)throw n;r=n}try{this.loadFromOrtFormat(e,t)}catch(n){throw i!==void 0?n:new Error(`Failed to load model as ONNX format: ${r}
as ORT format: ${n}`)}}loadFromOnnxFormat(e,t){let i=Hq.onnx.ModelProto.decode(e);if(hc.longToNumber(i.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=i.opsetImport.map(r=>({domain:r.domain,version:hc.longToNumber(r.version)})),this._graph=sO.from(i.graph,t)}loadFromOrtFormat(e,t){let i=new oe.ByteBuffer(e),r=jq.InferenceSession.getRootAsInferenceSession(i).model();if(hc.longToNumber(r.irVersion())<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(let n=0;n<r.opsetImportLength();n++){let o=r.opsetImport(n);this._opsets.push({domain:o?.domain(),version:hc.longToNumber(o.version())})}this._graph=sO.from(r.graph(),t)}get graph(){return this._graph}get opsets(){return this._opsets}}}),mK,jSe=Ce(()=>{"use strict";BSe(),VSe(),Al(),HSe(),mK=class{constructor(e={}){this._initialized=!1,this.backendHint=e.backendHint,this.profiler=TX.create(e.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}get inputNames(){return this._model.graph.getInputNames()}get outputNames(){return this._model.graph.getOutputNames()}startProfiling(){this.profiler.start()}endProfiling(){this.profiler.stop()}loadModel(e,t,i){return Qe(this,null,function*(){yield this.profiler.event("session","Session.loadModel",()=>Qe(this,null,function*(){let r=yield uK(this.backendHint);if(this.sessionHandler=r.createSessionHandler(this.context),this._model=new fK,typeof e=="string"){let n=e.endsWith(".ort");{let o=yield(yield fetch(e)).arrayBuffer();this.initialize(new Uint8Array(o),n)}}else if(ArrayBuffer.isView(e))this.initialize(e);else{let n=new Uint8Array(e,t||0,i||e.byteLength);this.initialize(n)}}))})}initialize(e,t){if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",()=>{let i=this.sessionHandler.transformGraph?this.sessionHandler:void 0;this._model.load(e,i,t),this.sessionHandler.onGraphInitialized&&this.sessionHandler.onGraphInitialized(this._model.graph),this.initializeOps(this._model.graph),this._executionPlan=new pK(this._model.graph,this._ops,this.profiler)}),this._initialized=!0}run(e){return Qe(this,null,function*(){if(!this._initialized)throw new Error("session not initialized yet");return this.profiler.event("session","Session.run",()=>Qe(this,null,function*(){let t=this.normalizeAndValidateInputs(e),i=yield this._executionPlan.execute(this.sessionHandler,t);return this.createOutput(i)}))})}normalizeAndValidateInputs(e){let t=this._model.graph.getInputNames();if(Array.isArray(e)){if(e.length!==t.length)throw new Error(`incorrect input array length: expected ${t.length} but got ${e.length}`)}else{if(e.size!==t.length)throw new Error(`incorrect input map size: expected ${t.length} but got ${e.size}`);let i=new Array(e.size),r=0;for(let n=0;n<t.length;++n){let o=e.get(t[n]);if(!o)throw new Error(`missing input tensor for: '${name}'`);i[r++]=o}e=i}if(!this.context.graphInputTypes||this.context.graphInputTypes.length===0||!this.context.graphInputDims||this.context.graphInputDims.length===0){let i=this._model.graph.getInputIndices(),r=this._model.graph.getValues(),n=new Array(i.length);for(let o=0;o<i.length;++o){let a=r[i[o]];n[o]=a.type.shape.dims,this.context.graphInputTypes.push(a.type.tensorType),this.context.graphInputDims.push(e[o].dims)}this.validateInputTensorDims(n,e,!0)}else this.validateInputTensorDims(this.context.graphInputDims,e,!1);return this.validateInputTensorTypes(this.context.graphInputTypes,e),e}validateInputTensorTypes(e,t){for(let i=0;i<t.length;i++){let r=e[i],n=t[i].type;if(r!==n)throw new Error(`input tensor[${i}] check failed: expected type '${r}' but got ${n}`)}}validateInputTensorDims(e,t,i){for(let r=0;r<t.length;r++){let n=e[r],o=t[r].dims;if(!this.compareTensorDims(n,o,i))throw new Error(`input tensor[${r}] check failed: expected shape '[${n.join(",")}]' but got [${o.join(",")}]`)}}compareTensorDims(e,t,i){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r]&&(!i||e[r]!==0))return!1;return!0}createOutput(e){let t=this._model.graph.getOutputNames();if(e.length!==t.length)throw new Error("expected number of outputs do not match number of generated outputs");let i=new Map;for(let r=0;r<t.length;++r)i.set(t[r],e[r]);return i}initializeOps(e){let t=e.getNodes();this._ops=new Array(t.length);for(let i=0;i<t.length;i++)this._ops[i]=this.sessionHandler.resolve(t[i],this._model.opsets,e)}}}),gK,GSe=Ce(()=>{"use strict";fc(),Eg(),gK=class{constructor(e){this.session=e,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames}dispose(){return Qe(this,null,function*(){})}run(e,t,i){return Qe(this,null,function*(){let r=new Map;for(let a in e)if(Object.hasOwnProperty.call(e,a)){let s=e[a];r.set(a,new bs(s.dims,s.type,void 0,void 0,s.data))}let n=yield this.session.run(r),o={};return n.forEach((a,s)=>{o[s]=new bo(a.type,a.data,a.dims)}),o})}startProfiling(){this.session.startProfiling()}endProfiling(){this.session.endProfiling()}}}),vK={};ob(vK,{onnxjsBackend:()=>_K});var Gq,_K,$Se=Ce(()=>{"use strict";jSe(),GSe(),Gq=class{init(){return Qe(this,null,function*(){})}createInferenceSessionHandler(e,t){return Qe(this,null,function*(){let i=new mK(t);return typeof e=="string"?yield i.loadModel(e):yield i.loadModel(e),new gK(i)})}},_K=new Gq}),EO=Ce(()=>{"use strict"}),bK={};ob(bK,{default:()=>yK});var _N,bN,yK,WSe=Ce(()=>{"use strict";NK(),Ag(),UE(),_N="ort-wasm-proxy-worker",bN=globalThis.self?.name===_N,bN&&(self.onmessage=e=>{let{type:t,in:i}=e.data;try{switch(t){case"init-wasm":CO(i.wasm).then(()=>{DO(i).then(()=>{postMessage({type:t})},r=>{postMessage({type:t,err:r})})},r=>{postMessage({type:t,err:r})});break;case"init-ep":{let{epName:r,env:n}=i;IO(n,r).then(()=>{postMessage({type:t})},o=>{postMessage({type:t,err:o})});break}case"copy-from":{let{buffer:r}=i,n=RE(r);postMessage({type:t,out:n});break}case"create":{let{model:r,options:n}=i;MO(r,n).then(o=>{postMessage({type:t,out:o})},o=>{postMessage({type:t,err:o})});break}case"release":kO(i),postMessage({type:t});break;case"run":{let{sessionId:r,inputIndices:n,inputs:o,outputIndices:a,options:s}=i;PO(r,n,o,a,new Array(a.length).fill(null),s).then(c=>{c.some(l=>l[3]!=="cpu")?postMessage({type:t,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:t,out:c},OO([...o,...c]))},c=>{postMessage({type:t,err:c})});break}case"end-profiling":NO(i),postMessage({type:t});break;default:}}catch(r){postMessage({type:t,err:r})}}),yK=bN?null:e=>new Worker(e??vg,{type:"module",name:_N})}),xK={};ob(xK,{default:()=>wK});var yN,xN,wK,qSe=Ce(()=>{"use strict";xN=(yN=import.meta.url,function(){return Qe(this,arguments,function*(e={}){function t(){return P.buffer!=j.buffer&&ie(),j}function i(){return P.buffer!=j.buffer&&ie(),B}function r(){return P.buffer!=j.buffer&&ie(),te}function n(){return P.buffer!=j.buffer&&ie(),Z}function o(){return P.buffer!=j.buffer&&ie(),se}var a,s,c=Object.assign({},e),l=new Promise((D,V)=>{a=D,s=V}),d=typeof window=="object",u=typeof importScripts=="function",h=u&&self.name=="em-pthread";c.mountExternalData=(D,V)=>{(c.Ua||(c.Ua=new Map)).set(D,V)},c.unmountExternalData=()=>{delete c.Ua};var p,m,f=globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,shared:!0}).buffer.constructor,g=Object.assign({},c),v="./this.program",_=(D,V)=>{throw V},b="";(d||u)&&(u?b=self.location.href:typeof document<"u"&&document.currentScript&&(b=document.currentScript.src),yN&&(b=yN),b=b.startsWith("blob:")?"":b.substr(0,b.replace(/[?#].*/,"").lastIndexOf("/")+1),u&&(m=D=>{var V=new XMLHttpRequest;return V.open("GET",D,!1),V.responseType="arraybuffer",V.send(null),new Uint8Array(V.response)}),p=(D,V,K)=>{var re=new XMLHttpRequest;re.open("GET",D,!0),re.responseType="arraybuffer",re.onload=()=>{re.status==200||re.status==0&&re.response?V(re.response):K()},re.onerror=K,re.send(null)});var y,x=console.log.bind(console),w=console.error.bind(console),I=x,S=w;if(Object.assign(c,g),g=null,h){let D=function(V){try{var K=V.data,re=K.cmd;if(re==="load"){let de=[];self.onmessage=He=>de.push(He),self.startWorker=()=>{postMessage({cmd:"loaded"});for(let He of de)D(He);self.onmessage=D};for(let He of K.handlers)c[He]&&!c[He].proxy||(c[He]=(...Pt)=>{postMessage({Za:"callHandler",kb:He,args:Pt})},He=="print"&&(I=c[He]),He=="printErr"&&(S=c[He]));P=K.wasmMemory,ie(),N(K.wasmModule)}else if(re==="run"){QE(K.pthread_ptr,0,0,1,0,0),Dg(K.pthread_ptr),lt(),Se(),M||=!0;try{hr(K.start_routine,K.arg)}catch(de){if(de!="unwind")throw de}}else re==="cancel"?zp()&&Db(-1):K.target!=="setimmediate"&&(re==="checkMailbox"?M&&Bp():re&&(S(`worker: received unknown command ${re}`),S(K)))}catch(de){throw XO(),de}};var E=D,N,M=!1;S=function(...V){V=V.join(" "),console.error(V)},self.alert=function(...V){postMessage({Za:"alert",text:V.join(" "),mb:zp()})},c.instantiateWasm=(V,K)=>new Promise(re=>{N=de=>{de=new WebAssembly.Instance(de,Kt()),K(de),re()}}),self.onunhandledrejection=V=>{throw V.reason||V},self.onmessage=D}c.wasmBinary&&(y=c.wasmBinary);var P,$,R,j,B,te,Z,ne,se,we=!1;function ie(){var D=P.buffer;c.HEAP8=j=new Int8Array(D),c.HEAP16=new Int16Array(D),c.HEAPU8=B=new Uint8Array(D),c.HEAPU16=new Uint16Array(D),c.HEAP32=te=new Int32Array(D),c.HEAPU32=Z=new Uint32Array(D),c.HEAPF32=new Float32Array(D),c.HEAPF64=se=new Float64Array(D),c.HEAP64=ne=new BigInt64Array(D),c.HEAPU64=new BigUint64Array(D)}if(!h){if(!((P=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0})).buffer instanceof f))throw S("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),Error("bad memory");ie()}var ue=[],Ee=[],ye=[],Te=0,pe=null,be=null;function De(){if(--Te==0&&(pe!==null&&(clearInterval(pe),pe=null),be)){var D=be;be=null,D()}}function fe(D){throw S(D="Aborted("+D+")"),we=!0,R=1,D=new WebAssembly.RuntimeError(D+". Build with -sASSERTIONS for more info."),s(D),D}var Ne,Pe=D=>D.startsWith("data:application/octet-stream;base64,"),Ke=D=>D.startsWith("file://");function At(D){if(D==Ne&&y)return new Uint8Array(y);if(m)return m(D);throw"both async and sync fetching of the wasm failed"}function bt(D,V,K){return function(re){if(!y&&(d||u)){if(typeof fetch=="function"&&!Ke(re))return fetch(re,{credentials:"same-origin"}).then(de=>{if(!de.ok)throw`failed to load wasm binary file at '${re}'`;return de.arrayBuffer()}).catch(()=>At(re));if(p)return new Promise((de,He)=>{p(re,Pt=>de(new Uint8Array(Pt)),He)})}return Promise.resolve().then(()=>At(re))}(D).then(re=>WebAssembly.instantiate(re,V)).then(K,re=>{S(`failed to asynchronously prepare wasm: ${re}`),fe(re)})}function Kt(){return{a:{j:Ki,b:pn,E:qn,g:Bu,V:db,A:pb,C:fb,W:mb,T:gb,L:vb,S:_b,o:bb,B:yb,y:xb,U:wb,z:Eb,_:HE,Z:jE,P:GE,w:$E,F:WE,k:qE,O:Dg,Y:XE,I:YE,J:sr,K:xo,G:Sb,H:zu,v:Uu,q:rQ,l:nQ,p:oQ,e:aQ,X:sQ,x:lQ,d:FO,f:cQ,i:dQ,u:uQ,t:hQ,s:pQ,Q:VO,R:zO,D:Wn,h:UO,n:HO,M:jO,m:GO,a:P,r:Zr,N:qO,c:gQ}}}var zi={822132:(D,V,K,re)=>{if(c===void 0||!c.Ua)return 1;if((D=xs(D>>>0)).startsWith("./")&&(D=D.substring(2)),!(D=c.Ua.get(D)))return 2;if(re>>>=0,(V>>>=0)+(K>>>=0)>D.byteLength)return 3;try{return i().set(D.subarray(V,V+K),re>>>0),0}catch{return 4}},822633:()=>typeof wasmOffsetConverter<"u"};function Ki(){return typeof wasmOffsetConverter<"u"}function br(D){this.name="ExitStatus",this.message=`Program terminated with exit(${D})`,this.status=D}var Wi=D=>{D.terminate(),D.onmessage=()=>{}},Qi=D=>{qo.length==0&&(Me(),Oe(qo[0]));var V=qo.pop();if(!V)return 6;Tn.push(V),ee[D.Ra]=V,V.Ra=D.Ra;var K={cmd:"run",start_routine:D.cb,arg:D.ab,pthread_ptr:D.Ra};return V.postMessage(K,D.ib),0},hn=0,gi=(D,V,...K)=>{for(var re=2*K.length,de=tC(),He=eC(8*re),Pt=He>>>3,$r=0;$r<K.length;$r++){var wo=K[$r];typeof wo=="bigint"?(ne[Pt+2*$r]=1n,ne[Pt+2*$r+1]=wo):(ne[Pt+2*$r]=0n,o()[Pt+2*$r+1>>>0]=wo)}return D=YO(D,0,re,He,V),Ib(de),D};function Zr(D){if(h)return gi(0,1,D);if(R=D,!(0<hn)){for(var V of Tn)Wi(V);for(V of qo)Wi(V);qo=[],Tn=[],ee=[],we=!0}_(D,new br(D))}function ys(D){if(h)return gi(1,0,D);Wn(D)}var Wn=D=>{if(R=D,h)throw ys(D),"unwind";Zr(D)},qo=[],Tn=[],H=[],ee={},ce=D=>{var V=D.Ra;delete ee[V],qo.push(D),Tn.splice(Tn.indexOf(D),1),D.Ra=0,JE(V)};function Se(){H.forEach(D=>D())}var Oe=D=>new Promise(V=>{D.onmessage=de=>{var He=(de=de.data).cmd;if(de.targetThread&&de.targetThread!=zp()){var Pt=ee[de.targetThread];Pt?Pt.postMessage(de,de.transferList):S(`Internal error! Worker sent a message "${He}" to target pthread ${de.targetThread}, but that thread no longer exists!`)}else He==="checkMailbox"?Bp():He==="spawnThread"?Qi(de):He==="cleanupThread"?ce(ee[de.thread]):He==="killThread"?(de=de.thread,He=ee[de],delete ee[de],Wi(He),JE(de),Tn.splice(Tn.indexOf(He),1),He.Ra=0):He==="cancelThread"?ee[de.thread].postMessage({cmd:"cancel"}):He==="loaded"?(D.loaded=!0,V(D)):He==="alert"?alert(`Thread ${de.threadId}: ${de.text}`):de.target==="setimmediate"?D.postMessage(de):He==="callHandler"?c[de.handler](...de.args):He&&S(`worker sent an unknown command ${He}`)},D.onerror=de=>{throw S(`worker sent an error! ${de.filename}:${de.lineno}: ${de.message}`),de};var K,re=[];for(K of[])c.hasOwnProperty(K)&&re.push(K);D.postMessage({cmd:"load",handlers:re,wasmMemory:P,wasmModule:$})});function Me(){var D=new Worker(new URL(import.meta.url),{type:"module",workerData:"em-pthread",name:"em-pthread"});qo.push(D)}var at,je=D=>{for(;0<D.length;)D.shift()(c)},lt=()=>{var D=zp(),V=n()[D+52>>>2>>>0];D=n()[D+56>>>2>>>0],KO(V,V-D),Ib(V)},Ue=[],hr=(D,V)=>{hn=0;var K=Ue[D];K||(D>=Ue.length&&(Ue.length=D+1),Ue[D]=K=at.get(D)),D=K(V),0<hn?R=D:Db(D)};class Sr{constructor(V){this.Xa=V-24}}function pn(D,V,K){var re=new Sr(D>>>=0);throw V>>>=0,K>>>=0,n()[re.Xa+16>>>2>>>0]=0,n()[re.Xa+4>>>2>>>0]=V,n()[re.Xa+8>>>2>>>0]=K,D}function uo(D,V,K,re){return h?gi(2,1,D,V,K,re):qn(D,V,K,re)}function qn(D,V,K,re){if(D>>>=0,V>>>=0,K>>>=0,re>>>=0,f===void 0)return S("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var de=[];return h&&de.length===0?uo(D,V,K,re):(D={cb:K,Ra:D,ab:re,ib:de},h?(D.Za="spawnThread",postMessage(D,de),0):Qi(D))}var va=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,_a=(D,V,K)=>{var re=(V>>>=0)+K;for(K=V;D[K]&&!(K>=re);)++K;if(16<K-V&&D.buffer&&va)return va.decode(D.buffer instanceof f?D.slice(V,K):D.subarray(V,K));for(re="";V<K;){var de=D[V++];if(128&de){var He=63&D[V++];if((224&de)==192)re+=String.fromCharCode((31&de)<<6|He);else{var Pt=63&D[V++];65536>(de=(240&de)==224?(15&de)<<12|He<<6|Pt:(7&de)<<18|He<<12|Pt<<6|63&D[V++])?re+=String.fromCharCode(de):(de-=65536,re+=String.fromCharCode(55296|de>>10,56320|1023&de))}}else re+=String.fromCharCode(de)}return re},xs=(D,V)=>(D>>>=0)?_a(i(),D,V):"";function Bu(D,V,K){return h?gi(3,1,D,V,K):0}function db(D,V){if(h)return gi(4,1,D,V)}var ub=D=>{for(var V=0,K=0;K<D.length;++K){var re=D.charCodeAt(K);127>=re?V++:2047>=re?V+=2:55296<=re&&57343>=re?(V+=4,++K):V+=3}return V},hb=(D,V,K,re)=>{if(!(0<re))return 0;var de=K>>>=0;re=K+re-1;for(var He=0;He<D.length;++He){var Pt=D.charCodeAt(He);if(55296<=Pt&&57343>=Pt&&(Pt=65536+((1023&Pt)<<10)|1023&D.charCodeAt(++He)),127>=Pt){if(K>=re)break;V[K++>>>0]=Pt}else{if(2047>=Pt){if(K+1>=re)break;V[K++>>>0]=192|Pt>>6}else{if(65535>=Pt){if(K+2>=re)break;V[K++>>>0]=224|Pt>>12}else{if(K+3>=re)break;V[K++>>>0]=240|Pt>>18,V[K++>>>0]=128|Pt>>12&63}V[K++>>>0]=128|Pt>>6&63}V[K++>>>0]=128|63&Pt}}return V[K>>>0]=0,K-de},Vu=(D,V,K)=>hb(D,i(),V,K);function pb(D,V){if(h)return gi(5,1,D,V)}function fb(D,V,K){if(h)return gi(6,1,D,V,K)}function mb(D,V,K){return h?gi(7,1,D,V,K):0}function gb(D,V){if(h)return gi(8,1,D,V)}function vb(D,V,K){if(h)return gi(9,1,D,V,K)}function _b(D,V,K,re){if(h)return gi(10,1,D,V,K,re)}function bb(D,V,K,re){if(h)return gi(11,1,D,V,K,re)}function yb(D,V,K,re){if(h)return gi(12,1,D,V,K,re)}function xb(D){if(h)return gi(13,1,D)}function wb(D,V){if(h)return gi(14,1,D,V)}function Eb(D,V,K){if(h)return gi(15,1,D,V,K)}var HE=()=>{fe("")},jE=()=>1;function GE(D){QE(D>>>0,!u,1,!d,131072,!1),Se()}function Dg(D){D>>>=0,typeof Atomics.jb=="function"&&(Atomics.jb(r(),D>>>2,D).value.then(Bp),D+=128,Atomics.store(r(),D>>>2,1))}var Bp=()=>{var D=zp();if(D&&(Dg(D),D=ZO,!we))try{if(D(),!(0<hn))try{h?Db(R):Wn(R)}catch(V){V instanceof br||V=="unwind"||_(1,V)}}catch(V){V instanceof br||V=="unwind"||_(1,V)}};function $E(D,V){(D>>>=0)==V>>>0?setTimeout(Bp):h?postMessage({targetThread:D,cmd:"checkMailbox"}):(D=ee[D])&&D.postMessage({cmd:"checkMailbox"})}var Ig=[];function WE(D,V,K,re,de){for(V>>>=0,re/=2,Ig.length=re,K=de>>>0>>>3,de=0;de<re;de++)Ig[de]=ne[K+2*de]?ne[K+2*de+1]:o()[K+2*de+1>>>0];return(V?zi[V]:vQ[D])(...Ig)}function qE(D){D>>>=0,h?postMessage({cmd:"cleanupThread",thread:D}):ce(ee[D])}function XE(D){}function YE(D,V){D=-9007199254740992>D||9007199254740992<D?NaN:Number(D),V>>>=0,D=new Date(1e3*D),r()[V>>>2>>>0]=D.getUTCSeconds(),r()[V+4>>>2>>>0]=D.getUTCMinutes(),r()[V+8>>>2>>>0]=D.getUTCHours(),r()[V+12>>>2>>>0]=D.getUTCDate(),r()[V+16>>>2>>>0]=D.getUTCMonth(),r()[V+20>>>2>>>0]=D.getUTCFullYear()-1900,r()[V+24>>>2>>>0]=D.getUTCDay(),D=(D.getTime()-Date.UTC(D.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,r()[V+28>>>2>>>0]=D}var cd=D=>D%4==0&&(D%100!=0||D%400==0),Cb=[0,31,60,91,121,152,182,213,244,274,305,335],dd=[0,31,59,90,120,151,181,212,243,273,304,334];function sr(D,V){D=-9007199254740992>D||9007199254740992<D?NaN:Number(D),V>>>=0,D=new Date(1e3*D),r()[V>>>2>>>0]=D.getSeconds(),r()[V+4>>>2>>>0]=D.getMinutes(),r()[V+8>>>2>>>0]=D.getHours(),r()[V+12>>>2>>>0]=D.getDate(),r()[V+16>>>2>>>0]=D.getMonth(),r()[V+20>>>2>>>0]=D.getFullYear()-1900,r()[V+24>>>2>>>0]=D.getDay();var K=(cd(D.getFullYear())?Cb:dd)[D.getMonth()]+D.getDate()-1|0;r()[V+28>>>2>>>0]=K,r()[V+36>>>2>>>0]=-60*D.getTimezoneOffset(),K=new Date(D.getFullYear(),6,1).getTimezoneOffset();var re=new Date(D.getFullYear(),0,1).getTimezoneOffset();D=0|(K!=re&&D.getTimezoneOffset()==Math.min(re,K)),r()[V+32>>>2>>>0]=D}function xo(D){D>>>=0;var V=new Date(r()[D+20>>>2>>>0]+1900,r()[D+16>>>2>>>0],r()[D+12>>>2>>>0],r()[D+8>>>2>>>0],r()[D+4>>>2>>>0],r()[D>>>2>>>0],0),K=r()[D+32>>>2>>>0],re=V.getTimezoneOffset(),de=new Date(V.getFullYear(),6,1).getTimezoneOffset(),He=new Date(V.getFullYear(),0,1).getTimezoneOffset(),Pt=Math.min(He,de);return 0>K?r()[D+32>>>2>>>0]=+(de!=He&&Pt==re):0<K!=(Pt==re)&&(de=Math.max(He,de),V.setTime(V.getTime()+6e4*((0<K?Pt:de)-re))),r()[D+24>>>2>>>0]=V.getDay(),K=(cd(V.getFullYear())?Cb:dd)[V.getMonth()]+V.getDate()-1|0,r()[D+28>>>2>>>0]=K,r()[D>>>2>>>0]=V.getSeconds(),r()[D+4>>>2>>>0]=V.getMinutes(),r()[D+8>>>2>>>0]=V.getHours(),r()[D+12>>>2>>>0]=V.getDate(),r()[D+16>>>2>>>0]=V.getMonth(),r()[D+20>>>2>>>0]=V.getYear(),D=V.getTime(),BigInt(isNaN(D)?-1:D/1e3)}function Sb(D,V,K,re,de,He,Pt){return h?gi(16,1,D,V,K,re,de,He,Pt):-52}function zu(D,V,K,re,de,He){if(h)return gi(17,1,D,V,K,re,de,He)}function Uu(D,V,K,re){D>>>=0,V>>>=0,K>>>=0,re>>>=0;var de=new Date().getFullYear(),He=new Date(de,0,1),Pt=new Date(de,6,1);de=He.getTimezoneOffset();var $r=Pt.getTimezoneOffset(),wo=Math.max(de,$r);n()[D>>>2>>>0]=60*wo,r()[V>>>2>>>0]=+(de!=$r),He=(D=Xo=>Xo.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1])(He),Pt=D(Pt),$r<de?(Vu(He,K,17),Vu(Pt,re,17)):(Vu(He,re,17),Vu(Pt,K,17))}var Mg=[];function rQ(D,V,K){D>>>=0,V>>>=0,K>>>=0,Mg.length=0;for(var re;re=i()[V++>>>0];){var de=re!=105;K+=(de&=re!=112)&&K%8?4:0,Mg.push(re==112?n()[K>>>2>>>0]:re==106?ne[K>>>3]:re==105?r()[K>>>2>>>0]:o()[K>>>3>>>0]),K+=de?8:4}return zi[D](...Mg)}var nQ=()=>{},oQ=()=>Date.now();function aQ(D,V){return S(xs(D>>>0,V>>>0))}var FO,sQ=()=>{throw hn+=1,"unwind"};function lQ(){return 4294901760}FO=()=>performance.timeOrigin+performance.now();var cQ=()=>navigator.hardwareConcurrency;function dQ(){return fe("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function uQ(D){D>>>=0;var V=i().length;if(D<=V||4294901760<D)return!1;for(var K=1;4>=K;K*=2){var re=V*(1+.2/K);re=Math.min(re,D+100663296);var de=Math;re=Math.max(D,re);e:{de=(de.min.call(de,4294901760,re+(65536-re%65536)%65536)-P.buffer.byteLength+65535)/65536;try{P.grow(de),ie();var He=1;break e}catch{}He=void 0}if(He)return!0}return!1}var Tb=()=>(fe("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),Vp={},LO=D=>{D.forEach(V=>{var K=Tb();K&&(Vp[K]=V)})};function hQ(){var D=Error().stack.toString().split(`
`);return D[0]=="Error"&&D.shift(),LO(D),Vp.$a=Tb(),Vp.bb=D,Vp.$a}function pQ(D,V,K){if(D>>>=0,V>>>=0,Vp.$a==D)var re=Vp.bb;else(re=Error().stack.toString().split(`
`))[0]=="Error"&&re.shift(),LO(re);for(var de=3;re[de]&&Tb()!=D;)++de;for(D=0;D<K&&re[D+de];++D)r()[V+4*D>>>2>>>0]=Tb();return D}var ZE,KE={},BO=()=>{if(!ZE){var D,V={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:v||"./this.program"};for(D in KE)KE[D]===void 0?delete V[D]:V[D]=KE[D];var K=[];for(D in V)K.push(`${D}=${V[D]}`);ZE=K}return ZE};function VO(D,V){if(h)return gi(18,1,D,V);D>>>=0,V>>>=0;var K=0;return BO().forEach((re,de)=>{var He=V+K;for(de=n()[D+4*de>>>2>>>0]=He,He=0;He<re.length;++He)t()[de++>>>0]=re.charCodeAt(He);t()[de>>>0]=0,K+=re.length+1}),0}function zO(D,V){if(h)return gi(19,1,D,V);D>>>=0,V>>>=0;var K=BO();n()[D>>>2>>>0]=K.length;var re=0;return K.forEach(de=>re+=de.length+1),n()[V>>>2>>>0]=re,0}function UO(D){return h?gi(20,1,D):52}function HO(D,V,K,re){return h?gi(21,1,D,V,K,re):52}function jO(D,V,K,re){return h?gi(22,1,D,V,K,re):70}var fQ=[null,[],[]];function GO(D,V,K,re){if(h)return gi(23,1,D,V,K,re);V>>>=0,K>>>=0,re>>>=0;for(var de=0,He=0;He<K;He++){var Pt=n()[V>>>2>>>0],$r=n()[V+4>>>2>>>0];V+=8;for(var wo=0;wo<$r;wo++){var Xo=i()[Pt+wo>>>0],ba=fQ[D];Xo===0||Xo===10?((D===1?I:S)(_a(ba,0)),ba.length=0):ba.push(Xo)}de+=$r}return n()[re>>>2>>>0]=de,0}var $O=[31,29,31,30,31,30,31,31,30,31,30,31],WO=[31,28,31,30,31,30,31,31,30,31,30,31],mQ=(D,V)=>{t().set(D,V>>>0)};function qO(D,V,K,re){function de(xe,lr,xn){for(xe=typeof xe=="number"?xe.toString():xe||"";xe.length<lr;)xe=xn[0]+xe;return xe}function He(xe,lr){return de(xe,lr,"0")}function Pt(xe,lr){function xn(t3){return 0>t3?-1:0<t3?1:0}var Hu;return(Hu=xn(xe.getFullYear()-lr.getFullYear()))===0&&(Hu=xn(xe.getMonth()-lr.getMonth()))===0&&(Hu=xn(xe.getDate()-lr.getDate())),Hu}function $r(xe){switch(xe.getDay()){case 0:return new Date(xe.getFullYear()-1,11,29);case 1:return xe;case 2:return new Date(xe.getFullYear(),0,3);case 3:return new Date(xe.getFullYear(),0,2);case 4:return new Date(xe.getFullYear(),0,1);case 5:return new Date(xe.getFullYear()-1,11,31);case 6:return new Date(xe.getFullYear()-1,11,30)}}function wo(xe){var lr=xe.Sa;for(xe=new Date(new Date(xe.Ta+1900,0,1).getTime());0<lr;){var xn=xe.getMonth(),Hu=(cd(xe.getFullYear())?$O:WO)[xn];if(!(lr>Hu-xe.getDate())){xe.setDate(xe.getDate()+lr);break}lr-=Hu-xe.getDate()+1,xe.setDate(1),11>xn?xe.setMonth(xn+1):(xe.setMonth(0),xe.setFullYear(xe.getFullYear()+1))}return xn=new Date(xe.getFullYear()+1,0,4),lr=$r(new Date(xe.getFullYear(),0,4)),xn=$r(xn),0>=Pt(lr,xe)?0>=Pt(xn,xe)?xe.getFullYear()+1:xe.getFullYear():xe.getFullYear()-1}D>>>=0,V>>>=0,K>>>=0,re>>>=0;var Xo=n()[re+40>>>2>>>0];for(var ba in re={gb:r()[re>>>2>>>0],fb:r()[re+4>>>2>>>0],Va:r()[re+8>>>2>>>0],Ya:r()[re+12>>>2>>>0],Wa:r()[re+16>>>2>>>0],Ta:r()[re+20>>>2>>>0],Qa:r()[re+24>>>2>>>0],Sa:r()[re+28>>>2>>>0],nb:r()[re+32>>>2>>>0],eb:r()[re+36>>>2>>>0],hb:Xo?xs(Xo):""},K=xs(K),Xo={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})K=K.replace(new RegExp(ba,"g"),Xo[ba]);var JO="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),e3="January February March April May June July August September October November December".split(" ");for(ba in Xo={"%a":xe=>JO[xe.Qa].substring(0,3),"%A":xe=>JO[xe.Qa],"%b":xe=>e3[xe.Wa].substring(0,3),"%B":xe=>e3[xe.Wa],"%C":xe=>He((xe.Ta+1900)/100|0,2),"%d":xe=>He(xe.Ya,2),"%e":xe=>de(xe.Ya,2," "),"%g":xe=>wo(xe).toString().substring(2),"%G":wo,"%H":xe=>He(xe.Va,2),"%I":xe=>((xe=xe.Va)==0?xe=12:12<xe&&(xe-=12),He(xe,2)),"%j":xe=>{for(var lr=0,xn=0;xn<=xe.Wa-1;lr+=(cd(xe.Ta+1900)?$O:WO)[xn++]);return He(xe.Ya+lr,3)},"%m":xe=>He(xe.Wa+1,2),"%M":xe=>He(xe.fb,2),"%n":()=>`
`,"%p":xe=>0<=xe.Va&&12>xe.Va?"AM":"PM","%S":xe=>He(xe.gb,2),"%t":()=>"	","%u":xe=>xe.Qa||7,"%U":xe=>He(Math.floor((xe.Sa+7-xe.Qa)/7),2),"%V":xe=>{var lr=Math.floor((xe.Sa+7-(xe.Qa+6)%7)/7);if(2>=(xe.Qa+371-xe.Sa-2)%7&&lr++,lr)lr==53&&((xn=(xe.Qa+371-xe.Sa)%7)==4||xn==3&&cd(xe.Ta)||(lr=1));else{lr=52;var xn=(xe.Qa+7-xe.Sa-1)%7;(xn==4||xn==5&&cd(xe.Ta%400-1))&&lr++}return He(lr,2)},"%w":xe=>xe.Qa,"%W":xe=>He(Math.floor((xe.Sa+7-(xe.Qa+6)%7)/7),2),"%y":xe=>(xe.Ta+1900).toString().substring(2),"%Y":xe=>xe.Ta+1900,"%z":xe=>{var lr=0<=(xe=xe.eb);return xe=Math.abs(xe)/60,(lr?"+":"-")+("0000"+(xe/60*100+xe%60)).slice(-4)},"%Z":xe=>xe.hb,"%%":()=>"%"},K=K.replace(/%%/g,"\0\0"),Xo)K.includes(ba)&&(K=K.replace(new RegExp(ba,"g"),Xo[ba](re)));return ba=function(xe){var lr=Array(ub(xe)+1);return hb(xe,lr,0,lr.length),lr}(K=K.replace(/\0\0/g,"%")),ba.length>V?0:(mQ(ba,D),ba.length-1)}function gQ(D,V,K,re){return qO(D>>>0,V>>>0,K>>>0,re>>>0)}h||function(){for(var D=c.numThreads-1;D--;)Me();ue.unshift(()=>{Te++,function(V){h?V():Promise.all(qo.map(Oe)).then(V)}(()=>De())})}();var vQ=[Zr,ys,uo,Bu,db,pb,fb,mb,gb,vb,_b,bb,yb,xb,wb,Eb,Sb,zu,VO,zO,UO,HO,jO,GO],Qt=function(){function D(K,re){return Qt=K.exports,Qt=function(){var de=Qt,He=$r=>()=>$r()>>>0,Pt=$r=>wo=>$r(wo)>>>0;return(de=Object.assign({},de)).Ba=He(de.Ba),de.Ca=Pt(de.Ca),de.emscripten_main_runtime_thread_id=He(de.emscripten_main_runtime_thread_id),de.Oa=Pt(de.Oa),de.Pa=He(de.Pa),de}(),H.push(Qt.Ea),at=Qt.Fa,Ee.unshift(Qt.$),$=re,De(),Qt}var V=Kt();if(Te++,c.instantiateWasm)try{return c.instantiateWasm(V,D)}catch(K){S(`Module.instantiateWasm callback failed with error: ${K}`),s(K)}return Ne||=c.locateFile?Pe("ort-wasm-simd-threaded.wasm")?"ort-wasm-simd-threaded.wasm":c.locateFile?c.locateFile("ort-wasm-simd-threaded.wasm",b):b+"ort-wasm-simd-threaded.wasm":new URL("ort-wasm-simd-threaded.wasm",import.meta.url).href,function(K,re){var de=Ne;return y||typeof WebAssembly.instantiateStreaming!="function"||Pe(de)||Ke(de)||typeof fetch!="function"?bt(de,K,re):fetch(de,{credentials:"same-origin"}).then(He=>WebAssembly.instantiateStreaming(He,K).then(re,function(Pt){return S(`wasm streaming compile failed: ${Pt}`),S("falling back to ArrayBuffer instantiation"),bt(de,K,re)}))}(V,function(K){D(K.instance,K.module)}).catch(s),{}}();c._OrtInit=(D,V)=>(c._OrtInit=Qt.aa)(D,V),c._OrtGetLastError=(D,V)=>(c._OrtGetLastError=Qt.ba)(D,V),c._OrtCreateSessionOptions=(D,V,K,re,de,He,Pt,$r,wo,Xo)=>(c._OrtCreateSessionOptions=Qt.ca)(D,V,K,re,de,He,Pt,$r,wo,Xo),c._OrtAppendExecutionProvider=(D,V)=>(c._OrtAppendExecutionProvider=Qt.da)(D,V),c._OrtAddFreeDimensionOverride=(D,V,K)=>(c._OrtAddFreeDimensionOverride=Qt.ea)(D,V,K),c._OrtAddSessionConfigEntry=(D,V,K)=>(c._OrtAddSessionConfigEntry=Qt.fa)(D,V,K),c._OrtReleaseSessionOptions=D=>(c._OrtReleaseSessionOptions=Qt.ga)(D),c._OrtCreateSession=(D,V,K)=>(c._OrtCreateSession=Qt.ha)(D,V,K),c._OrtReleaseSession=D=>(c._OrtReleaseSession=Qt.ia)(D),c._OrtGetInputOutputCount=(D,V,K)=>(c._OrtGetInputOutputCount=Qt.ja)(D,V,K),c._OrtGetInputName=(D,V)=>(c._OrtGetInputName=Qt.ka)(D,V),c._OrtGetOutputName=(D,V)=>(c._OrtGetOutputName=Qt.la)(D,V),c._OrtFree=D=>(c._OrtFree=Qt.ma)(D),c._OrtCreateTensor=(D,V,K,re,de,He)=>(c._OrtCreateTensor=Qt.na)(D,V,K,re,de,He),c._OrtGetTensorData=(D,V,K,re,de)=>(c._OrtGetTensorData=Qt.oa)(D,V,K,re,de),c._OrtReleaseTensor=D=>(c._OrtReleaseTensor=Qt.pa)(D),c._OrtCreateRunOptions=(D,V,K,re)=>(c._OrtCreateRunOptions=Qt.qa)(D,V,K,re),c._OrtAddRunConfigEntry=(D,V,K)=>(c._OrtAddRunConfigEntry=Qt.ra)(D,V,K),c._OrtReleaseRunOptions=D=>(c._OrtReleaseRunOptions=Qt.sa)(D),c._OrtCreateBinding=D=>(c._OrtCreateBinding=Qt.ta)(D),c._OrtBindInput=(D,V,K)=>(c._OrtBindInput=Qt.ua)(D,V,K),c._OrtBindOutput=(D,V,K,re)=>(c._OrtBindOutput=Qt.va)(D,V,K,re),c._OrtClearBoundOutputs=D=>(c._OrtClearBoundOutputs=Qt.wa)(D),c._OrtReleaseBinding=D=>(c._OrtReleaseBinding=Qt.xa)(D),c._OrtRunWithBinding=(D,V,K,re,de)=>(c._OrtRunWithBinding=Qt.ya)(D,V,K,re,de),c._OrtRun=(D,V,K,re,de,He,Pt,$r)=>(c._OrtRun=Qt.za)(D,V,K,re,de,He,Pt,$r),c._OrtEndProfiling=D=>(c._OrtEndProfiling=Qt.Aa)(D);var zp=()=>(zp=Qt.Ba)();c._malloc=D=>(c._malloc=Qt.Ca)(D),c._free=D=>(c._free=Qt.Da)(D);var Ab,QE=(D,V,K,re,de,He)=>(QE=Qt.Ga)(D,V,K,re,de,He),XO=()=>(XO=Qt.Ha)(),YO=(D,V,K,re,de)=>(YO=Qt.Ia)(D,V,K,re,de),JE=D=>(JE=Qt.Ja)(D),Db=D=>(Db=Qt.Ka)(D),ZO=()=>(ZO=Qt.La)(),KO=(D,V)=>(KO=Qt.Ma)(D,V),Ib=D=>(Ib=Qt.Na)(D),eC=D=>(eC=Qt.Oa)(D),tC=()=>(tC=Qt.Pa)();function QO(){0<Te||(h?(a(c),h||je(Ee),startWorker(c)):(je(ue),0<Te||Ab||(Ab=!0,c.calledRun=!0,we||(h||je(Ee),a(c),h||je(ye)))))}return c.___start_em_js=822690,c.___stop_em_js=822751,c.stackSave=()=>tC(),c.stackRestore=D=>Ib(D),c.stackAlloc=D=>eC(D),c.UTF8ToString=xs,c.stringToUTF8=Vu,c.lengthBytesUTF8=ub,be=function D(){Ab||QO(),Ab||(be=D)},QO(),l})}),wK=xN,globalThis.self?.name==="em-pthread"&&xN()}),vg,$q,Wq,qq,wN,EK,Xq,CK,UE=Ce(()=>{"use strict";EO(),vg=import.meta.url??(typeof document<"u"?document.currentScript?.src:typeof self<"u"?self.location?.href:void 0),$q=typeof location>"u"?void 0:location.origin,Wq=(e,t)=>{try{let i=t??vg;return(i?new URL(e,i):new URL(e)).origin===$q}catch{return!1}},qq=e=>Qe(void 0,null,function*(){let t=yield(yield fetch(e,{credentials:"same-origin"})).blob();return URL.createObjectURL(t)}),wN=(WSe(),IE(bK)).default,EK=()=>Qe(void 0,null,function*(){if(!vg)throw new Error("Failed to load proxy worker: cannot determine the script source URL.");if(Wq(vg))return[void 0,wN()];let e=yield qq(vg);return[e,wN(e)]}),Xq=(qSe(),IE(xK)).default,CK=(e,t,i)=>Qe(void 0,null,function*(){return[void 0,Xq]})}),EN,CE,U_,CN,Yq,Zq,CO,Wo,Ag=Ce(()=>{"use strict";UE(),CE=!1,U_=!1,CN=!1,Yq=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},Zq=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},CO=e=>Qe(void 0,null,function*(){if(CE)return Promise.resolve();if(U_)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(CN)throw new Error("previous call to 'initializeWebAssembly()' failed.");U_=!0;let t=e.initTimeout,i=e.numThreads;if(!Zq())throw new Error("WebAssembly SIMD is not supported in the current environment.");let r=Yq();i>1&&!r&&(typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+i+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),e.numThreads=i=1);let n=e.wasmPaths,o=typeof n=="string"?n:void 0,a=n?.mjs,s=a?.href??a,c=n?.wasm,l=c?.href??c,d=e.wasmBinary,[u,h]=yield CK(s,o,i>1),p=!1,m=[];if(t>0&&m.push(new Promise(f=>{setTimeout(()=>{p=!0,f()},t)})),m.push(new Promise((f,g)=>{let v={numThreads:i};d?v.wasmBinary=d:(l||o)&&(v.locateFile=(_,b)=>l??(o??b)+_),h(v).then(_=>{U_=!1,CE=!0,EN=_,f(),u&&URL.revokeObjectURL(u)},_=>{U_=!1,CN=!0,g(_)})})),yield Promise.race(m),p)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)}),Wo=()=>{if(CE&&EN)return EN;throw new Error("WebAssembly is not initialized yet.")}}),_o,OE,$n,SO=Ce(()=>{"use strict";Ag(),_o=(e,t)=>{let i=Wo(),r=i.lengthBytesUTF8(e)+1,n=i._malloc(r);return i.stringToUTF8(e,n,r),t.push(n),n},OE=(e,t,i,r)=>{if(typeof e=="object"&&e!==null){if(i.has(e))throw new Error("Circular reference in options");i.add(e)}Object.entries(e).forEach(([n,o])=>{let a=t?t+n:n;if(typeof o=="object")OE(o,a+".",i,r);else if(typeof o=="string"||typeof o=="number")r(a,o.toString());else if(typeof o=="boolean")r(a,o?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof o}`)})},$n=e=>{let t=Wo(),i=t.stackSave();try{let r=t.stackAlloc(8);t._OrtGetLastError(r,r+4);let n=t.HEAP32[r/4],o=t.HEAPU32[r/4+1],a=o?t.UTF8ToString(o):"";throw new Error(`${e} ERROR_CODE: ${n}, ERROR_MESSAGE: ${a}`)}finally{t.stackRestore(i)}}}),SK,XSe=Ce(()=>{"use strict";Ag(),SO(),SK=e=>{let t=Wo(),i=0,r=[],n=e||{};try{if(e?.logSeverityLevel===void 0)n.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(e?.logVerbosityLevel===void 0)n.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);e?.terminate===void 0&&(n.terminate=!1);let o=0;return e?.tag!==void 0&&(o=_o(e.tag,r)),i=t._OrtCreateRunOptions(n.logSeverityLevel,n.logVerbosityLevel,!!n.terminate,o),i===0&&$n("Can't create run options."),e?.extra!==void 0&&OE(e.extra,"",new WeakSet,(a,s)=>{let c=_o(a,r),l=_o(s,r);t._OrtAddRunConfigEntry(i,c,l)!==0&&$n(`Can't set a run config entry: ${a} - ${s}.`)}),[i,r]}catch(o){throw i!==0&&t._OrtReleaseRunOptions(i),r.forEach(a=>t._free(a)),o}}}),Kq,Qq,Jq,eX,TK,YSe=Ce(()=>{"use strict";Ag(),SO(),Kq=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},Qq=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},Jq=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(i=>(typeof i=="string"?i:i.name)==="webgpu")&&(e.enableMemPattern=!1)},eX=(e,t,i)=>{for(let r of t){let n=typeof r=="string"?r:r.name;switch(n){case"webnn":if(n="WEBNN",typeof r!="string"){let a=r?.deviceType;if(a){let s=_o("deviceType",i),c=_o(a,i);Wo()._OrtAddSessionConfigEntry(e,s,c)!==0&&$n(`Can't set a session config entry: 'deviceType' - ${a}.`)}}break;case"webgpu":if(n="JS",typeof r!="string"){let a=r;if(a?.preferredLayout){if(a.preferredLayout!=="NCHW"&&a.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${a.preferredLayout}`);let s=_o("preferredLayout",i),c=_o(a.preferredLayout,i);Wo()._OrtAddSessionConfigEntry(e,s,c)!==0&&$n(`Can't set a session config entry: 'preferredLayout' - ${a.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${n}`)}let o=_o(n,i);Wo()._OrtAppendExecutionProvider(e,o)!==0&&$n(`Can't append execution provider: ${n}.`)}},TK=e=>{let t=Wo(),i=0,r=[],n=e||{};Jq(n);try{let o=Kq(n.graphOptimizationLevel??"all"),a=Qq(n.executionMode??"sequential"),s=typeof n.logId=="string"?_o(n.logId,r):0,c=n.logSeverityLevel??2;if(!Number.isInteger(c)||c<0||c>4)throw new Error(`log serverity level is not valid: ${c}`);let l=n.logVerbosityLevel??0;if(!Number.isInteger(l)||l<0||l>4)throw new Error(`log verbosity level is not valid: ${l}`);let d=typeof n.optimizedModelFilePath=="string"?_o(n.optimizedModelFilePath,r):0;if(i=t._OrtCreateSessionOptions(o,!!n.enableCpuMemArena,!!n.enableMemPattern,a,!!n.enableProfiling,0,s,c,l,d),i===0&&$n("Can't create session options."),n.executionProviders&&eX(i,n.executionProviders,r),n.enableGraphCapture!==void 0){if(typeof n.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${n.enableGraphCapture}`);let u=_o("enableGraphCapture",r),h=_o(n.enableGraphCapture.toString(),r);t._OrtAddSessionConfigEntry(i,u,h)!==0&&$n(`Can't set a session config entry: 'enableGraphCapture' - ${n.enableGraphCapture}.`)}if(n.freeDimensionOverrides)for(let[u,h]of Object.entries(n.freeDimensionOverrides)){if(typeof u!="string")throw new Error(`free dimension override name must be a string: ${u}`);if(typeof h!="number"||!Number.isInteger(h)||h<0)throw new Error(`free dimension override value must be a non-negative integer: ${h}`);let p=_o(u,r);t._OrtAddFreeDimensionOverride(i,p,h)!==0&&$n(`Can't set a free dimension override: ${u} - ${h}.`)}return n.extra!==void 0&&OE(n.extra,"",new WeakSet,(u,h)=>{let p=_o(u,r),m=_o(h,r);t._OrtAddSessionConfigEntry(i,p,m)!==0&&$n(`Can't set a session config entry: ${u} - ${h}.`)}),[i,r]}catch(o){throw i!==0&&t._OrtReleaseSessionOptions(i),r.forEach(a=>t._free(a)),o}}}),lO,AK,cO,DK,IK,TO,MK,kK=Ce(()=>{"use strict";lO=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},AK=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},cO=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],DK=e=>{switch(e){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},IK=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},TO=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint8"||e==="bool",MK=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${e}`)}}}),AO,PK=Ce(()=>{"use strict";EO(),AO=e=>Qe(void 0,null,function*(){if(typeof e=="string")if(0)try{}catch(o){if(o.code==="ERR_FS_FILE_TOO_LARGE")try{for(var t=Ist(s),i,r,n;i=!(r=yield t.next()).done;i=!1){let l=r.value;;}}catch(r){n=[r]}finally{try{i&&(r=t.return)&&(yield r.call(t))}finally{if(n)throw n[0]}}}else{let o=yield fetch(e);if(!o.ok)throw new Error(`failed to load external data file: ${e}`);let a=o.headers.get("Content-Length"),s=a?parseInt(a,10):0;if(s<1073741824)return new Uint8Array(yield o.arrayBuffer());{if(!o.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let c=o.body.getReader(),l;try{l=new ArrayBuffer(s)}catch(u){if(u instanceof RangeError){let h=Math.ceil(s/65536);l=new WebAssembly.Memory({initial:h,maximum:h}).buffer}else throw u}let d=0;for(;;){let{done:u,value:h}=yield c.read();if(u)break;let p=h.byteLength;new Uint8Array(l,d,p).set(h),d+=p}return new Uint8Array(l,0,s)}}else return e instanceof Blob?new Uint8Array(yield e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)})}),tX,DO,IO,Mp,iX,RE,MO,kO,SN,PO,NO,OO,NK=Ce(()=>{"use strict";XSe(),YSe(),kK(),Ag(),SO(),PK(),tX=(e,t)=>{Wo()._OrtInit(e,t)!==0&&$n("Can't initialize onnxruntime.")},DO=e=>Qe(void 0,null,function*(){tX(e.wasm.numThreads,IK(e.logLevel))}),IO=(e,t)=>Qe(void 0,null,function*(){}),Mp=new Map,iX=e=>{let t=Wo(),i=t.stackSave();try{let r=t.stackAlloc(8);return t._OrtGetInputOutputCount(e,r,r+4)!==0&&$n("Can't get session input/output count."),[t.HEAP32[r/4],t.HEAP32[r/4+1]]}finally{t.stackRestore(i)}},RE=e=>{let t=Wo(),i=t._malloc(e.byteLength);if(i===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,i),[i,e.byteLength]},MO=(e,t)=>Qe(void 0,null,function*(){let i,r,n=Wo();Array.isArray(e)?[i,r]=e:e.buffer===n.HEAPU8.buffer?[i,r]=[e.byteOffset,e.byteLength]:[i,r]=RE(e);let o=0,a=0,s=0,c=[],l=[],d=[];try{if([a,c]=TK(t),t?.externalData&&n.mountExternalData){let _=[];for(let b of t.externalData){let y=typeof b=="string"?b:b.path;_.push(AO(typeof b=="string"?b:b.data).then(x=>{n.mountExternalData(y,x)}))}yield Promise.all(_)}for(let _ of t?.executionProviders??[])if((typeof _=="string"?_:_.name)==="webnn"){if(n.currentContext)throw new Error("WebNN execution provider is already set.");if(typeof _!="string"){let b=_,y=b?.context,x=b?.gpuDevice,w=b?.deviceType,I=b?.numThreads,S=b?.powerPreference;y?n.currentContext=y:x?n.currentContext=yield navigator.ml.createContext(x):n.currentContext=yield navigator.ml.createContext({deviceType:w,numThreads:I,powerPreference:S})}else n.currentContext=yield navigator.ml.createContext();break}o=yield n._OrtCreateSession(i,r,a),o===0&&$n("Can't create a session."),n.currentContext&&(n.currentContext=void 0);let[u,h]=iX(o),p=!!t?.enableGraphCapture,m=[],f=[],g=[];for(let _=0;_<u;_++){let b=n._OrtGetInputName(o,_);b===0&&$n("Can't get an input name."),l.push(b),m.push(n.UTF8ToString(b))}for(let _=0;_<h;_++){let b=n._OrtGetOutputName(o,_);b===0&&$n("Can't get an output name."),d.push(b);let y=n.UTF8ToString(b);f.push(y)}return Mp.set(o,[o,l,d,null,p,!1]),[o,m,f]}catch(u){throw l.forEach(h=>n._OrtFree(h)),d.forEach(h=>n._OrtFree(h)),s!==0&&n._OrtReleaseBinding(s),o!==0&&n._OrtReleaseSession(o),u}finally{n._free(i),a!==0&&n._OrtReleaseSessionOptions(a),c.forEach(u=>n._free(u)),n.unmountExternalData?.()}}),kO=e=>{let t=Wo(),i=Mp.get(e);if(!i)throw new Error(`cannot release session. invalid session id: ${e}`);let[r,n,o,a,s]=i;a&&(s&&t._OrtClearBoundOutputs(a.handle),t._OrtReleaseBinding(a.handle)),t.jsepOnReleaseSession?.(e),n.forEach(c=>t._OrtFree(c)),o.forEach(c=>t._OrtFree(c)),t._OrtReleaseSession(r),Mp.delete(e)},SN=(e,t,i,r,n,o=!1)=>{if(!e){t.push(0);return}let a=Wo(),s=e[0],c=e[1],l=e[3],d,u;if(s==="string"&&l==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(o&&l!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${n} when enableGraphCapture is true.`);if(l==="gpu-buffer"){let m=e[2].gpuBuffer,f=cO(lO(s));u=c.reduce((v,_)=>v*_,1)*f;let g=a.jsepRegisterBuffer;if(!g)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');d=g(r,n,m,u)}else{let m=e[2];if(Array.isArray(m)){u=4*m.length,d=a._malloc(u),i.push(d);let f=d/4;for(let g=0;g<m.length;g++){if(typeof m[g]!="string")throw new TypeError(`tensor data at index ${g} is not a string`);a.HEAPU32[f++]=_o(m[g],i)}}else u=m.byteLength,d=a._malloc(u),i.push(d),a.HEAPU8.set(new Uint8Array(m.buffer,m.byteOffset,u),d)}let h=a.stackSave(),p=a.stackAlloc(4*c.length);try{let m=p/4;c.forEach(g=>a.HEAP32[m++]=g);let f=a._OrtCreateTensor(lO(s),d,u,p,c.length,MK(l));f===0&&$n(`Can't create tensor for input/output. session=${r}, index=${n}.`),t.push(f)}finally{a.stackRestore(h)}},PO=(e,t,i,r,n,o)=>Qe(void 0,null,function*(){let a=Wo(),s=Mp.get(e);if(!s)throw new Error(`cannot run inference. invalid session id: ${e}`);let c=s[0],l=s[1],d=s[2],u=s[3],h=s[4],p=s[5],m=t.length,f=r.length,g=0,v=[],_=[],b=[],y=[],x=a.stackSave(),w=a.stackAlloc(m*4),I=a.stackAlloc(m*4),S=a.stackAlloc(f*4),E=a.stackAlloc(f*4);try{[g,v]=SK(o);for(let B=0;B<m;B++)SN(i[B],_,y,e,t[B],h);for(let B=0;B<f;B++)SN(n[B],b,y,e,m+r[B],h);let N=w/4,M=I/4,P=S/4,$=E/4;for(let B=0;B<m;B++)a.HEAPU32[N++]=_[B],a.HEAPU32[M++]=l[t[B]];for(let B=0;B<f;B++)a.HEAPU32[P++]=b[B],a.HEAPU32[$++]=d[r[B]];a.jsepOnRunStart?.(c);let R;R=yield a._OrtRun(c,I,w,m,E,f,S,g),R!==0&&$n("failed to call OrtRun().");let j=[];for(let B=0;B<f;B++){let te=a.HEAPU32[S/4+B];if(te===b[B]){j.push(n[B]);continue}let Z=a.stackSave(),ne=a.stackAlloc(4*4),se=!1,we,ie=0;try{a._OrtGetTensorData(te,ne,ne+4,ne+8,ne+12)!==0&&$n(`Can't access output tensor data on index ${B}.`);let ue=ne/4,Ee=a.HEAPU32[ue++];ie=a.HEAPU32[ue++];let ye=a.HEAPU32[ue++],Te=a.HEAPU32[ue++],pe=[];for(let fe=0;fe<Te;fe++)pe.push(a.HEAPU32[ye/4+fe]);a._OrtFree(ye);let be=pe.reduce((fe,Ne)=>fe*Ne,1);we=AK(Ee);let De=u?.outputPreferredLocations[r[B]];if(we==="string"){if(De==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let fe=[],Ne=ie/4;for(let Pe=0;Pe<be;Pe++){let Ke=a.HEAPU32[Ne++],At=Pe===be-1?void 0:a.HEAPU32[Ne]-Ke;fe.push(a.UTF8ToString(Ke,At))}j.push([we,pe,fe,"cpu"])}else if(De==="gpu-buffer"&&be>0){let fe=a.jsepGetBuffer;if(!fe)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let Ne=fe(ie),Pe=cO(Ee);if(Pe===void 0||!TO(we))throw new Error(`Unsupported data type: ${we}`);se=!0,j.push([we,pe,{gpuBuffer:Ne,download:a.jsepCreateDownloader(Ne,be*Pe,we),dispose:()=>{a._OrtReleaseTensor(te)}},"gpu-buffer"])}else{let fe=DK(we),Ne=new fe(be);new Uint8Array(Ne.buffer,Ne.byteOffset,Ne.byteLength).set(a.HEAPU8.subarray(ie,ie+Ne.byteLength)),j.push([we,pe,Ne,"cpu"])}}finally{a.stackRestore(Z),we==="string"&&ie&&a._free(ie),se||a._OrtReleaseTensor(te)}}return u&&!h&&(a._OrtClearBoundOutputs(u.handle),Mp.set(e,[c,l,d,u,h,!1])),j}finally{a.stackRestore(x),_.forEach(N=>a._OrtReleaseTensor(N)),b.forEach(N=>a._OrtReleaseTensor(N)),y.forEach(N=>a._free(N)),g!==0&&a._OrtReleaseRunOptions(g),v.forEach(N=>a._free(N))}}),NO=e=>{let t=Wo(),i=Mp.get(e);if(!i)throw new Error("invalid session id");let r=i[0],n=t._OrtEndProfiling(r);n===0&&$n("Can't get an profile file name."),t._OrtFree(n)},OO=e=>{let t=[];for(let i of e){let r=i[2];!Array.isArray(r)&&"buffer"in r&&t.push(r.buffer)}return t}}),Pu,tl,gg,H_,j_,SE,TN,TE,kp,Pp,rX,OK,RK,FK,LK,BK,VK,zK,UK=Ce(()=>{"use strict";fc(),NK(),Ag(),UE(),Pu=()=>!!Ii.wasm.proxy&&typeof document<"u",gg=!1,H_=!1,j_=!1,TE=new Map,kp=(e,t)=>{let i=TE.get(e);i?i.push(t):TE.set(e,[t])},Pp=()=>{if(gg||!H_||j_||!tl)throw new Error("worker not ready")},rX=e=>{switch(e.data.type){case"init-wasm":gg=!1,e.data.err?(j_=!0,TN[1](e.data.err)):(H_=!0,TN[0]()),SE&&(URL.revokeObjectURL(SE),SE=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let t=TE.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out);break}default:}},OK=()=>Qe(void 0,null,function*(){if(!H_){if(gg)throw new Error("multiple calls to 'initWasm()' detected.");if(j_)throw new Error("previous call to 'initWasm()' failed.");if(gg=!0,Pu())return new Promise((e,t)=>{tl?.terminate(),EK().then(([i,r])=>{try{tl=r,tl.onerror=o=>t(o),tl.onmessage=rX,TN=[e,t];let n={type:"init-wasm",in:Ii};tl.postMessage(n),SE=i}catch(n){t(n)}},t)});try{yield CO(Ii.wasm),yield DO(Ii),H_=!0}catch(e){throw j_=!0,e}finally{gg=!1}}}),RK=e=>Qe(void 0,null,function*(){if(Pu())return Pp(),new Promise((t,i)=>{kp("init-ep",[t,i]);let r={type:"init-ep",in:{epName:e,env:Ii}};tl.postMessage(r)});yield IO(Ii,e)}),FK=e=>Qe(void 0,null,function*(){return Pu()?(Pp(),new Promise((t,i)=>{kp("copy-from",[t,i]);let r={type:"copy-from",in:{buffer:e}};tl.postMessage(r,[e.buffer])})):RE(e)}),LK=(e,t)=>Qe(void 0,null,function*(){if(Pu()){if(t?.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return Pp(),new Promise((i,r)=>{kp("create",[i,r]);let n={type:"create",in:{model:e,options:L({},t)}},o=[];e instanceof Uint8Array&&o.push(e.buffer),tl.postMessage(n,o)})}else return MO(e,t)}),BK=e=>Qe(void 0,null,function*(){if(Pu())return Pp(),new Promise((t,i)=>{kp("release",[t,i]);let r={type:"release",in:e};tl.postMessage(r)});kO(e)}),VK=(e,t,i,r,n,o)=>Qe(void 0,null,function*(){if(Pu()){if(i.some(a=>a[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(n.some(a=>a))throw new Error("pre-allocated output tensor is not supported for proxy.");return Pp(),new Promise((a,s)=>{kp("run",[a,s]);let c=i,l={type:"run",in:{sessionId:e,inputIndices:t,inputs:c,outputIndices:r,options:o}};tl.postMessage(l,OO(c))})}else return PO(e,t,i,r,n,o)}),zK=e=>Qe(void 0,null,function*(){if(Pu())return Pp(),new Promise((t,i)=>{kp("end-profiling",[t,i]);let r={type:"end-profiling",in:e};tl.postMessage(r)});NO(e)})}),AN,nX,HK,ZSe=Ce(()=>{"use strict";fc(),UK(),kK(),EO(),PK(),AN=(e,t)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];default:throw new Error(`invalid data location: ${e.location} for ${t()}`)}},nX=e=>{switch(e[3]){case"cpu":return new bo(e[0],e[2],e[1]);case"gpu-buffer":{let t=e[0];if(!TO(t))throw new Error(`not supported data type: ${t} for deserializing GPU tensor`);let{gpuBuffer:i,download:r,dispose:n}=e[2];return bo.fromGpuBuffer(i,{dataType:t,dims:e[1],download:r,dispose:n})}default:throw new Error(`invalid data location: ${e[3]}`)}},HK=class{fetchModelAndCopyToWasmMemory(e){return Qe(this,null,function*(){return FK(yield AO(e))})}loadModel(e,t){return Qe(this,null,function*(){yg();let i;typeof e=="string"?i=yield this.fetchModelAndCopyToWasmMemory(e):i=e,[this.sessionId,this.inputNames,this.outputNames]=yield LK(i,t),xg()})}dispose(){return Qe(this,null,function*(){return BK(this.sessionId)})}run(e,t,i){return Qe(this,null,function*(){yg();let r=[],n=[];Object.entries(e).forEach(u=>{let h=u[0],p=u[1],m=this.inputNames.indexOf(h);if(m===-1)throw new Error(`invalid input '${h}'`);r.push(p),n.push(m)});let o=[],a=[];Object.entries(t).forEach(u=>{let h=u[0],p=u[1],m=this.outputNames.indexOf(h);if(m===-1)throw new Error(`invalid output '${h}'`);o.push(p),a.push(m)});let s=r.map((u,h)=>AN(u,()=>`input "${this.inputNames[n[h]]}"`)),c=o.map((u,h)=>u?AN(u,()=>`output "${this.outputNames[a[h]]}"`):null),l=yield VK(this.sessionId,n,s,a,c,i),d={};for(let u=0;u<l.length;u++)d[this.outputNames[a[u]]]=o[u]??nX(l[u]);return xg(),d})}startProfiling(){}endProfiling(){zK(this.sessionId)}}}),oX,jK,KSe=Ce(()=>{"use strict";fc(),UK(),ZSe(),UE(),oX=()=>{if((typeof Ii.wasm.initTimeout!="number"||Ii.wasm.initTimeout<0)&&(Ii.wasm.initTimeout=0),Ii.wasm.simd===!1&&console.warn('Deprecated property "env.wasm.simd" is set to false. non-SIMD build is no longer provided, and this setting will be ignored.'),typeof Ii.wasm.proxy!="boolean"&&(Ii.wasm.proxy=!1),typeof Ii.wasm.trace!="boolean"&&(Ii.wasm.trace=!1),typeof Ii.wasm.numThreads!="number"||!Number.isInteger(Ii.wasm.numThreads)||Ii.wasm.numThreads<=0)if(typeof self<"u"&&!self.crossOriginIsolated)Ii.wasm.numThreads=1;else{let e=typeof navigator>"u"?J2e("node:os").cpus().length:navigator.hardwareConcurrency;Ii.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}},jK=class{init(e){return Qe(this,null,function*(){oX(),yield OK(),yield RK(e)})}createInferenceSessionHandler(e,t){return Qe(this,null,function*(){let i=new HK;return yield i.loadModel(e,t),Promise.resolve(i)})}}}),GK={};ob(GK,{wasmBackend:()=>$K});var $K,QSe=Ce(()=>{"use strict";KSe(),$K=new jK});fc();fc();fc();var JSe="1.19.2",Mst=CX;{let e=($Se(),IE(vK)).onnxjsBackend;tb("webgl",e,-10)}{let e=(QSe(),IE(GK)).wasmBackend;tb("cpu",e,10),tb("wasm",e,10)}Object.defineProperty(Ii.versions,"web",{value:JSe,enumerable:!0});var tTe=["drawCanvas"],iTe=["drawCanvas2"];function rTe(e,t){if(e&1&&(C(0,"div",15),W(1),C(2,"p",16),W(3),B3(4,"number"),A()()),e&2){let i=t.$implicit,r=t.index;li("height",i*100,"%"),O(),Qr(" ",r," "),O(2),Pr(V3(4,4,i,"1.1-1"))}}var WK=(()=>{class e extends Fo{canvas;canvas2;session;isready=!1;probas=new Array(10).fill(0);maxProba=0;predictedDigit=0;ngOnInit(){this.load_sessions()}load_sessions(){return Qe(this,null,function*(){this.session=yield LE.create("assets/models/onnx_model.onnx"),this.isready=!0})}onDrawingEnded(i){return Qe(this,null,function*(){if(this.canvas2.drawArray(this.canvas.getArray()),!this.isready)return;let r=this.canvas.getArray(),n=[];for(let c=0;c<r.length;c+=4)n.push(r[c]/255);let o=new Float32Array(n),a=new bo("float32",o,[1,1,28,28]),s=yield this.session.run({"input.1":a});this.probas=[],this.maxProba=0;for(let c=0;c<s[27].data.length;c++)this.probas.push(s[27].data[c]),this.maxProba=Math.max(this.maxProba,s[27].data[c]),this.maxProba===s[27].data[c]&&(this.predictedDigit=c);this.cdr.detectChanges()})}static \u0275fac=(()=>{let i;return function(n){return(i||(i=Ar(e)))(n||e)}})();static \u0275cmp=Le({type:e,selectors:[["app-cnn"]],viewQuery:function(r,n){if(r&1&&(ht(tTe,5),ht(iTe,5)),r&2){let o;Ve(o=ze())&&(n.canvas=o.first),Ve(o=ze())&&(n.canvas2=o.first)}},features:[Yt],decls:22,vars:16,consts:[["antialiased",""],["brushSize",""],["drawCanvas",""],["drawCanvas2",""],[3,"rightDrawer","leftDrawer"],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["color","primary"],[3,"title","min","max","step","value"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],[1,"flex","flex-col","items-center","gap-3"],[1,"w-[512px]","aspect-square","crisp-edges","border-2","border-gray-500",3,"drawingEnded","antialiasing","brushRadius","width","OnlyBW"],["mat-raised-button","","color","primary",3,"click"],[1,"w-[28px]","aspect-square","crisp-edges","border-2","border-gray-500",3,"brushRadius","drawable","width"],[1,"flex","flex-row","gap-1","h-[64px]","border"],["class","w-[24px] h-[64px] bg-green-500 text-white text-center",3,"height",4,"ngFor","ngForOf"],[1,"w-[24px]","h-[64px]","bg-green-500","text-white","text-center"],[1,"border"]],template:function(r,n){if(r&1){let o=Ze();C(0,"app-tutorial-template",4),Ot(1,5),C(2,"mat-checkbox",6,0),W(4,"Use antialiasing"),A(),he(5,"app-labelled-sliders",7,1),Rt(),Ot(7,8),C(8,"div",9)(9,"app-draw-canvas",10,2),Y("drawingEnded",function(s){return q(o),X(n.onDrawingEnded(s))}),A(),C(11,"button",11),Y("click",function(){q(o);let s=Ft(10);return X(s.clearCanvas())}),W(12,"Clear"),A(),C(13,"i"),W(14,'What the network "sees":'),A(),he(15,"app-draw-canvas",12,3),C(17,"div",13),Be(18,rTe,5,7,"div",14),A(),C(19,"h2"),W(20),A()(),Rt(),W(21," MNIST Demo "),A()}if(r&2){let o=Ft(3),a=Ft(6);z("rightDrawer",!1)("leftDrawer",!0),O(5),z("title","Brush size")("min",1)("max",10)("step",1)("value",1),O(4),z("antialiasing",o.checked)("brushRadius",a.value)("width",28)("OnlyBW",!0),O(6),z("brushRadius",1)("drawable",!1)("width",28),O(3),z("ngForOf",n.probas),O(2),Qr("Digit: ",n.predictedDigit,"")}},dependencies:[Au,Xn,on,Vo,Mr,zo,eR],styles:[".crisp-edges[_ngcontent-%COMP%]{image-rendering:crisp-edges}"]})}return e})();var nTe=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:y9},{path:"fourierTransform",component:_j},{path:"spatialFiltering",component:m7},{path:"colorspaces",component:pj},{path:"morphology",component:l7},{path:"histogram",component:bj},{path:"weightLoss",component:Y$},{path:"sampling",component:h7},{path:"spectralFiltering",component:g7},{path:"PSNR",component:_7},{path:"gradientDescent",component:w7},{path:"optimizer",component:E7},{path:"PCA",component:C7},{path:"regression",component:S7},{path:"CNN",component:WK}],qK=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=rt({type:e});static \u0275inj=it({imports:[qI.forRoot(nTe),qI]})}return e})();var XK=(()=>{class e{title="cv-toolbox";static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Le({type:e,selectors:[["app-root"]],decls:6,vars:0,consts:[[1,"hide-smallscreen"],["routerLink","/home"]],template:function(r,n){r&1&&(C(0,"mat-toolbar",0)(1,"h1")(2,"a",1),W(3," Home"),A()()(),C(4,"div"),he(5,"router-outlet"),A())},dependencies:[Xm,zI,fu],styles:["a[_ngcontent-%COMP%]{color:inherit;text-decoration:inherit}h1[_ngcontent-%COMP%]{text-align:center;width:100%}"]})}return e})();var oTe=(()=>{class e extends Zb{constructor(i,r,n){super(i,r,n,Je(Lb,{optional:!0}))}ngOnDestroy(){this.flush()}static{this.\u0275fac=function(r){return new(r||e)(Ae(Bt),Ae(Ug),Ae(Yb))}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac})}}return e})();function aTe(){return new _R}function sTe(e,t,i){return new yR(e,t,i)}var ZK=[{provide:Yb,useFactory:aTe},{provide:Zb,useClass:oTe},{provide:Xp,useFactory:sTe,deps:[Qp,Zb,st]}],YK=[{provide:Ug,useFactory:()=>new bR},{provide:pr,useValue:"BrowserAnimations"},...ZK],lTe=[{provide:Ug,useClass:vR},{provide:pr,useValue:"NoopAnimations"},...ZK],KK=(()=>{class e{static withConfig(i){return{ngModule:e,providers:i.disableAnimations?lTe:YK}}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({providers:YK,imports:[ey]})}}return e})();var QK=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[gM,Ut,gM,Ut]})}}return e})();var JK=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[K1,To,Ut,Kc,_M,mE]})}}return e})();var eQ=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=rt({type:e})}static{this.\u0275inj=it({imports:[Ut,To,Ut]})}}return e})();var cTe="@",dTe=(()=>{class e{constructor(i,r,n,o,a){this.doc=i,this.delegate=r,this.zone=n,this.animationType=o,this.moduleImpl=a,this._rendererFactoryPromise=null,this.scheduler=Je(Lb,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-LEWMQU24.js")).catch(r=>{throw new Tr(5300,!1)}).then(({\u0275createEngine:r,\u0275AnimationRendererFactory:n})=>{this._engine=r(this.animationType,this.doc,this.scheduler);let o=new n(this.delegate,this._engine,this.zone);return this.delegate=o,o})}createRenderer(i,r){let n=this.delegate.createRenderer(i,r);if(n.\u0275type===0)return n;typeof n.throwOnSyntheticProps=="boolean"&&(n.throwOnSyntheticProps=!1);let o=new RO(n);return r?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(a=>{let s=a.createRenderer(i,r);o.use(s)}).catch(a=>{o.use(n)}),o}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static{this.\u0275fac=function(r){$p()}}static{this.\u0275prov=tt({token:e,factory:e.\u0275fac})}}return e})(),RO=class{constructor(t){this.delegate=t,this.replay=[],this.\u0275type=1}use(t){if(this.delegate=t,this.replay!==null){for(let i of this.replay)i(t);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(t,i){return this.delegate.createElement(t,i)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}get destroyNode(){return this.delegate.destroyNode}appendChild(t,i){this.delegate.appendChild(t,i)}insertBefore(t,i,r,n){this.delegate.insertBefore(t,i,r,n)}removeChild(t,i,r){this.delegate.removeChild(t,i,r)}selectRootElement(t,i){return this.delegate.selectRootElement(t,i)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,i,r,n){this.delegate.setAttribute(t,i,r,n)}removeAttribute(t,i,r){this.delegate.removeAttribute(t,i,r)}addClass(t,i){this.delegate.addClass(t,i)}removeClass(t,i){this.delegate.removeClass(t,i)}setStyle(t,i,r,n){this.delegate.setStyle(t,i,r,n)}removeStyle(t,i,r){this.delegate.removeStyle(t,i,r)}setProperty(t,i,r){this.shouldReplay(i)&&this.replay.push(n=>n.setProperty(t,i,r)),this.delegate.setProperty(t,i,r)}setValue(t,i){this.delegate.setValue(t,i)}listen(t,i,r){return this.shouldReplay(i)&&this.replay.push(n=>n.listen(t,i,r)),this.delegate.listen(t,i,r)}shouldReplay(t){return this.replay!==null&&t.startsWith(cTe)}};function tQ(e="animations"){return fC("NgAsyncAnimations"),Fb([{provide:Xp,useFactory:(t,i,r)=>new dTe(t,i,r,e),deps:[Bt,Qp,st]},{provide:pr,useValue:e==="noop"?"NoopAnimations":"BrowserAnimations"}])}var uTe={openCVDirPath:"assets/opencv"},iQ=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=rt({type:e,bootstrap:[XK]});static \u0275inj=it({providers:[tQ(),p3(q1.forRoot(uTe))],imports:[e8.forRoot({echarts:()=>import("./chunk-AQ6M336A.js")}),u7,eQ,cj,EH,vj,To,MU,fp,IU,DH,o7,PH,JK,mE,ZH,JH,oj,QK,aj,ey,VH,$H,qK,KK]})}return e})();Ii.wasm.wasmPaths={wasm:"assets/models/ort-wasm-simd-threaded.wasm",mjs:"assets/models/ort-wasm-simd-threaded-simd.mjs"};OR().bootstrapModule(iQ,{ngZoneEventCoalescing:!0}).catch(e=>console.error(e));
