import{$ as Ee,C as hI,E as mI,F as pI,J as r0,P as jp,S as en,T as fI,U as $i,V as Ci,W as n0,X as Qa,Z as qr,_ as Sa,aa as Id,f as Ss,fa as gI,g as uI,ga as vI,h as Md,ha as _I,i as ac,ia as Xw,ja as bI,k as oc,ka as xI,l as Eo,la as yI,m as Pr,n as As,o as Rr,q as i0}from"./chunk-5UGS3ATR.js";import{$ as yM,$a as sh,$b as Pt,A as ec,Aa as yd,Ab as GM,Ac as iI,B as tc,Ba as nt,Bb as S,Bc as rI,C as nh,Ca as Pe,Cb as A,Cc as yt,D as Rw,Da as wd,Db as ae,Dc as nI,E as Br,Ea as AM,Eb as At,Ec as Gp,F as Op,Fa as Vp,Fb as Tt,Fc as aI,G as _d,Ga as TM,Gb as uh,Gc as oI,H as bd,Ha as ll,Hb as Ue,Hc as Td,I as ic,Ia as zi,Ib as Cs,Ic as sI,J as Fw,Ja as zp,Jb as jM,Jc as Es,K as gM,Ka as ah,Kb as q,Kc as Fn,L as Ow,La as oh,Lb as WM,Lc as cn,M as vM,Ma as DM,Mb as J,Mc as e0,N as _M,Na as MM,Nb as ti,Nc as Dd,O as Lw,Oa as IM,Ob as it,Oc as On,P as jv,Pa as kM,Pb as Si,Pc as lI,Q as wa,Qa as NM,Qb as tt,Qc as t0,R as Wr,Ra as PM,Rb as Me,Rc as $w,S as yi,Sa as RM,Sb as Ie,Sc as cI,T as bM,Ta as Ka,Tb as kt,Tc as dI,U as Tr,Ua as FM,Ub as G,Uc as Ts,V as xM,Va as OM,Vb as gr,Vc as os,W as Ji,Wa as LM,Wb as Vr,Wc as ta,X as rc,Xa as zw,Xb as qM,Xc as So,Y as Jn,Ya as Up,Yb as $M,Yc as Ao,Z as He,Za as P,Zb as Nt,Zc as wI,_ as Ge,_a as z,_b as Dt,_c as CI,a as Nr,aa as Be,ab as lh,ac as _i,b as mM,ba as Bw,bb as $v,bc as Xt,c as ns,ca as he,cb as ch,cc as cl,d as Iw,da as Ve,db as dh,dc as Cd,e as zv,ea as wM,eb as Hp,ec as hh,ed as EI,f as ut,fa as Wv,fb as Uw,fc as Ed,fd as Wp,g as Nn,ga as Vw,gb as Xe,gc as XM,gd as a0,h as kw,ha as Lp,hb as Hw,hc as Yv,i as pM,ia as de,ib as as,ic as YM,j as Co,ja as Ae,jb as Gw,jc as Zv,k as Pn,ka as je,kb as BM,kc as Kv,l as pt,la as lt,lb as Ot,lc as Ww,ld as SI,m as vd,ma as qv,mb as wi,mc as Qv,md as o0,n as Uv,na as CM,nb as VM,nc as qw,o as fM,oa as EM,ob as jw,oc as ZM,od as AI,p as Rt,pa as xd,pb as zM,pc as Sd,q as rh,qa as nc,qb as Te,qc as Jv,r as Za,ra as ir,rb as Ft,rc as KM,s as Nw,sa as j,sb as O,sc as Vt,t as Hv,ta as W,tb as ei,tc as QM,td as TI,u as Fp,ua as Ca,ub as ft,uc as JM,v as Gv,va as Bp,vb as yr,vc as ot,w as ya,wa as sr,wb as Xv,wc as Dr,x as Rn,xa as ea,xb as fi,xc as eI,y as Mi,ya as SM,yb as UM,yc as tI,z as Pw,za as Ea,zb as HM,zc as Ad}from"./chunk-4SYVKDQZ.js";import{a as Z,b as Bt,d as x9,f as hM,g as sl,h as Mw}from"./chunk-27YXBSBS.js";var xT=x9((_T,bT)=>{"use strict";(function(e,t){typeof _T=="object"&&typeof bT<"u"?bT.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self,e["'typed'"]=t())})(_T,function(){"use strict";function e(){return!0}function t(){return!1}function i(){}let r="Argument is not a typed-function.";function n(){function o(B){return typeof B=="object"&&B!==null&&B.constructor===Object}let s=[{name:"number",test:function(B){return typeof B=="number"}},{name:"string",test:function(B){return typeof B=="string"}},{name:"boolean",test:function(B){return typeof B=="boolean"}},{name:"Function",test:function(B){return typeof B=="function"}},{name:"Array",test:Array.isArray},{name:"Date",test:function(B){return B instanceof Date}},{name:"RegExp",test:function(B){return B instanceof RegExp}},{name:"Object",test:o},{name:"null",test:function(B){return B===null}},{name:"undefined",test:function(B){return B===void 0}}],l={name:"any",test:e,isAny:!0},c,d,u=0,h={createCount:0};function m(B){let K=c.get(B);if(K)return K;let ne='Unknown type "'+B+'"',me=B.toLowerCase(),Ce;for(Ce of d)if(Ce.toLowerCase()===me){ne+='. Did you mean "'+Ce+'" ?';break}throw new TypeError(ne)}function f(B){let K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"any",ne=K?m(K).index:d.length,me=[];for(let xe=0;xe<B.length;++xe){if(!B[xe]||typeof B[xe].name!="string"||typeof B[xe].test!="function")throw new TypeError("Object with properties {name: string, test: function} expected");let Qe=B[xe].name;if(c.has(Qe))throw new TypeError('Duplicate type name "'+Qe+'"');me.push(Qe),c.set(Qe,{name:Qe,test:B[xe].test,isAny:B[xe].isAny,index:ne+xe,conversionsTo:[]})}let Ce=d.slice(ne);d=d.slice(0,ne).concat(me).concat(Ce);for(let xe=ne+me.length;xe<d.length;++xe)c.get(d[xe]).index=xe}function p(){c=new Map,d=[],u=0,f([l],!1)}p(),f(s);function g(){let B;for(B of d)c.get(B).conversionsTo=[];u=0}function v(B){let K=d.filter(ne=>{let me=c.get(ne);return!me.isAny&&me.test(B)});return K.length?K:["any"]}function b(B){return B&&typeof B=="function"&&"_typedFunctionData"in B}function _(B,K,ne){if(!b(B))throw new TypeError(r);let me=ne&&ne.exact,Ce=Array.isArray(K)?K.join(","):K,xe=N(Ce),Qe=y(xe);if(!me||Qe in B.signatures){let Qi=B._typedFunctionData.signatureMap.get(Qe);if(Qi)return Qi}let Fe=xe.length,Je;if(me){Je=[];let Qi;for(Qi in B.signatures)Je.push(B._typedFunctionData.signatureMap.get(Qi))}else Je=B._typedFunctionData.signatures;for(let Qi=0;Qi<Fe;++Qi){let or=xe[Qi],jr=[],ba;for(ba of Je){let Qn=F(ba.params,Qi);if(!(!Qn||or.restParam&&!Qn.restParam)){if(!Qn.hasAny){let is=C(Qn);if(or.types.some(rs=>!is.has(rs.name)))continue}jr.push(ba)}}if(Je=jr,Je.length===0)break}let Ne;for(Ne of Je)if(Ne.params.length<=Fe)return Ne;throw new TypeError("Signature not found (signature: "+(B.name||"unnamed")+"("+y(xe,", ")+"))")}function x(B,K,ne){return _(B,K,ne).implementation}function w(B,K){let ne=m(K);if(ne.test(B))return B;let me=ne.conversionsTo;if(me.length===0)throw new Error("There are no conversions to "+K+" defined.");for(let Ce=0;Ce<me.length;Ce++)if(m(me[Ce].from).test(B))return me[Ce].convert(B);throw new Error("Cannot convert "+B+" to "+K)}function y(B){let K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",";return B.map(ne=>ne.name).join(K)}function M(B){let K=B.indexOf("...")===0,me=(K?B.length>3?B.slice(3):"any":B).split("|").map(Fe=>m(Fe.trim())),Ce=!1,xe=K?"...":"";return{types:me.map(function(Fe){return Ce=Fe.isAny||Ce,xe+=Fe.name+"|",{name:Fe.name,typeIndex:Fe.index,test:Fe.test,isAny:Fe.isAny,conversion:null,conversionIndex:-1}}),name:xe.slice(0,-1),hasAny:Ce,hasConversion:!1,restParam:K}}function T(B){let K=B.types.map(Qe=>Qe.name),ne=oe(K),me=B.hasAny,Ce=B.name,xe=ne.map(function(Qe){let Fe=m(Qe.from);return me=Fe.isAny||me,Ce+="|"+Qe.from,{name:Qe.from,typeIndex:Fe.index,test:Fe.test,isAny:Fe.isAny,conversion:Qe,conversionIndex:Qe.index}});return{types:B.types.concat(xe),name:Ce,hasAny:me,hasConversion:xe.length>0,restParam:B.restParam}}function C(B){return B.typeSet||(B.typeSet=new Set,B.types.forEach(K=>B.typeSet.add(K.name))),B.typeSet}function N(B){let K=[];if(typeof B!="string")throw new TypeError("Signatures must be strings");let ne=B.trim();if(ne==="")return K;let me=ne.split(",");for(let Ce=0;Ce<me.length;++Ce){let xe=M(me[Ce].trim());if(xe.restParam&&Ce!==me.length-1)throw new SyntaxError('Unexpected rest parameter "'+me[Ce]+'": only allowed for the last parameter');if(xe.types.length===0)return null;K.push(xe)}return K}function D(B){let K=st(B);return K?K.restParam:!1}function k(B){if(!B||B.types.length===0)return e;if(B.types.length===1)return m(B.types[0].name).test;if(B.types.length===2){let K=m(B.types[0].name).test,ne=m(B.types[1].name).test;return function(Ce){return K(Ce)||ne(Ce)}}else{let K=B.types.map(function(ne){return m(ne.name).test});return function(me){for(let Ce=0;Ce<K.length;Ce++)if(K[Ce](me))return!0;return!1}}}function U(B){let K,ne,me;if(D(B)){K=_t(B).map(k);let Ce=K.length,xe=k(st(B)),Qe=function(Fe){for(let Je=Ce;Je<Fe.length;Je++)if(!xe(Fe[Je]))return!1;return!0};return function(Je){for(let Ne=0;Ne<K.length;Ne++)if(!K[Ne](Je[Ne]))return!1;return Qe(Je)&&Je.length>=Ce+1}}else return B.length===0?function(xe){return xe.length===0}:B.length===1?(ne=k(B[0]),function(xe){return ne(xe[0])&&xe.length===1}):B.length===2?(ne=k(B[0]),me=k(B[1]),function(xe){return ne(xe[0])&&me(xe[1])&&xe.length===2}):(K=B.map(k),function(xe){for(let Qe=0;Qe<K.length;Qe++)if(!K[Qe](xe[Qe]))return!1;return xe.length===K.length})}function F(B,K){return K<B.length?B[K]:D(B)?st(B):null}function H(B,K){let ne=F(B,K);return ne?C(ne):new Set}function V(B){return B.conversion===null||B.conversion===void 0}function Q(B,K){let ne=new Set;return B.forEach(me=>{let Ce=H(me.params,K),xe;for(xe of Ce)ne.add(xe)}),ne.has("any")?["any"]:Array.from(ne)}function $(B,K,ne){let me,Ce,xe=B||"unnamed",Qe=ne,Fe;for(Fe=0;Fe<K.length;Fe++){let or=[];if(Qe.forEach(jr=>{let ba=F(jr.params,Fe),Qn=k(ba);(Fe<jr.params.length||D(jr.params))&&Qn(K[Fe])&&or.push(jr)}),or.length===0){if(Ce=Q(Qe,Fe),Ce.length>0){let jr=v(K[Fe]);return me=new TypeError("Unexpected type of argument in function "+xe+" (expected: "+Ce.join(" or ")+", actual: "+jr.join(" | ")+", index: "+Fe+")"),me.data={category:"wrongType",fn:xe,index:Fe,actual:jr,expected:Ce},me}}else Qe=or}let Je=Qe.map(function(or){return D(or.params)?1/0:or.params.length});if(K.length<Math.min.apply(null,Je))return Ce=Q(Qe,Fe),me=new TypeError("Too few arguments in function "+xe+" (expected: "+Ce.join(" or ")+", index: "+K.length+")"),me.data={category:"tooFewArgs",fn:xe,index:K.length,expected:Ce},me;let Ne=Math.max.apply(null,Je);if(K.length>Ne)return me=new TypeError("Too many arguments in function "+xe+" (expected: "+Ne+", actual: "+K.length+")"),me.data={category:"tooManyArgs",fn:xe,index:K.length,expectedLength:Ne},me;let Qi=[];for(let or=0;or<K.length;++or)Qi.push(v(K[or]).join("|"));return me=new TypeError('Arguments of type "'+Qi.join(", ")+'" do not match any of the defined signatures of function '+xe+"."),me.data={category:"mismatch",actual:Qi},me}function ee(B){let K=d.length+1;for(let ne=0;ne<B.types.length;ne++)V(B.types[ne])&&(K=Math.min(K,B.types[ne].typeIndex));return K}function re(B){let K=u+1;for(let ne=0;ne<B.types.length;ne++)V(B.types[ne])||(K=Math.min(K,B.types[ne].conversionIndex));return K}function we(B,K){if(B.hasAny){if(!K.hasAny)return 1}else if(K.hasAny)return-1;if(B.restParam){if(!K.restParam)return 1}else if(K.restParam)return-1;if(B.hasConversion){if(!K.hasConversion)return 1}else if(K.hasConversion)return-1;let ne=ee(B)-ee(K);if(ne<0)return-1;if(ne>0)return 1;let me=re(B)-re(K);return me<0?-1:me>0?1:0}function te(B,K){let ne=B.params,me=K.params,Ce=st(ne),xe=st(me),Qe=D(ne),Fe=D(me);if(Qe&&Ce.hasAny){if(!Fe||!xe.hasAny)return 1}else if(Fe&&xe.hasAny)return-1;let Je=0,Ne=0,Qi;for(Qi of ne)Qi.hasAny&&++Je,Qi.hasConversion&&++Ne;let or=0,jr=0;for(Qi of me)Qi.hasAny&&++or,Qi.hasConversion&&++jr;if(Je!==or)return Je-or;if(Qe&&Ce.hasConversion){if(!Fe||!xe.hasConversion)return 1}else if(Fe&&xe.hasConversion)return-1;if(Ne!==jr)return Ne-jr;if(Qe){if(!Fe)return 1}else if(Fe)return-1;let ba=(ne.length-me.length)*(Qe?-1:1);if(ba!==0)return ba;let Qn=[],is=0;for(let ih=0;ih<ne.length;++ih){let Bv=we(ne[ih],me[ih]);Qn.push(Bv),is+=Bv}if(is!==0)return is;let rs;for(rs of Qn)if(rs!==0)return rs;return 0}function oe(B){if(B.length===0)return[];let K=B.map(m);B.length>1&&K.sort((Ce,xe)=>Ce.index-xe.index);let ne=K[0].conversionsTo;if(B.length===1)return ne;ne=ne.concat([]);let me=new Set(B);for(let Ce=1;Ce<K.length;++Ce){let xe;for(xe of K[Ce].conversionsTo)me.has(xe.from)||(ne.push(xe),me.add(xe.from))}return ne}function pe(B,K){let ne=K;if(B.some(Ce=>Ce.hasConversion)){let Ce=D(B),xe=B.map(ue);ne=function(){let Fe=[],Je=Ce?arguments.length-1:arguments.length;for(let Ne=0;Ne<Je;Ne++)Fe[Ne]=xe[Ne](arguments[Ne]);return Ce&&(Fe[Je]=arguments[Je].map(xe[Je])),K.apply(this,Fe)}}let me=ne;if(D(B)){let Ce=B.length-1;me=function(){return ne.apply(this,jt(arguments,0,Ce).concat([jt(arguments,Ce)]))}}return me}function ue(B){let K,ne,me,Ce,xe=[],Qe=[];switch(B.types.forEach(function(Fe){Fe.conversion&&(xe.push(m(Fe.conversion.from).test),Qe.push(Fe.conversion.convert))}),Qe.length){case 0:return function(Je){return Je};case 1:return K=xe[0],me=Qe[0],function(Je){return K(Je)?me(Je):Je};case 2:return K=xe[0],ne=xe[1],me=Qe[0],Ce=Qe[1],function(Je){return K(Je)?me(Je):ne(Je)?Ce(Je):Je};default:return function(Je){for(let Ne=0;Ne<Qe.length;Ne++)if(xe[Ne](Je))return Qe[Ne](Je);return Je}}}function _e(B){function K(ne,me,Ce){if(me<ne.length){let xe=ne[me],Qe=[];if(xe.restParam){let Fe=xe.types.filter(V);Fe.length<xe.types.length&&Qe.push({types:Fe,name:"..."+Fe.map(Je=>Je.name).join("|"),hasAny:Fe.some(Je=>Je.isAny),hasConversion:!1,restParam:!0}),Qe.push(xe)}else Qe=xe.types.map(function(Fe){return{types:[Fe],name:Fe.name,hasAny:Fe.isAny,hasConversion:Fe.conversion,restParam:!1}});return Bi(Qe,function(Fe){return K(ne,me+1,Ce.concat([Fe]))})}else return[Ce]}return K(B,0,[])}function ce(B,K){let ne=Math.max(B.length,K.length);for(let Fe=0;Fe<ne;Fe++){let Je=H(B,Fe),Ne=H(K,Fe),Qi=!1,or;for(or of Ne)if(Je.has(or)){Qi=!0;break}if(!Qi)return!1}let me=B.length,Ce=K.length,xe=D(B),Qe=D(K);return xe?Qe?me===Ce:Ce>=me:Qe?me>=Ce:me===Ce}function fe(B){return B.map(K=>kn(K)?Wi(K.referToSelf.callback):In(K)?Vi(K.referTo.references,K.referTo.callback):K)}function be(B,K,ne){let me=[],Ce;for(Ce of B){let xe=ne[Ce];if(typeof xe!="number")throw new TypeError('No definition for referenced signature "'+Ce+'"');if(xe=K[xe],typeof xe!="function")return!1;me.push(xe)}return me}function ge(B,K,ne){let me=fe(B),Ce=new Array(me.length).fill(!1),xe=!0;for(;xe;){xe=!1;let Qe=!0;for(let Fe=0;Fe<me.length;++Fe){if(Ce[Fe])continue;let Je=me[Fe];if(kn(Je))me[Fe]=Je.referToSelf.callback(ne),me[Fe].referToSelf=Je.referToSelf,Ce[Fe]=!0,Qe=!1;else if(In(Je)){let Ne=be(Je.referTo.references,me,K);Ne?(me[Fe]=Je.referTo.callback.apply(this,Ne),me[Fe].referTo=Je.referTo,Ce[Fe]=!0,Qe=!1):xe=!0}}if(Qe&&xe)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return me}function Oe(B){let K=/\bthis(\(|\.signatures\b)/;Object.keys(B).forEach(ne=>{let me=B[ne];if(K.test(me.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")})}function De(B,K){if(h.createCount++,Object.keys(K).length===0)throw new SyntaxError("No signatures provided");h.warnAgainstDeprecatedThis&&Oe(K);let ne=[],me=[],Ce={},xe=[],Qe;for(Qe in K){if(!Object.prototype.hasOwnProperty.call(K,Qe))continue;let qi=N(Qe);if(!qi)continue;ne.forEach(function(Rp){if(ce(Rp,qi))throw new TypeError('Conflicting signatures "'+y(Rp)+'" and "'+y(qi)+'".')}),ne.push(qi);let xa=me.length;me.push(K[Qe]);let _9=qi.map(T),Vv;for(Vv of _e(_9)){let Rp=y(Vv);xe.push({params:Vv,name:Rp,fn:xa}),Vv.every(b9=>!b9.hasConversion)&&(Ce[Rp]=xa)}}xe.sort(te);let Fe=ge(me,Ce,Pp),Je;for(Je in Ce)Object.prototype.hasOwnProperty.call(Ce,Je)&&(Ce[Je]=Fe[Ce[Je]]);let Ne=[],Qi=new Map;for(Je of xe)Qi.has(Je.name)||(Je.fn=Fe[Je.fn],Ne.push(Je),Qi.set(Je.name,Je));let or=Ne[0]&&Ne[0].params.length<=2&&!D(Ne[0].params),jr=Ne[1]&&Ne[1].params.length<=2&&!D(Ne[1].params),ba=Ne[2]&&Ne[2].params.length<=2&&!D(Ne[2].params),Qn=Ne[3]&&Ne[3].params.length<=2&&!D(Ne[3].params),is=Ne[4]&&Ne[4].params.length<=2&&!D(Ne[4].params),rs=Ne[5]&&Ne[5].params.length<=2&&!D(Ne[5].params),ih=or&&jr&&ba&&Qn&&is&&rs;for(let qi=0;qi<Ne.length;++qi)Ne[qi].test=U(Ne[qi].params);let Bv=or?k(Ne[0].params[0]):t,jU=jr?k(Ne[1].params[0]):t,WU=ba?k(Ne[2].params[0]):t,qU=Qn?k(Ne[3].params[0]):t,$U=is?k(Ne[4].params[0]):t,XU=rs?k(Ne[5].params[0]):t,YU=or?k(Ne[0].params[1]):t,ZU=jr?k(Ne[1].params[1]):t,KU=ba?k(Ne[2].params[1]):t,QU=Qn?k(Ne[3].params[1]):t,JU=is?k(Ne[4].params[1]):t,e9=rs?k(Ne[5].params[1]):t;for(let qi=0;qi<Ne.length;++qi)Ne[qi].implementation=pe(Ne[qi].params,Ne[qi].fn);let t9=or?Ne[0].implementation:i,i9=jr?Ne[1].implementation:i,r9=ba?Ne[2].implementation:i,n9=Qn?Ne[3].implementation:i,a9=is?Ne[4].implementation:i,o9=rs?Ne[5].implementation:i,s9=or?Ne[0].params.length:-1,l9=jr?Ne[1].params.length:-1,c9=ba?Ne[2].params.length:-1,d9=Qn?Ne[3].params.length:-1,u9=is?Ne[4].params.length:-1,h9=rs?Ne[5].params.length:-1,m9=ih?6:0,p9=Ne.length,f9=Ne.map(qi=>qi.test),g9=Ne.map(qi=>qi.implementation),v9=function(){for(let xa=m9;xa<p9;xa++)if(f9[xa](arguments))return g9[xa].apply(this,arguments);return h.onMismatch(B,arguments,Ne)};function Pp(qi,xa){return arguments.length===s9&&Bv(qi)&&YU(xa)?t9.apply(this,arguments):arguments.length===l9&&jU(qi)&&ZU(xa)?i9.apply(this,arguments):arguments.length===c9&&WU(qi)&&KU(xa)?r9.apply(this,arguments):arguments.length===d9&&qU(qi)&&QU(xa)?n9.apply(this,arguments):arguments.length===u9&&$U(qi)&&JU(xa)?a9.apply(this,arguments):arguments.length===h9&&XU(qi)&&e9(xa)?o9.apply(this,arguments):v9.apply(this,arguments)}try{Object.defineProperty(Pp,"name",{value:B})}catch{}return Pp.signatures=Ce,Pp._typedFunctionData={signatures:Ne,signatureMap:Qi},Pp}function $e(B,K,ne){throw $(B,K,ne)}function _t(B){return jt(B,0,B.length-1)}function st(B){return B[B.length-1]}function jt(B,K,ne){return Array.prototype.slice.call(B,K,ne)}function Di(B,K){for(let ne=0;ne<B.length;ne++)if(K(B[ne]))return B[ne]}function Bi(B,K){return Array.prototype.concat.apply([],B.map(K))}function fr(){let B=_t(arguments).map(ne=>y(N(ne))),K=st(arguments);if(typeof K!="function")throw new TypeError("Callback function expected as last argument");return Vi(B,K)}function Vi(B,K){return{referTo:{references:B,callback:K}}}function Wi(B){if(typeof B!="function")throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:B}}}function In(B){return B&&typeof B.referTo=="object"&&Array.isArray(B.referTo.references)&&typeof B.referTo.callback=="function"}function kn(B){return B&&typeof B.referToSelf=="object"&&typeof B.referToSelf.callback=="function"}function Gr(B,K){if(!B)return K;if(K&&K!==B){let ne=new Error("Function names do not match (expected: "+B+", actual: "+K+")");throw ne.data={actual:K,expected:B},ne}return B}function ol(B){let K;for(let ne in B)Object.prototype.hasOwnProperty.call(B,ne)&&(b(B[ne])||typeof B[ne].signature=="string")&&(K=Gr(K,B[ne].name));return K}function _a(B,K){let ne;for(ne in K)if(Object.prototype.hasOwnProperty.call(K,ne)){if(ne in B&&K[ne]!==B[ne]){let me=new Error('Signature "'+ne+'" is defined twice');throw me.data={signature:ne,sourceFunction:K[ne],destFunction:B[ne]},me}B[ne]=K[ne]}}let th=h;h=function(B){let K=typeof B=="string",ne=K?1:0,me=K?B:"",Ce={};for(let xe=ne;xe<arguments.length;++xe){let Qe=arguments[xe],Fe={},Je;if(typeof Qe=="function"?(Je=Qe.name,typeof Qe.signature=="string"?Fe[Qe.signature]=Qe:b(Qe)&&(Fe=Qe.signatures)):o(Qe)&&(Fe=Qe,K||(Je=ol(Qe))),Object.keys(Fe).length===0){let Ne=new TypeError("Argument to 'typed' at index "+xe+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw Ne.data={index:xe,argument:Qe},Ne}K||(me=Gr(me,Je)),_a(Ce,Fe)}return De(me||"",Ce)},h.create=n,h.createCount=th.createCount,h.onMismatch=$e,h.throwMismatchError=$e,h.createError=$,h.clear=p,h.clearConversions=g,h.addTypes=f,h._findType=m,h.referTo=fr,h.referToSelf=Wi,h.convert=w,h.findSignature=_,h.find=x,h.isTypedFunction=b,h.warnAgainstDeprecatedThis=!0,h.addType=function(B,K){let ne="any";K!==!1&&c.has("Object")&&(ne="Object"),h.addTypes([B],ne)};function wo(B){if(!B||typeof B.from!="string"||typeof B.to!="string"||typeof B.convert!="function")throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(B.to===B.from)throw new SyntaxError('Illegal to define conversion from "'+B.from+'" to itself.')}return h.addConversion=function(B){let K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{override:!1};wo(B);let ne=m(B.to),me=ne.conversionsTo.find(Ce=>Ce.from===B.from);if(me)if(K&&K.override)h.removeConversion({from:me.from,to:B.to,convert:me.convert});else throw new Error('There is already a conversion from "'+B.from+'" to "'+ne.name+'"');ne.conversionsTo.push({from:B.from,convert:B.convert,index:u++})},h.addConversions=function(B,K){B.forEach(ne=>h.addConversion(ne,K))},h.removeConversion=function(B){wo(B);let K=m(B.to),ne=Di(K.conversionsTo,Ce=>Ce.from===B.from);if(!ne)throw new Error("Attempt to remove nonexistent conversion from "+B.from+" to "+B.to);if(ne.convert!==B.convert)throw new Error("Conversion to remove does not match existing conversion");let me=K.conversionsTo.indexOf(ne);K.conversionsTo.splice(me,1)},h.resolve=function(B,K){if(!b(B))throw new TypeError(r);let ne=B._typedFunctionData.signatures;for(let me=0;me<ne.length;++me)if(ne[me].test(K))return ne[me];return null},h}var a=n();return a})});var Zw=class{};var mh=class e{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?typeof t=="string"?this.lazyInit=()=>{this.headers=new Map,t.split(`
`).forEach(i=>{let r=i.indexOf(":");if(r>0){let n=i.slice(0,r),a=n.toLowerCase(),o=i.slice(r+1).trim();this.maybeSetNormalizedName(n,a),this.headers.has(a)?this.headers.get(a).push(o):this.headers.set(a,[o])}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((i,r)=>{this.setHeaderEntries(r,i)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([i,r])=>{this.setHeaderEntries(i,r)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();let i=this.headers.get(t.toLowerCase());return i&&i.length>0?i[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,i){return this.clone({name:t,value:i,op:"a"})}set(t,i){return this.clone({name:t,value:i,op:"s"})}delete(t,i){return this.clone({name:t,value:i,op:"d"})}maybeSetNormalizedName(t,i){this.normalizedNames.has(i)||this.normalizedNames.set(i,t)}init(){this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(i=>{this.headers.set(i,t.headers.get(i)),this.normalizedNames.set(i,t.normalizedNames.get(i))})}clone(t){let i=new e;return i.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,i.lazyUpdate=(this.lazyUpdate||[]).concat([t]),i}applyUpdate(t){let i=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(t.name,i);let n=(t.op==="a"?this.headers.get(i):void 0)||[];n.push(...r),this.headers.set(i,n);break;case"d":let a=t.value;if(!a)this.headers.delete(i),this.normalizedNames.delete(i);else{let o=this.headers.get(i);if(!o)return;o=o.filter(s=>a.indexOf(s)===-1),o.length===0?(this.headers.delete(i),this.normalizedNames.delete(i)):this.headers.set(i,o)}break}}setHeaderEntries(t,i){let r=(Array.isArray(i)?i:[i]).map(a=>a.toString()),n=t.toLowerCase();this.headers.set(n,r),this.maybeSetNormalizedName(t,n)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(i=>t(this.normalizedNames.get(i),this.headers.get(i)))}};var Kw=class{encodeKey(t){return DI(t)}encodeValue(t){return DI(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}};function y9(e,t){let i=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(n=>{let a=n.indexOf("="),[o,s]=a==-1?[t.decodeKey(n),""]:[t.decodeKey(n.slice(0,a)),t.decodeValue(n.slice(a+1))],l=i.get(o)||[];l.push(s),i.set(o,l)}),i}var w9=/%(\d[a-f0-9])/gi,C9={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function DI(e){return encodeURIComponent(e).replace(w9,(t,i)=>C9[i]??t)}function s0(e){return`${e}`}var sc=class e{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new Kw,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=y9(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(i=>{let r=t.fromObject[i],n=Array.isArray(r)?r.map(s0):[s0(r)];this.map.set(i,n)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();let i=this.map.get(t);return i?i[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,i){return this.clone({param:t,value:i,op:"a"})}appendAll(t){let i=[];return Object.keys(t).forEach(r=>{let n=t[r];Array.isArray(n)?n.forEach(a=>{i.push({param:r,value:a,op:"a"})}):i.push({param:r,value:n,op:"a"})}),this.clone(i)}set(t,i){return this.clone({param:t,value:i,op:"s"})}delete(t,i){return this.clone({param:t,value:i,op:"d"})}toString(){return this.init(),this.keys().map(t=>{let i=this.encoder.encodeKey(t);return this.map.get(t).map(r=>i+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>t!=="").join("&")}clone(t){let i=new e({encoder:this.encoder});return i.cloneFrom=this.cloneFrom||this,i.updates=(this.updates||[]).concat(t),i}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":let i=(t.op==="a"?this.map.get(t.param):void 0)||[];i.push(s0(t.value)),this.map.set(t.param,i);break;case"d":if(t.value!==void 0){let r=this.map.get(t.param)||[],n=r.indexOf(s0(t.value));n!==-1&&r.splice(n,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}else{this.map.delete(t.param);break}}}),this.cloneFrom=this.updates=null)}};var Qw=class{constructor(){this.map=new Map}set(t,i){return this.map.set(t,i),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}};function E9(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function MI(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function II(e){return typeof Blob<"u"&&e instanceof Blob}function kI(e){return typeof FormData<"u"&&e instanceof FormData}function S9(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}var qp=class e{constructor(t,i,r,n){this.url=i,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase();let a;if(E9(this.method)||n?(this.body=r!==void 0?r:null,a=n):a=r,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params),this.transferCache=a.transferCache),this.headers??=new mh,this.context??=new Qw,!this.params)this.params=new sc,this.urlWithParams=i;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=i;else{let s=i.indexOf("?"),l=s===-1?"?":s<i.length-1?"&":"";this.urlWithParams=i+l+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||MI(this.body)||II(this.body)||kI(this.body)||S9(this.body)?this.body:this.body instanceof sc?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||kI(this.body)?null:II(this.body)?this.body.type||null:MI(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof sc?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(t={}){let i=t.method||this.method,r=t.url||this.url,n=t.responseType||this.responseType,a=t.transferCache??this.transferCache,o=t.body!==void 0?t.body:this.body,s=t.withCredentials??this.withCredentials,l=t.reportProgress??this.reportProgress,c=t.headers||this.headers,d=t.params||this.params,u=t.context??this.context;return t.setHeaders!==void 0&&(c=Object.keys(t.setHeaders).reduce((h,m)=>h.set(m,t.setHeaders[m]),c)),t.setParams&&(d=Object.keys(t.setParams).reduce((h,m)=>h.set(m,t.setParams[m]),d)),new e(i,r,o,{params:d,headers:c,context:u,reportProgress:l,responseType:n,withCredentials:s,transferCache:a})}},NI=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(NI||{}),Jw=class{constructor(t,i=PI.Ok,r="OK"){this.headers=t.headers||new mh,this.status=t.status!==void 0?t.status:i,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}};var e1=class e extends Jw{constructor(t={}){super(t),this.type=NI.Response,this.body=t.body!==void 0?t.body:null}clone(t={}){return new e({body:t.body!==void 0?t.body:this.body,headers:t.headers||this.headers,status:t.status!==void 0?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}};var PI=function(e){return e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Processing=102]="Processing",e[e.EarlyHints=103]="EarlyHints",e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.MultiStatus=207]="MultiStatus",e[e.AlreadyReported=208]="AlreadyReported",e[e.ImUsed=226]="ImUsed",e[e.MultipleChoices=300]="MultipleChoices",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.Unused=306]="Unused",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.LengthRequired=411]="LengthRequired",e[e.PreconditionFailed=412]="PreconditionFailed",e[e.PayloadTooLarge=413]="PayloadTooLarge",e[e.UriTooLong=414]="UriTooLong",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RangeNotSatisfiable=416]="RangeNotSatisfiable",e[e.ExpectationFailed=417]="ExpectationFailed",e[e.ImATeapot=418]="ImATeapot",e[e.MisdirectedRequest=421]="MisdirectedRequest",e[e.UnprocessableEntity=422]="UnprocessableEntity",e[e.Locked=423]="Locked",e[e.FailedDependency=424]="FailedDependency",e[e.TooEarly=425]="TooEarly",e[e.UpgradeRequired=426]="UpgradeRequired",e[e.PreconditionRequired=428]="PreconditionRequired",e[e.TooManyRequests=429]="TooManyRequests",e[e.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",e[e.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.HttpVersionNotSupported=505]="HttpVersionNotSupported",e[e.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",e[e.InsufficientStorage=507]="InsufficientStorage",e[e.LoopDetected=508]="LoopDetected",e[e.NotExtended=510]="NotExtended",e[e.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",e}(PI||{});function Yw(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials,transferCache:e.transferCache}}var RI=(()=>{class e{constructor(i){this.handler=i}request(i,r,n={}){let a;if(i instanceof qp)a=i;else{let l;n.headers instanceof mh?l=n.headers:l=new mh(n.headers);let c;n.params&&(n.params instanceof sc?c=n.params:c=new sc({fromObject:n.params})),a=new qp(i,r,n.body!==void 0?n.body:null,{headers:l,context:n.context,params:c,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials,transferCache:n.transferCache})}let o=pt(a).pipe(tc(l=>this.handler.handle(l)));if(i instanceof qp||n.observe==="events")return o;let s=o.pipe(Mi(l=>l instanceof e1));switch(n.observe||"body"){case"body":switch(a.responseType){case"arraybuffer":return s.pipe(Rt(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return s.pipe(Rt(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return s.pipe(Rt(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return s.pipe(Rt(l=>l.body))}case"response":return s;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(i,r={}){return this.request("DELETE",i,r)}get(i,r={}){return this.request("GET",i,r)}head(i,r={}){return this.request("HEAD",i,r)}jsonp(i,r){return this.request("JSONP",i,{params:new sc().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(i,r={}){return this.request("OPTIONS",i,r)}patch(i,r,n={}){return this.request("PATCH",i,Yw(n,r))}post(i,r,n={}){return this.request("POST",i,Yw(n,r))}put(i,r,n={}){return this.request("PUT",i,Yw(n,r))}static{this.\u0275fac=function(r){return new(r||e)(he(Zw))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac})}}return e})();var r1=class extends rI{constructor(){super(...arguments),this.supportsDOMEvents=!0}},n1=class e extends r1{static makeCurrent(){iI(new e)}onAndCancel(t,i,r){return t.addEventListener(i,r),()=>{t.removeEventListener(i,r)}}dispatchEvent(t,i){t.dispatchEvent(i)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,i){return i=i||this.getDefaultDocument(),i.createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,i){return i==="window"?window:i==="document"?t:i==="body"?t.body:null}getBaseHref(t){let i=D9();return i==null?null:M9(i)}resetBaseElement(){$p=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return sI(document.cookie,t)}},$p=null;function D9(){return $p=$p||document.querySelector("base"),$p?$p.getAttribute("href"):null}function M9(e){return new URL(e,document.baseURI).pathname}var a1=class{addToWindow(t){rc.getAngularTestability=(r,n=!0)=>{let a=t.findTestabilityInTree(r,n);if(a==null)throw new Ji(5103,!1);return a},rc.getAllAngularTestabilities=()=>t.getAllTestabilities(),rc.getAllAngularRootElements=()=>t.getAllRootElements();let i=r=>{let n=rc.getAllAngularTestabilities(),a=n.length,o=function(){a--,a==0&&r()};n.forEach(s=>{s.whenStable(o)})};rc.frameworkStabilizers||(rc.frameworkStabilizers=[]),rc.frameworkStabilizers.push(i)}findTestabilityInTree(t,i,r){if(i==null)return null;let n=t.getTestability(i);return n??(r?Ad().isShadowRoot(i)?this.findTestabilityInTree(t,i.host,!0):this.findTestabilityInTree(t,i.parentElement,!0):null)}},I9=(()=>{class e{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac})}}return e})(),o1=new Be(""),LI=(()=>{class e{constructor(i,r){this._zone=r,this._eventNameToPlugin=new Map,i.forEach(n=>{n.manager=this}),this._plugins=i.slice().reverse()}addEventListener(i,r,n){return this._findPluginFor(r).addEventListener(i,r,n)}getZone(){return this._zone}_findPluginFor(i){let r=this._eventNameToPlugin.get(i);if(r)return r;if(r=this._plugins.find(a=>a.supports(i)),!r)throw new Ji(5101,!1);return this._eventNameToPlugin.set(i,r),r}static{this.\u0275fac=function(r){return new(r||e)(he(o1),he(Xe))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac})}}return e})(),l0=class{constructor(t){this._doc=t}},t1="ng-app-id",BI=(()=>{class e{constructor(i,r,n,a={}){this.doc=i,this.appId=r,this.nonce=n,this.platformId=a,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=$w(a),this.resetHostNodes()}addStyles(i){for(let r of i)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(i){for(let r of i)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let i=this.styleNodesInDOM;i&&(i.forEach(r=>r.remove()),i.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(i){this.hostNodes.add(i);for(let r of this.getAllStyles())this.addStyleToHost(i,r)}removeHost(i){this.hostNodes.delete(i)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(i){for(let r of this.hostNodes)this.addStyleToHost(r,i)}onStyleRemoved(i){let r=this.styleRef;r.get(i)?.elements?.forEach(n=>n.remove()),r.delete(i)}collectServerRenderedStyles(){let i=this.doc.head?.querySelectorAll(`style[${t1}="${this.appId}"]`);if(i?.length){let r=new Map;return i.forEach(n=>{n.textContent!=null&&r.set(n.textContent,n)}),r}return null}changeUsageCount(i,r){let n=this.styleRef;if(n.has(i)){let a=n.get(i);return a.usage+=r,a.usage}return n.set(i,{usage:r,elements:[]}),r}getStyleElement(i,r){let n=this.styleNodesInDOM,a=n?.get(r);if(a?.parentNode===i)return n.delete(r),a.removeAttribute(t1),a;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=r,this.platformIsServer&&o.setAttribute(t1,this.appId),i.appendChild(o),o}}addStyleToHost(i,r){let n=this.getStyleElement(i,r),a=this.styleRef,o=a.get(r)?.elements;o?o.push(n):a.set(r,{elements:[n],usage:1})}resetHostNodes(){let i=this.hostNodes;i.clear(),i.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||e)(he(yt),he(Vp),he(zp,8),he(ll))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac})}}return e})(),i1={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},c1=/%COMP%/g,VI="%COMP%",k9=`_nghost-${VI}`,N9=`_ngcontent-${VI}`,P9=!0,R9=new Be("",{providedIn:"root",factory:()=>P9});function F9(e){return N9.replace(c1,e)}function O9(e){return k9.replace(c1,e)}function zI(e,t){return t.map(i=>i.replace(c1,e))}var ph=(()=>{class e{constructor(i,r,n,a,o,s,l,c=null){this.eventManager=i,this.sharedStylesHost=r,this.appId=n,this.removeStylesOnCompDestroy=a,this.doc=o,this.platformId=s,this.ngZone=l,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=$w(s),this.defaultRenderer=new Xp(i,o,l,this.platformIsServer)}createRenderer(i,r){if(!i||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Lp.ShadowDom&&(r=Bt(Z({},r),{encapsulation:Lp.Emulated}));let n=this.getOrCreateRenderer(i,r);return n instanceof c0?n.applyToHost(i):n instanceof Yp&&n.applyStyles(),n}getOrCreateRenderer(i,r){let n=this.rendererByCompId,a=n.get(r.id);if(!a){let o=this.doc,s=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,u=this.platformIsServer;switch(r.encapsulation){case Lp.Emulated:a=new c0(l,c,r,this.appId,d,o,s,u);break;case Lp.ShadowDom:return new s1(l,c,i,r,o,s,this.nonce,u);default:a=new Yp(l,c,r,d,o,s,u);break}n.set(r.id,a)}return a}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||e)(he(LI),he(BI),he(Vp),he(R9),he(yt),he(ll),he(Xe),he(zp))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac})}}return e})(),Xp=class{constructor(t,i,r,n){this.eventManager=t,this.doc=i,this.ngZone=r,this.platformIsServer=n,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(t,i){return i?this.doc.createElementNS(i1[i]||i,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,i){(FI(t)?t.content:t).appendChild(i)}insertBefore(t,i,r){t&&(FI(t)?t.content:t).insertBefore(i,r)}removeChild(t,i){t&&t.removeChild(i)}selectRootElement(t,i){let r=typeof t=="string"?this.doc.querySelector(t):t;if(!r)throw new Ji(-5104,!1);return i||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,i,r,n){if(n){i=n+":"+i;let a=i1[n];a?t.setAttributeNS(a,i,r):t.setAttribute(i,r)}else t.setAttribute(i,r)}removeAttribute(t,i,r){if(r){let n=i1[r];n?t.removeAttributeNS(n,i):t.removeAttribute(`${r}:${i}`)}else t.removeAttribute(i)}addClass(t,i){t.classList.add(i)}removeClass(t,i){t.classList.remove(i)}setStyle(t,i,r,n){n&(Up.DashCase|Up.Important)?t.style.setProperty(i,r,n&Up.Important?"important":""):t.style[i]=r}removeStyle(t,i,r){r&Up.DashCase?t.style.removeProperty(i):t.style[i]=""}setProperty(t,i,r){t!=null&&(t[i]=r)}setValue(t,i){t.nodeValue=i}listen(t,i,r){if(typeof t=="string"&&(t=Ad().getGlobalEventTarget(this.doc,t),!t))throw new Error(`Unsupported event target ${t} for event ${i}`);return this.eventManager.addEventListener(t,i,this.decoratePreventDefault(r))}decoratePreventDefault(t){return i=>{if(i==="__ngUnwrap__")return t;(this.platformIsServer?this.ngZone.runGuarded(()=>t(i)):t(i))===!1&&i.preventDefault()}}};function FI(e){return e.tagName==="TEMPLATE"&&e.content!==void 0}var s1=class extends Xp{constructor(t,i,r,n,a,o,s,l){super(t,a,o,l),this.sharedStylesHost=i,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=zI(n.id,n.styles);for(let d of c){let u=document.createElement("style");s&&u.setAttribute("nonce",s),u.textContent=d,this.shadowRoot.appendChild(u)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,i){return super.appendChild(this.nodeOrShadowRoot(t),i)}insertBefore(t,i,r){return super.insertBefore(this.nodeOrShadowRoot(t),i,r)}removeChild(t,i){return super.removeChild(this.nodeOrShadowRoot(t),i)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Yp=class extends Xp{constructor(t,i,r,n,a,o,s,l){super(t,a,o,s),this.sharedStylesHost=i,this.removeStylesOnCompDestroy=n,this.styles=l?zI(l,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},c0=class extends Yp{constructor(t,i,r,n,a,o,s,l){let c=n+"-"+r.id;super(t,i,r,a,o,s,l,c),this.contentAttr=F9(c),this.hostAttr=O9(c)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,i){let r=super.createElement(t,i);return super.setAttribute(r,this.contentAttr,""),r}},L9=(()=>{class e extends l0{constructor(i){super(i)}supports(i){return!0}addEventListener(i,r,n){return i.addEventListener(r,n,!1),()=>this.removeEventListener(i,r,n)}removeEventListener(i,r,n){return i.removeEventListener(r,n)}static{this.\u0275fac=function(r){return new(r||e)(he(yt))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac})}}return e})(),OI=["alt","control","meta","shift"],B9={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},V9={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey},z9=(()=>{class e extends l0{constructor(i){super(i)}supports(i){return e.parseEventName(i)!=null}addEventListener(i,r,n){let a=e.parseEventName(r),o=e.eventCallback(a.fullKey,n,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ad().onAndCancel(i,a.domEventName,o))}static parseEventName(i){let r=i.toLowerCase().split("."),n=r.shift();if(r.length===0||!(n==="keydown"||n==="keyup"))return null;let a=e._normalizeKey(r.pop()),o="",s=r.indexOf("code");if(s>-1&&(r.splice(s,1),o="code."),OI.forEach(c=>{let d=r.indexOf(c);d>-1&&(r.splice(d,1),o+=c+".")}),o+=a,r.length!=0||a.length===0)return null;let l={};return l.domEventName=n,l.fullKey=o,l}static matchEventFullKeyCode(i,r){let n=B9[i.key]||i.key,a="";return r.indexOf("code.")>-1&&(n=i.code,a="code."),n==null||!n?!1:(n=n.toLowerCase(),n===" "?n="space":n==="."&&(n="dot"),OI.forEach(o=>{if(o!==n){let s=V9[o];s(i)&&(a+=o+".")}}),a+=n,a===r)}static eventCallback(i,r,n){return a=>{e.matchEventFullKeyCode(a,i)&&n.runGuarded(()=>r(a))}}static _normalizeKey(i){return i==="esc"?"escape":i}static{this.\u0275fac=function(r){return new(r||e)(he(yt))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac})}}return e})();function U9(){n1.makeCurrent()}function H9(){return new yd}function G9(){return AM(document),document}var j9=[{provide:ll,useValue:lI},{provide:TM,useValue:U9,multi:!0},{provide:yt,useFactory:G9,deps:[]}],UI=KM(QM,"browser",j9),W9=new Be(""),q9=[{provide:Zv,useClass:a1,deps:[]},{provide:YM,useClass:Kv,deps:[Xe,Ww,Zv]},{provide:Kv,useClass:Kv,deps:[Xe,Ww,Zv]}],$9=[{provide:EM,useValue:"root"},{provide:yd,useFactory:H9,deps:[]},{provide:o1,useClass:L9,multi:!0,deps:[yt,Xe,ll]},{provide:o1,useClass:z9,multi:!0,deps:[yt]},ph,BI,LI,{provide:dh,useExisting:ph},{provide:dI,useClass:I9,deps:[]},[]],d0=(()=>{class e{constructor(i){}static withServerTransition(i){return{ngModule:e,providers:[{provide:Vp,useValue:i.appId}]}}static{this.\u0275fac=function(r){return new(r||e)(he(W9,12))}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({providers:[...$9,...q9],imports:[On,JM]})}}return e})();var HI=(()=>{class e{constructor(i){this._doc=i}getTitle(){return this._doc.title}setTitle(i){this._doc.title=i||""}static{this.\u0275fac=function(r){return new(r||e)(he(yt))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var d1=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:function(r){let n=null;return r?n=new(r||e):n=he(X9),n},providedIn:"root"})}}return e})(),X9=(()=>{class e extends d1{constructor(i){super(),this._doc=i}sanitize(i,r){if(r==null)return null;switch(i){case Ka.NONE:return r;case Ka.HTML:return oh(r,"HTML")?ah(r):RM(this._doc,String(r)).toString();case Ka.STYLE:return oh(r,"Style")?ah(r):r;case Ka.SCRIPT:if(oh(r,"Script"))return ah(r);throw new Ji(5200,!1);case Ka.URL:return oh(r,"URL")?ah(r):PM(String(r));case Ka.RESOURCE_URL:if(oh(r,"ResourceURL"))return ah(r);throw new Ji(5201,!1);default:throw new Ji(5202,!1)}}bypassSecurityTrustHtml(i){return DM(i)}bypassSecurityTrustStyle(i){return MM(i)}bypassSecurityTrustScript(i){return IM(i)}bypassSecurityTrustUrl(i){return kM(i)}bypassSecurityTrustResourceUrl(i){return NM(i)}static{this.\u0275fac=function(r){return new(r||e)(he(yt))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();Ci([vI,_I]);Ci(gI);function GI(e,t,i){typeof t=="object"&&(i=t,t=null);var r=this,n;if(!(e instanceof Function)){n=[];for(var a in e)e.hasOwnProperty(a)&&n.push(a)}var o=function(l){if(r.apply(this,arguments),e instanceof Function?jI(this,e.call(this,l)):Y9(this,e,n),this.constructor===o)for(var c=o.__initializers__,d=0;d<c.length;d++)c[d].apply(this,arguments)};o.__super__=r,r.__initializers__?o.__initializers__=r.__initializers__.slice():o.__initializers__=[],t&&o.__initializers__.push(t);var s=function(){};return s.prototype=r.prototype,o.prototype=new s,o.prototype.constructor=o,jI(o.prototype,i),o.extend=r.extend,o.derive=r.extend,o}function jI(e,t){if(t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}function Y9(e,t,i){for(var r=0;r<i.length;r++){var n=i[r];e[n]=t[n]}}var WI={extend:GI,derive:GI};function Z9(e,t){this.action=e,this.context=t}var K9={trigger:function(e){if(this.hasOwnProperty("__handlers__")&&this.__handlers__.hasOwnProperty(e)){var t=this.__handlers__[e],i=t.length,r=-1,n=arguments;switch(n.length){case 1:for(;++r<i;)t[r].action.call(t[r].context);return;case 2:for(;++r<i;)t[r].action.call(t[r].context,n[1]);return;case 3:for(;++r<i;)t[r].action.call(t[r].context,n[1],n[2]);return;case 4:for(;++r<i;)t[r].action.call(t[r].context,n[1],n[2],n[3]);return;case 5:for(;++r<i;)t[r].action.call(t[r].context,n[1],n[2],n[3],n[4]);return;default:for(;++r<i;)t[r].action.apply(t[r].context,Array.prototype.slice.call(n,1));return}}},on:function(e,t,i){if(!(!e||!t)){var r=this.__handlers__||(this.__handlers__={});if(!r[e])r[e]=[];else if(this.has(e,t))return;var n=new Z9(t,i||this);return r[e].push(n),this}},once:function(e,t,i){if(!e||!t)return;var r=this;function n(){r.off(e,n),t.apply(this,arguments)}return this.on(e,n,i)},before:function(e,t,i){if(!(!e||!t))return e="before"+e,this.on(e,t,i)},after:function(e,t,i){if(!(!e||!t))return e="after"+e,this.on(e,t,i)},success:function(e,t){return this.once("success",e,t)},error:function(e,t){return this.once("error",e,t)},off:function(e,t){var i=this.__handlers__||(this.__handlers__={});if(!t){i[e]=[];return}if(i[e]){for(var r=i[e],n=[],a=0;a<r.length;a++)t&&r[a].action!==t&&n.push(r[a]);i[e]=n}return this},has:function(e,t){var i=this.__handlers__;if(!i||!i[e])return!1;for(var r=i[e],n=0;n<r.length;n++)if(r[n].action===t)return!0}},fh=K9;var Q9=0,J9=Array.prototype,eH=J9.forEach,Zp={genGUID:function(){return++Q9},relative2absolute:function(e,t){if(!t||e.match(/^\//))return e;for(var i=e.split("/"),r=t.split("/"),n=i[0];n==="."||n==="..";)n===".."&&r.pop(),i.shift(),n=i[0];return r.join("/")+"/"+i.join("/")},extend:function(e,t){if(t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},defaults:function(e,t){if(t)for(var i in t)e[i]===void 0&&(e[i]=t[i]);return e},extendWithPropList:function(e,t,i){if(t)for(var r=0;r<i.length;r++){var n=i[r];e[n]=t[n]}return e},defaultsWithPropList:function(e,t,i){if(t)for(var r=0;r<i.length;r++){var n=i[r];e[n]==null&&(e[n]=t[n])}return e},each:function(e,t,i){if(e&&t)if(e.forEach&&e.forEach===eH)e.forEach(t,i);else if(e.length===+e.length)for(var r=0,n=e.length;r<n;r++)t.call(i,e[r],r,e);else for(var a in e)e.hasOwnProperty(a)&&t.call(i,e[a],a,e)},isObject:function(e){return e===Object(e)},isArray:function(e){return Array.isArray(e)},isArrayLike:function(e){return e?e.length===+e.length:!1},clone:function(e){if(Zp.isObject(e)){if(Zp.isArray(e))return e.slice();if(Zp.isArrayLike(e)){for(var t=new e.constructor(e.length),i=0;i<e.length;i++)t[i]=e[i];return t}else return Zp.extend({},e)}else return e}},vr=Zp;var u0=function(){this.__uid__=vr.genGUID()};u0.__initializers__=[function(e){vr.extend(this,e)}];vr.extend(u0,WI);vr.extend(u0.prototype,fh);var Ui=u0;var qI=["OES_texture_float","OES_texture_half_float","OES_texture_float_linear","OES_texture_half_float_linear","OES_standard_derivatives","OES_vertex_array_object","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","EXT_texture_filter_anisotropic","EXT_shader_texture_lod","WEBGL_draw_buffers","EXT_frag_depth","EXT_sRGB","ANGLE_instanced_arrays"],$I=["MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE"];function tH(e){for(var t={},i={},r=0;r<qI.length;r++){var n=qI[r];o(n)}for(var r=0;r<$I.length;r++){var a=$I[r];i[a]=e.getParameter(e[a])}this.getExtension=function(s){return s in t||o(s),t[s]},this.getParameter=function(s){return i[s]};function o(s){if(e.getExtension){var l=e.getExtension(s);l||(l=e.getExtension("MOZ_"+s)),l||(l=e.getExtension("WEBKIT_"+s)),t[s]=l}}}var XI=tH;var se={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444};function iH(e){var t=new XMLHttpRequest;t.open("get",e.url),t.responseType=e.responseType||"text",e.onprogress&&(t.onprogress=function(i){if(i.lengthComputable){var r=i.loaded/i.total;e.onprogress(r,i.loaded,i.total)}else e.onprogress(null)}),t.onload=function(i){t.status>=400?e.onerror&&e.onerror():e.onload&&e.onload(t.response)},e.onerror&&(t.onerror=e.onerror),t.send(null)}var YI={get:iH};var h1,ia={};ia.supportWebGL=function(){if(h1==null)try{var e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");if(!t)throw new Error}catch{h1=!1}return h1};ia.Int8Array=typeof Int8Array>"u"?Array:Int8Array;ia.Uint8Array=typeof Uint8Array>"u"?Array:Uint8Array;ia.Uint16Array=typeof Uint16Array>"u"?Array:Uint16Array;ia.Uint32Array=typeof Uint32Array>"u"?Array:Uint32Array;ia.Int16Array=typeof Int16Array>"u"?Array:Int16Array;ia.Float32Array=typeof Float32Array>"u"?Array:Float32Array;ia.Float64Array=typeof Float64Array>"u"?Array:Float64Array;var kd={};typeof window<"u"?kd=window:typeof global<"u"&&(kd=global);ia.requestAnimationFrame=kd.requestAnimationFrame||kd.msRequestAnimationFrame||kd.mozRequestAnimationFrame||kd.webkitRequestAnimationFrame||function(e){setTimeout(e,16)};ia.createCanvas=function(){return document.createElement("canvas")};ia.createImage=function(){return new kd.Image};ia.request={get:YI.get};ia.addEventListener=function(e,t,i,r){e.addEventListener(t,i,r)};ia.removeEventListener=function(e,t,i){e.removeEventListener(t,i)};var Ai=ia;var tn=function(){this.head=null,this.tail=null,this._length=0};tn.prototype.insert=function(e){var t=new tn.Entry(e);return this.insertEntry(t),t};tn.prototype.insertAt=function(e,t){if(!(e<0)){for(var i=this.head,r=0;i&&r!=e;)i=i.next,r++;if(i){var n=new tn.Entry(t),a=i.prev;a?(a.next=n,n.prev=a):this.head=n,n.next=i,i.prev=n}else this.insert(t)}};tn.prototype.insertBeforeEntry=function(e,t){var i=new tn.Entry(e),r=t.prev;r?(r.next=i,i.prev=r):this.head=i,i.next=t,t.prev=i,this._length++};tn.prototype.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,this.tail=e):this.head=this.tail=e,this._length++};tn.prototype.remove=function(e){var t=e.prev,i=e.next;t?t.next=i:this.head=i,i?i.prev=t:this.tail=t,e.next=e.prev=null,this._length--};tn.prototype.removeAt=function(e){if(!(e<0)){for(var t=this.head,i=0;t&&i!=e;)t=t.next,i++;if(t)return this.remove(t),t.value}};tn.prototype.getHead=function(){if(this.head)return this.head.value};tn.prototype.getTail=function(){if(this.tail)return this.tail.value};tn.prototype.getAt=function(e){if(!(e<0)){for(var t=this.head,i=0;t&&i!=e;)t=t.next,i++;return t.value}};tn.prototype.indexOf=function(e){for(var t=this.head,i=0;t;){if(t.value===e)return i;t=t.next,i++}};tn.prototype.length=function(){return this._length};tn.prototype.isEmpty=function(){return this._length===0};tn.prototype.forEach=function(e,t){for(var i=this.head,r=0,n=typeof t<"u";i;)n?e.call(t,i.value,r):e(i.value,r),i=i.next,r++};tn.prototype.clear=function(){this.tail=this.head=null,this._length=0};tn.Entry=function(e){this.value=e,this.next=null,this.prev=null};var ZI=tn;var gh=function(e){this._list=new ZI,this._map={},this._maxSize=e||10};gh.prototype.setMaxSize=function(e){this._maxSize=e};gh.prototype.put=function(e,t){if(!this._map.hasOwnProperty(e)){var i=this._list.length();if(i>=this._maxSize&&i>0){var r=this._list.head;this._list.remove(r),delete this._map[r.key]}var n=this._list.insert(t);n.key=e,this._map[e]=n}};gh.prototype.get=function(e){var t=this._map[e];if(this._map.hasOwnProperty(e))return t!==this._list.tail&&(this._list.remove(t),this._list.insertEntry(t)),t.value};gh.prototype.remove=function(e){var t=this._map[e];typeof t<"u"&&(delete this._map[e],this._list.remove(t))};gh.prototype.clear=function(){this._list.clear(),this._map={}};var h0=gh;var _r={},KI={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ls(e){return e=Math.round(e),e<0?0:e>255?255:e}function rH(e){return e=Math.round(e),e<0?0:e>360?360:e}function Kp(e){return e<0?0:e>1?1:e}function m1(e){return e.length&&e.charAt(e.length-1)==="%"?ls(parseFloat(e)/100*255):ls(parseInt(e,10))}function _h(e){return e.length&&e.charAt(e.length-1)==="%"?Kp(parseFloat(e)/100):Kp(parseFloat(e))}function p1(e,t,i){return i<0?i+=1:i>1&&(i-=1),i*6<1?e+(t-e)*i*6:i*2<1?t:i*3<2?e+(t-e)*(2/3-i)*6:e}function lc(e,t,i){return e+(t-e)*i}function ss(e,t,i,r,n){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e}function f1(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var QI=new h0(20),m0=null;function vh(e,t){m0&&f1(m0,t),m0=QI.put(e,m0||t.slice())}_r.parse=function(e,t){if(e){t=t||[];var i=QI.get(e);if(i)return f1(t,i);e=e+"";var r=e.replace(/ /g,"").toLowerCase();if(r in KI)return f1(t,KI[r]),vh(e,t),t;if(r.charAt(0)==="#"){if(r.length===4){var n=parseInt(r.substr(1),16);if(!(n>=0&&n<=4095)){ss(t,0,0,0,1);return}return ss(t,(n&3840)>>4|(n&3840)>>8,n&240|(n&240)>>4,n&15|(n&15)<<4,1),vh(e,t),t}else if(r.length===7){var n=parseInt(r.substr(1),16);if(!(n>=0&&n<=16777215)){ss(t,0,0,0,1);return}return ss(t,(n&16711680)>>16,(n&65280)>>8,n&255,1),vh(e,t),t}return}var a=r.indexOf("("),o=r.indexOf(")");if(a!==-1&&o+1===r.length){var s=r.substr(0,a),l=r.substr(a+1,o-(a+1)).split(","),c=1;switch(s){case"rgba":if(l.length!==4){ss(t,0,0,0,1);return}c=_h(l.pop());case"rgb":if(l.length!==3){ss(t,0,0,0,1);return}return ss(t,m1(l[0]),m1(l[1]),m1(l[2]),c),vh(e,t),t;case"hsla":if(l.length!==4){ss(t,0,0,0,1);return}return l[3]=_h(l[3]),g1(l,t),vh(e,t),t;case"hsl":if(l.length!==3){ss(t,0,0,0,1);return}return g1(l,t),vh(e,t),t;default:return}}ss(t,0,0,0,1)}};_r.parseToFloat=function(e,t){if(t=_r.parse(e,t),!!t)return t[0]/=255,t[1]/=255,t[2]/=255,t};function g1(e,t){var i=(parseFloat(e[0])%360+360)%360/360,r=_h(e[1]),n=_h(e[2]),a=n<=.5?n*(r+1):n+r-n*r,o=n*2-a;return t=t||[],ss(t,ls(p1(o,a,i+1/3)*255),ls(p1(o,a,i)*255),ls(p1(o,a,i-1/3)*255),1),e.length===4&&(t[3]=e[3]),t}function nH(e){if(e){var t=e[0]/255,i=e[1]/255,r=e[2]/255,n=Math.min(t,i,r),a=Math.max(t,i,r),o=a-n,s=(a+n)/2,l,c;if(o===0)l=0,c=0;else{s<.5?c=o/(a+n):c=o/(2-a-n);var d=((a-t)/6+o/2)/o,u=((a-i)/6+o/2)/o,h=((a-r)/6+o/2)/o;t===a?l=h-u:i===a?l=1/3+d-h:r===a&&(l=2/3+u-d),l<0&&(l+=1),l>1&&(l-=1)}var m=[l*360,c,s];return e[3]!=null&&m.push(e[3]),m}}_r.lift=function(e,t){var i=_r.parse(e);if(i){for(var r=0;r<3;r++)t<0?i[r]=i[r]*(1-t)|0:i[r]=(255-i[r])*t+i[r]|0;return _r.stringify(i,i.length===4?"rgba":"rgb")}};_r.toHex=function(e){var t=_r.parse(e);if(t)return((1<<24)+(t[0]<<16)+(t[1]<<8)+ +t[2]).toString(16).slice(1)};_r.fastLerp=function(e,t,i){if(!(!(t&&t.length)||!(e>=0&&e<=1))){i=i||[];var r=e*(t.length-1),n=Math.floor(r),a=Math.ceil(r),o=t[n],s=t[a],l=r-n;return i[0]=ls(lc(o[0],s[0],l)),i[1]=ls(lc(o[1],s[1],l)),i[2]=ls(lc(o[2],s[2],l)),i[3]=Kp(lc(o[3],s[3],l)),i}};_r.fastMapToColor=_r.fastLerp;_r.lerp=function(e,t,i){if(!(!(t&&t.length)||!(e>=0&&e<=1))){var r=e*(t.length-1),n=Math.floor(r),a=Math.ceil(r),o=_r.parse(t[n]),s=_r.parse(t[a]),l=r-n,c=_r.stringify([ls(lc(o[0],s[0],l)),ls(lc(o[1],s[1],l)),ls(lc(o[2],s[2],l)),Kp(lc(o[3],s[3],l))],"rgba");return i?{color:c,leftIndex:n,rightIndex:a,value:r}:c}};_r.mapToColor=_r.lerp;_r.modifyHSL=function(e,t,i,r){if(e=_r.parse(e),e)return e=nH(e),t!=null&&(e[0]=rH(t)),i!=null&&(e[1]=_h(i)),r!=null&&(e[2]=_h(r)),_r.stringify(g1(e),"rgba")};_r.modifyAlpha=function(e,t){if(e=_r.parse(e),e&&t!=null)return e[3]=Kp(t),_r.stringify(e,"rgba")};_r.stringify=function(e,t){if(!(!e||!e.length)){var i=e[0]+","+e[1]+","+e[2];return(t==="rgba"||t==="hsva"||t==="hsla")&&(i+=","+e[3]),t+"("+i+")"}};var JI=_r;var aH=JI.parseToFloat,v1={};function ek(e){var t=Object.keys(e);t.sort();for(var i=[],r=0;r<t.length;r++){var n=t[r],a=e[n];a===null?i.push(n):i.push(n+" "+a.toString())}return i.join(`
`)}function oH(e,t,i){i.sort();for(var r=[],n=0;n<i.length;n++){var a=i[n];r.push(a)}var o=ek(e)+`
`+ek(t)+`
`+r.join(`
`);if(v1[o])return v1[o];var s=vr.genGUID();return v1[o]=s,s}var sH=Ui.extend(function(){return{name:"",depthTest:!0,depthMask:!0,transparent:!1,blend:null,autoUpdateTextureStatus:!0,uniforms:{},vertexDefines:{},fragmentDefines:{},_textureStatus:{},_enabledUniforms:null}},function(){this.name||(this.name="MATERIAL_"+this.__uid__),this.shader&&this.attachShader(this.shader,!0)},{precision:"highp",setUniform:function(e,t){t===void 0&&console.warn('Uniform value "'+e+'" is undefined');var i=this.uniforms[e];i&&(typeof t=="string"&&(t=aH(t)||t),i.value=t,this.autoUpdateTextureStatus&&i.type==="t"&&(t?this.enableTexture(e):this.disableTexture(e)))},setUniforms:function(e){for(var t in e){var i=e[t];this.setUniform(t,i)}},isUniformEnabled:function(e){return this._enabledUniforms.indexOf(e)>=0},getEnabledUniforms:function(){return this._enabledUniforms},getTextureUniforms:function(){return this._textureUniforms},set:function(e,t){if(typeof e=="object")for(var i in e){var r=e[i];this.setUniform(i,r)}else this.setUniform(e,t)},get:function(e){var t=this.uniforms[e];if(t)return t.value},attachShader:function(e,t){var i=this.uniforms;this.uniforms=e.createUniforms(),this.shader=e;var r=this.uniforms;this._enabledUniforms=Object.keys(r),this._enabledUniforms.sort(),this._textureUniforms=this._enabledUniforms.filter(function(c){var d=this.uniforms[c].type;return d==="t"||d==="tv"},this);var n=this.vertexDefines,a=this.fragmentDefines;if(this.vertexDefines=vr.clone(e.vertexDefines),this.fragmentDefines=vr.clone(e.fragmentDefines),t){for(var o in i)r[o]&&(r[o].value=i[o].value);vr.defaults(this.vertexDefines,n),vr.defaults(this.fragmentDefines,a)}var s={};for(var l in e.textures)s[l]={shaderType:e.textures[l].shaderType,type:e.textures[l].type,enabled:t&&this._textureStatus[l]?this._textureStatus[l].enabled:!1};this._textureStatus=s,this._programKey=""},clone:function(){var e=new this.constructor({name:this.name,shader:this.shader});for(var t in this.uniforms)e.uniforms[t].value=this.uniforms[t].value;return e.depthTest=this.depthTest,e.depthMask=this.depthMask,e.transparent=this.transparent,e.blend=this.blend,e.vertexDefines=vr.clone(this.vertexDefines),e.fragmentDefines=vr.clone(this.fragmentDefines),e.enableTexture(this.getEnabledTextures()),e.precision=this.precision,e},define:function(e,t,i){var r=this.vertexDefines,n=this.fragmentDefines;e!=="vertex"&&e!=="fragment"&&e!=="both"&&arguments.length<3&&(i=t,t=e,e="both"),i=i??null,(e==="vertex"||e==="both")&&r[t]!==i&&(r[t]=i,this._programKey=""),(e==="fragment"||e==="both")&&n[t]!==i&&(n[t]=i,e!=="both"&&(this._programKey=""))},undefine:function(e,t){e!=="vertex"&&e!=="fragment"&&e!=="both"&&arguments.length<2&&(t=e,e="both"),(e==="vertex"||e==="both")&&this.isDefined("vertex",t)&&(delete this.vertexDefines[t],this._programKey=""),(e==="fragment"||e==="both")&&this.isDefined("fragment",t)&&(delete this.fragmentDefines[t],e!=="both"&&(this._programKey=""))},isDefined:function(e,t){switch(e){case"vertex":return this.vertexDefines[t]!==void 0;case"fragment":return this.fragmentDefines[t]!==void 0}},getDefine:function(e,t){switch(e){case"vertex":return this.vertexDefines[t];case"fragment":return this.fragmentDefines[t]}},enableTexture:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)this.enableTexture(e[t]);return}var i=this._textureStatus[e];if(i){var r=i.enabled;r||(i.enabled=!0,this._programKey="")}},enableTexturesAll:function(){var e=this._textureStatus;for(var t in e)e[t].enabled=!0;this._programKey=""},disableTexture:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)this.disableTexture(e[t]);return}var i=this._textureStatus[e];if(i){var r=!i.enabled;r||(i.enabled=!1,this._programKey="")}},disableTexturesAll:function(){var e=this._textureStatus;for(var t in e)e[t].enabled=!1;this._programKey=""},isTextureEnabled:function(e){var t=this._textureStatus;return!!t[e]&&t[e].enabled},getEnabledTextures:function(){var e=[],t=this._textureStatus;for(var i in t)t[i].enabled&&e.push(i);return e},dirtyDefines:function(){this._programKey=""},getProgramKey:function(){return this._programKey||(this._programKey=oH(this.vertexDefines,this.fragmentDefines,this.getEnabledTextures())),this._programKey}}),$r=sH;var Qp=1e-6,lr=Array,cc=Math.random;var Ht={};Ht.create=function(){var e=new lr(2);return e[0]=0,e[1]=0,e};Ht.clone=function(e){var t=new lr(2);return t[0]=e[0],t[1]=e[1],t};Ht.fromValues=function(e,t){var i=new lr(2);return i[0]=e,i[1]=t,i};Ht.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e};Ht.set=function(e,t,i){return e[0]=t,e[1]=i,e};Ht.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e};Ht.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e};Ht.sub=Ht.subtract;Ht.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e};Ht.mul=Ht.multiply;Ht.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e};Ht.div=Ht.divide;Ht.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e};Ht.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e};Ht.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e};Ht.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e};Ht.distance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(i*i+r*r)};Ht.dist=Ht.distance;Ht.squaredDistance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1];return i*i+r*r};Ht.sqrDist=Ht.squaredDistance;Ht.length=function(e){var t=e[0],i=e[1];return Math.sqrt(t*t+i*i)};Ht.len=Ht.length;Ht.squaredLength=function(e){var t=e[0],i=e[1];return t*t+i*i};Ht.sqrLen=Ht.squaredLength;Ht.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e};Ht.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e};Ht.normalize=function(e,t){var i=t[0],r=t[1],n=i*i+r*r;return n>0&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n),e};Ht.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]};Ht.cross=function(e,t,i){var r=t[0]*i[1]-t[1]*i[0];return e[0]=e[1]=0,e[2]=r,e};Ht.lerp=function(e,t,i,r){var n=t[0],a=t[1];return e[0]=n+r*(i[0]-n),e[1]=a+r*(i[1]-a),e};Ht.random=function(e,t){t=t||1;var i=GLMAT_RANDOM()*2*Math.PI;return e[0]=Math.cos(i)*t,e[1]=Math.sin(i)*t,e};Ht.transformMat2=function(e,t,i){var r=t[0],n=t[1];return e[0]=i[0]*r+i[2]*n,e[1]=i[1]*r+i[3]*n,e};Ht.transformMat2d=function(e,t,i){var r=t[0],n=t[1];return e[0]=i[0]*r+i[2]*n+i[4],e[1]=i[1]*r+i[3]*n+i[5],e};Ht.transformMat3=function(e,t,i){var r=t[0],n=t[1];return e[0]=i[0]*r+i[3]*n+i[6],e[1]=i[1]*r+i[4]*n+i[7],e};Ht.transformMat4=function(e,t,i){var r=t[0],n=t[1];return e[0]=i[0]*r+i[4]*n+i[12],e[1]=i[1]*r+i[5]*n+i[13],e};Ht.forEach=function(){var e=Ht.create();return function(t,i,r,n,a,o){var s,l;for(i||(i=2),r||(r=0),n?l=Math.min(n*i+r,t.length):l=t.length,s=r;s<l;s+=i)e[0]=t[s],e[1]=t[s+1],a(e,e,o),t[s]=e[0],t[s+1]=e[1];return t}}();var gt=Ht;var ii=function(e,t){e=e||0,t=t||0,this.array=gt.fromValues(e,t),this._dirty=!0};ii.prototype={constructor:ii,add:function(e){return gt.add(this.array,this.array,e.array),this._dirty=!0,this},set:function(e,t){return this.array[0]=e,this.array[1]=t,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this._dirty=!0,this},clone:function(){return new ii(this.x,this.y)},copy:function(e){return gt.copy(this.array,e.array),this._dirty=!0,this},cross:function(e,t){return gt.cross(e.array,this.array,t.array),e._dirty=!0,this},dist:function(e){return gt.dist(this.array,e.array)},distance:function(e){return gt.distance(this.array,e.array)},div:function(e){return gt.div(this.array,this.array,e.array),this._dirty=!0,this},divide:function(e){return gt.divide(this.array,this.array,e.array),this._dirty=!0,this},dot:function(e){return gt.dot(this.array,e.array)},len:function(){return gt.len(this.array)},length:function(){return gt.length(this.array)},lerp:function(e,t,i){return gt.lerp(this.array,e.array,t.array,i),this._dirty=!0,this},min:function(e){return gt.min(this.array,this.array,e.array),this._dirty=!0,this},max:function(e){return gt.max(this.array,this.array,e.array),this._dirty=!0,this},mul:function(e){return gt.mul(this.array,this.array,e.array),this._dirty=!0,this},multiply:function(e){return gt.multiply(this.array,this.array,e.array),this._dirty=!0,this},negate:function(){return gt.negate(this.array,this.array),this._dirty=!0,this},normalize:function(){return gt.normalize(this.array,this.array),this._dirty=!0,this},random:function(e){return gt.random(this.array,e),this._dirty=!0,this},scale:function(e){return gt.scale(this.array,this.array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return gt.scaleAndAdd(this.array,this.array,e.array,t),this._dirty=!0,this},sqrDist:function(e){return gt.sqrDist(this.array,e.array)},squaredDistance:function(e){return gt.squaredDistance(this.array,e.array)},sqrLen:function(){return gt.sqrLen(this.array)},squaredLength:function(){return gt.squaredLength(this.array)},sub:function(e){return gt.sub(this.array,this.array,e.array),this._dirty=!0,this},subtract:function(e){return gt.subtract(this.array,this.array,e.array),this._dirty=!0,this},transformMat2:function(e){return gt.transformMat2(this.array,this.array,e.array),this._dirty=!0,this},transformMat2d:function(e){return gt.transformMat2d(this.array,this.array,e.array),this._dirty=!0,this},transformMat3:function(e){return gt.transformMat3(this.array,this.array,e.array),this._dirty=!0,this},transformMat4:function(e){return gt.transformMat4(this.array,this.array,e.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};Object.defineProperty&&(_1=ii.prototype,Object.defineProperty(_1,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),Object.defineProperty(_1,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}));var _1;ii.add=function(e,t,i){return gt.add(e.array,t.array,i.array),e._dirty=!0,e};ii.set=function(e,t,i){return gt.set(e.array,t,i),e._dirty=!0,e};ii.copy=function(e,t){return gt.copy(e.array,t.array),e._dirty=!0,e};ii.cross=function(e,t,i){return gt.cross(e.array,t.array,i.array),e._dirty=!0,e};ii.dist=function(e,t){return gt.distance(e.array,t.array)};ii.distance=ii.dist;ii.div=function(e,t,i){return gt.divide(e.array,t.array,i.array),e._dirty=!0,e};ii.divide=ii.div;ii.dot=function(e,t){return gt.dot(e.array,t.array)};ii.len=function(e){return gt.length(e.array)};ii.lerp=function(e,t,i,r){return gt.lerp(e.array,t.array,i.array,r),e._dirty=!0,e};ii.min=function(e,t,i){return gt.min(e.array,t.array,i.array),e._dirty=!0,e};ii.max=function(e,t,i){return gt.max(e.array,t.array,i.array),e._dirty=!0,e};ii.mul=function(e,t,i){return gt.multiply(e.array,t.array,i.array),e._dirty=!0,e};ii.multiply=ii.mul;ii.negate=function(e,t){return gt.negate(e.array,t.array),e._dirty=!0,e};ii.normalize=function(e,t){return gt.normalize(e.array,t.array),e._dirty=!0,e};ii.random=function(e,t){return gt.random(e.array,t),e._dirty=!0,e};ii.scale=function(e,t,i){return gt.scale(e.array,t.array,i),e._dirty=!0,e};ii.scaleAndAdd=function(e,t,i,r){return gt.scaleAndAdd(e.array,t.array,i.array,r),e._dirty=!0,e};ii.sqrDist=function(e,t){return gt.sqrDist(e.array,t.array)};ii.squaredDistance=ii.sqrDist;ii.sqrLen=function(e){return gt.sqrLen(e.array)};ii.squaredLength=ii.sqrLen;ii.sub=function(e,t,i){return gt.subtract(e.array,t.array,i.array),e._dirty=!0,e};ii.subtract=ii.sub;ii.transformMat2=function(e,t,i){return gt.transformMat2(e.array,t.array,i.array),e._dirty=!0,e};ii.transformMat2d=function(e,t,i){return gt.transformMat2d(e.array,t.array,i.array),e._dirty=!0,e};ii.transformMat3=function(e,t,i){return gt.transformMat3(e.array,t.array,i.array),e._dirty=!0,e};ii.transformMat4=function(e,t,i){return gt.transformMat4(e.array,t.array,i.array),e._dirty=!0,e};var rn=ii;var tk=1,ik=2,b1=3,rk={};function lH(e){for(var t=e.split(`
`),i=0,r=t.length;i<r;i++)t[i]=i+1+": "+t[i];return t.join(`
`)}function nk(e,t,i){if(!e.getShaderParameter(t,e.COMPILE_STATUS))return[e.getShaderInfoLog(t),lH(i)].join(`
`)}var ak=new Ai.Float32Array(16),cH=Ui.extend({uniformSemantics:{},attributes:{}},function(){this._locations={},this._textureSlot=0,this._program=null},{bind:function(e){this._textureSlot=0,e.gl.useProgram(this._program)},hasUniform:function(e){var t=this._locations[e];return t!=null},useTextureSlot:function(e,t,i){t&&(e.gl.activeTexture(e.gl.TEXTURE0+i),t.isRenderable()?t.bind(e):t.unbind(e))},currentTextureSlot:function(){return this._textureSlot},resetTextureSlot:function(e){this._textureSlot=e||0},takeCurrentTextureSlot:function(e,t){var i=this._textureSlot;return this.useTextureSlot(e,t,i),this._textureSlot++,i},setUniform:function(e,t,i,r){var n=this._locations,a=n[i];if(a==null)return!1;switch(t){case"m4":if(!(r instanceof Float32Array)){for(var o=0;o<r.length;o++)ak[o]=r[o];r=ak}e.uniformMatrix4fv(a,!1,r);break;case"2i":e.uniform2i(a,r[0],r[1]);break;case"2f":e.uniform2f(a,r[0],r[1]);break;case"3i":e.uniform3i(a,r[0],r[1],r[2]);break;case"3f":e.uniform3f(a,r[0],r[1],r[2]);break;case"4i":e.uniform4i(a,r[0],r[1],r[2],r[3]);break;case"4f":e.uniform4f(a,r[0],r[1],r[2],r[3]);break;case"1i":e.uniform1i(a,r);break;case"1f":e.uniform1f(a,r);break;case"1fv":e.uniform1fv(a,r);break;case"1iv":e.uniform1iv(a,r);break;case"2iv":e.uniform2iv(a,r);break;case"2fv":e.uniform2fv(a,r);break;case"3iv":e.uniform3iv(a,r);break;case"3fv":e.uniform3fv(a,r);break;case"4iv":e.uniform4iv(a,r);break;case"4fv":e.uniform4fv(a,r);break;case"m2":case"m2v":e.uniformMatrix2fv(a,!1,r);break;case"m3":case"m3v":e.uniformMatrix3fv(a,!1,r);break;case"m4v":if(Array.isArray(r)&&Array.isArray(r[0])){for(var s=new Ai.Float32Array(r.length*16),l=0,o=0;o<r.length;o++)for(var c=r[o],d=0;d<16;d++)s[l++]=c[d];e.uniformMatrix4fv(a,!1,s)}else e.uniformMatrix4fv(a,!1,r);break}return!0},setUniformOfSemantic:function(e,t,i){var r=this.uniformSemantics[t];return r?this.setUniform(e,r.type,r.symbol,i):!1},enableAttributes:function(e,t,i){var r=e.gl,n=this._program,a=this._locations,o;i?o=i.__enabledAttributeList:o=rk[e.__uid__],o||(i?o=i.__enabledAttributeList=[]:o=rk[e.__uid__]=[]);for(var s=[],l=0;l<t.length;l++){var c=t[l];if(!this.attributes[c]){s[l]=-1;continue}var d=a[c];if(d==null){if(d=r.getAttribLocation(n,c),d===-1){s[l]=-1;continue}a[c]=d}s[l]=d,o[d]?o[d]=ik:o[d]=tk}for(var l=0;l<o.length;l++)switch(o[l]){case tk:r.enableVertexAttribArray(l),o[l]=b1;break;case ik:o[l]=b1;break;case b1:r.disableVertexAttribArray(l),o[l]=0;break}return s},getAttribLocation:function(e,t){var i=this._locations,r=i[t];return r==null&&(r=e.getAttribLocation(this._program,t),i[t]=r),r},buildProgram:function(e,t,i,r){var n=e.createShader(e.VERTEX_SHADER),a=e.createProgram();e.shaderSource(n,i),e.compileShader(n);var o=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(o,r),e.compileShader(o);var s=nk(e,n,i);if(s||(s=nk(e,o,r),s))return s;if(e.attachShader(a,n),e.attachShader(a,o),t.attributeSemantics.POSITION)e.bindAttribLocation(a,0,t.attributeSemantics.POSITION.symbol);else{var l=Object.keys(this.attributes);e.bindAttribLocation(a,0,l[0])}if(e.linkProgram(a),e.deleteShader(n),e.deleteShader(o),this._program=a,this.vertexCode=i,this.fragmentCode=r,!e.getProgramParameter(a,e.LINK_STATUS))return`Could not link program
`+e.getProgramInfoLog(a);for(var c=0;c<t.uniforms.length;c++){var d=t.uniforms[c];this._locations[d]=e.getUniformLocation(a,d)}}}),ok=cH;var dH=/for\s*?\(int\s*?_idx_\s*\=\s*([\w-]+)\;\s*_idx_\s*<\s*([\w-]+);\s*_idx_\s*\+\+\s*\)\s*\{\{([\s\S]+?)(?=\}\})\}\}/g;function sk(e,t,i){function r(o,s,l,c){var d="";isNaN(s)&&(s in t?s=t[s]:s=n[s]),isNaN(l)&&(l in t?l=t[l]:l=n[l]);for(var u=parseInt(s);u<parseInt(l);u++)d+="{"+c.replace(/float\s*\(\s*_idx_\s*\)/g,u.toFixed(1)).replace(/_idx_/g,u)+"}";return d}var n={};for(var a in i)n[a+"_COUNT"]=i[a];return e.replace(dH,r)}function x1(e,t,i){var r=[];if(t)for(var n in t){var a=t[n];a>0&&r.push("#define "+n.toUpperCase()+"_COUNT "+a)}if(i)for(var o=0;o<i.length;o++){var s=i[o];r.push("#define "+s.toUpperCase()+"_ENABLED")}for(var s in e){var l=e[s];l===null?r.push("#define "+s):r.push("#define "+s+" "+l.toString())}return r.join(`
`)}function uH(e){for(var t=[],i=0;i<e.length;i++)t.push("#extension GL_"+e[i]+" : enable");return t.join(`
`)}function hH(e){return["precision",e,"float"].join(" ")+`;
`+["precision",e,"int"].join(" ")+`;
`+["precision",e,"sampler2D"].join(" ")+`;
`}function lk(e){this._renderer=e,this._cache={}}lk.prototype.getProgram=function(e,t,i){var r=this._cache,n=e.isSkinnedMesh&&e.isSkinnedMesh(),a=e.isInstancedMesh&&e.isInstancedMesh(),o="s"+t.shader.shaderID+"m"+t.getProgramKey();i&&(o+="se"+i.getProgramKey(e.lightGroup)),n&&(o+=",sk"+e.joints.length),a&&(o+=",is");var x=r[o];if(x)return x;var s=i?i.getLightsNumbers(e.lightGroup):{},l=this._renderer,c=l.gl,d=t.getEnabledTextures(),u="";if(n){var h={SKINNING:null,JOINT_COUNT:e.joints.length};e.joints.length>l.getMaxJointNumber()&&(h.USE_SKIN_MATRICES_TEXTURE=null),u+=`
`+x1(h)+`
`}a&&(u+=`
#define INSTANCING
`);var m=u+x1(t.vertexDefines,s,d),f=u+x1(t.fragmentDefines,s,d),p=m+`
`+t.shader.vertex,g=["OES_standard_derivatives","EXT_shader_texture_lod"].filter(function(y){return l.getGLExtension(y)!=null});g.indexOf("EXT_shader_texture_lod")>=0&&(f+=`
#define SUPPORT_TEXTURE_LOD`),g.indexOf("OES_standard_derivatives")>=0&&(f+=`
#define SUPPORT_STANDARD_DERIVATIVES`);var v=uH(g)+`
`+hH(t.precision)+`
`+f+`
`+t.shader.fragment,b=sk(p,t.vertexDefines,s),_=sk(v,t.fragmentDefines,s),x=new ok;x.uniformSemantics=t.shader.uniformSemantics,x.attributes=t.shader.attributes;var w=x.buildProgram(c,t.shader,b,_);return x.__error=w,r[o]=x,x};var ck=lk;var dk=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g,mH=/attribute\s+(float|int|vec2|vec3|vec4)\s+([\s\S]*?);/g,uk=/#define\s+(\w+)?(\s+[\d-.]+)?\s*;?\s*\n/g,pH={bool:"1i",int:"1i",sampler2D:"t",samplerCube:"t",float:"1f",vec2:"2f",vec3:"3f",vec4:"4f",ivec2:"2i",ivec3:"3i",ivec4:"4i",mat2:"m2",mat3:"m3",mat4:"m4"};function dl(e){for(var t=[],i=0;i<e;i++)t[i]=0;return t}var hk={bool:function(){return!0},int:function(){return 0},float:function(){return 0},sampler2D:function(){return null},samplerCube:function(){return null},vec2:function(){return dl(2)},vec3:function(){return dl(3)},vec4:function(){return dl(4)},ivec2:function(){return dl(2)},ivec3:function(){return dl(3)},ivec4:function(){return dl(4)},mat2:function(){return dl(4)},mat3:function(){return dl(9)},mat4:function(){return dl(16)},array:function(){return[]}},w1=["POSITION","NORMAL","BINORMAL","TANGENT","TEXCOORD","TEXCOORD_0","TEXCOORD_1","COLOR","JOINT","WEIGHT"],fk=["SKIN_MATRIX","VIEWPORT_SIZE","VIEWPORT","DEVICEPIXELRATIO","WINDOW_SIZE","NEAR","FAR","TIME"],gk=["WORLD","VIEW","PROJECTION","WORLDVIEW","VIEWPROJECTION","WORLDVIEWPROJECTION","WORLDINVERSE","VIEWINVERSE","PROJECTIONINVERSE","WORLDVIEWINVERSE","VIEWPROJECTIONINVERSE","WORLDVIEWPROJECTIONINVERSE","WORLDTRANSPOSE","VIEWTRANSPOSE","PROJECTIONTRANSPOSE","WORLDVIEWTRANSPOSE","VIEWPROJECTIONTRANSPOSE","WORLDVIEWPROJECTIONTRANSPOSE","WORLDINVERSETRANSPOSE","VIEWINVERSETRANSPOSE","PROJECTIONINVERSETRANSPOSE","WORLDVIEWINVERSETRANSPOSE","VIEWPROJECTIONINVERSETRANSPOSE","WORLDVIEWPROJECTIONINVERSETRANSPOSE"],fH={vec4:4,vec3:3,vec2:2,float:1},y1={},vk={};function gH(e,t){var i="vertex:"+e+"fragment:"+t;if(y1[i])return y1[i];var r=vr.genGUID();return y1[i]=r,vk[r]={vertex:e,fragment:t},r}function mk(e){return e.replace(/[ \t]*\/\/.*\n/g,"").replace(/[ \t]*\/\*[\s\S]*?\*\//g,"")}function bh(){console.error("Wrong uniform/attributes syntax")}function pk(e,t){for(var i=/[,=\(\):]/,r=t.replace(/:\s*\[\s*(.*)\s*\]/g,"="+e+"($1)").replace(/\s+/g,"").split(/(?=[,=\(\):])/g),n=[],a=0;a<r.length;a++)r[a].match(i)?n.push(r[a].charAt(0),r[a].slice(1)):n.push(r[a]);r=n;var o=0,s=1,l=2,c=3,d=4,u=5,h=o,m={},f=null,p;g(r[0]);function g(_){_||bh();var x=_.match(/\[(.*?)\]/);p=_.replace(/\[(.*?)\]/,""),m[p]={},x&&(m[p].isArray=!0,m[p].arraySize=x[1])}for(var a=1;a<r.length;a++){var v=r[a];if(v){if(v==="="){if(h!==o&&h!==c){bh();break}h=s;continue}else if(v===":"){h=d;continue}else if(v===","){if(h===l){if(!(f instanceof Array)){bh();break}f.push(+r[++a])}else h=u;continue}else if(v===")"){m[p].value=new Ai.Float32Array(f),f=null,h=u;continue}else if(v==="("){if(h!==l){bh();break}if(!(f instanceof Array)){bh();break}f.push(+r[++a]);continue}else if(v.indexOf("vec")>=0){if(h!==s&&h!==d){bh();break}h=l,f=[];continue}else if(h===s){e==="bool"?m[p].value=v==="true":m[p].value=parseFloat(v),f=null;continue}else if(h===d){var b=v;w1.indexOf(b)>=0||fk.indexOf(b)>=0||gk.indexOf(b)>=0?m[p].semantic=b:b==="ignore"||b==="unconfigurable"?m[p].ignore=!0:e==="bool"?m[p].value=b==="true":m[p].value=parseFloat(b);continue}g(v),h=o}}return m}function Xr(e,t){typeof e=="object"&&(t=e.fragment,e=e.vertex),e=mk(e),t=mk(t),this._shaderID=gH(e,t),this._vertexCode=Xr.parseImport(e),this._fragmentCode=Xr.parseImport(t),this.attributeSemantics={},this.matrixSemantics={},this.uniformSemantics={},this.matrixSemanticKeys=[],this.uniformTemplates={},this.attributes={},this.textures={},this.vertexDefines={},this.fragmentDefines={},this._parseAttributes(),this._parseUniforms(),this._parseDefines()}Xr.prototype={constructor:Xr,createUniforms:function(){var e={};for(var t in this.uniformTemplates){var i=this.uniformTemplates[t];e[t]={type:i.type,value:i.value()}}return e},_parseImport:function(){this._vertexCode=Xr.parseImport(this.vertex),this._fragmentCode=Xr.parseImport(this.fragment)},_addSemanticUniform:function(e,t,i){if(w1.indexOf(i)>=0)this.attributeSemantics[i]={symbol:e,type:t};else if(gk.indexOf(i)>=0){var r=!1,n=i;i.match(/TRANSPOSE$/)&&(r=!0,n=i.slice(0,-9)),this.matrixSemantics[i]={symbol:e,type:t,isTranspose:r,semanticNoTranspose:n}}else fk.indexOf(i)>=0&&(this.uniformSemantics[i]={symbol:e,type:t})},_addMaterialUniform:function(e,t,i,r,n,a){a[e]={type:i,value:n?hk.array:r||hk[t],semantic:null}},_parseUniforms:function(){var e={},t=this,i="vertex";this._uniformList=[],this._vertexCode=this._vertexCode.replace(dk,n),i="fragment",this._fragmentCode=this._fragmentCode.replace(dk,n),t.matrixSemanticKeys=Object.keys(this.matrixSemantics);function r(a){return a!=null?function(){return a}:null}function n(a,o,s){var l=pk(o,s),c=[];for(var d in l){var u=l[d],h=u.semantic,m=d,f=pH[o],p=r(l[d].value);l[d].isArray&&(m+="["+l[d].arraySize+"]",f+="v"),c.push(m),t._uniformList.push(d),u.ignore||((o==="sampler2D"||o==="samplerCube")&&(t.textures[d]={shaderType:i,type:o}),h?t._addSemanticUniform(d,f,h):t._addMaterialUniform(d,o,f,p,l[d].isArray,e))}return c.length>0?"uniform "+o+" "+c.join(",")+`;
`:""}this.uniformTemplates=e},_parseAttributes:function(){var e={},t=this;this._vertexCode=this._vertexCode.replace(mH,i);function i(r,n,a){var o=pk(n,a),s=fH[n]||1,l=[];for(var c in o){var d=o[c].semantic;if(e[c]={type:"float",size:s,semantic:d||null},d){if(w1.indexOf(d)<0)throw new Error('Unkown semantic "'+d+'"');t.attributeSemantics[d]={symbol:c,type:n}}l.push(c)}return"attribute "+n+" "+l.join(",")+`;
`}this.attributes=e},_parseDefines:function(){var e=this,t="vertex";this._vertexCode=this._vertexCode.replace(uk,i),t="fragment",this._fragmentCode=this._fragmentCode.replace(uk,i);function i(r,n,a){var o=t==="vertex"?e.vertexDefines:e.fragmentDefines;return o[n]||(a==="false"?o[n]=!1:a==="true"?o[n]=!0:o[n]=a?isNaN(parseFloat(a))?a.trim():parseFloat(a):null),""}},clone:function(){var e=vk[this._shaderID],t=new Xr(e.vertex,e.fragment);return t}};Object.defineProperty&&(Object.defineProperty(Xr.prototype,"shaderID",{get:function(){return this._shaderID}}),Object.defineProperty(Xr.prototype,"vertex",{get:function(){return this._vertexCode}}),Object.defineProperty(Xr.prototype,"fragment",{get:function(){return this._fragmentCode}}),Object.defineProperty(Xr.prototype,"uniforms",{get:function(){return this._uniformList}}));var vH=/(@import)\s*([0-9a-zA-Z_\-\.]*)/g;Xr.parseImport=function(e){return e=e.replace(vH,function(n,i,r){var n=Xr.source(r);return n?Xr.parseImport(n):(console.error('Shader chunk "'+r+'" not existed in library'),"")}),e};var _H=/(@export)\s*([0-9a-zA-Z_\-\.]*)\s*\n([\s\S]*?)@end/g;Xr.import=function(e){e.replace(_H,function(t,i,r,a){var a=a.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+\x24)/g,"");if(a){for(var o=r.split("."),s=Xr.codes,l=0,c;l<o.length-1;)c=o[l++],s[c]||(s[c]={}),s=s[c];c=o[l],s[c]=a}return a})};Xr.codes={};Xr.source=function(e){for(var t=e.split("."),i=Xr.codes,r=0;i&&r<t.length;){var n=t[r++];i=i[n]}return typeof i!="string"?(console.error('Shader "'+e+'" not existed in library'),""):i};var Re=Xr;var p0=`@export clay.prez.vertex
uniform mat4 WVP : WORLDVIEWPROJECTION;
attribute vec3 pos : POSITION;
attribute vec2 uv : TEXCOORD_0;
uniform vec2 uvRepeat : [1.0, 1.0];
uniform vec2 uvOffset : [0.0, 0.0];
@import clay.chunk.skinning_header
@import clay.chunk.instancing_header
varying vec2 v_Texcoord;
void main()
{
 vec4 P = vec4(pos, 1.0);
#ifdef SKINNING
 @import clay.chunk.skin_matrix
 P = skinMatrixWS * P;
#endif
#ifdef INSTANCING
 @import clay.chunk.instancing_matrix
 P = instanceMat * P;
#endif
 gl_Position = WVP * P;
 v_Texcoord = uv * uvRepeat + uvOffset;
}
@end
@export clay.prez.fragment
uniform sampler2D alphaMap;
uniform float alphaCutoff: 0.0;
varying vec2 v_Texcoord;
void main()
{
 if (alphaCutoff > 0.0) {
 if (texture2D(alphaMap, v_Texcoord).a <= alphaCutoff) {
 discard;
 }
 }
 gl_FragColor = vec4(0.0,0.0,0.0,1.0);
}
@end`;var Xi={};Xi.create=function(){var e=new lr(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};Xi.clone=function(e){var t=new lr(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t};Xi.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e};Xi.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};Xi.transpose=function(e,t){if(e===t){var i=t[1],r=t[2],n=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=i,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=a,e[11]=t[14],e[12]=n,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e};Xi.invert=function(e,t){var i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],d=t[8],u=t[9],h=t[10],m=t[11],f=t[12],p=t[13],g=t[14],v=t[15],b=i*s-r*o,_=i*l-n*o,x=i*c-a*o,w=r*l-n*s,y=r*c-a*s,M=n*c-a*l,T=d*p-u*f,C=d*g-h*f,N=d*v-m*f,D=u*g-h*p,k=u*v-m*p,U=h*v-m*g,F=b*U-_*k+x*D+w*N-y*C+M*T;return F?(F=1/F,e[0]=(s*U-l*k+c*D)*F,e[1]=(n*k-r*U-a*D)*F,e[2]=(p*M-g*y+v*w)*F,e[3]=(h*y-u*M-m*w)*F,e[4]=(l*N-o*U-c*C)*F,e[5]=(i*U-n*N+a*C)*F,e[6]=(g*x-f*M-v*_)*F,e[7]=(d*M-h*x+m*_)*F,e[8]=(o*k-s*N+c*T)*F,e[9]=(r*N-i*k-a*T)*F,e[10]=(f*y-p*x+v*b)*F,e[11]=(u*x-d*y-m*b)*F,e[12]=(s*C-o*D-l*T)*F,e[13]=(i*D-r*C+n*T)*F,e[14]=(p*_-f*w-g*b)*F,e[15]=(d*w-u*_+h*b)*F,e):null};Xi.adjoint=function(e,t){var i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],d=t[8],u=t[9],h=t[10],m=t[11],f=t[12],p=t[13],g=t[14],v=t[15];return e[0]=s*(h*v-m*g)-u*(l*v-c*g)+p*(l*m-c*h),e[1]=-(r*(h*v-m*g)-u*(n*v-a*g)+p*(n*m-a*h)),e[2]=r*(l*v-c*g)-s*(n*v-a*g)+p*(n*c-a*l),e[3]=-(r*(l*m-c*h)-s*(n*m-a*h)+u*(n*c-a*l)),e[4]=-(o*(h*v-m*g)-d*(l*v-c*g)+f*(l*m-c*h)),e[5]=i*(h*v-m*g)-d*(n*v-a*g)+f*(n*m-a*h),e[6]=-(i*(l*v-c*g)-o*(n*v-a*g)+f*(n*c-a*l)),e[7]=i*(l*m-c*h)-o*(n*m-a*h)+d*(n*c-a*l),e[8]=o*(u*v-m*p)-d*(s*v-c*p)+f*(s*m-c*u),e[9]=-(i*(u*v-m*p)-d*(r*v-a*p)+f*(r*m-a*u)),e[10]=i*(s*v-c*p)-o*(r*v-a*p)+f*(r*c-a*s),e[11]=-(i*(s*m-c*u)-o*(r*m-a*u)+d*(r*c-a*s)),e[12]=-(o*(u*g-h*p)-d*(s*g-l*p)+f*(s*h-l*u)),e[13]=i*(u*g-h*p)-d*(r*g-n*p)+f*(r*h-n*u),e[14]=-(i*(s*g-l*p)-o*(r*g-n*p)+f*(r*l-n*s)),e[15]=i*(s*h-l*u)-o*(r*h-n*u)+d*(r*l-n*s),e};Xi.determinant=function(e){var t=e[0],i=e[1],r=e[2],n=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],d=e[9],u=e[10],h=e[11],m=e[12],f=e[13],p=e[14],g=e[15],v=t*o-i*a,b=t*s-r*a,_=t*l-n*a,x=i*s-r*o,w=i*l-n*o,y=r*l-n*s,M=c*f-d*m,T=c*p-u*m,C=c*g-h*m,N=d*p-u*f,D=d*g-h*f,k=u*g-h*p;return v*k-b*D+_*N+x*C-w*T+y*M};Xi.multiply=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],d=t[7],u=t[8],h=t[9],m=t[10],f=t[11],p=t[12],g=t[13],v=t[14],b=t[15],_=i[0],x=i[1],w=i[2],y=i[3];return e[0]=_*r+x*s+w*u+y*p,e[1]=_*n+x*l+w*h+y*g,e[2]=_*a+x*c+w*m+y*v,e[3]=_*o+x*d+w*f+y*b,_=i[4],x=i[5],w=i[6],y=i[7],e[4]=_*r+x*s+w*u+y*p,e[5]=_*n+x*l+w*h+y*g,e[6]=_*a+x*c+w*m+y*v,e[7]=_*o+x*d+w*f+y*b,_=i[8],x=i[9],w=i[10],y=i[11],e[8]=_*r+x*s+w*u+y*p,e[9]=_*n+x*l+w*h+y*g,e[10]=_*a+x*c+w*m+y*v,e[11]=_*o+x*d+w*f+y*b,_=i[12],x=i[13],w=i[14],y=i[15],e[12]=_*r+x*s+w*u+y*p,e[13]=_*n+x*l+w*h+y*g,e[14]=_*a+x*c+w*m+y*v,e[15]=_*o+x*d+w*f+y*b,e};Xi.multiplyAffine=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=t[4],s=t[5],l=t[6],c=t[8],d=t[9],u=t[10],h=t[12],m=t[13],f=t[14],p=i[0],g=i[1],v=i[2];return e[0]=p*r+g*o+v*c,e[1]=p*n+g*s+v*d,e[2]=p*a+g*l+v*u,p=i[4],g=i[5],v=i[6],e[4]=p*r+g*o+v*c,e[5]=p*n+g*s+v*d,e[6]=p*a+g*l+v*u,p=i[8],g=i[9],v=i[10],e[8]=p*r+g*o+v*c,e[9]=p*n+g*s+v*d,e[10]=p*a+g*l+v*u,p=i[12],g=i[13],v=i[14],e[12]=p*r+g*o+v*c+h,e[13]=p*n+g*s+v*d+m,e[14]=p*a+g*l+v*u+f,e};Xi.mul=Xi.multiply;Xi.mulAffine=Xi.multiplyAffine;Xi.translate=function(e,t,i){var r=i[0],n=i[1],a=i[2],o,s,l,c,d,u,h,m,f,p,g,v;return t===e?(e[12]=t[0]*r+t[4]*n+t[8]*a+t[12],e[13]=t[1]*r+t[5]*n+t[9]*a+t[13],e[14]=t[2]*r+t[6]*n+t[10]*a+t[14],e[15]=t[3]*r+t[7]*n+t[11]*a+t[15]):(o=t[0],s=t[1],l=t[2],c=t[3],d=t[4],u=t[5],h=t[6],m=t[7],f=t[8],p=t[9],g=t[10],v=t[11],e[0]=o,e[1]=s,e[2]=l,e[3]=c,e[4]=d,e[5]=u,e[6]=h,e[7]=m,e[8]=f,e[9]=p,e[10]=g,e[11]=v,e[12]=o*r+d*n+f*a+t[12],e[13]=s*r+u*n+p*a+t[13],e[14]=l*r+h*n+g*a+t[14],e[15]=c*r+m*n+v*a+t[15]),e};Xi.scale=function(e,t,i){var r=i[0],n=i[1],a=i[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e};Xi.rotate=function(e,t,i,r){var n=r[0],a=r[1],o=r[2],s=Math.sqrt(n*n+a*a+o*o),l,c,d,u,h,m,f,p,g,v,b,_,x,w,y,M,T,C,N,D,k,U,F,H;return Math.abs(s)<Qp?null:(s=1/s,n*=s,a*=s,o*=s,l=Math.sin(i),c=Math.cos(i),d=1-c,u=t[0],h=t[1],m=t[2],f=t[3],p=t[4],g=t[5],v=t[6],b=t[7],_=t[8],x=t[9],w=t[10],y=t[11],M=n*n*d+c,T=a*n*d+o*l,C=o*n*d-a*l,N=n*a*d-o*l,D=a*a*d+c,k=o*a*d+n*l,U=n*o*d+a*l,F=a*o*d-n*l,H=o*o*d+c,e[0]=u*M+p*T+_*C,e[1]=h*M+g*T+x*C,e[2]=m*M+v*T+w*C,e[3]=f*M+b*T+y*C,e[4]=u*N+p*D+_*k,e[5]=h*N+g*D+x*k,e[6]=m*N+v*D+w*k,e[7]=f*N+b*D+y*k,e[8]=u*U+p*F+_*H,e[9]=h*U+g*F+x*H,e[10]=m*U+v*F+w*H,e[11]=f*U+b*F+y*H,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)};Xi.rotateX=function(e,t,i){var r=Math.sin(i),n=Math.cos(i),a=t[4],o=t[5],s=t[6],l=t[7],c=t[8],d=t[9],u=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*n+c*r,e[5]=o*n+d*r,e[6]=s*n+u*r,e[7]=l*n+h*r,e[8]=c*n-a*r,e[9]=d*n-o*r,e[10]=u*n-s*r,e[11]=h*n-l*r,e};Xi.rotateY=function(e,t,i){var r=Math.sin(i),n=Math.cos(i),a=t[0],o=t[1],s=t[2],l=t[3],c=t[8],d=t[9],u=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n-c*r,e[1]=o*n-d*r,e[2]=s*n-u*r,e[3]=l*n-h*r,e[8]=a*r+c*n,e[9]=o*r+d*n,e[10]=s*r+u*n,e[11]=l*r+h*n,e};Xi.rotateZ=function(e,t,i){var r=Math.sin(i),n=Math.cos(i),a=t[0],o=t[1],s=t[2],l=t[3],c=t[4],d=t[5],u=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n+c*r,e[1]=o*n+d*r,e[2]=s*n+u*r,e[3]=l*n+h*r,e[4]=c*n-a*r,e[5]=d*n-o*r,e[6]=u*n-s*r,e[7]=h*n-l*r,e};Xi.fromRotationTranslation=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=t[3],s=r+r,l=n+n,c=a+a,d=r*s,u=r*l,h=r*c,m=n*l,f=n*c,p=a*c,g=o*s,v=o*l,b=o*c;return e[0]=1-(m+p),e[1]=u+b,e[2]=h-v,e[3]=0,e[4]=u-b,e[5]=1-(d+p),e[6]=f+g,e[7]=0,e[8]=h+v,e[9]=f-g,e[10]=1-(d+m),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e};Xi.fromQuat=function(e,t){var i=t[0],r=t[1],n=t[2],a=t[3],o=i+i,s=r+r,l=n+n,c=i*o,d=r*o,u=r*s,h=n*o,m=n*s,f=n*l,p=a*o,g=a*s,v=a*l;return e[0]=1-u-f,e[1]=d+v,e[2]=h-g,e[3]=0,e[4]=d-v,e[5]=1-c-f,e[6]=m+p,e[7]=0,e[8]=h+g,e[9]=m-p,e[10]=1-c-u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};Xi.frustum=function(e,t,i,r,n,a,o){var s=1/(i-t),l=1/(n-r),c=1/(a-o);return e[0]=a*2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*l,e[6]=0,e[7]=0,e[8]=(i+t)*s,e[9]=(n+r)*l,e[10]=(o+a)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*c,e[15]=0,e};Xi.perspective=function(e,t,i,r,n){var a=1/Math.tan(t/2),o=1/(r-n);return e[0]=a/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(n+r)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*n*r*o,e[15]=0,e};Xi.ortho=function(e,t,i,r,n,a,o){var s=1/(t-i),l=1/(r-n),c=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+i)*s,e[13]=(n+r)*l,e[14]=(o+a)*c,e[15]=1,e};Xi.lookAt=function(e,t,i,r){var n,a,o,s,l,c,d,u,h,m,f=t[0],p=t[1],g=t[2],v=r[0],b=r[1],_=r[2],x=i[0],w=i[1],y=i[2];return Math.abs(f-x)<Qp&&Math.abs(p-w)<Qp&&Math.abs(g-y)<Qp?Xi.identity(e):(d=f-x,u=p-w,h=g-y,m=1/Math.sqrt(d*d+u*u+h*h),d*=m,u*=m,h*=m,n=b*h-_*u,a=_*d-v*h,o=v*u-b*d,m=Math.sqrt(n*n+a*a+o*o),m?(m=1/m,n*=m,a*=m,o*=m):(n=0,a=0,o=0),s=u*o-h*a,l=h*n-d*o,c=d*a-u*n,m=Math.sqrt(s*s+l*l+c*c),m?(m=1/m,s*=m,l*=m,c*=m):(s=0,l=0,c=0),e[0]=n,e[1]=s,e[2]=d,e[3]=0,e[4]=a,e[5]=l,e[6]=u,e[7]=0,e[8]=o,e[9]=c,e[10]=h,e[11]=0,e[12]=-(n*f+a*p+o*g),e[13]=-(s*f+l*p+c*g),e[14]=-(d*f+u*p+h*g),e[15]=1,e)};Xi.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))};var ke=Xi;var wt={};wt.create=function(){var e=new lr(3);return e[0]=0,e[1]=0,e[2]=0,e};wt.clone=function(e){var t=new lr(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t};wt.fromValues=function(e,t,i){var r=new lr(3);return r[0]=e,r[1]=t,r[2]=i,r};wt.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e};wt.set=function(e,t,i,r){return e[0]=t,e[1]=i,e[2]=r,e};wt.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e};wt.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e};wt.sub=wt.subtract;wt.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e};wt.mul=wt.multiply;wt.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e};wt.div=wt.divide;wt.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e};wt.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e};wt.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e};wt.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e};wt.distance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return Math.sqrt(i*i+r*r+n*n)};wt.dist=wt.distance;wt.squaredDistance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return i*i+r*r+n*n};wt.sqrDist=wt.squaredDistance;wt.length=function(e){var t=e[0],i=e[1],r=e[2];return Math.sqrt(t*t+i*i+r*r)};wt.len=wt.length;wt.squaredLength=function(e){var t=e[0],i=e[1],r=e[2];return t*t+i*i+r*r};wt.sqrLen=wt.squaredLength;wt.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e};wt.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e};wt.normalize=function(e,t){var i=t[0],r=t[1],n=t[2],a=i*i+r*r+n*n;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e};wt.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]};wt.cross=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=i[0],s=i[1],l=i[2];return e[0]=n*l-a*s,e[1]=a*o-r*l,e[2]=r*s-n*o,e};wt.lerp=function(e,t,i,r){var n=t[0],a=t[1],o=t[2];return e[0]=n+r*(i[0]-n),e[1]=a+r*(i[1]-a),e[2]=o+r*(i[2]-o),e};wt.random=function(e,t){t=t||1;var i=cc()*2*Math.PI,r=cc()*2-1,n=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(i)*n,e[1]=Math.sin(i)*n,e[2]=r*t,e};wt.transformMat4=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=i[3]*r+i[7]*n+i[11]*a+i[15];return o=o||1,e[0]=(i[0]*r+i[4]*n+i[8]*a+i[12])/o,e[1]=(i[1]*r+i[5]*n+i[9]*a+i[13])/o,e[2]=(i[2]*r+i[6]*n+i[10]*a+i[14])/o,e};wt.transformMat3=function(e,t,i){var r=t[0],n=t[1],a=t[2];return e[0]=r*i[0]+n*i[3]+a*i[6],e[1]=r*i[1]+n*i[4]+a*i[7],e[2]=r*i[2]+n*i[5]+a*i[8],e};wt.transformQuat=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=i[0],s=i[1],l=i[2],c=i[3],d=c*r+s*a-l*n,u=c*n+l*r-o*a,h=c*a+o*n-s*r,m=-o*r-s*n-l*a;return e[0]=d*c+m*-o+u*-l-h*-s,e[1]=u*c+m*-s+h*-o-d*-l,e[2]=h*c+m*-l+d*-s-u*-o,e};wt.rotateX=function(e,t,i,r){var n=[],a=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],a[0]=n[0],a[1]=n[1]*Math.cos(r)-n[2]*Math.sin(r),a[2]=n[1]*Math.sin(r)+n[2]*Math.cos(r),e[0]=a[0]+i[0],e[1]=a[1]+i[1],e[2]=a[2]+i[2],e};wt.rotateY=function(e,t,i,r){var n=[],a=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],a[0]=n[2]*Math.sin(r)+n[0]*Math.cos(r),a[1]=n[1],a[2]=n[2]*Math.cos(r)-n[0]*Math.sin(r),e[0]=a[0]+i[0],e[1]=a[1]+i[1],e[2]=a[2]+i[2],e};wt.rotateZ=function(e,t,i,r){var n=[],a=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],a[0]=n[0]*Math.cos(r)-n[1]*Math.sin(r),a[1]=n[0]*Math.sin(r)+n[1]*Math.cos(r),a[2]=n[2],e[0]=a[0]+i[0],e[1]=a[1]+i[1],e[2]=a[2]+i[2],e};wt.forEach=function(){var e=wt.create();return function(t,i,r,n,a,o){var s,l;for(i||(i=3),r||(r=0),n?l=Math.min(n*i+r,t.length):l=t.length,s=r;s<l;s+=i)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}();wt.angle=function(e,t){var i=wt.fromValues(e[0],e[1],e[2]),r=wt.fromValues(t[0],t[1],t[2]);wt.normalize(i,i),wt.normalize(r,r);var n=wt.dot(i,r);return n>1?0:Math.acos(n)};var Y=wt;Re.import(p0);var dr=ke.create,_k={};function bk(e){return e.material}function bH(e,t,i){return t.uniforms[i].value}function xH(e,t,i,r){return i!==r}function yH(e){return!0}function xk(){}var yk={float:se.FLOAT,byte:se.BYTE,ubyte:se.UNSIGNED_BYTE,short:se.SHORT,ushort:se.UNSIGNED_SHORT};function wH(e,t,i){this.availableAttributes=e,this.availableAttributeSymbols=t,this.indicesBuffer=i,this.vao=null}function CH(e){var t,i;this.bind=function(r){t||(t=Ai.createCanvas(),t.width=t.height=1,t.getContext("2d"));var n=r.gl,a=!i;a&&(i=n.createTexture()),n.bindTexture(n.TEXTURE_2D,i),a&&n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)},this.unbind=function(r){r.gl.bindTexture(r.gl.TEXTURE_2D,null)},this.isRenderable=function(){return!0}}var dc=Ui.extend(function(){return{canvas:null,_width:100,_height:100,devicePixelRatio:typeof window<"u"&&window.devicePixelRatio||1,clearColor:[0,0,0,0],clearBit:17664,alpha:!0,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,throwError:!0,gl:null,viewport:{},maxJointNumber:20,__currentFrameBuffer:null,_viewportStack:[],_clearStack:[],_sceneRendering:null}},function(){this.canvas||(this.canvas=Ai.createCanvas());var e=this.canvas;try{var t={alpha:this.alpha,depth:this.depth,stencil:this.stencil,antialias:this.antialias,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer};if(this.gl=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!this.gl)throw new Error;this._glinfo=new XI(this.gl),this.gl.targetRenderer&&console.error("Already created a renderer"),this.gl.targetRenderer=this,this.resize()}catch(i){throw"Error creating WebGL Context "+i}this._programMgr=new ck(this),this._placeholderTexture=new CH(this)},{resize:function(e,t){var i=this.canvas,r=this.devicePixelRatio;e!=null?(i.style&&(i.style.width=e+"px",i.style.height=t+"px"),i.width=e*r,i.height=t*r,this._width=e,this._height=t):(this._width=i.width/r,this._height=i.height/r),this.setViewport(0,0,this._width,this._height)},getWidth:function(){return this._width},getHeight:function(){return this._height},getViewportAspect:function(){var e=this.viewport;return e.width/e.height},setDevicePixelRatio:function(e){this.devicePixelRatio=e,this.resize(this._width,this._height)},getDevicePixelRatio:function(){return this.devicePixelRatio},getGLExtension:function(e){return this._glinfo.getExtension(e)},getGLParameter:function(e){return this._glinfo.getParameter(e)},setViewport:function(e,t,i,r,n){if(typeof e=="object"){var a=e;e=a.x,t=a.y,i=a.width,r=a.height,n=a.devicePixelRatio}n=n||this.devicePixelRatio,this.gl.viewport(e*n,t*n,i*n,r*n),this.viewport={x:e,y:t,width:i,height:r,devicePixelRatio:n}},saveViewport:function(){this._viewportStack.push(this.viewport)},restoreViewport:function(){this._viewportStack.length>0&&this.setViewport(this._viewportStack.pop())},saveClear:function(){this._clearStack.push({clearBit:this.clearBit,clearColor:this.clearColor})},restoreClear:function(){if(this._clearStack.length>0){var e=this._clearStack.pop();this.clearColor=e.clearColor,this.clearBit=e.clearBit}},bindSceneRendering:function(e){this._sceneRendering=e},render:function(e,t,i,r){var n=this.gl,a=this.clearColor;if(this.clearBit){n.colorMask(!0,!0,!0,!0),n.depthMask(!0);var o=this.viewport,s=!1,l=o.devicePixelRatio;(o.width!==this._width||o.height!==this._height||l&&l!==this.devicePixelRatio||o.x||o.y)&&(s=!0,n.enable(n.SCISSOR_TEST),n.scissor(o.x*l,o.y*l,o.width*l,o.height*l)),n.clearColor(a[0],a[1],a[2],a[3]),n.clear(this.clearBit),s&&n.disable(n.SCISSOR_TEST)}if(i||e.update(!1),e.updateLights(),t=t||e.getMainCamera(),!t){console.error("Can't find camera in the scene.");return}t.update();var c=e.updateRenderList(t,!0);this._sceneRendering=e;var d=c.opaque,u=c.transparent,h=e.material;e.trigger("beforerender",this,e,t,c),r?(this.renderPreZ(d,e,t),n.depthFunc(n.LEQUAL)):n.depthFunc(n.LESS);for(var m=dr(),f=Y.create(),p=0;p<u.length;p++){var g=u[p];ke.multiplyAffine(m,t.viewMatrix.array,g.worldTransform.array),Y.transformMat4(f,g.position.array,m),g.__depth=f[2]}this.renderPass(d,t,{getMaterial:function(v){return h||v.material},sortCompare:this.opaqueSortCompare}),this.renderPass(u,t,{getMaterial:function(v){return h||v.material},sortCompare:this.transparentSortCompare}),e.trigger("afterrender",this,e,t,c),this._sceneRendering=null},getProgram:function(e,t,i){return t=t||e.material,this._programMgr.getProgram(e,t,i)},validateProgram:function(e){if(e.__error){var t=e.__error;if(_k[e.__uid__])return;if(_k[e.__uid__]=!0,this.throwError)throw new Error(t);this.trigger("error",t)}},updatePrograms:function(e,t,i){var r=i&&i.getMaterial||bk;t=t||null;for(var n=0;n<e.length;n++){var a=e[n],o=r.call(this,a);if(n>0){var s=e[n-1],l=s.joints?s.joints.length:0,c=a.joints?a.joints.length:0;if(c===l&&a.material===s.material&&a.lightGroup===s.lightGroup){a.__program=s.__program;continue}}var d=this._programMgr.getProgram(a,o,t);this.validateProgram(d),a.__program=d}},renderPass:function(e,t,i){this.trigger("beforerenderpass",this,e,t,i),i=i||{},i.getMaterial=i.getMaterial||bk,i.getUniform=i.getUniform||bH,i.isMaterialChanged=i.isMaterialChanged||xH,i.beforeRender=i.beforeRender||xk,i.afterRender=i.afterRender||xk;var r=i.ifRender||yH;this.updatePrograms(e,this._sceneRendering,i),i.sortCompare&&e.sort(i.sortCompare);var n=this.viewport,a=n.devicePixelRatio,o=[n.x*a,n.y*a,n.width*a,n.height*a],s=this.devicePixelRatio,l=this.__currentFrameBuffer?[this.__currentFrameBuffer.getTextureWidth(),this.__currentFrameBuffer.getTextureHeight()]:[this._width*s,this._height*s],c=[o[2],o[3]],d=Date.now();t?(ke.copy(cr.VIEW,t.viewMatrix.array),ke.copy(cr.PROJECTION,t.projectionMatrix.array),ke.copy(cr.VIEWINVERSE,t.worldTransform.array)):(ke.identity(cr.VIEW),ke.identity(cr.PROJECTION),ke.identity(cr.VIEWINVERSE)),ke.multiply(cr.VIEWPROJECTION,cr.PROJECTION,cr.VIEW),ke.invert(cr.PROJECTIONINVERSE,cr.PROJECTION),ke.invert(cr.VIEWPROJECTIONINVERSE,cr.VIEWPROJECTION);for(var u=this.gl,h=this._sceneRendering,m,f,p,g,v,b,_,x,w,y,M,T,C=null,N=0;N<e.length;N++){var D=e[N],k=D.worldTransform!=null,U;if(r(D)){k&&(U=D.isSkinnedMesh&&D.isSkinnedMesh()?D.offsetMatrix?D.offsetMatrix.array:cr.IDENTITY:D.worldTransform.array);var F=D.geometry,H=i.getMaterial.call(this,D),V=D.__program,Q=H.shader,$=F.__uid__+"-"+V.__uid__,ee=$!==y;y=$,ee&&C&&C.bindVertexArrayOES(null),k&&(ke.copy(cr.WORLD,U),ke.multiply(cr.WORLDVIEWPROJECTION,cr.VIEWPROJECTION,U),ke.multiplyAffine(cr.WORLDVIEW,cr.VIEW,U),(Q.matrixSemantics.WORLDINVERSE||Q.matrixSemantics.WORLDINVERSETRANSPOSE)&&ke.invert(cr.WORLDINVERSE,U),(Q.matrixSemantics.WORLDVIEWINVERSE||Q.matrixSemantics.WORLDVIEWINVERSETRANSPOSE)&&ke.invert(cr.WORLDVIEWINVERSE,cr.WORLDVIEW),(Q.matrixSemantics.WORLDVIEWPROJECTIONINVERSE||Q.matrixSemantics.WORLDVIEWPROJECTIONINVERSETRANSPOSE)&&ke.invert(cr.WORLDVIEWPROJECTIONINVERSE,cr.WORLDVIEWPROJECTION)),D.beforeRender&&D.beforeRender(this),i.beforeRender.call(this,D,H,m);var re=V!==f;re?(V.bind(this),V.setUniformOfSemantic(u,"VIEWPORT",o),V.setUniformOfSemantic(u,"WINDOW_SIZE",l),t&&(V.setUniformOfSemantic(u,"NEAR",t.near),V.setUniformOfSemantic(u,"FAR",t.far)),V.setUniformOfSemantic(u,"DEVICEPIXELRATIO",a),V.setUniformOfSemantic(u,"TIME",d),V.setUniformOfSemantic(u,"VIEWPORT_SIZE",c),h&&h.setLightUniforms(V,D.lightGroup,this)):V=f,(re||i.isMaterialChanged(D,p,H,m))&&(H.depthTest!==g&&(H.depthTest?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),g=H.depthTest),H.depthMask!==v&&(u.depthMask(H.depthMask),v=H.depthMask),H.transparent!==w&&(H.transparent?u.enable(u.BLEND):u.disable(u.BLEND),w=H.transparent),H.transparent&&(H.blend?H.blend(u):(u.blendEquationSeparate(u.FUNC_ADD,u.FUNC_ADD),u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA))),T=this._bindMaterial(D,H,V,p||null,m||null,f||null,i.getUniform),m=H);var we=Q.matrixSemanticKeys;if(k)for(var te=0;te<we.length;te++){var oe=we[te],pe=Q.matrixSemantics[oe],ue=cr[oe];if(pe.isTranspose){var _e=cr[pe.semanticNoTranspose];ke.transpose(ue,_e)}V.setUniform(u,pe.type,pe.symbol,ue)}D.cullFace!==_&&(_=D.cullFace,u.cullFace(_)),D.frontFace!==x&&(x=D.frontFace,u.frontFace(x)),D.culling!==b&&(b=D.culling,b?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE)),this._updateSkeleton(D,V,T),ee&&(M=this._bindVAO(C,Q,F,V)),this._renderObject(D,M,V),i.afterRender(this,D),D.afterRender&&D.afterRender(this),f=V,p=D}}C&&C.bindVertexArrayOES(null),this.trigger("afterrenderpass",this,e,t,i)},getMaxJointNumber:function(){return this.maxJointNumber},_updateSkeleton:function(e,t,i){var r=this.gl,n=e.skeleton;if(n)if(n.update(),e.joints.length>this.getMaxJointNumber()){var a=n.getSubSkinMatricesTexture(e.__uid__,e.joints);t.useTextureSlot(this,a,i),t.setUniform(r,"1i","skinMatricesTexture",i),t.setUniform(r,"1f","skinMatricesTextureSize",a.width)}else{var o=n.getSubSkinMatrices(e.__uid__,e.joints);t.setUniformOfSemantic(r,"SKIN_MATRIX",o)}},_renderObject:function(e,t,i){var r=this.gl,n=e.geometry,a=e.mode;a==null&&(a=4);var o=null,s=e.isInstancedMesh&&e.isInstancedMesh();if(s&&(o=this.getGLExtension("ANGLE_instanced_arrays"),!o)){console.warn("Device not support ANGLE_instanced_arrays extension");return}var l;if(s&&(l=this._bindInstancedAttributes(e,i,o)),t.indicesBuffer){var c=this.getGLExtension("OES_element_index_uint"),d=c&&n.indices instanceof Uint32Array,u=d?r.UNSIGNED_INT:r.UNSIGNED_SHORT;s?o.drawElementsInstancedANGLE(a,t.indicesBuffer.count,u,0,e.getInstanceCount()):r.drawElements(a,t.indicesBuffer.count,u,0)}else s?o.drawArraysInstancedANGLE(a,0,n.vertexCount,e.getInstanceCount()):r.drawArrays(a,0,n.vertexCount);if(s)for(var h=0;h<l.length;h++)r.disableVertexAttribArray(l[h])},_bindInstancedAttributes:function(e,t,i){for(var r=this.gl,n=e.getInstancedAttributesBuffers(this),a=[],o=0;o<n.length;o++){var s=n[o],l=t.getAttribLocation(r,s.symbol);if(!(l<0)){var c=yk[s.type]||r.FLOAT;r.enableVertexAttribArray(l),r.bindBuffer(r.ARRAY_BUFFER,s.buffer),r.vertexAttribPointer(l,s.size,c,!1,0,0),i.vertexAttribDivisorANGLE(l,s.divisor),a.push(l)}}return a},_bindMaterial:function(e,t,i,r,n,a,o){for(var s=this.gl,l=a===i,c=i.currentTextureSlot(),d=t.getEnabledUniforms(),u=t.getTextureUniforms(),h=this._placeholderTexture,m=0;m<u.length;m++){var f=u[m],p=o(e,t,f),g=t.uniforms[f].type;if(g==="t"&&p)p.__slot=-1;else if(g==="tv")for(var v=0;v<p.length;v++)p[v]&&(p[v].__slot=-1)}h.__slot=-1;for(var m=0;m<d.length;m++){var f=d[m],b=t.uniforms[f],p=o(e,t,f),g=b.type,_=g==="t";if(_&&(!p||!p.isRenderable())&&(p=h),n&&l){var x=o(r,n,f);if(_&&(!x||!x.isRenderable())&&(x=h),x===p){if(_)i.takeCurrentTextureSlot(this,null);else if(g==="tv"&&p)for(var v=0;v<p.length;v++)i.takeCurrentTextureSlot(this,null);continue}}if(p!=null)if(_)if(p.__slot<0){var w=i.currentTextureSlot(),y=i.setUniform(s,"1i",f,w);y&&(i.takeCurrentTextureSlot(this,p),p.__slot=w)}else i.setUniform(s,"1i",f,p.__slot);else if(Array.isArray(p)){if(p.length===0)continue;if(g==="tv"){if(!i.hasUniform(f))continue;for(var M=[],v=0;v<p.length;v++){var T=p[v];if(T.__slot<0){var w=i.currentTextureSlot();M.push(w),i.takeCurrentTextureSlot(this,T),T.__slot=w}else M.push(T.__slot)}i.setUniform(s,"1iv",f,M)}else i.setUniform(s,b.type,f,p)}else i.setUniform(s,b.type,f,p)}var C=i.currentTextureSlot();return i.resetTextureSlot(c),C},_bindVAO:function(e,t,i,r){var n=!i.dynamic,a=this.gl,o=this.__uid__+"-"+r.__uid__,s=i.__vaoCache[o];if(!s){var l=i.getBufferChunks(this);if(!l||!l.length)return;for(var c=l[0],d=c.attributeBuffers,x=c.indicesBuffer,_=[],u=[],h=0;h<d.length;h++){var m=d[h],f=m.name,p=m.semantic,g;if(p){var v=t.attributeSemantics[p];g=v&&v.symbol}else g=f;g&&r.attributes[g]&&(_.push(m),u.push(g))}s=new wH(_,u,x),n&&(i.__vaoCache[o]=s)}var b=!0;e&&n&&(s.vao==null?s.vao=e.createVertexArrayOES():b=!1,e.bindVertexArrayOES(s.vao));var _=s.availableAttributes,x=s.indicesBuffer;if(b){for(var w=r.enableAttributes(this,s.availableAttributeSymbols,e&&n&&s),h=0;h<_.length;h++){var y=w[h];if(y!==-1){var m=_[h],M=m.buffer,T=m.size,C=yk[m.type]||a.FLOAT;a.bindBuffer(a.ARRAY_BUFFER,M),a.vertexAttribPointer(y,T,C,!1,0,0)}}i.isUseIndices()&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,x.buffer)}return s},renderPreZ:function(e,t,i){var r=this.gl,n=this._prezMaterial||new $r({shader:new Re(Re.source("clay.prez.vertex"),Re.source("clay.prez.fragment"))});this._prezMaterial=n,r.colorMask(!1,!1,!1,!1),r.depthMask(!0),this.renderPass(e,i,{ifRender:function(a){return!a.ignorePreZ},isMaterialChanged:function(a,o){var s=a.material,l=o.material;return s.get("diffuseMap")!==l.get("diffuseMap")||(s.get("alphaCutoff")||0)!==(l.get("alphaCutoff")||0)},getUniform:function(a,o,s){if(s==="alphaMap")return a.material.get("diffuseMap");if(s==="alphaCutoff"){if(a.material.isDefined("fragment","ALPHA_TEST")&&a.material.get("diffuseMap")){var l=a.material.get("alphaCutoff");return l||0}return 0}else return s==="uvRepeat"?a.material.get("uvRepeat"):s==="uvOffset"?a.material.get("uvOffset"):o.get(s)},getMaterial:function(){return n},sort:this.opaqueSortCompare}),r.colorMask(!0,!0,!0,!0),r.depthMask(!0)},disposeScene:function(e){this.disposeNode(e,!0,!0),e.dispose()},disposeNode:function(e,t,i){e.getParent()&&e.getParent().remove(e);var r={};e.traverse(function(n){var a=n.material;if(n.geometry&&t&&n.geometry.dispose(this),i&&a&&!r[a.__uid__]){for(var o=a.getTextureUniforms(),s=0;s<o.length;s++){var l=o[s],c=a.uniforms[l].value,d=a.uniforms[l].type;if(c){if(d==="t")c.dispose&&c.dispose(this);else if(d==="tv")for(var u=0;u<c.length;u++)c[u]&&c[u].dispose&&c[u].dispose(this)}}r[a.__uid__]=!0}n.dispose&&n.dispose(this)},this)},disposeGeometry:function(e){e.dispose(this)},disposeTexture:function(e){e.dispose(this)},disposeFrameBuffer:function(e){e.dispose(this)},dispose:function(){},screenToNDC:function(e,t,i){i||(i=new rn),t=this._height-t;var r=this.viewport,n=i.array;return n[0]=(e-r.x)/r.width,n[0]=n[0]*2-1,n[1]=(t-r.y)/r.height,n[1]=n[1]*2-1,i}});dc.opaqueSortCompare=dc.prototype.opaqueSortCompare=function(e,t){return e.renderOrder===t.renderOrder?e.__program===t.__program?e.material===t.material?e.geometry.__uid__-t.geometry.__uid__:e.material.__uid__-t.material.__uid__:e.__program&&t.__program?e.__program.__uid__-t.__program.__uid__:0:e.renderOrder-t.renderOrder};dc.transparentSortCompare=dc.prototype.transparentSortCompare=function(e,t){return e.renderOrder===t.renderOrder?e.__depth===t.__depth?e.__program===t.__program?e.material===t.material?e.geometry.__uid__-t.geometry.__uid__:e.material.__uid__-t.material.__uid__:e.__program&&t.__program?e.__program.__uid__-t.__program.__uid__:0:e.__depth-t.__depth:e.renderOrder-t.renderOrder};var cr={IDENTITY:dr(),WORLD:dr(),VIEW:dr(),PROJECTION:dr(),WORLDVIEW:dr(),VIEWPROJECTION:dr(),WORLDVIEWPROJECTION:dr(),WORLDINVERSE:dr(),VIEWINVERSE:dr(),PROJECTIONINVERSE:dr(),WORLDVIEWINVERSE:dr(),VIEWPROJECTIONINVERSE:dr(),WORLDVIEWPROJECTIONINVERSE:dr(),WORLDTRANSPOSE:dr(),VIEWTRANSPOSE:dr(),PROJECTIONTRANSPOSE:dr(),WORLDVIEWTRANSPOSE:dr(),VIEWPROJECTIONTRANSPOSE:dr(),WORLDVIEWPROJECTIONTRANSPOSE:dr(),WORLDINVERSETRANSPOSE:dr(),VIEWINVERSETRANSPOSE:dr(),PROJECTIONINVERSETRANSPOSE:dr(),WORLDVIEWINVERSETRANSPOSE:dr(),VIEWPROJECTIONINVERSETRANSPOSE:dr(),WORLDVIEWPROJECTIONINVERSETRANSPOSE:dr()};dc.COLOR_BUFFER_BIT=se.COLOR_BUFFER_BIT;dc.DEPTH_BUFFER_BIT=se.DEPTH_BUFFER_BIT;dc.STENCIL_BUFFER_BIT=se.STENCIL_BUFFER_BIT;var uc=dc;var Ct=function(e,t,i){e=e||0,t=t||0,i=i||0,this.array=Y.fromValues(e,t,i),this._dirty=!0};Ct.prototype={constructor:Ct,add:function(e){return Y.add(this.array,this.array,e.array),this._dirty=!0,this},set:function(e,t,i){return this.array[0]=e,this.array[1]=t,this.array[2]=i,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this._dirty=!0,this},clone:function(){return new Ct(this.x,this.y,this.z)},copy:function(e){return Y.copy(this.array,e.array),this._dirty=!0,this},cross:function(e,t){return Y.cross(this.array,e.array,t.array),this._dirty=!0,this},dist:function(e){return Y.dist(this.array,e.array)},distance:function(e){return Y.distance(this.array,e.array)},div:function(e){return Y.div(this.array,this.array,e.array),this._dirty=!0,this},divide:function(e){return Y.divide(this.array,this.array,e.array),this._dirty=!0,this},dot:function(e){return Y.dot(this.array,e.array)},len:function(){return Y.len(this.array)},length:function(){return Y.length(this.array)},lerp:function(e,t,i){return Y.lerp(this.array,e.array,t.array,i),this._dirty=!0,this},min:function(e){return Y.min(this.array,this.array,e.array),this._dirty=!0,this},max:function(e){return Y.max(this.array,this.array,e.array),this._dirty=!0,this},mul:function(e){return Y.mul(this.array,this.array,e.array),this._dirty=!0,this},multiply:function(e){return Y.multiply(this.array,this.array,e.array),this._dirty=!0,this},negate:function(){return Y.negate(this.array,this.array),this._dirty=!0,this},normalize:function(){return Y.normalize(this.array,this.array),this._dirty=!0,this},random:function(e){return Y.random(this.array,e),this._dirty=!0,this},scale:function(e){return Y.scale(this.array,this.array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return Y.scaleAndAdd(this.array,this.array,e.array,t),this._dirty=!0,this},sqrDist:function(e){return Y.sqrDist(this.array,e.array)},squaredDistance:function(e){return Y.squaredDistance(this.array,e.array)},sqrLen:function(){return Y.sqrLen(this.array)},squaredLength:function(){return Y.squaredLength(this.array)},sub:function(e){return Y.sub(this.array,this.array,e.array),this._dirty=!0,this},subtract:function(e){return Y.subtract(this.array,this.array,e.array),this._dirty=!0,this},transformMat3:function(e){return Y.transformMat3(this.array,this.array,e.array),this._dirty=!0,this},transformMat4:function(e){return Y.transformMat4(this.array,this.array,e.array),this._dirty=!0,this},transformQuat:function(e){return Y.transformQuat(this.array,this.array,e.array),this._dirty=!0,this},applyProjection:function(e){var t=this.array;if(e=e.array,e[15]===0){var i=-1/t[2];t[0]=e[0]*t[0]*i,t[1]=e[5]*t[1]*i,t[2]=(e[10]*t[2]+e[14])*i}else t[0]=e[0]*t[0]+e[12],t[1]=e[5]*t[1]+e[13],t[2]=e[10]*t[2]+e[14];return this._dirty=!0,this},eulerFromQuat:function(e,t){Ct.eulerFromQuat(this,e,t)},eulerFromMat3:function(e,t){Ct.eulerFromMat3(this,e,t)},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var f0=Object.defineProperty;f0&&(g0=Ct.prototype,f0(g0,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),f0(g0,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}),f0(g0,"z",{get:function(){return this.array[2]},set:function(e){this.array[2]=e,this._dirty=!0}}));var g0;Ct.add=function(e,t,i){return Y.add(e.array,t.array,i.array),e._dirty=!0,e};Ct.set=function(e,t,i,r){Y.set(e.array,t,i,r),e._dirty=!0};Ct.copy=function(e,t){return Y.copy(e.array,t.array),e._dirty=!0,e};Ct.cross=function(e,t,i){return Y.cross(e.array,t.array,i.array),e._dirty=!0,e};Ct.dist=function(e,t){return Y.distance(e.array,t.array)};Ct.distance=Ct.dist;Ct.div=function(e,t,i){return Y.divide(e.array,t.array,i.array),e._dirty=!0,e};Ct.divide=Ct.div;Ct.dot=function(e,t){return Y.dot(e.array,t.array)};Ct.len=function(e){return Y.length(e.array)};Ct.lerp=function(e,t,i,r){return Y.lerp(e.array,t.array,i.array,r),e._dirty=!0,e};Ct.min=function(e,t,i){return Y.min(e.array,t.array,i.array),e._dirty=!0,e};Ct.max=function(e,t,i){return Y.max(e.array,t.array,i.array),e._dirty=!0,e};Ct.mul=function(e,t,i){return Y.multiply(e.array,t.array,i.array),e._dirty=!0,e};Ct.multiply=Ct.mul;Ct.negate=function(e,t){return Y.negate(e.array,t.array),e._dirty=!0,e};Ct.normalize=function(e,t){return Y.normalize(e.array,t.array),e._dirty=!0,e};Ct.random=function(e,t){return Y.random(e.array,t),e._dirty=!0,e};Ct.scale=function(e,t,i){return Y.scale(e.array,t.array,i),e._dirty=!0,e};Ct.scaleAndAdd=function(e,t,i,r){return Y.scaleAndAdd(e.array,t.array,i.array,r),e._dirty=!0,e};Ct.sqrDist=function(e,t){return Y.sqrDist(e.array,t.array)};Ct.squaredDistance=Ct.sqrDist;Ct.sqrLen=function(e){return Y.sqrLen(e.array)};Ct.squaredLength=Ct.sqrLen;Ct.sub=function(e,t,i){return Y.subtract(e.array,t.array,i.array),e._dirty=!0,e};Ct.subtract=Ct.sub;Ct.transformMat3=function(e,t,i){return Y.transformMat3(e.array,t.array,i.array),e._dirty=!0,e};Ct.transformMat4=function(e,t,i){return Y.transformMat4(e.array,t.array,i.array),e._dirty=!0,e};Ct.transformQuat=function(e,t,i){return Y.transformQuat(e.array,t.array,i.array),e._dirty=!0,e};function To(e,t,i){return e<t?t:e>i?i:e}var Hi=Math.atan2,Do=Math.asin,xh=Math.abs;Ct.eulerFromQuat=function(e,t,h){e._dirty=!0,t=t.array;var r=e.array,n=t[0],a=t[1],o=t[2],s=t[3],l=n*n,c=a*a,d=o*o,u=s*s,h=(h||"XYZ").toUpperCase();switch(h){case"XYZ":r[0]=Hi(2*(n*s-a*o),u-l-c+d),r[1]=Do(To(2*(n*o+a*s),-1,1)),r[2]=Hi(2*(o*s-n*a),u+l-c-d);break;case"YXZ":r[0]=Do(To(2*(n*s-a*o),-1,1)),r[1]=Hi(2*(n*o+a*s),u-l-c+d),r[2]=Hi(2*(n*a+o*s),u-l+c-d);break;case"ZXY":r[0]=Do(To(2*(n*s+a*o),-1,1)),r[1]=Hi(2*(a*s-o*n),u-l-c+d),r[2]=Hi(2*(o*s-n*a),u-l+c-d);break;case"ZYX":r[0]=Hi(2*(n*s+o*a),u-l-c+d),r[1]=Do(To(2*(a*s-n*o),-1,1)),r[2]=Hi(2*(n*a+o*s),u+l-c-d);break;case"YZX":r[0]=Hi(2*(n*s-o*a),u-l+c-d),r[1]=Hi(2*(a*s-n*o),u+l-c-d),r[2]=Do(To(2*(n*a+o*s),-1,1));break;case"XZY":r[0]=Hi(2*(n*s+a*o),u-l+c-d),r[1]=Hi(2*(n*o+a*s),u+l-c-d),r[2]=Do(To(2*(o*s-n*a),-1,1));break;default:console.warn("Unkown order: "+h)}return e};Ct.eulerFromMat3=function(e,t,f){var r=t.array,n=r[0],a=r[3],o=r[6],s=r[1],l=r[4],c=r[7],d=r[2],u=r[5],h=r[8],m=e.array,f=(f||"XYZ").toUpperCase();switch(f){case"XYZ":m[1]=Do(To(o,-1,1)),xh(o)<.99999?(m[0]=Hi(-c,h),m[2]=Hi(-a,n)):(m[0]=Hi(u,l),m[2]=0);break;case"YXZ":m[0]=Do(-To(c,-1,1)),xh(c)<.99999?(m[1]=Hi(o,h),m[2]=Hi(s,l)):(m[1]=Hi(-d,n),m[2]=0);break;case"ZXY":m[0]=Do(To(u,-1,1)),xh(u)<.99999?(m[1]=Hi(-d,h),m[2]=Hi(-a,l)):(m[1]=0,m[2]=Hi(s,n));break;case"ZYX":m[1]=Do(-To(d,-1,1)),xh(d)<.99999?(m[0]=Hi(u,h),m[2]=Hi(s,n)):(m[0]=0,m[2]=Hi(-a,l));break;case"YZX":m[2]=Do(To(s,-1,1)),xh(s)<.99999?(m[0]=Hi(-c,l),m[1]=Hi(-d,n)):(m[0]=0,m[1]=Hi(o,h));break;case"XZY":m[2]=Do(-To(a,-1,1)),xh(a)<.99999?(m[0]=Hi(u,l),m[1]=Hi(o,n)):(m[0]=Hi(-c,h),m[1]=0);break;default:console.warn("Unkown order: "+f)}return e._dirty=!0,e};Object.defineProperties(Ct,{POSITIVE_X:{get:function(){return new Ct(1,0,0)}},NEGATIVE_X:{get:function(){return new Ct(-1,0,0)}},POSITIVE_Y:{get:function(){return new Ct(0,1,0)}},NEGATIVE_Y:{get:function(){return new Ct(0,-1,0)}},POSITIVE_Z:{get:function(){return new Ct(0,0,1)}},NEGATIVE_Z:{get:function(){return new Ct(0,0,-1)}},UP:{get:function(){return new Ct(0,1,0)}},ZERO:{get:function(){return new Ct}}});var Se=Ct;var C1=1e-5,v0=function(e,t){this.origin=e||new Se,this.direction=t||new Se};v0.prototype={constructor:v0,intersectPlane:function(e,t){var i=e.normal.array,r=e.distance,n=this.origin.array,a=this.direction.array,o=Y.dot(i,a);if(o===0)return null;t||(t=new Se);var s=(Y.dot(i,n)-r)/o;return Y.scaleAndAdd(t.array,n,a,-s),t._dirty=!0,t},mirrorAgainstPlane:function(e){var t=Y.dot(e.normal.array,this.direction.array);Y.scaleAndAdd(this.direction.array,this.direction.array,e.normal.array,-t*2),this.direction._dirty=!0},distanceToPoint:function(){var e=Y.create();return function(t){Y.sub(e,t,this.origin.array);var i=Y.dot(e,this.direction.array);if(i<0)return Y.distance(this.origin.array,t);var r=Y.lenSquared(e);return Math.sqrt(r-i*i)}}(),intersectSphere:function(){var e=Y.create();return function(t,i,r){var n=this.origin.array,a=this.direction.array;t=t.array,Y.sub(e,t,n);var o=Y.dot(e,a),s=Y.squaredLength(e),l=s-o*o,c=i*i;if(!(l>c)){var d=Math.sqrt(c-l),u=o-d,h=o+d;return r||(r=new Se),u<0?h<0?null:(Y.scaleAndAdd(r.array,n,a,h),r):(Y.scaleAndAdd(r.array,n,a,u),r)}}}(),intersectBoundingBox:function(e,t){var i=this.direction.array,r=this.origin.array,n=e.min.array,a=e.max.array,o=1/i[0],s=1/i[1],l=1/i[2],c,d,u,h,m,f;if(o>=0?(c=(n[0]-r[0])*o,d=(a[0]-r[0])*o):(d=(n[0]-r[0])*o,c=(a[0]-r[0])*o),s>=0?(u=(n[1]-r[1])*s,h=(a[1]-r[1])*s):(h=(n[1]-r[1])*s,u=(a[1]-r[1])*s),c>h||u>d||((u>c||c!==c)&&(c=u),(h<d||d!==d)&&(d=h),l>=0?(m=(n[2]-r[2])*l,f=(a[2]-r[2])*l):(f=(n[2]-r[2])*l,m=(a[2]-r[2])*l),c>f||m>d)||((m>c||c!==c)&&(c=m),(f<d||d!==d)&&(d=f),d<0))return null;var p=c>=0?c:d;return t||(t=new Se),Y.scaleAndAdd(t.array,r,i,p),t},intersectTriangle:function(){var e=Y.create(),t=Y.create(),i=Y.create(),r=Y.create();return function(n,a,o,s,l,c){var d=this.direction.array,u=this.origin.array;n=n.array,a=a.array,o=o.array,Y.sub(e,a,n),Y.sub(t,o,n),Y.cross(r,t,d);var h=Y.dot(e,r);if(s){if(h>-C1)return null}else if(h>-C1&&h<C1)return null;Y.sub(i,u,n);var m=Y.dot(r,i)/h;if(m<0||m>1)return null;Y.cross(r,e,i);var f=Y.dot(d,r)/h;if(f<0||f>1||m+f>1)return null;Y.cross(r,e,t);var p=-Y.dot(i,r)/h;return p<0?null:(l||(l=new Se),c&&Se.set(c,1-m-f,m,f),Y.scaleAndAdd(l.array,u,d,p),l)}}(),applyTransform:function(e){Se.add(this.direction,this.direction,this.origin),Se.transformMat4(this.origin,this.origin,e),Se.transformMat4(this.direction,this.direction,e),Se.sub(this.direction,this.direction,this.origin),Se.normalize(this.direction,this.direction)},copy:function(e){Se.copy(this.origin,e.origin),Se.copy(this.direction,e.direction)},clone:function(){var e=new v0;return e.copy(this),e}};var Nd=v0;var Wt={};Wt.create=function(){var e=new lr(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e};Wt.clone=function(e){var t=new lr(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t};Wt.fromValues=function(e,t,i,r){var n=new lr(4);return n[0]=e,n[1]=t,n[2]=i,n[3]=r,n};Wt.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e};Wt.set=function(e,t,i,r,n){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e};Wt.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e};Wt.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e};Wt.sub=Wt.subtract;Wt.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e};Wt.mul=Wt.multiply;Wt.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e[3]=t[3]/i[3],e};Wt.div=Wt.divide;Wt.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e[3]=Math.min(t[3],i[3]),e};Wt.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e[3]=Math.max(t[3],i[3]),e};Wt.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e};Wt.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e};Wt.distance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(i*i+r*r+n*n+a*a)};Wt.dist=Wt.distance;Wt.squaredDistance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return i*i+r*r+n*n+a*a};Wt.sqrDist=Wt.squaredDistance;Wt.length=function(e){var t=e[0],i=e[1],r=e[2],n=e[3];return Math.sqrt(t*t+i*i+r*r+n*n)};Wt.len=Wt.length;Wt.squaredLength=function(e){var t=e[0],i=e[1],r=e[2],n=e[3];return t*t+i*i+r*r+n*n};Wt.sqrLen=Wt.squaredLength;Wt.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e};Wt.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e};Wt.normalize=function(e,t){var i=t[0],r=t[1],n=t[2],a=t[3],o=i*i+r*r+n*n+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e[3]=t[3]*o),e};Wt.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]};Wt.lerp=function(e,t,i,r){var n=t[0],a=t[1],o=t[2],s=t[3];return e[0]=n+r*(i[0]-n),e[1]=a+r*(i[1]-a),e[2]=o+r*(i[2]-o),e[3]=s+r*(i[3]-s),e};Wt.random=function(e,t){return t=t||1,e[0]=cc(),e[1]=cc(),e[2]=cc(),e[3]=cc(),Wt.normalize(e,e),Wt.scale(e,e,t),e};Wt.transformMat4=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=t[3];return e[0]=i[0]*r+i[4]*n+i[8]*a+i[12]*o,e[1]=i[1]*r+i[5]*n+i[9]*a+i[13]*o,e[2]=i[2]*r+i[6]*n+i[10]*a+i[14]*o,e[3]=i[3]*r+i[7]*n+i[11]*a+i[15]*o,e};Wt.transformQuat=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=i[0],s=i[1],l=i[2],c=i[3],d=c*r+s*a-l*n,u=c*n+l*r-o*a,h=c*a+o*n-s*r,m=-o*r-s*n-l*a;return e[0]=d*c+m*-o+u*-l-h*-s,e[1]=u*c+m*-s+h*-o-d*-l,e[2]=h*c+m*-l+d*-s-u*-o,e};Wt.forEach=function(){var e=Wt.create();return function(t,i,r,n,a,o){var s,l;for(i||(i=4),r||(r=0),n?l=Math.min(n*i+r,t.length):l=t.length,s=r;s<l;s+=i)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}();var We=Wt;var Yr={};Yr.create=function(){var e=new lr(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e};Yr.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e};Yr.clone=function(e){var t=new lr(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t};Yr.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e};Yr.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e};Yr.transpose=function(e,t){if(e===t){var i=t[1],r=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=r,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e};Yr.invert=function(e,t){var i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],d=t[8],u=d*o-s*c,h=-d*a+s*l,m=c*a-o*l,f=i*u+r*h+n*m;return f?(f=1/f,e[0]=u*f,e[1]=(-d*r+n*c)*f,e[2]=(s*r-n*o)*f,e[3]=h*f,e[4]=(d*i-n*l)*f,e[5]=(-s*i+n*a)*f,e[6]=m*f,e[7]=(-c*i+r*l)*f,e[8]=(o*i-r*a)*f,e):null};Yr.adjoint=function(e,t){var i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],d=t[8];return e[0]=o*d-s*c,e[1]=n*c-r*d,e[2]=r*s-n*o,e[3]=s*l-a*d,e[4]=i*d-n*l,e[5]=n*a-i*s,e[6]=a*c-o*l,e[7]=r*l-i*c,e[8]=i*o-r*a,e};Yr.determinant=function(e){var t=e[0],i=e[1],r=e[2],n=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8];return t*(c*a-o*l)+i*(-c*n+o*s)+r*(l*n-a*s)};Yr.multiply=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],d=t[7],u=t[8],h=i[0],m=i[1],f=i[2],p=i[3],g=i[4],v=i[5],b=i[6],_=i[7],x=i[8];return e[0]=h*r+m*o+f*c,e[1]=h*n+m*s+f*d,e[2]=h*a+m*l+f*u,e[3]=p*r+g*o+v*c,e[4]=p*n+g*s+v*d,e[5]=p*a+g*l+v*u,e[6]=b*r+_*o+x*c,e[7]=b*n+_*s+x*d,e[8]=b*a+_*l+x*u,e};Yr.mul=Yr.multiply;Yr.translate=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],d=t[7],u=t[8],h=i[0],m=i[1];return e[0]=r,e[1]=n,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=h*r+m*o+c,e[7]=h*n+m*s+d,e[8]=h*a+m*l+u,e};Yr.rotate=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],d=t[7],u=t[8],h=Math.sin(i),m=Math.cos(i);return e[0]=m*r+h*o,e[1]=m*n+h*s,e[2]=m*a+h*l,e[3]=m*o-h*r,e[4]=m*s-h*n,e[5]=m*l-h*a,e[6]=c,e[7]=d,e[8]=u,e};Yr.scale=function(e,t,i){var r=i[0],n=i[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e};Yr.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e};Yr.fromQuat=function(e,t){var i=t[0],r=t[1],n=t[2],a=t[3],o=i+i,s=r+r,l=n+n,c=i*o,d=r*o,u=r*s,h=n*o,m=n*s,f=n*l,p=a*o,g=a*s,v=a*l;return e[0]=1-u-f,e[3]=d-v,e[6]=h+g,e[1]=d+v,e[4]=1-c-f,e[7]=m-p,e[2]=h-g,e[5]=m+p,e[8]=1-c-u,e};Yr.normalFromMat4=function(e,t){var i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],d=t[8],u=t[9],h=t[10],m=t[11],f=t[12],p=t[13],g=t[14],v=t[15],b=i*s-r*o,_=i*l-n*o,x=i*c-a*o,w=r*l-n*s,y=r*c-a*s,M=n*c-a*l,T=d*p-u*f,C=d*g-h*f,N=d*v-m*f,D=u*g-h*p,k=u*v-m*p,U=h*v-m*g,F=b*U-_*k+x*D+w*N-y*C+M*T;return F?(F=1/F,e[0]=(s*U-l*k+c*D)*F,e[1]=(l*N-o*U-c*C)*F,e[2]=(o*k-s*N+c*T)*F,e[3]=(n*k-r*U-a*D)*F,e[4]=(i*U-n*N+a*C)*F,e[5]=(r*N-i*k-a*T)*F,e[6]=(p*M-g*y+v*w)*F,e[7]=(g*x-f*M-v*_)*F,e[8]=(f*y-p*x+v*b)*F,e):null};Yr.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))};var qt=Yr;var bi={};bi.create=function(){var e=new lr(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e};bi.rotationTo=function(){var e=Y.create(),t=Y.fromValues(1,0,0),i=Y.fromValues(0,1,0);return function(r,n,a){var o=Y.dot(n,a);return o<-.999999?(Y.cross(e,t,n),Y.length(e)<1e-6&&Y.cross(e,i,n),Y.normalize(e,e),bi.setAxisAngle(r,e,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Y.cross(e,n,a),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+o,bi.normalize(r,r))}}();bi.setAxes=function(){var e=qt.create();return function(t,i,r,n){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=n[0],e[4]=n[1],e[7]=n[2],e[2]=-i[0],e[5]=-i[1],e[8]=-i[2],bi.normalize(t,bi.fromMat3(t,e))}}();bi.clone=We.clone;bi.fromValues=We.fromValues;bi.copy=We.copy;bi.set=We.set;bi.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e};bi.setAxisAngle=function(e,t,i){i=i*.5;var r=Math.sin(i);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(i),e};bi.add=We.add;bi.multiply=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=t[3],s=i[0],l=i[1],c=i[2],d=i[3];return e[0]=r*d+o*s+n*c-a*l,e[1]=n*d+o*l+a*s-r*c,e[2]=a*d+o*c+r*l-n*s,e[3]=o*d-r*s-n*l-a*c,e};bi.mul=bi.multiply;bi.scale=We.scale;bi.rotateX=function(e,t,i){i*=.5;var r=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(i),l=Math.cos(i);return e[0]=r*l+o*s,e[1]=n*l+a*s,e[2]=a*l-n*s,e[3]=o*l-r*s,e};bi.rotateY=function(e,t,i){i*=.5;var r=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(i),l=Math.cos(i);return e[0]=r*l-a*s,e[1]=n*l+o*s,e[2]=a*l+r*s,e[3]=o*l-n*s,e};bi.rotateZ=function(e,t,i){i*=.5;var r=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(i),l=Math.cos(i);return e[0]=r*l+n*s,e[1]=n*l-r*s,e[2]=a*l+o*s,e[3]=o*l-a*s,e};bi.calculateW=function(e,t){var i=t[0],r=t[1],n=t[2];return e[0]=i,e[1]=r,e[2]=n,e[3]=Math.sqrt(Math.abs(1-i*i-r*r-n*n)),e};bi.dot=We.dot;bi.lerp=We.lerp;bi.slerp=function(e,t,i,r){var n=t[0],a=t[1],o=t[2],s=t[3],l=i[0],c=i[1],d=i[2],u=i[3],h,m,f,p,g;return m=n*l+a*c+o*d+s*u,m<0&&(m=-m,l=-l,c=-c,d=-d,u=-u),1-m>1e-6?(h=Math.acos(m),f=Math.sin(h),p=Math.sin((1-r)*h)/f,g=Math.sin(r*h)/f):(p=1-r,g=r),e[0]=p*n+g*l,e[1]=p*a+g*c,e[2]=p*o+g*d,e[3]=p*s+g*u,e};bi.invert=function(e,t){var i=t[0],r=t[1],n=t[2],a=t[3],o=i*i+r*r+n*n+a*a,s=o?1/o:0;return e[0]=-i*s,e[1]=-r*s,e[2]=-n*s,e[3]=a*s,e};bi.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e};bi.length=We.length;bi.len=bi.length;bi.squaredLength=We.squaredLength;bi.sqrLen=bi.squaredLength;bi.normalize=We.normalize;bi.fromMat3=function(e,t){var i=t[0]+t[4]+t[8],r;if(i>0)r=Math.sqrt(i+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[n*3+n]&&(n=2);var a=(n+1)%3,o=(n+2)%3;r=Math.sqrt(t[n*3+n]-t[a*3+a]-t[o*3+o]+1),e[n]=.5*r,r=.5/r,e[3]=(t[a*3+o]-t[o*3+a])*r,e[a]=(t[a*3+n]+t[n*3+a])*r,e[o]=(t[o*3+n]+t[n*3+o])*r}return e};var xt=bi;var rr=function(){this._axisX=new Se,this._axisY=new Se,this._axisZ=new Se,this.array=ke.create(),this._dirty=!0};rr.prototype={constructor:rr,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},adjoint:function(){return ke.adjoint(this.array,this.array),this._dirty=!0,this},clone:function(){return new rr().copy(this)},copy:function(e){return ke.copy(this.array,e.array),this._dirty=!0,this},determinant:function(){return ke.determinant(this.array)},fromQuat:function(e){return ke.fromQuat(this.array,e.array),this._dirty=!0,this},fromRotationTranslation:function(e,t){return ke.fromRotationTranslation(this.array,e.array,t.array),this._dirty=!0,this},fromMat2d:function(e){return rr.fromMat2d(this,e),this},frustum:function(e,t,i,r,n,a){return ke.frustum(this.array,e,t,i,r,n,a),this._dirty=!0,this},identity:function(){return ke.identity(this.array),this._dirty=!0,this},invert:function(){return ke.invert(this.array,this.array),this._dirty=!0,this},lookAt:function(e,t,i){return ke.lookAt(this.array,e.array,t.array,i.array),this._dirty=!0,this},mul:function(e){return ke.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return ke.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return ke.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return ke.multiply(this.array,e.array,this.array),this._dirty=!0,this},ortho:function(e,t,i,r,n,a){return ke.ortho(this.array,e,t,i,r,n,a),this._dirty=!0,this},perspective:function(e,t,i,r){return ke.perspective(this.array,e,t,i,r),this._dirty=!0,this},rotate:function(e,t){return ke.rotate(this.array,this.array,e,t.array),this._dirty=!0,this},rotateX:function(e){return ke.rotateX(this.array,this.array,e),this._dirty=!0,this},rotateY:function(e){return ke.rotateY(this.array,this.array,e),this._dirty=!0,this},rotateZ:function(e){return ke.rotateZ(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return ke.scale(this.array,this.array,e.array),this._dirty=!0,this},translate:function(e){return ke.translate(this.array,this.array,e.array),this._dirty=!0,this},transpose:function(){return ke.transpose(this.array,this.array),this._dirty=!0,this},decomposeMatrix:function(){var e=Y.create(),t=Y.create(),i=Y.create(),r=qt.create();return function(n,a,o){var s=this.array;Y.set(e,s[0],s[1],s[2]),Y.set(t,s[4],s[5],s[6]),Y.set(i,s[8],s[9],s[10]);var l=Y.length(e),c=Y.length(t),d=Y.length(i),u=this.determinant();u<0&&(l=-l),n&&n.set(l,c,d),o.set(s[12],s[13],s[14]),qt.fromMat4(r,s),r[0]/=l,r[1]/=l,r[2]/=l,r[3]/=c,r[4]/=c,r[5]/=c,r[6]/=d,r[7]/=d,r[8]/=d,xt.fromMat3(a.array,r),xt.normalize(a.array,a.array),a._dirty=!0,o._dirty=!0}}(),toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var _0=Object.defineProperty;_0&&(b0=rr.prototype,_0(b0,"z",{get:function(){var e=this.array;return this._axisZ.set(e[8],e[9],e[10]),this._axisZ},set:function(e){var t=this.array;e=e.array,t[8]=e[0],t[9]=e[1],t[10]=e[2],this._dirty=!0}}),_0(b0,"y",{get:function(){var e=this.array;return this._axisY.set(e[4],e[5],e[6]),this._axisY},set:function(e){var t=this.array;e=e.array,t[4]=e[0],t[5]=e[1],t[6]=e[2],this._dirty=!0}}),_0(b0,"x",{get:function(){var e=this.array;return this._axisX.set(e[0],e[1],e[2]),this._axisX},set:function(e){var t=this.array;e=e.array,t[0]=e[0],t[1]=e[1],t[2]=e[2],this._dirty=!0}}));var b0;rr.adjoint=function(e,t){return ke.adjoint(e.array,t.array),e._dirty=!0,e};rr.copy=function(e,t){return ke.copy(e.array,t.array),e._dirty=!0,e};rr.determinant=function(e){return ke.determinant(e.array)};rr.identity=function(e){return ke.identity(e.array),e._dirty=!0,e};rr.ortho=function(e,t,i,r,n,a,o){return ke.ortho(e.array,t,i,r,n,a,o),e._dirty=!0,e};rr.perspective=function(e,t,i,r,n){return ke.perspective(e.array,t,i,r,n),e._dirty=!0,e};rr.lookAt=function(e,t,i,r){return ke.lookAt(e.array,t.array,i.array,r.array),e._dirty=!0,e};rr.invert=function(e,t){return ke.invert(e.array,t.array),e._dirty=!0,e};rr.mul=function(e,t,i){return ke.mul(e.array,t.array,i.array),e._dirty=!0,e};rr.multiply=rr.mul;rr.fromQuat=function(e,t){return ke.fromQuat(e.array,t.array),e._dirty=!0,e};rr.fromRotationTranslation=function(e,t,i){return ke.fromRotationTranslation(e.array,t.array,i.array),e._dirty=!0,e};rr.fromMat2d=function(r,i){r._dirty=!0;var i=i.array,r=r.array;return r[0]=i[0],r[4]=i[2],r[12]=i[4],r[1]=i[1],r[5]=i[3],r[13]=i[5],r};rr.rotate=function(e,t,i,r){return ke.rotate(e.array,t.array,i,r.array),e._dirty=!0,e};rr.rotateX=function(e,t,i){return ke.rotateX(e.array,t.array,i),e._dirty=!0,e};rr.rotateY=function(e,t,i){return ke.rotateY(e.array,t.array,i),e._dirty=!0,e};rr.rotateZ=function(e,t,i){return ke.rotateZ(e.array,t.array,i),e._dirty=!0,e};rr.scale=function(e,t,i){return ke.scale(e.array,t.array,i.array),e._dirty=!0,e};rr.transpose=function(e,t){return ke.transpose(e.array,t.array),e._dirty=!0,e};rr.translate=function(e,t,i){return ke.translate(e.array,t.array,i.array),e._dirty=!0,e};var Ye=rr;var Ii=function(e,t,i,r){e=e||0,t=t||0,i=i||0,r=r===void 0?1:r,this.array=xt.fromValues(e,t,i,r),this._dirty=!0};Ii.prototype={constructor:Ii,add:function(e){return xt.add(this.array,this.array,e.array),this._dirty=!0,this},calculateW:function(){return xt.calculateW(this.array,this.array),this._dirty=!0,this},set:function(e,t,i,r){return this.array[0]=e,this.array[1]=t,this.array[2]=i,this.array[3]=r,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this.array[3]=e[3],this._dirty=!0,this},clone:function(){return new Ii(this.x,this.y,this.z,this.w)},conjugate:function(){return xt.conjugate(this.array,this.array),this._dirty=!0,this},copy:function(e){return xt.copy(this.array,e.array),this._dirty=!0,this},dot:function(e){return xt.dot(this.array,e.array)},fromMat3:function(e){return xt.fromMat3(this.array,e.array),this._dirty=!0,this},fromMat4:function(){var e=qt.create();return function(t){return qt.fromMat4(e,t.array),qt.transpose(e,e),xt.fromMat3(this.array,e),this._dirty=!0,this}}(),identity:function(){return xt.identity(this.array),this._dirty=!0,this},invert:function(){return xt.invert(this.array,this.array),this._dirty=!0,this},len:function(){return xt.len(this.array)},length:function(){return xt.length(this.array)},lerp:function(e,t,i){return xt.lerp(this.array,e.array,t.array,i),this._dirty=!0,this},mul:function(e){return xt.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return xt.multiply(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return xt.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return xt.multiply(this.array,e.array,this.array),this._dirty=!0,this},normalize:function(){return xt.normalize(this.array,this.array),this._dirty=!0,this},rotateX:function(e){return xt.rotateX(this.array,this.array,e),this._dirty=!0,this},rotateY:function(e){return xt.rotateY(this.array,this.array,e),this._dirty=!0,this},rotateZ:function(e){return xt.rotateZ(this.array,this.array,e),this._dirty=!0,this},rotationTo:function(e,t){return xt.rotationTo(this.array,e.array,t.array),this._dirty=!0,this},setAxes:function(e,t,i){return xt.setAxes(this.array,e.array,t.array,i.array),this._dirty=!0,this},setAxisAngle:function(e,t){return xt.setAxisAngle(this.array,e.array,t),this._dirty=!0,this},slerp:function(e,t,i){return xt.slerp(this.array,e.array,t.array,i),this._dirty=!0,this},sqrLen:function(){return xt.sqrLen(this.array)},squaredLength:function(){return xt.squaredLength(this.array)},fromEuler:function(e,t){return Ii.fromEuler(this,e,t)},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var Jp=Object.defineProperty;Jp&&(ef=Ii.prototype,Jp(ef,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),Jp(ef,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}),Jp(ef,"z",{get:function(){return this.array[2]},set:function(e){this.array[2]=e,this._dirty=!0}}),Jp(ef,"w",{get:function(){return this.array[3]},set:function(e){this.array[3]=e,this._dirty=!0}}));var ef;Ii.add=function(e,t,i){return xt.add(e.array,t.array,i.array),e._dirty=!0,e};Ii.set=function(e,t,i,r,n){xt.set(e.array,t,i,r,n),e._dirty=!0};Ii.copy=function(e,t){return xt.copy(e.array,t.array),e._dirty=!0,e};Ii.calculateW=function(e,t){return xt.calculateW(e.array,t.array),e._dirty=!0,e};Ii.conjugate=function(e,t){return xt.conjugate(e.array,t.array),e._dirty=!0,e};Ii.identity=function(e){return xt.identity(e.array),e._dirty=!0,e};Ii.invert=function(e,t){return xt.invert(e.array,t.array),e._dirty=!0,e};Ii.dot=function(e,t){return xt.dot(e.array,t.array)};Ii.len=function(e){return xt.length(e.array)};Ii.lerp=function(e,t,i,r){return xt.lerp(e.array,t.array,i.array,r),e._dirty=!0,e};Ii.slerp=function(e,t,i,r){return xt.slerp(e.array,t.array,i.array,r),e._dirty=!0,e};Ii.mul=function(e,t,i){return xt.multiply(e.array,t.array,i.array),e._dirty=!0,e};Ii.multiply=Ii.mul;Ii.rotateX=function(e,t,i){return xt.rotateX(e.array,t.array,i),e._dirty=!0,e};Ii.rotateY=function(e,t,i){return xt.rotateY(e.array,t.array,i),e._dirty=!0,e};Ii.rotateZ=function(e,t,i){return xt.rotateZ(e.array,t.array,i),e._dirty=!0,e};Ii.setAxisAngle=function(e,t,i){return xt.setAxisAngle(e.array,t.array,i),e._dirty=!0,e};Ii.normalize=function(e,t){return xt.normalize(e.array,t.array),e._dirty=!0,e};Ii.sqrLen=function(e){return xt.sqrLen(e.array)};Ii.squaredLength=Ii.sqrLen;Ii.fromMat3=function(e,t){return xt.fromMat3(e.array,t.array),e._dirty=!0,e};Ii.setAxes=function(e,t,i,r){return xt.setAxes(e.array,t.array,i.array,r.array),e._dirty=!0,e};Ii.rotationTo=function(e,t,i){return xt.rotationTo(e.array,t.array,i.array),e._dirty=!0,e};Ii.fromEuler=function(e,t,d){e._dirty=!0,t=t.array;var r=e.array,n=Math.cos(t[0]/2),a=Math.cos(t[1]/2),o=Math.cos(t[2]/2),s=Math.sin(t[0]/2),l=Math.sin(t[1]/2),c=Math.sin(t[2]/2),d=(d||"XYZ").toUpperCase();switch(d){case"XYZ":r[0]=s*a*o+n*l*c,r[1]=n*l*o-s*a*c,r[2]=n*a*c+s*l*o,r[3]=n*a*o-s*l*c;break;case"YXZ":r[0]=s*a*o+n*l*c,r[1]=n*l*o-s*a*c,r[2]=n*a*c-s*l*o,r[3]=n*a*o+s*l*c;break;case"ZXY":r[0]=s*a*o-n*l*c,r[1]=n*l*o+s*a*c,r[2]=n*a*c+s*l*o,r[3]=n*a*o-s*l*c;break;case"ZYX":r[0]=s*a*o-n*l*c,r[1]=n*l*o+s*a*c,r[2]=n*a*c-s*l*o,r[3]=n*a*o+s*l*c;break;case"YZX":r[0]=s*a*o+n*l*c,r[1]=n*l*o+s*a*c,r[2]=n*a*c-s*l*o,r[3]=n*a*o-s*l*c;break;case"XZY":r[0]=s*a*o-n*l*c,r[1]=n*l*o-s*a*c,r[2]=n*a*c+s*l*o,r[3]=n*a*o+s*l*c;break}};var x0=Ii;var hc=Y.set,y0=Y.copy,w0=function(e,t){this.min=e||new Se(1/0,1/0,1/0),this.max=t||new Se(-1/0,-1/0,-1/0),this.vertices=null};w0.prototype={constructor:w0,updateFromVertices:function(e){if(e.length>0){var t=this.min,i=this.max,r=t.array,n=i.array;y0(r,e[0]),y0(n,e[0]);for(var a=1;a<e.length;a++){var o=e[a];o[0]<r[0]&&(r[0]=o[0]),o[1]<r[1]&&(r[1]=o[1]),o[2]<r[2]&&(r[2]=o[2]),o[0]>n[0]&&(n[0]=o[0]),o[1]>n[1]&&(n[1]=o[1]),o[2]>n[2]&&(n[2]=o[2])}t._dirty=!0,i._dirty=!0}},union:function(e){var t=this.min,i=this.max;return Y.min(t.array,t.array,e.min.array),Y.max(i.array,i.array,e.max.array),t._dirty=!0,i._dirty=!0,this},intersection:function(e){var t=this.min,i=this.max;return Y.max(t.array,t.array,e.min.array),Y.min(i.array,i.array,e.max.array),t._dirty=!0,i._dirty=!0,this},intersectBoundingBox:function(e){var t=this.min.array,i=this.max.array,r=e.min.array,n=e.max.array;return!(t[0]>n[0]||t[1]>n[1]||t[2]>n[2]||i[0]<r[0]||i[1]<r[1]||i[2]<r[2])},containBoundingBox:function(e){var t=this.min.array,i=this.max.array,r=e.min.array,n=e.max.array;return t[0]<=r[0]&&t[1]<=r[1]&&t[2]<=r[2]&&i[0]>=n[0]&&i[1]>=n[1]&&i[2]>=n[2]},containPoint:function(e){var t=this.min.array,i=this.max.array,r=e.array;return t[0]<=r[0]&&t[1]<=r[1]&&t[2]<=r[2]&&i[0]>=r[0]&&i[1]>=r[1]&&i[2]>=r[2]},isFinite:function(){var e=this.min.array,t=this.max.array;return isFinite(e[0])&&isFinite(e[1])&&isFinite(e[2])&&isFinite(t[0])&&isFinite(t[1])&&isFinite(t[2])},applyTransform:function(e){this.transformFrom(this,e)},transformFrom:function(){var e=Y.create(),t=Y.create(),i=Y.create(),r=Y.create(),n=Y.create(),a=Y.create();return function(o,s){var l=o.min.array,c=o.max.array,d=s.array;return e[0]=d[0]*l[0],e[1]=d[1]*l[0],e[2]=d[2]*l[0],t[0]=d[0]*c[0],t[1]=d[1]*c[0],t[2]=d[2]*c[0],i[0]=d[4]*l[1],i[1]=d[5]*l[1],i[2]=d[6]*l[1],r[0]=d[4]*c[1],r[1]=d[5]*c[1],r[2]=d[6]*c[1],n[0]=d[8]*l[2],n[1]=d[9]*l[2],n[2]=d[10]*l[2],a[0]=d[8]*c[2],a[1]=d[9]*c[2],a[2]=d[10]*c[2],l=this.min.array,c=this.max.array,l[0]=Math.min(e[0],t[0])+Math.min(i[0],r[0])+Math.min(n[0],a[0])+d[12],l[1]=Math.min(e[1],t[1])+Math.min(i[1],r[1])+Math.min(n[1],a[1])+d[13],l[2]=Math.min(e[2],t[2])+Math.min(i[2],r[2])+Math.min(n[2],a[2])+d[14],c[0]=Math.max(e[0],t[0])+Math.max(i[0],r[0])+Math.max(n[0],a[0])+d[12],c[1]=Math.max(e[1],t[1])+Math.max(i[1],r[1])+Math.max(n[1],a[1])+d[13],c[2]=Math.max(e[2],t[2])+Math.max(i[2],r[2])+Math.max(n[2],a[2])+d[14],this.min._dirty=!0,this.max._dirty=!0,this}}(),applyProjection:function(e){var t=this.min.array,i=this.max.array,r=e.array,n=t[0],a=t[1],o=t[2],s=i[0],l=i[1],c=t[2],d=i[0],u=i[1],h=i[2];if(r[15]===1)t[0]=r[0]*n+r[12],t[1]=r[5]*a+r[13],i[2]=r[10]*o+r[14],i[0]=r[0]*d+r[12],i[1]=r[5]*u+r[13],t[2]=r[10]*h+r[14];else{var m=-1/o;t[0]=r[0]*n*m,t[1]=r[5]*a*m,i[2]=(r[10]*o+r[14])*m,m=-1/c,i[0]=r[0]*s*m,i[1]=r[5]*l*m,m=-1/h,t[2]=(r[10]*h+r[14])*m}return this.min._dirty=!0,this.max._dirty=!0,this},updateVertices:function(){var e=this.vertices;if(!e){e=[];for(var t=0;t<8;t++)e[t]=Y.fromValues(0,0,0);this.vertices=e}var i=this.min.array,r=this.max.array;return hc(e[0],i[0],i[1],i[2]),hc(e[1],i[0],r[1],i[2]),hc(e[2],r[0],i[1],i[2]),hc(e[3],r[0],r[1],i[2]),hc(e[4],i[0],i[1],r[2]),hc(e[5],i[0],r[1],r[2]),hc(e[6],r[0],i[1],r[2]),hc(e[7],r[0],r[1],r[2]),this},copy:function(e){var t=this.min,i=this.max;return y0(t.array,e.min.array),y0(i.array,e.max.array),t._dirty=!0,i._dirty=!0,this},clone:function(){var e=new w0;return e.copy(this),e}};var wr=w0;var EH=0,SH=Ui.extend({name:"",position:null,rotation:null,scale:null,worldTransform:null,localTransform:null,autoUpdateLocalTransform:!0,_parent:null,_scene:null,_needsUpdateWorldTransform:!0,_inIterating:!1,__depth:0},function(){this.name||(this.name=(this.type||"NODE")+"_"+EH++),this.position||(this.position=new Se),this.rotation||(this.rotation=new x0),this.scale||(this.scale=new Se(1,1,1)),this.worldTransform=new Ye,this.localTransform=new Ye,this._children=[]},{target:null,invisible:!1,isSkinnedMesh:function(){return!1},isRenderable:function(){return!1},setName:function(e){var t=this._scene;if(t){var i=t._nodeRepository;delete i[this.name],i[e]=this}this.name=e},add:function(e){var t=e._parent;if(t!==this){t&&t.remove(e),e._parent=this,this._children.push(e);var i=this._scene;i&&i!==e.scene&&e.traverse(this._addSelfToScene,this),e._needsUpdateWorldTransform=!0}},remove:function(e){var t=this._children,i=t.indexOf(e);i<0||(t.splice(i,1),e._parent=null,this._scene&&e.traverse(this._removeSelfFromScene,this))},removeAll:function(){for(var e=this._children,t=0;t<e.length;t++)e[t]._parent=null,this._scene&&e[t].traverse(this._removeSelfFromScene,this);this._children=[]},getScene:function(){return this._scene},getParent:function(){return this._parent},_removeSelfFromScene:function(e){e._scene.removeFromScene(e),e._scene=null},_addSelfToScene:function(e){this._scene.addToScene(e),e._scene=this._scene},isAncestor:function(e){for(var t=e._parent;t;){if(t===this)return!0;t=t._parent}return!1},children:function(){return this._children.slice()},childAt:function(e){return this._children[e]},getChildByName:function(e){for(var t=this._children,i=0;i<t.length;i++)if(t[i].name===e)return t[i]},getDescendantByName:function(e){for(var t=this._children,i=0;i<t.length;i++){var r=t[i];if(r.name===e)return r;var n=r.getDescendantByName(e);if(n)return n}},queryNode:function(e){if(e){for(var t=e.split("/"),i=this,r=0;r<t.length;r++){var n=t[r];if(n){for(var a=!1,o=i._children,s=0;s<o.length;s++){var l=o[s];if(l.name===n){i=l,a=!0;break}}if(!a)return}}return i}},getPath:function(e){if(!this._parent)return"/";for(var t=this._parent,i=this.name;t._parent&&(i=t.name+"/"+i,t._parent!=e);)t=t._parent;return!t._parent&&e?null:i},traverse:function(e,t){e.call(t,this);for(var i=this._children,r=0,n=i.length;r<n;r++)i[r].traverse(e,t)},eachChild:function(e,t){for(var i=this._children,r=0,n=i.length;r<n;r++){var a=i[r];e.call(t,a,r)}},setLocalTransform:function(e){ke.copy(this.localTransform.array,e.array),this.decomposeLocalTransform()},decomposeLocalTransform:function(e){var t=e?null:this.scale;this.localTransform.decomposeMatrix(t,this.rotation,this.position)},setWorldTransform:function(e){ke.copy(this.worldTransform.array,e.array),this.decomposeWorldTransform()},decomposeWorldTransform:function(){var e=ke.create();return function(t){var i=this.localTransform,r=this.worldTransform;this._parent?(ke.invert(e,this._parent.worldTransform.array),ke.multiply(i.array,e,r.array)):ke.copy(i.array,r.array);var n=t?null:this.scale;i.decomposeMatrix(n,this.rotation,this.position)}}(),transformNeedsUpdate:function(){return this.position._dirty||this.rotation._dirty||this.scale._dirty},updateLocalTransform:function(){var e=this.position,t=this.rotation,i=this.scale;if(this.transformNeedsUpdate()){var r=this.localTransform.array;ke.fromRotationTranslation(r,t.array,e.array),ke.scale(r,r,i.array),t._dirty=!1,i._dirty=!1,e._dirty=!1,this._needsUpdateWorldTransform=!0}},_updateWorldTransformTopDown:function(){var e=this.localTransform.array,t=this.worldTransform.array;this._parent?ke.multiplyAffine(t,this._parent.worldTransform.array,e):ke.copy(t,e)},updateWorldTransform:function(){for(var e=this;e&&e.getParent()&&e.getParent().transformNeedsUpdate();)e=e.getParent();e.update()},update:function(e){this.autoUpdateLocalTransform?this.updateLocalTransform():e=!0,(e||this._needsUpdateWorldTransform)&&(this._updateWorldTransformTopDown(),e=!0,this._needsUpdateWorldTransform=!1);for(var t=this._children,i=0,r=t.length;i<r;i++)t[i].update(e)},getBoundingBox:function(){function e(n){return!n.invisible&&n.geometry}var t=new wr,i=new Ye,r=new Ye;return function(n,a){return a=a||new wr,n=n||e,this._parent?Ye.invert(r,this._parent.worldTransform):Ye.identity(r),this.traverse(function(o){o.geometry&&o.geometry.boundingBox&&(t.copy(o.geometry.boundingBox),Ye.multiply(i,r,o.worldTransform),t.applyTransform(i),a.union(t))},this,e),a}}(),getWorldPosition:function(e){this.transformNeedsUpdate()&&this.updateWorldTransform();var t=this.worldTransform.array;if(e){var i=e.array;return i[0]=t[12],i[1]=t[13],i[2]=t[14],e}else return new Se(t[12],t[13],t[14])},clone:function(){var e=new this.constructor,t=this._children;e.setName(this.name),e.position.copy(this.position),e.rotation.copy(this.rotation),e.scale.copy(this.scale);for(var i=0;i<t.length;i++)e.add(t[i].clone());return e},rotateAround:function(){var e=new Se,t=new Ye;return function(i,r,n){e.copy(this.position).subtract(i);var a=this.localTransform;a.identity(),a.translate(i),a.rotate(n,r),t.fromRotationTranslation(this.rotation,e),a.multiply(t),a.scale(this.scale),this.decomposeLocalTransform(),this._needsUpdateWorldTransform=!0}}(),lookAt:function(){var e=new Ye;return function(t,i){e.lookAt(this.position,t,i||this.localTransform.y).invert(),this.setLocalTransform(e),this.target=t}}()}),ra=SH;var Ja=ra.extend({material:null,geometry:null,mode:se.TRIANGLES,_renderInfo:null},{__program:null,lightGroup:0,renderOrder:0,culling:!0,cullFace:se.BACK,frontFace:se.CCW,frustumCulling:!0,receiveShadow:!0,castShadow:!0,ignorePicking:!1,ignorePreZ:!1,ignoreGBuffer:!1,isRenderable:function(){return this.geometry&&this.material&&this.material.shader&&!this.invisible&&this.geometry.vertexCount>0},beforeRender:function(e){},afterRender:function(e,t){},getBoundingBox:function(e,t){return t=ra.prototype.getBoundingBox.call(this,e,t),this.geometry&&this.geometry.boundingBox&&t.union(this.geometry.boundingBox),t},clone:function(){var e=["castShadow","receiveShadow","mode","culling","cullFace","frontFace","frustumCulling","renderOrder","lineWidth","ignorePicking","ignorePreZ","ignoreGBuffer"];return function(){var t=ra.prototype.clone.call(this);t.geometry=this.geometry,t.material=this.material;for(var i=0;i<e.length;i++){var r=e[i];t[r]!==this[r]&&(t[r]=this[r])}return t}}()});Ja.POINTS=se.POINTS;Ja.LINES=se.LINES;Ja.LINE_LOOP=se.LINE_LOOP;Ja.LINE_STRIP=se.LINE_STRIP;Ja.TRIANGLES=se.TRIANGLES;Ja.TRIANGLE_STRIP=se.TRIANGLE_STRIP;Ja.TRIANGLE_FAN=se.TRIANGLE_FAN;Ja.BACK=se.BACK;Ja.FRONT=se.FRONT;Ja.FRONT_AND_BACK=se.FRONT_AND_BACK;Ja.CW=se.CW;Ja.CCW=se.CCW;var tf=Ja;var E1=Ui.extend({scene:null,camera:null,renderer:null},function(){this._ray=new Nd,this._ndc=new rn},{pick:function(e,t,i){var r=this.pickAll(e,t,[],i);return r[0]||null},pickAll:function(e,t,i,r){return this.renderer.screenToNDC(e,t,this._ndc),this.camera.castRay(this._ndc,this._ray),i=i||[],this._intersectNode(this.scene,i,r||!1),i.sort(this._intersectionCompareFunc),i},_intersectNode:function(e,t,i){e instanceof tf&&e.isRenderable()&&(!e.ignorePicking||i)&&(e.mode===se.TRIANGLES&&e.geometry.isUseIndices()||e.geometry.pickByRay||e.geometry.pick)&&this._intersectRenderable(e,t);for(var r=0;r<e._children.length;r++)this._intersectNode(e._children[r],t,i)},_intersectRenderable:function(){var e=new Se,t=new Se,i=new Se,r=new Nd,n=new Ye;return function(a,o){var s=a.isSkinnedMesh();r.copy(this._ray),Ye.invert(n,a.worldTransform),s||r.applyTransform(n);var l=a.geometry,c=s?a.skeleton.boundingBox:l.boundingBox;if(!(c&&!r.intersectBoundingBox(c))){if(l.pick){l.pick(this._ndc.x,this._ndc.y,this.renderer,this.camera,a,o);return}else if(l.pickByRay){l.pickByRay(r,a,o);return}var d=a.cullFace===se.BACK&&a.frontFace===se.CCW||a.cullFace===se.FRONT&&a.frontFace===se.CW,u,h=l.indices,m=l.attributes.position,f=l.attributes.weight,p=l.attributes.joint,g,v=[];if(!(!m||!m.value||!h)){if(s){g=a.skeleton.getSubSkinMatrices(a.__uid__,a.joints);for(var b=0;b<a.joints.length;b++){v[b]=v[b]||[];for(var _=0;_<16;_++)v[b][_]=g[b*16+_]}var x=[],w=[],y=[],M=[],T=[],C=l.attributes.skinnedPosition;(!C||!C.value)&&(l.createAttribute("skinnedPosition","f",3),C=l.attributes.skinnedPosition,C.init(l.vertexCount));for(var b=0;b<l.vertexCount;b++){m.get(b,x),f.get(b,w),p.get(b,y),w[3]=1-w[0]-w[1]-w[2],Y.set(M,0,0,0);for(var _=0;_<4;_++)y[_]>=0&&w[_]>1e-4&&(Y.transformMat4(T,x,v[y[_]]),Y.scaleAndAdd(M,M,T,w[_]));C.set(b,M)}}for(var b=0;b<h.length;b+=3){var N=h[b],D=h[b+1],k=h[b+2],U=s?l.attributes.skinnedPosition:m;if(U.get(N,e.array),U.get(D,t.array),U.get(k,i.array),d?u=r.intersectTriangle(e,t,i,a.culling):u=r.intersectTriangle(e,i,t,a.culling),u){var F=new Se;s?Se.copy(F,u):Se.transformMat4(F,u,a.worldTransform),o.push(new E1.Intersection(u,F,a,[N,D,k],b/3,Se.dist(F,this._ray.origin)))}}}}}}(),_intersectionCompareFunc:function(e,t){return e.distance-t.distance}});E1.Intersection=function(e,t,i,r,n,a){this.point=e,this.pointWorld=t,this.target=i,this.triangle=r,this.triangleIndex=n,this.distance=a};var wk=E1;var rf="__dt__",C0=function(){this._contextId=0,this._caches=[],this._context={}};C0.prototype={use:function(e,t){var i=this._caches;i[e]||(i[e]={},t&&(i[e]=t())),this._contextId=e,this._context=i[e]},put:function(e,t){this._context[e]=t},get:function(e){return this._context[e]},dirty:function(e){e=e||"";var t=rf+e;this.put(t,!0)},dirtyAll:function(e){e=e||"";for(var t=rf+e,i=this._caches,r=0;r<i.length;r++)i[r]&&(i[r][t]=!0)},fresh:function(e){e=e||"";var t=rf+e;this.put(t,!1)},freshAll:function(e){e=e||"";for(var t=rf+e,i=this._caches,r=0;r<i.length;r++)i[r]&&(i[r][t]=!1)},isDirty:function(e){e=e||"";var t=rf+e,i=this._context;return!i.hasOwnProperty(t)||i[t]===!0},deleteContext:function(e){delete this._caches[e],this._context={}},delete:function(e){delete this._context[e]},clearAll:function(){this._caches={}},getContext:function(){return this._context},eachContext:function(e,t){var i=Object.keys(this._caches);i.forEach(function(r){e&&e.call(t,r)})},miss:function(e){return!this._context.hasOwnProperty(e)}};C0.prototype.constructor=C0;var yh=C0;var hi=Ui.extend({width:512,height:512,type:se.UNSIGNED_BYTE,format:se.RGBA,wrapS:se.REPEAT,wrapT:se.REPEAT,minFilter:se.LINEAR_MIPMAP_LINEAR,magFilter:se.LINEAR,useMipmap:!0,anisotropic:1,flipY:!0,sRGB:!0,unpackAlignment:4,premultiplyAlpha:!1,dynamic:!1,NPOT:!1,__used:0},function(){this._cache=new yh},{getWebGLTexture:function(e){var t=e.gl,i=this._cache;return i.use(e.__uid__),i.miss("webgl_texture")&&i.put("webgl_texture",t.createTexture()),this.dynamic?this.update(e):i.isDirty()&&(this.update(e),i.fresh()),i.get("webgl_texture")},bind:function(){},unbind:function(){},dirty:function(){this._cache&&this._cache.dirtyAll()},update:function(e){},updateCommon:function(e){var t=e.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,this.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,this.unpackAlignment),this.format===se.DEPTH_COMPONENT&&(this.useMipmap=!1);var i=e.getGLExtension("EXT_sRGB");this.format===hi.SRGB&&!i&&(this.format=hi.RGB),this.format===hi.SRGB_ALPHA&&!i&&(this.format=hi.RGBA),this.NPOT=!this.isPowerOfTwo()},getAvailableWrapS:function(){return this.NPOT?se.CLAMP_TO_EDGE:this.wrapS},getAvailableWrapT:function(){return this.NPOT?se.CLAMP_TO_EDGE:this.wrapT},getAvailableMinFilter:function(){var e=this.minFilter;return this.NPOT||!this.useMipmap?e===se.NEAREST_MIPMAP_NEAREST||e===se.NEAREST_MIPMAP_LINEAR?se.NEAREST:e===se.LINEAR_MIPMAP_LINEAR||e===se.LINEAR_MIPMAP_NEAREST?se.LINEAR:e:e},getAvailableMagFilter:function(){return this.magFilter},nextHighestPowerOfTwo:function(e){--e;for(var t=1;t<32;t<<=1)e=e|e>>t;return e+1},dispose:function(e){var t=this._cache;t.use(e.__uid__);var i=t.get("webgl_texture");i&&e.gl.deleteTexture(i),t.deleteContext(e.__uid__)},isRenderable:function(){},isPowerOfTwo:function(){}});Object.defineProperty(hi.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e}});Object.defineProperty(hi.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e}});hi.BYTE=se.BYTE;hi.UNSIGNED_BYTE=se.UNSIGNED_BYTE;hi.SHORT=se.SHORT;hi.UNSIGNED_SHORT=se.UNSIGNED_SHORT;hi.INT=se.INT;hi.UNSIGNED_INT=se.UNSIGNED_INT;hi.FLOAT=se.FLOAT;hi.HALF_FLOAT=36193;hi.UNSIGNED_INT_24_8_WEBGL=34042;hi.DEPTH_COMPONENT=se.DEPTH_COMPONENT;hi.DEPTH_STENCIL=se.DEPTH_STENCIL;hi.ALPHA=se.ALPHA;hi.RGB=se.RGB;hi.RGBA=se.RGBA;hi.LUMINANCE=se.LUMINANCE;hi.LUMINANCE_ALPHA=se.LUMINANCE_ALPHA;hi.SRGB=35904;hi.SRGB_ALPHA=35906;hi.COMPRESSED_RGB_S3TC_DXT1_EXT=33776;hi.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777;hi.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778;hi.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779;hi.NEAREST=se.NEAREST;hi.LINEAR=se.LINEAR;hi.NEAREST_MIPMAP_NEAREST=se.NEAREST_MIPMAP_NEAREST;hi.LINEAR_MIPMAP_NEAREST=se.LINEAR_MIPMAP_NEAREST;hi.NEAREST_MIPMAP_LINEAR=se.NEAREST_MIPMAP_LINEAR;hi.LINEAR_MIPMAP_LINEAR=se.LINEAR_MIPMAP_LINEAR;hi.REPEAT=se.REPEAT;hi.CLAMP_TO_EDGE=se.CLAMP_TO_EDGE;hi.MIRRORED_REPEAT=se.MIRRORED_REPEAT;var qe=hi;var eo=tf.extend({skeleton:null,joints:null},function(){this.joints||(this.joints=[])},{offsetMatrix:null,isInstancedMesh:function(){return!1},isSkinnedMesh:function(){return!!(this.skeleton&&this.joints&&this.joints.length>0)},clone:function(){var e=tf.prototype.clone.call(this);return e.skeleton=this.skeleton,this.joints&&(e.joints=this.joints.slice()),e}});eo.POINTS=se.POINTS;eo.LINES=se.LINES;eo.LINE_LOOP=se.LINE_LOOP;eo.LINE_STRIP=se.LINE_STRIP;eo.TRIANGLES=se.TRIANGLES;eo.TRIANGLE_STRIP=se.TRIANGLE_STRIP;eo.TRIANGLE_FAN=se.TRIANGLE_FAN;eo.BACK=se.BACK;eo.FRONT=se.FRONT;eo.FRONT_AND_BACK=se.FRONT_AND_BACK;eo.CW=se.CW;eo.CCW=se.CCW;var cs=eo;var E0={};E0.isPowerOfTwo=function(e){return(e&e-1)===0};E0.nextPowerOfTwo=function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e};E0.nearestPowerOfTwo=function(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))};var S0=E0;var Ck=S0.isPowerOfTwo;function Ek(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))}function AH(e,t){var i=Ek(e.width),r=Ek(e.height);t=t||document.createElement("canvas"),t.width=i,t.height=r;var n=t.getContext("2d");return n.drawImage(e.image,0,0,i,r),t}var S1=qe.extend(function(){return{image:null,pixels:null,mipmaps:[],convertToPOT:!1}},{textureType:"texture2D",update:function(e){var t=e.gl;t.bindTexture(t.TEXTURE_2D,this._cache.get("webgl_texture")),this.updateCommon(e);var i=this.format,r=this.type,n=!!(this.convertToPOT&&!this.mipmaps.length&&this.image&&(this.wrapS===qe.REPEAT||this.wrapT===qe.REPEAT)&&this.NPOT);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,n?this.wrapS:this.getAvailableWrapS()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,n?this.wrapT:this.getAvailableWrapT()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n?this.magFilter:this.getAvailableMagFilter()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n?this.minFilter:this.getAvailableMinFilter());var a=e.getGLExtension("EXT_texture_filter_anisotropic");if(a&&this.anisotropic>1&&t.texParameterf(t.TEXTURE_2D,a.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),r===36193){var o=e.getGLExtension("OES_texture_half_float");o||(r=se.FLOAT)}if(this.mipmaps.length)for(var s=this.width,l=this.height,c=0;c<this.mipmaps.length;c++){var d=this.mipmaps[c];this._updateTextureData(t,d,c,s,l,i,r,!1),s/=2,l/=2}else this._updateTextureData(t,this,0,this.width,this.height,i,r,n),this.useMipmap&&(!this.NPOT||n)&&t.generateMipmap(t.TEXTURE_2D);t.bindTexture(t.TEXTURE_2D,null)},_updateTextureData:function(e,t,i,r,n,a,o,s){if(t.image){var l=t.image;s&&(this._potCanvas=AH(this,this._potCanvas),l=this._potCanvas),e.texImage2D(e.TEXTURE_2D,i,a,a,o,l)}else a<=qe.COMPRESSED_RGBA_S3TC_DXT5_EXT&&a>=qe.COMPRESSED_RGB_S3TC_DXT1_EXT?e.compressedTexImage2D(e.TEXTURE_2D,i,a,r,n,0,t.pixels):e.texImage2D(e.TEXTURE_2D,i,a,r,n,0,a,o,t.pixels)},generateMipmap:function(e){var t=e.gl;this.useMipmap&&!this.NPOT&&(t.bindTexture(t.TEXTURE_2D,this._cache.get("webgl_texture")),t.generateMipmap(t.TEXTURE_2D))},isPowerOfTwo:function(){return Ck(this.width)&&Ck(this.height)},isRenderable:function(){return this.image?this.image.width>0&&this.image.height>0:!!(this.width&&this.height)},bind:function(e){e.gl.bindTexture(e.gl.TEXTURE_2D,this.getWebGLTexture(e))},unbind:function(e){e.gl.bindTexture(e.gl.TEXTURE_2D,null)},load:function(e,t){var i=Ai.createImage();t&&(i.crossOrigin=t);var r=this;return i.onload=function(){r.dirty(),r.trigger("success",r)},i.onerror=function(){r.trigger("error",r)},i.src=e,this.image=i,this}});Object.defineProperty(S1.prototype,"width",{get:function(){return this.image?this.image.width:this._width},set:function(e){this.image?console.warn("Texture from image can't set width"):(this._width!==e&&this.dirty(),this._width=e)}});Object.defineProperty(S1.prototype,"height",{get:function(){return this.image?this.image.height:this._height},set:function(e){this.image?console.warn("Texture from image can't set height"):(this._height!==e&&this.dirty(),this._height=e)}});var ct=S1;function Sk(e){return{byte:Ai.Int8Array,ubyte:Ai.Uint8Array,short:Ai.Int16Array,ushort:Ai.Uint16Array}[e]||Ai.Float32Array}function A1(e){return"attr_"+e}function wh(e,t,i,r){switch(this.name=e,this.type=t,this.size=i,this.semantic=r||"",this.value=null,i){case 1:this.get=function(n){return this.value[n]},this.set=function(n,a){this.value[n]=a},this.copy=function(n,a){this.value[n]=this.value[n]};break;case 2:this.get=function(n,a){var o=this.value;return a[0]=o[n*2],a[1]=o[n*2+1],a},this.set=function(n,a){var o=this.value;o[n*2]=a[0],o[n*2+1]=a[1]},this.copy=function(n,a){var o=this.value;a*=2,n*=2,o[n]=o[a],o[n+1]=o[a+1]};break;case 3:this.get=function(n,a){var o=n*3,s=this.value;return a[0]=s[o],a[1]=s[o+1],a[2]=s[o+2],a},this.set=function(n,a){var o=n*3,s=this.value;s[o]=a[0],s[o+1]=a[1],s[o+2]=a[2]},this.copy=function(n,a){var o=this.value;a*=3,n*=3,o[n]=o[a],o[n+1]=o[a+1],o[n+2]=o[a+2]};break;case 4:this.get=function(n,a){var o=this.value,s=n*4;return a[0]=o[s],a[1]=o[s+1],a[2]=o[s+2],a[3]=o[s+3],a},this.set=function(n,a){var o=this.value,s=n*4;o[s]=a[0],o[s+1]=a[1],o[s+2]=a[2],o[s+3]=a[3]},this.copy=function(n,a){var o=this.value;a*=4,n*=4,o[n]=o[a],o[n+1]=o[a+1],o[n+2]=o[a+2],o[n+3]=o[a+3]}}}wh.prototype.init=function(e){if(!this.value||this.value.length!==e*this.size){var t=Sk(this.type);this.value=new t(e*this.size)}};wh.prototype.fromArray=function(e){var t=Sk(this.type),i;if(e[0]&&e[0].length){var r=0,n=this.size;i=new t(e.length*n);for(var a=0;a<e.length;a++)for(var o=0;o<n;o++)i[r++]=e[a][o]}else i=new t(e);this.value=i};wh.prototype.clone=function(e){var t=new wh(this.name,this.type,this.size,this.semantic);return e&&console.warn("todo"),t};function Ak(e,t,i,r,n){this.name=e,this.type=t,this.buffer=i,this.size=r,this.semantic=n,this.symbol="",this.needsRemove=!1}function Tk(e){this.buffer=e,this.count=0}var ul=Ui.extend(function(){return{attributes:{},indices:null,dynamic:!0,_enabledAttributes:null,__used:0}},function(){this._cache=new yh,this._attributeList=Object.keys(this.attributes),this.__vaoCache={}},{mainAttribute:"",pick:null,pickByRay:null,dirty:function(){for(var e=this.getEnabledAttributes(),t=0;t<e.length;t++)this.dirtyAttribute(e[t]);this.dirtyIndices(),this._enabledAttributes=null,this._cache.dirty("any")},dirtyIndices:function(){this._cache.dirtyAll("indices")},dirtyAttribute:function(e){this._cache.dirtyAll(A1(e)),this._cache.dirtyAll("attributes")},getTriangleIndices:function(e,t){if(e<this.triangleCount&&e>=0){t||(t=[]);var i=this.indices;return t[0]=i[e*3],t[1]=i[e*3+1],t[2]=i[e*3+2],t}},setTriangleIndices:function(e,t){var i=this.indices;i[e*3]=t[0],i[e*3+1]=t[1],i[e*3+2]=t[2]},isUseIndices:function(){return!!this.indices},initIndicesFromArray:function(e){var t,i=this.vertexCount>65535?Ai.Uint32Array:Ai.Uint16Array;if(e[0]&&e[0].length){var r=0,n=3;t=new i(e.length*n);for(var a=0;a<e.length;a++)for(var o=0;o<n;o++)t[r++]=e[a][o]}else t=new i(e);this.indices=t},createAttribute:function(e,t,i,r){var n=new wh(e,t,i,r);return this.attributes[e]&&this.removeAttribute(e),this.attributes[e]=n,this._attributeList.push(e),n},removeAttribute:function(e){var t=this._attributeList,i=t.indexOf(e);return i>=0?(t.splice(i,1),delete this.attributes[e],!0):!1},getAttribute:function(e){return this.attributes[e]},getEnabledAttributes:function(){var e=this._enabledAttributes,t=this._attributeList;if(e)return e;for(var i=[],r=this.vertexCount,n=0;n<t.length;n++){var a=t[n],o=this.attributes[a];o.value&&o.value.length===r*o.size&&i.push(a)}return this._enabledAttributes=i,i},getBufferChunks:function(e){var t=this._cache;t.use(e.__uid__);var i=t.isDirty("attributes"),r=t.isDirty("indices");if(i||r){this._updateBuffer(e.gl,i,r);for(var n=this.getEnabledAttributes(),a=0;a<n.length;a++)t.fresh(A1(n[a]));t.fresh("attributes"),t.fresh("indices")}return t.fresh("any"),t.get("chunks")},_updateBuffer:function(e,t,i){var r=this._cache,n=r.get("chunks"),a=!1;n||(n=[],n[0]={attributeBuffers:[],indicesBuffer:null},r.put("chunks",n),a=!0);var o=n[0],s=o.attributeBuffers,l=o.indicesBuffer;if(t||a){var c=this.getEnabledAttributes(),d={};if(!a)for(var u=0;u<s.length;u++)d[s[u].name]=s[u];for(var h=0;h<c.length;h++){var m=c[h],f=this.attributes[m],p;a||(p=d[m]);var g;p?g=p.buffer:g=e.createBuffer(),r.isDirty(A1(m))&&(e.bindBuffer(e.ARRAY_BUFFER,g),e.bufferData(e.ARRAY_BUFFER,f.value,this.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW)),s[h]=new Ak(m,f.type,g,f.size,f.semantic)}for(var u=h;u<s.length;u++)e.deleteBuffer(s[u].buffer);s.length=h}this.isUseIndices()&&(i||a)&&(l||(l=new Tk(e.createBuffer()),o.indicesBuffer=l),l.count=this.indices.length,e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,l.buffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,this.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW))},dispose:function(e){var t=this._cache;t.use(e.__uid__);var i=t.get("chunks");if(i)for(var r=0;r<i.length;r++){for(var n=i[r],a=0;a<n.attributeBuffers.length;a++){var o=n.attributeBuffers[a];e.gl.deleteBuffer(o.buffer)}n.indicesBuffer&&e.gl.deleteBuffer(n.indicesBuffer.buffer)}if(this.__vaoCache){var s=e.getGLExtension("OES_vertex_array_object");for(var l in this.__vaoCache){var c=this.__vaoCache[l].vao;c&&s.deleteVertexArrayOES(c)}}this.__vaoCache={},t.deleteContext(e.__uid__)}});Object.defineProperty&&(Object.defineProperty(ul.prototype,"vertexCount",{enumerable:!1,get:function(){var e=this.attributes[this.mainAttribute];return e||(e=this.attributes[this._attributeList[0]]),!e||!e.value?0:e.value.length/e.size}}),Object.defineProperty(ul.prototype,"triangleCount",{enumerable:!1,get:function(){var e=this.indices;return e?e.length/3:0}}));ul.STATIC_DRAW=se.STATIC_DRAW;ul.DYNAMIC_DRAW=se.DYNAMIC_DRAW;ul.STREAM_DRAW=se.STREAM_DRAW;ul.AttributeBuffer=Ak;ul.IndicesBuffer=Tk;ul.Attribute=wh;var mc=ul;var na=Y.create,Ch=Y.add,Pd=Y.set,Ds=mc.Attribute,Rd=mc.extend(function(){return{attributes:{position:new Ds("position","float",3,"POSITION"),texcoord0:new Ds("texcoord0","float",2,"TEXCOORD_0"),texcoord1:new Ds("texcoord1","float",2,"TEXCOORD_1"),normal:new Ds("normal","float",3,"NORMAL"),tangent:new Ds("tangent","float",4,"TANGENT"),color:new Ds("color","float",4,"COLOR"),weight:new Ds("weight","float",3,"WEIGHT"),joint:new Ds("joint","float",4,"JOINT"),barycentric:new Ds("barycentric","float",3,null)},boundingBox:null}},{mainAttribute:"position",updateBoundingBox:function(){var e=this.boundingBox;e||(e=this.boundingBox=new wr);var t=this.attributes.position.value;if(t&&t.length){var i=e.min,r=e.max,n=i.array,a=r.array;Y.set(n,t[0],t[1],t[2]),Y.set(a,t[0],t[1],t[2]);for(var o=3;o<t.length;){var s=t[o++],l=t[o++],c=t[o++];s<n[0]&&(n[0]=s),l<n[1]&&(n[1]=l),c<n[2]&&(n[2]=c),s>a[0]&&(a[0]=s),l>a[1]&&(a[1]=l),c>a[2]&&(a[2]=c)}i._dirty=!0,r._dirty=!0}},generateVertexNormals:function(){if(this.vertexCount){var e=this.indices,t=this.attributes,i=t.position.value,r=t.normal.value;if(!r||r.length!==i.length)r=t.normal.value=new Ai.Float32Array(i.length);else for(var n=0;n<r.length;n++)r[n]=0;for(var a=na(),o=na(),s=na(),l=na(),c=na(),d=na(),u=e?e.length:this.vertexCount,h,m,f,p=0;p<u;){e?(h=e[p++],m=e[p++],f=e[p++]):(h=p++,m=p++,f=p++),Pd(a,i[h*3],i[h*3+1],i[h*3+2]),Pd(o,i[m*3],i[m*3+1],i[m*3+2]),Pd(s,i[f*3],i[f*3+1],i[f*3+2]),Y.sub(l,a,o),Y.sub(c,o,s),Y.cross(d,l,c);for(var n=0;n<3;n++)r[h*3+n]=r[h*3+n]+d[n],r[m*3+n]=r[m*3+n]+d[n],r[f*3+n]=r[f*3+n]+d[n]}for(var n=0;n<r.length;)Pd(d,r[n],r[n+1],r[n+2]),Y.normalize(d,d),r[n++]=d[0],r[n++]=d[1],r[n++]=d[2];this.dirty()}},generateFaceNormals:function(){if(this.vertexCount){this.isUniqueVertex()||this.generateUniqueVertex();var e=this.indices,t=this.attributes,i=t.position.value,r=t.normal.value,n=na(),a=na(),o=na(),s=na(),l=na(),c=na();r||(r=t.normal.value=new Float32Array(i.length));for(var d=e?e.length:this.vertexCount,u,h,m,f=0;f<d;){e?(u=e[f++],h=e[f++],m=e[f++]):(u=f++,h=f++,m=f++),Pd(n,i[u*3],i[u*3+1],i[u*3+2]),Pd(a,i[h*3],i[h*3+1],i[h*3+2]),Pd(o,i[m*3],i[m*3+1],i[m*3+2]),Y.sub(s,n,a),Y.sub(l,a,o),Y.cross(c,s,l),Y.normalize(c,c);for(var p=0;p<3;p++)r[u*3+p]=c[p],r[h*3+p]=c[p],r[m*3+p]=c[p]}this.dirty()}},generateTangents:function(){if(this.vertexCount){var e=this.vertexCount,t=this.attributes;t.tangent.value||(t.tangent.value=new Float32Array(e*4));var i=t.texcoord0.value,r=t.position.value,n=t.tangent.value,a=t.normal.value;if(!i){console.warn("Geometry without texcoords can't generate tangents.");return}for(var o=[],s=[],l=0;l<e;l++)o[l]=[0,0,0],s[l]=[0,0,0];for(var c=[0,0,0],d=[0,0,0],u=this.indices,h=u?u.length:this.vertexCount,m,f,p,l=0;l<h;){u?(m=u[l++],f=u[l++],p=u[l++]):(m=l++,f=l++,p=l++);var g=i[m*2],v=i[f*2],b=i[p*2],_=i[m*2+1],x=i[f*2+1],w=i[p*2+1],y=r[m*3],M=r[f*3],T=r[p*3],C=r[m*3+1],N=r[f*3+1],D=r[p*3+1],k=r[m*3+2],U=r[f*3+2],F=r[p*3+2],H=M-y,V=T-y,Q=N-C,$=D-C,ee=U-k,re=F-k,we=v-g,te=b-g,oe=x-_,pe=w-_,ue=1/(we*pe-oe*te);c[0]=(pe*H-oe*V)*ue,c[1]=(pe*Q-oe*$)*ue,c[2]=(pe*ee-oe*re)*ue,d[0]=(we*V-te*H)*ue,d[1]=(we*$-te*Q)*ue,d[2]=(we*re-te*ee)*ue,Ch(o[m],o[m],c),Ch(o[f],o[f],c),Ch(o[p],o[p],c),Ch(s[m],s[m],d),Ch(s[f],s[f],d),Ch(s[p],s[p],d)}for(var _e=na(),ce=na(),fe=na(),l=0;l<e;l++){fe[0]=a[l*3],fe[1]=a[l*3+1],fe[2]=a[l*3+2];var be=o[l];Y.scale(_e,fe,Y.dot(fe,be)),Y.sub(_e,be,_e),Y.normalize(_e,_e),Y.cross(ce,fe,be),n[l*4]=_e[0],n[l*4+1]=_e[1],n[l*4+2]=_e[2],n[l*4+3]=Y.dot(ce,s[l])<0?-1:1}this.dirty()}},isUniqueVertex:function(){return this.isUseIndices()?this.vertexCount===this.indices.length:!0},generateUniqueVertex:function(){if(!(!this.vertexCount||!this.indices)){this.indices.length>65535&&(this.indices=new Ai.Uint32Array(this.indices));for(var e=this.attributes,t=this.indices,i=this.getEnabledAttributes(),r={},n=0;n<i.length;n++){var a=i[n];r[a]=e[a].value,e[a].init(this.indices.length)}for(var o=0,s=0;s<t.length;s++){for(var l=t[s],n=0;n<i.length;n++)for(var a=i[n],c=e[a].value,d=e[a].size,u=0;u<d;u++)c[o*d+u]=r[a][l*d+u];t[s]=o,o++}this.dirty()}},generateBarycentric:function(){if(this.vertexCount){this.isUniqueVertex()||this.generateUniqueVertex();var e=this.attributes,t=e.barycentric.value,i=this.indices;if(!(t&&t.length===i.length*3)){t=e.barycentric.value=new Float32Array(i.length*3);for(var r=0;r<(i?i.length:this.vertexCount/3);)for(var n=0;n<3;n++){var a=i?i[r++]:r*3+n;t[a*3+n]=1}this.dirty()}}},applyTransform:function(e){var t=this.attributes,i=t.position.value,r=t.normal.value,n=t.tangent.value;e=e.array;var a=ke.create();ke.invert(a,e),ke.transpose(a,a);var o=Y.transformMat4,s=Y.forEach;s(i,3,0,null,o,e),r&&s(r,3,0,null,o,a),n&&s(n,4,0,null,o,a),this.boundingBox&&this.updateBoundingBox()},dispose:function(e){var t=this._cache;t.use(e.__uid__);var i=t.get("chunks");if(i)for(var r=0;r<i.length;r++){for(var n=i[r],a=0;a<n.attributeBuffers.length;a++){var o=n.attributeBuffers[a];e.gl.deleteBuffer(o.buffer)}n.indicesBuffer&&e.gl.deleteBuffer(n.indicesBuffer.buffer)}if(this.__vaoCache){var s=e.getGLExtension("OES_vertex_array_object");for(var l in this.__vaoCache){var c=this.__vaoCache[l].vao;c&&s.deleteVertexArrayOES(c)}}this.__vaoCache={},t.deleteContext(e.__uid__)}});Rd.STATIC_DRAW=mc.STATIC_DRAW;Rd.DYNAMIC_DRAW=mc.DYNAMIC_DRAW;Rd.STREAM_DRAW=mc.STREAM_DRAW;Rd.AttributeBuffer=mc.AttributeBuffer;Rd.IndicesBuffer=mc.IndicesBuffer;Rd.Attribute=Ds;var Lt=Rd;var Dk=`vec3 calcAmbientSHLight(int idx, vec3 N) {
 int offset = 9 * idx;
 return ambientSHLightCoefficients[0]
 + ambientSHLightCoefficients[1] * N.x
 + ambientSHLightCoefficients[2] * N.y
 + ambientSHLightCoefficients[3] * N.z
 + ambientSHLightCoefficients[4] * N.x * N.z
 + ambientSHLightCoefficients[5] * N.z * N.y
 + ambientSHLightCoefficients[6] * N.y * N.x
 + ambientSHLightCoefficients[7] * (3.0 * N.z * N.z - 1.0)
 + ambientSHLightCoefficients[8] * (N.x * N.x - N.y * N.y);
}`;var ds="uniform vec3 ",nf="uniform float ",Eh="@export clay.header.",Sh="@end",dn=":unconfigurable;",Mk=[Eh+"directional_light",ds+"directionalLightDirection[DIRECTIONAL_LIGHT_COUNT]"+dn,ds+"directionalLightColor[DIRECTIONAL_LIGHT_COUNT]"+dn,Sh,Eh+"ambient_light",ds+"ambientLightColor[AMBIENT_LIGHT_COUNT]"+dn,Sh,Eh+"ambient_sh_light",ds+"ambientSHLightColor[AMBIENT_SH_LIGHT_COUNT]"+dn,ds+"ambientSHLightCoefficients[AMBIENT_SH_LIGHT_COUNT * 9]"+dn,Dk,Sh,Eh+"ambient_cubemap_light",ds+"ambientCubemapLightColor[AMBIENT_CUBEMAP_LIGHT_COUNT]"+dn,"uniform samplerCube ambientCubemapLightCubemap[AMBIENT_CUBEMAP_LIGHT_COUNT]"+dn,"uniform sampler2D ambientCubemapLightBRDFLookup[AMBIENT_CUBEMAP_LIGHT_COUNT]"+dn,Sh,Eh+"point_light",ds+"pointLightPosition[POINT_LIGHT_COUNT]"+dn,nf+"pointLightRange[POINT_LIGHT_COUNT]"+dn,ds+"pointLightColor[POINT_LIGHT_COUNT]"+dn,Sh,Eh+"spot_light",ds+"spotLightPosition[SPOT_LIGHT_COUNT]"+dn,ds+"spotLightDirection[SPOT_LIGHT_COUNT]"+dn,nf+"spotLightRange[SPOT_LIGHT_COUNT]"+dn,nf+"spotLightUmbraAngleCosine[SPOT_LIGHT_COUNT]"+dn,nf+"spotLightPenumbraAngleCosine[SPOT_LIGHT_COUNT]"+dn,nf+"spotLightFalloffFactor[SPOT_LIGHT_COUNT]"+dn,ds+"spotLightColor[SPOT_LIGHT_COUNT]"+dn,Sh].join(`
`);Re.import(Mk);var TH=ra.extend(function(){return{color:[1,1,1],intensity:1,castShadow:!0,shadowResolution:512,group:0}},{type:"",clone:function(){var e=ra.prototype.clone.call(this);return e.color=Array.prototype.slice.call(this.color),e.intensity=this.intensity,e.castShadow=this.castShadow,e.shadowResolution=this.shadowResolution,e}}),un=TH;var A0=function(e,t){this.normal=e||new Se(0,1,0),this.distance=t||0};A0.prototype={constructor:A0,distanceToPoint:function(e){return Y.dot(e.array,this.normal.array)-this.distance},projectPoint:function(e,t){t||(t=new Se);var i=this.distanceToPoint(e);return Y.scaleAndAdd(t.array,e.array,this.normal.array,-i),t._dirty=!0,t},normalize:function(){var e=1/Y.len(this.normal.array);Y.scale(this.normal.array,e),this.distance*=e},intersectFrustum:function(e){for(var t=e.vertices,i=this.normal.array,r=Y.dot(t[0].array,i)>this.distance,n=1;n<8;n++)if(Y.dot(t[n].array,i)>this.distance!=r)return!0},intersectLine:function(){var e=Y.create();return function(t,i,r){var n=this.distanceToPoint(t),a=this.distanceToPoint(i);if(n>0&&a>0||n<0&&a<0)return null;var o=this.normal.array,s=this.distance,l=t.array;Y.sub(e,i.array,t.array),Y.normalize(e,e);var c=Y.dot(o,e);if(c===0)return null;r||(r=new Se);var d=(Y.dot(o,l)-s)/c;return Y.scaleAndAdd(r.array,l,e,-d),r._dirty=!0,r}}(),applyTransform:function(){var e=ke.create(),t=We.create(),i=We.create();return i[3]=1,function(r){r=r.array,Y.scale(i,this.normal.array,this.distance),We.transformMat4(i,i,r),this.distance=Y.dot(i,this.normal.array),ke.invert(e,r),ke.transpose(e,e),t[3]=0,Y.copy(t,this.normal.array),We.transformMat4(t,t,e),Y.copy(this.normal.array,t)}}(),copy:function(e){Y.copy(this.normal.array,e.normal.array),this.normal._dirty=!0,this.distance=e.distance},clone:function(){var e=new A0;return e.copy(this),e}};var T0=A0;var Fr=Y.set,Ik=Y.copy,kk=Y.transformMat4,T1=Math.min,D1=Math.max,Nk=function(){this.planes=[];for(var e=0;e<6;e++)this.planes.push(new T0);this.boundingBox=new wr,this.vertices=[];for(var e=0;e<8;e++)this.vertices[e]=Y.fromValues(0,0,0)};Nk.prototype={setFromProjection:function(e){var t=this.planes,i=e.array,r=i[0],n=i[1],a=i[2],o=i[3],s=i[4],l=i[5],c=i[6],d=i[7],u=i[8],h=i[9],m=i[10],f=i[11],p=i[12],g=i[13],v=i[14],b=i[15];Fr(t[0].normal.array,o-r,d-s,f-u),t[0].distance=-(b-p),t[0].normalize(),Fr(t[1].normal.array,o+r,d+s,f+u),t[1].distance=-(b+p),t[1].normalize(),Fr(t[2].normal.array,o+n,d+l,f+h),t[2].distance=-(b+g),t[2].normalize(),Fr(t[3].normal.array,o-n,d-l,f-h),t[3].distance=-(b-g),t[3].normalize(),Fr(t[4].normal.array,o-a,d-c,f-m),t[4].distance=-(b-v),t[4].normalize(),Fr(t[5].normal.array,o+a,d+c,f+m),t[5].distance=-(b+v),t[5].normalize();var _=this.boundingBox,x=this.vertices;if(b===0){var w=l/r,y=-v/(m-1),M=-v/(m+1),T=-M/l,C=-y/l;_.min.set(-T*w,-T,M),_.max.set(T*w,T,y),Fr(x[0],-T*w,-T,M),Fr(x[1],-T*w,T,M),Fr(x[2],T*w,-T,M),Fr(x[3],T*w,T,M),Fr(x[4],-C*w,-C,y),Fr(x[5],-C*w,C,y),Fr(x[6],C*w,-C,y),Fr(x[7],C*w,C,y)}else{var N=(-1-p)/r,D=(1-p)/r,k=(1-g)/l,U=(-1-g)/l,F=(-1-v)/m,H=(1-v)/m;_.min.set(Math.min(N,D),Math.min(U,k),Math.min(H,F)),_.max.set(Math.max(D,N),Math.max(k,U),Math.max(F,H));var V=_.min.array,Q=_.max.array;Fr(x[0],V[0],V[1],V[2]),Fr(x[1],V[0],Q[1],V[2]),Fr(x[2],Q[0],V[1],V[2]),Fr(x[3],Q[0],Q[1],V[2]),Fr(x[4],V[0],V[1],Q[2]),Fr(x[5],V[0],Q[1],Q[2]),Fr(x[6],Q[0],V[1],Q[2]),Fr(x[7],Q[0],Q[1],Q[2])}},getTransformedBoundingBox:function(){var e=Y.create();return function(t,i){var r=this.vertices,n=i.array,a=t.min,o=t.max,s=a.array,l=o.array,c=r[0];kk(e,c,n),Ik(s,e),Ik(l,e);for(var d=1;d<8;d++)c=r[d],kk(e,c,n),s[0]=T1(e[0],s[0]),s[1]=T1(e[1],s[1]),s[2]=T1(e[2],s[2]),l[0]=D1(e[0],l[0]),l[1]=D1(e[1],l[1]),l[2]=D1(e[2],l[2]);return a._dirty=!0,o._dirty=!0,t}}()};var Ah=Nk;var DH=ra.extend(function(){return{projectionMatrix:new Ye,invProjectionMatrix:new Ye,viewMatrix:new Ye,frustum:new Ah}},function(){this.update(!0)},{update:function(e){ra.prototype.update.call(this,e),Ye.invert(this.viewMatrix,this.worldTransform),this.updateProjectionMatrix(),Ye.invert(this.invProjectionMatrix,this.projectionMatrix),this.frustum.setFromProjection(this.projectionMatrix)},setViewMatrix:function(e){Ye.copy(this.viewMatrix,e),Ye.invert(this.worldTransform,e),this.decomposeWorldTransform()},decomposeProjectionMatrix:function(){},setProjectionMatrix:function(e){Ye.copy(this.projectionMatrix,e),Ye.invert(this.invProjectionMatrix,e),this.decomposeProjectionMatrix()},updateProjectionMatrix:function(){},castRay:function(){var e=We.create();return function(t,i){var r=i!==void 0?i:new Nd,n=t.array[0],a=t.array[1];return We.set(e,n,a,-1,1),We.transformMat4(e,e,this.invProjectionMatrix.array),We.transformMat4(e,e,this.worldTransform.array),Y.scale(r.origin.array,e,1/e[3]),We.set(e,n,a,1,1),We.transformMat4(e,e,this.invProjectionMatrix.array),We.transformMat4(e,e,this.worldTransform.array),Y.scale(e,e,1/e[3]),Y.sub(r.direction.array,e,r.origin.array),Y.normalize(r.direction.array,r.direction.array),r.direction._dirty=!0,r.origin._dirty=!0,r}}()}),hl=DH;var MH=ke.create(),Pk=ke.create(),M1={};function IH(e){var t=[],i=Object.keys(e);i.sort();for(var r=0;r<i.length;r++){var n=i[r];t.push(n+" "+e[n])}var a=t.join(`
`);if(M1[a])return M1[a];var o=vr.genGUID();return M1[a]=o,o}function D0(){this.opaque=[],this.transparent=[],this._opaqueCount=0,this._transparentCount=0}D0.prototype.startCount=function(){this._opaqueCount=0,this._transparentCount=0};D0.prototype.add=function(e,t){t?this.transparent[this._transparentCount++]=e:this.opaque[this._opaqueCount++]=e};D0.prototype.endCount=function(){this.transparent.length=this._transparentCount,this.opaque.length=this._opaqueCount};var kH=ra.extend(function(){return{material:null,lights:[],viewBoundingBoxLastFrame:new wr,shadowUniforms:{},_cameraList:[],_lightUniforms:{},_previousLightNumber:{},_lightNumber:{},_lightProgramKeys:{},_nodeRepository:{},_renderLists:new h0(20)}},function(){this._scene=this},{addToScene:function(e){e instanceof hl?(this._cameraList.length>0&&console.warn("Found multiple camera in one scene. Use the fist one."),this._cameraList.push(e)):e instanceof un&&this.lights.push(e),e.name&&(this._nodeRepository[e.name]=e)},removeFromScene:function(e){var t;e instanceof hl?(t=this._cameraList.indexOf(e),t>=0&&this._cameraList.splice(t,1)):e instanceof un&&(t=this.lights.indexOf(e),t>=0&&this.lights.splice(t,1)),e.name&&delete this._nodeRepository[e.name]},getNode:function(e){return this._nodeRepository[e]},setMainCamera:function(e){var t=this._cameraList.indexOf(e);t>=0&&this._cameraList.splice(t,1),this._cameraList.unshift(e)},getMainCamera:function(){return this._cameraList[0]},getLights:function(){return this.lights},updateLights:function(){var e=this.lights;this._previousLightNumber=this._lightNumber;for(var t={},i=0;i<e.length;i++){var r=e[i];if(!r.invisible){var n=r.group;t[n]||(t[n]={}),t[n][r.type]=t[n][r.type]||0,t[n][r.type]++}}this._lightNumber=t;for(var a in t)this._lightProgramKeys[a]=IH(t[a]);this._updateLightUniforms()},cloneNode:function(e){var t=e.clone(),i={};function r(n,a){i[n.__uid__]=a;for(var o=0;o<n._children.length;o++){var s=n._children[o],l=a._children[o];r(s,l)}}return r(e,t),t.traverse(function(n){n.skeleton&&(n.skeleton=n.skeleton.clone(i)),n.material&&(n.material=n.material.clone())}),t},updateRenderList:function(e,t){var i=e.__uid__,r=this._renderLists.get(i);r||(r=new D0,this._renderLists.put(i,r)),r.startCount(),t&&(this.viewBoundingBoxLastFrame.min.set(1/0,1/0,1/0),this.viewBoundingBoxLastFrame.max.set(-1/0,-1/0,-1/0));var n=this.material&&this.material.transparent||!1;return this._doUpdateRenderList(this,e,n,r,t),r.endCount(),r},getRenderList:function(e){return this._renderLists.get(e.__uid__)},_doUpdateRenderList:function(e,t,i,r,n){if(!e.invisible)for(var a=0;a<e._children.length;a++){var o=e._children[a];if(o.isRenderable()){var s=o.isSkinnedMesh()?MH:o.worldTransform.array,l=o.geometry;ke.multiplyAffine(Pk,t.viewMatrix.array,s),(n&&!l.boundingBox||!this.isFrustumCulled(o,t,Pk))&&r.add(o,o.material.transparent||i)}o._children.length>0&&this._doUpdateRenderList(o,t,i,r,n)}},isFrustumCulled:function(){var e=new wr,t=new Ye;return function(i,r,n){var a=i.boundingBox;if(a||(i.skeleton&&i.skeleton.boundingBox?a=i.skeleton.boundingBox:a=i.geometry.boundingBox),!a)return!1;if(t.array=n,e.transformFrom(a,t),i.castShadow&&this.viewBoundingBoxLastFrame.union(e),i.frustumCulling){if(!e.intersectBoundingBox(r.frustum.boundingBox))return!0;t.array=r.projectionMatrix.array,e.max.array[2]>0&&e.min.array[2]<0&&(e.max.array[2]=-1e-20),e.applyProjection(t);var o=e.min.array,s=e.max.array;if(s[0]<-1||o[0]>1||s[1]<-1||o[1]>1||s[2]<-1||o[2]>1)return!0}return!1}}(),_updateLightUniforms:function(){var e=this.lights;e.sort(NH);var t=this._lightUniforms;for(var i in t)for(var r in t[i])t[i][r].value.length=0;for(var n=0;n<e.length;n++){var a=e[n];if(!a.invisible){var i=a.group;for(var r in a.uniformTemplates){var o=a.uniformTemplates[r],s=o.value(a);if(s!=null){t[i]||(t[i]={}),t[i][r]||(t[i][r]={type:"",value:[]});var l=t[i][r];switch(l.type=o.type+"v",o.type){case"1i":case"1f":case"t":l.value.push(s);break;case"2f":case"3f":case"4f":for(var c=0;c<s.length;c++)l.value.push(s[c]);break;default:console.error("Unkown light uniform type "+o.type)}}}}}},getLightGroups:function(){var e=[];for(var t in this._lightNumber)e.push(t);return e},getNumberChangedLightGroups:function(){var e=[];for(var t in this._lightNumber)this.isLightNumberChanged(t)&&e.push(t);return e},isLightNumberChanged:function(e){var t=this._previousLightNumber,i=this._lightNumber;for(var r in i[e])if(!t[e]||i[e][r]!==t[e][r])return!0;for(var r in t[e])if(!i[e]||i[e][r]!==t[e][r])return!0;return!1},getLightsNumbers:function(e){return this._lightNumber[e]},getProgramKey:function(e){return this._lightProgramKeys[e]},setLightUniforms:function(){function e(t,i,r){for(var n in t){var a=t[n];if(a.type==="tv"){if(!i.hasUniform(n))continue;for(var o=[],s=0;s<a.value.length;s++){var l=a.value[s],c=i.takeCurrentTextureSlot(r,l);o.push(c)}i.setUniform(r.gl,"1iv",n,o)}else i.setUniform(r.gl,a.type,n,a.value)}}return function(t,i,r){e(this._lightUniforms[i],t,r),e(this.shadowUniforms,t,r)}}(),dispose:function(){this.material=null,this._opaqueList=[],this._transparentList=[],this.lights=[],this._lightUniforms={},this._lightNumber={},this._nodeRepository={}}});function NH(e,t){if(t.castShadow&&!e.castShadow)return!0}var to=kH;var Rk=function(){function e(t){this.value=t}return e}();var PH=function(){function e(){this._len=0}return e.prototype.insert=function(t){var i=new Rk(t);return this.insertEntry(i),i},e.prototype.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},e.prototype.remove=function(t){var i=t.prev,r=t.next;i?i.next=r:this.head=r,r?r.prev=i:this.tail=i,t.next=t.prev=null,this._len--},e.prototype.len=function(){return this._len},e.prototype.clear=function(){this.head=this.tail=null,this._len=0},e}();var RH=function(){function e(t){this._list=new PH,this._maxSize=10,this._map={},this._maxSize=t}return e.prototype.put=function(t,i){var r=this._list,n=this._map,a=null;if(n[t]==null){var o=r.len(),s=this._lastRemovedEntry;if(o>=this._maxSize&&o>0){var l=r.head;r.remove(l),delete n[l.key],a=l.value,this._lastRemovedEntry=l}s?s.value=i:s=new Rk(i),s.key=t,r.insertEntry(s),n[t]=s}return a},e.prototype.get=function(t){var i=this._map[t],r=this._list;if(i!=null)return i!==r.tail&&(r.remove(i),r.insertEntry(i)),i.value},e.prototype.clear=function(){this._list.clear(),this._map={}},e.prototype.len=function(){return this._list.len()},e}(),M0=RH;var I0=S0.isPowerOfTwo,FH=["px","nx","py","ny","pz","nz"],I1=qe.extend(function(){return{image:{px:null,nx:null,py:null,ny:null,pz:null,nz:null},pixels:{px:null,nx:null,py:null,ny:null,pz:null,nz:null},mipmaps:[]}},{textureType:"textureCube",update:function(e){var t=e.gl;t.bindTexture(t.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),this.updateCommon(e);var i=this.format,r=this.type;t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,this.getAvailableWrapS()),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,this.getAvailableWrapT()),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,this.getAvailableMagFilter()),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,this.getAvailableMinFilter());var n=e.getGLExtension("EXT_texture_filter_anisotropic");if(n&&this.anisotropic>1&&t.texParameterf(t.TEXTURE_CUBE_MAP,n.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),r===36193){var a=e.getGLExtension("OES_texture_half_float");a||(r=se.FLOAT)}if(this.mipmaps.length)for(var o=this.width,s=this.height,l=0;l<this.mipmaps.length;l++){var c=this.mipmaps[l];this._updateTextureData(t,c,l,o,s,i,r),o/=2,s/=2}else this._updateTextureData(t,this,0,this.width,this.height,i,r),!this.NPOT&&this.useMipmap&&t.generateMipmap(t.TEXTURE_CUBE_MAP);t.bindTexture(t.TEXTURE_CUBE_MAP,null)},_updateTextureData:function(e,t,i,r,n,a,o){for(var s=0;s<6;s++){var l=FH[s],c=t.image&&t.image[l];c?e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,i,a,a,o,c):e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,i,a,r,n,0,a,o,t.pixels&&t.pixels[l])}},generateMipmap:function(e){var t=e.gl;this.useMipmap&&!this.NPOT&&(t.bindTexture(t.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),t.generateMipmap(t.TEXTURE_CUBE_MAP))},bind:function(e){e.gl.bindTexture(e.gl.TEXTURE_CUBE_MAP,this.getWebGLTexture(e))},unbind:function(e){e.gl.bindTexture(e.gl.TEXTURE_CUBE_MAP,null)},isPowerOfTwo:function(){return this.image.px?I0(this.image.px.width)&&I0(this.image.px.height):I0(this.width)&&I0(this.height)},isRenderable:function(){return this.image.px?Th(this.image.px)&&Th(this.image.nx)&&Th(this.image.py)&&Th(this.image.ny)&&Th(this.image.pz)&&Th(this.image.nz):!!(this.width&&this.height)},load:function(e,t){var i=0,r=this;return vr.each(e,function(n,a){var o=Ai.createImage();t&&(o.crossOrigin=t),o.onload=function(){i--,i===0&&(r.dirty(),r.trigger("success",r))},o.onerror=function(){i--},i++,o.src=n,r.image[a]=o}),this}});Object.defineProperty(I1.prototype,"width",{get:function(){return this.image&&this.image.px?this.image.px.width:this._width},set:function(e){this.image&&this.image.px?console.warn("Texture from image can't set width"):(this._width!==e&&this.dirty(),this._width=e)}});Object.defineProperty(I1.prototype,"height",{get:function(){return this.image&&this.image.px?this.image.px.height:this._height},set:function(e){this.image&&this.image.px?console.warn("Texture from image can't set height"):(this._height!==e&&this.dirty(),this._height=e)}});function Th(e){return e.width>0&&e.height>0}var ml=I1;var OH=hl.extend({fov:50,aspect:1,near:.1,far:2e3},{updateProjectionMatrix:function(){var e=this.fov/180*Math.PI;this.projectionMatrix.perspective(e,this.aspect,this.near,this.far)},decomposeProjectionMatrix:function(){var e=this.projectionMatrix.array,t=Math.atan(1/e[5])*2;this.fov=t/Math.PI*180,this.aspect=e[5]/e[0],this.near=e[14]/(e[10]-1),this.far=e[14]/(e[10]+1)},clone:function(){var e=hl.prototype.clone.call(this);return e.fov=this.fov,e.aspect=this.aspect,e.near=this.near,e.far=this.far,e}}),Cr=OH;var k0="framebuffer",pl="renderbuffer",Fk=pl+"_width",Ok=pl+"_height",k1=pl+"_attached",N1="depthtexture_attached",Fd=se.FRAMEBUFFER,af=se.RENDERBUFFER,of=se.DEPTH_ATTACHMENT,Lk=se.COLOR_ATTACHMENT0,sf=Ui.extend({depthBuffer:!0,viewport:null,_width:0,_height:0,_textures:null,_boundRenderer:null},function(){this._cache=new yh,this._textures={}},{getTextureWidth:function(){return this._width},getTextureHeight:function(){return this._height},bind:function(e){if(e.__currentFrameBuffer){if(e.__currentFrameBuffer===this)return;console.warn("Renderer already bound with another framebuffer. Unbind it first")}e.__currentFrameBuffer=this;var t=e.gl;t.bindFramebuffer(Fd,this._getFrameBufferGL(e)),this._boundRenderer=e;var i=this._cache;i.put("viewport",e.viewport);var r=!1,n,a;for(var o in this._textures){r=!0;var s=this._textures[o];s&&(n=s.texture.width,a=s.texture.height,this._doAttach(e,s.texture,o,s.target))}this._width=n,this._height=a,!r&&this.depthBuffer&&console.error("Must attach texture before bind, or renderbuffer may have incorrect width and height."),this.viewport?e.setViewport(this.viewport):e.setViewport(0,0,n,a,1);var l=i.get("attached_textures");if(l){for(var o in l)if(!this._textures[o]){var c=l[o];this._doDetach(t,o,c)}}if(!i.get(N1)&&this.depthBuffer){i.miss(pl)&&i.put(pl,t.createRenderbuffer());var d=i.get(pl);(n!==i.get(Fk)||a!==i.get(Ok))&&(t.bindRenderbuffer(af,d),t.renderbufferStorage(af,t.DEPTH_COMPONENT16,n,a),i.put(Fk,n),i.put(Ok,a),t.bindRenderbuffer(af,null)),i.get(k1)||(t.framebufferRenderbuffer(Fd,of,af,d),i.put(k1,!0))}},unbind:function(e){e.__currentFrameBuffer=null;var t=e.gl;t.bindFramebuffer(Fd,null),this._boundRenderer=null,this._cache.use(e.__uid__);var i=this._cache.get("viewport");i&&e.setViewport(i),this.updateMipmap(e)},updateMipmap:function(e){var t=e.gl;for(var i in this._textures){var r=this._textures[i];if(r){var n=r.texture;if(!n.NPOT&&n.useMipmap&&n.minFilter===qe.LINEAR_MIPMAP_LINEAR){var a=n.textureType==="textureCube"?se.TEXTURE_CUBE_MAP:se.TEXTURE_2D;t.bindTexture(a,n.getWebGLTexture(e)),t.generateMipmap(a),t.bindTexture(a,null)}}}},checkStatus:function(e){return e.checkFramebufferStatus(Fd)},_getFrameBufferGL:function(e){var t=this._cache;return t.use(e.__uid__),t.miss(k0)&&t.put(k0,e.gl.createFramebuffer()),t.get(k0)},attach:function(e,t,i){if(!e.width)throw new Error("The texture attached to color buffer is not a valid.");t=t||Lk,i=i||se.TEXTURE_2D;var r=this._boundRenderer,n=r&&r.gl,a;if(n){var o=this._cache;o.use(r.__uid__),a=o.get("attached_textures")}var s=this._textures[t];if(!(s&&s.target===i&&s.texture===e&&a&&a[t]!=null)){var l=!0;r&&(l=this._doAttach(r,e,t,i),this.viewport||r.setViewport(0,0,e.width,e.height,1)),l&&(this._textures[t]=this._textures[t]||{},this._textures[t].texture=e,this._textures[t].target=i)}},_doAttach:function(e,t,i,r){var n=e.gl,a=t.getWebGLTexture(e),o=this._cache.get("attached_textures");if(o&&o[i]){var s=o[i];if(s.texture===t&&s.target===r)return}i=+i;var l=!0;if(i===of||i===se.DEPTH_STENCIL_ATTACHMENT){var c=e.getGLExtension("WEBGL_depth_texture");if(c||(console.error("Depth texture is not supported by the browser"),l=!1),t.format!==se.DEPTH_COMPONENT&&t.format!==se.DEPTH_STENCIL&&(console.error("The texture attached to depth buffer is not a valid."),l=!1),l){var d=this._cache.get(pl);d&&(n.framebufferRenderbuffer(Fd,of,af,null),n.deleteRenderbuffer(d),this._cache.put(pl,!1)),this._cache.put(k1,!1),this._cache.put(N1,!0)}}return n.framebufferTexture2D(Fd,i,r,a,0),o||(o={},this._cache.put("attached_textures",o)),o[i]=o[i]||{},o[i].texture=t,o[i].target=r,l},_doDetach:function(e,t,i){e.framebufferTexture2D(Fd,t,i,null,0);var r=this._cache.get("attached_textures");r&&r[t]&&(r[t]=null),(t===of||t===se.DEPTH_STENCIL_ATTACHMENT)&&this._cache.put(N1,!1)},detach:function(e,t){if(this._textures[e]=null,this._boundRenderer){var i=this._cache;i.use(this._boundRenderer.__uid__),this._doDetach(this._boundRenderer.gl,e,t)}},dispose:function(e){var t=e.gl,i=this._cache;i.use(e.__uid__);var r=i.get(pl);r&&t.deleteRenderbuffer(r);var n=i.get(k0);n&&t.deleteFramebuffer(n),i.deleteContext(e.__uid__),this._textures={}}});sf.DEPTH_ATTACHMENT=of;sf.COLOR_ATTACHMENT0=Lk;sf.STENCIL_ATTACHMENT=se.STENCIL_ATTACHMENT;sf.DEPTH_STENCIL_ATTACHMENT=se.DEPTH_STENCIL_ATTACHMENT;var ki=sf;var LH=["px","nx","py","ny","pz","nz"],BH=Ui.extend(function(){var e={position:new Se,far:1e3,near:.1,texture:null,shadowMapPass:null},t=e._cameras={px:new Cr({fov:90}),nx:new Cr({fov:90}),py:new Cr({fov:90}),ny:new Cr({fov:90}),pz:new Cr({fov:90}),nz:new Cr({fov:90})};return t.px.lookAt(Se.POSITIVE_X,Se.NEGATIVE_Y),t.nx.lookAt(Se.NEGATIVE_X,Se.NEGATIVE_Y),t.py.lookAt(Se.POSITIVE_Y,Se.POSITIVE_Z),t.ny.lookAt(Se.NEGATIVE_Y,Se.NEGATIVE_Z),t.pz.lookAt(Se.POSITIVE_Z,Se.NEGATIVE_Y),t.nz.lookAt(Se.NEGATIVE_Z,Se.NEGATIVE_Y),e._frameBuffer=new ki,e},{getCamera:function(e){return this._cameras[e]},render:function(e,t,i){var r=e.gl;i||t.update();for(var n=this.texture.width,a=2*Math.atan(n/(n-.5))/Math.PI*180,o=0;o<6;o++){var s=LH[o],l=this._cameras[s];if(Se.copy(l.position,this.position),l.far=this.far,l.near=this.near,l.fov=a,this.shadowMapPass){l.update();var c=t.getBoundingBox();c.applyTransform(l.viewMatrix),t.viewBoundingBoxLastFrame.copy(c),this.shadowMapPass.render(e,t,l,!0)}this._frameBuffer.attach(this.texture,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+o),this._frameBuffer.bind(e),e.render(t,l,!0),this._frameBuffer.unbind(e)}},dispose:function(e){this._frameBuffer.dispose(e)}}),Dh=BH;var VH=Lt.extend({dynamic:!1,widthSegments:1,heightSegments:1},function(){this.build()},{build:function(){for(var e=this.heightSegments,t=this.widthSegments,i=this.attributes,r=[],n=[],a=[],o=[],s=0;s<=e;s++)for(var l=s/e,c=0;c<=t;c++){var d=c/t;if(r.push([2*d-1,2*l-1,0]),n&&n.push([d,l]),a&&a.push([0,0,1]),c<t&&s<e){var u=c+s*(t+1);o.push([u,u+1,u+t+1]),o.push([u+t+1,u+1,u+t+2])}}i.position.fromArray(r),i.texcoord0.fromArray(n),i.normal.fromArray(a),this.initIndicesFromArray(o),this.boundingBox=new wr,this.boundingBox.min.set(-1,-1,0),this.boundingBox.max.set(1,1,0)}}),pc=VH;var Er=new Ye,zH=Lt.extend({dynamic:!1,widthSegments:1,heightSegments:1,depthSegments:1,inside:!1},function(){this.build()},{build:function(){var e={px:Mh("px",this.depthSegments,this.heightSegments),nx:Mh("nx",this.depthSegments,this.heightSegments),py:Mh("py",this.widthSegments,this.depthSegments),ny:Mh("ny",this.widthSegments,this.depthSegments),pz:Mh("pz",this.widthSegments,this.heightSegments),nz:Mh("nz",this.widthSegments,this.heightSegments)},t=["position","texcoord0","normal"],i=0,r=0;for(var n in e)i+=e[n].vertexCount,r+=e[n].indices.length;for(var a=0;a<t.length;a++)this.attributes[t[a]].init(i);this.indices=new Ai.Uint16Array(r);var o=0,s=0;for(var n in e){for(var l=e[n],a=0;a<t.length;a++)for(var c=t[a],d=l.attributes[c].value,u=l.attributes[c].size,h=c==="normal",m=0;m<d.length;m++){var f=d[m];this.inside&&h&&(f=-f),this.attributes[c].value[m+u*s]=f}for(var p=l.indices.length,m=0;m<l.indices.length;m++)this.indices[m+o]=s+l.indices[this.inside?p-m-1:m];o+=l.indices.length,s+=l.vertexCount}this.boundingBox=new wr,this.boundingBox.max.set(1,1,1),this.boundingBox.min.set(-1,-1,-1)}});function Mh(e,t,i){Er.identity();var r=new pc({widthSegments:t,heightSegments:i});switch(e){case"px":Ye.translate(Er,Er,Se.POSITIVE_X),Ye.rotateY(Er,Er,Math.PI/2);break;case"nx":Ye.translate(Er,Er,Se.NEGATIVE_X),Ye.rotateY(Er,Er,-Math.PI/2);break;case"py":Ye.translate(Er,Er,Se.POSITIVE_Y),Ye.rotateX(Er,Er,-Math.PI/2);break;case"ny":Ye.translate(Er,Er,Se.NEGATIVE_Y),Ye.rotateX(Er,Er,Math.PI/2);break;case"pz":Ye.translate(Er,Er,Se.POSITIVE_Z);break;case"nz":Ye.translate(Er,Er,Se.NEGATIVE_Z),Ye.rotateY(Er,Er,Math.PI);break}return r.applyTransform(Er),r}var N0=zH;var Bk=`@export clay.skybox.vertex
#define SHADER_NAME skybox
uniform mat4 world : WORLD;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
attribute vec3 position : POSITION;
varying vec3 v_WorldPosition;
void main()
{
 v_WorldPosition = (world * vec4(position, 1.0)).xyz;
 gl_Position = worldViewProjection * vec4(position, 1.0);
}
@end
@export clay.skybox.fragment
#define PI 3.1415926
uniform mat4 viewInverse : VIEWINVERSE;
#ifdef EQUIRECTANGULAR
uniform sampler2D environmentMap;
#else
uniform samplerCube environmentMap;
#endif
uniform float lod: 0.0;
varying vec3 v_WorldPosition;
@import clay.util.rgbm
@import clay.util.srgb
@import clay.util.ACES
void main()
{
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(v_WorldPosition - eyePos);
#ifdef EQUIRECTANGULAR
 float phi = acos(V.y);
 float theta = atan(-V.x, V.z) + PI * 0.5;
 vec2 uv = vec2(theta / 2.0 / PI, phi / PI);
 vec4 texel = decodeHDR(texture2D(environmentMap, fract(uv)));
#else
 #if defined(LOD) || defined(SUPPORT_TEXTURE_LOD)
 vec4 texel = decodeHDR(textureCubeLodEXT(environmentMap, V, lod));
 #else
 vec4 texel = decodeHDR(textureCube(environmentMap, V));
 #endif
#endif
#ifdef SRGB_DECODE
 texel = sRGBToLinear(texel);
#endif
#ifdef TONEMAPPING
 texel.rgb = ACESToneMapping(texel.rgb);
#endif
#ifdef SRGB_ENCODE
 texel = linearTosRGB(texel);
#endif
 gl_FragColor = encodeHDR(vec4(texel.rgb, 1.0));
}
@end`;Re.import(Bk);var UH=cs.extend(function(){var e=new Re({vertex:Re.source("clay.skybox.vertex"),fragment:Re.source("clay.skybox.fragment")}),t=new $r({shader:e,depthMask:!1});return{scene:null,geometry:new N0,material:t,environmentMap:null,culling:!1,_dummyCamera:new Cr}},function(){var e=this.scene;e&&this.attachScene(e),this.environmentMap&&this.setEnvironmentMap(this.environmentMap)},{attachScene:function(e){this.scene&&this.detachScene(),e.skybox=this,this.scene=e,e.on("beforerender",this._beforeRenderScene,this)},detachScene:function(){this.scene&&(this.scene.off("beforerender",this._beforeRenderScene),this.scene.skybox=null),this.scene=null},dispose:function(e){this.detachScene(),this.geometry.dispose(e)},setEnvironmentMap:function(e){e.textureType==="texture2D"?(this.material.define("EQUIRECTANGULAR"),e.minFilter=qe.LINEAR):this.material.undefine("EQUIRECTANGULAR"),this.material.set("environmentMap",e)},getEnvironmentMap:function(){return this.material.get("environmentMap")},_beforeRenderScene:function(e,t,i){this.renderSkybox(e,i)},renderSkybox:function(e,t){var i=this._dummyCamera;i.aspect=e.getViewportAspect(),i.fov=t.fov||50,i.updateProjectionMatrix(),Ye.invert(i.invProjectionMatrix,i.projectionMatrix),i.worldTransform.copy(t.worldTransform),i.viewMatrix.copy(t.viewMatrix),this.position.copy(t.getWorldPosition()),this.update(),e.gl.disable(e.gl.BLEND),this.material.get("lod")>0?this.material.define("fragment","LOD"):this.material.undefine("fragment","LOD"),e.renderPass([this],i)}}),fc=UH;var P0=fc;var HH=542327876;var GH=131072;var jH=512;var WH=4;function P1(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var qH=31,$H=P1("DXT1"),XH=P1("DXT3"),YH=P1("DXT5"),ZH=0,KH=1,QH=2,JH=3,e7=4,t7=7,i7=20,r7=21;var n7=28;var a7={parse:function(e,t){var i=new Int32Array(e,0,qH);if(i[ZH]!==HH||!i(i7)&WH)return null;var r=i(r7),n=i[e7],a=i[JH],o=i[n7]&jH,s=i[QH]&GH,l,c;switch(r){case $H:l=8,c=qe.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case XH:l=16,c=qe.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case YH:l=16,c=qe.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return null}var d=i[KH]+4,u=o?6:1,h=1;s&&(h=Math.max(1,i[t7]));for(var m=[],f=0;f<u;f++){var p=n,g=a;m[f]=new ct({width:p,height:g,format:c});for(var v=[],b=0;b<h;b++){var _=Math.max(4,p)/4*Math.max(4,g)/4*l,x=new Uint8Array(e,d,_);d+=_,p*=.5,g*=.5,v[b]=x}m[f].pixels=v[0],s&&(m[f].mipmaps=v)}if(t)t.width=m[0].width,t.height=m[0].height,t.format=m[0].format,t.pixels=m[0].pixels,t.mipmaps=m[0].mipmaps;else return m[0]}},Vk=a7;var R0=String.fromCharCode,o7=8,s7=32767;function l7(e,t,i,r){if(e[3]>0){var n=Math.pow(2,e[3]-128-8+r);t[i+0]=e[0]*n,t[i+1]=e[1]*n,t[i+2]=e[2]*n}else t[i+0]=0,t[i+1]=0,t[i+2]=0;return t[i+3]=1,t}function c7(e,t,i){for(var r="",n=t;n<i;n++)r+=R0(e[n]);return r}function d7(e,t){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]}function zk(e,t,i,r){for(var n=0,a=0,o=r;o>0;)if(e[a][0]=t[i++],e[a][1]=t[i++],e[a][2]=t[i++],e[a][3]=t[i++],e[a][0]===1&&e[a][1]===1&&e[a][2]===1){for(var s=e[a][3]<<n>>>0;s>0;s--)d7(e[a-1],e[a]),a++,o--;n+=8}else a++,o--,n=0;return i}function u7(e,t,i,r){if(r<o7|r>s7)return zk(e,t,i,r);var n=t[i++];if(n!=2)return zk(e,t,i-1,r);if(e[0][1]=t[i++],e[0][2]=t[i++],n=t[i++],(e[0][2]<<8>>>0|n)>>>0!==r)return null;for(var n=0;n<4;n++)for(var a=0;a<r;){var o=t[i++];if(o>128){o=(o&127)>>>0;for(var s=t[i++];o--;)e[a++][n]=s}else for(;o--;)e[a++][n]=t[i++]}return i}var h7={parseRGBE:function(e,t,i){i==null&&(i=0);var r=new Uint8Array(e),n=r.length;if(c7(r,0,2)==="#?"){for(var a=2;a<n&&!(R0(r[a])===`
`&&R0(r[a+1])===`
`);a++);if(!(a>=n)){a+=2;for(var o="";a<n;a++){var s=R0(r[a]);if(s===`
`)break;o+=s}var l=o.split(" "),c=parseInt(l[1]),d=parseInt(l[3]);if(!(!d||!c)){for(var u=a+1,h=[],m=0;m<d;m++){h[m]=[];for(var f=0;f<4;f++)h[m][f]=0}for(var p=new Float32Array(d*c*4),g=0,v=0;v<c;v++){var u=u7(h,r,u,d);if(!u)return null;for(var m=0;m<d;m++)l7(h[m],p,g,i),g+=4}return t||(t=new ct),t.width=d,t.height=c,t.pixels=p,t.type=qe.FLOAT,t}}}},parseRGBEFromPNG:function(e){}},Uk=h7;var F0={loadTexture:function(e,t,i,r){var n;if(typeof t=="function"?(i=t,r=i,t={}):t=t||{},typeof e=="string"){if(e.match(/.hdr$/)||t.fileType==="hdr")return n=new ct({width:0,height:0,sRGB:!1}),F0._fetchTexture(e,function(a){Uk.parseRGBE(a,n,t.exposure),n.dirty(),i&&i(n)},r),n;e.match(/.dds$/)||t.fileType==="dds"?(n=new ct({width:0,height:0}),F0._fetchTexture(e,function(a){Vk.parse(a,n),n.dirty(),i&&i(n)},r)):(n=new ct,n.load(e),n.success(i),n.error(r))}else typeof e=="object"&&typeof e.px<"u"&&(n=new ml,n.load(e),n.success(i),n.error(r));return n},loadPanorama:function(e,t,i,r,n,a){var o=this;typeof r=="function"?(n=r,a=n,r={}):r=r||{},F0.loadTexture(t,r,function(s){s.flipY=r.flipY||!1,o.panoramaToCubeMap(e,s,i,r),s.dispose(e),n&&n(i)},a)},panoramaToCubeMap:function(e,t,i,r){var n=new Dh,a=new P0({scene:new to});return a.setEnvironmentMap(t),r=r||{},r.encodeRGBM&&a.material.define("fragment","RGBM_ENCODE"),i.sRGB=t.sRGB,n.texture=i,n.render(e,a.scene),n.texture=null,n.dispose(e),i},heightToNormal:function(e,t){var i=document.createElement("canvas"),r=i.width=e.width,n=i.height=e.height,a=i.getContext("2d");a.drawImage(e,0,0,r,n),t=t||!1;for(var o=a.getImageData(0,0,r,n),s=a.createImageData(r,n),l=0;l<o.data.length;l+=4){if(t){var c=o.data[l],d=o.data[l+1],u=o.data[l+2],h=Math.abs(c-d)+Math.abs(d-u);if(h>20)return console.warn("Given image is not a height map"),e}var m,f,p,g;l%(r*4)===0?(m=o.data[l],p=o.data[l+4]):l%(r*4)===(r-1)*4?(m=o.data[l-4],p=o.data[l]):(m=o.data[l-4],p=o.data[l+4]),l<r*4?(f=o.data[l],g=o.data[l+r*4]):l>r*(n-1)*4?(f=o.data[l-r*4],g=o.data[l]):(f=o.data[l-r*4],g=o.data[l+r*4]),s.data[l]=m-p+127,s.data[l+1]=f-g+127,s.data[l+2]=255,s.data[l+3]=255}return a.putImageData(s,0,0),i},isHeightImage:function(e,t,i){if(!e||!e.width||!e.height)return!1;var r=document.createElement("canvas"),n=r.getContext("2d"),a=t||32;i=i||20,r.width=r.height=a,n.drawImage(e,0,0,a,a);for(var o=n.getImageData(0,0,a,a),s=0;s<o.data.length;s+=4){var l=o.data[s],c=o.data[s+1],d=o.data[s+2],u=Math.abs(l-c)+Math.abs(c-d);if(u>i)return!1}return!0},_fetchTexture:function(e,t,i){Ai.request.get({url:e,responseType:"arraybuffer",onload:t,onerror:i})},createChessboard:function(e,t,i,r){e=e||512,t=t||64,i=i||"black",r=r||"white";var n=Math.ceil(e/t),a=document.createElement("canvas");a.width=e,a.height=e;var o=a.getContext("2d");o.fillStyle=r,o.fillRect(0,0,e,e),o.fillStyle=i;for(var s=0;s<n;s++)for(var l=0;l<n;l++){var c=l%2?s%2:s%2-1;c&&o.fillRect(s*t,l*t,t,t)}var d=new ct({image:a,anisotropic:8});return d},createBlank:function(e){var t=document.createElement("canvas");t.width=1,t.height=1;var i=t.getContext("2d");i.fillStyle=e,i.fillRect(0,0,1,1);var r=new ct({image:t});return r}},Ms=F0;var R1=["mousedown","mouseup","mousemove","mouseover","mouseout","click","dblclick","contextmenu"];function F1(e){return"_on"+e}var O1=function(e){var t=this;this._texture=new ct({anisotropic:32,flipY:!1,surface:this,dispose:function(i){t.dispose(),ct.prototype.dispose.call(this,i)}}),R1.forEach(function(i){this[F1(i)]=function(r){r.triangle&&this._meshes.forEach(function(n){this.dispatchEvent(i,n,r.triangle,r.point)},this)}},this),this._meshes=[],e&&this.setECharts(e),this.onupdate=null};O1.prototype={constructor:O1,getTexture:function(){return this._texture},setECharts:function(e){this._chart=e;var t=e.getDom();if(!(t instanceof HTMLCanvasElement))console.error("ECharts must init on canvas if it is used as texture."),t=document.createElement("canvas");else{var i=this,r=e.getZr(),n=r.__oldRefreshImmediately||r.refreshImmediately;r.refreshImmediately=function(){n.call(this),i._texture.dirty(),i.onupdate&&i.onupdate()},r.__oldRefreshImmediately=n}this._texture.image=t,this._texture.dirty(),this.onupdate&&this.onupdate()},dispatchEvent:function(){var e=new Se,t=new Se,i=new Se,r=new rn,n=new rn,a=new rn,o=new rn,s=new Se;return function(l,c,d,u){var h=c.geometry,m=h.attributes.position,f=h.attributes.texcoord0,p=Se.dot,g=Se.cross;m.get(d[0],e.array),m.get(d[1],t.array),m.get(d[2],i.array),f.get(d[0],r.array),f.get(d[1],n.array),f.get(d[2],a.array),g(s,t,i);var v=p(e,s),b=p(u,s)/v;g(s,i,e);var _=p(u,s)/v;g(s,e,t);var x=p(u,s)/v;rn.scale(o,r,b),rn.scaleAndAdd(o,o,n,_),rn.scaleAndAdd(o,o,a,x);var w=o.x*this._chart.getWidth(),y=o.y*this._chart.getHeight();this._chart.getZr().handler.dispatch(l,{zrX:w,zrY:y})}}(),attachToMesh:function(e){this._meshes.indexOf(e)>=0||(R1.forEach(function(t){e.on(t,this[F1(t)],this)},this),this._meshes.push(e))},detachFromMesh:function(e){var t=this._meshes.indexOf(e);t>=0&&this._meshes.splice(t,1),R1.forEach(function(i){e.off(i,this[F1(i)])},this)},dispose:function(){this._meshes.forEach(function(e){this.detachFromMesh(e)},this)}};var Hk=O1;var m7=hl.extend({left:-1,right:1,near:-1,far:1,top:1,bottom:-1},{updateProjectionMatrix:function(){this.projectionMatrix.ortho(this.left,this.right,this.bottom,this.top,this.near,this.far)},decomposeProjectionMatrix:function(){var e=this.projectionMatrix.array;this.left=(-1-e[12])/e[0],this.right=(1-e[12])/e[0],this.top=(1-e[13])/e[5],this.bottom=(-1-e[13])/e[5],this.near=-(-1-e[14])/e[10],this.far=-(1-e[14])/e[10]},clone:function(){var e=hl.prototype.clone.call(this);return e.left=this.left,e.right=this.right,e.near=this.near,e.far=this.far,e.top=this.top,e.bottom=this.bottom,e}}),us=m7;var Gk=`
@export clay.compositor.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;
varying vec2 v_Texcoord;
void main()
{
 v_Texcoord = texcoord;
 gl_Position = worldViewProjection * vec4(position, 1.0);
}
@end`;Re.import(Gk);var p7=new pc,jk=new cs({geometry:p7,frustumCulling:!1}),f7=new us,g7=Ui.extend(function(){return{fragment:"",outputs:null,material:null,blendWithPrevious:!1,clearColor:!1,clearDepth:!0}},function(){var e=new Re(Re.source("clay.compositor.vertex"),this.fragment),t=new $r({shader:e});t.enableTexturesAll(),this.material=t},{setUniform:function(e,t){this.material.setUniform(e,t)},getUniform:function(e){var t=this.material.uniforms[e];if(t)return t.value},attachOutput:function(e,t){this.outputs||(this.outputs={}),t=t||se.COLOR_ATTACHMENT0,this.outputs[t]=e},detachOutput:function(e){for(var t in this.outputs)this.outputs[t]===e&&(this.outputs[t]=null)},bind:function(e,t){if(this.outputs)for(var i in this.outputs){var r=this.outputs[i];r&&t.attach(r,i)}t&&t.bind(e)},unbind:function(e,t){t.unbind(e)},render:function(e,t){var i=e.gl;if(t){this.bind(e,t);var r=e.getGLExtension("EXT_draw_buffers");if(r&&this.outputs){var n=[];for(var a in this.outputs)a=+a,a>=i.COLOR_ATTACHMENT0&&a<=i.COLOR_ATTACHMENT0+8&&n.push(a);r.drawBuffersEXT(n)}}this.trigger("beforerender",this,e);var o=this.clearDepth?i.DEPTH_BUFFER_BIT:0;if(i.depthMask(!0),this.clearColor){o=o|i.COLOR_BUFFER_BIT,i.colorMask(!0,!0,!0,!0);var s=this.clearColor;Array.isArray(s)&&i.clearColor(s[0],s[1],s[2],s[3])}i.clear(o),this.blendWithPrevious?(i.enable(i.BLEND),this.material.transparent=!0):(i.disable(i.BLEND),this.material.transparent=!1),this.renderQuad(e),this.trigger("afterrender",this,e),t&&this.unbind(e,t)},renderQuad:function(e){jk.material=this.material,e.renderPass([jk],f7)},dispose:function(e){}}),Oi=g7;var Wk=`#define SAMPLE_NUMBER 1024
#define PI 3.14159265358979
uniform sampler2D normalDistribution;
uniform vec2 viewportSize : [512, 256];
const vec3 N = vec3(0.0, 0.0, 1.0);
const float fSampleNumber = float(SAMPLE_NUMBER);
vec3 importanceSampleNormal(float i, float roughness, vec3 N) {
 vec3 H = texture2D(normalDistribution, vec2(roughness, i)).rgb;
 vec3 upVector = abs(N.y) > 0.999 ? vec3(1.0, 0.0, 0.0) : vec3(0.0, 1.0, 0.0);
 vec3 tangentX = normalize(cross(N, upVector));
 vec3 tangentZ = cross(N, tangentX);
 return normalize(tangentX * H.x + N * H.y + tangentZ * H.z);
}
float G_Smith(float roughness, float NoV, float NoL) {
 float k = roughness * roughness / 2.0;
 float G1V = NoV / (NoV * (1.0 - k) + k);
 float G1L = NoL / (NoL * (1.0 - k) + k);
 return G1L * G1V;
}
void main() {
 vec2 uv = gl_FragCoord.xy / viewportSize;
 float NoV = uv.x;
 float roughness = uv.y;
 vec3 V;
 V.x = sqrt(1.0 - NoV * NoV);
 V.y = 0.0;
 V.z = NoV;
 float A = 0.0;
 float B = 0.0;
 for (int i = 0; i < SAMPLE_NUMBER; i++) {
 vec3 H = importanceSampleNormal(float(i) / fSampleNumber, roughness, N);
 vec3 L = reflect(-V, H);
 float NoL = clamp(L.z, 0.0, 1.0);
 float NoH = clamp(H.z, 0.0, 1.0);
 float VoH = clamp(dot(V, H), 0.0, 1.0);
 if (NoL > 0.0) {
 float G = G_Smith(roughness, NoV, NoL);
 float G_Vis = G * VoH / (NoH * NoV);
 float Fc = pow(1.0 - VoH, 5.0);
 A += (1.0 - Fc) * G_Vis;
 B += Fc * G_Vis;
 }
 }
 gl_FragColor = vec4(vec2(A, B) / fSampleNumber, 0.0, 1.0);
}
`;var qk=`#define SHADER_NAME prefilter
#define SAMPLE_NUMBER 1024
#define PI 3.14159265358979
uniform mat4 viewInverse : VIEWINVERSE;
uniform samplerCube environmentMap;
uniform sampler2D normalDistribution;
uniform float roughness : 0.5;
varying vec2 v_Texcoord;
varying vec3 v_WorldPosition;
@import clay.util.rgbm
vec3 importanceSampleNormal(float i, float roughness, vec3 N) {
 vec3 H = texture2D(normalDistribution, vec2(roughness, i)).rgb;
 vec3 upVector = abs(N.y) > 0.999 ? vec3(1.0, 0.0, 0.0) : vec3(0.0, 1.0, 0.0);
 vec3 tangentX = normalize(cross(N, upVector));
 vec3 tangentZ = cross(N, tangentX);
 return normalize(tangentX * H.x + N * H.y + tangentZ * H.z);
}
void main() {
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(v_WorldPosition - eyePos);
 vec3 N = V;
 vec3 prefilteredColor = vec3(0.0);
 float totalWeight = 0.0;
 float fMaxSampleNumber = float(SAMPLE_NUMBER);
 for (int i = 0; i < SAMPLE_NUMBER; i++) {
 vec3 H = importanceSampleNormal(float(i) / fMaxSampleNumber, roughness, N);
 vec3 L = reflect(-V, H);
 float NoL = clamp(dot(N, L), 0.0, 1.0);
 if (NoL > 0.0) {
 prefilteredColor += decodeHDR(textureCube(environmentMap, L)).rgb * NoL;
 totalWeight += NoL;
 }
 }
 gl_FragColor = encodeHDR(vec4(prefilteredColor / totalWeight, 1.0));
}
`;var Od={},L1=["px","nx","py","ny","pz","nz"];Od.prefilterEnvironmentMap=function(e,t,i,r,n){(!n||!r)&&(r=Od.generateNormalDistribution(),n=Od.integrateBRDF(e,r)),i=i||{};var a=i.width||64,o=i.height||64,s=i.type||t.type,l=new ml({width:a,height:o,type:s,flipY:!1,mipmaps:[]});l.isPowerOfTwo()||console.warn("Width and height must be power of two to enable mipmap.");var c=Math.min(a,o),d=Math.log(c)/Math.log(2)+1,u=new $r({shader:new Re({vertex:Re.source("clay.skybox.vertex"),fragment:qk})});u.set("normalDistribution",r),i.encodeRGBM&&u.define("fragment","RGBM_ENCODE"),i.decodeRGBM&&u.define("fragment","RGBM_DECODE");var h=new to,m;if(t.textureType==="texture2D"){var f=new ml({width:a,height:o,type:s===qe.FLOAT?qe.HALF_FLOAT:s});Ms.panoramaToCubeMap(e,t,f,{encodeRGBM:i.decodeRGBM}),t=f}m=new fc({scene:h,material:u}),m.material.set("environmentMap",t);var p=new Dh({texture:l});i.encodeRGBM&&(s=l.type=qe.UNSIGNED_BYTE);for(var g=new ct({width:a,height:o,type:s}),v=new ki({depthBuffer:!1}),b=Ai[s===qe.UNSIGNED_BYTE?"Uint8Array":"Float32Array"],_=0;_<d;_++){l.mipmaps[_]={pixels:{}},m.material.set("roughness",_/(d-1));for(var x=g.width,w=2*Math.atan(x/(x-.5))/Math.PI*180,y=0;y<L1.length;y++){var M=new b(g.width*g.height*4);v.attach(g),v.bind(e);var T=p.getCamera(L1[y]);T.fov=w,e.render(h,T),e.gl.readPixels(0,0,g.width,g.height,qe.RGBA,s,M),v.unbind(e),l.mipmaps[_].pixels[L1[y]]=M}g.width/=2,g.height/=2,g.dirty()}return v.dispose(e),g.dispose(e),m.dispose(e),r.dispose(e),{environmentMap:l,brdfLookup:n,normalDistribution:r,maxMipmapLevel:d}};Od.integrateBRDF=function(e,t){t=t||Od.generateNormalDistribution();var i=new ki({depthBuffer:!1}),r=new Oi({fragment:Wk}),n=new ct({width:512,height:256,type:qe.HALF_FLOAT,wrapS:qe.CLAMP_TO_EDGE,wrapT:qe.CLAMP_TO_EDGE,minFilter:qe.NEAREST,magFilter:qe.NEAREST,useMipmap:!1});return r.setUniform("normalDistribution",t),r.setUniform("viewportSize",[512,256]),r.attachOutput(n),r.render(e,i),i.dispose(e),n};Od.generateNormalDistribution=function(i,r){for(var i=i||256,r=r||1024,n=new ct({width:i,height:r,type:qe.FLOAT,minFilter:qe.NEAREST,magFilter:qe.NEAREST,wrapS:qe.CLAMP_TO_EDGE,wrapT:qe.CLAMP_TO_EDGE,useMipmap:!1}),a=new Float32Array(r*i*4),o=[],s=0;s<i;s++){for(var l=s/i,c=l*l,d=0;d<r;d++){var u=(d<<16|d>>>16)>>>0;u=((u&1431655765)<<1|(u&2863311530)>>>1)>>>0,u=((u&858993459)<<2|(u&3435973836)>>>2)>>>0,u=((u&252645135)<<4|(u&4042322160)>>>4)>>>0,u=(((u&16711935)<<8|(u&4278255360)>>>8)>>>0)/4294967296;var h=Math.sqrt((1-u)/(1+(c*c-1)*u));o[d]=h}for(var d=0;d<r;d++){var m=(d*i+s)*4,h=o[d],f=Math.sqrt(1-h*h),p=d/r,g=2*Math.PI*p;a[m]=f*Math.cos(g),a[m+1]=h,a[m+2]=f*Math.sin(g),a[m+3]=1}}return n.pixels=a,n};var Ih=Od;var v7=un.extend({cubemap:null,castShadow:!1,_normalDistribution:null,_brdfLookup:null},{type:"AMBIENT_CUBEMAP_LIGHT",prefilter:function(e,t){if(!e.getGLExtension("EXT_shader_texture_lod")){console.warn("Device not support textureCubeLodEXT");return}this._brdfLookup||(this._normalDistribution=Ih.generateNormalDistribution(),this._brdfLookup=Ih.integrateBRDF(e,this._normalDistribution));var i=this.cubemap;if(!i.__prefiltered){var r=Ih.prefilterEnvironmentMap(e,i,{encodeRGBM:!0,width:t,height:t},this._normalDistribution,this._brdfLookup);this.cubemap=r.environmentMap,this.cubemap.__prefiltered=!0,i.dispose(e)}},getBRDFLookup:function(){return this._brdfLookup},uniformTemplates:{ambientCubemapLightColor:{type:"3f",value:function(e){var t=e.color,i=e.intensity;return[t[0]*i,t[1]*i,t[2]*i]}},ambientCubemapLightCubemap:{type:"t",value:function(e){return e.cubemap}},ambientCubemapLightBRDFLookup:{type:"t",value:function(e){return e._brdfLookup}}}}),$k=v7;var _7=un.extend({castShadow:!1,coefficients:[]},function(){this._coefficientsTmpArr=new Ai.Float32Array(9*3)},{type:"AMBIENT_SH_LIGHT",uniformTemplates:{ambientSHLightColor:{type:"3f",value:function(e){var t=e.color,i=e.intensity;return[t[0]*i,t[1]*i,t[2]*i]}},ambientSHLightCoefficients:{type:"3f",value:function(e){for(var t=e._coefficientsTmpArr,i=0;i<e.coefficients.length;i++)t[i]=e.coefficients[i];return t}}}}),Xk=_7;var Yk={},Ld=["px","nx","py","ny","pz","nz"];function b7(e,t){var i=e[0],r=e[1],n=e[2];return t===0?1:t===1?i:t===2?r:t===3?n:t===4?i*n:t===5?r*n:t===6?i*r:t===7?3*n*n-1:i*i-r*r}var x7={px:[2,1,0,-1,-1,1],nx:[2,1,0,1,-1,-1],py:[0,2,1,1,-1,-1],ny:[0,2,1,1,1,1],pz:[0,1,2,-1,-1,-1],nz:[0,1,2,1,-1,1]};function y7(e,t,i,r){for(var n=new Ai.Float32Array(27),a=Y.create(),o=Y.create(),s=Y.create(),l=0;l<9;l++){for(var c=Y.create(),d=0;d<Ld.length;d++){for(var u=t[Ld[d]],h=Y.create(),m=0,f=0,p=x7[Ld[d]],g=0;g<r;g++)for(var v=0;v<i;v++){a[0]=v/(i-1)*2-1,a[1]=g/(r-1)*2-1,a[2]=-1,Y.normalize(a,a),s[0]=a[p[0]]*p[3],s[1]=a[p[1]]*p[4],s[2]=a[p[2]]*p[5],o[0]=u[f++]/255,o[1]=u[f++]/255,o[2]=u[f++]/255;var b=u[f++]/255*8.12;o[0]*=b,o[1]*=b,o[2]*=b,Y.scaleAndAdd(h,h,o,b7(s,l)*-a[2]),m+=-a[2]}Y.scaleAndAdd(c,c,h,1/m)}n[l*3]=c[0]/6,n[l*3+1]=c[1]/6,n[l*3+2]=c[2]/6}return n}Yk.projectEnvironmentMap=function(e,t,i){i=i||{},i.lod=i.lod||0;var r,n=new to,a=64;t.textureType==="texture2D"?r=new P0({scene:n,environmentMap:t}):(a=t.image&&t.image.px?t.image.px.width:t.width,r=new fc({scene:n,environmentMap:t}));var o=Math.ceil(a/Math.pow(2,i.lod)),s=Math.ceil(a/Math.pow(2,i.lod)),l=new ct({width:o,height:s}),c=new ki;r.material.define("fragment","RGBM_ENCODE"),i.decodeRGBM&&r.material.define("fragment","RGBM_DECODE"),r.material.set("lod",i.lod);for(var d=new Dh({texture:l}),u={},h=0;h<Ld.length;h++){u[Ld[h]]=new Uint8Array(o*s*4);var m=d.getCamera(Ld[h]);m.fov=90,c.attach(l),c.bind(e),e.render(n,m),e.gl.readPixels(0,0,o,s,qe.RGBA,qe.UNSIGNED_BYTE,u[Ld[h]]),c.unbind(e)}return r.dispose(e),c.dispose(e),l.dispose(e),y7(e,u,o,s)};var Zk=Yk;var w7={firstNotNull:function(){for(var e=0,t=arguments.length;e<t;e++)if(arguments[e]!=null)return arguments[e]},queryDataIndex:function(e,t){if(t.dataIndexInside!=null)return t.dataIndexInside;if(t.dataIndex!=null)return Ee.isArray(t.dataIndex)?Ee.map(t.dataIndex,function(i){return e.indexOfRawIndex(i)}):e.indexOfRawIndex(t.dataIndex);if(t.name!=null)return Ee.isArray(t.name)?Ee.map(t.name,function(i){return e.indexOfName(i)}):e.indexOfName(t.name)}},ht=w7;var C7=Lt.extend({dynamic:!1,widthSegments:40,heightSegments:20,phiStart:0,phiLength:Math.PI*2,thetaStart:0,thetaLength:Math.PI,radius:1},function(){this.build()},{build:function(){var e=this.heightSegments,t=this.widthSegments,i=this.attributes.position,r=this.attributes.texcoord0,n=this.attributes.normal,a=(t+1)*(e+1);i.init(a),r.init(a),n.init(a);var o=a>65535?Uint32Array:Uint16Array,s=this.indices=new o(t*e*6),l,c,d,u,h,m,f,_=this.radius,p=this.phiStart,g=this.phiLength,v=this.thetaStart,b=this.thetaLength,_=this.radius,x=[],w=[],y=0,M=1/_;for(f=0;f<=e;f++)for(m=0;m<=t;m++)u=m/t,h=f/e,l=-_*Math.cos(p+u*g)*Math.sin(v+h*b),c=_*Math.cos(v+h*b),d=_*Math.sin(p+u*g)*Math.sin(v+h*b),x[0]=l,x[1]=c,x[2]=d,w[0]=u,w[1]=h,i.set(y,x),r.set(y,w),x[0]*=M,x[1]*=M,x[2]*=M,n.set(y,x),y++;var T,C,N,D,k=t+1,U=0;for(f=0;f<e;f++)for(m=0;m<t;m++)C=f*k+m,T=f*k+m+1,D=(f+1)*k+m+1,N=(f+1)*k+m,s[U++]=T,s[U++]=C,s[U++]=D,s[U++]=C,s[U++]=N,s[U++]=D;this.boundingBox=new wr,this.boundingBox.max.set(_,_,_),this.boundingBox.min.set(-_,-_,-_)}}),Kk=C7;var E7=un.extend({castShadow:!1},{type:"AMBIENT_LIGHT",uniformTemplates:{ambientLightColor:{type:"3f",value:function(e){var t=e.color,i=e.intensity;return[t[0]*i,t[1]*i,t[2]*i]}}}}),Qk=E7;var S7=un.extend({shadowBias:.001,shadowSlopeScale:2,shadowCascade:1,cascadeSplitLogFactor:.2},{type:"DIRECTIONAL_LIGHT",uniformTemplates:{directionalLightDirection:{type:"3f",value:function(e){return e.__dir=e.__dir||new Se,e.__dir.copy(e.worldTransform.z).normalize().negate().array}},directionalLightColor:{type:"3f",value:function(e){var t=e.color,i=e.intensity;return[t[0]*i,t[1]*i,t[2]*i]}}},clone:function(){var e=un.prototype.clone.call(this);return e.shadowBias=this.shadowBias,e.shadowSlopeScale=this.shadowSlopeScale,e}}),Jk=S7;var A7=un.extend({range:100,castShadow:!1},{type:"POINT_LIGHT",uniformTemplates:{pointLightPosition:{type:"3f",value:function(e){return e.getWorldPosition().array}},pointLightRange:{type:"1f",value:function(e){return e.range}},pointLightColor:{type:"3f",value:function(e){var t=e.color,i=e.intensity;return[t[0]*i,t[1]*i,t[2]*i]}}},clone:function(){var e=un.prototype.clone.call(this);return e.range=this.range,e}}),eN=A7;var T7=un.extend({range:20,umbraAngle:30,penumbraAngle:45,falloffFactor:2,shadowBias:.001,shadowSlopeScale:2},{type:"SPOT_LIGHT",uniformTemplates:{spotLightPosition:{type:"3f",value:function(e){return e.getWorldPosition().array}},spotLightRange:{type:"1f",value:function(e){return e.range}},spotLightUmbraAngleCosine:{type:"1f",value:function(e){return Math.cos(e.umbraAngle*Math.PI/180)}},spotLightPenumbraAngleCosine:{type:"1f",value:function(e){return Math.cos(e.penumbraAngle*Math.PI/180)}},spotLightFalloffFactor:{type:"1f",value:function(e){return e.falloffFactor}},spotLightDirection:{type:"3f",value:function(e){return e.__dir=e.__dir||new Se,e.__dir.copy(e.worldTransform.z).negate().array}},spotLightColor:{type:"3f",value:function(e){var t=e.color,i=e.intensity;return[t[0]*i,t[1]*i,t[2]*i]}}},clone:function(){var e=un.prototype.clone.call(this);return e.range=this.range,e.umbraAngle=this.umbraAngle,e.penumbraAngle=this.penumbraAngle,e.falloffFactor=this.falloffFactor,e.shadowBias=this.shadowBias,e.shadowSlopeScale=this.shadowSlopeScale,e}}),tN=T7;var mi=function(e,t,i,r){e=e||0,t=t||0,i=i||0,r=r||0,this.array=We.fromValues(e,t,i,r),this._dirty=!0};mi.prototype={constructor:mi,add:function(e){return We.add(this.array,this.array,e.array),this._dirty=!0,this},set:function(e,t,i,r){return this.array[0]=e,this.array[1]=t,this.array[2]=i,this.array[3]=r,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this.array[3]=e[3],this._dirty=!0,this},clone:function(){return new mi(this.x,this.y,this.z,this.w)},copy:function(e){return We.copy(this.array,e.array),this._dirty=!0,this},dist:function(e){return We.dist(this.array,e.array)},distance:function(e){return We.distance(this.array,e.array)},div:function(e){return We.div(this.array,this.array,e.array),this._dirty=!0,this},divide:function(e){return We.divide(this.array,this.array,e.array),this._dirty=!0,this},dot:function(e){return We.dot(this.array,e.array)},len:function(){return We.len(this.array)},length:function(){return We.length(this.array)},lerp:function(e,t,i){return We.lerp(this.array,e.array,t.array,i),this._dirty=!0,this},min:function(e){return We.min(this.array,this.array,e.array),this._dirty=!0,this},max:function(e){return We.max(this.array,this.array,e.array),this._dirty=!0,this},mul:function(e){return We.mul(this.array,this.array,e.array),this._dirty=!0,this},multiply:function(e){return We.multiply(this.array,this.array,e.array),this._dirty=!0,this},negate:function(){return We.negate(this.array,this.array),this._dirty=!0,this},normalize:function(){return We.normalize(this.array,this.array),this._dirty=!0,this},random:function(e){return We.random(this.array,e),this._dirty=!0,this},scale:function(e){return We.scale(this.array,this.array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return We.scaleAndAdd(this.array,this.array,e.array,t),this._dirty=!0,this},sqrDist:function(e){return We.sqrDist(this.array,e.array)},squaredDistance:function(e){return We.squaredDistance(this.array,e.array)},sqrLen:function(){return We.sqrLen(this.array)},squaredLength:function(){return We.squaredLength(this.array)},sub:function(e){return We.sub(this.array,this.array,e.array),this._dirty=!0,this},subtract:function(e){return We.subtract(this.array,this.array,e.array),this._dirty=!0,this},transformMat4:function(e){return We.transformMat4(this.array,this.array,e.array),this._dirty=!0,this},transformQuat:function(e){return We.transformQuat(this.array,this.array,e.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var lf=Object.defineProperty;lf&&(cf=mi.prototype,lf(cf,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),lf(cf,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}),lf(cf,"z",{get:function(){return this.array[2]},set:function(e){this.array[2]=e,this._dirty=!0}}),lf(cf,"w",{get:function(){return this.array[3]},set:function(e){this.array[3]=e,this._dirty=!0}}));var cf;mi.add=function(e,t,i){return We.add(e.array,t.array,i.array),e._dirty=!0,e};mi.set=function(e,t,i,r,n){We.set(e.array,t,i,r,n),e._dirty=!0};mi.copy=function(e,t){return We.copy(e.array,t.array),e._dirty=!0,e};mi.dist=function(e,t){return We.distance(e.array,t.array)};mi.distance=mi.dist;mi.div=function(e,t,i){return We.divide(e.array,t.array,i.array),e._dirty=!0,e};mi.divide=mi.div;mi.dot=function(e,t){return We.dot(e.array,t.array)};mi.len=function(e){return We.length(e.array)};mi.lerp=function(e,t,i,r){return We.lerp(e.array,t.array,i.array,r),e._dirty=!0,e};mi.min=function(e,t,i){return We.min(e.array,t.array,i.array),e._dirty=!0,e};mi.max=function(e,t,i){return We.max(e.array,t.array,i.array),e._dirty=!0,e};mi.mul=function(e,t,i){return We.multiply(e.array,t.array,i.array),e._dirty=!0,e};mi.multiply=mi.mul;mi.negate=function(e,t){return We.negate(e.array,t.array),e._dirty=!0,e};mi.normalize=function(e,t){return We.normalize(e.array,t.array),e._dirty=!0,e};mi.random=function(e,t){return We.random(e.array,t),e._dirty=!0,e};mi.scale=function(e,t,i){return We.scale(e.array,t.array,i),e._dirty=!0,e};mi.scaleAndAdd=function(e,t,i,r){return We.scaleAndAdd(e.array,t.array,i.array,r),e._dirty=!0,e};mi.sqrDist=function(e,t){return We.sqrDist(e.array,t.array)};mi.squaredDistance=mi.sqrDist;mi.sqrLen=function(e){return We.sqrLen(e.array)};mi.squaredLength=mi.sqrLen;mi.sub=function(e,t,i){return We.subtract(e.array,t.array,i.array),e._dirty=!0,e};mi.subtract=mi.sub;mi.transformMat4=function(e,t,i){return We.transformMat4(e.array,t.array,i.array),e._dirty=!0,e};mi.transformQuat=function(e,t,i){return We.transformQuat(e.array,t.array,i.array),e._dirty=!0,e};var iN=mi;var Ln={};Ln.create=function(){var e=new lr(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e};Ln.clone=function(e){var t=new lr(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t};Ln.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e};Ln.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e};Ln.transpose=function(e,t){if(e===t){var i=t[1];e[1]=t[2],e[2]=i}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e};Ln.invert=function(e,t){var i=t[0],r=t[1],n=t[2],a=t[3],o=i*a-n*r;return o?(o=1/o,e[0]=a*o,e[1]=-r*o,e[2]=-n*o,e[3]=i*o,e):null};Ln.adjoint=function(e,t){var i=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=i,e};Ln.determinant=function(e){return e[0]*e[3]-e[2]*e[1]};Ln.multiply=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=t[3],s=i[0],l=i[1],c=i[2],d=i[3];return e[0]=r*s+a*l,e[1]=n*s+o*l,e[2]=r*c+a*d,e[3]=n*c+o*d,e};Ln.mul=Ln.multiply;Ln.rotate=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(i),l=Math.cos(i);return e[0]=r*l+a*s,e[1]=n*l+o*s,e[2]=r*-s+a*l,e[3]=n*-s+o*l,e};Ln.scale=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=t[3],s=i[0],l=i[1];return e[0]=r*s,e[1]=n*s,e[2]=a*l,e[3]=o*l,e};Ln.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))};Ln.LDU=function(e,t,i,r){return e[2]=r[2]/r[0],i[0]=r[0],i[1]=r[1],i[3]=r[3]-e[2]*i[1],[e,t,i]};var br=Ln;var aa=function(){this.array=br.create(),this._dirty=!0};aa.prototype={constructor:aa,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},clone:function(){return new aa().copy(this)},copy:function(e){return br.copy(this.array,e.array),this._dirty=!0,this},adjoint:function(){return br.adjoint(this.array,this.array),this._dirty=!0,this},determinant:function(){return br.determinant(this.array)},identity:function(){return br.identity(this.array),this._dirty=!0,this},invert:function(){return br.invert(this.array,this.array),this._dirty=!0,this},mul:function(e){return br.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return br.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return br.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return br.multiply(this.array,e.array,this.array),this._dirty=!0,this},rotate:function(e){return br.rotate(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return br.scale(this.array,this.array,e.array),this._dirty=!0,this},transpose:function(){return br.transpose(this.array,this.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};aa.adjoint=function(e,t){return br.adjoint(e.array,t.array),e._dirty=!0,e};aa.copy=function(e,t){return br.copy(e.array,t.array),e._dirty=!0,e};aa.determinant=function(e){return br.determinant(e.array)};aa.identity=function(e){return br.identity(e.array),e._dirty=!0,e};aa.invert=function(e,t){return br.invert(e.array,t.array),e._dirty=!0,e};aa.mul=function(e,t,i){return br.mul(e.array,t.array,i.array),e._dirty=!0,e};aa.multiply=aa.mul;aa.rotate=function(e,t,i){return br.rotate(e.array,t.array,i),e._dirty=!0,e};aa.scale=function(e,t,i){return br.scale(e.array,t.array,i.array),e._dirty=!0,e};aa.transpose=function(e,t){return br.transpose(e.array,t.array),e._dirty=!0,e};var rN=aa;var Aa={};Aa.create=function(){var e=new lr(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e};Aa.clone=function(e){var t=new lr(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t};Aa.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e};Aa.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e};Aa.invert=function(e,t){var i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=i*a-r*n;return l?(l=1/l,e[0]=a*l,e[1]=-r*l,e[2]=-n*l,e[3]=i*l,e[4]=(n*s-a*o)*l,e[5]=(r*o-i*s)*l,e):null};Aa.determinant=function(e){return e[0]*e[3]-e[1]*e[2]};Aa.multiply=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=i[0],d=i[1],u=i[2],h=i[3],m=i[4],f=i[5];return e[0]=r*c+a*d,e[1]=n*c+o*d,e[2]=r*u+a*h,e[3]=n*u+o*h,e[4]=r*m+a*f+s,e[5]=n*m+o*f+l,e};Aa.mul=Aa.multiply;Aa.rotate=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=Math.sin(i),d=Math.cos(i);return e[0]=r*d+a*c,e[1]=n*d+o*c,e[2]=r*-c+a*d,e[3]=n*-c+o*d,e[4]=s,e[5]=l,e};Aa.scale=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=i[0],d=i[1];return e[0]=r*c,e[1]=n*c,e[2]=a*d,e[3]=o*d,e[4]=s,e[5]=l,e};Aa.translate=function(e,t,i){var r=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=i[0],d=i[1];return e[0]=r,e[1]=n,e[2]=a,e[3]=o,e[4]=r*c+a*d+s,e[5]=n*c+o*d+l,e};Aa.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)};var Mr=Aa;var Ta=function(){this.array=Mr.create(),this._dirty=!0};Ta.prototype={constructor:Ta,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},clone:function(){return new Ta().copy(this)},copy:function(e){return Mr.copy(this.array,e.array),this._dirty=!0,this},determinant:function(){return Mr.determinant(this.array)},identity:function(){return Mr.identity(this.array),this._dirty=!0,this},invert:function(){return Mr.invert(this.array,this.array),this._dirty=!0,this},mul:function(e){return Mr.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return Mr.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return Mr.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return Mr.multiply(this.array,e.array,this.array),this._dirty=!0,this},rotate:function(e){return Mr.rotate(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return Mr.scale(this.array,this.array,e.array),this._dirty=!0,this},translate:function(e){return Mr.translate(this.array,this.array,e.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};Ta.copy=function(e,t){return Mr.copy(e.array,t.array),e._dirty=!0,e};Ta.determinant=function(e){return Mr.determinant(e.array)};Ta.identity=function(e){return Mr.identity(e.array),e._dirty=!0,e};Ta.invert=function(e,t){return Mr.invert(e.array,t.array),e._dirty=!0,e};Ta.mul=function(e,t,i){return Mr.mul(e.array,t.array,i.array),e._dirty=!0,e};Ta.multiply=Ta.mul;Ta.rotate=function(e,t,i){return Mr.rotate(e.array,t.array,i),e._dirty=!0,e};Ta.scale=function(e,t,i){return Mr.scale(e.array,t.array,i.array),e._dirty=!0,e};Ta.translate=function(e,t,i){return Mr.translate(e.array,t.array,i.array),e._dirty=!0,e};var nN=Ta;var Zr=function(){this.array=qt.create(),this._dirty=!0};Zr.prototype={constructor:Zr,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},adjoint:function(){return qt.adjoint(this.array,this.array),this._dirty=!0,this},clone:function(){return new Zr().copy(this)},copy:function(e){return qt.copy(this.array,e.array),this._dirty=!0,this},determinant:function(){return qt.determinant(this.array)},fromMat2d:function(e){return qt.fromMat2d(this.array,e.array),this._dirty=!0,this},fromMat4:function(e){return qt.fromMat4(this.array,e.array),this._dirty=!0,this},fromQuat:function(e){return qt.fromQuat(this.array,e.array),this._dirty=!0,this},identity:function(){return qt.identity(this.array),this._dirty=!0,this},invert:function(){return qt.invert(this.array,this.array),this._dirty=!0,this},mul:function(e){return qt.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return qt.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return qt.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return qt.multiply(this.array,e.array,this.array),this._dirty=!0,this},rotate:function(e){return qt.rotate(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return qt.scale(this.array,this.array,e.array),this._dirty=!0,this},translate:function(e){return qt.translate(this.array,this.array,e.array),this._dirty=!0,this},normalFromMat4:function(e){return qt.normalFromMat4(this.array,e.array),this._dirty=!0,this},transpose:function(){return qt.transpose(this.array,this.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};Zr.adjoint=function(e,t){return qt.adjoint(e.array,t.array),e._dirty=!0,e};Zr.copy=function(e,t){return qt.copy(e.array,t.array),e._dirty=!0,e};Zr.determinant=function(e){return qt.determinant(e.array)};Zr.identity=function(e){return qt.identity(e.array),e._dirty=!0,e};Zr.invert=function(e,t){return qt.invert(e.array,t.array),e};Zr.mul=function(e,t,i){return qt.mul(e.array,t.array,i.array),e._dirty=!0,e};Zr.multiply=Zr.mul;Zr.fromMat2d=function(e,t){return qt.fromMat2d(e.array,t.array),e._dirty=!0,e};Zr.fromMat4=function(e,t){return qt.fromMat4(e.array,t.array),e._dirty=!0,e};Zr.fromQuat=function(e,t){return qt.fromQuat(e.array,t.array),e._dirty=!0,e};Zr.normalFromMat4=function(e,t){return qt.normalFromMat4(e.array,t.array),e._dirty=!0,e};Zr.rotate=function(e,t,i){return qt.rotate(e.array,t.array,i),e._dirty=!0,e};Zr.scale=function(e,t,i){return qt.scale(e.array,t.array,i.array),e._dirty=!0,e};Zr.transpose=function(e,t){return qt.transpose(e.array,t.array),e._dirty=!0,e};Zr.translate=function(e,t,i){return qt.translate(e.array,t.array,i.array),e._dirty=!0,e};var aN=Zr;var O0={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return .5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return e===0?0:Math.pow(1024,e-1)},exponentialOut:function(e){return e===1?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var t,i=.1,r=.4;return e===0?0:e===1?1:(!i||i<1?(i=1,t=r/4):t=r*Math.asin(1/i)/(2*Math.PI),-(i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/r)))},elasticOut:function(e){var t,i=.1,r=.4;return e===0?0:e===1?1:(!i||i<1?(i=1,t=r/4):t=r*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/r)+1)},elasticInOut:function(e){var t,i=.1,r=.4;return e===0?0:e===1?1:(!i||i<1?(i=1,t=r/4):t=r*Math.asin(1/i)/(2*Math.PI),(e*=2)<1?-.5*(i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/r)):i*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/r)*.5+1)},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},backInOut:function(e){var t=2.5949095;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)},bounceIn:function(e){return 1-O0.bounceOut(1-e)},bounceOut:function(e){return e<.36363636363636365?7.5625*e*e:e<.7272727272727273?7.5625*(e-=.5454545454545454)*e+.75:e<.9090909090909091?7.5625*(e-=.8181818181818182)*e+.9375:7.5625*(e-=.9545454545454546)*e+.984375},bounceInOut:function(e){return e<.5?O0.bounceIn(e*2)*.5:O0.bounceOut(e*2-1)*.5+.5}},L0=O0;var sN=12,D7="sans-serif",oN=sN+"px "+D7,M7=20,I7=100,k7="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function N7(e){var t={};if(typeof JSON>"u")return t;for(var i=0;i<e.length;i++){var r=String.fromCharCode(i+32),n=(e.charCodeAt(i)-M7)/I7;t[r]=n}return t}var P7=N7(k7),B1={createCanvas:function(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){var e,t;return function(i,r){if(!e){var n=B1.createCanvas();e=n&&n.getContext("2d")}if(e)return t!==r&&(t=e.font=r||oN),e.measureText(i);i=i||"",r=r||oN;var a=/^([0-9]*?)px$/.exec(r),o=+(a&&a[1])||sN,s=0;if(r.indexOf("mono")>=0)s=o*i.length;else for(var l=0;l<i.length;l++){var c=P7[i[l]];s+=c==null?o:c*o}return{width:s}}}(),loadImage:function(e,t,i){var r=new Image;return r.onload=t,r.onerror=i,r.src=e,r}};var j_e=hN(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(e,t){return e["[object "+t+"]"]=!0,e},{}),W_e=hN(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(e,t){return e["[object "+t+"Array]"]=!0,e},{}),R7=Object.prototype.toString,V0=Array.prototype,F7=V0.forEach,q_e=V0.filter,cN=V0.slice,O7=V0.map,lN=function(){}.constructor,B0=lN?lN.prototype:null,L7="__proto__";function dN(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];typeof console<"u"&&console.error.apply(console,e)}function uN(e,t){if(Object.assign)Object.assign(e,t);else for(var i in t)t.hasOwnProperty(i)&&i!==L7&&(e[i]=t[i]);return e}var $_e=B1.createCanvas;function df(e){return!e||typeof e=="string"?!1:typeof e.length=="number"}function B7(e,t,i){if(e&&t)if(e.forEach&&e.forEach===F7)e.forEach(t,i);else if(e.length===+e.length)for(var r=0,n=e.length;r<n;r++)t.call(i,e[r],r,e);else for(var a in e)e.hasOwnProperty(a)&&t.call(i,e[a],a,e)}function z0(e,t,i){if(!e)return[];if(!t)return U7(e);if(e.map&&e.map===O7)return e.map(t,i);for(var r=[],n=0,a=e.length;n<a;n++)r.push(t.call(i,e[n],n,e));return r}function hN(e,t,i,r){if(e&&t){for(var n=0,a=e.length;n<a;n++)i=t.call(r,i,e[n],n,e);return i}}function U0(e){if(!e)return[];if(Object.keys)return Object.keys(e);var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t}function V7(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return function(){return e.apply(t,i.concat(cN.call(arguments)))}}var X_e=B0&&Bd(B0.bind)?B0.call.bind(B0.bind):V7;function z7(e){return Array.isArray?Array.isArray(e):R7.call(e)==="[object Array]"}function Bd(e){return typeof e=="function"}function mN(e){return typeof e=="string"}function H0(e){return typeof e=="number"}function pN(e){return e.colorStops!=null}function fN(e){return e!==e}function U7(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return cN.apply(e,t)}function uf(e){return e==null?null:typeof e.trim=="function"?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var Y_e=function(){function e(t){this.data={};var i=z7(t);this.data={};var r=this;t instanceof e?t.each(n):t&&B7(t,n);function n(a,o){i?r.set(a,o):r.set(o,a)}}return e.prototype.get=function(t){return this.data.hasOwnProperty(t)?this.data[t]:null},e.prototype.set=function(t,i){return this.data[t]=i},e.prototype.each=function(t,i){for(var r in this.data)this.data.hasOwnProperty(r)&&t.call(i,this.data[r],r)},e.prototype.keys=function(){return U0(this.data)},e.prototype.removeKey=function(t){delete this.data[t]},e}();function V1(e,t){for(var i=new e.constructor(e.length+t.length),r=0;r<e.length;r++)i[r]=e[r];for(var n=e.length,r=0;r<t.length;r++)i[r+n]=t[r];return i}function G0(){}var H7=180/Math.PI;function j0(e,t){return e==null&&(e=0),t==null&&(t=0),[e,t]}function z1(e,t,i){var r=t[0],n=t[1];return e[0]=i[0]*r+i[2]*n+i[4],e[1]=i[1]*r+i[3]*n+i[5],e}var W0=Math.pow,X0=Math.sqrt,gN=1e-8;var vN=X0(3),q0=1/3,J_e=j0(),ebe=j0(),tbe=j0();function $0(e){return e>-gN&&e<gN}function _N(e,t,i,r,n){var a=1-n;return a*a*(a*e+3*n*t)+n*n*(n*r+3*a*i)}function bN(e,t,i,r,n,a){var o=r+3*(t-i)-e,s=3*(i-t*2+e),l=3*(t-e),c=e-n,d=s*s-3*o*l,u=s*l-9*o*c,h=l*l-3*s*c,m=0;if($0(d)&&$0(u))if($0(s))a[0]=0;else{var f=-l/s;f>=0&&f<=1&&(a[m++]=f)}else{var p=u*u-4*d*h;if($0(p)){var g=u/d,f=-s/o+g,v=-g/2;f>=0&&f<=1&&(a[m++]=f),v>=0&&v<=1&&(a[m++]=v)}else if(p>0){var b=X0(p),_=d*s+1.5*o*(-u+b),x=d*s+1.5*o*(-u-b);_<0?_=-W0(-_,q0):_=W0(_,q0),x<0?x=-W0(-x,q0):x=W0(x,q0);var f=(-s-(_+x))/(3*o);f>=0&&f<=1&&(a[m++]=f)}else{var w=(2*d*s-3*o*u)/(2*X0(d*d*d)),y=Math.acos(w)/3,M=X0(d),T=Math.cos(y),f=(-s-2*M*T)/(3*o),v=(-s+M*(T+vN*Math.sin(y)))/(3*o),C=(-s+M*(T-vN*Math.sin(y)))/(3*o);f>=0&&f<=1&&(a[m++]=f),v>=0&&v<=1&&(a[m++]=v),C>=0&&C<=1&&(a[m++]=C)}}return m}var j7=/cubic-bezier\(([0-9,\.e ]+)\)/;function Y0(e){var t=e&&j7.exec(e);if(t){var i=t[1].split(","),r=+uf(i[0]),n=+uf(i[1]),a=+uf(i[2]),o=+uf(i[3]);if(isNaN(r+n+a+o))return;var s=[];return function(l){return l<=0?0:l>=1?1:bN(0,r,a,1,l,s)&&_N(0,n,o,1,s[0])}}}var W7=function(){function e(t){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=t.life||1e3,this._delay=t.delay||0,this.loop=t.loop||!1,this.onframe=t.onframe||G0,this.ondestroy=t.ondestroy||G0,this.onrestart=t.onrestart||G0,t.easing&&this.setEasing(t.easing)}return e.prototype.step=function(t,i){if(this._inited||(this._startTime=t+this._delay,this._inited=!0),this._paused){this._pausedTime+=i;return}var r=this._life,n=t-this._startTime-this._pausedTime,a=n/r;a<0&&(a=0),a=Math.min(a,1);var o=this.easingFunc,s=o?o(a):a;if(this.onframe(s),a===1)if(this.loop){var l=n%r;this._startTime=t-l,this._pausedTime=0,this.onrestart()}else return!0;return!1},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1},e.prototype.setEasing=function(t){this.easing=t,this.easingFunc=Bd(t)?t:L0[t]||Y0(t)},e}(),xN=W7;var yN={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function hf(e){return e=Math.round(e),e<0?0:e>255?255:e}function wN(e){return e<0?0:e>1?1:e}function U1(e){var t=e;return t.length&&t.charAt(t.length-1)==="%"?hf(parseFloat(t)/100*255):hf(parseInt(t,10))}function K0(e){var t=e;return t.length&&t.charAt(t.length-1)==="%"?wN(parseFloat(t)/100):wN(parseFloat(t))}function H1(e,t,i){return i<0?i+=1:i>1&&(i-=1),i*6<1?e+(t-e)*i*6:i*2<1?t:i*3<2?e+(t-e)*(2/3-i)*6:e}function Mo(e,t,i,r,n){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e}function G1(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var EN=new M0(20),Z0=null;function kh(e,t){Z0&&G1(Z0,t),Z0=EN.put(e,Z0||t.slice())}function Q0(e,t){if(e){t=t||[];var i=EN.get(e);if(i)return G1(t,i);e=e+"";var r=e.replace(/ /g,"").toLowerCase();if(r in yN)return G1(t,yN[r]),kh(e,t),t;var n=r.length;if(r.charAt(0)==="#"){if(n===4||n===5){var a=parseInt(r.slice(1,4),16);if(!(a>=0&&a<=4095)){Mo(t,0,0,0,1);return}return Mo(t,(a&3840)>>4|(a&3840)>>8,a&240|(a&240)>>4,a&15|(a&15)<<4,n===5?parseInt(r.slice(4),16)/15:1),kh(e,t),t}else if(n===7||n===9){var a=parseInt(r.slice(1,7),16);if(!(a>=0&&a<=16777215)){Mo(t,0,0,0,1);return}return Mo(t,(a&16711680)>>16,(a&65280)>>8,a&255,n===9?parseInt(r.slice(7),16)/255:1),kh(e,t),t}return}var o=r.indexOf("("),s=r.indexOf(")");if(o!==-1&&s+1===n){var l=r.substr(0,o),c=r.substr(o+1,s-(o+1)).split(","),d=1;switch(l){case"rgba":if(c.length!==4)return c.length===3?Mo(t,+c[0],+c[1],+c[2],1):Mo(t,0,0,0,1);d=K0(c.pop());case"rgb":if(c.length!==3){Mo(t,0,0,0,1);return}return Mo(t,U1(c[0]),U1(c[1]),U1(c[2]),d),kh(e,t),t;case"hsla":if(c.length!==4){Mo(t,0,0,0,1);return}return c[3]=K0(c[3]),CN(c,t),kh(e,t),t;case"hsl":if(c.length!==3){Mo(t,0,0,0,1);return}return CN(c,t),kh(e,t),t;default:return}}Mo(t,0,0,0,1)}}function CN(e,t){var i=(parseFloat(e[0])%360+360)%360/360,r=K0(e[1]),n=K0(e[2]),a=n<=.5?n*(r+1):n+r-n*r,o=n*2-a;return t=t||[],Mo(t,hf(H1(o,a,i+1/3)*255),hf(H1(o,a,i)*255),hf(H1(o,a,i-1/3)*255),1),e.length===4&&(t[3]=e[3]),t}var $7=function(){function e(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return e}(),X7=function(){function e(){this.browser=new $7,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<"u"}return e}(),Vd=new X7;typeof wx=="object"&&typeof wx.getSystemInfoSync=="function"?(Vd.wxa=!0,Vd.touchEventsSupported=!0):typeof document>"u"&&typeof self<"u"?Vd.worker=!0:typeof navigator>"u"?(Vd.node=!0,Vd.svgSupported=!0):Y7(navigator.userAgent,Vd);function Y7(e,t){var i=t.browser,r=e.match(/Firefox\/([\d.]+)/),n=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/.+?rv:(([\d.]+))/),a=e.match(/Edge?\/([\d.]+)/),o=/micromessenger/i.test(e);r&&(i.firefox=!0,i.version=r[1]),n&&(i.ie=!0,i.version=n[1]),a&&(i.edge=!0,i.version=a[1],i.newEdge=+a[1].split(".")[0]>18),o&&(i.weChat=!0),t.svgSupported=typeof SVGRect<"u",t.touchEventsSupported="ontouchstart"in window&&!i.ie&&!i.edge,t.pointerEventsSupported="onpointerdown"in window&&(i.edge||i.ie&&+i.version>=11),t.domSupported=typeof document<"u";var s=document.documentElement.style;t.transform3dSupported=(i.ie&&"transition"in s||i.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in s)&&!("OTransition"in s),t.transformSupported=t.transform3dSupported||i.ie&&+i.version>=9}var J0=Vd;function SN(e){return e.type==="linear"}function AN(e){return e.type==="radial"}var gbe=function(){return J0.hasGlobalWindow&&Bd(window.btoa)?function(e){return window.btoa(unescape(e))}:typeof Buffer<"u"?function(e){return Buffer.from(e).toString("base64")}:function(e){return null}}();var q1=Array.prototype.slice;function fl(e,t,i){return(t-e)*i+e}function j1(e,t,i,r){for(var n=t.length,a=0;a<n;a++)e[a]=fl(t[a],i[a],r);return e}function Z7(e,t,i,r){for(var n=t.length,a=n&&t[0].length,o=0;o<n;o++){e[o]||(e[o]=[]);for(var s=0;s<a;s++)e[o][s]=fl(t[o][s],i[o][s],r)}return e}function e_(e,t,i,r){for(var n=t.length,a=0;a<n;a++)e[a]=t[a]+i[a]*r;return e}function TN(e,t,i,r){for(var n=t.length,a=n&&t[0].length,o=0;o<n;o++){e[o]||(e[o]=[]);for(var s=0;s<a;s++)e[o][s]=t[o][s]+i[o][s]*r}return e}function K7(e,t){for(var i=e.length,r=t.length,n=i>r?t:e,a=Math.min(i,r),o=n[a-1]||{color:[0,0,0,0],offset:0},s=a;s<Math.max(i,r);s++)n.push({offset:o.offset,color:o.color.slice()})}function Q7(e,t,i){var r=e,n=t;if(!(!r.push||!n.push)){var a=r.length,o=n.length;if(a!==o){var s=a>o;if(s)r.length=o;else for(var l=a;l<o;l++)r.push(i===1?n[l]:q1.call(n[l]))}for(var c=r[0]&&r[0].length,l=0;l<r.length;l++)if(i===1)isNaN(r[l])&&(r[l]=n[l]);else for(var d=0;d<c;d++)isNaN(r[l][d])&&(r[l][d]=n[l][d])}}function W1(e){if(df(e)){var t=e.length;if(df(e[0])){for(var i=[],r=0;r<t;r++)i.push(q1.call(e[r]));return i}return q1.call(e)}return e}function r_(e){return e[0]=Math.floor(e[0])||0,e[1]=Math.floor(e[1])||0,e[2]=Math.floor(e[2])||0,e[3]=e[3]==null?1:e[3],"rgba("+e.join(",")+")"}function J7(e){return df(e&&e[0])?2:1}var t_=0,n_=1,IN=2,pf=3,$1=4,X1=5,DN=6;function MN(e){return e===$1||e===X1}function i_(e){return e===n_||e===IN}var mf=[0,0,0,0],eG=function(){function e(t){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=t}return e.prototype.isFinished=function(){return this._finished},e.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},e.prototype.needsAnimate=function(){return this.keyframes.length>=1},e.prototype.getAdditiveTrack=function(){return this._additiveTrack},e.prototype.addKeyframe=function(t,i,r){this._needsSort=!0;var n=this.keyframes,a=n.length,o=!1,s=DN,l=i;if(df(i)){var c=J7(i);s=c,(c===1&&!H0(i[0])||c===2&&!H0(i[0][0]))&&(o=!0)}else if(H0(i)&&!fN(i))s=t_;else if(mN(i))if(!isNaN(+i))s=t_;else{var d=Q0(i);d&&(l=d,s=pf)}else if(pN(i)){var u=uN({},l);u.colorStops=z0(i.colorStops,function(m){return{offset:m.offset,color:Q0(m.color)}}),SN(i)?s=$1:AN(i)&&(s=X1),l=u}a===0?this.valType=s:(s!==this.valType||s===DN)&&(o=!0),this.discrete=this.discrete||o;var h={time:t,value:l,rawValue:i,percent:0};return r&&(h.easing=r,h.easingFunc=Bd(r)?r:L0[r]||Y0(r)),n.push(h),h},e.prototype.prepare=function(t,i){var r=this.keyframes;this._needsSort&&r.sort(function(p,g){return p.time-g.time});for(var n=this.valType,a=r.length,o=r[a-1],s=this.discrete,l=i_(n),c=MN(n),d=0;d<a;d++){var u=r[d],h=u.value,m=o.value;u.percent=u.time/t,s||(l&&d!==a-1?Q7(h,m,n):c&&K7(h.colorStops,m.colorStops))}if(!s&&n!==X1&&i&&this.needsAnimate()&&i.needsAnimate()&&n===i.valType&&!i._finished){this._additiveTrack=i;for(var f=r[0].value,d=0;d<a;d++)n===t_?r[d].additiveValue=r[d].value-f:n===pf?r[d].additiveValue=e_([],r[d].value,f,-1):i_(n)&&(r[d].additiveValue=n===n_?e_([],r[d].value,f,-1):TN([],r[d].value,f,-1))}},e.prototype.step=function(t,i){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var r=this._additiveTrack!=null,n=r?"additiveValue":"value",a=this.valType,o=this.keyframes,s=o.length,l=this.propName,c=a===pf,d,u=this._lastFr,h=Math.min,m,f;if(s===1)m=f=o[0];else{if(i<0)d=0;else if(i<this._lastFrP){var p=h(u+1,s-1);for(d=p;d>=0&&!(o[d].percent<=i);d--);d=h(d,s-2)}else{for(d=u;d<s&&!(o[d].percent>i);d++);d=h(d-1,s-2)}f=o[d+1],m=o[d]}if(m&&f){this._lastFr=d,this._lastFrP=i;var g=f.percent-m.percent,v=g===0?1:h((i-m.percent)/g,1);f.easingFunc&&(v=f.easingFunc(v));var b=r?this._additiveValue:c?mf:t[l];if((i_(a)||c)&&!b&&(b=this._additiveValue=[]),this.discrete)t[l]=v<1?m.rawValue:f.rawValue;else if(i_(a))a===n_?j1(b,m[n],f[n],v):Z7(b,m[n],f[n],v);else if(MN(a)){var _=m[n],x=f[n],w=a===$1;t[l]={type:w?"linear":"radial",x:fl(_.x,x.x,v),y:fl(_.y,x.y,v),colorStops:z0(_.colorStops,function(M,T){var C=x.colorStops[T];return{offset:fl(M.offset,C.offset,v),color:r_(j1([],M.color,C.color,v))}}),global:x.global},w?(t[l].x2=fl(_.x2,x.x2,v),t[l].y2=fl(_.y2,x.y2,v)):t[l].r=fl(_.r,x.r,v)}else if(c)j1(b,m[n],f[n],v),r||(t[l]=r_(b));else{var y=fl(m[n],f[n],v);r?this._additiveValue=y:t[l]=y}r&&this._addToTarget(t)}}},e.prototype._addToTarget=function(t){var i=this.valType,r=this.propName,n=this._additiveValue;i===t_?t[r]=t[r]+n:i===pf?(Q0(t[r],mf),e_(mf,mf,n,1),t[r]=r_(mf)):i===n_?e_(t[r],t[r],n,1):i===IN&&TN(t[r],t[r],n,1)},e}(),tG=function(){function e(t,i,r,n){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=t,this._loop=i,i&&n){dN("Can' use additive animation on looped animation.");return}this._additiveAnimators=n,this._allowDiscrete=r}return e.prototype.getMaxTime=function(){return this._maxTime},e.prototype.getDelay=function(){return this._delay},e.prototype.getLoop=function(){return this._loop},e.prototype.getTarget=function(){return this._target},e.prototype.changeTarget=function(t){this._target=t},e.prototype.when=function(t,i,r){return this.whenWithKeys(t,i,U0(i),r)},e.prototype.whenWithKeys=function(t,i,r,n){for(var a=this._tracks,o=0;o<r.length;o++){var s=r[o],l=a[s];if(!l){l=a[s]=new eG(s);var c=void 0,d=this._getAdditiveTrack(s);if(d){var u=d.keyframes,h=u[u.length-1];c=h&&h.value,d.valType===pf&&c&&(c=r_(c))}else c=this._target[s];if(c==null)continue;t>0&&l.addKeyframe(0,W1(c),n),this._trackKeys.push(s)}l.addKeyframe(t,W1(i[s]),n)}return this._maxTime=Math.max(this._maxTime,t),this},e.prototype.pause=function(){this._clip.pause(),this._paused=!0},e.prototype.resume=function(){this._clip.resume(),this._paused=!1},e.prototype.isPaused=function(){return!!this._paused},e.prototype.duration=function(t){return this._maxTime=t,this._force=!0,this},e.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var t=this._doneCbs;if(t)for(var i=t.length,r=0;r<i;r++)t[r].call(this)},e.prototype._abortedCallback=function(){this._setTracksFinished();var t=this.animation,i=this._abortedCbs;if(t&&t.removeClip(this._clip),this._clip=null,i)for(var r=0;r<i.length;r++)i[r].call(this)},e.prototype._setTracksFinished=function(){for(var t=this._tracks,i=this._trackKeys,r=0;r<i.length;r++)t[i[r]].setFinished()},e.prototype._getAdditiveTrack=function(t){var i,r=this._additiveAnimators;if(r)for(var n=0;n<r.length;n++){var a=r[n].getTrack(t);a&&(i=a)}return i},e.prototype.start=function(t){if(!(this._started>0)){this._started=1;for(var i=this,r=[],n=this._maxTime||0,a=0;a<this._trackKeys.length;a++){var o=this._trackKeys[a],s=this._tracks[o],l=this._getAdditiveTrack(o),c=s.keyframes,d=c.length;if(s.prepare(n,l),s.needsAnimate())if(!this._allowDiscrete&&s.discrete){var u=c[d-1];u&&(i._target[s.propName]=u.rawValue),s.setFinished()}else r.push(s)}if(r.length||this._force){var h=new xN({life:n,loop:this._loop,delay:this._delay||0,onframe:function(m){i._started=2;var f=i._additiveAnimators;if(f){for(var p=!1,g=0;g<f.length;g++)if(f[g]._clip){p=!0;break}p||(i._additiveAnimators=null)}for(var g=0;g<r.length;g++)r[g].step(i._target,m);var v=i._onframeCbs;if(v)for(var g=0;g<v.length;g++)v[g](i._target,m)},ondestroy:function(){i._doneCallback()}});this._clip=h,this.animation&&this.animation.addClip(h),t&&h.setEasing(t)}else this._doneCallback();return this}},e.prototype.stop=function(t){if(this._clip){var i=this._clip;t&&i.onframe(1),this._abortedCallback()}},e.prototype.delay=function(t){return this._delay=t,this},e.prototype.during=function(t){return t&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(t)),this},e.prototype.done=function(t){return t&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(t)),this},e.prototype.aborted=function(t){return t&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(t)),this},e.prototype.getClip=function(){return this._clip},e.prototype.getTrack=function(t){return this._tracks[t]},e.prototype.getTracks=function(){var t=this;return z0(this._trackKeys,function(i){return t._tracks[i]})},e.prototype.stopTracks=function(t,i){if(!t.length||!this._clip)return!0;for(var r=this._tracks,n=this._trackKeys,a=0;a<t.length;a++){var o=r[t[a]];o&&!o.isFinished()&&(i?o.step(this._target,1):this._started===1&&o.step(this._target,0),o.setFinished())}for(var s=!0,a=0;a<n.length;a++)if(!r[n[a]].isFinished()){s=!1;break}return s&&this._abortedCallback(),s},e.prototype.saveTo=function(t,i,r){if(t){i=i||this._trackKeys;for(var n=0;n<i.length;n++){var a=i[n],o=this._tracks[a];if(!(!o||o.isFinished())){var s=o.keyframes,l=s[r?0:s.length-1];l&&(t[a]=W1(l.rawValue))}}}},e.prototype.__changeFinalValue=function(t,i){i=i||U0(t);for(var r=0;r<i.length;r++){var n=i[r],a=this._tracks[n];if(a){var o=a.keyframes;if(o.length>1){var s=o.pop();a.addKeyframe(s.time,t[n]),a.prepare(this._maxTime,a.getAdditiveTrack())}}}},e}(),kN=tG;var iG={_animators:null,getAnimators:function(){return this._animators=this._animators||[],this._animators},animate:function(e,t){this._animators=this._animators||[];var i=this,r;if(e){for(var n=e.split("."),a=i,o=0,s=n.length;o<s;o++)a&&(a=a[n[o]]);a&&(r=a)}else r=i;if(r==null)throw new Error("Target "+e+" not exists");var l=this._animators,c=new kN(r,t),d=this;return c.during(function(){d.__zr&&d.__zr.refresh()}).done(function(){var u=l.indexOf(c);u>=0&&l.splice(u,1)}),l.push(c),this.__zr&&this.__zr.animation.addAnimator(c),c},stopAnimation:function(e){this._animators=this._animators||[];for(var t=this._animators,i=t.length,r=0;r<i;r++)t[r].stop(e);return t.length=0,this},addAnimatorsToZr:function(e){if(this._animators)for(var t=0;t<this._animators.length;t++)e.animation.addAnimator(this._animators[t])},removeAnimatorsFromZr:function(e){if(this._animators)for(var t=0;t<this._animators.length;t++)e.animation.removeAnimator(this._animators[t])}},NN=iG;var a_=`
@export clay.util.rand
highp float rand(vec2 uv) {
 const highp float a = 12.9898, b = 78.233, c = 43758.5453;
 highp float dt = dot(uv.xy, vec2(a,b)), sn = mod(dt, 3.141592653589793);
 return fract(sin(sn) * c);
}
@end
@export clay.util.calculate_attenuation
uniform float attenuationFactor : 5.0;
float lightAttenuation(float dist, float range)
{
 float attenuation = 1.0;
 attenuation = dist*dist/(range*range+1.0);
 float att_s = attenuationFactor;
 attenuation = 1.0/(attenuation*att_s+1.0);
 att_s = 1.0/(att_s+1.0);
 attenuation = attenuation - att_s;
 attenuation /= 1.0 - att_s;
 return clamp(attenuation, 0.0, 1.0);
}
@end
@export clay.util.edge_factor
#ifdef SUPPORT_STANDARD_DERIVATIVES
float edgeFactor(float width)
{
 vec3 d = fwidth(v_Barycentric);
 vec3 a3 = smoothstep(vec3(0.0), d * width, v_Barycentric);
 return min(min(a3.x, a3.y), a3.z);
}
#else
float edgeFactor(float width)
{
 return 1.0;
}
#endif
@end
@export clay.util.encode_float
vec4 encodeFloat(const in float depth)
{
 const vec4 bitShifts = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);
 const vec4 bit_mask = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);
 vec4 res = fract(depth * bitShifts);
 res -= res.xxyz * bit_mask;
 return res;
}
@end
@export clay.util.decode_float
float decodeFloat(const in vec4 color)
{
 const vec4 bitShifts = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);
 return dot(color, bitShifts);
}
@end
@export clay.util.float
@import clay.util.encode_float
@import clay.util.decode_float
@end
@export clay.util.rgbm_decode
vec3 RGBMDecode(vec4 rgbm, float range) {
 return range * rgbm.rgb * rgbm.a;
}
@end
@export clay.util.rgbm_encode
vec4 RGBMEncode(vec3 color, float range) {
 if (dot(color, color) == 0.0) {
 return vec4(0.0);
 }
 vec4 rgbm;
 color /= range;
 rgbm.a = clamp(max(max(color.r, color.g), max(color.b, 1e-6)), 0.0, 1.0);
 rgbm.a = ceil(rgbm.a * 255.0) / 255.0;
 rgbm.rgb = color / rgbm.a;
 return rgbm;
}
@end
@export clay.util.rgbm
@import clay.util.rgbm_decode
@import clay.util.rgbm_encode
vec4 decodeHDR(vec4 color)
{
#if defined(RGBM_DECODE) || defined(RGBM)
 return vec4(RGBMDecode(color, 8.12), 1.0);
#else
 return color;
#endif
}
vec4 encodeHDR(vec4 color)
{
#if defined(RGBM_ENCODE) || defined(RGBM)
 return RGBMEncode(color.xyz, 8.12);
#else
 return color;
#endif
}
@end
@export clay.util.srgb
vec4 sRGBToLinear(in vec4 value) {
 return vec4(mix(pow(value.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)), value.rgb * 0.0773993808, vec3(lessThanEqual(value.rgb, vec3(0.04045)))), value.w);
}
vec4 linearTosRGB(in vec4 value) {
 return vec4(mix(pow(value.rgb, vec3(0.41666)) * 1.055 - vec3(0.055), value.rgb * 12.92, vec3(lessThanEqual(value.rgb, vec3(0.0031308)))), value.w);
}
@end
@export clay.chunk.skinning_header
#ifdef SKINNING
attribute vec3 weight : WEIGHT;
attribute vec4 joint : JOINT;
#ifdef USE_SKIN_MATRICES_TEXTURE
uniform sampler2D skinMatricesTexture : ignore;
uniform float skinMatricesTextureSize: ignore;
mat4 getSkinMatrix(sampler2D tex, float idx) {
 float j = idx * 4.0;
 float x = mod(j, skinMatricesTextureSize);
 float y = floor(j / skinMatricesTextureSize) + 0.5;
 vec2 scale = vec2(skinMatricesTextureSize);
 return mat4(
 texture2D(tex, vec2(x + 0.5, y) / scale),
 texture2D(tex, vec2(x + 1.5, y) / scale),
 texture2D(tex, vec2(x + 2.5, y) / scale),
 texture2D(tex, vec2(x + 3.5, y) / scale)
 );
}
mat4 getSkinMatrix(float idx) {
 return getSkinMatrix(skinMatricesTexture, idx);
}
#else
uniform mat4 skinMatrix[JOINT_COUNT] : SKIN_MATRIX;
mat4 getSkinMatrix(float idx) {
 return skinMatrix[int(idx)];
}
#endif
#endif
@end
@export clay.chunk.skin_matrix
mat4 skinMatrixWS = getSkinMatrix(joint.x) * weight.x;
if (weight.y > 1e-4)
{
 skinMatrixWS += getSkinMatrix(joint.y) * weight.y;
}
if (weight.z > 1e-4)
{
 skinMatrixWS += getSkinMatrix(joint.z) * weight.z;
}
float weightW = 1.0-weight.x-weight.y-weight.z;
if (weightW > 1e-4)
{
 skinMatrixWS += getSkinMatrix(joint.w) * weightW;
}
@end
@export clay.chunk.instancing_header
#ifdef INSTANCING
attribute vec4 instanceMat1;
attribute vec4 instanceMat2;
attribute vec4 instanceMat3;
#endif
@end
@export clay.chunk.instancing_matrix
mat4 instanceMat = mat4(
 vec4(instanceMat1.xyz, 0.0),
 vec4(instanceMat2.xyz, 0.0),
 vec4(instanceMat3.xyz, 0.0),
 vec4(instanceMat1.w, instanceMat2.w, instanceMat3.w, 1.0)
);
@end
@export clay.util.parallax_correct
vec3 parallaxCorrect(in vec3 dir, in vec3 pos, in vec3 boxMin, in vec3 boxMax) {
 vec3 first = (boxMax - pos) / dir;
 vec3 second = (boxMin - pos) / dir;
 vec3 further = max(first, second);
 float dist = min(further.x, min(further.y, further.z));
 vec3 fixedPos = pos + dir * dist;
 vec3 boxCenter = (boxMax + boxMin) * 0.5;
 return normalize(fixedPos - boxCenter);
}
@end
@export clay.util.clamp_sample
vec4 clampSample(const in sampler2D texture, const in vec2 coord)
{
#ifdef STEREO
 float eye = step(0.5, coord.x) * 0.5;
 vec2 coordClamped = clamp(coord, vec2(eye, 0.0), vec2(0.5 + eye, 1.0));
#else
 vec2 coordClamped = clamp(coord, vec2(0.0), vec2(1.0));
#endif
 return texture2D(texture, coordClamped);
}
@end
@export clay.util.ACES
vec3 ACESToneMapping(vec3 color)
{
 const float A = 2.51;
 const float B = 0.03;
 const float C = 2.43;
 const float D = 0.59;
 const float E = 0.14;
 return (color * (A * color + B)) / (color * (C * color + D) + E);
}
@end`;var PN=`
@export ecgl.common.transformUniforms
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform mat4 worldInverseTranspose : WORLDINVERSETRANSPOSE;
uniform mat4 world : WORLD;
@end

@export ecgl.common.attributes
attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;
attribute vec3 normal : NORMAL;
@end

@export ecgl.common.uv.header
uniform vec2 uvRepeat : [1.0, 1.0];
uniform vec2 uvOffset : [0.0, 0.0];
uniform vec2 detailUvRepeat : [1.0, 1.0];
uniform vec2 detailUvOffset : [0.0, 0.0];

varying vec2 v_Texcoord;
varying vec2 v_DetailTexcoord;
@end

@export ecgl.common.uv.main
v_Texcoord = texcoord * uvRepeat + uvOffset;
v_DetailTexcoord = texcoord * detailUvRepeat + detailUvOffset;
@end

@export ecgl.common.uv.fragmentHeader
varying vec2 v_Texcoord;
varying vec2 v_DetailTexcoord;
@end


@export ecgl.common.albedo.main

 vec4 albedoTexel = vec4(1.0);
#ifdef DIFFUSEMAP_ENABLED
 albedoTexel = texture2D(diffuseMap, v_Texcoord);
 #ifdef SRGB_DECODE
 albedoTexel = sRGBToLinear(albedoTexel);
 #endif
#endif

#ifdef DETAILMAP_ENABLED
 vec4 detailTexel = texture2D(detailMap, v_DetailTexcoord);
 #ifdef SRGB_DECODE
 detailTexel = sRGBToLinear(detailTexel);
 #endif
 albedoTexel.rgb = mix(albedoTexel.rgb, detailTexel.rgb, detailTexel.a);
 albedoTexel.a = detailTexel.a + (1.0 - detailTexel.a) * albedoTexel.a;
#endif

@end

@export ecgl.common.wireframe.vertexHeader

#ifdef WIREFRAME_QUAD
attribute vec4 barycentric;
varying vec4 v_Barycentric;
#elif defined(WIREFRAME_TRIANGLE)
attribute vec3 barycentric;
varying vec3 v_Barycentric;
#endif

@end

@export ecgl.common.wireframe.vertexMain

#if defined(WIREFRAME_QUAD) || defined(WIREFRAME_TRIANGLE)
 v_Barycentric = barycentric;
#endif

@end


@export ecgl.common.wireframe.fragmentHeader

uniform float wireframeLineWidth : 1;
uniform vec4 wireframeLineColor: [0, 0, 0, 0.5];

#ifdef WIREFRAME_QUAD
varying vec4 v_Barycentric;
float edgeFactor () {
 vec4 d = fwidth(v_Barycentric);
 vec4 a4 = smoothstep(vec4(0.0), d * wireframeLineWidth, v_Barycentric);
 return min(min(min(a4.x, a4.y), a4.z), a4.w);
}
#elif defined(WIREFRAME_TRIANGLE)
varying vec3 v_Barycentric;
float edgeFactor () {
 vec3 d = fwidth(v_Barycentric);
 vec3 a3 = smoothstep(vec3(0.0), d * wireframeLineWidth, v_Barycentric);
 return min(min(a3.x, a3.y), a3.z);
}
#endif

@end


@export ecgl.common.wireframe.fragmentMain

#if defined(WIREFRAME_QUAD) || defined(WIREFRAME_TRIANGLE)
 if (wireframeLineWidth > 0.) {
 vec4 lineColor = wireframeLineColor;
#ifdef SRGB_DECODE
 lineColor = sRGBToLinear(lineColor);
#endif

 gl_FragColor.rgb = mix(gl_FragColor.rgb, lineColor.rgb, (1.0 - edgeFactor()) * lineColor.a);
 }
#endif
@end




@export ecgl.common.bumpMap.header

#ifdef BUMPMAP_ENABLED
uniform sampler2D bumpMap;
uniform float bumpScale : 1.0;


vec3 bumpNormal(vec3 surfPos, vec3 surfNormal, vec3 baseNormal)
{
 vec2 dSTdx = dFdx(v_Texcoord);
 vec2 dSTdy = dFdy(v_Texcoord);

 float Hll = bumpScale * texture2D(bumpMap, v_Texcoord).x;
 float dHx = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdx).x - Hll;
 float dHy = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdy).x - Hll;

 vec3 vSigmaX = dFdx(surfPos);
 vec3 vSigmaY = dFdy(surfPos);
 vec3 vN = surfNormal;

 vec3 R1 = cross(vSigmaY, vN);
 vec3 R2 = cross(vN, vSigmaX);

 float fDet = dot(vSigmaX, R1);

 vec3 vGrad = sign(fDet) * (dHx * R1 + dHy * R2);
 return normalize(abs(fDet) * baseNormal - vGrad);

}
#endif

@end

@export ecgl.common.normalMap.vertexHeader

#ifdef NORMALMAP_ENABLED
attribute vec4 tangent : TANGENT;
varying vec3 v_Tangent;
varying vec3 v_Bitangent;
#endif

@end

@export ecgl.common.normalMap.vertexMain

#ifdef NORMALMAP_ENABLED
 if (dot(tangent, tangent) > 0.0) {
 v_Tangent = normalize((worldInverseTranspose * vec4(tangent.xyz, 0.0)).xyz);
 v_Bitangent = normalize(cross(v_Normal, v_Tangent) * tangent.w);
 }
#endif

@end


@export ecgl.common.normalMap.fragmentHeader

#ifdef NORMALMAP_ENABLED
uniform sampler2D normalMap;
varying vec3 v_Tangent;
varying vec3 v_Bitangent;
#endif

@end

@export ecgl.common.normalMap.fragmentMain
#ifdef NORMALMAP_ENABLED
 if (dot(v_Tangent, v_Tangent) > 0.0) {
 vec3 normalTexel = texture2D(normalMap, v_DetailTexcoord).xyz;
 if (dot(normalTexel, normalTexel) > 0.0) { N = normalTexel * 2.0 - 1.0;
 mat3 tbn = mat3(v_Tangent, v_Bitangent, v_Normal);
 N = normalize(tbn * N);
 }
 }
#endif
@end



@export ecgl.common.vertexAnimation.header

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
attribute vec3 prevNormal;
uniform float percent;
#endif

@end

@export ecgl.common.vertexAnimation.main

#ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
 vec3 norm = mix(prevNormal, normal, percent);
#else
 vec3 pos = position;
 vec3 norm = normal;
#endif

@end


@export ecgl.common.ssaoMap.header
#ifdef SSAOMAP_ENABLED
uniform sampler2D ssaoMap;
uniform vec4 viewport : VIEWPORT;
#endif
@end

@export ecgl.common.ssaoMap.main
 float ao = 1.0;
#ifdef SSAOMAP_ENABLED
 ao = texture2D(ssaoMap, (gl_FragCoord.xy - viewport.xy) / viewport.zw).r;
#endif
@end




@export ecgl.common.diffuseLayer.header

#if (LAYER_DIFFUSEMAP_COUNT > 0)
uniform float layerDiffuseIntensity[LAYER_DIFFUSEMAP_COUNT];
uniform sampler2D layerDiffuseMap[LAYER_DIFFUSEMAP_COUNT];
#endif

@end

@export ecgl.common.emissiveLayer.header

#if (LAYER_EMISSIVEMAP_COUNT > 0)
uniform float layerEmissionIntensity[LAYER_EMISSIVEMAP_COUNT];
uniform sampler2D layerEmissiveMap[LAYER_EMISSIVEMAP_COUNT];
#endif

@end

@export ecgl.common.layers.header
@import ecgl.common.diffuseLayer.header
@import ecgl.common.emissiveLayer.header
@end

@export ecgl.common.diffuseLayer.main

#if (LAYER_DIFFUSEMAP_COUNT > 0)
 for (int _idx_ = 0; _idx_ < LAYER_DIFFUSEMAP_COUNT; _idx_++) {{
 float intensity = layerDiffuseIntensity[_idx_];
 vec4 texel2 = texture2D(layerDiffuseMap[_idx_], v_Texcoord);
 #ifdef SRGB_DECODE
 texel2 = sRGBToLinear(texel2);
 #endif
 albedoTexel.rgb = mix(albedoTexel.rgb, texel2.rgb * intensity, texel2.a);
 albedoTexel.a = texel2.a + (1.0 - texel2.a) * albedoTexel.a;
 }}
#endif

@end

@export ecgl.common.emissiveLayer.main

#if (LAYER_EMISSIVEMAP_COUNT > 0)
 for (int _idx_ = 0; _idx_ < LAYER_EMISSIVEMAP_COUNT; _idx_++)
 {{
 vec4 texel2 = texture2D(layerEmissiveMap[_idx_], v_Texcoord) * layerEmissionIntensity[_idx_];
 #ifdef SRGB_DECODE
 texel2 = sRGBToLinear(texel2);
 #endif
 float intensity = layerEmissionIntensity[_idx_];
 gl_FragColor.rgb += texel2.rgb * texel2.a * intensity;
 }}
#endif

@end
`;var RN=`@export ecgl.color.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

@import ecgl.common.uv.header

attribute vec2 texcoord : TEXCOORD_0;
attribute vec3 position: POSITION;

@import ecgl.common.wireframe.vertexHeader

#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
uniform float percent : 1.0;
#endif

#ifdef ATMOSPHERE_ENABLED
attribute vec3 normal: NORMAL;
uniform mat4 worldInverseTranspose : WORLDINVERSETRANSPOSE;
varying vec3 v_Normal;
#endif

void main()
{
#ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
#else
 vec3 pos = position;
#endif

 gl_Position = worldViewProjection * vec4(pos, 1.0);

 @import ecgl.common.uv.main

#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif

#ifdef ATMOSPHERE_ENABLED
 v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);
#endif

 @import ecgl.common.wireframe.vertexMain

}

@end

@export ecgl.color.fragment

#define LAYER_DIFFUSEMAP_COUNT 0
#define LAYER_EMISSIVEMAP_COUNT 0

uniform sampler2D diffuseMap;
uniform sampler2D detailMap;

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

#ifdef ATMOSPHERE_ENABLED
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform vec3 glowColor;
uniform float glowPower;
varying vec3 v_Normal;
#endif

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif

@import ecgl.common.layers.header

@import ecgl.common.uv.fragmentHeader

@import ecgl.common.wireframe.fragmentHeader

@import clay.util.srgb

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color);
#else
 gl_FragColor = color;
#endif

#ifdef VERTEX_COLOR
 gl_FragColor *= v_Color;
#endif

 @import ecgl.common.albedo.main

 @import ecgl.common.diffuseLayer.main

 gl_FragColor *= albedoTexel;

#ifdef ATMOSPHERE_ENABLED
 float atmoIntensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor.rgb += glowColor * atmoIntensity;
#endif

 @import ecgl.common.emissiveLayer.main

 @import ecgl.common.wireframe.fragmentMain

}
@end`;var FN=`/**
 * http: */

@export ecgl.lambert.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header


@import ecgl.common.attributes

@import ecgl.common.wireframe.vertexHeader

#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif


@import ecgl.common.vertexAnimation.header


varying vec3 v_Normal;
varying vec3 v_WorldPosition;

void main()
{
 @import ecgl.common.uv.main

 @import ecgl.common.vertexAnimation.main


 gl_Position = worldViewProjection * vec4(pos, 1.0);

 v_Normal = normalize((worldInverseTranspose * vec4(norm, 0.0)).xyz);
 v_WorldPosition = (world * vec4(pos, 1.0)).xyz;

#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif

 @import ecgl.common.wireframe.vertexMain
}

@end


@export ecgl.lambert.fragment

#define LAYER_DIFFUSEMAP_COUNT 0
#define LAYER_EMISSIVEMAP_COUNT 0

#define NORMAL_UP_AXIS 1
#define NORMAL_FRONT_AXIS 2

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform sampler2D diffuseMap;
uniform sampler2D detailMap;

@import ecgl.common.layers.header

uniform float emissionIntensity: 1.0;

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

uniform mat4 viewInverse : VIEWINVERSE;

#ifdef ATMOSPHERE_ENABLED
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform vec3 glowColor;
uniform float glowPower;
#endif

#ifdef AMBIENT_LIGHT_COUNT
@import clay.header.ambient_light
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
@import clay.header.ambient_sh_light
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif


@import ecgl.common.ssaoMap.header

@import ecgl.common.bumpMap.header

@import clay.util.srgb

@import ecgl.common.wireframe.fragmentHeader

@import clay.plugin.compute_shadow_map

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color);
#else
 gl_FragColor = color;
#endif

#ifdef VERTEX_COLOR
 #ifdef SRGB_DECODE
 gl_FragColor *= sRGBToLinear(v_Color);
 #else
 gl_FragColor *= v_Color;
 #endif
#endif

 @import ecgl.common.albedo.main

 @import ecgl.common.diffuseLayer.main

 gl_FragColor *= albedoTexel;

 vec3 N = v_Normal;
#ifdef DOUBLE_SIDED
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);

 if (dot(N, V) < 0.0) {
 N = -N;
 }
#endif

 float ambientFactor = 1.0;

#ifdef BUMPMAP_ENABLED
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 ambientFactor = dot(v_Normal, N);
#endif

 vec3 N2 = vec3(N.x, N[NORMAL_UP_AXIS], N[NORMAL_FRONT_AXIS]);

 vec3 diffuseColor = vec3(0.0, 0.0, 0.0);

 @import ecgl.common.ssaoMap.main

#ifdef AMBIENT_LIGHT_COUNT
 for(int i = 0; i < AMBIENT_LIGHT_COUNT; i++)
 {
 diffuseColor += ambientLightColor[i] * ambientFactor * ao;
 }
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)
 {{
 diffuseColor += calcAmbientSHLight(_idx_, N2) * ambientSHLightColor[_idx_] * ao;
 }}
#endif
#ifdef DIRECTIONAL_LIGHT_COUNT
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
#endif
 for(int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++)
 {
 vec3 lightDirection = -directionalLightDirection[i];
 vec3 lightColor = directionalLightColor[i];

 float shadowContrib = 1.0;
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 if (shadowEnabled)
 {
 shadowContrib = shadowContribsDir[i];
 }
#endif

 float ndl = dot(N, normalize(lightDirection)) * shadowContrib;

 diffuseColor += lightColor * clamp(ndl, 0.0, 1.0);
 }
#endif

 gl_FragColor.rgb *= diffuseColor;

#ifdef ATMOSPHERE_ENABLED
 float atmoIntensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor.rgb += glowColor * atmoIntensity;
#endif

 @import ecgl.common.emissiveLayer.main

 @import ecgl.common.wireframe.fragmentMain
}

@end`;var ON=`@export ecgl.realistic.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header

@import ecgl.common.attributes


@import ecgl.common.wireframe.vertexHeader

#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif

#ifdef NORMALMAP_ENABLED
attribute vec4 tangent : TANGENT;
varying vec3 v_Tangent;
varying vec3 v_Bitangent;
#endif

@import ecgl.common.vertexAnimation.header

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

void main()
{

 @import ecgl.common.uv.main

 @import ecgl.common.vertexAnimation.main

 gl_Position = worldViewProjection * vec4(pos, 1.0);

 v_Normal = normalize((worldInverseTranspose * vec4(norm, 0.0)).xyz);
 v_WorldPosition = (world * vec4(pos, 1.0)).xyz;

#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif

#ifdef NORMALMAP_ENABLED
 v_Tangent = normalize((worldInverseTranspose * vec4(tangent.xyz, 0.0)).xyz);
 v_Bitangent = normalize(cross(v_Normal, v_Tangent) * tangent.w);
#endif

 @import ecgl.common.wireframe.vertexMain

}

@end



@export ecgl.realistic.fragment

#define LAYER_DIFFUSEMAP_COUNT 0
#define LAYER_EMISSIVEMAP_COUNT 0
#define PI 3.14159265358979
#define ROUGHNESS_CHANEL 0
#define METALNESS_CHANEL 1

#define NORMAL_UP_AXIS 1
#define NORMAL_FRONT_AXIS 2

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform sampler2D diffuseMap;

uniform sampler2D detailMap;
uniform sampler2D metalnessMap;
uniform sampler2D roughnessMap;

@import ecgl.common.layers.header

uniform float emissionIntensity: 1.0;

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

uniform float metalness : 0.0;
uniform float roughness : 0.5;

uniform mat4 viewInverse : VIEWINVERSE;

#ifdef ATMOSPHERE_ENABLED
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform vec3 glowColor;
uniform float glowPower;
#endif

#ifdef AMBIENT_LIGHT_COUNT
@import clay.header.ambient_light
#endif

#ifdef AMBIENT_SH_LIGHT_COUNT
@import clay.header.ambient_sh_light
#endif

#ifdef AMBIENT_CUBEMAP_LIGHT_COUNT
@import clay.header.ambient_cubemap_light
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

@import ecgl.common.normalMap.fragmentHeader

@import ecgl.common.ssaoMap.header

@import ecgl.common.bumpMap.header

@import clay.util.srgb

@import clay.util.rgbm

@import ecgl.common.wireframe.fragmentHeader

@import clay.plugin.compute_shadow_map

vec3 F_Schlick(float ndv, vec3 spec) {
 return spec + (1.0 - spec) * pow(1.0 - ndv, 5.0);
}

float D_Phong(float g, float ndh) {
 float a = pow(8192.0, g);
 return (a + 2.0) / 8.0 * pow(ndh, a);
}

void main()
{
 vec4 albedoColor = color;

 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);
#ifdef VERTEX_COLOR
 #ifdef SRGB_DECODE
 albedoColor *= sRGBToLinear(v_Color);
 #else
 albedoColor *= v_Color;
 #endif
#endif

 @import ecgl.common.albedo.main

 @import ecgl.common.diffuseLayer.main

 albedoColor *= albedoTexel;

 float m = metalness;

#ifdef METALNESSMAP_ENABLED
 float m2 = texture2D(metalnessMap, v_DetailTexcoord)[METALNESS_CHANEL];
 m = clamp(m2 + (m - 0.5) * 2.0, 0.0, 1.0);
#endif

 vec3 baseColor = albedoColor.rgb;
 albedoColor.rgb = baseColor * (1.0 - m);
 vec3 specFactor = mix(vec3(0.04), baseColor, m);

 float g = 1.0 - roughness;

#ifdef ROUGHNESSMAP_ENABLED
 float g2 = 1.0 - texture2D(roughnessMap, v_DetailTexcoord)[ROUGHNESS_CHANEL];
 g = clamp(g2 + (g - 0.5) * 2.0, 0.0, 1.0);
#endif

 vec3 N = v_Normal;

#ifdef DOUBLE_SIDED
 if (dot(N, V) < 0.0) {
 N = -N;
 }
#endif

 float ambientFactor = 1.0;

#ifdef BUMPMAP_ENABLED
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 ambientFactor = dot(v_Normal, N);
#endif

@import ecgl.common.normalMap.fragmentMain

 vec3 N2 = vec3(N.x, N[NORMAL_UP_AXIS], N[NORMAL_FRONT_AXIS]);

 vec3 diffuseTerm = vec3(0.0);
 vec3 specularTerm = vec3(0.0);

 float ndv = clamp(dot(N, V), 0.0, 1.0);
 vec3 fresnelTerm = F_Schlick(ndv, specFactor);

 @import ecgl.common.ssaoMap.main

#ifdef AMBIENT_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_LIGHT_COUNT; _idx_++)
 {{
 diffuseTerm += ambientLightColor[_idx_] * ambientFactor * ao;
 }}
#endif

#ifdef AMBIENT_SH_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)
 {{
 diffuseTerm += calcAmbientSHLight(_idx_, N2) * ambientSHLightColor[_idx_] * ao;
 }}
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
#endif
 for(int _idx_ = 0; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++)
 {{
 vec3 L = -directionalLightDirection[_idx_];
 vec3 lc = directionalLightColor[_idx_];

 vec3 H = normalize(L + V);
 float ndl = clamp(dot(N, normalize(L)), 0.0, 1.0);
 float ndh = clamp(dot(N, H), 0.0, 1.0);

 float shadowContrib = 1.0;
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 if (shadowEnabled)
 {
 shadowContrib = shadowContribsDir[_idx_];
 }
#endif

 vec3 li = lc * ndl * shadowContrib;

 diffuseTerm += li;
 specularTerm += li * fresnelTerm * D_Phong(g, ndh);
 }}
#endif


#ifdef AMBIENT_CUBEMAP_LIGHT_COUNT
 vec3 L = reflect(-V, N);
 L = vec3(L.x, L[NORMAL_UP_AXIS], L[NORMAL_FRONT_AXIS]);
 float rough2 = clamp(1.0 - g, 0.0, 1.0);
 float bias2 = rough2 * 5.0;
 vec2 brdfParam2 = texture2D(ambientCubemapLightBRDFLookup[0], vec2(rough2, ndv)).xy;
 vec3 envWeight2 = specFactor * brdfParam2.x + brdfParam2.y;
 vec3 envTexel2;
 for(int _idx_ = 0; _idx_ < AMBIENT_CUBEMAP_LIGHT_COUNT; _idx_++)
 {{
 envTexel2 = RGBMDecode(textureCubeLodEXT(ambientCubemapLightCubemap[_idx_], L, bias2), 8.12);
 specularTerm += ambientCubemapLightColor[_idx_] * envTexel2 * envWeight2 * ao;
 }}
#endif

 gl_FragColor.rgb = albedoColor.rgb * diffuseTerm + specularTerm;
 gl_FragColor.a = albedoColor.a;

#ifdef ATMOSPHERE_ENABLED
 float atmoIntensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor.rgb += glowColor * atmoIntensity;
#endif

#ifdef SRGB_ENCODE
 gl_FragColor = linearTosRGB(gl_FragColor);
#endif

 @import ecgl.common.emissiveLayer.main

 @import ecgl.common.wireframe.fragmentMain
}

@end`;var LN=`@export ecgl.hatching.vertex

@import ecgl.realistic.vertex

@end


@export ecgl.hatching.fragment

#define NORMAL_UP_AXIS 1
#define NORMAL_FRONT_AXIS 2

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform vec4 color : [0.0, 0.0, 0.0, 1.0];
uniform vec4 paperColor : [1.0, 1.0, 1.0, 1.0];

uniform mat4 viewInverse : VIEWINVERSE;

#ifdef AMBIENT_LIGHT_COUNT
@import clay.header.ambient_light
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
@import clay.header.ambient_sh_light
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif


@import ecgl.common.ssaoMap.header

@import ecgl.common.bumpMap.header

@import clay.util.srgb

@import ecgl.common.wireframe.fragmentHeader

@import clay.plugin.compute_shadow_map

uniform sampler2D hatch1;
uniform sampler2D hatch2;
uniform sampler2D hatch3;
uniform sampler2D hatch4;
uniform sampler2D hatch5;
uniform sampler2D hatch6;

float shade(in float tone) {
 vec4 c = vec4(1. ,1., 1., 1.);
 float step = 1. / 6.;
 vec2 uv = v_DetailTexcoord;
 if (tone <= step / 2.0) {
 c = mix(vec4(0.), texture2D(hatch6, uv), 12. * tone);
 }
 else if (tone <= step) {
 c = mix(texture2D(hatch6, uv), texture2D(hatch5, uv), 6. * tone);
 }
 if(tone > step && tone <= 2. * step){
 c = mix(texture2D(hatch5, uv), texture2D(hatch4, uv) , 6. * (tone - step));
 }
 if(tone > 2. * step && tone <= 3. * step){
 c = mix(texture2D(hatch4, uv), texture2D(hatch3, uv), 6. * (tone - 2. * step));
 }
 if(tone > 3. * step && tone <= 4. * step){
 c = mix(texture2D(hatch3, uv), texture2D(hatch2, uv), 6. * (tone - 3. * step));
 }
 if(tone > 4. * step && tone <= 5. * step){
 c = mix(texture2D(hatch2, uv), texture2D(hatch1, uv), 6. * (tone - 4. * step));
 }
 if(tone > 5. * step){
 c = mix(texture2D(hatch1, uv), vec4(1.), 6. * (tone - 5. * step));
 }

 return c.r;
}

const vec3 w = vec3(0.2125, 0.7154, 0.0721);

void main()
{
#ifdef SRGB_DECODE
 vec4 inkColor = sRGBToLinear(color);
#else
 vec4 inkColor = color;
#endif

#ifdef VERTEX_COLOR
 #ifdef SRGB_DECODE
 inkColor *= sRGBToLinear(v_Color);
 #else
 inkColor *= v_Color;
 #endif
#endif

 vec3 N = v_Normal;
#ifdef DOUBLE_SIDED
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);

 if (dot(N, V) < 0.0) {
 N = -N;
 }
#endif

 float tone = 0.0;

 float ambientFactor = 1.0;

#ifdef BUMPMAP_ENABLED
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 ambientFactor = dot(v_Normal, N);
#endif

 vec3 N2 = vec3(N.x, N[NORMAL_UP_AXIS], N[NORMAL_FRONT_AXIS]);

 @import ecgl.common.ssaoMap.main

#ifdef AMBIENT_LIGHT_COUNT
 for(int i = 0; i < AMBIENT_LIGHT_COUNT; i++)
 {
 tone += dot(ambientLightColor[i], w) * ambientFactor * ao;
 }
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)
 {{
 tone += dot(calcAmbientSHLight(_idx_, N2) * ambientSHLightColor[_idx_], w) * ao;
 }}
#endif
#ifdef DIRECTIONAL_LIGHT_COUNT
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
#endif
 for(int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++)
 {
 vec3 lightDirection = -directionalLightDirection[i];
 float lightTone = dot(directionalLightColor[i], w);

 float shadowContrib = 1.0;
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 if (shadowEnabled)
 {
 shadowContrib = shadowContribsDir[i];
 }
#endif

 float ndl = dot(N, normalize(lightDirection)) * shadowContrib;

 tone += lightTone * clamp(ndl, 0.0, 1.0);
 }
#endif

 gl_FragColor = mix(inkColor, paperColor, shade(clamp(tone, 0.0, 1.0)));
 }
@end
`;var BN=`@export ecgl.sm.depth.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
uniform float percent : 1.0;
#endif

varying vec4 v_ViewPosition;
varying vec2 v_Texcoord;

void main(){

#ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
#else
 vec3 pos = position;
#endif

 v_ViewPosition = worldViewProjection * vec4(pos, 1.0);
 gl_Position = v_ViewPosition;

 v_Texcoord = texcoord;

}
@end



@export ecgl.sm.depth.fragment

@import clay.sm.depth.fragment

@end`;Object.assign(ra.prototype,NN);Re.import(a_);Re.import(p0);Re.import(PN);Re.import(RN);Re.import(FN);Re.import(ON);Re.import(LN);Re.import(BN);function rG(e){return!e||e==="none"}function UN(e){return e instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof Image}function nG(e){return e.getZr&&e.setOption}var aG=to.prototype.addToScene,oG=to.prototype.removeFromScene;to.prototype.addToScene=function(e){if(aG.call(this,e),this.__zr){var t=this.__zr;e.traverse(function(i){i.__zr=t,i.addAnimatorsToZr&&i.addAnimatorsToZr(t)})}};to.prototype.removeFromScene=function(e){oG.call(this,e),e.traverse(function(t){var i=t.__zr;t.__zr=null,i&&t.removeAnimatorsFromZr&&t.removeAnimatorsFromZr(i)})};$r.prototype.setTextureImage=function(e,t,i,r){if(this.shader){var n=i.getZr(),a=this,o;return a.autoUpdateTextureStatus=!1,a.disableTexture(e),rG(t)||(o=St.loadTexture(t,i,r,function(s){a.enableTexture(e),n&&n.refresh()}),a.set(e,o)),o}};var St={};St.Renderer=uc;St.Node=ra;St.Mesh=cs;St.Shader=Re;St.Material=$r;St.Texture=qe;St.Texture2D=ct;St.Geometry=Lt;St.SphereGeometry=Kk;St.PlaneGeometry=pc;St.CubeGeometry=N0;St.AmbientLight=Qk;St.DirectionalLight=Jk;St.PointLight=eN;St.SpotLight=tN;St.PerspectiveCamera=Cr;St.OrthographicCamera=us;St.Vector2=rn;St.Vector3=Se;St.Vector4=iN;St.Quaternion=x0;St.Matrix2=rN;St.Matrix2d=nN;St.Matrix3=aN;St.Matrix4=Ye;St.Plane=T0;St.Ray=Nd;St.BoundingBox=wr;St.Frustum=Ah;var o_=null;function sG(){return o_!==null||(o_=Ms.createBlank("rgba(255,255,255,0)").image),o_}function VN(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))}function zN(e){if((e.wrapS===qe.REPEAT||e.wrapT===qe.REPEAT)&&e.image){var t=VN(e.width),i=VN(e.height);if(t!==e.width||i!==e.height){var r=document.createElement("canvas");r.width=t,r.height=i;var n=r.getContext("2d");n.drawImage(e.image,0,0,t,i),e.image=r}}}St.loadTexture=function(e,t,i,r){typeof i=="function"&&(r=i,i={}),i=i||{};for(var n=Object.keys(i).sort(),a="",o=0;o<n.length;o++)a+=n[o]+"_"+i[n[o]]+"_";var s=t.__textureCache=t.__textureCache||new M0(20);if(nG(e)){var l=e.__textureid__,c=s.get(a+l);if(c)c.texture.surface.setECharts(e),r&&r(c.texture);else{var d=new Hk(e);d.onupdate=function(){t.getZr().refresh()},c={texture:d.getTexture()};for(var o=0;o<n.length;o++)c.texture[n[o]]=i[n[o]];l=e.__textureid__||"__ecgl_ec__"+c.texture.__uid__,e.__textureid__=l,s.put(a+l,c),r&&r(c.texture)}return c.texture}else if(UN(e)){var l=e.__textureid__,c=s.get(a+l);if(!c){c={texture:new St.Texture2D({image:e})};for(var o=0;o<n.length;o++)c.texture[n[o]]=i[n[o]];l=e.__textureid__||"__ecgl_image__"+c.texture.__uid__,e.__textureid__=l,s.put(a+l,c),zN(c.texture),r&&r(c.texture)}return c.texture}else{var c=s.get(a+e);if(c)c.callbacks?c.callbacks.push(r):r&&r(c.texture);else if(e.match(/.hdr$|^data:application\/octet-stream/)){c={callbacks:[r]};var u=Ms.loadTexture(e,{exposure:i.exposure,fileType:"hdr"},function(){u.dirty(),c.callbacks.forEach(function(f){f&&f(u)}),c.callbacks=null});c.texture=u,s.put(a+e,c)}else{for(var u=new St.Texture2D({image:new Image}),o=0;o<n.length;o++)u[n[o]]=i[n[o]];c={texture:u,callbacks:[r]};var h=u.image;h.onload=function(){u.image=h,zN(u),u.dirty(),c.callbacks.forEach(function(p){p&&p(u)}),c.callbacks=null},h.crossOrigin="Anonymous",h.src=e,u.image=sG(),s.put(a+e,c)}return c.texture}};St.createAmbientCubemap=function(e,t,i,r){e=e||{};var n=e.texture,a=ht.firstNotNull(e.exposure,1),o=new $k({intensity:ht.firstNotNull(e.specularIntensity,1)}),s=new Xk({intensity:ht.firstNotNull(e.diffuseIntensity,1),coefficients:[.844,.712,.691,-.037,.083,.167,.343,.288,.299,-.041,-.021,-.009,-.003,-.041,-.064,-.011,-.007,-.004,-.031,.034,.081,-.06,-.049,-.06,.046,.056,.05]});return o.cubemap=St.loadTexture(n,i,{exposure:a},function(){if(o.cubemap.flipY=!1,0)var l;if(o.prefilter(t,32),0)var c;s.coefficients=Zk.projectEnvironmentMap(t,o.cubemap,{lod:1}),r&&r()}),{specular:o,diffuse:s}};St.createBlankTexture=Ms.createBlank;St.isImage=UN;St.additiveBlend=function(e){e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE)};St.parseColor=function(e,t){return e instanceof Array?(t||(t=[]),t[0]=e[0],t[1]=e[1],t[2]=e[2],e.length>3?t[3]=e[3]:t[3]=1,t):(t=Ss.parse(e||"#000",t)||[0,0,0,0],t[0]/=255,t[1]/=255,t[2]/=255,t)};St.directionFromAlphaBeta=function(e,t){var i=e/180*Math.PI+Math.PI/2,r=-t/180*Math.PI+Math.PI/2,n=[],a=Math.sin(i);return n[0]=a*Math.cos(r),n[1]=-Math.cos(i),n[2]=a*Math.sin(r),n};St.getShadowResolution=function(e){var t=1024;switch(e){case"low":t=512;break;case"medium":break;case"high":t=2048;break;case"ultra":t=4096;break}return t};St.COMMON_SHADERS=["lambert","color","realistic","hatching","shadow"];St.createShader=function(e){e==="ecgl.shadow"&&(e="ecgl.displayShadow");var t=Re.source(e+".vertex"),i=Re.source(e+".fragment");t||console.error("Vertex shader of '%s' not exits",e),i||console.error("Fragment shader of '%s' not exits",e);var r=new Re(t,i);return r.name=e,r};St.createMaterial=function(e,t){t instanceof Array||(t=[t]);var i=St.createShader(e),r=new $r({shader:i});return t.forEach(function(n){typeof n=="string"&&r.define(n)}),r};St.setMaterialFromModel=function(e,t,i,r){t.autoUpdateTextureStatus=!1;var n=i.getModel(e+"Material"),a=n.get("detailTexture"),o=ht.firstNotNull(n.get("textureTiling"),1),s=ht.firstNotNull(n.get("textureOffset"),0);typeof o=="number"&&(o=[o,o]),typeof s=="number"&&(s=[s,s]);var l=o[0]>1||o[1]>1?St.Texture.REPEAT:St.Texture.CLAMP_TO_EDGE,c={anisotropic:8,wrapS:l,wrapT:l};if(e==="realistic"){var d=n.get("roughness"),u=n.get("metalness");u!=null?isNaN(u)&&(t.setTextureImage("metalnessMap",u,r,c),u=ht.firstNotNull(n.get("metalnessAdjust"),.5)):u=0,d!=null?isNaN(d)&&(t.setTextureImage("roughnessMap",d,r,c),d=ht.firstNotNull(n.get("roughnessAdjust"),.5)):d=.5;var h=n.get("normalTexture");t.setTextureImage("detailMap",a,r,c),t.setTextureImage("normalMap",h,r,c),t.set({roughness:d,metalness:u,detailUvRepeat:o,detailUvOffset:s})}else if(e==="lambert")t.setTextureImage("detailMap",a,r,c),t.set({detailUvRepeat:o,detailUvOffset:s});else if(e==="color")t.setTextureImage("detailMap",a,r,c),t.set({detailUvRepeat:o,detailUvOffset:s});else if(e==="hatching"){var m=n.get("hatchingTextures")||[];m.length<6;for(var f=0;f<6;f++)t.setTextureImage("hatch"+(f+1),m[f],r,{anisotropic:8,wrapS:St.Texture.REPEAT,wrapT:St.Texture.REPEAT});t.set({detailUvRepeat:o,detailUvOffset:s})}};St.updateVertexAnimation=function(e,t,i,r){var n=r.get("animation"),a=r.get("animationDurationUpdate"),o=r.get("animationEasingUpdate"),s=i.shadowDepthMaterial;if(n&&t&&a>0&&t.geometry.vertexCount===i.geometry.vertexCount){i.material.define("vertex","VERTEX_ANIMATION"),i.ignorePreZ=!0,s&&s.define("vertex","VERTEX_ANIMATION");for(var l=0;l<e.length;l++)i.geometry.attributes[e[l][0]].value=t.geometry.attributes[e[l][1]].value;i.geometry.dirty(),i.__percent=0,i.material.set("percent",0),i.stopAnimation(),i.animate().when(a,{__percent:1}).during(function(){i.material.set("percent",i.__percent),s&&s.set("percent",i.__percent)}).done(function(){i.ignorePreZ=!1,i.material.undefine("vertex","VERTEX_ANIMATION"),s&&s.undefine("vertex","VERTEX_ANIMATION")}).start(o)}else i.material.undefine("vertex","VERTEX_ANIMATION"),s&&s.undefine("vertex","VERTEX_ANIMATION")};var R=St;var HN;HN=J0.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){return setTimeout(e,16)};var ff=HN;var Yi=function(e,t){this.id=e,this.zr=t;try{this.renderer=new uc({clearBit:0,devicePixelRatio:t.painter.dpr,preserveDrawingBuffer:!0,premultipliedAlpha:!0}),this.renderer.resize(t.painter.getWidth(),t.painter.getHeight())}catch(r){this.renderer=null,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute; left: 0; top: 0; right: 0; bottom: 0;",this.dom.className="ecgl-nowebgl",this.dom.innerHTML="Sorry, your browser does not support WebGL",console.error(r);return}this.onglobalout=this.onglobalout.bind(this),t.on("globalout",this.onglobalout),this.dom=this.renderer.canvas;var i=this.dom.style;i.position="absolute",i.left="0",i.top="0",this.views=[],this._picking=new wk({renderer:this.renderer}),this._viewsToDispose=[],this._accumulatingId=0,this._zrEventProxy=new qr.Rect({shape:{x:-1,y:-1,width:2,height:2},__isGLToZRProxy:!0}),this._backgroundColor=null,this._disposed=!1};Yi.prototype.setUnpainted=function(){};Yi.prototype.addView=function(e){if(e.layer!==this){var t=this._viewsToDispose.indexOf(e);t>=0&&this._viewsToDispose.splice(t,1),this.views.push(e),e.layer=this;var i=this.zr;e.scene.traverse(function(r){r.__zr=i,r.addAnimatorsToZr&&r.addAnimatorsToZr(i)})}};function GN(e){var t=e.__zr;e.__zr=null,t&&e.removeAnimatorsFromZr&&e.removeAnimatorsFromZr(t)}Yi.prototype.removeView=function(e){if(e.layer===this){var t=this.views.indexOf(e);t>=0&&(this.views.splice(t,1),e.scene.traverse(GN,this),e.layer=null,this._viewsToDispose.push(e))}};Yi.prototype.removeViewsAll=function(){this.views.forEach(function(e){e.scene.traverse(GN,this),e.layer=null,this._viewsToDispose.push(e)},this),this.views.length=0};Yi.prototype.resize=function(e,t){var i=this.renderer;i.resize(e,t)};Yi.prototype.clear=function(){var e=this.renderer.gl,t=this._backgroundColor||[0,0,0,0];e.clearColor(t[0],t[1],t[2],t[3]),e.depthMask(!0),e.colorMask(!0,!0,!0,!0),e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT)};Yi.prototype.clearDepth=function(){var e=this.renderer.gl;e.clear(e.DEPTH_BUFFER_BIT)};Yi.prototype.clearColor=function(){var e=this.renderer.gl;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)};Yi.prototype.needsRefresh=function(){this.zr.refresh()};Yi.prototype.refresh=function(e){this._backgroundColor=e?R.parseColor(e):[0,0,0,0],this.renderer.clearColor=this._backgroundColor;for(var t=0;t<this.views.length;t++)this.views[t].prepareRender(this.renderer);this._doRender(!1),this._trackAndClean();for(var t=0;t<this._viewsToDispose.length;t++)this._viewsToDispose[t].dispose(this.renderer);this._viewsToDispose.length=0,this._startAccumulating()};Yi.prototype.renderToCanvas=function(e){this._startAccumulating(!0),e.drawImage(this.dom,0,0,e.canvas.width,e.canvas.height)};Yi.prototype._doRender=function(e){this.clear(),this.renderer.saveViewport();for(var t=0;t<this.views.length;t++)this.views[t].render(this.renderer,e);this.renderer.restoreViewport()};Yi.prototype._stopAccumulating=function(){this._accumulatingId=0,clearTimeout(this._accumulatingTimeout)};var lG=1;Yi.prototype._startAccumulating=function(e){var t=this;this._stopAccumulating();for(var i=!1,r=0;r<this.views.length;r++)i=this.views[r].needsAccumulate()||i;if(!i)return;function n(a){if(!(!t._accumulatingId||a!==t._accumulatingId)){for(var o=!0,s=0;s<t.views.length;s++)o=t.views[s].isAccumulateFinished()&&i;o||(t._doRender(!0),e?n(a):ff(function(){n(a)}))}}this._accumulatingId=lG++,e?n(t._accumulatingId):this._accumulatingTimeout=setTimeout(function(){n(t._accumulatingId)},50)};Yi.prototype._trackAndClean=function(){var e=[],t=[];this._textureList&&(l_(this._textureList),l_(this._geometriesList));for(var i=0;i<this.views.length;i++)cG(this.views[i].scene,e,t);this._textureList&&(c_(this.renderer,this._textureList),c_(this.renderer,this._geometriesList)),this._textureList=e,this._geometriesList=t};function l_(e){for(var t=0;t<e.length;t++)e[t].__used__=0}function c_(e,t){for(var i=0;i<t.length;i++)t[i].__used__||t[i].dispose(e)}function s_(e,t){e.__used__=e.__used__||0,e.__used__++,e.__used__===1&&t.push(e)}function cG(e,t,i){var r,n;e.traverse(function(o){if(o.isRenderable()){var s=o.geometry,l=o.material;if(l!==r)for(var c=l.getTextureUniforms(),d=0;d<c.length;d++){var u=c[d],h=l.uniforms[u].value;if(h){if(h instanceof qe)s_(h,t);else if(h instanceof Array)for(var m=0;m<h.length;m++)h[m]instanceof qe&&s_(h[m],t)}}s!==n&&s_(s,i),r=l,n=s}});for(var a=0;a<e.lights.length;a++)e.lights[a].cubemap&&s_(e.lights[a].cubemap,t)}Yi.prototype.dispose=function(){this._disposed||(this._stopAccumulating(),this._textureList&&(l_(this._textureList),l_(this._geometriesList),c_(this.renderer,this._textureList),c_(this.renderer,this._geometriesList)),this.zr.off("globalout",this.onglobalout),this._disposed=!0)};Yi.prototype.onmousedown=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY);t&&(this._dispatchEvent("mousedown",e,t),this._dispatchDataEvent("mousedown",e,t)),this._downX=e.offsetX,this._downY=e.offsetY}};Yi.prototype.onmousemove=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY),i=t&&t.target,r=this._hovered;this._hovered=t,r&&i!==r.target&&(r.relatedTarget=i,this._dispatchEvent("mouseout",e,r),this.zr.setCursorStyle("default")),this._dispatchEvent("mousemove",e,t),t&&(this.zr.setCursorStyle("pointer"),(!r||i!==r.target)&&this._dispatchEvent("mouseover",e,t)),this._dispatchDataEvent("mousemove",e,t)}};Yi.prototype.onmouseup=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY);t&&(this._dispatchEvent("mouseup",e,t),this._dispatchDataEvent("mouseup",e,t)),this._upX=e.offsetX,this._upY=e.offsetY}};Yi.prototype.onclick=Yi.prototype.dblclick=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){var t=this._upX-this._downX,i=this._upY-this._downY;if(!(Math.sqrt(t*t+i*i)>20)){e=e.event;var r=this.pickObject(e.offsetX,e.offsetY);r&&(this._dispatchEvent(e.type,e,r),this._dispatchDataEvent(e.type,e,r));var n=this._clickToSetFocusPoint(e);if(n){var a=n.view.setDOFFocusOnPoint(n.distance);a&&this.zr.refresh()}}}};Yi.prototype._clickToSetFocusPoint=function(e){for(var t=this.renderer,i=t.viewport,r=this.views.length-1;r>=0;r--){var n=this.views[r];if(n.hasDOF()&&n.containPoint(e.offsetX,e.offsetY)){this._picking.scene=n.scene,this._picking.camera=n.camera,t.viewport=n.viewport;var a=this._picking.pick(e.offsetX,e.offsetY,!0);if(a)return a.view=n,a}}t.viewport=i};Yi.prototype.onglobalout=function(e){var t=this._hovered;t&&this._dispatchEvent("mouseout",e,{target:t.target})};Yi.prototype.pickObject=function(e,t){for(var i=[],r=this.renderer,n=r.viewport,a=0;a<this.views.length;a++){var o=this.views[a];o.containPoint(e,t)&&(this._picking.scene=o.scene,this._picking.camera=o.camera,r.viewport=o.viewport,this._picking.pickAll(e,t,i))}return r.viewport=n,i.sort(function(s,l){return s.distance-l.distance}),i[0]};Yi.prototype._dispatchEvent=function(e,t,i){i||(i={});var r=i.target;for(i.cancelBubble=!1,i.event=t,i.type=e,i.offsetX=t.offsetX,i.offsetY=t.offsetY;r&&(r.trigger(e,i),r=r.getParent(),!i.cancelBubble););this._dispatchToView(e,i)};Yi.prototype._dispatchDataEvent=function(e,t,i){var r=i&&i.target,n=r&&r.dataIndex,a=r&&r.seriesIndex,o=r&&r.eventData,s=!1,l=this._zrEventProxy;l.x=t.offsetX,l.y=t.offsetY,l.update();var c={target:l};let d=$i.getECData(l);e==="mousemove"&&(n!=null?n!==this._lastDataIndex&&(parseInt(this._lastDataIndex,10)>=0&&(d.dataIndex=this._lastDataIndex,d.seriesIndex=this._lastSeriesIndex,this.zr.handler.dispatchToElement(c,"mouseout",t)),s=!0):o!=null&&o!==this._lastEventData&&(this._lastEventData!=null&&(d.eventData=this._lastEventData,this.zr.handler.dispatchToElement(c,"mouseout",t)),s=!0),this._lastEventData=o,this._lastDataIndex=n,this._lastSeriesIndex=a),d.eventData=o,d.dataIndex=n,d.seriesIndex=a,(o!=null||parseInt(n,10)>=0&&parseInt(a,10)>=0)&&(this.zr.handler.dispatchToElement(c,e,t),s&&this.zr.handler.dispatchToElement(c,"mouseover",t))};Yi.prototype._dispatchToView=function(e,t){for(var i=0;i<this.views.length;i++)this.views[i].containPoint(t.offsetX,t.offsetY)&&this.views[i].trigger(e,t)};Object.assign(Yi.prototype,fh);var Y1=Yi;var dG=["bar3D","line3D","map3D","scatter3D","surface","lines3D","scatterGL","scatter3D"];function gf(e,t){if(e&&e[t]&&(e[t].normal||e[t].emphasis)){var i=e[t].normal,r=e[t].emphasis;i&&(e[t]=i),r&&(e.emphasis=e.emphasis||{},e.emphasis[t]=r)}}function uG(e){gf(e,"itemStyle"),gf(e,"lineStyle"),gf(e,"areaStyle"),gf(e,"label")}function d_(e){e&&(e instanceof Array||(e=[e]),Ee.each(e,function(t){if(t.axisLabel){var i=t.axisLabel;Object.assign(i,i.textStyle),i.textStyle=null}}))}function jN(e){Ee.each(e.series,function(t){Ee.indexOf(dG,t.type)>=0&&(uG(t),t.coordinateSystem==="mapbox"&&(t.coordinateSystem="mapbox3D",e.mapbox3D=e.mapbox))}),d_(e.xAxis3D),d_(e.yAxis3D),d_(e.zAxis3D),d_(e.grid3D),gf(e.geo3D)}function WN(e){this._layers={},this._zr=e}WN.prototype.update=function(e,t){var i=this,r=t.getZr();if(!r.getWidth()||!r.getHeight()){console.warn("Dom has no width or height");return}function n(s){r.setSleepAfterStill(0);var l;s.coordinateSystem&&s.coordinateSystem.model,l=s.get("zlevel");var c=i._layers,d=c[l];if(!d){if(d=c[l]=new Y1("gl-"+l,r),r.painter.isSingleCanvas()){d.virtual=!0;var u=new qr.Image({z:1e4,style:{image:d.renderer.canvas},silent:!0});d.__hostImage=u,r.add(u)}r.painter.insertLayer(l,d)}return d.__hostImage&&d.__hostImage.setStyle({width:d.renderer.getWidth(),height:d.renderer.getHeight()}),d}function a(s,l){s&&s.traverse(function(c){c.isRenderable&&c.isRenderable()&&(c.ignorePicking=c.$ignorePicking!=null?c.$ignorePicking:l)})}for(var o in this._layers)this._layers[o].removeViewsAll();e.eachComponent(function(s,l){if(s!=="series"){var c=t.getViewOfComponentModel(l),d=l.coordinateSystem;if(c.__ecgl__){var u;if(d){if(!d.viewGL){console.error("Can't find viewGL in coordinateSystem of component "+l.id);return}u=d.viewGL}else{if(!l.viewGL){console.error("Can't find viewGL of component "+l.id);return}u=d.viewGL}var u=d.viewGL,h=n(l);h.addView(u),c.afterRender&&c.afterRender(l,e,t,h),a(c.groupGL,l.get("silent"))}}}),e.eachSeries(function(s){var l=t.getViewOfSeriesModel(s),c=s.coordinateSystem;if(l.__ecgl__){if(c&&!c.viewGL&&!l.viewGL){console.error("Can't find viewGL of series "+l.id);return}var d=c&&c.viewGL||l.viewGL,u=n(s);u.addView(d),l.afterRender&&l.afterRender(s,e,t,u),a(l.groupGL,s.get("silent"))}})};mI(function(e){var t=e.getZr(),i=t.painter.dispose;t.painter.dispose=function(){this.eachOtherLayer(function(r){r instanceof Y1&&r.dispose()}),i.call(this)},t.painter.getRenderedCanvas=function(r){if(r=r||{},this._singleCanvas)return this._layers[0].dom;var n=document.createElement("canvas"),a=r.pixelRatio||this.dpr;n.width=this.getWidth()*a,n.height=this.getHeight()*a;var o=n.getContext("2d");o.dpr=a,o.clearRect(0,0,n.width,n.height),r.backgroundColor&&(o.fillStyle=r.backgroundColor,o.fillRect(0,0,n.width,n.height));var s=this.storage.getDisplayList(!0),l={},c,d=this;function u(p,g){var v=d._zlevelList;p==null&&(p=-1/0);for(var b,_=0;_<v.length;_++){var x=v[_],w=d._layers[x];if(!w.__builtin__&&x>p&&x<g){b=w;break}}b&&b.renderToCanvas&&(o.save(),b.renderToCanvas(o),o.restore())}for(var h={ctx:o},m=0;m<s.length;m++){var f=s[m];f.zlevel!==c&&(u(c,f.zlevel),c=f.zlevel),this._doPaintEl(f,h,!0,null,l)}return u(c,1/0),n}});pI(function(e,t){var i=t.getZr(),r=i.__egl=i.__egl||new WN(i);r.update(e,t)});hI(jN);var gc={defaultOption:{viewControl:{projection:"perspective",autoRotate:!1,autoRotateDirection:"cw",autoRotateSpeed:10,autoRotateAfterStill:3,damping:.8,rotateSensitivity:1,zoomSensitivity:1,panSensitivity:1,panMouseButton:"middle",rotateMouseButton:"left",distance:150,minDistance:40,maxDistance:400,orthographicSize:150,maxOrthographicSize:400,minOrthographicSize:20,center:[0,0,0],alpha:0,beta:0,minAlpha:-90,maxAlpha:90}},setView:function(e){e=e||{},this.option.viewControl=this.option.viewControl||{},e.alpha!=null&&(this.option.viewControl.alpha=e.alpha),e.beta!=null&&(this.option.viewControl.beta=e.beta),e.distance!=null&&(this.option.viewControl.distance=e.distance),e.center!=null&&(this.option.viewControl.center=e.center)}};var Io={defaultOption:{postEffect:{enable:!1,bloom:{enable:!0,intensity:.1},depthOfField:{enable:!1,focalRange:20,focalDistance:50,blurRadius:10,fstop:2.8,quality:"medium"},screenSpaceAmbientOcclusion:{enable:!1,radius:2,quality:"medium",intensity:1},screenSpaceReflection:{enable:!1,quality:"medium",maxRoughness:.8},colorCorrection:{enable:!0,exposure:0,brightness:0,contrast:1,saturation:1,lookupTexture:""},edge:{enable:!1},FXAA:{enable:!1}},temporalSuperSampling:{enable:"auto"}}};var ko={defaultOption:{light:{main:{shadow:!1,shadowQuality:"high",color:"#fff",intensity:1,alpha:0,beta:0},ambient:{color:"#fff",intensity:.2},ambientCubemap:{texture:null,exposure:1,diffuseIntensity:.5,specularIntensity:.5}}}};var u_=Eo.extend({type:"grid3D",dependencies:["xAxis3D","yAxis3D","zAxis3D"],defaultOption:{show:!0,zlevel:-10,left:0,top:0,width:"100%",height:"100%",environment:"auto",boxWidth:100,boxHeight:100,boxDepth:100,axisPointer:{show:!0,lineStyle:{color:"rgba(0, 0, 0, 0.8)",width:1},label:{show:!0,formatter:null,margin:8,textStyle:{fontSize:14,color:"#fff",backgroundColor:"rgba(0,0,0,0.5)",padding:3,borderRadius:3}}},axisLine:{show:!0,lineStyle:{color:"#333",width:2,type:"solid"}},axisTick:{show:!0,inside:!1,length:3,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,margin:8,textStyle:{fontSize:12}},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}},light:{main:{alpha:30,beta:40},ambient:{intensity:.4}},viewControl:{alpha:20,beta:40,autoRotate:!1,distance:200,minDistance:40,maxDistance:400}}});Ee.merge(u_.prototype,gc);Ee.merge(u_.prototype,Io);Ee.merge(u_.prototype,ko);var qN=u_;var vf=ht.firstNotNull,$N={left:0,middle:1,right:2};function XN(e){return e instanceof Array||(e=[e,e]),e}var YN=Ui.extend(function(){return{zr:null,viewGL:null,_center:new Se,minDistance:.5,maxDistance:1.5,maxOrthographicSize:300,minOrthographicSize:30,minAlpha:-90,maxAlpha:90,minBeta:-1/0,maxBeta:1/0,autoRotateAfterStill:0,autoRotateDirection:"cw",autoRotateSpeed:60,damping:.8,rotateSensitivity:1,zoomSensitivity:1,panSensitivity:1,panMouseButton:"middle",rotateMouseButton:"left",_mode:"rotate",_camera:null,_needsUpdate:!1,_rotating:!1,_phi:0,_theta:0,_mouseX:0,_mouseY:0,_rotateVelocity:new rn,_panVelocity:new rn,_distance:500,_zoomSpeed:0,_stillTimeout:0,_animators:[]}},function(){["_mouseDownHandler","_mouseWheelHandler","_mouseMoveHandler","_mouseUpHandler","_pinchHandler","_contextMenuHandler","_update"].forEach(function(e){this[e]=this[e].bind(this)},this)},{init:function(){var e=this.zr;e&&(e.on("mousedown",this._mouseDownHandler),e.on("globalout",this._mouseUpHandler),e.on("mousewheel",this._mouseWheelHandler),e.on("pinch",this._pinchHandler),e.animation.on("frame",this._update),e.dom.addEventListener("contextmenu",this._contextMenuHandler))},dispose:function(){var e=this.zr;e&&(e.off("mousedown",this._mouseDownHandler),e.off("mousemove",this._mouseMoveHandler),e.off("mouseup",this._mouseUpHandler),e.off("mousewheel",this._mouseWheelHandler),e.off("pinch",this._pinchHandler),e.off("globalout",this._mouseUpHandler),e.dom.removeEventListener("contextmenu",this._contextMenuHandler),e.animation.off("frame",this._update)),this.stopAllAnimation()},getDistance:function(){return this._distance},setDistance:function(e){this._distance=e,this._needsUpdate=!0},getOrthographicSize:function(){return this._orthoSize},setOrthographicSize:function(e){this._orthoSize=e,this._needsUpdate=!0},getAlpha:function(){return this._theta/Math.PI*180},getBeta:function(){return-this._phi/Math.PI*180},getCenter:function(){return this._center.toArray()},setAlpha:function(e){e=Math.max(Math.min(this.maxAlpha,e),this.minAlpha),this._theta=e/180*Math.PI,this._needsUpdate=!0},setBeta:function(e){e=Math.max(Math.min(this.maxBeta,e),this.minBeta),this._phi=-e/180*Math.PI,this._needsUpdate=!0},setCenter:function(e){this._center.setArray(e)},setViewGL:function(e){this.viewGL=e},getCamera:function(){return this.viewGL.camera},setFromViewControlModel:function(e,t){t=t||{};var i=t.baseDistance||0,r=t.baseOrthoSize||1,n=e.get("projection");n!=="perspective"&&n!=="orthographic"&&n!=="isometric"&&(n="perspective"),this._projection=n,this.viewGL.setProjection(n);var a=e.get("distance")+i,o=e.get("orthographicSize")+r;[["damping",.8],["autoRotate",!1],["autoRotateAfterStill",3],["autoRotateDirection","cw"],["autoRotateSpeed",10],["minDistance",30],["maxDistance",400],["minOrthographicSize",30],["maxOrthographicSize",300],["minAlpha",-90],["maxAlpha",90],["minBeta",-1/0],["maxBeta",1/0],["rotateSensitivity",1],["zoomSensitivity",1],["panSensitivity",1],["panMouseButton","left"],["rotateMouseButton","middle"]].forEach(function(h){this[h[0]]=vf(e.get(h[0]),h[1])},this),this.minDistance+=i,this.maxDistance+=i,this.minOrthographicSize+=r,this.maxOrthographicSize+=r;var s=e.ecModel,l={};["animation","animationDurationUpdate","animationEasingUpdate"].forEach(function(h){l[h]=vf(e.get(h),s&&s.get(h))});var c=vf(t.alpha,e.get("alpha"))||0,d=vf(t.beta,e.get("beta"))||0,u=vf(t.center,e.get("center"))||[0,0,0];l.animation&&l.animationDurationUpdate>0&&this._notFirst?this.animateTo({alpha:c,beta:d,center:u,distance:a,orthographicSize:o,easing:l.animationEasingUpdate,duration:l.animationDurationUpdate}):(this.setDistance(a),this.setAlpha(c),this.setBeta(d),this.setCenter(u),this.setOrthographicSize(o)),this._notFirst=!0,this._validateProperties()},_validateProperties:function(){},animateTo:function(e){var t=this.zr,i=this,r={},n={};return e.distance!=null&&(r.distance=this.getDistance(),n.distance=e.distance),e.orthographicSize!=null&&(r.orthographicSize=this.getOrthographicSize(),n.orthographicSize=e.orthographicSize),e.alpha!=null&&(r.alpha=this.getAlpha(),n.alpha=e.alpha),e.beta!=null&&(r.beta=this.getBeta(),n.beta=e.beta),e.center!=null&&(r.center=this.getCenter(),n.center=e.center),this._addAnimator(t.animation.animate(r).when(e.duration||1e3,n).during(function(){r.alpha!=null&&i.setAlpha(r.alpha),r.beta!=null&&i.setBeta(r.beta),r.distance!=null&&i.setDistance(r.distance),r.center!=null&&i.setCenter(r.center),r.orthographicSize!=null&&i.setOrthographicSize(r.orthographicSize),i._needsUpdate=!0})).start(e.easing||"linear")},stopAllAnimation:function(){for(var e=0;e<this._animators.length;e++)this._animators[e].stop();this._animators.length=0},update:function(){this._needsUpdate=!0,this._update(20)},_isAnimating:function(){return this._animators.length>0},_update:function(e){if(this._rotating){var t=(this.autoRotateDirection==="cw"?1:-1)*this.autoRotateSpeed/180*Math.PI;this._phi-=t*e/1e3,this._needsUpdate=!0}else this._rotateVelocity.len()>0&&(this._needsUpdate=!0);(Math.abs(this._zoomSpeed)>.1||this._panVelocity.len()>0)&&(this._needsUpdate=!0),this._needsUpdate&&(e=Math.min(e,50),this._updateDistanceOrSize(e),this._updatePan(e),this._updateRotate(e),this._updateTransform(),this.getCamera().update(),this.zr&&this.zr.refresh(),this.trigger("update"),this._needsUpdate=!1)},_updateRotate:function(e){var t=this._rotateVelocity;this._phi=t.y*e/20+this._phi,this._theta=t.x*e/20+this._theta,this.setAlpha(this.getAlpha()),this.setBeta(this.getBeta()),this._vectorDamping(t,Math.pow(this.damping,e/16))},_updateDistanceOrSize:function(e){this._projection==="perspective"?this._setDistance(this._distance+this._zoomSpeed*e/20):this._setOrthoSize(this._orthoSize+this._zoomSpeed*e/20),this._zoomSpeed*=Math.pow(this.damping,e/16)},_setDistance:function(e){this._distance=Math.max(Math.min(e,this.maxDistance),this.minDistance)},_setOrthoSize:function(e){this._orthoSize=Math.max(Math.min(e,this.maxOrthographicSize),this.minOrthographicSize);var t=this.getCamera(),i=this._orthoSize,r=i/this.viewGL.viewport.height*this.viewGL.viewport.width;t.left=-r/2,t.right=r/2,t.top=i/2,t.bottom=-i/2},_updatePan:function(e){var t=this._panVelocity,i=this._distance,r=this.getCamera(),n=r.worldTransform.y,a=r.worldTransform.x;this._center.scaleAndAdd(a,-t.x*i/200).scaleAndAdd(n,-t.y*i/200),this._vectorDamping(t,0)},_updateTransform:function(){var e=this.getCamera(),t=new Se,i=this._theta+Math.PI/2,r=this._phi+Math.PI/2,n=Math.sin(i);t.x=n*Math.cos(r),t.y=-Math.cos(i),t.z=n*Math.sin(r),e.position.copy(this._center).scaleAndAdd(t,this._distance),e.rotation.identity().rotateY(-this._phi).rotateX(-this._theta)},_startCountingStill:function(){clearTimeout(this._stillTimeout);var e=this.autoRotateAfterStill,t=this;!isNaN(e)&&e>0&&(this._stillTimeout=setTimeout(function(){t._rotating=!0},e*1e3))},_vectorDamping:function(e,t){var i=e.len();i=i*t,i<1e-4&&(i=0),e.normalize().scale(i)},_decomposeTransform:function(){if(this.getCamera()){this.getCamera().updateWorldTransform();var e=this.getCamera().worldTransform.z,t=Math.asin(e.y),i=Math.atan2(e.x,e.z);this._theta=t,this._phi=-i,this.setBeta(this.getBeta()),this.setAlpha(this.getAlpha()),this.getCamera().aspect?this._setDistance(this.getCamera().position.dist(this._center)):this._setOrthoSize(this.getCamera().top-this.getCamera().bottom)}},_mouseDownHandler:function(e){if(!e.target&&!this._isAnimating()){var t=e.offsetX,i=e.offsetY;this.viewGL&&!this.viewGL.containPoint(t,i)||(this.zr.on("mousemove",this._mouseMoveHandler),this.zr.on("mouseup",this._mouseUpHandler),e.event.targetTouches?e.event.targetTouches.length===1&&(this._mode="rotate"):e.event.button===$N[this.rotateMouseButton]?this._mode="rotate":e.event.button===$N[this.panMouseButton]?this._mode="pan":this._mode="",this._rotateVelocity.set(0,0),this._rotating=!1,this.autoRotate&&this._startCountingStill(),this._mouseX=e.offsetX,this._mouseY=e.offsetY)}},_mouseMoveHandler:function(e){if(!(e.target&&e.target.__isGLToZRProxy)&&!this._isAnimating()){var t=XN(this.panSensitivity),i=XN(this.rotateSensitivity);this._mode==="rotate"?(this._rotateVelocity.y=(e.offsetX-this._mouseX)/this.zr.getHeight()*2*i[0],this._rotateVelocity.x=(e.offsetY-this._mouseY)/this.zr.getWidth()*2*i[1]):this._mode==="pan"&&(this._panVelocity.x=(e.offsetX-this._mouseX)/this.zr.getWidth()*t[0]*400,this._panVelocity.y=(-e.offsetY+this._mouseY)/this.zr.getHeight()*t[1]*400),this._mouseX=e.offsetX,this._mouseY=e.offsetY,e.event.preventDefault()}},_mouseWheelHandler:function(e){if(!this._isAnimating()){var t=e.event.wheelDelta||-e.event.detail;this._zoomHandler(e,t)}},_pinchHandler:function(e){this._isAnimating()||(this._zoomHandler(e,e.pinchScale>1?1:-1),this._mode="")},_zoomHandler:function(e,t){if(t!==0){var i=e.offsetX,r=e.offsetY;if(!(this.viewGL&&!this.viewGL.containPoint(i,r))){var n;this._projection==="perspective"?n=Math.max(Math.max(Math.min(this._distance-this.minDistance,this.maxDistance-this._distance))/20,.5):n=Math.max(Math.max(Math.min(this._orthoSize-this.minOrthographicSize,this.maxOrthographicSize-this._orthoSize))/20,.5),this._zoomSpeed=(t>0?-1:1)*n*this.zoomSensitivity,this._rotating=!1,this.autoRotate&&this._mode==="rotate"&&this._startCountingStill(),e.event.preventDefault()}}},_mouseUpHandler:function(){this.zr.off("mousemove",this._mouseMoveHandler),this.zr.off("mouseup",this._mouseUpHandler)},_isRightMouseButtonUsed:function(){return this.rotateMouseButton==="right"||this.panMouseButton==="right"},_contextMenuHandler:function(e){this._isRightMouseButtonUsed()&&e.preventDefault()},_addAnimator:function(e){var t=this._animators;return t.push(e),e.done(function(){var i=t.indexOf(e);i>=0&&t.splice(i,1)}),e}});Object.defineProperty(YN.prototype,"autoRotate",{get:function(e){return this._autoRotate},set:function(e){this._autoRotate=e,this._rotating=e}});var vc=YN;var Is={convertToDynamicArray:function(e){e&&this.resetOffset();var t=this.attributes;for(var i in t)e||!t[i].value?t[i].value=[]:t[i].value=Array.prototype.slice.call(t[i].value);e||!this.indices?this.indices=[]:this.indices=Array.prototype.slice.call(this.indices)},convertToTypedArray:function(){var e=this.attributes;for(var t in e)e[t].value&&e[t].value.length>0?e[t].value=new Float32Array(e[t].value):e[t].value=null;this.indices&&this.indices.length>0&&(this.indices=this.vertexCount>65535?new Uint32Array(this.indices):new Uint16Array(this.indices)),this.dirty()}};var ZN={vec2:gt,vec3:Y,vec4:We,mat2:br,mat2d:Mr,mat3:qt,mat4:ke,quat:xt};var ri=ZN;var Z1=ri.vec3,KN=[[0,0],[1,1]],QN=Lt.extend(function(){return{segmentScale:1,dynamic:!0,useNativeLine:!0,attributes:{position:new Lt.Attribute("position","float",3,"POSITION"),positionPrev:new Lt.Attribute("positionPrev","float",3),positionNext:new Lt.Attribute("positionNext","float",3),prevPositionPrev:new Lt.Attribute("prevPositionPrev","float",3),prevPosition:new Lt.Attribute("prevPosition","float",3),prevPositionNext:new Lt.Attribute("prevPositionNext","float",3),offset:new Lt.Attribute("offset","float",1),color:new Lt.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._triangleOffset=0,this._itemVertexOffsets=[]},setVertexCount:function(e){var t=this.attributes;this.vertexCount!==e&&(t.position.init(e),t.color.init(e),this.useNativeLine||(t.positionPrev.init(e),t.positionNext.init(e),t.offset.init(e)),e>65535?this.indices instanceof Uint16Array&&(this.indices=new Uint32Array(this.indices)):this.indices instanceof Uint32Array&&(this.indices=new Uint16Array(this.indices)))},setTriangleCount:function(e){this.triangleCount!==e&&(e===0?this.indices=null:this.indices=this.vertexCount>65535?new Uint32Array(e*3):new Uint16Array(e*3))},_getCubicCurveApproxStep:function(e,t,i,r){var n=Z1.dist(e,t)+Z1.dist(i,t)+Z1.dist(r,i),a=1/(n+1)*this.segmentScale;return a},getCubicCurveVertexCount:function(e,t,i,r){var n=this._getCubicCurveApproxStep(e,t,i,r),a=Math.ceil(1/n);return this.useNativeLine?a*2:a*2+2},getCubicCurveTriangleCount:function(e,t,i,r){var n=this._getCubicCurveApproxStep(e,t,i,r),a=Math.ceil(1/n);return this.useNativeLine?0:a*2},getLineVertexCount:function(){return this.getPolylineVertexCount(KN)},getLineTriangleCount:function(){return this.getPolylineTriangleCount(KN)},getPolylineVertexCount:function(e){var t;if(typeof e=="number")t=e;else{var i=typeof e[0]!="number";t=i?e.length:e.length/3}return this.useNativeLine?(t-1)*2:(t-1)*2+2},getPolylineTriangleCount:function(e){var t;if(typeof e=="number")t=e;else{var i=typeof e[0]!="number";t=i?e.length:e.length/3}return this.useNativeLine?0:Math.max(t-1,0)*2},addCubicCurve:function(e,t,i,r,n,a){a==null&&(a=1);for(var o=e[0],s=e[1],l=e[2],c=t[0],d=t[1],u=t[2],h=i[0],m=i[1],f=i[2],p=r[0],g=r[1],v=r[2],b=this._getCubicCurveApproxStep(e,t,i,r),_=b*b,x=_*b,w=3*b,y=3*_,M=6*_,T=6*x,C=o-c*2+h,N=s-d*2+m,D=l-u*2+f,k=(c-h)*3-o+p,U=(d-m)*3-s+g,F=(u-f)*3-l+v,H=o,V=s,Q=l,$=(c-o)*w+C*y+k*x,ee=(d-s)*w+N*y+U*x,re=(u-l)*w+D*y+F*x,we=C*M+k*T,te=N*M+U*T,oe=D*M+F*T,pe=k*T,ue=U*T,_e=F*T,ce=0,fe=0,be=Math.ceil(1/b),ge=new Float32Array((be+1)*3),ge=[],Oe=0,fe=0;fe<be+1;fe++)ge[Oe++]=H,ge[Oe++]=V,ge[Oe++]=Q,H+=$,V+=ee,Q+=re,$+=we,ee+=te,re+=oe,we+=pe,te+=ue,oe+=_e,ce+=b,ce>1&&(H=$>0?Math.min(H,p):Math.max(H,p),V=ee>0?Math.min(V,g):Math.max(V,g),Q=re>0?Math.min(Q,v):Math.max(Q,v));return this.addPolyline(ge,n,a)},addLine:function(e,t,i,r){return this.addPolyline([e,t],i,r)},addPolyline:function(e,t,i,r,n){if(e.length){var a=typeof e[0]!="number";if(n==null&&(n=a?e.length:e.length/3),!(n<2)){r==null&&(r=0),i==null&&(i=1),this._itemVertexOffsets.push(this._vertexOffset);var a=typeof e[0]!="number",o=a?typeof t[0]!="number":t.length/4===n,s=this.attributes.position,l=this.attributes.positionPrev,c=this.attributes.positionNext,d=this.attributes.color,u=this.attributes.offset,h=this.indices,m=this._vertexOffset,f,p;i=Math.max(i,.01);for(var g=r;g<n;g++){if(a)f=e[g],o?p=t[g]:p=t;else{var v=g*3;if(f=f||[],f[0]=e[v],f[1]=e[v+1],f[2]=e[v+2],o){var b=g*4;p=p||[],p[0]=t[b],p[1]=t[b+1],p[2]=t[b+2],p[3]=t[b+3]}else p=t}if(this.useNativeLine?g>1&&(s.copy(m,m-1),d.copy(m,m-1),m++):(g<n-1&&(l.set(m+2,f),l.set(m+3,f)),g>0&&(c.set(m-2,f),c.set(m-1,f)),s.set(m,f),s.set(m+1,f),d.set(m,p),d.set(m+1,p),u.set(m,i/2),u.set(m+1,-i/2),m+=2),this.useNativeLine)d.set(m,p),s.set(m,f),m++;else if(g>0){var _=this._triangleOffset*3,h=this.indices;h[_]=m-4,h[_+1]=m-3,h[_+2]=m-2,h[_+3]=m-3,h[_+4]=m-1,h[_+5]=m-2,this._triangleOffset+=2}}if(!this.useNativeLine){var x=this._vertexOffset,w=this._vertexOffset+n*2;l.copy(x,x+2),l.copy(x+1,x+3),c.copy(w-1,w-3),c.copy(w-2,w-4)}return this._vertexOffset=m,this._vertexOffset}}},setItemColor:function(e,t){for(var i=this._itemVertexOffsets[e],r=e<this._itemVertexOffsets.length-1?this._itemVertexOffsets[e+1]:this._vertexOffset,n=i;n<r;n++)this.attributes.color.set(n,t);this.dirty("color")},currentTriangleOffset:function(){return this._triangleOffset},currentVertexOffset:function(){return this._vertexOffset}});Ee.defaults(QN.prototype,Is);var Da=QN;function h_(e,t,i,r,n,a,o){this._zr=e,this._x=0,this._y=0,this._rowHeight=0,this.width=r,this.height=n,this.offsetX=t,this.offsetY=i,this.dpr=o,this.gap=a}h_.prototype={constructor:h_,clear:function(){this._x=0,this._y=0,this._rowHeight=0},add:function(e,t,i){var r=e.getBoundingRect();t==null&&(t=r.width),i==null&&(i=r.height),t*=this.dpr,i*=this.dpr,this._fitElement(e,t,i);var n=this._x,a=this._y,o=this.width*this.dpr,s=this.height*this.dpr,l=this.gap;if(n+t+l>o&&(n=this._x=0,a+=this._rowHeight+l,this._y=a,this._rowHeight=0),this._x+=t+l,this._rowHeight=Math.max(this._rowHeight,i),a+i+l>s)return null;e.x+=this.offsetX*this.dpr+n,e.y+=this.offsetY*this.dpr+a,this._zr.add(e);var c=[this.offsetX/this.width,this.offsetY/this.height],d=[[n/o+c[0],a/s+c[1]],[(n+t)/o+c[0],(a+i)/s+c[1]]];return d},_fitElement:function(e,t,i){var r=e.getBoundingRect(),n=t/r.width,a=i/r.height;e.x=-r.x*n,e.y=-r.y*a,e.scaleX=n,e.scaleY=a,e.update()}};function JN(e){e=e||{},e.width=e.width||512,e.height=e.height||512,e.devicePixelRatio=e.devicePixelRatio||1,e.gap=e.gap==null?2:e.gap;var t=document.createElement("canvas");t.width=e.width*e.devicePixelRatio,t.height=e.height*e.devicePixelRatio,this._canvas=t,this._texture=new ct({image:t,flipY:!1});var i=this;this._zr=uI.init(t);var r=this._zr.refreshImmediately;this._zr.refreshImmediately=function(){r.call(this),i._texture.dirty(),i.onupdate&&i.onupdate()},this._dpr=e.devicePixelRatio,this._coords={},this.onupdate=e.onupdate,this._gap=e.gap,this._textureAtlasNodes=[new h_(this._zr,0,0,e.width,e.height,this._gap,this._dpr)],this._nodeWidth=e.width,this._nodeHeight=e.height,this._currentNodeIdx=0}JN.prototype={clear:function(){for(var e=0;e<this._textureAtlasNodes.length;e++)this._textureAtlasNodes[e].clear();this._currentNodeIdx=0,this._zr.clear(),this._coords={}},getWidth:function(){return this._width},getHeight:function(){return this._height},getTexture:function(){return this._texture},getDevicePixelRatio:function(){return this._dpr},getZr:function(){return this._zr},_getCurrentNode:function(){return this._textureAtlasNodes[this._currentNodeIdx]},_expand:function(){if(this._currentNodeIdx++,this._textureAtlasNodes[this._currentNodeIdx])return this._textureAtlasNodes[this._currentNodeIdx];var e=4096/this._dpr,t=this._textureAtlasNodes,i=t.length,r=i*this._nodeWidth%e,n=Math.floor(i*this._nodeWidth/e)*this._nodeHeight;if(!(n>=e)){var a=(r+this._nodeWidth)*this._dpr,o=(n+this._nodeHeight)*this._dpr;try{this._zr.resize({width:a,height:o})}catch{this._canvas.width=a,this._canvas.height=o}var s=new h_(this._zr,r,n,this._nodeWidth,this._nodeHeight,this._gap,this._dpr);return this._textureAtlasNodes.push(s),s}},add:function(e,t,i){if(this._coords[e.id])return this._coords[e.id];var r=this._getCurrentNode().add(e,t,i);if(!r){var n=this._expand();if(!n)return;r=n.add(e,t,i)}return this._coords[e.id]=r,r},getCoordsScale:function(){var e=this._dpr;return[this._nodeWidth/this._canvas.width*e,this._nodeHeight/this._canvas.height*e]},getCoords:function(e){return this._coords[e]},dispose:function(){this._zr.dispose()}};var _f=JN;function K1(){}K1.prototype={constructor:K1,setScene:function(e){this._scene=e,this._skybox&&this._skybox.attachScene(this._scene)},initLight:function(e){this._lightRoot=e,this.mainLight=new R.DirectionalLight({shadowBias:.005}),this.ambientLight=new R.AmbientLight,e.add(this.mainLight),e.add(this.ambientLight)},dispose:function(){this._lightRoot&&(this._lightRoot.remove(this.mainLight),this._lightRoot.remove(this.ambientLight))},updateLight:function(e){var t=this.mainLight,i=this.ambientLight,r=e.getModel("light"),n=r.getModel("main"),a=r.getModel("ambient");t.intensity=n.get("intensity"),i.intensity=a.get("intensity"),t.color=R.parseColor(n.get("color")).slice(0,3),i.color=R.parseColor(a.get("color")).slice(0,3);var o=n.get("alpha")||0,s=n.get("beta")||0;t.position.setArray(R.directionFromAlphaBeta(o,s)),t.lookAt(R.Vector3.ZERO),t.castShadow=n.get("shadow"),t.shadowResolution=R.getShadowResolution(n.get("shadowQuality"))},updateAmbientCubemap:function(e,t,i){var r=t.getModel("light.ambientCubemap"),n=r.get("texture");if(n){this._cubemapLightsCache=this._cubemapLightsCache||{};var a=this._cubemapLightsCache[n];if(!a){var o=this;a=this._cubemapLightsCache[n]=R.createAmbientCubemap(r.option,e,i,function(){o._isSkyboxFromAmbientCubemap&&o._skybox.setEnvironmentMap(a.specular.cubemap),i.getZr().refresh()})}this._lightRoot.add(a.diffuse),this._lightRoot.add(a.specular),this._currentCubemapLights=a}else this._currentCubemapLights&&(this._lightRoot.remove(this._currentCubemapLights.diffuse),this._lightRoot.remove(this._currentCubemapLights.specular),this._currentCubemapLights=null)},updateSkybox:function(e,t,i){var r=t.get("environment"),n=this;function a(){return n._skybox=n._skybox||new fc,n._skybox}var o=a();if(r&&r!=="none")if(r==="auto")if(this._isSkyboxFromAmbientCubemap=!0,this._currentCubemapLights){var s=this._currentCubemapLights.specular.cubemap;o.setEnvironmentMap(s),this._scene&&o.attachScene(this._scene),o.material.set("lod",3)}else this._skybox&&this._skybox.detachScene();else if(typeof r=="object"&&r.colorStops||typeof r=="string"&&Ss.parse(r)){this._isSkyboxFromAmbientCubemap=!1;var l=new R.Texture2D({anisotropic:8,flipY:!1});o.setEnvironmentMap(l);var c=l.image=document.createElement("canvas");c.width=c.height=16;var d=c.getContext("2d"),u=new qr.Rect({shape:{x:0,y:0,width:16,height:16},style:{fill:r}});i0(d,u),o.attachScene(this._scene)}else{this._isSkyboxFromAmbientCubemap=!1;var l=R.loadTexture(r,i,{anisotropic:8,flipY:!1});o.setEnvironmentMap(l),o.attachScene(this._scene)}else this._skybox&&this._skybox.detachScene(this._scene),this._skybox=null;var h=t.coordinateSystem;if(this._skybox)if(h&&h.viewGL&&r!=="auto"&&!(r.match&&r.match(/.hdr$/))){var m=h.viewGL.isLinearSpace()?"define":"undefine";this._skybox.material[m]("fragment","SRGB_DECODE")}else this._skybox.material.undefine("fragment","SRGB_DECODE")}};var No=K1;var zd=ri.vec3,eP=Lt.extend(function(){return{segmentScale:1,useNativeLine:!0,attributes:{position:new Lt.Attribute("position","float",3,"POSITION"),normal:new Lt.Attribute("normal","float",3,"NORMAL"),color:new Lt.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setQuadCount:function(e){var t=this.attributes,i=this.getQuadVertexCount()*e,r=this.getQuadTriangleCount()*e;this.vertexCount!==i&&(t.position.init(i),t.normal.init(i),t.color.init(i)),this.triangleCount!==r&&(this.indices=i>65535?new Uint32Array(r*3):new Uint16Array(r*3))},getQuadVertexCount:function(){return 4},getQuadTriangleCount:function(){return 2},addQuad:function(){var e=zd.create(),t=zd.create(),i=zd.create(),r=[0,3,1,3,2,1];return function(n,a){var o=this.attributes.position,s=this.attributes.normal,l=this.attributes.color;zd.sub(e,n[1],n[0]),zd.sub(t,n[2],n[1]),zd.cross(i,e,t),zd.normalize(i,i);for(var c=0;c<4;c++)o.set(this._vertexOffset+c,n[c]),l.set(this._vertexOffset+c,a),s.set(this._vertexOffset+c,i);for(var d=this._faceOffset*3,c=0;c<6;c++)this.indices[d+c]=r[c]+this._vertexOffset;this._vertexOffset+=4,this._faceOffset+=2}}()});Ee.defaults(eP.prototype,Is);var tP=eP;var Q1=ht.firstNotNull,hG={x:0,y:2,z:1};function mG(e,t,i,r){var n=[0,0,0],a=r<0?i.getExtentMin():i.getExtentMax();n[hG[i.dim]]=a,e.position.setArray(n),e.rotation.identity(),t.distance=-Math.abs(a),t.normal.set(0,0,0),i.dim==="x"?(e.rotation.rotateY(r*Math.PI/2),t.normal.x=-r):i.dim==="z"?(e.rotation.rotateX(-r*Math.PI/2),t.normal.y=-r):(r>0&&e.rotation.rotateY(Math.PI),t.normal.z=-r)}function m_(e,t,i){this.rootNode=new R.Node;var r=new R.Mesh({geometry:new Da({useNativeLine:!1}),material:t,castShadow:!1,ignorePicking:!0,$ignorePicking:!0,renderOrder:1}),n=new R.Mesh({geometry:new tP,material:i,castShadow:!1,culling:!1,ignorePicking:!0,$ignorePicking:!0,renderOrder:0});this.rootNode.add(n),this.rootNode.add(r),this.faceInfo=e,this.plane=new R.Plane,this.linesMesh=r,this.quadsMesh=n}m_.prototype.update=function(e,t,i){var r=e.coordinateSystem,n=[r.getAxis(this.faceInfo[0]),r.getAxis(this.faceInfo[1])],a=this.linesMesh.geometry,o=this.quadsMesh.geometry;a.convertToDynamicArray(!0),o.convertToDynamicArray(!0),this._updateSplitLines(a,n,e,i),this._udpateSplitAreas(o,n,e,i),a.convertToTypedArray(),o.convertToTypedArray();var s=r.getAxis(this.faceInfo[2]);mG(this.rootNode,this.plane,s,this.faceInfo[3])};m_.prototype._updateSplitLines=function(e,t,i,r){var n=r.getDevicePixelRatio();t.forEach(function(a,o){var s=a.model,l=t[1-o].getExtent();if(!a.scale.isBlank()){var c=s.getModel("splitLine",i.getModel("splitLine"));if(c.get("show")){var d=c.getModel("lineStyle"),u=d.get("color"),h=Q1(d.get("opacity"),1),m=Q1(d.get("width"),1);u=Ee.isArray(u)?u:[u];for(var f=a.getTicksCoords({tickModel:c}),p=0,g=0;g<f.length;g++){var v=f[g].coord,b=R.parseColor(u[p%u.length]);b[3]*=h;var _=[0,0,0],x=[0,0,0];_[o]=x[o]=v,_[1-o]=l[0],x[1-o]=l[1],e.addLine(_,x,b,m*n),p++}}}})};m_.prototype._udpateSplitAreas=function(e,t,i,r){t.forEach(function(n,a){var o=n.model,s=t[1-a].getExtent();if(!n.scale.isBlank()){var l=o.getModel("splitArea",i.getModel("splitArea"));if(l.get("show")){var c=l.getModel("areaStyle"),d=c.get("color"),u=Q1(c.get("opacity"),1);d=Ee.isArray(d)?d:[d];for(var h=n.getTicksCoords({tickModel:l,clamp:!0}),m=0,f=[0,0,0],p=[0,0,0],g=0;g<h.length;g++){var v=h[g].coord,b=[0,0,0],_=[0,0,0];if(b[a]=_[a]=v,b[1-a]=s[0],_[1-a]=s[1],g===0){f=b,p=_;continue}var x=R.parseColor(d[m%d.length]);x[3]*=u,e.addQuad([f,b,_,p],x),f=b,p=_,m++}}}})};var iP=m_;var rP=[0,1,2,0,2,3],nP=Lt.extend(function(){return{attributes:{position:new Lt.Attribute("position","float",3,"POSITION"),texcoord:new Lt.Attribute("texcoord","float",2,"TEXCOORD_0"),offset:new Lt.Attribute("offset","float",2),color:new Lt.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setSpriteCount:function(e){this._spriteCount=e;var t=e*4,i=e*2;this.vertexCount!==t&&(this.attributes.position.init(t),this.attributes.offset.init(t),this.attributes.color.init(t)),this.triangleCount!==i&&(this.indices=t>65535?new Uint32Array(i*3):new Uint16Array(i*3))},setSpriteAlign:function(e,t,i,r,n){i==null&&(i="left"),r==null&&(r="top");var a,o,s,l;switch(n=n||0,i){case"left":a=n,s=t[0]+n;break;case"center":case"middle":a=-t[0]/2,s=t[0]/2;break;case"right":a=-t[0]-n,s=-n;break}switch(r){case"bottom":o=n,l=t[1]+n;break;case"middle":o=-t[1]/2,l=t[1]/2;break;case"top":o=-t[1]-n,l=-n;break}var c=e*4,d=this.attributes.offset;d.set(c,[a,l]),d.set(c+1,[s,l]),d.set(c+2,[s,o]),d.set(c+3,[a,o])},addSprite:function(e,t,i,r,n,a){var o=this._vertexOffset;this.setSprite(this._vertexOffset/4,e,t,i,r,n,a);for(var s=0;s<rP.length;s++)this.indices[this._faceOffset*3+s]=rP[s]+o;return this._faceOffset+=2,this._vertexOffset+=4,o/4},setSprite:function(e,t,i,r,n,a,o){for(var s=e*4,l=this.attributes,c=0;c<4;c++)l.position.set(s+c,t);var d=l.texcoord;d.set(s,[r[0][0],r[0][1]]),d.set(s+1,[r[1][0],r[0][1]]),d.set(s+2,[r[1][0],r[1][1]]),d.set(s+3,[r[0][0],r[1][1]]),this.setSpriteAlign(e,i,n,a,o)}});Ee.defaults(nP.prototype,Is);var aP=nP;var oP=`@export ecgl.labels.vertex

attribute vec3 position: POSITION;
attribute vec2 texcoord: TEXCOORD_0;
attribute vec2 offset;
#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;

varying vec2 v_Texcoord;

void main()
{
 vec4 proj = worldViewProjection * vec4(position, 1.0);

 vec2 screen = (proj.xy / abs(proj.w) + 1.0) * 0.5 * viewport.zw;

 screen += offset;

 proj.xy = (screen / viewport.zw - 0.5) * 2.0 * abs(proj.w);
 gl_Position = proj;
#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif
 v_Texcoord = texcoord;
}
@end


@export ecgl.labels.fragment

uniform vec3 color : [1.0, 1.0, 1.0];
uniform float alpha : 1.0;
uniform sampler2D textureAtlas;
uniform vec2 uvScale: [1.0, 1.0];

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif
varying float v_Miter;

varying vec2 v_Texcoord;

void main()
{
 gl_FragColor = vec4(color, alpha) * texture2D(textureAtlas, v_Texcoord * uvScale);
#ifdef VERTEX_COLOR
 gl_FragColor *= v_Color;
#endif
}

@end`;R.Shader.import(oP);var Nh=R.Mesh.extend(function(){var e=new aP({dynamic:!0}),t=new R.Material({shader:R.createShader("ecgl.labels"),transparent:!0,depthMask:!1});return{geometry:e,material:t,culling:!1,castShadow:!1,ignorePicking:!0}});var Ud=ht.firstNotNull,Hd={x:0,y:2,z:1};function eC(e,t){var i=new R.Mesh({geometry:new Da({useNativeLine:!1}),material:t,castShadow:!1,ignorePicking:!0,renderOrder:2}),r=new Nh;r.material.depthMask=!1;var n=new R.Node;n.add(i),n.add(r),this.rootNode=n,this.dim=e,this.linesMesh=i,this.labelsMesh=r,this.axisLineCoords=null,this.labelElements=[]}var J1={x:"y",y:"x",z:"y"};eC.prototype.update=function(e,t,i){var r=e.coordinateSystem,n=r.getAxis(this.dim),a=this.linesMesh.geometry,o=this.labelsMesh.geometry;a.convertToDynamicArray(!0),o.convertToDynamicArray(!0);var s=n.model,l=n.getExtent(),D=i.getDevicePixelRatio(),c=s.getModel("axisLine",e.getModel("axisLine")),d=s.getModel("axisTick",e.getModel("axisTick")),u=s.getModel("axisLabel",e.getModel("axisLabel")),h=c.get("lineStyle.color");if(c.get("show")){var m=c.getModel("lineStyle"),f=[0,0,0],p=[0,0,0],g=Hd[n.dim];f[g]=l[0],p[g]=l[1],this.axisLineCoords=[f,p];var v=R.parseColor(h),b=Ud(m.get("width"),1),_=Ud(m.get("opacity"),1);v[3]*=_,a.addLine(f,p,v,b*D)}if(d.get("show")){var x=d.getModel("lineStyle"),w=R.parseColor(Ud(x.get("color"),h)),b=Ud(x.get("width"),1);w[3]*=Ud(x.get("opacity"),1);for(var y=n.getTicksCoords(),M=d.get("length"),T=0;T<y.length;T++){var C=y[T].coord,f=[0,0,0],p=[0,0,0],g=Hd[n.dim],N=Hd[J1[n.dim]];f[g]=p[g]=C,p[N]=M,a.addLine(f,p,w,b*D)}}this.labelElements=[];var D=i.getDevicePixelRatio();if(u.get("show"))for(var y=n.getTicksCoords(),k=s.get("data"),U=u.get("margin"),F=n.getViewLabels(),T=0;T<F.length;T++){var H=F[T].tickValue,V=F[T].formattedLabel,Q=F[T].rawLabel,C=n.dataToCoord(H),$=[0,0,0],g=Hd[n.dim],N=Hd[J1[n.dim]];$[g]=$[g]=C,$[N]=U;var ee=u;k&&k[H]&&k[H].textStyle&&(ee=new ac(k[H].textStyle,u,s.ecModel));var re=Ud(ee.get("color"),h),we=new qr.Text({style:Md(ee,{text:V,fill:typeof re=="function"?re(n.type==="category"?Q:n.type==="value"?H+"":H,T):re,verticalAlign:"top",align:"left"})}),te=t.add(we),oe=we.getBoundingRect();o.addSprite($,[oe.width*D,oe.height*D],te),this.labelElements.push(we)}if(s.get("name")){var pe=s.getModel("nameTextStyle"),$=[0,0,0],g=Hd[n.dim],N=Hd[J1[n.dim]],ue=Ud(pe.get("color"),h),_e=pe.get("borderColor"),b=pe.get("borderWidth");$[g]=$[g]=(l[0]+l[1])/2,$[N]=s.get("nameGap");var we=new qr.Text({style:Md(pe,{text:s.get("name"),fill:ue,stroke:_e,lineWidth:b})}),te=t.add(we),oe=we.getBoundingRect();o.addSprite($,[oe.width*D,oe.height*D],te),we.__idx=this.labelElements.length,this.nameLabelElement=we}this.labelsMesh.material.set("textureAtlas",t.getTexture()),this.labelsMesh.material.set("uvScale",t.getCoordsScale()),a.convertToTypedArray(),o.convertToTypedArray()};eC.prototype.setSpriteAlign=function(e,t,i){for(var r=i.getDevicePixelRatio(),n=this.labelsMesh.geometry,a=0;a<this.labelElements.length;a++){var o=this.labelElements[a],s=o.getBoundingRect();n.setSpriteAlign(a,[s.width*r,s.height*r],e,t)}var l=this.nameLabelElement;if(l){var s=l.getBoundingRect();n.setSpriteAlign(l.__idx,[s.width*r,s.height*r],e,t),n.dirty()}this.textAlign=e,this.textVerticalAlign=t};var sP=eC;var _c=`@export ecgl.lines3D.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec3 position: POSITION;
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;

void main()
{
 gl_Position = worldViewProjection * vec4(position, 1.0);
 v_Color = a_Color;
}

@end

@export ecgl.lines3D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;

@import clay.util.srgb

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color * v_Color);
#else
 gl_FragColor = color * v_Color;
#endif
}
@end



@export ecgl.lines3D.clipNear

vec4 clipNear(vec4 p1, vec4 p2) {
 float n = (p1.w - near) / (p1.w - p2.w);
 return vec4(mix(p1.xy, p2.xy, n), -near, near);
}

@end

@export ecgl.lines3D.expandLine
#ifdef VERTEX_ANIMATION
 vec4 prevProj = worldViewProjection * vec4(mix(prevPositionPrev, positionPrev, percent), 1.0);
 vec4 currProj = worldViewProjection * vec4(mix(prevPosition, position, percent), 1.0);
 vec4 nextProj = worldViewProjection * vec4(mix(prevPositionNext, positionNext, percent), 1.0);
#else
 vec4 prevProj = worldViewProjection * vec4(positionPrev, 1.0);
 vec4 currProj = worldViewProjection * vec4(position, 1.0);
 vec4 nextProj = worldViewProjection * vec4(positionNext, 1.0);
#endif

 if (currProj.w < 0.0) {
 if (nextProj.w > 0.0) {
 currProj = clipNear(currProj, nextProj);
 }
 else if (prevProj.w > 0.0) {
 currProj = clipNear(currProj, prevProj);
 }
 }

 vec2 prevScreen = (prevProj.xy / abs(prevProj.w) + 1.0) * 0.5 * viewport.zw;
 vec2 currScreen = (currProj.xy / abs(currProj.w) + 1.0) * 0.5 * viewport.zw;
 vec2 nextScreen = (nextProj.xy / abs(nextProj.w) + 1.0) * 0.5 * viewport.zw;

 vec2 dir;
 float len = offset;
 if (position == positionPrev) {
 dir = normalize(nextScreen - currScreen);
 }
 else if (position == positionNext) {
 dir = normalize(currScreen - prevScreen);
 }
 else {
 vec2 dirA = normalize(currScreen - prevScreen);
 vec2 dirB = normalize(nextScreen - currScreen);

 vec2 tanget = normalize(dirA + dirB);

 float miter = 1.0 / max(dot(tanget, dirA), 0.5);
 len *= miter;
 dir = tanget;
 }

 dir = vec2(-dir.y, dir.x) * len;
 currScreen += dir;

 currProj.xy = (currScreen / viewport.zw - 0.5) * 2.0 * abs(currProj.w);
@end


@export ecgl.meshLines3D.vertex

attribute vec3 position: POSITION;
attribute vec3 positionPrev;
attribute vec3 positionNext;
attribute float offset;
attribute vec4 a_Color : COLOR;

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
attribute vec3 prevPositionPrev;
attribute vec3 prevPositionNext;
uniform float percent : 1.0;
#endif

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;
uniform float near : NEAR;

varying vec4 v_Color;

@import ecgl.common.wireframe.vertexHeader

@import ecgl.lines3D.clipNear

void main()
{
 @import ecgl.lines3D.expandLine

 gl_Position = currProj;

 v_Color = a_Color;

 @import ecgl.common.wireframe.vertexMain
}
@end


@export ecgl.meshLines3D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;

@import ecgl.common.wireframe.fragmentHeader

@import clay.util.srgb

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color * v_Color);
#else
 gl_FragColor = color * v_Color;
#endif

 @import ecgl.common.wireframe.fragmentMain
}

@end`;var lP=ht.firstNotNull;R.Shader.import(_c);var Gd={x:0,y:2,z:1},cP=As.extend({type:"grid3D",__ecgl__:!0,init:function(e,t){var i=[["y","z","x",-1,"left"],["y","z","x",1,"right"],["x","y","z",-1,"bottom"],["x","y","z",1,"top"],["x","z","y",-1,"far"],["x","z","y",1,"near"]],r=["x","y","z"],n=new R.Material({shader:R.createShader("ecgl.color"),depthMask:!1,transparent:!0}),a=new R.Material({shader:R.createShader("ecgl.meshLines3D"),depthMask:!1,transparent:!0});n.define("fragment","DOUBLE_SIDED"),n.define("both","VERTEX_COLOR"),this.groupGL=new R.Node,this._control=new vc({zr:t.getZr()}),this._control.init(),this._faces=i.map(function(s){var l=new iP(s,a,n);return this.groupGL.add(l.rootNode),l},this),this._axes=r.map(function(s){var l=new sP(s,a);return this.groupGL.add(l.rootNode),l},this);var o=t.getDevicePixelRatio();this._axisLabelSurface=new _f({width:256,height:256,devicePixelRatio:o}),this._axisLabelSurface.onupdate=function(){t.getZr().refresh()},this._axisPointerLineMesh=new R.Mesh({geometry:new Da({useNativeLine:!1}),material:a,castShadow:!1,ignorePicking:!0,renderOrder:3}),this.groupGL.add(this._axisPointerLineMesh),this._axisPointerLabelsSurface=new _f({width:128,height:128,devicePixelRatio:o}),this._axisPointerLabelsMesh=new Nh({ignorePicking:!0,renderOrder:4,castShadow:!1}),this._axisPointerLabelsMesh.material.set("textureAtlas",this._axisPointerLabelsSurface.getTexture()),this.groupGL.add(this._axisPointerLabelsMesh),this._lightRoot=new R.Node,this._sceneHelper=new No,this._sceneHelper.initLight(this._lightRoot)},render:function(e,t,i){this._model=e,this._api=i;var r=e.coordinateSystem;r.viewGL.add(this._lightRoot),e.get("show")?r.viewGL.add(this.groupGL):r.viewGL.remove(this.groupGL);var n=this._control;n.setViewGL(r.viewGL);var a=e.getModel("viewControl");n.setFromViewControlModel(a,0),this._axisLabelSurface.clear(),n.off("update"),e.get("show")&&(this._faces.forEach(function(o){o.update(e,t,i)},this),this._axes.forEach(function(o){o.update(e,this._axisLabelSurface,i)},this)),n.on("update",this._onCameraChange.bind(this,e,i),this),this._sceneHelper.setScene(r.viewGL.scene),this._sceneHelper.updateLight(e),r.viewGL.setPostEffect(e.getModel("postEffect"),i),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._initMouseHandler(e)},afterRender:function(e,t,i,r){var n=r.renderer;this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i)},showAxisPointer:function(e,t,i,r){this._doShowAxisPointer(),this._updateAxisPointer(r.value)},hideAxisPointer:function(e,t,i,r){this._doHideAxisPointer()},_initMouseHandler:function(e){var t=e.coordinateSystem,i=t.viewGL;e.get("show")&&e.get("axisPointer.show")?i.on("mousemove",this._updateAxisPointerOnMousePosition,this):i.off("mousemove",this._updateAxisPointerOnMousePosition)},_updateAxisPointerOnMousePosition:function(e){if(!e.target){for(var t=this._model,i=t.coordinateSystem,r=i.viewGL,n=r.castRay(e.offsetX,e.offsetY,new R.Ray),a,o=0;o<this._faces.length;o++){var s=this._faces[o];if(!s.rootNode.invisible){s.plane.normal.dot(r.camera.worldTransform.z)<0&&s.plane.normal.negate();var l=n.intersectPlane(s.plane);if(l){var c=i.getAxis(s.faceInfo[0]),d=i.getAxis(s.faceInfo[1]),u=Gd[s.faceInfo[0]],h=Gd[s.faceInfo[1]];c.contain(l.array[u])&&d.contain(l.array[h])&&(a=l)}}}if(a){var m=i.pointToData(a.array,[],!0);this._updateAxisPointer(m),this._doShowAxisPointer()}else this._doHideAxisPointer()}},_onCameraChange:function(e,t){e.get("show")&&(this._updateFaceVisibility(),this._updateAxisLinePosition());var i=this._control;t.dispatchAction({type:"grid3DChangeCamera",alpha:i.getAlpha(),beta:i.getBeta(),distance:i.getDistance(),center:i.getCenter(),from:this.uid,grid3DId:e.id})},_updateFaceVisibility:function(){var e=this._control.getCamera(),t=new R.Vector3;e.update();for(var i=0;i<this._faces.length/2;i++){for(var r=[],n=0;n<2;n++){var a=this._faces[i*2+n];a.rootNode.getWorldPosition(t),t.transformMat4(e.viewMatrix),r[n]=t.z}var o=r[0]>r[1]?0:1,s=this._faces[i*2+o],l=this._faces[i*2+1-o];s.rootNode.invisible=!0,l.rootNode.invisible=!1}},_updateAxisLinePosition:function(){var e=this._model.coordinateSystem,t=e.getAxis("x"),i=e.getAxis("y"),r=e.getAxis("z"),n=r.getExtentMax(),a=r.getExtentMin(),o=t.getExtentMin(),s=t.getExtentMax(),l=i.getExtentMax(),c=i.getExtentMin(),d=this._axes[0].rootNode,u=this._axes[1].rootNode,h=this._axes[2].rootNode,m=this._faces,f=m[4].rootNode.invisible?c:l,p=m[2].rootNode.invisible?n:a,g=m[0].rootNode.invisible?o:s,v=m[2].rootNode.invisible?n:a,b=m[0].rootNode.invisible?s:o,_=m[4].rootNode.invisible?c:l;d.rotation.identity(),u.rotation.identity(),h.rotation.identity(),m[4].rootNode.invisible&&(this._axes[0].flipped=!0,d.rotation.rotateX(Math.PI)),m[0].rootNode.invisible&&(this._axes[1].flipped=!0,u.rotation.rotateZ(Math.PI)),m[4].rootNode.invisible&&(this._axes[2].flipped=!0,h.rotation.rotateY(Math.PI)),d.position.set(0,p,f),u.position.set(g,v,0),h.position.set(b,0,_),d.update(),u.update(),h.update(),this._updateAxisLabelAlign()},_updateAxisLabelAlign:function(){var e=this._control.getCamera(),t=[new R.Vector4,new R.Vector4],i=new R.Vector4;this.groupGL.getWorldPosition(i),i.w=1,i.transformMat4(e.viewMatrix).transformMat4(e.projectionMatrix),i.x/=i.w,i.y/=i.w,this._axes.forEach(function(r){for(var n=r.axisLineCoords,a=r.labelsMesh.geometry,o=0;o<t.length;o++)t[o].setArray(n[o]),t[o].w=1,t[o].transformMat4(r.rootNode.worldTransform).transformMat4(e.viewMatrix).transformMat4(e.projectionMatrix),t[o].x/=t[o].w,t[o].y/=t[o].w;var s=t[1].x-t[0].x,l=t[1].y-t[0].y,c=(t[1].x+t[0].x)/2,d=(t[1].y+t[0].y)/2,u,h;Math.abs(l/s)<.5?(u="center",h=d>i.y?"bottom":"top"):(h="middle",u=c>i.x?"left":"right"),r.setSpriteAlign(u,h,this._api)},this)},_doShowAxisPointer:function(){this._axisPointerLineMesh.invisible&&(this._axisPointerLineMesh.invisible=!1,this._axisPointerLabelsMesh.invisible=!1,this._api.getZr().refresh())},_doHideAxisPointer:function(){this._axisPointerLineMesh.invisible||(this._axisPointerLineMesh.invisible=!0,this._axisPointerLabelsMesh.invisible=!0,this._api.getZr().refresh())},_updateAxisPointer:function(e){var t=this._model.coordinateSystem,i=t.dataToPoint(e),r=this._axisPointerLineMesh,n=r.geometry,a=this._model.getModel("axisPointer"),o=this._api.getDevicePixelRatio();n.convertToDynamicArray(!0);function s(T){return ht.firstNotNull(T.model.get("axisPointer.show"),a.get("show"))}function l(T){var C=T.model.getModel("axisPointer",a),N=C.getModel("lineStyle"),D=R.parseColor(N.get("color")),k=lP(N.get("width"),1),U=lP(N.get("opacity"),1);return D[3]*=U,{color:D,lineWidth:k}}for(var c=0;c<this._faces.length;c++){var d=this._faces[c];if(!d.rootNode.invisible){for(var u=d.faceInfo,h=u[3]<0?t.getAxis(u[2]).getExtentMin():t.getAxis(u[2]).getExtentMax(),m=Gd[u[2]],f=0;f<2;f++){var p=u[f],g=u[1-f],v=t.getAxis(p),b=t.getAxis(g);if(s(v)){var _=[0,0,0],x=[0,0,0],w=Gd[p],y=Gd[g];_[w]=x[w]=i[w],_[m]=x[m]=h,_[y]=b.getExtentMin(),x[y]=b.getExtentMax();var M=l(v);n.addLine(_,x,M.color,M.lineWidth*o)}}if(s(t.getAxis(u[2]))){var _=i.slice(),x=i.slice();x[m]=h;var M=l(t.getAxis(u[2]));n.addLine(_,x,M.color,M.lineWidth*o)}}}n.convertToTypedArray(),this._updateAxisPointerLabelsMesh(e),this._api.getZr().refresh()},_updateAxisPointerLabelsMesh:function(e){var t=this._model,i=this._axisPointerLabelsMesh,r=this._axisPointerLabelsSurface,n=t.coordinateSystem,a=t.getModel("axisPointer");i.geometry.convertToDynamicArray(!0),r.clear();var o={x:"y",y:"x",z:"y"};this._axes.forEach(function(s,l){var c=n.getAxis(s.dim),d=c.model,u=d.getModel("axisPointer",a),h=u.getModel("label"),m=u.get("lineStyle.color");if(!(!h.get("show")||!u.get("show"))){var f=e[l],p=h.get("formatter"),g=c.scale.getLabel({value:f});if(p!=null)g=p(g,e);else if(c.scale.type==="interval"||c.scale.type==="log"){var v=Qa.getPrecisionSafe(c.scale.getTicks()[0]);g=f.toFixed(v+2)}var b=h.get("color"),_=new qr.Text({style:Md(h,{text:g,fill:b||m,align:"left",verticalAlign:"top"})}),x=r.add(_),w=_.getBoundingRect(),y=this._api.getDevicePixelRatio(),M=s.rootNode.position.toArray(),T=Gd[o[s.dim]];M[T]+=(s.flipped?-1:1)*h.get("margin"),M[Gd[s.dim]]=c.dataToCoord(e[l]),i.geometry.addSprite(M,[w.width*y,w.height*y],x,s.textAlign,s.textVerticalAlign)}},this),r.getZr().refreshImmediately(),i.material.set("uvScale",r.getCoordsScale()),i.geometry.convertToTypedArray()},dispose:function(){this.groupGL.removeAll(),this._control.dispose(),this._axisLabelSurface.dispose(),this._axisPointerLabelsSurface.dispose()}});function p_(e){Xw.call(this,e),this.type="cartesian3D",this.dimensions=["x","y","z"],this.size=[0,0,0]}p_.prototype={constructor:p_,model:null,containPoint:function(e){return this.getAxis("x").contain(e[0])&&this.getAxis("y").contain(e[2])&&this.getAxis("z").contain(e[1])},containData:function(e){return this.getAxis("x").containData(e[0])&&this.getAxis("y").containData(e[1])&&this.getAxis("z").containData(e[2])},dataToPoint:function(e,t,i){return t=t||[],t[0]=this.getAxis("x").dataToCoord(e[0],i),t[2]=this.getAxis("y").dataToCoord(e[1],i),t[1]=this.getAxis("z").dataToCoord(e[2],i),t},pointToData:function(e,t,i){return t=t||[],t[0]=this.getAxis("x").coordToData(e[0],i),t[1]=this.getAxis("y").coordToData(e[2],i),t[2]=this.getAxis("z").coordToData(e[1],i),t}};Ee.inherits(p_,Xw);var tC=p_;function f_(e,t,i){Id.call(this,e,t,i)}f_.prototype={constructor:f_,getExtentMin:function(){var e=this._extent;return Math.min(e[0],e[1])},getExtentMax:function(){var e=this._extent;return Math.max(e[0],e[1])},calculateCategoryInterval:function(){return Math.floor(this.scale.count()/8)}};Ee.inherits(f_,Id);var dP=f_;var rC=function(){this._pool={},this._allocatedTextures=[]};rC.prototype={constructor:rC,get:function(e){var t=uP(e);this._pool.hasOwnProperty(t)||(this._pool[t]=[]);var i=this._pool[t];if(!i.length){var r=new ct(e);return this._allocatedTextures.push(r),r}return i.pop()},put:function(e){var t=uP(e);this._pool.hasOwnProperty(t)||(this._pool[t]=[]);var i=this._pool[t];i.push(e)},clear:function(e){for(var t=0;t<this._allocatedTextures.length;t++)this._allocatedTextures[t].dispose(e);this._pool={},this._allocatedTextures=[]}};var hP={width:512,height:512,type:se.UNSIGNED_BYTE,format:se.RGBA,wrapS:se.CLAMP_TO_EDGE,wrapT:se.CLAMP_TO_EDGE,minFilter:se.LINEAR_MIPMAP_LINEAR,magFilter:se.LINEAR,useMipmap:!0,anisotropic:1,flipY:!0,unpackAlignment:4,premultiplyAlpha:!1},iC=Object.keys(hP);function uP(e){vr.defaultsWithPropList(e,hP,iC),pG(e);for(var t="",i=0;i<iC.length;i++){var r=iC[i],n=e[r].toString();t+=n}return t}function pG(e){var t=fG(e.width,e.height);e.format===se.DEPTH_COMPONENT&&(e.useMipmap=!1),(!t||!e.useMipmap)&&(e.minFilter==se.NEAREST_MIPMAP_NEAREST||e.minFilter==se.NEAREST_MIPMAP_LINEAR?e.minFilter=se.NEAREST:(e.minFilter==se.LINEAR_MIPMAP_LINEAR||e.minFilter==se.LINEAR_MIPMAP_NEAREST)&&(e.minFilter=se.LINEAR)),t||(e.wrapS=se.CLAMP_TO_EDGE,e.wrapT=se.CLAMP_TO_EDGE)}function fG(e,t){return(e&e-1)===0&&(t&t-1)===0}var g_=rC;var mP=`@export clay.sm.depth.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;
uniform vec2 uvRepeat = vec2(1.0, 1.0);
uniform vec2 uvOffset = vec2(0.0, 0.0);
@import clay.chunk.skinning_header
@import clay.chunk.instancing_header
varying vec4 v_ViewPosition;
varying vec2 v_Texcoord;
void main(){
 vec4 P = vec4(position, 1.0);
#ifdef SKINNING
 @import clay.chunk.skin_matrix
 P = skinMatrixWS * P;
#endif
#ifdef INSTANCING
 @import clay.chunk.instancing_matrix
 P = instanceMat * P;
#endif
 v_ViewPosition = worldViewProjection * P;
 gl_Position = v_ViewPosition;
 v_Texcoord = texcoord * uvRepeat + uvOffset;
}
@end
@export clay.sm.depth.fragment
varying vec4 v_ViewPosition;
varying vec2 v_Texcoord;
uniform float bias : 0.001;
uniform float slopeScale : 1.0;
uniform sampler2D alphaMap;
uniform float alphaCutoff: 0.0;
@import clay.util.encode_float
void main(){
 float depth = v_ViewPosition.z / v_ViewPosition.w;
 if (alphaCutoff > 0.0) {
 if (texture2D(alphaMap, v_Texcoord).a <= alphaCutoff) {
 discard;
 }
 }
#ifdef USE_VSM
 depth = depth * 0.5 + 0.5;
 float moment1 = depth;
 float moment2 = depth * depth;
 #ifdef SUPPORT_STANDARD_DERIVATIVES
 float dx = dFdx(depth);
 float dy = dFdy(depth);
 moment2 += 0.25*(dx*dx+dy*dy);
 #endif
 gl_FragColor = vec4(moment1, moment2, 0.0, 1.0);
#else
 #ifdef SUPPORT_STANDARD_DERIVATIVES
 float dx = dFdx(depth);
 float dy = dFdy(depth);
 depth += sqrt(dx*dx + dy*dy) * slopeScale + bias;
 #else
 depth += bias;
 #endif
 gl_FragColor = encodeFloat(depth * 0.5 + 0.5);
#endif
}
@end
@export clay.sm.debug_depth
uniform sampler2D depthMap;
varying vec2 v_Texcoord;
@import clay.util.decode_float
void main() {
 vec4 tex = texture2D(depthMap, v_Texcoord);
#ifdef USE_VSM
 gl_FragColor = vec4(tex.rgb, 1.0);
#else
 float depth = decodeFloat(tex);
 gl_FragColor = vec4(depth, depth, depth, 1.0);
#endif
}
@end
@export clay.sm.distance.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform mat4 world : WORLD;
attribute vec3 position : POSITION;
@import clay.chunk.skinning_header
varying vec3 v_WorldPosition;
void main (){
 vec4 P = vec4(position, 1.0);
#ifdef SKINNING
 @import clay.chunk.skin_matrix
 P = skinMatrixWS * P;
#endif
#ifdef INSTANCING
 @import clay.chunk.instancing_matrix
 P = instanceMat * P;
#endif
 gl_Position = worldViewProjection * P;
 v_WorldPosition = (world * P).xyz;
}
@end
@export clay.sm.distance.fragment
uniform vec3 lightPosition;
uniform float range : 100;
varying vec3 v_WorldPosition;
@import clay.util.encode_float
void main(){
 float dist = distance(lightPosition, v_WorldPosition);
#ifdef USE_VSM
 gl_FragColor = vec4(dist, dist * dist, 0.0, 0.0);
#else
 dist = dist / range;
 gl_FragColor = encodeFloat(dist);
#endif
}
@end
@export clay.plugin.shadow_map_common
@import clay.util.decode_float
float tapShadowMap(sampler2D map, vec2 uv, float z){
 vec4 tex = texture2D(map, uv);
 return step(z, decodeFloat(tex) * 2.0 - 1.0);
}
float pcf(sampler2D map, vec2 uv, float z, float textureSize, vec2 scale) {
 float shadowContrib = tapShadowMap(map, uv, z);
 vec2 offset = vec2(1.0 / textureSize) * scale;
#ifdef PCF_KERNEL_SIZE
 for (int _idx_ = 0; _idx_ < PCF_KERNEL_SIZE; _idx_++) {{
 shadowContrib += tapShadowMap(map, uv + offset * pcfKernel[_idx_], z);
 }}
 return shadowContrib / float(PCF_KERNEL_SIZE + 1);
#else
 shadowContrib += tapShadowMap(map, uv+vec2(offset.x, 0.0), z);
 shadowContrib += tapShadowMap(map, uv+vec2(offset.x, offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(0.0, offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, 0.0), z);
 shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, -offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(offset.x, -offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(0.0, -offset.y), z);
 return shadowContrib / 9.0;
#endif
}
float pcf(sampler2D map, vec2 uv, float z, float textureSize) {
 return pcf(map, uv, z, textureSize, vec2(1.0));
}
float chebyshevUpperBound(vec2 moments, float z){
 float p = 0.0;
 z = z * 0.5 + 0.5;
 if (z <= moments.x) {
 p = 1.0;
 }
 float variance = moments.y - moments.x * moments.x;
 variance = max(variance, 0.0000001);
 float mD = moments.x - z;
 float pMax = variance / (variance + mD * mD);
 pMax = clamp((pMax-0.4)/(1.0-0.4), 0.0, 1.0);
 return max(p, pMax);
}
float computeShadowContrib(
 sampler2D map, mat4 lightVPM, vec3 position, float textureSize, vec2 scale, vec2 offset
) {
 vec4 posInLightSpace = lightVPM * vec4(position, 1.0);
 posInLightSpace.xyz /= posInLightSpace.w;
 float z = posInLightSpace.z;
 if(all(greaterThan(posInLightSpace.xyz, vec3(-0.99, -0.99, -1.0))) &&
 all(lessThan(posInLightSpace.xyz, vec3(0.99, 0.99, 1.0)))){
 vec2 uv = (posInLightSpace.xy+1.0) / 2.0;
 #ifdef USE_VSM
 vec2 moments = texture2D(map, uv * scale + offset).xy;
 return chebyshevUpperBound(moments, z);
 #else
 return pcf(map, uv * scale + offset, z, textureSize, scale);
 #endif
 }
 return 1.0;
}
float computeShadowContrib(sampler2D map, mat4 lightVPM, vec3 position, float textureSize) {
 return computeShadowContrib(map, lightVPM, position, textureSize, vec2(1.0), vec2(0.0));
}
float computeShadowContribOmni(samplerCube map, vec3 direction, float range)
{
 float dist = length(direction);
 vec4 shadowTex = textureCube(map, direction);
#ifdef USE_VSM
 vec2 moments = shadowTex.xy;
 float variance = moments.y - moments.x * moments.x;
 float mD = moments.x - dist;
 float p = variance / (variance + mD * mD);
 if(moments.x + 0.001 < dist){
 return clamp(p, 0.0, 1.0);
 }else{
 return 1.0;
 }
#else
 return step(dist, (decodeFloat(shadowTex) + 0.0002) * range);
#endif
}
@end
@export clay.plugin.compute_shadow_map
#if defined(SPOT_LIGHT_SHADOWMAP_COUNT) || defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT) || defined(POINT_LIGHT_SHADOWMAP_COUNT)
#ifdef SPOT_LIGHT_SHADOWMAP_COUNT
uniform sampler2D spotLightShadowMaps[SPOT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform mat4 spotLightMatrices[SPOT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform float spotLightShadowMapSizes[SPOT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
#endif
#ifdef DIRECTIONAL_LIGHT_SHADOWMAP_COUNT
#if defined(SHADOW_CASCADE)
uniform sampler2D directionalLightShadowMaps[1]:unconfigurable;
uniform mat4 directionalLightMatrices[SHADOW_CASCADE]:unconfigurable;
uniform float directionalLightShadowMapSizes[1]:unconfigurable;
uniform float shadowCascadeClipsNear[SHADOW_CASCADE]:unconfigurable;
uniform float shadowCascadeClipsFar[SHADOW_CASCADE]:unconfigurable;
#else
uniform sampler2D directionalLightShadowMaps[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform mat4 directionalLightMatrices[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform float directionalLightShadowMapSizes[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
#endif
#endif
#ifdef POINT_LIGHT_SHADOWMAP_COUNT
uniform samplerCube pointLightShadowMaps[POINT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
#endif
uniform bool shadowEnabled : true;
#ifdef PCF_KERNEL_SIZE
uniform vec2 pcfKernel[PCF_KERNEL_SIZE];
#endif
@import clay.plugin.shadow_map_common
#if defined(SPOT_LIGHT_SHADOWMAP_COUNT)
void computeShadowOfSpotLights(vec3 position, inout float shadowContribs[SPOT_LIGHT_COUNT] ) {
 float shadowContrib;
 for(int _idx_ = 0; _idx_ < SPOT_LIGHT_SHADOWMAP_COUNT; _idx_++) {{
 shadowContrib = computeShadowContrib(
 spotLightShadowMaps[_idx_], spotLightMatrices[_idx_], position,
 spotLightShadowMapSizes[_idx_]
 );
 shadowContribs[_idx_] = shadowContrib;
 }}
 for(int _idx_ = SPOT_LIGHT_SHADOWMAP_COUNT; _idx_ < SPOT_LIGHT_COUNT; _idx_++){{
 shadowContribs[_idx_] = 1.0;
 }}
}
#endif
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
#ifdef SHADOW_CASCADE
void computeShadowOfDirectionalLights(vec3 position, inout float shadowContribs[DIRECTIONAL_LIGHT_COUNT]){
 float depth = (2.0 * gl_FragCoord.z - gl_DepthRange.near - gl_DepthRange.far)
 / (gl_DepthRange.far - gl_DepthRange.near);
 float shadowContrib;
 shadowContribs[0] = 1.0;
 for (int _idx_ = 0; _idx_ < SHADOW_CASCADE; _idx_++) {{
 if (
 depth >= shadowCascadeClipsNear[_idx_] &&
 depth <= shadowCascadeClipsFar[_idx_]
 ) {
 shadowContrib = computeShadowContrib(
 directionalLightShadowMaps[0], directionalLightMatrices[_idx_], position,
 directionalLightShadowMapSizes[0],
 vec2(1.0 / float(SHADOW_CASCADE), 1.0),
 vec2(float(_idx_) / float(SHADOW_CASCADE), 0.0)
 );
 shadowContribs[0] = shadowContrib;
 }
 }}
 for(int _idx_ = DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++) {{
 shadowContribs[_idx_] = 1.0;
 }}
}
#else
void computeShadowOfDirectionalLights(vec3 position, inout float shadowContribs[DIRECTIONAL_LIGHT_COUNT]){
 float shadowContrib;
 for(int _idx_ = 0; _idx_ < DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_++) {{
 shadowContrib = computeShadowContrib(
 directionalLightShadowMaps[_idx_], directionalLightMatrices[_idx_], position,
 directionalLightShadowMapSizes[_idx_]
 );
 shadowContribs[_idx_] = shadowContrib;
 }}
 for(int _idx_ = DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++) {{
 shadowContribs[_idx_] = 1.0;
 }}
}
#endif
#endif
#if defined(POINT_LIGHT_SHADOWMAP_COUNT)
void computeShadowOfPointLights(vec3 position, inout float shadowContribs[POINT_LIGHT_COUNT] ){
 vec3 lightPosition;
 vec3 direction;
 for(int _idx_ = 0; _idx_ < POINT_LIGHT_SHADOWMAP_COUNT; _idx_++) {{
 lightPosition = pointLightPosition[_idx_];
 direction = position - lightPosition;
 shadowContribs[_idx_] = computeShadowContribOmni(pointLightShadowMaps[_idx_], direction, pointLightRange[_idx_]);
 }}
 for(int _idx_ = POINT_LIGHT_SHADOWMAP_COUNT; _idx_ < POINT_LIGHT_COUNT; _idx_++) {{
 shadowContribs[_idx_] = 1.0;
 }}
}
#endif
#endif
@end`;var bc=["px","nx","py","ny","pz","nz"];Re.import(mP);function nC(e,t,i){if(i==="alphaMap")return e.material.get("diffuseMap");if(i==="alphaCutoff"){if(e.material.isDefined("fragment","ALPHA_TEST")&&e.material.get("diffuseMap")){var r=e.material.get("alphaCutoff");return r||0}return 0}else return i==="uvRepeat"?e.material.get("uvRepeat"):i==="uvOffset"?e.material.get("uvOffset"):t.get(i)}function pP(e,t){var i=e.material,r=t.material;return i.get("diffuseMap")!==r.get("diffuseMap")||(i.get("alphaCutoff")||0)!==(r.get("alphaCutoff")||0)}var ks=Ui.extend(function(){return{softShadow:ks.PCF,shadowBlur:1,lightFrustumBias:"auto",kernelPCF:new Float32Array([1,0,1,1,-1,1,0,1,-1,0,-1,-1,1,-1,0,-1]),precision:"highp",_lastRenderNotCastShadow:!1,_frameBuffer:new ki,_textures:{},_shadowMapNumber:{POINT_LIGHT:0,DIRECTIONAL_LIGHT:0,SPOT_LIGHT:0},_depthMaterials:{},_distanceMaterials:{},_receivers:[],_lightsCastShadow:[],_lightCameras:{},_lightMaterials:{},_texturePool:new g_}},function(){this._gaussianPassH=new Oi({fragment:Re.source("clay.compositor.gaussian_blur")}),this._gaussianPassV=new Oi({fragment:Re.source("clay.compositor.gaussian_blur")}),this._gaussianPassH.setUniform("blurSize",this.shadowBlur),this._gaussianPassH.setUniform("blurDir",0),this._gaussianPassV.setUniform("blurSize",this.shadowBlur),this._gaussianPassV.setUniform("blurDir",1),this._outputDepthPass=new Oi({fragment:Re.source("clay.sm.debug_depth")})},{render:function(e,t,i,r){i||(i=t.getMainCamera()),this.trigger("beforerender",this,e,t,i),this._renderShadowPass(e,t,i,r),this.trigger("afterrender",this,e,t,i)},renderDebug:function(e,t){e.saveClear();var i=e.viewport,r=0,n=0,a=t||i.width/4,o=a;this.softShadow===ks.VSM?this._outputDepthPass.material.define("fragment","USE_VSM"):this._outputDepthPass.material.undefine("fragment","USE_VSM");for(var s in this._textures){var l=this._textures[s];e.setViewport(r,n,a*l.width/l.height,o),this._outputDepthPass.setUniform("depthMap",l),this._outputDepthPass.render(e),r+=a*l.width/l.height}e.setViewport(i),e.restoreClear()},_updateReceivers:function(e,t){if(t.receiveShadow?(this._receivers.push(t),t.material.set("shadowEnabled",1),t.material.set("pcfKernel",this.kernelPCF)):t.material.set("shadowEnabled",0),this.softShadow===ks.VSM)t.material.define("fragment","USE_VSM"),t.material.undefine("fragment","PCF_KERNEL_SIZE");else{t.material.undefine("fragment","USE_VSM");var i=this.kernelPCF;i&&i.length?t.material.define("fragment","PCF_KERNEL_SIZE",i.length/2):t.material.undefine("fragment","PCF_KERNEL_SIZE")}},_update:function(e,t){var i=this;t.traverse(function(a){a.isRenderable()&&i._updateReceivers(e,a)});for(var r=0;r<t.lights.length;r++){var n=t.lights[r];n.castShadow&&!n.invisible&&this._lightsCastShadow.push(n)}},_renderShadowPass:function(e,t,i,r){for(var n in this._shadowMapNumber)this._shadowMapNumber[n]=0;this._lightsCastShadow.length=0,this._receivers.length=0;var a=e.gl;if(r||t.update(),i&&i.update(),t.updateLights(),this._update(e,t),!this._lightsCastShadow.length&&this._lastRenderNotCastShadow)return;this._lastRenderNotCastShadow=this._lightsCastShadow===0,a.enable(a.DEPTH_TEST),a.depthMask(!0),a.disable(a.BLEND),a.clearColor(1,1,1,1);for(var o=[],s=[],l=[],c=[],d=[],u=[],h,m=0;m<this._lightsCastShadow.length;m++){var f=this._lightsCastShadow[m];if(f.type==="DIRECTIONAL_LIGHT"){if(h){console.warn("Only one direectional light supported with shadow cascade");continue}if(f.shadowCascade>4){console.warn("Support at most 4 cascade");continue}f.shadowCascade>1&&(h=f),this.renderDirectionalLightShadow(e,t,i,f,d,c,l)}else f.type==="SPOT_LIGHT"?this.renderSpotLightShadow(e,t,f,s,o):f.type==="POINT_LIGHT"&&this.renderPointLightShadow(e,t,f,u);this._shadowMapNumber[f.type]++}for(var p in this._shadowMapNumber)for(var g=this._shadowMapNumber[p],v=p+"_SHADOWMAP_COUNT",m=0;m<this._receivers.length;m++){var b=this._receivers[m],_=b.material;_.fragmentDefines[v]!==g&&(g>0?_.define("fragment",v,g):_.isDefined("fragment",v)&&_.undefine("fragment",v))}for(var m=0;m<this._receivers.length;m++){var b=this._receivers[m],_=b.material;h?_.define("fragment","SHADOW_CASCADE",h.shadowCascade):_.undefine("fragment","SHADOW_CASCADE")}var x=t.shadowUniforms;function w(N){return N.height}if(l.length>0){var y=l.map(w);if(x.directionalLightShadowMaps={value:l,type:"tv"},x.directionalLightMatrices={value:c,type:"m4v"},x.directionalLightShadowMapSizes={value:y,type:"1fv"},h){var M=d.slice(),T=d.slice();M.pop(),T.shift(),M.reverse(),T.reverse(),c.reverse(),x.shadowCascadeClipsNear={value:M,type:"1fv"},x.shadowCascadeClipsFar={value:T,type:"1fv"}}}if(o.length>0){var C=o.map(w),x=t.shadowUniforms;x.spotLightShadowMaps={value:o,type:"tv"},x.spotLightMatrices={value:s,type:"m4v"},x.spotLightShadowMapSizes={value:C,type:"1fv"}}u.length>0&&(x.pointLightShadowMaps={value:u,type:"tv"})},renderDirectionalLightShadow:function(){var e=new Ah,t=new Ye,i=new wr,r=new Ye,n=new Ye,a=new Ye,o=new Ye;return function(s,l,c,d,u,h,m){var f=this._getDepthMaterial(d),p={getMaterial:function(oe){return oe.shadowDepthMaterial||f},isMaterialChanged:pP,getUniform:nC,ifRender:function(oe){return oe.castShadow},sortCompare:uc.opaqueSortCompare};if(!l.viewBoundingBoxLastFrame.isFinite()){var g=l.getBoundingBox();l.viewBoundingBoxLastFrame.copy(g).applyTransform(c.viewMatrix)}var v=Math.min(-l.viewBoundingBoxLastFrame.min.z,c.far),b=Math.max(-l.viewBoundingBoxLastFrame.max.z,c.near),_=this._getDirectionalLightCamera(d,l,c),x=a.array;o.copy(_.projectionMatrix),ke.invert(n.array,_.worldTransform.array),ke.multiply(n.array,n.array,c.worldTransform.array),ke.multiply(x,o.array,n.array);for(var w=[],y=c instanceof Cr,M=(c.near+c.far)/(c.near-c.far),T=2*c.near*c.far/(c.near-c.far),C=0;C<=d.shadowCascade;C++){var N=b*Math.pow(v/b,C/d.shadowCascade),D=b+(v-b)*C/d.shadowCascade,k=N*d.cascadeSplitLogFactor+D*(1-d.cascadeSplitLogFactor);w.push(k),u.push(-(-k*M+T)/-k)}var U=this._getTexture(d,d.shadowCascade);m.push(U);var F=s.viewport,H=s.gl;this._frameBuffer.attach(U),this._frameBuffer.bind(s),H.clear(H.COLOR_BUFFER_BIT|H.DEPTH_BUFFER_BIT);for(var C=0;C<d.shadowCascade;C++){var V=w[C],Q=w[C+1];y?ke.perspective(t.array,c.fov/180*Math.PI,c.aspect,V,Q):ke.ortho(t.array,c.left,c.right,c.bottom,c.top,V,Q),e.setFromProjection(t),e.getTransformedBoundingBox(i,n),i.applyProjection(o);var $=i.min.array,ee=i.max.array;$[0]=Math.max($[0],-1),$[1]=Math.max($[1],-1),ee[0]=Math.min(ee[0],1),ee[1]=Math.min(ee[1],1),r.ortho($[0],ee[0],$[1],ee[1],1,-1),_.projectionMatrix.multiplyLeft(r);var re=d.shadowResolution||512;s.setViewport((d.shadowCascade-C-1)*re,0,re,re,1);var we=l.updateRenderList(_);s.renderPass(we.opaque,_,p),this.softShadow===ks.VSM&&this._gaussianFilter(s,U,U.width);var te=new Ye;te.copy(_.viewMatrix).multiplyLeft(_.projectionMatrix),h.push(te.array),_.projectionMatrix.copy(o)}this._frameBuffer.unbind(s),s.setViewport(F)}}(),renderSpotLightShadow:function(e,t,i,r,n){var a=this._getTexture(i),o=this._getSpotLightCamera(i),s=e.gl;this._frameBuffer.attach(a),this._frameBuffer.bind(e),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var l=this._getDepthMaterial(i),c={getMaterial:function(h){return h.shadowDepthMaterial||l},isMaterialChanged:pP,getUniform:nC,ifRender:function(h){return h.castShadow},sortCompare:uc.opaqueSortCompare},d=t.updateRenderList(o);e.renderPass(d.opaque,o,c),this._frameBuffer.unbind(e),this.softShadow===ks.VSM&&this._gaussianFilter(e,a,a.width);var u=new Ye;u.copy(o.worldTransform).invert().multiplyLeft(o.projectionMatrix),n.push(a),r.push(u.array)},renderPointLightShadow:function(e,t,i,r){var n=this._getTexture(i),a=e.gl;r.push(n);var o=this._getDepthMaterial(i),s={getMaterial:function(b){return b.shadowDepthMaterial||o},getUniform:nC,sortCompare:uc.opaqueSortCompare},l={px:[],py:[],pz:[],nx:[],ny:[],nz:[]},c=new wr,d=i.getWorldPosition().array,u=new wr,h=i.range;u.min.setArray(d),u.max.setArray(d);var m=new Se(h,h,h);u.max.add(m),u.min.sub(m);var f={px:!1,py:!1,pz:!1,nx:!1,ny:!1,nz:!1};t.traverse(function(b){if(b.isRenderable()&&b.castShadow){var _=b.geometry;if(!_.boundingBox){for(var x=0;x<bc.length;x++)l[bc[x]].push(b);return}if(c.transformFrom(_.boundingBox,b.worldTransform),!c.intersectBoundingBox(u))return;c.updateVertices();for(var x=0;x<bc.length;x++)f[bc[x]]=!1;for(var x=0;x<8;x++){var w=c.vertices[x],y=w[0]-d[0],M=w[1]-d[1],T=w[2]-d[2],C=Math.abs(y),N=Math.abs(M),D=Math.abs(T);C>N?C>D?f[y>0?"px":"nx"]=!0:f[T>0?"pz":"nz"]=!0:N>D?f[M>0?"py":"ny"]=!0:f[T>0?"pz":"nz"]=!0}for(var x=0;x<bc.length;x++)f[bc[x]]&&l[bc[x]].push(b)}});for(var p=0;p<6;p++){var g=bc[p],v=this._getPointLightCamera(i,g);this._frameBuffer.attach(n,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+p),this._frameBuffer.bind(e),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),e.renderPass(l[g],v,s)}this._frameBuffer.unbind(e)},_getDepthMaterial:function(e){var t=this._lightMaterials[e.__uid__],i=e.type==="POINT_LIGHT";if(!t){var r=i?"clay.sm.distance.":"clay.sm.depth.";t=new $r({precision:this.precision,shader:new Re(Re.source(r+"vertex"),Re.source(r+"fragment"))}),this._lightMaterials[e.__uid__]=t}return e.shadowSlopeScale!=null&&t.setUniform("slopeScale",e.shadowSlopeScale),e.shadowBias!=null&&t.setUniform("bias",e.shadowBias),this.softShadow===ks.VSM?t.define("fragment","USE_VSM"):t.undefine("fragment","USE_VSM"),i&&(t.set("lightPosition",e.getWorldPosition().array),t.set("range",e.range)),t},_gaussianFilter:function(e,t,i){var r={width:i,height:i,type:qe.FLOAT},n=this._texturePool.get(r);this._frameBuffer.attach(n),this._frameBuffer.bind(e),this._gaussianPassH.setUniform("texture",t),this._gaussianPassH.setUniform("textureWidth",i),this._gaussianPassH.render(e),this._frameBuffer.attach(t),this._gaussianPassV.setUniform("texture",n),this._gaussianPassV.setUniform("textureHeight",i),this._gaussianPassV.render(e),this._frameBuffer.unbind(e),this._texturePool.put(n)},_getTexture:function(e,t){var i=e.__uid__,r=this._textures[i],n=e.shadowResolution||512;return t=t||1,r||(e.type==="POINT_LIGHT"?r=new ml:r=new ct,r.width=n*t,r.height=n,this.softShadow===ks.VSM?(r.type=qe.FLOAT,r.anisotropic=4):(r.minFilter=se.NEAREST,r.magFilter=se.NEAREST,r.useMipmap=!1),this._textures[i]=r),r},_getPointLightCamera:function(e,t){this._lightCameras.point||(this._lightCameras.point={px:new Cr,nx:new Cr,py:new Cr,ny:new Cr,pz:new Cr,nz:new Cr});var i=this._lightCameras.point[t];switch(i.far=e.range,i.fov=90,i.position.set(0,0,0),t){case"px":i.lookAt(Se.POSITIVE_X,Se.NEGATIVE_Y);break;case"nx":i.lookAt(Se.NEGATIVE_X,Se.NEGATIVE_Y);break;case"py":i.lookAt(Se.POSITIVE_Y,Se.POSITIVE_Z);break;case"ny":i.lookAt(Se.NEGATIVE_Y,Se.NEGATIVE_Z);break;case"pz":i.lookAt(Se.POSITIVE_Z,Se.NEGATIVE_Y);break;case"nz":i.lookAt(Se.NEGATIVE_Z,Se.NEGATIVE_Y);break}return e.getWorldPosition(i.position),i.update(),i},_getDirectionalLightCamera:function(){var e=new Ye,t=new wr,i=new wr;return function(r,n,a){this._lightCameras.directional||(this._lightCameras.directional=new us);var o=this._lightCameras.directional;t.copy(n.viewBoundingBoxLastFrame),t.intersection(a.frustum.boundingBox),o.position.copy(t.min).add(t.max).scale(.5).transformMat4(a.worldTransform),o.rotation.copy(r.rotation),o.scale.copy(r.scale),o.updateWorldTransform(),Ye.invert(e,o.worldTransform),Ye.multiply(e,e,a.worldTransform),i.copy(t).applyTransform(e);var s=i.min.array,l=i.max.array;return o.position.set((s[0]+l[0])/2,(s[1]+l[1])/2,l[2]).transformMat4(o.worldTransform),o.near=0,o.far=-s[2]+l[2],isNaN(this.lightFrustumBias)?o.far*=4:o.far+=this.lightFrustumBias,o.left=s[0],o.right=l[0],o.top=l[1],o.bottom=s[1],o.update(!0),o}}(),_getSpotLightCamera:function(e){this._lightCameras.spot||(this._lightCameras.spot=new Cr);var t=this._lightCameras.spot;return t.fov=e.penumbraAngle*2,t.far=e.range,t.worldTransform.copy(e.worldTransform),t.updateProjectionMatrix(),ke.invert(t.viewMatrix.array,t.worldTransform.array),t},dispose:function(e){var t=e.gl||e;this._frameBuffer&&this._frameBuffer.dispose(t);for(var i in this._textures)this._textures[i].dispose(t);this._texturePool.clear(e.gl),this._depthMaterials={},this._distanceMaterials={},this._textures={},this._lightCameras={},this._shadowMapNumber={POINT_LIGHT:0,DIRECTIONAL_LIGHT:0,SPOT_LIGHT:0},this._meshMaterials={};for(var r=0;r<this._receivers.length;r++){var n=this._receivers[r];if(n.material){var a=n.material;a.undefine("fragment","POINT_LIGHT_SHADOW_COUNT"),a.undefine("fragment","DIRECTIONAL_LIGHT_SHADOW_COUNT"),a.undefine("fragment","AMBIENT_LIGHT_SHADOW_COUNT"),a.set("shadowEnabled",0)}}this._receivers=[],this._lightsCastShadow=[]}});ks.VSM=1;ks.PCF=2;var fP=ks;var gG=Ui.extend(function(){return{name:"",inputLinks:{},outputLinks:{},_prevOutputTextures:{},_outputTextures:{},_outputReferences:{},_rendering:!1,_rendered:!1,_compositor:null}},{updateParameter:function(e,t){var i=this.outputs[e],r=i.parameters,n=i._parametersCopy;if(n||(n=i._parametersCopy={}),r)for(var a in r)a!=="width"&&a!=="height"&&(n[a]=r[a]);var o,s;return r.width instanceof Function?o=r.width.call(this,t):o=r.width,r.height instanceof Function?s=r.height.call(this,t):s=r.height,(n.width!==o||n.height!==s)&&this._outputTextures[e]&&this._outputTextures[e].dispose(t.gl),n.width=o,n.height=s,n},setParameter:function(e,t){},getParameter:function(e){},setParameters:function(e){for(var t in e)this.setParameter(t,e[t])},render:function(){},getOutput:function(e,t){if(t==null)return t=e,this._outputTextures[t];var i=this.outputs[t];if(i)return this._rendered?i.outputLastFrame?this._prevOutputTextures[t]:this._outputTextures[t]:this._rendering?(this._prevOutputTextures[t]||(this._prevOutputTextures[t]=this._compositor.allocateTexture(i.parameters||{})),this._prevOutputTextures[t]):(this.render(e),this._outputTextures[t])},removeReference:function(e){if(this._outputReferences[e]--,this._outputReferences[e]===0){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}},link:function(e,t,i){this.inputLinks[e]={node:t,pin:i},t.outputLinks[i]||(t.outputLinks[i]=[]),t.outputLinks[i].push({node:this,pin:e}),this.pass.material.enableTexture(e)},clear:function(){this.inputLinks={},this.outputLinks={}},updateReference:function(e){if(!this._rendering){this._rendering=!0;for(var t in this.inputLinks){var i=this.inputLinks[t];i.node.updateReference(i.pin)}this._rendering=!1}e&&this._outputReferences[e]++},beforeFrame:function(){this._rendered=!1;for(var e in this.outputLinks)this._outputReferences[e]=0},afterFrame:function(){for(var e in this.outputLinks)if(this._outputReferences[e]>0){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}}}),gl=gG;var vG=Ui.extend(function(){return{nodes:[]}},{dirty:function(){this._dirty=!0},addNode:function(e){this.nodes.indexOf(e)>=0||(this.nodes.push(e),this._dirty=!0)},removeNode:function(e){typeof e=="string"&&(e=this.getNodeByName(e));var t=this.nodes.indexOf(e);t>=0&&(this.nodes.splice(t,1),this._dirty=!0)},getNodeByName:function(e){for(var t=0;t<this.nodes.length;t++)if(this.nodes[t].name===e)return this.nodes[t]},update:function(){for(var e=0;e<this.nodes.length;e++)this.nodes[e].clear();for(var e=0;e<this.nodes.length;e++){var t=this.nodes[e];if(t.inputs){for(var i in t.inputs)if(t.inputs[i]){if(t.pass&&!t.pass.material.isUniformEnabled(i)){console.warn("Pin "+t.name+"."+i+" not used.");continue}var r=t.inputs[i],n=this.findPin(r);n?t.link(i,n.node,n.pin):console.warn(typeof r=="string"?"Node "+r+" not exist":"Pin of "+r.node+"."+r.pin+" not exist")}}}},findPin:function(e){var t;if((typeof e=="string"||e instanceof gl)&&(e={node:e}),typeof e.node=="string")for(var i=0;i<this.nodes.length;i++){var r=this.nodes[i];r.name===e.node&&(t=r)}else t=e.node;if(t){var n=e.pin;if(n||t.outputs&&(n=Object.keys(t.outputs)[0]),t.outputs[n])return{node:t,pin:n}}}}),aC=vG;var _G=aC.extend(function(){return{_outputs:[],_texturePool:new g_,_frameBuffer:new ki({depthBuffer:!1})}},{addNode:function(e){aC.prototype.addNode.call(this,e),e._compositor=this},render:function(e,t){if(this._dirty){this.update(),this._dirty=!1,this._outputs.length=0;for(var i=0;i<this.nodes.length;i++)this.nodes[i].outputs||this._outputs.push(this.nodes[i])}for(var i=0;i<this.nodes.length;i++)this.nodes[i].beforeFrame();for(var i=0;i<this._outputs.length;i++)this._outputs[i].updateReference();for(var i=0;i<this._outputs.length;i++)this._outputs[i].render(e,t);for(var i=0;i<this.nodes.length;i++)this.nodes[i].afterFrame()},allocateTexture:function(e){return this._texturePool.get(e)},releaseTexture:function(e){this._texturePool.put(e)},getFrameBuffer:function(){return this._frameBuffer},dispose:function(e){this._texturePool.clear(e)}}),gP=_G;var bG=gl.extend({name:"scene",scene:null,camera:null,autoUpdateScene:!0,preZ:!1},function(){this.frameBuffer=new ki},{render:function(e){this._rendering=!0;var t=e.gl;this.trigger("beforerender");var i;if(!this.outputs)i=e.render(this.scene,this.camera,!this.autoUpdateScene,this.preZ);else{var r=this.frameBuffer;for(var n in this.outputs){var a=this.updateParameter(n,e),o=this.outputs[n],s=this._compositor.allocateTexture(a);this._outputTextures[n]=s;var l=o.attachment||t.COLOR_ATTACHMENT0;typeof l=="string"&&(l=t[l]),r.attach(s,l)}r.bind(e);var c=e.getGLExtension("EXT_draw_buffers");if(c){var d=[];for(var l in this.outputs)l=parseInt(l),l>=t.COLOR_ATTACHMENT0&&l<=t.COLOR_ATTACHMENT0+8&&d.push(l);c.drawBuffersEXT(d)}e.saveClear(),e.clearBit=se.DEPTH_BUFFER_BIT|se.COLOR_BUFFER_BIT,i=e.render(this.scene,this.camera,!this.autoUpdateScene,this.preZ),e.restoreClear(),r.unbind(e)}this.trigger("afterrender",i),this._rendering=!1,this._rendered=!0}}),vP=bG;var xG=gl.extend(function(){return{texture:null,outputs:{color:{}}}},function(){},{getOutput:function(e,t){return this.texture},beforeFrame:function(){},afterFrame:function(){}}),_P=xG;var yG=gl.extend(function(){return{name:"",inputs:{},outputs:null,shader:"",inputLinks:{},outputLinks:{},pass:null,_prevOutputTextures:{},_outputTextures:{},_outputReferences:{},_rendering:!1,_rendered:!1,_compositor:null}},function(){var e=new Oi({fragment:this.shader});this.pass=e},{render:function(e,t){this.trigger("beforerender",e),this._rendering=!0;var i=e.gl;for(var r in this.inputLinks){var n=this.inputLinks[r],a=n.node.getOutput(e,n.pin);this.pass.setUniform(r,a)}if(!this.outputs)this.pass.outputs=null,this._compositor.getFrameBuffer().unbind(e),this.pass.render(e,t);else{this.pass.outputs={};var o={};for(var s in this.outputs){var l=this.updateParameter(s,e);isNaN(l.width)&&this.updateParameter(s,e);var c=this.outputs[s],d=this._compositor.allocateTexture(l);this._outputTextures[s]=d;var u=c.attachment||i.COLOR_ATTACHMENT0;typeof u=="string"&&(u=i[u]),o[u]=d}this._compositor.getFrameBuffer().bind(e);for(var u in o)this._compositor.getFrameBuffer().attach(o[u],u);this.pass.render(e),this._compositor.getFrameBuffer().updateMipmap(e)}for(var r in this.inputLinks){var n=this.inputLinks[r];n.node.removeReference(n.pin)}this._rendering=!1,this._rendered=!0,this.trigger("afterrender",e)},updateParameter:function(e,t){var i=this.outputs[e],r=i.parameters,n=i._parametersCopy;if(n||(n=i._parametersCopy={}),r)for(var a in r)a!=="width"&&a!=="height"&&(n[a]=r[a]);var o,s;return typeof r.width=="function"?o=r.width.call(this,t):o=r.width,typeof r.height=="function"?s=r.height.call(this,t):s=r.height,o=Math.ceil(o),s=Math.ceil(s),(n.width!==o||n.height!==s)&&this._outputTextures[e]&&this._outputTextures[e].dispose(t),n.width=o,n.height=s,n},setParameter:function(e,t){this.pass.setUniform(e,t)},getParameter:function(e){return this.pass.getUniform(e)},setParameters:function(e){for(var t in e)this.setParameter(t,e[t])},define:function(e,t){this.pass.material.define("fragment",e,t)},undefine:function(e){this.pass.material.undefine("fragment",e)},removeReference:function(e){if(this._outputReferences[e]--,this._outputReferences[e]===0){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}},clear:function(){gl.prototype.clear.call(this),this.pass.material.disableTexturesAll()}}),bP=yG;var xP=`@export clay.compositor.coloradjust
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float brightness : 0.0;
uniform float contrast : 1.0;
uniform float exposure : 0.0;
uniform float gamma : 1.0;
uniform float saturation : 1.0;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord);
 vec3 color = clamp(tex.rgb + vec3(brightness), 0.0, 1.0);
 color = clamp( (color-vec3(0.5))*contrast+vec3(0.5), 0.0, 1.0);
 color = clamp( color * pow(2.0, exposure), 0.0, 1.0);
 color = clamp( pow(color, vec3(gamma)), 0.0, 1.0);
 float luminance = dot( color, w );
 color = mix(vec3(luminance), color, saturation);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.brightness
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float brightness : 0.0;
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord);
 vec3 color = tex.rgb + vec3(brightness);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.contrast
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float contrast : 1.0;
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord);
 vec3 color = (tex.rgb-vec3(0.5))*contrast+vec3(0.5);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.exposure
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float exposure : 0.0;
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 vec3 color = tex.rgb * pow(2.0, exposure);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.gamma
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float gamma : 1.0;
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 vec3 color = pow(tex.rgb, vec3(gamma));
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.saturation
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float saturation : 1.0;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 vec3 color = tex.rgb;
 float luminance = dot(color, w);
 color = mix(vec3(luminance), color, saturation);
 gl_FragColor = vec4(color, tex.a);
}
@end`;var v_=`@export clay.compositor.kernel.gaussian_9
float gaussianKernel[9];
gaussianKernel[0] = 0.07;
gaussianKernel[1] = 0.09;
gaussianKernel[2] = 0.12;
gaussianKernel[3] = 0.14;
gaussianKernel[4] = 0.16;
gaussianKernel[5] = 0.14;
gaussianKernel[6] = 0.12;
gaussianKernel[7] = 0.09;
gaussianKernel[8] = 0.07;
@end
@export clay.compositor.kernel.gaussian_13
float gaussianKernel[13];
gaussianKernel[0] = 0.02;
gaussianKernel[1] = 0.03;
gaussianKernel[2] = 0.06;
gaussianKernel[3] = 0.08;
gaussianKernel[4] = 0.11;
gaussianKernel[5] = 0.13;
gaussianKernel[6] = 0.14;
gaussianKernel[7] = 0.13;
gaussianKernel[8] = 0.11;
gaussianKernel[9] = 0.08;
gaussianKernel[10] = 0.06;
gaussianKernel[11] = 0.03;
gaussianKernel[12] = 0.02;
@end
@export clay.compositor.gaussian_blur
#define SHADER_NAME gaussian_blur
uniform sampler2D texture;varying vec2 v_Texcoord;
uniform float blurSize : 2.0;
uniform vec2 textureSize : [512.0, 512.0];
uniform float blurDir : 0.0;
@import clay.util.rgbm
@import clay.util.clamp_sample
void main (void)
{
 @import clay.compositor.kernel.gaussian_9
 vec2 off = blurSize / textureSize;
 off *= vec2(1.0 - blurDir, blurDir);
 vec4 sum = vec4(0.0);
 float weightAll = 0.0;
 for (int i = 0; i < 9; i++) {
 float w = gaussianKernel[i];
 vec4 texel = decodeHDR(clampSample(texture, v_Texcoord + float(i - 4) * off));
 sum += texel * w;
 weightAll += w;
 }
 gl_FragColor = encodeHDR(sum / max(weightAll, 0.01));
}
@end
`;var yP=`@export clay.compositor.hdr.log_lum
varying vec2 v_Texcoord;
uniform sampler2D texture;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
@import clay.util.rgbm
void main()
{
 vec4 tex = decodeHDR(texture2D(texture, v_Texcoord));
 float luminance = dot(tex.rgb, w);
 luminance = log(luminance + 0.001);
 gl_FragColor = encodeHDR(vec4(vec3(luminance), 1.0));
}
@end
@export clay.compositor.hdr.lum_adaption
varying vec2 v_Texcoord;
uniform sampler2D adaptedLum;
uniform sampler2D currentLum;
uniform float frameTime : 0.02;
@import clay.util.rgbm
void main()
{
 float fAdaptedLum = decodeHDR(texture2D(adaptedLum, vec2(0.5, 0.5))).r;
 float fCurrentLum = exp(encodeHDR(texture2D(currentLum, vec2(0.5, 0.5))).r);
 fAdaptedLum += (fCurrentLum - fAdaptedLum) * (1.0 - pow(0.98, 30.0 * frameTime));
 gl_FragColor = encodeHDR(vec4(vec3(fAdaptedLum), 1.0));
}
@end
@export clay.compositor.lum
varying vec2 v_Texcoord;
uniform sampler2D texture;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord );
 float luminance = dot(tex.rgb, w);
 gl_FragColor = vec4(vec3(luminance), 1.0);
}
@end`;var __=`
@export clay.compositor.lut
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform sampler2D lookup;
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 float blueColor = tex.b * 63.0;
 vec2 quad1;
 quad1.y = floor(floor(blueColor) / 8.0);
 quad1.x = floor(blueColor) - (quad1.y * 8.0);
 vec2 quad2;
 quad2.y = floor(ceil(blueColor) / 8.0);
 quad2.x = ceil(blueColor) - (quad2.y * 8.0);
 vec2 texPos1;
 texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.r);
 texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.g);
 vec2 texPos2;
 texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.r);
 texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.g);
 vec4 newColor1 = texture2D(lookup, texPos1);
 vec4 newColor2 = texture2D(lookup, texPos2);
 vec4 newColor = mix(newColor1, newColor2, fract(blueColor));
 gl_FragColor = vec4(newColor.rgb, tex.w);
}
@end`;var wP=`@export clay.compositor.vignette
#define OUTPUT_ALPHA
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float darkness: 1;
uniform float offset: 1;
@import clay.util.rgbm
void main()
{
 vec4 texel = decodeHDR(texture2D(texture, v_Texcoord));
 gl_FragColor.rgb = texel.rgb;
 vec2 uv = (v_Texcoord - vec2(0.5)) * vec2(offset);
 gl_FragColor = encodeHDR(vec4(mix(texel.rgb, vec3(1.0 - darkness), dot(uv, uv)), texel.a));
}
@end`;var b_=`@export clay.compositor.output
#define OUTPUT_ALPHA
varying vec2 v_Texcoord;
uniform sampler2D texture;
@import clay.util.rgbm
void main()
{
 vec4 tex = decodeHDR(texture2D(texture, v_Texcoord));
 gl_FragColor.rgb = tex.rgb;
#ifdef OUTPUT_ALPHA
 gl_FragColor.a = tex.a;
#else
 gl_FragColor.a = 1.0;
#endif
 gl_FragColor = encodeHDR(gl_FragColor);
#ifdef PREMULTIPLY_ALPHA
 gl_FragColor.rgb *= gl_FragColor.a;
#endif
}
@end`;var x_=`@export clay.compositor.bright
uniform sampler2D texture;
uniform float threshold : 1;
uniform float scale : 1.0;
uniform vec2 textureSize: [512, 512];
varying vec2 v_Texcoord;
const vec3 lumWeight = vec3(0.2125, 0.7154, 0.0721);
@import clay.util.rgbm
vec4 median(vec4 a, vec4 b, vec4 c)
{
 return a + b + c - min(min(a, b), c) - max(max(a, b), c);
}
void main()
{
 vec4 texel = decodeHDR(texture2D(texture, v_Texcoord));
#ifdef ANTI_FLICKER
 vec3 d = 1.0 / textureSize.xyx * vec3(1.0, 1.0, 0.0);
 vec4 s1 = decodeHDR(texture2D(texture, v_Texcoord - d.xz));
 vec4 s2 = decodeHDR(texture2D(texture, v_Texcoord + d.xz));
 vec4 s3 = decodeHDR(texture2D(texture, v_Texcoord - d.zy));
 vec4 s4 = decodeHDR(texture2D(texture, v_Texcoord + d.zy));
 texel = median(median(texel, s1, s2), s3, s4);
#endif
 float lum = dot(texel.rgb , lumWeight);
 vec4 color;
 if (lum > threshold && texel.a > 0.0)
 {
 color = vec4(texel.rgb * scale, texel.a * scale);
 }
 else
 {
 color = vec4(0.0);
 }
 gl_FragColor = encodeHDR(color);
}
@end
`;var y_=`@export clay.compositor.downsample
uniform sampler2D texture;
uniform vec2 textureSize : [512, 512];
varying vec2 v_Texcoord;
@import clay.util.rgbm
float brightness(vec3 c)
{
 return max(max(c.r, c.g), c.b);
}
@import clay.util.clamp_sample
void main()
{
 vec4 d = vec4(-1.0, -1.0, 1.0, 1.0) / textureSize.xyxy;
#ifdef ANTI_FLICKER
 vec3 s1 = decodeHDR(clampSample(texture, v_Texcoord + d.xy)).rgb;
 vec3 s2 = decodeHDR(clampSample(texture, v_Texcoord + d.zy)).rgb;
 vec3 s3 = decodeHDR(clampSample(texture, v_Texcoord + d.xw)).rgb;
 vec3 s4 = decodeHDR(clampSample(texture, v_Texcoord + d.zw)).rgb;
 float s1w = 1.0 / (brightness(s1) + 1.0);
 float s2w = 1.0 / (brightness(s2) + 1.0);
 float s3w = 1.0 / (brightness(s3) + 1.0);
 float s4w = 1.0 / (brightness(s4) + 1.0);
 float oneDivideSum = 1.0 / (s1w + s2w + s3w + s4w);
 vec4 color = vec4(
 (s1 * s1w + s2 * s2w + s3 * s3w + s4 * s4w) * oneDivideSum,
 1.0
 );
#else
 vec4 color = decodeHDR(clampSample(texture, v_Texcoord + d.xy));
 color += decodeHDR(clampSample(texture, v_Texcoord + d.zy));
 color += decodeHDR(clampSample(texture, v_Texcoord + d.xw));
 color += decodeHDR(clampSample(texture, v_Texcoord + d.zw));
 color *= 0.25;
#endif
 gl_FragColor = encodeHDR(color);
}
@end`;var w_=`
@export clay.compositor.upsample
#define HIGH_QUALITY
uniform sampler2D texture;
uniform vec2 textureSize : [512, 512];
uniform float sampleScale: 0.5;
varying vec2 v_Texcoord;
@import clay.util.rgbm
@import clay.util.clamp_sample
void main()
{
#ifdef HIGH_QUALITY
 vec4 d = vec4(1.0, 1.0, -1.0, 0.0) / textureSize.xyxy * sampleScale;
 vec4 s;
 s = decodeHDR(clampSample(texture, v_Texcoord - d.xy));
 s += decodeHDR(clampSample(texture, v_Texcoord - d.wy)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord - d.zy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zw)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord )) * 4.0;
 s += decodeHDR(clampSample(texture, v_Texcoord + d.xw)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.wy)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord + d.xy));
 gl_FragColor = encodeHDR(s / 16.0);
#else
 vec4 d = vec4(-1.0, -1.0, +1.0, +1.0) / textureSize.xyxy;
 vec4 s;
 s = decodeHDR(clampSample(texture, v_Texcoord + d.xy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.xw));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zw));
 gl_FragColor = encodeHDR(s / 4.0);
#endif
}
@end`;var C_=`@export clay.compositor.hdr.composite
#define TONEMAPPING
uniform sampler2D texture;
#ifdef BLOOM_ENABLED
uniform sampler2D bloom;
#endif
#ifdef LENSFLARE_ENABLED
uniform sampler2D lensflare;
uniform sampler2D lensdirt;
#endif
#ifdef LUM_ENABLED
uniform sampler2D lum;
#endif
#ifdef LUT_ENABLED
uniform sampler2D lut;
#endif
#ifdef COLOR_CORRECTION
uniform float brightness : 0.0;
uniform float contrast : 1.0;
uniform float saturation : 1.0;
#endif
#ifdef VIGNETTE
uniform float vignetteDarkness: 1.0;
uniform float vignetteOffset: 1.0;
#endif
uniform float exposure : 1.0;
uniform float bloomIntensity : 0.25;
uniform float lensflareIntensity : 1;
varying vec2 v_Texcoord;
@import clay.util.srgb
vec3 ACESToneMapping(vec3 color)
{
 const float A = 2.51;
 const float B = 0.03;
 const float C = 2.43;
 const float D = 0.59;
 const float E = 0.14;
 return (color * (A * color + B)) / (color * (C * color + D) + E);
}
float eyeAdaption(float fLum)
{
 return mix(0.2, fLum, 0.5);
}
#ifdef LUT_ENABLED
vec3 lutTransform(vec3 color) {
 float blueColor = color.b * 63.0;
 vec2 quad1;
 quad1.y = floor(floor(blueColor) / 8.0);
 quad1.x = floor(blueColor) - (quad1.y * 8.0);
 vec2 quad2;
 quad2.y = floor(ceil(blueColor) / 8.0);
 quad2.x = ceil(blueColor) - (quad2.y * 8.0);
 vec2 texPos1;
 texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.r);
 texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.g);
 vec2 texPos2;
 texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.r);
 texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.g);
 vec4 newColor1 = texture2D(lut, texPos1);
 vec4 newColor2 = texture2D(lut, texPos2);
 vec4 newColor = mix(newColor1, newColor2, fract(blueColor));
 return newColor.rgb;
}
#endif
@import clay.util.rgbm
void main()
{
 vec4 texel = vec4(0.0);
 vec4 originalTexel = vec4(0.0);
#ifdef TEXTURE_ENABLED
 texel = decodeHDR(texture2D(texture, v_Texcoord));
 originalTexel = texel;
#endif
#ifdef BLOOM_ENABLED
 vec4 bloomTexel = decodeHDR(texture2D(bloom, v_Texcoord));
 texel.rgb += bloomTexel.rgb * bloomIntensity;
 texel.a += bloomTexel.a * bloomIntensity;
#endif
#ifdef LENSFLARE_ENABLED
 texel += decodeHDR(texture2D(lensflare, v_Texcoord)) * texture2D(lensdirt, v_Texcoord) * lensflareIntensity;
#endif
 texel.a = min(texel.a, 1.0);
#ifdef LUM_ENABLED
 float fLum = texture2D(lum, vec2(0.5, 0.5)).r;
 float adaptedLumDest = 3.0 / (max(0.1, 1.0 + 10.0*eyeAdaption(fLum)));
 float exposureBias = adaptedLumDest * exposure;
#else
 float exposureBias = exposure;
#endif
#ifdef TONEMAPPING
 texel.rgb *= exposureBias;
 texel.rgb = ACESToneMapping(texel.rgb);
#endif
 texel = linearTosRGB(texel);
#ifdef LUT_ENABLED
 texel.rgb = lutTransform(clamp(texel.rgb,vec3(0.0),vec3(1.0)));
#endif
#ifdef COLOR_CORRECTION
 texel.rgb = clamp(texel.rgb + vec3(brightness), 0.0, 1.0);
 texel.rgb = clamp((texel.rgb - vec3(0.5))*contrast+vec3(0.5), 0.0, 1.0);
 float lum = dot(texel.rgb, vec3(0.2125, 0.7154, 0.0721));
 texel.rgb = mix(vec3(lum), texel.rgb, saturation);
#endif
#ifdef VIGNETTE
 vec2 uv = (v_Texcoord - vec2(0.5)) * vec2(vignetteOffset);
 texel.rgb = mix(texel.rgb, vec3(1.0 - vignetteDarkness), dot(uv, uv));
#endif
 gl_FragColor = encodeHDR(texel);
#ifdef DEBUG
 #if DEBUG == 1
 gl_FragColor = encodeHDR(decodeHDR(texture2D(texture, v_Texcoord)));
 #elif DEBUG == 2
 gl_FragColor = encodeHDR(decodeHDR(texture2D(bloom, v_Texcoord)) * bloomIntensity);
 #elif DEBUG == 3
 gl_FragColor = encodeHDR(decodeHDR(texture2D(lensflare, v_Texcoord) * lensflareIntensity));
 #endif
#endif
 if (originalTexel.a <= 0.01 && gl_FragColor.a > 1e-5) {
 gl_FragColor.a = dot(gl_FragColor.rgb, vec3(0.2125, 0.7154, 0.0721));
 }
#ifdef PREMULTIPLY_ALPHA
 gl_FragColor.rgb *= gl_FragColor.a;
#endif
}
@end`;var CP=`@export clay.compositor.lensflare
#define SAMPLE_NUMBER 8
uniform sampler2D texture;
uniform sampler2D lenscolor;
uniform vec2 textureSize : [512, 512];
uniform float dispersal : 0.3;
uniform float haloWidth : 0.4;
uniform float distortion : 1.0;
varying vec2 v_Texcoord;
@import clay.util.rgbm
vec4 textureDistorted(
 in vec2 texcoord,
 in vec2 direction,
 in vec3 distortion
) {
 return vec4(
 decodeHDR(texture2D(texture, texcoord + direction * distortion.r)).r,
 decodeHDR(texture2D(texture, texcoord + direction * distortion.g)).g,
 decodeHDR(texture2D(texture, texcoord + direction * distortion.b)).b,
 1.0
 );
}
void main()
{
 vec2 texcoord = -v_Texcoord + vec2(1.0); vec2 textureOffset = 1.0 / textureSize;
 vec2 ghostVec = (vec2(0.5) - texcoord) * dispersal;
 vec2 haloVec = normalize(ghostVec) * haloWidth;
 vec3 distortion = vec3(-textureOffset.x * distortion, 0.0, textureOffset.x * distortion);
 vec4 result = vec4(0.0);
 for (int i = 0; i < SAMPLE_NUMBER; i++)
 {
 vec2 offset = fract(texcoord + ghostVec * float(i));
 float weight = length(vec2(0.5) - offset) / length(vec2(0.5));
 weight = pow(1.0 - weight, 10.0);
 result += textureDistorted(offset, normalize(ghostVec), distortion) * weight;
 }
 result *= texture2D(lenscolor, vec2(length(vec2(0.5) - texcoord)) / length(vec2(0.5)));
 float weight = length(vec2(0.5) - fract(texcoord + haloVec)) / length(vec2(0.5));
 weight = pow(1.0 - weight, 10.0);
 vec2 offset = fract(texcoord + haloVec);
 result += textureDistorted(offset, normalize(ghostVec), distortion) * weight;
 gl_FragColor = result;
}
@end`;var E_=`@export clay.compositor.blend
#define SHADER_NAME blend
#ifdef TEXTURE1_ENABLED
uniform sampler2D texture1;
uniform float weight1 : 1.0;
#endif
#ifdef TEXTURE2_ENABLED
uniform sampler2D texture2;
uniform float weight2 : 1.0;
#endif
#ifdef TEXTURE3_ENABLED
uniform sampler2D texture3;
uniform float weight3 : 1.0;
#endif
#ifdef TEXTURE4_ENABLED
uniform sampler2D texture4;
uniform float weight4 : 1.0;
#endif
#ifdef TEXTURE5_ENABLED
uniform sampler2D texture5;
uniform float weight5 : 1.0;
#endif
#ifdef TEXTURE6_ENABLED
uniform sampler2D texture6;
uniform float weight6 : 1.0;
#endif
varying vec2 v_Texcoord;
@import clay.util.rgbm
void main()
{
 vec4 tex = vec4(0.0);
#ifdef TEXTURE1_ENABLED
 tex += decodeHDR(texture2D(texture1, v_Texcoord)) * weight1;
#endif
#ifdef TEXTURE2_ENABLED
 tex += decodeHDR(texture2D(texture2, v_Texcoord)) * weight2;
#endif
#ifdef TEXTURE3_ENABLED
 tex += decodeHDR(texture2D(texture3, v_Texcoord)) * weight3;
#endif
#ifdef TEXTURE4_ENABLED
 tex += decodeHDR(texture2D(texture4, v_Texcoord)) * weight4;
#endif
#ifdef TEXTURE5_ENABLED
 tex += decodeHDR(texture2D(texture5, v_Texcoord)) * weight5;
#endif
#ifdef TEXTURE6_ENABLED
 tex += decodeHDR(texture2D(texture6, v_Texcoord)) * weight6;
#endif
 gl_FragColor = encodeHDR(tex);
}
@end`;var S_=`@export clay.compositor.fxaa
uniform sampler2D texture;
uniform vec4 viewport : VIEWPORT;
varying vec2 v_Texcoord;
#define FXAA_REDUCE_MIN (1.0/128.0)
#define FXAA_REDUCE_MUL (1.0/8.0)
#define FXAA_SPAN_MAX 8.0
@import clay.util.rgbm
void main()
{
 vec2 resolution = 1.0 / viewport.zw;
 vec3 rgbNW = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * resolution ) ).xyz;
 vec3 rgbNE = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * resolution ) ).xyz;
 vec3 rgbSW = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * resolution ) ).xyz;
 vec3 rgbSE = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * resolution ) ).xyz;
 vec4 rgbaM = decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution ) );
 vec3 rgbM = rgbaM.xyz;
 float opacity = rgbaM.w;
 vec3 luma = vec3( 0.299, 0.587, 0.114 );
 float lumaNW = dot( rgbNW, luma );
 float lumaNE = dot( rgbNE, luma );
 float lumaSW = dot( rgbSW, luma );
 float lumaSE = dot( rgbSE, luma );
 float lumaM = dot( rgbM, luma );
 float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );
 float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );
 vec2 dir;
 dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
 dir.y = ((lumaNW + lumaSW) - (lumaNE + lumaSE));
 float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );
 float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );
 dir = min( vec2( FXAA_SPAN_MAX, FXAA_SPAN_MAX),
 max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
 dir * rcpDirMin)) * resolution;
 vec3 rgbA = decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * ( 1.0 / 3.0 - 0.5 ) ) ).xyz;
 rgbA += decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * ( 2.0 / 3.0 - 0.5 ) ) ).xyz;
 rgbA *= 0.5;
 vec3 rgbB = decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * -0.5 ) ).xyz;
 rgbB += decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * 0.5 ) ).xyz;
 rgbB *= 0.25;
 rgbB += rgbA * 0.5;
 float lumaB = dot( rgbB, luma );
 if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) )
 {
 gl_FragColor = vec4( rgbA, opacity );
 }
 else {
 gl_FragColor = vec4( rgbB, opacity );
 }
}
@end`;function oC(e){e.import(xP),e.import(v_),e.import(yP),e.import(__),e.import(wP),e.import(b_),e.import(x_),e.import(y_),e.import(w_),e.import(C_),e.import(CP),e.import(E_),e.import(S_)}oC(Re);var wG=/^#source\((.*?)\)/;function CG(e,t){var i=new gP;t=t||{};var r={textures:{},parameters:{}},n=function(s,l){for(var c=0;c<e.nodes.length;c++){var d=e.nodes[c],u=EG(d,r,t);u&&i.addNode(u)}};for(var a in e.parameters){var o=e.parameters[a];r.parameters[a]=sC(o)}return TG(e,r,t,function(s){r.textures=s,n()}),i}function EG(e,t,i){var r=e.type||"filter",n,a,o;if(r==="filter"){var s=e.shader.trim(),l=wG.exec(s);if(l?n=Re.source(l[1].trim()):s.charAt(0)==="#"&&(n=t.shaders[s.substr(1)]),n||(n=s),!n)return}if(e.inputs){a={};for(var c in e.inputs)typeof e.inputs[c]=="string"?a[c]=e.inputs[c]:a[c]={node:e.inputs[c].node,pin:e.inputs[c].pin}}if(e.outputs){o={};for(var c in e.outputs){var d=e.outputs[c];o[c]={},d.attachment!=null&&(o[c].attachment=d.attachment),d.keepLastFrame!=null&&(o[c].keepLastFrame=d.keepLastFrame),d.outputLastFrame!=null&&(o[c].outputLastFrame=d.outputLastFrame),d.parameters&&(o[c].parameters=sC(d.parameters))}}var u;if(r==="scene"?u=new vP({name:e.name,scene:i.scene,camera:i.camera,outputs:o}):r==="texture"?u=new _P({name:e.name,outputs:o}):u=new bP({name:e.name,shader:n,inputs:a,outputs:o}),u){if(e.parameters)for(var c in e.parameters){var h=e.parameters[c];typeof h=="string"?(h=h.trim(),h.charAt(0)==="#"?h=t.textures[h.substr(1)]:u.on("beforerender",DG(c,EP(h)))):typeof h=="function"&&u.on("beforerender",h),u.setParameter(c,h)}if(e.defines&&u.pass)for(var c in e.defines){var h=e.defines[c];u.pass.material.define("fragment",c,h)}}return u}function SG(e,t){return e}function AG(e,t){return t}function sC(e){var t={};if(!e)return t;["type","minFilter","magFilter","wrapS","wrapT","flipY","useMipmap"].forEach(function(r){var n=e[r];n!=null&&(typeof n=="string"&&(n=qe[n]),t[r]=n)});var i=e.scale||1;return["width","height"].forEach(function(r){if(e[r]!=null){var n=e[r];typeof n=="string"?(n=n.trim(),t[r]=MG(r,EP(n),i)):t[r]=n}}),t.width||(t.width=SG),t.height||(t.height=AG),e.useMipmap!=null&&(t.useMipmap=e.useMipmap),t}function TG(e,t,i,r){if(!e.textures){r({});return}var n={},a=0,o=!1,s=i.textureRootPath;vr.each(e.textures,function(l,c){var d,u=l.path,h=sC(l.parameters);if(Array.isArray(u)&&u.length===6)s&&(u=u.map(function(m){return vr.relative2absolute(m,s)})),d=new ml(h);else if(typeof u=="string")s&&(u=vr.relative2absolute(u,s)),d=new ct(h);else return;d.load(u),a++,d.once("success",function(){n[c]=d,a--,a===0&&(r(n),o=!0)})}),a===0&&!o&&r(n)}function DG(e,t){return function(i){var r=i.getDevicePixelRatio(),n=i.getWidth(),a=i.getHeight(),o=t(n,a,r);this.setParameter(e,o)}}function MG(e,t,i){return i=i||1,function(r){var n=r.getDevicePixelRatio(),a=r.getWidth()*i,o=r.getHeight()*i;return t(a,o,n)}}function EP(e){var t=/^expr\((.*)\)$/.exec(e);if(t)try{var i=new Function("width","height","dpr","return "+t[1]);return i(1,1),i}catch{throw new Error("Invalid expression.")}}var SP=CG;var AP=SP;function IG(e,t){for(var i=0,r=1/t,n=e;n>0;)i=i+r*(n%t),n=Math.floor(n/t),r=r/t;return i}var vl=IG;var TP=`@export ecgl.ssao.estimate

uniform sampler2D depthTex;

uniform sampler2D normalTex;

uniform sampler2D noiseTex;

uniform vec2 depthTexSize;

uniform vec2 noiseTexSize;

uniform mat4 projection;

uniform mat4 projectionInv;

uniform mat4 viewInverseTranspose;

uniform vec3 kernel[KERNEL_SIZE];

uniform float radius : 1;

uniform float power : 1;

uniform float bias: 1e-2;

uniform float intensity: 1.0;

varying vec2 v_Texcoord;

float ssaoEstimator(in vec3 originPos, in mat3 kernelBasis) {
 float occlusion = 0.0;

 for (int i = 0; i < KERNEL_SIZE; i++) {
 vec3 samplePos = kernel[i];
#ifdef NORMALTEX_ENABLED
 samplePos = kernelBasis * samplePos;
#endif
 samplePos = samplePos * radius + originPos;

 vec4 texCoord = projection * vec4(samplePos, 1.0);
 texCoord.xy /= texCoord.w;

 vec4 depthTexel = texture2D(depthTex, texCoord.xy * 0.5 + 0.5);

 float sampleDepth = depthTexel.r * 2.0 - 1.0;
 if (projection[3][3] == 0.0) {
 sampleDepth = projection[3][2] / (sampleDepth * projection[2][3] - projection[2][2]);
 }
 else {
 sampleDepth = (sampleDepth - projection[3][2]) / projection[2][2];
 }
 
 float rangeCheck = smoothstep(0.0, 1.0, radius / abs(originPos.z - sampleDepth));
 occlusion += rangeCheck * step(samplePos.z, sampleDepth - bias);
 }
#ifdef NORMALTEX_ENABLED
 occlusion = 1.0 - occlusion / float(KERNEL_SIZE);
#else
 occlusion = 1.0 - clamp((occlusion / float(KERNEL_SIZE) - 0.6) * 2.5, 0.0, 1.0);
#endif
 return pow(occlusion, power);
}

void main()
{

 vec4 depthTexel = texture2D(depthTex, v_Texcoord);

#ifdef NORMALTEX_ENABLED
 vec4 tex = texture2D(normalTex, v_Texcoord);
 if (dot(tex.rgb, tex.rgb) == 0.0) {
 gl_FragColor = vec4(1.0);
 return;
 }
 vec3 N = tex.rgb * 2.0 - 1.0;
 N = (viewInverseTranspose * vec4(N, 0.0)).xyz;

 vec2 noiseTexCoord = depthTexSize / vec2(noiseTexSize) * v_Texcoord;
 vec3 rvec = texture2D(noiseTex, noiseTexCoord).rgb * 2.0 - 1.0;
 vec3 T = normalize(rvec - N * dot(rvec, N));
 vec3 BT = normalize(cross(N, T));
 mat3 kernelBasis = mat3(T, BT, N);
#else
 if (depthTexel.r > 0.99999) {
 gl_FragColor = vec4(1.0);
 return;
 }
 mat3 kernelBasis;
#endif

 float z = depthTexel.r * 2.0 - 1.0;

 vec4 projectedPos = vec4(v_Texcoord * 2.0 - 1.0, z, 1.0);
 vec4 p4 = projectionInv * projectedPos;

 vec3 position = p4.xyz / p4.w;

 float ao = ssaoEstimator(position, kernelBasis);
 ao = clamp(1.0 - (1.0 - ao) * intensity, 0.0, 1.0);
 gl_FragColor = vec4(vec3(ao), 1.0);
}

@end


@export ecgl.ssao.blur
#define SHADER_NAME SSAO_BLUR

uniform sampler2D ssaoTexture;

#ifdef NORMALTEX_ENABLED
uniform sampler2D normalTex;
#endif

varying vec2 v_Texcoord;

uniform vec2 textureSize;
uniform float blurSize : 1.0;

uniform int direction: 0.0;

#ifdef DEPTHTEX_ENABLED
uniform sampler2D depthTex;
uniform mat4 projection;
uniform float depthRange : 0.5;

float getLinearDepth(vec2 coord)
{
 float depth = texture2D(depthTex, coord).r * 2.0 - 1.0;
 return projection[3][2] / (depth * projection[2][3] - projection[2][2]);
}
#endif

void main()
{
 float kernel[5];
 kernel[0] = 0.122581;
 kernel[1] = 0.233062;
 kernel[2] = 0.288713;
 kernel[3] = 0.233062;
 kernel[4] = 0.122581;

 vec2 off = vec2(0.0);
 if (direction == 0) {
 off[0] = blurSize / textureSize.x;
 }
 else {
 off[1] = blurSize / textureSize.y;
 }

 vec2 coord = v_Texcoord;

 float sum = 0.0;
 float weightAll = 0.0;

#ifdef NORMALTEX_ENABLED
 vec3 centerNormal = texture2D(normalTex, v_Texcoord).rgb * 2.0 - 1.0;
#endif
#if defined(DEPTHTEX_ENABLED)
 float centerDepth = getLinearDepth(v_Texcoord);
#endif

 for (int i = 0; i < 5; i++) {
 vec2 coord = clamp(v_Texcoord + vec2(float(i) - 2.0) * off, vec2(0.0), vec2(1.0));

 float w = kernel[i];
#ifdef NORMALTEX_ENABLED
 vec3 normal = texture2D(normalTex, coord).rgb * 2.0 - 1.0;
 w *= clamp(dot(normal, centerNormal), 0.0, 1.0);
#endif
#ifdef DEPTHTEX_ENABLED
 float d = getLinearDepth(coord);
 w *= (1.0 - smoothstep(abs(centerDepth - d) / depthRange, 0.0, 1.0));
#endif

 weightAll += w;
 sum += texture2D(ssaoTexture, coord).r * w;
 }

 gl_FragColor = vec4(vec3(sum / weightAll), 1.0);
}

@end
`;Re.import(TP);function MP(e){for(var t=new Uint8Array(e*e*4),i=0,r=new Se,n=0;n<e;n++)for(var a=0;a<e;a++)r.set(Math.random()*2-1,Math.random()*2-1,0).normalize(),t[i++]=(r.x*.5+.5)*255,t[i++]=(r.y*.5+.5)*255,t[i++]=0,t[i++]=255;return t}function DP(e){return new ct({pixels:MP(e),wrapS:qe.REPEAT,wrapT:qe.REPEAT,width:e,height:e})}function kG(e,t,i){var r=new Float32Array(e*3);t=t||0;for(var n=0;n<e;n++){var a=vl(n+t,2)*(i?1:2)*Math.PI,o=vl(n+t,3)*Math.PI,s=Math.random(),l=Math.cos(a)*Math.sin(o)*s,c=Math.cos(o)*s,d=Math.sin(a)*Math.sin(o)*s;r[n*3]=l,r[n*3+1]=c,r[n*3+2]=d}return r}function _l(e){e=e||{},this._ssaoPass=new Oi({fragment:Re.source("ecgl.ssao.estimate")}),this._blurPass=new Oi({fragment:Re.source("ecgl.ssao.blur")}),this._framebuffer=new ki({depthBuffer:!1}),this._ssaoTexture=new ct,this._blurTexture=new ct,this._blurTexture2=new ct,this._depthTex=e.depthTexture,this._normalTex=e.normalTexture,this.setNoiseSize(4),this.setKernelSize(e.kernelSize||12),e.radius!=null&&this.setParameter("radius",e.radius),e.power!=null&&this.setParameter("power",e.power),this._normalTex||(this._ssaoPass.material.disableTexture("normalTex"),this._blurPass.material.disableTexture("normalTex")),this._depthTex||this._blurPass.material.disableTexture("depthTex"),this._blurPass.material.setUniform("normalTex",this._normalTex),this._blurPass.material.setUniform("depthTex",this._depthTex)}_l.prototype.setDepthTexture=function(e){this._depthTex=e};_l.prototype.setNormalTexture=function(e){this._normalTex=e,this._ssaoPass.material[e?"enableTexture":"disableTexture"]("normalTex"),this.setKernelSize(this._kernelSize)};_l.prototype.update=function(e,t,i){var r=e.getWidth(),n=e.getHeight(),a=this._ssaoPass,o=this._blurPass;a.setUniform("kernel",this._kernels[i%this._kernels.length]),a.setUniform("depthTex",this._depthTex),this._normalTex!=null&&a.setUniform("normalTex",this._normalTex),a.setUniform("depthTexSize",[this._depthTex.width,this._depthTex.height]);var s=new Ye;Ye.transpose(s,t.worldTransform),a.setUniform("projection",t.projectionMatrix.array),a.setUniform("projectionInv",t.invProjectionMatrix.array),a.setUniform("viewInverseTranspose",s.array);var l=this._ssaoTexture,c=this._blurTexture,d=this._blurTexture2;l.width=r/2,l.height=n/2,c.width=r,c.height=n,d.width=r,d.height=n,this._framebuffer.attach(l),this._framebuffer.bind(e),e.gl.clearColor(1,1,1,1),e.gl.clear(e.gl.COLOR_BUFFER_BIT),a.render(e),o.setUniform("textureSize",[r/2,n/2]),o.setUniform("projection",t.projectionMatrix.array),this._framebuffer.attach(c),o.setUniform("direction",0),o.setUniform("ssaoTexture",l),o.render(e),this._framebuffer.attach(d),o.setUniform("textureSize",[r,n]),o.setUniform("direction",1),o.setUniform("ssaoTexture",c),o.render(e),this._framebuffer.unbind(e);var u=e.clearColor;e.gl.clearColor(u[0],u[1],u[2],u[3])};_l.prototype.getTargetTexture=function(){return this._blurTexture2};_l.prototype.setParameter=function(e,t){e==="noiseTexSize"?this.setNoiseSize(t):e==="kernelSize"?this.setKernelSize(t):e==="intensity"?this._ssaoPass.material.set("intensity",t):this._ssaoPass.setUniform(e,t)};_l.prototype.setKernelSize=function(e){this._kernelSize=e,this._ssaoPass.material.define("fragment","KERNEL_SIZE",e),this._kernels=this._kernels||[];for(var t=0;t<30;t++)this._kernels[t]=kG(e,t*e,!!this._normalTex)};_l.prototype.setNoiseSize=function(e){var t=this._ssaoPass.getUniform("noiseTex");t?(t.data=MP(e),t.width=t.height=e,t.dirty()):(t=DP(e),this._ssaoPass.setUniform("noiseTex",DP(e))),this._ssaoPass.setUniform("noiseTexSize",[e,e])};_l.prototype.dispose=function(e){this._blurTexture.dispose(e),this._ssaoTexture.dispose(e),this._blurTexture2.dispose(e)};var IP=_l;var kP=`@export ecgl.ssr.main

#define SHADER_NAME SSR
#define MAX_ITERATION 20;
#define SAMPLE_PER_FRAME 5;
#define TOTAL_SAMPLES 128;

uniform sampler2D sourceTexture;
uniform sampler2D gBufferTexture1;
uniform sampler2D gBufferTexture2;
uniform sampler2D gBufferTexture3;
uniform samplerCube specularCubemap;
uniform float specularIntensity: 1;

uniform mat4 projection;
uniform mat4 projectionInv;
uniform mat4 toViewSpace;
uniform mat4 toWorldSpace;

uniform float maxRayDistance: 200;

uniform float pixelStride: 16;
uniform float pixelStrideZCutoff: 50; 
uniform float screenEdgeFadeStart: 0.9; 
uniform float eyeFadeStart : 0.2; uniform float eyeFadeEnd: 0.8; 
uniform float minGlossiness: 0.2; uniform float zThicknessThreshold: 1;

uniform float nearZ;
uniform vec2 viewportSize : VIEWPORT_SIZE;

uniform float jitterOffset: 0;

varying vec2 v_Texcoord;

#ifdef DEPTH_DECODE
@import clay.util.decode_float
#endif

#ifdef PHYSICALLY_CORRECT
uniform sampler2D normalDistribution;
uniform float sampleOffset: 0;
uniform vec2 normalDistributionSize;

vec3 transformNormal(vec3 H, vec3 N) {
 vec3 upVector = N.y > 0.999 ? vec3(1.0, 0.0, 0.0) : vec3(0.0, 1.0, 0.0);
 vec3 tangentX = normalize(cross(N, upVector));
 vec3 tangentZ = cross(N, tangentX);
 return normalize(tangentX * H.x + N * H.y + tangentZ * H.z);
}
vec3 importanceSampleNormalGGX(float i, float roughness, vec3 N) {
 float p = fract((i + sampleOffset) / float(TOTAL_SAMPLES));
 vec3 H = texture2D(normalDistribution,vec2(roughness, p)).rgb;
 return transformNormal(H, N);
}
float G_Smith(float g, float ndv, float ndl) {
 float roughness = 1.0 - g;
 float k = roughness * roughness / 2.0;
 float G1V = ndv / (ndv * (1.0 - k) + k);
 float G1L = ndl / (ndl * (1.0 - k) + k);
 return G1L * G1V;
}
vec3 F_Schlick(float ndv, vec3 spec) {
 return spec + (1.0 - spec) * pow(1.0 - ndv, 5.0);
}
#endif

float fetchDepth(sampler2D depthTexture, vec2 uv)
{
 vec4 depthTexel = texture2D(depthTexture, uv);
 return depthTexel.r * 2.0 - 1.0;
}

float linearDepth(float depth)
{
 if (projection[3][3] == 0.0) {
 return projection[3][2] / (depth * projection[2][3] - projection[2][2]);
 }
 else {
 return (depth - projection[3][2]) / projection[2][2];
 }
}

bool rayIntersectDepth(float rayZNear, float rayZFar, vec2 hitPixel)
{
 if (rayZFar > rayZNear)
 {
 float t = rayZFar; rayZFar = rayZNear; rayZNear = t;
 }
 float cameraZ = linearDepth(fetchDepth(gBufferTexture2, hitPixel));
 return rayZFar <= cameraZ && rayZNear >= cameraZ - zThicknessThreshold;
}


bool traceScreenSpaceRay(
 vec3 rayOrigin, vec3 rayDir, float jitter,
 out vec2 hitPixel, out vec3 hitPoint, out float iterationCount
)
{
 float rayLength = ((rayOrigin.z + rayDir.z * maxRayDistance) > -nearZ)
 ? (-nearZ - rayOrigin.z) / rayDir.z : maxRayDistance;

 vec3 rayEnd = rayOrigin + rayDir * rayLength;

 vec4 H0 = projection * vec4(rayOrigin, 1.0);
 vec4 H1 = projection * vec4(rayEnd, 1.0);

 float k0 = 1.0 / H0.w, k1 = 1.0 / H1.w;

 vec3 Q0 = rayOrigin * k0, Q1 = rayEnd * k1;

 vec2 P0 = (H0.xy * k0 * 0.5 + 0.5) * viewportSize;
 vec2 P1 = (H1.xy * k1 * 0.5 + 0.5) * viewportSize;

 P1 += dot(P1 - P0, P1 - P0) < 0.0001 ? 0.01 : 0.0;
 vec2 delta = P1 - P0;

 bool permute = false;
 if (abs(delta.x) < abs(delta.y)) {
 permute = true;
 delta = delta.yx;
 P0 = P0.yx;
 P1 = P1.yx;
 }
 float stepDir = sign(delta.x);
 float invdx = stepDir / delta.x;

 vec3 dQ = (Q1 - Q0) * invdx;
 float dk = (k1 - k0) * invdx;

 vec2 dP = vec2(stepDir, delta.y * invdx);

 float strideScaler = 1.0 - min(1.0, -rayOrigin.z / pixelStrideZCutoff);
 float pixStride = 1.0 + strideScaler * pixelStride;

 dP *= pixStride; dQ *= pixStride; dk *= pixStride;

 vec4 pqk = vec4(P0, Q0.z, k0);
 vec4 dPQK = vec4(dP, dQ.z, dk);

 pqk += dPQK * jitter;
 float rayZFar = (dPQK.z * 0.5 + pqk.z) / (dPQK.w * 0.5 + pqk.w);
 float rayZNear;

 bool intersect = false;

 vec2 texelSize = 1.0 / viewportSize;

 iterationCount = 0.0;

 for (int i = 0; i < MAX_ITERATION; i++)
 {
 pqk += dPQK;

 rayZNear = rayZFar;
 rayZFar = (dPQK.z * 0.5 + pqk.z) / (dPQK.w * 0.5 + pqk.w);

 hitPixel = permute ? pqk.yx : pqk.xy;
 hitPixel *= texelSize;

 intersect = rayIntersectDepth(rayZNear, rayZFar, hitPixel);

 iterationCount += 1.0;

 dPQK *= 1.2;

 if (intersect) {
 break;
 }
 }

 Q0.xy += dQ.xy * iterationCount;
 Q0.z = pqk.z;
 hitPoint = Q0 / pqk.w;

 return intersect;
}

float calculateAlpha(
 float iterationCount, float reflectivity,
 vec2 hitPixel, vec3 hitPoint, float dist, vec3 rayDir
)
{
 float alpha = clamp(reflectivity, 0.0, 1.0);
 alpha *= 1.0 - (iterationCount / float(MAX_ITERATION));
 vec2 hitPixelNDC = hitPixel * 2.0 - 1.0;
 float maxDimension = min(1.0, max(abs(hitPixelNDC.x), abs(hitPixelNDC.y)));
 alpha *= 1.0 - max(0.0, maxDimension - screenEdgeFadeStart) / (1.0 - screenEdgeFadeStart);

 float _eyeFadeStart = eyeFadeStart;
 float _eyeFadeEnd = eyeFadeEnd;
 if (_eyeFadeStart > _eyeFadeEnd) {
 float tmp = _eyeFadeEnd;
 _eyeFadeEnd = _eyeFadeStart;
 _eyeFadeStart = tmp;
 }

 float eyeDir = clamp(rayDir.z, _eyeFadeStart, _eyeFadeEnd);
 alpha *= 1.0 - (eyeDir - _eyeFadeStart) / (_eyeFadeEnd - _eyeFadeStart);

 alpha *= 1.0 - clamp(dist / maxRayDistance, 0.0, 1.0);

 return alpha;
}

@import clay.util.rand

@import clay.util.rgbm

void main()
{
 vec4 normalAndGloss = texture2D(gBufferTexture1, v_Texcoord);

 if (dot(normalAndGloss.rgb, vec3(1.0)) == 0.0) {
 discard;
 }

 float g = normalAndGloss.a;
#if !defined(PHYSICALLY_CORRECT)
 if (g <= minGlossiness) {
 discard;
 }
#endif

 float reflectivity = (g - minGlossiness) / (1.0 - minGlossiness);

 vec3 N = normalize(normalAndGloss.rgb * 2.0 - 1.0);
 N = normalize((toViewSpace * vec4(N, 0.0)).xyz);

 vec4 projectedPos = vec4(v_Texcoord * 2.0 - 1.0, fetchDepth(gBufferTexture2, v_Texcoord), 1.0);
 vec4 pos = projectionInv * projectedPos;
 vec3 rayOrigin = pos.xyz / pos.w;
 vec3 V = -normalize(rayOrigin);

 float ndv = clamp(dot(N, V), 0.0, 1.0);
 float iterationCount;
 float jitter = rand(fract(v_Texcoord + jitterOffset));

#ifdef PHYSICALLY_CORRECT
 vec4 color = vec4(vec3(0.0), 1.0);
 vec4 albedoMetalness = texture2D(gBufferTexture3, v_Texcoord);
 vec3 albedo = albedoMetalness.rgb;
 float m = albedoMetalness.a;
 vec3 diffuseColor = albedo * (1.0 - m);
 vec3 spec = mix(vec3(0.04), albedo, m);

 float jitter2 = rand(fract(v_Texcoord)) * float(TOTAL_SAMPLES);

 for (int i = 0; i < SAMPLE_PER_FRAME; i++) {
 vec3 H = importanceSampleNormalGGX(float(i) + jitter2, 1.0 - g, N);
 vec3 rayDir = normalize(reflect(-V, H));
#else
 vec3 rayDir = normalize(reflect(-V, N));
#endif
 vec2 hitPixel;
 vec3 hitPoint;

 bool intersect = traceScreenSpaceRay(rayOrigin, rayDir, jitter, hitPixel, hitPoint, iterationCount);

 float dist = distance(rayOrigin, hitPoint);

 vec3 hitNormal = texture2D(gBufferTexture1, hitPixel).rgb * 2.0 - 1.0;
 hitNormal = normalize((toViewSpace * vec4(hitNormal, 0.0)).xyz);
#ifdef PHYSICALLY_CORRECT
 float ndl = clamp(dot(N, rayDir), 0.0, 1.0);
 float vdh = clamp(dot(V, H), 0.0, 1.0);
 float ndh = clamp(dot(N, H), 0.0, 1.0);
 vec3 litTexel = vec3(0.0);
 if (dot(hitNormal, rayDir) < 0.0 && intersect) {
 litTexel = texture2D(sourceTexture, hitPixel).rgb;
 litTexel *= pow(clamp(1.0 - dist / 200.0, 0.0, 1.0), 3.0);

 }
 else {
 #ifdef SPECULARCUBEMAP_ENABLED
 vec3 rayDirW = normalize(toWorldSpace * vec4(rayDir, 0.0)).rgb;
 litTexel = RGBMDecode(textureCubeLodEXT(specularCubemap, rayDirW, 0.0), 8.12).rgb * specularIntensity;
#endif
 }
 color.rgb += ndl * litTexel * (
 F_Schlick(ndl, spec) * G_Smith(g, ndv, ndl) * vdh / (ndh * ndv + 0.001)
 );
 }
 color.rgb /= float(SAMPLE_PER_FRAME);
#else
 #if !defined(SPECULARCUBEMAP_ENABLED)
 if (dot(hitNormal, rayDir) >= 0.0) {
 discard;
 }
 if (!intersect) {
 discard;
 }
#endif
 float alpha = clamp(calculateAlpha(iterationCount, reflectivity, hitPixel, hitPoint, dist, rayDir), 0.0, 1.0);
 vec4 color = texture2D(sourceTexture, hitPixel);
 color.rgb *= alpha;

#ifdef SPECULARCUBEMAP_ENABLED
 vec3 rayDirW = normalize(toWorldSpace * vec4(rayDir, 0.0)).rgb;
 alpha = alpha * (intersect ? 1.0 : 0.0);
 float bias = (1.0 -g) * 5.0;
 color.rgb += (1.0 - alpha)
 * RGBMDecode(textureCubeLodEXT(specularCubemap, rayDirW, bias), 8.12).rgb
 * specularIntensity;
#endif

#endif

 gl_FragColor = encodeHDR(color);
}
@end

@export ecgl.ssr.blur

uniform sampler2D texture;
uniform sampler2D gBufferTexture1;
uniform sampler2D gBufferTexture2;
uniform mat4 projection;
uniform float depthRange : 0.05;

varying vec2 v_Texcoord;

uniform vec2 textureSize;
uniform float blurSize : 1.0;

#ifdef BLEND
 #ifdef SSAOTEX_ENABLED
uniform sampler2D ssaoTex;
 #endif
uniform sampler2D sourceTexture;
#endif

float getLinearDepth(vec2 coord)
{
 float depth = texture2D(gBufferTexture2, coord).r * 2.0 - 1.0;
 return projection[3][2] / (depth * projection[2][3] - projection[2][2]);
}

@import clay.util.rgbm


void main()
{
 @import clay.compositor.kernel.gaussian_9

 vec4 centerNTexel = texture2D(gBufferTexture1, v_Texcoord);
 float g = centerNTexel.a;
 float maxBlurSize = clamp(1.0 - g, 0.0, 1.0) * blurSize;
#ifdef VERTICAL
 vec2 off = vec2(0.0, maxBlurSize / textureSize.y);
#else
 vec2 off = vec2(maxBlurSize / textureSize.x, 0.0);
#endif

 vec2 coord = v_Texcoord;

 vec4 sum = vec4(0.0);
 float weightAll = 0.0;

 vec3 cN = centerNTexel.rgb * 2.0 - 1.0;
 float cD = getLinearDepth(v_Texcoord);
 for (int i = 0; i < 9; i++) {
 vec2 coord = clamp((float(i) - 4.0) * off + v_Texcoord, vec2(0.0), vec2(1.0));
 float w = gaussianKernel[i]
 * clamp(dot(cN, texture2D(gBufferTexture1, coord).rgb * 2.0 - 1.0), 0.0, 1.0);
 float d = getLinearDepth(coord);
 w *= (1.0 - smoothstep(abs(cD - d) / depthRange, 0.0, 1.0));

 weightAll += w;
 sum += decodeHDR(texture2D(texture, coord)) * w;
 }

#ifdef BLEND
 float aoFactor = 1.0;
 #ifdef SSAOTEX_ENABLED
 aoFactor = texture2D(ssaoTex, v_Texcoord).r;
 #endif
 gl_FragColor = encodeHDR(
 sum / weightAll * aoFactor + decodeHDR(texture2D(sourceTexture, v_Texcoord))
 );
#else
 gl_FragColor = encodeHDR(sum / weightAll);
#endif
}

@end`;Re.import(kP);function bl(e){e=e||{},this._ssrPass=new Oi({fragment:Re.source("ecgl.ssr.main"),clearColor:[0,0,0,0]}),this._blurPass1=new Oi({fragment:Re.source("ecgl.ssr.blur"),clearColor:[0,0,0,0]}),this._blurPass2=new Oi({fragment:Re.source("ecgl.ssr.blur"),clearColor:[0,0,0,0]}),this._blendPass=new Oi({fragment:Re.source("clay.compositor.blend")}),this._blendPass.material.disableTexturesAll(),this._blendPass.material.enableTexture(["texture1","texture2"]),this._ssrPass.setUniform("gBufferTexture1",e.normalTexture),this._ssrPass.setUniform("gBufferTexture2",e.depthTexture),this._blurPass1.setUniform("gBufferTexture1",e.normalTexture),this._blurPass1.setUniform("gBufferTexture2",e.depthTexture),this._blurPass2.setUniform("gBufferTexture1",e.normalTexture),this._blurPass2.setUniform("gBufferTexture2",e.depthTexture),this._blurPass2.material.define("fragment","VERTICAL"),this._blurPass2.material.define("fragment","BLEND"),this._ssrTexture=new ct({type:qe.HALF_FLOAT}),this._texture2=new ct({type:qe.HALF_FLOAT}),this._texture3=new ct({type:qe.HALF_FLOAT}),this._prevTexture=new ct({type:qe.HALF_FLOAT}),this._currentTexture=new ct({type:qe.HALF_FLOAT}),this._frameBuffer=new ki({depthBuffer:!1}),this._normalDistribution=null,this._totalSamples=256,this._samplePerFrame=4,this._ssrPass.material.define("fragment","SAMPLE_PER_FRAME",this._samplePerFrame),this._ssrPass.material.define("fragment","TOTAL_SAMPLES",this._totalSamples),this._downScale=1}bl.prototype.setAmbientCubemap=function(e,t){this._ssrPass.material.set("specularCubemap",e),this._ssrPass.material.set("specularIntensity",t);var i=e&&t;this._ssrPass.material[i?"enableTexture":"disableTexture"]("specularCubemap")};bl.prototype.update=function(e,t,i,r){var n=e.getWidth(),a=e.getHeight(),o=this._ssrTexture,s=this._texture2,l=this._texture3;o.width=this._prevTexture.width=this._currentTexture.width=n/this._downScale,o.height=this._prevTexture.height=this._currentTexture.height=a/this._downScale,s.width=l.width=n,s.height=l.height=a;var c=this._frameBuffer,d=this._ssrPass,u=this._blurPass1,h=this._blurPass2,m=this._blendPass,f=new Ye,p=new Ye;Ye.transpose(f,t.worldTransform),Ye.transpose(p,t.viewMatrix),d.setUniform("sourceTexture",i),d.setUniform("projection",t.projectionMatrix.array),d.setUniform("projectionInv",t.invProjectionMatrix.array),d.setUniform("toViewSpace",f.array),d.setUniform("toWorldSpace",p.array),d.setUniform("nearZ",t.near);var g=r/this._totalSamples*this._samplePerFrame;if(d.setUniform("jitterOffset",g),d.setUniform("sampleOffset",r*this._samplePerFrame),u.setUniform("textureSize",[o.width,o.height]),h.setUniform("textureSize",[n,a]),h.setUniform("sourceTexture",i),u.setUniform("projection",t.projectionMatrix.array),h.setUniform("projection",t.projectionMatrix.array),c.attach(o),c.bind(e),d.render(e),this._physicallyCorrect&&(c.attach(this._currentTexture),m.setUniform("texture1",this._prevTexture),m.setUniform("texture2",o),m.material.set({weight1:r>=1?.95:0,weight2:r>=1?.05:1}),m.render(e)),c.attach(s),u.setUniform("texture",this._physicallyCorrect?this._currentTexture:o),u.render(e),c.attach(l),h.setUniform("texture",s),h.render(e),c.unbind(e),this._physicallyCorrect){var v=this._prevTexture;this._prevTexture=this._currentTexture,this._currentTexture=v}};bl.prototype.getTargetTexture=function(){return this._texture3};bl.prototype.setParameter=function(e,t){e==="maxIteration"?this._ssrPass.material.define("fragment","MAX_ITERATION",t):this._ssrPass.setUniform(e,t)};bl.prototype.setPhysicallyCorrect=function(e){e?(this._normalDistribution||(this._normalDistribution=Ih.generateNormalDistribution(64,this._totalSamples)),this._ssrPass.material.define("fragment","PHYSICALLY_CORRECT"),this._ssrPass.material.set("normalDistribution",this._normalDistribution),this._ssrPass.material.set("normalDistributionSize",[64,this._totalSamples])):this._ssrPass.material.undefine("fragment","PHYSICALLY_CORRECT"),this._physicallyCorrect=e};bl.prototype.setSSAOTexture=function(e){var t=this._blurPass2;e?(t.material.enableTexture("ssaoTex"),t.material.set("ssaoTex",e)):t.material.disableTexture("ssaoTex")};bl.prototype.isFinished=function(e){return this._physicallyCorrect?e>this._totalSamples/this._samplePerFrame:!0};bl.prototype.dispose=function(e){this._ssrTexture.dispose(e),this._texture2.dispose(e),this._texture3.dispose(e),this._prevTexture.dispose(e),this._currentTexture.dispose(e),this._frameBuffer.dispose(e)};var NP=bl;var lC=[0,0,-.321585265978,-.154972575841,.458126042375,.188473391593,.842080129861,.527766490688,.147304551086,-.659453822776,-.331943915203,-.940619700594,.0479226680259,.54812163202,.701581552186,-.709825561388,-.295436780218,.940589268233,-.901489676764,.237713156085,.973570876096,-.109899459384,-.866792314779,-.451805525005,.330975007087,.800048655954,-.344275183665,.381779221166,-.386139432542,-.437418421534,-.576478634965,-.0148463392551,.385798197415,-.262426961053,-.666302061145,.682427250835,-.628010632582,-.732836215494,.10163141741,-.987658134403,.711995289051,-.320024291314,.0296005138058,.950296523438,.0130612307608,-.351024443122,-.879596633704,-.10478487883,.435712737232,.504254490347,.779203817497,.206477676721,.388264289969,-.896736162545,-.153106280781,-.629203242522,-.245517550697,.657969239148,.126830499058,.26862328493,-.634888119007,-.302301223431,.617074219636,.779817204925];var PP=`@export ecgl.normal.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header

@import ecgl.common.attributes

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

@import ecgl.common.normalMap.vertexHeader

@import ecgl.common.vertexAnimation.header

void main()
{

 @import ecgl.common.vertexAnimation.main

 @import ecgl.common.uv.main

 v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);
 v_WorldPosition = (world * vec4(pos, 1.0)).xyz;

 @import ecgl.common.normalMap.vertexMain

 gl_Position = worldViewProjection * vec4(pos, 1.0);

}


@end


@export ecgl.normal.fragment

#define ROUGHNESS_CHANEL 0

uniform bool useBumpMap;
uniform bool useRoughnessMap;
uniform bool doubleSide;
uniform float roughness;

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform mat4 viewInverse : VIEWINVERSE;

@import ecgl.common.normalMap.fragmentHeader
@import ecgl.common.bumpMap.header

uniform sampler2D roughnessMap;

void main()
{
 vec3 N = v_Normal;
 
 bool flipNormal = false;
 if (doubleSide) {
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);

 if (dot(N, V) < 0.0) {
 flipNormal = true;
 }
 }

 @import ecgl.common.normalMap.fragmentMain

 if (useBumpMap) {
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 }

 float g = 1.0 - roughness;

 if (useRoughnessMap) {
 float g2 = 1.0 - texture2D(roughnessMap, v_DetailTexcoord)[ROUGHNESS_CHANEL];
 g = clamp(g2 + (g - 0.5) * 2.0, 0.0, 1.0);
 }

 if (flipNormal) {
 N = -N;
 }

 gl_FragColor.rgb = (N.xyz + 1.0) * 0.5;
 gl_FragColor.a = g;
}
@end`;Re.import(PP);function cC(e,t,i,r,n){var a=e.gl;t.setUniform(a,"1i",i,n),a.activeTexture(a.TEXTURE0+n),r.isRenderable()?r.bind(e):r.unbind(e)}function NG(e,t,i,r,n){var a,o,s,l,c=e.gl;return function(d,u,h){if(!(l&&l.material===d.material)){var m=d.material,f=d.__program,p=m.get("roughness");p==null&&(p=1);var g=m.get("normalMap")||t,v=m.get("roughnessMap"),b=m.get("bumpMap"),_=m.get("uvRepeat"),x=m.get("uvOffset"),w=m.get("detailUvRepeat"),y=m.get("detailUvOffset"),M=!!b&&m.isTextureEnabled("bumpMap"),T=!!v&&m.isTextureEnabled("roughnessMap"),C=m.isDefined("fragment","DOUBLE_SIDED");b=b||i,v=v||r,h!==u?(u.set("normalMap",g),u.set("bumpMap",b),u.set("roughnessMap",v),u.set("useBumpMap",M),u.set("useRoughnessMap",T),u.set("doubleSide",C),_!=null&&u.set("uvRepeat",_),x!=null&&u.set("uvOffset",x),w!=null&&u.set("detailUvRepeat",w),y!=null&&u.set("detailUvOffset",y),u.set("roughness",p)):(f.setUniform(c,"1f","roughness",p),a!==g&&cC(e,f,"normalMap",g,0),o!==b&&b&&cC(e,f,"bumpMap",b,1),s!==v&&v&&cC(e,f,"roughnessMap",v,2),_!=null&&f.setUniform(c,"2f","uvRepeat",_),x!=null&&f.setUniform(c,"2f","uvOffset",x),w!=null&&f.setUniform(c,"2f","detailUvRepeat",w),y!=null&&f.setUniform(c,"2f","detailUvOffset",y),f.setUniform(c,"1i","useBumpMap",+M),f.setUniform(c,"1i","useRoughnessMap",+T),f.setUniform(c,"1i","doubleSide",+C)),a=g,o=b,s=v,l=d}}}function Ph(e){e=e||{},this._depthTex=new ct({format:qe.DEPTH_COMPONENT,type:qe.UNSIGNED_INT}),this._normalTex=new ct({type:qe.HALF_FLOAT}),this._framebuffer=new ki,this._framebuffer.attach(this._normalTex),this._framebuffer.attach(this._depthTex,ki.DEPTH_ATTACHMENT),this._normalMaterial=new $r({shader:new Re(Re.source("ecgl.normal.vertex"),Re.source("ecgl.normal.fragment"))}),this._normalMaterial.enableTexture(["normalMap","bumpMap","roughnessMap"]),this._defaultNormalMap=Ms.createBlank("#000"),this._defaultBumpMap=Ms.createBlank("#000"),this._defaultRoughessMap=Ms.createBlank("#000"),this._debugPass=new Oi({fragment:Re.source("clay.compositor.output")}),this._debugPass.setUniform("texture",this._normalTex),this._debugPass.material.undefine("fragment","OUTPUT_ALPHA")}Ph.prototype.getDepthTexture=function(){return this._depthTex};Ph.prototype.getNormalTexture=function(){return this._normalTex};Ph.prototype.update=function(e,t,i){var r=e.getWidth(),n=e.getHeight(),a=this._depthTex,o=this._normalTex,s=this._normalMaterial;a.width=r,a.height=n,o.width=r,o.height=n;var l=t.getRenderList(i).opaque;this._framebuffer.bind(e),e.gl.clearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT|e.gl.DEPTH_BUFFER_BIT),e.gl.disable(e.gl.BLEND),e.renderPass(l,i,{getMaterial:function(){return s},ifRender:function(c){return c.renderNormal},beforeRender:NG(e,this._defaultNormalMap,this._defaultBumpMap,this._defaultRoughessMap,this._normalMaterial),sort:e.opaqueSortCompare}),this._framebuffer.unbind(e)};Ph.prototype.renderDebug=function(e){this._debugPass.render(e)};Ph.prototype.dispose=function(e){this._depthTex.dispose(e),this._normalTex.dispose(e)};var RP=Ph;function bf(e){e=e||{},this._edgePass=new Oi({fragment:Re.source("ecgl.edge")}),this._edgePass.setUniform("normalTexture",e.normalTexture),this._edgePass.setUniform("depthTexture",e.depthTexture),this._targetTexture=new ct({type:qe.HALF_FLOAT}),this._frameBuffer=new ki,this._frameBuffer.attach(this._targetTexture)}bf.prototype.update=function(e,t,i,r){var n=e.getWidth(),a=e.getHeight(),o=this._targetTexture;o.width=n,o.height=a;var s=this._frameBuffer;s.bind(e),this._edgePass.setUniform("projectionInv",t.invProjectionMatrix.array),this._edgePass.setUniform("textureSize",[n,a]),this._edgePass.setUniform("texture",i),this._edgePass.render(e),s.unbind(e)};bf.prototype.getTargetTexture=function(){return this._targetTexture};bf.prototype.setParameter=function(e,t){this._edgePass.setUniform(e,t)};bf.prototype.dispose=function(e){this._targetTexture.dispose(e),this._frameBuffer.dispose(e)};var FP=bf;var OP={type:"compositor",nodes:[{name:"source",type:"texture",outputs:{color:{}}},{name:"source_half",shader:"#source(clay.compositor.downsample)",inputs:{texture:"source"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"bright",shader:"#source(clay.compositor.bright)",inputs:{texture:"source_half"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{threshold:2,scale:4,textureSize:"expr([width * 1.0 / 2, height / 2])"}},{name:"bright_downsample_4",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 2, height / 2] )"}},{name:"bright_downsample_8",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright_downsample_4"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 4, height / 4] )"}},{name:"bright_downsample_16",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright_downsample_8"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 8, height / 8] )"}},{name:"bright_downsample_32",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright_downsample_16"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 32)",height:"expr(height * 1.0 / 32)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 16, height / 16] )"}},{name:"bright_upsample_16_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_32"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 32, height / 32] )"}},{name:"bright_upsample_16_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_16_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 16, height * 1.0 / 16] )"}},{name:"bright_upsample_8_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_16"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 16, height * 1.0 / 16] )"}},{name:"bright_upsample_8_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_8_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 8, height * 1.0 / 8] )"}},{name:"bright_upsample_8_blend",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_8_blur_v",texture2:"bright_upsample_16_blur_v"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_4_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_8"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 8, height * 1.0 / 8] )"}},{name:"bright_upsample_4_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_4_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 4, height * 1.0 / 4] )"}},{name:"bright_upsample_4_blend",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_4_blur_v",texture2:"bright_upsample_8_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_2_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_4"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 4, height * 1.0 / 4] )"}},{name:"bright_upsample_2_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_2_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 2, height * 1.0 / 2] )"}},{name:"bright_upsample_2_blend",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_2_blur_v",texture2:"bright_upsample_4_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_full_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 2, height * 1.0 / 2] )"}},{name:"bright_upsample_full_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_full_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"bloom_composite",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_full_blur_v",texture2:"bright_upsample_2_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"coc",shader:"#source(ecgl.dof.coc)",outputs:{color:{parameters:{minFilter:"NEAREST",magFilter:"NEAREST",width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},parameters:{focalDist:50,focalRange:30}},{name:"dof_far_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"source",coc:"coc"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"dof_near_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"source",coc:"coc"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"},defines:{BLUR_NEARFIELD:null}},{name:"dof_coc_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"coc"},outputs:{color:{parameters:{minFilter:"NEAREST",magFilter:"NEAREST",width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"},defines:{BLUR_COC:null}},{name:"dof_composite",shader:"#source(ecgl.dof.composite)",inputs:{original:"source",blurred:"dof_far_blur",nearfield:"dof_near_blur",coc:"coc",nearcoc:"dof_coc_blur"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}}},{name:"composite",shader:"#source(clay.compositor.hdr.composite)",inputs:{texture:"source",bloom:"bloom_composite"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},defines:{}},{name:"FXAA",shader:"#source(clay.compositor.fxaa)",inputs:{texture:"composite"}}]};var LP=`@export ecgl.dof.coc

uniform sampler2D depth;

uniform float zNear: 0.1;
uniform float zFar: 2000;

uniform float focalDistance: 3;
uniform float focalRange: 1;
uniform float focalLength: 30;
uniform float fstop: 2.8;

varying vec2 v_Texcoord;

@import clay.util.encode_float

void main()
{
 float z = texture2D(depth, v_Texcoord).r * 2.0 - 1.0;

 float dist = 2.0 * zNear * zFar / (zFar + zNear - z * (zFar - zNear));

 float aperture = focalLength / fstop;

 float coc;

 float uppper = focalDistance + focalRange;
 float lower = focalDistance - focalRange;
 if (dist <= uppper && dist >= lower) {
 coc = 0.5;
 }
 else {
 float focalAdjusted = dist > uppper ? uppper : lower;

 coc = abs(aperture * (focalLength * (dist - focalAdjusted)) / (dist * (focalAdjusted - focalLength)));
 coc = clamp(coc, 0.0, 2.0) / 2.00001;

 if (dist < lower) {
 coc = -coc;
 }
 coc = coc * 0.5 + 0.5;
 }

 gl_FragColor = encodeFloat(coc);
}
@end


@export ecgl.dof.composite

#define DEBUG 0

uniform sampler2D original;
uniform sampler2D blurred;
uniform sampler2D nearfield;
uniform sampler2D coc;
uniform sampler2D nearcoc;
varying vec2 v_Texcoord;

@import clay.util.rgbm
@import clay.util.float

void main()
{
 vec4 blurredColor = texture2D(blurred, v_Texcoord);
 vec4 originalColor = texture2D(original, v_Texcoord);

 float fCoc = decodeFloat(texture2D(coc, v_Texcoord));

 fCoc = abs(fCoc * 2.0 - 1.0);

 float weight = smoothstep(0.0, 1.0, fCoc);
 
#ifdef NEARFIELD_ENABLED
 vec4 nearfieldColor = texture2D(nearfield, v_Texcoord);
 float fNearCoc = decodeFloat(texture2D(nearcoc, v_Texcoord));
 fNearCoc = abs(fNearCoc * 2.0 - 1.0);

 gl_FragColor = encodeHDR(
 mix(
 nearfieldColor, mix(originalColor, blurredColor, weight),
 pow(1.0 - fNearCoc, 4.0)
 )
 );
#else
 gl_FragColor = encodeHDR(mix(originalColor, blurredColor, weight));
#endif

}

@end



@export ecgl.dof.diskBlur

#define POISSON_KERNEL_SIZE 16;

uniform sampler2D texture;
uniform sampler2D coc;
varying vec2 v_Texcoord;

uniform float blurRadius : 10.0;
uniform vec2 textureSize : [512.0, 512.0];

uniform vec2 poissonKernel[POISSON_KERNEL_SIZE];

uniform float percent;

float nrand(const in vec2 n) {
 return fract(sin(dot(n.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

@import clay.util.rgbm
@import clay.util.float


void main()
{
 vec2 offset = blurRadius / textureSize;

 float rnd = 6.28318 * nrand(v_Texcoord + 0.07 * percent );
 float cosa = cos(rnd);
 float sina = sin(rnd);
 vec4 basis = vec4(cosa, -sina, sina, cosa);

#if !defined(BLUR_NEARFIELD) && !defined(BLUR_COC)
 offset *= abs(decodeFloat(texture2D(coc, v_Texcoord)) * 2.0 - 1.0);
#endif

#ifdef BLUR_COC
 float cocSum = 0.0;
#else
 vec4 color = vec4(0.0);
#endif


 float weightSum = 0.0;

 for (int i = 0; i < POISSON_KERNEL_SIZE; i++) {
 vec2 ofs = poissonKernel[i];

 ofs = vec2(dot(ofs, basis.xy), dot(ofs, basis.zw));

 vec2 uv = v_Texcoord + ofs * offset;
 vec4 texel = texture2D(texture, uv);

 float w = 1.0;
#ifdef BLUR_COC
 float fCoc = decodeFloat(texel) * 2.0 - 1.0;
 cocSum += clamp(fCoc, -1.0, 0.0) * w;
#else
 texel = texel;
 #if !defined(BLUR_NEARFIELD)
 float fCoc = decodeFloat(texture2D(coc, uv)) * 2.0 - 1.0;
 w *= abs(fCoc);
 #endif
 texel.rgb *= texel.a;
 color += texel * w;
#endif

 weightSum += w;
 }

#ifdef BLUR_COC
 gl_FragColor = encodeFloat(clamp(cocSum / weightSum, -1.0, 0.0) * 0.5 + 0.5);
#else
 color /= weightSum;
 color.rgb /= (color.a + 0.0001);
 gl_FragColor = color;
#endif
}

@end`;var BP=`@export ecgl.edge

uniform sampler2D texture;

uniform sampler2D normalTexture;
uniform sampler2D depthTexture;

uniform mat4 projectionInv;

uniform vec2 textureSize;

uniform vec4 edgeColor: [0,0,0,0.8];

varying vec2 v_Texcoord;

vec3 packColor(vec2 coord) {
 float z = texture2D(depthTexture, coord).r * 2.0 - 1.0;
 vec4 p = vec4(v_Texcoord * 2.0 - 1.0, z, 1.0);
 vec4 p4 = projectionInv * p;

 return vec3(
 texture2D(normalTexture, coord).rg,
 -p4.z / p4.w / 5.0
 );
}

void main() {
 vec2 cc = v_Texcoord;
 vec3 center = packColor(cc);

 float size = clamp(1.0 - (center.z - 10.0) / 100.0, 0.0, 1.0) * 0.5;
 float dx = size / textureSize.x;
 float dy = size / textureSize.y;

 vec2 coord;
 vec3 topLeft = packColor(cc+vec2(-dx, -dy));
 vec3 top = packColor(cc+vec2(0.0, -dy));
 vec3 topRight = packColor(cc+vec2(dx, -dy));
 vec3 left = packColor(cc+vec2(-dx, 0.0));
 vec3 right = packColor(cc+vec2(dx, 0.0));
 vec3 bottomLeft = packColor(cc+vec2(-dx, dy));
 vec3 bottom = packColor(cc+vec2(0.0, dy));
 vec3 bottomRight = packColor(cc+vec2(dx, dy));

 vec3 v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;
 vec3 h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;

 float edge = sqrt(dot(h, h) + dot(v, v));

 edge = smoothstep(0.8, 1.0, edge);

 gl_FragColor = mix(texture2D(texture, v_Texcoord), vec4(edgeColor.rgb, 1.0), edgeColor.a * edge);
}
@end`;Re.import(v_);Re.import(__);Re.import(b_);Re.import(x_);Re.import(y_);Re.import(w_);Re.import(C_);Re.import(E_);Re.import(S_);Re.import(LP);Re.import(BP);function VP(e,t){return{color:{parameters:{width:e,height:t}}}}var dC=["composite","FXAA"];function si(){this._width,this._height,this._dpr,this._sourceTexture=new ct({type:qe.HALF_FLOAT}),this._depthTexture=new ct({format:qe.DEPTH_COMPONENT,type:qe.UNSIGNED_INT}),this._framebuffer=new ki,this._framebuffer.attach(this._sourceTexture),this._framebuffer.attach(this._depthTexture,ki.DEPTH_ATTACHMENT),this._normalPass=new RP,this._compositor=AP(OP);var e=this._compositor.getNodeByName("source");e.texture=this._sourceTexture;var t=this._compositor.getNodeByName("coc");this._sourceNode=e,this._cocNode=t,this._compositeNode=this._compositor.getNodeByName("composite"),this._fxaaNode=this._compositor.getNodeByName("FXAA"),this._dofBlurNodes=["dof_far_blur","dof_near_blur","dof_coc_blur"].map(function(r){return this._compositor.getNodeByName(r)},this),this._dofBlurKernel=0,this._dofBlurKernelSize=new Float32Array(0),this._finalNodesChain=dC.map(function(r){return this._compositor.getNodeByName(r)},this);var i={normalTexture:this._normalPass.getNormalTexture(),depthTexture:this._normalPass.getDepthTexture()};this._ssaoPass=new IP(i),this._ssrPass=new NP(i),this._edgePass=new FP(i)}si.prototype.resize=function(r,n,i){i=i||1;var r=r*i,n=n*i,a=this._sourceTexture,o=this._depthTexture;a.width=r,a.height=n,o.width=r,o.height=n;var s={getWidth:function(){return r},getHeight:function(){return n},getDevicePixelRatio:function(){return i}};function l(c,d){if(typeof c[d]=="function"){var u=c[d].__original||c[d];c[d]=function(h){return u.call(this,s)},c[d].__original=u}}this._compositor.nodes.forEach(function(c){for(var d in c.outputs){var u=c.outputs[d].parameters;u&&(l(u,"width"),l(u,"height"))}for(var h in c.parameters)l(c.parameters,h)}),this._width=r,this._height=n,this._dpr=i};si.prototype.getWidth=function(){return this._width};si.prototype.getHeight=function(){return this._height};si.prototype._ifRenderNormalPass=function(){return this._enableSSAO||this._enableEdge||this._enableSSR};si.prototype._getPrevNode=function(e){for(var t=dC.indexOf(e.name)-1,i=this._finalNodesChain[t];i&&!this._compositor.getNodeByName(i.name);)t-=1,i=this._finalNodesChain[t];return i};si.prototype._getNextNode=function(e){for(var t=dC.indexOf(e.name)+1,i=this._finalNodesChain[t];i&&!this._compositor.getNodeByName(i.name);)t+=1,i=this._finalNodesChain[t];return i};si.prototype._addChainNode=function(e){var t=this._getPrevNode(e),i=this._getNextNode(e);t&&(e.inputs.texture=t.name,i?(e.outputs=VP(this.getWidth.bind(this),this.getHeight.bind(this)),i.inputs.texture=e.name):e.outputs=null,this._compositor.addNode(e))};si.prototype._removeChainNode=function(e){var t=this._getPrevNode(e),i=this._getNextNode(e);t&&(i?(t.outputs=VP(this.getWidth.bind(this),this.getHeight.bind(this)),i.inputs.texture=t.name):t.outputs=null,this._compositor.removeNode(e))};si.prototype.updateNormal=function(e,t,i,r){this._ifRenderNormalPass()&&this._normalPass.update(e,t,i)};si.prototype.updateSSAO=function(e,t,i,r){this._ssaoPass.update(e,i,r)};si.prototype.enableSSAO=function(){this._enableSSAO=!0};si.prototype.disableSSAO=function(){this._enableSSAO=!1};si.prototype.enableSSR=function(){this._enableSSR=!0};si.prototype.disableSSR=function(){this._enableSSR=!1};si.prototype.getSSAOTexture=function(){return this._ssaoPass.getTargetTexture()};si.prototype.getSourceFrameBuffer=function(){return this._framebuffer};si.prototype.getSourceTexture=function(){return this._sourceTexture};si.prototype.disableFXAA=function(){this._removeChainNode(this._fxaaNode)};si.prototype.enableFXAA=function(){this._addChainNode(this._fxaaNode)};si.prototype.enableBloom=function(){this._compositeNode.inputs.bloom="bloom_composite",this._compositor.dirty()};si.prototype.disableBloom=function(){this._compositeNode.inputs.bloom=null,this._compositor.dirty()};si.prototype.enableDOF=function(){this._compositeNode.inputs.texture="dof_composite",this._compositor.dirty()};si.prototype.disableDOF=function(){this._compositeNode.inputs.texture="source",this._compositor.dirty()};si.prototype.enableColorCorrection=function(){this._compositeNode.define("COLOR_CORRECTION"),this._enableColorCorrection=!0};si.prototype.disableColorCorrection=function(){this._compositeNode.undefine("COLOR_CORRECTION"),this._enableColorCorrection=!1};si.prototype.enableEdge=function(){this._enableEdge=!0};si.prototype.disableEdge=function(){this._enableEdge=!1};si.prototype.setBloomIntensity=function(e){this._compositeNode.setParameter("bloomIntensity",e)};si.prototype.setSSAOParameter=function(e,t){switch(e){case"quality":var i={low:6,medium:12,high:32,ultra:62}[t]||12;this._ssaoPass.setParameter("kernelSize",i);break;case"radius":this._ssaoPass.setParameter(e,t),this._ssaoPass.setParameter("bias",t/200);break;case"intensity":this._ssaoPass.setParameter(e,t);break;default:}};si.prototype.setDOFParameter=function(e,t){switch(e){case"focalDistance":case"focalRange":case"fstop":this._cocNode.setParameter(e,t);break;case"blurRadius":for(var i=0;i<this._dofBlurNodes.length;i++)this._dofBlurNodes[i].setParameter("blurRadius",t);break;case"quality":var r={low:4,medium:8,high:16,ultra:32}[t]||8;this._dofBlurKernelSize=r;for(var i=0;i<this._dofBlurNodes.length;i++)this._dofBlurNodes[i].pass.material.define("POISSON_KERNEL_SIZE",r);this._dofBlurKernel=new Float32Array(r*2);break;default:}};si.prototype.setSSRParameter=function(e,t){if(t!=null)switch(e){case"quality":var i={low:10,medium:15,high:30,ultra:80}[t]||20,r={low:32,medium:16,high:8,ultra:4}[t]||16;this._ssrPass.setParameter("maxIteration",i),this._ssrPass.setParameter("pixelStride",r);break;case"maxRoughness":this._ssrPass.setParameter("minGlossiness",Math.max(Math.min(1-t,1),0));break;case"physical":this.setPhysicallyCorrectSSR(t);break;default:console.warn("Unkown SSR parameter "+e)}};si.prototype.setPhysicallyCorrectSSR=function(e){this._ssrPass.setPhysicallyCorrect(e)};si.prototype.setEdgeColor=function(e){var t=R.parseColor(e);this._edgePass.setParameter("edgeColor",t)};si.prototype.setExposure=function(e){this._compositeNode.setParameter("exposure",Math.pow(2,e))};si.prototype.setColorLookupTexture=function(e,t){this._compositeNode.pass.material.setTextureImage("lut",this._enableColorCorrection?e:"none",t,{minFilter:R.Texture.NEAREST,magFilter:R.Texture.NEAREST,flipY:!1})};si.prototype.setColorCorrection=function(e,t){this._compositeNode.setParameter(e,t)};si.prototype.isSSREnabled=function(){return this._enableSSR};si.prototype.composite=function(e,t,i,r,n){var a=this._sourceTexture,o=a;this._enableEdge&&(this._edgePass.update(e,i,a,n),a=o=this._edgePass.getTargetTexture()),this._enableSSR&&(this._ssrPass.update(e,i,a,n),o=this._ssrPass.getTargetTexture(),this._ssrPass.setSSAOTexture(this._enableSSAO?this._ssaoPass.getTargetTexture():null)),this._sourceNode.texture=o,this._cocNode.setParameter("depth",this._depthTexture);for(var s=this._dofBlurKernel,l=this._dofBlurKernelSize,c=Math.floor(lC.length/2/l),d=n%c,u=0;u<l*2;u++)s[u]=lC[u+d*l*2];for(var u=0;u<this._dofBlurNodes.length;u++)this._dofBlurNodes[u].setParameter("percent",n/30),this._dofBlurNodes[u].setParameter("poissonKernel",s);this._cocNode.setParameter("zNear",i.near),this._cocNode.setParameter("zFar",i.far),this._compositor.render(e,r)};si.prototype.dispose=function(e){this._sourceTexture.dispose(e),this._depthTexture.dispose(e),this._framebuffer.dispose(e),this._compositor.dispose(e),this._normalPass.dispose(e),this._ssaoPass.dispose(e)};var zP=si;function uC(e){for(var t=[],i=0;i<30;i++)t.push([vl(i,2),vl(i,3)]);this._haltonSequence=t,this._frame=0,this._sourceTex=new ct,this._sourceFb=new ki,this._sourceFb.attach(this._sourceTex),this._prevFrameTex=new ct,this._outputTex=new ct;var r=this._blendPass=new Oi({fragment:Re.source("clay.compositor.blend")});r.material.disableTexturesAll(),r.material.enableTexture(["texture1","texture2"]),this._blendFb=new ki({depthBuffer:!1}),this._outputPass=new Oi({fragment:Re.source("clay.compositor.output"),blendWithPrevious:!0}),this._outputPass.material.define("fragment","OUTPUT_ALPHA"),this._outputPass.material.blend=function(n){n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD),n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA)}}uC.prototype={constructor:uC,jitterProjection:function(e,t){var i=e.viewport,r=i.devicePixelRatio||e.getDevicePixelRatio(),n=i.width*r,a=i.height*r,o=this._haltonSequence[this._frame%this._haltonSequence.length],s=new Ye;s.array[12]=(o[0]*2-1)/n,s.array[13]=(o[1]*2-1)/a,Ye.mul(t.projectionMatrix,s,t.projectionMatrix),Ye.invert(t.invProjectionMatrix,t.projectionMatrix)},resetFrame:function(){this._frame=0},getFrame:function(){return this._frame},getSourceFrameBuffer:function(){return this._sourceFb},getOutputTexture:function(){return this._outputTex},resize:function(e,t){this._prevFrameTex.width=e,this._prevFrameTex.height=t,this._outputTex.width=e,this._outputTex.height=t,this._sourceTex.width=e,this._sourceTex.height=t,this._prevFrameTex.dirty(),this._outputTex.dirty(),this._sourceTex.dirty()},isFinished:function(){return this._frame>=this._haltonSequence.length},render:function(e,t,i){var r=this._blendPass;this._frame===0?(r.setUniform("weight1",0),r.setUniform("weight2",1)):(r.setUniform("weight1",.9),r.setUniform("weight2",.1)),r.setUniform("texture1",this._prevFrameTex),r.setUniform("texture2",t||this._sourceTex),this._blendFb.attach(this._outputTex),this._blendFb.bind(e),r.render(e),this._blendFb.unbind(e),i||(this._outputPass.setUniform("texture",this._outputTex),this._outputPass.render(e));var n=this._prevFrameTex;this._prevFrameTex=this._outputTex,this._outputTex=n,this._frame++},dispose:function(e){this._sourceFb.dispose(e),this._blendFb.dispose(e),this._prevFrameTex.dispose(e),this._outputTex.dispose(e),this._sourceTex.dispose(e),this._outputPass.dispose(e),this._blendPass.dispose(e)}};var UP=uC;function xr(e){e=e||"perspective",this.layer=null,this.scene=new to,this.rootNode=this.scene,this.viewport={x:0,y:0,width:0,height:0},this.setProjection(e),this._compositor=new zP,this._temporalSS=new UP,this._shadowMapPass=new fP;for(var t=[],i=0,r=0;r<30;r++){for(var n=[],a=0;a<6;a++)n.push(vl(i,2)*4-2),n.push(vl(i,3)*4-2),i++;t.push(n)}this._pcfKernels=t,this.scene.on("beforerender",function(o,s,l){this.needsTemporalSS()&&this._temporalSS.jitterProjection(o,l)},this)}xr.prototype.setProjection=function(e){var t=this.camera;t&&t.update(),e==="perspective"?this.camera instanceof Cr||(this.camera=new Cr,t&&this.camera.setLocalTransform(t.localTransform)):this.camera instanceof us||(this.camera=new us,t&&this.camera.setLocalTransform(t.localTransform)),this.camera.near=.1,this.camera.far=2e3};xr.prototype.setViewport=function(e,t,i,r,n){this.camera instanceof Cr&&(this.camera.aspect=i/r),n=n||1,this.viewport.x=e,this.viewport.y=t,this.viewport.width=i,this.viewport.height=r,this.viewport.devicePixelRatio=n,this._compositor.resize(i*n,r*n),this._temporalSS.resize(i*n,r*n)};xr.prototype.containPoint=function(e,t){var i=this.viewport,r=this.layer.renderer.getHeight();return t=r-t,e>=i.x&&t>=i.y&&e<=i.x+i.width&&t<=i.y+i.height};var HP=new rn;xr.prototype.castRay=function(e,t,i){var r=this.layer.renderer,n=r.viewport;return r.viewport=this.viewport,r.screenToNDC(e,t,HP),this.camera.castRay(HP,i),r.viewport=n,i};xr.prototype.prepareRender=function(){this.scene.update(),this.camera.update(),this.scene.updateLights();var e=this.scene.updateRenderList(this.camera);this._needsSortProgressively=!1;for(var t=0;t<e.transparent.length;t++){var i=e.transparent[t],r=i.geometry;r.needsSortVerticesProgressively&&r.needsSortVerticesProgressively()&&(this._needsSortProgressively=!0),r.needsSortTrianglesProgressively&&r.needsSortTrianglesProgressively()&&(this._needsSortProgressively=!0)}this._frame=0,this._temporalSS.resetFrame()};xr.prototype.render=function(e,t){this._doRender(e,t,this._frame),this._frame++};xr.prototype.needsAccumulate=function(){return this.needsTemporalSS()||this._needsSortProgressively};xr.prototype.needsTemporalSS=function(){var e=this._enableTemporalSS;return e==="auto"&&(e=this._enablePostEffect),e};xr.prototype.hasDOF=function(){return this._enableDOF};xr.prototype.isAccumulateFinished=function(){return this.needsTemporalSS()?this._temporalSS.isFinished():this._frame>30};xr.prototype._doRender=function(e,t,i){var r=this.scene,n=this.camera;i=i||0,this._updateTransparent(e,r,n,i),t||(this._shadowMapPass.kernelPCF=this._pcfKernels[0],this._shadowMapPass.render(e,r,n,!0)),this._updateShadowPCFKernel(i);var a=e.clearColor;if(e.gl.clearColor(a[0],a[1],a[2],a[3]),this._enablePostEffect&&(this.needsTemporalSS()&&this._temporalSS.jitterProjection(e,n),this._compositor.updateNormal(e,r,n,this._temporalSS.getFrame())),this._updateSSAO(e,r,n,this._temporalSS.getFrame()),this._enablePostEffect){var o=this._compositor.getSourceFrameBuffer();o.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT),e.render(r,n,!0,!0),o.unbind(e),this.needsTemporalSS()&&t?(this._compositor.composite(e,r,n,this._temporalSS.getSourceFrameBuffer(),this._temporalSS.getFrame()),e.setViewport(this.viewport),this._temporalSS.render(e)):(e.setViewport(this.viewport),this._compositor.composite(e,r,n,null,0))}else if(this.needsTemporalSS()&&t){var o=this._temporalSS.getSourceFrameBuffer();o.bind(e),e.saveClear(),e.clearBit=e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT,e.render(r,n,!0,!0),e.restoreClear(),o.unbind(e),e.setViewport(this.viewport),this._temporalSS.render(e)}else e.setViewport(this.viewport),e.render(r,n,!0,!0)};xr.prototype._updateTransparent=function(e,t,i,r){for(var n=new Se,a=new Ye,o=i.getWorldPosition(),s=t.getRenderList(i).transparent,l=0;l<s.length;l++){var c=s[l],d=c.geometry;Ye.invert(a,c.worldTransform),Se.transformMat4(n,o,a),d.needsSortTriangles&&d.needsSortTriangles()&&d.doSortTriangles(n,r),d.needsSortVertices&&d.needsSortVertices()&&d.doSortVertices(n,r)}};xr.prototype._updateSSAO=function(e,t,i){var r=this._enableSSAO&&this._enablePostEffect;r&&this._compositor.updateSSAO(e,t,i,this._temporalSS.getFrame());for(var n=t.getRenderList(i),a=0;a<n.opaque.length;a++){var o=n.opaque[a];o.renderNormal&&o.material[r?"enableTexture":"disableTexture"]("ssaoMap"),r&&o.material.set("ssaoMap",this._compositor.getSSAOTexture())}};xr.prototype._updateShadowPCFKernel=function(e){for(var t=this._pcfKernels[e%this._pcfKernels.length],i=this.scene.getRenderList(this.camera),r=i.opaque,n=0;n<r.length;n++)r[n].receiveShadow&&(r[n].material.set("pcfKernel",t),r[n].material.define("fragment","PCF_KERNEL_SIZE",t.length/2))};xr.prototype.dispose=function(e){this._compositor.dispose(e.gl),this._temporalSS.dispose(e.gl),this._shadowMapPass.dispose(e)};xr.prototype.setPostEffect=function(e,t){var i=this._compositor;this._enablePostEffect=e.get("enable");var r=e.getModel("bloom"),n=e.getModel("edge"),a=e.getModel("DOF",e.getModel("depthOfField")),o=e.getModel("SSAO",e.getModel("screenSpaceAmbientOcclusion")),s=e.getModel("SSR",e.getModel("screenSpaceReflection")),l=e.getModel("FXAA"),c=e.getModel("colorCorrection");r.get("enable")?i.enableBloom():i.disableBloom(),a.get("enable")?i.enableDOF():i.disableDOF(),s.get("enable")?i.enableSSR():i.disableSSR(),c.get("enable")?i.enableColorCorrection():i.disableColorCorrection(),n.get("enable")?i.enableEdge():i.disableEdge(),l.get("enable")?i.enableFXAA():i.disableFXAA(),this._enableDOF=a.get("enable"),this._enableSSAO=o.get("enable"),this._enableSSAO?i.enableSSAO():i.disableSSAO(),i.setBloomIntensity(r.get("intensity")),i.setEdgeColor(n.get("color")),i.setColorLookupTexture(c.get("lookupTexture"),t),i.setExposure(c.get("exposure")),["radius","quality","intensity"].forEach(function(d){i.setSSAOParameter(d,o.get(d))}),["quality","maxRoughness","physical"].forEach(function(d){i.setSSRParameter(d,s.get(d))}),["quality","focalDistance","focalRange","blurRadius","fstop"].forEach(function(d){i.setDOFParameter(d,a.get(d))}),["brightness","contrast","saturation"].forEach(function(d){i.setColorCorrection(d,c.get(d))})};xr.prototype.setDOFFocusOnPoint=function(e){if(this._enablePostEffect)return e>this.camera.far||e<this.camera.near?void 0:(this._compositor.setDOFParameter("focalDistance",e),!0)};xr.prototype.setTemporalSuperSampling=function(e){this._enableTemporalSS=e.get("enable")};xr.prototype.isLinearSpace=function(){return this._enablePostEffect};xr.prototype.setRootNode=function(e){if(this.rootNode!==e){for(var t=this.rootNode.children(),i=0;i<t.length;i++)e.add(t[i]);e!==this.scene&&this.scene.add(e),this.rootNode=e}};xr.prototype.add=function(e){this.rootNode.add(e)};xr.prototype.remove=function(e){this.rootNode.remove(e)};xr.prototype.removeAll=function(e){this.rootNode.removeAll(e)};Object.assign(xr.prototype,fh);var Bn=xr;function PG(e,t){var i=e.getBoxLayoutParams(),r=oc(i,{width:t.getWidth(),height:t.getHeight()});r.y=t.getHeight()-r.y-r.height,this.viewGL.setViewport(r.x,r.y,r.width,r.height,t.getDevicePixelRatio());var n=e.get("boxWidth"),a=e.get("boxHeight"),o=e.get("boxDepth");this.getAxis("x").setExtent(-n/2,n/2),this.getAxis("y").setExtent(o/2,-o/2),this.getAxis("z").setExtent(-a/2,a/2),this.size=[n,a,o]}function RG(e,t){var i={};function r(n,a){i[n]=i[n]||[1/0,-1/0],i[n][0]=Math.min(a[0],i[n][0]),i[n][1]=Math.max(a[1],i[n][1])}e.eachSeries(function(n){if(n.coordinateSystem===this){var a=n.getData();["x","y","z"].forEach(function(o){a.mapDimensionsAll(o,!0).forEach(function(s){r(o,a.getDataExtent(s,!0))})})}},this),["xAxis3D","yAxis3D","zAxis3D"].forEach(function(n){e.eachComponent(n,function(a){var o=n.charAt(0),s=a.getReferringComponents("grid3D").models[0],l=s.coordinateSystem;if(l===this){var c=l.getAxis(o);if(!c){var d=$i.createScale(i[o]||[1/0,-1/0],a);c=new dP(o,d),c.type=a.get("type");var u=c.type==="category";c.onBand=u&&a.get("boundaryGap"),c.inverse=a.get("inverse"),a.axis=c,c.model=a,c.getLabelModel=function(){return a.getModel("axisLabel",s.getModel("axisLabel"))},c.getTickModel=function(){return a.getModel("axisTick",s.getModel("axisTick"))},l.addAxis(c)}}},this)},this),this.resize(this.model,t)}var FG={dimensions:tC.prototype.dimensions,create:function(e,t){var i=[];e.eachComponent("grid3D",function(a){a.__viewGL=a.__viewGL||new Bn;var o=new tC;o.model=a,o.viewGL=a.__viewGL,a.coordinateSystem=o,i.push(o),o.resize=PG,o.update=RG});var r=["xAxis3D","yAxis3D","zAxis3D"];function n(a,o){return r.map(function(s){var l=a.getReferringComponents(s).models[0];return l==null&&(l=o.getComponent(s)),l})}return e.eachSeries(function(a){if(a.get("coordinateSystem")==="cartesian3D"){var o=a.getReferringComponents("grid3D").models[0];if(o==null){var s=n(a,e),o=s[0].getCoordSysModel();s.forEach(function(d){var u=d.getCoordSysModel()})}var l=o.coordinateSystem;a.coordinateSystem=l}}),i}},GP=FG;var jP=Eo.extend({type:"cartesian3DAxis",axis:null,getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"grid3D",index:this.option.gridIndex,id:this.option.gridId})[0]}});$i.mixinAxisModelCommonMethods(jP);var WP=jP;var qP={show:!0,grid3DIndex:0,inverse:!1,name:"",nameLocation:"middle",nameTextStyle:{fontSize:16},nameGap:20,axisPointer:{},axisLine:{},axisTick:{},axisLabel:{},splitArea:{}},OG=Ee.merge({boundaryGap:!0,axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"},axisPointer:{label:{show:!1}}},qP),hC=Ee.merge({boundaryGap:[0,0],splitNumber:5,axisPointer:{label:{}}},qP),LG=Ee.defaults({scale:!0,min:"dataMin",max:"dataMax"},hC),$P=Ee.defaults({logBase:10},hC);$P.scale=!0;var XP={categoryAxis3D:OG,valueAxis3D:hC,timeAxis3D:LG,logAxis3D:$P};var BG=["value","category","time","log"];function YP(e,t,i,r,n){BG.forEach(function(a){var o=i.extend({type:t+"Axis3D."+a,__ordinalMeta:null,mergeDefaultAndTheme:function(s,l){var c=l.getTheme();Ee.merge(s,c.get(a+"Axis3D")),Ee.merge(s,this.getDefaultOption()),s.type=r(t,s)},optionUpdated:function(){var s=this.option;s.type==="category"&&(this.__ordinalMeta=fI.createByAxisModel(this))},getCategories:function(){if(this.option.type==="category")return this.__ordinalMeta.categories},getOrdinalMeta:function(){return this.__ordinalMeta},defaultOption:Ee.merge(Ee.clone(XP[a+"Axis3D"]),n||{},!0)});e.registerComponentModel(o)}),e.registerSubTypeDefaulter(t+"Axis3D",Ee.curry(r,t))}function VG(e,t){return t.type||(t.data?"category":"value")}function ZP(e){e.registerComponentModel(qN),e.registerComponentView(cP),e.registerCoordinateSystem("grid3D",GP),["x","y","z"].forEach(function(t){YP(e,t,WP,VG,{name:t.toUpperCase()});let i=e.ComponentView.extend({type:t+"Axis3D"});e.registerComponentView(i)}),e.registerAction({type:"grid3DChangeCamera",event:"grid3dcamerachanged",update:"series:updateCamera"},function(t,i){i.eachComponent({mainType:"grid3D",query:t},function(r){r.setView(t)})}),e.registerAction({type:"grid3DShowAxisPointer",event:"grid3dshowaxispointer",update:"grid3D:showAxisPointer"},function(t,i){}),e.registerAction({type:"grid3DHideAxisPointer",event:"grid3dhideaxispointer",update:"grid3D:hideAxisPointer"},function(t,i){})}Ci(ZP);var Po={defaultOption:{shading:null,realisticMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},lambertMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},colorMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},hatchingMaterial:{textureTiling:1,textureOffset:0,paperColor:"#fff"}}};var A_={getFilledRegions:function(e,t){var i=(e||[]).slice(),r;if(typeof t=="string"?(t=jp(t),r=t&&t.geoJson):t&&t.features&&(r=t),!r)return[];for(var n={},a=r.features,o=0;o<i.length;o++)n[i[o].name]=i[o];for(var o=0;o<a.length;o++){var s=a[o].properties.name;n[s]||i.push({name:s})}return i},defaultOption:{show:!0,zlevel:-10,map:"",left:0,top:0,width:"100%",height:"100%",boxWidth:100,boxHeight:10,boxDepth:"auto",regionHeight:3,environment:"auto",groundPlane:{show:!1,color:"#aaa"},shading:"lambert",light:{main:{alpha:40,beta:30}},viewControl:{alpha:40,beta:0,distance:100,orthographicSize:60,minAlpha:5,minBeta:-80,maxBeta:80},label:{show:!1,distance:2,textStyle:{fontSize:20,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:4}},itemStyle:{color:"#fff",borderWidth:0,borderColor:"#333"},emphasis:{itemStyle:{color:"#639fc0"},label:{show:!0}}}};var Rh=Eo.extend({type:"geo3D",layoutMode:"box",coordinateSystem:null,optionUpdated:function(){var e=this.option;e.regions=this.getFilledRegions(e.regions,e.map);var t=$i.createDimensions(e.data||[],{coordDimensions:["value"],encodeDefine:this.get("encode"),dimensionsDefine:this.get("dimensions")}),i=new en(t,this);i.initData(e.regions);var r={};i.each(function(n){var a=i.getName(n),o=i.getItemModel(n);r[a]=o}),this._regionModelMap=r,this._data=i},getData:function(){return this._data},getRegionModel:function(e){var t=this.getData().getName(e);return this._regionModelMap[t]||new ac(null,this)},getRegionPolygonCoords:function(e){var t=this.getData().getName(e),i=this.coordinateSystem.getRegion(t);return i?i.geometries:[]},getFormattedLabel:function(e,t){var i=this._data.getName(e),r=this.getRegionModel(e),n=r.get(t==="normal"?["label","formatter"]:["emphasis","label","formatter"]);n==null&&(n=r.get(["label","formatter"]));var a={name:i};if(typeof n=="function")return a.status=t,n(a);if(typeof n=="string"){var o=a.seriesName;return n.replace("{a}",o??"")}else return i},defaultOption:{regions:[]}});Ee.merge(Rh.prototype,A_);Ee.merge(Rh.prototype,gc);Ee.merge(Rh.prototype,Io);Ee.merge(Rh.prototype,ko);Ee.merge(Rh.prototype,Po);var KP=Rh;var JP=eR;function eR(e,t,i){i=i||2;var r=t&&t.length,n=r?t[0]*i:e.length,a=tR(e,0,n,i,!0),o=[];if(!a)return o;var s,l,c,d,u,h,m;if(r&&(a=jG(e,t,a,i)),e.length>80*i){s=c=e[0],l=d=e[1];for(var f=i;f<n;f+=i)u=e[f],h=e[f+1],u<s&&(s=u),h<l&&(l=h),u>c&&(c=u),h>d&&(d=h);m=Math.max(c-s,d-l)}return yf(a,o,i,s,l,m),o}function tR(e,t,i,r,n){var a,o;if(n===fC(e,t,i,r)>0)for(a=t;a<i;a+=r)o=QP(a,e[a],e[a+1],o);else for(a=i-r;a>=t;a-=r)o=QP(a,e[a],e[a+1],o);return o&&jd(o,o.next)&&(Cf(o),o=o.next),o}function xf(e,t){if(!e)return e;t||(t=e);var i=e,r;do if(r=!1,!i.steiner&&(jd(i,i.next)||oa(i.prev,i,i.next)===0)){if(Cf(i),i=t=i.prev,i===i.next)return null;r=!0}else i=i.next;while(r||i!==t);return t}function yf(e,t,i,r,n,a,o){if(e){!o&&a&&XG(e,r,n,a);for(var s=e,l,c;e.prev!==e.next;){if(l=e.prev,c=e.next,a?UG(e,r,n,a):zG(e)){t.push(l.i/i),t.push(e.i/i),t.push(c.i/i),Cf(e),e=c.next,s=c.next;continue}if(e=c,e===s){o?o===1?(e=HG(e,t,i),yf(e,t,i,r,n,a,2)):o===2&&GG(e,t,i,r,n,a):yf(xf(e),t,i,r,n,a,1);break}}}}function zG(e){var t=e.prev,i=e,r=e.next;if(oa(t,i,r)>=0)return!1;for(var n=e.next.next;n!==e.prev;){if(T_(t.x,t.y,i.x,i.y,r.x,r.y,n.x,n.y)&&oa(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function UG(e,t,i,r){var n=e.prev,a=e,o=e.next;if(oa(n,a,o)>=0)return!1;for(var s=n.x<a.x?n.x<o.x?n.x:o.x:a.x<o.x?a.x:o.x,l=n.y<a.y?n.y<o.y?n.y:o.y:a.y<o.y?a.y:o.y,c=n.x>a.x?n.x>o.x?n.x:o.x:a.x>o.x?a.x:o.x,d=n.y>a.y?n.y>o.y?n.y:o.y:a.y>o.y?a.y:o.y,u=mC(s,l,t,i,r),h=mC(c,d,t,i,r),m=e.nextZ;m&&m.z<=h;){if(m!==e.prev&&m!==e.next&&T_(n.x,n.y,a.x,a.y,o.x,o.y,m.x,m.y)&&oa(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(m=e.prevZ;m&&m.z>=u;){if(m!==e.prev&&m!==e.next&&T_(n.x,n.y,a.x,a.y,o.x,o.y,m.x,m.y)&&oa(m.prev,m,m.next)>=0)return!1;m=m.prevZ}return!0}function HG(e,t,i){var r=e;do{var n=r.prev,a=r.next.next;!jd(n,a)&&iR(n,r,r.next,a)&&wf(n,a)&&wf(a,n)&&(t.push(n.i/i),t.push(r.i/i),t.push(a.i/i),Cf(r),Cf(r.next),r=e=a),r=r.next}while(r!==e);return r}function GG(e,t,i,r,n,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&KG(o,s)){var l=rR(o,s);o=xf(o,o.next),l=xf(l,l.next),yf(o,t,i,r,n,a),yf(l,t,i,r,n,a);return}s=s.next}o=o.next}while(o!==e)}function jG(e,t,i,r){var n=[],a,o,s,l,c;for(a=0,o=t.length;a<o;a++)s=t[a]*r,l=a<o-1?t[a+1]*r:e.length,c=tR(e,s,l,r,!1),c===c.next&&(c.steiner=!0),n.push(ZG(c));for(n.sort(WG),a=0;a<n.length;a++)qG(n[a],i),i=xf(i,i.next);return i}function WG(e,t){return e.x-t.x}function qG(e,t){if(t=$G(e,t),t){var i=rR(t,e);xf(i,i.next)}}function $G(e,t){var i=t,r=e.x,n=e.y,a=-1/0,o;do{if(n<=i.y&&n>=i.next.y&&i.next.y!==i.y){var s=i.x+(n-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>a){if(a=s,s===r){if(n===i.y)return i;if(n===i.next.y)return i.next}o=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!o)return null;if(r===a)return o.prev;var l=o,c=o.x,d=o.y,u=1/0,h;for(i=o.next;i!==l;)r>=i.x&&i.x>=c&&r!==i.x&&T_(n<d?r:a,n,c,d,n<d?a:r,n,i.x,i.y)&&(h=Math.abs(n-i.y)/(r-i.x),(h<u||h===u&&i.x>o.x)&&wf(i,e)&&(o=i,u=h)),i=i.next;return o}function XG(e,t,i,r){var n=e;do n.z===null&&(n.z=mC(n.x,n.y,t,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,YG(n)}function YG(e){var t,i,r,n,a,o,s,l,c=1;do{for(i=e,e=null,a=null,o=0;i;){for(o++,r=i,s=0,t=0;t<c&&(s++,r=r.nextZ,!!r);t++);for(l=c;s>0||l>0&&r;)s!==0&&(l===0||!r||i.z<=r.z)?(n=i,i=i.nextZ,s--):(n=r,r=r.nextZ,l--),a?a.nextZ=n:e=n,n.prevZ=a,a=n;i=r}a.nextZ=null,c*=2}while(o>1);return e}function mC(e,t,i,r,n){return e=32767*(e-i)/n,t=32767*(t-r)/n,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function ZG(e){var t=e,i=e;do t.x<i.x&&(i=t),t=t.next;while(t!==e);return i}function T_(e,t,i,r,n,a,o,s){return(n-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(r-s)-(i-o)*(t-s)>=0&&(i-o)*(a-s)-(n-o)*(r-s)>=0}function KG(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!QG(e,t)&&wf(e,t)&&wf(t,e)&&JG(e,t)}function oa(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function jd(e,t){return e.x===t.x&&e.y===t.y}function iR(e,t,i,r){return jd(e,t)&&jd(i,r)||jd(e,r)&&jd(i,t)?!0:oa(e,t,i)>0!=oa(e,t,r)>0&&oa(i,r,e)>0!=oa(i,r,t)>0}function QG(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&iR(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}function wf(e,t){return oa(e.prev,e,e.next)<0?oa(e,t,e.next)>=0&&oa(e,e.prev,t)>=0:oa(e,t,e.prev)<0||oa(e,e.next,t)<0}function JG(e,t){var i=e,r=!1,n=(e.x+t.x)/2,a=(e.y+t.y)/2;do i.y>a!=i.next.y>a&&i.next.y!==i.y&&n<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next;while(i!==e);return r}function rR(e,t){var i=new pC(e.i,e.x,e.y),r=new pC(t.i,t.x,t.y),n=e.next,a=t.prev;return e.next=t,t.prev=e,i.next=n,n.prev=i,r.next=i,i.prev=r,a.next=r,r.prev=a,r}function QP(e,t,i,r){var n=new pC(e,t,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function Cf(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function pC(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}eR.deviation=function(e,t,i,r){var n=t&&t.length,a=n?t[0]*i:e.length,o=Math.abs(fC(e,0,a,i));if(n)for(var s=0,l=t.length;s<l;s++){var c=t[s]*i,d=s<l-1?t[s+1]*i:e.length;o-=Math.abs(fC(e,c,d,i))}var u=0;for(s=0;s<r.length;s+=3){var h=r[s]*i,m=r[s+1]*i,f=r[s+2]*i;u+=Math.abs((e[h]-e[f])*(e[m+1]-e[h+1])-(e[h]-e[m])*(e[f+1]-e[h+1]))}return o===0&&u===0?0:Math.abs((u-o)/o)};function fC(e,t,i,r){for(var n=0,a=t,o=i-r;a<i;a+=r)n+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return n}function gC(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}function nR(e,t,i,r,n){var a=i,o=e[t];gC(e,t,r);for(var s=i;s<r;s++)n(e[s],o)<0&&(gC(e,s,a),a++);return gC(e,r,a),a}function D_(e,t,i,r){if(i<r){var n=Math.floor((i+r)/2),a=nR(e,n,i,r,t);D_(e,t,i,a-1),D_(e,t,a+1,r)}}function vC(){this._parts=[]}vC.prototype.step=function(e,t,i){var r=e.length;if(i===0){this._parts=[],this._sorted=!1;var n=Math.floor(r/2);this._parts.push({pivot:n,left:0,right:r-1}),this._currentSortPartIdx=0}if(!this._sorted){var a=this._parts;if(a.length===0)return this._sorted=!0,!0;if(a.length<512){for(var o=0;o<a.length;o++)a[o].pivot=nR(e,a[o].pivot,a[o].left,a[o].right,t);for(var s=[],o=0;o<a.length;o++){var l=a[o].left,c=a[o].pivot-1;c>l&&s.push({pivot:Math.floor((c+l)/2),left:l,right:c});var l=a[o].pivot+1,c=a[o].right;c>l&&s.push({pivot:Math.floor((c+l)/2),left:l,right:c})}a=this._parts=s}else for(var o=0;o<Math.floor(a.length/10);o++){var d=a.length-1-this._currentSortPartIdx;if(D_(e,t,a[d].left,a[d].right),this._currentSortPartIdx++,this._currentSortPartIdx===a.length)return this._sorted=!0,!0}return!1}};vC.sort=D_;var Fh=vC;var Oh=ri.vec3,aR=Oh.create(),oR=Oh.create(),sR=Oh.create(),Lh={needsSortTriangles:function(){return this.indices&&this.sortTriangles},needsSortTrianglesProgressively:function(){return this.needsSortTriangles()&&this.triangleCount>=2e4},doSortTriangles:function(e,t){var i=this.indices;if(t===0){var r=this.attributes.position,e=e.array;(!this._triangleZList||this._triangleZList.length!==this.triangleCount)&&(this._triangleZList=new Float32Array(this.triangleCount),this._sortedTriangleIndices=new Uint32Array(this.triangleCount),this._indicesTmp=new i.constructor(i.length),this._triangleZListTmp=new Float32Array(this.triangleCount));for(var n=0,a,o=0;o<i.length;){r.get(i[o++],aR),r.get(i[o++],oR),r.get(i[o++],sR);var s=Oh.sqrDist(aR,e),l=Oh.sqrDist(oR,e),c=Oh.sqrDist(sR,e),d=Math.min(s,l);d=Math.min(d,c),o===3?(a=d,d=0):d=d-a,this._triangleZList[n++]=d}}for(var u=this._sortedTriangleIndices,o=0;o<u.length;o++)u[o]=o;if(this.triangleCount<2e4)t===0&&this._simpleSort(!0);else for(var o=0;o<3;o++)this._progressiveQuickSort(t*3+o);for(var h=this._indicesTmp,m=this._triangleZListTmp,f=this._triangleZList,o=0;o<this.triangleCount;o++){var p=u[o]*3,g=o*3;h[g++]=i[p++],h[g++]=i[p++],h[g]=i[p],m[o]=f[u[o]]}var v=this._indicesTmp;this._indicesTmp=this.indices,this.indices=v;var v=this._triangleZListTmp;this._triangleZListTmp=this._triangleZList,this._triangleZList=v,this.dirtyIndices()},_simpleSort:function(e){var t=this._triangleZList,i=this._sortedTriangleIndices;function r(n,a){return t[a]-t[n]}e?Array.prototype.sort.call(i,r):Fh.sort(i,r,0,i.length-1)},_progressiveQuickSort:function(e){var t=this._triangleZList,i=this._sortedTriangleIndices;this._quickSort=this._quickSort||new Fh,this._quickSort.step(i,function(r,n){return t[n]-t[r]},e)}};function lR(e){let t=e.getVisual("style");if(t){let i=e.getVisual("drawType");return t[i]}}function cR(e){return e.getVisual("style").opacity}function Gi(e,t){let i=e.getItemVisual(t,"style");if(i){let r=e.getVisual("drawType");return i[r]}}function Zi(e,t){let i=e.getItemVisual(t,"style");return i&&i.opacity}var dR=1,uR=2;function Wd(e,t,i){this._labelsMesh=new Nh,this._labelTextureSurface=new _f({width:512,height:512,devicePixelRatio:i.getDevicePixelRatio(),onupdate:function(){i.getZr().refresh()}}),this._api=i,this._labelsMesh.material.set("textureAtlas",this._labelTextureSurface.getTexture())}Wd.prototype.getLabelPosition=function(e,t,i){return[0,0,0]};Wd.prototype.getLabelDistance=function(e,t,i){return 0};Wd.prototype.getMesh=function(){return this._labelsMesh};Wd.prototype.updateData=function(e,t,i){t==null&&(t=0),i==null&&(i=e.count()),(!this._labelsVisibilitiesBits||this._labelsVisibilitiesBits.length!==i-t)&&(this._labelsVisibilitiesBits=new Uint8Array(i-t));for(var r=["label","show"],n=["emphasis","label","show"],a=t;a<i;a++){var o=e.getItemModel(a),s=o.get(r),l=o.get(n);l==null&&(l=s);var c=(s?dR:0)|(l?uR:0);this._labelsVisibilitiesBits[a-t]=c}this._start=t,this._end=i,this._data=e};Wd.prototype.updateLabels=function(e){if(this._data){e=e||[];for(var t=e.length>0,i={},r=0;r<e.length;r++)i[e[r]]=!0;this._labelsMesh.geometry.convertToDynamicArray(!0),this._labelTextureSurface.clear();for(var n=["label"],a=["emphasis","label"],o=this._data.hostModel,s=this._data,l=o.getModel(n),c=o.getModel(a,l),d={left:"right",right:"left",top:"center",bottom:"center"},u={left:"middle",right:"middle",top:"bottom",bottom:"top"},h=this._start;h<this._end;h++){var m=!1;t&&i[h]&&(m=!0);var f=this._labelsVisibilitiesBits[h-this._start]&(m?uR:dR);if(f){var p=s.getItemModel(h),g=p.getModel(m?a:n,m?c:l),v=g.get("distance")||0,b=g.get("position"),_=this._api.getDevicePixelRatio(),x=o.getFormattedLabel(h,m?"emphasis":"normal");if(x==null||x==="")return;var w=new qr.Text({style:Md(g,{text:x,fill:g.get("color")||Gi(s,h)||"#000",align:"left",verticalAlign:"top",opacity:ht.firstNotNull(g.get("opacity"),Zi(s,h),1)})}),y=w.getBoundingRect(),M=1.2;y.height*=M;var T=this._labelTextureSurface.add(w),C=d[b]||"center",N=u[b]||"bottom";this._labelsMesh.geometry.addSprite(this.getLabelPosition(h,b,v),[y.width*_,y.height*_],T,C,N,this.getLabelDistance(h,b,v)*_)}}this._labelsMesh.material.set("uvScale",this._labelTextureSurface.getCoordsScale()),this._labelTextureSurface.getZr().refreshImmediately(),this._labelsMesh.geometry.convertToTypedArray(),this._labelsMesh.geometry.dirty()}};Wd.prototype.dispose=function(){this._labelTextureSurface.dispose()};var Bh=Wd;var Ma=ri.vec3;R.Shader.import(_c);function _C(e){this.rootNode=new R.Node,this._triangulationResults={},this._shadersMap=R.COMMON_SHADERS.filter(function(i){return i!=="shadow"}).reduce(function(i,r){return i[r]=R.createShader("ecgl."+r),i},{}),this._linesShader=R.createShader("ecgl.meshLines3D");var t={};R.COMMON_SHADERS.forEach(function(i){t[i]=new R.Material({shader:R.createShader("ecgl."+i)})}),this._groundMaterials=t,this._groundMesh=new R.Mesh({geometry:new R.PlaneGeometry({dynamic:!0}),castShadow:!1,renderNormal:!0,$ignorePicking:!0}),this._groundMesh.rotation.rotateX(-Math.PI/2),this._labelsBuilder=new Bh(512,512,e),this._labelsBuilder.getMesh().renderOrder=100,this._labelsBuilder.getMesh().material.depthTest=!1,this.rootNode.add(this._labelsBuilder.getMesh()),this._initMeshes(),this._api=e}_C.prototype={constructor:_C,extrudeY:!0,update:function(e,t,i,r,n){var a=e.getData();r==null&&(r=0),n==null&&(n=a.count()),this._startIndex=r,this._endIndex=n-1,this._triangulation(e,r,n);var o=this._getShader(e.get("shading"));this._prepareMesh(e,o,i,r,n),this.rootNode.updateWorldTransform(),this._updateRegionMesh(e,i,r,n);var s=e.coordinateSystem;s.type==="geo3D"&&this._updateGroundPlane(e,s,i);var l=this;this._labelsBuilder.updateData(a,r,n),this._labelsBuilder.getLabelPosition=function(c,d,u){var h=a.getName(c),m,f=u;if(s.type==="geo3D"){var p=s.getRegion(h);if(!p)return[NaN,NaN,NaN];m=p.getCenter();var g=s.dataToPoint([m[0],m[1],f]);return g}else var v=l._triangulationResults[c-l._startIndex],m=l.extrudeY?[(v.max[0]+v.min[0])/2,v.max[1]+f,(v.max[2]+v.min[2])/2]:[(v.max[0]+v.min[0])/2,(v.max[1]+v.min[1])/2,v.max[2]+f]},this._data=a,this._labelsBuilder.updateLabels(),this._updateDebugWireframe(e),this._lastHoverDataIndex=0},_initMeshes:function(){var e=this;function t(){var n=new R.Mesh({name:"Polygon",material:new R.Material({shader:e._shadersMap.lambert}),geometry:new R.Geometry({sortTriangles:!0,dynamic:!0}),culling:!1,ignorePicking:!0,renderNormal:!0});return Object.assign(n.geometry,Lh),n}var i=t(),r=new R.Mesh({material:new R.Material({shader:this._linesShader}),castShadow:!1,ignorePicking:!0,$ignorePicking:!0,geometry:new Da({useNativeLine:!1})});this.rootNode.add(i),this.rootNode.add(r),i.material.define("both","VERTEX_COLOR"),i.material.define("fragment","DOUBLE_SIDED"),this._polygonMesh=i,this._linesMesh=r,this.rootNode.add(this._groundMesh)},_getShader:function(e){var t=this._shadersMap[e];return t||(t=this._shadersMap.lambert),t.__shading=e,t},_prepareMesh:function(e,t,i,r,n){for(var a=0,o=0,s=0,l=0,c=r;c<n;c++){var d=this._getRegionPolygonInfo(c),u=this._getRegionLinesInfo(c,e,this._linesMesh.geometry);a+=d.vertexCount,o+=d.triangleCount,s+=u.vertexCount,l+=u.triangleCount}var h=this._polygonMesh,m=h.geometry;["position","normal","texcoord0","color"].forEach(function(f){m.attributes[f].init(a)}),m.indices=a>65535?new Uint32Array(o*3):new Uint16Array(o*3),h.material.shader!==t&&h.material.attachShader(t,!0),R.setMaterialFromModel(t.__shading,h.material,e,i),s>0&&(this._linesMesh.geometry.resetOffset(),this._linesMesh.geometry.setVertexCount(s),this._linesMesh.geometry.setTriangleCount(l)),this._dataIndexOfVertex=new Uint32Array(a),this._vertexRangeOfDataIndex=new Uint32Array((n-r)*2)},_updateRegionMesh:function(e,t,i,r){for(var n=e.getData(),a=0,o=0,s=!1,y=this._polygonMesh,l=this._linesMesh,c=i;c<r;c++){var d=e.getRegionModel(c),u=d.getModel("itemStyle"),h=ht.firstNotNull(Gi(n,c),u.get("color"),"#fff"),m=ht.firstNotNull(Zi(n,c),1),f=R.parseColor(h),p=R.parseColor(u.get("borderColor"));f[3]*=m,p[3]*=m;var g=f[3]<.99;y.material.set("color",[1,1,1,1]),s=s||g;for(var v=ht.firstNotNull(d.get("height",!0),e.get("regionHeight")),b=this._updatePolygonGeometry(e,y.geometry,c,v,a,o,f),_=a;_<b.vertexOffset;_++)this._dataIndexOfVertex[_]=c;this._vertexRangeOfDataIndex[(c-i)*2]=a,this._vertexRangeOfDataIndex[(c-i)*2+1]=b.vertexOffset,a=b.vertexOffset,o=b.triangleOffset;var x=u.get("borderWidth"),w=x>0;w&&(x*=t.getDevicePixelRatio(),this._updateLinesGeometry(l.geometry,e,c,v,x,e.coordinateSystem.transform)),l.invisible=!w,l.material.set({color:p})}var y=this._polygonMesh;y.material.transparent=s,y.material.depthMask=!s,y.geometry.updateBoundingBox(),y.frontFace=this.extrudeY?R.Mesh.CCW:R.Mesh.CW,y.material.get("normalMap")&&y.geometry.generateTangents(),y.seriesIndex=e.seriesIndex,y.on("mousemove",this._onmousemove,this),y.on("mouseout",this._onmouseout,this)},_updateDebugWireframe:function(e){var t=e.getModel("debug.wireframe");if(t.get("show")){var i=R.parseColor(t.get("lineStyle.color")||"rgba(0,0,0,0.5)"),r=ht.firstNotNull(t.get("lineStyle.width"),1),n=this._polygonMesh;n.geometry.generateBarycentric(),n.material.define("both","WIREFRAME_TRIANGLE"),n.material.set("wireframeLineColor",i),n.material.set("wireframeLineWidth",r)}},_onmousemove:function(e){var t=this._dataIndexOfVertex[e.triangle[0]];t==null&&(t=-1),t!==this._lastHoverDataIndex&&(this.downplay(this._lastHoverDataIndex),this.highlight(t),this._labelsBuilder.updateLabels([t])),this._lastHoverDataIndex=t,this._polygonMesh.dataIndex=t},_onmouseout:function(e){e.target&&(this.downplay(this._lastHoverDataIndex),this._lastHoverDataIndex=-1,this._polygonMesh.dataIndex=-1),this._labelsBuilder.updateLabels([])},_updateGroundPlane:function(e,t,i){var r=e.getModel("groundPlane",e);if(this._groundMesh.invisible=!r.get("show",!0),!this._groundMesh.invisible){var n=e.get("shading"),a=this._groundMaterials[n];a||(a=this._groundMaterials.lambert),R.setMaterialFromModel(n,a,r,i),a.get("normalMap")&&this._groundMesh.geometry.generateTangents(),this._groundMesh.material=a,this._groundMesh.material.set("color",R.parseColor(r.get("color"))),this._groundMesh.scale.set(t.size[0],t.size[2],1)}},_triangulation:function(e,t,i){this._triangulationResults=[];for(var r=[1/0,1/0,1/0],n=[-1/0,-1/0,-1/0],a=e.coordinateSystem,o=t;o<i;o++){for(var s=[],l=e.getRegionPolygonCoords(o),c=0;c<l.length;c++){var d=l[c].exterior,u=l[c].interiors,h=[],m=[];if(!(d.length<3)){for(var f=0,p=0;p<d.length;p++){var g=d[p];h[f++]=g[0],h[f++]=g[1]}for(var p=0;p<u.length;p++)if(!(u[p].length<3)){for(var v=h.length/2,b=0;b<u[p].length;b++){var g=u[p][b];h.push(g[0]),h.push(g[1])}m.push(v)}for(var _=JP(h,m),x=new Float64Array(h.length/2*3),w=[],y=[1/0,1/0,1/0],M=[-1/0,-1/0,-1/0],T=0,p=0;p<h.length;)Ma.set(w,h[p++],0,h[p++]),a&&a.transform&&Ma.transformMat4(w,w,a.transform),Ma.min(y,y,w),Ma.max(M,M,w),x[T++]=w[0],x[T++]=w[1],x[T++]=w[2];Ma.min(r,r,y),Ma.max(n,n,M),s.push({points:x,indices:_,min:y,max:M})}}this._triangulationResults.push(s)}this._geoBoundingBox=[r,n]},_getRegionPolygonInfo:function(e){for(var t=this._triangulationResults[e-this._startIndex],i=0,r=0,n=0;n<t.length;n++)i+=t[n].points.length/3,r+=t[n].indices.length/3;var a=i*2+i*4,o=r*2+i*2;return{vertexCount:a,triangleCount:o}},_updatePolygonGeometry:function(e,t,i,r,n,a,o){var s=e.get("projectUVOnGround"),l=t.attributes.position,c=t.attributes.normal,d=t.attributes.texcoord0,u=t.attributes.color,h=this._triangulationResults[i-this._startIndex],m=u.value&&o,f=t.indices,p=this.extrudeY?1:2,g=this.extrudeY?2:1,v=[this.rootNode.worldTransform.x.len(),this.rootNode.worldTransform.y.len(),this.rootNode.worldTransform.z.len()],b=Ma.mul([],this._geoBoundingBox[0],v),_=Ma.mul([],this._geoBoundingBox[1],v),x=Math.max(_[0]-b[0],_[2]-b[2]);function w(fe,be,ge){for(var Oe=fe.points,De=Oe.length,$e=[],_t=[],st=0;st<De;st+=3)$e[0]=Oe[st],$e[p]=be,$e[g]=Oe[st+2],_t[0]=(Oe[st]*v[0]-b[0])/x,_t[1]=(Oe[st+2]*v[g]-b[2])/x,l.set(n,$e),m&&u.set(n,o),d.set(n++,_t)}function y(fe,be,ge){var Oe=n;w(fe,be,ge);for(var De=fe.indices.length,$e=0;$e<De;$e++)f[a*3+$e]=fe.indices[$e]+Oe;a+=fe.indices.length/3}for(var M=this.extrudeY?[0,1,0]:[0,0,1],T=Ma.negate([],M),C=0;C<h.length;C++){var N=n,D=h[C];y(D,0,0),y(D,r,0);for(var k=D.points.length/3,U=0;U<k;U++)c.set(N+U,T),c.set(N+U+k,M);for(var F=[0,3,1,1,3,2],H=[[],[],[],[]],V=[],Q=[],$=[],ee=[],re=0,U=0;U<k;U++){for(var we=(U+1)%k,te=(D.points[we*3]-D.points[U*3])*v[0],oe=(D.points[we*3+2]-D.points[U*3+2])*v[g],pe=Math.sqrt(te*te+oe*oe),ue=0;ue<4;ue++){var _e=ue===0||ue===3,ce=(_e?U:we)*3;H[ue][0]=D.points[ce],H[ue][p]=ue>1?r:0,H[ue][g]=D.points[ce+2],l.set(n+ue,H[ue]),s?(ee[0]=(D.points[ce]*v[0]-b[0])/x,ee[1]=(D.points[ce+2]*v[g]-b[g])/x):(ee[0]=(_e?re:re+pe)/x,ee[1]=(H[ue][p]*v[p]-b[p])/x),d.set(n+ue,ee)}Ma.sub(V,H[1],H[0]),Ma.sub(Q,H[3],H[0]),Ma.cross($,V,Q),Ma.normalize($,$);for(var ue=0;ue<4;ue++)c.set(n+ue,$),m&&u.set(n+ue,o);for(var ue=0;ue<6;ue++)f[a*3+ue]=F[ue]+n;n+=4,a+=2,re+=pe}}return t.dirty(),{vertexOffset:n,triangleOffset:a}},_getRegionLinesInfo:function(e,t,i){var r=0,n=0,a=t.getRegionModel(e),o=a.getModel("itemStyle"),s=o.get("borderWidth");if(s>0){var l=t.getRegionPolygonCoords(e);l.forEach(function(c){var d=c.exterior,u=c.interiors;r+=i.getPolylineVertexCount(d),n+=i.getPolylineTriangleCount(d);for(var h=0;h<u.length;h++)r+=i.getPolylineVertexCount(u[h]),n+=i.getPolylineTriangleCount(u[h])},this)}return{vertexCount:r,triangleCount:n}},_updateLinesGeometry:function(e,t,i,r,n,a){function o(c){for(var d=new Float64Array(c.length*3),u=0,h=[],m=0;m<c.length;m++)h[0]=c[m][0],h[1]=r+.1,h[2]=c[m][1],a&&Ma.transformMat4(h,h,a),d[u++]=h[0],d[u++]=h[1],d[u++]=h[2];return d}var s=[1,1,1,1],l=t.getRegionPolygonCoords(i);l.forEach(function(c){var d=c.exterior,u=c.interiors;e.addPolyline(o(d),s,n);for(var h=0;h<u.length;h++)e.addPolyline(o(u[h]),s,n)})},highlight:function(e){var t=this._data;if(t){var i=t.getItemModel(e),r=i.getModel(["emphasis","itemStyle"]),n=r.get("color"),a=ht.firstNotNull(r.get("opacity"),Zi(t,e),1);if(n==null){var o=Gi(t,e);n=Ss.lift(o,-.4)}a==null&&(a=Zi(t,e));var s=R.parseColor(n);s[3]*=a,this._setColorOfDataIndex(t,e,s)}},downplay:function(e){var t=this._data;if(t){var i=ht.firstNotNull(Gi(t,e),t.getItemModel(e).get(["itemStyle","color"]),"#fff"),r=ht.firstNotNull(Zi(t,e),1),n=R.parseColor(i);n[3]*=r,this._setColorOfDataIndex(t,e,n)}},dispose:function(){this._labelsBuilder.dispose()},_setColorOfDataIndex:function(e,t,i){if(!(t<this._startIndex&&t>this._endIndex)){t-=this._startIndex;for(var r=this._vertexRangeOfDataIndex[t*2];r<this._vertexRangeOfDataIndex[t*2+1];r++)this._polygonMesh.geometry.attributes.color.set(r,i);this._polygonMesh.geometry.dirty(),this._api.getZr().refresh()}}};var qd=_C;var hR=As.extend({type:"geo3D",__ecgl__:!0,init:function(e,t){this._geo3DBuilder=new qd(t),this.groupGL=new R.Node,this._lightRoot=new R.Node,this._sceneHelper=new No(this._lightRoot),this._sceneHelper.initLight(this._lightRoot),this._control=new vc({zr:t.getZr()}),this._control.init()},render:function(e,t,i){this.groupGL.add(this._geo3DBuilder.rootNode);var r=e.coordinateSystem;if(!(!r||!r.viewGL)){r.viewGL.add(this._lightRoot),e.get("show")?r.viewGL.add(this.groupGL):r.viewGL.remove(this.groupGL);var n=this._control;n.setViewGL(r.viewGL);var a=e.getModel("viewControl");n.setFromViewControlModel(a,0),this._sceneHelper.setScene(r.viewGL.scene),this._sceneHelper.updateLight(e),r.viewGL.setPostEffect(e.getModel("postEffect"),i),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._geo3DBuilder.update(e,t,i,0,e.getData().count());var o=r.viewGL.isLinearSpace()?"define":"undefine";this._geo3DBuilder.rootNode.traverse(function(s){s.material&&s.material[o]("fragment","SRGB_DECODE")}),n.off("update"),n.on("update",function(){i.dispatchAction({type:"geo3DChangeCamera",alpha:n.getAlpha(),beta:n.getBeta(),distance:n.getDistance(),center:n.getCenter(),from:this.uid,geo3DId:e.id})}),n.update()}},afterRender:function(e,t,i,r){var n=r.renderer;this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i)},dispose:function(){this._control.dispose(),this._geo3DBuilder.dispose()}});var ej={Russia:[100,60],"United States":[-99,38],"United States of America":[-99,38]};function bC(e,t){if(e==="world"){var i=ej[t.name];if(i){var r=[i[0],i[1]];t.setCenter(r)}}}var tj=ri.vec3,Vh=ri.mat4,ij=[bI,bC];function xC(e,t,i,r,n){this.name=e,this.map=t,this.regionHeight=0,this.regions=[],this._nameCoordMap={},this.loadGeoJson(i,r,n),this.transform=Vh.identity(new Float64Array(16)),this.invTransform=Vh.identity(new Float64Array(16)),this.extrudeY=!0,this.altitudeAxis}xC.prototype={constructor:xC,type:"geo3D",dimensions:["lng","lat","alt"],containPoint:function(){},loadGeoJson:function(e,t,i){var r=n0||n0;try{this.regions=e?r(e):[]}catch(c){throw`Invalid geoJson format
`+c}t=t||{},i=i||{};for(var n=this.regions,a={},o=0;o<n.length;o++){var s=n[o].name;s=i[s]||s,n[o].name=s,a[s]=n[o],this.addGeoCoord(s,n[o].getCenter());var l=t[s];l&&n[o].transformTo(l.left,l.top,l.width,l.height)}this._regionsMap=a,this._geoRect=null,ij.forEach(function(c){c(this)},this)},getGeoBoundingRect:function(){if(this._geoRect)return this._geoRect;for(var e,t=this.regions,i=0;i<t.length;i++){var r=t[i].getBoundingRect();e=e||r.clone(),e.union(r)}return this._geoRect=e||new qr.BoundingRect(0,0,0,0)},addGeoCoord:function(e,t){this._nameCoordMap[e]=t},getRegion:function(e){return this._regionsMap[e]},getRegionByCoord:function(e){for(var t=this.regions,i=0;i<t.length;i++)if(t[i].contain(e))return t[i]},setSize:function(e,t,i){this.size=[e,t,i];var r=this.getGeoBoundingRect(),n=e/r.width,a=-i/r.height,o=-e/2-r.x*n,s=i/2-r.y*a,l=this.extrudeY?[o,0,s]:[o,s,0],c=this.extrudeY?[n,1,a]:[n,a,1],d=this.transform;Vh.identity(d),Vh.translate(d,d,l),Vh.scale(d,d,c),Vh.invert(this.invTransform,d)},dataToPoint:function(e,t){t=t||[];var i=this.extrudeY?1:2,r=this.extrudeY?2:1,n=e[2];return isNaN(n)&&(n=0),t[0]=e[0],t[r]=e[1],this.altitudeAxis?t[i]=this.altitudeAxis.dataToCoord(n):t[i]=0,t[i]+=this.regionHeight,tj.transformMat4(t,t,this.transform),t},pointToData:function(e,t){}};var yC=xC;function rj(e,t){var i=e.getBoxLayoutParams(),r=oc(i,{width:t.getWidth(),height:t.getHeight()});r.y=t.getHeight()-r.y-r.height,this.viewGL.setViewport(r.x,r.y,r.width,r.height,t.getDevicePixelRatio());var n=this.getGeoBoundingRect(),a=n.width/n.height*(e.get("aspectScale")||.75),o=e.get("boxWidth"),s=e.get("boxDepth"),l=e.get("boxHeight");l==null&&(l=5),isNaN(o)&&isNaN(s)&&(o=100),isNaN(s)?s=o/a:isNaN(o)&&(o=s/a),this.setSize(o,l,s),this.regionHeight=e.get("regionHeight"),this.altitudeAxis&&this.altitudeAxis.setExtent(0,Math.max(l-this.regionHeight,0))}function nj(e,t){var i=[1/0,-1/0];if(e.eachSeries(function(n){if(n.coordinateSystem===this&&n.type!=="series.map3D"){var a=n.getData(),o=n.coordDimToDataDim("alt"),s=o&&o[0];if(s){var l=a.getDataExtent(s,!0);i[0]=Math.min(i[0],l[0]),i[1]=Math.max(i[1],l[1])}}},this),i&&isFinite(i[1]-i[0])){var r=$i.createScale(i,{type:"value",min:"dataMin",max:"dataMax"});this.altitudeAxis=new Id("altitude",r),this.resize(this.model,t)}}var mR=0,pR={dimensions:yC.prototype.dimensions,create:function(e,t){var i=[];if(!jp)throw new Error("geo3D component depends on geo component");function r(n,a){var o=pR.createGeo3D(n);n.__viewGL=n.__viewGL||new Bn,o.viewGL=n.__viewGL,n.coordinateSystem=o,o.model=n,i.push(o),o.resize=rj,o.resize(n,t),o.update=nj}return e.eachComponent("geo3D",function(n,a){r(n,a)}),e.eachSeriesByType("map3D",function(n,a){var o=n.get("coordinateSystem");o==null&&(o="geo3D"),o==="geo3D"&&r(n,a)}),e.eachSeries(function(n){if(n.get("coordinateSystem")==="geo3D"){if(n.type==="series.map3D")return;var a=n.getReferringComponents("geo3D").models[0];if(a||(a=e.getComponent("geo3D")),!a)throw new Error('geo "'+ht.firstNotNull(n.get("geo3DIndex"),n.get("geo3DId"),0)+'" not found');n.coordinateSystem=a.coordinateSystem}}),i},createGeo3D:function(e){var t=e.get("map"),i;return typeof t=="string"?(i=t,t=jp(t)):t&&t.features&&(t={geoJson:t}),i==null&&(i="GEO_ANONYMOUS_"+mR++),new yC(i+mR++,i,t&&t.geoJson,t&&t.specialAreas,e.get("nameMap"))}},M_=pR;function I_(e){e.registerComponentModel(KP),e.registerComponentView(hR),e.registerAction({type:"geo3DChangeCamera",event:"geo3dcamerachanged",update:"series:updateCamera"},function(t,i){i.eachComponent({mainType:"geo3D",query:t},function(r){r.setView(t)})}),e.registerCoordinateSystem("geo3D",M_)}Ci(I_);function fR(e,t){e.id=e.id||e.name||t+""}var $d=Eo.extend({type:"globe",layoutMode:"box",coordinateSystem:null,init:function(){$d.superApply(this,"init",arguments),Ee.each(this.option.layers,function(e,t){Ee.merge(e,this.defaultLayerOption),fR(e,t)},this)},mergeOption:function(e){var t=this.option.layers;this.option.layers=null,$d.superApply(this,"mergeOption",arguments);function i(o){return Ee.reduce(o,function(s,l,c){return fR(l,c),s[l.id]=l,s},{})}if(t&&t.length){var r=i(e.layers),n=i(t);for(var a in r)n[a]?Ee.merge(n[a],r[a],!0):t.push(e.layers[a]);this.option.layers=t}Ee.each(this.option.layers,function(o){Ee.merge(o,this.defaultLayerOption)},this)},optionUpdated:function(){this.updateDisplacementHash()},defaultLayerOption:{show:!0,type:"overlay"},defaultOption:{show:!0,zlevel:-10,left:0,top:0,width:"100%",height:"100%",environment:"auto",baseColor:"#fff",baseTexture:"",heightTexture:"",displacementTexture:"",displacementScale:0,displacementQuality:"medium",globeRadius:100,globeOuterRadius:150,shading:"lambert",light:{main:{time:""}},atmosphere:{show:!1,offset:5,color:"#ffffff",glowPower:6,innerGlowPower:2},viewControl:{autoRotate:!0,panSensitivity:0,targetCoord:null},layers:[]},setDisplacementData:function(e,t,i){this.displacementData=e,this.displacementWidth=t,this.displacementHeight=i},getDisplacementTexture:function(){return this.get("displacementTexture")||this.get("heightTexture")},getDisplacemenScale:function(){var e=this.getDisplacementTexture(),t=this.get("displacementScale");return(!e||e==="none")&&(t=0),t},hasDisplacement:function(){return this.getDisplacemenScale()>0},_displacementChanged:!0,_displacementScale:0,updateDisplacementHash:function(){var e=this.getDisplacementTexture(),t=this.getDisplacemenScale();this._displacementChanged=this._displacementTexture!==e||this._displacementScale!==t,this._displacementTexture=e,this._displacementScale=t},isDisplacementChanged:function(){return this._displacementChanged}});Ee.merge($d.prototype,gc);Ee.merge($d.prototype,Io);Ee.merge($d.prototype,ko);Ee.merge($d.prototype,Po);var gR=$d;var vR=Math.PI,Ro=Math.sin,xl=Math.cos,_R=Math.tan,bR=Math.asin,xR=Math.atan2,Xd=vR/180,aj=1e3*60*60*24,oj=2440588,sj=2451545;function lj(e){return e.valueOf()/aj-.5+oj}function cj(e){return lj(e)-sj}var k_=Xd*23.4397;function dj(e,t){return xR(Ro(e)*xl(k_)-_R(t)*Ro(k_),xl(e))}function uj(e,t){return bR(Ro(t)*xl(k_)+xl(t)*Ro(k_)*Ro(e))}function hj(e,t,i){return xR(Ro(e),xl(e)*Ro(t)-_R(i)*xl(t))}function mj(e,t,i){return bR(Ro(t)*Ro(i)+xl(t)*xl(i)*xl(e))}function pj(e,t){return Xd*(280.16+360.9856235*e)-t}function fj(e){return Xd*(357.5291+.98560028*e)}function gj(e){var t=Xd*(1.9148*Ro(e)+.02*Ro(2*e)+3e-4*Ro(3*e)),i=Xd*102.9372;return e+t+i+vR}function vj(e){var t=fj(e),i=gj(t);return{dec:uj(i,0),ra:dj(i,0)}}var yR={};yR.getPosition=function(e,t,i){var r=Xd*-i,n=Xd*t,a=cj(e),o=vj(a),s=pj(a,r)-o.ra;return{azimuth:hj(s,n,o.dec),altitude:mj(s,n,o.dec)}};var wR=yR;var CR=`@export ecgl.atmosphere.vertex
attribute vec3 position: POSITION;
attribute vec3 normal : NORMAL;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform mat4 normalMatrix : WORLDINVERSETRANSPOSE;

varying vec3 v_Normal;

void main() {
 v_Normal = normalize((normalMatrix * vec4(normal, 0.0)).xyz);
 gl_Position = worldViewProjection * vec4(position, 1.0);
}
@end


@export ecgl.atmosphere.fragment
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform float glowPower;
uniform vec3 glowColor;

varying vec3 v_Normal;

void main() {
 float intensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor = vec4(glowColor, intensity * intensity);
}
@end`;R.Shader.import(a_);R.Shader.import(CR);var ER=As.extend({type:"globe",__ecgl__:!0,_displacementScale:0,init:function(e,t){this.groupGL=new R.Node,this._sphereGeometry=new R.SphereGeometry({widthSegments:200,heightSegments:100,dynamic:!0}),this._overlayGeometry=new R.SphereGeometry({widthSegments:80,heightSegments:40}),this._planeGeometry=new R.PlaneGeometry,this._earthMesh=new R.Mesh({renderNormal:!0}),this._atmosphereMesh=new R.Mesh,this._atmosphereGeometry=new R.SphereGeometry({widthSegments:80,heightSegments:40}),this._atmosphereMaterial=new R.Material({shader:new R.Shader(R.Shader.source("ecgl.atmosphere.vertex"),R.Shader.source("ecgl.atmosphere.fragment")),transparent:!0}),this._atmosphereMesh.geometry=this._atmosphereGeometry,this._atmosphereMesh.material=this._atmosphereMaterial,this._atmosphereMesh.frontFace=R.Mesh.CW,this._lightRoot=new R.Node,this._sceneHelper=new No,this._sceneHelper.initLight(this._lightRoot),this.groupGL.add(this._atmosphereMesh),this.groupGL.add(this._earthMesh),this._control=new vc({zr:t.getZr()}),this._control.init(),this._layerMeshes={}},render:function(e,t,i){var r=e.coordinateSystem,n=e.get("shading");r.viewGL.add(this._lightRoot),e.get("show")?r.viewGL.add(this.groupGL):r.viewGL.remove(this.groupGL),this._sceneHelper.setScene(r.viewGL.scene),r.viewGL.setPostEffect(e.getModel("postEffect"),i),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling"));var a=this._earthMesh;a.geometry=this._sphereGeometry;var o="ecgl."+n;(!a.material||a.material.shader.name!==o)&&(a.material=R.createMaterial(o)),R.setMaterialFromModel(n,a.material,e,i),["roughnessMap","metalnessMap","detailMap","normalMap"].forEach(function(u){var h=a.material.get(u);h&&(h.flipY=!1)}),a.material.set("color",R.parseColor(e.get("baseColor")));var s=r.radius*.99;if(a.scale.set(s,s,s),e.get("atmosphere.show")){a.material.define("both","ATMOSPHERE_ENABLED"),this._atmosphereMesh.invisible=!1,this._atmosphereMaterial.setUniforms({glowPower:e.get("atmosphere.glowPower")||6,glowColor:e.get("atmosphere.color")||"#ffffff"}),a.material.setUniforms({glowPower:e.get("atmosphere.innerGlowPower")||2,glowColor:e.get("atmosphere.color")||"#ffffff"});var l=e.get("atmosphere.offset")||5;this._atmosphereMesh.scale.set(s+l,s+l,s+l)}else a.material.undefine("both","ATMOSPHERE_ENABLED"),this._atmosphereMesh.invisible=!0;var c=a.material.setTextureImage("diffuseMap",e.get("baseTexture"),i,{flipY:!1,anisotropic:8});c&&c.surface&&c.surface.attachToMesh(a);var d=a.material.setTextureImage("bumpMap",e.get("heightTexture"),i,{flipY:!1,anisotropic:8});d&&d.surface&&d.surface.attachToMesh(a),a.material[e.get("postEffect.enable")?"define":"undefine"]("fragment","SRGB_DECODE"),this._updateLight(e,i),this._displaceVertices(e,i),this._updateViewControl(e,i),this._updateLayers(e,i)},afterRender:function(e,t,i,r){var n=r.renderer;this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i)},_updateLayers:function(e,t){var i=e.coordinateSystem,r=e.get("layers"),n=i.radius,a=[],o=[],s=[],l=[];Ee.each(r,function(m){var f=new ac(m),p=f.get("type"),g=R.loadTexture(f.get("texture"),t,{flipY:!1,anisotropic:8});if(g.surface&&g.surface.attachToMesh(this._earthMesh),p==="blend"){var v=f.get("blendTo"),b=ht.firstNotNull(f.get("intensity"),1);v==="emission"?(s.push(g),l.push(b)):(a.push(g),o.push(b))}else{var _=f.get("id"),x=this._layerMeshes[_];x||(x=this._layerMeshes[_]=new R.Mesh({geometry:this._overlayGeometry,castShadow:!1,ignorePicking:!0}));var w=f.get("shading");w==="lambert"?(x.material=x.__lambertMaterial||new R.Material({autoUpdateTextureStatus:!1,shader:R.createShader("ecgl.lambert"),transparent:!0,depthMask:!1}),x.__lambertMaterial=x.material):(x.material=x.__colorMaterial||new R.Material({autoUpdateTextureStatus:!1,shader:R.createShader("ecgl.color"),transparent:!0,depthMask:!1}),x.__colorMaterial=x.material),x.material.enableTexture("diffuseMap");var y=f.get("distance"),M=n+(y??i.radius/100);x.scale.set(M,M,M),n=M;var T=this._blankTexture||(this._blankTexture=R.createBlankTexture("rgba(255, 255, 255, 0)"));x.material.set("diffuseMap",T),R.loadTexture(f.get("texture"),t,{flipY:!1,anisotropic:8},function(C){C.surface&&C.surface.attachToMesh(x),x.material.set("diffuseMap",C),t.getZr().refresh()}),f.get("show")?this.groupGL.add(x):this.groupGL.remove(x)}},this);var c=this._earthMesh.material;c.define("fragment","LAYER_DIFFUSEMAP_COUNT",a.length),c.define("fragment","LAYER_EMISSIVEMAP_COUNT",s.length),c.set("layerDiffuseMap",a),c.set("layerDiffuseIntensity",o),c.set("layerEmissiveMap",s),c.set("layerEmissionIntensity",l);var d=e.getModel("debug.wireframe");if(d.get("show")){c.define("both","WIREFRAME_TRIANGLE");var u=R.parseColor(d.get("lineStyle.color")||"rgba(0,0,0,0.5)"),h=ht.firstNotNull(d.get("lineStyle.width"),1);c.set("wireframeLineWidth",h),c.set("wireframeLineColor",u)}else c.undefine("both","WIREFRAME_TRIANGLE")},_updateViewControl:function(e,t){var i=e.coordinateSystem,r=e.getModel("viewControl"),n=i.viewGL.camera,a=this;function o(){return{type:"globeChangeCamera",alpha:s.getAlpha(),beta:s.getBeta(),distance:s.getDistance()-i.radius,center:s.getCenter(),from:a.uid,globeId:e.id}}var s=this._control;s.setViewGL(i.viewGL);var l=r.get("targetCoord"),c,d;l!=null&&(d=l[0]+90,c=l[1]),s.setFromViewControlModel(r,{baseDistance:i.radius,alpha:c,beta:d}),s.off("update"),s.on("update",function(){t.dispatchAction(o())})},_displaceVertices:function(e,t){var i=e.get("displacementQuality"),r=e.get("debug.wireframe.show"),n=e.coordinateSystem;if(!(!e.isDisplacementChanged()&&i===this._displacementQuality&&r===this._showDebugWireframe)){this._displacementQuality=i,this._showDebugWireframe=r;var a=this._sphereGeometry,o={low:100,medium:200,high:400,ultra:800}[i]||200,s=o/2;(a.widthSegments!==o||r)&&(a.widthSegments=o,a.heightSegments=s,a.build()),this._doDisplaceVertices(a,n),r&&a.generateBarycentric()}},_doDisplaceVertices:function(e,t){var i=e.attributes.position.value,r=e.attributes.texcoord0.value,n=e.__originalPosition;(!n||n.length!==i.length)&&(n=new Float32Array(i.length),n.set(i),e.__originalPosition=n);for(var a=t.displacementWidth,o=t.displacementHeight,s=t.displacementData,l=0;l<e.vertexCount;l++){var c=l*3,d=l*2,u=n[c+1],h=n[c+2],m=n[c+3],f=r[d++],p=r[d++],g=Math.round(f*(a-1)),v=Math.round(p*(o-1)),b=v*a+g,_=s?s[b]:0;i[c+1]=u+u*_,i[c+2]=h+h*_,i[c+3]=m+m*_}e.generateVertexNormals(),e.dirty(),e.updateBoundingBox()},_updateLight:function(e,t){var i=this._earthMesh;this._sceneHelper.updateLight(e);var r=this._sceneHelper.mainLight,n=e.get("light.main.time")||new Date,a=wR.getPosition(Qa.parseDate(n),0,0),o=Math.cos(a.altitude);r.position.y=-o*Math.cos(a.azimuth),r.position.x=Math.sin(a.altitude),r.position.z=o*Math.sin(a.azimuth),r.lookAt(i.getWorldPosition())},dispose:function(e,t){this.groupGL.removeAll(),this._control.dispose()}});var _j=ri.vec3;function wC(e){this.radius=e,this.viewGL=null,this.altitudeAxis,this.displacementData=null,this.displacementWidth,this.displacementHeight}wC.prototype={constructor:wC,dimensions:["lng","lat","alt"],type:"globe",containPoint:function(){},setDisplacementData:function(e,t,i){this.displacementData=e,this.displacementWidth=t,this.displacementHeight=i},_getDisplacementScale:function(e,t){var i=(e+180)/360*(this.displacementWidth-1),r=(90-t)/180*(this.displacementHeight-1),n=Math.round(i)+Math.round(r)*this.displacementWidth;return this.displacementData[n]},dataToPoint:function(e,t){var i=e[0],r=e[1],n=e[2]||0,a=this.radius;this.displacementData&&(a*=1+this._getDisplacementScale(i,r)),this.altitudeAxis&&(a+=this.altitudeAxis.dataToCoord(n)),i=i*Math.PI/180,r=r*Math.PI/180;var o=Math.cos(r)*a;return t=t||[],t[0]=-o*Math.cos(i+Math.PI),t[1]=Math.sin(r)*a,t[2]=o*Math.sin(i+Math.PI),t},pointToData:function(e,t){var i=e[0],r=e[1],n=e[2],a=_j.len(e);i/=a,r/=a,n/=a;var o=Math.asin(r),s=Math.atan2(n,-i);s<0&&(s=Math.PI*2+s);var l=o*180/Math.PI,c=s*180/Math.PI-180;return t=t||[],t[0]=c,t[1]=l,t[2]=a-this.radius,this.altitudeAxis&&(t[2]=this.altitudeAxis.coordToData(t[2])),t}};var CC=wC;function bj(e,t){var i=document.createElement("canvas"),r=i.getContext("2d"),n=e.width,a=e.height;i.width=n,i.height=a,r.drawImage(e,0,0,n,a);for(var o=r.getImageData(0,0,n,a).data,s=new Float32Array(o.length/4),l=0;l<o.length/4;l++){var c=o[l*4];s[l]=c/255*t}return{data:s,width:n,height:a}}function xj(e,t){var i=e.getBoxLayoutParams(),r=oc(i,{width:t.getWidth(),height:t.getHeight()});r.y=t.getHeight()-r.y-r.height,this.viewGL.setViewport(r.x,r.y,r.width,r.height,t.getDevicePixelRatio()),this.radius=e.get("globeRadius");var n=e.get("globeOuterRadius");this.altitudeAxis&&this.altitudeAxis.setExtent(0,n-this.radius)}function yj(e,t){var i=[1/0,-1/0];if(e.eachSeries(function(n){if(n.coordinateSystem===this){var a=n.getData(),o=n.coordDimToDataDim("alt"),s=o&&o[0];if(s){var l=a.getDataExtent(s,!0);i[0]=Math.min(i[0],l[0]),i[1]=Math.max(i[1],l[1])}}},this),i&&isFinite(i[1]-i[0])){var r=$i.createScale(i,{type:"value",min:"dataMin",max:"dataMax"});this.altitudeAxis=new Id("altitude",r),this.resize(this.model,t)}}var wj={dimensions:CC.prototype.dimensions,create:function(e,t){var i=[];return e.eachComponent("globe",function(r){r.__viewGL=r.__viewGL||new Bn;var n=new CC;n.viewGL=r.__viewGL,r.coordinateSystem=n,n.model=r,i.push(n),n.resize=xj,n.resize(r,t),n.update=yj}),e.eachSeries(function(r){if(r.get("coordinateSystem")==="globe"){var n=r.getReferringComponents("globe").models[0];if(n||(n=e.getComponent("globe")),!n)throw new Error('globe "'+ht.firstNotNull(r.get("globe3DIndex"),r.get("globe3DId"),0)+'" not found');var a=n.coordinateSystem;r.coordinateSystem=a}}),e.eachComponent("globe",function(r,n){var a=r.coordinateSystem,o=r.getDisplacementTexture(),s=r.getDisplacemenScale();if(r.isDisplacementChanged()){if(r.hasDisplacement()){var l=!0;R.loadTexture(o,t,function(c){var d=c.image,u=bj(d,s);r.setDisplacementData(u.data,u.width,u.height),l||t.dispatchAction({type:"globeUpdateDisplacment"})}),l=!1}else a.setDisplacementData(null,0,0);a.setDisplacementData(r.displacementData,r.displacementWidth,r.displacementHeight)}}),i}},SR=wj;function AR(e){e.registerComponentModel(gR),e.registerComponentView(ER),e.registerCoordinateSystem("globe",SR),e.registerAction({type:"globeChangeCamera",event:"globecamerachanged",update:"series:updateCamera"},function(t,i){i.eachComponent({mainType:"globe",query:t},function(r){r.setView(t)})}),e.registerAction({type:"globeUpdateDisplacment",event:"globedisplacementupdated",update:"update"},function(t,i){})}Ci(AR);var TR=["zoom","center","pitch","bearing"],EC=Eo.extend({type:"mapbox3D",layoutMode:"box",coordinateSystem:null,defaultOption:{zlevel:-10,style:"mapbox://styles/mapbox/light-v9",center:[0,0],zoom:0,pitch:0,bearing:0,light:{main:{alpha:20,beta:30}},altitudeScale:1,boxHeight:"auto"},getMapboxCameraOption:function(){var e=this;return TR.reduce(function(t,i){return t[i]=e.get(i),t},{})},setMapboxCameraOption:function(e){e!=null&&TR.forEach(function(t){e[t]!=null&&(this.option[t]=e[t])},this)},getMapbox:function(){return this._mapbox},setMapbox:function(e){this._mapbox=e}});Ee.merge(EC.prototype,Io);Ee.merge(EC.prototype,ko);var DR=EC;function xc(e,t){if(this.id=e,this.zr=t,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute;left:0;right:0;top:0;bottom:0;",!mapboxgl)throw new Error("Mapbox GL library must be included. See https://www.mapbox.com/mapbox-gl-js/api/");this._mapbox=new mapboxgl.Map({container:this.dom}),this._initEvents()}xc.prototype.setUnpainted=function(){};xc.prototype.resize=function(){this._mapbox.resize()};xc.prototype.getMapbox=function(){return this._mapbox};xc.prototype.clear=function(){};xc.prototype.refresh=function(){this._mapbox.resize()};var MR=["mousedown","mouseup","click","dblclick","mousemove","mousewheel","wheel","touchstart","touchend","touchmove","touchcancel"];xc.prototype._initEvents=function(){var e=this._mapbox.getCanvasContainer();this._handlers=this._handlers||{contextmenu:function(t){return t.preventDefault(),!1}},MR.forEach(function(t){this._handlers[t]=function(i){var r={};for(var n in i)r[n]=i[n];r.bubbles=!1;var a=new i.constructor(i.type,r);e.dispatchEvent(a)},this.zr.dom.addEventListener(t,this._handlers[t])},this),this.zr.dom.addEventListener("contextmenu",this._handlers.contextmenu)};xc.prototype.dispose=function(){MR.forEach(function(e){this.zr.dom.removeEventListener(e,this._handlers[e])},this)};var IR=xc;var N_=`
@export ecgl.displayShadow.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header

@import ecgl.common.attributes

varying vec3 v_WorldPosition;

varying vec3 v_Normal;

void main()
{
 @import ecgl.common.uv.main
 v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);

 v_WorldPosition = (world * vec4(position, 1.0)).xyz;
 gl_Position = worldViewProjection * vec4(position, 1.0);
}

@end


@export ecgl.displayShadow.fragment

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform float roughness: 0.2;

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

@import ecgl.common.ssaoMap.header

@import clay.plugin.compute_shadow_map

void main()
{
 float shadow = 1.0;

 @import ecgl.common.ssaoMap.main

#if defined(DIRECTIONAL_LIGHT_COUNT) && defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
 for (int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++) {
 shadow = min(shadow, shadowContribsDir[i] * 0.5 + 0.5);
 }
#endif

 shadow *= 0.5 + ao * 0.5;
 shadow = clamp(shadow, 0.0, 1.0);

 gl_FragColor = vec4(vec3(0.0), 1.0 - shadow);
}

@end`;R.Shader.import(N_);var kR=As.extend({type:"mapbox3D",__ecgl__:!0,init:function(e,t){var i=t.getZr();this._zrLayer=new IR("mapbox3D",i),i.painter.insertLayer(-1e3,this._zrLayer),this._lightRoot=new R.Node,this._sceneHelper=new No(this._lightRoot),this._sceneHelper.initLight(this._lightRoot);var r=this._zrLayer.getMapbox(),n=this._dispatchInteractAction.bind(this,t,r);["zoom","rotate","drag","pitch","rotate","move"].forEach(function(a){r.on(a,n)}),this._groundMesh=new R.Mesh({geometry:new R.PlaneGeometry,material:new R.Material({shader:new R.Shader({vertex:R.Shader.source("ecgl.displayShadow.vertex"),fragment:R.Shader.source("ecgl.displayShadow.fragment")}),depthMask:!1}),renderOrder:-100,culling:!1,castShadow:!1,$ignorePicking:!0,renderNormal:!0})},render:function(e,t,i){var r=this._zrLayer.getMapbox(),n=e.get("style"),a=JSON.stringify(n);a!==this._oldStyleStr&&n&&r.setStyle(n),this._oldStyleStr=a,r.setCenter(e.get("center")),r.setZoom(e.get("zoom")),r.setPitch(e.get("pitch")),r.setBearing(e.get("bearing")),e.setMapbox(r);var o=e.coordinateSystem;o.viewGL.scene.add(this._lightRoot),o.viewGL.add(this._groundMesh),this._updateGroundMesh(),this._sceneHelper.setScene(o.viewGL.scene),this._sceneHelper.updateLight(e),o.viewGL.setPostEffect(e.getModel("postEffect"),i),o.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._mapbox3DModel=e},afterRender:function(e,t,i,r){var n=r.renderer;this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i),e.coordinateSystem.viewGL.scene.traverse(function(a){a.material&&(a.material.define("fragment","NORMAL_UP_AXIS",2),a.material.define("fragment","NORMAL_FRONT_AXIS",1))})},updateCamera:function(e,t,i,r){e.coordinateSystem.setCameraOption(r),this._updateGroundMesh(),i.getZr().refresh()},_dispatchInteractAction:function(e,t,i){e.dispatchAction({type:"mapbox3DChangeCamera",pitch:t.getPitch(),zoom:t.getZoom(),center:t.getCenter().toArray(),bearing:t.getBearing(),mapbox3DId:this._mapbox3DModel&&this._mapbox3DModel.id})},_updateGroundMesh:function(){if(this._mapbox3DModel){var e=this._mapbox3DModel.coordinateSystem,t=e.dataToPoint(e.center);this._groundMesh.position.set(t[0],t[1],-.001);var i=new R.Plane(new R.Vector3(0,0,1),0),r=e.viewGL.camera.castRay(new R.Vector2(-1,-1)),n=e.viewGL.camera.castRay(new R.Vector2(1,1)),a=r.intersectPlane(i),o=n.intersectPlane(i),s=a.dist(o)/e.viewGL.rootNode.scale.x;this._groundMesh.scale.set(s,s,1)}},dispose:function(e,t){this._zrLayer&&this._zrLayer.dispose(),t.getZr().painter.delLayer(-1e3)}});var yc=ri.mat4,Ef=512,SC=.6435011087932844,Ia=Math.PI,zh=1/10;function AC(){this.width=0,this.height=0,this.altitudeScale=1,this.boxHeight="auto",this.altitudeExtent,this.bearing=0,this.pitch=0,this.center=[0,0],this._origin,this.zoom=0,this._initialZoom,this.maxPitch=60,this.zoomOffset=0}AC.prototype={constructor:AC,dimensions:["lng","lat","alt"],containPoint:function(){},setCameraOption:function(e){this.bearing=e.bearing,this.pitch=e.pitch,this.center=e.center,this.zoom=e.zoom,this._origin||(this._origin=this.projectOnTileWithScale(this.center,Ef)),this._initialZoom==null&&(this._initialZoom=this.zoom),this.updateTransform()},updateTransform:function(){if(this.height){var e=.5/Math.tan(SC/2)*this.height*zh,t=Math.max(Math.min(this.pitch,this.maxPitch),0)/180*Math.PI,i=SC/2,r=Math.PI/2+t,n=Math.sin(i)*e/Math.sin(Math.PI-r-i),a=Math.cos(Math.PI/2-t)*n+e,o=a*1.1;this.pitch>50&&(o=1e3);var s=[];yc.perspective(s,SC,this.width/this.height,1,o),this.viewGL.camera.projectionMatrix.setArray(s),this.viewGL.camera.decomposeProjectionMatrix();var s=yc.identity([]),l=this.dataToPoint(this.center);yc.scale(s,s,[1,-1,1]),yc.translate(s,s,[0,0,-e]),yc.rotateX(s,s,t),yc.rotateZ(s,s,-this.bearing/180*Math.PI),yc.translate(s,s,[-l[0]*this.getScale()*zh,-l[1]*this.getScale()*zh,0]),this.viewGL.camera.viewMatrix.array=s;var c=[];yc.invert(c,s),this.viewGL.camera.worldTransform.array=c,this.viewGL.camera.decomposeWorldTransform();var d=Ef*this.getScale(),u;if(this.altitudeExtent&&!isNaN(this.boxHeight)){var h=this.altitudeExtent[1]-this.altitudeExtent[0];u=this.boxHeight/h*this.getScale()/Math.pow(2,this._initialZoom-this.zoomOffset)}else u=d/(2*Math.PI*6378e3*Math.abs(Math.cos(this.center[1]*(Math.PI/180))))*this.altitudeScale*zh;this.viewGL.rootNode.scale.set(this.getScale()*zh,this.getScale()*zh,u)}},getScale:function(){return Math.pow(2,this.zoom-this.zoomOffset)},projectOnTile:function(e,t){return this.projectOnTileWithScale(e,this.getScale()*Ef,t)},projectOnTileWithScale:function(e,t,i){var r=e[0],n=e[1],a=r*Ia/180,o=n*Ia/180,s=t*(a+Ia)/(2*Ia),l=t*(Ia-Math.log(Math.tan(Ia/4+o*.5)))/(2*Ia);return i=i||[],i[0]=s,i[1]=l,i},unprojectFromTile:function(e,t){return this.unprojectOnTileWithScale(e,this.getScale()*Ef,t)},unprojectOnTileWithScale:function(e,t,i){var r=e[0],n=e[1],a=r/t*(2*Ia)-Ia,o=2*(Math.atan(Math.exp(Ia-n/t*(2*Ia)))-Ia/4);return i=i||[],i[0]=a*180/Ia,i[1]=o*180/Ia,i},dataToPoint:function(e,t){return t=this.projectOnTileWithScale(e,Ef,t),t[0]-=this._origin[0],t[1]-=this._origin[1],t[2]=isNaN(e[2])?0:e[2],isNaN(e[2])||(t[2]=e[2],this.altitudeExtent&&(t[2]-=this.altitudeExtent[0])),t}};var Uh=AC;function Sf(){Uh.apply(this,arguments)}Sf.prototype=new Uh;Sf.prototype.constructor=Sf;Sf.prototype.type="mapbox3D";var NR=Sf;function P_(e,t,i){function r(a,o){var s=o.getWidth(),l=o.getHeight(),c=o.getDevicePixelRatio();this.viewGL.setViewport(0,0,s,l,c),this.width=s,this.height=l,this.altitudeScale=a.get("altitudeScale"),this.boxHeight=a.get("boxHeight")}function n(a,o){if(this.model.get("boxHeight")!=="auto"){var s=[1/0,-1/0];a.eachSeries(function(l){if(l.coordinateSystem===this){var c=l.getData(),d=l.coordDimToDataDim("alt")[0];if(d){var u=c.getDataExtent(d,!0);s[0]=Math.min(s[0],u[0]),s[1]=Math.max(s[1],u[1])}}},this),s&&isFinite(s[1]-s[0])&&(this.altitudeExtent=s)}}return{dimensions:t.prototype.dimensions,create:function(a,o){var s=[];return a.eachComponent(e,function(l){var c=l.__viewGL;c||(c=l.__viewGL=new Bn,c.setRootNode(new R.Node));var d=new t;d.viewGL=l.__viewGL,d.resize=r,d.resize(l,o),s.push(d),l.coordinateSystem=d,d.model=l,d.update=n}),a.eachSeries(function(l){if(l.get("coordinateSystem")===e){var c=l.getReferringComponents(e).models[0];if(c||(c=a.getComponent(e)),!c)throw new Error(e+' "'+ht.firstNotNull(l.get(e+"Index"),l.get(e+"Id"),0)+'" not found');l.coordinateSystem=c.coordinateSystem}}),i&&i(s,a,o),s}}}var Cj=P_("mapbox3D",NR,function(e){e.forEach(function(t){t.setCameraOption(t.model.getMapboxCameraOption())})}),PR=Cj;function RR(e){e.registerComponentModel(DR),e.registerComponentView(kR),e.registerCoordinateSystem("mapbox3D",PR),e.registerAction({type:"mapbox3DChangeCamera",event:"mapbox3dcamerachanged",update:"mapbox3D:updateCamera"},function(t,i){i.eachComponent({mainType:"mapbox3D",query:t},function(r){r.setMapboxCameraOption(t)})})}Ci(RR);var FR=["zoom","center","pitch","bearing"],TC=Eo.extend({type:"maptalks3D",layoutMode:"box",coordinateSystem:null,defaultOption:{zlevel:-10,urlTemplate:"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://osm.org">OpenStreetMap</a> contributors, &copy; <a href="https://carto.com/">CARTO</a>',center:[0,0],zoom:0,pitch:0,bearing:0,light:{main:{alpha:20,beta:30}},altitudeScale:1,boxHeight:"auto"},getMaptalksCameraOption:function(){var e=this;return FR.reduce(function(t,i){return t[i]=e.get(i),t},{})},setMaptalksCameraOption:function(e){e!=null&&FR.forEach(function(t){e[t]!=null&&(this.option[t]=e[t])},this)},getMaptalks:function(){return this._maptalks},setMaptalks:function(e){this._maptalks=e}});Ee.merge(TC.prototype,Io);Ee.merge(TC.prototype,ko);var OR=TC;function wc(e,t,i,r){if(this.id=e,this.zr=t,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute;left:0;right:0;top:0;bottom:0;",!maptalks)throw new Error("Maptalks library must be included. See https://maptalks.org");this._maptalks=new maptalks.Map(this.dom,{center:i,zoom:r,doubleClickZoom:!1,fog:!1}),this._initEvents()}wc.prototype.setUnpainted=function(){};wc.prototype.resize=function(){this._maptalks.checkSize()};wc.prototype.getMaptalks=function(){return this._maptalks};wc.prototype.clear=function(){};wc.prototype.refresh=function(){this._maptalks.checkSize()};var LR=["mousedown","mouseup","click","dblclick","mousemove","mousewheel","DOMMouseScroll","touchstart","touchend","touchmove","touchcancel"];wc.prototype._initEvents=function(){var e=this.dom;this._handlers=this._handlers||{contextmenu:function(t){return t.preventDefault(),!1}},LR.forEach(function(t){this._handlers[t]=function(i){var r={};for(var n in i)r[n]=i[n];r.bubbles=!1;var a=new i.constructor(i.type,r);t==="mousewheel"||t==="DOMMouseScroll"?e.dispatchEvent(a):e.firstElementChild.dispatchEvent(a)},this.zr.dom.addEventListener(t,this._handlers[t])},this),this.zr.dom.addEventListener("contextmenu",this._handlers.contextmenu)};wc.prototype.dispose=function(){LR.forEach(function(e){this.zr.dom.removeEventListener(e,this._handlers[e])},this),this._maptalks.remove()};var BR=wc;R.Shader.import(N_);var VR=As.extend({type:"maptalks3D",__ecgl__:!0,init:function(e,t){this._groundMesh=new R.Mesh({geometry:new R.PlaneGeometry,material:new R.Material({shader:new R.Shader({vertex:R.Shader.source("ecgl.displayShadow.vertex"),fragment:R.Shader.source("ecgl.displayShadow.fragment")}),depthMask:!1}),renderOrder:-100,culling:!1,castShadow:!1,$ignorePicking:!0,renderNormal:!0})},_initMaptalksLayer:function(e,t){var i=t.getZr();this._zrLayer=new BR("maptalks3D",i,e.get("center"),e.get("zoom")),i.painter.insertLayer(-1e3,this._zrLayer),this._lightRoot=new R.Node,this._sceneHelper=new No(this._lightRoot),this._sceneHelper.initLight(this._lightRoot);var r=this._zrLayer.getMaptalks(),n=this._dispatchInteractAction.bind(this,t,r);["zoomend","zooming","zoomstart","dragrotating","pitch","pitchend","movestart","moving","moveend","resize","touchstart","touchmove","touchend","animating"].forEach(function(a){r.on(a,n)})},render:function(e,t,i){this._zrLayer||this._initMaptalksLayer(e,i);var r=this._zrLayer.getMaptalks(),n=e.get("urlTemplate"),a=r.getBaseLayer();n!==this._oldUrlTemplate&&(a?a.setOptions({urlTemplate:n,attribution:e.get("attribution")}):(a=new maptalks.TileLayer("maptalks-echarts-gl-baselayer",{urlTemplate:n,subdomains:["a","b","c"],attribution:e.get("attribution")}),r.setBaseLayer(a))),this._oldUrlTemplate=n,r.setCenter(e.get("center")),r.setZoom(e.get("zoom"),{animation:!1}),r.setPitch(e.get("pitch")),r.setBearing(e.get("bearing")),e.setMaptalks(r);var o=e.coordinateSystem;o.viewGL.scene.add(this._lightRoot),o.viewGL.add(this._groundMesh),this._updateGroundMesh(),this._sceneHelper.setScene(o.viewGL.scene),this._sceneHelper.updateLight(e),o.viewGL.setPostEffect(e.getModel("postEffect"),i),o.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._maptalks3DModel=e},afterRender:function(e,t,i,r){var n=r.renderer;this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i),e.coordinateSystem.viewGL.scene.traverse(function(a){a.material&&(a.material.define("fragment","NORMAL_UP_AXIS",2),a.material.define("fragment","NORMAL_FRONT_AXIS",1))})},updateCamera:function(e,t,i,r){e.coordinateSystem.setCameraOption(r),this._updateGroundMesh(),i.getZr().refresh()},_dispatchInteractAction:function(e,t,i){e.dispatchAction({type:"maptalks3DChangeCamera",pitch:t.getPitch(),zoom:Sj(t.getResolution())+1,center:t.getCenter().toArray(),bearing:t.getBearing(),maptalks3DId:this._maptalks3DModel&&this._maptalks3DModel.id})},_updateGroundMesh:function(){if(this._maptalks3DModel){var e=this._maptalks3DModel.coordinateSystem,t=e.dataToPoint(e.center);this._groundMesh.position.set(t[0],t[1],-.001);var i=new R.Plane(new R.Vector3(0,0,1),0),r=e.viewGL.camera.castRay(new R.Vector2(-1,-1)),n=e.viewGL.camera.castRay(new R.Vector2(1,1)),a=r.intersectPlane(i),o=n.intersectPlane(i),s=a.dist(o)/e.viewGL.rootNode.scale.x;this._groundMesh.scale.set(s,s,1)}},dispose:function(e,t){this._zrLayer&&this._zrLayer.dispose(),t.getZr().painter.delLayer(-1e3)}}),Ej=2*6378137*Math.PI/(256*Math.pow(2,20));function Sj(e){return 19-Math.log(e/Ej)/Math.LN2}function Af(){Uh.apply(this,arguments),this.maxPitch=85,this.zoomOffset=1}Af.prototype=new Uh;Af.prototype.constructor=Af;Af.prototype.type="maptalks3D";var zR=Af;var Aj=P_("maptalks3D",zR,function(e){e.forEach(function(t){t.setCameraOption(t.model.getMaptalksCameraOption())})}),UR=Aj;function HR(e){e.registerComponentModel(OR),e.registerComponentView(VR),e.registerCoordinateSystem("maptalks3D",UR),e.registerAction({type:"maptalks3DChangeCamera",event:"maptalks3dcamerachanged",update:"maptalks3D:updateCamera"},function(t,i){i.eachComponent({mainType:"maptalks3D",query:t},function(r){r.setMaptalksCameraOption(t)})})}Ci(HR);var Tj=ri.vec3,Dj=$i.dataStack.isDimensionStacked;function Mj(e){var t=e[0],i=e[1];return!(t>0&&i>0||t<0&&i<0)}function Ij(e,t){var i=e.getData(),r=e.get("barSize");if(r==null){var n=t.size,a,o,s=t.getAxis("x"),l=t.getAxis("y");s.type==="category"?a=s.getBandWidth()*.7:a=Math.round(n[0]/Math.sqrt(i.count()))*.6,l.type==="category"?o=l.getBandWidth()*.7:o=Math.round(n[1]/Math.sqrt(i.count()))*.6,r=[a,o]}else Ee.isArray(r)||(r=[r,r]);var c=t.getAxis("z").scale.getExtent(),d=Mj(c),u=["x","y","z"].map(function(f){return e.coordDimToDataDim(f)[0]}),h=Dj(i,u[2]),m=h?i.getCalculationInfo("stackResultDimension"):u[2];i.each(u,function(f,p,g,v){var b=i.get(m,v),_=h?b-g:d?0:c[0],x=t.dataToPoint([f,p,_]),w=t.dataToPoint([f,p,b]),y=Tj.dist(x,w),M=[0,w[1]<x[1]?-1:1,0];Math.abs(y)===0&&(y=.1);var T=[r[0],y,r[1]];i.setItemLayout(v,[x,M,T])}),i.setLayout("orient",[1,0,0])}var GR=Ij;function R_(e,t,i){for(var r=e.getDataExtent(t),n=e.getDataExtent(i),a=r[1]-r[0]||r[0],o=n[1]-n[0]||n[0],s=50,l=new Uint8Array(s*s),c=0;c<e.count();c++){var d=e.get(t,c),u=e.get(i,c),h=Math.floor((d-r[0])/a*(s-1)),m=Math.floor((u-n[0])/o*(s-1)),f=m*s+h;l[f]=l[f]||1}for(var p=0,c=0;c<l.length;c++)l[c]&&p++;return p/l.length}var jR=ri.vec3,kj=$i.dataStack.isDimensionStacked;function Nj(e,t){var i=e.getData(),r=e.get("minHeight")||0,n=e.get("barSize"),a=["lng","lat","alt"].map(function(c){return e.coordDimToDataDim(c)[0]});if(n==null){var o=t.radius*Math.PI,s=R_(i,a[0],a[1]);n=[o/Math.sqrt(i.count()/s),o/Math.sqrt(i.count()/s)]}else Ee.isArray(n)||(n=[n,n]);var l=DC(i,a);i.each(a,function(c,d,u,h){var m=i.get(l.dimension,h),f=l.isStacked?m-u:t.altitudeAxis.scale.getExtent()[0],p=Math.max(t.altitudeAxis.dataToCoord(u),r),g=t.dataToPoint([c,d,f]),v=t.dataToPoint([c,d,m]),b=jR.sub([],v,g);jR.normalize(b,b);var _=[n[0],p,n[1]];i.setItemLayout(h,[g,b,_])}),i.setLayout("orient",Se.UP.array)}function Pj(e,t){var i=e.getData(),r=e.get("barSize"),n=e.get("minHeight")||0,a=["lng","lat","alt"].map(function(d){return e.coordDimToDataDim(d)[0]});if(r==null){var o=Math.min(t.size[0],t.size[2]),s=R_(i,a[0],a[1]);r=[o/Math.sqrt(i.count()/s),o/Math.sqrt(i.count()/s)]}else Ee.isArray(r)||(r=[r,r]);var l=[0,1,0],c=DC(i,a);i.each(a,function(d,u,h,m){var f=i.get(c.dimension,m),p=c.isStacked?f-h:t.altitudeAxis.scale.getExtent()[0],g=Math.max(t.altitudeAxis.dataToCoord(h),n),v=t.dataToPoint([d,u,p]),b=[r[0],g,r[1]];i.setItemLayout(m,[v,l,b])}),i.setLayout("orient",[1,0,0])}function Rj(e,t){var i=e.getData(),r=e.coordDimToDataDim("lng")[0],n=e.coordDimToDataDim("lat")[0],a=e.coordDimToDataDim("alt")[0],o=e.get("barSize"),s=e.get("minHeight")||0;if(o==null){var l=i.getDataExtent(r),c=i.getDataExtent(n),d=t.dataToPoint([l[0],c[0]]),u=t.dataToPoint([l[1],c[1]]),h=Math.min(Math.abs(d[0]-u[0]),Math.abs(d[1]-u[1]))||1,m=R_(i,r,n);o=[h/Math.sqrt(i.count()/m),h/Math.sqrt(i.count()/m)]}else Ee.isArray(o)||(o=[o,o]),o[0]/=t.getScale()/16,o[1]/=t.getScale()/16;var f=[0,0,1],p=[r,n,a],g=DC(i,p);i.each(p,function(v,b,_,x){var w=i.get(g.dimension,x),y=g.isStacked?w-_:0,M=t.dataToPoint([v,b,y]),T=t.dataToPoint([v,b,w]),C=Math.max(T[2]-M[2],s),N=[o[0],C,o[1]];i.setItemLayout(x,[M,f,N])}),i.setLayout("orient",[1,0,0])}function DC(e,t){var i=kj(e,t[2]);return{dimension:i?e.getCalculationInfo("stackResultDimension"):t[2],isStacked:i}}function MC(e){e.registerLayout(function(t,i){t.eachSeriesByType("bar3D",function(r){var n=r.coordinateSystem,a=n&&n.type;a==="globe"?Nj(r,n):a==="cartesian3D"?GR(r,n):a==="geo3D"?Pj(r,n):(a==="mapbox3D"||a==="maptalks3D")&&Rj(r,n)})})}var IC={};IC.getFormattedLabel=function(e,t,i,r,n){i=i||"normal";var a=e.getData(r),o=a.getItemModel(t),s=e.getDataParams(t,r);n!=null&&s.value instanceof Array&&(s.value=s.value[n]);var l=o.get(i==="normal"?["label","formatter"]:["emphasis","label","formatter"]);l==null&&(l=o.get(["label","formatter"]));var c;return typeof l=="function"?(s.status=i,c=l(s)):typeof l=="string"&&(c=Sa.formatTpl(l,s)),c};IC.normalizeToArray=function(e){return e instanceof Array?e:e==null?[]:[e]};var Fo=IC;function Fj(e,t){var i=[];return Ee.each(e.dimensions,function(r){var n=e.getDimensionInfo(r),a=n.otherDims,o=a[t];o!=null&&o!==!1&&(i[o]=n.name)}),i}function Ns(e,t,i){function r(u){var h=!0,m=[],f=Fj(n,"tooltip");f.length?Ee.each(f,function(g){p(n.get(g,t),g)}):Ee.each(u,p);function p(g,v){var b=n.getDimensionInfo(v);if(!(!b||b.otherDims.tooltip===!1)){var _=b.type,x=(h?"- "+(b.tooltipName||b.name)+": ":"")+(_==="ordinal"?g+"":_==="time"?i?"":Sa.formatTime("yyyy/MM/dd hh:mm:ss",g):Sa.addCommas(g));x&&m.push(Sa.encodeHTML(x))}}return(h?"<br/>":"")+m.join(h?"<br/>":", ")}var n=e.getData(),a=e.getRawValue(t),o=Ee.isArray(a)?r(a):Sa.encodeHTML(Sa.addCommas(a)),s=n.getName(t),l=Gi(n,t);Ee.isObject(l)&&l.colorStops&&(l=(l.colorStops[0]||{}).color),l=l||"transparent";var c=Sa.getTooltipMarker(l),d=e.name;return d==="\0-"&&(d=""),d=d?Sa.encodeHTML(d)+(i?": ":"<br/>"):"",i?c+d+o:d+c+(s?Sa.encodeHTML(s)+": "+o:o)}function Cc(e,t,i){i=i||e.getSource();var r=t||r0(e.get("coordinateSystem"))||["x","y","z"],n=$i.createDimensions(i,{dimensionsDefine:i.dimensionsDefine||e.get("dimensions"),encodeDefine:i.encodeDefine||e.get("encode"),coordDimensions:r.map(function(s){var l=e.getReferringComponents(s+"Axis3D").models[0];return{type:l&&l.get("type")==="category"?"ordinal":"float",name:s}})});e.get("coordinateSystem")==="cartesian3D"&&n.forEach(function(s){if(r.indexOf(s.coordDim)>=0){var l=e.getReferringComponents(s.coordDim+"Axis3D").models[0];l&&l.get("type")==="category"&&(s.ordinalMeta=l.getOrdinalMeta())}});var a=$i.dataStack.enableDataStack(e,n,{byIndex:!0,stackedCoordDimension:"z"}),o=new en(n,e);return o.setCalculationInfo(a),o.initData(i),o}var WR=Pr.extend({type:"series.bar3D",dependencies:["globe"],visualStyleAccessPathvisu:"itemStyle",getInitialData:function(e,t){return Cc(this)},getFormattedLabel:function(e,t,i,r){var n=Fo.getFormattedLabel(this,e,t,i,r);return n==null&&(n=this.getData().get("z",e)),n},formatTooltip:function(e){return Ns(this,e)},defaultOption:{coordinateSystem:"cartesian3D",globeIndex:0,grid3DIndex:0,zlevel:-10,bevelSize:0,bevelSmoothness:2,onGridPlane:"xy",shading:"color",minHeight:0,itemStyle:{opacity:1},label:{show:!1,distance:2,textStyle:{fontSize:14,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:3}},emphasis:{label:{show:!0}},animationDurationUpdate:500}});Ee.merge(WR.prototype,Po);var qR=WR;var Sr=ri.vec3,Oj=ri.mat3,kC=Lt.extend(function(){return{attributes:{position:new Lt.Attribute("position","float",3,"POSITION"),normal:new Lt.Attribute("normal","float",3,"NORMAL"),color:new Lt.Attribute("color","float",4,"COLOR"),prevPosition:new Lt.Attribute("prevPosition","float",3),prevNormal:new Lt.Attribute("prevNormal","float",3)},dynamic:!0,enableNormal:!1,bevelSize:1,bevelSegments:0,_dataIndices:null,_vertexOffset:0,_triangleOffset:0}},{resetOffset:function(){this._vertexOffset=0,this._triangleOffset=0},setBarCount:function(e){var t=this.enableNormal,i=this.getBarVertexCount()*e,r=this.getBarTriangleCount()*e;this.vertexCount!==i&&(this.attributes.position.init(i),t?this.attributes.normal.init(i):this.attributes.normal.value=null,this.attributes.color.init(i)),this.triangleCount!==r&&(this.indices=i>65535?new Uint32Array(r*3):new Uint16Array(r*3),this._dataIndices=new Uint32Array(i))},getBarVertexCount:function(){var e=this.bevelSize>0?this.bevelSegments:0;return e>0?this._getBevelBarVertexCount(e):this.enableNormal?24:8},getBarTriangleCount:function(){var e=this.bevelSize>0?this.bevelSegments:0;return e>0?this._getBevelBarTriangleCount(e):12},_getBevelBarVertexCount:function(e){return(e+1)*4*(e+1)*2},_getBevelBarTriangleCount:function(e){var t=e*4+3,i=e*2+1;return(t+1)*i*2+4},setColor:function(e,t){for(var i=this.getBarVertexCount(),r=i*e,n=i*(e+1),a=r;a<n;a++)this.attributes.color.set(a,t);this.dirtyAttribute("color")},getDataIndexOfVertex:function(e){return this._dataIndices?this._dataIndices[e]:null},addBar:function(){for(var e=Sr.create,t=Sr.scaleAndAdd,i=e(),r=e(),n=e(),a=e(),o=e(),s=e(),l=e(),c=[],d=[],u=0;u<8;u++)c[u]=e();for(var h=[[0,1,5,4],[2,3,7,6],[4,5,6,7],[3,2,1,0],[0,4,7,3],[1,2,6,5]],m=[0,1,2,0,2,3],f=[],u=0;u<h.length;u++)for(var p=h[u],g=0;g<2;g++){for(var v=[],b=0;b<3;b++)v.push(p[m[g*3+b]]);f.push(v)}return function(_,x,w,y,M,T){var C=this._vertexOffset;if(this.bevelSize>0&&this.bevelSegments>0)this._addBevelBar(_,x,w,y,this.bevelSize,this.bevelSegments,M);else{Sr.copy(n,x),Sr.normalize(n,n),Sr.cross(a,w,n),Sr.normalize(a,a),Sr.cross(r,n,a),Sr.normalize(a,a),Sr.negate(o,r),Sr.negate(s,n),Sr.negate(l,a),t(c[0],_,r,y[0]/2),t(c[0],c[0],a,y[2]/2),t(c[1],_,r,y[0]/2),t(c[1],c[1],l,y[2]/2),t(c[2],_,o,y[0]/2),t(c[2],c[2],l,y[2]/2),t(c[3],_,o,y[0]/2),t(c[3],c[3],a,y[2]/2),t(i,_,n,y[1]),t(c[4],i,r,y[0]/2),t(c[4],c[4],a,y[2]/2),t(c[5],i,r,y[0]/2),t(c[5],c[5],l,y[2]/2),t(c[6],i,o,y[0]/2),t(c[6],c[6],l,y[2]/2),t(c[7],i,o,y[0]/2),t(c[7],c[7],a,y[2]/2);var N=this.attributes;if(this.enableNormal){d[0]=r,d[1]=o,d[2]=n,d[3]=s,d[4]=a,d[5]=l;for(var D=this._vertexOffset,k=0;k<h.length;k++){for(var U=this._triangleOffset*3,F=0;F<6;F++)this.indices[U++]=D+m[F];D+=4,this._triangleOffset+=2}for(var k=0;k<h.length;k++)for(var H=d[k],F=0;F<4;F++){var V=h[k][F];N.position.set(this._vertexOffset,c[V]),N.normal.set(this._vertexOffset,H),N.color.set(this._vertexOffset++,M)}}else{for(var k=0;k<f.length;k++){for(var U=this._triangleOffset*3,F=0;F<3;F++)this.indices[U+F]=f[k][F]+this._vertexOffset;this._triangleOffset++}for(var k=0;k<c.length;k++)N.position.set(this._vertexOffset,c[k]),N.color.set(this._vertexOffset++,M)}}for(var Q=this._vertexOffset,k=C;k<Q;k++)this._dataIndices[k]=T}}(),_addBevelBar:function(){var e=Sr.create(),t=Sr.create(),i=Sr.create(),r=Oj.create(),n=[],a=[1,-1,-1,1],o=[1,1,-1,-1],s=[2,0];return function(l,c,d,u,h,m,f){Sr.copy(t,c),Sr.normalize(t,t),Sr.cross(i,d,t),Sr.normalize(i,i),Sr.cross(e,t,i),Sr.normalize(i,i),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=t[0],r[4]=t[1],r[5]=t[2],r[6]=i[0],r[7]=i[1],r[8]=i[2],h=Math.min(u[0],u[2])/2*h;for(var p=0;p<3;p++)n[p]=Math.max(u[p]-h*2,0);for(var g=(u[0]-n[0])/2,v=(u[1]-n[1])/2,b=(u[2]-n[2])/2,_=[],x=[],w=this._vertexOffset,y=[],p=0;p<2;p++){y[p]=y[p]=[];for(var M=0;M<=m;M++)for(var T=0;T<4;T++){(M===0&&p===0||p===1&&M===m)&&y[p].push(w);for(var C=0;C<=m;C++){var N=C/m*Math.PI/2+Math.PI/2*T,D=M/m*Math.PI/2+Math.PI/2*p;x[0]=g*Math.cos(N)*Math.sin(D),x[1]=v*Math.cos(D),x[2]=b*Math.sin(N)*Math.sin(D),_[0]=x[0]+a[T]*n[0]/2,_[1]=x[1]+v+s[p]*n[1]/2,_[2]=x[2]+o[T]*n[2]/2,Math.abs(g-v)<1e-6&&Math.abs(v-b)<1e-6||(x[0]/=g*g,x[1]/=v*v,x[2]/=b*b),Sr.normalize(x,x),Sr.transformMat3(_,_,r),Sr.transformMat3(x,x,r),Sr.add(_,_,l),this.attributes.position.set(w,_),this.enableNormal&&this.attributes.normal.set(w,x),this.attributes.color.set(w,f),w++}}}for(var k=m*4+3,U=m*2+1,F=k+1,T=0;T<U;T++)for(var p=0;p<=k;p++){var H=T*F+p+this._vertexOffset,V=T*F+(p+1)%F+this._vertexOffset,Q=(T+1)*F+(p+1)%F+this._vertexOffset,$=(T+1)*F+p+this._vertexOffset;this.setTriangleIndices(this._triangleOffset++,[Q,H,V]),this.setTriangleIndices(this._triangleOffset++,[Q,$,H])}this.setTriangleIndices(this._triangleOffset++,[y[0][0],y[0][2],y[0][1]]),this.setTriangleIndices(this._triangleOffset++,[y[0][0],y[0][3],y[0][2]]),this.setTriangleIndices(this._triangleOffset++,[y[1][0],y[1][1],y[1][2]]),this.setTriangleIndices(this._triangleOffset++,[y[1][0],y[1][2],y[1][3]]),this._vertexOffset=w}}()});Ee.defaults(kC.prototype,Is);Ee.defaults(kC.prototype,Lh);var $R=kC;var Lj=ri.vec3,XR=Rr.extend({type:"bar3D",__ecgl__:!0,init:function(e,t){this.groupGL=new R.Node,this._api=t,this._labelsBuilder=new Bh(256,256,t);var i=this;this._labelsBuilder.getLabelPosition=function(r,n,a){if(i._data){var o=i._data.getItemLayout(r),s=o[0],l=o[1],c=o[2][1];return Lj.scaleAndAdd([],s,l,a+c)}else return[0,0]},this._labelsBuilder.getMesh().renderOrder=100},render:function(e,t,i){var r=this._prevBarMesh;this._prevBarMesh=this._barMesh,this._barMesh=r,this._barMesh||(this._barMesh=new R.Mesh({geometry:new $R,shadowDepthMaterial:new R.Material({shader:new R.Shader(R.Shader.source("ecgl.sm.depth.vertex"),R.Shader.source("ecgl.sm.depth.fragment"))}),culling:e.coordinateSystem.type==="cartesian3D",renderOrder:10,renderNormal:!0})),this.groupGL.remove(this._prevBarMesh),this.groupGL.add(this._barMesh),this.groupGL.add(this._labelsBuilder.getMesh());var n=e.coordinateSystem;if(this._doRender(e,i),n&&n.viewGL){n.viewGL.add(this.groupGL);var a=n.viewGL.isLinearSpace()?"define":"undefine";this._barMesh.material[a]("fragment","SRGB_DECODE")}this._data=e.getData(),this._labelsBuilder.updateData(this._data),this._labelsBuilder.updateLabels(),this._updateAnimation(e)},_updateAnimation:function(e){R.updateVertexAnimation([["prevPosition","position"],["prevNormal","normal"]],this._prevBarMesh,this._barMesh,e)},_doRender:function(e,t){var i=e.getData(),r=e.get("shading"),n=r!=="color",a=this,o=this._barMesh,s="ecgl."+r;(!o.material||o.material.shader.name!==s)&&(o.material=R.createMaterial(s,["VERTEX_COLOR"])),R.setMaterialFromModel(r,o.material,e,t),o.geometry.enableNormal=n,o.geometry.resetOffset();var l=e.get("bevelSize"),c=e.get("bevelSmoothness");o.geometry.bevelSegments=c,o.geometry.bevelSize=l;var d=[],u=new Float32Array(i.count()*4),h=0,g=0,m=!1;i.each(function(b){if(i.hasValue(b)){var _=Gi(i,b),x=Zi(i,b);x==null&&(x=1),R.parseColor(_,d),d[3]*=x,u[h++]=d[0],u[h++]=d[1],u[h++]=d[2],u[h++]=d[3],d[3]>0&&(g++,d[3]<.99&&(m=!0))}}),o.geometry.setBarCount(g);var f=i.getLayout("orient"),p=this._barIndexOfData=new Int32Array(i.count()),g=0;i.each(function(b){if(!i.hasValue(b)){p[b]=-1;return}var _=i.getItemLayout(b),x=_[0],w=_[1],y=_[2],M=b*4;d[0]=u[M++],d[1]=u[M++],d[2]=u[M++],d[3]=u[M++],d[3]>0&&(a._barMesh.geometry.addBar(x,w,f,y,d,b),p[b]=g++)}),o.geometry.dirty(),o.geometry.updateBoundingBox();var v=o.material;v.transparent=m,v.depthMask=!m,o.geometry.sortTriangles=m,this._initHandler(e,t)},_initHandler:function(e,t){var i=e.getData(),r=this._barMesh,n=e.coordinateSystem.type==="cartesian3D";r.seriesIndex=e.seriesIndex;var a=-1;r.off("mousemove"),r.off("mouseout"),r.on("mousemove",function(o){var s=r.geometry.getDataIndexOfVertex(o.triangle[0]);s!==a&&(this._downplay(a),this._highlight(s),this._labelsBuilder.updateLabels([s]),n&&t.dispatchAction({type:"grid3DShowAxisPointer",value:[i.get("x",s),i.get("y",s),i.get("z",s,!0)]})),a=s,r.dataIndex=s},this),r.on("mouseout",function(o){this._downplay(a),this._labelsBuilder.updateLabels(),a=-1,r.dataIndex=-1,n&&t.dispatchAction({type:"grid3DHideAxisPointer"})},this)},_highlight:function(e){var t=this._data;if(t){var i=this._barIndexOfData[e];if(!(i<0)){var r=t.getItemModel(e),n=r.getModel("emphasis.itemStyle"),a=n.get("color"),o=n.get("opacity");if(a==null){var s=Gi(t,e);a=Ss.lift(s,-.4)}o==null&&(o=Zi(t,e));var l=R.parseColor(a);l[3]*=o,this._barMesh.geometry.setColor(i,l),this._api.getZr().refresh()}}},_downplay:function(e){var t=this._data;if(t){var i=this._barIndexOfData[e];if(!(i<0)){var r=Gi(t,e),n=Zi(t,e),a=R.parseColor(r);a[3]*=n,this._barMesh.geometry.setColor(i,a),this._api.getZr().refresh()}}},highlight:function(e,t,i,r){this._toggleStatus("highlight",e,t,i,r)},downplay:function(e,t,i,r){this._toggleStatus("downplay",e,t,i,r)},_toggleStatus:function(e,t,i,r,n){var a=t.getData(),o=ht.queryDataIndex(a,n),s=this;o!=null?Ee.each(Fo.normalizeToArray(o),function(l){e==="highlight"?this._highlight(l):this._downplay(l)},this):a.each(function(l){e==="highlight"?s._highlight(l):s._downplay(l)})},remove:function(){this.groupGL.removeAll()},dispose:function(){this._labelsBuilder.dispose(),this.groupGL.removeAll()}});function YR(e){e.registerChartView(XR),e.registerSeriesModel(qR),MC(e),e.registerProcessor(function(t,i){t.eachSeriesByType("bar3d",function(r){var n=r.getData();n.filterSelf(function(a){return n.hasValue(a)})})})}Ci(YR);var Bj=Pr.extend({type:"series.line3D",dependencies:["grid3D"],visualStyleAccessPath:"lineStyle",visualDrawType:"stroke",getInitialData:function(e,t){return Cc(this)},formatTooltip:function(e){return Ns(this,e)},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,grid3DIndex:0,lineStyle:{width:2},animationDurationUpdate:500}}),ZR=Bj;function KR(e,t,i,r,n,a,o){if(n===0)return!1;var s=n,l=0,c=e;if(o>t+s&&o>r+s||o<t-s&&o<r-s||a>e+s&&a>i+s||a<e-s&&a<i-s)return!1;if(e!==i)l=(t-r)/(e-i),c=(e*r-i*t)/(e-i);else return Math.abs(a-e)<=s/2;var d=l*a-o+c,u=d*d/(l*l+1);return u<=s/2*s/2}var zj=ri.vec3;R.Shader.import(_c);var QR=Rr.extend({type:"line3D",__ecgl__:!0,init:function(e,t){this.groupGL=new R.Node,this._api=t},render:function(e,t,i){var r=this._prevLine3DMesh;this._prevLine3DMesh=this._line3DMesh,this._line3DMesh=r,this._line3DMesh||(this._line3DMesh=new R.Mesh({geometry:new Da({useNativeLine:!1,sortTriangles:!0}),material:new R.Material({shader:R.createShader("ecgl.meshLines3D")}),renderOrder:10}),this._line3DMesh.geometry.pick=this._pick.bind(this)),this.groupGL.remove(this._prevLine3DMesh),this.groupGL.add(this._line3DMesh);var n=e.coordinateSystem;if(n&&n.viewGL){n.viewGL.add(this.groupGL);var a=n.viewGL.isLinearSpace()?"define":"undefine";this._line3DMesh.material[a]("fragment","SRGB_DECODE")}this._doRender(e,i),this._data=e.getData(),this._camera=n.viewGL.camera,this.updateCamera(),this._updateAnimation(e)},updateCamera:function(){this._updateNDCPosition()},_doRender:function(e,t){var i=e.getData(),r=this._line3DMesh;r.geometry.resetOffset();var n=i.getLayout("points"),a=[],o=new Float32Array(n.length/3*4),s=0,l=!1;i.each(function(u){var h=Gi(i,u),m=Zi(i,u);m==null&&(m=1),R.parseColor(h,a),a[3]*=m,o[s++]=a[0],o[s++]=a[1],o[s++]=a[2],o[s++]=a[3],a[3]<.99&&(l=!0)}),r.geometry.setVertexCount(r.geometry.getPolylineVertexCount(n)),r.geometry.setTriangleCount(r.geometry.getPolylineTriangleCount(n)),r.geometry.addPolyline(n,o,ht.firstNotNull(e.get("lineStyle.width"),1)),r.geometry.dirty(),r.geometry.updateBoundingBox();var c=r.material;c.transparent=l,c.depthMask=!l;var d=e.getModel("debug.wireframe");d.get("show")?(r.geometry.createAttribute("barycentric","float",3),r.geometry.generateBarycentric(),r.material.set("both","WIREFRAME_TRIANGLE"),r.material.set("wireframeLineColor",R.parseColor(d.get("lineStyle.color")||"rgba(0,0,0,0.5)")),r.material.set("wireframeLineWidth",ht.firstNotNull(d.get("lineStyle.width"),1))):r.material.set("both","WIREFRAME_TRIANGLE"),this._points=n,this._initHandler(e,t)},_updateAnimation:function(e){R.updateVertexAnimation([["prevPosition","position"],["prevPositionPrev","positionPrev"],["prevPositionNext","positionNext"]],this._prevLine3DMesh,this._line3DMesh,e)},_initHandler:function(e,t){var i=e.getData(),r=e.coordinateSystem,n=this._line3DMesh,a=-1;n.seriesIndex=e.seriesIndex,n.off("mousemove"),n.off("mouseout"),n.on("mousemove",function(o){var s=r.pointToData(o.point.array),l=i.indicesOfNearest("x",s[0])[0];l!==a&&(t.dispatchAction({type:"grid3DShowAxisPointer",value:[i.get("x",l),i.get("y",l),i.get("z",l)]}),n.dataIndex=l),a=l},this),n.on("mouseout",function(o){a=-1,n.dataIndex=-1,t.dispatchAction({type:"grid3DHideAxisPointer"})},this)},_updateNDCPosition:function(){var e=new Ye,t=this._camera;Ye.multiply(e,t.projectionMatrix,t.viewMatrix);var i=this._positionNDC,r=this._points,n=r.length/3;(!i||i.length/2!==n)&&(i=this._positionNDC=new Float32Array(n*2));for(var a=[],o=0;o<n;o++){var s=o*3,l=o*2;a[0]=r[s],a[1]=r[s+1],a[2]=r[s+2],a[3]=1,zj.transformMat4(a,a,e.array),i[l]=a[0]/a[3],i[l+1]=a[1]/a[3]}},_pick:function(e,t,i,r,n,a){var o=this._positionNDC,s=this._data.hostModel,l=s.get("lineStyle.width"),c=-1,d=i.viewport.width,u=i.viewport.height,h=d*.5,m=u*.5;e=(e+1)*h,t=(t+1)*m;for(var f=1;f<o.length/2;f++){var p=(o[(f-1)*2]+1)*h,g=(o[(f-1)*2+1]+1)*m,v=(o[f*2]+1)*h,b=(o[f*2+1]+1)*m;if(KR(p,g,v,b,l,e,t)){var _=(p-e)*(p-e)+(g-t)*(g-t),x=(v-e)*(v-e)+(b-t)*(b-t);c=_<x?f-1:f}}if(c>=0){var w=c*3,y=new Se(this._points[w],this._points[w+1],this._points[w+2]);a.push({dataIndex:c,point:y,pointWorld:y.clone(),target:this._line3DMesh,distance:this._camera.getWorldPosition().dist(y)})}},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}});function JR(e){e.registerChartView(QR),e.registerSeriesModel(ZR),e.registerLayout(function(t,i){t.eachSeriesByType("line3D",function(r){var n=r.getData(),a=r.coordinateSystem;if(a){if(a.type!=="cartesian3D")return;var o=new Float32Array(n.count()*3),s=[],l=[],c=a.dimensions,d=c.map(function(u){return r.coordDimToDataDim(u)[0]});a&&n.each(d,function(u,h,m,f){s[0]=u,s[1]=h,s[2]=m,a.dataToPoint(s,l),o[f*3]=l[0],o[f*3+1]=l[1],o[f*3+2]=l[2]}),n.setLayout("points",o)}})})}Ci(JR);var eF=Pr.extend({type:"series.scatter3D",dependencies:["globe","grid3D","geo3D"],visualStyleAccessPath:"itemStyle",hasSymbolVisual:!0,getInitialData:function(e,t){return Cc(this)},getFormattedLabel:function(e,t,i,r){var n=Fo.getFormattedLabel(this,e,t,i,r);if(n==null){var a=this.getData(),o=a.dimensions[a.dimensions.length-1];n=a.get(o,e)}return n},formatTooltip:function(e){return Ns(this,e)},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,progressive:1e5,progressiveThreshold:1e5,grid3DIndex:0,globeIndex:0,symbol:"circle",symbolSize:10,blendMode:"source-over",label:{show:!1,position:"right",distance:5,textStyle:{fontSize:14,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:3}},itemStyle:{opacity:.8},emphasis:{label:{show:!0}},animationDurationUpdate:500}});function NC(e,r,i){var r=r||document.createElement("canvas");r.width=e,r.height=e;var n=r.getContext("2d");return i&&i(n),r}function Uj(e,t,i,r){Ee.isArray(t)||(t=[t,t]);var n=PC.getMarginByStyle(i,r),a=t[0]+n.left+n.right,o=t[1]+n.top+n.bottom,s=$i.createSymbol(e,0,0,t[0],t[1]),l=Math.max(a,o);s.x=n.left,s.y=n.top,a>o?s.y+=(l-o)/2:s.x+=(l-a)/2;var c=s.getBoundingRect();return s.x-=c.x,s.y-=c.y,s.setStyle(i),s.update(),s.__size=l,s}function Hj(e,t,i){var r=t.width,n=t.height,a=e.canvas.width,o=e.canvas.height,s=r/a,l=n/o;function c(v){return v<128?1:-1}function d(v,b){var _=1/0;v=Math.floor(v*s),b=Math.floor(b*l);for(var x=b*r+v,w=t.data[x*4],y=c(w),M=Math.max(b-i,0);M<Math.min(b+i,n);M++)for(var T=Math.max(v-i,0);T<Math.min(v+i,r);T++){var x=M*r+T,C=t.data[x*4],N=c(C),D=T-v,k=M-b;if(y!==N){var U=D*D+k*k;U<_&&(_=U)}}return y*Math.sqrt(_)}for(var u=e.createImageData(a,o),h=0;h<o;h++)for(var m=0;m<a;m++){var f=d(m,h),p=f/i*.5+.5,g=(h*a+m)*4;u.data[g++]=(1-p)*255,u.data[g++]=(1-p)*255,u.data[g++]=(1-p)*255,u.data[g++]=255}return u}var PC={getMarginByStyle:function(e){var t=e.minMargin||0,i=0;e.stroke&&e.stroke!=="none"&&(i=e.lineWidth==null?1:e.lineWidth);var r=e.shadowBlur||0,n=e.shadowOffsetX||0,a=e.shadowOffsetY||0,o={};return o.left=Math.max(i/2,-n+r,t),o.right=Math.max(i/2,n+r,t),o.top=Math.max(i/2,-a+r,t),o.bottom=Math.max(i/2,a+r,t),o},createSymbolSprite:function(e,t,i,r){var n=Uj(e,t,i),a=PC.getMarginByStyle(i);return{image:NC(n.__size,r,function(o){i0(o,n)}),margin:a}},createSDFFromCanvas:function(e,t,i,r){return NC(t,r,function(n){var a=e.getContext("2d"),o=a.getImageData(0,0,e.width,e.height);n.putImageData(Hj(n,o,i),0,0)})},createSimpleSprite:function(e,t){return NC(e,t,function(i){var r=e/2;i.beginPath(),i.arc(r,r,60,0,Math.PI*2,!1),i.closePath();var n=i.createRadialGradient(r,r,0,r,r,r);n.addColorStop(0,"rgba(255, 255, 255, 1)"),n.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),n.addColorStop(1,"rgba(255, 255, 255, 0)"),i.fillStyle=n,i.fill()})}},RC=PC;var tF=ri.vec3,iF={needsSortVertices:function(){return this.sortVertices},needsSortVerticesProgressively:function(){return this.needsSortVertices()&&this.vertexCount>=2e4},doSortVertices:function(e,t){var i=this.indices,r=tF.create();if(!i){i=this.indices=this.vertexCount>65535?new Uint32Array(this.vertexCount):new Uint16Array(this.vertexCount);for(var n=0;n<i.length;n++)i[n]=n}if(t===0){var a=this.attributes.position,e=e.array,o=0;(!this._zList||this._zList.length!==this.vertexCount)&&(this._zList=new Float32Array(this.vertexCount));for(var s,n=0;n<this.vertexCount;n++){a.get(n,r);var l=tF.sqrDist(r,e);isNaN(l)&&(l=1e7,o++),n===0?(s=l,l=0):l=l-s,this._zList[n]=l}this._noneCount=o}if(this.vertexCount<2e4)t===0&&this._simpleSort(this._noneCount/this.vertexCount>.05);else for(var n=0;n<3;n++)this._progressiveQuickSort(t*3+n);this.dirtyIndices()},_simpleSort:function(e){var t=this._zList,i=this.indices;function r(n,a){return t[a]-t[n]}e?Array.prototype.sort.call(i,r):Fh.sort(i,r,0,i.length-1)},_progressiveQuickSort:function(e){var t=this._zList,i=this.indices;this._quickSort=this._quickSort||new Fh,this._quickSort.step(i,function(r,n){return t[n]-t[r]},e)}};var rF=`@export ecgl.sdfSprite.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform float elapsedTime : 0;

attribute vec3 position : POSITION;

#ifdef VERTEX_SIZE
attribute float size;
#else
uniform float u_Size;
#endif

#ifdef VERTEX_COLOR
attribute vec4 a_FillColor: COLOR;
varying vec4 v_Color;
#endif

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
attribute float prevSize;
uniform float percent : 1.0;
#endif


#ifdef POSITIONTEXTURE_ENABLED
uniform sampler2D positionTexture;
#endif

varying float v_Size;

void main()
{

#ifdef POSITIONTEXTURE_ENABLED
 gl_Position = worldViewProjection * vec4(texture2D(positionTexture, position.xy).xy, -10.0, 1.0);
#else

 #ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
 #else
 vec3 pos = position;
 #endif
 gl_Position = worldViewProjection * vec4(pos, 1.0);
#endif

#ifdef VERTEX_SIZE
#ifdef VERTEX_ANIMATION
 v_Size = mix(prevSize, size, percent);
#else
 v_Size = size;
#endif
#else
 v_Size = u_Size;
#endif

#ifdef VERTEX_COLOR
 v_Color = a_FillColor;
 #endif

 gl_PointSize = v_Size;
}

@end

@export ecgl.sdfSprite.fragment

uniform vec4 color: [1, 1, 1, 1];
uniform vec4 strokeColor: [1, 1, 1, 1];
uniform float smoothing: 0.07;

uniform float lineWidth: 0.0;

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif

varying float v_Size;

uniform sampler2D sprite;

@import clay.util.srgb

void main()
{
 gl_FragColor = color;

 vec4 _strokeColor = strokeColor;

#ifdef VERTEX_COLOR
 gl_FragColor *= v_Color;
 #endif

#ifdef SPRITE_ENABLED
 float d = texture2D(sprite, gl_PointCoord).r;
 gl_FragColor.a *= smoothstep(0.5 - smoothing, 0.5 + smoothing, d);

 if (lineWidth > 0.0) {
 float sLineWidth = lineWidth / 2.0;

 float outlineMaxValue0 = 0.5 + sLineWidth;
 float outlineMaxValue1 = 0.5 + sLineWidth + smoothing;
 float outlineMinValue0 = 0.5 - sLineWidth - smoothing;
 float outlineMinValue1 = 0.5 - sLineWidth;

 if (d <= outlineMaxValue1 && d >= outlineMinValue0) {
 float a = _strokeColor.a;
 if (d <= outlineMinValue1) {
 a = a * smoothstep(outlineMinValue0, outlineMinValue1, d);
 }
 else {
 a = a * smoothstep(outlineMaxValue1, outlineMaxValue0, d);
 }
 gl_FragColor.rgb = mix(gl_FragColor.rgb * gl_FragColor.a, _strokeColor.rgb, a);
 gl_FragColor.a = gl_FragColor.a * (1.0 - a) + a;
 }
 }
#endif

#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(gl_FragColor);
#endif
}
@end`;var FC=ri.vec4;R.Shader.import(rF);var Gj=R.Mesh.extend(function(){var e=new R.Geometry({dynamic:!0,attributes:{color:new R.Geometry.Attribute("color","float",4,"COLOR"),position:new R.Geometry.Attribute("position","float",3,"POSITION"),size:new R.Geometry.Attribute("size","float",1),prevPosition:new R.Geometry.Attribute("prevPosition","float",3),prevSize:new R.Geometry.Attribute("prevSize","float",1)}});Object.assign(e,iF);var t=new R.Material({shader:R.createShader("ecgl.sdfSprite"),transparent:!0,depthMask:!1});t.enableTexture("sprite"),t.define("both","VERTEX_COLOR"),t.define("both","VERTEX_SIZE");var i=new R.Texture2D({image:document.createElement("canvas"),flipY:!1});return t.set("sprite",i),e.pick=this._pick.bind(this),{geometry:e,material:t,mode:R.Mesh.POINTS,sizeScale:1}},{_pick:function(e,t,i,r,n,a){var o=this._positionNDC;if(o)for(var s=i.viewport,l=2/s.width,c=2/s.height,d=this.geometry.vertexCount-1;d>=0;d--){var u;this.geometry.indices?u=this.geometry.indices[d]:u=d;var h=o[u*2],m=o[u*2+1],f=this.geometry.attributes.size.get(u)/this.sizeScale,p=f/2;if(e>h-p*l&&e<h+p*l&&t>m-p*c&&t<m+p*c){var g=new R.Vector3,v=new R.Vector3;this.geometry.attributes.position.get(u,g.array),R.Vector3.transformMat4(v,g,this.worldTransform),a.push({vertexIndex:u,point:g,pointWorld:v,target:this,distance:v.distance(r.getWorldPosition())})}}},updateNDCPosition:function(e,t,i){var r=this._positionNDC,n=this.geometry;(!r||r.length/2!==n.vertexCount)&&(r=this._positionNDC=new Float32Array(n.vertexCount*2));for(var a=FC.create(),o=0;o<n.vertexCount;o++)n.attributes.position.get(o,a),a[3]=1,FC.transformMat4(a,a,e.array),FC.scale(a,a,1/a[3]),r[o*2]=a[0],r[o*2+1]=a[1]}}),nF=Gj;var aF=20,oF=-10;function jj(e,t){return e&&t&&e[0]===t[0]&&e[1]===t[1]}function OC(e,t){this.rootNode=new R.Node,this.is2D=e,this._labelsBuilder=new Bh(256,256,t),this._labelsBuilder.getMesh().renderOrder=100,this.rootNode.add(this._labelsBuilder.getMesh()),this._api=t,this._spriteImageCanvas=document.createElement("canvas"),this._startDataIndex=0,this._endDataIndex=0,this._sizeScale=1}OC.prototype={constructor:OC,highlightOnMouseover:!0,update:function(e,t,i,r,n){var a=this._prevMesh;this._prevMesh=this._mesh,this._mesh=a;var o=e.getData();if(r==null&&(r=0),n==null&&(n=o.count()),this._startDataIndex=r,this._endDataIndex=n-1,!this._mesh){var s=this._prevMesh&&this._prevMesh.material;this._mesh=new nF({renderOrder:10,frustumCulling:!1}),s&&(this._mesh.material=s)}var s=this._mesh.material,l=this._mesh.geometry,c=l.attributes;this.rootNode.remove(this._prevMesh),this.rootNode.add(this._mesh),this._setPositionTextureToMesh(this._mesh,this._positionTexture);var d=this._getSymbolInfo(e,r,n),u=i.getDevicePixelRatio(),h=e.getModel("itemStyle").getItemStyle(),m=e.get("large"),f=1;d.maxSize>2?(f=this._updateSymbolSprite(e,h,d,u),s.enableTexture("sprite")):s.disableTexture("sprite"),c.position.init(n-r);var p=[];if(m){s.undefine("VERTEX_SIZE"),s.undefine("VERTEX_COLOR");var g=lR(o),v=cR(o);R.parseColor(g,p),p[3]*=v,s.set({color:p,u_Size:d.maxSize*this._sizeScale})}else s.set({color:[1,1,1,1]}),s.define("VERTEX_SIZE"),s.define("VERTEX_COLOR"),c.size.init(n-r),c.color.init(n-r),this._originalOpacity=new Float32Array(n-r);for(var b=o.getLayout("points"),_=c.position.value,x=!1,w=0;w<n-r;w++){var y=w*3,M=w*2;if(this.is2D?(_[y]=b[M],_[y+1]=b[M+1],_[y+2]=oF):(_[y]=b[y],_[y+1]=b[y+1],_[y+2]=b[y+2]),!m){var g=Gi(o,w),v=Zi(o,w);R.parseColor(g,p),p[3]*=v,c.color.set(w,p),p[3]<.99&&(x=!0);var T=o.getItemVisual(w,"symbolSize");T=T instanceof Array?Math.max(T[0],T[1]):T,isNaN(T)&&(T=0),c.size.value[w]=T*f*this._sizeScale,this._originalOpacity[w]=p[3]}}this._mesh.sizeScale=f,l.updateBoundingBox(),l.dirty(),this._updateMaterial(e,h);var C=e.coordinateSystem;if(C&&C.viewGL){var N=C.viewGL.isLinearSpace()?"define":"undefine";s[N]("fragment","SRGB_DECODE")}m||this._updateLabelBuilder(e,r,n),this._updateHandler(e,t,i),this._updateAnimation(e),this._api=i},getPointsMesh:function(){return this._mesh},updateLabels:function(e){this._labelsBuilder.updateLabels(e)},hideLabels:function(){this.rootNode.remove(this._labelsBuilder.getMesh())},showLabels:function(){this.rootNode.add(this._labelsBuilder.getMesh())},dispose:function(){this._labelsBuilder.dispose()},_updateSymbolSprite:function(e,t,i,r){i.maxSize=Math.min(i.maxSize*2,200);var n=[];return i.aspect>1?(n[0]=i.maxSize,n[1]=i.maxSize/i.aspect):(n[1]=i.maxSize,n[0]=i.maxSize*i.aspect),n[0]=n[0]||1,n[1]=n[1]||1,(this._symbolType!==i.type||!jj(this._symbolSize,n)||this._lineWidth!==t.lineWidth)&&(RC.createSymbolSprite(i.type,n,{fill:"#fff",lineWidth:t.lineWidth,stroke:"transparent",shadowColor:"transparent",minMargin:Math.min(n[0]/2,10)},this._spriteImageCanvas),RC.createSDFFromCanvas(this._spriteImageCanvas,Math.min(this._spriteImageCanvas.width,32),aF,this._mesh.material.get("sprite").image),this._symbolType=i.type,this._symbolSize=n,this._lineWidth=t.lineWidth),this._spriteImageCanvas.width/i.maxSize*r},_updateMaterial:function(e,t){var i=e.get("blendMode")==="lighter"?R.additiveBlend:null,r=this._mesh.material;r.blend=i,r.set("lineWidth",t.lineWidth/aF);var n=R.parseColor(t.stroke);r.set("strokeColor",n),r.transparent=!0,r.depthMask=!1,r.depthTest=!this.is2D,r.sortVertices=!this.is2D},_updateLabelBuilder:function(e,o,i){var r=e.getData(),n=this._mesh.geometry,a=n.attributes.position.value,o=this._startDataIndex,s=this._mesh.sizeScale;this._labelsBuilder.updateData(r,o,i),this._labelsBuilder.getLabelPosition=function(l,c,d){var u=(l-o)*3;return[a[u],a[u+1],a[u+2]]},this._labelsBuilder.getLabelDistance=function(l,c,d){var u=n.attributes.size.get(l-o)/s;return u/2+d},this._labelsBuilder.updateLabels()},_updateAnimation:function(e){R.updateVertexAnimation([["prevPosition","position"],["prevSize","size"]],this._prevMesh,this._mesh,e)},_updateHandler:function(e,t,i){var r=e.getData(),n=this._mesh,a=this,o=-1,s=e.coordinateSystem&&e.coordinateSystem.type==="cartesian3D",l;s&&(l=e.coordinateSystem.model),n.seriesIndex=e.seriesIndex,n.off("mousemove"),n.off("mouseout"),n.on("mousemove",function(c){var d=c.vertexIndex+a._startDataIndex;d!==o&&(this.highlightOnMouseover&&(this.downplay(r,o),this.highlight(r,d),this._labelsBuilder.updateLabels([d])),s&&i.dispatchAction({type:"grid3DShowAxisPointer",value:[r.get(e.coordDimToDataDim("x")[0],d),r.get(e.coordDimToDataDim("y")[0],d),r.get(e.coordDimToDataDim("z")[0],d)],grid3DIndex:l.componentIndex})),n.dataIndex=d,o=d},this),n.on("mouseout",function(c){var d=c.vertexIndex+a._startDataIndex;this.highlightOnMouseover&&(this.downplay(r,d),this._labelsBuilder.updateLabels()),o=-1,n.dataIndex=-1,s&&i.dispatchAction({type:"grid3DHideAxisPointer",grid3DIndex:l.componentIndex})},this)},updateLayout:function(e,t,i){var r=e.getData();if(this._mesh){var n=this._mesh.geometry.attributes.position.value,a=r.getLayout("points");if(this.is2D)for(var o=0;o<a.length/2;o++){var s=o*3,l=o*2;n[s]=a[l],n[s+1]=a[l+1],n[s+2]=oF}else for(var o=0;o<a.length;o++)n[o]=a[o];this._mesh.geometry.dirty(),i.getZr().refresh()}},updateView:function(e){if(this._mesh){var t=new Ye;Ye.mul(t,e.viewMatrix,this._mesh.worldTransform),Ye.mul(t,e.projectionMatrix,t),this._mesh.updateNDCPosition(t,this.is2D,this._api)}},highlight:function(e,t){if(!(t>this._endDataIndex||t<this._startDataIndex)){var i=e.getItemModel(t),r=i.getModel("emphasis.itemStyle"),n=r.get("color"),a=r.get("opacity");if(n==null){var o=Gi(e,t);n=Ss.lift(o,-.4)}a==null&&(a=Zi(e,t));var s=R.parseColor(n);s[3]*=a,this._mesh.geometry.attributes.color.set(t-this._startDataIndex,s),this._mesh.geometry.dirtyAttribute("color"),this._api.getZr().refresh()}},downplay:function(e,t){if(!(t>this._endDataIndex||t<this._startDataIndex)){var i=Gi(e,t),r=Zi(e,t),n=R.parseColor(i);n[3]*=r,this._mesh.geometry.attributes.color.set(t-this._startDataIndex,n),this._mesh.geometry.dirtyAttribute("color"),this._api.getZr().refresh()}},fadeOutAll:function(e){if(this._originalOpacity){for(var t=this._mesh.geometry,i=0;i<t.vertexCount;i++){var r=this._originalOpacity[i]*e;t.attributes.color.value[i*4+3]=r}t.dirtyAttribute("color"),this._api.getZr().refresh()}},fadeInAll:function(){this.fadeOutAll(1)},setPositionTexture:function(e){this._mesh&&this._setPositionTextureToMesh(this._mesh,e),this._positionTexture=e},removePositionTexture:function(){this._positionTexture=null,this._mesh&&this._setPositionTextureToMesh(this._mesh,null)},setSizeScale:function(e){if(e!==this._sizeScale){if(this._mesh){var t=this._mesh.material.get("u_Size");this._mesh.material.set("u_Size",t/this._sizeScale*e);var i=this._mesh.geometry.attributes;if(i.size.value)for(var r=0;r<i.size.value.length;r++)i.size.value[r]=i.size.value[r]/this._sizeScale*e}this._sizeScale=e}},_setPositionTextureToMesh:function(e,t){t&&e.material.set("positionTexture",t),e.material[t?"enableTexture":"disableTexture"]("positionTexture")},_getSymbolInfo:function(e,t,i){if(e.get("large")){var r=ht.firstNotNull(e.get("symbolSize"),1),c,a;return r instanceof Array?(c=Math.max(r[0],r[1]),a=r[0]/r[1]):(c=r,a=1),{maxSize:r,type:e.get("symbol"),aspect:a}}for(var n=e.getData(),a,o=!1,s=n.getItemVisual(0,"symbol")||"circle",l=!1,c=0,d=t;d<i;d++){var r=n.getItemVisual(d,"symbolSize"),u=n.getItemVisual(d,"symbol"),h;if(r instanceof Array)h=r[0]/r[1],c=Math.max(Math.max(r[0],r[1]),c);else{if(isNaN(r))continue;h=1,c=Math.max(r,c)}s=u,a=h}return{maxSize:c,type:s,aspect:a}}};var Ec=OC;var sF=Rr.extend({type:"scatter3D",hasSymbolVisual:!0,__ecgl__:!0,init:function(e,t){this.groupGL=new R.Node,this._pointsBuilderList=[],this._currentStep=0},render:function(e,t,i){if(this.groupGL.removeAll(),!!e.getData().count()){var r=e.coordinateSystem;if(r&&r.viewGL){r.viewGL.add(this.groupGL),this._camera=r.viewGL.camera;var n=this._pointsBuilderList[0];n||(n=this._pointsBuilderList[0]=new Ec(!1,i)),this._pointsBuilderList.length=1,this.groupGL.add(n.rootNode),n.update(e,t,i),n.updateView(r.viewGL.camera)}}},incrementalPrepareRender:function(e,t,i){var r=e.coordinateSystem;r&&r.viewGL&&(r.viewGL.add(this.groupGL),this._camera=r.viewGL.camera),this.groupGL.removeAll(),this._currentStep=0},incrementalRender:function(e,t,i,r){if(!(e.end<=e.start)){var n=this._pointsBuilderList[this._currentStep];n||(n=new Ec(!1,r),this._pointsBuilderList[this._currentStep]=n),this.groupGL.add(n.rootNode),n.update(t,i,r,e.start,e.end),n.updateView(t.coordinateSystem.viewGL.camera),this._currentStep++}},updateCamera:function(){this._pointsBuilderList.forEach(function(e){e.updateView(this._camera)},this)},highlight:function(e,t,i,r){this._toggleStatus("highlight",e,t,i,r)},downplay:function(e,t,i,r){this._toggleStatus("downplay",e,t,i,r)},_toggleStatus:function(e,t,i,r,n){var a=t.getData(),o=ht.queryDataIndex(a,n),s=e==="highlight";o!=null?Ee.each(Fo.normalizeToArray(o),function(l){for(var c=0;c<this._pointsBuilderList.length;c++){var d=this._pointsBuilderList[c];s?d.highlight(a,l):d.downplay(a,l)}},this):a.each(function(l){for(var c=0;c<this._pointsBuilderList.length;c++){var d=this._pointsBuilderList[c];s?d.highlight(a,l):d.downplay(a,l)}})},dispose:function(){this._pointsBuilderList.forEach(function(e){e.dispose()}),this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}});function lF(e){e.registerChartView(sF),e.registerSeriesModel(eF),e.registerLayout({seriesType:"scatter3D",reset:function(t){var i=t.coordinateSystem;if(i){var r=i.dimensions;if(r.length<3)return;var n=r.map(function(s){return t.coordDimToDataDim(s)[0]}),a=[],o=[];return{progress:function(s,l){for(var c=new Float32Array((s.end-s.start)*3),d=s.start;d<s.end;d++){var u=(d-s.start)*3;a[0]=l.get(n[0],d),a[1]=l.get(n[1],d),a[2]=l.get(n[2],d),i.dataToPoint(a,o),c[u]=o[0],c[u+1]=o[1],c[u+2]=o[2]}l.setLayout("points",c)}}}}})}Ci(lF);var Kr=ri.vec3,cF=ri.vec2,yl=Kr.normalize,F_=Kr.cross,dF=Kr.sub,LC=Kr.add,Tc=Kr.create,Sc=Tc(),Oo=Tc(),Ac=Tc(),Tf=Tc(),uF=[],hF=[];function Wj(e,t){cF.copy(uF,e[0]),cF.copy(hF,e[1]);var i=[],r=i[0]=Tc(),n=i[1]=Tc(),a=i[2]=Tc(),o=i[3]=Tc();t.dataToPoint(uF,r),t.dataToPoint(hF,o),yl(Sc,r),dF(Oo,o,r),yl(Oo,Oo),F_(Ac,Oo,Sc),yl(Ac,Ac),F_(Oo,Sc,Ac),LC(n,Sc,Oo),yl(n,n),yl(Sc,o),dF(Oo,r,o),yl(Oo,Oo),F_(Ac,Oo,Sc),yl(Ac,Ac),F_(Oo,Sc,Ac),LC(a,Sc,Oo),yl(a,a),LC(Tf,r,o),yl(Tf,Tf);var s=Kr.dot(r,Tf),l=Kr.dot(Tf,n),c=(Math.max(Kr.len(r),Kr.len(o))-s)/l*2;return Kr.scaleAndAdd(n,r,n,c),Kr.scaleAndAdd(a,o,a,c),i}function qj(e,t,i){var r=[],n=r[0]=Kr.create(),a=r[1]=Kr.create(),o=r[2]=Kr.create(),s=r[3]=Kr.create();t.dataToPoint(e[0],n),t.dataToPoint(e[1],s);var l=Kr.dist(n,s);return Kr.lerp(a,n,s,.3),Kr.lerp(o,n,s,.3),Kr.scaleAndAdd(a,a,i,Math.min(l*.1,10)),Kr.scaleAndAdd(o,o,i,Math.min(l*.1,10)),r}function pF(e,t){for(var i=new Float32Array(e.length*3),r=0,n=[],a=0;a<e.length;a++)t.dataToPoint(e[a],n),i[r++]=n[0],i[r++]=n[1],i[r++]=n[2];return i}function fF(e){var t=[];return e.each(function(i){var r=e.getItemModel(i),n=r.option instanceof Array?r.option:r.getShallow("coords",!0);t.push(n)}),{coordsList:t}}function $j(e,t){var i=e.getData(),r=e.get("polyline");i.setLayout("lineType",r?"polyline":"cubicBezier");var n=fF(i);i.each(function(a){var o=n.coordsList[a],s=r?pF:Wj;i.setItemLayout(a,s(o,t))})}function mF(e,t,i){var r=e.getData(),n=e.get("polyline"),a=fF(r);r.setLayout("lineType",n?"polyline":"cubicBezier"),r.each(function(o){var s=a.coordsList[o],l=n?pF(s,t):qj(s,t,i);r.setItemLayout(o,l)})}function BC(e,t){e.eachSeriesByType("lines3D",function(i){var r=i.coordinateSystem;r.type==="globe"?$j(i,r):r.type==="geo3D"?mF(i,r,[0,1,0]):(r.type==="mapbox3D"||r.type==="maptalks3D")&&mF(i,r,[0,0,1])})}var gF=Pr.extend({type:"series.lines3D",dependencies:["globe"],visualStyleAccessPath:"lineStyle",visualDrawType:"stroke",getInitialData:function(e,t){var i=new en(["value"],this);return i.hasItemOption=!1,i.initData(e.data,[],function(r,n,a,o){if(r instanceof Array)return NaN;i.hasItemOption=!0;var s=r.value;if(s!=null)return s instanceof Array?s[o]:s}),i},defaultOption:{coordinateSystem:"globe",globeIndex:0,geo3DIndex:0,zlevel:-10,polyline:!1,effect:{show:!1,period:4,trailWidth:4,trailLength:.2,spotIntensity:6},silent:!0,blendMode:"source-over",lineStyle:{width:1,opacity:.5}}});var vF=`@export ecgl.trail2.vertex
attribute vec3 position: POSITION;
attribute vec3 positionPrev;
attribute vec3 positionNext;
attribute float offset;
attribute float dist;
attribute float distAll;
attribute float start;

attribute vec4 a_Color : COLOR;

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;
uniform float near : NEAR;

uniform float speed : 0;
uniform float trailLength: 0.3;
uniform float time;
uniform float period: 1000;

uniform float spotSize: 1;

varying vec4 v_Color;
varying float v_Percent;
varying float v_SpotPercent;

@import ecgl.common.wireframe.vertexHeader

@import ecgl.lines3D.clipNear

void main()
{
 @import ecgl.lines3D.expandLine

 gl_Position = currProj;

 v_Color = a_Color;

 @import ecgl.common.wireframe.vertexMain

#ifdef CONSTANT_SPEED
 float t = mod((speed * time + start) / distAll, 1. + trailLength) - trailLength;
#else
 float t = mod((time + start) / period, 1. + trailLength) - trailLength;
#endif

 float trailLen = distAll * trailLength;

 v_Percent = (dist - t * distAll) / trailLen;

 v_SpotPercent = spotSize / distAll;

 }
@end


@export ecgl.trail2.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
uniform float spotIntensity: 5;

varying vec4 v_Color;
varying float v_Percent;
varying float v_SpotPercent;

@import ecgl.common.wireframe.fragmentHeader

@import clay.util.srgb

void main()
{
 if (v_Percent > 1.0 || v_Percent < 0.0) {
 discard;
 }

 float fade = v_Percent;

#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color * v_Color);
#else
 gl_FragColor = color * v_Color;
#endif

 @import ecgl.common.wireframe.fragmentMain

 if (v_Percent > (1.0 - v_SpotPercent)) {
 gl_FragColor.rgb *= spotIntensity;
 }

 gl_FragColor.a *= fade;
}

@end`;var _F=ri.vec3;function Xj(e){return e>0?1:-1}R.Shader.import(vF);var bF=R.Mesh.extend(function(){var e=new R.Material({shader:new R.Shader(R.Shader.source("ecgl.trail2.vertex"),R.Shader.source("ecgl.trail2.fragment")),transparent:!0,depthMask:!1}),t=new Da({dynamic:!0});return t.createAttribute("dist","float",1),t.createAttribute("distAll","float",1),t.createAttribute("start","float",1),{geometry:t,material:e,culling:!1,$ignorePicking:!0}},{updateData:function(e,t,i){var r=e.hostModel,n=this.geometry,a=r.getModel("effect"),o=a.get("trailWidth")*t.getDevicePixelRatio(),s=a.get("trailLength"),l=r.get("effect.constantSpeed"),c=r.get("effect.period")*1e3,d=l!=null;d?this.material.set("speed",l/1e3):this.material.set("period",c),this.material[d?"define":"undefine"]("vertex","CONSTANT_SPEED");var u=r.get("polyline");n.trailLength=s,this.material.set("trailLength",s),n.resetOffset(),["position","positionPrev","positionNext"].forEach(function(M){n.attributes[M].value=i.attributes[M].value});var h=["dist","distAll","start","offset","color"];h.forEach(function(M){n.attributes[M].init(n.vertexCount)}),n.indices=i.indices;var m=[],f=a.get("trailColor"),p=a.get("trailOpacity"),g=f!=null,v=p!=null;this.updateWorldTransform();var b=this.worldTransform.x.len(),_=this.worldTransform.y.len(),x=this.worldTransform.z.len(),w=0,y=0;e.each(function(M){var T=e.getItemLayout(M),C=v?p:Zi(e,M),N=Gi(e,M);C==null&&(C=1),m=R.parseColor(g?f:N,m),m[3]*=C;for(var D=u?i.getPolylineVertexCount(T):i.getCubicCurveVertexCount(T[0],T[1],T[2],T[3]),k=0,U=[],F=[],H=w;H<w+D;H++)n.attributes.position.get(H,U),U[0]*=b,U[1]*=_,U[2]*=x,H>w&&(k+=_F.dist(U,F)),n.attributes.dist.set(H,k),_F.copy(F,U);y=Math.max(y,k);for(var V=Math.random()*(d?k:c),H=w;H<w+D;H++)n.attributes.distAll.set(H,k),n.attributes.start.set(H,V),n.attributes.offset.set(H,Xj(i.attributes.offset.get(H))*o/2),n.attributes.color.set(H,m);w+=D}),this.material.set("spotSize",y*.1*s),this.material.set("spotIntensity",a.get("spotIntensity")),n.dirty()},setAnimationTime:function(e){this.material.set("time",e)}});R.Shader.import(_c);function Yj(e){return e.radius!=null?e.radius:e.size!=null?Math.max(e.size[0],e.size[1],e.size[2]):100}var xF=Rr.extend({type:"lines3D",__ecgl__:!0,init:function(e,t){this.groupGL=new R.Node,this._meshLinesMaterial=new R.Material({shader:R.createShader("ecgl.meshLines3D"),transparent:!0,depthMask:!1}),this._linesMesh=new R.Mesh({geometry:new Da,material:this._meshLinesMaterial,$ignorePicking:!0}),this._trailMesh=new bF},render:function(e,t,i){this.groupGL.add(this._linesMesh);var r=e.coordinateSystem,n=e.getData();if(r&&r.viewGL){var a=r.viewGL;a.add(this.groupGL),this._updateLines(e,t,i);var o=r.viewGL.isLinearSpace()?"define":"undefine";this._linesMesh.material[o]("fragment","SRGB_DECODE"),this._trailMesh.material[o]("fragment","SRGB_DECODE")}var s=this._trailMesh;if(s.stopAnimation(),e.get("effect.show")){this.groupGL.add(s),s.updateData(n,i,this._linesMesh.geometry),s.__time=s.__time||0;var l=3600*1e3;this._curveEffectsAnimator=s.animate("",{loop:!0}).when(l,{__time:l}).during(function(){s.setAnimationTime(s.__time)}).start()}else this.groupGL.remove(s),this._curveEffectsAnimator=null;this._linesMesh.material.blend=this._trailMesh.material.blend=e.get("blendMode")==="lighter"?R.additiveBlend:null},pauseEffect:function(){this._curveEffectsAnimator&&this._curveEffectsAnimator.pause()},resumeEffect:function(){this._curveEffectsAnimator&&this._curveEffectsAnimator.resume()},toggleEffect:function(){var e=this._curveEffectsAnimator;e&&(e.isPaused()?e.resume():e.pause())},_updateLines:function(e,t,i){var r=e.getData(),n=e.coordinateSystem,a=this._linesMesh.geometry,o=e.get("polyline");a.expandLine=!0;var s=Yj(n);a.segmentScale=s/20;var l="lineStyle.width".split("."),c=i.getDevicePixelRatio(),d=0;r.each(function(f){var p=r.getItemModel(f),g=p.get(l);g==null&&(g=1),r.setItemVisual(f,"lineWidth",g),d=Math.max(g,d)}),a.useNativeLine=!1;var u=0,h=0;r.each(function(f){var p=r.getItemLayout(f);o?(u+=a.getPolylineVertexCount(p),h+=a.getPolylineTriangleCount(p)):(u+=a.getCubicCurveVertexCount(p[0],p[1],p[2],p[3]),h+=a.getCubicCurveTriangleCount(p[0],p[1],p[2],p[3]))}),a.setVertexCount(u),a.setTriangleCount(h),a.resetOffset();var m=[];r.each(function(f){var p=r.getItemLayout(f),g=Gi(r,f),v=Zi(r,f),b=r.getItemVisual(f,"lineWidth")*c;v==null&&(v=1),m=R.parseColor(g,m),m[3]*=v,o?a.addPolyline(p,m,b):a.addCubicCurve(p[0],p[1],p[2],p[3],m,b)}),a.dirty()},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}});function yF(e){e.registerChartView(xF),e.registerSeriesModel(gF),e.registerLayout(BC),e.registerAction({type:"lines3DPauseEffect",event:"lines3deffectpaused",update:"series.lines3D:pauseEffect"},function(){}),e.registerAction({type:"lines3DResumeEffect",event:"lines3deffectresumed",update:"series.lines3D:resumeEffect"},function(){}),e.registerAction({type:"lines3DToggleEffect",event:"lines3deffectchanged",update:"series.lines3D:toggleEffect"},function(){})}Ci(yF);function wF(e,t){for(var i=[],r=0;r<t.length;r++)i.push(e.dataToPoint(t[r]));return i}var CF=Pr.extend({type:"series.polygons3D",getRegionModel:function(e){return this.getData().getItemModel(e)},getRegionPolygonCoords:function(e){var t=this.coordinateSystem,i=this.getData().getItemModel(e),r=i.option instanceof Array?i.option:i.getShallow("coords");i.get("multiPolygon")||(r=[r]);for(var n=[],a=0;a<r.length;a++){for(var o=[],s=1;s<r[a].length;s++)o.push(wF(t,r[a][s]));n.push({exterior:wF(t,r[a][0]),interiors:o})}return n},getInitialData:function(e){var t=new en(["value"],this);return t.hasItemOption=!1,t.initData(e.data,[],function(i,r,n,a){if(i instanceof Array)return NaN;t.hasItemOption=!0;var o=i.value;if(o!=null)return o instanceof Array?o[a]:o}),t},defaultOption:{show:!0,data:null,multiPolygon:!1,progressiveThreshold:1e3,progressive:1e3,zlevel:-10,label:{show:!1,distance:2,textStyle:{fontSize:20,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:4}},itemStyle:{color:"#fff",borderWidth:0,borderColor:"#333"},emphasis:{itemStyle:{color:"#639fc0"},label:{show:!0}}}});Ee.merge(CF.prototype,Po);var EF=CF;var SF=Rr.extend({type:"polygons3D",__ecgl__:!0,init:function(e,t){this.groupGL=new R.Node,this._geo3DBuilderList=[],this._currentStep=0},render:function(e,t,i){this.groupGL.removeAll();var r=e.coordinateSystem;r&&r.viewGL&&r.viewGL.add(this.groupGL);var n=this._geo3DBuilderList[0];n||(n=new qd(i),n.extrudeY=r.type!=="mapbox3D"&&r.type!=="maptalks3D",this._geo3DBuilderList[0]=n),this._updateShaderDefines(r,n),n.update(e,t,i),this._geo3DBuilderList.length=1,this.groupGL.add(n.rootNode)},incrementalPrepareRender:function(e,t,i){this.groupGL.removeAll();var r=e.coordinateSystem;r&&r.viewGL&&r.viewGL.add(this.groupGL),this._currentStep=0},incrementalRender:function(e,t,i,r){var n=this._geo3DBuilderList[this._currentStep],a=t.coordinateSystem;n||(n=new qd(r),n.extrudeY=a.type!=="mapbox3D"&&a.type!=="maptalks3D",this._geo3DBuilderList[this._currentStep]=n),n.update(t,i,r,e.start,e.end),this.groupGL.add(n.rootNode),this._updateShaderDefines(a,n),this._currentStep++},_updateShaderDefines:function(e,t){var i=e.viewGL.isLinearSpace()?"define":"undefine";t.rootNode.traverse(function(r){r.material&&(r.material[i]("fragment","SRGB_DECODE"),(e.type==="mapbox3D"||e.type==="maptalks3D")&&(r.material.define("fragment","NORMAL_UP_AXIS",2),r.material.define("fragment","NORMAL_FRONT_AXIS",1)))})},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll(),this._geo3DBuilderList.forEach(function(e){e.dispose()})}});function AF(e){e.registerChartView(SF),e.registerSeriesModel(EF)}Ci(AF);var TF=Pr.extend({type:"series.surface",dependencies:["globe","grid3D","geo3D"],visualStyleAccessPath:"itemStyle",formatTooltip:function(e){return Ns(this,e)},getInitialData:function(e,t){var i=e.data;function r(Q){return!(isNaN(Q.min)||isNaN(Q.max)||isNaN(Q.step))}function n(Q){var $=Qa.getPrecisionSafe;return Math.max($(Q.min),$(Q.max),$(Q.step))+1}if(!i)if(e.parametric){var x=e.parametricEquation||{},w=x.u||{},y=x.v||{};["u","v"].forEach(function($){r(x[$])}),["x","y","z"].forEach(function($){x[$]});var M=Math.floor((w.max+w.step-w.min)/w.step),T=Math.floor((y.max+y.step-y.min)/y.step);i=new Float32Array(M*T*5);for(var C=n(w),N=n(y),h=0,m=0;m<T;m++)for(var f=0;f<M;f++){var D=f*w.step+w.min,k=m*y.step+y.min,U=Qa.round(Math.min(D,w.max),C),F=Qa.round(Math.min(k,y.max),N),p=x.x(U,F),g=x.y(U,F),_=x.z(U,F);i[h++]=p,i[h++]=g,i[h++]=_,i[h++]=U,i[h++]=F}}else{var a=e.equation||{},o=a.x||{},s=a.y||{};if(["x","y"].forEach(function(Q){r(a[Q])}),typeof a.z!="function")return;var l=Math.floor((o.max+o.step-o.min)/o.step),c=Math.floor((s.max+s.step-s.min)/s.step);i=new Float32Array(l*c*3);for(var d=n(o),u=n(s),h=0,m=0;m<c;m++)for(var f=0;f<l;f++){var p=f*o.step+o.min,g=m*s.step+s.min,v=Qa.round(Math.min(p,o.max),d),b=Qa.round(Math.min(g,s.max),u),_=a.z(v,b);i[h++]=v,i[h++]=b,i[h++]=_}}var H=["x","y","z"];e.parametric&&H.push("u","v");var V=Cc(this,H,i);return V},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,grid3DIndex:0,shading:"lambert",parametric:!1,wireframe:{show:!0,lineStyle:{color:"rgba(0,0,0,0.5)",width:1}},equation:{x:{min:-1,max:1,step:.1},y:{min:-1,max:1,step:.1},z:null},parametricEquation:{u:{min:-1,max:1,step:.1},v:{min:-1,max:1,step:.1},x:null,y:null,z:null},dataShape:null,itemStyle:{},animationDurationUpdate:500}});Ee.merge(TF.prototype,Po);var DF=TF;var Yd=ri.vec3;function Zj(e){return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])}var MF=Rr.extend({type:"surface",__ecgl__:!0,init:function(e,t){this.groupGL=new R.Node},render:function(e,t,i){var r=this._prevSurfaceMesh;this._prevSurfaceMesh=this._surfaceMesh,this._surfaceMesh=r,this._surfaceMesh||(this._surfaceMesh=this._createSurfaceMesh()),this.groupGL.remove(this._prevSurfaceMesh),this.groupGL.add(this._surfaceMesh);var n=e.coordinateSystem,a=e.get("shading"),o=e.getData(),s="ecgl."+a;if((!this._surfaceMesh.material||this._surfaceMesh.material.shader.name!==s)&&(this._surfaceMesh.material=R.createMaterial(s,["VERTEX_COLOR","DOUBLE_SIDED"])),R.setMaterialFromModel(a,this._surfaceMesh.material,e,i),n&&n.viewGL){n.viewGL.add(this.groupGL);var l=n.viewGL.isLinearSpace()?"define":"undefine";this._surfaceMesh.material[l]("fragment","SRGB_DECODE")}var c=e.get("parametric"),d=e.get("dataShape");d||(d=this._getDataShape(o,c));var u=e.getModel("wireframe"),h=u.get("lineStyle.width"),m=u.get("show")&&h>0;this._updateSurfaceMesh(this._surfaceMesh,e,d,m);var f=this._surfaceMesh.material;m?(f.define("WIREFRAME_QUAD"),f.set("wireframeLineWidth",h),f.set("wireframeLineColor",R.parseColor(u.get("lineStyle.color")))):f.undefine("WIREFRAME_QUAD"),this._initHandler(e,i),this._updateAnimation(e)},_updateAnimation:function(e){R.updateVertexAnimation([["prevPosition","position"],["prevNormal","normal"]],this._prevSurfaceMesh,this._surfaceMesh,e)},_createSurfaceMesh:function(){var e=new R.Mesh({geometry:new R.Geometry({dynamic:!0,sortTriangles:!0}),shadowDepthMaterial:new R.Material({shader:new R.Shader(R.Shader.source("ecgl.sm.depth.vertex"),R.Shader.source("ecgl.sm.depth.fragment"))}),culling:!1,renderOrder:10,renderNormal:!0});return e.geometry.createAttribute("barycentric","float",4),e.geometry.createAttribute("prevPosition","float",3),e.geometry.createAttribute("prevNormal","float",3),Object.assign(e.geometry,Lh),e},_initHandler:function(e,t){var i=e.getData(),r=this._surfaceMesh,n=e.coordinateSystem;function a(s,l){for(var c=1/0,d=-1,u=[],h=0;h<s.length;h++){r.geometry.attributes.position.get(s[h],u);var m=Yd.dist(l.array,u);m<c&&(c=m,d=s[h])}return d}r.seriesIndex=e.seriesIndex;var o=-1;r.off("mousemove"),r.off("mouseout"),r.on("mousemove",function(s){var l=a(s.triangle,s.point);if(l>=0){var c=[];r.geometry.attributes.position.get(l,c);for(var d=n.pointToData(c),u=1/0,h=-1,m=[],f=0;f<i.count();f++){m[0]=i.get("x",f),m[1]=i.get("y",f),m[2]=i.get("z",f);var p=Yd.squaredDistance(m,d);p<u&&(h=f,u=p)}h!==o&&t.dispatchAction({type:"grid3DShowAxisPointer",value:d}),o=h,r.dataIndex=h}else r.dataIndex=-1},this),r.on("mouseout",function(s){o=-1,r.dataIndex=-1,t.dispatchAction({type:"grid3DHideAxisPointer"})},this)},_updateSurfaceMesh:function(e,t,i,r){var n=e.geometry,a=t.getData(),o=a.getLayout("points"),s=0;a.each(function($e){a.hasValue($e)||s++});var l=s||r,c=n.attributes.position,d=n.attributes.normal,u=n.attributes.texcoord0,h=n.attributes.barycentric,m=n.attributes.color,f=i[0],p=i[1],g=t.get("shading"),v=g!=="color";if(l){var b=(f-1)*(p-1)*4;c.init(b),r&&h.init(b)}else c.value=new Float32Array(o);m.init(n.vertexCount),u.init(n.vertexCount);var _=[0,3,1,1,3,2],x=[[1,1,0,0],[0,1,0,1],[1,0,0,1],[1,0,1,0]],w=n.indices=new(n.vertexCount>65535?Uint32Array:Uint16Array)((f-1)*(p-1)*6),y=function($e,_t,st){st[1]=$e*p+_t,st[0]=$e*p+_t+1,st[3]=($e+1)*p+_t+1,st[2]=($e+1)*p+_t},M=!1;if(l){var T=[],C=[],N=0;v?d.init(n.vertexCount):d.value=null;for(var D=[[],[],[]],k=[],U=[],F=Yd.create(),H=function($e,_t,st){var jt=_t*3;return st[0]=$e[jt],st[1]=$e[jt+1],st[2]=$e[jt+2],st},V=new Float32Array(o.length),Q=new Float32Array(o.length/3*4),$=0;$<a.count();$++)if(a.hasValue($)){var ge=R.parseColor(Gi(a,$)),ee=Zi(a,$);ee!=null&&(ge[3]*=ee),ge[3]<.99&&(M=!0);for(var re=0;re<4;re++)Q[$*4+re]=ge[re]}for(var we=[1e7,1e7,1e7],$=0;$<f-1;$++)for(var te=0;te<p-1;te++){var oe=$*(p-1)+te,pe=oe*4;y($,te,T);for(var ue=!1,re=0;re<4;re++)H(o,T[re],C),Zj(C)&&(ue=!0);for(var re=0;re<4;re++)ue?c.set(pe+re,we):(H(o,T[re],C),c.set(pe+re,C)),r&&h.set(pe+re,x[re]);for(var re=0;re<6;re++)w[N++]=_[re]+pe;if(v&&!ue)for(var re=0;re<2;re++){for(var _e=re*3,ce=0;ce<3;ce++){var fe=T[_[_e]+ce];H(o,fe,D[ce])}Yd.sub(k,D[0],D[1]),Yd.sub(U,D[1],D[2]),Yd.cross(F,k,U);for(var ce=0;ce<3;ce++){var be=T[_[_e]+ce]*3;V[be]=V[be]+F[0],V[be+1]=V[be+1]+F[1],V[be+2]=V[be+2]+F[2]}}}if(v)for(var $=0;$<V.length/3;$++)H(V,$,F),Yd.normalize(F,F),V[$*3]=F[0],V[$*3+1]=F[1],V[$*3+2]=F[2];for(var ge=[],Oe=[],$=0;$<f-1;$++)for(var te=0;te<p-1;te++){var oe=$*(p-1)+te,pe=oe*4;y($,te,T);for(var re=0;re<4;re++){for(var ce=0;ce<4;ce++)ge[ce]=Q[T[re]*4+ce];m.set(pe+re,ge),v&&(H(V,T[re],F),d.set(pe+re,F));var fe=T[re];Oe[0]=fe%p/(p-1),Oe[1]=Math.floor(fe/p)/(f-1),u.set(pe+re,Oe)}oe++}}else{for(var Oe=[],$=0;$<a.count();$++){Oe[0]=$%p/(p-1),Oe[1]=Math.floor($/p)/(f-1);var ge=R.parseColor(Gi(a,$)),ee=Zi(a,$);ee!=null&&(ge[3]*=ee),ge[3]<.99&&(M=!0),m.set($,ge),u.set($,Oe)}for(var T=[],De=0,$=0;$<f-1;$++)for(var te=0;te<p-1;te++){y($,te,T);for(var re=0;re<6;re++)w[De++]=T[_[re]]}v?n.generateVertexNormals():d.value=null}e.material.get("normalMap")&&n.generateTangents(),n.updateBoundingBox(),n.dirty(),e.material.transparent=M,e.material.depthMask=!M},_getDataShape:function(e,t){for(var i=-1/0,r=0,n=0,a=0,o=!1,s=t?"u":"x",l=e.count(),c=0;c<l;c++){var d=e.get(s,c);d<i&&(a=n,n=0,r++),i=d,n++}if((!r||n===1)&&(o=!0),!o)return[r+1,n];for(var u=Math.floor(Math.sqrt(l));u>0;){if(Math.floor(l/u)===l/u)return[u,l/u];u--}return u=Math.floor(Math.sqrt(l)),[u,u]},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}});function IF(e){e.registerChartView(MF),e.registerSeriesModel(DF),e.registerLayout(function(t,i){t.eachSeriesByType("surface",function(r){var n=r.coordinateSystem;!n||n.type;var a=r.getData(),o=new Float32Array(3*a.count()),s=[NaN,NaN,NaN];if(n&&n.type==="cartesian3D"){var l=n.dimensions,c=l.map(function(d){return r.coordDimToDataDim(d)[0]});a.each(c,function(d,u,h,m){var f;a.hasValue(m)?f=n.dataToPoint([d,u,h]):f=s,o[m*3]=f[0],o[m*3+1]=f[1],o[m*3+2]=f[2]})}a.setLayout("points",o)})})}Ci(IF);function kF(e,t){for(var i=[],r=0;r<t.length;r++)i.push(e.dataToPoint(t[r]));return i}var Hh=Pr.extend({type:"series.map3D",layoutMode:"box",coordinateSystem:null,visualStyleAccessPath:"itemStyle",optionUpdated:function(e){e=e||{};var t=this.get("coordinateSystem");if(!(t==null||t==="geo3D")){if(0)var i,r;this.get("groundPlane.show")&&(this.option.groundPlane.show=!1),this._geo=null}},getInitialData:function(e){e.data=this.getFilledRegions(e.data,e.map);var t=$i.createDimensions(e.data,{coordDimensions:["value"]}),i=new en(t,this);i.initData(e.data);var r={};return i.each(function(n){var a=i.getName(n),o=i.getItemModel(n);r[a]=o}),this._regionModelMap=r,i},formatTooltip:function(e){return Ns(this,e)},getRegionModel:function(e){var t=this.getData().getName(e);return this._regionModelMap[t]||new ac(null,this)},getRegionPolygonCoords:function(e){var t=this.coordinateSystem,i=this.getData().getName(e);if(t.transform){var r=t.getRegion(i);return r?r.geometries:[]}else{this._geo||(this._geo=M_.createGeo3D(this));for(var r=this._geo.getRegion(i),n=[],a=0;a<r.geometries.length;a++){var o=r.geometries[a],s=[],l=kF(t,o.exterior);if(s&&s.length)for(var c=0;c<o.interiors.length;c++)s.push(kF(t,s[c]));n.push({interiors:s,exterior:l})}return n}},getFormattedLabel:function(e,t){var i=Fo.getFormattedLabel(this,e,t);return i==null&&(i=this.getData().getName(e)),i},defaultOption:{coordinateSystem:"geo3D",data:null}});Ee.merge(Hh.prototype,A_);Ee.merge(Hh.prototype,gc);Ee.merge(Hh.prototype,Io);Ee.merge(Hh.prototype,ko);Ee.merge(Hh.prototype,Po);var NF=Hh;var PF=Rr.extend({type:"map3D",__ecgl__:!0,init:function(e,t){this._geo3DBuilder=new qd(t),this.groupGL=new R.Node},render:function(e,t,i){var r=e.coordinateSystem;if(!(!r||!r.viewGL)){this.groupGL.add(this._geo3DBuilder.rootNode),r.viewGL.add(this.groupGL);var n;if(r.type==="geo3D"){n=r,this._sceneHelper||(this._sceneHelper=new No,this._sceneHelper.initLight(this.groupGL)),this._sceneHelper.setScene(r.viewGL.scene),this._sceneHelper.updateLight(e),r.viewGL.setPostEffect(e.getModel("postEffect"),i),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling"));var a=this._control;a||(a=this._control=new vc({zr:i.getZr()}),this._control.init());var o=e.getModel("viewControl");a.setViewGL(r.viewGL),a.setFromViewControlModel(o,0),a.off("update"),a.on("update",function(){i.dispatchAction({type:"map3DChangeCamera",alpha:a.getAlpha(),beta:a.getBeta(),distance:a.getDistance(),from:this.uid,map3DId:e.id})}),this._geo3DBuilder.extrudeY=!0}else this._control&&(this._control.dispose(),this._control=null),this._sceneHelper&&(this._sceneHelper.dispose(),this._sceneHelper=null),n=e.getData().getLayout("geo3D"),this._geo3DBuilder.extrudeY=!1;this._geo3DBuilder.update(e,t,i,0,e.getData().count());var s=r.viewGL.isLinearSpace()?"define":"undefine";this._geo3DBuilder.rootNode.traverse(function(l){l.material&&l.material[s]("fragment","SRGB_DECODE")})}},afterRender:function(e,t,i,r){var n=r.renderer,a=e.coordinateSystem;a&&a.type==="geo3D"&&(this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i))},dispose:function(){this.groupGL.removeAll(),this._control.dispose(),this._geo3DBuilder.dispose()}});function RF(e){I_(e),e.registerChartView(PF),e.registerSeriesModel(NF),e.registerAction({type:"map3DChangeCamera",event:"map3dcamerachanged",update:"series:updateCamera"},function(t,i){i.eachComponent({mainType:"series",subType:"map3D",query:t},function(r){r.setView(t)})})}Ci(RF);var FF=Pr.extend({type:"series.scatterGL",dependencies:["grid","polar","geo","singleAxis"],visualStyleAccessPath:"itemStyle",hasSymbolVisual:!0,getInitialData:function(){return $i.createList(this)},defaultOption:{coordinateSystem:"cartesian2d",zlevel:10,progressive:1e5,progressiveThreshold:1e5,large:!1,symbol:"circle",symbolSize:10,zoomScale:0,blendMode:"source-over",itemStyle:{opacity:.8},postEffect:{enable:!1,colorCorrection:{exposure:0,brightness:0,contrast:1,saturation:1,enable:!0}}}});function OF(){return[1,0,0,1,0,0]}function LF(e,t){var i=t[0],r=t[2],n=t[4],a=t[1],o=t[3],s=t[5],l=i*o-a*r;return l?(l=1/l,e[0]=o*l,e[1]=-a*l,e[2]=-r*l,e[3]=i*l,e[4]=(r*s-o*n)*l,e[5]=(a*n-i*s)*l,e):null}function Dc(e){this.viewGL=e}Dc.prototype.reset=function(e,t){this._updateCamera(t.getWidth(),t.getHeight(),t.getDevicePixelRatio()),this._viewTransform=OF(),this.updateTransform(e,t)};Dc.prototype.updateTransform=function(e,t){var i=e.coordinateSystem;i.getRoamTransform&&(LF(this._viewTransform,i.getRoamTransform()),this._setCameraTransform(this._viewTransform),t.getZr().refresh())};Dc.prototype.dataToPoint=function(e,t,i){i=e.dataToPoint(t,null,i);var r=this._viewTransform;r&&z1(i,i,r)};Dc.prototype.removeTransformInPoint=function(e){return this._viewTransform&&z1(e,e,this._viewTransform),e};Dc.prototype.getZoom=function(){if(this._viewTransform){var e=this._viewTransform;return 1/Math.max(Math.sqrt(e[0]*e[0]+e[1]*e[1]),Math.sqrt(e[2]*e[2]+e[3]*e[3]))}return 1};Dc.prototype._setCameraTransform=function(e){var t=this.viewGL.camera;t.position.set(e[4],e[5],0),t.scale.set(Math.sqrt(e[0]*e[0]+e[1]*e[1]),Math.sqrt(e[2]*e[2]+e[3]*e[3]),1)};Dc.prototype._updateCamera=function(e,t,i){this.viewGL.setViewport(0,0,e,t,i);var r=this.viewGL.camera;r.left=r.top=0,r.bottom=t,r.right=e,r.near=0,r.far=100};var O_=Dc;var BF=Rr.extend({type:"scatterGL",__ecgl__:!0,init:function(e,t){this.groupGL=new R.Node,this.viewGL=new Bn("orthographic"),this.viewGL.add(this.groupGL),this._pointsBuilderList=[],this._currentStep=0,this._sizeScale=1,this._glViewHelper=new O_(this.viewGL)},render:function(e,t,i){if(this.groupGL.removeAll(),this._glViewHelper.reset(e,i),!!e.getData().count()){var r=this._pointsBuilderList[0];r||(r=this._pointsBuilderList[0]=new Ec(!0,i)),this._pointsBuilderList.length=1,this.groupGL.add(r.rootNode),this._removeTransformInPoints(e.getData().getLayout("points")),r.update(e,t,i),this.viewGL.setPostEffect(e.getModel("postEffect"),i)}},incrementalPrepareRender:function(e,t,i){this.groupGL.removeAll(),this._glViewHelper.reset(e,i),this._currentStep=0,this.viewGL.setPostEffect(e.getModel("postEffect"),i)},incrementalRender:function(e,t,i,r){if(!(e.end<=e.start)){var n=this._pointsBuilderList[this._currentStep];n||(n=new Ec(!0,r),this._pointsBuilderList[this._currentStep]=n),this.groupGL.add(n.rootNode),this._removeTransformInPoints(t.getData().getLayout("points")),n.setSizeScale(this._sizeScale),n.update(t,i,r,e.start,e.end),r.getZr().refresh(),this._currentStep++}},updateTransform:function(e,t,i){if(e.coordinateSystem.getRoamTransform){this._glViewHelper.updateTransform(e,i);var r=this._glViewHelper.getZoom(),n=Math.max((e.get("zoomScale")||0)*(r-1)+1,0);this._sizeScale=n,this._pointsBuilderList.forEach(function(a){a.setSizeScale(n)})}},_removeTransformInPoints:function(e){if(e)for(var t=[],i=0;i<e.length;i+=2)t[0]=e[i],t[1]=e[i+1],this._glViewHelper.removeTransformInPoint(t),e[i]=t[0],e[i+1]=t[1]},dispose:function(){this.groupGL.removeAll(),this._pointsBuilderList.forEach(function(e){e.dispose()})},remove:function(){this.groupGL.removeAll()}});function VF(e){e.registerChartView(BF),e.registerSeriesModel(FF),e.registerLayout({seriesType:"scatterGL",reset:function(t){var i=t.coordinateSystem,r=t.getData(),n;if(i){var a=i.dimensions.map(function(s){return r.mapDimension(s)}).slice(0,2),o=[];a.length===1?n=function(s){for(var l=new Float32Array((s.end-s.start)*2),c=s.start;c<s.end;c++){var d=(c-s.start)*2,u=r.get(a[0],c),h=i.dataToPoint(u);l[d]=h[0],l[d+1]=h[1]}r.setLayout("points",l)}:a.length===2&&(n=function(s){for(var l=new Float32Array((s.end-s.start)*2),c=s.start;c<s.end;c++){var d=(c-s.start)*2,u=r.get(a[0],c),h=r.get(a[1],c);o[0]=u,o[1]=h,o=i.dataToPoint(o),l[d]=o[0],l[d+1]=o[1]}r.setLayout("points",l)})}return{progress:n}}})}Ci(VF);var zF=yI;function UF(e,t,i,r,n){for(var a=new xI(r),o=0;o<e.length;o++)a.addNode(ht.firstNotNull(e[o].id,e[o].name,o),o);for(var s=[],l=[],c=0,o=0;o<t.length;o++){var d=t[o],u=d.source,h=d.target;a.addEdge(u,h,c)&&(l.push(d),s.push(ht.firstNotNull(d.id,u+" > "+h)),c++)}var m,f=$i.createDimensions(e,{coordDimensions:["value"]});m=new en(f,i),m.initData(e);var p=new en(["value"],i);return p.initData(l,s),n&&n(m,p),zF({mainData:m,struct:a,structAttr:"graph",datas:{node:m,edge:p},datasAttr:{node:"data",edge:"edgeData"}}),a.update(),a}var Df=Pr.extend({type:"series.graphGL",visualStyleAccessPath:"itemStyle",hasSymbolVisual:!0,init:function(e){Df.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._categoriesData},this._updateCategoriesData()},mergeOption:function(e){Df.superApply(this,"mergeOption",arguments),this._updateCategoriesData()},getFormattedLabel:function(e,t,i,r){var n=Fo.getFormattedLabel(this,e,t,i,r);if(n==null){var a=this.getData(),o=a.dimensions[a.dimensions.length-1];n=a.get(o,e)}return n},getInitialData:function(e,t){var i=e.edges||e.links||[],r=e.data||e.nodes||[],n=this;if(r&&i)return UF(r,i,this,!0,a).data;function a(o,s){o.wrapMethod("getItemModel",function(u){let h=n._categoriesModels,m=u.getShallow("category"),f=h[m];return f&&(f.parentModel=u.parentModel,u.parentModel=f),u});let l=t.getModel([]).getModel;function c(u,h){let m=l.call(this,u,h);return m.resolveParentPath=d,m}s.wrapMethod("getItemModel",function(u){return u.resolveParentPath=d,u.getModel=c,u});function d(u){if(u&&(u[0]==="label"||u[1]==="label")){let h=u.slice();return u[0]==="label"?h[0]="edgeLabel":u[1]==="label"&&(h[1]="edgeLabel"),h}return u}}},getGraph:function(){return this.getData().graph},getEdgeData:function(){return this.getGraph().edgeData},getCategoriesData:function(){return this._categoriesData},formatTooltip:function(e,t,i){if(i==="edge"){var r=this.getData(),n=this.getDataParams(e,i),a=r.graph.getEdgeByIndex(e),o=r.getName(a.node1.dataIndex),s=r.getName(a.node2.dataIndex),l=[];return o!=null&&l.push(o),s!=null&&l.push(s),l=Sa.encodeHTML(l.join(" > ")),n.value&&(l+=" : "+Sa.encodeHTML(n.value)),l}else return Df.superApply(this,"formatTooltip",arguments)},_updateCategoriesData:function(){var e=(this.option.categories||[]).map(function(i){return i.value!=null?i:Object.assign({value:0},i)}),t=new en(["value"],this);t.initData(e),this._categoriesData=t,this._categoriesModels=t.mapArray(function(i){return t.getItemModel(i,!0)})},setView:function(e){e.zoom!=null&&(this.option.zoom=e.zoom),e.offset!=null&&(this.option.offset=e.offset)},setNodePosition:function(e){for(var t=0;t<e.length/2;t++){var i=e[t*2],r=e[t*2+1],n=this.getData().getRawDataItem(t);n.x=i,n.y=r}},isAnimationEnabled:function(){return Df.superCall(this,"isAnimationEnabled")&&!(this.get("layout")==="force"&&this.get("force.layoutAnimation"))},defaultOption:{zlevel:10,z:2,legendHoverLink:!0,layout:"forceAtlas2",forceAtlas2:{initLayout:null,GPU:!0,steps:1,maxSteps:1e3,repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,edgeWeightInfluence:1,edgeWeight:[1,4],nodeWeight:[1,4],preventOverlap:!1,gravityCenter:null},focusNodeAdjacency:!0,focusNodeAdjacencyOn:"mouseover",left:"center",top:"center",symbol:"circle",symbolSize:5,roam:!1,center:null,zoom:1,label:{show:!1,formatter:"{b}",position:"right",distance:5,textStyle:{fontSize:14}},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{label:{show:!0}},animation:!1}}),HF=Df;var Qr=ri.vec2,GF=[[0,0],[1,1]],jF=Lt.extend(function(){return{segmentScale:4,dynamic:!0,useNativeLine:!0,attributes:{position:new Lt.Attribute("position","float",2,"POSITION"),normal:new Lt.Attribute("normal","float",2),offset:new Lt.Attribute("offset","float",1),color:new Lt.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0,this._itemVertexOffsets=[]},setVertexCount:function(e){var t=this.attributes;this.vertexCount!==e&&(t.position.init(e),t.color.init(e),this.useNativeLine||(t.offset.init(e),t.normal.init(e)),e>65535?this.indices instanceof Uint16Array&&(this.indices=new Uint32Array(this.indices)):this.indices instanceof Uint32Array&&(this.indices=new Uint16Array(this.indices)))},setTriangleCount:function(e){this.triangleCount!==e&&(e===0?this.indices=null:this.indices=this.vertexCount>65535?new Uint32Array(e*3):new Uint16Array(e*3))},_getCubicCurveApproxStep:function(e,t,i,r){var n=Qr.dist(e,t)+Qr.dist(i,t)+Qr.dist(r,i),a=1/(n+1)*this.segmentScale;return a},getCubicCurveVertexCount:function(e,t,i,r){var n=this._getCubicCurveApproxStep(e,t,i,r),a=Math.ceil(1/n);return this.useNativeLine?a*2:a*2+2},getCubicCurveTriangleCount:function(e,t,i,r){var n=this._getCubicCurveApproxStep(e,t,i,r),a=Math.ceil(1/n);return this.useNativeLine?0:a*2},getLineVertexCount:function(){return this.getPolylineVertexCount(GF)},getLineTriangleCount:function(){return this.getPolylineTriangleCount(GF)},getPolylineVertexCount:function(e){var t;if(typeof e=="number")t=e;else{var i=typeof e[0]!="number";t=i?e.length:e.length/2}return this.useNativeLine?(t-1)*2:(t-1)*2+2},getPolylineTriangleCount:function(e){var t;if(typeof e=="number")t=e;else{var i=typeof e[0]!="number";t=i?e.length:e.length/2}return this.useNativeLine?0:(t-1)*2},addCubicCurve:function(e,t,i,r,n,a){a==null&&(a=1);for(var o=e[0],s=e[1],l=t[0],c=t[1],d=i[0],u=i[1],h=r[0],m=r[1],f=this._getCubicCurveApproxStep(e,t,i,r),p=f*f,g=p*f,v=3*f,b=3*p,_=6*p,x=6*g,w=o-l*2+d,y=s-c*2+u,M=(l-d)*3-o+h,T=(c-u)*3-s+m,C=o,N=s,D=(l-o)*v+w*b+M*g,k=(c-s)*v+y*b+T*g,U=w*_+M*x,F=y*_+T*x,H=M*x,V=T*x,Q=0,$=0,ee=Math.ceil(1/f),re=new Float32Array((ee+1)*3),re=[],we=0,$=0;$<ee+1;$++)re[we++]=C,re[we++]=N,C+=D,N+=k,D+=U,k+=F,U+=H,F+=V,Q+=f,Q>1&&(C=D>0?Math.min(C,h):Math.max(C,h),N=k>0?Math.min(N,m):Math.max(N,m));this.addPolyline(re,n,a)},addLine:function(e,t,i,r){this.addPolyline([e,t],i,r)},addPolyline:function(){var e=Qr.create(),t=Qr.create(),i=Qr.create(),r=Qr.create(),n=[],a=[],o=[];return function(s,l,c,d,u){if(s.length){var h=typeof s[0]!="number";if(u==null&&(u=h?s.length:s.length/2),!(u<2)){d==null&&(d=0),c==null&&(c=1),this._itemVertexOffsets.push(this._vertexOffset);for(var m=h?typeof l[0]!="number":l.length/4===u,f=this.attributes.position,p=this.attributes.color,g=this.attributes.offset,v=this.attributes.normal,b=this.indices,_=this._vertexOffset,x,w=0;w<u;w++){if(h)n=s[w+d],m?x=l[w+d]:x=l;else{var y=w*2+d;if(n=n||[],n[0]=s[y],n[1]=s[y+1],m){var M=w*4+d;x=x||[],x[0]=l[M],x[1]=l[M+1],x[2]=l[M+2],x[3]=l[M+3]}else x=l}if(this.useNativeLine)w>1&&(f.copy(_,_-1),p.copy(_,_-1),_++);else{var T;if(w<u-1){if(h)Qr.copy(a,s[w+1]);else{var y=(w+1)*2+d;a=a||[],a[0]=s[y],a[1]=s[y+1]}if(w>0){Qr.sub(e,n,o),Qr.sub(t,a,n),Qr.normalize(e,e),Qr.normalize(t,t),Qr.add(r,e,t),Qr.normalize(r,r);var C=c/2*Math.min(1/Qr.dot(e,r),2);i[0]=-r[1],i[1]=r[0],T=C}else Qr.sub(e,a,n),Qr.normalize(e,e),i[0]=-e[1],i[1]=e[0],T=c/2}else Qr.sub(e,n,o),Qr.normalize(e,e),i[0]=-e[1],i[1]=e[0],T=c/2;v.set(_,i),v.set(_+1,i),g.set(_,T),g.set(_+1,-T),Qr.copy(o,n),f.set(_,n),f.set(_+1,n),p.set(_,x),p.set(_+1,x),_+=2}if(this.useNativeLine)p.set(_,x),f.set(_,n),_++;else if(w>0){var N=this._faceOffset*3,b=this.indices;b[N]=_-4,b[N+1]=_-3,b[N+2]=_-2,b[N+3]=_-3,b[N+4]=_-1,b[N+5]=_-2,this._faceOffset+=2}}this._vertexOffset=_}}}}(),setItemColor:function(e,t){for(var i=this._itemVertexOffsets[e],r=e<this._itemVertexOffsets.length-1?this._itemVertexOffsets[e+1]:this._vertexOffset,n=i;n<r;n++)this.attributes.color.set(n,t);this.dirty("color")}});Ee.defaults(jF.prototype,Is);var L_=jF;var WF=`@export ecgl.forceAtlas2.updateNodeRepulsion

#define NODE_COUNT 0

uniform sampler2D positionTex;

uniform vec2 textureSize;
uniform float gravity;
uniform float scaling;
uniform vec2 gravityCenter;

uniform bool strongGravityMode;
uniform bool preventOverlap;

varying vec2 v_Texcoord;

void main() {

 vec4 n0 = texture2D(positionTex, v_Texcoord);

 vec2 force = vec2(0.0);
 for (int i = 0; i < NODE_COUNT; i++) {
 vec2 uv = vec2(
 mod(float(i), textureSize.x) / (textureSize.x - 1.0),
 floor(float(i) / textureSize.x) / (textureSize.y - 1.0)
 );
 vec4 n1 = texture2D(positionTex, uv);

 vec2 dir = n0.xy - n1.xy;
 float d2 = dot(dir, dir);

 if (d2 > 0.0) {
 float factor = 0.0;
 if (preventOverlap) {
 float d = sqrt(d2);
 d = d - n0.w - n1.w;
 if (d > 0.0) {
 factor = scaling * n0.z * n1.z / (d * d);
 }
 else if (d < 0.0) {
 factor = scaling * 100.0 * n0.z * n1.z;
 }
 }
 else {
 factor = scaling * n0.z * n1.z / d2;
 }
 force += dir * factor;
 }
 }

 vec2 dir = gravityCenter - n0.xy;
 float d = 1.0;
 if (!strongGravityMode) {
 d = length(dir);
 }

 force += dir * n0.z * gravity / (d + 1.0);

 gl_FragColor = vec4(force, 0.0, 1.0);
}
@end

@export ecgl.forceAtlas2.updateEdgeAttraction.vertex

attribute vec2 node1;
attribute vec2 node2;
attribute float weight;

uniform sampler2D positionTex;
uniform float edgeWeightInfluence;
uniform bool preventOverlap;
uniform bool linLogMode;

uniform vec2 windowSize: WINDOW_SIZE;

varying vec2 v_Force;

void main() {

 vec4 n0 = texture2D(positionTex, node1);
 vec4 n1 = texture2D(positionTex, node2);

 vec2 dir = n1.xy - n0.xy;
 float d = length(dir);
 float w;
 if (edgeWeightInfluence == 0.0) {
 w = 1.0;
 }
 else if (edgeWeightInfluence == 1.0) {
 w = weight;
 }
 else {
 w = pow(weight, edgeWeightInfluence);
 }
 vec2 offset = vec2(1.0 / windowSize.x, 1.0 / windowSize.y);
 vec2 scale = vec2((windowSize.x - 1.0) / windowSize.x, (windowSize.y - 1.0) / windowSize.y);
 vec2 pos = node1 * scale * 2.0 - 1.0;
 gl_Position = vec4(pos + offset, 0.0, 1.0);
 gl_PointSize = 1.0;

 float factor;
 if (preventOverlap) {
 d = d - n1.w - n0.w;
 }
 if (d <= 0.0) {
 v_Force = vec2(0.0);
 return;
 }

 if (linLogMode) {
 factor = w * log(d) / d;
 }
 else {
 factor = w;
 }
 v_Force = dir * factor;
}
@end

@export ecgl.forceAtlas2.updateEdgeAttraction.fragment

varying vec2 v_Force;

void main() {
 gl_FragColor = vec4(v_Force, 0.0, 0.0);
}
@end

@export ecgl.forceAtlas2.calcWeightedSum.vertex

attribute vec2 node;

varying vec2 v_NodeUv;

void main() {

 v_NodeUv = node;
 gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
 gl_PointSize = 1.0;
}
@end

@export ecgl.forceAtlas2.calcWeightedSum.fragment

varying vec2 v_NodeUv;

uniform sampler2D positionTex;
uniform sampler2D forceTex;
uniform sampler2D forcePrevTex;

void main() {
 vec2 force = texture2D(forceTex, v_NodeUv).rg;
 vec2 forcePrev = texture2D(forcePrevTex, v_NodeUv).rg;

 float mass = texture2D(positionTex, v_NodeUv).z;
 float swing = length(force - forcePrev) * mass;
 float traction = length(force + forcePrev) * 0.5 * mass;

 gl_FragColor = vec4(swing, traction, 0.0, 0.0);
}
@end

@export ecgl.forceAtlas2.calcGlobalSpeed

uniform sampler2D globalSpeedPrevTex;
uniform sampler2D weightedSumTex;
uniform float jitterTolerence;

void main() {
 vec2 weightedSum = texture2D(weightedSumTex, vec2(0.5)).xy;
 float prevGlobalSpeed = texture2D(globalSpeedPrevTex, vec2(0.5)).x;
 float globalSpeed = jitterTolerence * jitterTolerence
 * weightedSum.y / weightedSum.x;
 if (prevGlobalSpeed > 0.0) {
 globalSpeed = min(globalSpeed / prevGlobalSpeed, 1.5) * prevGlobalSpeed;
 }
 gl_FragColor = vec4(globalSpeed, 0.0, 0.0, 1.0);
}
@end

@export ecgl.forceAtlas2.updatePosition

uniform sampler2D forceTex;
uniform sampler2D forcePrevTex;
uniform sampler2D positionTex;
uniform sampler2D globalSpeedTex;

varying vec2 v_Texcoord;

void main() {
 vec2 force = texture2D(forceTex, v_Texcoord).xy;
 vec2 forcePrev = texture2D(forcePrevTex, v_Texcoord).xy;
 vec4 node = texture2D(positionTex, v_Texcoord);

 float globalSpeed = texture2D(globalSpeedTex, vec2(0.5)).r;
 float swing = length(force - forcePrev);
 float speed = 0.1 * globalSpeed / (0.1 + globalSpeed * sqrt(swing));

 float df = length(force);
 if (df > 0.0) {
 speed = min(df * speed, 10.0) / df;

 gl_FragColor = vec4(node.xy + speed * force, node.zw);
 }
 else {
 gl_FragColor = node;
 }
}
@end

@export ecgl.forceAtlas2.edges.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec2 node;
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;

uniform sampler2D positionTex;

void main()
{
 gl_Position = worldViewProjection * vec4(
 texture2D(positionTex, node).xy, -10.0, 1.0
 );
 v_Color = a_Color;
}
@end

@export ecgl.forceAtlas2.edges.fragment
uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
varying vec4 v_Color;
void main() {
 gl_FragColor = color * v_Color;
}
@end`;R.Shader.import(WF);var VC={repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,scaling:1,edgeWeightInfluence:1,jitterTolerence:.1,preventOverlap:!1,dissuadeHubs:!1,gravityCenter:null};function hn(e){var t={type:R.Texture.FLOAT,minFilter:R.Texture.NEAREST,magFilter:R.Texture.NEAREST};this._positionSourceTex=new R.Texture2D(t),this._positionSourceTex.flipY=!1,this._positionTex=new R.Texture2D(t),this._positionPrevTex=new R.Texture2D(t),this._forceTex=new R.Texture2D(t),this._forcePrevTex=new R.Texture2D(t),this._weightedSumTex=new R.Texture2D(t),this._weightedSumTex.width=this._weightedSumTex.height=1,this._globalSpeedTex=new R.Texture2D(t),this._globalSpeedPrevTex=new R.Texture2D(t),this._globalSpeedTex.width=this._globalSpeedTex.height=1,this._globalSpeedPrevTex.width=this._globalSpeedPrevTex.height=1,this._nodeRepulsionPass=new Oi({fragment:R.Shader.source("ecgl.forceAtlas2.updateNodeRepulsion")}),this._positionPass=new Oi({fragment:R.Shader.source("ecgl.forceAtlas2.updatePosition")}),this._globalSpeedPass=new Oi({fragment:R.Shader.source("ecgl.forceAtlas2.calcGlobalSpeed")}),this._copyPass=new Oi({fragment:R.Shader.source("clay.compositor.output")});var i=function(r){r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ONE,r.ONE)};this._edgeForceMesh=new R.Mesh({geometry:new R.Geometry({attributes:{node1:new R.Geometry.Attribute("node1","float",2),node2:new R.Geometry.Attribute("node2","float",2),weight:new R.Geometry.Attribute("weight","float",1)},dynamic:!0,mainAttribute:"node1"}),material:new R.Material({transparent:!0,shader:R.createShader("ecgl.forceAtlas2.updateEdgeAttraction"),blend:i,depthMask:!1,depthText:!1}),mode:R.Mesh.POINTS}),this._weightedSumMesh=new R.Mesh({geometry:new R.Geometry({attributes:{node:new R.Geometry.Attribute("node","float",2)},dynamic:!0,mainAttribute:"node"}),material:new R.Material({transparent:!0,shader:R.createShader("ecgl.forceAtlas2.calcWeightedSum"),blend:i,depthMask:!1,depthText:!1}),mode:R.Mesh.POINTS}),this._framebuffer=new ki({depthBuffer:!1}),this._dummyCamera=new R.OrthographicCamera({left:-1,right:1,top:1,bottom:-1,near:0,far:100}),this._globalSpeed=0}hn.prototype.updateOption=function(e){for(var t in VC)this[t]=VC[t];var i=this._nodes.length;if(i>5e4?this.jitterTolerence=10:i>5e3?this.jitterTolerence=1:this.jitterTolerence=.1,i>100?this.scaling=2:this.scaling=10,e)for(var t in VC)e[t]!=null&&(this[t]=e[t]);if(this.repulsionByDegree)for(var r=this._positionSourceTex.pixels,n=0;n<this._nodes.length;n++)r[n*4+2]=(this._nodes[n].degree||0)+1};hn.prototype._updateGravityCenter=function(e){var t=this._nodes,i=this._edges;if(this.gravityCenter)this._gravityCenter=this.gravityCenter;else{for(var r=[1/0,1/0],n=[-1/0,-1/0],a=0;a<t.length;a++)r[0]=Math.min(t[a].x,r[0]),r[1]=Math.min(t[a].y,r[1]),n[0]=Math.max(t[a].x,n[0]),n[1]=Math.max(t[a].y,n[1]);this._gravityCenter=[(r[0]+n[0])*.5,(r[1]+n[1])*.5]}for(var a=0;a<i.length;a++){var o=i[a].node1,s=i[a].node2;t[o].degree=(t[o].degree||0)+1,t[s].degree=(t[s].degree||0)+1}};hn.prototype.initData=function(e,t){this._nodes=e,this._edges=t,this._updateGravityCenter();var i=Math.ceil(Math.sqrt(e.length)),r=i,n=new Float32Array(i*r*4);this._resize(i,r);for(var a=0,o=0;o<e.length;o++){var s=e[o];n[a++]=s.x||0,n[a++]=s.y||0,n[a++]=s.mass||1,n[a++]=s.size||1}this._positionSourceTex.pixels=n;var l=this._edgeForceMesh.geometry,c=t.length;l.attributes.node1.init(c*2),l.attributes.node2.init(c*2),l.attributes.weight.init(c*2);for(var d=[],o=0;o<t.length;o++){var u=l.attributes,h=t[o].weight;h==null&&(h=1),u.node1.set(o,this.getNodeUV(t[o].node1,d)),u.node2.set(o,this.getNodeUV(t[o].node2,d)),u.weight.set(o,h),u.node1.set(o+c,this.getNodeUV(t[o].node2,d)),u.node2.set(o+c,this.getNodeUV(t[o].node1,d)),u.weight.set(o+c,h)}var m=this._weightedSumMesh.geometry;m.attributes.node.init(e.length);for(var o=0;o<e.length;o++)m.attributes.node.set(o,this.getNodeUV(o,d));l.dirty(),m.dirty(),this._nodeRepulsionPass.material.define("fragment","NODE_COUNT",e.length),this._nodeRepulsionPass.material.setUniform("textureSize",[i,r]),this._inited=!1,this._frame=0};hn.prototype.getNodes=function(){return this._nodes};hn.prototype.getEdges=function(){return this._edges};hn.prototype.step=function(e){this._inited||(this._initFromSource(e),this._inited=!0),this._frame++,this._framebuffer.attach(this._forceTex),this._framebuffer.bind(e);var t=this._nodeRepulsionPass;t.setUniform("strongGravityMode",this.strongGravityMode),t.setUniform("gravity",this.gravity),t.setUniform("gravityCenter",this._gravityCenter),t.setUniform("scaling",this.scaling),t.setUniform("preventOverlap",this.preventOverlap),t.setUniform("positionTex",this._positionPrevTex),t.render(e);var i=this._edgeForceMesh;i.material.set("linLogMode",this.linLogMode),i.material.set("edgeWeightInfluence",this.edgeWeightInfluence),i.material.set("preventOverlap",this.preventOverlap),i.material.set("positionTex",this._positionPrevTex),e.gl.enable(e.gl.BLEND),e.renderPass([i],this._dummyCamera),this._framebuffer.attach(this._weightedSumTex),e.gl.clearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT),e.gl.enable(e.gl.BLEND);var r=this._weightedSumMesh;r.material.set("positionTex",this._positionPrevTex),r.material.set("forceTex",this._forceTex),r.material.set("forcePrevTex",this._forcePrevTex),e.renderPass([r],this._dummyCamera),this._framebuffer.attach(this._globalSpeedTex);var n=this._globalSpeedPass;n.setUniform("globalSpeedPrevTex",this._globalSpeedPrevTex),n.setUniform("weightedSumTex",this._weightedSumTex),n.setUniform("jitterTolerence",this.jitterTolerence),e.gl.disable(e.gl.BLEND),n.render(e);var a=this._positionPass;this._framebuffer.attach(this._positionTex),a.setUniform("globalSpeedTex",this._globalSpeedTex),a.setUniform("positionTex",this._positionPrevTex),a.setUniform("forceTex",this._forceTex),a.setUniform("forcePrevTex",this._forcePrevTex),a.render(e),this._framebuffer.unbind(e),this._swapTexture()};hn.prototype.update=function(e,t,i){t==null&&(t=1),t=Math.max(t,1);for(var r=0;r<t;r++)this.step(e);i&&i()};hn.prototype.getNodePositionTexture=function(){return this._inited?this._positionPrevTex:this._positionSourceTex};hn.prototype.getNodeUV=function(e,t){t=t||[];var i=this._positionTex.width,r=this._positionTex.height;return t[0]=e%i/(i-1),t[1]=Math.floor(e/i)/(r-1)||0,t};hn.prototype.getNodePosition=function(e,t){var i=this._positionArr,r=this._positionTex.width,n=this._positionTex.height,a=r*n;(!i||i.length!==a*4)&&(i=this._positionArr=new Float32Array(a*4)),this._framebuffer.bind(e),this._framebuffer.attach(this._positionPrevTex),e.gl.readPixels(0,0,r,n,e.gl.RGBA,e.gl.FLOAT,i),this._framebuffer.unbind(e),t||(t=new Float32Array(this._nodes.length*2));for(var o=0;o<this._nodes.length;o++)t[o*2]=i[o*4],t[o*2+1]=i[o*4+1];return t};hn.prototype.getTextureData=function(e,t){var i=this["_"+t+"Tex"],r=i.width,n=i.height;this._framebuffer.bind(e),this._framebuffer.attach(i);var a=new Float32Array(r*n*4);return e.gl.readPixels(0,0,r,n,e.gl.RGBA,e.gl.FLOAT,a),this._framebuffer.unbind(e),a};hn.prototype.getTextureSize=function(){return{width:this._positionTex.width,height:this._positionTex.height}};hn.prototype.isFinished=function(e){return this._frame>e};hn.prototype._swapTexture=function(){var e=this._positionPrevTex;this._positionPrevTex=this._positionTex,this._positionTex=e;var e=this._forcePrevTex;this._forcePrevTex=this._forceTex,this._forceTex=e;var e=this._globalSpeedPrevTex;this._globalSpeedPrevTex=this._globalSpeedTex,this._globalSpeedTex=e};hn.prototype._initFromSource=function(e){this._framebuffer.attach(this._positionPrevTex),this._framebuffer.bind(e),this._copyPass.setUniform("texture",this._positionSourceTex),this._copyPass.render(e),e.gl.clearColor(0,0,0,0),this._framebuffer.attach(this._forcePrevTex),e.gl.clear(e.gl.COLOR_BUFFER_BIT),this._framebuffer.attach(this._globalSpeedPrevTex),e.gl.clear(e.gl.COLOR_BUFFER_BIT),this._framebuffer.unbind(e)};hn.prototype._resize=function(e,t){["_positionSourceTex","_positionTex","_positionPrevTex","_forceTex","_forcePrevTex"].forEach(function(i){this[i].width=e,this[i].height=t,this[i].dirty()},this)};hn.prototype.dispose=function(e){this._framebuffer.dispose(e),this._copyPass.dispose(e),this._nodeRepulsionPass.dispose(e),this._positionPass.dispose(e),this._globalSpeedPass.dispose(e),this._edgeForceMesh.geometry.dispose(e),this._weightedSumMesh.geometry.dispose(e),this._positionSourceTex.dispose(e),this._positionTex.dispose(e),this._positionPrevTex.dispose(e),this._forceTex.dispose(e),this._forcePrevTex.dispose(e),this._weightedSumTex.dispose(e),this._globalSpeedTex.dispose(e),this._globalSpeedPrevTex.dispose(e)};var B_=hn;function Qj(){var e={create:function(){return new Float32Array(2)},dist:function(l,c){var d=c[0]-l[0],u=c[1]-l[1];return Math.sqrt(d*d+u*u)},len:function(l){var c=l[0],d=l[1];return Math.sqrt(c*c+d*d)},scaleAndAdd:function(l,c,d,u){return l[0]=c[0]+d[0]*u,l[1]=c[1]+d[1]*u,l},scale:function(l,c,d){return l[0]=c[0]*d,l[1]=c[1]*d,l},add:function(l,c,d){return l[0]=c[0]+d[0],l[1]=c[1]+d[1],l},sub:function(l,c,d){return l[0]=c[0]-d[0],l[1]=c[1]-d[1],l},normalize:function(l,c){var d=c[0],u=c[1],h=d*d+u*u;return h>0&&(h=1/Math.sqrt(h),l[0]=c[0]*h,l[1]=c[1]*h),l},negate:function(l,c){return l[0]=-c[0],l[1]=-c[1],l},copy:function(l,c){return l[0]=c[0],l[1]=c[1],l},set:function(l,c,d){return l[0]=c,l[1]=d,l}};function t(){this.subRegions=[],this.nSubRegions=0,this.node=null,this.mass=0,this.centerOfMass=null,this.bbox=new Float32Array(4),this.size=0}var i=t.prototype;i.beforeUpdate=function(){for(var l=0;l<this.nSubRegions;l++)this.subRegions[l].beforeUpdate();this.mass=0,this.centerOfMass&&(this.centerOfMass[0]=0,this.centerOfMass[1]=0),this.nSubRegions=0,this.node=null},i.afterUpdate=function(){this.subRegions.length=this.nSubRegions;for(var l=0;l<this.nSubRegions;l++)this.subRegions[l].afterUpdate()},i.addNode=function(l){if(this.nSubRegions===0)if(this.node==null){this.node=l;return}else this._addNodeToSubRegion(this.node),this.node=null;this._addNodeToSubRegion(l),this._updateCenterOfMass(l)},i.findSubRegion=function(l,c){for(var d=0;d<this.nSubRegions;d++){var u=this.subRegions[d];if(u.contain(l,c))return u}},i.contain=function(l,c){return this.bbox[0]<=l&&this.bbox[2]>=l&&this.bbox[1]<=c&&this.bbox[3]>=c},i.setBBox=function(l,c,d,u){this.bbox[0]=l,this.bbox[1]=c,this.bbox[2]=d,this.bbox[3]=u,this.size=(d-l+u-c)/2},i._newSubRegion=function(){var l=this.subRegions[this.nSubRegions];return l||(l=new t,this.subRegions[this.nSubRegions]=l),this.nSubRegions++,l},i._addNodeToSubRegion=function(l){var c=this.findSubRegion(l.position[0],l.position[1]),d=this.bbox;if(!c){var u=(d[0]+d[2])/2,h=(d[1]+d[3])/2,m=(d[2]-d[0])/2,f=(d[3]-d[1])/2,p=l.position[0]>=u?1:0,g=l.position[1]>=h?1:0,c=this._newSubRegion();c.setBBox(p*m+d[0],g*f+d[1],(p+1)*m+d[0],(g+1)*f+d[1])}c.addNode(l)},i._updateCenterOfMass=function(l){this.centerOfMass==null&&(this.centerOfMass=new Float32Array(2));var c=this.centerOfMass[0]*this.mass,d=this.centerOfMass[1]*this.mass;c+=l.position[0]*l.mass,d+=l.position[1]*l.mass,this.mass+=l.mass,this.centerOfMass[0]=c/this.mass,this.centerOfMass[1]=d/this.mass};function r(){this.position=new Float32Array(2),this.force=e.create(),this.forcePrev=e.create(),this.mass=1,this.inDegree=0,this.outDegree=0}function n(l,c){this.source=l,this.target=c,this.weight=1}function a(){this.autoSettings=!0,this.barnesHutOptimize=!0,this.barnesHutTheta=1.5,this.repulsionByDegree=!0,this.linLogMode=!1,this.strongGravityMode=!1,this.gravity=1,this.scaling=1,this.edgeWeightInfluence=1,this.jitterTolerence=.1,this.preventOverlap=!1,this.dissuadeHubs=!1,this.rootRegion=new t,this.rootRegion.centerOfMass=e.create(),this.nodes=[],this.edges=[],this.bbox=new Float32Array(4),this.gravityCenter=null,this._massArr=null,this._swingingArr=null,this._sizeArr=null,this._globalSpeed=0}var o=a.prototype;o.initNodes=function(l,c,d){var u=c.length;this.nodes.length=0;for(var h=typeof d<"u",m=0;m<u;m++){var f=new r;f.position[0]=l[m*2],f.position[1]=l[m*2+1],f.mass=c[m],h&&(f.size=d[m]),this.nodes.push(f)}this._massArr=c,this._swingingArr=new Float32Array(u),h&&(this._sizeArr=d)},o.initEdges=function(l,c){var d=l.length/2;this.edges.length=0;for(var u=0;u<d;u++){var h=l[u*2],m=l[u*2+1],f=this.nodes[h],p=this.nodes[m];if(!f||!p){console.error("Node not exists, try initNodes before initEdges");return}f.outDegree++,p.inDegree++;var g=new n(f,p);c&&(g.weight=c[u]),this.edges.push(g)}},o.updateSettings=function(){if(this.repulsionByDegree)for(var l=0;l<this.nodes.length;l++){var c=this.nodes[l];c.mass=c.inDegree+c.outDegree+1}else for(var l=0;l<this.nodes.length;l++){var c=this.nodes[l];c.mass=this._massArr[l]}},o.update=function(){var l=this.nodes.length;if(this.updateSettings(),this.updateBBox(),this.barnesHutOptimize){this.rootRegion.setBBox(this.bbox[0],this.bbox[1],this.bbox[2],this.bbox[3]),this.rootRegion.beforeUpdate();for(var c=0;c<l;c++)this.rootRegion.addNode(this.nodes[c]);this.rootRegion.afterUpdate()}for(var c=0;c<l;c++){var d=this.nodes[c];e.copy(d.forcePrev,d.force),e.set(d.force,0,0)}for(var c=0;c<l;c++){var u=this.nodes[c];if(this.barnesHutOptimize)this.applyRegionToNodeRepulsion(this.rootRegion,u);else for(var h=c+1;h<l;h++){var m=this.nodes[h];this.applyNodeToNodeRepulsion(u,m,!1)}this.gravity>0&&(this.strongGravityMode?this.applyNodeStrongGravity(u):this.applyNodeGravity(u))}for(var c=0;c<this.edges.length;c++)this.applyEdgeAttraction(this.edges[c]);for(var f=0,p=0,g=e.create(),c=0;c<l;c++){var d=this.nodes[c],v=e.dist(d.force,d.forcePrev);f+=v*d.mass,e.add(g,d.force,d.forcePrev);var b=e.len(g)*.5;p+=b*d.mass,this._swingingArr[c]=v}var _=this.jitterTolerence*this.jitterTolerence*p/f;this._globalSpeed>0&&(_=Math.min(_/this._globalSpeed,1.5)*this._globalSpeed),this._globalSpeed=_;for(var c=0;c<l;c++){var d=this.nodes[c],v=this._swingingArr[c],x=.1*_/(1+_*Math.sqrt(v)),w=e.len(d.force);w>0&&(x=Math.min(w*x,10)/w,e.scaleAndAdd(d.position,d.position,d.force,x))}},o.applyRegionToNodeRepulsion=function(){var l=e.create();return function(d,u){if(d.node)this.applyNodeToNodeRepulsion(d.node,u,!0);else{e.sub(l,u.position,d.centerOfMass);var h=l[0]*l[0]+l[1]*l[1];if(h>this.barnesHutTheta*d.size*d.size){var m=this.scaling*u.mass*d.mass/h;e.scaleAndAdd(u.force,u.force,l,m)}else for(var f=0;f<d.nSubRegions;f++)this.applyRegionToNodeRepulsion(d.subRegions[f],u)}}}(),o.applyNodeToNodeRepulsion=function(){var l=e.create();return function(d,u,h){if(d!=u){e.sub(l,d.position,u.position);var m=l[0]*l[0]+l[1]*l[1];if(m!==0){var f;if(this.preventOverlap){var p=Math.sqrt(m);if(p=p-d.size-u.size,p>0)f=this.scaling*d.mass*u.mass/(p*p);else if(p<0)f=this.scaling*100*d.mass*u.mass;else return}else f=this.scaling*d.mass*u.mass/m;e.scaleAndAdd(d.force,d.force,l,f),e.scaleAndAdd(u.force,u.force,l,-f)}}}}(),o.applyEdgeAttraction=function(){var l=e.create();return function(d){var u=d.source,h=d.target;e.sub(l,u.position,h.position);var m=e.len(l),f;this.edgeWeightInfluence===0?f=1:this.edgeWeightInfluence===1?f=d.weight:f=Math.pow(d.weight,this.edgeWeightInfluence);var p;this.preventOverlap&&(m=m-u.size-h.size,m<=0)||(this.linLogMode?p=-f*Math.log(m+1)/(m+1):p=-f,e.scaleAndAdd(u.force,u.force,l,p),e.scaleAndAdd(h.force,h.force,l,-p))}}(),o.applyNodeGravity=function(){var l=e.create();return function(c){e.sub(l,this.gravityCenter,c.position);var d=e.len(l);e.scaleAndAdd(c.force,c.force,l,this.gravity*c.mass/(d+1))}}(),o.applyNodeStrongGravity=function(){var l=e.create();return function(c){e.sub(l,this.gravityCenter,c.position),e.scaleAndAdd(c.force,c.force,l,this.gravity*c.mass)}}(),o.updateBBox=function(){for(var l=1/0,c=1/0,d=-1/0,u=-1/0,h=0;h<this.nodes.length;h++){var m=this.nodes[h].position;l=Math.min(l,m[0]),c=Math.min(c,m[1]),d=Math.max(d,m[0]),u=Math.max(u,m[1])}this.bbox[0]=l,this.bbox[1]=c,this.bbox[2]=d,this.bbox[3]=u},o.getGlobalSpeed=function(){return this._globalSpeed};var s=null;self.onmessage=function(l){switch(l.data.cmd){case"init":s=new a,s.initNodes(l.data.nodesPosition,l.data.nodesMass,l.data.nodesSize),s.initEdges(l.data.edges,l.data.edgesWeight);break;case"updateConfig":if(s)for(var c in l.data.config)s[c]=l.data.config[c];break;case"update":var d=l.data.steps;if(s){for(var u=0;u<d;u++)s.update();for(var h=s.nodes.length,m=new Float32Array(h*2),u=0;u<h;u++){var f=s.nodes[u];m[u*2]=f.position[0],m[u*2+1]=f.position[1]}self.postMessage({buffer:m.buffer,globalSpeed:s.getGlobalSpeed()},[m.buffer])}else{var p=new Float32Array;self.postMessage({buffer:p.buffer,globalSpeed:s.getGlobalSpeed()},[p.buffer])}break}}}var qF=Qj;var Mf=qF.toString();Mf=Mf.slice(Mf.indexOf("{")+1,Mf.lastIndexOf("}"));var If={barnesHutOptimize:!0,barnesHutTheta:1.5,repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,scaling:1,edgeWeightInfluence:1,jitterTolerence:.1,preventOverlap:!1,dissuadeHubs:!1,gravityCenter:null},io=function(e){for(var t in If)this[t]=If[t];if(e)for(var t in e)this[t]=e[t];this._nodes=[],this._edges=[],this._disposed=!1,this._positionTex=new ct({type:qe.FLOAT,flipY:!1,minFilter:qe.NEAREST,magFilter:qe.NEAREST})};io.prototype.initData=function(e,t){var i=new Blob([Mf]),r=window.URL.createObjectURL(i);this._worker=new Worker(r),this._worker.onmessage=this._$onupdate.bind(this),this._nodes=e,this._edges=t,this._frame=0;for(var n=e.length,a=t.length,o=new Float32Array(n*2),s=new Float32Array(n),l=new Float32Array(n),c=new Float32Array(a*2),d=new Float32Array(a),u=0;u<e.length;u++){var h=e[u];o[u*2]=h.x,o[u*2+1]=h.y,s[u]=h.mass==null?1:h.mass,l[u]=h.size==null?1:h.size}for(var u=0;u<t.length;u++){var m=t[u],f=m.node1,p=m.node2;c[u*2]=f,c[u*2+1]=p,d[u]=m.weight==null?1:m.weight}var g=Math.ceil(Math.sqrt(e.length)),v=g,b=new Float32Array(g*v*4),_=this._positionTex;_.width=g,_.height=v,_.pixels=b,this._worker.postMessage({cmd:"init",nodesPosition:o,nodesMass:s,nodesSize:l,edges:c,edgesWeight:d}),this._globalSpeed=1/0};io.prototype.updateOption=function(e){var t={};for(var i in If)t[i]=If[i];var r=this._nodes,n=this._edges,a=r.length;if(a>5e4?t.jitterTolerence=10:a>5e3?t.jitterTolerence=1:t.jitterTolerence=.1,a>100?t.scaling=2:t.scaling=10,a>1e3?t.barnesHutOptimize=!0:t.barnesHutOptimize=!1,e)for(var i in If)e[i]!=null&&(t[i]=e[i]);if(!t.gravityCenter){for(var o=[1/0,1/0],s=[-1/0,-1/0],l=0;l<r.length;l++)o[0]=Math.min(r[l].x,o[0]),o[1]=Math.min(r[l].y,o[1]),s[0]=Math.max(r[l].x,s[0]),s[1]=Math.max(r[l].y,s[1]);t.gravityCenter=[(o[0]+s[0])*.5,(o[1]+s[1])*.5]}for(var l=0;l<n.length;l++){var c=n[l].node1,d=n[l].node2;r[c].degree=(r[c].degree||0)+1,r[d].degree=(r[d].degree||0)+1}this._worker&&this._worker.postMessage({cmd:"updateConfig",config:t})};io.prototype.update=function(e,t,i){t==null&&(t=1),t=Math.max(t,1),this._frame+=t,this._onupdate=i,this._worker&&this._worker.postMessage({cmd:"update",steps:Math.round(t)})};io.prototype._$onupdate=function(e){if(!this._disposed){var t=new Float32Array(e.data.buffer);this._globalSpeed=e.data.globalSpeed,this._positionArr=t,this._updateTexture(t),this._onupdate&&this._onupdate()}};io.prototype.getNodePositionTexture=function(){return this._positionTex};io.prototype.getNodeUV=function(e,t){t=t||[];var i=this._positionTex.width,r=this._positionTex.height;return t[0]=e%i/(i-1),t[1]=Math.floor(e/i)/(r-1),t};io.prototype.getNodes=function(){return this._nodes};io.prototype.getEdges=function(){return this._edges};io.prototype.isFinished=function(e){return this._frame>e};io.prototype.getNodePosition=function(e,t){if(t||(t=new Float32Array(this._nodes.length*2)),this._positionArr)for(var i=0;i<this._positionArr.length;i++)t[i]=this._positionArr[i];return t};io.prototype._updateTexture=function(e){for(var t=this._positionTex.pixels,i=0,r=0;r<e.length;)t[i++]=e[r++],t[i++]=e[r++],t[i++]=1,t[i++]=1;this._positionTex.dirty()};io.prototype.dispose=function(e){this._disposed=!0,this._worker=null};var zC=io;var Jj=Ui.extend(function(){return{zr:null,viewGL:null,minZoom:.2,maxZoom:5,_needsUpdate:!1,_dx:0,_dy:0,_zoom:1}},function(){this._mouseDownHandler=this._mouseDownHandler.bind(this),this._mouseWheelHandler=this._mouseWheelHandler.bind(this),this._mouseMoveHandler=this._mouseMoveHandler.bind(this),this._mouseUpHandler=this._mouseUpHandler.bind(this),this._update=this._update.bind(this)},{init:function(){var e=this.zr;e.on("mousedown",this._mouseDownHandler),e.on("mousewheel",this._mouseWheelHandler),e.on("globalout",this._mouseUpHandler),e.animation.on("frame",this._update)},setTarget:function(e){this._target=e},setZoom:function(e){this._zoom=Math.max(Math.min(e,this.maxZoom),this.minZoom),this._needsUpdate=!0},setOffset:function(e){this._dx=e[0],this._dy=e[1],this._needsUpdate=!0},getZoom:function(){return this._zoom},getOffset:function(){return[this._dx,this._dy]},_update:function(){if(this._target&&this._needsUpdate){var e=this._target,t=this._zoom;e.position.x=this._dx,e.position.y=this._dy,e.scale.set(t,t,t),this.zr.refresh(),this._needsUpdate=!1,this.trigger("update")}},_mouseDownHandler:function(e){if(!e.target){var t=e.offsetX,i=e.offsetY;if(!(this.viewGL&&!this.viewGL.containPoint(t,i))){this.zr.on("mousemove",this._mouseMoveHandler),this.zr.on("mouseup",this._mouseUpHandler);var r=this._convertPos(t,i);this._x=r.x,this._y=r.y}}},_convertPos:function(e,t){var i=this.viewGL.camera,r=this.viewGL.viewport;return{x:(e-r.x)/r.width*(i.right-i.left)+i.left,y:(t-r.y)/r.height*(i.bottom-i.top)+i.top}},_mouseMoveHandler:function(e){var t=this._convertPos(e.offsetX,e.offsetY);this._dx+=t.x-this._x,this._dy+=t.y-this._y,this._x=t.x,this._y=t.y,this._needsUpdate=!0},_mouseUpHandler:function(e){this.zr.off("mousemove",this._mouseMoveHandler),this.zr.off("mouseup",this._mouseUpHandler)},_mouseWheelHandler:function(e){e=e.event;var t=e.wheelDelta||-e.detail;if(t!==0){var i=e.offsetX,r=e.offsetY;if(!(this.viewGL&&!this.viewGL.containPoint(i,r))){var n=t>0?1.1:.9,a=Math.max(Math.min(this._zoom*n,this.maxZoom),this.minZoom);n=a/this._zoom;var o=this._convertPos(i,r),s=(o.x-this._dx)*(n-1),l=(o.y-this._dy)*(n-1);this._dx-=s,this._dy-=l,this._zoom=a,this._needsUpdate=!0}}},dispose:function(){var e=this.zr;e.off("mousedown",this._mouseDownHandler),e.off("mousemove",this._mouseMoveHandler),e.off("mouseup",this._mouseUpHandler),e.off("mousewheel",this._mouseWheelHandler),e.off("globalout",this._mouseUpHandler),e.animation.off("frame",this._update)}}),$F=Jj;var XF=`@export ecgl.lines2D.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec2 position: POSITION;
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;

#ifdef POSITIONTEXTURE_ENABLED
uniform sampler2D positionTexture;
#endif

void main()
{
 gl_Position = worldViewProjection * vec4(position, -10.0, 1.0);

 v_Color = a_Color;
}

@end

@export ecgl.lines2D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;

void main()
{
 gl_FragColor = color * v_Color;
}
@end


@export ecgl.meshLines2D.vertex

attribute vec2 position: POSITION;
attribute vec2 normal;
attribute float offset;
attribute vec4 a_Color : COLOR;

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;

varying vec4 v_Color;
varying float v_Miter;

void main()
{
 vec4 p2 = worldViewProjection * vec4(position + normal, -10.0, 1.0);
 gl_Position = worldViewProjection * vec4(position, -10.0, 1.0);

 p2.xy /= p2.w;
 gl_Position.xy /= gl_Position.w;

 vec2 N = normalize(p2.xy - gl_Position.xy);
 gl_Position.xy += N * offset / viewport.zw * 2.0;

 gl_Position.xy *= gl_Position.w;

 v_Color = a_Color;
}
@end


@export ecgl.meshLines2D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;
varying float v_Miter;

void main()
{
 gl_FragColor = color * v_Color;
}

@end`;var V_=ri.vec2;R.Shader.import(XF);var eW=1,YF=Rr.extend({type:"graphGL",__ecgl__:!0,init:function(e,t){this.groupGL=new R.Node,this.viewGL=new Bn("orthographic"),this.viewGL.camera.left=this.viewGL.camera.right=0,this.viewGL.add(this.groupGL),this._pointsBuilder=new Ec(!0,t),this._forceEdgesMesh=new R.Mesh({material:new R.Material({shader:R.createShader("ecgl.forceAtlas2.edges"),transparent:!0,depthMask:!1,depthTest:!1}),$ignorePicking:!0,geometry:new R.Geometry({attributes:{node:new R.Geometry.Attribute("node","float",2),color:new R.Geometry.Attribute("color","float",4,"COLOR")},dynamic:!0,mainAttribute:"node"}),renderOrder:-1,mode:R.Mesh.LINES}),this._edgesMesh=new R.Mesh({material:new R.Material({shader:R.createShader("ecgl.meshLines2D"),transparent:!0,depthMask:!1,depthTest:!1}),$ignorePicking:!0,geometry:new L_({useNativeLine:!1,dynamic:!0}),renderOrder:-1,culling:!1}),this._layoutId=0,this._control=new $F({zr:t.getZr(),viewGL:this.viewGL}),this._control.setTarget(this.groupGL),this._control.init(),this._clickHandler=this._clickHandler.bind(this)},render:function(e,t,i){this.groupGL.add(this._pointsBuilder.rootNode),this._model=e,this._api=i,this._initLayout(e,t,i),this._pointsBuilder.update(e,t,i),this._forceLayoutInstance instanceof B_||this.groupGL.remove(this._forceEdgesMesh),this._updateCamera(e,i),this._control.off("update"),this._control.on("update",function(){i.dispatchAction({type:"graphGLRoam",seriesId:e.id,zoom:this._control.getZoom(),offset:this._control.getOffset()}),this._pointsBuilder.updateView(this.viewGL.camera)},this),this._control.setZoom(ht.firstNotNull(e.get("zoom"),1)),this._control.setOffset(e.get("offset")||[0,0]);var r=this._pointsBuilder.getPointsMesh();if(r.off("mousemove",this._mousemoveHandler),r.off("mouseout",this._mouseOutHandler,this),i.getZr().off("click",this._clickHandler),this._pointsBuilder.highlightOnMouseover=!0,e.get("focusNodeAdjacency")){var n=e.get("focusNodeAdjacencyOn");n==="click"?i.getZr().on("click",this._clickHandler):n==="mouseover"&&(r.on("mousemove",this._mousemoveHandler,this),r.on("mouseout",this._mouseOutHandler,this),this._pointsBuilder.highlightOnMouseover=!1)}this._lastMouseOverDataIndex=-1},_clickHandler:function(e){if(!this._layouting){var t=this._pointsBuilder.getPointsMesh().dataIndex;t>=0?this._api.dispatchAction({type:"graphGLFocusNodeAdjacency",seriesId:this._model.id,dataIndex:t}):this._api.dispatchAction({type:"graphGLUnfocusNodeAdjacency",seriesId:this._model.id})}},_mousemoveHandler:function(e){if(!this._layouting){var t=this._pointsBuilder.getPointsMesh().dataIndex;t>=0?t!==this._lastMouseOverDataIndex&&this._api.dispatchAction({type:"graphGLFocusNodeAdjacency",seriesId:this._model.id,dataIndex:t}):this._mouseOutHandler(e),this._lastMouseOverDataIndex=t}},_mouseOutHandler:function(e){this._layouting||(this._api.dispatchAction({type:"graphGLUnfocusNodeAdjacency",seriesId:this._model.id}),this._lastMouseOverDataIndex=-1)},_updateForceEdgesGeometry:function(e,t){var i=this._forceEdgesMesh.geometry,r=t.getEdgeData(),n=0,a=this._forceLayoutInstance,o=r.count()*2;i.attributes.node.init(o),i.attributes.color.init(o),r.each(function(s){var l=e[s];i.attributes.node.set(n,a.getNodeUV(l.node1)),i.attributes.node.set(n+1,a.getNodeUV(l.node2));var c=Gi(r,l.dataIndex),d=R.parseColor(c);d[3]*=ht.firstNotNull(Zi(r,l.dataIndex),1),i.attributes.color.set(n,d),i.attributes.color.set(n+1,d),n+=2}),i.dirty()},_updateMeshLinesGeometry:function(){var t=this._model.getEdgeData(),e=this._edgesMesh.geometry,t=this._model.getEdgeData(),i=this._model.getData().getLayout("points");e.resetOffset(),e.setVertexCount(t.count()*e.getLineVertexCount()),e.setTriangleCount(t.count()*e.getLineTriangleCount());var r=[],n=[],a=["lineStyle","width"];this._originalEdgeColors=new Float32Array(t.count()*4),this._edgeIndicesMap=new Float32Array(t.count()),t.each(function(o){var s=t.graph.getEdgeByIndex(o),l=s.node1.dataIndex*2,c=s.node2.dataIndex*2;r[0]=i[l],r[1]=i[l+1],n[0]=i[c],n[1]=i[c+1];var d=Gi(t,s.dataIndex),u=R.parseColor(d);u[3]*=ht.firstNotNull(Zi(t,s.dataIndex),1);var h=t.getItemModel(s.dataIndex),m=ht.firstNotNull(h.get(a),1)*this._api.getDevicePixelRatio();e.addLine(r,n,u,m);for(var f=0;f<4;f++)this._originalEdgeColors[s.dataIndex*4+f]=u[f];this._edgeIndicesMap[s.dataIndex]=o},this),e.dirty()},_updateForceNodesGeometry:function(e){for(var t=this._pointsBuilder.getPointsMesh(),i=[],r=0;r<e.count();r++)this._forceLayoutInstance.getNodeUV(r,i),t.geometry.attributes.position.set(r,i);t.geometry.dirty("position")},_initLayout:function(e,t,i){var r=e.get("layout"),n=e.getGraph(),a=e.getBoxLayoutParams(),o=oc(a,{width:i.getWidth(),height:i.getHeight()});r==="force"&&(r="forceAtlas2"),this.stopLayout(e,t,i,{beforeLayout:!0});var s=e.getData(),l=e.getData();if(r==="forceAtlas2"){var c=e.getModel("forceAtlas2"),d=this._forceLayoutInstance,u=[],h=[],m=s.getDataExtent("value"),f=l.getDataExtent("value"),p=ht.firstNotNull(c.get("edgeWeight"),1),g=ht.firstNotNull(c.get("nodeWeight"),1);typeof p=="number"&&(p=[p,p]),typeof g=="number"&&(g=[g,g]);var v=0,b={},_=new Float32Array(s.count()*2);if(n.eachNode(function(w){var y=w.dataIndex,M=s.get("value",y),T,C;if(s.hasItemOption){var N=s.getItemModel(y);T=N.get("x"),C=N.get("y")}T==null&&(T=o.x+Math.random()*o.width,C=o.y+Math.random()*o.height),_[v*2]=T,_[v*2+1]=C,b[w.id]=v++;var D=Qa.linearMap(M,m,g);isNaN(D)&&(isNaN(g[0])?D=1:D=g[0]),u.push({x:T,y:C,mass:D,size:s.getItemVisual(y,"symbolSize")})}),s.setLayout("points",_),n.eachEdge(function(w){var y=w.dataIndex,M=s.get("value",y),T=Qa.linearMap(M,f,p);isNaN(T)&&(isNaN(p[0])?T=1:T=p[0]),h.push({node1:b[w.node1.id],node2:b[w.node2.id],weight:T,dataIndex:y})}),!d){var x=c.get("GPU");this._forceLayoutInstance&&(x&&!(this._forceLayoutInstance instanceof B_)||!x&&!(this._forceLayoutInstance instanceof zC))&&(this._forceLayoutInstanceToDispose=this._forceLayoutInstance),d=this._forceLayoutInstance=x?new B_:new zC}d.initData(u,h),d.updateOption(c.option),this._updateForceEdgesGeometry(d.getEdges(),e),this._updatePositionTexture(),i.dispatchAction({type:"graphGLStartLayout",from:this.uid})}else{var _=new Float32Array(s.count()*2),v=0;n.eachNode(function(M){var T=M.dataIndex,C,N;if(s.hasItemOption){var D=s.getItemModel(T);C=D.get("x"),N=D.get("y")}_[v++]=C,_[v++]=N}),s.setLayout("points",_),this._updateAfterLayout(e,t,i)}},_updatePositionTexture:function(){var e=this._forceLayoutInstance.getNodePositionTexture();this._pointsBuilder.setPositionTexture(e),this._forceEdgesMesh.material.set("positionTex",e)},startLayout:function(e,t,a,r){if(!(r&&r.from!=null&&r.from!==this.uid)){var n=this.viewGL,a=this._api,o=this._forceLayoutInstance,s=this._model.getData(),l=this._model.getModel("forceAtlas2");if(o&&(this.groupGL.remove(this._edgesMesh),this.groupGL.add(this._forceEdgesMesh),!!this._forceLayoutInstance)){this._updateForceNodesGeometry(e.getData()),this._pointsBuilder.hideLabels();var c=this,d=this._layoutId=eW++,u=l.getShallow("maxSteps"),h=l.getShallow("steps"),m=0,f=Math.max(h*2,20),p=function(g){if(g===c._layoutId){if(o.isFinished(u)){a.dispatchAction({type:"graphGLStopLayout",from:c.uid}),a.dispatchAction({type:"graphGLFinishLayout",points:s.getLayout("points"),from:c.uid});return}o.update(n.layer.renderer,h,function(){c._updatePositionTexture(),m+=h,m>=f&&(c._syncNodePosition(e),m=0),a.getZr().refresh(),ff(function(){p(g)})})}};ff(function(){c._forceLayoutInstanceToDispose&&(c._forceLayoutInstanceToDispose.dispose(n.layer.renderer),c._forceLayoutInstanceToDispose=null),p(d)}),this._layouting=!0}}},stopLayout:function(e,t,i,r){r&&r.from!=null&&r.from!==this.uid||(this._layoutId=0,this.groupGL.remove(this._forceEdgesMesh),this.groupGL.add(this._edgesMesh),this._forceLayoutInstance&&this.viewGL.layer&&(r&&r.beforeLayout||(this._syncNodePosition(e),this._updateAfterLayout(e,t,i)),this._api.getZr().refresh(),this._layouting=!1))},_syncNodePosition:function(e){var t=this._forceLayoutInstance.getNodePosition(this.viewGL.layer.renderer);e.getData().setLayout("points",t),e.setNodePosition(t)},_updateAfterLayout:function(e,t,i){this._updateMeshLinesGeometry(),this._pointsBuilder.removePositionTexture(),this._pointsBuilder.updateLayout(e,t,i),this._pointsBuilder.updateView(this.viewGL.camera),this._pointsBuilder.updateLabels(),this._pointsBuilder.showLabels()},focusNodeAdjacency:function(e,t,i,r){var n=this._model.getData();this._downplayAll();var a=r.dataIndex,o=n.graph,s=[],l=o.getNodeByIndex(a);s.push(l),l.edges.forEach(function(d){d.dataIndex<0||(d.node1!==l&&s.push(d.node1),d.node2!==l&&s.push(d.node2))},this),this._pointsBuilder.fadeOutAll(.05),this._fadeOutEdgesAll(.05),s.forEach(function(d){this._pointsBuilder.highlight(n,d.dataIndex)},this),this._pointsBuilder.updateLabels(s.map(function(d){return d.dataIndex}));var c=[];l.edges.forEach(function(d){d.dataIndex>=0&&(this._highlightEdge(d.dataIndex),c.push(d))},this),this._focusNodes=s,this._focusEdges=c},unfocusNodeAdjacency:function(e,t,i,r){this._downplayAll(),this._pointsBuilder.fadeInAll(),this._fadeInEdgesAll(),this._pointsBuilder.updateLabels()},_highlightEdge:function(e){var t=this._model.getEdgeData().getItemModel(e),i=R.parseColor(t.get("emphasis.lineStyle.color")||t.get("lineStyle.color")),r=ht.firstNotNull(t.get("emphasis.lineStyle.opacity"),t.get("lineStyle.opacity"),1);i[3]*=r,this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[e],i)},_downplayAll:function(){this._focusNodes&&this._focusNodes.forEach(function(e){this._pointsBuilder.downplay(this._model.getData(),e.dataIndex)},this),this._focusEdges&&this._focusEdges.forEach(function(e){this._downplayEdge(e.dataIndex)},this)},_downplayEdge:function(e){var t=this._getColor(e,[]);this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[e],t)},_setEdgeFade:function(){var e=[];return function(t,i){this._getColor(t,e),e[3]*=i,this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[t],e)}}(),_getColor:function(e,t){for(var i=0;i<4;i++)t[i]=this._originalEdgeColors[e*4+i];return t},_fadeOutEdgesAll:function(e){var t=this._model.getData().graph;t.eachEdge(function(i){this._setEdgeFade(i.dataIndex,e)},this)},_fadeInEdgesAll:function(){this._fadeOutEdgesAll(1)},_updateCamera:function(e,t){this.viewGL.setViewport(0,0,t.getWidth(),t.getHeight(),t.getDevicePixelRatio());for(var i=this.viewGL.camera,r=e.getData(),n=r.getLayout("points"),a=V_.create(1/0,1/0),o=V_.create(-1/0,-1/0),s=[],l=0;l<n.length;)s[0]=n[l++],s[1]=n[l++],V_.min(a,a,s),V_.max(o,o,s);var c=(o[1]+a[1])/2,d=(o[0]+a[0])/2;if(!(d>i.left&&d<i.right&&c<i.bottom&&c>i.top)){var u=Math.max(o[0]-a[0],10),h=u/t.getWidth()*t.getHeight();u*=1.4,h*=1.4,a[0]-=u*.2,i.left=a[0],i.top=c-h/2,i.bottom=c+h/2,i.right=u+a[0],i.near=0,i.far=100}},dispose:function(){var e=this.viewGL.layer.renderer;this._forceLayoutInstance&&this._forceLayoutInstance.dispose(e),this.groupGL.removeAll(),this._layoutId=-1,this._pointsBuilder.dispose()},remove:function(){this.groupGL.removeAll(),this._control.dispose()}});function z_(e){return e instanceof Array||(e=[e,e]),e}function ZF(e){e.registerChartView(YF),e.registerSeriesModel(HF),e.registerVisual(function(i){let r={};i.eachSeriesByType("graphGL",function(n){var a=n.getCategoriesData(),o=n.getData(),s={};a.each(function(l){var c=a.getName(l);s["ec-"+c]=l;var d=a.getItemModel(l),u=d.getModel("itemStyle").getItemStyle();u.fill||(u.fill=n.getColorFromPalette(c,r)),a.setItemVisual(l,"style",u);var h=["symbol","symbolSize","symbolKeepAspect"];for(let f=0;f<h.length;f++){var m=d.getShallow(h[f],!0);m!=null&&a.setItemVisual(l,h[f],m)}}),a.count()&&o.each(function(l){var c=o.getItemModel(l);let d=c.getShallow("category");if(d!=null){typeof d=="string"&&(d=s["ec-"+d]);var u=a.getItemVisual(d,"style"),h=o.ensureUniqueItemVisual(l,"style");Ee.extend(h,u);var m=["symbol","symbolSize","symbolKeepAspect"];for(let f=0;f<m.length;f++)o.setItemVisual(l,m[f],a.getItemVisual(d,m[f]))}})})}),e.registerVisual(function(i){i.eachSeriesByType("graphGL",function(r){var n=r.getGraph(),a=r.getEdgeData(),o=z_(r.get("edgeSymbol")),s=z_(r.get("edgeSymbolSize"));a.setVisual("drawType","stroke"),a.setVisual("fromSymbol",o&&o[0]),a.setVisual("toSymbol",o&&o[1]),a.setVisual("fromSymbolSize",s&&s[0]),a.setVisual("toSymbolSize",s&&s[1]),a.setVisual("style",r.getModel("lineStyle").getLineStyle()),a.each(function(l){var c=a.getItemModel(l),d=n.getEdgeByIndex(l),u=z_(c.getShallow("symbol",!0)),h=z_(c.getShallow("symbolSize",!0)),m=c.getModel("lineStyle").getLineStyle(),f=a.ensureUniqueItemVisual(l,"style");switch(Ee.extend(f,m),f.stroke){case"source":{var p=d.node1.getVisual("style");f.stroke=p&&p.fill;break}case"target":{var p=d.node2.getVisual("style");f.stroke=p&&p.fill;break}}u[0]&&d.setVisual("fromSymbol",u[0]),u[1]&&d.setVisual("toSymbol",u[1]),h[0]&&d.setVisual("fromSymbolSize",h[0]),h[1]&&d.setVisual("toSymbolSize",h[1])})})}),e.registerAction({type:"graphGLRoam",event:"graphglroam",update:"series.graphGL:roam"},function(i,r){r.eachComponent({mainType:"series",query:i},function(n){n.setView(i)})});function t(){}e.registerAction({type:"graphGLStartLayout",event:"graphgllayoutstarted",update:"series.graphGL:startLayout"},t),e.registerAction({type:"graphGLStopLayout",event:"graphgllayoutstopped",update:"series.graphGL:stopLayout"},t),e.registerAction({type:"graphGLFocusNodeAdjacency",event:"graphGLFocusNodeAdjacency",update:"series.graphGL:focusNodeAdjacency"},t),e.registerAction({type:"graphGLUnfocusNodeAdjacency",event:"graphGLUnfocusNodeAdjacency",update:"series.graphGL:unfocusNodeAdjacency"},t)}Ci(ZF);var KF=Pr.extend({type:"series.flowGL",dependencies:["geo","grid","bmap"],visualStyleAccessPath:"itemStyle",getInitialData:function(e,t){var i=this.get("coordinateSystem"),r=i==="geo"?["lng","lat"]:r0(i)||["x","y"];r.push("vx","vy");var n=$i.createDimensions(this.getSource(),{coordDimensions:r,encodeDefine:this.get("encode"),dimensionsDefine:this.get("dimensions")}),a=new en(n,this);return a.initData(this.getSource()),a},defaultOption:{coordinateSystem:"cartesian2d",zlevel:10,supersampling:1,particleType:"point",particleDensity:128,particleSize:1,particleSpeed:1,particleTrail:2,colorTexture:null,gridWidth:"auto",gridHeight:"auto",itemStyle:{color:"#fff",opacity:.8}}});var tW=Lt.extend(function(){return{dynamic:!0,attributes:{position:new Lt.Attribute("position","float",3,"POSITION")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setLineCount:function(e){var t=this.attributes,i=4*e,r=2*e;this.vertexCount!==i&&t.position.init(i),this.triangleCount!==r&&(r===0?this.indices=null:this.indices=this.vertexCount>65535?new Uint32Array(r*3):new Uint16Array(r*3))},addLine:function(e){var t=this._vertexOffset;this.attributes.position.set(t,[e[0],e[1],1]),this.attributes.position.set(t+1,[e[0],e[1],-1]),this.attributes.position.set(t+2,[e[0],e[1],2]),this.attributes.position.set(t+3,[e[0],e[1],-2]),this.setTriangleIndices(this._faceOffset++,[t,t+1,t+2]),this.setTriangleIndices(this._faceOffset++,[t+1,t+2,t+3]),this._vertexOffset+=4}}),QF=tW;var JF=`@export ecgl.vfParticle.particle.fragment

uniform sampler2D particleTexture;
uniform sampler2D spawnTexture;
uniform sampler2D velocityTexture;

uniform float deltaTime;
uniform float elapsedTime;

uniform float speedScaling : 1.0;

uniform vec2 textureSize;
uniform vec4 region : [0, 0, 1, 1];
uniform float firstFrameTime;

varying vec2 v_Texcoord;


void main()
{
 vec4 p = texture2D(particleTexture, v_Texcoord);
 bool spawn = false;
 if (p.w <= 0.0) {
 p = texture2D(spawnTexture, fract(v_Texcoord + elapsedTime / 10.0));
 p.w -= firstFrameTime;
 spawn = true;
 }
 vec2 v = texture2D(velocityTexture, fract(p.xy * region.zw + region.xy)).xy;
 v = (v - 0.5) * 2.0;
 p.z = length(v);
 p.xy += v * deltaTime / 10.0 * speedScaling;
 p.w -= deltaTime;

 if (spawn || p.xy != fract(p.xy)) {
 p.z = 0.0;
 }
 p.xy = fract(p.xy);

 gl_FragColor = p;
}
@end

@export ecgl.vfParticle.renderPoints.vertex

#define PI 3.1415926

attribute vec2 texcoord : TEXCOORD_0;

uniform sampler2D particleTexture;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

uniform float size : 1.0;

varying float v_Mag;
varying vec2 v_Uv;

void main()
{
 vec4 p = texture2D(particleTexture, texcoord);

 if (p.w > 0.0 && p.z > 1e-5) {
 gl_Position = worldViewProjection * vec4(p.xy * 2.0 - 1.0, 0.0, 1.0);
 }
 else {
 gl_Position = vec4(100000.0, 100000.0, 100000.0, 1.0);
 }

 v_Mag = p.z;
 v_Uv = p.xy;

 gl_PointSize = size;
}

@end

@export ecgl.vfParticle.renderPoints.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
uniform sampler2D gradientTexture;
uniform sampler2D colorTexture;
uniform sampler2D spriteTexture;

varying float v_Mag;
varying vec2 v_Uv;

void main()
{
 gl_FragColor = color;
#ifdef SPRITETEXTURE_ENABLED
 gl_FragColor *= texture2D(spriteTexture, gl_PointCoord);
 if (color.a == 0.0) {
 discard;
 }
#endif
#ifdef GRADIENTTEXTURE_ENABLED
 gl_FragColor *= texture2D(gradientTexture, vec2(v_Mag, 0.5));
#endif
#ifdef COLORTEXTURE_ENABLED
 gl_FragColor *= texture2D(colorTexture, v_Uv);
#endif
}

@end

@export ecgl.vfParticle.renderLines.vertex

#define PI 3.1415926

attribute vec3 position : POSITION;

uniform sampler2D particleTexture;
uniform sampler2D prevParticleTexture;

uniform float size : 1.0;
uniform vec4 vp: VIEWPORT;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

varying float v_Mag;
varying vec2 v_Uv;

@import clay.util.rand

void main()
{
 vec4 p = texture2D(particleTexture, position.xy);
 vec4 p2 = texture2D(prevParticleTexture, position.xy);

 p.xy = p.xy * 2.0 - 1.0;
 p2.xy = p2.xy * 2.0 - 1.0;

 if (p.w > 0.0 && p.z > 1e-5) {
 vec2 dir = normalize(p.xy - p2.xy);
 vec2 norm = vec2(dir.y / vp.z, -dir.x / vp.w) * sign(position.z) * size;
 if (abs(position.z) == 2.0) {
 gl_Position = vec4(p.xy + norm, 0.0, 1.0);
 v_Uv = p.xy;
 v_Mag = p.z;
 }
 else {
 gl_Position = vec4(p2.xy + norm, 0.0, 1.0);
 v_Mag = p2.z;
 v_Uv = p2.xy;
 }
 gl_Position = worldViewProjection * gl_Position;
 }
 else {
 gl_Position = vec4(100000.0, 100000.0, 100000.0, 1.0);
 }
}

@end

@export ecgl.vfParticle.renderLines.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
uniform sampler2D gradientTexture;
uniform sampler2D colorTexture;

varying float v_Mag;
varying vec2 v_Uv;

void main()
{
 gl_FragColor = color;
 #ifdef GRADIENTTEXTURE_ENABLED
 gl_FragColor *= texture2D(gradientTexture, vec2(v_Mag, 0.5));
#endif
#ifdef COLORTEXTURE_ENABLED
 gl_FragColor *= texture2D(colorTexture, v_Uv);
#endif
}

@end
`;Re.import(JF);function iW(e){var t=document.createElement("canvas");t.width=t.height=e;var i=t.getContext("2d");return i.fillStyle="#fff",i.arc(e/2,e/2,e/2,0,Math.PI*2),i.fill(),t}var UC=function(){this.motionBlurFactor=.99,this.vectorFieldTexture=new ct({type:qe.FLOAT,flipY:!1}),this.particleLife=[5,20],this._particleType="point",this._particleSize=1,this.particleColor=[1,1,1,1],this.particleSpeedScaling=1,this._thisFrameTexture=null,this._particlePass=null,this._spawnTexture=null,this._particleTexture0=null,this._particleTexture1=null,this._particlePointsMesh=null,this._surfaceFrameBuffer=null,this._elapsedTime=0,this._scene=null,this._camera=null,this._lastFrameTexture=null,this._supersampling=1,this._downsampleTextures=[],this._width=512,this._height=512,this.init()};UC.prototype={constructor:UC,init:function(){var e={type:qe.FLOAT,minFilter:qe.NEAREST,magFilter:qe.NEAREST,useMipmap:!1};this._spawnTexture=new ct(e),this._particleTexture0=new ct(e),this._particleTexture1=new ct(e),this._frameBuffer=new ki({depthBuffer:!1}),this._particlePass=new Oi({fragment:Re.source("ecgl.vfParticle.particle.fragment")}),this._particlePass.setUniform("velocityTexture",this.vectorFieldTexture),this._particlePass.setUniform("spawnTexture",this._spawnTexture),this._downsamplePass=new Oi({fragment:Re.source("clay.compositor.downsample")});var t=new cs({renderOrder:10,material:new $r({shader:new Re(Re.source("ecgl.vfParticle.renderPoints.vertex"),Re.source("ecgl.vfParticle.renderPoints.fragment"))}),mode:cs.POINTS,geometry:new Lt({dynamic:!0,mainAttribute:"texcoord0"})}),i=new cs({renderOrder:10,material:new $r({shader:new Re(Re.source("ecgl.vfParticle.renderLines.vertex"),Re.source("ecgl.vfParticle.renderLines.fragment"))}),geometry:new QF,culling:!1}),r=new cs({material:new $r({shader:new Re(Re.source("ecgl.color.vertex"),Re.source("ecgl.color.fragment"))}),geometry:new pc});r.material.enableTexture("diffuseMap"),this._particlePointsMesh=t,this._particleLinesMesh=i,this._lastFrameFullQuadMesh=r,this._camera=new us,this._thisFrameTexture=new ct,this._lastFrameTexture=new ct},setParticleDensity:function(e,t){for(var i=e*t,r=new Float32Array(i*4),n=0,a=this.particleLife,o=0;o<e;o++)for(var s=0;s<t;s++,n++){r[n*4]=Math.random(),r[n*4+1]=Math.random(),r[n*4+2]=Math.random();var l=(a[1]-a[0])*Math.random()+a[0];r[n*4+3]=l}this._particleType==="line"?this._setLineGeometry(e,t):this._setPointsGeometry(e,t),this._spawnTexture.width=e,this._spawnTexture.height=t,this._spawnTexture.pixels=r,this._particleTexture0.width=this._particleTexture1.width=e,this._particleTexture0.height=this._particleTexture1.height=t,this._particlePass.setUniform("textureSize",[e,t])},_setPointsGeometry:function(e,t){var i=e*t,r=this._particlePointsMesh.geometry,n=r.attributes;n.texcoord0.init(i);for(var a=0,o=0;o<e;o++)for(var s=0;s<t;s++,a++)n.texcoord0.value[a*2]=o/e,n.texcoord0.value[a*2+1]=s/t;r.dirty()},_setLineGeometry:function(e,t){var i=e*t,r=this._getParticleMesh().geometry;r.setLineCount(i),r.resetOffset();for(var n=0;n<e;n++)for(var a=0;a<t;a++)r.addLine([n/e,a/t]);r.dirty()},_getParticleMesh:function(){return this._particleType==="line"?this._particleLinesMesh:this._particlePointsMesh},update:function(e,t,i,r){var n=this._getParticleMesh(),a=this._frameBuffer,o=this._particlePass;r&&this._updateDownsampleTextures(e,t),n.material.set("size",this._particleSize*this._supersampling),n.material.set("color",this.particleColor),o.setUniform("speedScaling",this.particleSpeedScaling),a.attach(this._particleTexture1),o.setUniform("firstFrameTime",r?(this.particleLife[1]+this.particleLife[0])/2:0),o.setUniform("particleTexture",this._particleTexture0),o.setUniform("deltaTime",i),o.setUniform("elapsedTime",this._elapsedTime),o.render(e,a),n.material.set("particleTexture",this._particleTexture1),n.material.set("prevParticleTexture",this._particleTexture0),a.attach(this._thisFrameTexture),a.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT);var s=this._lastFrameFullQuadMesh;s.material.set("diffuseMap",this._lastFrameTexture),s.material.set("color",[1,1,1,this.motionBlurFactor]),this._camera.update(!0),e.renderPass([s,n],this._camera),a.unbind(e),this._downsample(e),this._swapTexture(),this._elapsedTime+=i},_downsample:function(e){var t=this._downsampleTextures;if(t.length!==0)for(var i=0,r=this._thisFrameTexture,n=t[i];n;)this._frameBuffer.attach(n),this._downsamplePass.setUniform("texture",r),this._downsamplePass.setUniform("textureSize",[r.width,r.height]),this._downsamplePass.render(e,this._frameBuffer),r=n,n=t[++i]},getSurfaceTexture:function(){var e=this._downsampleTextures;return e.length>0?e[e.length-1]:this._lastFrameTexture},setRegion:function(e){this._particlePass.setUniform("region",e)},resize:function(e,t){this._lastFrameTexture.width=e*this._supersampling,this._lastFrameTexture.height=t*this._supersampling,this._thisFrameTexture.width=e*this._supersampling,this._thisFrameTexture.height=t*this._supersampling,this._width=e,this._height=t},setParticleSize:function(e){var t=this._getParticleMesh();if(e<=2){t.material.disableTexture("spriteTexture"),t.material.transparent=!1;return}this._spriteTexture||(this._spriteTexture=new ct),(!this._spriteTexture.image||this._spriteTexture.image.width!==e)&&(this._spriteTexture.image=iW(e),this._spriteTexture.dirty()),t.material.transparent=!0,t.material.enableTexture("spriteTexture"),t.material.set("spriteTexture",this._spriteTexture),this._particleSize=e},setGradientTexture:function(e){var t=this._getParticleMesh().material;t[e?"enableTexture":"disableTexture"]("gradientTexture"),t.setUniform("gradientTexture",e)},setColorTextureImage:function(e,t){var i=this._getParticleMesh().material;i.setTextureImage("colorTexture",e,t,{flipY:!0})},setParticleType:function(e){this._particleType=e},clearFrame:function(e){var t=this._frameBuffer;t.attach(this._lastFrameTexture),t.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT),t.unbind(e)},setSupersampling:function(e){this._supersampling=e,this.resize(this._width,this._height)},_updateDownsampleTextures:function(e,t){for(var i=this._downsampleTextures,r=Math.max(Math.floor(Math.log(this._supersampling/t.getDevicePixelRatio())/Math.log(2)),0),n=2,a=this._width*this._supersampling,o=this._height*this._supersampling,s=0;s<r;s++)i[s]=i[s]||new ct,i[s].width=a/n,i[s].height=o/n,n*=2;for(;s<i.length;s++)i[s].dispose(e);i.length=r},_swapTexture:function(){var e=this._particleTexture0;this._particleTexture0=this._particleTexture1,this._particleTexture1=e;var e=this._thisFrameTexture;this._thisFrameTexture=this._lastFrameTexture,this._lastFrameTexture=e},dispose:function(e){e.disposeFrameBuffer(this._frameBuffer),e.disposeTexture(this.vectorFieldTexture),e.disposeTexture(this._spawnTexture),e.disposeTexture(this._particleTexture0),e.disposeTexture(this._particleTexture1),e.disposeTexture(this._thisFrameTexture),e.disposeTexture(this._lastFrameTexture),e.disposeGeometry(this._particleLinesMesh.geometry),e.disposeGeometry(this._particlePointsMesh.geometry),e.disposeGeometry(this._lastFrameFullQuadMesh.geometry),this._spriteTexture&&e.disposeTexture(this._spriteTexture),this._particlePass.dispose(e),this._downsamplePass.dispose(e),this._downsampleTextures.forEach(function(t){t.dispose(e)})}};var eO=UC;var tO=Rr.extend({type:"flowGL",__ecgl__:!0,init:function(e,t){this.viewGL=new Bn("orthographic"),this.groupGL=new R.Node,this.viewGL.add(this.groupGL),this._particleSurface=new eO;var i=new R.Mesh({geometry:new R.PlaneGeometry,material:new R.Material({shader:new R.Shader({vertex:R.Shader.source("ecgl.color.vertex"),fragment:R.Shader.source("ecgl.color.fragment")}),transparent:!0})});i.material.enableTexture("diffuseMap"),this.groupGL.add(i),this._planeMesh=i},render:function(e,t,i){var r=this._particleSurface;r.setParticleType(e.get("particleType")),r.setSupersampling(e.get("supersampling")),this._updateData(e,i),this._updateCamera(i.getWidth(),i.getHeight(),i.getDevicePixelRatio());var n=ht.firstNotNull(e.get("particleDensity"),128);r.setParticleDensity(n,n);var a=this._planeMesh,o=+new Date,s=this,l=!0;a.__percent=0,a.stopAnimation(),a.animate("",{loop:!0}).when(1e5,{__percent:1}).during(function(){var u=+new Date,h=Math.min(u-o,20);o=o+h,s._renderer&&(r.update(s._renderer,i,h/1e3,l),a.material.set("diffuseMap",r.getSurfaceTexture())),l=!1}).start();var c=e.getModel("itemStyle"),d=R.parseColor(c.get("color"));d[3]*=ht.firstNotNull(c.get("opacity"),1),a.material.set("color",d),r.setColorTextureImage(e.get("colorTexture"),i),r.setParticleSize(e.get("particleSize")),r.particleSpeedScaling=e.get("particleSpeed"),r.motionBlurFactor=1-Math.pow(.1,e.get("particleTrail"))},updateTransform:function(e,t,i){this._updateData(e,i)},afterRender:function(e,t,i,r){var n=r.renderer;this._renderer=n},_updateData:function(e,t){var i=e.coordinateSystem,r=i.dimensions.map(function(b){return e.coordDimToDataDim(b)[0]}),n=e.getData(),a=n.getDataExtent(r[0]),o=n.getDataExtent(r[1]),s=e.get("gridWidth"),l=e.get("gridHeight");if(s==null||s==="auto"){var c=(a[1]-a[0])/(o[1]-o[0]);s=Math.round(Math.sqrt(c*n.count()))}(l==null||l==="auto")&&(l=Math.ceil(n.count()/s));var d=this._particleSurface.vectorFieldTexture,u=d.pixels;if(!u||u.length!==l*s*4)u=d.pixels=new Float32Array(s*l*4);else for(var h=0;h<u.length;h++)u[h]=0;var m=0,f=1/0,p=new Float32Array(n.count()*2),g=0,v=[[1/0,1/0],[-1/0,-1/0]];n.each([r[0],r[1],"vx","vy"],function(b,_,x,w){var y=i.dataToPoint([b,_]);p[g++]=y[0],p[g++]=y[1],v[0][0]=Math.min(y[0],v[0][0]),v[0][1]=Math.min(y[1],v[0][1]),v[1][0]=Math.max(y[0],v[1][0]),v[1][1]=Math.max(y[1],v[1][1]);var M=Math.sqrt(x*x+w*w);m=Math.max(m,M),f=Math.min(f,M)}),n.each(["vx","vy"],function(b,_,x){var w=Math.round((p[x*2]-v[0][0])/(v[1][0]-v[0][0])*(s-1)),y=l-1-Math.round((p[x*2+1]-v[0][1])/(v[1][1]-v[0][1])*(l-1)),M=(y*s+w)*4;u[M]=b/m*.5+.5,u[M+1]=_/m*.5+.5,u[M+3]=1}),d.width=s,d.height=l,e.get("coordinateSystem")==="bmap"&&this._fillEmptyPixels(d),d.dirty(),this._updatePlanePosition(v[0],v[1],e,t),this._updateGradientTexture(n.getVisual("visualMeta"),[f,m])},_fillEmptyPixels:function(e){var t=e.pixels,i=e.width,r=e.height;function n(p,g,v){p=Math.max(Math.min(p,i-1),0),g=Math.max(Math.min(g,r-1),0);var b=(g*(i-1)+p)*4;return t[b+3]===0?!1:(v[0]=t[b],v[1]=t[b+1],!0)}function a(p,g,v){v[0]=p[0]+g[0],v[1]=p[1]+g[1]}for(var o=[],s=[],l=[],c=[],d=[],u=0,h=0;h<r;h++)for(var m=0;m<i;m++){var f=(h*(i-1)+m)*4;t[f+3]===0&&(u=o[0]=o[1]=0,n(m-1,h,s)&&(u++,a(s,o,o)),n(m+1,h,l)&&(u++,a(l,o,o)),n(m,h-1,c)&&(u++,a(c,o,o)),n(m,h+1,d)&&(u++,a(d,o,o)),o[0]/=u,o[1]/=u,t[f]=o[0],t[f+1]=o[1]),t[f+3]=1}},_updateGradientTexture:function(e,t){if(!e||!e.length){this._particleSurface.setGradientTexture(null);return}this._gradientTexture=this._gradientTexture||new R.Texture2D({image:document.createElement("canvas")});var i=this._gradientTexture,r=i.image;r.width=200,r.height=1;var n=r.getContext("2d"),a=n.createLinearGradient(0,.5,r.width,.5);e[0].stops.forEach(function(o){var s;t[1]===t[0]?s=0:(s=o.value/t[1],s=Math.min(Math.max(s,0),1)),a.addColorStop(s,o.color)}),n.fillStyle=a,n.fillRect(0,0,r.width,r.height),i.dirty(),this._particleSurface.setGradientTexture(this._gradientTexture)},_updatePlanePosition:function(e,t,i,r){var n=this._limitInViewportAndFullFill(e,t,i,r);e=n.leftTop,t=n.rightBottom,this._particleSurface.setRegion(n.region),this._planeMesh.position.set((e[0]+t[0])/2,r.getHeight()-(e[1]+t[1])/2,0);var a=t[0]-e[0],o=t[1]-e[1];this._planeMesh.scale.set(a/2,o/2,1),this._particleSurface.resize(Math.max(Math.min(a,2048),1),Math.max(Math.min(o,2048),1)),this._renderer&&this._particleSurface.clearFrame(this._renderer)},_limitInViewportAndFullFill:function(e,t,i,r){var n=[Math.max(e[0],0),Math.max(e[1],0)],a=[Math.min(t[0],r.getWidth()),Math.min(t[1],r.getHeight())];if(i.get("coordinateSystem")==="bmap"){var o=i.getData().getDataExtent(i.coordDimToDataDim("lng")[0]),s=Math.floor(o[1]-o[0])>=359;s&&(n[0]>0&&(n[0]=0),a[0]<r.getWidth()&&(a[0]=r.getWidth()))}var l=t[0]-e[0],c=t[1]-e[1],d=a[0]-n[0],u=a[1]-n[1],h=[(n[0]-e[0])/l,1-u/c-(n[1]-e[1])/c,d/l,u/c];return{leftTop:n,rightBottom:a,region:h}},_updateCamera:function(e,t,i){this.viewGL.setViewport(0,0,e,t,i);var r=this.viewGL.camera;r.left=r.bottom=0,r.top=t,r.right=e,r.near=0,r.far=100,r.position.z=10},remove:function(){this._planeMesh.stopAnimation(),this.groupGL.removeAll()},dispose:function(){this._renderer&&this._particleSurface.dispose(this._renderer),this.groupGL.removeAll()}});function iO(e){e.registerChartView(tO),e.registerSeriesModel(KF)}Ci(iO);var HC=Pr.extend({type:"series.linesGL",dependencies:["grid","geo"],visualStyleAccessPath:"lineStyle",visualDrawType:"stroke",streamEnabled:!0,init:function(e){var t=this._processFlatCoordsArray(e.data);this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset,t.flatCoords&&(e.data=new Float32Array(t.count)),HC.superApply(this,"init",arguments)},mergeOption:function(e){var t=this._processFlatCoordsArray(e.data);this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset,t.flatCoords&&(e.data=new Float32Array(t.count)),HC.superApply(this,"mergeOption",arguments)},appendData:function(e){var t=this._processFlatCoordsArray(e.data);t.flatCoords&&(this._flatCoords?(this._flatCoords=V1(this._flatCoords,t.flatCoords),this._flatCoordsOffset=V1(this._flatCoordsOffset,t.flatCoordsOffset)):(this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset),e.data=new Float32Array(t.count)),this.getRawData().appendData(e.data)},_getCoordsFromItemModel:function(e){var t=this.getData().getItemModel(e),i=t.option instanceof Array?t.option:t.getShallow("coords");return i},getLineCoordsCount:function(e){return this._flatCoordsOffset?this._flatCoordsOffset[e*2+1]:this._getCoordsFromItemModel(e).length},getLineCoords:function(e,t){if(this._flatCoordsOffset){for(var i=this._flatCoordsOffset[e*2],r=this._flatCoordsOffset[e*2+1],n=0;n<r;n++)t[n]=t[n]||[],t[n][0]=this._flatCoords[i+n*2],t[n][1]=this._flatCoords[i+n*2+1];return r}else{for(var a=this._getCoordsFromItemModel(e),n=0;n<a.length;n++)t[n]=t[n]||[],t[n][0]=a[n][0],t[n][1]=a[n][1];return a.length}},_processFlatCoordsArray:function(e){var t=0;if(this._flatCoords&&(t=this._flatCoords.length),typeof e[0]=="number"){for(var i=e.length,r=new Uint32Array(i),n=new Float64Array(i),a=0,o=0,s=0,l=0;l<i;){s++;var c=e[l++];r[o++]=a+t,r[o++]=c;for(var d=0;d<c;d++){var u=e[l++],h=e[l++];n[a++]=u,n[a++]=h,l>i}}return{flatCoordsOffset:new Uint32Array(r.buffer,0,o),flatCoords:n,count:s}}return{flatCoordsOffset:null,flatCoords:null,count:e.length}},getInitialData:function(e,t){var i=new en(["value"],this);return i.hasItemOption=!1,i.initData(e.data,[],function(r,n,a,o){if(r instanceof Array)return NaN;i.hasItemOption=!0;var s=r.value;if(s!=null)return s instanceof Array?s[o]:s}),i},defaultOption:{coordinateSystem:"geo",zlevel:10,progressive:1e4,progressiveThreshold:5e4,blendMode:"source-over",lineStyle:{opacity:.8},postEffect:{enable:!1,colorCorrection:{exposure:0,brightness:0,contrast:1,saturation:1,enable:!0}}}}),rO=HC;var nO=Rr.extend({type:"linesGL",__ecgl__:!0,init:function(e,t){this.groupGL=new R.Node,this.viewGL=new Bn("orthographic"),this.viewGL.add(this.groupGL),this._glViewHelper=new O_(this.viewGL),this._nativeLinesShader=R.createShader("ecgl.lines3D"),this._meshLinesShader=R.createShader("ecgl.meshLines3D"),this._linesMeshes=[],this._currentStep=0},render:function(e,t,i){this.groupGL.removeAll(),this._glViewHelper.reset(e,i);var r=this._linesMeshes[0];r||(r=this._linesMeshes[0]=this._createLinesMesh(e)),this._linesMeshes.length=1,this.groupGL.add(r),this._updateLinesMesh(e,r,0,e.getData().count()),this.viewGL.setPostEffect(e.getModel("postEffect"),i)},incrementalPrepareRender:function(e,t,i){this.groupGL.removeAll(),this._glViewHelper.reset(e,i),this._currentStep=0,this.viewGL.setPostEffect(e.getModel("postEffect"),i)},incrementalRender:function(e,t,i,r){var n=this._linesMeshes[this._currentStep];n||(n=this._createLinesMesh(t),this._linesMeshes[this._currentStep]=n),this._updateLinesMesh(t,n,e.start,e.end),this.groupGL.add(n),r.getZr().refresh(),this._currentStep++},updateTransform:function(e,t,i){e.coordinateSystem.getRoamTransform&&this._glViewHelper.updateTransform(e,i)},_createLinesMesh:function(e){var t=new R.Mesh({$ignorePicking:!0,material:new R.Material({shader:R.createShader("ecgl.lines3D"),transparent:!0,depthMask:!1,depthTest:!1}),geometry:new L_({segmentScale:10,useNativeLine:!0,dynamic:!1}),mode:R.Mesh.LINES,culling:!1});return t},_updateLinesMesh:function(e,t,i,r){var n=e.getData();t.material.blend=e.get("blendMode")==="lighter"?R.additiveBlend:null;var a=e.get("lineStyle.curveness")||0,o=e.get("polyline"),s=t.geometry,l=e.coordinateSystem,c=ht.firstNotNull(e.get("lineStyle.width"),1);c>1?(t.material.shader!==this._meshLinesShader&&t.material.attachShader(this._meshLinesShader),t.mode=R.Mesh.TRIANGLES):(t.material.shader!==this._nativeLinesShader&&t.material.attachShader(this._nativeLinesShader),t.mode=R.Mesh.LINES),i=i||0,r=r||n.count(),s.resetOffset();var d=0,u=0,h=[],m=[],f=[],p=[],g=[],v=.3,b=.7;function _(){m[0]=h[0]*b+p[0]*v-(h[1]-p[1])*a,m[1]=h[1]*b+p[1]*v-(p[0]-h[0])*a,f[0]=h[0]*v+p[0]*b-(h[1]-p[1])*a,f[1]=h[1]*v+p[1]*b-(p[0]-h[0])*a}if(o||a!==0)for(var x=i;x<r;x++)if(o){var w=e.getLineCoordsCount(x);d+=s.getPolylineVertexCount(w),u+=s.getPolylineTriangleCount(w)}else e.getLineCoords(x,g),this._glViewHelper.dataToPoint(l,g[0],h),this._glViewHelper.dataToPoint(l,g[1],p),_(),d+=s.getCubicCurveVertexCount(h,m,f,p),u+=s.getCubicCurveTriangleCount(h,m,f,p);else{var y=r-i;d+=y*s.getLineVertexCount(),u+=y*s.getLineVertexCount()}s.setVertexCount(d),s.setTriangleCount(u);for(var M=i,T=[],x=i;x<r;x++){R.parseColor(Gi(n,M),T);var C=ht.firstNotNull(Zi(n,M),1);T[3]*=C;for(var w=e.getLineCoords(x,g),N=0;N<w;N++)this._glViewHelper.dataToPoint(l,g[N],g[N]);o?s.addPolyline(g,T,c,0,w):a!==0?(h=g[0],p=g[1],_(),s.addCubicCurve(h,m,f,p,T,c)):s.addPolyline(g,T,c,0,2),M++}},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}});function aO(e){e.registerChartView(nO),e.registerSeriesModel(rO)}Ci(aO);var GC=class{constructor(){this.subject=new kw(1),this.subscriptions=new Nr}doFilter(t){this.subject.next(t)}dispose(){this.subscriptions.unsubscribe()}notEmpty(t,i){this.subscriptions.add(this.subject.subscribe(r=>{if(r[t]){let n=r[t].currentValue;n!=null&&i(n)}}))}has(t,i){this.subscriptions.add(this.subject.subscribe(r=>{if(r[t]){let n=r[t].currentValue;i(n)}}))}notFirst(t,i){this.subscriptions.add(this.subject.subscribe(r=>{if(r[t]&&!r[t].isFirstChange()){let n=r[t].currentValue;i(n)}}))}notFirstAndEmpty(t,i){this.subscriptions.add(this.subject.subscribe(r=>{if(r[t]&&!r[t].isFirstChange()){let n=r[t].currentValue;n!=null&&i(n)}}))}},oO=new Be("NGX_ECHARTS_CONFIG"),mn=(()=>{class e{constructor(i,r,n){this.el=r,this.ngZone=n,this.options=null,this.theme=null,this.initOpts=null,this.merge=null,this.autoResize=!0,this.loading=!1,this.loadingType="default",this.loadingOpts=null,this.chartInit=new Pe,this.optionsError=new Pe,this.chartClick=this.createLazyEvent("click"),this.chartDblClick=this.createLazyEvent("dblclick"),this.chartMouseDown=this.createLazyEvent("mousedown"),this.chartMouseMove=this.createLazyEvent("mousemove"),this.chartMouseUp=this.createLazyEvent("mouseup"),this.chartMouseOver=this.createLazyEvent("mouseover"),this.chartMouseOut=this.createLazyEvent("mouseout"),this.chartGlobalOut=this.createLazyEvent("globalout"),this.chartContextMenu=this.createLazyEvent("contextmenu"),this.chartHighlight=this.createLazyEvent("highlight"),this.chartDownplay=this.createLazyEvent("downplay"),this.chartSelectChanged=this.createLazyEvent("selectchanged"),this.chartLegendSelectChanged=this.createLazyEvent("legendselectchanged"),this.chartLegendSelected=this.createLazyEvent("legendselected"),this.chartLegendUnselected=this.createLazyEvent("legendunselected"),this.chartLegendLegendSelectAll=this.createLazyEvent("legendselectall"),this.chartLegendLegendInverseSelect=this.createLazyEvent("legendinverseselect"),this.chartLegendScroll=this.createLazyEvent("legendscroll"),this.chartDataZoom=this.createLazyEvent("datazoom"),this.chartDataRangeSelected=this.createLazyEvent("datarangeselected"),this.chartGraphRoam=this.createLazyEvent("graphroam"),this.chartGeoRoam=this.createLazyEvent("georoam"),this.chartTreeRoam=this.createLazyEvent("treeroam"),this.chartTimelineChanged=this.createLazyEvent("timelinechanged"),this.chartTimelinePlayChanged=this.createLazyEvent("timelineplaychanged"),this.chartRestore=this.createLazyEvent("restore"),this.chartDataViewChanged=this.createLazyEvent("dataviewchanged"),this.chartMagicTypeChanged=this.createLazyEvent("magictypechanged"),this.chartGeoSelectChanged=this.createLazyEvent("geoselectchanged"),this.chartGeoSelected=this.createLazyEvent("geoselected"),this.chartGeoUnselected=this.createLazyEvent("geounselected"),this.chartAxisAreaSelected=this.createLazyEvent("axisareaselected"),this.chartBrush=this.createLazyEvent("brush"),this.chartBrushEnd=this.createLazyEvent("brushend"),this.chartBrushSelected=this.createLazyEvent("brushselected"),this.chartGlobalCursorTaken=this.createLazyEvent("globalcursortaken"),this.chartRendered=this.createLazyEvent("rendered"),this.chartFinished=this.createLazyEvent("finished"),this.animationFrameID=null,this.chart$=new kw(1),this.resize$=new ut,this.changeFilter=new GC,this.resizeObFired=!1,this.echarts=i.echarts,this.theme=i.theme||null}ngOnChanges(i){this.changeFilter.doFilter(i)}ngOnInit(){if(!window.ResizeObserver)throw new Error("please install a polyfill for ResizeObserver");this.resizeSub=this.resize$.pipe(xM(100,pM,{leading:!1,trailing:!0})).subscribe(()=>this.resize()),this.autoResize&&(this.resizeOb=this.ngZone.runOutsideAngular(()=>new window.ResizeObserver(i=>{for(let r of i)r.target===this.el.nativeElement&&(this.resizeObFired?this.animationFrameID=window.requestAnimationFrame(()=>{this.resize$.next()}):this.resizeObFired=!0)})),this.resizeOb.observe(this.el.nativeElement)),this.changeFilter.notFirstAndEmpty("options",i=>this.onOptionsChange(i)),this.changeFilter.notFirstAndEmpty("merge",i=>this.setOption(i)),this.changeFilter.has("loading",i=>this.toggleLoading(!!i)),this.changeFilter.notFirst("theme",()=>this.refreshChart())}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&this.resizeSub.unsubscribe(),this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeOb&&this.resizeOb.unobserve(this.el.nativeElement),this.loadingSub&&this.loadingSub.unsubscribe(),this.changeFilter.dispose(),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.chart.resize()}toggleLoading(i){this.chart?i?this.chart.showLoading(this.loadingType,this.loadingOpts):this.chart.hideLoading():this.loadingSub=this.chart$.subscribe(r=>i?r.showLoading(this.loadingType,this.loadingOpts):r.hideLoading())}setOption(i,r){if(this.chart)try{this.chart.setOption(i,r)}catch(n){console.error(n),this.optionsError.emit(n)}}refreshChart(){return sl(this,null,function*(){this.dispose(),yield this.initChart()})}createChart(){let i=this.el.nativeElement;if(window&&window.getComputedStyle){let r=window.getComputedStyle(i,null).getPropertyValue("height");(!r||r==="0px")&&(!i.style.height||i.style.height==="0px")&&(i.style.height="400px")}return this.ngZone.runOutsideAngular(()=>(typeof this.echarts=="function"?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:n})=>n(i,this.theme,this.initOpts)))}initChart(){return sl(this,null,function*(){yield this.onOptionsChange(this.options),this.merge&&this.chart&&this.setOption(this.merge)})}onOptionsChange(i){return sl(this,null,function*(){i&&(this.chart?this.setOption(this.options,!0):(this.chart=yield this.createChart(),this.chart$.next(this.chart),this.chartInit.emit(this.chart),this.setOption(this.options,!0)))})}createLazyEvent(i){return this.chartInit.pipe(Wr(r=>new ns(n=>(r.on(i,a=>this.ngZone.run(()=>n.next(a))),()=>{this.chart&&(this.chart.isDisposed()||r.off(i))}))))}static{this.\u0275fac=function(r){return new(r||e)(z(oO),z(nt),z(Xe))}}static{this.\u0275dir=lt({type:e,selectors:[["echarts"],["","echarts",""]],inputs:{options:"options",theme:"theme",initOpts:"initOpts",merge:"merge",autoResize:"autoResize",loading:"loading",loadingType:"loadingType",loadingOpts:"loadingOpts"},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartHighlight:"chartHighlight",chartDownplay:"chartDownplay",chartSelectChanged:"chartSelectChanged",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendLegendSelectAll:"chartLegendLegendSelectAll",chartLegendLegendInverseSelect:"chartLegendLegendInverseSelect",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartGraphRoam:"chartGraphRoam",chartGeoRoam:"chartGeoRoam",chartTreeRoam:"chartTreeRoam",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartGeoSelectChanged:"chartGeoSelectChanged",chartGeoSelected:"chartGeoSelected",chartGeoUnselected:"chartGeoUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartGlobalCursorTaken:"chartGlobalCursorTaken",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],standalone:!0,features:[ir]})}}return e})();var rW=e=>({provide:oO,useValue:e}),sO=(()=>{class e{static forRoot(i){return{ngModule:e,providers:[rW(i)]}}static forChild(){return{ngModule:e}}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({})}}return e})();var lO=new RegExp(`(\\:not\\()|(([\\.\\#]?)[-\\w]+)|(?:\\[([-.\\w*\\\\$]+)(?:=(["']?)([^\\]"']*)\\5)?\\])|(\\))|(\\s*,\\s*)`,"g"),cm=class e{constructor(){this.element=null,this.classNames=[],this.attrs=[],this.notSelectors=[]}static parse(t){let i=[],r=(l,c)=>{c.notSelectors.length>0&&!c.element&&c.classNames.length==0&&c.attrs.length==0&&(c.element="*"),l.push(c)},n=new e,a,o=n,s=!1;for(lO.lastIndex=0;a=lO.exec(t);){if(a[1]){if(s)throw new Error("Nesting :not in a selector is not allowed");s=!0,o=new e,n.notSelectors.push(o)}let l=a[2];if(l){let d=a[3];d==="#"?o.addAttribute("id",l.slice(1)):d==="."?o.addClassName(l.slice(1)):o.setElement(l)}let c=a[4];if(c&&o.addAttribute(o.unescapeAttribute(c),a[6]),a[7]&&(s=!1,o=n),a[8]){if(s)throw new Error("Multiple selectors in :not are not supported");r(i,n),n=o=new e}}return r(i,n),i}unescapeAttribute(t){let i="",r=!1;for(let n=0;n<t.length;n++){let a=t.charAt(n);if(a==="\\"){r=!0;continue}if(a==="$"&&!r)throw new Error(`Error in attribute selector "${t}". Unescaped "$" is not supported. Please escape with "\\$".`);r=!1,i+=a}return i}escapeAttribute(t){return t.replace(/\\/g,"\\\\").replace(/\$/g,"\\$")}isElementSelector(){return this.hasElementSelector()&&this.classNames.length==0&&this.attrs.length==0&&this.notSelectors.length===0}hasElementSelector(){return!!this.element}setElement(t=null){this.element=t}getAttrs(){let t=[];return this.classNames.length>0&&t.push("class",this.classNames.join(" ")),t.concat(this.attrs)}addAttribute(t,i=""){this.attrs.push(t,i&&i.toLowerCase()||"")}addClassName(t){this.classNames.push(t.toLowerCase())}toString(){let t=this.element||"";if(this.classNames&&this.classNames.forEach(i=>t+=`.${i}`),this.attrs)for(let i=0;i<this.attrs.length;i+=2){let r=this.escapeAttribute(this.attrs[i]),n=this.attrs[i+1];t+=`[${r}${n?"="+n:""}]`}return this.notSelectors.forEach(i=>t+=`:not(${i})`),t}},nb=class e{constructor(){this._elementMap=new Map,this._elementPartialMap=new Map,this._classMap=new Map,this._classPartialMap=new Map,this._attrValueMap=new Map,this._attrValuePartialMap=new Map,this._listContexts=[]}static createNotMatcher(t){let i=new e;return i.addSelectables(t,null),i}addSelectables(t,i){let r=null;t.length>1&&(r=new pE(t),this._listContexts.push(r));for(let n=0;n<t.length;n++)this._addSelectable(t[n],i,r)}_addSelectable(t,i,r){let n=this,a=t.element,o=t.classNames,s=t.attrs,l=new fE(t,i,r);if(a&&(s.length===0&&o.length===0?this._addTerminal(n._elementMap,a,l):n=this._addPartial(n._elementPartialMap,a)),o)for(let c=0;c<o.length;c++){let d=s.length===0&&c===o.length-1,u=o[c];d?this._addTerminal(n._classMap,u,l):n=this._addPartial(n._classPartialMap,u)}if(s)for(let c=0;c<s.length;c+=2){let d=c===s.length-2,u=s[c],h=s[c+1];if(d){let m=n._attrValueMap,f=m.get(u);f||(f=new Map,m.set(u,f)),this._addTerminal(f,h,l)}else{let m=n._attrValuePartialMap,f=m.get(u);f||(f=new Map,m.set(u,f)),n=this._addPartial(f,h)}}}_addTerminal(t,i,r){let n=t.get(i);n||(n=[],t.set(i,n)),n.push(r)}_addPartial(t,i){let r=t.get(i);return r||(r=new e,t.set(i,r)),r}match(t,i){let r=!1,n=t.element,a=t.classNames,o=t.attrs;for(let s=0;s<this._listContexts.length;s++)this._listContexts[s].alreadyMatched=!1;if(r=this._matchTerminal(this._elementMap,n,t,i)||r,r=this._matchPartial(this._elementPartialMap,n,t,i)||r,a)for(let s=0;s<a.length;s++){let l=a[s];r=this._matchTerminal(this._classMap,l,t,i)||r,r=this._matchPartial(this._classPartialMap,l,t,i)||r}if(o)for(let s=0;s<o.length;s+=2){let l=o[s],c=o[s+1],d=this._attrValueMap.get(l);c&&(r=this._matchTerminal(d,"",t,i)||r),r=this._matchTerminal(d,c,t,i)||r;let u=this._attrValuePartialMap.get(l);c&&(r=this._matchPartial(u,"",t,i)||r),r=this._matchPartial(u,c,t,i)||r}return r}_matchTerminal(t,i,r,n){if(!t||typeof i!="string")return!1;let a=t.get(i)||[],o=t.get("*");if(o&&(a=a.concat(o)),a.length===0)return!1;let s,l=!1;for(let c=0;c<a.length;c++)s=a[c],l=s.finalize(r,n)||l;return l}_matchPartial(t,i,r,n){if(!t||typeof i!="string")return!1;let a=t.get(i);return a?a.match(r,n):!1}},pE=class{constructor(t){this.selectors=t,this.alreadyMatched=!1}},fE=class{constructor(t,i,r){this.selector=t,this.cbContext=i,this.listContext=r,this.notSelectors=t.notSelectors}finalize(t,i){let r=!0;return this.notSelectors.length>0&&(!this.listContext||!this.listContext.alreadyMatched)&&(r=!nb.createNotMatcher(this.notSelectors).match(t,null)),r&&i&&(!this.listContext||!this.listContext.alreadyMatched)&&(this.listContext&&(this.listContext.alreadyMatched=!0),i(this.selector,this.cbContext)),r}};var Qd=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(Qd||{}),iS=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(iS||{}),Qh=function(e){return e[e.None=0]="None",e[e.SignalBased=1]="SignalBased",e[e.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",e}(Qh||{}),cO={name:"custom-elements"},dO={name:"no-errors-schema"};var gi=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(gi||{});function nW(e){let t=e.classNames&&e.classNames.length?[8,...e.classNames]:[];return[e.element&&e.element!=="*"?e.element:"",...e.attrs,...t]}function aW(e){let t=e.classNames&&e.classNames.length?[8,...e.classNames]:[];return e.element?[5,e.element,...e.attrs,...t]:e.attrs.length?[3,...e.attrs,...t]:e.classNames&&e.classNames.length?[9,...e.classNames]:[]}function oW(e){let t=nW(e),i=e.notSelectors&&e.notSelectors.length?e.notSelectors.map(r=>aW(r)):[];return t.concat(...i)}function Cg(e){return e?cm.parse(e).map(oW):[]}var ab;function sW(e){return uW(dW(e.nodes).join("")+`[${e.meaning}]`)}function lW(e){return e.id||fL(e)}function fL(e){let t=new gE,i=e.nodes.map(r=>r.visit(t,null));return gL(i.join(""),e.meaning)}var ob=class{visitText(t,i){return t.value}visitContainer(t,i){return`[${t.children.map(r=>r.visit(this)).join(", ")}]`}visitIcu(t,i){let r=Object.keys(t.cases).map(n=>`${n} {${t.cases[n].visit(this)}}`);return`{${t.expression}, ${t.type}, ${r.join(", ")}}`}visitTagPlaceholder(t,i){return t.isVoid?`<ph tag name="${t.startName}"/>`:`<ph tag name="${t.startName}">${t.children.map(r=>r.visit(this)).join(", ")}</ph name="${t.closeName}">`}visitPlaceholder(t,i){return t.value?`<ph name="${t.name}">${t.value}</ph>`:`<ph name="${t.name}"/>`}visitIcuPlaceholder(t,i){return`<ph icu name="${t.name}">${t.value.visit(this)}</ph>`}visitBlockPlaceholder(t,i){return`<ph block name="${t.startName}">${t.children.map(r=>r.visit(this)).join(", ")}</ph name="${t.closeName}">`}},cW=new ob;function dW(e){return e.map(t=>t.visit(cW,null))}var gE=class extends ob{visitIcu(t,i){let r=Object.keys(t.cases).map(n=>`${n} {${t.cases[n].visit(this)}}`);return`{${t.type}, ${r.join(", ")}}`}};function uW(e){ab??=new TextEncoder;let t=[...ab.encode(e)],i=pW(t,rS.Big),r=t.length*8,n=new Uint32Array(80),a=1732584193,o=4023233417,s=2562383102,l=271733878,c=3285377520;i[r>>5]|=128<<24-r%32,i[(r+64>>9<<4)+15]=r;for(let d=0;d<i.length;d+=16){let u=a,h=o,m=s,f=l,p=c;for(let g=0;g<80;g++){g<16?n[g]=i[d+g]:n[g]=jC(n[g-3]^n[g-8]^n[g-14]^n[g-16],1);let v=hW(g,o,s,l),b=v[0],_=v[1],x=[jC(a,5),b,c,_,n[g]].reduce(Gh);c=l,l=s,s=jC(o,30),o=a,a=x}a=Gh(a,u),o=Gh(o,h),s=Gh(s,m),l=Gh(l,f),c=Gh(c,p)}return kf(a)+kf(o)+kf(s)+kf(l)+kf(c)}function kf(e){return(e>>>0).toString(16).padStart(8,"0")}function hW(e,t,i,r){return e<20?[t&i|~t&r,1518500249]:e<40?[t^i^r,1859775393]:e<60?[t&i|t&r|i&r,2400959708]:[t^i^r,3395469782]}function uO(e){ab??=new TextEncoder;let t=ab.encode(e),i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=hO(i,t.length,0),n=hO(i,t.length,102072);return r==0&&(n==0||n==1)&&(r=r^319790063,n=n^-1801410264),BigInt.asUintN(32,BigInt(r))<<BigInt(32)|BigInt.asUintN(32,BigInt(n))}function gL(e,t=""){let i=uO(e);return t&&(i=BigInt.asUintN(64,i<<BigInt(1))|i>>BigInt(63)&BigInt(1),i+=uO(t)),BigInt.asUintN(63,i).toString()}function hO(e,t,i){let r=2654435769,n=2654435769,a=0,o=t-12;for(;a<=o;a+=12){r+=e.getUint32(a,!0),n+=e.getUint32(a+4,!0),i+=e.getUint32(a+8,!0);let l=mO(r,n,i);r=l[0],n=l[1],i=l[2]}let s=t-a;return i+=t,s>=4?(r+=e.getUint32(a,!0),a+=4,s>=8?(n+=e.getUint32(a,!0),a+=4,s>=9&&(i+=e.getUint8(a++)<<8),s>=10&&(i+=e.getUint8(a++)<<16),s===11&&(i+=e.getUint8(a++)<<24)):(s>=5&&(n+=e.getUint8(a++)),s>=6&&(n+=e.getUint8(a++)<<8),s===7&&(n+=e.getUint8(a++)<<16))):(s>=1&&(r+=e.getUint8(a++)),s>=2&&(r+=e.getUint8(a++)<<8),s===3&&(r+=e.getUint8(a++)<<16)),mO(r,n,i)[2]}function mO(e,t,i){return e-=t,e-=i,e^=i>>>13,t-=i,t-=e,t^=e<<8,i-=e,i-=t,i^=t>>>13,e-=t,e-=i,e^=i>>>12,t-=i,t-=e,t^=e<<16,i-=e,i-=t,i^=t>>>5,e-=t,e-=i,e^=i>>>3,t-=i,t-=e,t^=e<<10,i-=e,i-=t,i^=t>>>15,[e,t,i]}var rS=function(e){return e[e.Little=0]="Little",e[e.Big=1]="Big",e}(rS||{});function Gh(e,t){return mW(e,t)[1]}function mW(e,t){let i=(e&65535)+(t&65535),r=(e>>>16)+(t>>>16)+(i>>>16);return[r>>>16,r<<16|i&65535]}function jC(e,t){return e<<t|e>>>32-t}function pW(e,t){let i=e.length+3>>>2,r=[];for(let n=0;n<i;n++)r[n]=fW(e,n*4,t);return r}function pO(e,t){return t>=e.length?0:e[t]}function fW(e,t,i){let r=0;if(i===rS.Big)for(let n=0;n<4;n++)r+=pO(e,t+n)<<24-8*n;else for(let n=0;n<4;n++)r+=pO(e,t+n)<<8*n;return r}var vL=function(e){return e[e.None=0]="None",e[e.Const=1]="Const",e}(vL||{}),sb=class{constructor(t=vL.None){this.modifiers=t}hasModifier(t){return(this.modifiers&t)!==0}},zl=function(e){return e[e.Dynamic=0]="Dynamic",e[e.Bool=1]="Bool",e[e.String=2]="String",e[e.Int=3]="Int",e[e.Number=4]="Number",e[e.Function=5]="Function",e[e.Inferred=6]="Inferred",e[e.None=7]="None",e}(zl||{}),zs=class extends sb{constructor(t,i){super(i),this.name=t}visitType(t,i){return t.visitBuiltinType(this,i)}},Ho=class extends sb{constructor(t,i,r=null){super(i),this.value=t,this.typeParams=r}visitType(t,i){return t.visitExpressionType(this,i)}};var Ul=new zs(zl.Dynamic),da=new zs(zl.Inferred),gW=new zs(zl.Bool),yke=new zs(zl.Int),Eg=new zs(zl.Number),nS=new zs(zl.String),wke=new zs(zl.Function),Us=new zs(zl.None),cu=function(e){return e[e.Minus=0]="Minus",e[e.Plus=1]="Plus",e}(cu||{}),ze=function(e){return e[e.Equals=0]="Equals",e[e.NotEquals=1]="NotEquals",e[e.Identical=2]="Identical",e[e.NotIdentical=3]="NotIdentical",e[e.Minus=4]="Minus",e[e.Plus=5]="Plus",e[e.Divide=6]="Divide",e[e.Multiply=7]="Multiply",e[e.Modulo=8]="Modulo",e[e.And=9]="And",e[e.Or=10]="Or",e[e.BitwiseOr=11]="BitwiseOr",e[e.BitwiseAnd=12]="BitwiseAnd",e[e.Lower=13]="Lower",e[e.LowerEquals=14]="LowerEquals",e[e.Bigger=15]="Bigger",e[e.BiggerEquals=16]="BiggerEquals",e[e.NullishCoalesce=17]="NullishCoalesce",e}(ze||{});function vW(e,t){return e==null||t==null?e==t:e.isEquivalent(t)}function _L(e,t,i){let r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(!i(e[n],t[n]))return!1;return!0}function so(e,t){return _L(e,t,(i,r)=>i.isEquivalent(r))}var Pi=class{constructor(t,i){this.type=t||null,this.sourceSpan=i||null}prop(t,i){return new ma(this,t,null,i)}key(t,i,r){return new Hs(this,t,i,r)}callFn(t,i,r){return new ha(this,t,null,i,r)}instantiate(t,i,r){return new Wf(this,t,i,r)}conditional(t,i=null,r){return new co(this,t,i,null,r)}equals(t,i){return new ci(ze.Equals,this,t,null,i)}notEquals(t,i){return new ci(ze.NotEquals,this,t,null,i)}identical(t,i){return new ci(ze.Identical,this,t,null,i)}notIdentical(t,i){return new ci(ze.NotIdentical,this,t,null,i)}minus(t,i){return new ci(ze.Minus,this,t,null,i)}plus(t,i){return new ci(ze.Plus,this,t,null,i)}divide(t,i){return new ci(ze.Divide,this,t,null,i)}multiply(t,i){return new ci(ze.Multiply,this,t,null,i)}modulo(t,i){return new ci(ze.Modulo,this,t,null,i)}and(t,i){return new ci(ze.And,this,t,null,i)}bitwiseOr(t,i,r=!0){return new ci(ze.BitwiseOr,this,t,null,i,r)}bitwiseAnd(t,i,r=!0){return new ci(ze.BitwiseAnd,this,t,null,i,r)}or(t,i){return new ci(ze.Or,this,t,null,i)}lower(t,i){return new ci(ze.Lower,this,t,null,i)}lowerEquals(t,i){return new ci(ze.LowerEquals,this,t,null,i)}bigger(t,i){return new ci(ze.Bigger,this,t,null,i)}biggerEquals(t,i){return new ci(ze.BiggerEquals,this,t,null,i)}isBlank(t){return this.equals(kc,t)}nullishCoalesce(t,i){return new ci(ze.NullishCoalesce,this,t,null,i)}toStmt(){return new bn(this,null)}},lo=class e extends Pi{constructor(t,i,r){super(i,r),this.name=t}isEquivalent(t){return t instanceof e&&this.name===t.name}isConstant(){return!1}visitExpression(t,i){return t.visitReadVarExpr(this,i)}clone(){return new e(this.name,this.type,this.sourceSpan)}set(t){return new lb(this.name,t,null,this.sourceSpan)}},dm=class e extends Pi{constructor(t,i,r){super(i,r),this.expr=t}visitExpression(t,i){return t.visitTypeofExpr(this,i)}isEquivalent(t){return t instanceof e&&t.expr.isEquivalent(this.expr)}isConstant(){return this.expr.isConstant()}clone(){return new e(this.expr.clone())}},di=class e extends Pi{constructor(t,i,r){super(i,r),this.node=t}isEquivalent(t){return t instanceof e&&this.node===t.node}isConstant(){return!1}visitExpression(t,i){return t.visitWrappedNodeExpr(this,i)}clone(){return new e(this.node,this.type,this.sourceSpan)}},lb=class e extends Pi{constructor(t,i,r,n){super(r||i.type,n),this.name=t,this.value=i}isEquivalent(t){return t instanceof e&&this.name===t.name&&this.value.isEquivalent(t.value)}isConstant(){return!1}visitExpression(t,i){return t.visitWriteVarExpr(this,i)}clone(){return new e(this.name,this.value.clone(),this.type,this.sourceSpan)}toDeclStmt(t,i){return new Wn(this.name,this.value,t,i,this.sourceSpan)}toConstDecl(){return this.toDeclStmt(da,Sn.Final)}},jf=class e extends Pi{constructor(t,i,r,n,a){super(n||r.type,a),this.receiver=t,this.index=i,this.value=r}isEquivalent(t){return t instanceof e&&this.receiver.isEquivalent(t.receiver)&&this.index.isEquivalent(t.index)&&this.value.isEquivalent(t.value)}isConstant(){return!1}visitExpression(t,i){return t.visitWriteKeyExpr(this,i)}clone(){return new e(this.receiver.clone(),this.index.clone(),this.value.clone(),this.type,this.sourceSpan)}},um=class e extends Pi{constructor(t,i,r,n,a){super(n||r.type,a),this.receiver=t,this.name=i,this.value=r}isEquivalent(t){return t instanceof e&&this.receiver.isEquivalent(t.receiver)&&this.name===t.name&&this.value.isEquivalent(t.value)}isConstant(){return!1}visitExpression(t,i){return t.visitWritePropExpr(this,i)}clone(){return new e(this.receiver.clone(),this.name,this.value.clone(),this.type,this.sourceSpan)}},ha=class e extends Pi{constructor(t,i,r,n,a=!1){super(r,n),this.fn=t,this.args=i,this.pure=a}get receiver(){return this.fn}isEquivalent(t){return t instanceof e&&this.fn.isEquivalent(t.fn)&&so(this.args,t.args)&&this.pure===t.pure}isConstant(){return!1}visitExpression(t,i){return t.visitInvokeFunctionExpr(this,i)}clone(){return new e(this.fn.clone(),this.args.map(t=>t.clone()),this.type,this.sourceSpan,this.pure)}},cb=class e extends Pi{constructor(t,i,r,n){super(r,n),this.tag=t,this.template=i}isEquivalent(t){return t instanceof e&&this.tag.isEquivalent(t.tag)&&_L(this.template.elements,t.template.elements,(i,r)=>i.text===r.text)&&so(this.template.expressions,t.template.expressions)}isConstant(){return!1}visitExpression(t,i){return t.visitTaggedTemplateExpr(this,i)}clone(){return new e(this.tag.clone(),this.template.clone(),this.type,this.sourceSpan)}},Wf=class e extends Pi{constructor(t,i,r,n){super(r,n),this.classExpr=t,this.args=i}isEquivalent(t){return t instanceof e&&this.classExpr.isEquivalent(t.classExpr)&&so(this.args,t.args)}isConstant(){return!1}visitExpression(t,i){return t.visitInstantiateExpr(this,i)}clone(){return new e(this.classExpr.clone(),this.args.map(t=>t.clone()),this.type,this.sourceSpan)}},_n=class e extends Pi{constructor(t,i,r){super(i,r),this.value=t}isEquivalent(t){return t instanceof e&&this.value===t.value}isConstant(){return!0}visitExpression(t,i){return t.visitLiteralExpr(this,i)}clone(){return new e(this.value,this.type,this.sourceSpan)}},qf=class e{constructor(t,i){this.elements=t,this.expressions=i}clone(){return new e(this.elements.map(t=>t.clone()),this.expressions.map(t=>t.clone()))}},$f=class e{constructor(t,i,r){this.text=t,this.sourceSpan=i,this.rawText=r??i?.toString()??vE(eb(t))}clone(){return new e(this.text,this.sourceSpan,this.rawText)}},nu=class{constructor(t,i){this.text=t,this.sourceSpan=i}},om=class{constructor(t,i,r){this.text=t,this.sourceSpan=i,this.associatedMessage=r}},_W="|",fO="@@",bW="\u241F",db=class e extends Pi{constructor(t,i,r,n,a){super(nS,a),this.metaBlock=t,this.messageParts=i,this.placeHolderNames=r,this.expressions=n}isEquivalent(t){return!1}isConstant(){return!1}visitExpression(t,i){return t.visitLocalizedString(this,i)}clone(){return new e(this.metaBlock,this.messageParts,this.placeHolderNames,this.expressions.map(t=>t.clone()),this.sourceSpan)}serializeI18nHead(){let t=this.metaBlock.description||"";return this.metaBlock.meaning&&(t=`${this.metaBlock.meaning}${_W}${t}`),this.metaBlock.customId&&(t=`${t}${fO}${this.metaBlock.customId}`),this.metaBlock.legacyIds&&this.metaBlock.legacyIds.forEach(i=>{t=`${t}${bW}${i}`}),gO(t,this.messageParts[0].text,this.getMessagePartSourceSpan(0))}getMessagePartSourceSpan(t){return this.messageParts[t]?.sourceSpan??this.sourceSpan}getPlaceholderSourceSpan(t){return this.placeHolderNames[t]?.sourceSpan??this.expressions[t]?.sourceSpan??this.sourceSpan}serializeI18nTemplatePart(t){let i=this.placeHolderNames[t-1],r=this.messageParts[t],n=i.text;return i.associatedMessage?.legacyIds.length===0&&(n+=`${fO}${gL(i.associatedMessage.messageString,i.associatedMessage.meaning)}`),gO(n,r.text,this.getMessagePartSourceSpan(t))}},eb=e=>e.replace(/\\/g,"\\\\"),xW=e=>e.replace(/^:/,"\\:"),yW=e=>e.replace(/:/g,"\\:"),vE=e=>e.replace(/`/g,"\\`").replace(/\${/g,"$\\{");function gO(e,t,i){return e===""?{cooked:t,raw:vE(xW(eb(t))),range:i}:{cooked:`:${e}:${t}`,raw:vE(`:${yW(eb(e))}:${eb(t)}`),range:i}}var Il=class e extends Pi{constructor(t,i,r=null,n){super(i,n),this.value=t,this.typeParams=r}isEquivalent(t){return t instanceof e&&this.value.name===t.value.name&&this.value.moduleName===t.value.moduleName&&this.value.runtime===t.value.runtime}isConstant(){return!1}visitExpression(t,i){return t.visitExternalExpr(this,i)}clone(){return new e(this.value,this.type,this.typeParams,this.sourceSpan)}};var co=class e extends Pi{constructor(t,i,r=null,n,a){super(n||i.type,a),this.condition=t,this.falseCase=r,this.trueCase=i}isEquivalent(t){return t instanceof e&&this.condition.isEquivalent(t.condition)&&this.trueCase.isEquivalent(t.trueCase)&&vW(this.falseCase,t.falseCase)}isConstant(){return!1}visitExpression(t,i){return t.visitConditionalExpr(this,i)}clone(){return new e(this.condition.clone(),this.trueCase.clone(),this.falseCase?.clone(),this.type,this.sourceSpan)}},Xf=class e extends Pi{constructor(t,i){super(null,i),this.url=t}isEquivalent(t){return t instanceof e&&this.url===t.url}isConstant(){return!1}visitExpression(t,i){return t.visitDynamicImportExpr(this,i)}clone(){return new e(this.url,this.sourceSpan)}},kl=class e extends Pi{constructor(t,i){super(gW,i),this.condition=t}isEquivalent(t){return t instanceof e&&this.condition.isEquivalent(t.condition)}isConstant(){return!1}visitExpression(t,i){return t.visitNotExpr(this,i)}clone(){return new e(this.condition.clone(),this.sourceSpan)}},er=class e{constructor(t,i=null){this.name=t,this.type=i}isEquivalent(t){return this.name===t.name}clone(){return new e(this.name,this.type)}},du=class e extends Pi{constructor(t,i,r,n,a){super(r,n),this.params=t,this.statements=i,this.name=a}isEquivalent(t){return(t instanceof e||t instanceof Yf)&&so(this.params,t.params)&&so(this.statements,t.statements)}isConstant(){return!1}visitExpression(t,i){return t.visitFunctionExpr(this,i)}toDeclStmt(t,i){return new Yf(t,this.params,this.statements,this.type,i,this.sourceSpan)}clone(){return new e(this.params.map(t=>t.clone()),this.statements,this.type,this.sourceSpan,this.name)}},uu=class e extends Pi{constructor(t,i,r,n){super(r,n),this.params=t,this.body=i}isEquivalent(t){return!(t instanceof e)||!so(this.params,t.params)?!1:this.body instanceof Pi&&t.body instanceof Pi?this.body.isEquivalent(t.body):Array.isArray(this.body)&&Array.isArray(t.body)?so(this.body,t.body):!1}isConstant(){return!1}visitExpression(t,i){return t.visitArrowFunctionExpr(this,i)}clone(){return new e(this.params.map(t=>t.clone()),Array.isArray(this.body)?this.body:this.body.clone(),this.type,this.sourceSpan)}toDeclStmt(t,i){return new Wn(t,this,da,i,this.sourceSpan)}},hu=class e extends Pi{constructor(t,i,r,n,a=!0){super(r||Eg,n),this.operator=t,this.expr=i,this.parens=a}isEquivalent(t){return t instanceof e&&this.operator===t.operator&&this.expr.isEquivalent(t.expr)}isConstant(){return!1}visitExpression(t,i){return t.visitUnaryOperatorExpr(this,i)}clone(){return new e(this.operator,this.expr.clone(),this.type,this.sourceSpan,this.parens)}},ci=class e extends Pi{constructor(t,i,r,n,a,o=!0){super(n||i.type,a),this.operator=t,this.rhs=r,this.parens=o,this.lhs=i}isEquivalent(t){return t instanceof e&&this.operator===t.operator&&this.lhs.isEquivalent(t.lhs)&&this.rhs.isEquivalent(t.rhs)}isConstant(){return!1}visitExpression(t,i){return t.visitBinaryOperatorExpr(this,i)}clone(){return new e(this.operator,this.lhs.clone(),this.rhs.clone(),this.type,this.sourceSpan,this.parens)}},ma=class e extends Pi{constructor(t,i,r,n){super(r,n),this.receiver=t,this.name=i}get index(){return this.name}isEquivalent(t){return t instanceof e&&this.receiver.isEquivalent(t.receiver)&&this.name===t.name}isConstant(){return!1}visitExpression(t,i){return t.visitReadPropExpr(this,i)}set(t){return new um(this.receiver,this.name,t,null,this.sourceSpan)}clone(){return new e(this.receiver.clone(),this.name,this.type,this.sourceSpan)}},Hs=class e extends Pi{constructor(t,i,r,n){super(r,n),this.receiver=t,this.index=i}isEquivalent(t){return t instanceof e&&this.receiver.isEquivalent(t.receiver)&&this.index.isEquivalent(t.index)}isConstant(){return!1}visitExpression(t,i){return t.visitReadKeyExpr(this,i)}set(t){return new jf(this.receiver,this.index,t,null,this.sourceSpan)}clone(){return new e(this.receiver.clone(),this.index.clone(),this.type,this.sourceSpan)}},Go=class e extends Pi{constructor(t,i,r){super(i,r),this.entries=t}isConstant(){return this.entries.every(t=>t.isConstant())}isEquivalent(t){return t instanceof e&&so(this.entries,t.entries)}visitExpression(t,i){return t.visitLiteralArrayExpr(this,i)}clone(){return new e(this.entries.map(t=>t.clone()),this.type,this.sourceSpan)}},hm=class e{constructor(t,i,r){this.key=t,this.value=i,this.quoted=r}isEquivalent(t){return this.key===t.key&&this.value.isEquivalent(t.value)}clone(){return new e(this.key,this.value.clone(),this.quoted)}},fs=class e extends Pi{constructor(t,i,r){super(i,r),this.entries=t,this.valueType=null,i&&(this.valueType=i.valueType)}isEquivalent(t){return t instanceof e&&so(this.entries,t.entries)}isConstant(){return this.entries.every(t=>t.value.isConstant())}visitExpression(t,i){return t.visitLiteralMapExpr(this,i)}clone(){let t=this.entries.map(i=>i.clone());return new e(t,this.type,this.sourceSpan)}};var mu=new _n(null,null,null),kc=new _n(null,da,null),Sn=function(e){return e[e.None=0]="None",e[e.Final=1]="Final",e[e.Private=2]="Private",e[e.Exported=4]="Exported",e[e.Static=8]="Static",e}(Sn||{}),_E=class{constructor(t,i,r){this.text=t,this.multiline=i,this.trailingNewline=r}toString(){return this.multiline?` ${this.text} `:this.text}},ub=class extends _E{constructor(t){super("",!0,!0),this.tags=t}toString(){return EW(this.tags)}},pu=class{constructor(t=Sn.None,i=null,r){this.modifiers=t,this.sourceSpan=i,this.leadingComments=r}hasModifier(t){return(this.modifiers&t)!==0}addLeadingComment(t){this.leadingComments=this.leadingComments??[],this.leadingComments.push(t)}},Wn=class e extends pu{constructor(t,i,r,n,a,o){super(n,a,o),this.name=t,this.value=i,this.type=r||i&&i.type||null}isEquivalent(t){return t instanceof e&&this.name===t.name&&(this.value?!!t.value&&this.value.isEquivalent(t.value):!t.value)}visitStatement(t,i){return t.visitDeclareVarStmt(this,i)}},Yf=class e extends pu{constructor(t,i,r,n,a,o,s){super(a,o,s),this.name=t,this.params=i,this.statements=r,this.type=n||null}isEquivalent(t){return t instanceof e&&so(this.params,t.params)&&so(this.statements,t.statements)}visitStatement(t,i){return t.visitDeclareFunctionStmt(this,i)}},bn=class e extends pu{constructor(t,i,r){super(Sn.None,i,r),this.expr=t}isEquivalent(t){return t instanceof e&&this.expr.isEquivalent(t.expr)}visitStatement(t,i){return t.visitExpressionStmt(this,i)}},Jr=class e extends pu{constructor(t,i=null,r){super(Sn.None,i,r),this.value=t}isEquivalent(t){return t instanceof e&&this.value.isEquivalent(t.value)}visitStatement(t,i){return t.visitReturnStmt(this,i)}},hb=class e extends pu{constructor(t,i,r=[],n,a){super(Sn.None,n,a),this.condition=t,this.trueCase=i,this.falseCase=r}isEquivalent(t){return t instanceof e&&this.condition.isEquivalent(t.condition)&&so(this.trueCase,t.trueCase)&&so(this.falseCase,t.falseCase)}visitStatement(t,i){return t.visitIfStmt(this,i)}};function wW(e=[]){return new ub(e)}function et(e,t,i){return new lo(e,t,i)}function Le(e,t=null,i){return new Il(e,null,t,i)}function An(e,t,i){return new Ho(e,t,i)}function Sg(e){return new dm(e)}function zt(e,t,i){return new Go(e,t,i)}function xn(e,t=null){return new fs(e.map(i=>new hm(i.key,i.value,i.quoted)),t,null)}function bL(e,t){return new kl(e,t)}function Gs(e,t,i,r,n){return new du(e,t,i,r,n)}function vn(e,t,i,r){return new uu(e,t,i,r)}function Ag(e,t,i,r,n){return new hb(e,t,i,r,n)}function bE(e,t,i,r){return new cb(e,t,i,r)}function L(e,t,i){return new _n(e,t,i)}function CW(e,t,i,r,n){return new db(e,t,i,r,n)}function xL(e){return e instanceof _n&&e.value===null}function vO(e){let t="";if(e.tagName&&(t+=` @${e.tagName}`),e.text){if(e.text.match(/\/\*|\*\//))throw new Error('JSDoc text cannot contain "/*" and "*/"');t+=" "+e.text.replace(/@/g,"\\@")}return t}function EW(e){if(e.length===0)return"";if(e.length===1&&e[0].tagName&&!e[0].text)return`*${vO(e[0])} `;let t=`*
`;for(let i of e)t+=" *",t+=vO(i).replace(/\n/g,`
 * `),t+=`
`;return t+=" ",t}var SW="_c",_O=et("<unknown>"),AW={},TW=50,mb=class e extends Pi{constructor(t){super(t.type),this.resolved=t,this.shared=!1,this.original=t}visitExpression(t,i){return i===AW?this.original.visitExpression(t,i):this.resolved.visitExpression(t,i)}isEquivalent(t){return t instanceof e&&this.resolved.isEquivalent(t.resolved)}isConstant(){return!0}clone(){throw new Error("Not supported.")}fixup(t){this.resolved=t,this.shared=!0}},pb=class{constructor(t=!1){this.isClosureCompilerEnabled=t,this.statements=[],this.literals=new Map,this.literalFactories=new Map,this.sharedConstants=new Map,this._claimedNames=new Map,this.nextNameIndex=0}getConstLiteral(t,i){if(t instanceof _n&&!bO(t)||t instanceof mb)return t;let r=sm.INSTANCE.keyOf(t),n=this.literals.get(r),a=!1;if(n||(n=new mb(t),this.literals.set(r,n),a=!0),!a&&!n.shared||a&&i){let o=this.freshName(),s,l;this.isClosureCompilerEnabled&&bO(t)?(s=et(o).set(new du([],[new Jr(t)])),l=et(o).callFn([])):(s=et(o).set(t),l=et(o)),this.statements.push(s.toDeclStmt(da,Sn.Final)),n.fixup(l)}return n}getSharedConstant(t,i){let r=t.keyOf(i);if(!this.sharedConstants.has(r)){let n=this.freshName();this.sharedConstants.set(r,et(n)),this.statements.push(t.toSharedConstantDeclaration(n,i))}return this.sharedConstants.get(r)}getLiteralFactory(t){if(t instanceof Go){let i=t.entries.map(n=>n.isConstant()?n:_O),r=sm.INSTANCE.keyOf(zt(i));return this._getLiteralFactory(r,t.entries,n=>zt(n))}else{let i=xn(t.entries.map(n=>({key:n.key,value:n.value.isConstant()?n.value:_O,quoted:n.quoted}))),r=sm.INSTANCE.keyOf(i);return this._getLiteralFactory(r,t.entries.map(n=>n.value),n=>xn(n.map((a,o)=>({key:t.entries[o].key,value:a,quoted:t.entries[o].quoted}))))}}getSharedFunctionReference(t,i,r=!0){let n=t instanceof uu;for(let o of this.statements)if(n&&o instanceof Wn&&o.value?.isEquivalent(t)||!n&&o instanceof Yf&&t.isEquivalent(o))return et(o.name);let a=r?this.uniqueName(i):i;return this.statements.push(t.toDeclStmt(a,Sn.Final)),et(a)}_getLiteralFactory(t,i,r){let n=this.literalFactories.get(t),a=i.filter(o=>!o.isConstant());if(!n){let o=i.map((d,u)=>d.isConstant()?this.getConstLiteral(d,!0):et(`a${u}`)),s=o.filter(DW).map(d=>new er(d.name,Ul)),l=vn(s,r(o),da),c=this.freshName();this.statements.push(et(c).set(l).toDeclStmt(da,Sn.Final)),n=et(c),this.literalFactories.set(t,n)}return{literalFactory:n,literalFactoryArguments:a}}uniqueName(t,i=!0){let r=this._claimedNames.get(t)??0,n=r===0&&!i?`${t}`:`${t}${r}`;return this._claimedNames.set(t,r+1),n}freshName(){return this.uniqueName(SW)}},sm=class e{static{this.INSTANCE=new e}keyOf(t){if(t instanceof _n&&typeof t.value=="string")return`"${t.value}"`;if(t instanceof _n)return String(t.value);if(t instanceof Go){let i=[];for(let r of t.entries)i.push(this.keyOf(r));return`[${i.join(",")}]`}else if(t instanceof fs){let i=[];for(let r of t.entries){let n=r.key;r.quoted&&(n=`"${n}"`),i.push(n+":"+this.keyOf(r.value))}return`{${i.join(",")}}`}else{if(t instanceof Il)return`import("${t.value.moduleName}", ${t.value.name})`;if(t instanceof lo)return`read(${t.name})`;if(t instanceof dm)return`typeof(${this.keyOf(t.expr)})`;throw new Error(`${this.constructor.name} does not handle expressions of type ${t.constructor.name}`)}}};function DW(e){return e instanceof lo}function bO(e){return e instanceof _n&&typeof e.value=="string"&&e.value.length>=TW}var X="@angular/core",E=(()=>{class e{static{this.NEW_METHOD="factory"}static{this.TRANSFORM_METHOD="transform"}static{this.PATCH_DEPS="patchedDeps"}static{this.core={name:null,moduleName:X}}static{this.namespaceHTML={name:"\u0275\u0275namespaceHTML",moduleName:X}}static{this.namespaceMathML={name:"\u0275\u0275namespaceMathML",moduleName:X}}static{this.namespaceSVG={name:"\u0275\u0275namespaceSVG",moduleName:X}}static{this.element={name:"\u0275\u0275element",moduleName:X}}static{this.elementStart={name:"\u0275\u0275elementStart",moduleName:X}}static{this.elementEnd={name:"\u0275\u0275elementEnd",moduleName:X}}static{this.advance={name:"\u0275\u0275advance",moduleName:X}}static{this.syntheticHostProperty={name:"\u0275\u0275syntheticHostProperty",moduleName:X}}static{this.syntheticHostListener={name:"\u0275\u0275syntheticHostListener",moduleName:X}}static{this.attribute={name:"\u0275\u0275attribute",moduleName:X}}static{this.attributeInterpolate1={name:"\u0275\u0275attributeInterpolate1",moduleName:X}}static{this.attributeInterpolate2={name:"\u0275\u0275attributeInterpolate2",moduleName:X}}static{this.attributeInterpolate3={name:"\u0275\u0275attributeInterpolate3",moduleName:X}}static{this.attributeInterpolate4={name:"\u0275\u0275attributeInterpolate4",moduleName:X}}static{this.attributeInterpolate5={name:"\u0275\u0275attributeInterpolate5",moduleName:X}}static{this.attributeInterpolate6={name:"\u0275\u0275attributeInterpolate6",moduleName:X}}static{this.attributeInterpolate7={name:"\u0275\u0275attributeInterpolate7",moduleName:X}}static{this.attributeInterpolate8={name:"\u0275\u0275attributeInterpolate8",moduleName:X}}static{this.attributeInterpolateV={name:"\u0275\u0275attributeInterpolateV",moduleName:X}}static{this.classProp={name:"\u0275\u0275classProp",moduleName:X}}static{this.elementContainerStart={name:"\u0275\u0275elementContainerStart",moduleName:X}}static{this.elementContainerEnd={name:"\u0275\u0275elementContainerEnd",moduleName:X}}static{this.elementContainer={name:"\u0275\u0275elementContainer",moduleName:X}}static{this.styleMap={name:"\u0275\u0275styleMap",moduleName:X}}static{this.styleMapInterpolate1={name:"\u0275\u0275styleMapInterpolate1",moduleName:X}}static{this.styleMapInterpolate2={name:"\u0275\u0275styleMapInterpolate2",moduleName:X}}static{this.styleMapInterpolate3={name:"\u0275\u0275styleMapInterpolate3",moduleName:X}}static{this.styleMapInterpolate4={name:"\u0275\u0275styleMapInterpolate4",moduleName:X}}static{this.styleMapInterpolate5={name:"\u0275\u0275styleMapInterpolate5",moduleName:X}}static{this.styleMapInterpolate6={name:"\u0275\u0275styleMapInterpolate6",moduleName:X}}static{this.styleMapInterpolate7={name:"\u0275\u0275styleMapInterpolate7",moduleName:X}}static{this.styleMapInterpolate8={name:"\u0275\u0275styleMapInterpolate8",moduleName:X}}static{this.styleMapInterpolateV={name:"\u0275\u0275styleMapInterpolateV",moduleName:X}}static{this.classMap={name:"\u0275\u0275classMap",moduleName:X}}static{this.classMapInterpolate1={name:"\u0275\u0275classMapInterpolate1",moduleName:X}}static{this.classMapInterpolate2={name:"\u0275\u0275classMapInterpolate2",moduleName:X}}static{this.classMapInterpolate3={name:"\u0275\u0275classMapInterpolate3",moduleName:X}}static{this.classMapInterpolate4={name:"\u0275\u0275classMapInterpolate4",moduleName:X}}static{this.classMapInterpolate5={name:"\u0275\u0275classMapInterpolate5",moduleName:X}}static{this.classMapInterpolate6={name:"\u0275\u0275classMapInterpolate6",moduleName:X}}static{this.classMapInterpolate7={name:"\u0275\u0275classMapInterpolate7",moduleName:X}}static{this.classMapInterpolate8={name:"\u0275\u0275classMapInterpolate8",moduleName:X}}static{this.classMapInterpolateV={name:"\u0275\u0275classMapInterpolateV",moduleName:X}}static{this.styleProp={name:"\u0275\u0275styleProp",moduleName:X}}static{this.stylePropInterpolate1={name:"\u0275\u0275stylePropInterpolate1",moduleName:X}}static{this.stylePropInterpolate2={name:"\u0275\u0275stylePropInterpolate2",moduleName:X}}static{this.stylePropInterpolate3={name:"\u0275\u0275stylePropInterpolate3",moduleName:X}}static{this.stylePropInterpolate4={name:"\u0275\u0275stylePropInterpolate4",moduleName:X}}static{this.stylePropInterpolate5={name:"\u0275\u0275stylePropInterpolate5",moduleName:X}}static{this.stylePropInterpolate6={name:"\u0275\u0275stylePropInterpolate6",moduleName:X}}static{this.stylePropInterpolate7={name:"\u0275\u0275stylePropInterpolate7",moduleName:X}}static{this.stylePropInterpolate8={name:"\u0275\u0275stylePropInterpolate8",moduleName:X}}static{this.stylePropInterpolateV={name:"\u0275\u0275stylePropInterpolateV",moduleName:X}}static{this.nextContext={name:"\u0275\u0275nextContext",moduleName:X}}static{this.resetView={name:"\u0275\u0275resetView",moduleName:X}}static{this.templateCreate={name:"\u0275\u0275template",moduleName:X}}static{this.defer={name:"\u0275\u0275defer",moduleName:X}}static{this.deferWhen={name:"\u0275\u0275deferWhen",moduleName:X}}static{this.deferOnIdle={name:"\u0275\u0275deferOnIdle",moduleName:X}}static{this.deferOnImmediate={name:"\u0275\u0275deferOnImmediate",moduleName:X}}static{this.deferOnTimer={name:"\u0275\u0275deferOnTimer",moduleName:X}}static{this.deferOnHover={name:"\u0275\u0275deferOnHover",moduleName:X}}static{this.deferOnInteraction={name:"\u0275\u0275deferOnInteraction",moduleName:X}}static{this.deferOnViewport={name:"\u0275\u0275deferOnViewport",moduleName:X}}static{this.deferPrefetchWhen={name:"\u0275\u0275deferPrefetchWhen",moduleName:X}}static{this.deferPrefetchOnIdle={name:"\u0275\u0275deferPrefetchOnIdle",moduleName:X}}static{this.deferPrefetchOnImmediate={name:"\u0275\u0275deferPrefetchOnImmediate",moduleName:X}}static{this.deferPrefetchOnTimer={name:"\u0275\u0275deferPrefetchOnTimer",moduleName:X}}static{this.deferPrefetchOnHover={name:"\u0275\u0275deferPrefetchOnHover",moduleName:X}}static{this.deferPrefetchOnInteraction={name:"\u0275\u0275deferPrefetchOnInteraction",moduleName:X}}static{this.deferPrefetchOnViewport={name:"\u0275\u0275deferPrefetchOnViewport",moduleName:X}}static{this.deferEnableTimerScheduling={name:"\u0275\u0275deferEnableTimerScheduling",moduleName:X}}static{this.conditional={name:"\u0275\u0275conditional",moduleName:X}}static{this.repeater={name:"\u0275\u0275repeater",moduleName:X}}static{this.repeaterCreate={name:"\u0275\u0275repeaterCreate",moduleName:X}}static{this.repeaterTrackByIndex={name:"\u0275\u0275repeaterTrackByIndex",moduleName:X}}static{this.repeaterTrackByIdentity={name:"\u0275\u0275repeaterTrackByIdentity",moduleName:X}}static{this.componentInstance={name:"\u0275\u0275componentInstance",moduleName:X}}static{this.text={name:"\u0275\u0275text",moduleName:X}}static{this.enableBindings={name:"\u0275\u0275enableBindings",moduleName:X}}static{this.disableBindings={name:"\u0275\u0275disableBindings",moduleName:X}}static{this.getCurrentView={name:"\u0275\u0275getCurrentView",moduleName:X}}static{this.textInterpolate={name:"\u0275\u0275textInterpolate",moduleName:X}}static{this.textInterpolate1={name:"\u0275\u0275textInterpolate1",moduleName:X}}static{this.textInterpolate2={name:"\u0275\u0275textInterpolate2",moduleName:X}}static{this.textInterpolate3={name:"\u0275\u0275textInterpolate3",moduleName:X}}static{this.textInterpolate4={name:"\u0275\u0275textInterpolate4",moduleName:X}}static{this.textInterpolate5={name:"\u0275\u0275textInterpolate5",moduleName:X}}static{this.textInterpolate6={name:"\u0275\u0275textInterpolate6",moduleName:X}}static{this.textInterpolate7={name:"\u0275\u0275textInterpolate7",moduleName:X}}static{this.textInterpolate8={name:"\u0275\u0275textInterpolate8",moduleName:X}}static{this.textInterpolateV={name:"\u0275\u0275textInterpolateV",moduleName:X}}static{this.restoreView={name:"\u0275\u0275restoreView",moduleName:X}}static{this.pureFunction0={name:"\u0275\u0275pureFunction0",moduleName:X}}static{this.pureFunction1={name:"\u0275\u0275pureFunction1",moduleName:X}}static{this.pureFunction2={name:"\u0275\u0275pureFunction2",moduleName:X}}static{this.pureFunction3={name:"\u0275\u0275pureFunction3",moduleName:X}}static{this.pureFunction4={name:"\u0275\u0275pureFunction4",moduleName:X}}static{this.pureFunction5={name:"\u0275\u0275pureFunction5",moduleName:X}}static{this.pureFunction6={name:"\u0275\u0275pureFunction6",moduleName:X}}static{this.pureFunction7={name:"\u0275\u0275pureFunction7",moduleName:X}}static{this.pureFunction8={name:"\u0275\u0275pureFunction8",moduleName:X}}static{this.pureFunctionV={name:"\u0275\u0275pureFunctionV",moduleName:X}}static{this.pipeBind1={name:"\u0275\u0275pipeBind1",moduleName:X}}static{this.pipeBind2={name:"\u0275\u0275pipeBind2",moduleName:X}}static{this.pipeBind3={name:"\u0275\u0275pipeBind3",moduleName:X}}static{this.pipeBind4={name:"\u0275\u0275pipeBind4",moduleName:X}}static{this.pipeBindV={name:"\u0275\u0275pipeBindV",moduleName:X}}static{this.hostProperty={name:"\u0275\u0275hostProperty",moduleName:X}}static{this.property={name:"\u0275\u0275property",moduleName:X}}static{this.propertyInterpolate={name:"\u0275\u0275propertyInterpolate",moduleName:X}}static{this.propertyInterpolate1={name:"\u0275\u0275propertyInterpolate1",moduleName:X}}static{this.propertyInterpolate2={name:"\u0275\u0275propertyInterpolate2",moduleName:X}}static{this.propertyInterpolate3={name:"\u0275\u0275propertyInterpolate3",moduleName:X}}static{this.propertyInterpolate4={name:"\u0275\u0275propertyInterpolate4",moduleName:X}}static{this.propertyInterpolate5={name:"\u0275\u0275propertyInterpolate5",moduleName:X}}static{this.propertyInterpolate6={name:"\u0275\u0275propertyInterpolate6",moduleName:X}}static{this.propertyInterpolate7={name:"\u0275\u0275propertyInterpolate7",moduleName:X}}static{this.propertyInterpolate8={name:"\u0275\u0275propertyInterpolate8",moduleName:X}}static{this.propertyInterpolateV={name:"\u0275\u0275propertyInterpolateV",moduleName:X}}static{this.i18n={name:"\u0275\u0275i18n",moduleName:X}}static{this.i18nAttributes={name:"\u0275\u0275i18nAttributes",moduleName:X}}static{this.i18nExp={name:"\u0275\u0275i18nExp",moduleName:X}}static{this.i18nStart={name:"\u0275\u0275i18nStart",moduleName:X}}static{this.i18nEnd={name:"\u0275\u0275i18nEnd",moduleName:X}}static{this.i18nApply={name:"\u0275\u0275i18nApply",moduleName:X}}static{this.i18nPostprocess={name:"\u0275\u0275i18nPostprocess",moduleName:X}}static{this.pipe={name:"\u0275\u0275pipe",moduleName:X}}static{this.projection={name:"\u0275\u0275projection",moduleName:X}}static{this.projectionDef={name:"\u0275\u0275projectionDef",moduleName:X}}static{this.reference={name:"\u0275\u0275reference",moduleName:X}}static{this.inject={name:"\u0275\u0275inject",moduleName:X}}static{this.injectAttribute={name:"\u0275\u0275injectAttribute",moduleName:X}}static{this.directiveInject={name:"\u0275\u0275directiveInject",moduleName:X}}static{this.invalidFactory={name:"\u0275\u0275invalidFactory",moduleName:X}}static{this.invalidFactoryDep={name:"\u0275\u0275invalidFactoryDep",moduleName:X}}static{this.templateRefExtractor={name:"\u0275\u0275templateRefExtractor",moduleName:X}}static{this.forwardRef={name:"forwardRef",moduleName:X}}static{this.resolveForwardRef={name:"resolveForwardRef",moduleName:X}}static{this.\u0275\u0275defineInjectable={name:"\u0275\u0275defineInjectable",moduleName:X}}static{this.declareInjectable={name:"\u0275\u0275ngDeclareInjectable",moduleName:X}}static{this.InjectableDeclaration={name:"\u0275\u0275InjectableDeclaration",moduleName:X}}static{this.resolveWindow={name:"\u0275\u0275resolveWindow",moduleName:X}}static{this.resolveDocument={name:"\u0275\u0275resolveDocument",moduleName:X}}static{this.resolveBody={name:"\u0275\u0275resolveBody",moduleName:X}}static{this.getComponentDepsFactory={name:"\u0275\u0275getComponentDepsFactory",moduleName:X}}static{this.defineComponent={name:"\u0275\u0275defineComponent",moduleName:X}}static{this.declareComponent={name:"\u0275\u0275ngDeclareComponent",moduleName:X}}static{this.setComponentScope={name:"\u0275\u0275setComponentScope",moduleName:X}}static{this.ChangeDetectionStrategy={name:"ChangeDetectionStrategy",moduleName:X}}static{this.ViewEncapsulation={name:"ViewEncapsulation",moduleName:X}}static{this.ComponentDeclaration={name:"\u0275\u0275ComponentDeclaration",moduleName:X}}static{this.FactoryDeclaration={name:"\u0275\u0275FactoryDeclaration",moduleName:X}}static{this.declareFactory={name:"\u0275\u0275ngDeclareFactory",moduleName:X}}static{this.FactoryTarget={name:"\u0275\u0275FactoryTarget",moduleName:X}}static{this.defineDirective={name:"\u0275\u0275defineDirective",moduleName:X}}static{this.declareDirective={name:"\u0275\u0275ngDeclareDirective",moduleName:X}}static{this.DirectiveDeclaration={name:"\u0275\u0275DirectiveDeclaration",moduleName:X}}static{this.InjectorDef={name:"\u0275\u0275InjectorDef",moduleName:X}}static{this.InjectorDeclaration={name:"\u0275\u0275InjectorDeclaration",moduleName:X}}static{this.defineInjector={name:"\u0275\u0275defineInjector",moduleName:X}}static{this.declareInjector={name:"\u0275\u0275ngDeclareInjector",moduleName:X}}static{this.NgModuleDeclaration={name:"\u0275\u0275NgModuleDeclaration",moduleName:X}}static{this.ModuleWithProviders={name:"ModuleWithProviders",moduleName:X}}static{this.defineNgModule={name:"\u0275\u0275defineNgModule",moduleName:X}}static{this.declareNgModule={name:"\u0275\u0275ngDeclareNgModule",moduleName:X}}static{this.setNgModuleScope={name:"\u0275\u0275setNgModuleScope",moduleName:X}}static{this.registerNgModuleType={name:"\u0275\u0275registerNgModuleType",moduleName:X}}static{this.PipeDeclaration={name:"\u0275\u0275PipeDeclaration",moduleName:X}}static{this.definePipe={name:"\u0275\u0275definePipe",moduleName:X}}static{this.declarePipe={name:"\u0275\u0275ngDeclarePipe",moduleName:X}}static{this.declareClassMetadata={name:"\u0275\u0275ngDeclareClassMetadata",moduleName:X}}static{this.setClassMetadata={name:"\u0275setClassMetadata",moduleName:X}}static{this.setClassMetadataAsync={name:"\u0275setClassMetadataAsync",moduleName:X}}static{this.setClassDebugInfo={name:"\u0275setClassDebugInfo",moduleName:X}}static{this.queryRefresh={name:"\u0275\u0275queryRefresh",moduleName:X}}static{this.viewQuery={name:"\u0275\u0275viewQuery",moduleName:X}}static{this.loadQuery={name:"\u0275\u0275loadQuery",moduleName:X}}static{this.contentQuery={name:"\u0275\u0275contentQuery",moduleName:X}}static{this.viewQuerySignal={name:"\u0275\u0275viewQuerySignal",moduleName:X}}static{this.contentQuerySignal={name:"\u0275\u0275contentQuerySignal",moduleName:X}}static{this.queryAdvance={name:"\u0275\u0275queryAdvance",moduleName:X}}static{this.twoWayProperty={name:"\u0275\u0275twoWayProperty",moduleName:X}}static{this.twoWayBindingSet={name:"\u0275\u0275twoWayBindingSet",moduleName:X}}static{this.twoWayListener={name:"\u0275\u0275twoWayListener",moduleName:X}}static{this.NgOnChangesFeature={name:"\u0275\u0275NgOnChangesFeature",moduleName:X}}static{this.InheritDefinitionFeature={name:"\u0275\u0275InheritDefinitionFeature",moduleName:X}}static{this.CopyDefinitionFeature={name:"\u0275\u0275CopyDefinitionFeature",moduleName:X}}static{this.StandaloneFeature={name:"\u0275\u0275StandaloneFeature",moduleName:X}}static{this.ProvidersFeature={name:"\u0275\u0275ProvidersFeature",moduleName:X}}static{this.HostDirectivesFeature={name:"\u0275\u0275HostDirectivesFeature",moduleName:X}}static{this.InputTransformsFeatureFeature={name:"\u0275\u0275InputTransformsFeature",moduleName:X}}static{this.listener={name:"\u0275\u0275listener",moduleName:X}}static{this.getInheritedFactory={name:"\u0275\u0275getInheritedFactory",moduleName:X}}static{this.InputFlags={name:"\u0275\u0275InputFlags",moduleName:X}}static{this.sanitizeHtml={name:"\u0275\u0275sanitizeHtml",moduleName:X}}static{this.sanitizeStyle={name:"\u0275\u0275sanitizeStyle",moduleName:X}}static{this.sanitizeResourceUrl={name:"\u0275\u0275sanitizeResourceUrl",moduleName:X}}static{this.sanitizeScript={name:"\u0275\u0275sanitizeScript",moduleName:X}}static{this.sanitizeUrl={name:"\u0275\u0275sanitizeUrl",moduleName:X}}static{this.sanitizeUrlOrResourceUrl={name:"\u0275\u0275sanitizeUrlOrResourceUrl",moduleName:X}}static{this.trustConstantHtml={name:"\u0275\u0275trustConstantHtml",moduleName:X}}static{this.trustConstantResourceUrl={name:"\u0275\u0275trustConstantResourceUrl",moduleName:X}}static{this.validateIframeAttribute={name:"\u0275\u0275validateIframeAttribute",moduleName:X}}static{this.InputSignalBrandWriteType={name:"\u0275INPUT_SIGNAL_BRAND_WRITE_TYPE",moduleName:X}}static{this.UnwrapDirectiveSignalInputs={name:"\u0275UnwrapDirectiveSignalInputs",moduleName:X}}static{this.unwrapWritableSignal={name:"\u0275unwrapWritableSignal",moduleName:X}}}return e})(),MW=/-+([a-z0-9])/g;function IW(e){return e.replace(MW,(...t)=>t[1].toUpperCase())}function kW(e,t){return yL(e,":",t)}function NW(e,t){return yL(e,".",t)}function yL(e,t,i){let r=e.indexOf(t);return r==-1?i:[e.slice(0,r).trim(),e.slice(r+1).trim()]}function fb(e){throw new Error(`Internal Error: ${e}`)}function PW(e){let t=[];for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);if(r>=55296&&r<=56319&&e.length>i+1){let n=e.charCodeAt(i+1);n>=56320&&n<=57343&&(i++,r=(r-55296<<10)+n-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,r&63|128):r<=65535?t.push(r>>12|224,r>>6&63|128,r&63|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,r&63|128)}return t}function wL(e){if(typeof e=="string")return e;if(Array.isArray(e))return"["+e.map(wL).join(", ")+"]";if(e==null)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;if(!e.toString)return"object";let t=e.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i===-1?t:t.substring(0,i)}var xE=class{constructor(t){this.full=t;let i=t.split(".");this.major=i[0],this.minor=i[1],this.patch=i.slice(2).join(".")}},Bf=globalThis;function RW(e,t){let i=[],r=[];for(let n of e)(t(n)?i:r).push(n);return[i,r]}var FW=3,OW="# sourceMappingURL=data:application/json;base64,",yE=class{constructor(t=null){this.file=t,this.sourcesContent=new Map,this.lines=[],this.lastCol0=0,this.hasMappings=!1}addSource(t,i=null){return this.sourcesContent.has(t)||this.sourcesContent.set(t,i),this}addLine(){return this.lines.push([]),this.lastCol0=0,this}addMapping(t,i,r,n){if(!this.currentLine)throw new Error("A line must be added before mappings can be added");if(i!=null&&!this.sourcesContent.has(i))throw new Error(`Unknown source file "${i}"`);if(t==null)throw new Error("The column in the generated code must be provided");if(t<this.lastCol0)throw new Error("Mapping should be added in output order");if(i&&(r==null||n==null))throw new Error("The source location must be provided when a source url is provided");return this.hasMappings=!0,this.lastCol0=t,this.currentLine.push({col0:t,sourceUrl:i,sourceLine0:r,sourceCol0:n}),this}get currentLine(){return this.lines.slice(-1)[0]}toJSON(){if(!this.hasMappings)return null;let t=new Map,i=[],r=[];Array.from(this.sourcesContent.keys()).forEach((c,d)=>{t.set(c,d),i.push(c),r.push(this.sourcesContent.get(c)||null)});let n="",a=0,o=0,s=0,l=0;return this.lines.forEach(c=>{a=0,n+=c.map(d=>{let u=U_(d.col0-a);return a=d.col0,d.sourceUrl!=null&&(u+=U_(t.get(d.sourceUrl)-o),o=t.get(d.sourceUrl),u+=U_(d.sourceLine0-s),s=d.sourceLine0,u+=U_(d.sourceCol0-l),l=d.sourceCol0),u}).join(","),n+=";"}),n=n.slice(0,-1),{file:this.file||"",version:FW,sourceRoot:"",sources:i,sourcesContent:r,mappings:n}}toJsComment(){return this.hasMappings?"//"+OW+LW(JSON.stringify(this,null,0)):""}};function LW(e){let t="",i=PW(e);for(let r=0;r<i.length;){let n=i[r++],a=r<i.length?i[r++]:null,o=r<i.length?i[r++]:null;t+=Rf(n>>2),t+=Rf((n&3)<<4|(a===null?0:a>>4)),t+=a===null?"=":Rf((a&15)<<2|(o===null?0:o>>6)),t+=a===null||o===null?"=":Rf(o&63)}return t}function U_(e){e=e<0?(-e<<1)+1:e<<1;let t="";do{let i=e&31;e=e>>5,e>0&&(i=i|32),t+=Rf(i)}while(e>0);return t}var BW="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Rf(e){if(e<0||e>=64)throw new Error("Can only encode value in the range [0, 63]");return BW[e]}var VW=/'|\\|\n|\r|\$/g,zW=/^[$A-Z_][0-9A-Z_$]*$/i,wE="  ",gb=class{constructor(t){this.indent=t,this.partsLength=0,this.parts=[],this.srcSpans=[]}},CE=class e{static createRoot(){return new e(0)}constructor(t){this._indent=t,this._lines=[new gb(t)]}get _currentLine(){return this._lines[this._lines.length-1]}println(t,i=""){this.print(t||null,i,!0)}lineIsEmpty(){return this._currentLine.parts.length===0}lineLength(){return this._currentLine.indent*wE.length+this._currentLine.partsLength}print(t,i,r=!1){i.length>0&&(this._currentLine.parts.push(i),this._currentLine.partsLength+=i.length,this._currentLine.srcSpans.push(t&&t.sourceSpan||null)),r&&this._lines.push(new gb(this._indent))}removeEmptyLastLine(){this.lineIsEmpty()&&this._lines.pop()}incIndent(){this._indent++,this.lineIsEmpty()&&(this._currentLine.indent=this._indent)}decIndent(){this._indent--,this.lineIsEmpty()&&(this._currentLine.indent=this._indent)}toSource(){return this.sourceLines.map(t=>t.parts.length>0?xO(t.indent)+t.parts.join(""):"").join(`
`)}toSourceMapGenerator(t,i=0){let r=new yE(t),n=!1,a=()=>{n||(r.addSource(t," ").addMapping(0,t,0,0),n=!0)};for(let o=0;o<i;o++)r.addLine(),a();return this.sourceLines.forEach((o,s)=>{r.addLine();let l=o.srcSpans,c=o.parts,d=o.indent*wE.length,u=0;for(;u<l.length&&!l[u];)d+=c[u].length,u++;for(u<l.length&&s===0&&d===0?n=!0:a();u<l.length;){let h=l[u],m=h.start.file,f=h.start.line,p=h.start.col;for(r.addSource(m.url,m.content).addMapping(d,m.url,f,p),d+=c[u].length,u++;u<l.length&&(h===l[u]||!l[u]);)d+=c[u].length,u++}}),r}spanOf(t,i){let r=this._lines[t];if(r){let n=i-xO(r.indent).length;for(let a=0;a<r.parts.length;a++){let o=r.parts[a];if(o.length>n)return r.srcSpans[a];n-=o.length}}return null}get sourceLines(){return this._lines.length&&this._lines[this._lines.length-1].parts.length===0?this._lines.slice(0,-1):this._lines}},EE=class{constructor(t){this._escapeDollarInStrings=t}printLeadingComments(t,i){if(t.leadingComments!==void 0)for(let r of t.leadingComments)r instanceof ub?i.print(t,`/*${r.toString()}*/`,r.trailingNewline):r.multiline?i.print(t,`/* ${r.text} */`,r.trailingNewline):r.text.split(`
`).forEach(n=>{i.println(t,`// ${n}`)})}visitExpressionStmt(t,i){return this.printLeadingComments(t,i),t.expr.visitExpression(this,i),i.println(t,";"),null}visitReturnStmt(t,i){return this.printLeadingComments(t,i),i.print(t,"return "),t.value.visitExpression(this,i),i.println(t,";"),null}visitIfStmt(t,i){this.printLeadingComments(t,i),i.print(t,"if ("),t.condition.visitExpression(this,i),i.print(t,") {");let r=t.falseCase!=null&&t.falseCase.length>0;return t.trueCase.length<=1&&!r?(i.print(t," "),this.visitAllStatements(t.trueCase,i),i.removeEmptyLastLine(),i.print(t," ")):(i.println(),i.incIndent(),this.visitAllStatements(t.trueCase,i),i.decIndent(),r&&(i.println(t,"} else {"),i.incIndent(),this.visitAllStatements(t.falseCase,i),i.decIndent())),i.println(t,"}"),null}visitWriteVarExpr(t,i){let r=i.lineIsEmpty();return r||i.print(t,"("),i.print(t,`${t.name} = `),t.value.visitExpression(this,i),r||i.print(t,")"),null}visitWriteKeyExpr(t,i){let r=i.lineIsEmpty();return r||i.print(t,"("),t.receiver.visitExpression(this,i),i.print(t,"["),t.index.visitExpression(this,i),i.print(t,"] = "),t.value.visitExpression(this,i),r||i.print(t,")"),null}visitWritePropExpr(t,i){let r=i.lineIsEmpty();return r||i.print(t,"("),t.receiver.visitExpression(this,i),i.print(t,`.${t.name} = `),t.value.visitExpression(this,i),r||i.print(t,")"),null}visitInvokeFunctionExpr(t,i){let r=t.fn instanceof uu;return r&&i.print(t.fn,"("),t.fn.visitExpression(this,i),r&&i.print(t.fn,")"),i.print(t,"("),this.visitAllExpressions(t.args,i,","),i.print(t,")"),null}visitTaggedTemplateExpr(t,i){t.tag.visitExpression(this,i),i.print(t,"`"+t.template.elements[0].rawText);for(let r=1;r<t.template.elements.length;r++)i.print(t,"${"),t.template.expressions[r-1].visitExpression(this,i),i.print(t,`}${t.template.elements[r].rawText}`);return i.print(t,"`"),null}visitWrappedNodeExpr(t,i){throw new Error("Abstract emitter cannot visit WrappedNodeExpr.")}visitTypeofExpr(t,i){i.print(t,"typeof "),t.expr.visitExpression(this,i)}visitReadVarExpr(t,i){return i.print(t,t.name),null}visitInstantiateExpr(t,i){return i.print(t,"new "),t.classExpr.visitExpression(this,i),i.print(t,"("),this.visitAllExpressions(t.args,i,","),i.print(t,")"),null}visitLiteralExpr(t,i){let r=t.value;return typeof r=="string"?i.print(t,tu(r,this._escapeDollarInStrings)):i.print(t,`${r}`),null}visitLocalizedString(t,i){let r=t.serializeI18nHead();i.print(t,"$localize `"+r.raw);for(let n=1;n<t.messageParts.length;n++)i.print(t,"${"),t.expressions[n-1].visitExpression(this,i),i.print(t,`}${t.serializeI18nTemplatePart(n).raw}`);return i.print(t,"`"),null}visitConditionalExpr(t,i){return i.print(t,"("),t.condition.visitExpression(this,i),i.print(t,"? "),t.trueCase.visitExpression(this,i),i.print(t,": "),t.falseCase.visitExpression(this,i),i.print(t,")"),null}visitDynamicImportExpr(t,i){i.print(t,`import(${t.url})`)}visitNotExpr(t,i){return i.print(t,"!"),t.condition.visitExpression(this,i),null}visitUnaryOperatorExpr(t,i){let r;switch(t.operator){case cu.Plus:r="+";break;case cu.Minus:r="-";break;default:throw new Error(`Unknown operator ${t.operator}`)}return t.parens&&i.print(t,"("),i.print(t,r),t.expr.visitExpression(this,i),t.parens&&i.print(t,")"),null}visitBinaryOperatorExpr(t,i){let r;switch(t.operator){case ze.Equals:r="==";break;case ze.Identical:r="===";break;case ze.NotEquals:r="!=";break;case ze.NotIdentical:r="!==";break;case ze.And:r="&&";break;case ze.BitwiseOr:r="|";break;case ze.BitwiseAnd:r="&";break;case ze.Or:r="||";break;case ze.Plus:r="+";break;case ze.Minus:r="-";break;case ze.Divide:r="/";break;case ze.Multiply:r="*";break;case ze.Modulo:r="%";break;case ze.Lower:r="<";break;case ze.LowerEquals:r="<=";break;case ze.Bigger:r=">";break;case ze.BiggerEquals:r=">=";break;case ze.NullishCoalesce:r="??";break;default:throw new Error(`Unknown operator ${t.operator}`)}return t.parens&&i.print(t,"("),t.lhs.visitExpression(this,i),i.print(t,` ${r} `),t.rhs.visitExpression(this,i),t.parens&&i.print(t,")"),null}visitReadPropExpr(t,i){return t.receiver.visitExpression(this,i),i.print(t,"."),i.print(t,t.name),null}visitReadKeyExpr(t,i){return t.receiver.visitExpression(this,i),i.print(t,"["),t.index.visitExpression(this,i),i.print(t,"]"),null}visitLiteralArrayExpr(t,i){return i.print(t,"["),this.visitAllExpressions(t.entries,i,","),i.print(t,"]"),null}visitLiteralMapExpr(t,i){return i.print(t,"{"),this.visitAllObjects(r=>{i.print(t,`${tu(r.key,this._escapeDollarInStrings,r.quoted)}:`),r.value.visitExpression(this,i)},t.entries,i,","),i.print(t,"}"),null}visitCommaExpr(t,i){return i.print(t,"("),this.visitAllExpressions(t.parts,i,","),i.print(t,")"),null}visitAllExpressions(t,i,r){this.visitAllObjects(n=>n.visitExpression(this,i),t,i,r)}visitAllObjects(t,i,r,n){let a=!1;for(let o=0;o<i.length;o++)o>0&&(r.lineLength()>80?(r.print(null,n,!0),a||(r.incIndent(),r.incIndent(),a=!0)):r.print(null,n,!1)),t(i[o]);a&&(r.decIndent(),r.decIndent())}visitAllStatements(t,i){t.forEach(r=>r.visitStatement(this,i))}};function tu(e,t,i=!0){if(e==null)return null;let r=e.replace(VW,(...a)=>a[0]=="$"?t?"\\$":"$":a[0]==`
`?"\\n":a[0]=="\r"?"\\r":`\\${a[0]}`);return i||!zW.test(r)?`'${r}'`:r}function xO(e){let t="";for(let i=0;i<e;i++)t+=wE;return t}function mx(e,t){if(t===0)return An(e);let i=[];for(let r=0;r<t;r++)i.push(Ul);return An(e,void 0,i)}var CL="@";function EL(e){return`${CL}${e}`}function UW(e,t){return`${CL}${e}.${t}`}function HW(e,t){let i=tu(t,!1,!1);return i!==t?`${e}[${i}]`:`${e}.${t}`}function SL(e,t){return`animation_${e}_${t}`}function GW(e){return jW("ngJitMode",e)}function jW(e,t){let i=new Il({name:e,moduleName:null}),r=new ci(ze.Identical,new dm(i),L("undefined")),n=new ci(ze.Or,r,i,void 0,void 0,!0);return new ci(ze.And,n,t)}function nn(e){let t=new di(e);return{value:t,type:t}}function iu(e,t){let i=zt(e.map(r=>r.value));return t?vn([],i):i}function aS(e,t){return{expression:e,forwardRef:t}}function WW({expression:e,forwardRef:t}){switch(t){case 0:case 1:return e;case 2:return qW(e)}}function qW(e){return Le(E.forwardRef).callFn([vn([],e)])}var vb=function(e){return e[e.Class=0]="Class",e[e.Function=1]="Function",e}(vb||{}),El=function(e){return e[e.Directive=0]="Directive",e[e.Component=1]="Component",e[e.Injectable=2]="Injectable",e[e.Pipe=3]="Pipe",e[e.NgModule=4]="NgModule",e}(El||{});function Jd(e){let t=et("t"),i=null,r=wO(e)?t:new ci(ze.Or,t,e.type.value),n=null;e.deps!==null?e.deps!=="invalid"&&(n=new Wf(r,yO(e.deps,e.target))):(i=et(`\u0275${e.name}_BaseFactory`),n=i.callFn([r]));let a=[],o=null;function s(c){let d=et("r");a.push(d.set(mu).toDeclStmt());let u=n!==null?d.set(n).toStmt():Le(E.invalidFactory).callFn([]).toStmt();return a.push(Ag(t,[u],[d.set(c).toStmt()])),d}if(wO(e)){let c=yO(e.delegateDeps,e.target),d=new(e.delegateType===vb.Class?Wf:ha)(e.delegate,c);o=s(d)}else KW(e)?o=s(e.expression):o=n;if(o===null)a.push(Le(E.invalidFactory).callFn([]).toStmt());else if(i!==null){let c=Le(E.getInheritedFactory).callFn([e.type.value]),d=new ci(ze.Or,i,i.set(c));a.push(new Jr(d.callFn([r])))}else a.push(new Jr(o));let l=Gs([new er("t",Ul)],a,da,void 0,`${e.name}_Factory`);return i!==null&&(l=vn([],[new Wn(i.name),new Jr(l)]).callFn([],void 0,!0)),{expression:l,statements:[],type:$W(e)}}function $W(e){let t=e.deps!==null&&e.deps!=="invalid"?YW(e.deps):Us;return An(Le(E.FactoryDeclaration,[mx(e.type.type,e.typeArgumentCount),t]))}function yO(e,t){return e.map((i,r)=>XW(i,t,r))}function XW(e,t,i){if(e.token===null)return Le(E.invalidFactoryDep).callFn([L(i)]);if(e.attributeNameType===null){let r=0|(e.self?2:0)|(e.skipSelf?4:0)|(e.host?1:0)|(e.optional?8:0)|(t===El.Pipe?16:0),n=r!==0||e.optional?L(r):null,a=[e.token];n&&a.push(n);let o=QW(t);return Le(o).callFn(a)}else return Le(E.injectAttribute).callFn([e.token])}function YW(e){let t=!1,i=e.map(r=>{let n=ZW(r);return n!==null?(t=!0,n):L(null)});return t?An(zt(i)):Us}function ZW(e){let t=[];return e.attributeNameType!==null&&t.push({key:"attribute",value:e.attributeNameType,quoted:!1}),e.optional&&t.push({key:"optional",value:L(!0),quoted:!1}),e.host&&t.push({key:"host",value:L(!0),quoted:!1}),e.self&&t.push({key:"self",value:L(!0),quoted:!1}),e.skipSelf&&t.push({key:"skipSelf",value:L(!0),quoted:!1}),t.length>0?xn(t):null}function wO(e){return e.delegateType!==void 0}function KW(e){return e.expression!==void 0}function QW(e){switch(e){case El.Component:case El.Directive:case El.Pipe:return E.directiveInject;case El.NgModule:case El.Injectable:default:return E.inject}}var Rs=function(e){return e[e.RAW_TEXT=0]="RAW_TEXT",e[e.ESCAPABLE_RAW_TEXT=1]="ESCAPABLE_RAW_TEXT",e[e.PARSABLE_DATA=2]="PARSABLE_DATA",e}(Rs||{});function ua(e,t=!0){if(e[0]!=":")return[null,e];let i=e.indexOf(":",1);if(i===-1){if(t)throw new Error(`Unsupported format "${e}" expecting ":namespace:name"`);return[null,e]}return[e.slice(1,i),e.slice(i+1)]}function SE(e){return ua(e)[1]==="ng-container"}function AE(e){return ua(e)[1]==="ng-content"}function JW(e){return ua(e)[1]==="ng-template"}function TE(e){return e===null?null:ua(e)[0]}function DE(e,t){return e?`:${e}:${t}`:t}var mm=class{constructor(t,i){this.value=t,this.sourceSpan=i}visit(t){throw new Error("visit() not implemented for Comment")}},Dl=class{constructor(t,i){this.value=t,this.sourceSpan=i}visit(t){return t.visitText(this)}},fu=class{constructor(t,i,r){this.value=t,this.sourceSpan=i,this.i18n=r}visit(t){return t.visitBoundText(this)}},pm=class{constructor(t,i,r,n,a,o){this.name=t,this.value=i,this.sourceSpan=r,this.keySpan=n,this.valueSpan=a,this.i18n=o}visit(t){return t.visitTextAttribute(this)}},_b=class e{constructor(t,i,r,n,a,o,s,l,c){this.name=t,this.type=i,this.securityContext=r,this.value=n,this.unit=a,this.sourceSpan=o,this.keySpan=s,this.valueSpan=l,this.i18n=c}static fromBoundElementProperty(t,i){if(t.keySpan===void 0)throw new Error(`Unexpected state: keySpan must be defined for bound attributes but was not for ${t.name}: ${t.sourceSpan}`);return new e(t.name,t.type,t.securityContext,t.value,t.unit,t.sourceSpan,t.keySpan,t.valueSpan,i)}visit(t){return t.visitBoundAttribute(this)}},bb=class e{constructor(t,i,r,n,a,o,s,l){this.name=t,this.type=i,this.handler=r,this.target=n,this.phase=a,this.sourceSpan=o,this.handlerSpan=s,this.keySpan=l}static fromParsedEvent(t){let i=t.type===0?t.targetOrPhase:null,r=t.type===1?t.targetOrPhase:null;if(t.keySpan===void 0)throw new Error(`Unexpected state: keySpan must be defined for bound event but was not for ${t.name}: ${t.sourceSpan}`);return new e(t.name,t.type,t.handler,i,r,t.sourceSpan,t.handlerSpan,t.keySpan)}visit(t){return t.visitBoundEvent(this)}},pa=class{constructor(t,i,r,n,a,o,s,l,c,d){this.name=t,this.attributes=i,this.inputs=r,this.outputs=n,this.children=a,this.references=o,this.sourceSpan=s,this.startSourceSpan=l,this.endSourceSpan=c,this.i18n=d}visit(t){return t.visitElement(this)}},Nl=class{constructor(t,i,r,n){this.nameSpan=t,this.sourceSpan=i,this.prefetchSpan=r,this.whenOrOnSourceSpan=n}visit(t){return t.visitDeferredTrigger(this)}},ME=class extends Nl{constructor(t,i,r,n){super(null,i,r,n),this.value=t}},IE=class extends Nl{},kE=class extends Nl{},xb=class extends Nl{constructor(t,i,r,n,a){super(i,r,n,a),this.reference=t}},NE=class extends Nl{constructor(t,i,r,n,a){super(i,r,n,a),this.delay=t}},yb=class extends Nl{constructor(t,i,r,n,a){super(i,r,n,a),this.reference=t}},wb=class extends Nl{constructor(t,i,r,n,a){super(i,r,n,a),this.reference=t}},jo=class{constructor(t,i,r,n){this.nameSpan=t,this.sourceSpan=i,this.startSourceSpan=r,this.endSourceSpan=n}},Zf=class extends jo{constructor(t,i,r,n,a,o,s){super(r,n,a,o),this.children=t,this.minimumTime=i,this.i18n=s}visit(t){return t.visitDeferredBlockPlaceholder(this)}},Kf=class extends jo{constructor(t,i,r,n,a,o,s,l){super(n,a,o,s),this.children=t,this.afterTime=i,this.minimumTime=r,this.i18n=l}visit(t){return t.visitDeferredBlockLoading(this)}},Qf=class extends jo{constructor(t,i,r,n,a,o){super(i,r,n,a),this.children=t,this.i18n=o}visit(t){return t.visitDeferredBlockError(this)}},gu=class extends jo{constructor(t,i,r,n,a,o,s,l,c,d,u,h){super(s,l,d,u),this.children=t,this.placeholder=n,this.loading=a,this.error=o,this.mainBlockSpan=c,this.i18n=h,this.triggers=i,this.prefetchTriggers=r,this.definedTriggers=Object.keys(i),this.definedPrefetchTriggers=Object.keys(r)}visit(t){return t.visitDeferredBlock(this)}visitAll(t){this.visitTriggers(this.definedTriggers,this.triggers,t),this.visitTriggers(this.definedPrefetchTriggers,this.prefetchTriggers,t),Vf(t,this.children);let i=[this.placeholder,this.loading,this.error].filter(r=>r!==null);Vf(t,i)}visitTriggers(t,i,r){Vf(r,t.map(n=>i[n]))}},Cb=class extends jo{constructor(t,i,r,n,a,o,s){super(s,n,a,o),this.expression=t,this.cases=i,this.unknownBlocks=r}visit(t){return t.visitSwitchBlock(this)}},Jf=class extends jo{constructor(t,i,r,n,a,o,s){super(o,r,n,a),this.expression=t,this.children=i,this.i18n=s}visit(t){return t.visitSwitchBlockCase(this)}},fm=class extends jo{constructor(t,i,r,n,a,o,s,l,c,d,u,h,m){super(h,l,d,u),this.item=t,this.expression=i,this.trackBy=r,this.trackKeywordSpan=n,this.contextVariables=a,this.children=o,this.empty=s,this.mainBlockSpan=c,this.i18n=m}visit(t){return t.visitForLoopBlock(this)}},eg=class extends jo{constructor(t,i,r,n,a,o){super(a,i,r,n),this.children=t,this.i18n=o}visit(t){return t.visitForLoopBlockEmpty(this)}},Eb=class extends jo{constructor(t,i,r,n,a){super(a,i,r,n),this.branches=t}visit(t){return t.visitIfBlock(this)}},au=class extends jo{constructor(t,i,r,n,a,o,s,l){super(s,n,a,o),this.expression=t,this.children=i,this.expressionAlias=r,this.i18n=l}visit(t){return t.visitIfBlockBranch(this)}},Sb=class{constructor(t,i,r){this.name=t,this.sourceSpan=i,this.nameSpan=r}visit(t){return t.visitUnknownBlock(this)}},La=class{constructor(t,i,r,n,a,o,s,l,c,d,u,h){this.tagName=t,this.attributes=i,this.inputs=r,this.outputs=n,this.templateAttrs=a,this.children=o,this.references=s,this.variables=l,this.sourceSpan=c,this.startSourceSpan=d,this.endSourceSpan=u,this.i18n=h}visit(t){return t.visitTemplate(this)}},Ab=class{constructor(t,i,r,n){this.selector=t,this.attributes=i,this.sourceSpan=r,this.i18n=n,this.name="ng-content"}visit(t){return t.visitContent(this)}},Pl=class{constructor(t,i,r,n,a){this.name=t,this.value=i,this.sourceSpan=r,this.keySpan=n,this.valueSpan=a}visit(t){return t.visitVariable(this)}},tg=class{constructor(t,i,r,n,a){this.name=t,this.value=i,this.sourceSpan=r,this.keySpan=n,this.valueSpan=a}visit(t){return t.visitReference(this)}},ig=class{constructor(t,i,r,n){this.vars=t,this.placeholders=i,this.sourceSpan=r,this.i18n=n}visit(t){return t.visitIcu(this)}};function Vf(e,t){let i=[];if(e.visit)for(let r of t)e.visit(r)||r.visit(e);else for(let r of t){let n=r.visit(e);n&&i.push(n)}return i}var jn=class{constructor(t,i,r,n,a,o){this.nodes=t,this.placeholders=i,this.placeholderToMessage=r,this.meaning=n,this.description=a,this.customId=o,this.legacyIds=[],this.id=this.customId,this.messageString=eq(this.nodes),t.length?this.sources=[{filePath:t[0].sourceSpan.start.file.url,startLine:t[0].sourceSpan.start.line+1,startCol:t[0].sourceSpan.start.col+1,endLine:t[t.length-1].sourceSpan.end.line+1,endCol:t[0].sourceSpan.start.col+1}]:this.sources=[]}},Jh=class{constructor(t,i){this.value=t,this.sourceSpan=i}visit(t,i){return t.visitText(this,i)}},Bs=class{constructor(t,i){this.children=t,this.sourceSpan=i}visit(t,i){return t.visitContainer(this,i)}},Tb=class{constructor(t,i,r,n,a){this.expression=t,this.type=i,this.cases=r,this.sourceSpan=n,this.expressionPlaceholder=a}visit(t,i){return t.visitIcu(this,i)}},zc=class{constructor(t,i,r,n,a,o,s,l,c){this.tag=t,this.attrs=i,this.startName=r,this.closeName=n,this.children=a,this.isVoid=o,this.sourceSpan=s,this.startSourceSpan=l,this.endSourceSpan=c}visit(t,i){return t.visitTagPlaceholder(this,i)}},rg=class{constructor(t,i,r){this.value=t,this.name=i,this.sourceSpan=r}visit(t,i){return t.visitPlaceholder(this,i)}},gm=class{constructor(t,i,r){this.value=t,this.name=i,this.sourceSpan=r}visit(t,i){return t.visitIcuPlaceholder(this,i)}},Rl=class{constructor(t,i,r,n,a,o,s,l){this.name=t,this.parameters=i,this.startName=r,this.closeName=n,this.children=a,this.sourceSpan=o,this.startSourceSpan=s,this.endSourceSpan=l}visit(t,i){return t.visitBlockPlaceholder(this,i)}};function eq(e){let t=new PE;return e.map(r=>r.visit(t)).join("")}var PE=class{visitText(t){return t.value}visitContainer(t){return t.children.map(i=>i.visit(this)).join("")}visitIcu(t){let i=Object.keys(t.cases).map(r=>`${r} {${t.cases[r].visit(this)}}`);return`{${t.expressionPlaceholder}, ${t.type}, ${i.join(" ")}}`}visitTagPlaceholder(t){let i=t.children.map(r=>r.visit(this)).join("");return`{$${t.startName}}${i}{$${t.closeName}}`}visitPlaceholder(t){return`{$${t.name}}`}visitIcuPlaceholder(t){return`{$${t.name}}`}visitBlockPlaceholder(t){let i=t.children.map(r=>r.visit(this)).join("");return`{$${t.startName}}${i}{$${t.closeName}}`}};var RE=class{visitTag(t){let i=this._serializeAttributes(t.attrs);if(t.children.length==0)return`<${t.name}${i}/>`;let r=t.children.map(n=>n.visit(this));return`<${t.name}${i}>${r.join("")}</${t.name}>`}visitText(t){return t.value}visitDeclaration(t){return`<?xml${this._serializeAttributes(t.attrs)} ?>`}_serializeAttributes(t){let i=Object.keys(t).map(r=>`${r}="${t[r]}"`).join(" ");return i.length>0?" "+i:""}visitDoctype(t){return`<!DOCTYPE ${t.rootTag} [
${t.dtd}
]>`}},Cke=new RE;function tq(e){return e.toUpperCase().replace(/[^A-Z0-9_]/g,"_")}var iq="MSG_",rq="i18n_",AL="i18n",FE="i18n-",nq="VAR_",aq="I18N_EXP_",CO="\uFFFD";function TL(e){return e===AL||e.startsWith(FE)}function ng(e){return e instanceof jn}function Ff(e){return ng(e)&&e.nodes.length===1&&e.nodes[0]instanceof Tb}function oq(e){return!!e.i18n}function sq(e){return e.attrs.some(t=>TL(t.name))}function oS(e){return e.nodes[0]}function px(e,t=0){let i=t>0?`:${t}`:"";return`${CO}${e}${i}${CO}`}function lq(e,t=0,i=0){if(!e.length)return"";let r="",n=e.length-1;for(let a=0;a<n;a++)r+=`${e[a]}${px(t+a,i)}`;return r+=e[n],r}function cq(e=0){let t=e;return()=>t++}function EO(e){let t={};return e.forEach((i,r)=>{t[r]=L(i.length>1?`[${i.join("|")}]`:i[0])}),t}function Of(e,t,...i){let r=e.get(t)||[];r.push(...i),e.set(t,r)}function DL(e,t=0,i=0){let r=t,n=new Map,a=e instanceof jn?e.nodes.find(o=>o instanceof Bs):e;return a&&a.children.filter(o=>o instanceof rg).forEach((o,s)=>{let l=px(r+s,i);Of(n,o.name,l)}),n}function Tg(e={},t){let i={};return e&&Object.keys(e).length&&Object.keys(e).forEach(r=>i[Dg(r,t)]=e[r]),i}function Dg(e,t=!0){let i=tq(e);if(!t)return i;let r=i.split("_");if(r.length===1)return e.toLowerCase();let n;/^\d+$/.test(r[r.length-1])&&(n=r.pop());let a=r.shift().toLowerCase();return r.length&&(a+=r.map(o=>o.charAt(0).toUpperCase()+o.slice(1).toLowerCase()).join("")),n?`${a}_${n}`:a}function Db(e){return`${iq}${e}`.toUpperCase()}function ML(e){return new Wn(e.name,void 0,da,void 0,e.sourceSpan)}var dq=/[-.]/,sS="_t",la="ctx",Mg="rf",uq="_r",hq="$implicit",mq="ngNonBindable",IL="restoredCtx",OE="#context",pq=500,fq=new Set([E.element,E.elementStart,E.elementEnd,E.elementContainer,E.elementContainerStart,E.elementContainerEnd,E.i18nExp,E.listener,E.classProp,E.syntheticHostListener,E.hostProperty,E.syntheticHostProperty,E.property,E.propertyInterpolate1,E.propertyInterpolate2,E.propertyInterpolate3,E.propertyInterpolate4,E.propertyInterpolate5,E.propertyInterpolate6,E.propertyInterpolate7,E.propertyInterpolate8,E.propertyInterpolateV,E.attribute,E.attributeInterpolate1,E.attributeInterpolate2,E.attributeInterpolate3,E.attributeInterpolate4,E.attributeInterpolate5,E.attributeInterpolate6,E.attributeInterpolate7,E.attributeInterpolate8,E.attributeInterpolateV,E.styleProp,E.stylePropInterpolate1,E.stylePropInterpolate2,E.stylePropInterpolate3,E.stylePropInterpolate4,E.stylePropInterpolate5,E.stylePropInterpolate6,E.stylePropInterpolate7,E.stylePropInterpolate8,E.stylePropInterpolateV,E.textInterpolate,E.textInterpolate1,E.textInterpolate2,E.textInterpolate3,E.textInterpolate4,E.textInterpolate5,E.textInterpolate6,E.textInterpolate7,E.textInterpolate8,E.textInterpolateV,E.templateCreate,E.twoWayProperty,E.twoWayListener]);function vu(e,t,i){return Le(t,null,e).callFn(i,e)}function kL(e,t){let i=null;return()=>(i||(e(new Wn(sS,void 0,Ul)),i=et(t)),i)}function ro(e){throw new Error(`Invalid state: Visitor ${this.constructor.name} doesn't handle ${e.constructor.name}`)}function hs(e){return Array.isArray(e)?zt(e.map(hs)):L(e,da)}function SO(e,t){let i=Object.getOwnPropertyNames(e);return i.length===0?null:xn(i.map(r=>{let n=e[r],a,o,s,l;if(typeof n=="string")a=r,s=r,o=n,l=hs(o);else{s=r,a=n.classPropertyName,o=n.bindingPropertyName;let c=o!==a,d=n.transformFunction!==null,u=null;if(n.isSignal&&(u=TO(Qh.SignalBased,u)),d&&(u=TO(Qh.HasDecoratorInputTransform,u)),t&&(c||d||u!==null)){let m=[u??Le(E.InputFlags).prop(Qh[Qh.None]),hs(o)];(c||d)&&(m.push(hs(a)),d&&m.push(n.transformFunction)),l=zt(m)}else l=hs(o)}return{key:s,quoted:dq.test(s),value:l}}))}function AO(e){return Le(E.InputFlags).prop(Qh[e])}function TO(e,t){return t===null?AO(e):AO(e).bitwiseOr(t)}function jh(e){for(;xL(e[e.length-1]);)e.pop();return e}var Uc=class{constructor(){this.values=[]}set(t,i){if(i){let r=this.values.find(n=>n.key===t);r?r.value=i:this.values.push({key:t,value:i,quoted:!1})}}toLiteralMap(){return xn(this.values)}};function gq(e){let t=e instanceof pa?e.name:"ng-template",i=vq(e),r=new cm,n=ua(t)[1];return r.setElement(n),Object.getOwnPropertyNames(i).forEach(a=>{let o=ua(a)[1],s=i[a];r.addAttribute(o,s),a.toLowerCase()==="class"&&s.trim().split(/\s+/).forEach(c=>r.addClassName(c))}),r}function vq(e){let t={};return e instanceof La&&e.tagName!=="ng-template"?e.templateAttrs.forEach(i=>t[i.name]=""):(e.attributes.forEach(i=>{TL(i.name)||(t[i.name]=i.value)}),e.inputs.forEach(i=>{(i.type===0||i.type===5)&&(t[i.name]="")}),e.outputs.forEach(i=>{t[i.name]=""})),t}function ku(e){let{expressions:t,strings:i}=e;return t.length===1&&i.length===2&&i[0]===""&&i[1]===""?1:t.length+i.length}function Mb(e){let t=[],i=null,r=null,n=0;for(let a of e){let o=(typeof a.paramsOrFn=="function"?a.paramsOrFn():a.paramsOrFn)??[],s=Array.isArray(o)?o:[o];n<pq&&r===a.reference&&fq.has(r)?(i=i.callFn(s,i.sourceSpan),n++):(i!==null&&t.push(i.toStmt()),i=vu(a.span,a.reference,s),r=a.reference,n=0)}return i!==null&&t.push(i.toStmt()),t}function DO(e,t){let i=null,r={name:e.name,type:e.type,typeArgumentCount:e.typeArgumentCount,deps:[],target:El.Injectable};if(e.useClass!==void 0){let s=e.useClass.expression.isEquivalent(e.type.value),l;e.deps!==void 0&&(l=e.deps),l!==void 0?i=Jd(Bt(Z({},r),{delegate:e.useClass.expression,delegateDeps:l,delegateType:vb.Class})):s?i=Jd(r):i={statements:[],expression:MO(e.type.value,e.useClass.expression,t)}}else e.useFactory!==void 0?e.deps!==void 0?i=Jd(Bt(Z({},r),{delegate:e.useFactory,delegateDeps:e.deps||[],delegateType:vb.Function})):i={statements:[],expression:vn([],e.useFactory.callFn([]))}:e.useValue!==void 0?i=Jd(Bt(Z({},r),{expression:e.useValue.expression})):e.useExisting!==void 0?i=Jd(Bt(Z({},r),{expression:Le(E.inject).callFn([e.useExisting.expression])})):i={statements:[],expression:MO(e.type.value,e.type.value,t)};let n=e.type.value,a=new Uc;return a.set("token",n),a.set("factory",i.expression),e.providedIn.expression.value!==null&&a.set("providedIn",WW(e.providedIn)),{expression:Le(E.\u0275\u0275defineInjectable).callFn([a.toLiteralMap()],void 0,!0),type:_q(e),statements:i.statements}}function _q(e){return new Ho(Le(E.InjectableDeclaration,[mx(e.type.type,e.typeArgumentCount)]))}function MO(e,t,i){if(e.node===t.node)return t.prop("\u0275fac");if(!i)return IO(t);let r=Le(E.resolveForwardRef).callFn([t]);return IO(r)}function IO(e){return vn([new er("t",Ul)],e.prop("\u0275fac").callFn([et("t")]))}var bq=[/^\s*$/,/[<>]/,/^[{}]$/,/&(#|[a-z])/i,/^\/\//];function xq(e,t){if(t!=null&&!(Array.isArray(t)&&t.length==2))throw new Error(`Expected '${e}' to be an array, [start, end].`);if(t!=null){let i=t[0],r=t[1];bq.forEach(n=>{if(n.test(i)||n.test(r))throw new Error(`['${i}', '${r}'] contains unusable interpolation symbol.`)})}}var Ib=class e{static fromArray(t){return t?(xq("interpolation",t),new e(t[0],t[1])):Fs}constructor(t,i){this.start=t,this.end=i}},Fs=new Ib("{{","}}"),yq=new Set(["switch"]),ca=0,wq=8,lS=9,ou=10,NL=11,PL=12,cS=13,RL=32,LE=33,ag=34,FL=35,OL=36,Cq=37,kb=38,og=39,Ml=40,ms=41,Eq=42,LL=43,Uo=44,Nb=45,Zh=46,Sl=47,Rc=58,ps=59,em=60,tm=61,Pc=62,kO=63,dS=48,Sq=55,BL=57,Im=65,Aq=69,Tq=70,Dq=88,fx=90,lm=91,Pb=92,im=93,Mq=94,gx=95,_u=97,Iq=98,kq=101,uS=102,VL=110,zL=114,UL=116,HL=117,GL=118,jL=120,Ig=122,Os=123,NO=124,Pa=125,WL=160;var PO=64,Nq=96;function vx(e){return e>=lS&&e<=RL||e==WL}function Cl(e){return dS<=e&&e<=BL}function _x(e){return e>=_u&&e<=Ig||e>=Im&&e<=fx}function Pq(e){return e>=_u&&e<=uS||e>=Im&&e<=Tq||Cl(e)}function qL(e){return e===ou||e===cS}function RO(e){return dS<=e&&e<=Sq}function Rb(e){return e===og||e===ag||e===Nq}var sg=class e{constructor(t,i,r,n){this.file=t,this.offset=i,this.line=r,this.col=n}toString(){return this.offset!=null?`${this.file.url}@${this.line}:${this.col}`:this.file.url}moveBy(t){let i=this.file.content,r=i.length,n=this.offset,a=this.line,o=this.col;for(;n>0&&t<0;)if(n--,t++,i.charCodeAt(n)==ou){a--;let l=i.substring(0,n-1).lastIndexOf(String.fromCharCode(ou));o=l>0?n-l:n}else o--;for(;n<r&&t>0;){let s=i.charCodeAt(n);n++,t--,s==ou?(a++,o=0):o++}return new e(this.file,n,a,o)}getContext(t,i){let r=this.file.content,n=this.offset;if(n!=null){n>r.length-1&&(n=r.length-1);let a=n,o=0,s=0;for(;o<t&&n>0&&(n--,o++,!(r[n]==`
`&&++s==i)););for(o=0,s=0;o<t&&a<r.length-1&&(a++,o++,!(r[a]==`
`&&++s==i)););return{before:r.substring(n,this.offset),after:r.substring(this.offset,a+1)}}return null}},Fb=class{constructor(t,i){this.content=t,this.url=i}},Qt=class{constructor(t,i,r=t,n=null){this.start=t,this.end=i,this.fullStart=r,this.details=n}toString(){return this.start.file.content.substring(this.start.offset,this.end.offset)}},Oc=function(e){return e[e.WARNING=0]="WARNING",e[e.ERROR=1]="ERROR",e}(Oc||{}),$t=class{constructor(t,i,r=Oc.ERROR){this.span=t,this.msg=i,this.level=r}contextualMessage(){let t=this.span.start.getContext(100,3);return t?`${this.msg} ("${t.before}[${Oc[this.level]} ->]${t.after}")`:this.msg}toString(){let t=this.span.details?`, ${this.span.details}`:"";return`${this.contextualMessage()}: ${this.span.start}${t}`}};function Rq(e,t,i){let r=`in ${e} ${t} in ${i}`,n=new Fb("",r);return new Qt(new sg(n,-1,-1,-1),new sg(n,-1,-1,-1))}var Fq=0;function Oq(e){if(!e||!e.reference)return null;let t=e.reference;if(t.__anonymousType)return t.__anonymousType;if(t.__forward_ref__)return"__forward_ref__";let i=wL(t);return i.indexOf("(")>=0?(i=`anonymous_${Fq++}`,t.__anonymousType=i):i=Vs(i),i}function Vs(e){return e.replace(/\W/g,"_")}var FO='(this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e})',BE=class extends EE{constructor(){super(!1)}visitWrappedNodeExpr(t,i){throw new Error("Cannot emit a WrappedNodeExpr in Javascript.")}visitDeclareVarStmt(t,i){return i.print(t,`var ${t.name}`),t.value&&(i.print(t," = "),t.value.visitExpression(this,i)),i.println(t,";"),null}visitTaggedTemplateExpr(t,i){let r=t.template.elements;return t.tag.visitExpression(this,i),i.print(t,`(${FO}(`),i.print(t,`[${r.map(n=>tu(n.text,!1)).join(", ")}], `),i.print(t,`[${r.map(n=>tu(n.rawText,!1)).join(", ")}])`),t.template.expressions.forEach(n=>{i.print(t,", "),n.visitExpression(this,i)}),i.print(t,")"),null}visitFunctionExpr(t,i){return i.print(t,`function${t.name?" "+t.name:""}(`),this._visitParams(t.params,i),i.println(t,") {"),i.incIndent(),this.visitAllStatements(t.statements,i),i.decIndent(),i.print(t,"}"),null}visitArrowFunctionExpr(t,i){if(i.print(t,"("),this._visitParams(t.params,i),i.print(t,") =>"),Array.isArray(t.body))i.println(t,"{"),i.incIndent(),this.visitAllStatements(t.body,i),i.decIndent(),i.print(t,"}");else{let r=t.body instanceof fs;r&&i.print(t,"("),t.body.visitExpression(this,i),r&&i.print(t,")")}return null}visitDeclareFunctionStmt(t,i){return i.print(t,`function ${t.name}(`),this._visitParams(t.params,i),i.println(t,") {"),i.incIndent(),this.visitAllStatements(t.statements,i),i.decIndent(),i.println(t,"}"),null}visitLocalizedString(t,i){i.print(t,`$localize(${FO}(`);let r=[t.serializeI18nHead()];for(let n=1;n<t.messageParts.length;n++)r.push(t.serializeI18nTemplatePart(n));return i.print(t,`[${r.map(n=>tu(n.cooked,!1)).join(", ")}], `),i.print(t,`[${r.map(n=>tu(n.raw,!1)).join(", ")}])`),t.expressions.forEach(n=>{i.print(t,", "),n.visitExpression(this,i)}),i.print(t,")"),null}_visitParams(t,i){this.visitAllObjects(r=>i.print(null,r.name),t,i,",")}},H_;function Lq(){if(H_===void 0){let e=Bf.trustedTypes;if(H_=null,e)try{H_=e.createPolicy("angular#unsafe-jit",{createScript:t=>t})}catch{}}return H_}function Bq(e){return Lq()?.createScript(e)||e}function OO(...e){if(!Bf.trustedTypes)return new Function(...e);let t=e.slice(0,-1).join(","),i=e[e.length-1],r=`(function anonymous(${t}
) { ${i}
})`,n=Bf.eval(Bq(r));return n.bind===void 0?new Function(...e):(n.toString=()=>r,n.bind(Bf))}var VE=class{evaluateStatements(t,i,r,n){let a=new zE(r),o=CE.createRoot();return i.length>0&&!Vq(i[0])&&(i=[L("use strict").toStmt(),...i]),a.visitAllStatements(i,o),a.createReturnStmt(o),this.evaluateCode(t,o,a.getArgs(),n)}evaluateCode(t,i,r,n){let a=`"use strict";${i.toSource()}
//# sourceURL=${t}`,o=[],s=[];for(let c in r)s.push(r[c]),o.push(c);if(n){let c=OO(...o.concat("return null;")).toString(),d=c.slice(0,c.indexOf("return null;")).split(`
`).length-1;a+=`
${i.toSourceMapGenerator(t,d).toJsComment()}`}let l=OO(...o.concat(a));return this.executeFunction(l,s)}executeFunction(t,i){return t(...i)}},zE=class extends BE{constructor(t){super(),this.refResolver=t,this._evalArgNames=[],this._evalArgValues=[],this._evalExportedVars=[]}createReturnStmt(t){new Jr(new fs(this._evalExportedVars.map(r=>new hm(r,et(r),!1)))).visitStatement(this,t)}getArgs(){let t={};for(let i=0;i<this._evalArgNames.length;i++)t[this._evalArgNames[i]]=this._evalArgValues[i];return t}visitExternalExpr(t,i){return this._emitReferenceToExternal(t,this.refResolver.resolveExternalReference(t.value),i),null}visitWrappedNodeExpr(t,i){return this._emitReferenceToExternal(t,t.node,i),null}visitDeclareVarStmt(t,i){return t.hasModifier(Sn.Exported)&&this._evalExportedVars.push(t.name),super.visitDeclareVarStmt(t,i)}visitDeclareFunctionStmt(t,i){return t.hasModifier(Sn.Exported)&&this._evalExportedVars.push(t.name),super.visitDeclareFunctionStmt(t,i)}_emitReferenceToExternal(t,i,r){let n=this._evalArgValues.indexOf(i);if(n===-1){n=this._evalArgValues.length,this._evalArgValues.push(i);let a=Oq({reference:i})||"val";this._evalArgNames.push(`jit_${a}_${n}`)}r.print(t,this._evalArgNames[n])}};function Vq(e){return e.isEquivalent(L("use strict").toStmt())}function LO(e){let t=new Uc;e.providers!==null&&t.set("providers",e.providers),e.imports.length>0&&t.set("imports",zt(e.imports));let i=Le(E.defineInjector).callFn([t.toLiteralMap()],void 0,!0),r=zq(e);return{expression:i,type:r,statements:[]}}function zq(e){return new Ho(Le(E.InjectorDeclaration,[new Ho(e.type.type)]))}var UE=class{constructor(t){this.context=t}resolveExternalReference(t){if(t.moduleName!=="@angular/core")throw new Error(`Cannot resolve external reference to ${t.moduleName}, only references to @angular/core are supported.`);if(!this.context.hasOwnProperty(t.name))throw new Error(`No value provided for @angular/core symbol '${t.name}'.`);return this.context[t.name]}},Ob=function(e){return e[e.Inline=0]="Inline",e[e.SideEffect=1]="SideEffect",e[e.Omit=2]="Omit",e}(Ob||{}),Lc=function(e){return e[e.Global=0]="Global",e[e.Local=1]="Local",e}(Lc||{});function Uq(e){let t=[],i=new Uc;if(i.set("type",e.type.value),e.kind===Lc.Global&&e.bootstrap.length>0&&i.set("bootstrap",iu(e.bootstrap,e.containsForwardDecls)),e.selectorScopeMode===Ob.Inline)e.declarations.length>0&&i.set("declarations",iu(e.declarations,e.containsForwardDecls)),e.imports.length>0&&i.set("imports",iu(e.imports,e.containsForwardDecls)),e.exports.length>0&&i.set("exports",iu(e.exports,e.containsForwardDecls));else if(e.selectorScopeMode===Ob.SideEffect){let a=jq(e);a!==null&&t.push(a)}e.schemas!==null&&e.schemas.length>0&&i.set("schemas",zt(e.schemas.map(a=>a.value))),e.id!==null&&(i.set("id",e.id),t.push(Le(E.registerNgModuleType).callFn([e.type.value,e.id]).toStmt()));let r=Le(E.defineNgModule).callFn([i.toLiteralMap()],void 0,!0),n=Gq(e);return{expression:r,type:n,statements:t}}function Hq(e){let t=new Uc;return t.set("type",new di(e.type)),e.bootstrap!==void 0&&t.set("bootstrap",new di(e.bootstrap)),e.declarations!==void 0&&t.set("declarations",new di(e.declarations)),e.imports!==void 0&&t.set("imports",new di(e.imports)),e.exports!==void 0&&t.set("exports",new di(e.exports)),e.schemas!==void 0&&t.set("schemas",new di(e.schemas)),e.id!==void 0&&t.set("id",new di(e.id)),Le(E.defineNgModule).callFn([t.toLiteralMap()])}function Gq(e){if(e.kind===Lc.Local)return new Ho(e.type.value);let{type:t,declarations:i,exports:r,imports:n,includeImportTypes:a,publicDeclarationTypes:o}=e;return new Ho(Le(E.NgModuleDeclaration,[new Ho(t.type),o===null?WC(i):Wq(o),a?WC(n):Us,WC(r)]))}function jq(e){let t=new Uc;if(e.kind===Lc.Global?e.declarations.length>0&&t.set("declarations",iu(e.declarations,e.containsForwardDecls)):e.declarationsExpression&&t.set("declarations",e.declarationsExpression),e.kind===Lc.Global?e.imports.length>0&&t.set("imports",iu(e.imports,e.containsForwardDecls)):e.importsExpression&&t.set("imports",e.importsExpression),e.kind===Lc.Global?e.exports.length>0&&t.set("exports",iu(e.exports,e.containsForwardDecls)):e.exportsExpression&&t.set("exports",e.exportsExpression),e.kind===Lc.Local&&e.bootstrapExpression&&t.set("bootstrap",e.bootstrapExpression),Object.keys(t.values).length===0)return null;let i=new ha(Le(E.setNgModuleScope),[e.type.value,t.toLiteralMap()]),r=GW(i),n=new du([],[r.toStmt()]);return new ha(n,[]).toStmt()}function WC(e){let t=e.map(i=>Sg(i.type));return e.length>0?An(zt(t)):Us}function Wq(e){let t=e.map(i=>Sg(i));return e.length>0?An(zt(t)):Us}function BO(e){let t=[];t.push({key:"name",value:L(e.pipeName),quoted:!1}),t.push({key:"type",value:e.type.value,quoted:!1}),t.push({key:"pure",value:L(e.pure),quoted:!1}),e.isStandalone&&t.push({key:"standalone",value:L(!0),quoted:!1});let i=Le(E.definePipe).callFn([xn(t)],void 0,!0),r=qq(e);return{expression:i,type:r,statements:[]}}function qq(e){return new Ho(Le(E.PipeDeclaration,[mx(e.type.type,e.typeArgumentCount),new Ho(new _n(e.pipeName)),new Ho(new _n(e.isStandalone))]))}var bx=function(e){return e[e.Directive=0]="Directive",e[e.Pipe=1]="Pipe",e[e.NgModule=2]="NgModule",e}(bx||{}),lg=class{constructor(t,i,r,n){this.input=i,this.errLocation=r,this.ctxLocation=n,this.message=`Parser Error: ${t} ${r} [${i}] in ${n}`}},bu=class{constructor(t,i){this.start=t,this.end=i}toAbsolute(t){return new ao(t+this.start,t+this.end)}},Or=class{constructor(t,i){this.span=t,this.sourceSpan=i}toString(){return"AST"}},vm=class extends Or{constructor(t,i,r){super(t,i),this.nameSpan=r}},zn=class extends Or{visit(t,i=null){}},Hn=class extends Or{visit(t,i=null){return t.visitImplicitReceiver(this,i)}},Bc=class extends Hn{visit(t,i=null){return t.visitThisReceiver?.(this,i)}},Hc=class extends Or{constructor(t,i,r){super(t,i),this.expressions=r}visit(t,i=null){return t.visitChain(this,i)}},xu=class extends Or{constructor(t,i,r,n,a){super(t,i),this.condition=r,this.trueExp=n,this.falseExp=a}visit(t,i=null){return t.visitConditional(this,i)}},fn=class extends vm{constructor(t,i,r,n,a){super(t,i,r),this.receiver=n,this.name=a}visit(t,i=null){return t.visitPropertyRead(this,i)}},_m=class extends vm{constructor(t,i,r,n,a,o){super(t,i,r),this.receiver=n,this.name=a,this.value=o}visit(t,i=null){return t.visitPropertyWrite(this,i)}},bm=class extends vm{constructor(t,i,r,n,a){super(t,i,r),this.receiver=n,this.name=a}visit(t,i=null){return t.visitSafePropertyRead(this,i)}},Fl=class extends Or{constructor(t,i,r,n){super(t,i),this.receiver=r,this.key=n}visit(t,i=null){return t.visitKeyedRead(this,i)}},yu=class extends Or{constructor(t,i,r,n){super(t,i),this.receiver=r,this.key=n}visit(t,i=null){return t.visitSafeKeyedRead(this,i)}},xm=class extends Or{constructor(t,i,r,n,a){super(t,i),this.receiver=r,this.key=n,this.value=a}visit(t,i=null){return t.visitKeyedWrite(this,i)}},wu=class extends vm{constructor(t,i,r,n,a,o){super(t,i,o),this.exp=r,this.name=n,this.args=a}visit(t,i=null){return t.visitPipe(this,i)}},Un=class extends Or{constructor(t,i,r){super(t,i),this.value=r}visit(t,i=null){return t.visitLiteralPrimitive(this,i)}},Cu=class extends Or{constructor(t,i,r){super(t,i),this.expressions=r}visit(t,i=null){return t.visitLiteralArray(this,i)}},ym=class extends Or{constructor(t,i,r,n){super(t,i),this.keys=r,this.values=n}visit(t,i=null){return t.visitLiteralMap(this,i)}},zr=class extends Or{constructor(t,i,r,n){super(t,i),this.strings=r,this.expressions=n}visit(t,i=null){return t.visitInterpolation(this,i)}},Na=class extends Or{constructor(t,i,r,n,a){super(t,i),this.operation=r,this.left=n,this.right=a}visit(t,i=null){return t.visitBinary(this,i)}},Ol=class e extends Na{static createMinus(t,i,r){return new e(t,i,"-",r,"-",new Un(t,i,0),r)}static createPlus(t,i,r){return new e(t,i,"+",r,"-",r,new Un(t,i,0))}constructor(t,i,r,n,a,o,s){super(t,i,a,o,s),this.operator=r,this.expr=n,this.left=null,this.right=null,this.operation=null}visit(t,i=null){return t.visitUnary!==void 0?t.visitUnary(this,i):t.visitBinary(this,i)}},Eu=class extends Or{constructor(t,i,r){super(t,i),this.expression=r}visit(t,i=null){return t.visitPrefixNot(this,i)}},Su=class extends Or{constructor(t,i,r){super(t,i),this.expression=r}visit(t,i=null){return t.visitNonNullAssert(this,i)}},js=class extends Or{constructor(t,i,r,n,a){super(t,i),this.receiver=r,this.args=n,this.argumentSpan=a}visit(t,i=null){return t.visitCall(this,i)}},Au=class extends Or{constructor(t,i,r,n,a){super(t,i),this.receiver=r,this.args=n,this.argumentSpan=a}visit(t,i=null){return t.visitSafeCall(this,i)}},ao=class{constructor(t,i){this.start=t,this.end=i}},Fa=class extends Or{constructor(t,i,r,n,a){super(new bu(0,i===null?0:i.length),new ao(n,i===null?n:n+i.length)),this.ast=t,this.source=i,this.location=r,this.errors=a}visit(t,i=null){return t.visitASTWithSource?t.visitASTWithSource(this,i):this.ast.visit(t,i)}toString(){return`${this.source} in ${this.location}`}},cg=class{constructor(t,i,r){this.sourceSpan=t,this.key=i,this.value=r}},HE=class{constructor(t,i,r){this.sourceSpan=t,this.key=i,this.value=r}},Lb=class{visit(t,i){t.visit(this,i)}visitUnary(t,i){this.visit(t.expr,i)}visitBinary(t,i){this.visit(t.left,i),this.visit(t.right,i)}visitChain(t,i){this.visitAll(t.expressions,i)}visitConditional(t,i){this.visit(t.condition,i),this.visit(t.trueExp,i),this.visit(t.falseExp,i)}visitPipe(t,i){this.visit(t.exp,i),this.visitAll(t.args,i)}visitImplicitReceiver(t,i){}visitThisReceiver(t,i){}visitInterpolation(t,i){this.visitAll(t.expressions,i)}visitKeyedRead(t,i){this.visit(t.receiver,i),this.visit(t.key,i)}visitKeyedWrite(t,i){this.visit(t.receiver,i),this.visit(t.key,i),this.visit(t.value,i)}visitLiteralArray(t,i){this.visitAll(t.expressions,i)}visitLiteralMap(t,i){this.visitAll(t.values,i)}visitLiteralPrimitive(t,i){}visitPrefixNot(t,i){this.visit(t.expression,i)}visitNonNullAssert(t,i){this.visit(t.expression,i)}visitPropertyRead(t,i){this.visit(t.receiver,i)}visitPropertyWrite(t,i){this.visit(t.receiver,i),this.visit(t.value,i)}visitSafePropertyRead(t,i){this.visit(t.receiver,i)}visitSafeKeyedRead(t,i){this.visit(t.receiver,i),this.visit(t.key,i)}visitCall(t,i){this.visit(t.receiver,i),this.visitAll(t.args,i)}visitSafeCall(t,i){this.visit(t.receiver,i),this.visitAll(t.args,i)}visitAll(t,i){for(let r of t)this.visit(r,i)}},GE=class{visitImplicitReceiver(t,i){return t}visitThisReceiver(t,i){return t}visitInterpolation(t,i){return new zr(t.span,t.sourceSpan,t.strings,this.visitAll(t.expressions))}visitLiteralPrimitive(t,i){return new Un(t.span,t.sourceSpan,t.value)}visitPropertyRead(t,i){return new fn(t.span,t.sourceSpan,t.nameSpan,t.receiver.visit(this),t.name)}visitPropertyWrite(t,i){return new _m(t.span,t.sourceSpan,t.nameSpan,t.receiver.visit(this),t.name,t.value.visit(this))}visitSafePropertyRead(t,i){return new bm(t.span,t.sourceSpan,t.nameSpan,t.receiver.visit(this),t.name)}visitLiteralArray(t,i){return new Cu(t.span,t.sourceSpan,this.visitAll(t.expressions))}visitLiteralMap(t,i){return new ym(t.span,t.sourceSpan,t.keys,this.visitAll(t.values))}visitUnary(t,i){switch(t.operator){case"+":return Ol.createPlus(t.span,t.sourceSpan,t.expr.visit(this));case"-":return Ol.createMinus(t.span,t.sourceSpan,t.expr.visit(this));default:throw new Error(`Unknown unary operator ${t.operator}`)}}visitBinary(t,i){return new Na(t.span,t.sourceSpan,t.operation,t.left.visit(this),t.right.visit(this))}visitPrefixNot(t,i){return new Eu(t.span,t.sourceSpan,t.expression.visit(this))}visitNonNullAssert(t,i){return new Su(t.span,t.sourceSpan,t.expression.visit(this))}visitConditional(t,i){return new xu(t.span,t.sourceSpan,t.condition.visit(this),t.trueExp.visit(this),t.falseExp.visit(this))}visitPipe(t,i){return new wu(t.span,t.sourceSpan,t.exp.visit(this),t.name,this.visitAll(t.args),t.nameSpan)}visitKeyedRead(t,i){return new Fl(t.span,t.sourceSpan,t.receiver.visit(this),t.key.visit(this))}visitKeyedWrite(t,i){return new xm(t.span,t.sourceSpan,t.receiver.visit(this),t.key.visit(this),t.value.visit(this))}visitCall(t,i){return new js(t.span,t.sourceSpan,t.receiver.visit(this),this.visitAll(t.args),t.argumentSpan)}visitSafeCall(t,i){return new Au(t.span,t.sourceSpan,t.receiver.visit(this),this.visitAll(t.args),t.argumentSpan)}visitAll(t){let i=[];for(let r=0;r<t.length;++r)i[r]=t[r].visit(this);return i}visitChain(t,i){return new Hc(t.span,t.sourceSpan,this.visitAll(t.expressions))}visitSafeKeyedRead(t,i){return new yu(t.span,t.sourceSpan,t.receiver.visit(this),t.key.visit(this))}},jE=class{visitImplicitReceiver(t,i){return t}visitThisReceiver(t,i){return t}visitInterpolation(t,i){let r=this.visitAll(t.expressions);return r!==t.expressions?new zr(t.span,t.sourceSpan,t.strings,r):t}visitLiteralPrimitive(t,i){return t}visitPropertyRead(t,i){let r=t.receiver.visit(this);return r!==t.receiver?new fn(t.span,t.sourceSpan,t.nameSpan,r,t.name):t}visitPropertyWrite(t,i){let r=t.receiver.visit(this),n=t.value.visit(this);return r!==t.receiver||n!==t.value?new _m(t.span,t.sourceSpan,t.nameSpan,r,t.name,n):t}visitSafePropertyRead(t,i){let r=t.receiver.visit(this);return r!==t.receiver?new bm(t.span,t.sourceSpan,t.nameSpan,r,t.name):t}visitLiteralArray(t,i){let r=this.visitAll(t.expressions);return r!==t.expressions?new Cu(t.span,t.sourceSpan,r):t}visitLiteralMap(t,i){let r=this.visitAll(t.values);return r!==t.values?new ym(t.span,t.sourceSpan,t.keys,r):t}visitUnary(t,i){let r=t.expr.visit(this);if(r!==t.expr)switch(t.operator){case"+":return Ol.createPlus(t.span,t.sourceSpan,r);case"-":return Ol.createMinus(t.span,t.sourceSpan,r);default:throw new Error(`Unknown unary operator ${t.operator}`)}return t}visitBinary(t,i){let r=t.left.visit(this),n=t.right.visit(this);return r!==t.left||n!==t.right?new Na(t.span,t.sourceSpan,t.operation,r,n):t}visitPrefixNot(t,i){let r=t.expression.visit(this);return r!==t.expression?new Eu(t.span,t.sourceSpan,r):t}visitNonNullAssert(t,i){let r=t.expression.visit(this);return r!==t.expression?new Su(t.span,t.sourceSpan,r):t}visitConditional(t,i){let r=t.condition.visit(this),n=t.trueExp.visit(this),a=t.falseExp.visit(this);return r!==t.condition||n!==t.trueExp||a!==t.falseExp?new xu(t.span,t.sourceSpan,r,n,a):t}visitPipe(t,i){let r=t.exp.visit(this),n=this.visitAll(t.args);return r!==t.exp||n!==t.args?new wu(t.span,t.sourceSpan,r,t.name,n,t.nameSpan):t}visitKeyedRead(t,i){let r=t.receiver.visit(this),n=t.key.visit(this);return r!==t.receiver||n!==t.key?new Fl(t.span,t.sourceSpan,r,n):t}visitKeyedWrite(t,i){let r=t.receiver.visit(this),n=t.key.visit(this),a=t.value.visit(this);return r!==t.receiver||n!==t.key||a!==t.value?new xm(t.span,t.sourceSpan,r,n,a):t}visitAll(t){let i=[],r=!1;for(let n=0;n<t.length;++n){let a=t[n],o=a.visit(this);i[n]=o,r=r||o!==a}return r?i:t}visitChain(t,i){let r=this.visitAll(t.expressions);return r!==t.expressions?new Hc(t.span,t.sourceSpan,r):t}visitCall(t,i){let r=t.receiver.visit(this),n=this.visitAll(t.args);return r!==t.receiver||n!==t.args?new js(t.span,t.sourceSpan,r,n,t.argumentSpan):t}visitSafeCall(t,i){let r=t.receiver.visit(this),n=this.visitAll(t.args);return r!==t.receiver||n!==t.args?new Au(t.span,t.sourceSpan,r,n,t.argumentSpan):t}visitSafeKeyedRead(t,i){let r=t.receiver.visit(this),n=t.key.visit(this);return r!==t.receiver||n!==t.key?new yu(t.span,t.sourceSpan,r,n):t}},zf=class{constructor(t,i,r,n,a,o){this.name=t,this.expression=i,this.type=r,this.sourceSpan=n,this.keySpan=a,this.valueSpan=o,this.isLiteral=this.type===Fc.LITERAL_ATTR,this.isAnimation=this.type===Fc.ANIMATION}},Fc=function(e){return e[e.DEFAULT=0]="DEFAULT",e[e.LITERAL_ATTR=1]="LITERAL_ATTR",e[e.ANIMATION=2]="ANIMATION",e[e.TWO_WAY=3]="TWO_WAY",e}(Fc||{}),Bb=class{constructor(t,i,r,n,a,o,s){this.name=t,this.targetOrPhase=i,this.type=r,this.handler=n,this.sourceSpan=a,this.handlerSpan=o,this.keySpan=s}},WE=class{constructor(t,i,r,n,a){this.name=t,this.value=i,this.sourceSpan=r,this.keySpan=n,this.valueSpan=a}},Vb=class{constructor(t,i,r,n,a,o,s,l){this.name=t,this.type=i,this.securityContext=r,this.value=n,this.unit=a,this.sourceSpan=o,this.keySpan=s,this.valueSpan=l}},Gc=class{static{this.event=et("$event")}};function $q(e,t,i,r,n,a,o){e??=new dg(o);let s=new Tu(e,t,r,!1,n,a),l=[];xx(ZL(i).visit(s,Ni.Statement),l),QL(s.temporaryCount,r,l),s.usesImplicitReceiver&&e.notifyImplicitReceiverUse();let c=l.length-1;if(c>=0){let d=l[c];d instanceof bn&&(l[c]=new Jr(d.expr))}return l}function Xq(e,t,i,r,n,a,o){e??=new dg(o);let s=new Tu(e,t,r,!1,n,a),l=ZL(i).visit(s,Ni.Statement);if(!(l instanceof bn))throw new Error("Illegal state: unsupported expression in two-way action binding.");l=Yq(l.expr).toStmt();let c=[];return xx(l,c),QL(s.temporaryCount,r,c),c.push(new Jr(Gc.event)),a?.add(Gc.event.name),s.usesImplicitReceiver&&e.notifyImplicitReceiverUse(),c}function G_(e){return new Il(E.twoWayBindingSet).callFn([e,Gc.event]).or(e.set(Gc.event))}function j_(e){return e instanceof ma||e instanceof Hs}function Yq(e){if(j_(e))return G_(e);if(e instanceof ci&&j_(e.rhs))return new ci(e.operator,e.lhs,G_(e.rhs));if(e instanceof co&&j_(e.falseCase))return new co(e.condition,e.trueCase,G_(e.falseCase));if(e instanceof kl){let t=e.condition;for(;;)if(t instanceof kl)t=t.condition;else{if(j_(t))return G_(t);break}}throw new Error("Illegal state: unsupported expression in two-way action binding.")}function $L(e,t){return Qq(e,t)}var qE=class{constructor(t,i){this.stmts=t,this.currValExpr=i}};function XL(e,t,i,r){e||(e=new dg);let n=new Tu(e,t,r,!1),a=i.visit(n,Ni.Expression),o=YL(n,r);return n.usesImplicitReceiver&&e.notifyImplicitReceiverUse(),new qE(o,a)}function Zq(e,t,i,r){let n=$L({createLiteralArrayConverter:()=>s=>zt(s),createLiteralMapConverter:s=>l=>xn(s.map((c,d)=>({key:c.key,value:l[d],quoted:c.quoted}))),createPipeConverter:()=>{throw new Error("Illegal State: Pipes are not allowed in this context")}},e),a=new Tu(t,i,r,!1),o=[];return xx(n.visit(a,Ni.Statement),o),o}function Kq(e,t,i,r){let n=new Tu(e,t,r,!0),a=n.visitInterpolation(i,Ni.Expression);n.usesImplicitReceiver&&e.notifyImplicitReceiverUse();let o=YL(n,r),s=a.args;return{stmts:o,args:s}}function YL(e,t){let i=[];for(let r=0;r<e.temporaryCount;r++)i.push(KL(t,r));return i}function Qq(e,t){let i=new XE(e);return t.visit(i)}function ZL(e){return $L({createLiteralArrayConverter:()=>i=>zt(i),createLiteralMapConverter:i=>r=>{let n=i.map((a,o)=>({key:a.key,value:r[o],quoted:a.quoted}));return xn(n)},createPipeConverter:i=>{throw new Error(`Illegal State: Actions are not allowed to contain pipes. Pipe: ${i}`)}},e)}function $E(e,t){return`tmp_${e}_${t}`}function KL(e,t){return new Wn($E(e,t))}function QL(e,t,i){for(let r=e-1;r>=0;r--)i.unshift(KL(t,r))}var Ni=function(e){return e[e.Statement=0]="Statement",e[e.Expression=1]="Expression",e}(Ni||{});function Jq(e,t){if(e!==Ni.Statement)throw new Error(`Expected a statement, but saw ${t}`)}function VO(e,t){if(e!==Ni.Expression)throw new Error(`Expected an expression, but saw ${t}`)}function sa(e,t){return e===Ni.Statement?t.toStmt():t}var XE=class extends GE{constructor(t){super(),this._converterFactory=t}visitPipe(t,i){let r=[t.exp,...t.args].map(n=>n.visit(this,i));return new Vc(t.span,t.sourceSpan,r,this._converterFactory.createPipeConverter(t.name,r.length))}visitLiteralArray(t,i){let r=t.expressions.map(n=>n.visit(this,i));return new Vc(t.span,t.sourceSpan,r,this._converterFactory.createLiteralArrayConverter(t.expressions.length))}visitLiteralMap(t,i){let r=t.values.map(n=>n.visit(this,i));return new Vc(t.span,t.sourceSpan,r,this._converterFactory.createLiteralMapConverter(t.keys))}},Tu=class{constructor(t,i,r,n,a,o){this._localResolver=t,this._implicitReceiver=i,this.bindingId=r,this.supportsInterpolation=n,this.baseSourceSpan=a,this.implicitReceiverAccesses=o,this._nodeMap=new Map,this._resultMap=new Map,this._currentTemporary=0,this.temporaryCount=0,this.usesImplicitReceiver=!1}visitUnary(t,i){let r;switch(t.operator){case"+":r=cu.Plus;break;case"-":r=cu.Minus;break;default:throw new Error(`Unsupported operator ${t.operator}`)}return sa(i,new hu(r,this._visit(t.expr,Ni.Expression),void 0,this.convertSourceSpan(t.span)))}visitBinary(t,i){let r;switch(t.operation){case"+":r=ze.Plus;break;case"-":r=ze.Minus;break;case"*":r=ze.Multiply;break;case"/":r=ze.Divide;break;case"%":r=ze.Modulo;break;case"&&":r=ze.And;break;case"||":r=ze.Or;break;case"==":r=ze.Equals;break;case"!=":r=ze.NotEquals;break;case"===":r=ze.Identical;break;case"!==":r=ze.NotIdentical;break;case"<":r=ze.Lower;break;case">":r=ze.Bigger;break;case"<=":r=ze.LowerEquals;break;case">=":r=ze.BiggerEquals;break;case"??":return this.convertNullishCoalesce(t,i);default:throw new Error(`Unsupported operation ${t.operation}`)}return sa(i,new ci(r,this._visit(t.left,Ni.Expression),this._visit(t.right,Ni.Expression),void 0,this.convertSourceSpan(t.span)))}visitChain(t,i){return Jq(i,t),this.visitAll(t.expressions,i)}visitConditional(t,i){let r=this._visit(t.condition,Ni.Expression);return sa(i,r.conditional(this._visit(t.trueExp,Ni.Expression),this._visit(t.falseExp,Ni.Expression),this.convertSourceSpan(t.span)))}visitPipe(t,i){throw new Error(`Illegal state: Pipes should have been converted into functions. Pipe: ${t.name}`)}visitImplicitReceiver(t,i){return VO(i,t),this.usesImplicitReceiver=!0,this._implicitReceiver}visitThisReceiver(t,i){return this.visitImplicitReceiver(t,i)}visitInterpolation(t,i){if(!this.supportsInterpolation)throw new Error("Unexpected interpolation");VO(i,t);let r=[];for(let a=0;a<t.strings.length-1;a++)r.push(L(t.strings[a])),r.push(this._visit(t.expressions[a],Ni.Expression));r.push(L(t.strings[t.strings.length-1]));let n=t.strings;return n.length===2&&n[0]===""&&n[1]===""?r=[r[1]]:t.expressions.length>=9&&(r=[zt(r)]),new YE(r)}visitKeyedRead(t,i){let r=this.leftMostSafeNode(t);return r?this.convertSafeAccess(t,r,i):sa(i,this._visit(t.receiver,Ni.Expression).key(this._visit(t.key,Ni.Expression)))}visitKeyedWrite(t,i){let r=this._visit(t.receiver,Ni.Expression),n=this._visit(t.key,Ni.Expression),a=this._visit(t.value,Ni.Expression);return r===this._implicitReceiver&&this._localResolver.maybeRestoreView(),sa(i,r.key(n).set(a))}visitLiteralArray(t,i){throw new Error("Illegal State: literal arrays should have been converted into functions")}visitLiteralMap(t,i){throw new Error("Illegal State: literal maps should have been converted into functions")}visitLiteralPrimitive(t,i){let r=t.value===null||t.value===void 0||t.value===!0||t.value===!0?da:void 0;return sa(i,L(t.value,r,this.convertSourceSpan(t.span)))}_getLocal(t,i){return this._localResolver.globals?.has(t)&&i instanceof Bc?null:this._localResolver.getLocal(t)}visitPrefixNot(t,i){return sa(i,bL(this._visit(t.expression,Ni.Expression)))}visitNonNullAssert(t,i){return sa(i,this._visit(t.expression,Ni.Expression))}visitPropertyRead(t,i){let r=this.leftMostSafeNode(t);if(r)return this.convertSafeAccess(t,r,i);{let n=null,a=this.usesImplicitReceiver,o=this._visit(t.receiver,Ni.Expression);return o===this._implicitReceiver&&(n=this._getLocal(t.name,t.receiver),n&&(this.usesImplicitReceiver=a,this.addImplicitReceiverAccess(t.name))),n==null&&(n=o.prop(t.name,this.convertSourceSpan(t.span))),sa(i,n)}}visitPropertyWrite(t,i){let r=this._visit(t.receiver,Ni.Expression),n=this.usesImplicitReceiver,a=null;if(r===this._implicitReceiver){let o=this._getLocal(t.name,t.receiver);if(o)if(o instanceof ma)a=o,this.usesImplicitReceiver=n,this.addImplicitReceiverAccess(t.name);else{let s=t.name,l=t.value instanceof fn?t.value.name:void 0;throw new Error(`Cannot assign value "${l}" to template variable "${s}". Template variables are read-only.`)}}return a===null&&(a=r.prop(t.name,this.convertSourceSpan(t.span))),sa(i,a.set(this._visit(t.value,Ni.Expression)))}visitSafePropertyRead(t,i){return this.convertSafeAccess(t,this.leftMostSafeNode(t),i)}visitSafeKeyedRead(t,i){return this.convertSafeAccess(t,this.leftMostSafeNode(t),i)}visitAll(t,i){return t.map(r=>this._visit(r,i))}visitCall(t,i){let r=this.leftMostSafeNode(t);if(r)return this.convertSafeAccess(t,r,i);let n=this.visitAll(t.args,Ni.Expression);if(t instanceof Vc)return sa(i,t.converter(n));let a=t.receiver;if(a instanceof fn&&a.receiver instanceof Hn&&!(a.receiver instanceof Bc)&&a.name==="$any"){if(n.length!==1)throw new Error(`Invalid call to $any, expected 1 argument but received ${n.length||"none"}`);return sa(i,n[0])}let o=this._visit(a,Ni.Expression).callFn(n,this.convertSourceSpan(t.span));return sa(i,o)}visitSafeCall(t,i){return this.convertSafeAccess(t,this.leftMostSafeNode(t),i)}_visit(t,i){let r=this._resultMap.get(t);return r||(this._nodeMap.get(t)||t).visit(this,i)}convertSafeAccess(t,i,r){let n=this._visit(i.receiver,Ni.Expression),a;this.needsTemporaryInSafeAccess(i.receiver)&&(a=this.allocateTemporary(),n=a.set(n),this._resultMap.set(i.receiver,a));let o=n.isBlank();i instanceof Au?this._nodeMap.set(i,new js(i.span,i.sourceSpan,i.receiver,i.args,i.argumentSpan)):i instanceof yu?this._nodeMap.set(i,new Fl(i.span,i.sourceSpan,i.receiver,i.key)):this._nodeMap.set(i,new fn(i.span,i.sourceSpan,i.nameSpan,i.receiver,i.name));let s=this._visit(t,Ni.Expression);return this._nodeMap.delete(i),a&&this.releaseTemporary(a),sa(r,o.conditional(mu,s))}convertNullishCoalesce(t,i){let r=this._visit(t.left,Ni.Expression),n=this._visit(t.right,Ni.Expression),a=this.allocateTemporary();return this.releaseTemporary(a),sa(i,a.set(r).notIdentical(mu).and(a.notIdentical(L(void 0))).conditional(a,n))}leftMostSafeNode(t){let i=(r,n)=>(this._nodeMap.get(n)||n).visit(r);return t.visit({visitUnary(r){return null},visitBinary(r){return null},visitChain(r){return null},visitConditional(r){return null},visitCall(r){return i(this,r.receiver)},visitSafeCall(r){return i(this,r.receiver)||r},visitImplicitReceiver(r){return null},visitThisReceiver(r){return null},visitInterpolation(r){return null},visitKeyedRead(r){return i(this,r.receiver)},visitKeyedWrite(r){return null},visitLiteralArray(r){return null},visitLiteralMap(r){return null},visitLiteralPrimitive(r){return null},visitPipe(r){return null},visitPrefixNot(r){return null},visitNonNullAssert(r){return i(this,r.expression)},visitPropertyRead(r){return i(this,r.receiver)},visitPropertyWrite(r){return null},visitSafePropertyRead(r){return i(this,r.receiver)||r},visitSafeKeyedRead(r){return i(this,r.receiver)||r}})}needsTemporaryInSafeAccess(t){let i=(n,a)=>a&&(this._nodeMap.get(a)||a).visit(n),r=(n,a)=>a.some(o=>i(n,o));return t.visit({visitUnary(n){return i(this,n.expr)},visitBinary(n){return i(this,n.left)||i(this,n.right)},visitChain(n){return!1},visitConditional(n){return i(this,n.condition)||i(this,n.trueExp)||i(this,n.falseExp)},visitCall(n){return!0},visitSafeCall(n){return!0},visitImplicitReceiver(n){return!1},visitThisReceiver(n){return!1},visitInterpolation(n){return r(this,n.expressions)},visitKeyedRead(n){return!1},visitKeyedWrite(n){return!1},visitLiteralArray(n){return!0},visitLiteralMap(n){return!0},visitLiteralPrimitive(n){return!1},visitPipe(n){return!0},visitPrefixNot(n){return i(this,n.expression)},visitNonNullAssert(n){return i(this,n.expression)},visitPropertyRead(n){return!1},visitPropertyWrite(n){return!1},visitSafePropertyRead(n){return!1},visitSafeKeyedRead(n){return!1}})}allocateTemporary(){let t=this._currentTemporary++;return this.temporaryCount=Math.max(this._currentTemporary,this.temporaryCount),new lo($E(this.bindingId,t))}releaseTemporary(t){if(this._currentTemporary--,t.name!=$E(this.bindingId,this._currentTemporary))throw new Error(`Temporary ${t.name} released out of order`)}convertSourceSpan(t){if(this.baseSourceSpan){let i=this.baseSourceSpan.start.moveBy(t.start),r=this.baseSourceSpan.start.moveBy(t.end),n=this.baseSourceSpan.fullStart.moveBy(t.start);return new Qt(i,r,n)}else return null}addImplicitReceiverAccess(t){this.implicitReceiverAccesses&&this.implicitReceiverAccesses.add(t)}};function xx(e,t){Array.isArray(e)?e.forEach(i=>xx(i,t)):t.push(e)}function W_(){throw new Error("Unsupported operation")}var YE=class extends Pi{constructor(t){super(null,null),this.args=t,this.isConstant=W_,this.isEquivalent=W_,this.visitExpression=W_,this.clone=W_}},dg=class{constructor(t){this.globals=t}notifyImplicitReceiverUse(){}maybeRestoreView(){}getLocal(t){return t===Gc.event.name?Gc.event:null}},Vc=class extends js{constructor(t,i,r,n){super(t,i,new zn(t,i),r,null),this.converter=n}},tb;function zO(){return tb||(tb={},q_(gi.HTML,["iframe|srcdoc","*|innerHTML","*|outerHTML"]),q_(gi.STYLE,["*|style"]),q_(gi.URL,["*|formAction","area|href","area|ping","audio|src","a|href","a|ping","blockquote|cite","body|background","del|cite","form|action","img|src","input|src","ins|cite","q|cite","source|src","track|src","video|poster","video|src"]),q_(gi.RESOURCE_URL,["applet|code","applet|codebase","base|href","embed|src","frame|src","head|profile","html|manifest","iframe|src","link|href","media|src","object|codebase","object|data","script|src"])),tb}function q_(e,t){for(let i of t)tb[i.toLowerCase()]=e}var e$=new Set(["sandbox","allow","allowfullscreen","referrerpolicy","csp","fetchpriority"]);function hS(e){return e$.has(e.toLowerCase())}var t$=new Set(["inherit","initial","revert","unset","alternate","alternate-reverse","normal","reverse","backwards","both","forwards","none","paused","running","ease","ease-in","ease-in-out","ease-out","linear","step-start","step-end","end","jump-both","jump-end","jump-none","jump-start","start"]),i$=["@media","@supports","@document","@layer","@container","@scope","@starting-style"],ZE=class{constructor(){this._animationDeclarationKeyframesRe=/(^|\s+)(?:(?:(['"])((?:\\\\|\\\2|(?!\2).)+)\2)|(-?[A-Za-z][\w\-]*))(?=[,\s]|$)/g}shimCssText(t,i,r=""){let n=[];t=t.replace(m$,s=>{if(s.match(p$))n.push(s);else{let l=s.match(h$);n.push((l?.join("")??"")+`
`)}return fS}),t=this._insertDirectives(t);let a=this._scopeCssText(t,i,r),o=0;return a.replace(f$,()=>n[o++])}_insertDirectives(t){return t=this._insertPolyfillDirectivesInCssText(t),this._insertPolyfillRulesInCssText(t)}_scopeKeyframesRelatedCss(t,i){let r=new Set,n=$_(t,a=>this._scopeLocalKeyframeDeclarations(a,i,r));return $_(n,a=>this._scopeAnimationRule(a,i,r))}_scopeLocalKeyframeDeclarations(t,i,r){return Bt(Z({},t),{selector:t.selector.replace(/(^@(?:-webkit-)?keyframes(?:\s+))(['"]?)(.+)\2(\s*)$/,(n,a,o,s,l)=>(r.add(jO(s,o)),`${a}${o}${i}_${s}${o}${l}`))})}_scopeAnimationKeyframe(t,i,r){return t.replace(/^(\s*)(['"]?)(.+?)\2(\s*)$/,(n,a,o,s,l)=>(s=`${r.has(jO(s,o))?i+"_":""}${s}`,`${a}${o}${s}${o}${l}`))}_scopeAnimationRule(t,i,r){let n=t.content.replace(/((?:^|\s+|;)(?:-webkit-)?animation(?:\s*):(?:\s*))([^;]+)/g,(a,o,s)=>o+s.replace(this._animationDeclarationKeyframesRe,(l,c,d="",u,h)=>u?`${c}${this._scopeAnimationKeyframe(`${d}${u}${d}`,i,r)}`:t$.has(h)?l:`${c}${this._scopeAnimationKeyframe(h,i,r)}`));return n=n.replace(/((?:^|\s+|;)(?:-webkit-)?animation-name(?:\s*):(?:\s*))([^;]+)/g,(a,o,s)=>`${o}${s.split(",").map(l=>this._scopeAnimationKeyframe(l,i,r)).join(",")}`),Bt(Z({},t),{content:n})}_insertPolyfillDirectivesInCssText(t){return t.replace(r$,function(...i){return i[2]+"{"})}_insertPolyfillRulesInCssText(t){return t.replace(n$,(...i)=>{let r=i[0].replace(i[1],"").replace(i[2],"");return i[4]+r})}_scopeCssText(t,i,r){let n=this._extractUnscopedRulesFromCssText(t);return t=this._insertPolyfillHostInCssText(t),t=this._convertColonHost(t),t=this._convertColonHostContext(t),t=this._convertShadowDOMSelectors(t),i&&(t=this._scopeKeyframesRelatedCss(t,i),t=this._scopeSelectors(t,i,r)),t=t+`
`+n,t.trim()}_extractUnscopedRulesFromCssText(t){let i="",r;for(UO.lastIndex=0;(r=UO.exec(t))!==null;){let n=r[0].replace(r[2],"").replace(r[1],r[4]);i+=n+`

`}return i}_convertColonHost(t){return t.replace(a$,(i,r,n)=>{if(r){let a=[],o=r.split(",").map(s=>s.trim());for(let s of o){if(!s)break;let l=Kd+s.replace(zb,"")+n;a.push(l)}return a.join(",")}else return Kd+n})}_convertColonHostContext(t){return t.replace(o$,i=>{let r=[[]],n;for(;n=s$.exec(i);){let a=(n[1]??"").trim().split(",").map(s=>s.trim()).filter(s=>s!==""),o=r.length;A$(r,a.length);for(let s=0;s<a.length;s++)for(let l=0;l<o;l++)r[l+s*o].push(a[s]);i=n[2]}return r.map(a=>S$(a,i)).join(", ")})}_convertShadowDOMSelectors(t){return l$.reduce((i,r)=>i.replace(r," "),t)}_scopeSelectors(t,i,r){return $_(t,n=>{let a=n.selector,o=n.content;return n.selector[0]!=="@"?a=this._scopeSelector(n.selector,i,r):i$.some(s=>n.selector.startsWith(s))?o=this._scopeSelectors(n.content,i,r):(n.selector.startsWith("@font-face")||n.selector.startsWith("@page"))&&(o=this._stripScopingSelectors(n.content)),new ug(a,o)})}_stripScopingSelectors(t){return $_(t,i=>{let r=i.selector.replace(GO," ").replace(HO," ");return new ug(r,i.content)})}_scopeSelector(t,i,r){return t.split(",").map(n=>n.trim().split(GO)).map(n=>{let[a,...o]=n;return[(l=>this._selectorNeedsScoping(l,i)?this._applySelectorScope(l,i,r):l)(a),...o].join(" ")}).join(", ")}_selectorNeedsScoping(t,i){return!this._makeScopeMatcher(i).test(t)}_makeScopeMatcher(t){let i=/\[/g,r=/\]/g;return t=t.replace(i,"\\[").replace(r,"\\]"),new RegExp("^("+t+")"+c$,"m")}_applySimpleSelectorScope(t,i,r){if(rm.lastIndex=0,rm.test(t)){let n=`[${r}]`;return t.replace(HO,(a,o)=>o.replace(/([^:]*)(:*)(.*)/,(s,l,c,d)=>l+n+c+d)).replace(rm,n+" ")}return i+" "+t}_applySelectorScope(t,i,r){let n=/\[is=([^\]]*)\]/g;i=i.replace(n,(p,...g)=>g[0]);let a="["+i+"]",o=p=>{let g=p.trim();if(!g)return"";if(p.indexOf(Kd)>-1)g=this._applySimpleSelectorScope(p,i,r);else{let v=p.replace(rm,"");if(v.length>0){let b=v.match(/([^:]*)(:*)(.*)/);b&&(g=b[1]+a+b[2]+b[3])}}return g},s=new KE(t);t=s.content();let l="",c=0,d,u=/( |>|\+|~(?!=))\s*/g,m=!(t.indexOf(Kd)>-1);for(;(d=u.exec(t))!==null;){let p=d[1],g=t.slice(c,d.index).trim();if(g.match(/__esc-ph-(\d+)__/)&&t[d.index+1]?.match(/[a-fA-F\d]/))continue;m=m||g.indexOf(Kd)>-1;let v=m?o(g):g;l+=`${v} ${p} `,c=u.lastIndex}let f=t.substring(c);return m=m||f.indexOf(Kd)>-1,l+=m?o(f):f,s.restore(l)}_insertPolyfillHostInCssText(t){return t.replace(u$,mS).replace(d$,zb)}},KE=class{constructor(t){this.placeholders=[],this.index=0,t=this._escapeRegexMatches(t,/(\[[^\]]*\])/g),t=t.replace(/(\\.)/g,(i,r)=>{let n=`__esc-ph-${this.index}__`;return this.placeholders.push(r),this.index++,n}),this._content=t.replace(/(:nth-[-\w]+)(\([^)]+\))/g,(i,r,n)=>{let a=`__ph-${this.index}__`;return this.placeholders.push(n),this.index++,r+a})}restore(t){return t.replace(/__(?:ph|esc-ph)-(\d+)__/g,(i,r)=>this.placeholders[+r])}content(){return this._content}_escapeRegexMatches(t,i){return t.replace(i,(r,n)=>{let a=`__ph-${this.index}__`;return this.placeholders.push(n),this.index++,a})}},r$=/polyfill-next-selector[^}]*content:[\s]*?(['"])(.*?)\1[;\s]*}([^{]*?){/gim,n$=/(polyfill-rule)[^}]*(content:[\s]*(['"])(.*?)\3)[;\s]*[^}]*}/gim,UO=/(polyfill-unscoped-rule)[^}]*(content:[\s]*(['"])(.*?)\3)[;\s]*[^}]*}/gim,zb="-shadowcsshost",mS="-shadowcsscontext",pS="(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))?([^,{]*)",a$=new RegExp(zb+pS,"gim"),o$=new RegExp(mS+pS,"gim"),s$=new RegExp(mS+pS,"im"),Kd=zb+"-no-combinator",HO=/-shadowcsshost-no-combinator([^\s]*)/,l$=[/::shadow/g,/::content/g,/\/shadow-deep\//g,/\/shadow\//g],GO=/(?:>>>)|(?:\/deep\/)|(?:::ng-deep)/g,c$="([>\\s~+[.,{:][\\s\\S]*)?$",rm=/-shadowcsshost/gim,d$=/:host/gim,u$=/:host-context/gim,h$=/\r?\n/g,m$=/\/\*[\s\S]*?\*\//g,p$=/\/\*\s*#\s*source(Mapping)?URL=/g,fS="%COMMENT%",f$=new RegExp(fS,"g"),qC="%BLOCK%",g$=new RegExp(`(\\s*(?:${fS}\\s*)*)([^;\\{\\}]+?)(\\s*)((?:{%BLOCK%}?\\s*;?)|(?:\\s*;))`,"g"),v$=new Map([["{","}"]]),JL="%COMMA_IN_PLACEHOLDER%",eB="%SEMI_IN_PLACEHOLDER%",tB="%COLON_IN_PLACEHOLDER%",_$=new RegExp(JL,"g"),b$=new RegExp(eB,"g"),x$=new RegExp(tB,"g"),ug=class{constructor(t,i){this.selector=t,this.content=i}};function $_(e,t){let i=C$(e),r=y$(i,v$,qC),n=0,a=r.escapedString.replace(g$,(...o)=>{let s=o[2],l="",c=o[4],d="";c&&c.startsWith("{"+qC)&&(l=r.blocks[n++],c=c.substring(qC.length+1),d="{");let u=t(new ug(s,l));return`${o[1]}${u.selector}${o[3]}${d}${u.content}${c}`});return E$(a)}var QE=class{constructor(t,i){this.escapedString=t,this.blocks=i}};function y$(e,t,i){let r=[],n=[],a=0,o=0,s=-1,l,c;for(let d=0;d<e.length;d++){let u=e[d];u==="\\"?d++:u===c?(a--,a===0&&(n.push(e.substring(s,d)),r.push(i),o=d,s=-1,l=c=void 0)):u===l?a++:a===0&&t.has(u)&&(l=u,c=t.get(u),a=1,s=d+1,r.push(e.substring(o,s)))}return s!==-1?(n.push(e.substring(s)),r.push(i)):r.push(e.substring(o)),new QE(r.join(""),n)}var w$={";":eB,",":JL,":":tB};function C$(e){let t=e,i=null;for(let r=0;r<t.length;r++){let n=t[r];if(n==="\\")r++;else if(i!==null)if(n===i)i=null;else{let a=w$[n];a&&(t=`${t.substr(0,r)}${a}${t.substr(r+1)}`,r+=a.length-1)}else(n==="'"||n==='"')&&(i=n)}return t}function E$(e){let t=e.replace(_$,",");return t=t.replace(b$,";"),t=t.replace(x$,":"),t}function jO(e,t){return t?e.replace(/((?:^|[^\\])(?:\\\\)*)\\(?=['"])/g,"$1"):e}function S$(e,t){let i=Kd;rm.lastIndex=0;let r=rm.test(t);if(e.length===0)return i+t;let n=[e.pop()||""];for(;e.length>0;){let a=n.length,o=e.pop();for(let s=0;s<a;s++){let l=n[s];n[a*2+s]=l+" "+o,n[a+s]=o+" "+l,n[s]=o+l}}return n.map(a=>r?`${a}${t}`:`${a}${i}${t}, ${a} ${i}${t}`).join(",")}function A$(e,t){let i=e.length;for(let r=1;r<t;r++)for(let n=0;n<i;n++)e[n+r*i]=e[n].slice(0)}var I=function(e){return e[e.ListEnd=0]="ListEnd",e[e.Statement=1]="Statement",e[e.Variable=2]="Variable",e[e.ElementStart=3]="ElementStart",e[e.Element=4]="Element",e[e.Template=5]="Template",e[e.ElementEnd=6]="ElementEnd",e[e.ContainerStart=7]="ContainerStart",e[e.Container=8]="Container",e[e.ContainerEnd=9]="ContainerEnd",e[e.DisableBindings=10]="DisableBindings",e[e.Conditional=11]="Conditional",e[e.EnableBindings=12]="EnableBindings",e[e.Text=13]="Text",e[e.Listener=14]="Listener",e[e.InterpolateText=15]="InterpolateText",e[e.Binding=16]="Binding",e[e.Property=17]="Property",e[e.StyleProp=18]="StyleProp",e[e.ClassProp=19]="ClassProp",e[e.StyleMap=20]="StyleMap",e[e.ClassMap=21]="ClassMap",e[e.Advance=22]="Advance",e[e.Pipe=23]="Pipe",e[e.Attribute=24]="Attribute",e[e.ExtractedAttribute=25]="ExtractedAttribute",e[e.Defer=26]="Defer",e[e.DeferOn=27]="DeferOn",e[e.DeferWhen=28]="DeferWhen",e[e.I18nMessage=29]="I18nMessage",e[e.HostProperty=30]="HostProperty",e[e.Namespace=31]="Namespace",e[e.ProjectionDef=32]="ProjectionDef",e[e.Projection=33]="Projection",e[e.RepeaterCreate=34]="RepeaterCreate",e[e.Repeater=35]="Repeater",e[e.TwoWayProperty=36]="TwoWayProperty",e[e.TwoWayListener=37]="TwoWayListener",e[e.I18nStart=38]="I18nStart",e[e.I18n=39]="I18n",e[e.I18nEnd=40]="I18nEnd",e[e.I18nExpression=41]="I18nExpression",e[e.I18nApply=42]="I18nApply",e[e.IcuStart=43]="IcuStart",e[e.IcuEnd=44]="IcuEnd",e[e.IcuPlaceholder=45]="IcuPlaceholder",e[e.I18nContext=46]="I18nContext",e[e.I18nAttributes=47]="I18nAttributes",e}(I||{}),bt=function(e){return e[e.LexicalRead=0]="LexicalRead",e[e.Context=1]="Context",e[e.TrackContext=2]="TrackContext",e[e.ReadVariable=3]="ReadVariable",e[e.NextContext=4]="NextContext",e[e.Reference=5]="Reference",e[e.GetCurrentView=6]="GetCurrentView",e[e.RestoreView=7]="RestoreView",e[e.ResetView=8]="ResetView",e[e.PureFunctionExpr=9]="PureFunctionExpr",e[e.PureFunctionParameterExpr=10]="PureFunctionParameterExpr",e[e.PipeBinding=11]="PipeBinding",e[e.PipeBindingVariadic=12]="PipeBindingVariadic",e[e.SafePropertyRead=13]="SafePropertyRead",e[e.SafeKeyedRead=14]="SafeKeyedRead",e[e.SafeInvokeFunction=15]="SafeInvokeFunction",e[e.SafeTernaryExpr=16]="SafeTernaryExpr",e[e.EmptyExpr=17]="EmptyExpr",e[e.AssignTemporaryExpr=18]="AssignTemporaryExpr",e[e.ReadTemporaryExpr=19]="ReadTemporaryExpr",e[e.SlotLiteralExpr=20]="SlotLiteralExpr",e[e.ConditionalCase=21]="ConditionalCase",e[e.ConstCollected=22]="ConstCollected",e[e.TwoWayBindingSet=23]="TwoWayBindingSet",e}(bt||{}),Ls=function(e){return e[e.None=0]="None",e[e.AlwaysInline=1]="AlwaysInline",e}(Ls||{}),gn=function(e){return e[e.Context=0]="Context",e[e.Identifier=1]="Identifier",e[e.SavedView=2]="SavedView",e[e.Alias=3]="Alias",e}(gn||{}),uo=function(e){return e[e.Normal=0]="Normal",e[e.TemplateDefinitionBuilder=1]="TemplateDefinitionBuilder",e}(uo||{}),dt=function(e){return e[e.Attribute=0]="Attribute",e[e.ClassName=1]="ClassName",e[e.StyleProperty=2]="StyleProperty",e[e.Property=3]="Property",e[e.Template=4]="Template",e[e.I18n=5]="I18n",e[e.Animation=6]="Animation",e[e.TwoWayProperty=7]="TwoWayProperty",e}(dt||{}),hg=function(e){return e[e.Creation=0]="Creation",e[e.Postproccessing=1]="Postproccessing",e}(hg||{}),km=function(e){return e[e.I18nText=0]="I18nText",e[e.I18nAttribute=1]="I18nAttribute",e}(km||{}),Ki=function(e){return e[e.None=0]="None",e[e.ElementTag=1]="ElementTag",e[e.TemplateTag=2]="TemplateTag",e[e.OpenTag=4]="OpenTag",e[e.CloseTag=8]="CloseTag",e[e.ExpressionIndex=16]="ExpressionIndex",e}(Ki||{}),Gn=function(e){return e[e.HTML=0]="HTML",e[e.SVG=1]="SVG",e[e.Math=2]="Math",e}(Gn||{}),ur=function(e){return e[e.Idle=0]="Idle",e[e.Immediate=1]="Immediate",e[e.Timer=2]="Timer",e[e.Hover=3]="Hover",e[e.Interaction=4]="Interaction",e[e.Viewport=5]="Viewport",e}(ur||{}),ru=function(e){return e[e.RootI18n=0]="RootI18n",e[e.Icu=1]="Icu",e[e.Attr=2]="Attr",e}(ru||{}),oo=function(e){return e[e.NgTemplate=0]="NgTemplate",e[e.Structural=1]="Structural",e[e.Block=2]="Block",e}(oo||{}),iB=Symbol("ConsumesSlot"),rB=Symbol("DependsOnSlotContext"),kg=Symbol("ConsumesVars"),yx=Symbol("UsesVarOffset"),Hl={[iB]:!0,numSlotsUsed:1},Wo={[rB]:!0},mo={[kg]:!0};function Nm(e){return e[iB]===!0}function gS(e){return e[rB]===!0}function $C(e){return e[kg]===!0}function WO(e){return e[yx]===!0}function Ws(e){return Z({kind:I.Statement,statement:e},Jt)}function nm(e,t,i,r){return Z({kind:I.Variable,xref:e,variable:t,initializer:i,flags:r},Jt)}var Jt={debugListId:null,prev:null,next:null};function T$(e,t,i){return Z(Z(Z({kind:I.InterpolateText,target:e,interpolation:t,sourceSpan:i},Wo),mo),Jt)}var Ur=class{constructor(t,i,r){if(this.strings=t,this.expressions=i,this.i18nPlaceholders=r,r.length!==0&&r.length!==i.length)throw new Error(`Expected ${i.length} placeholders to match interpolation expression count, but got ${r.length}`)}};function Du(e,t,i,r,n,a,o,s,l,c,d){return Z({kind:I.Binding,bindingKind:t,target:e,name:i,expression:r,unit:n,securityContext:a,isTextAttribute:o,isStructuralTemplateAttribute:s,templateKind:l,i18nContext:null,i18nMessage:c,sourceSpan:d},Jt)}function D$(e,t,i,r,n,a,o,s,l,c){return Z(Z(Z({kind:I.Property,target:e,name:t,expression:i,isAnimationTrigger:r,securityContext:n,sanitizer:null,isStructuralTemplateAttribute:a,templateKind:o,i18nContext:s,i18nMessage:l,sourceSpan:c},Wo),mo),Jt)}function M$(e,t,i,r,n,a,o,s,l){return Z(Z(Z({kind:I.TwoWayProperty,target:e,name:t,expression:i,securityContext:r,sanitizer:null,isStructuralTemplateAttribute:n,templateKind:a,i18nContext:o,i18nMessage:s,sourceSpan:l},Wo),mo),Jt)}function I$(e,t,i,r,n){return Z(Z(Z({kind:I.StyleProp,target:e,name:t,expression:i,unit:r,sourceSpan:n},Wo),mo),Jt)}function k$(e,t,i,r){return Z(Z(Z({kind:I.ClassProp,target:e,name:t,expression:i,sourceSpan:r},Wo),mo),Jt)}function N$(e,t,i){return Z(Z(Z({kind:I.StyleMap,target:e,expression:t,sourceSpan:i},Wo),mo),Jt)}function P$(e,t,i){return Z(Z(Z({kind:I.ClassMap,target:e,expression:t,sourceSpan:i},Wo),mo),Jt)}function R$(e,t,i,r,n,a,o,s,l,c){return Z(Z(Z({kind:I.Attribute,target:e,namespace:t,name:i,expression:r,securityContext:n,sanitizer:null,isTextAttribute:a,isStructuralTemplateAttribute:o,templateKind:s,i18nContext:null,i18nMessage:l,sourceSpan:c},Wo),mo),Jt)}function F$(e,t){return Z({kind:I.Advance,delta:e,sourceSpan:t},Jt)}function nB(e,t,i,r,n){return Z(Z(Z({kind:I.Conditional,target:e,targetSlot:t,test:i,conditions:r,processed:null,sourceSpan:n,contextValue:null},Jt),Wo),mo)}function O$(e,t,i,r){return Z(Z({kind:I.Repeater,target:e,targetSlot:t,collection:i,sourceSpan:r},Jt),Wo)}function L$(e,t,i,r){return Z(Z(Z({kind:I.DeferWhen,target:e,expr:t,prefetch:i,sourceSpan:r},Jt),Wo),mo)}function aB(e,t,i,r,n,a,o,s,l,c,d){return Z(Z(Z({kind:I.I18nExpression,context:e,target:t,i18nOwner:i,handle:r,expression:n,icuPlaceholder:a,i18nPlaceholder:o,resolutionTime:s,usage:l,name:c,sourceSpan:d},Jt),mo),Wo)}function B$(e,t,i){return Z({kind:I.I18nApply,owner:e,handle:t,sourceSpan:i},Jt)}var qO,$O,XO,YO,ZO,KO;function qs(e){return e instanceof tr}var tr=class extends Pi{constructor(t=null){super(null,t)}},Oa=class e extends tr{constructor(t){super(),this.name=t,this.kind=bt.LexicalRead}visitExpression(t,i){}isEquivalent(t){return this.name===t.name}isConstant(){return!1}transformInternalExpressions(){}clone(){return new e(this.name)}},Ub=class e extends tr{constructor(t,i,r){super(),this.target=t,this.targetSlot=i,this.offset=r,this.kind=bt.Reference}visitExpression(){}isEquivalent(t){return t instanceof e&&t.target===this.target}isConstant(){return!1}transformInternalExpressions(){}clone(){return new e(this.target,this.targetSlot,this.offset)}},Ll=class e extends tr{constructor(t){super(),this.view=t,this.kind=bt.Context}visitExpression(){}isEquivalent(t){return t instanceof e&&t.view===this.view}isConstant(){return!1}transformInternalExpressions(){}clone(){return new e(this.view)}},Hb=class e extends tr{constructor(t){super(),this.view=t,this.kind=bt.TrackContext}visitExpression(){}isEquivalent(t){return t instanceof e&&t.view===this.view}isConstant(){return!1}transformInternalExpressions(){}clone(){return new e(this.view)}},Gb=class e extends tr{constructor(){super(),this.kind=bt.NextContext,this.steps=1}visitExpression(){}isEquivalent(t){return t instanceof e&&t.steps===this.steps}isConstant(){return!1}transformInternalExpressions(){}clone(){let t=new e;return t.steps=this.steps,t}},JE=class e extends tr{constructor(){super(),this.kind=bt.GetCurrentView}visitExpression(){}isEquivalent(t){return t instanceof e}isConstant(){return!1}transformInternalExpressions(){}clone(){return new e}},jb=class e extends tr{constructor(t){super(),this.view=t,this.kind=bt.RestoreView}visitExpression(t,i){typeof this.view!="number"&&this.view.visitExpression(t,i)}isEquivalent(t){return!(t instanceof e)||typeof t.view!=typeof this.view?!1:typeof this.view=="number"?this.view===t.view:this.view.isEquivalent(t.view)}isConstant(){return!1}transformInternalExpressions(t,i){typeof this.view!="number"&&(this.view=Ke(this.view,t,i))}clone(){return new e(this.view instanceof Pi?this.view.clone():this.view)}},e2=class e extends tr{constructor(t){super(),this.expr=t,this.kind=bt.ResetView}visitExpression(t,i){this.expr.visitExpression(t,i)}isEquivalent(t){return t instanceof e&&this.expr.isEquivalent(t.expr)}isConstant(){return!1}transformInternalExpressions(t,i){this.expr=Ke(this.expr,t,i)}clone(){return new e(this.expr.clone())}},Wb=class e extends tr{constructor(t,i){super(),this.target=t,this.value=i,this.kind=bt.TwoWayBindingSet}visitExpression(t,i){this.target.visitExpression(t,i),this.value.visitExpression(t,i)}isEquivalent(t){return this.target.isEquivalent(t.target)&&this.value.isEquivalent(t.value)}isConstant(){return!1}transformInternalExpressions(t,i){this.target=Ke(this.target,t,i),this.value=Ke(this.value,t,i)}clone(){return new e(this.target,this.value)}},Bl=class e extends tr{constructor(t){super(),this.xref=t,this.kind=bt.ReadVariable,this.name=null}visitExpression(){}isEquivalent(t){return t instanceof e&&t.xref===this.xref}isConstant(){return!1}transformInternalExpressions(){}clone(){let t=new e(this.xref);return t.name=this.name,t}},Mu=class e extends tr{static{qO=kg,$O=yx}constructor(t,i){super(),this.kind=bt.PureFunctionExpr,this[qO]=!0,this[$O]=!0,this.varOffset=null,this.fn=null,this.body=t,this.args=i}visitExpression(t,i){this.body?.visitExpression(t,i);for(let r of this.args)r.visitExpression(t,i)}isEquivalent(t){return!(t instanceof e)||t.args.length!==this.args.length?!1:t.body!==null&&this.body!==null&&t.body.isEquivalent(this.body)&&t.args.every((i,r)=>i.isEquivalent(this.args[r]))}isConstant(){return!1}transformInternalExpressions(t,i){this.body!==null?this.body=Ke(this.body,t,i|Ri.InChildOperation):this.fn!==null&&(this.fn=Ke(this.fn,t,i));for(let r=0;r<this.args.length;r++)this.args[r]=Ke(this.args[r],t,i)}clone(){let t=new e(this.body?.clone()??null,this.args.map(i=>i.clone()));return t.fn=this.fn?.clone()??null,t.varOffset=this.varOffset,t}},wm=class e extends tr{constructor(t){super(),this.index=t,this.kind=bt.PureFunctionParameterExpr}visitExpression(){}isEquivalent(t){return t instanceof e&&t.index===this.index}isConstant(){return!0}transformInternalExpressions(){}clone(){return new e(this.index)}},Iu=class e extends tr{static{XO=kg,YO=yx}constructor(t,i,r,n){super(),this.target=t,this.targetSlot=i,this.name=r,this.args=n,this.kind=bt.PipeBinding,this[XO]=!0,this[YO]=!0,this.varOffset=null}visitExpression(t,i){for(let r of this.args)r.visitExpression(t,i)}isEquivalent(){return!1}isConstant(){return!1}transformInternalExpressions(t,i){for(let r=0;r<this.args.length;r++)this.args[r]=Ke(this.args[r],t,i)}clone(){let t=new e(this.target,this.targetSlot,this.name,this.args.map(i=>i.clone()));return t.varOffset=this.varOffset,t}},qb=class e extends tr{static{ZO=kg,KO=yx}constructor(t,i,r,n,a){super(),this.target=t,this.targetSlot=i,this.name=r,this.args=n,this.numArgs=a,this.kind=bt.PipeBindingVariadic,this[ZO]=!0,this[KO]=!0,this.varOffset=null}visitExpression(t,i){this.args.visitExpression(t,i)}isEquivalent(){return!1}isConstant(){return!1}transformInternalExpressions(t,i){this.args=Ke(this.args,t,i)}clone(){let t=new e(this.target,this.targetSlot,this.name,this.args.clone(),this.numArgs);return t.varOffset=this.varOffset,t}},Cm=class e extends tr{constructor(t,i){super(),this.receiver=t,this.name=i,this.kind=bt.SafePropertyRead}get index(){return this.name}visitExpression(t,i){this.receiver.visitExpression(t,i)}isEquivalent(){return!1}isConstant(){return!1}transformInternalExpressions(t,i){this.receiver=Ke(this.receiver,t,i)}clone(){return new e(this.receiver.clone(),this.name)}},Em=class e extends tr{constructor(t,i,r){super(r),this.receiver=t,this.index=i,this.kind=bt.SafeKeyedRead}visitExpression(t,i){this.receiver.visitExpression(t,i),this.index.visitExpression(t,i)}isEquivalent(){return!1}isConstant(){return!1}transformInternalExpressions(t,i){this.receiver=Ke(this.receiver,t,i),this.index=Ke(this.index,t,i)}clone(){return new e(this.receiver.clone(),this.index.clone(),this.sourceSpan)}},jc=class e extends tr{constructor(t,i){super(),this.receiver=t,this.args=i,this.kind=bt.SafeInvokeFunction}visitExpression(t,i){this.receiver.visitExpression(t,i);for(let r of this.args)r.visitExpression(t,i)}isEquivalent(){return!1}isConstant(){return!1}transformInternalExpressions(t,i){this.receiver=Ke(this.receiver,t,i);for(let r=0;r<this.args.length;r++)this.args[r]=Ke(this.args[r],t,i)}clone(){return new e(this.receiver.clone(),this.args.map(t=>t.clone()))}},Sm=class e extends tr{constructor(t,i){super(),this.guard=t,this.expr=i,this.kind=bt.SafeTernaryExpr}visitExpression(t,i){this.guard.visitExpression(t,i),this.expr.visitExpression(t,i)}isEquivalent(){return!1}isConstant(){return!1}transformInternalExpressions(t,i){this.guard=Ke(this.guard,t,i),this.expr=Ke(this.expr,t,i)}clone(){return new e(this.guard.clone(),this.expr.clone())}},mg=class e extends tr{constructor(){super(...arguments),this.kind=bt.EmptyExpr}visitExpression(t,i){}isEquivalent(t){return t instanceof e}isConstant(){return!0}clone(){return new e}transformInternalExpressions(){}},gs=class e extends tr{constructor(t,i){super(),this.expr=t,this.xref=i,this.kind=bt.AssignTemporaryExpr,this.name=null}visitExpression(t,i){this.expr.visitExpression(t,i)}isEquivalent(){return!1}isConstant(){return!1}transformInternalExpressions(t,i){this.expr=Ke(this.expr,t,i)}clone(){let t=new e(this.expr.clone(),this.xref);return t.name=this.name,t}},Vl=class e extends tr{constructor(t){super(),this.xref=t,this.kind=bt.ReadTemporaryExpr,this.name=null}visitExpression(t,i){}isEquivalent(){return this.xref===this.xref}isConstant(){return!1}transformInternalExpressions(t,i){}clone(){let t=new e(this.xref);return t.name=this.name,t}},$b=class e extends tr{constructor(t){super(),this.slot=t,this.kind=bt.SlotLiteralExpr}visitExpression(t,i){}isEquivalent(t){return t instanceof e&&t.slot===this.slot}isConstant(){return!0}clone(){return new e(this.slot)}transformInternalExpressions(){}},Xb=class e extends tr{constructor(t,i,r,n=null){super(),this.expr=t,this.target=i,this.targetSlot=r,this.alias=n,this.kind=bt.ConditionalCase}visitExpression(t,i){this.expr!==null&&this.expr.visitExpression(t,i)}isEquivalent(t){return t instanceof e&&t.expr===this.expr}isConstant(){return!0}clone(){return new e(this.expr,this.target,this.targetSlot)}transformInternalExpressions(t,i){this.expr!==null&&(this.expr=Ke(this.expr,t,i))}},pg=class e extends tr{constructor(t){super(),this.expr=t,this.kind=bt.ConstCollected}transformInternalExpressions(t,i){this.expr=t(this.expr,i)}visitExpression(t,i){this.expr.visitExpression(t,i)}isEquivalent(t){return t instanceof e?this.expr.isEquivalent(t.expr):!1}isConstant(){return this.expr.isConstant()}clone(){return new e(this.expr)}};function Ba(e,t){Tn(e,(i,r)=>(t(i,r),i),Ri.None)}var Ri=function(e){return e[e.None=0]="None",e[e.InChildOperation=1]="InChildOperation",e}(Ri||{});function XC(e,t,i){for(let r=0;r<e.expressions.length;r++)e.expressions[r]=Ke(e.expressions[r],t,i)}function Tn(e,t,i){switch(e.kind){case I.StyleProp:case I.StyleMap:case I.ClassProp:case I.ClassMap:case I.Binding:e.expression instanceof Ur?XC(e.expression,t,i):e.expression=Ke(e.expression,t,i);break;case I.Property:case I.HostProperty:case I.Attribute:e.expression instanceof Ur?XC(e.expression,t,i):e.expression=Ke(e.expression,t,i),e.sanitizer=e.sanitizer&&Ke(e.sanitizer,t,i);break;case I.TwoWayProperty:e.expression=Ke(e.expression,t,i),e.sanitizer=e.sanitizer&&Ke(e.sanitizer,t,i);break;case I.I18nExpression:e.expression=Ke(e.expression,t,i);break;case I.InterpolateText:XC(e.interpolation,t,i);break;case I.Statement:Yb(e.statement,t,i);break;case I.Variable:e.initializer=Ke(e.initializer,t,i);break;case I.Conditional:for(let r of e.conditions)r.expr!==null&&(r.expr=Ke(r.expr,t,i));e.processed!==null&&(e.processed=Ke(e.processed,t,i)),e.contextValue!==null&&(e.contextValue=Ke(e.contextValue,t,i));break;case I.Listener:case I.TwoWayListener:for(let r of e.handlerOps)Tn(r,t,i|Ri.InChildOperation);break;case I.ExtractedAttribute:e.expression=e.expression&&Ke(e.expression,t,i),e.trustedValueFn=e.trustedValueFn&&Ke(e.trustedValueFn,t,i);break;case I.RepeaterCreate:e.track=Ke(e.track,t,i),e.trackByFn!==null&&(e.trackByFn=Ke(e.trackByFn,t,i));break;case I.Repeater:e.collection=Ke(e.collection,t,i);break;case I.Defer:e.loadingConfig!==null&&(e.loadingConfig=Ke(e.loadingConfig,t,i)),e.placeholderConfig!==null&&(e.placeholderConfig=Ke(e.placeholderConfig,t,i)),e.resolverFn!==null&&(e.resolverFn=Ke(e.resolverFn,t,i));break;case I.I18nMessage:for(let[r,n]of e.params)e.params.set(r,Ke(n,t,i));for(let[r,n]of e.postprocessingParams)e.postprocessingParams.set(r,Ke(n,t,i));break;case I.DeferWhen:e.expr=Ke(e.expr,t,i);break;case I.Advance:case I.Container:case I.ContainerEnd:case I.ContainerStart:case I.DeferOn:case I.DisableBindings:case I.Element:case I.ElementEnd:case I.ElementStart:case I.EnableBindings:case I.I18n:case I.I18nApply:case I.I18nContext:case I.I18nEnd:case I.I18nStart:case I.IcuEnd:case I.IcuStart:case I.Namespace:case I.Pipe:case I.Projection:case I.ProjectionDef:case I.Template:case I.Text:case I.I18nAttributes:case I.IcuPlaceholder:break;default:throw new Error(`AssertionError: transformExpressionsInOp doesn't handle ${I[e.kind]}`)}}function Ke(e,t,i){if(e instanceof tr)e.transformInternalExpressions(t,i);else if(e instanceof ci)e.lhs=Ke(e.lhs,t,i),e.rhs=Ke(e.rhs,t,i);else if(e instanceof hu)e.expr=Ke(e.expr,t,i);else if(e instanceof ma)e.receiver=Ke(e.receiver,t,i);else if(e instanceof Hs)e.receiver=Ke(e.receiver,t,i),e.index=Ke(e.index,t,i);else if(e instanceof um)e.receiver=Ke(e.receiver,t,i),e.value=Ke(e.value,t,i);else if(e instanceof jf)e.receiver=Ke(e.receiver,t,i),e.index=Ke(e.index,t,i),e.value=Ke(e.value,t,i);else if(e instanceof ha){e.fn=Ke(e.fn,t,i);for(let r=0;r<e.args.length;r++)e.args[r]=Ke(e.args[r],t,i)}else if(e instanceof Go)for(let r=0;r<e.entries.length;r++)e.entries[r]=Ke(e.entries[r],t,i);else if(e instanceof fs)for(let r=0;r<e.entries.length;r++)e.entries[r].value=Ke(e.entries[r].value,t,i);else if(e instanceof co)e.condition=Ke(e.condition,t,i),e.trueCase=Ke(e.trueCase,t,i),e.falseCase!==null&&(e.falseCase=Ke(e.falseCase,t,i));else if(e instanceof dm)e.expr=Ke(e.expr,t,i);else if(e instanceof lb)e.value=Ke(e.value,t,i);else if(e instanceof db)for(let r=0;r<e.expressions.length;r++)e.expressions[r]=Ke(e.expressions[r],t,i);else if(e instanceof kl)e.condition=Ke(e.condition,t,i);else if(e instanceof cb)e.tag=Ke(e.tag,t,i),e.template.expressions=e.template.expressions.map(r=>Ke(r,t,i));else if(e instanceof uu)if(Array.isArray(e.body))for(let r=0;r<e.body.length;r++)Yb(e.body[r],t,i);else e.body=Ke(e.body,t,i);else if(!(e instanceof di)){if(!(e instanceof lo||e instanceof Il||e instanceof _n))throw new Error(`Unhandled expression kind: ${e.constructor.name}`)}return t(e,i)}function Yb(e,t,i){if(e instanceof bn)e.expr=Ke(e.expr,t,i);else if(e instanceof Jr)e.value=Ke(e.value,t,i);else if(e instanceof Wn)e.value!==void 0&&(e.value=Ke(e.value,t,i));else if(e instanceof hb){e.condition=Ke(e.condition,t,i);for(let r of e.trueCase)Yb(r,t,i);for(let r of e.falseCase)Yb(r,t,i)}else throw new Error(`Unhandled statement kind: ${e.constructor.name}`)}function oB(e){return e instanceof _n&&typeof e.value=="string"}var ve=(()=>{class e{static{this.nextListId=0}constructor(){this.debugListId=e.nextListId++,this.head={kind:I.ListEnd,next:null,prev:null,debugListId:this.debugListId},this.tail={kind:I.ListEnd,next:null,prev:null,debugListId:this.debugListId},this.head.next=this.tail,this.tail.prev=this.head}push(i){if(Array.isArray(i)){for(let n of i)this.push(n);return}e.assertIsNotEnd(i),e.assertIsUnowned(i),i.debugListId=this.debugListId;let r=this.tail.prev;i.prev=r,r.next=i,i.next=this.tail,this.tail.prev=i}prepend(i){if(i.length===0)return;for(let a of i)e.assertIsNotEnd(a),e.assertIsUnowned(a),a.debugListId=this.debugListId;let r=this.head.next,n=this.head;for(let a of i)n.next=a,a.prev=n,n=a;n.next=r,r.prev=n}*[Symbol.iterator](){let i=this.head.next;for(;i!==this.tail;){e.assertIsOwned(i,this.debugListId);let r=i.next;yield i,i=r}}*reversed(){let i=this.tail.prev;for(;i!==this.head;){e.assertIsOwned(i,this.debugListId);let r=i.prev;yield i,i=r}}static replace(i,r){e.assertIsNotEnd(i),e.assertIsNotEnd(r),e.assertIsOwned(i),e.assertIsUnowned(r),r.debugListId=i.debugListId,i.prev!==null&&(i.prev.next=r,r.prev=i.prev),i.next!==null&&(i.next.prev=r,r.next=i.next),i.debugListId=null,i.prev=null,i.next=null}static replaceWithMany(i,r){if(r.length===0){e.remove(i);return}e.assertIsNotEnd(i),e.assertIsOwned(i);let n=i.debugListId;i.debugListId=null;for(let d of r)e.assertIsNotEnd(d),e.assertIsUnowned(d);let{prev:a,next:o}=i;i.prev=null,i.next=null;let s=a;for(let d of r)this.assertIsUnowned(d),d.debugListId=n,s.next=d,d.prev=s,d.next=null,s=d;let l=r[0],c=s;a!==null&&(a.next=l,l.prev=a),o!==null&&(o.prev=c,c.next=o)}static remove(i){e.assertIsNotEnd(i),e.assertIsOwned(i),i.prev.next=i.next,i.next.prev=i.prev,i.debugListId=null,i.prev=null,i.next=null}static insertBefore(i,r){if(Array.isArray(i)){for(let n of i)this.insertBefore(n,r);return}if(e.assertIsOwned(r),r.prev===null)throw new Error("AssertionError: illegal operation on list start");e.assertIsNotEnd(i),e.assertIsUnowned(i),i.debugListId=r.debugListId,i.prev=null,r.prev.next=i,i.prev=r.prev,i.next=r,r.prev=i}static insertAfter(i,r){if(e.assertIsOwned(r),r.next===null)throw new Error("AssertionError: illegal operation on list end");e.assertIsNotEnd(i),e.assertIsUnowned(i),i.debugListId=r.debugListId,r.next.prev=i,i.next=r.next,i.prev=r,r.next=i}static assertIsUnowned(i){if(i.debugListId!==null)throw new Error(`AssertionError: illegal operation on owned node: ${I[i.kind]}`)}static assertIsOwned(i,r){if(i.debugListId===null)throw new Error(`AssertionError: illegal operation on unowned node: ${I[i.kind]}`);if(r!==void 0&&i.debugListId!==r)throw new Error(`AssertionError: node belongs to the wrong list (expected ${r}, actual ${i.debugListId})`)}static assertIsNotEnd(i){if(i.kind===I.ListEnd)throw new Error("AssertionError: illegal operation on list head or tail")}}return e})(),ho=class{constructor(){this.slot=null}},V$=new Set([I.Element,I.ElementStart,I.Container,I.ContainerStart,I.Template,I.RepeaterCreate]);function Wc(e){return V$.has(e.kind)}function z$(e,t,i,r,n,a){return Z(Z({kind:I.ElementStart,xref:t,tag:e,handle:new ho,attributes:null,localRefs:[],nonBindable:!1,namespace:i,i18nPlaceholder:r,startSourceSpan:n,wholeSourceSpan:a},Hl),Jt)}function Cx(e,t,i,r,n,a,o,s){return Z(Z({kind:I.Template,xref:e,templateKind:t,attributes:null,tag:i,handle:new ho,functionNameSuffix:r,decls:null,vars:null,localRefs:[],nonBindable:!1,namespace:n,i18nPlaceholder:a,startSourceSpan:o,wholeSourceSpan:s},Hl),Jt)}function U$(e,t,i,r,n,a,o,s,l,c){return Bt(Z(Z(Z({kind:I.RepeaterCreate,attributes:null,xref:e,handle:new ho,emptyView:t,track:r,trackByFn:null,tag:i,emptyTag:a,emptyAttributes:null,functionNameSuffix:"For",namespace:Gn.HTML,nonBindable:!1,localRefs:[],decls:null,vars:null,varNames:n,usesComponentInstance:!1,i18nPlaceholder:o,emptyI18nPlaceholder:s,startSourceSpan:l,wholeSourceSpan:c},Hl),Jt),mo),{numSlotsUsed:t===null?2:3})}function H$(e,t){return Z({kind:I.ElementEnd,xref:e,sourceSpan:t},Jt)}function G$(e){return Z({kind:I.DisableBindings,xref:e},Jt)}function j$(e){return Z({kind:I.EnableBindings,xref:e},Jt)}function sB(e,t,i,r){return Z(Z({kind:I.Text,xref:e,handle:new ho,initialValue:t,icuPlaceholder:i,sourceSpan:r},Hl),Jt)}function vS(e,t,i,r,n,a,o,s,l){let c=new ve;return c.push(n),Z({kind:I.Listener,target:e,targetSlot:t,tag:r,hostListener:s,name:i,handlerOps:c,handlerFnName:null,consumesDollarEvent:!1,isAnimationListener:a!==null,animationPhase:a,eventTarget:o,sourceSpan:l},Jt)}function lB(e,t,i,r,n,a){let o=new ve;return o.push(n),Z({kind:I.TwoWayListener,target:e,targetSlot:t,tag:r,name:i,handlerOps:o,handlerFnName:null,sourceSpan:a},Jt)}function cB(e,t,i){return Z(Z({kind:I.Pipe,xref:e,handle:t,name:i},Jt),Hl)}function W$(e){return Z({kind:I.Namespace,active:e},Jt)}function q$(e){return Z({kind:I.ProjectionDef,def:e},Jt)}function $$(e,t,i,r){return Z(Z({kind:I.Projection,xref:e,handle:new ho,selector:t,i18nPlaceholder:i,projectionSlotIndex:0,attributes:null,localRefs:[],sourceSpan:r},Jt),Hl)}function zo(e,t,i,r,n,a,o,s){return Z({kind:I.ExtractedAttribute,target:e,bindingKind:t,namespace:i,name:r,expression:n,i18nContext:a,i18nMessage:o,securityContext:s,trustedValueFn:null},Jt)}function X$(e,t,i,r,n,a){return Bt(Z(Z({kind:I.Defer,xref:e,handle:new ho,mainView:t,mainSlot:i,loadingView:null,loadingSlot:null,loadingConfig:null,loadingMinimumTime:null,loadingAfterTime:null,placeholderView:null,placeholderSlot:null,placeholderConfig:null,placeholderMinimumTime:null,errorView:null,errorSlot:null,metadata:r,resolverFn:n,sourceSpan:a},Jt),Hl),{numSlotsUsed:2})}function Zd(e,t,i,r){return Z({kind:I.DeferOn,defer:e,trigger:t,prefetch:i,sourceSpan:r},Jt)}function Y$(e,t,i,r,n,a,o,s){return Z({kind:I.I18nMessage,xref:e,i18nContext:t,i18nBlock:i,message:r,messagePlaceholder:n,params:a,postprocessingParams:o,needsPostprocessing:s,subMessages:[]},Jt)}function Ex(e,t,i,r){return Z(Z({kind:I.I18nStart,xref:e,handle:new ho,root:i??e,message:t,messageIndex:null,subTemplateIndex:null,context:null,sourceSpan:r},Jt),Hl)}function Sx(e,t){return Z({kind:I.I18nEnd,xref:e,sourceSpan:t},Jt)}function Z$(e,t,i,r){return Z({kind:I.IcuStart,xref:e,message:t,messagePlaceholder:i,context:null,sourceSpan:r},Jt)}function K$(e){return Z({kind:I.IcuEnd,xref:e},Jt)}function Q$(e,t,i){return Z({kind:I.IcuPlaceholder,xref:e,name:t,strings:i,expressionPlaceholders:[]},Jt)}function YC(e,t,i,r,n){if(i===null&&e!==ru.Attr)throw new Error("AssertionError: i18nBlock must be provided for non-attribute contexts.");return Z({kind:I.I18nContext,contextKind:e,xref:t,i18nBlock:i,message:r,sourceSpan:n,params:new Map,postprocessingParams:new Map},Jt)}function dB(e,t,i){return Z(Z({kind:I.I18nAttributes,xref:e,handle:t,target:i,i18nAttributesConfig:null},Jt),Hl)}function J$(e,t,i,r,n,a){return Z(Z({kind:I.HostProperty,name:e,expression:t,isAnimationTrigger:i,i18nContext:r,securityContext:n,sanitizer:null,sourceSpan:a},mo),Jt)}var uB="CTX_REF_MARKER",Ze=function(e){return e[e.Tmpl=0]="Tmpl",e[e.Host=1]="Host",e[e.Both=2]="Both",e}(Ze||{}),Zb=class{constructor(t,i,r){this.componentName=t,this.pool=i,this.compatibility=r,this.kind=Ze.Both,this.nextXrefId=0}allocateXrefId(){return this.nextXrefId++}},fg=class extends Zb{constructor(t,i,r,n,a,o,s){super(t,i,r),this.relativeContextFilePath=n,this.i18nUseExternalIds=a,this.deferBlocksMeta=o,this.allDeferrableDepsFn=s,this.kind=Ze.Tmpl,this.fnSuffix="Template",this.views=new Map,this.contentSelectors=null,this.consts=[],this.constsInitializers=[],this.root=new qc(this,this.allocateXrefId(),null),this.views.set(this.root.xref,this.root)}allocateView(t){let i=new qc(this,this.allocateXrefId(),t);return this.views.set(i.xref,i),i}get units(){return this.views.values()}addConst(t,i){for(let n=0;n<this.consts.length;n++)if(this.consts[n].isEquivalent(t))return n;let r=this.consts.length;return this.consts.push(t),i&&this.constsInitializers.push(...i),r}},Kb=class{constructor(t){this.xref=t,this.create=new ve,this.update=new ve,this.fnName=null,this.vars=null}*ops(){for(let t of this.create)if(yield t,t.kind===I.Listener||t.kind===I.TwoWayListener)for(let i of t.handlerOps)yield i;for(let t of this.update)yield t}},qc=class extends Kb{constructor(t,i,r){super(i),this.job=t,this.parent=r,this.contextVariables=new Map,this.aliases=new Set,this.decls=null}},Qb=class extends Zb{constructor(t,i,r){super(t,i,r),this.kind=Ze.Host,this.fnSuffix="HostBindings",this.root=new t2(this)}get units(){return[this.root]}},t2=class extends Kb{constructor(t){super(0),this.job=t,this.attributes=null}};function eX(e){for(let t of e.units)for(let i of t.ops())Tn(i,tX,Ri.None)}function tX(e){if(e instanceof ha&&e.fn instanceof Oa&&e.fn.name==="$any"){if(e.args.length!==1)throw new Error("The $any builtin function expects exactly one argument.");return e.args[0]}return e}function iX(e){let t=new Map;for(let i of e.units)for(let r of i.create)r.kind===I.I18nContext&&t.set(r.xref,r);for(let i of e.units)for(let r of i.update)r.kind===I.I18nExpression&&rX(t,r)&&ve.insertAfter(B$(r.i18nOwner,r.handle,null),r)}function rX(e,t){if(t.next?.kind!==I.I18nExpression)return!0;let i=e.get(t.context),r=e.get(t.next.context);if(i===void 0)throw new Error("AssertionError: expected an I18nContextOp to exist for the I18nExpressionOp's context");if(r===void 0)throw new Error("AssertionError: expected an I18nContextOp to exist for the next I18nExpressionOp's context");return i.i18nBlock!==null?i.i18nBlock!==r.i18nBlock:t.i18nOwner!==t.next.i18nOwner}function nX(e){for(let t of e.units){let i=t.update.head,r=[],n=null;for(let a of t.create){if(a.kind===I.I18nStart)n={blockXref:a.xref,lastSlotConsumer:a.xref};else if(a.kind===I.I18nEnd){for(let o of r)o.target=n.lastSlotConsumer,ve.insertBefore(o,i);r.length=0,n=null}if(Nm(a))for(n!==null&&(n.lastSlotConsumer=a.xref);i.next!==null;){if(n!==null&&i.kind===I.I18nExpression&&i.usage===km.I18nText&&i.i18nOwner===n.blockXref){let o=i;i=i.next,ve.remove(o),r.push(o);continue}if(gS(i)&&i.target!==a.xref)break;i=i.next}}}}function _S(e){let t=new Map;for(let i of e.create)Nm(i)&&(t.set(i.xref,i),i.kind===I.RepeaterCreate&&i.emptyView!==null&&t.set(i.emptyView,i));return t}function aX(e){for(let t of e.units){let i=_S(t);for(let r of t.ops())switch(r.kind){case I.Attribute:oX(t,r,i);break;case I.Property:if(!r.isAnimationTrigger){let n;r.i18nMessage!==null&&r.templateKind===null?n=dt.I18n:r.isStructuralTemplateAttribute?n=dt.Template:n=dt.Property,ve.insertBefore(zo(r.target,n,null,r.name,null,null,null,r.securityContext),Kh(i,r.target))}break;case I.TwoWayProperty:ve.insertBefore(zo(r.target,dt.TwoWayProperty,null,r.name,null,null,null,r.securityContext),Kh(i,r.target));break;case I.StyleProp:case I.ClassProp:t.job.compatibility===uo.TemplateDefinitionBuilder&&r.expression instanceof mg&&ve.insertBefore(zo(r.target,dt.Property,null,r.name,null,null,null,gi.STYLE),Kh(i,r.target));break;case I.Listener:if(!r.isAnimationListener){let n=zo(r.target,dt.Property,null,r.name,null,null,null,gi.NONE);if(e.kind===Ze.Host){if(e.compatibility)break;t.create.push(n)}else ve.insertBefore(n,Kh(i,r.target))}break;case I.TwoWayListener:if(e.kind!==Ze.Host){let n=zo(r.target,dt.Property,null,r.name,null,null,null,gi.NONE);ve.insertBefore(n,Kh(i,r.target))}break}}}function Kh(e,t){let i=e.get(t);if(i===void 0)throw new Error("All attributes should have an element-like target.");return i}function oX(e,t,i){if(t.expression instanceof Ur)return;let r=t.isTextAttribute||t.expression.isConstant();if(e.job.compatibility===uo.TemplateDefinitionBuilder&&(r&&=t.isTextAttribute),r){let n=zo(t.target,t.isStructuralTemplateAttribute?dt.Template:dt.Attribute,t.namespace,t.name,t.expression,t.i18nContext,t.i18nMessage,t.securityContext);if(e.job.kind===Ze.Host)e.create.push(n);else{let a=Kh(i,t.target);ve.insertBefore(n,a)}ve.remove(t)}}function sX(e,t){let i=e.get(t);if(i===void 0)throw new Error("All attributes should have an element-like target.");return i}function lX(e){let t=new Map;for(let i of e.units)for(let r of i.create)Wc(r)&&t.set(r.xref,r);for(let i of e.units)for(let r of i.ops())if(r.kind===I.Binding)switch(r.bindingKind){case dt.Attribute:if(r.name==="ngNonBindable"){ve.remove(r);let n=sX(t,r.target);n.nonBindable=!0}else{let[n,a]=ua(r.name);ve.replace(r,R$(r.target,n,a,r.expression,r.securityContext,r.isTextAttribute,r.isStructuralTemplateAttribute,r.templateKind,r.i18nMessage,r.sourceSpan))}break;case dt.Property:case dt.Animation:e.kind===Ze.Host?ve.replace(r,J$(r.name,r.expression,r.bindingKind===dt.Animation,r.i18nContext,r.securityContext,r.sourceSpan)):ve.replace(r,D$(r.target,r.name,r.expression,r.bindingKind===dt.Animation,r.securityContext,r.isStructuralTemplateAttribute,r.templateKind,r.i18nContext,r.i18nMessage,r.sourceSpan));break;case dt.TwoWayProperty:if(!(r.expression instanceof Pi))throw new Error(`Expected value of two-way property binding "${r.name}" to be an expression`);ve.replace(r,M$(r.target,r.name,r.expression,r.securityContext,r.isStructuralTemplateAttribute,r.templateKind,r.i18nContext,r.i18nMessage,r.sourceSpan));break;case dt.I18n:case dt.ClassName:case dt.StyleProperty:throw new Error(`Unhandled binding of kind ${dt[r.bindingKind]}`)}}var cX=new Set([E.attribute,E.classProp,E.element,E.elementContainer,E.elementContainerEnd,E.elementContainerStart,E.elementEnd,E.elementStart,E.hostProperty,E.i18nExp,E.listener,E.listener,E.property,E.styleProp,E.stylePropInterpolate1,E.stylePropInterpolate2,E.stylePropInterpolate3,E.stylePropInterpolate4,E.stylePropInterpolate5,E.stylePropInterpolate6,E.stylePropInterpolate7,E.stylePropInterpolate8,E.stylePropInterpolateV,E.syntheticHostListener,E.syntheticHostProperty,E.templateCreate,E.twoWayProperty,E.twoWayListener]);function dX(e){for(let t of e.units)QO(t.create),QO(t.update)}function QO(e){let t=null;for(let i of e){if(i.kind!==I.Statement||!(i.statement instanceof bn)){t=null;continue}if(!(i.statement.expr instanceof ha)||!(i.statement.expr.fn instanceof Il)){t=null;continue}let r=i.statement.expr.fn.value;if(!cX.has(r)){t=null;continue}if(t!==null&&t.instruction===r){let n=t.expression.callFn(i.statement.expr.args,i.statement.expr.sourceSpan,i.statement.expr.pure);t.expression=n,t.op.statement=n.toStmt(),ve.remove(i)}else t={op:i,instruction:r,expression:i.statement.expr}}}function uX(e){for(let t of e.units)for(let i of t.update)i.kind===I.Attribute&&i.expression instanceof Ur&&i.expression.strings.length===2&&i.expression.strings.every(n=>n==="")&&(i.expression=i.expression.expressions[0])}function hX(e){for(let t of e.units)for(let i of t.ops()){if(i.kind!==I.Conditional)continue;let r,n=i.conditions.findIndex(o=>o.expr===null);if(n>=0){let o=i.conditions.splice(n,1)[0].targetSlot;r=new $b(o)}else r=L(-1);let a=i.test==null?null:new gs(i.test,e.allocateXrefId());for(let o=i.conditions.length-1;o>=0;o--){let s=i.conditions[o];if(s.expr!==null){if(a!==null){let l=o===0?a:new Vl(a.xref);s.expr=new ci(ze.Identical,l,s.expr)}else if(s.alias!==null){let l=e.allocateXrefId();s.expr=new gs(s.expr,l),i.contextValue=new Vl(l)}r=new co(s.expr,new $b(s.targetSlot),r)}}i.processed=r,i.conditions=[]}}var mX=new Map([["&&",ze.And],[">",ze.Bigger],[">=",ze.BiggerEquals],["|",ze.BitwiseOr],["&",ze.BitwiseAnd],["/",ze.Divide],["==",ze.Equals],["===",ze.Identical],["<",ze.Lower],["<=",ze.LowerEquals],["-",ze.Minus],["%",ze.Modulo],["*",ze.Multiply],["!=",ze.NotEquals],["!==",ze.NotIdentical],["??",ze.NullishCoalesce],["||",ze.Or],["+",ze.Plus]]);function hB(e){let t=new Map([["svg",Gn.SVG],["math",Gn.Math]]);return e===null?Gn.HTML:t.get(e)??Gn.HTML}function pX(e){let t=new Map([["svg",Gn.SVG],["math",Gn.Math]]);for(let[i,r]of t.entries())if(r===e)return i;return null}function fX(e,t){return t===Gn.HTML?e:`:${pX(t)}:${e}`}function Am(e){return Array.isArray(e)?zt(e.map(Am)):L(e)}function gX(e){let t=new Map;for(let i of e.units)for(let r of i.create)if(r.kind===I.ExtractedAttribute){let n=t.get(r.target)||new i2(e.compatibility);t.set(r.target,n),n.add(r.bindingKind,r.name,r.expression,r.namespace,r.trustedValueFn),ve.remove(r)}if(e instanceof fg)for(let i of e.units)for(let r of i.create)if(r.kind==I.Projection){let n=t.get(r.xref);if(n!==void 0){let a=r2(n);a.entries.length>0&&(r.attributes=a)}}else Wc(r)&&(r.attributes=JO(e,t,r.xref),r.kind===I.RepeaterCreate&&r.emptyView!==null&&(r.emptyAttributes=JO(e,t,r.emptyView)));else if(e instanceof Qb)for(let[i,r]of t.entries()){if(i!==e.root.xref)throw new Error("An attribute would be const collected into the host binding's template function, but is not associated with the root xref.");let n=r2(r);n.entries.length>0&&(e.root.attributes=n)}}function JO(e,t,i){let r=t.get(i);if(r!==void 0){let n=r2(r);if(n.entries.length>0)return e.addConst(n)}return null}var Wh=Object.freeze([]),i2=class{get attributes(){return this.byKind.get(dt.Attribute)??Wh}get classes(){return this.byKind.get(dt.ClassName)??Wh}get styles(){return this.byKind.get(dt.StyleProperty)??Wh}get bindings(){return this.propertyBindings??Wh}get template(){return this.byKind.get(dt.Template)??Wh}get i18n(){return this.byKind.get(dt.I18n)??Wh}constructor(t){this.compatibility=t,this.known=new Map,this.byKind=new Map,this.propertyBindings=null,this.projectAs=null}isKnown(t,i){let r=this.known.get(t)??new Set;return this.known.set(t,r),r.has(i)?!0:(r.add(i),!1)}add(t,i,r,n,a){if(!(this.compatibility===uo.TemplateDefinitionBuilder&&(t===dt.Attribute||t===dt.ClassName||t===dt.StyleProperty))&&this.isKnown(t,i))return;if(i==="ngProjectAs"){if(r===null||!(r instanceof _n)||r.value==null||typeof r.value?.toString()!="string")throw Error("ngProjectAs must have a string literal value");this.projectAs=r.value.toString()}let s=this.arrayFor(t);if(s.push(...vX(n,i)),t===dt.Attribute||t===dt.StyleProperty){if(r===null)throw Error("Attribute, i18n attribute, & style element attributes must have a value");if(a!==null){if(!oB(r))throw Error("AssertionError: extracted attribute value should be string literal");s.push(bE(a,new qf([new $f(r.value)],[]),void 0,r.sourceSpan))}else s.push(r)}}arrayFor(t){return t===dt.Property||t===dt.TwoWayProperty?(this.propertyBindings??=[],this.propertyBindings):(this.byKind.has(t)||this.byKind.set(t,[]),this.byKind.get(t))}};function vX(e,t){let i=L(t);return e?[L(0),L(e),i]:[i]}function r2({attributes:e,bindings:t,classes:i,i18n:r,projectAs:n,styles:a,template:o}){let s=[...e];if(n!==null){let l=Cg(n)[0];s.push(L(5),Am(l))}return i.length>0&&s.push(L(1),...i),a.length>0&&s.push(L(2),...a),t.length>0&&s.push(L(3),...t),o.length>0&&s.push(L(4),...o),r.length>0&&s.push(L(6),...r),zt(s)}function _X(e){let t=new Map;for(let i of e.units){for(let r of i.create)r.kind===I.I18nAttributes&&t.set(r.target,r);for(let r of i.update)switch(r.kind){case I.Property:case I.Attribute:if(r.i18nContext===null||!(r.expression instanceof Ur))continue;let n=t.get(r.target);if(n===void 0)throw new Error("AssertionError: An i18n attribute binding instruction requires the owning element to have an I18nAttributes create instruction");if(n.target!==r.target)throw new Error("AssertionError: Expected i18nAttributes target element to match binding target element");let a=[];for(let o=0;o<r.expression.expressions.length;o++){let s=r.expression.expressions[o];if(r.expression.i18nPlaceholders.length!==r.expression.expressions.length)throw new Error(`AssertionError: An i18n attribute binding instruction requires the same number of expressions and placeholders, but found ${r.expression.i18nPlaceholders.length} placeholders and ${r.expression.expressions.length} expressions`);a.push(aB(r.i18nContext,n.target,n.xref,n.handle,s,null,r.expression.i18nPlaceholders[o],hg.Creation,km.I18nAttribute,r.name,r.sourceSpan))}ve.replaceWithMany(r,a);break}}}function bX(e){for(let t of e.units)for(let i of t.create)if(i.kind===I.Defer){if(i.metadata.deps.length===0||i.resolverFn!==null)continue;let r=[];for(let o of i.metadata.deps)if(o.isDeferrable){let s=vn([new er("m",Ul)],et("m").prop(o.isDefaultImport?"default":o.symbolName)),l=new Xf(o.importPath).prop("then").callFn([s]);r.push(l)}else r.push(o.type);let n=vn([],zt(r));if(i.handle.slot===null)throw new Error("AssertionError: slot must be assigned bfore extracting defer deps functions");let a=t.fnName?.replace("_Template","");i.resolverFn=e.pool.getSharedFunctionReference(n,`${a}_Defer_${i.handle.slot}_DepsFn`,!1)}}function xX(e){let t=new Map;for(let n of e.units)for(let a of n.ops())switch(a.kind){case I.Binding:case I.Property:case I.Attribute:case I.ExtractedAttribute:if(a.i18nMessage===null)continue;if(!t.has(a.i18nMessage)){let o=YC(ru.Attr,e.allocateXrefId(),null,a.i18nMessage,null);n.create.push(o),t.set(a.i18nMessage,o.xref)}a.i18nContext=t.get(a.i18nMessage);break}let i=new Map;for(let n of e.units)for(let a of n.create)switch(a.kind){case I.I18nStart:if(a.xref===a.root){let o=YC(ru.RootI18n,e.allocateXrefId(),a.xref,a.message,null);n.create.push(o),a.context=o.xref,i.set(a.xref,o)}break}for(let n of e.units)for(let a of n.create)if(a.kind===I.I18nStart&&a.xref!==a.root){let o=i.get(a.root);if(o===void 0)throw Error("AssertionError: Root i18n block i18n context should have been created.");a.context=o.xref,i.set(a.xref,o)}let r=null;for(let n of e.units)for(let a of n.create)switch(a.kind){case I.I18nStart:r=a;break;case I.I18nEnd:r=null;break;case I.IcuStart:if(r===null)throw Error("AssertionError: Unexpected ICU outside of an i18n block.");if(a.message.id!==r.message.id){let o=YC(ru.Icu,e.allocateXrefId(),r.root,a.message,null);n.create.push(o),a.context=o.xref}else a.context=r.context,i.get(r.xref).contextKind=ru.Icu;break}}function yX(e){let t=new Map;for(let i of e.units)for(let r of i.update.reversed())if(r.kind===I.Binding&&r.isTextAttribute){let n=t.get(r.target)||new Set;n.has(r.name)&&e.compatibility===uo.TemplateDefinitionBuilder&&(r.name==="style"||r.name==="class")&&ve.remove(r),n.add(r.name),t.set(r.target,n)}}function wX(e){for(let t of e.units)for(let i of t.create)i.kind===I.Defer&&(i.placeholderMinimumTime!==null&&(i.placeholderConfig=new pg(Am([i.placeholderMinimumTime]))),(i.loadingMinimumTime!==null||i.loadingAfterTime!==null)&&(i.loadingConfig=new pg(Am([i.loadingMinimumTime,i.loadingAfterTime]))))}function CX(e){let t=new Map;function i(n){if(t.has(n.xref))return t.get(n.xref);let a=new n2;for(let o of n.create)if(!(!Wc(o)||o.localRefs===null)){if(!Array.isArray(o.localRefs))throw new Error("LocalRefs were already processed, but were needed to resolve defer targets.");for(let s of o.localRefs)s.target===""&&a.targets.set(s.name,{xref:o.xref,slot:o.handle})}return t.set(n.xref,a),a}function r(n,a,o){switch(a.trigger.kind){case ur.Idle:case ur.Immediate:case ur.Timer:return;case ur.Hover:case ur.Interaction:case ur.Viewport:if(a.trigger.targetName===null){if(o===null)throw new Error("defer on trigger with no target name must have a placeholder block");let c=e.views.get(o);if(c==null)throw new Error("AssertionError: could not find placeholder view for defer on trigger");for(let d of c.create)if(Nm(d)&&(Wc(d)||d.kind===I.Projection)){a.trigger.targetXref=d.xref,a.trigger.targetView=o,a.trigger.targetSlotViewSteps=-1,a.trigger.targetSlot=d.handle;return}return}let s=o!==null?e.views.get(o):n,l=o!==null?-1:0;for(;s!==null;){let c=i(s);if(c.targets.has(a.trigger.targetName)){let{xref:d,slot:u}=c.targets.get(a.trigger.targetName);a.trigger.targetXref=d,a.trigger.targetView=s.xref,a.trigger.targetSlotViewSteps=l,a.trigger.targetSlot=u;return}s=s.parent!==null?e.views.get(s.parent):null,l++}break;default:throw new Error(`Trigger kind ${a.trigger.kind} not handled`)}}for(let n of e.units){let a=new Map;for(let o of n.create)switch(o.kind){case I.Defer:a.set(o.xref,o);break;case I.DeferOn:let s=a.get(o.defer);r(n,o,s.placeholderView);break}}}var n2=class{constructor(){this.targets=new Map}},EX=new Map([[I.ElementEnd,[I.ElementStart,I.Element]],[I.ContainerEnd,[I.ContainerStart,I.Container]],[I.I18nEnd,[I.I18nStart,I.I18n]]]),SX=new Set([I.Pipe]);function AX(e){for(let t of e.units)for(let i of t.create){let r=EX.get(i.kind);if(r===void 0)continue;let[n,a]=r,o=i.prev;for(;o!==null&&SX.has(o.kind);)o=o.prev;o!==null&&o.kind===n&&(o.kind=a,ve.remove(i))}}function TX(e){for(let t of e.units)for(let i of t.ops())Tn(i,r=>PX(r,{job:e}),Ri.None),Tn(i,RX,Ri.None)}var Eke=[ha,Go,fs,jc,Iu].map(e=>e.constructor.name);function Lo(e){return e instanceof hu?Lo(e.expr):e instanceof ci?Lo(e.lhs)||Lo(e.rhs):e instanceof co?e.falseCase&&Lo(e.falseCase)?!0:Lo(e.condition)||Lo(e.trueCase):e instanceof kl?Lo(e.condition):e instanceof gs?Lo(e.expr):e instanceof ma?Lo(e.receiver):e instanceof Hs?Lo(e.receiver)||Lo(e.index):e instanceof ha||e instanceof Go||e instanceof fs||e instanceof jc||e instanceof Iu}function DX(e){let t=new Set;return Ke(e,i=>(i instanceof gs&&t.add(i.xref),i),Ri.None),t}function MX(e,t,i){return Ke(e,r=>{if(r instanceof gs&&t.has(r.xref)){let n=new Vl(r.xref);return i.job.compatibility===uo.TemplateDefinitionBuilder?new gs(n,n.xref):n}return r},Ri.None),e}function qh(e,t,i){let r;if(Lo(e)){let n=i.job.allocateXrefId();r=[new gs(e,n),new Vl(n)]}else r=[e,e.clone()],MX(r[1],DX(r[0]),i);return new Sm(r[0],t(r[1]))}function IX(e){return e instanceof Cm||e instanceof Em||e instanceof jc}function kX(e){return e instanceof ma||e instanceof Hs||e instanceof ha}function mB(e){return IX(e)||kX(e)}function NX(e){if(mB(e)&&e.receiver instanceof Sm){let t=e.receiver;for(;t.expr instanceof Sm;)t=t.expr;return t}return null}function PX(e,t){if(!mB(e))return e;let i=NX(e);if(i){if(e instanceof ha)return i.expr=i.expr.callFn(e.args),e.receiver;if(e instanceof ma)return i.expr=i.expr.prop(e.name),e.receiver;if(e instanceof Hs)return i.expr=i.expr.key(e.index),e.receiver;if(e instanceof jc)return i.expr=qh(i.expr,r=>r.callFn(e.args),t),e.receiver;if(e instanceof Cm)return i.expr=qh(i.expr,r=>r.prop(e.name),t),e.receiver;if(e instanceof Em)return i.expr=qh(i.expr,r=>r.key(e.index),t),e.receiver}else{if(e instanceof jc)return qh(e.receiver,r=>r.callFn(e.args),t);if(e instanceof Cm)return qh(e.receiver,r=>r.prop(e.name),t);if(e instanceof Em)return qh(e.receiver,r=>r.key(e.index),t)}return e}function RX(e){return e instanceof Sm?new co(new ci(ze.Equals,e.guard,mu),mu,e.expr):e}var e3="\uFFFD",FX="#",OX="*",LX="/",BX=":",VX="[",zX="]",UX="|";function HX(e){let t=new Map,i=new Map,r=new Map;for(let a of e.units)for(let o of a.create)switch(o.kind){case I.I18nContext:let s=GX(e,o);a.create.push(s),t.set(o.xref,s),r.set(o.xref,o);break;case I.I18nStart:i.set(o.xref,o);break}let n=null;for(let a of e.units)for(let o of a.create)switch(o.kind){case I.IcuStart:n=o,ve.remove(o);let s=r.get(o.context);if(s.contextKind!==ru.Icu)continue;let l=i.get(s.i18nBlock);if(l.context===s.xref)continue;let c=i.get(l.root),d=t.get(c.context);if(d===void 0)throw Error("AssertionError: ICU sub-message should belong to a root message.");let u=t.get(s.xref);u.messagePlaceholder=o.messagePlaceholder,d.subMessages.push(u.xref);break;case I.IcuEnd:n=null,ve.remove(o);break;case I.IcuPlaceholder:if(n===null||n.context==null)throw Error("AssertionError: Unexpected ICU placeholder outside of i18n context");t.get(n.context).postprocessingParams.set(o.name,L(jX(o))),ve.remove(o);break}}function GX(e,t,i){let r=t3(t.params),n=t3(t.postprocessingParams),a=[...t.params.values()].some(o=>o.length>1);return Y$(e.allocateXrefId(),t.xref,t.i18nBlock,t.message,i??null,r,n,a)}function jX(e){if(e.strings.length!==e.expressionPlaceholders.length+1)throw Error(`AssertionError: Invalid ICU placeholder with ${e.strings.length} strings and ${e.expressionPlaceholders.length} expressions`);let t=e.expressionPlaceholders.map(am);return e.strings.flatMap((i,r)=>[i,t[r]||""]).join("")}function t3(e){let t=new Map;for(let[i,r]of e){let n=WX(r);n!==null&&t.set(i,L(n))}return t}function WX(e){if(e.length===0)return null;let t=e.map(i=>am(i));return t.length===1?t[0]:`${VX}${t.join(UX)}${zX}`}function am(e){if(e.flags&Ki.ElementTag&&e.flags&Ki.TemplateTag){if(typeof e.value!="object")throw Error("AssertionError: Expected i18n param value to have an element and template slot");let n=am(Bt(Z({},e),{value:e.value.element,flags:e.flags&~Ki.TemplateTag})),a=am(Bt(Z({},e),{value:e.value.template,flags:e.flags&~Ki.ElementTag}));return e.flags&Ki.OpenTag&&e.flags&Ki.CloseTag?`${a}${n}${a}`:e.flags&Ki.CloseTag?`${n}${a}`:`${a}${n}`}if(e.flags&Ki.OpenTag&&e.flags&Ki.CloseTag)return`${am(Bt(Z({},e),{flags:e.flags&~Ki.CloseTag}))}${am(Bt(Z({},e),{flags:e.flags&~Ki.OpenTag}))}`;if(e.flags===Ki.None)return`${e.value}`;let t="",i="";e.flags&Ki.ElementTag?t=FX:e.flags&Ki.TemplateTag&&(t=OX),t!==""&&(i=e.flags&Ki.CloseTag?LX:"");let r=e.subTemplateIndex===null?"":`${BX}${e.subTemplateIndex}`;return`${e3}${i}${t}${e.value}${r}${e3}`}function qX(e){for(let t of e.units){let i=new Map;for(let n of t.create){if(Nm(n)){if(n.handle.slot===null)throw new Error("AssertionError: expected slots to have been allocated before generating advance() calls")}else continue;i.set(n.xref,n.handle.slot)}let r=0;for(let n of t.update){if(gS(n)){if(!i.has(n.target))throw new Error(`AssertionError: reference to unknown slot for target ${n.target}`)}else continue;let a=i.get(n.target);if(r!==a){let o=a-r;if(o<0)throw new Error("AssertionError: slot counter should never need to move backwards");ve.insertBefore(F$(o,n.sourceSpan),n),r=a}}}}function $X(e){let t=e.compatibility===uo.TemplateDefinitionBuilder,i=[],r=0;for(let n of e.units)for(let a of n.create)a.kind===I.Projection&&(i.push(a.selector),a.projectionSlotIndex=r++);if(i.length>0){let n=null;if(i.length>1||i[0]!=="*"){let a=i.map(o=>o==="*"?o:Cg(o));n=e.pool.getConstLiteral(Am(a),t)}e.contentSelectors=e.pool.getConstLiteral(Am(i),t),e.root.create.prepend([q$(n)])}}function XX(e){ib(e.root,null)}function ib(e,t){let i=YX(e,t);for(let n of e.create)switch(n.kind){case I.Template:ib(e.job.views.get(n.xref),i);break;case I.RepeaterCreate:ib(e.job.views.get(n.xref),i),n.emptyView&&ib(e.job.views.get(n.emptyView),i);break;case I.Listener:case I.TwoWayListener:n.handlerOps.prepend(a2(e,i));break}let r=a2(e,i);e.update.prepend(r)}function YX(e,t){let i={view:e.xref,viewContextVariable:{kind:gn.Context,name:null,view:e.xref},contextVariables:new Map,aliases:e.aliases,references:[],parent:t};for(let r of e.contextVariables.keys())i.contextVariables.set(r,{kind:gn.Identifier,name:null,identifier:r});for(let r of e.create)switch(r.kind){case I.ElementStart:case I.Template:if(!Array.isArray(r.localRefs))throw new Error("AssertionError: expected localRefs to be an array");for(let n=0;n<r.localRefs.length;n++)i.references.push({name:r.localRefs[n].name,targetId:r.xref,targetSlot:r.handle,offset:n,variable:{kind:gn.Identifier,name:null,identifier:r.localRefs[n].name}});break}return i}function a2(e,t){let i=[];t.view!==e.xref&&i.push(nm(e.job.allocateXrefId(),t.viewContextVariable,new Gb,Ls.None));let r=e.job.views.get(t.view);for(let[n,a]of r.contextVariables){let o=new Ll(t.view),s=a===uB?o:new ma(o,a);i.push(nm(e.job.allocateXrefId(),t.contextVariables.get(n),s,Ls.None))}for(let n of r.aliases)i.push(nm(e.job.allocateXrefId(),n,n.expression.clone(),Ls.AlwaysInline));for(let n of t.references)i.push(nm(e.job.allocateXrefId(),n.variable,new Ub(n.targetId,n.targetSlot,n.offset),Ls.None));return t.parent!==null&&i.push(...a2(e,t.parent)),i}function ZX(e){for(let t of e.units)for(let i of t.ops())Tn(i,r=>r instanceof pg?L(e.addConst(r.expr)):r,Ri.None)}var i3="style.",r3="class.",KX="style!",n3="class!",a3="!important";function QX(e){for(let t of e.root.update)if(t.kind===I.Binding&&t.bindingKind===dt.Property)if(t.name.endsWith(a3)&&(t.name=t.name.substring(0,t.name.length-a3.length)),t.name.startsWith(i3)){t.bindingKind=dt.StyleProperty,t.name=t.name.substring(i3.length),JX(t.name)||(t.name=eY(t.name));let{property:i,suffix:r}=ZC(t.name);t.name=i,t.unit=r}else t.name.startsWith(KX)?(t.bindingKind=dt.StyleProperty,t.name="style"):t.name.startsWith(r3)?(t.bindingKind=dt.ClassName,t.name=ZC(t.name.substring(r3.length)).property):t.name.startsWith(n3)&&(t.bindingKind=dt.ClassName,t.name=ZC(t.name.substring(n3.length)).property)}function JX(e){return e.startsWith("--")}function eY(e){return e.replace(/[a-z][A-Z]/g,t=>t.charAt(0)+"-"+t.charAt(1)).toLowerCase()}function ZC(e){let t=e.indexOf("!important");t!==-1&&(e=t>0?e.substring(0,t):"");let i=null,r=e,n=e.lastIndexOf(".");return n>0&&(i=e.slice(n+1),r=e.substring(0,n)),{property:r,suffix:i}}function gg(e,t=!1){return xn(Object.keys(e).map(i=>({key:i,quoted:t,value:e[i]})))}var o2=class{visitText(t){return t.value}visitContainer(t){return t.children.map(i=>i.visit(this)).join("")}visitIcu(t){let i=Object.keys(t.cases).map(n=>`${n} {${t.cases[n].visit(this)}}`);return`{${t.expressionPlaceholder}, ${t.type}, ${i.join(" ")}}`}visitTagPlaceholder(t){return t.isVoid?this.formatPh(t.startName):`${this.formatPh(t.startName)}${t.children.map(i=>i.visit(this)).join("")}${this.formatPh(t.closeName)}`}visitPlaceholder(t){return this.formatPh(t.name)}visitBlockPlaceholder(t){return`${this.formatPh(t.startName)}${t.children.map(i=>i.visit(this)).join("")}${this.formatPh(t.closeName)}`}visitIcuPlaceholder(t,i){return this.formatPh(t.name)}formatPh(t){return`{${Dg(t,!1)}}`}},tY=new o2;function pB(e){return e.visit(tY)}var li=function(e){return e[e.Character=0]="Character",e[e.Identifier=1]="Identifier",e[e.PrivateIdentifier=2]="PrivateIdentifier",e[e.Keyword=3]="Keyword",e[e.String=4]="String",e[e.Operator=5]="Operator",e[e.Number=6]="Number",e[e.Error=7]="Error",e}(li||{}),iY=["var","let","as","null","undefined","true","false","if","else","this"],vg=class{tokenize(t){let i=new s2(t),r=[],n=i.scanToken();for(;n!=null;)r.push(n),n=i.scanToken();return r}},vs=class{constructor(t,i,r,n,a){this.index=t,this.end=i,this.type=r,this.numValue=n,this.strValue=a}isCharacter(t){return this.type==li.Character&&this.numValue==t}isNumber(){return this.type==li.Number}isString(){return this.type==li.String}isOperator(t){return this.type==li.Operator&&this.strValue==t}isIdentifier(){return this.type==li.Identifier}isPrivateIdentifier(){return this.type==li.PrivateIdentifier}isKeyword(){return this.type==li.Keyword}isKeywordLet(){return this.type==li.Keyword&&this.strValue=="let"}isKeywordAs(){return this.type==li.Keyword&&this.strValue=="as"}isKeywordNull(){return this.type==li.Keyword&&this.strValue=="null"}isKeywordUndefined(){return this.type==li.Keyword&&this.strValue=="undefined"}isKeywordTrue(){return this.type==li.Keyword&&this.strValue=="true"}isKeywordFalse(){return this.type==li.Keyword&&this.strValue=="false"}isKeywordThis(){return this.type==li.Keyword&&this.strValue=="this"}isError(){return this.type==li.Error}toNumber(){return this.type==li.Number?this.numValue:-1}toString(){switch(this.type){case li.Character:case li.Identifier:case li.Keyword:case li.Operator:case li.PrivateIdentifier:case li.String:case li.Error:return this.strValue;case li.Number:return this.numValue.toString();default:return null}}};function o3(e,t,i){return new vs(e,t,li.Character,i,String.fromCharCode(i))}function rY(e,t,i){return new vs(e,t,li.Identifier,0,i)}function nY(e,t,i){return new vs(e,t,li.PrivateIdentifier,0,i)}function aY(e,t,i){return new vs(e,t,li.Keyword,0,i)}function KC(e,t,i){return new vs(e,t,li.Operator,0,i)}function oY(e,t,i){return new vs(e,t,li.String,0,i)}function sY(e,t,i){return new vs(e,t,li.Number,i,"")}function lY(e,t,i){return new vs(e,t,li.Error,0,i)}var QC=new vs(-1,-1,li.Character,0,""),s2=class{constructor(t){this.input=t,this.peek=0,this.index=-1,this.length=t.length,this.advance()}advance(){this.peek=++this.index>=this.length?ca:this.input.charCodeAt(this.index)}scanToken(){let t=this.input,i=this.length,r=this.peek,n=this.index;for(;r<=RL;)if(++n>=i){r=ca;break}else r=t.charCodeAt(n);if(this.peek=r,this.index=n,n>=i)return null;if(s3(r))return this.scanIdentifier();if(Cl(r))return this.scanNumber(n);let a=n;switch(r){case Zh:return this.advance(),Cl(this.peek)?this.scanNumber(a):o3(a,this.index,Zh);case Ml:case ms:case Os:case Pa:case lm:case im:case Uo:case Rc:case ps:return this.scanCharacter(a,r);case og:case ag:return this.scanString();case FL:return this.scanPrivateIdentifier();case LL:case Nb:case Eq:case Sl:case Cq:case Mq:return this.scanOperator(a,String.fromCharCode(r));case kO:return this.scanQuestion(a);case em:case Pc:return this.scanComplexOperator(a,String.fromCharCode(r),tm,"=");case LE:case tm:return this.scanComplexOperator(a,String.fromCharCode(r),tm,"=",tm,"=");case kb:return this.scanComplexOperator(a,"&",kb,"&");case NO:return this.scanComplexOperator(a,"|",NO,"|");case WL:for(;vx(this.peek);)this.advance();return this.scanToken()}return this.advance(),this.error(`Unexpected character [${String.fromCharCode(r)}]`,0)}scanCharacter(t,i){return this.advance(),o3(t,this.index,i)}scanOperator(t,i){return this.advance(),KC(t,this.index,i)}scanComplexOperator(t,i,r,n,a,o){this.advance();let s=i;return this.peek==r&&(this.advance(),s+=n),a!=null&&this.peek==a&&(this.advance(),s+=o),KC(t,this.index,s)}scanIdentifier(){let t=this.index;for(this.advance();l3(this.peek);)this.advance();let i=this.input.substring(t,this.index);return iY.indexOf(i)>-1?aY(t,this.index,i):rY(t,this.index,i)}scanPrivateIdentifier(){let t=this.index;if(this.advance(),!s3(this.peek))return this.error("Invalid character [#]",-1);for(;l3(this.peek);)this.advance();let i=this.input.substring(t,this.index);return nY(t,this.index,i)}scanNumber(t){let i=this.index===t,r=!1;for(this.advance();;){if(!Cl(this.peek))if(this.peek===gx){if(!Cl(this.input.charCodeAt(this.index-1))||!Cl(this.input.charCodeAt(this.index+1)))return this.error("Invalid numeric separator",0);r=!0}else if(this.peek===Zh)i=!1;else if(cY(this.peek)){if(this.advance(),dY(this.peek)&&this.advance(),!Cl(this.peek))return this.error("Invalid exponent",-1);i=!1}else break;this.advance()}let n=this.input.substring(t,this.index);r&&(n=n.replace(/_/g,""));let a=i?hY(n):parseFloat(n);return sY(t,this.index,a)}scanString(){let t=this.index,i=this.peek;this.advance();let r="",n=this.index,a=this.input;for(;this.peek!=i;)if(this.peek==Pb){r+=a.substring(n,this.index);let s;if(this.advance(),this.peek==HL){let l=a.substring(this.index+1,this.index+5);if(/^[0-9a-f]+$/i.test(l))s=parseInt(l,16);else return this.error(`Invalid unicode escape [\\u${l}]`,0);for(let c=0;c<5;c++)this.advance()}else s=uY(this.peek),this.advance();r+=String.fromCharCode(s),n=this.index}else{if(this.peek==ca)return this.error("Unterminated quote",0);this.advance()}let o=a.substring(n,this.index);return this.advance(),oY(t,this.index,r+o)}scanQuestion(t){this.advance();let i="?";return(this.peek===kO||this.peek===Zh)&&(i+=this.peek===Zh?".":"?",this.advance()),KC(t,this.index,i)}error(t,i){let r=this.index+i;return lY(r,this.index,`Lexer Error: ${t} at column ${r} in expression [${this.input}]`)}};function s3(e){return _u<=e&&e<=Ig||Im<=e&&e<=fx||e==gx||e==OL}function l3(e){return _x(e)||Cl(e)||e==gx||e==OL}function cY(e){return e==kq||e==Aq}function dY(e){return e==Nb||e==LL}function uY(e){switch(e){case VL:return ou;case uS:return PL;case zL:return cS;case UL:return lS;case GL:return NL;default:return e}}function hY(e){let t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}var l2=class{constructor(t,i,r){this.strings=t,this.expressions=i,this.offsets=r}},c2=class{constructor(t,i,r){this.templateBindings=t,this.warnings=i,this.errors=r}},Jb=class{constructor(t){this._lexer=t,this.errors=[]}parseAction(t,i,r,n=Fs){this._checkNoInterpolation(t,i,n);let a=this._stripComments(t),o=this._lexer.tokenize(a),s=new eu(t,i,r,o,1,this.errors,0).parseChain();return new Fa(s,t,i,r,this.errors)}parseBinding(t,i,r,n=Fs){let a=this._parseBindingAst(t,i,r,n);return new Fa(a,t,i,r,this.errors)}checkSimpleExpression(t){let i=new d2;return t.visit(i),i.errors}parseSimpleBinding(t,i,r,n=Fs){let a=this._parseBindingAst(t,i,r,n),o=this.checkSimpleExpression(a);return o.length>0&&this._reportError(`Host binding expression cannot contain ${o.join(" ")}`,t,i),new Fa(a,t,i,r,this.errors)}_reportError(t,i,r,n){this.errors.push(new lg(t,i,r,n))}_parseBindingAst(t,i,r,n){this._checkNoInterpolation(t,i,n);let a=this._stripComments(t),o=this._lexer.tokenize(a);return new eu(t,i,r,o,0,this.errors,0).parseChain()}parseTemplateBindings(t,i,r,n,a){let o=this._lexer.tokenize(i);return new eu(i,r,a,o,0,this.errors,0).parseTemplateBindings({source:t,span:new ao(n,n+t.length)})}parseInterpolation(t,i,r,n,a=Fs){let{strings:o,expressions:s,offsets:l}=this.splitInterpolation(t,i,n,a);if(s.length===0)return null;let c=[];for(let d=0;d<s.length;++d){let u=s[d].text,h=this._stripComments(u),m=this._lexer.tokenize(h),f=new eu(t,i,r,m,0,this.errors,l[d]).parseChain();c.push(f)}return this.createInterpolationAst(o.map(d=>d.text),c,t,i,r)}parseInterpolationExpression(t,i,r){let n=this._stripComments(t),a=this._lexer.tokenize(n),o=new eu(t,i,r,a,0,this.errors,0).parseChain(),s=["",""];return this.createInterpolationAst(s,[o],t,i,r)}createInterpolationAst(t,i,r,n,a){let o=new bu(0,r.length),s=new zr(o,o.toAbsolute(a),t,i);return new Fa(s,r,n,a,this.errors)}splitInterpolation(t,i,r,n=Fs){let a=[],o=[],s=[],l=r?mY(r):null,c=0,d=!1,u=!1,{start:h,end:m}=n;for(;c<t.length;)if(d){let f=c,p=f+h.length,g=this._getInterpolationEndIndex(t,m,p);if(g===-1){d=!1,u=!0;break}let v=g+m.length,b=t.substring(p,g);b.trim().length===0&&this._reportError("Blank expressions are not allowed in interpolated strings",t,`at column ${c} in`,i),o.push({text:b,start:f,end:v});let x=(l?.get(f)??f)+h.length;s.push(x),c=v,d=!1}else{let f=c;c=t.indexOf(h,c),c===-1&&(c=t.length);let p=t.substring(f,c);a.push({text:p,start:f,end:c}),d=!0}if(!d)if(u){let f=a[a.length-1];f.text+=t.substring(c),f.end=t.length}else a.push({text:t.substring(c),start:c,end:t.length});return new l2(a,o,s)}wrapLiteralPrimitive(t,i,r){let n=new bu(0,t==null?0:t.length);return new Fa(new Un(n,n.toAbsolute(r),t),t,i,r,this.errors)}_stripComments(t){let i=this._commentStart(t);return i!=null?t.substring(0,i):t}_commentStart(t){let i=null;for(let r=0;r<t.length-1;r++){let n=t.charCodeAt(r),a=t.charCodeAt(r+1);if(n===Sl&&a==Sl&&i==null)return r;i===n?i=null:i==null&&Rb(n)&&(i=n)}return null}_checkNoInterpolation(t,i,{start:r,end:n}){let a=-1,o=-1;for(let s of this._forEachUnquotedChar(t,0))if(a===-1)t.startsWith(r)&&(a=s);else if(o=this._getInterpolationEndIndex(t,n,s),o>-1)break;a>-1&&o>-1&&this._reportError(`Got interpolation (${r}${n}) where expression was expected`,t,`at column ${a} in`,i)}_getInterpolationEndIndex(t,i,r){for(let n of this._forEachUnquotedChar(t,r)){if(t.startsWith(i,n))return n;if(t.startsWith("//",n))return t.indexOf(i,n)}return-1}*_forEachUnquotedChar(t,i){let r=null,n=0;for(let a=i;a<t.length;a++){let o=t[a];Rb(t.charCodeAt(a))&&(r===null||r===o)&&n%2===0?r=r===null?o:null:r===null&&(yield a),n=o==="\\"?n+1:0}}},Lf=function(e){return e[e.None=0]="None",e[e.Writable=1]="Writable",e}(Lf||{}),eu=class{constructor(t,i,r,n,a,o,s){this.input=t,this.location=i,this.absoluteOffset=r,this.tokens=n,this.parseFlags=a,this.errors=o,this.offset=s,this.rparensExpected=0,this.rbracketsExpected=0,this.rbracesExpected=0,this.context=Lf.None,this.sourceSpanCache=new Map,this.index=0}peek(t){let i=this.index+t;return i<this.tokens.length?this.tokens[i]:QC}get next(){return this.peek(0)}get atEOF(){return this.index>=this.tokens.length}get inputIndex(){return this.atEOF?this.currentEndIndex:this.next.index+this.offset}get currentEndIndex(){return this.index>0?this.peek(-1).end+this.offset:this.tokens.length===0?this.input.length+this.offset:this.next.index+this.offset}get currentAbsoluteOffset(){return this.absoluteOffset+this.inputIndex}span(t,i){let r=this.currentEndIndex;if(i!==void 0&&i>this.currentEndIndex&&(r=i),t>r){let n=r;r=t,t=n}return new bu(t,r)}sourceSpan(t,i){let r=`${t}@${this.inputIndex}:${i}`;return this.sourceSpanCache.has(r)||this.sourceSpanCache.set(r,this.span(t,i).toAbsolute(this.absoluteOffset)),this.sourceSpanCache.get(r)}advance(){this.index++}withContext(t,i){this.context|=t;let r=i();return this.context^=t,r}consumeOptionalCharacter(t){return this.next.isCharacter(t)?(this.advance(),!0):!1}peekKeywordLet(){return this.next.isKeywordLet()}peekKeywordAs(){return this.next.isKeywordAs()}expectCharacter(t){this.consumeOptionalCharacter(t)||this.error(`Missing expected ${String.fromCharCode(t)}`)}consumeOptionalOperator(t){return this.next.isOperator(t)?(this.advance(),!0):!1}expectOperator(t){this.consumeOptionalOperator(t)||this.error(`Missing expected operator ${t}`)}prettyPrintToken(t){return t===QC?"end of input":`token ${t}`}expectIdentifierOrKeyword(){let t=this.next;return!t.isIdentifier()&&!t.isKeyword()?(t.isPrivateIdentifier()?this._reportErrorForPrivateIdentifier(t,"expected identifier or keyword"):this.error(`Unexpected ${this.prettyPrintToken(t)}, expected identifier or keyword`),null):(this.advance(),t.toString())}expectIdentifierOrKeywordOrString(){let t=this.next;return!t.isIdentifier()&&!t.isKeyword()&&!t.isString()?(t.isPrivateIdentifier()?this._reportErrorForPrivateIdentifier(t,"expected identifier, keyword or string"):this.error(`Unexpected ${this.prettyPrintToken(t)}, expected identifier, keyword, or string`),""):(this.advance(),t.toString())}parseChain(){let t=[],i=this.inputIndex;for(;this.index<this.tokens.length;){let r=this.parsePipe();if(t.push(r),this.consumeOptionalCharacter(ps))for(this.parseFlags&1||this.error("Binding expression cannot contain chained expression");this.consumeOptionalCharacter(ps););else if(this.index<this.tokens.length){let n=this.index;if(this.error(`Unexpected token '${this.next}'`),this.index===n)break}}if(t.length===0){let r=this.offset,n=this.offset+this.input.length;return new zn(this.span(r,n),this.sourceSpan(r,n))}return t.length==1?t[0]:new Hc(this.span(i),this.sourceSpan(i),t)}parsePipe(){let t=this.inputIndex,i=this.parseExpression();if(this.consumeOptionalOperator("|")){this.parseFlags&1&&this.error("Cannot have a pipe in an action expression");do{let r=this.inputIndex,n=this.expectIdentifierOrKeyword(),a,o;n!==null?a=this.sourceSpan(r):(n="",o=this.next.index!==-1?this.next.index:this.input.length+this.offset,a=new bu(o,o).toAbsolute(this.absoluteOffset));let s=[];for(;this.consumeOptionalCharacter(Rc);)s.push(this.parseExpression());i=new wu(this.span(t),this.sourceSpan(t,o),i,n,s,a)}while(this.consumeOptionalOperator("|"))}return i}parseExpression(){return this.parseConditional()}parseConditional(){let t=this.inputIndex,i=this.parseLogicalOr();if(this.consumeOptionalOperator("?")){let r=this.parsePipe(),n;if(this.consumeOptionalCharacter(Rc))n=this.parsePipe();else{let a=this.inputIndex,o=this.input.substring(t,a);this.error(`Conditional expression ${o} requires all 3 expressions`),n=new zn(this.span(t),this.sourceSpan(t))}return new xu(this.span(t),this.sourceSpan(t),i,r,n)}else return i}parseLogicalOr(){let t=this.inputIndex,i=this.parseLogicalAnd();for(;this.consumeOptionalOperator("||");){let r=this.parseLogicalAnd();i=new Na(this.span(t),this.sourceSpan(t),"||",i,r)}return i}parseLogicalAnd(){let t=this.inputIndex,i=this.parseNullishCoalescing();for(;this.consumeOptionalOperator("&&");){let r=this.parseNullishCoalescing();i=new Na(this.span(t),this.sourceSpan(t),"&&",i,r)}return i}parseNullishCoalescing(){let t=this.inputIndex,i=this.parseEquality();for(;this.consumeOptionalOperator("??");){let r=this.parseEquality();i=new Na(this.span(t),this.sourceSpan(t),"??",i,r)}return i}parseEquality(){let t=this.inputIndex,i=this.parseRelational();for(;this.next.type==li.Operator;){let r=this.next.strValue;switch(r){case"==":case"===":case"!=":case"!==":this.advance();let n=this.parseRelational();i=new Na(this.span(t),this.sourceSpan(t),r,i,n);continue}break}return i}parseRelational(){let t=this.inputIndex,i=this.parseAdditive();for(;this.next.type==li.Operator;){let r=this.next.strValue;switch(r){case"<":case">":case"<=":case">=":this.advance();let n=this.parseAdditive();i=new Na(this.span(t),this.sourceSpan(t),r,i,n);continue}break}return i}parseAdditive(){let t=this.inputIndex,i=this.parseMultiplicative();for(;this.next.type==li.Operator;){let r=this.next.strValue;switch(r){case"+":case"-":this.advance();let n=this.parseMultiplicative();i=new Na(this.span(t),this.sourceSpan(t),r,i,n);continue}break}return i}parseMultiplicative(){let t=this.inputIndex,i=this.parsePrefix();for(;this.next.type==li.Operator;){let r=this.next.strValue;switch(r){case"*":case"%":case"/":this.advance();let n=this.parsePrefix();i=new Na(this.span(t),this.sourceSpan(t),r,i,n);continue}break}return i}parsePrefix(){if(this.next.type==li.Operator){let t=this.inputIndex,i=this.next.strValue,r;switch(i){case"+":return this.advance(),r=this.parsePrefix(),Ol.createPlus(this.span(t),this.sourceSpan(t),r);case"-":return this.advance(),r=this.parsePrefix(),Ol.createMinus(this.span(t),this.sourceSpan(t),r);case"!":return this.advance(),r=this.parsePrefix(),new Eu(this.span(t),this.sourceSpan(t),r)}}return this.parseCallChain()}parseCallChain(){let t=this.inputIndex,i=this.parsePrimary();for(;;)if(this.consumeOptionalCharacter(Zh))i=this.parseAccessMember(i,t,!1);else if(this.consumeOptionalOperator("?."))this.consumeOptionalCharacter(Ml)?i=this.parseCall(i,t,!0):i=this.consumeOptionalCharacter(lm)?this.parseKeyedReadOrWrite(i,t,!0):this.parseAccessMember(i,t,!0);else if(this.consumeOptionalCharacter(lm))i=this.parseKeyedReadOrWrite(i,t,!1);else if(this.consumeOptionalCharacter(Ml))i=this.parseCall(i,t,!1);else if(this.consumeOptionalOperator("!"))i=new Su(this.span(t),this.sourceSpan(t),i);else return i}parsePrimary(){let t=this.inputIndex;if(this.consumeOptionalCharacter(Ml)){this.rparensExpected++;let i=this.parsePipe();return this.rparensExpected--,this.expectCharacter(ms),i}else{if(this.next.isKeywordNull())return this.advance(),new Un(this.span(t),this.sourceSpan(t),null);if(this.next.isKeywordUndefined())return this.advance(),new Un(this.span(t),this.sourceSpan(t),void 0);if(this.next.isKeywordTrue())return this.advance(),new Un(this.span(t),this.sourceSpan(t),!0);if(this.next.isKeywordFalse())return this.advance(),new Un(this.span(t),this.sourceSpan(t),!1);if(this.next.isKeywordThis())return this.advance(),new Bc(this.span(t),this.sourceSpan(t));if(this.consumeOptionalCharacter(lm)){this.rbracketsExpected++;let i=this.parseExpressionList(im);return this.rbracketsExpected--,this.expectCharacter(im),new Cu(this.span(t),this.sourceSpan(t),i)}else{if(this.next.isCharacter(Os))return this.parseLiteralMap();if(this.next.isIdentifier())return this.parseAccessMember(new Hn(this.span(t),this.sourceSpan(t)),t,!1);if(this.next.isNumber()){let i=this.next.toNumber();return this.advance(),new Un(this.span(t),this.sourceSpan(t),i)}else if(this.next.isString()){let i=this.next.toString();return this.advance(),new Un(this.span(t),this.sourceSpan(t),i)}else return this.next.isPrivateIdentifier()?(this._reportErrorForPrivateIdentifier(this.next,null),new zn(this.span(t),this.sourceSpan(t))):this.index>=this.tokens.length?(this.error(`Unexpected end of expression: ${this.input}`),new zn(this.span(t),this.sourceSpan(t))):(this.error(`Unexpected token ${this.next}`),new zn(this.span(t),this.sourceSpan(t)))}}}parseExpressionList(t){let i=[];do if(!this.next.isCharacter(t))i.push(this.parsePipe());else break;while(this.consumeOptionalCharacter(Uo));return i}parseLiteralMap(){let t=[],i=[],r=this.inputIndex;if(this.expectCharacter(Os),!this.consumeOptionalCharacter(Pa)){this.rbracesExpected++;do{let n=this.inputIndex,a=this.next.isString(),o=this.expectIdentifierOrKeywordOrString();if(t.push({key:o,quoted:a}),a)this.expectCharacter(Rc),i.push(this.parsePipe());else if(this.consumeOptionalCharacter(Rc))i.push(this.parsePipe());else{let s=this.span(n),l=this.sourceSpan(n);i.push(new fn(s,l,l,new Hn(s,l),o))}}while(this.consumeOptionalCharacter(Uo)&&!this.next.isCharacter(Pa));this.rbracesExpected--,this.expectCharacter(Pa)}return new ym(this.span(r),this.sourceSpan(r),t,i)}parseAccessMember(t,i,r){let n=this.inputIndex,a=this.withContext(Lf.Writable,()=>{let l=this.expectIdentifierOrKeyword()??"";return l.length===0&&this.error("Expected identifier for property access",t.span.end),l}),o=this.sourceSpan(n),s;if(r)this.consumeOptionalOperator("=")?(this.error("The '?.' operator cannot be used in the assignment"),s=new zn(this.span(i),this.sourceSpan(i))):s=new bm(this.span(i),this.sourceSpan(i),o,t,a);else if(this.consumeOptionalOperator("=")){if(!(this.parseFlags&1))return this.error("Bindings cannot contain assignments"),new zn(this.span(i),this.sourceSpan(i));let l=this.parseConditional();s=new _m(this.span(i),this.sourceSpan(i),o,t,a,l)}else s=new fn(this.span(i),this.sourceSpan(i),o,t,a);return s}parseCall(t,i,r){let n=this.inputIndex;this.rparensExpected++;let a=this.parseCallArguments(),o=this.span(n,this.inputIndex).toAbsolute(this.absoluteOffset);this.expectCharacter(ms),this.rparensExpected--;let s=this.span(i),l=this.sourceSpan(i);return r?new Au(s,l,t,a,o):new js(s,l,t,a,o)}parseCallArguments(){if(this.next.isCharacter(ms))return[];let t=[];do t.push(this.parsePipe());while(this.consumeOptionalCharacter(Uo));return t}expectTemplateBindingKey(){let t="",i=!1,r=this.currentAbsoluteOffset;do t+=this.expectIdentifierOrKeywordOrString(),i=this.consumeOptionalOperator("-"),i&&(t+="-");while(i);return{source:t,span:new ao(r,r+t.length)}}parseTemplateBindings(t){let i=[];for(i.push(...this.parseDirectiveKeywordBindings(t));this.index<this.tokens.length;){let r=this.parseLetBinding();if(r)i.push(r);else{let n=this.expectTemplateBindingKey(),a=this.parseAsBinding(n);a?i.push(a):(n.source=t.source+n.source.charAt(0).toUpperCase()+n.source.substring(1),i.push(...this.parseDirectiveKeywordBindings(n)))}this.consumeStatementTerminator()}return new c2(i,[],this.errors)}parseKeyedReadOrWrite(t,i,r){return this.withContext(Lf.Writable,()=>{this.rbracketsExpected++;let n=this.parsePipe();if(n instanceof zn&&this.error("Key access cannot be empty"),this.rbracketsExpected--,this.expectCharacter(im),this.consumeOptionalOperator("="))if(r)this.error("The '?.' operator cannot be used in the assignment");else{let a=this.parseConditional();return new xm(this.span(i),this.sourceSpan(i),t,n,a)}else return r?new yu(this.span(i),this.sourceSpan(i),t,n):new Fl(this.span(i),this.sourceSpan(i),t,n);return new zn(this.span(i),this.sourceSpan(i))})}parseDirectiveKeywordBindings(t){let i=[];this.consumeOptionalCharacter(Rc);let r=this.getDirectiveBoundTarget(),n=this.currentAbsoluteOffset,a=this.parseAsBinding(t);a||(this.consumeStatementTerminator(),n=this.currentAbsoluteOffset);let o=new ao(t.span.start,n);return i.push(new HE(o,t,r)),a&&i.push(a),i}getDirectiveBoundTarget(){if(this.next===QC||this.peekKeywordAs()||this.peekKeywordLet())return null;let t=this.parsePipe(),{start:i,end:r}=t.span,n=this.input.substring(i,r);return new Fa(t,n,this.location,this.absoluteOffset+i,this.errors)}parseAsBinding(t){if(!this.peekKeywordAs())return null;this.advance();let i=this.expectTemplateBindingKey();this.consumeStatementTerminator();let r=new ao(t.span.start,this.currentAbsoluteOffset);return new cg(r,i,t)}parseLetBinding(){if(!this.peekKeywordLet())return null;let t=this.currentAbsoluteOffset;this.advance();let i=this.expectTemplateBindingKey(),r=null;this.consumeOptionalOperator("=")&&(r=this.expectTemplateBindingKey()),this.consumeStatementTerminator();let n=new ao(t,this.currentAbsoluteOffset);return new cg(n,i,r)}consumeStatementTerminator(){this.consumeOptionalCharacter(ps)||this.consumeOptionalCharacter(Uo)}error(t,i=null){this.errors.push(new lg(t,this.input,this.locationText(i),this.location)),this.skip()}locationText(t=null){return t==null&&(t=this.index),t<this.tokens.length?`at column ${this.tokens[t].index+1} in`:"at the end of the expression"}_reportErrorForPrivateIdentifier(t,i){let r=`Private identifiers are not supported. Unexpected private identifier: ${t}`;i!==null&&(r+=`, ${i}`),this.error(r)}skip(){let t=this.next;for(;this.index<this.tokens.length&&!t.isCharacter(ps)&&!t.isOperator("|")&&(this.rparensExpected<=0||!t.isCharacter(ms))&&(this.rbracesExpected<=0||!t.isCharacter(Pa))&&(this.rbracketsExpected<=0||!t.isCharacter(im))&&(!(this.context&Lf.Writable)||!t.isOperator("="));)this.next.isError()&&this.errors.push(new lg(this.next.toString(),this.input,this.locationText(),this.location)),this.advance(),t=this.next}},d2=class extends Lb{constructor(){super(...arguments),this.errors=[]}visitPipe(){this.errors.push("pipes")}};function mY(e){let t=new Map,i=0,r=0,n=0;for(;n<e.length;){let a=e[n];if(a.type===9){let[o,s]=a.parts;i+=s.length,r+=o.length}else{let o=a.parts.reduce((s,l)=>s+l.length,0);r+=o,i+=o}t.set(r,i),n++}return t}var $c=class{constructor(t,i){this.sourceSpan=t,this.i18n=i}},Xc=class extends $c{constructor(t,i,r,n){super(i,n),this.value=t,this.tokens=r}visit(t,i){return t.visitText(this,i)}},Tm=class extends $c{constructor(t,i,r,n,a,o){super(n,o),this.switchValue=t,this.type=i,this.cases=r,this.switchValueSourceSpan=a}visit(t,i){return t.visitExpansion(this,i)}},u2=class{constructor(t,i,r,n,a){this.value=t,this.expression=i,this.sourceSpan=r,this.valueSourceSpan=n,this.expSourceSpan=a}visit(t,i){return t.visitExpansionCase(this,i)}},h2=class extends $c{constructor(t,i,r,n,a,o,s){super(r,s),this.name=t,this.value=i,this.keySpan=n,this.valueSpan=a,this.valueTokens=o}visit(t,i){return t.visitAttribute(this,i)}},Bo=class extends $c{constructor(t,i,r,n,a,o=null,s){super(n,s),this.name=t,this.attrs=i,this.children=r,this.startSourceSpan=a,this.endSourceSpan=o}visit(t,i){return t.visitElement(this,i)}},_g=class{constructor(t,i){this.value=t,this.sourceSpan=i}visit(t,i){return t.visitComment(this,i)}},Vo=class extends $c{constructor(t,i,r,n,a,o,s=null,l){super(n,l),this.name=t,this.parameters=i,this.children=r,this.nameSpan=a,this.startSourceSpan=o,this.endSourceSpan=s}visit(t,i){return t.visitBlock(this,i)}},ex=class{constructor(t,i){this.expression=t,this.sourceSpan=i}visit(t,i){return t.visitBlockParameter(this,i)}};function Ar(e,t,i=null){let r=[],n=e.visit?a=>e.visit(a,i)||a.visit(e,i):a=>a.visit(e,i);return t.forEach(a=>{let o=n(a);o&&r.push(o)}),r}var m2=class{},pY="boolean",fY="number",gY="string",vY="object",_Y=["[Element]|textContent,%ariaAtomic,%ariaAutoComplete,%ariaBusy,%ariaChecked,%ariaColCount,%ariaColIndex,%ariaColSpan,%ariaCurrent,%ariaDescription,%ariaDisabled,%ariaExpanded,%ariaHasPopup,%ariaHidden,%ariaKeyShortcuts,%ariaLabel,%ariaLevel,%ariaLive,%ariaModal,%ariaMultiLine,%ariaMultiSelectable,%ariaOrientation,%ariaPlaceholder,%ariaPosInSet,%ariaPressed,%ariaReadOnly,%ariaRelevant,%ariaRequired,%ariaRoleDescription,%ariaRowCount,%ariaRowIndex,%ariaRowSpan,%ariaSelected,%ariaSetSize,%ariaSort,%ariaValueMax,%ariaValueMin,%ariaValueNow,%ariaValueText,%classList,className,elementTiming,id,innerHTML,*beforecopy,*beforecut,*beforepaste,*fullscreenchange,*fullscreenerror,*search,*webkitfullscreenchange,*webkitfullscreenerror,outerHTML,%part,#scrollLeft,#scrollTop,slot,*message,*mozfullscreenchange,*mozfullscreenerror,*mozpointerlockchange,*mozpointerlockerror,*webglcontextcreationerror,*webglcontextlost,*webglcontextrestored","[HTMLElement]^[Element]|accessKey,autocapitalize,!autofocus,contentEditable,dir,!draggable,enterKeyHint,!hidden,!inert,innerText,inputMode,lang,nonce,*abort,*animationend,*animationiteration,*animationstart,*auxclick,*beforexrselect,*blur,*cancel,*canplay,*canplaythrough,*change,*click,*close,*contextmenu,*copy,*cuechange,*cut,*dblclick,*drag,*dragend,*dragenter,*dragleave,*dragover,*dragstart,*drop,*durationchange,*emptied,*ended,*error,*focus,*formdata,*gotpointercapture,*input,*invalid,*keydown,*keypress,*keyup,*load,*loadeddata,*loadedmetadata,*loadstart,*lostpointercapture,*mousedown,*mouseenter,*mouseleave,*mousemove,*mouseout,*mouseover,*mouseup,*mousewheel,*paste,*pause,*play,*playing,*pointercancel,*pointerdown,*pointerenter,*pointerleave,*pointermove,*pointerout,*pointerover,*pointerrawupdate,*pointerup,*progress,*ratechange,*reset,*resize,*scroll,*securitypolicyviolation,*seeked,*seeking,*select,*selectionchange,*selectstart,*slotchange,*stalled,*submit,*suspend,*timeupdate,*toggle,*transitioncancel,*transitionend,*transitionrun,*transitionstart,*volumechange,*waiting,*webkitanimationend,*webkitanimationiteration,*webkitanimationstart,*webkittransitionend,*wheel,outerText,!spellcheck,%style,#tabIndex,title,!translate,virtualKeyboardPolicy","abbr,address,article,aside,b,bdi,bdo,cite,content,code,dd,dfn,dt,em,figcaption,figure,footer,header,hgroup,i,kbd,main,mark,nav,noscript,rb,rp,rt,rtc,ruby,s,samp,section,small,strong,sub,sup,u,var,wbr^[HTMLElement]|accessKey,autocapitalize,!autofocus,contentEditable,dir,!draggable,enterKeyHint,!hidden,innerText,inputMode,lang,nonce,*abort,*animationend,*animationiteration,*animationstart,*auxclick,*beforexrselect,*blur,*cancel,*canplay,*canplaythrough,*change,*click,*close,*contextmenu,*copy,*cuechange,*cut,*dblclick,*drag,*dragend,*dragenter,*dragleave,*dragover,*dragstart,*drop,*durationchange,*emptied,*ended,*error,*focus,*formdata,*gotpointercapture,*input,*invalid,*keydown,*keypress,*keyup,*load,*loadeddata,*loadedmetadata,*loadstart,*lostpointercapture,*mousedown,*mouseenter,*mouseleave,*mousemove,*mouseout,*mouseover,*mouseup,*mousewheel,*paste,*pause,*play,*playing,*pointercancel,*pointerdown,*pointerenter,*pointerleave,*pointermove,*pointerout,*pointerover,*pointerrawupdate,*pointerup,*progress,*ratechange,*reset,*resize,*scroll,*securitypolicyviolation,*seeked,*seeking,*select,*selectionchange,*selectstart,*slotchange,*stalled,*submit,*suspend,*timeupdate,*toggle,*transitioncancel,*transitionend,*transitionrun,*transitionstart,*volumechange,*waiting,*webkitanimationend,*webkitanimationiteration,*webkitanimationstart,*webkittransitionend,*wheel,outerText,!spellcheck,%style,#tabIndex,title,!translate,virtualKeyboardPolicy","media^[HTMLElement]|!autoplay,!controls,%controlsList,%crossOrigin,#currentTime,!defaultMuted,#defaultPlaybackRate,!disableRemotePlayback,!loop,!muted,*encrypted,*waitingforkey,#playbackRate,preload,!preservesPitch,src,%srcObject,#volume",":svg:^[HTMLElement]|!autofocus,nonce,*abort,*animationend,*animationiteration,*animationstart,*auxclick,*beforexrselect,*blur,*cancel,*canplay,*canplaythrough,*change,*click,*close,*contextmenu,*copy,*cuechange,*cut,*dblclick,*drag,*dragend,*dragenter,*dragleave,*dragover,*dragstart,*drop,*durationchange,*emptied,*ended,*error,*focus,*formdata,*gotpointercapture,*input,*invalid,*keydown,*keypress,*keyup,*load,*loadeddata,*loadedmetadata,*loadstart,*lostpointercapture,*mousedown,*mouseenter,*mouseleave,*mousemove,*mouseout,*mouseover,*mouseup,*mousewheel,*paste,*pause,*play,*playing,*pointercancel,*pointerdown,*pointerenter,*pointerleave,*pointermove,*pointerout,*pointerover,*pointerrawupdate,*pointerup,*progress,*ratechange,*reset,*resize,*scroll,*securitypolicyviolation,*seeked,*seeking,*select,*selectionchange,*selectstart,*slotchange,*stalled,*submit,*suspend,*timeupdate,*toggle,*transitioncancel,*transitionend,*transitionrun,*transitionstart,*volumechange,*waiting,*webkitanimationend,*webkitanimationiteration,*webkitanimationstart,*webkittransitionend,*wheel,%style,#tabIndex",":svg:graphics^:svg:|",":svg:animation^:svg:|*begin,*end,*repeat",":svg:geometry^:svg:|",":svg:componentTransferFunction^:svg:|",":svg:gradient^:svg:|",":svg:textContent^:svg:graphics|",":svg:textPositioning^:svg:textContent|","a^[HTMLElement]|charset,coords,download,hash,host,hostname,href,hreflang,name,password,pathname,ping,port,protocol,referrerPolicy,rel,%relList,rev,search,shape,target,text,type,username","area^[HTMLElement]|alt,coords,download,hash,host,hostname,href,!noHref,password,pathname,ping,port,protocol,referrerPolicy,rel,%relList,search,shape,target,username","audio^media|","br^[HTMLElement]|clear","base^[HTMLElement]|href,target","body^[HTMLElement]|aLink,background,bgColor,link,*afterprint,*beforeprint,*beforeunload,*blur,*error,*focus,*hashchange,*languagechange,*load,*message,*messageerror,*offline,*online,*pagehide,*pageshow,*popstate,*rejectionhandled,*resize,*scroll,*storage,*unhandledrejection,*unload,text,vLink","button^[HTMLElement]|!disabled,formAction,formEnctype,formMethod,!formNoValidate,formTarget,name,type,value","canvas^[HTMLElement]|#height,#width","content^[HTMLElement]|select","dl^[HTMLElement]|!compact","data^[HTMLElement]|value","datalist^[HTMLElement]|","details^[HTMLElement]|!open","dialog^[HTMLElement]|!open,returnValue","dir^[HTMLElement]|!compact","div^[HTMLElement]|align","embed^[HTMLElement]|align,height,name,src,type,width","fieldset^[HTMLElement]|!disabled,name","font^[HTMLElement]|color,face,size","form^[HTMLElement]|acceptCharset,action,autocomplete,encoding,enctype,method,name,!noValidate,target","frame^[HTMLElement]|frameBorder,longDesc,marginHeight,marginWidth,name,!noResize,scrolling,src","frameset^[HTMLElement]|cols,*afterprint,*beforeprint,*beforeunload,*blur,*error,*focus,*hashchange,*languagechange,*load,*message,*messageerror,*offline,*online,*pagehide,*pageshow,*popstate,*rejectionhandled,*resize,*scroll,*storage,*unhandledrejection,*unload,rows","hr^[HTMLElement]|align,color,!noShade,size,width","head^[HTMLElement]|","h1,h2,h3,h4,h5,h6^[HTMLElement]|align","html^[HTMLElement]|version","iframe^[HTMLElement]|align,allow,!allowFullscreen,!allowPaymentRequest,csp,frameBorder,height,loading,longDesc,marginHeight,marginWidth,name,referrerPolicy,%sandbox,scrolling,src,srcdoc,width","img^[HTMLElement]|align,alt,border,%crossOrigin,decoding,#height,#hspace,!isMap,loading,longDesc,lowsrc,name,referrerPolicy,sizes,src,srcset,useMap,#vspace,#width","input^[HTMLElement]|accept,align,alt,autocomplete,!checked,!defaultChecked,defaultValue,dirName,!disabled,%files,formAction,formEnctype,formMethod,!formNoValidate,formTarget,#height,!incremental,!indeterminate,max,#maxLength,min,#minLength,!multiple,name,pattern,placeholder,!readOnly,!required,selectionDirection,#selectionEnd,#selectionStart,#size,src,step,type,useMap,value,%valueAsDate,#valueAsNumber,#width","li^[HTMLElement]|type,#value","label^[HTMLElement]|htmlFor","legend^[HTMLElement]|align","link^[HTMLElement]|as,charset,%crossOrigin,!disabled,href,hreflang,imageSizes,imageSrcset,integrity,media,referrerPolicy,rel,%relList,rev,%sizes,target,type","map^[HTMLElement]|name","marquee^[HTMLElement]|behavior,bgColor,direction,height,#hspace,#loop,#scrollAmount,#scrollDelay,!trueSpeed,#vspace,width","menu^[HTMLElement]|!compact","meta^[HTMLElement]|content,httpEquiv,media,name,scheme","meter^[HTMLElement]|#high,#low,#max,#min,#optimum,#value","ins,del^[HTMLElement]|cite,dateTime","ol^[HTMLElement]|!compact,!reversed,#start,type","object^[HTMLElement]|align,archive,border,code,codeBase,codeType,data,!declare,height,#hspace,name,standby,type,useMap,#vspace,width","optgroup^[HTMLElement]|!disabled,label","option^[HTMLElement]|!defaultSelected,!disabled,label,!selected,text,value","output^[HTMLElement]|defaultValue,%htmlFor,name,value","p^[HTMLElement]|align","param^[HTMLElement]|name,type,value,valueType","picture^[HTMLElement]|","pre^[HTMLElement]|#width","progress^[HTMLElement]|#max,#value","q,blockquote,cite^[HTMLElement]|","script^[HTMLElement]|!async,charset,%crossOrigin,!defer,event,htmlFor,integrity,!noModule,%referrerPolicy,src,text,type","select^[HTMLElement]|autocomplete,!disabled,#length,!multiple,name,!required,#selectedIndex,#size,value","slot^[HTMLElement]|name","source^[HTMLElement]|#height,media,sizes,src,srcset,type,#width","span^[HTMLElement]|","style^[HTMLElement]|!disabled,media,type","caption^[HTMLElement]|align","th,td^[HTMLElement]|abbr,align,axis,bgColor,ch,chOff,#colSpan,headers,height,!noWrap,#rowSpan,scope,vAlign,width","col,colgroup^[HTMLElement]|align,ch,chOff,#span,vAlign,width","table^[HTMLElement]|align,bgColor,border,%caption,cellPadding,cellSpacing,frame,rules,summary,%tFoot,%tHead,width","tr^[HTMLElement]|align,bgColor,ch,chOff,vAlign","tfoot,thead,tbody^[HTMLElement]|align,ch,chOff,vAlign","template^[HTMLElement]|","textarea^[HTMLElement]|autocomplete,#cols,defaultValue,dirName,!disabled,#maxLength,#minLength,name,placeholder,!readOnly,!required,#rows,selectionDirection,#selectionEnd,#selectionStart,value,wrap","time^[HTMLElement]|dateTime","title^[HTMLElement]|text","track^[HTMLElement]|!default,kind,label,src,srclang","ul^[HTMLElement]|!compact,type","unknown^[HTMLElement]|","video^media|!disablePictureInPicture,#height,*enterpictureinpicture,*leavepictureinpicture,!playsInline,poster,#width",":svg:a^:svg:graphics|",":svg:animate^:svg:animation|",":svg:animateMotion^:svg:animation|",":svg:animateTransform^:svg:animation|",":svg:circle^:svg:geometry|",":svg:clipPath^:svg:graphics|",":svg:defs^:svg:graphics|",":svg:desc^:svg:|",":svg:discard^:svg:|",":svg:ellipse^:svg:geometry|",":svg:feBlend^:svg:|",":svg:feColorMatrix^:svg:|",":svg:feComponentTransfer^:svg:|",":svg:feComposite^:svg:|",":svg:feConvolveMatrix^:svg:|",":svg:feDiffuseLighting^:svg:|",":svg:feDisplacementMap^:svg:|",":svg:feDistantLight^:svg:|",":svg:feDropShadow^:svg:|",":svg:feFlood^:svg:|",":svg:feFuncA^:svg:componentTransferFunction|",":svg:feFuncB^:svg:componentTransferFunction|",":svg:feFuncG^:svg:componentTransferFunction|",":svg:feFuncR^:svg:componentTransferFunction|",":svg:feGaussianBlur^:svg:|",":svg:feImage^:svg:|",":svg:feMerge^:svg:|",":svg:feMergeNode^:svg:|",":svg:feMorphology^:svg:|",":svg:feOffset^:svg:|",":svg:fePointLight^:svg:|",":svg:feSpecularLighting^:svg:|",":svg:feSpotLight^:svg:|",":svg:feTile^:svg:|",":svg:feTurbulence^:svg:|",":svg:filter^:svg:|",":svg:foreignObject^:svg:graphics|",":svg:g^:svg:graphics|",":svg:image^:svg:graphics|decoding",":svg:line^:svg:geometry|",":svg:linearGradient^:svg:gradient|",":svg:mpath^:svg:|",":svg:marker^:svg:|",":svg:mask^:svg:|",":svg:metadata^:svg:|",":svg:path^:svg:geometry|",":svg:pattern^:svg:|",":svg:polygon^:svg:geometry|",":svg:polyline^:svg:geometry|",":svg:radialGradient^:svg:gradient|",":svg:rect^:svg:geometry|",":svg:svg^:svg:graphics|#currentScale,#zoomAndPan",":svg:script^:svg:|type",":svg:set^:svg:animation|",":svg:stop^:svg:|",":svg:style^:svg:|!disabled,media,title,type",":svg:switch^:svg:graphics|",":svg:symbol^:svg:|",":svg:tspan^:svg:textPositioning|",":svg:text^:svg:textPositioning|",":svg:textPath^:svg:textContent|",":svg:title^:svg:|",":svg:use^:svg:graphics|",":svg:view^:svg:|#zoomAndPan","data^[HTMLElement]|value","keygen^[HTMLElement]|!autofocus,challenge,!disabled,form,keytype,name","menuitem^[HTMLElement]|type,label,icon,!disabled,!checked,radiogroup,!default","summary^[HTMLElement]|","time^[HTMLElement]|dateTime",":svg:cursor^:svg:|",":math:^[HTMLElement]|!autofocus,nonce,*abort,*animationend,*animationiteration,*animationstart,*auxclick,*beforeinput,*beforematch,*beforetoggle,*beforexrselect,*blur,*cancel,*canplay,*canplaythrough,*change,*click,*close,*contentvisibilityautostatechange,*contextlost,*contextmenu,*contextrestored,*copy,*cuechange,*cut,*dblclick,*drag,*dragend,*dragenter,*dragleave,*dragover,*dragstart,*drop,*durationchange,*emptied,*ended,*error,*focus,*formdata,*gotpointercapture,*input,*invalid,*keydown,*keypress,*keyup,*load,*loadeddata,*loadedmetadata,*loadstart,*lostpointercapture,*mousedown,*mouseenter,*mouseleave,*mousemove,*mouseout,*mouseover,*mouseup,*mousewheel,*paste,*pause,*play,*playing,*pointercancel,*pointerdown,*pointerenter,*pointerleave,*pointermove,*pointerout,*pointerover,*pointerrawupdate,*pointerup,*progress,*ratechange,*reset,*resize,*scroll,*scrollend,*securitypolicyviolation,*seeked,*seeking,*select,*selectionchange,*selectstart,*slotchange,*stalled,*submit,*suspend,*timeupdate,*toggle,*transitioncancel,*transitionend,*transitionrun,*transitionstart,*volumechange,*waiting,*webkitanimationend,*webkitanimationiteration,*webkitanimationstart,*webkittransitionend,*wheel,%style,#tabIndex",":math:math^:math:|",":math:maction^:math:|",":math:menclose^:math:|",":math:merror^:math:|",":math:mfenced^:math:|",":math:mfrac^:math:|",":math:mi^:math:|",":math:mmultiscripts^:math:|",":math:mn^:math:|",":math:mo^:math:|",":math:mover^:math:|",":math:mpadded^:math:|",":math:mphantom^:math:|",":math:mroot^:math:|",":math:mrow^:math:|",":math:ms^:math:|",":math:mspace^:math:|",":math:msqrt^:math:|",":math:mstyle^:math:|",":math:msub^:math:|",":math:msubsup^:math:|",":math:msup^:math:|",":math:mtable^:math:|",":math:mtd^:math:|",":math:mtext^:math:|",":math:mtr^:math:|",":math:munder^:math:|",":math:munderover^:math:|",":math:semantics^:math:|"],fB=new Map(Object.entries({class:"className",for:"htmlFor",formaction:"formAction",innerHtml:"innerHTML",readonly:"readOnly",tabindex:"tabIndex"})),bY=Array.from(fB).reduce((e,[t,i])=>(e.set(t,i),e),new Map),Dm=class extends m2{constructor(){super(),this._schema=new Map,this._eventSchema=new Map,_Y.forEach(t=>{let i=new Map,r=new Set,[n,a]=t.split("|"),o=a.split(","),[s,l]=n.split("^");s.split(",").forEach(d=>{this._schema.set(d.toLowerCase(),i),this._eventSchema.set(d.toLowerCase(),r)});let c=l&&this._schema.get(l.toLowerCase());if(c){for(let[d,u]of c)i.set(d,u);for(let d of this._eventSchema.get(l.toLowerCase()))r.add(d)}o.forEach(d=>{if(d.length>0)switch(d[0]){case"*":r.add(d.substring(1));break;case"!":i.set(d.substring(1),pY);break;case"#":i.set(d.substring(1),fY);break;case"%":i.set(d.substring(1),vY);break;default:i.set(d,gY)}})})}hasProperty(t,i,r){if(r.some(a=>a.name===dO.name))return!0;if(t.indexOf("-")>-1){if(SE(t)||AE(t))return!1;if(r.some(a=>a.name===cO.name))return!0}return(this._schema.get(t.toLowerCase())||this._schema.get("unknown")).has(i)}hasElement(t,i){return i.some(r=>r.name===dO.name)||t.indexOf("-")>-1&&(SE(t)||AE(t)||i.some(r=>r.name===cO.name))?!0:this._schema.has(t.toLowerCase())}securityContext(t,i,r){r&&(i=this.getMappedPropName(i)),t=t.toLowerCase(),i=i.toLowerCase();let n=zO()[t+"|"+i];return n||(n=zO()["*|"+i],n||gi.NONE)}getMappedPropName(t){return fB.get(t)??t}getDefaultComponentElementName(){return"ng-component"}validateProperty(t){return t.toLowerCase().startsWith("on")?{error:!0,msg:`Binding to event property '${t}' is disallowed for security reasons, please use (${t.slice(2)})=...
If '${t}' is a directive input, make sure the directive is imported by the current module.`}:{error:!1}}validateAttribute(t){return t.toLowerCase().startsWith("on")?{error:!0,msg:`Binding to event attribute '${t}' is disallowed for security reasons, please use (${t.slice(2)})=...`}:{error:!1}}allKnownElementNames(){return Array.from(this._schema.keys())}allKnownAttributesOfElement(t){let i=this._schema.get(t.toLowerCase())||this._schema.get("unknown");return Array.from(i.keys()).map(r=>bY.get(r)??r)}allKnownEventsOfElement(t){return Array.from(this._eventSchema.get(t.toLowerCase())??[])}normalizeAnimationStyleProperty(t){return IW(t)}normalizeAnimationStyleValue(t,i,r){let n="",a=r.toString().trim(),o=null;if(xY(t)&&r!==0&&r!=="0")if(typeof r=="number")n="px";else{let s=r.match(/^[+-]?[\d\.]+([a-z]*)$/);s&&s[1].length==0&&(o=`Please provide a CSS unit value for ${i}:${r}`)}return{error:o,value:a+n}}};function xY(e){switch(e){case"width":case"height":case"minWidth":case"minHeight":case"maxWidth":case"maxHeight":case"left":case"top":case"bottom":case"right":case"fontSize":case"outlineWidth":case"outlineOffset":case"paddingTop":case"paddingLeft":case"paddingBottom":case"paddingRight":case"marginTop":case"marginLeft":case"marginBottom":case"marginRight":case"borderRadius":case"borderWidth":case"borderTopWidth":case"borderLeftWidth":case"borderRightWidth":case"borderBottomWidth":case"textIndent":return!0;default:return!1}}var Yt=class{constructor({closedByChildren:t,implicitNamespacePrefix:i,contentType:r=Rs.PARSABLE_DATA,closedByParent:n=!1,isVoid:a=!1,ignoreFirstLf:o=!1,preventNamespaceInheritance:s=!1,canSelfClose:l=!1}={}){this.closedByChildren={},this.closedByParent=!1,t&&t.length>0&&t.forEach(c=>this.closedByChildren[c]=!0),this.isVoid=a,this.closedByParent=n||a,this.implicitNamespacePrefix=i||null,this.contentType=r,this.ignoreFirstLf=o,this.preventNamespaceInheritance=s,this.canSelfClose=l??a}isClosedByChild(t){return this.isVoid||t.toLowerCase()in this.closedByChildren}getContentType(t){return typeof this.contentType=="object"?(t===void 0?void 0:this.contentType[t])??this.contentType.default:this.contentType}},c3,$h;function gB(e){return $h||(c3=new Yt({canSelfClose:!0}),$h=Object.assign(Object.create(null),{base:new Yt({isVoid:!0}),meta:new Yt({isVoid:!0}),area:new Yt({isVoid:!0}),embed:new Yt({isVoid:!0}),link:new Yt({isVoid:!0}),img:new Yt({isVoid:!0}),input:new Yt({isVoid:!0}),param:new Yt({isVoid:!0}),hr:new Yt({isVoid:!0}),br:new Yt({isVoid:!0}),source:new Yt({isVoid:!0}),track:new Yt({isVoid:!0}),wbr:new Yt({isVoid:!0}),p:new Yt({closedByChildren:["address","article","aside","blockquote","div","dl","fieldset","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","main","nav","ol","p","pre","section","table","ul"],closedByParent:!0}),thead:new Yt({closedByChildren:["tbody","tfoot"]}),tbody:new Yt({closedByChildren:["tbody","tfoot"],closedByParent:!0}),tfoot:new Yt({closedByChildren:["tbody"],closedByParent:!0}),tr:new Yt({closedByChildren:["tr"],closedByParent:!0}),td:new Yt({closedByChildren:["td","th"],closedByParent:!0}),th:new Yt({closedByChildren:["td","th"],closedByParent:!0}),col:new Yt({isVoid:!0}),svg:new Yt({implicitNamespacePrefix:"svg"}),foreignObject:new Yt({implicitNamespacePrefix:"svg",preventNamespaceInheritance:!0}),math:new Yt({implicitNamespacePrefix:"math"}),li:new Yt({closedByChildren:["li"],closedByParent:!0}),dt:new Yt({closedByChildren:["dt","dd"]}),dd:new Yt({closedByChildren:["dt","dd"],closedByParent:!0}),rb:new Yt({closedByChildren:["rb","rt","rtc","rp"],closedByParent:!0}),rt:new Yt({closedByChildren:["rb","rt","rtc","rp"],closedByParent:!0}),rtc:new Yt({closedByChildren:["rb","rtc","rp"],closedByParent:!0}),rp:new Yt({closedByChildren:["rb","rt","rtc","rp"],closedByParent:!0}),optgroup:new Yt({closedByChildren:["optgroup"],closedByParent:!0}),option:new Yt({closedByChildren:["option","optgroup"],closedByParent:!0}),pre:new Yt({ignoreFirstLf:!0}),listing:new Yt({ignoreFirstLf:!0}),style:new Yt({contentType:Rs.RAW_TEXT}),script:new Yt({contentType:Rs.RAW_TEXT}),title:new Yt({contentType:{default:Rs.ESCAPABLE_RAW_TEXT,svg:Rs.PARSABLE_DATA}}),textarea:new Yt({contentType:Rs.ESCAPABLE_RAW_TEXT,ignoreFirstLf:!0})}),new Dm().allKnownElementNames().forEach(t=>{!$h[t]&&TE(t)===null&&($h[t]=new Yt({canSelfClose:!1}))})),$h[e]??$h[e.toLowerCase()]??c3}var d3={A:"LINK",B:"BOLD_TEXT",BR:"LINE_BREAK",EM:"EMPHASISED_TEXT",H1:"HEADING_LEVEL1",H2:"HEADING_LEVEL2",H3:"HEADING_LEVEL3",H4:"HEADING_LEVEL4",H5:"HEADING_LEVEL5",H6:"HEADING_LEVEL6",HR:"HORIZONTAL_RULE",I:"ITALIC_TEXT",LI:"LIST_ITEM",LINK:"MEDIA_LINK",OL:"ORDERED_LIST",P:"PARAGRAPH",Q:"QUOTATION",S:"STRIKETHROUGH_TEXT",SMALL:"SMALL_TEXT",SUB:"SUBSTRIPT",SUP:"SUPERSCRIPT",TBODY:"TABLE_BODY",TD:"TABLE_CELL",TFOOT:"TABLE_FOOTER",TH:"TABLE_HEADER_CELL",THEAD:"TABLE_HEADER",TR:"TABLE_ROW",TT:"MONOSPACED_TEXT",U:"UNDERLINED_TEXT",UL:"UNORDERED_LIST"},p2=class{constructor(){this._placeHolderNameCounts={},this._signatureToName={}}getStartTagPlaceholderName(t,i,r){let n=this._hashTag(t,i,r);if(this._signatureToName[n])return this._signatureToName[n];let a=t.toUpperCase(),o=d3[a]||`TAG_${a}`,s=this._generateUniqueName(r?o:`START_${o}`);return this._signatureToName[n]=s,s}getCloseTagPlaceholderName(t){let i=this._hashClosingTag(t);if(this._signatureToName[i])return this._signatureToName[i];let r=t.toUpperCase(),n=d3[r]||`TAG_${r}`,a=this._generateUniqueName(`CLOSE_${n}`);return this._signatureToName[i]=a,a}getPlaceholderName(t,i){let r=t.toUpperCase(),n=`PH: ${r}=${i}`;if(this._signatureToName[n])return this._signatureToName[n];let a=this._generateUniqueName(r);return this._signatureToName[n]=a,a}getUniquePlaceholder(t){return this._generateUniqueName(t.toUpperCase())}getStartBlockPlaceholderName(t,i){let r=this._hashBlock(t,i);if(this._signatureToName[r])return this._signatureToName[r];let n=this._generateUniqueName(`START_BLOCK_${this._toSnakeCase(t)}`);return this._signatureToName[r]=n,n}getCloseBlockPlaceholderName(t){let i=this._hashClosingBlock(t);if(this._signatureToName[i])return this._signatureToName[i];let r=this._generateUniqueName(`CLOSE_BLOCK_${this._toSnakeCase(t)}`);return this._signatureToName[i]=r,r}_hashTag(t,i,r){let n=`<${t}`,a=Object.keys(i).sort().map(s=>` ${s}=${i[s]}`).join(""),o=r?"/>":`></${t}>`;return n+a+o}_hashClosingTag(t){return this._hashTag(`/${t}`,{},!1)}_hashBlock(t,i){let r=i.length===0?"":` (${i.sort().join("; ")})`;return`@${t}${r} {}`}_hashClosingBlock(t){return this._hashBlock(`close_${t}`,[])}_toSnakeCase(t){return t.toUpperCase().replace(/[^A-Z0-9]/g,"_")}_generateUniqueName(t){if(!this._placeHolderNameCounts.hasOwnProperty(t))return this._placeHolderNameCounts[t]=1,t;let r=this._placeHolderNameCounts[t];return this._placeHolderNameCounts[t]=r+1,`${t}_${r}`}},yY=new Jb(new vg);function wY(e,t){let i=new f2(yY,e,t);return(r,n,a,o,s)=>i.toI18nMessage(r,n,a,o,s)}function CY(e,t){return t}var f2=class{constructor(t,i,r){this._expressionParser=t,this._interpolationConfig=i,this._containerBlocks=r}toI18nMessage(t,i="",r="",n="",a){let o={isIcu:t.length==1&&t[0]instanceof Tm,icuDepth:0,placeholderRegistry:new p2,placeholderToContent:{},placeholderToMessage:{},visitNodeFn:a||CY},s=Ar(this,t,o);return new jn(s,o.placeholderToContent,o.placeholderToMessage,i,r,n)}visitElement(t,i){let r=Ar(this,t.children,i),n={};t.attrs.forEach(c=>{n[c.name]=c.value});let a=gB(t.name).isVoid,o=i.placeholderRegistry.getStartTagPlaceholderName(t.name,n,a);i.placeholderToContent[o]={text:t.startSourceSpan.toString(),sourceSpan:t.startSourceSpan};let s="";a||(s=i.placeholderRegistry.getCloseTagPlaceholderName(t.name),i.placeholderToContent[s]={text:`</${t.name}>`,sourceSpan:t.endSourceSpan??t.sourceSpan});let l=new zc(t.name,n,o,s,r,a,t.sourceSpan,t.startSourceSpan,t.endSourceSpan);return i.visitNodeFn(t,l)}visitAttribute(t,i){let r=t.valueTokens===void 0||t.valueTokens.length===1?new Jh(t.value,t.valueSpan||t.sourceSpan):this._visitTextWithInterpolation(t.valueTokens,t.valueSpan||t.sourceSpan,i,t.i18n);return i.visitNodeFn(t,r)}visitText(t,i){let r=t.tokens.length===1?new Jh(t.value,t.sourceSpan):this._visitTextWithInterpolation(t.tokens,t.sourceSpan,i,t.i18n);return i.visitNodeFn(t,r)}visitComment(t,i){return null}visitExpansion(t,i){i.icuDepth++;let r={},n=new Tb(t.switchValue,t.type,r,t.sourceSpan);if(t.cases.forEach(s=>{r[s.value]=new Bs(s.expression.map(l=>l.visit(this,i)),s.expSourceSpan)}),i.icuDepth--,i.isIcu||i.icuDepth>0){let s=i.placeholderRegistry.getUniquePlaceholder(`VAR_${t.type}`);return n.expressionPlaceholder=s,i.placeholderToContent[s]={text:t.switchValue,sourceSpan:t.switchValueSourceSpan},i.visitNodeFn(t,n)}let a=i.placeholderRegistry.getPlaceholderName("ICU",t.sourceSpan.toString());i.placeholderToMessage[a]=this.toI18nMessage([t],"","","",void 0);let o=new gm(n,a,t.sourceSpan);return i.visitNodeFn(t,o)}visitExpansionCase(t,i){throw new Error("Unreachable code")}visitBlock(t,i){let r=Ar(this,t.children,i);if(this._containerBlocks.has(t.name))return new Bs(r,t.sourceSpan);let n=t.parameters.map(l=>l.expression),a=i.placeholderRegistry.getStartBlockPlaceholderName(t.name,n),o=i.placeholderRegistry.getCloseBlockPlaceholderName(t.name);i.placeholderToContent[a]={text:t.startSourceSpan.toString(),sourceSpan:t.startSourceSpan},i.placeholderToContent[o]={text:t.endSourceSpan?t.endSourceSpan.toString():"}",sourceSpan:t.endSourceSpan??t.sourceSpan};let s=new Rl(t.name,n,a,o,r,t.sourceSpan,t.startSourceSpan,t.endSourceSpan);return i.visitNodeFn(t,s)}visitBlockParameter(t,i){throw new Error("Unreachable code")}_visitTextWithInterpolation(t,i,r,n){let a=[],o=!1;for(let s of t)switch(s.type){case 8:case 17:o=!0;let l=s.parts[1],c=DY(l)||"INTERPOLATION",d=r.placeholderRegistry.getPlaceholderName(c,l);r.placeholderToContent[d]={text:s.parts.join(""),sourceSpan:s.sourceSpan},a.push(new rg(l,d,s.sourceSpan));break;default:if(s.parts[0].length>0){let u=a[a.length-1];u instanceof Jh?(u.value+=s.parts[0],u.sourceSpan=new Qt(u.sourceSpan.start,s.sourceSpan.end,u.sourceSpan.fullStart,u.sourceSpan.details)):a.push(new Jh(s.parts[0],s.sourceSpan))}break}return o?(EY(a,n),new Bs(a,i)):a[0]}};function EY(e,t){if(t instanceof jn&&(SY(t),t=t.nodes[0]),t instanceof Bs){AY(t.children,e);for(let i=0;i<e.length;i++)e[i].sourceSpan=t.children[i].sourceSpan}}function SY(e){let t=e.nodes;if(t.length!==1||!(t[0]instanceof Bs))throw new Error("Unexpected previous i18n message - expected it to consist of only a single `Container` node.")}function AY(e,t){if(e.length!==t.length)throw new Error("The number of i18n message children changed between first and second pass.");if(e.some((i,r)=>t[r].constructor!==i.constructor))throw new Error("The types of the i18n message children changed between first and second pass.")}var TY=/\/\/[\s\S]*i18n[\s\S]*\([\s\S]*ph[\s\S]*=[\s\S]*("|')([\s\S]*?)\1[\s\S]*\)/g;function DY(e){return e.split(TY)[2]}var g2=class extends $t{constructor(t,i){super(t,i)}},tx={AElig:"\xC6",AMP:"&",amp:"&",Aacute:"\xC1",Abreve:"\u0102",Acirc:"\xC2",Acy:"\u0410",Afr:"\u{1D504}",Agrave:"\xC0",Alpha:"\u0391",Amacr:"\u0100",And:"\u2A53",Aogon:"\u0104",Aopf:"\u{1D538}",ApplyFunction:"\u2061",af:"\u2061",Aring:"\xC5",angst:"\xC5",Ascr:"\u{1D49C}",Assign:"\u2254",colone:"\u2254",coloneq:"\u2254",Atilde:"\xC3",Auml:"\xC4",Backslash:"\u2216",setminus:"\u2216",setmn:"\u2216",smallsetminus:"\u2216",ssetmn:"\u2216",Barv:"\u2AE7",Barwed:"\u2306",doublebarwedge:"\u2306",Bcy:"\u0411",Because:"\u2235",becaus:"\u2235",because:"\u2235",Bernoullis:"\u212C",Bscr:"\u212C",bernou:"\u212C",Beta:"\u0392",Bfr:"\u{1D505}",Bopf:"\u{1D539}",Breve:"\u02D8",breve:"\u02D8",Bumpeq:"\u224E",HumpDownHump:"\u224E",bump:"\u224E",CHcy:"\u0427",COPY:"\xA9",copy:"\xA9",Cacute:"\u0106",Cap:"\u22D2",CapitalDifferentialD:"\u2145",DD:"\u2145",Cayleys:"\u212D",Cfr:"\u212D",Ccaron:"\u010C",Ccedil:"\xC7",Ccirc:"\u0108",Cconint:"\u2230",Cdot:"\u010A",Cedilla:"\xB8",cedil:"\xB8",CenterDot:"\xB7",centerdot:"\xB7",middot:"\xB7",Chi:"\u03A7",CircleDot:"\u2299",odot:"\u2299",CircleMinus:"\u2296",ominus:"\u2296",CirclePlus:"\u2295",oplus:"\u2295",CircleTimes:"\u2297",otimes:"\u2297",ClockwiseContourIntegral:"\u2232",cwconint:"\u2232",CloseCurlyDoubleQuote:"\u201D",rdquo:"\u201D",rdquor:"\u201D",CloseCurlyQuote:"\u2019",rsquo:"\u2019",rsquor:"\u2019",Colon:"\u2237",Proportion:"\u2237",Colone:"\u2A74",Congruent:"\u2261",equiv:"\u2261",Conint:"\u222F",DoubleContourIntegral:"\u222F",ContourIntegral:"\u222E",conint:"\u222E",oint:"\u222E",Copf:"\u2102",complexes:"\u2102",Coproduct:"\u2210",coprod:"\u2210",CounterClockwiseContourIntegral:"\u2233",awconint:"\u2233",Cross:"\u2A2F",Cscr:"\u{1D49E}",Cup:"\u22D3",CupCap:"\u224D",asympeq:"\u224D",DDotrahd:"\u2911",DJcy:"\u0402",DScy:"\u0405",DZcy:"\u040F",Dagger:"\u2021",ddagger:"\u2021",Darr:"\u21A1",Dashv:"\u2AE4",DoubleLeftTee:"\u2AE4",Dcaron:"\u010E",Dcy:"\u0414",Del:"\u2207",nabla:"\u2207",Delta:"\u0394",Dfr:"\u{1D507}",DiacriticalAcute:"\xB4",acute:"\xB4",DiacriticalDot:"\u02D9",dot:"\u02D9",DiacriticalDoubleAcute:"\u02DD",dblac:"\u02DD",DiacriticalGrave:"`",grave:"`",DiacriticalTilde:"\u02DC",tilde:"\u02DC",Diamond:"\u22C4",diam:"\u22C4",diamond:"\u22C4",DifferentialD:"\u2146",dd:"\u2146",Dopf:"\u{1D53B}",Dot:"\xA8",DoubleDot:"\xA8",die:"\xA8",uml:"\xA8",DotDot:"\u20DC",DotEqual:"\u2250",doteq:"\u2250",esdot:"\u2250",DoubleDownArrow:"\u21D3",Downarrow:"\u21D3",dArr:"\u21D3",DoubleLeftArrow:"\u21D0",Leftarrow:"\u21D0",lArr:"\u21D0",DoubleLeftRightArrow:"\u21D4",Leftrightarrow:"\u21D4",hArr:"\u21D4",iff:"\u21D4",DoubleLongLeftArrow:"\u27F8",Longleftarrow:"\u27F8",xlArr:"\u27F8",DoubleLongLeftRightArrow:"\u27FA",Longleftrightarrow:"\u27FA",xhArr:"\u27FA",DoubleLongRightArrow:"\u27F9",Longrightarrow:"\u27F9",xrArr:"\u27F9",DoubleRightArrow:"\u21D2",Implies:"\u21D2",Rightarrow:"\u21D2",rArr:"\u21D2",DoubleRightTee:"\u22A8",vDash:"\u22A8",DoubleUpArrow:"\u21D1",Uparrow:"\u21D1",uArr:"\u21D1",DoubleUpDownArrow:"\u21D5",Updownarrow:"\u21D5",vArr:"\u21D5",DoubleVerticalBar:"\u2225",par:"\u2225",parallel:"\u2225",shortparallel:"\u2225",spar:"\u2225",DownArrow:"\u2193",ShortDownArrow:"\u2193",darr:"\u2193",downarrow:"\u2193",DownArrowBar:"\u2913",DownArrowUpArrow:"\u21F5",duarr:"\u21F5",DownBreve:"\u0311",DownLeftRightVector:"\u2950",DownLeftTeeVector:"\u295E",DownLeftVector:"\u21BD",leftharpoondown:"\u21BD",lhard:"\u21BD",DownLeftVectorBar:"\u2956",DownRightTeeVector:"\u295F",DownRightVector:"\u21C1",rhard:"\u21C1",rightharpoondown:"\u21C1",DownRightVectorBar:"\u2957",DownTee:"\u22A4",top:"\u22A4",DownTeeArrow:"\u21A7",mapstodown:"\u21A7",Dscr:"\u{1D49F}",Dstrok:"\u0110",ENG:"\u014A",ETH:"\xD0",Eacute:"\xC9",Ecaron:"\u011A",Ecirc:"\xCA",Ecy:"\u042D",Edot:"\u0116",Efr:"\u{1D508}",Egrave:"\xC8",Element:"\u2208",in:"\u2208",isin:"\u2208",isinv:"\u2208",Emacr:"\u0112",EmptySmallSquare:"\u25FB",EmptyVerySmallSquare:"\u25AB",Eogon:"\u0118",Eopf:"\u{1D53C}",Epsilon:"\u0395",Equal:"\u2A75",EqualTilde:"\u2242",eqsim:"\u2242",esim:"\u2242",Equilibrium:"\u21CC",rightleftharpoons:"\u21CC",rlhar:"\u21CC",Escr:"\u2130",expectation:"\u2130",Esim:"\u2A73",Eta:"\u0397",Euml:"\xCB",Exists:"\u2203",exist:"\u2203",ExponentialE:"\u2147",ee:"\u2147",exponentiale:"\u2147",Fcy:"\u0424",Ffr:"\u{1D509}",FilledSmallSquare:"\u25FC",FilledVerySmallSquare:"\u25AA",blacksquare:"\u25AA",squarf:"\u25AA",squf:"\u25AA",Fopf:"\u{1D53D}",ForAll:"\u2200",forall:"\u2200",Fouriertrf:"\u2131",Fscr:"\u2131",GJcy:"\u0403",GT:">",gt:">",Gamma:"\u0393",Gammad:"\u03DC",Gbreve:"\u011E",Gcedil:"\u0122",Gcirc:"\u011C",Gcy:"\u0413",Gdot:"\u0120",Gfr:"\u{1D50A}",Gg:"\u22D9",ggg:"\u22D9",Gopf:"\u{1D53E}",GreaterEqual:"\u2265",ge:"\u2265",geq:"\u2265",GreaterEqualLess:"\u22DB",gel:"\u22DB",gtreqless:"\u22DB",GreaterFullEqual:"\u2267",gE:"\u2267",geqq:"\u2267",GreaterGreater:"\u2AA2",GreaterLess:"\u2277",gl:"\u2277",gtrless:"\u2277",GreaterSlantEqual:"\u2A7E",geqslant:"\u2A7E",ges:"\u2A7E",GreaterTilde:"\u2273",gsim:"\u2273",gtrsim:"\u2273",Gscr:"\u{1D4A2}",Gt:"\u226B",NestedGreaterGreater:"\u226B",gg:"\u226B",HARDcy:"\u042A",Hacek:"\u02C7",caron:"\u02C7",Hat:"^",Hcirc:"\u0124",Hfr:"\u210C",Poincareplane:"\u210C",HilbertSpace:"\u210B",Hscr:"\u210B",hamilt:"\u210B",Hopf:"\u210D",quaternions:"\u210D",HorizontalLine:"\u2500",boxh:"\u2500",Hstrok:"\u0126",HumpEqual:"\u224F",bumpe:"\u224F",bumpeq:"\u224F",IEcy:"\u0415",IJlig:"\u0132",IOcy:"\u0401",Iacute:"\xCD",Icirc:"\xCE",Icy:"\u0418",Idot:"\u0130",Ifr:"\u2111",Im:"\u2111",image:"\u2111",imagpart:"\u2111",Igrave:"\xCC",Imacr:"\u012A",ImaginaryI:"\u2148",ii:"\u2148",Int:"\u222C",Integral:"\u222B",int:"\u222B",Intersection:"\u22C2",bigcap:"\u22C2",xcap:"\u22C2",InvisibleComma:"\u2063",ic:"\u2063",InvisibleTimes:"\u2062",it:"\u2062",Iogon:"\u012E",Iopf:"\u{1D540}",Iota:"\u0399",Iscr:"\u2110",imagline:"\u2110",Itilde:"\u0128",Iukcy:"\u0406",Iuml:"\xCF",Jcirc:"\u0134",Jcy:"\u0419",Jfr:"\u{1D50D}",Jopf:"\u{1D541}",Jscr:"\u{1D4A5}",Jsercy:"\u0408",Jukcy:"\u0404",KHcy:"\u0425",KJcy:"\u040C",Kappa:"\u039A",Kcedil:"\u0136",Kcy:"\u041A",Kfr:"\u{1D50E}",Kopf:"\u{1D542}",Kscr:"\u{1D4A6}",LJcy:"\u0409",LT:"<",lt:"<",Lacute:"\u0139",Lambda:"\u039B",Lang:"\u27EA",Laplacetrf:"\u2112",Lscr:"\u2112",lagran:"\u2112",Larr:"\u219E",twoheadleftarrow:"\u219E",Lcaron:"\u013D",Lcedil:"\u013B",Lcy:"\u041B",LeftAngleBracket:"\u27E8",lang:"\u27E8",langle:"\u27E8",LeftArrow:"\u2190",ShortLeftArrow:"\u2190",larr:"\u2190",leftarrow:"\u2190",slarr:"\u2190",LeftArrowBar:"\u21E4",larrb:"\u21E4",LeftArrowRightArrow:"\u21C6",leftrightarrows:"\u21C6",lrarr:"\u21C6",LeftCeiling:"\u2308",lceil:"\u2308",LeftDoubleBracket:"\u27E6",lobrk:"\u27E6",LeftDownTeeVector:"\u2961",LeftDownVector:"\u21C3",dharl:"\u21C3",downharpoonleft:"\u21C3",LeftDownVectorBar:"\u2959",LeftFloor:"\u230A",lfloor:"\u230A",LeftRightArrow:"\u2194",harr:"\u2194",leftrightarrow:"\u2194",LeftRightVector:"\u294E",LeftTee:"\u22A3",dashv:"\u22A3",LeftTeeArrow:"\u21A4",mapstoleft:"\u21A4",LeftTeeVector:"\u295A",LeftTriangle:"\u22B2",vartriangleleft:"\u22B2",vltri:"\u22B2",LeftTriangleBar:"\u29CF",LeftTriangleEqual:"\u22B4",ltrie:"\u22B4",trianglelefteq:"\u22B4",LeftUpDownVector:"\u2951",LeftUpTeeVector:"\u2960",LeftUpVector:"\u21BF",uharl:"\u21BF",upharpoonleft:"\u21BF",LeftUpVectorBar:"\u2958",LeftVector:"\u21BC",leftharpoonup:"\u21BC",lharu:"\u21BC",LeftVectorBar:"\u2952",LessEqualGreater:"\u22DA",leg:"\u22DA",lesseqgtr:"\u22DA",LessFullEqual:"\u2266",lE:"\u2266",leqq:"\u2266",LessGreater:"\u2276",lessgtr:"\u2276",lg:"\u2276",LessLess:"\u2AA1",LessSlantEqual:"\u2A7D",leqslant:"\u2A7D",les:"\u2A7D",LessTilde:"\u2272",lesssim:"\u2272",lsim:"\u2272",Lfr:"\u{1D50F}",Ll:"\u22D8",Lleftarrow:"\u21DA",lAarr:"\u21DA",Lmidot:"\u013F",LongLeftArrow:"\u27F5",longleftarrow:"\u27F5",xlarr:"\u27F5",LongLeftRightArrow:"\u27F7",longleftrightarrow:"\u27F7",xharr:"\u27F7",LongRightArrow:"\u27F6",longrightarrow:"\u27F6",xrarr:"\u27F6",Lopf:"\u{1D543}",LowerLeftArrow:"\u2199",swarr:"\u2199",swarrow:"\u2199",LowerRightArrow:"\u2198",searr:"\u2198",searrow:"\u2198",Lsh:"\u21B0",lsh:"\u21B0",Lstrok:"\u0141",Lt:"\u226A",NestedLessLess:"\u226A",ll:"\u226A",Map:"\u2905",Mcy:"\u041C",MediumSpace:"\u205F",Mellintrf:"\u2133",Mscr:"\u2133",phmmat:"\u2133",Mfr:"\u{1D510}",MinusPlus:"\u2213",mnplus:"\u2213",mp:"\u2213",Mopf:"\u{1D544}",Mu:"\u039C",NJcy:"\u040A",Nacute:"\u0143",Ncaron:"\u0147",Ncedil:"\u0145",Ncy:"\u041D",NegativeMediumSpace:"\u200B",NegativeThickSpace:"\u200B",NegativeThinSpace:"\u200B",NegativeVeryThinSpace:"\u200B",ZeroWidthSpace:"\u200B",NewLine:`
`,Nfr:"\u{1D511}",NoBreak:"\u2060",NonBreakingSpace:"\xA0",nbsp:"\xA0",Nopf:"\u2115",naturals:"\u2115",Not:"\u2AEC",NotCongruent:"\u2262",nequiv:"\u2262",NotCupCap:"\u226D",NotDoubleVerticalBar:"\u2226",npar:"\u2226",nparallel:"\u2226",nshortparallel:"\u2226",nspar:"\u2226",NotElement:"\u2209",notin:"\u2209",notinva:"\u2209",NotEqual:"\u2260",ne:"\u2260",NotEqualTilde:"\u2242\u0338",nesim:"\u2242\u0338",NotExists:"\u2204",nexist:"\u2204",nexists:"\u2204",NotGreater:"\u226F",ngt:"\u226F",ngtr:"\u226F",NotGreaterEqual:"\u2271",nge:"\u2271",ngeq:"\u2271",NotGreaterFullEqual:"\u2267\u0338",ngE:"\u2267\u0338",ngeqq:"\u2267\u0338",NotGreaterGreater:"\u226B\u0338",nGtv:"\u226B\u0338",NotGreaterLess:"\u2279",ntgl:"\u2279",NotGreaterSlantEqual:"\u2A7E\u0338",ngeqslant:"\u2A7E\u0338",nges:"\u2A7E\u0338",NotGreaterTilde:"\u2275",ngsim:"\u2275",NotHumpDownHump:"\u224E\u0338",nbump:"\u224E\u0338",NotHumpEqual:"\u224F\u0338",nbumpe:"\u224F\u0338",NotLeftTriangle:"\u22EA",nltri:"\u22EA",ntriangleleft:"\u22EA",NotLeftTriangleBar:"\u29CF\u0338",NotLeftTriangleEqual:"\u22EC",nltrie:"\u22EC",ntrianglelefteq:"\u22EC",NotLess:"\u226E",nless:"\u226E",nlt:"\u226E",NotLessEqual:"\u2270",nle:"\u2270",nleq:"\u2270",NotLessGreater:"\u2278",ntlg:"\u2278",NotLessLess:"\u226A\u0338",nLtv:"\u226A\u0338",NotLessSlantEqual:"\u2A7D\u0338",nleqslant:"\u2A7D\u0338",nles:"\u2A7D\u0338",NotLessTilde:"\u2274",nlsim:"\u2274",NotNestedGreaterGreater:"\u2AA2\u0338",NotNestedLessLess:"\u2AA1\u0338",NotPrecedes:"\u2280",npr:"\u2280",nprec:"\u2280",NotPrecedesEqual:"\u2AAF\u0338",npre:"\u2AAF\u0338",npreceq:"\u2AAF\u0338",NotPrecedesSlantEqual:"\u22E0",nprcue:"\u22E0",NotReverseElement:"\u220C",notni:"\u220C",notniva:"\u220C",NotRightTriangle:"\u22EB",nrtri:"\u22EB",ntriangleright:"\u22EB",NotRightTriangleBar:"\u29D0\u0338",NotRightTriangleEqual:"\u22ED",nrtrie:"\u22ED",ntrianglerighteq:"\u22ED",NotSquareSubset:"\u228F\u0338",NotSquareSubsetEqual:"\u22E2",nsqsube:"\u22E2",NotSquareSuperset:"\u2290\u0338",NotSquareSupersetEqual:"\u22E3",nsqsupe:"\u22E3",NotSubset:"\u2282\u20D2",nsubset:"\u2282\u20D2",vnsub:"\u2282\u20D2",NotSubsetEqual:"\u2288",nsube:"\u2288",nsubseteq:"\u2288",NotSucceeds:"\u2281",nsc:"\u2281",nsucc:"\u2281",NotSucceedsEqual:"\u2AB0\u0338",nsce:"\u2AB0\u0338",nsucceq:"\u2AB0\u0338",NotSucceedsSlantEqual:"\u22E1",nsccue:"\u22E1",NotSucceedsTilde:"\u227F\u0338",NotSuperset:"\u2283\u20D2",nsupset:"\u2283\u20D2",vnsup:"\u2283\u20D2",NotSupersetEqual:"\u2289",nsupe:"\u2289",nsupseteq:"\u2289",NotTilde:"\u2241",nsim:"\u2241",NotTildeEqual:"\u2244",nsime:"\u2244",nsimeq:"\u2244",NotTildeFullEqual:"\u2247",ncong:"\u2247",NotTildeTilde:"\u2249",nap:"\u2249",napprox:"\u2249",NotVerticalBar:"\u2224",nmid:"\u2224",nshortmid:"\u2224",nsmid:"\u2224",Nscr:"\u{1D4A9}",Ntilde:"\xD1",Nu:"\u039D",OElig:"\u0152",Oacute:"\xD3",Ocirc:"\xD4",Ocy:"\u041E",Odblac:"\u0150",Ofr:"\u{1D512}",Ograve:"\xD2",Omacr:"\u014C",Omega:"\u03A9",ohm:"\u03A9",Omicron:"\u039F",Oopf:"\u{1D546}",OpenCurlyDoubleQuote:"\u201C",ldquo:"\u201C",OpenCurlyQuote:"\u2018",lsquo:"\u2018",Or:"\u2A54",Oscr:"\u{1D4AA}",Oslash:"\xD8",Otilde:"\xD5",Otimes:"\u2A37",Ouml:"\xD6",OverBar:"\u203E",oline:"\u203E",OverBrace:"\u23DE",OverBracket:"\u23B4",tbrk:"\u23B4",OverParenthesis:"\u23DC",PartialD:"\u2202",part:"\u2202",Pcy:"\u041F",Pfr:"\u{1D513}",Phi:"\u03A6",Pi:"\u03A0",PlusMinus:"\xB1",plusmn:"\xB1",pm:"\xB1",Popf:"\u2119",primes:"\u2119",Pr:"\u2ABB",Precedes:"\u227A",pr:"\u227A",prec:"\u227A",PrecedesEqual:"\u2AAF",pre:"\u2AAF",preceq:"\u2AAF",PrecedesSlantEqual:"\u227C",prcue:"\u227C",preccurlyeq:"\u227C",PrecedesTilde:"\u227E",precsim:"\u227E",prsim:"\u227E",Prime:"\u2033",Product:"\u220F",prod:"\u220F",Proportional:"\u221D",prop:"\u221D",propto:"\u221D",varpropto:"\u221D",vprop:"\u221D",Pscr:"\u{1D4AB}",Psi:"\u03A8",QUOT:'"',quot:'"',Qfr:"\u{1D514}",Qopf:"\u211A",rationals:"\u211A",Qscr:"\u{1D4AC}",RBarr:"\u2910",drbkarow:"\u2910",REG:"\xAE",circledR:"\xAE",reg:"\xAE",Racute:"\u0154",Rang:"\u27EB",Rarr:"\u21A0",twoheadrightarrow:"\u21A0",Rarrtl:"\u2916",Rcaron:"\u0158",Rcedil:"\u0156",Rcy:"\u0420",Re:"\u211C",Rfr:"\u211C",real:"\u211C",realpart:"\u211C",ReverseElement:"\u220B",SuchThat:"\u220B",ni:"\u220B",niv:"\u220B",ReverseEquilibrium:"\u21CB",leftrightharpoons:"\u21CB",lrhar:"\u21CB",ReverseUpEquilibrium:"\u296F",duhar:"\u296F",Rho:"\u03A1",RightAngleBracket:"\u27E9",rang:"\u27E9",rangle:"\u27E9",RightArrow:"\u2192",ShortRightArrow:"\u2192",rarr:"\u2192",rightarrow:"\u2192",srarr:"\u2192",RightArrowBar:"\u21E5",rarrb:"\u21E5",RightArrowLeftArrow:"\u21C4",rightleftarrows:"\u21C4",rlarr:"\u21C4",RightCeiling:"\u2309",rceil:"\u2309",RightDoubleBracket:"\u27E7",robrk:"\u27E7",RightDownTeeVector:"\u295D",RightDownVector:"\u21C2",dharr:"\u21C2",downharpoonright:"\u21C2",RightDownVectorBar:"\u2955",RightFloor:"\u230B",rfloor:"\u230B",RightTee:"\u22A2",vdash:"\u22A2",RightTeeArrow:"\u21A6",map:"\u21A6",mapsto:"\u21A6",RightTeeVector:"\u295B",RightTriangle:"\u22B3",vartriangleright:"\u22B3",vrtri:"\u22B3",RightTriangleBar:"\u29D0",RightTriangleEqual:"\u22B5",rtrie:"\u22B5",trianglerighteq:"\u22B5",RightUpDownVector:"\u294F",RightUpTeeVector:"\u295C",RightUpVector:"\u21BE",uharr:"\u21BE",upharpoonright:"\u21BE",RightUpVectorBar:"\u2954",RightVector:"\u21C0",rharu:"\u21C0",rightharpoonup:"\u21C0",RightVectorBar:"\u2953",Ropf:"\u211D",reals:"\u211D",RoundImplies:"\u2970",Rrightarrow:"\u21DB",rAarr:"\u21DB",Rscr:"\u211B",realine:"\u211B",Rsh:"\u21B1",rsh:"\u21B1",RuleDelayed:"\u29F4",SHCHcy:"\u0429",SHcy:"\u0428",SOFTcy:"\u042C",Sacute:"\u015A",Sc:"\u2ABC",Scaron:"\u0160",Scedil:"\u015E",Scirc:"\u015C",Scy:"\u0421",Sfr:"\u{1D516}",ShortUpArrow:"\u2191",UpArrow:"\u2191",uarr:"\u2191",uparrow:"\u2191",Sigma:"\u03A3",SmallCircle:"\u2218",compfn:"\u2218",Sopf:"\u{1D54A}",Sqrt:"\u221A",radic:"\u221A",Square:"\u25A1",squ:"\u25A1",square:"\u25A1",SquareIntersection:"\u2293",sqcap:"\u2293",SquareSubset:"\u228F",sqsub:"\u228F",sqsubset:"\u228F",SquareSubsetEqual:"\u2291",sqsube:"\u2291",sqsubseteq:"\u2291",SquareSuperset:"\u2290",sqsup:"\u2290",sqsupset:"\u2290",SquareSupersetEqual:"\u2292",sqsupe:"\u2292",sqsupseteq:"\u2292",SquareUnion:"\u2294",sqcup:"\u2294",Sscr:"\u{1D4AE}",Star:"\u22C6",sstarf:"\u22C6",Sub:"\u22D0",Subset:"\u22D0",SubsetEqual:"\u2286",sube:"\u2286",subseteq:"\u2286",Succeeds:"\u227B",sc:"\u227B",succ:"\u227B",SucceedsEqual:"\u2AB0",sce:"\u2AB0",succeq:"\u2AB0",SucceedsSlantEqual:"\u227D",sccue:"\u227D",succcurlyeq:"\u227D",SucceedsTilde:"\u227F",scsim:"\u227F",succsim:"\u227F",Sum:"\u2211",sum:"\u2211",Sup:"\u22D1",Supset:"\u22D1",Superset:"\u2283",sup:"\u2283",supset:"\u2283",SupersetEqual:"\u2287",supe:"\u2287",supseteq:"\u2287",THORN:"\xDE",TRADE:"\u2122",trade:"\u2122",TSHcy:"\u040B",TScy:"\u0426",Tab:"	",Tau:"\u03A4",Tcaron:"\u0164",Tcedil:"\u0162",Tcy:"\u0422",Tfr:"\u{1D517}",Therefore:"\u2234",there4:"\u2234",therefore:"\u2234",Theta:"\u0398",ThickSpace:"\u205F\u200A",ThinSpace:"\u2009",thinsp:"\u2009",Tilde:"\u223C",sim:"\u223C",thicksim:"\u223C",thksim:"\u223C",TildeEqual:"\u2243",sime:"\u2243",simeq:"\u2243",TildeFullEqual:"\u2245",cong:"\u2245",TildeTilde:"\u2248",ap:"\u2248",approx:"\u2248",asymp:"\u2248",thickapprox:"\u2248",thkap:"\u2248",Topf:"\u{1D54B}",TripleDot:"\u20DB",tdot:"\u20DB",Tscr:"\u{1D4AF}",Tstrok:"\u0166",Uacute:"\xDA",Uarr:"\u219F",Uarrocir:"\u2949",Ubrcy:"\u040E",Ubreve:"\u016C",Ucirc:"\xDB",Ucy:"\u0423",Udblac:"\u0170",Ufr:"\u{1D518}",Ugrave:"\xD9",Umacr:"\u016A",UnderBar:"_",lowbar:"_",UnderBrace:"\u23DF",UnderBracket:"\u23B5",bbrk:"\u23B5",UnderParenthesis:"\u23DD",Union:"\u22C3",bigcup:"\u22C3",xcup:"\u22C3",UnionPlus:"\u228E",uplus:"\u228E",Uogon:"\u0172",Uopf:"\u{1D54C}",UpArrowBar:"\u2912",UpArrowDownArrow:"\u21C5",udarr:"\u21C5",UpDownArrow:"\u2195",updownarrow:"\u2195",varr:"\u2195",UpEquilibrium:"\u296E",udhar:"\u296E",UpTee:"\u22A5",bot:"\u22A5",bottom:"\u22A5",perp:"\u22A5",UpTeeArrow:"\u21A5",mapstoup:"\u21A5",UpperLeftArrow:"\u2196",nwarr:"\u2196",nwarrow:"\u2196",UpperRightArrow:"\u2197",nearr:"\u2197",nearrow:"\u2197",Upsi:"\u03D2",upsih:"\u03D2",Upsilon:"\u03A5",Uring:"\u016E",Uscr:"\u{1D4B0}",Utilde:"\u0168",Uuml:"\xDC",VDash:"\u22AB",Vbar:"\u2AEB",Vcy:"\u0412",Vdash:"\u22A9",Vdashl:"\u2AE6",Vee:"\u22C1",bigvee:"\u22C1",xvee:"\u22C1",Verbar:"\u2016",Vert:"\u2016",VerticalBar:"\u2223",mid:"\u2223",shortmid:"\u2223",smid:"\u2223",VerticalLine:"|",verbar:"|",vert:"|",VerticalSeparator:"\u2758",VerticalTilde:"\u2240",wr:"\u2240",wreath:"\u2240",VeryThinSpace:"\u200A",hairsp:"\u200A",Vfr:"\u{1D519}",Vopf:"\u{1D54D}",Vscr:"\u{1D4B1}",Vvdash:"\u22AA",Wcirc:"\u0174",Wedge:"\u22C0",bigwedge:"\u22C0",xwedge:"\u22C0",Wfr:"\u{1D51A}",Wopf:"\u{1D54E}",Wscr:"\u{1D4B2}",Xfr:"\u{1D51B}",Xi:"\u039E",Xopf:"\u{1D54F}",Xscr:"\u{1D4B3}",YAcy:"\u042F",YIcy:"\u0407",YUcy:"\u042E",Yacute:"\xDD",Ycirc:"\u0176",Ycy:"\u042B",Yfr:"\u{1D51C}",Yopf:"\u{1D550}",Yscr:"\u{1D4B4}",Yuml:"\u0178",ZHcy:"\u0416",Zacute:"\u0179",Zcaron:"\u017D",Zcy:"\u0417",Zdot:"\u017B",Zeta:"\u0396",Zfr:"\u2128",zeetrf:"\u2128",Zopf:"\u2124",integers:"\u2124",Zscr:"\u{1D4B5}",aacute:"\xE1",abreve:"\u0103",ac:"\u223E",mstpos:"\u223E",acE:"\u223E\u0333",acd:"\u223F",acirc:"\xE2",acy:"\u0430",aelig:"\xE6",afr:"\u{1D51E}",agrave:"\xE0",alefsym:"\u2135",aleph:"\u2135",alpha:"\u03B1",amacr:"\u0101",amalg:"\u2A3F",and:"\u2227",wedge:"\u2227",andand:"\u2A55",andd:"\u2A5C",andslope:"\u2A58",andv:"\u2A5A",ang:"\u2220",angle:"\u2220",ange:"\u29A4",angmsd:"\u2221",measuredangle:"\u2221",angmsdaa:"\u29A8",angmsdab:"\u29A9",angmsdac:"\u29AA",angmsdad:"\u29AB",angmsdae:"\u29AC",angmsdaf:"\u29AD",angmsdag:"\u29AE",angmsdah:"\u29AF",angrt:"\u221F",angrtvb:"\u22BE",angrtvbd:"\u299D",angsph:"\u2222",angzarr:"\u237C",aogon:"\u0105",aopf:"\u{1D552}",apE:"\u2A70",apacir:"\u2A6F",ape:"\u224A",approxeq:"\u224A",apid:"\u224B",apos:"'",aring:"\xE5",ascr:"\u{1D4B6}",ast:"*",midast:"*",atilde:"\xE3",auml:"\xE4",awint:"\u2A11",bNot:"\u2AED",backcong:"\u224C",bcong:"\u224C",backepsilon:"\u03F6",bepsi:"\u03F6",backprime:"\u2035",bprime:"\u2035",backsim:"\u223D",bsim:"\u223D",backsimeq:"\u22CD",bsime:"\u22CD",barvee:"\u22BD",barwed:"\u2305",barwedge:"\u2305",bbrktbrk:"\u23B6",bcy:"\u0431",bdquo:"\u201E",ldquor:"\u201E",bemptyv:"\u29B0",beta:"\u03B2",beth:"\u2136",between:"\u226C",twixt:"\u226C",bfr:"\u{1D51F}",bigcirc:"\u25EF",xcirc:"\u25EF",bigodot:"\u2A00",xodot:"\u2A00",bigoplus:"\u2A01",xoplus:"\u2A01",bigotimes:"\u2A02",xotime:"\u2A02",bigsqcup:"\u2A06",xsqcup:"\u2A06",bigstar:"\u2605",starf:"\u2605",bigtriangledown:"\u25BD",xdtri:"\u25BD",bigtriangleup:"\u25B3",xutri:"\u25B3",biguplus:"\u2A04",xuplus:"\u2A04",bkarow:"\u290D",rbarr:"\u290D",blacklozenge:"\u29EB",lozf:"\u29EB",blacktriangle:"\u25B4",utrif:"\u25B4",blacktriangledown:"\u25BE",dtrif:"\u25BE",blacktriangleleft:"\u25C2",ltrif:"\u25C2",blacktriangleright:"\u25B8",rtrif:"\u25B8",blank:"\u2423",blk12:"\u2592",blk14:"\u2591",blk34:"\u2593",block:"\u2588",bne:"=\u20E5",bnequiv:"\u2261\u20E5",bnot:"\u2310",bopf:"\u{1D553}",bowtie:"\u22C8",boxDL:"\u2557",boxDR:"\u2554",boxDl:"\u2556",boxDr:"\u2553",boxH:"\u2550",boxHD:"\u2566",boxHU:"\u2569",boxHd:"\u2564",boxHu:"\u2567",boxUL:"\u255D",boxUR:"\u255A",boxUl:"\u255C",boxUr:"\u2559",boxV:"\u2551",boxVH:"\u256C",boxVL:"\u2563",boxVR:"\u2560",boxVh:"\u256B",boxVl:"\u2562",boxVr:"\u255F",boxbox:"\u29C9",boxdL:"\u2555",boxdR:"\u2552",boxdl:"\u2510",boxdr:"\u250C",boxhD:"\u2565",boxhU:"\u2568",boxhd:"\u252C",boxhu:"\u2534",boxminus:"\u229F",minusb:"\u229F",boxplus:"\u229E",plusb:"\u229E",boxtimes:"\u22A0",timesb:"\u22A0",boxuL:"\u255B",boxuR:"\u2558",boxul:"\u2518",boxur:"\u2514",boxv:"\u2502",boxvH:"\u256A",boxvL:"\u2561",boxvR:"\u255E",boxvh:"\u253C",boxvl:"\u2524",boxvr:"\u251C",brvbar:"\xA6",bscr:"\u{1D4B7}",bsemi:"\u204F",bsol:"\\",bsolb:"\u29C5",bsolhsub:"\u27C8",bull:"\u2022",bullet:"\u2022",bumpE:"\u2AAE",cacute:"\u0107",cap:"\u2229",capand:"\u2A44",capbrcup:"\u2A49",capcap:"\u2A4B",capcup:"\u2A47",capdot:"\u2A40",caps:"\u2229\uFE00",caret:"\u2041",ccaps:"\u2A4D",ccaron:"\u010D",ccedil:"\xE7",ccirc:"\u0109",ccups:"\u2A4C",ccupssm:"\u2A50",cdot:"\u010B",cemptyv:"\u29B2",cent:"\xA2",cfr:"\u{1D520}",chcy:"\u0447",check:"\u2713",checkmark:"\u2713",chi:"\u03C7",cir:"\u25CB",cirE:"\u29C3",circ:"\u02C6",circeq:"\u2257",cire:"\u2257",circlearrowleft:"\u21BA",olarr:"\u21BA",circlearrowright:"\u21BB",orarr:"\u21BB",circledS:"\u24C8",oS:"\u24C8",circledast:"\u229B",oast:"\u229B",circledcirc:"\u229A",ocir:"\u229A",circleddash:"\u229D",odash:"\u229D",cirfnint:"\u2A10",cirmid:"\u2AEF",cirscir:"\u29C2",clubs:"\u2663",clubsuit:"\u2663",colon:":",comma:",",commat:"@",comp:"\u2201",complement:"\u2201",congdot:"\u2A6D",copf:"\u{1D554}",copysr:"\u2117",crarr:"\u21B5",cross:"\u2717",cscr:"\u{1D4B8}",csub:"\u2ACF",csube:"\u2AD1",csup:"\u2AD0",csupe:"\u2AD2",ctdot:"\u22EF",cudarrl:"\u2938",cudarrr:"\u2935",cuepr:"\u22DE",curlyeqprec:"\u22DE",cuesc:"\u22DF",curlyeqsucc:"\u22DF",cularr:"\u21B6",curvearrowleft:"\u21B6",cularrp:"\u293D",cup:"\u222A",cupbrcap:"\u2A48",cupcap:"\u2A46",cupcup:"\u2A4A",cupdot:"\u228D",cupor:"\u2A45",cups:"\u222A\uFE00",curarr:"\u21B7",curvearrowright:"\u21B7",curarrm:"\u293C",curlyvee:"\u22CE",cuvee:"\u22CE",curlywedge:"\u22CF",cuwed:"\u22CF",curren:"\xA4",cwint:"\u2231",cylcty:"\u232D",dHar:"\u2965",dagger:"\u2020",daleth:"\u2138",dash:"\u2010",hyphen:"\u2010",dbkarow:"\u290F",rBarr:"\u290F",dcaron:"\u010F",dcy:"\u0434",ddarr:"\u21CA",downdownarrows:"\u21CA",ddotseq:"\u2A77",eDDot:"\u2A77",deg:"\xB0",delta:"\u03B4",demptyv:"\u29B1",dfisht:"\u297F",dfr:"\u{1D521}",diamondsuit:"\u2666",diams:"\u2666",digamma:"\u03DD",gammad:"\u03DD",disin:"\u22F2",div:"\xF7",divide:"\xF7",divideontimes:"\u22C7",divonx:"\u22C7",djcy:"\u0452",dlcorn:"\u231E",llcorner:"\u231E",dlcrop:"\u230D",dollar:"$",dopf:"\u{1D555}",doteqdot:"\u2251",eDot:"\u2251",dotminus:"\u2238",minusd:"\u2238",dotplus:"\u2214",plusdo:"\u2214",dotsquare:"\u22A1",sdotb:"\u22A1",drcorn:"\u231F",lrcorner:"\u231F",drcrop:"\u230C",dscr:"\u{1D4B9}",dscy:"\u0455",dsol:"\u29F6",dstrok:"\u0111",dtdot:"\u22F1",dtri:"\u25BF",triangledown:"\u25BF",dwangle:"\u29A6",dzcy:"\u045F",dzigrarr:"\u27FF",eacute:"\xE9",easter:"\u2A6E",ecaron:"\u011B",ecir:"\u2256",eqcirc:"\u2256",ecirc:"\xEA",ecolon:"\u2255",eqcolon:"\u2255",ecy:"\u044D",edot:"\u0117",efDot:"\u2252",fallingdotseq:"\u2252",efr:"\u{1D522}",eg:"\u2A9A",egrave:"\xE8",egs:"\u2A96",eqslantgtr:"\u2A96",egsdot:"\u2A98",el:"\u2A99",elinters:"\u23E7",ell:"\u2113",els:"\u2A95",eqslantless:"\u2A95",elsdot:"\u2A97",emacr:"\u0113",empty:"\u2205",emptyset:"\u2205",emptyv:"\u2205",varnothing:"\u2205",emsp13:"\u2004",emsp14:"\u2005",emsp:"\u2003",eng:"\u014B",ensp:"\u2002",eogon:"\u0119",eopf:"\u{1D556}",epar:"\u22D5",eparsl:"\u29E3",eplus:"\u2A71",epsi:"\u03B5",epsilon:"\u03B5",epsiv:"\u03F5",straightepsilon:"\u03F5",varepsilon:"\u03F5",equals:"=",equest:"\u225F",questeq:"\u225F",equivDD:"\u2A78",eqvparsl:"\u29E5",erDot:"\u2253",risingdotseq:"\u2253",erarr:"\u2971",escr:"\u212F",eta:"\u03B7",eth:"\xF0",euml:"\xEB",euro:"\u20AC",excl:"!",fcy:"\u0444",female:"\u2640",ffilig:"\uFB03",fflig:"\uFB00",ffllig:"\uFB04",ffr:"\u{1D523}",filig:"\uFB01",fjlig:"fj",flat:"\u266D",fllig:"\uFB02",fltns:"\u25B1",fnof:"\u0192",fopf:"\u{1D557}",fork:"\u22D4",pitchfork:"\u22D4",forkv:"\u2AD9",fpartint:"\u2A0D",frac12:"\xBD",half:"\xBD",frac13:"\u2153",frac14:"\xBC",frac15:"\u2155",frac16:"\u2159",frac18:"\u215B",frac23:"\u2154",frac25:"\u2156",frac34:"\xBE",frac35:"\u2157",frac38:"\u215C",frac45:"\u2158",frac56:"\u215A",frac58:"\u215D",frac78:"\u215E",frasl:"\u2044",frown:"\u2322",sfrown:"\u2322",fscr:"\u{1D4BB}",gEl:"\u2A8C",gtreqqless:"\u2A8C",gacute:"\u01F5",gamma:"\u03B3",gap:"\u2A86",gtrapprox:"\u2A86",gbreve:"\u011F",gcirc:"\u011D",gcy:"\u0433",gdot:"\u0121",gescc:"\u2AA9",gesdot:"\u2A80",gesdoto:"\u2A82",gesdotol:"\u2A84",gesl:"\u22DB\uFE00",gesles:"\u2A94",gfr:"\u{1D524}",gimel:"\u2137",gjcy:"\u0453",glE:"\u2A92",gla:"\u2AA5",glj:"\u2AA4",gnE:"\u2269",gneqq:"\u2269",gnap:"\u2A8A",gnapprox:"\u2A8A",gne:"\u2A88",gneq:"\u2A88",gnsim:"\u22E7",gopf:"\u{1D558}",gscr:"\u210A",gsime:"\u2A8E",gsiml:"\u2A90",gtcc:"\u2AA7",gtcir:"\u2A7A",gtdot:"\u22D7",gtrdot:"\u22D7",gtlPar:"\u2995",gtquest:"\u2A7C",gtrarr:"\u2978",gvertneqq:"\u2269\uFE00",gvnE:"\u2269\uFE00",hardcy:"\u044A",harrcir:"\u2948",harrw:"\u21AD",leftrightsquigarrow:"\u21AD",hbar:"\u210F",hslash:"\u210F",planck:"\u210F",plankv:"\u210F",hcirc:"\u0125",hearts:"\u2665",heartsuit:"\u2665",hellip:"\u2026",mldr:"\u2026",hercon:"\u22B9",hfr:"\u{1D525}",hksearow:"\u2925",searhk:"\u2925",hkswarow:"\u2926",swarhk:"\u2926",hoarr:"\u21FF",homtht:"\u223B",hookleftarrow:"\u21A9",larrhk:"\u21A9",hookrightarrow:"\u21AA",rarrhk:"\u21AA",hopf:"\u{1D559}",horbar:"\u2015",hscr:"\u{1D4BD}",hstrok:"\u0127",hybull:"\u2043",iacute:"\xED",icirc:"\xEE",icy:"\u0438",iecy:"\u0435",iexcl:"\xA1",ifr:"\u{1D526}",igrave:"\xEC",iiiint:"\u2A0C",qint:"\u2A0C",iiint:"\u222D",tint:"\u222D",iinfin:"\u29DC",iiota:"\u2129",ijlig:"\u0133",imacr:"\u012B",imath:"\u0131",inodot:"\u0131",imof:"\u22B7",imped:"\u01B5",incare:"\u2105",infin:"\u221E",infintie:"\u29DD",intcal:"\u22BA",intercal:"\u22BA",intlarhk:"\u2A17",intprod:"\u2A3C",iprod:"\u2A3C",iocy:"\u0451",iogon:"\u012F",iopf:"\u{1D55A}",iota:"\u03B9",iquest:"\xBF",iscr:"\u{1D4BE}",isinE:"\u22F9",isindot:"\u22F5",isins:"\u22F4",isinsv:"\u22F3",itilde:"\u0129",iukcy:"\u0456",iuml:"\xEF",jcirc:"\u0135",jcy:"\u0439",jfr:"\u{1D527}",jmath:"\u0237",jopf:"\u{1D55B}",jscr:"\u{1D4BF}",jsercy:"\u0458",jukcy:"\u0454",kappa:"\u03BA",kappav:"\u03F0",varkappa:"\u03F0",kcedil:"\u0137",kcy:"\u043A",kfr:"\u{1D528}",kgreen:"\u0138",khcy:"\u0445",kjcy:"\u045C",kopf:"\u{1D55C}",kscr:"\u{1D4C0}",lAtail:"\u291B",lBarr:"\u290E",lEg:"\u2A8B",lesseqqgtr:"\u2A8B",lHar:"\u2962",lacute:"\u013A",laemptyv:"\u29B4",lambda:"\u03BB",langd:"\u2991",lap:"\u2A85",lessapprox:"\u2A85",laquo:"\xAB",larrbfs:"\u291F",larrfs:"\u291D",larrlp:"\u21AB",looparrowleft:"\u21AB",larrpl:"\u2939",larrsim:"\u2973",larrtl:"\u21A2",leftarrowtail:"\u21A2",lat:"\u2AAB",latail:"\u2919",late:"\u2AAD",lates:"\u2AAD\uFE00",lbarr:"\u290C",lbbrk:"\u2772",lbrace:"{",lcub:"{",lbrack:"[",lsqb:"[",lbrke:"\u298B",lbrksld:"\u298F",lbrkslu:"\u298D",lcaron:"\u013E",lcedil:"\u013C",lcy:"\u043B",ldca:"\u2936",ldrdhar:"\u2967",ldrushar:"\u294B",ldsh:"\u21B2",le:"\u2264",leq:"\u2264",leftleftarrows:"\u21C7",llarr:"\u21C7",leftthreetimes:"\u22CB",lthree:"\u22CB",lescc:"\u2AA8",lesdot:"\u2A7F",lesdoto:"\u2A81",lesdotor:"\u2A83",lesg:"\u22DA\uFE00",lesges:"\u2A93",lessdot:"\u22D6",ltdot:"\u22D6",lfisht:"\u297C",lfr:"\u{1D529}",lgE:"\u2A91",lharul:"\u296A",lhblk:"\u2584",ljcy:"\u0459",llhard:"\u296B",lltri:"\u25FA",lmidot:"\u0140",lmoust:"\u23B0",lmoustache:"\u23B0",lnE:"\u2268",lneqq:"\u2268",lnap:"\u2A89",lnapprox:"\u2A89",lne:"\u2A87",lneq:"\u2A87",lnsim:"\u22E6",loang:"\u27EC",loarr:"\u21FD",longmapsto:"\u27FC",xmap:"\u27FC",looparrowright:"\u21AC",rarrlp:"\u21AC",lopar:"\u2985",lopf:"\u{1D55D}",loplus:"\u2A2D",lotimes:"\u2A34",lowast:"\u2217",loz:"\u25CA",lozenge:"\u25CA",lpar:"(",lparlt:"\u2993",lrhard:"\u296D",lrm:"\u200E",lrtri:"\u22BF",lsaquo:"\u2039",lscr:"\u{1D4C1}",lsime:"\u2A8D",lsimg:"\u2A8F",lsquor:"\u201A",sbquo:"\u201A",lstrok:"\u0142",ltcc:"\u2AA6",ltcir:"\u2A79",ltimes:"\u22C9",ltlarr:"\u2976",ltquest:"\u2A7B",ltrPar:"\u2996",ltri:"\u25C3",triangleleft:"\u25C3",lurdshar:"\u294A",luruhar:"\u2966",lvertneqq:"\u2268\uFE00",lvnE:"\u2268\uFE00",mDDot:"\u223A",macr:"\xAF",strns:"\xAF",male:"\u2642",malt:"\u2720",maltese:"\u2720",marker:"\u25AE",mcomma:"\u2A29",mcy:"\u043C",mdash:"\u2014",mfr:"\u{1D52A}",mho:"\u2127",micro:"\xB5",midcir:"\u2AF0",minus:"\u2212",minusdu:"\u2A2A",mlcp:"\u2ADB",models:"\u22A7",mopf:"\u{1D55E}",mscr:"\u{1D4C2}",mu:"\u03BC",multimap:"\u22B8",mumap:"\u22B8",nGg:"\u22D9\u0338",nGt:"\u226B\u20D2",nLeftarrow:"\u21CD",nlArr:"\u21CD",nLeftrightarrow:"\u21CE",nhArr:"\u21CE",nLl:"\u22D8\u0338",nLt:"\u226A\u20D2",nRightarrow:"\u21CF",nrArr:"\u21CF",nVDash:"\u22AF",nVdash:"\u22AE",nacute:"\u0144",nang:"\u2220\u20D2",napE:"\u2A70\u0338",napid:"\u224B\u0338",napos:"\u0149",natur:"\u266E",natural:"\u266E",ncap:"\u2A43",ncaron:"\u0148",ncedil:"\u0146",ncongdot:"\u2A6D\u0338",ncup:"\u2A42",ncy:"\u043D",ndash:"\u2013",neArr:"\u21D7",nearhk:"\u2924",nedot:"\u2250\u0338",nesear:"\u2928",toea:"\u2928",nfr:"\u{1D52B}",nharr:"\u21AE",nleftrightarrow:"\u21AE",nhpar:"\u2AF2",nis:"\u22FC",nisd:"\u22FA",njcy:"\u045A",nlE:"\u2266\u0338",nleqq:"\u2266\u0338",nlarr:"\u219A",nleftarrow:"\u219A",nldr:"\u2025",nopf:"\u{1D55F}",not:"\xAC",notinE:"\u22F9\u0338",notindot:"\u22F5\u0338",notinvb:"\u22F7",notinvc:"\u22F6",notnivb:"\u22FE",notnivc:"\u22FD",nparsl:"\u2AFD\u20E5",npart:"\u2202\u0338",npolint:"\u2A14",nrarr:"\u219B",nrightarrow:"\u219B",nrarrc:"\u2933\u0338",nrarrw:"\u219D\u0338",nscr:"\u{1D4C3}",nsub:"\u2284",nsubE:"\u2AC5\u0338",nsubseteqq:"\u2AC5\u0338",nsup:"\u2285",nsupE:"\u2AC6\u0338",nsupseteqq:"\u2AC6\u0338",ntilde:"\xF1",nu:"\u03BD",num:"#",numero:"\u2116",numsp:"\u2007",nvDash:"\u22AD",nvHarr:"\u2904",nvap:"\u224D\u20D2",nvdash:"\u22AC",nvge:"\u2265\u20D2",nvgt:">\u20D2",nvinfin:"\u29DE",nvlArr:"\u2902",nvle:"\u2264\u20D2",nvlt:"<\u20D2",nvltrie:"\u22B4\u20D2",nvrArr:"\u2903",nvrtrie:"\u22B5\u20D2",nvsim:"\u223C\u20D2",nwArr:"\u21D6",nwarhk:"\u2923",nwnear:"\u2927",oacute:"\xF3",ocirc:"\xF4",ocy:"\u043E",odblac:"\u0151",odiv:"\u2A38",odsold:"\u29BC",oelig:"\u0153",ofcir:"\u29BF",ofr:"\u{1D52C}",ogon:"\u02DB",ograve:"\xF2",ogt:"\u29C1",ohbar:"\u29B5",olcir:"\u29BE",olcross:"\u29BB",olt:"\u29C0",omacr:"\u014D",omega:"\u03C9",omicron:"\u03BF",omid:"\u29B6",oopf:"\u{1D560}",opar:"\u29B7",operp:"\u29B9",or:"\u2228",vee:"\u2228",ord:"\u2A5D",order:"\u2134",orderof:"\u2134",oscr:"\u2134",ordf:"\xAA",ordm:"\xBA",origof:"\u22B6",oror:"\u2A56",orslope:"\u2A57",orv:"\u2A5B",oslash:"\xF8",osol:"\u2298",otilde:"\xF5",otimesas:"\u2A36",ouml:"\xF6",ovbar:"\u233D",para:"\xB6",parsim:"\u2AF3",parsl:"\u2AFD",pcy:"\u043F",percnt:"%",period:".",permil:"\u2030",pertenk:"\u2031",pfr:"\u{1D52D}",phi:"\u03C6",phiv:"\u03D5",straightphi:"\u03D5",varphi:"\u03D5",phone:"\u260E",pi:"\u03C0",piv:"\u03D6",varpi:"\u03D6",planckh:"\u210E",plus:"+",plusacir:"\u2A23",pluscir:"\u2A22",plusdu:"\u2A25",pluse:"\u2A72",plussim:"\u2A26",plustwo:"\u2A27",pointint:"\u2A15",popf:"\u{1D561}",pound:"\xA3",prE:"\u2AB3",prap:"\u2AB7",precapprox:"\u2AB7",precnapprox:"\u2AB9",prnap:"\u2AB9",precneqq:"\u2AB5",prnE:"\u2AB5",precnsim:"\u22E8",prnsim:"\u22E8",prime:"\u2032",profalar:"\u232E",profline:"\u2312",profsurf:"\u2313",prurel:"\u22B0",pscr:"\u{1D4C5}",psi:"\u03C8",puncsp:"\u2008",qfr:"\u{1D52E}",qopf:"\u{1D562}",qprime:"\u2057",qscr:"\u{1D4C6}",quatint:"\u2A16",quest:"?",rAtail:"\u291C",rHar:"\u2964",race:"\u223D\u0331",racute:"\u0155",raemptyv:"\u29B3",rangd:"\u2992",range:"\u29A5",raquo:"\xBB",rarrap:"\u2975",rarrbfs:"\u2920",rarrc:"\u2933",rarrfs:"\u291E",rarrpl:"\u2945",rarrsim:"\u2974",rarrtl:"\u21A3",rightarrowtail:"\u21A3",rarrw:"\u219D",rightsquigarrow:"\u219D",ratail:"\u291A",ratio:"\u2236",rbbrk:"\u2773",rbrace:"}",rcub:"}",rbrack:"]",rsqb:"]",rbrke:"\u298C",rbrksld:"\u298E",rbrkslu:"\u2990",rcaron:"\u0159",rcedil:"\u0157",rcy:"\u0440",rdca:"\u2937",rdldhar:"\u2969",rdsh:"\u21B3",rect:"\u25AD",rfisht:"\u297D",rfr:"\u{1D52F}",rharul:"\u296C",rho:"\u03C1",rhov:"\u03F1",varrho:"\u03F1",rightrightarrows:"\u21C9",rrarr:"\u21C9",rightthreetimes:"\u22CC",rthree:"\u22CC",ring:"\u02DA",rlm:"\u200F",rmoust:"\u23B1",rmoustache:"\u23B1",rnmid:"\u2AEE",roang:"\u27ED",roarr:"\u21FE",ropar:"\u2986",ropf:"\u{1D563}",roplus:"\u2A2E",rotimes:"\u2A35",rpar:")",rpargt:"\u2994",rppolint:"\u2A12",rsaquo:"\u203A",rscr:"\u{1D4C7}",rtimes:"\u22CA",rtri:"\u25B9",triangleright:"\u25B9",rtriltri:"\u29CE",ruluhar:"\u2968",rx:"\u211E",sacute:"\u015B",scE:"\u2AB4",scap:"\u2AB8",succapprox:"\u2AB8",scaron:"\u0161",scedil:"\u015F",scirc:"\u015D",scnE:"\u2AB6",succneqq:"\u2AB6",scnap:"\u2ABA",succnapprox:"\u2ABA",scnsim:"\u22E9",succnsim:"\u22E9",scpolint:"\u2A13",scy:"\u0441",sdot:"\u22C5",sdote:"\u2A66",seArr:"\u21D8",sect:"\xA7",semi:";",seswar:"\u2929",tosa:"\u2929",sext:"\u2736",sfr:"\u{1D530}",sharp:"\u266F",shchcy:"\u0449",shcy:"\u0448",shy:"\xAD",sigma:"\u03C3",sigmaf:"\u03C2",sigmav:"\u03C2",varsigma:"\u03C2",simdot:"\u2A6A",simg:"\u2A9E",simgE:"\u2AA0",siml:"\u2A9D",simlE:"\u2A9F",simne:"\u2246",simplus:"\u2A24",simrarr:"\u2972",smashp:"\u2A33",smeparsl:"\u29E4",smile:"\u2323",ssmile:"\u2323",smt:"\u2AAA",smte:"\u2AAC",smtes:"\u2AAC\uFE00",softcy:"\u044C",sol:"/",solb:"\u29C4",solbar:"\u233F",sopf:"\u{1D564}",spades:"\u2660",spadesuit:"\u2660",sqcaps:"\u2293\uFE00",sqcups:"\u2294\uFE00",sscr:"\u{1D4C8}",star:"\u2606",sub:"\u2282",subset:"\u2282",subE:"\u2AC5",subseteqq:"\u2AC5",subdot:"\u2ABD",subedot:"\u2AC3",submult:"\u2AC1",subnE:"\u2ACB",subsetneqq:"\u2ACB",subne:"\u228A",subsetneq:"\u228A",subplus:"\u2ABF",subrarr:"\u2979",subsim:"\u2AC7",subsub:"\u2AD5",subsup:"\u2AD3",sung:"\u266A",sup1:"\xB9",sup2:"\xB2",sup3:"\xB3",supE:"\u2AC6",supseteqq:"\u2AC6",supdot:"\u2ABE",supdsub:"\u2AD8",supedot:"\u2AC4",suphsol:"\u27C9",suphsub:"\u2AD7",suplarr:"\u297B",supmult:"\u2AC2",supnE:"\u2ACC",supsetneqq:"\u2ACC",supne:"\u228B",supsetneq:"\u228B",supplus:"\u2AC0",supsim:"\u2AC8",supsub:"\u2AD4",supsup:"\u2AD6",swArr:"\u21D9",swnwar:"\u292A",szlig:"\xDF",target:"\u2316",tau:"\u03C4",tcaron:"\u0165",tcedil:"\u0163",tcy:"\u0442",telrec:"\u2315",tfr:"\u{1D531}",theta:"\u03B8",thetasym:"\u03D1",thetav:"\u03D1",vartheta:"\u03D1",thorn:"\xFE",times:"\xD7",timesbar:"\u2A31",timesd:"\u2A30",topbot:"\u2336",topcir:"\u2AF1",topf:"\u{1D565}",topfork:"\u2ADA",tprime:"\u2034",triangle:"\u25B5",utri:"\u25B5",triangleq:"\u225C",trie:"\u225C",tridot:"\u25EC",triminus:"\u2A3A",triplus:"\u2A39",trisb:"\u29CD",tritime:"\u2A3B",trpezium:"\u23E2",tscr:"\u{1D4C9}",tscy:"\u0446",tshcy:"\u045B",tstrok:"\u0167",uHar:"\u2963",uacute:"\xFA",ubrcy:"\u045E",ubreve:"\u016D",ucirc:"\xFB",ucy:"\u0443",udblac:"\u0171",ufisht:"\u297E",ufr:"\u{1D532}",ugrave:"\xF9",uhblk:"\u2580",ulcorn:"\u231C",ulcorner:"\u231C",ulcrop:"\u230F",ultri:"\u25F8",umacr:"\u016B",uogon:"\u0173",uopf:"\u{1D566}",upsi:"\u03C5",upsilon:"\u03C5",upuparrows:"\u21C8",uuarr:"\u21C8",urcorn:"\u231D",urcorner:"\u231D",urcrop:"\u230E",uring:"\u016F",urtri:"\u25F9",uscr:"\u{1D4CA}",utdot:"\u22F0",utilde:"\u0169",uuml:"\xFC",uwangle:"\u29A7",vBar:"\u2AE8",vBarv:"\u2AE9",vangrt:"\u299C",varsubsetneq:"\u228A\uFE00",vsubne:"\u228A\uFE00",varsubsetneqq:"\u2ACB\uFE00",vsubnE:"\u2ACB\uFE00",varsupsetneq:"\u228B\uFE00",vsupne:"\u228B\uFE00",varsupsetneqq:"\u2ACC\uFE00",vsupnE:"\u2ACC\uFE00",vcy:"\u0432",veebar:"\u22BB",veeeq:"\u225A",vellip:"\u22EE",vfr:"\u{1D533}",vopf:"\u{1D567}",vscr:"\u{1D4CB}",vzigzag:"\u299A",wcirc:"\u0175",wedbar:"\u2A5F",wedgeq:"\u2259",weierp:"\u2118",wp:"\u2118",wfr:"\u{1D534}",wopf:"\u{1D568}",wscr:"\u{1D4CC}",xfr:"\u{1D535}",xi:"\u03BE",xnis:"\u22FB",xopf:"\u{1D569}",xscr:"\u{1D4CD}",yacute:"\xFD",yacy:"\u044F",ycirc:"\u0177",ycy:"\u044B",yen:"\xA5",yfr:"\u{1D536}",yicy:"\u0457",yopf:"\u{1D56A}",yscr:"\u{1D4CE}",yucy:"\u044E",yuml:"\xFF",zacute:"\u017A",zcaron:"\u017E",zcy:"\u0437",zdot:"\u017C",zeta:"\u03B6",zfr:"\u{1D537}",zhcy:"\u0436",zigrarr:"\u21DD",zopf:"\u{1D56B}",zscr:"\u{1D4CF}",zwj:"\u200D",zwnj:"\u200C"},vB="\uE500";tx.ngsp=vB;var Uf=class extends $t{constructor(t,i,r){super(r,t),this.tokenType=i}},v2=class{constructor(t,i,r){this.tokens=t,this.errors=i,this.nonNormalizedIcuExpressions=r}};function MY(e,t,i,r={}){let n=new b2(new Fb(e,t),i,r);return n.tokenize(),new v2(BY(n.tokens),n.errors,n.nonNormalizedIcuExpressions)}var IY=/\r\n?/g;function Nf(e){return`Unexpected character "${e===ca?"EOF":String.fromCharCode(e)}"`}function u3(e){return`Unknown entity "${e}" - use the "&#<decimal>;" or  "&#x<hex>;" syntax`}function kY(e,t){return`Unable to parse entity "${t}" - ${e} character reference entities must end with ";"`}var _2=function(e){return e.HEX="hexadecimal",e.DEC="decimal",e}(_2||{}),Hf=class{constructor(t){this.error=t}},b2=class{constructor(t,i,r){this._getTagDefinition=i,this._currentTokenStart=null,this._currentTokenType=null,this._expansionCaseStack=[],this._inInterpolation=!1,this.tokens=[],this.errors=[],this.nonNormalizedIcuExpressions=[],this._tokenizeIcu=r.tokenizeExpansionForms||!1,this._interpolationConfig=r.interpolationConfig||Fs,this._leadingTriviaCodePoints=r.leadingTriviaChars&&r.leadingTriviaChars.map(a=>a.codePointAt(0)||0);let n=r.range||{endPos:t.content.length,startPos:0,startLine:0,startCol:0};this._cursor=r.escapedString?new x2(t,n):new ix(t,n),this._preserveLineEndings=r.preserveLineEndings||!1,this._i18nNormalizeLineEndingsInICUs=r.i18nNormalizeLineEndingsInICUs||!1,this._tokenizeBlocks=r.tokenizeBlocks??!0;try{this._cursor.init()}catch(a){this.handleError(a)}}_processCarriageReturns(t){return this._preserveLineEndings?t:t.replace(IY,`
`)}tokenize(){for(;this._cursor.peek()!==ca;){let t=this._cursor.clone();try{this._attemptCharCode(em)?this._attemptCharCode(LE)?this._attemptCharCode(lm)?this._consumeCdata(t):this._attemptCharCode(Nb)?this._consumeComment(t):this._consumeDocType(t):this._attemptCharCode(Sl)?this._consumeTagClose(t):this._consumeTagOpen(t):this._tokenizeBlocks&&this._attemptCharCode(PO)?this._consumeBlockStart(t):this._tokenizeBlocks&&!this._inInterpolation&&!this._isInExpansionCase()&&!this._isInExpansionForm()&&this._attemptCharCode(Pa)?this._consumeBlockEnd(t):this._tokenizeIcu&&this._tokenizeExpansionForm()||this._consumeWithInterpolation(5,8,()=>this._isTextEnd(),()=>this._isTagStart())}catch(i){this.handleError(i)}}this._beginToken(29),this._endToken([])}_getBlockName(){let t=!1,i=this._cursor.clone();return this._attemptCharCodeUntilFn(r=>vx(r)?!t:LY(r)?(t=!0,!1):!0),this._cursor.getChars(i).trim()}_consumeBlockStart(t){this._beginToken(24,t);let i=this._endToken([this._getBlockName()]);if(this._cursor.peek()===Ml)if(this._cursor.advance(),this._consumeBlockParameters(),this._attemptCharCodeUntilFn(Vn),this._attemptCharCode(ms))this._attemptCharCodeUntilFn(Vn);else{i.type=28;return}this._attemptCharCode(Os)?(this._beginToken(25),this._endToken([])):i.type=28}_consumeBlockEnd(t){this._beginToken(26,t),this._endToken([])}_consumeBlockParameters(){for(this._attemptCharCodeUntilFn(p3);this._cursor.peek()!==ms&&this._cursor.peek()!==ca;){this._beginToken(27);let t=this._cursor.clone(),i=null,r=0;for(;this._cursor.peek()!==ps&&this._cursor.peek()!==ca||i!==null;){let n=this._cursor.peek();if(n===Pb)this._cursor.advance();else if(n===i)i=null;else if(i===null&&Rb(n))i=n;else if(n===Ml&&i===null)r++;else if(n===ms&&i===null){if(r===0)break;r>0&&r--}this._cursor.advance()}this._endToken([this._cursor.getChars(t)]),this._attemptCharCodeUntilFn(p3)}}_tokenizeExpansionForm(){if(this.isExpansionFormStart())return this._consumeExpansionFormStart(),!0;if(FY(this._cursor.peek())&&this._isInExpansionForm())return this._consumeExpansionCaseStart(),!0;if(this._cursor.peek()===Pa){if(this._isInExpansionCase())return this._consumeExpansionCaseEnd(),!0;if(this._isInExpansionForm())return this._consumeExpansionFormEnd(),!0}return!1}_beginToken(t,i=this._cursor.clone()){this._currentTokenStart=i,this._currentTokenType=t}_endToken(t,i){if(this._currentTokenStart===null)throw new Uf("Programming error - attempted to end a token when there was no start to the token",this._currentTokenType,this._cursor.getSpan(i));if(this._currentTokenType===null)throw new Uf("Programming error - attempted to end a token which has no token type",null,this._cursor.getSpan(this._currentTokenStart));let r={type:this._currentTokenType,parts:t,sourceSpan:(i??this._cursor).getSpan(this._currentTokenStart,this._leadingTriviaCodePoints)};return this.tokens.push(r),this._currentTokenStart=null,this._currentTokenType=null,r}_createError(t,i){this._isInExpansionForm()&&(t+=` (Do you have an unescaped "{" in your template? Use "{{ '{' }}") to escape it.)`);let r=new Uf(t,this._currentTokenType,i);return this._currentTokenStart=null,this._currentTokenType=null,new Hf(r)}handleError(t){if(t instanceof bg&&(t=this._createError(t.msg,this._cursor.getSpan(t.cursor))),t instanceof Hf)this.errors.push(t.error);else throw t}_attemptCharCode(t){return this._cursor.peek()===t?(this._cursor.advance(),!0):!1}_attemptCharCodeCaseInsensitive(t){return OY(this._cursor.peek(),t)?(this._cursor.advance(),!0):!1}_requireCharCode(t){let i=this._cursor.clone();if(!this._attemptCharCode(t))throw this._createError(Nf(this._cursor.peek()),this._cursor.getSpan(i))}_attemptStr(t){let i=t.length;if(this._cursor.charsLeft()<i)return!1;let r=this._cursor.clone();for(let n=0;n<i;n++)if(!this._attemptCharCode(t.charCodeAt(n)))return this._cursor=r,!1;return!0}_attemptStrCaseInsensitive(t){for(let i=0;i<t.length;i++)if(!this._attemptCharCodeCaseInsensitive(t.charCodeAt(i)))return!1;return!0}_requireStr(t){let i=this._cursor.clone();if(!this._attemptStr(t))throw this._createError(Nf(this._cursor.peek()),this._cursor.getSpan(i))}_attemptCharCodeUntilFn(t){for(;!t(this._cursor.peek());)this._cursor.advance()}_requireCharCodeUntilFn(t,i){let r=this._cursor.clone();if(this._attemptCharCodeUntilFn(t),this._cursor.diff(r)<i)throw this._createError(Nf(this._cursor.peek()),this._cursor.getSpan(r))}_attemptUntilChar(t){for(;this._cursor.peek()!==t;)this._cursor.advance()}_readChar(){let t=String.fromCodePoint(this._cursor.peek());return this._cursor.advance(),t}_consumeEntity(t){this._beginToken(9);let i=this._cursor.clone();if(this._cursor.advance(),this._attemptCharCode(FL)){let r=this._attemptCharCode(jL)||this._attemptCharCode(Dq),n=this._cursor.clone();if(this._attemptCharCodeUntilFn(PY),this._cursor.peek()!=ps){this._cursor.advance();let o=r?_2.HEX:_2.DEC;throw this._createError(kY(o,this._cursor.getChars(i)),this._cursor.getSpan())}let a=this._cursor.getChars(n);this._cursor.advance();try{let o=parseInt(a,r?16:10);this._endToken([String.fromCharCode(o),this._cursor.getChars(i)])}catch{throw this._createError(u3(this._cursor.getChars(i)),this._cursor.getSpan())}}else{let r=this._cursor.clone();if(this._attemptCharCodeUntilFn(RY),this._cursor.peek()!=ps)this._beginToken(t,i),this._cursor=r,this._endToken(["&"]);else{let n=this._cursor.getChars(r);this._cursor.advance();let a=tx[n];if(!a)throw this._createError(u3(n),this._cursor.getSpan(i));this._endToken([a,`&${n};`])}}}_consumeRawText(t,i){this._beginToken(t?6:7);let r=[];for(;;){let n=this._cursor.clone(),a=i();if(this._cursor=n,a)break;t&&this._cursor.peek()===kb?(this._endToken([this._processCarriageReturns(r.join(""))]),r.length=0,this._consumeEntity(6),this._beginToken(6)):r.push(this._readChar())}this._endToken([this._processCarriageReturns(r.join(""))])}_consumeComment(t){this._beginToken(10,t),this._requireCharCode(Nb),this._endToken([]),this._consumeRawText(!1,()=>this._attemptStr("-->")),this._beginToken(11),this._requireStr("-->"),this._endToken([])}_consumeCdata(t){this._beginToken(12,t),this._requireStr("CDATA["),this._endToken([]),this._consumeRawText(!1,()=>this._attemptStr("]]>")),this._beginToken(13),this._requireStr("]]>"),this._endToken([])}_consumeDocType(t){this._beginToken(18,t);let i=this._cursor.clone();this._attemptUntilChar(Pc);let r=this._cursor.getChars(i);this._cursor.advance(),this._endToken([r])}_consumePrefixAndName(){let t=this._cursor.clone(),i="";for(;this._cursor.peek()!==Rc&&!NY(this._cursor.peek());)this._cursor.advance();let r;this._cursor.peek()===Rc?(i=this._cursor.getChars(t),this._cursor.advance(),r=this._cursor.clone()):r=t,this._requireCharCodeUntilFn(h3,i===""?0:1);let n=this._cursor.getChars(r);return[i,n]}_consumeTagOpen(t){let i,r,n;try{if(!_x(this._cursor.peek()))throw this._createError(Nf(this._cursor.peek()),this._cursor.getSpan(t));for(n=this._consumeTagOpenStart(t),r=n.parts[0],i=n.parts[1],this._attemptCharCodeUntilFn(Vn);this._cursor.peek()!==Sl&&this._cursor.peek()!==Pc&&this._cursor.peek()!==em&&this._cursor.peek()!==ca;)this._consumeAttributeName(),this._attemptCharCodeUntilFn(Vn),this._attemptCharCode(tm)&&(this._attemptCharCodeUntilFn(Vn),this._consumeAttributeValue()),this._attemptCharCodeUntilFn(Vn);this._consumeTagOpenEnd()}catch(o){if(o instanceof Hf){n?n.type=4:(this._beginToken(5,t),this._endToken(["<"]));return}throw o}let a=this._getTagDefinition(i).getContentType(r);a===Rs.RAW_TEXT?this._consumeRawTextWithTagClose(r,i,!1):a===Rs.ESCAPABLE_RAW_TEXT&&this._consumeRawTextWithTagClose(r,i,!0)}_consumeRawTextWithTagClose(t,i,r){this._consumeRawText(r,()=>!this._attemptCharCode(em)||!this._attemptCharCode(Sl)||(this._attemptCharCodeUntilFn(Vn),!this._attemptStrCaseInsensitive(i))?!1:(this._attemptCharCodeUntilFn(Vn),this._attemptCharCode(Pc))),this._beginToken(3),this._requireCharCodeUntilFn(n=>n===Pc,3),this._cursor.advance(),this._endToken([t,i])}_consumeTagOpenStart(t){this._beginToken(0,t);let i=this._consumePrefixAndName();return this._endToken(i)}_consumeAttributeName(){let t=this._cursor.peek();if(t===og||t===ag)throw this._createError(Nf(t),this._cursor.getSpan());this._beginToken(14);let i=this._consumePrefixAndName();this._endToken(i)}_consumeAttributeValue(){if(this._cursor.peek()===og||this._cursor.peek()===ag){let t=this._cursor.peek();this._consumeQuote(t);let i=()=>this._cursor.peek()===t;this._consumeWithInterpolation(16,17,i,i),this._consumeQuote(t)}else{let t=()=>h3(this._cursor.peek());this._consumeWithInterpolation(16,17,t,t)}}_consumeQuote(t){this._beginToken(15),this._requireCharCode(t),this._endToken([String.fromCodePoint(t)])}_consumeTagOpenEnd(){let t=this._attemptCharCode(Sl)?2:1;this._beginToken(t),this._requireCharCode(Pc),this._endToken([])}_consumeTagClose(t){this._beginToken(3,t),this._attemptCharCodeUntilFn(Vn);let i=this._consumePrefixAndName();this._attemptCharCodeUntilFn(Vn),this._requireCharCode(Pc),this._endToken(i)}_consumeExpansionFormStart(){this._beginToken(19),this._requireCharCode(Os),this._endToken([]),this._expansionCaseStack.push(19),this._beginToken(7);let t=this._readUntil(Uo),i=this._processCarriageReturns(t);if(this._i18nNormalizeLineEndingsInICUs)this._endToken([i]);else{let n=this._endToken([t]);i!==t&&this.nonNormalizedIcuExpressions.push(n)}this._requireCharCode(Uo),this._attemptCharCodeUntilFn(Vn),this._beginToken(7);let r=this._readUntil(Uo);this._endToken([r]),this._requireCharCode(Uo),this._attemptCharCodeUntilFn(Vn)}_consumeExpansionCaseStart(){this._beginToken(20);let t=this._readUntil(Os).trim();this._endToken([t]),this._attemptCharCodeUntilFn(Vn),this._beginToken(21),this._requireCharCode(Os),this._endToken([]),this._attemptCharCodeUntilFn(Vn),this._expansionCaseStack.push(21)}_consumeExpansionCaseEnd(){this._beginToken(22),this._requireCharCode(Pa),this._endToken([]),this._attemptCharCodeUntilFn(Vn),this._expansionCaseStack.pop()}_consumeExpansionFormEnd(){this._beginToken(23),this._requireCharCode(Pa),this._endToken([]),this._expansionCaseStack.pop()}_consumeWithInterpolation(t,i,r,n){this._beginToken(t);let a=[];for(;!r();){let o=this._cursor.clone();this._interpolationConfig&&this._attemptStr(this._interpolationConfig.start)?(this._endToken([this._processCarriageReturns(a.join(""))],o),a.length=0,this._consumeInterpolation(i,o,n),this._beginToken(t)):this._cursor.peek()===kb?(this._endToken([this._processCarriageReturns(a.join(""))]),a.length=0,this._consumeEntity(t),this._beginToken(t)):a.push(this._readChar())}this._inInterpolation=!1,this._endToken([this._processCarriageReturns(a.join(""))])}_consumeInterpolation(t,i,r){let n=[];this._beginToken(t,i),n.push(this._interpolationConfig.start);let a=this._cursor.clone(),o=null,s=!1;for(;this._cursor.peek()!==ca&&(r===null||!r());){let l=this._cursor.clone();if(this._isTagStart()){this._cursor=l,n.push(this._getProcessedChars(a,l)),this._endToken(n);return}if(o===null)if(this._attemptStr(this._interpolationConfig.end)){n.push(this._getProcessedChars(a,l)),n.push(this._interpolationConfig.end),this._endToken(n);return}else this._attemptStr("//")&&(s=!0);let c=this._cursor.peek();this._cursor.advance(),c===Pb?this._cursor.advance():c===o?o=null:!s&&o===null&&Rb(c)&&(o=c)}n.push(this._getProcessedChars(a,this._cursor)),this._endToken(n)}_getProcessedChars(t,i){return this._processCarriageReturns(i.getChars(t))}_isTextEnd(){return!!(this._isTagStart()||this._cursor.peek()===ca||this._tokenizeIcu&&!this._inInterpolation&&(this.isExpansionFormStart()||this._cursor.peek()===Pa&&this._isInExpansionCase())||this._tokenizeBlocks&&!this._inInterpolation&&!this._isInExpansion()&&(this._cursor.peek()===PO||this._cursor.peek()===Pa))}_isTagStart(){if(this._cursor.peek()===em){let t=this._cursor.clone();t.advance();let i=t.peek();if(_u<=i&&i<=Ig||Im<=i&&i<=fx||i===Sl||i===LE)return!0}return!1}_readUntil(t){let i=this._cursor.clone();return this._attemptUntilChar(t),this._cursor.getChars(i)}_isInExpansion(){return this._isInExpansionCase()||this._isInExpansionForm()}_isInExpansionCase(){return this._expansionCaseStack.length>0&&this._expansionCaseStack[this._expansionCaseStack.length-1]===21}_isInExpansionForm(){return this._expansionCaseStack.length>0&&this._expansionCaseStack[this._expansionCaseStack.length-1]===19}isExpansionFormStart(){if(this._cursor.peek()!==Os)return!1;if(this._interpolationConfig){let t=this._cursor.clone(),i=this._attemptStr(this._interpolationConfig.start);return this._cursor=t,!i}return!0}};function Vn(e){return!vx(e)||e===ca}function h3(e){return vx(e)||e===Pc||e===em||e===Sl||e===og||e===ag||e===tm||e===ca}function NY(e){return(e<_u||Ig<e)&&(e<Im||fx<e)&&(e<dS||e>BL)}function PY(e){return e===ps||e===ca||!Pq(e)}function RY(e){return e===ps||e===ca||!_x(e)}function FY(e){return e!==Pa}function OY(e,t){return m3(e)===m3(t)}function m3(e){return e>=_u&&e<=Ig?e-_u+Im:e}function LY(e){return _x(e)||Cl(e)||e===gx}function p3(e){return e!==ps&&Vn(e)}function BY(e){let t=[],i;for(let r=0;r<e.length;r++){let n=e[r];i&&i.type===5&&n.type===5||i&&i.type===16&&n.type===16?(i.parts[0]+=n.parts[0],i.sourceSpan.end=n.sourceSpan.end):(i=n,t.push(i))}return t}var ix=class e{constructor(t,i){if(t instanceof e){this.file=t.file,this.input=t.input,this.end=t.end;let r=t.state;this.state={peek:r.peek,offset:r.offset,line:r.line,column:r.column}}else{if(!i)throw new Error("Programming error: the range argument must be provided with a file argument.");this.file=t,this.input=t.content,this.end=i.endPos,this.state={peek:-1,offset:i.startPos,line:i.startLine,column:i.startCol}}}clone(){return new e(this)}peek(){return this.state.peek}charsLeft(){return this.end-this.state.offset}diff(t){return this.state.offset-t.state.offset}advance(){this.advanceState(this.state)}init(){this.updatePeek(this.state)}getSpan(t,i){t=t||this;let r=t;if(i)for(;this.diff(t)>0&&i.indexOf(t.peek())!==-1;)r===t&&(t=t.clone()),t.advance();let n=this.locationFromCursor(t),a=this.locationFromCursor(this),o=r!==t?this.locationFromCursor(r):n;return new Qt(n,a,o)}getChars(t){return this.input.substring(t.state.offset,this.state.offset)}charAt(t){return this.input.charCodeAt(t)}advanceState(t){if(t.offset>=this.end)throw this.state=t,new bg('Unexpected character "EOF"',this);let i=this.charAt(t.offset);i===ou?(t.line++,t.column=0):qL(i)||t.column++,t.offset++,this.updatePeek(t)}updatePeek(t){t.peek=t.offset>=this.end?ca:this.charAt(t.offset)}locationFromCursor(t){return new sg(t.file,t.state.offset,t.state.line,t.state.column)}},x2=class e extends ix{constructor(t,i){t instanceof e?(super(t),this.internalState=Z({},t.internalState)):(super(t,i),this.internalState=this.state)}advance(){this.state=this.internalState,super.advance(),this.processEscapeSequence()}init(){super.init(),this.processEscapeSequence()}clone(){return new e(this)}getChars(t){let i=t.clone(),r="";for(;i.internalState.offset<this.internalState.offset;)r+=String.fromCodePoint(i.peek()),i.advance();return r}processEscapeSequence(){let t=()=>this.internalState.peek;if(t()===Pb)if(this.internalState=Z({},this.state),this.advanceState(this.internalState),t()===VL)this.state.peek=ou;else if(t()===zL)this.state.peek=cS;else if(t()===GL)this.state.peek=NL;else if(t()===UL)this.state.peek=lS;else if(t()===Iq)this.state.peek=wq;else if(t()===uS)this.state.peek=PL;else if(t()===HL)if(this.advanceState(this.internalState),t()===Os){this.advanceState(this.internalState);let i=this.clone(),r=0;for(;t()!==Pa;)this.advanceState(this.internalState),r++;this.state.peek=this.decodeHexDigits(i,r)}else{let i=this.clone();this.advanceState(this.internalState),this.advanceState(this.internalState),this.advanceState(this.internalState),this.state.peek=this.decodeHexDigits(i,4)}else if(t()===jL){this.advanceState(this.internalState);let i=this.clone();this.advanceState(this.internalState),this.state.peek=this.decodeHexDigits(i,2)}else if(RO(t())){let i="",r=0,n=this.clone();for(;RO(t())&&r<3;)n=this.clone(),i+=String.fromCodePoint(t()),this.advanceState(this.internalState),r++;this.state.peek=parseInt(i,8),this.internalState=n.internalState}else qL(this.internalState.peek)?(this.advanceState(this.internalState),this.state=this.internalState):this.state.peek=this.internalState.peek}decodeHexDigits(t,i){let r=this.input.slice(t.internalState.offset,t.internalState.offset+i),n=parseInt(r,16);if(isNaN(n))throw t.state=t.internalState,new bg("Invalid hexadecimal escape sequence",t);return n}},bg=class{constructor(t,i){this.msg=t,this.cursor=i}},ka=class e extends $t{static create(t,i,r){return new e(t,i,r)}constructor(t,i,r){super(i,r),this.elementName=t}},rx=class{constructor(t,i){this.rootNodes=t,this.errors=i}},y2=class{constructor(t){this.getTagDefinition=t}parse(t,i,r){let n=MY(t,i,this.getTagDefinition,r),a=new w2(n.tokens,this.getTagDefinition);return a.build(),new rx(a.rootNodes,n.errors.concat(a.errors))}},w2=class e{constructor(t,i){this.tokens=t,this.getTagDefinition=i,this._index=-1,this._containerStack=[],this.rootNodes=[],this.errors=[],this._advance()}build(){for(;this._peek.type!==29;)this._peek.type===0||this._peek.type===4?this._consumeStartTag(this._advance()):this._peek.type===3?this._consumeEndTag(this._advance()):this._peek.type===12?(this._closeVoidElement(),this._consumeCdata(this._advance())):this._peek.type===10?(this._closeVoidElement(),this._consumeComment(this._advance())):this._peek.type===5||this._peek.type===7||this._peek.type===6?(this._closeVoidElement(),this._consumeText(this._advance())):this._peek.type===19?this._consumeExpansion(this._advance()):this._peek.type===24?(this._closeVoidElement(),this._consumeBlockOpen(this._advance())):this._peek.type===26?(this._closeVoidElement(),this._consumeBlockClose(this._advance())):this._peek.type===28?(this._closeVoidElement(),this._consumeIncompleteBlock(this._advance())):this._advance();for(let t of this._containerStack)t instanceof Vo&&this.errors.push(ka.create(t.name,t.sourceSpan,`Unclosed block "${t.name}"`))}_advance(){let t=this._peek;return this._index<this.tokens.length-1&&this._index++,this._peek=this.tokens[this._index],t}_advanceIf(t){return this._peek.type===t?this._advance():null}_consumeCdata(t){this._consumeText(this._advance()),this._advanceIf(13)}_consumeComment(t){let i=this._advanceIf(7),r=this._advanceIf(11),n=i!=null?i.parts[0].trim():null,a=r==null?t.sourceSpan:new Qt(t.sourceSpan.start,r.sourceSpan.end,t.sourceSpan.fullStart);this._addToParent(new _g(n,a))}_consumeExpansion(t){let i=this._advance(),r=this._advance(),n=[];for(;this._peek.type===20;){let o=this._parseExpansionCase();if(!o)return;n.push(o)}if(this._peek.type!==23){this.errors.push(ka.create(null,this._peek.sourceSpan,"Invalid ICU message. Missing '}'."));return}let a=new Qt(t.sourceSpan.start,this._peek.sourceSpan.end,t.sourceSpan.fullStart);this._addToParent(new Tm(i.parts[0],r.parts[0],n,a,i.sourceSpan)),this._advance()}_parseExpansionCase(){let t=this._advance();if(this._peek.type!==21)return this.errors.push(ka.create(null,this._peek.sourceSpan,"Invalid ICU message. Missing '{'.")),null;let i=this._advance(),r=this._collectExpansionExpTokens(i);if(!r)return null;let n=this._advance();r.push({type:29,parts:[],sourceSpan:n.sourceSpan});let a=new e(r,this.getTagDefinition);if(a.build(),a.errors.length>0)return this.errors=this.errors.concat(a.errors),null;let o=new Qt(t.sourceSpan.start,n.sourceSpan.end,t.sourceSpan.fullStart),s=new Qt(i.sourceSpan.start,n.sourceSpan.end,i.sourceSpan.fullStart);return new u2(t.parts[0],a.rootNodes,o,t.sourceSpan,s)}_collectExpansionExpTokens(t){let i=[],r=[21];for(;;){if((this._peek.type===19||this._peek.type===21)&&r.push(this._peek.type),this._peek.type===22)if(f3(r,21)){if(r.pop(),r.length===0)return i}else return this.errors.push(ka.create(null,t.sourceSpan,"Invalid ICU message. Missing '}'.")),null;if(this._peek.type===23)if(f3(r,19))r.pop();else return this.errors.push(ka.create(null,t.sourceSpan,"Invalid ICU message. Missing '}'.")),null;if(this._peek.type===29)return this.errors.push(ka.create(null,t.sourceSpan,"Invalid ICU message. Missing '}'.")),null;i.push(this._advance())}}_consumeText(t){let i=[t],r=t.sourceSpan,n=t.parts[0];if(n.length>0&&n[0]===`
`){let a=this._getContainer();a!=null&&a.children.length===0&&this.getTagDefinition(a.name).ignoreFirstLf&&(n=n.substring(1),i[0]={type:t.type,sourceSpan:t.sourceSpan,parts:[n]})}for(;this._peek.type===8||this._peek.type===5||this._peek.type===9;)t=this._advance(),i.push(t),t.type===8?n+=t.parts.join("").replace(/&([^;]+);/g,g3):t.type===9?n+=t.parts[0]:n+=t.parts.join("");if(n.length>0){let a=t.sourceSpan;this._addToParent(new Xc(n,new Qt(r.start,a.end,r.fullStart,r.details),i))}}_closeVoidElement(){let t=this._getContainer();t instanceof Bo&&this.getTagDefinition(t.name).isVoid&&this._containerStack.pop()}_consumeStartTag(t){let[i,r]=t.parts,n=[];for(;this._peek.type===14;)n.push(this._consumeAttr(this._advance()));let a=this._getElementFullName(i,r,this._getClosestParentElement()),o=!1;if(this._peek.type===2){this._advance(),o=!0;let h=this.getTagDefinition(a);h.canSelfClose||TE(a)!==null||h.isVoid||this.errors.push(ka.create(a,t.sourceSpan,`Only void, custom and foreign elements can be self closed "${t.parts[1]}"`))}else this._peek.type===1&&(this._advance(),o=!1);let s=this._peek.sourceSpan.fullStart,l=new Qt(t.sourceSpan.start,s,t.sourceSpan.fullStart),c=new Qt(t.sourceSpan.start,s,t.sourceSpan.fullStart),d=new Bo(a,n,[],l,c,void 0),u=this._getContainer();this._pushContainer(d,u instanceof Bo&&this.getTagDefinition(u.name).isClosedByChild(d.name)),o?this._popContainer(a,Bo,l):t.type===4&&(this._popContainer(a,Bo,null),this.errors.push(ka.create(a,l,`Opening tag "${a}" not terminated.`)))}_pushContainer(t,i){i&&this._containerStack.pop(),this._addToParent(t),this._containerStack.push(t)}_consumeEndTag(t){let i=this._getElementFullName(t.parts[0],t.parts[1],this._getClosestParentElement());if(this.getTagDefinition(i).isVoid)this.errors.push(ka.create(i,t.sourceSpan,`Void elements do not have end tags "${t.parts[1]}"`));else if(!this._popContainer(i,Bo,t.sourceSpan)){let r=`Unexpected closing tag "${i}". It may happen when the tag has already been closed by another tag. For more info see https://www.w3.org/TR/html5/syntax.html#closing-elements-that-have-implied-end-tags`;this.errors.push(ka.create(i,t.sourceSpan,r))}}_popContainer(t,i,r){let n=!1;for(let a=this._containerStack.length-1;a>=0;a--){let o=this._containerStack[a];if((o.name===t||t===null)&&o instanceof i)return o.endSourceSpan=r,o.sourceSpan.end=r!==null?r.end:o.sourceSpan.end,this._containerStack.splice(a,this._containerStack.length-a),!n;(o instanceof Vo||o instanceof Bo&&!this.getTagDefinition(o.name).closedByParent)&&(n=!0)}return!1}_consumeAttr(t){let i=DE(t.parts[0],t.parts[1]),r=t.sourceSpan.end;this._peek.type===15&&this._advance();let n="",a=[],o,s;if(this._peek.type===16)for(o=this._peek.sourceSpan,s=this._peek.sourceSpan.end;this._peek.type===16||this._peek.type===17||this._peek.type===9;){let d=this._advance();a.push(d),d.type===17?n+=d.parts.join("").replace(/&([^;]+);/g,g3):d.type===9?n+=d.parts[0]:n+=d.parts.join(""),s=r=d.sourceSpan.end}this._peek.type===15&&(r=this._advance().sourceSpan.end);let c=o&&s&&new Qt(o.start,s,o.fullStart);return new h2(i,n,new Qt(t.sourceSpan.start,r,t.sourceSpan.fullStart),t.sourceSpan,c,a.length>0?a:void 0,void 0)}_consumeBlockOpen(t){let i=[];for(;this._peek.type===27;){let s=this._advance();i.push(new ex(s.parts[0],s.sourceSpan))}this._peek.type===25&&this._advance();let r=this._peek.sourceSpan.fullStart,n=new Qt(t.sourceSpan.start,r,t.sourceSpan.fullStart),a=new Qt(t.sourceSpan.start,r,t.sourceSpan.fullStart),o=new Vo(t.parts[0],i,[],n,t.sourceSpan,a);this._pushContainer(o,!1)}_consumeBlockClose(t){this._popContainer(null,Vo,t.sourceSpan)||this.errors.push(ka.create(null,t.sourceSpan,'Unexpected closing block. The block may have been closed earlier. If you meant to write the } character, you should use the "&#125;" HTML entity instead.'))}_consumeIncompleteBlock(t){let i=[];for(;this._peek.type===27;){let s=this._advance();i.push(new ex(s.parts[0],s.sourceSpan))}let r=this._peek.sourceSpan.fullStart,n=new Qt(t.sourceSpan.start,r,t.sourceSpan.fullStart),a=new Qt(t.sourceSpan.start,r,t.sourceSpan.fullStart),o=new Vo(t.parts[0],i,[],n,t.sourceSpan,a);this._pushContainer(o,!1),this._popContainer(null,Vo,null),this.errors.push(ka.create(t.parts[0],n,`Incomplete block "${t.parts[0]}". If you meant to write the @ character, you should use the "&#64;" HTML entity instead.`))}_getContainer(){return this._containerStack.length>0?this._containerStack[this._containerStack.length-1]:null}_getClosestParentElement(){for(let t=this._containerStack.length-1;t>-1;t--)if(this._containerStack[t]instanceof Bo)return this._containerStack[t];return null}_addToParent(t){let i=this._getContainer();i===null?this.rootNodes.push(t):i.children.push(t)}_getElementFullName(t,i,r){if(t===""&&(t=this.getTagDefinition(i).implicitNamespacePrefix||"",t===""&&r!=null)){let n=ua(r.name)[1];this.getTagDefinition(n).preventNamespaceInheritance||(t=TE(r.name))}return DE(t,i)}};function f3(e,t){return e.length>0&&e[e.length-1]===t}function g3(e,t){return tx[t]!==void 0?tx[t]||e:/^#x[a-f0-9]+$/i.test(t)?String.fromCodePoint(parseInt(t.slice(2),16)):/^#\d+$/.test(t)?String.fromCodePoint(parseInt(t.slice(1),10)):e}var v3=new Set(["iframe|srcdoc","*|innerhtml","*|outerhtml","embed|src","object|codebase","object|data"]);function _B(e,t){return e=e.toLowerCase(),t=t.toLowerCase(),v3.has(e+"|"+t)||v3.has("*|"+t)}var VY=(e,t)=>(e instanceof $c&&(t instanceof gm&&e.i18n instanceof jn&&(t.previousMessage=e.i18n),e.i18n=t),t),nx=class{constructor(t=Fs,i=!1,r=!1,n=yq){this.interpolationConfig=t,this.keepI18nAttrs=i,this.enableI18nLegacyMessageIdFormat=r,this.containerBlocks=n,this.hasI18nMeta=!1,this._errors=[]}_generateI18nMessage(t,i="",r){let{meaning:n,description:a,customId:o}=this._parseMetadata(i),l=wY(this.interpolationConfig,this.containerBlocks)(t,n,a,o,r);return this._setMessageId(l,i),this._setLegacyIds(l,i),l}visitAllWithErrors(t){let i=t.map(r=>r.visit(this,null));return new rx(i,this._errors)}visitElement(t){let i;if(sq(t)){this.hasI18nMeta=!0;let r=[],n={};for(let a of t.attrs)if(a.name===AL){let o=t.i18n||a.value;i=this._generateI18nMessage(t.children,o,VY),i.nodes.length===0&&(i=void 0),t.i18n=i}else if(a.name.startsWith(FE)){let o=a.name.slice(FE.length);_B(t.name,o)?this._reportError(a,`Translating attribute '${o}' is disallowed for security reasons.`):n[o]=a.value}else r.push(a);if(Object.keys(n).length)for(let a of r){let o=n[a.name];o!==void 0&&a.value&&(a.i18n=this._generateI18nMessage([a],a.i18n||o))}this.keepI18nAttrs||(t.attrs=r)}return Ar(this,t.children,i),t}visitExpansion(t,i){let r,n=t.i18n;if(this.hasI18nMeta=!0,n instanceof gm){let a=n.name;r=this._generateI18nMessage([t],n);let o=oS(r);o.name=a,i!==null&&(i.placeholderToMessage[a]=r)}else r=this._generateI18nMessage([t],i||n);return t.i18n=r,t}visitText(t){return t}visitAttribute(t){return t}visitComment(t){return t}visitExpansionCase(t){return t}visitBlock(t,i){return Ar(this,t.children,i),t}visitBlockParameter(t,i){return t}_parseMetadata(t){return typeof t=="string"?HY(t):t instanceof jn?t:{}}_setMessageId(t,i){t.id||(t.id=i instanceof jn&&i.id||lW(t))}_setLegacyIds(t,i){if(this.enableI18nLegacyMessageIdFormat)t.legacyIds=[sW(t),fL(t)];else if(typeof i!="string"){let r=i instanceof jn?i:i instanceof gm?i.previousMessage:void 0;t.legacyIds=r?r.legacyIds:[]}}_reportError(t,i){this._errors.push(new g2(t.sourceSpan,i))}},zY="|",UY="@@";function HY(e=""){let t,i,r;if(e=e.trim(),e){let n=e.indexOf(UY),a=e.indexOf(zY),o;[o,t]=n>-1?[e.slice(0,n),e.slice(n+2)]:[e,""],[i,r]=a>-1?[o.slice(0,a),o.slice(a+1)]:["",o]}return{customId:t,meaning:i,description:r}}function GY(e){let t=[];return e.description?t.push({tagName:"desc",text:e.description}):t.push({tagName:"suppress",text:"{msgDescriptions}"}),e.meaning&&t.push({tagName:"meaning",text:e.meaning}),wW(t)}var jY="goog.getMsg";function bB(e,t,i,r){let n=qY(t),a=[L(n)];Object.keys(r).length&&(a.push(gg(Tg(r,!0),!0)),a.push(gg({original_code:xn(Object.keys(r).map(l=>({key:Dg(l),quoted:!0,value:t.placeholders[l]?L(t.placeholders[l].sourceSpan.toString()):L(t.placeholderToMessage[l].nodes.map(c=>c.sourceSpan.toString()).join(""))})))})));let o=i.set(et(jY).callFn(a)).toConstDecl();o.addLeadingComment(GY(t));let s=new bn(e.set(i));return[o,s]}var C2=class{formatPh(t){return`{$${Dg(t)}}`}visitText(t){return t.value}visitContainer(t){return t.children.map(i=>i.visit(this)).join("")}visitIcu(t){return pB(t)}visitTagPlaceholder(t){return t.isVoid?this.formatPh(t.startName):`${this.formatPh(t.startName)}${t.children.map(i=>i.visit(this)).join("")}${this.formatPh(t.closeName)}`}visitPlaceholder(t){return this.formatPh(t.name)}visitBlockPlaceholder(t){return`${this.formatPh(t.startName)}${t.children.map(i=>i.visit(this)).join("")}${this.formatPh(t.closeName)}`}visitIcuPlaceholder(t,i){return this.formatPh(t.name)}},WY=new C2;function qY(e){return e.nodes.map(t=>t.visit(WY,null)).join("")}function xB(e,t,i){let{messageParts:r,placeHolders:n}=$Y(t),a=XY(t),o=n.map(c=>i[c.text]),s=CW(t,r,n,o,a),l=e.set(s);return[new bn(l)]}var E2=class{constructor(t,i){this.placeholderToMessage=t,this.pieces=i}visitText(t){if(this.pieces[this.pieces.length-1]instanceof nu)this.pieces[this.pieces.length-1].text+=t.value;else{let i=new Qt(t.sourceSpan.fullStart,t.sourceSpan.end,t.sourceSpan.fullStart,t.sourceSpan.details);this.pieces.push(new nu(t.value,i))}}visitContainer(t){t.children.forEach(i=>i.visit(this))}visitIcu(t){this.pieces.push(new nu(pB(t),t.sourceSpan))}visitTagPlaceholder(t){this.pieces.push(this.createPlaceholderPiece(t.startName,t.startSourceSpan??t.sourceSpan)),t.isVoid||(t.children.forEach(i=>i.visit(this)),this.pieces.push(this.createPlaceholderPiece(t.closeName,t.endSourceSpan??t.sourceSpan)))}visitPlaceholder(t){this.pieces.push(this.createPlaceholderPiece(t.name,t.sourceSpan))}visitBlockPlaceholder(t){this.pieces.push(this.createPlaceholderPiece(t.startName,t.startSourceSpan??t.sourceSpan)),t.children.forEach(i=>i.visit(this)),this.pieces.push(this.createPlaceholderPiece(t.closeName,t.endSourceSpan??t.sourceSpan))}visitIcuPlaceholder(t){this.pieces.push(this.createPlaceholderPiece(t.name,t.sourceSpan,this.placeholderToMessage[t.name]))}createPlaceholderPiece(t,i,r){return new om(Dg(t,!1),i,r)}};function $Y(e){let t=[],i=new E2(e.placeholderToMessage,t);return e.nodes.forEach(r=>r.visit(i)),YY(t)}function XY(e){let t=e.nodes[0],i=e.nodes[e.nodes.length-1];return new Qt(t.sourceSpan.fullStart,i.sourceSpan.end,t.sourceSpan.fullStart,t.sourceSpan.details)}function YY(e){let t=[],i=[];e[0]instanceof om&&t.push(JC(e[0].sourceSpan.start));for(let r=0;r<e.length;r++){let n=e[r];n instanceof nu?t.push(n):(i.push(n),e[r-1]instanceof om&&t.push(JC(e[r-1].sourceSpan.end)))}return e[e.length-1]instanceof om&&t.push(JC(e[e.length-1].sourceSpan.end)),{messageParts:t,placeHolders:i}}function JC(e){return new nu("",new Qt(e,e))}var _3="ngI18nClosureMode",ZY="i18n_",KY="I18N_EXP_",b3="\uFFFD";function QY(e){let t=e.relativeContextFilePath.replace(/[^A-Za-z0-9]/g,"_").toUpperCase()+"_",i=new Map,r=new Map,n=new Map,a=new Map;for(let l of e.units)for(let c of l.ops())if(c.kind===I.ExtractedAttribute&&c.i18nContext!==null){let d=i.get(c.i18nContext)??[];d.push(c),i.set(c.i18nContext,d)}else if(c.kind===I.I18nAttributes)r.set(c.target,c);else if(c.kind===I.I18nExpression&&c.usage===km.I18nAttribute){let d=n.get(c.target)??[];d.push(c),n.set(c.target,d)}else c.kind===I.I18nMessage&&a.set(c.xref,c);let o=new Map,s=new Map;for(let l of e.units)for(let c of l.create)if(c.kind===I.I18nMessage){if(c.messagePlaceholder===null){let{mainVar:d,statements:u}=yB(e,t,a,c);if(c.i18nBlock!==null){let h=e.addConst(d,u);s.set(c.i18nBlock,h)}else{e.constsInitializers.push(...u),o.set(c.i18nContext,d);let h=i.get(c.i18nContext);if(h!==void 0)for(let m of h)m.expression=d.clone()}}ve.remove(c)}for(let l of e.units)for(let c of l.create)if(Wc(c)){let d=r.get(c.xref);if(d===void 0)continue;let u=n.get(c.xref);if(u===void 0)throw new Error("AssertionError: Could not find any i18n expressions associated with an I18nAttributes instruction");let h=new Set;u=u.filter(f=>{let p=h.has(f.name);return h.add(f.name),!p});let m=u.flatMap(f=>{let p=o.get(f.context);if(p===void 0)throw new Error("AssertionError: Could not find i18n expression's value");return[L(f.name),p]});d.i18nAttributesConfig=e.addConst(new Go(m))}for(let l of e.units)for(let c of l.create)if(c.kind===I.I18nStart){let d=s.get(c.root);if(d===void 0)throw new Error("AssertionError: Could not find corresponding i18n block index for an i18n message op; was an i18n message incorrectly assumed to correspond to an attribute?");c.messageIndex=d}}function yB(e,t,i,r){let n=[],a=new Map;for(let c of r.subMessages){let d=i.get(c),{mainVar:u,statements:h}=yB(e,t,i,d);n.push(...h);let m=a.get(d.messagePlaceholder)??[];m.push(u),a.set(d.messagePlaceholder,m)}JY(r,a),r.params=new Map([...r.params.entries()].sort());let o=et(e.pool.uniqueName(ZY)),s=iZ(e.pool,r.message.id,t,e.i18nUseExternalIds),l;if(r.needsPostprocessing||r.postprocessingParams.size>0){let c=Object.fromEntries([...r.postprocessingParams.entries()].sort()),d=Tg(c,!1),u=[];r.postprocessingParams.size>0&&u.push(gg(d,!0)),l=h=>Le(E.i18nPostprocess).callFn([h,...u])}return n.push(...eZ(r.message,o,s,r.params,l)),{mainVar:o,statements:n}}function JY(e,t){for(let[i,r]of t)r.length===1?e.params.set(i,r[0]):(e.params.set(i,L(`${b3}${KY}${i}${b3}`)),e.postprocessingParams.set(i,zt(r)))}function eZ(e,t,i,r,n){let a=Object.fromEntries(r),o=[ML(t),Ag(tZ(),bB(t,e,i,a),xB(t,e,Tg(a,!1)))];return n&&o.push(new bn(t.set(n(t)))),o}function tZ(){return Sg(et(_3)).notIdentical(L("undefined",nS)).and(et(_3))}function iZ(e,t,i,r){let n,a=i;if(r){let o=Db("EXTERNAL_"),s=e.uniqueName(a);n=`${o}${Vs(t)}$$${s}`}else{let o=Db(a);n=e.uniqueName(o)}return et(n)}function rZ(e){for(let t of e.units){let i=null,r=null,n=new Map,a=new Map,o=new Map;for(let s of t.create)switch(s.kind){case I.I18nStart:if(s.context===null)throw Error("I18n op should have its context set.");i=s;break;case I.I18nEnd:i=null;break;case I.IcuStart:if(s.context===null)throw Error("Icu op should have its context set.");r=s;break;case I.IcuEnd:r=null;break;case I.Text:if(i!==null)if(n.set(s.xref,i),a.set(s.xref,r),s.icuPlaceholder!==null){let l=Q$(e.allocateXrefId(),s.icuPlaceholder,[s.initialValue]);ve.replace(s,l),o.set(s.xref,l)}else ve.remove(s);break}for(let s of t.update)switch(s.kind){case I.InterpolateText:if(!n.has(s.target))continue;let l=n.get(s.target),c=a.get(s.target),d=o.get(s.target),u=c?c.context:l.context,h=c?hg.Postproccessing:hg.Creation,m=[];for(let f=0;f<s.interpolation.expressions.length;f++){let p=s.interpolation.expressions[f];m.push(aB(u,l.xref,l.xref,l.handle,p,d?.xref??null,s.interpolation.i18nPlaceholders[f]??null,h,km.I18nText,"",p.sourceSpan??s.sourceSpan))}ve.replaceWithMany(s,m),d!==void 0&&(d.strings=s.interpolation.strings);break}}}function nZ(e){for(let t of e.units)for(let i of t.create)switch(i.kind){case I.ElementStart:case I.Template:if(!Array.isArray(i.localRefs))throw new Error("AssertionError: expected localRefs to be an array still");if(i.numSlotsUsed+=i.localRefs.length,i.localRefs.length>0){let r=aZ(i.localRefs);i.localRefs=e.addConst(r)}else i.localRefs=null;break}}function aZ(e){let t=[];for(let i of e)t.push(L(i.name),L(i.target));return zt(t)}function oZ(e){for(let t of e.units){let i=Gn.HTML;for(let r of t.create)r.kind===I.ElementStart&&r.namespace!==i&&(ve.insertBefore(W$(r.namespace),r),i=r.namespace)}}function wB(e){let t=[],i=0,r=0,n=0,a=0,o=0,s=null;for(;i<e.length;)switch(e.charCodeAt(i++)){case 40:r++;break;case 41:r--;break;case 39:n===0?n=39:n===39&&e.charCodeAt(i-1)!==92&&(n=0);break;case 34:n===0?n=34:n===34&&e.charCodeAt(i-1)!==92&&(n=0);break;case 58:!s&&r===0&&n===0&&(s=bS(e.substring(o,i-1).trim()),a=i);break;case 59:if(s&&a>0&&r===0&&n===0){let c=e.substring(a,i-1).trim();t.push(s,c),o=i,a=0,s=null}break}if(s&&a){let l=e.slice(a).trim();t.push(s,l)}return t}function bS(e){return e.replace(/[a-z][A-Z]/g,t=>t.charAt(0)+"-"+t.charAt(1)).toLowerCase()}function sZ(e){rb(e.root,e.componentName,{index:0},e.compatibility===uo.TemplateDefinitionBuilder)}function rb(e,t,i,r){e.fnName===null&&(e.fnName=e.job.pool.uniqueName(Vs(`${t}_${e.job.fnSuffix}`),!1));let n=new Map;for(let a of e.ops())switch(a.kind){case I.Property:case I.HostProperty:a.isAnimationTrigger&&(a.name="@"+a.name);break;case I.Listener:if(a.handlerFnName!==null)break;if(!a.hostListener&&a.targetSlot.slot===null)throw new Error("Expected a slot to be assigned");let o="";a.isAnimationListener&&(a.name=`@${a.name}.${a.animationPhase}`,o="animation"),a.hostListener?a.handlerFnName=`${t}_${o}${a.name}_HostBindingHandler`:a.handlerFnName=`${e.fnName}_${a.tag.replace("-","_")}_${o}${a.name}_${a.targetSlot.slot}_listener`,a.handlerFnName=Vs(a.handlerFnName);break;case I.TwoWayListener:if(a.handlerFnName!==null)break;if(a.targetSlot.slot===null)throw new Error("Expected a slot to be assigned");a.handlerFnName=Vs(`${e.fnName}_${a.tag.replace("-","_")}_${a.name}_${a.targetSlot.slot}_listener`);break;case I.Variable:n.set(a.xref,lZ(e,a.variable,i));break;case I.RepeaterCreate:if(!(e instanceof qc))throw new Error("AssertionError: must be compiling a component");if(a.handle.slot===null)throw new Error("Expected slot to be assigned");if(a.emptyView!==null){let c=e.job.views.get(a.emptyView);rb(c,`${t}_${a.functionNameSuffix}Empty_${a.handle.slot+2}`,i,r)}rb(e.job.views.get(a.xref),`${t}_${a.functionNameSuffix}_${a.handle.slot+1}`,i,r);break;case I.Template:if(!(e instanceof qc))throw new Error("AssertionError: must be compiling a component");let s=e.job.views.get(a.xref);if(a.handle.slot===null)throw new Error("Expected slot to be assigned");let l=a.functionNameSuffix.length===0?"":`_${a.functionNameSuffix}`;rb(s,`${t}${l}_${a.handle.slot}`,i,r);break;case I.StyleProp:a.name=cZ(a.name),r&&(a.name=x3(a.name));break;case I.ClassProp:r&&(a.name=x3(a.name));break}for(let a of e.ops())Ba(a,o=>{if(!(!(o instanceof Bl)||o.name!==null)){if(!n.has(o.xref))throw new Error(`Variable ${o.xref} not yet named`);o.name=n.get(o.xref)}})}function lZ(e,t,i){if(t.name===null)switch(t.kind){case gn.Context:t.name=`ctx_r${i.index++}`;break;case gn.Identifier:if(e.job.compatibility===uo.TemplateDefinitionBuilder){let r=t.identifier==="ctx"?"i":"";t.name=`${t.identifier}_${r}r${++i.index}`}else t.name=`${t.identifier}_i${i.index++}`;break;default:t.name=`_r${++i.index}`;break}return t.name}function cZ(e){return e.startsWith("--")?e:bS(e)}function x3(e){let t=e.indexOf("!important");return t>-1?e.substring(0,t):e}function dZ(e){for(let t of e.units){for(let i of t.create)(i.kind===I.Listener||i.kind===I.TwoWayListener)&&y3(i.handlerOps);y3(t.update)}}function y3(e){for(let t of e){if(t.kind!==I.Statement||!(t.statement instanceof bn)||!(t.statement.expr instanceof Gb))continue;let i=t.statement.expr.steps,r=!0;for(let n=t.next;n.kind!==I.ListEnd&&r;n=n.next)Ba(n,(a,o)=>{if(!qs(a))return a;if(r&&!(o&Ri.InChildOperation))switch(a.kind){case bt.NextContext:a.steps+=i,ve.remove(t),r=!1;break;case bt.GetCurrentView:case bt.Reference:r=!1;break}})}}var uZ="ng-container";function hZ(e){for(let t of e.units){let i=new Set;for(let r of t.create)r.kind===I.ElementStart&&r.tag===uZ&&(r.kind=I.ContainerStart,i.add(r.xref)),r.kind===I.ElementEnd&&i.has(r.xref)&&(r.kind=I.ContainerEnd)}}function mZ(e,t){let i=e.get(t);if(i===void 0)throw new Error("All attributes should have an element-like target.");return i}function pZ(e){let t=new Map;for(let i of e.units)for(let r of i.create)Wc(r)&&t.set(r.xref,r);for(let i of e.units)for(let r of i.create)(r.kind===I.ElementStart||r.kind===I.ContainerStart)&&r.nonBindable&&ve.insertAfter(G$(r.xref),r),(r.kind===I.ElementEnd||r.kind===I.ContainerEnd)&&mZ(t,r.xref).nonBindable&&ve.insertBefore(j$(r.xref),r)}function fZ(e){for(let t of e.units)for(let i of t.ops())Tn(i,r=>{if(!(r instanceof ci)||r.operator!==ze.NullishCoalesce)return r;let n=new gs(r.lhs.clone(),e.allocateXrefId()),a=new Vl(n.xref);return new co(new ci(ze.And,new ci(ze.NotIdentical,n,mu),new ci(ze.NotIdentical,a,new _n(void 0))),a.clone(),r.rhs)},Ri.None)}function Al(e){return t=>t.kind===e}function Gf(e,t){return i=>i.kind===e&&t===i.expression instanceof Ur}function gZ(e){return e.kind===I.Listener&&!(e.hostListener&&e.isAnimationListener)||e.kind===I.TwoWayListener}function vZ(e){return(e.kind===I.Property||e.kind===I.TwoWayProperty)&&!(e.expression instanceof Ur)}var _Z=[{test:e=>e.kind===I.Listener&&e.hostListener&&e.isAnimationListener},{test:gZ}],bZ=[{test:Al(I.StyleMap),transform:ax},{test:Al(I.ClassMap),transform:ax},{test:Al(I.StyleProp)},{test:Al(I.ClassProp)},{test:Gf(I.Attribute,!0)},{test:Gf(I.Property,!0)},{test:vZ},{test:Gf(I.Attribute,!1)}],xZ=[{test:Gf(I.HostProperty,!0)},{test:Gf(I.HostProperty,!1)},{test:Al(I.Attribute)},{test:Al(I.StyleMap),transform:ax},{test:Al(I.ClassMap),transform:ax},{test:Al(I.StyleProp)},{test:Al(I.ClassProp)}],w3=new Set([I.Listener,I.TwoWayListener,I.StyleMap,I.ClassMap,I.StyleProp,I.ClassProp,I.Property,I.TwoWayProperty,I.HostProperty,I.Attribute]);function yZ(e){for(let t of e.units){C3(t.create,_Z);let i=t.job.kind===Ze.Host?xZ:bZ;C3(t.update,i)}}function C3(e,t){let i=[],r=null;for(let n of e){let a=gS(n)?n.target:null;(!w3.has(n.kind)||a!==r&&r!==null&&a!==null)&&(ve.insertBefore(E3(i,t),n),i=[],r=null),w3.has(n.kind)&&(i.push(n),ve.remove(n),r=a??r)}e.push(E3(i,t))}function E3(e,t){let i=Array.from(t,()=>new Array);for(let r of e){let n=t.findIndex(a=>a.test(r));i[n].push(r)}return i.flatMap((r,n)=>{let a=t[n].transform;return a?a(r):r})}function ax(e){return e.slice(e.length-1)}function wZ(e){let t=new Map;for(let i of e.units)for(let r of i.create)Wc(r)&&t.set(r.xref,r);for(let i of e.units)for(let r of i.create)if(r.kind===I.ExtractedAttribute&&r.bindingKind===dt.Attribute&&oB(r.expression)){let n=t.get(r.target);if(n!==void 0&&n.kind===I.Template&&n.templateKind===oo.Structural)continue;if(r.name==="style"){let a=wB(r.expression.value);for(let o=0;o<a.length-1;o+=2)ve.insertBefore(zo(r.target,dt.StyleProperty,null,a[o],L(a[o+1]),null,null,gi.STYLE),r);ve.remove(r)}else if(r.name==="class"){let a=r.expression.value.trim().split(/\s+/g);for(let o of a)ve.insertBefore(zo(r.target,dt.ClassName,null,o,null,null,null,gi.NONE),r);ve.remove(r)}}}function CZ(e){for(let t of e.units){let i=_S(t);for(let r of t.ops())switch(r.kind){case I.Binding:let n=SZ(i,r.target);EZ(r.name)&&n.kind===I.Projection&&ve.remove(r);break}}}function EZ(e){return e.toLowerCase()==="select"}function SZ(e,t){let i=e.get(t);if(i===void 0)throw new Error("All attributes should have an slottable target.");return i}function AZ(e){for(let t of e.units)TZ(t)}function TZ(e){for(let t of e.update)Ba(t,(i,r)=>{if(qs(i)&&i.kind===bt.PipeBinding){if(r&Ri.InChildOperation)throw new Error("AssertionError: pipe bindings should not appear in child expressions");if(e.job.compatibility){if(t.target==null)throw new Error("AssertionError: expected slot handle to be assigned for pipe creation");DZ(e,t.target,i)}else e.create.push(cB(i.target,i.targetSlot,i.name))}})}function DZ(e,t,i){for(let r=e.create.head.next;r.kind!==I.ListEnd;r=r.next){if(!Nm(r)||r.xref!==t)continue;for(;r.next.kind===I.Pipe;)r=r.next;let n=cB(i.target,i.targetSlot,i.name);ve.insertBefore(n,r.next);return}throw new Error(`AssertionError: unable to find insertion point for pipe ${i.name}`)}function MZ(e){for(let t of e.units)for(let i of t.update)Tn(i,r=>!(r instanceof Iu)||r.args.length<=4?r:new qb(r.target,r.targetSlot,r.name,zt(r.args),r.args.length),Ri.None)}function IZ(e){CB(e.root,0)}function CB(e,t){let i=null;for(let r of e.create)switch(r.kind){case I.I18nStart:r.subTemplateIndex=t===0?null:t,i=r;break;case I.I18nEnd:i.subTemplateIndex===null&&(t=0),i=null;break;case I.Template:t=eE(e.job.views.get(r.xref),i,r.i18nPlaceholder,t);break;case I.RepeaterCreate:let n=e.job.views.get(r.xref);t=eE(n,i,r.i18nPlaceholder,t),r.emptyView!==null&&(t=eE(e.job.views.get(r.emptyView),i,r.emptyI18nPlaceholder,t));break}return t}function eE(e,t,i,r){if(i!==void 0){if(t===null)throw Error("Expected template with i18n placeholder to be in an i18n block.");r++,kZ(e,t)}return CB(e,r)}function kZ(e,t){if(e.create.head.next?.kind!==I.I18nStart){let i=e.job.allocateXrefId();ve.insertAfter(Ex(i,t.message,t.root,null),e.create.head),ve.insertBefore(Sx(i,null),e.create.tail)}}function NZ(e){for(let t of e.units)for(let i of t.ops())Ba(i,r=>{if(!(r instanceof Mu)||r.body===null)return;let n=new S2(r.args.length);r.fn=e.pool.getSharedConstant(n,r.body),r.body=null})}var S2=class extends sm{constructor(t){super(),this.numArgs=t}keyOf(t){return t instanceof wm?`param(${t.index})`:super.keyOf(t)}toSharedConstantDeclaration(t,i){let r=[];for(let a=0;a<this.numArgs;a++)r.push(new er("a"+a));let n=Ke(i,a=>a instanceof wm?et("a"+a.index):a,Ri.None);return new Wn(t,new uu(r,n),void 0,Sn.Final)}};function PZ(e){for(let t of e.units)for(let i of t.update)Tn(i,(r,n)=>n&Ri.InChildOperation?r:r instanceof Go?RZ(r):r instanceof fs?FZ(r):r,Ri.None)}function RZ(e){let t=[],i=[];for(let r of e.entries)if(r.isConstant())t.push(r);else{let n=i.length;i.push(r),t.push(new wm(n))}return new Mu(zt(t),i)}function FZ(e){let t=[],i=[];for(let r of e.entries)if(r.value.isConstant())t.push(r);else{let n=i.length;i.push(r.value),t.push(new hm(r.key,new wm(n),r.quoted))}return new Mu(xn(t),i)}function OZ(e,t,i,r,n){return Ax(E.element,e,t,i,r,n)}function LZ(e,t,i,r,n){return Ax(E.elementStart,e,t,i,r,n)}function Ax(e,t,i,r,n,a){let o=[L(t)];return i!==null&&o.push(L(i)),n!==null?o.push(L(r),L(n)):r!==null&&o.push(L(r)),vi(e,o,a)}function BZ(e){return vi(E.elementEnd,[],e)}function VZ(e,t,i,r){return Ax(E.elementContainerStart,e,null,t,i,r)}function zZ(e,t,i,r){return Ax(E.elementContainer,e,null,t,i,r)}function UZ(){return vi(E.elementContainerEnd,[],null)}function HZ(e,t,i,r,n,a,o,s){let l=[L(e),t,L(i),L(r),L(n),L(a)];for(o!==null&&(l.push(L(o)),l.push(Le(E.templateRefExtractor)));l[l.length-1].isEquivalent(mu);)l.pop();return vi(E.templateCreate,l,s)}function GZ(){return vi(E.disableBindings,[],null)}function jZ(){return vi(E.enableBindings,[],null)}function WZ(e,t,i,r,n){let a=[L(e),t];return i!==null&&(a.push(L(!1)),a.push(Le(i))),vi(r?E.syntheticHostListener:E.listener,a,n)}function S3(e,t){return Le(E.twoWayBindingSet).callFn([e,t])}function qZ(e,t,i){return vi(E.twoWayListener,[L(e),t],i)}function $Z(e,t){return vi(E.pipe,[L(e),L(t)],null)}function XZ(){return vi(E.namespaceHTML,[],null)}function YZ(){return vi(E.namespaceSVG,[],null)}function ZZ(){return vi(E.namespaceMathML,[],null)}function KZ(e,t){return vi(E.advance,e>1?[L(e)]:[],t)}function QZ(e){return Le(E.reference).callFn([L(e)])}function JZ(e){return Le(E.nextContext).callFn(e===1?[]:[L(e)])}function eK(){return Le(E.getCurrentView).callFn([])}function tK(e){return Le(E.restoreView).callFn([e])}function iK(e){return Le(E.resetView).callFn([e])}function rK(e,t,i){let r=[L(e,null)];return t!==""&&r.push(L(t)),vi(E.text,r,i)}function nK(e,t,i,r,n,a,o,s,l,c){let d=[L(e),L(t),i??L(null),L(r),L(n),L(a),o??L(null),s??L(null),l?Le(E.deferEnableTimerScheduling):L(null)],u;for(;(u=d[d.length-1])!==null&&u instanceof _n&&u.value===null;)d.pop();return vi(E.defer,d,c)}var aK=new Map([[ur.Idle,[E.deferOnIdle,E.deferPrefetchOnIdle]],[ur.Immediate,[E.deferOnImmediate,E.deferPrefetchOnImmediate]],[ur.Timer,[E.deferOnTimer,E.deferPrefetchOnTimer]],[ur.Hover,[E.deferOnHover,E.deferPrefetchOnHover]],[ur.Interaction,[E.deferOnInteraction,E.deferPrefetchOnInteraction]],[ur.Viewport,[E.deferOnViewport,E.deferPrefetchOnViewport]]]);function oK(e,t,i,r){let n=aK.get(e);if(n===void 0)throw new Error(`Unable to determine instruction for trigger ${e}`);let a=i?n[1]:n[0];return vi(a,t.map(o=>L(o)),r)}function sK(e){return vi(E.projectionDef,e?[e]:[],null)}function lK(e,t,i,r){let n=[L(e)];return(t!==0||i!==null)&&(n.push(L(t)),i!==null&&n.push(i)),vi(E.projection,n,r)}function cK(e,t,i,r){let n=[L(e),L(t)];return i!==null&&n.push(L(i)),vi(E.i18nStart,n,r)}function dK(e,t,i,r,n,a,o,s,l,c,d,u,h,m){let f=[L(e),et(t),L(i),L(r),L(n),L(a),o];return(s||l!==null)&&(f.push(L(s)),l!==null&&(f.push(et(l),L(c),L(d)),(u!==null||h!==null)&&f.push(L(u)),h!==null&&f.push(L(h)))),vi(E.repeaterCreate,f,m)}function uK(e,t){return vi(E.repeater,[e],t)}function hK(e,t,i){return vi(e?E.deferPrefetchWhen:E.deferWhen,[t],i)}function mK(e,t,i,r){let n=[L(e),L(t)];return i&&n.push(L(i)),vi(E.i18n,n,r)}function pK(e){return vi(E.i18nEnd,[],e)}function fK(e,t){let i=[L(e),L(t)];return vi(E.i18nAttributes,i,null)}function gK(e,t,i,r){let n=[L(e),t];return i!==null&&n.push(i),vi(E.property,n,r)}function vK(e,t,i,r){let n=[L(e),t];return i!==null&&n.push(i),vi(E.twoWayProperty,n,r)}function _K(e,t,i,r){let n=[L(e),t];return(i!==null||r!==null)&&n.push(i??L(null)),r!==null&&n.push(L(r)),vi(E.attribute,n,null)}function bK(e,t,i,r){let n=[L(e),t];return i!==null&&n.push(L(i)),vi(E.styleProp,n,r)}function xK(e,t,i){return vi(E.classProp,[L(e),t],i)}function yK(e,t){return vi(E.styleMap,[e],t)}function wK(e,t){return vi(E.classMap,[e],t)}var A3=[E.pipeBind1,E.pipeBind2,E.pipeBind3,E.pipeBind4];function CK(e,t,i){if(i.length<1||i.length>A3.length)throw new Error("pipeBind() argument count out of bounds");let r=A3[i.length-1];return Le(r).callFn([L(e),L(t),...i])}function EK(e,t,i){return Le(E.pipeBindV).callFn([L(e),L(t),i])}function SK(e,t,i){if(e.length<1||t.length!==e.length-1)throw new Error("AssertionError: expected specific shape of args for strings/expressions in interpolation");let r=[];if(t.length===1&&e[0]===""&&e[1]==="")r.push(t[0]);else{let n;for(n=0;n<t.length;n++)r.push(L(e[n]),t[n]);r.push(L(e[n]))}return Pm(LK,[],r,[],i)}function AK(e,t){return vi(E.i18nExp,[e],t)}function TK(e,t){return vi(E.i18nApply,[L(e)],t)}function DK(e,t,i,r,n){let a=Ng(t,i),o=[];return r!==null&&o.push(r),Pm(BK,[L(e)],a,o,n)}function MK(e,t,i,r,n){let a=Ng(t,i),o=[];return r!==null&&o.push(r),Pm(zK,[L(e)],a,o,n)}function IK(e,t,i,r,n){let a=Ng(t,i),o=[];return r!==null&&o.push(L(r)),Pm(VK,[L(e)],a,o,n)}function kK(e,t,i){let r=Ng(e,t);return Pm(UK,[],r,[],i)}function NK(e,t,i){let r=Ng(e,t);return Pm(HK,[],r,[],i)}function PK(e,t,i,r){let n=[L(e),t];return i!==null&&n.push(i),vi(E.hostProperty,n,r)}function RK(e,t,i){return vi(E.syntheticHostProperty,[L(e),t],i)}function FK(e,t,i){return EB(GK,[L(e),t],i,[],null)}function Ng(e,t){if(e.length<1||t.length!==e.length-1)throw new Error("AssertionError: expected specific shape of args for strings/expressions in interpolation");let i=[];if(t.length===1&&e[0]===""&&e[1]==="")i.push(t[0]);else{let r;for(r=0;r<t.length;r++)i.push(L(e[r]),t[r]);i.push(L(e[r]))}return i}function vi(e,t,i){let r=Le(e).callFn(t,i);return Ws(new bn(r,i))}function OK(e,t,i,r){let n=[L(e),t];return i!==null&&n.push(i),vi(E.conditional,n,r)}var LK={constant:[E.textInterpolate,E.textInterpolate1,E.textInterpolate2,E.textInterpolate3,E.textInterpolate4,E.textInterpolate5,E.textInterpolate6,E.textInterpolate7,E.textInterpolate8],variable:E.textInterpolateV,mapping:e=>{if(e%2===0)throw new Error("Expected odd number of arguments");return(e-1)/2}},BK={constant:[E.propertyInterpolate,E.propertyInterpolate1,E.propertyInterpolate2,E.propertyInterpolate3,E.propertyInterpolate4,E.propertyInterpolate5,E.propertyInterpolate6,E.propertyInterpolate7,E.propertyInterpolate8],variable:E.propertyInterpolateV,mapping:e=>{if(e%2===0)throw new Error("Expected odd number of arguments");return(e-1)/2}},VK={constant:[E.styleProp,E.stylePropInterpolate1,E.stylePropInterpolate2,E.stylePropInterpolate3,E.stylePropInterpolate4,E.stylePropInterpolate5,E.stylePropInterpolate6,E.stylePropInterpolate7,E.stylePropInterpolate8],variable:E.stylePropInterpolateV,mapping:e=>{if(e%2===0)throw new Error("Expected odd number of arguments");return(e-1)/2}},zK={constant:[E.attribute,E.attributeInterpolate1,E.attributeInterpolate2,E.attributeInterpolate3,E.attributeInterpolate4,E.attributeInterpolate5,E.attributeInterpolate6,E.attributeInterpolate7,E.attributeInterpolate8],variable:E.attributeInterpolateV,mapping:e=>{if(e%2===0)throw new Error("Expected odd number of arguments");return(e-1)/2}},UK={constant:[E.styleMap,E.styleMapInterpolate1,E.styleMapInterpolate2,E.styleMapInterpolate3,E.styleMapInterpolate4,E.styleMapInterpolate5,E.styleMapInterpolate6,E.styleMapInterpolate7,E.styleMapInterpolate8],variable:E.styleMapInterpolateV,mapping:e=>{if(e%2===0)throw new Error("Expected odd number of arguments");return(e-1)/2}},HK={constant:[E.classMap,E.classMapInterpolate1,E.classMapInterpolate2,E.classMapInterpolate3,E.classMapInterpolate4,E.classMapInterpolate5,E.classMapInterpolate6,E.classMapInterpolate7,E.classMapInterpolate8],variable:E.classMapInterpolateV,mapping:e=>{if(e%2===0)throw new Error("Expected odd number of arguments");return(e-1)/2}},GK={constant:[E.pureFunction0,E.pureFunction1,E.pureFunction2,E.pureFunction3,E.pureFunction4,E.pureFunction5,E.pureFunction6,E.pureFunction7,E.pureFunction8],variable:E.pureFunctionV,mapping:e=>e};function EB(e,t,i,r,n){let a=e.mapping(i.length);if(a<e.constant.length)return Le(e.constant[a]).callFn([...t,...i,...r],n);if(e.variable!==null)return Le(e.variable).callFn([...t,zt(i),...r],n);throw new Error("AssertionError: unable to call variadic function")}function Pm(e,t,i,r,n){return Ws(EB(e,t,i,r,n).toStmt())}var jK=new Map([["window",E.resolveWindow],["document",E.resolveDocument],["body",E.resolveBody]]);function WK(e){for(let t of e.units)qK(t,t.create),SB(t,t.update)}function qK(e,t){for(let i of t)switch(Tn(i,AB,Ri.None),i.kind){case I.Text:ve.replace(i,rK(i.handle.slot,i.initialValue,i.sourceSpan));break;case I.ElementStart:ve.replace(i,LZ(i.handle.slot,i.tag,i.attributes,i.localRefs,i.startSourceSpan));break;case I.Element:ve.replace(i,OZ(i.handle.slot,i.tag,i.attributes,i.localRefs,i.wholeSourceSpan));break;case I.ElementEnd:ve.replace(i,BZ(i.sourceSpan));break;case I.ContainerStart:ve.replace(i,VZ(i.handle.slot,i.attributes,i.localRefs,i.startSourceSpan));break;case I.Container:ve.replace(i,zZ(i.handle.slot,i.attributes,i.localRefs,i.wholeSourceSpan));break;case I.ContainerEnd:ve.replace(i,UZ());break;case I.I18nStart:ve.replace(i,cK(i.handle.slot,i.messageIndex,i.subTemplateIndex,i.sourceSpan));break;case I.I18nEnd:ve.replace(i,pK(i.sourceSpan));break;case I.I18n:ve.replace(i,mK(i.handle.slot,i.messageIndex,i.subTemplateIndex,i.sourceSpan));break;case I.I18nAttributes:if(i.i18nAttributesConfig===null)throw new Error("AssertionError: i18nAttributesConfig was not set");ve.replace(i,fK(i.handle.slot,i.i18nAttributesConfig));break;case I.Template:if(!(e instanceof qc))throw new Error("AssertionError: must be compiling a component");if(Array.isArray(i.localRefs))throw new Error("AssertionError: local refs array should have been extracted into a constant");let r=e.job.views.get(i.xref);ve.replace(i,HZ(i.handle.slot,et(r.fnName),r.decls,r.vars,i.tag,i.attributes,i.localRefs,i.startSourceSpan));break;case I.DisableBindings:ve.replace(i,GZ());break;case I.EnableBindings:ve.replace(i,jZ());break;case I.Pipe:ve.replace(i,$Z(i.handle.slot,i.name));break;case I.Listener:let n=T3(e,i.handlerFnName,i.handlerOps,i.consumesDollarEvent),a=i.eventTarget?jK.get(i.eventTarget):null;if(a===void 0)throw new Error(`Unexpected global target '${i.eventTarget}' defined for '${i.name}' event. Supported list of global targets: window,document,body.`);ve.replace(i,WZ(i.name,n,a,i.hostListener&&i.isAnimationListener,i.sourceSpan));break;case I.TwoWayListener:ve.replace(i,qZ(i.name,T3(e,i.handlerFnName,i.handlerOps,!0),i.sourceSpan));break;case I.Variable:if(i.variable.name===null)throw new Error(`AssertionError: unnamed variable ${i.xref}`);ve.replace(i,Ws(new Wn(i.variable.name,i.initializer,void 0,Sn.Final)));break;case I.Namespace:switch(i.active){case Gn.HTML:ve.replace(i,XZ());break;case Gn.SVG:ve.replace(i,YZ());break;case Gn.Math:ve.replace(i,ZZ());break}break;case I.Defer:let o=!!i.loadingMinimumTime||!!i.loadingAfterTime||!!i.placeholderMinimumTime;ve.replace(i,nK(i.handle.slot,i.mainSlot.slot,i.resolverFn,i.loadingSlot?.slot??null,i.placeholderSlot?.slot??null,i.errorSlot?.slot??null,i.loadingConfig,i.placeholderConfig,o,i.sourceSpan));break;case I.DeferOn:let s=[];switch(i.trigger.kind){case ur.Idle:case ur.Immediate:break;case ur.Timer:s=[i.trigger.delay];break;case ur.Interaction:case ur.Hover:case ur.Viewport:if(i.trigger.targetSlot?.slot==null||i.trigger.targetSlotViewSteps===null)throw new Error(`Slot or view steps not set in trigger reification for trigger kind ${i.trigger.kind}`);s=[i.trigger.targetSlot.slot],i.trigger.targetSlotViewSteps!==0&&s.push(i.trigger.targetSlotViewSteps);break;default:throw new Error(`AssertionError: Unsupported reification of defer trigger kind ${i.trigger.kind}`)}ve.replace(i,oK(i.trigger.kind,s,i.prefetch,i.sourceSpan));break;case I.ProjectionDef:ve.replace(i,sK(i.def));break;case I.Projection:if(i.handle.slot===null)throw new Error("No slot was assigned for project instruction");ve.replace(i,lK(i.handle.slot,i.projectionSlotIndex,i.attributes,i.sourceSpan));break;case I.RepeaterCreate:if(i.handle.slot===null)throw new Error("No slot was assigned for repeater instruction");if(!(e instanceof qc))throw new Error("AssertionError: must be compiling a component");let l=e.job.views.get(i.xref);if(l.fnName===null)throw new Error("AssertionError: expected repeater primary view to have been named");let c=null,d=null,u=null;if(i.emptyView!==null){let h=e.job.views.get(i.emptyView);if(h===void 0)throw new Error("AssertionError: repeater had empty view xref, but empty view was not found");if(h.fnName===null||h.decls===null||h.vars===null)throw new Error("AssertionError: expected repeater empty view to have been named and counted");c=h.fnName,d=h.decls,u=h.vars}ve.replace(i,dK(i.handle.slot,l.fnName,i.decls,i.vars,i.tag,i.attributes,i.trackByFn,i.usesComponentInstance,c,d,u,i.emptyTag,i.emptyAttributes,i.wholeSourceSpan));break;case I.Statement:break;default:throw new Error(`AssertionError: Unsupported reification of create op ${I[i.kind]}`)}}function SB(e,t){for(let i of t)switch(Tn(i,AB,Ri.None),i.kind){case I.Advance:ve.replace(i,KZ(i.delta,i.sourceSpan));break;case I.Property:i.expression instanceof Ur?ve.replace(i,DK(i.name,i.expression.strings,i.expression.expressions,i.sanitizer,i.sourceSpan)):ve.replace(i,gK(i.name,i.expression,i.sanitizer,i.sourceSpan));break;case I.TwoWayProperty:ve.replace(i,vK(i.name,i.expression,i.sanitizer,i.sourceSpan));break;case I.StyleProp:i.expression instanceof Ur?ve.replace(i,IK(i.name,i.expression.strings,i.expression.expressions,i.unit,i.sourceSpan)):ve.replace(i,bK(i.name,i.expression,i.unit,i.sourceSpan));break;case I.ClassProp:ve.replace(i,xK(i.name,i.expression,i.sourceSpan));break;case I.StyleMap:i.expression instanceof Ur?ve.replace(i,kK(i.expression.strings,i.expression.expressions,i.sourceSpan)):ve.replace(i,yK(i.expression,i.sourceSpan));break;case I.ClassMap:i.expression instanceof Ur?ve.replace(i,NK(i.expression.strings,i.expression.expressions,i.sourceSpan)):ve.replace(i,wK(i.expression,i.sourceSpan));break;case I.I18nExpression:ve.replace(i,AK(i.expression,i.sourceSpan));break;case I.I18nApply:ve.replace(i,TK(i.handle.slot,i.sourceSpan));break;case I.InterpolateText:ve.replace(i,SK(i.interpolation.strings,i.interpolation.expressions,i.sourceSpan));break;case I.Attribute:i.expression instanceof Ur?ve.replace(i,MK(i.name,i.expression.strings,i.expression.expressions,i.sanitizer,i.sourceSpan)):ve.replace(i,_K(i.name,i.expression,i.sanitizer,i.namespace));break;case I.HostProperty:if(i.expression instanceof Ur)throw new Error("not yet handled");i.isAnimationTrigger?ve.replace(i,RK(i.name,i.expression,i.sourceSpan)):ve.replace(i,PK(i.name,i.expression,i.sanitizer,i.sourceSpan));break;case I.Variable:if(i.variable.name===null)throw new Error(`AssertionError: unnamed variable ${i.xref}`);ve.replace(i,Ws(new Wn(i.variable.name,i.initializer,void 0,Sn.Final)));break;case I.Conditional:if(i.processed===null)throw new Error("Conditional test was not set.");if(i.targetSlot.slot===null)throw new Error("Conditional slot was not set.");ve.replace(i,OK(i.targetSlot.slot,i.processed,i.contextValue,i.sourceSpan));break;case I.Repeater:ve.replace(i,uK(i.collection,i.sourceSpan));break;case I.DeferWhen:ve.replace(i,hK(i.prefetch,i.expr,i.sourceSpan));break;case I.Statement:break;default:throw new Error(`AssertionError: Unsupported reification of update op ${I[i.kind]}`)}}function AB(e){if(!qs(e))return e;switch(e.kind){case bt.NextContext:return JZ(e.steps);case bt.Reference:return QZ(e.targetSlot.slot+1+e.offset);case bt.LexicalRead:throw new Error(`AssertionError: unresolved LexicalRead of ${e.name}`);case bt.TwoWayBindingSet:throw new Error("AssertionError: unresolved TwoWayBindingSet");case bt.RestoreView:if(typeof e.view=="number")throw new Error("AssertionError: unresolved RestoreView");return tK(e.view);case bt.ResetView:return iK(e.expr);case bt.GetCurrentView:return eK();case bt.ReadVariable:if(e.name===null)throw new Error(`Read of unnamed variable ${e.xref}`);return et(e.name);case bt.ReadTemporaryExpr:if(e.name===null)throw new Error(`Read of unnamed temporary ${e.xref}`);return et(e.name);case bt.AssignTemporaryExpr:if(e.name===null)throw new Error(`Assign of unnamed temporary ${e.xref}`);return et(e.name).set(e.expr);case bt.PureFunctionExpr:if(e.fn===null)throw new Error("AssertionError: expected PureFunctions to have been extracted");return FK(e.varOffset,e.fn,e.args);case bt.PureFunctionParameterExpr:throw new Error("AssertionError: expected PureFunctionParameterExpr to have been extracted");case bt.PipeBinding:return CK(e.targetSlot.slot,e.varOffset,e.args);case bt.PipeBindingVariadic:return EK(e.targetSlot.slot,e.varOffset,e.args);case bt.SlotLiteralExpr:return L(e.slot.slot);default:throw new Error(`AssertionError: Unsupported reification of ir.Expression kind: ${bt[e.kind]}`)}}function T3(e,t,i,r){SB(e,i);let n=[];for(let o of i){if(o.kind!==I.Statement)throw new Error(`AssertionError: expected reified statements, but found op ${I[o.kind]}`);n.push(o.statement)}let a=[];return r&&a.push(new er("$event")),Gs(a,n,void 0,void 0,t)}function $K(e){for(let t of e.units)for(let i of t.update)switch(i.kind){case I.Attribute:case I.Binding:case I.ClassProp:case I.ClassMap:case I.Property:case I.StyleProp:case I.StyleMap:i.expression instanceof mg&&ve.remove(i);break}}function XK(e){for(let t of e.units)for(let i of t.create)switch(i.kind){case I.I18nContext:ve.remove(i);break;case I.I18nStart:i.context=null;break}}function YK(e){for(let t of e.units){let i=new Set;for(let r of t.update)switch(r.kind){case I.I18nExpression:i.add(r.i18nOwner)}for(let r of t.create)switch(r.kind){case I.I18nAttributes:if(i.has(r.xref))continue;ve.remove(r)}}}function ZK(e){for(let t of e.units)A2(t,t.create),A2(t,t.update)}function A2(e,t){let i=new Map;i.set(e.xref,et("ctx"));for(let r of t)switch(r.kind){case I.Variable:switch(r.variable.kind){case gn.Context:i.set(r.variable.view,new Bl(r.xref));break}break;case I.Listener:case I.TwoWayListener:A2(e,r.handlerOps);break}e===e.job.root&&i.set(e.xref,et("ctx"));for(let r of t)Tn(r,n=>{if(n instanceof Ll){if(!i.has(n.view))throw new Error(`No context found for reference to view ${n.view} from view ${e.xref}`);return i.get(n.view)}else return n},Ri.None)}function KK(e){for(let t of e.units)D3(t.create),D3(t.update)}function D3(e){for(let t of e)(t.kind===I.Listener||t.kind===I.TwoWayListener)&&Tn(t,i=>i instanceof Oa&&i.name==="$event"?(t.kind===I.Listener&&(t.consumesDollarEvent=!0),new lo(i.name)):i,Ri.InChildOperation)}function QK(e){let t=new Map,i=new Map;for(let r of e.units)for(let n of r.create)switch(n.kind){case I.I18nContext:t.set(n.xref,n);break;case I.ElementStart:i.set(n.xref,n);break}Nc(e,e.root,t,i)}function Nc(e,t,i,r,n){let a=null,o=new Map;for(let s of t.create)switch(s.kind){case I.I18nStart:if(!s.context)throw Error("Could not find i18n context for i18n op");a={i18nBlock:s,i18nContext:i.get(s.context)};break;case I.I18nEnd:a=null;break;case I.ElementStart:if(s.i18nPlaceholder!==void 0){if(a===null)throw Error("i18n tag placeholder should only occur inside an i18n block");M3(s,a.i18nContext,a.i18nBlock,n),n&&s.i18nPlaceholder.closeName&&o.set(s.xref,n),n=void 0}break;case I.ElementEnd:let l=r.get(s.xref);if(l&&l.i18nPlaceholder!==void 0){if(a===null)throw Error("AssertionError: i18n tag placeholder should only occur inside an i18n block");I3(l,a.i18nContext,a.i18nBlock,o.get(s.xref)),o.delete(s.xref)}break;case I.Projection:if(s.i18nPlaceholder!==void 0){if(a===null)throw Error("i18n tag placeholder should only occur inside an i18n block");M3(s,a.i18nContext,a.i18nBlock,n),I3(s,a.i18nContext,a.i18nBlock,n),n=void 0}break;case I.Template:let c=e.views.get(s.xref);if(s.i18nPlaceholder===void 0)Nc(e,c,i,r);else{if(a===null)throw Error("i18n tag placeholder should only occur inside an i18n block");s.templateKind===oo.Structural?Nc(e,c,i,r,s):(tE(e,c,s.handle.slot,s.i18nPlaceholder,a.i18nContext,a.i18nBlock,n),Nc(e,c,i,r),iE(e,c,s.handle.slot,s.i18nPlaceholder,a.i18nContext,a.i18nBlock,n),n=void 0)}break;case I.RepeaterCreate:if(n!==void 0)throw Error("AssertionError: Unexpected structural directive associated with @for block");let d=s.handle.slot+1,u=e.views.get(s.xref);if(s.i18nPlaceholder===void 0)Nc(e,u,i,r);else{if(a===null)throw Error("i18n tag placeholder should only occur inside an i18n block");tE(e,u,d,s.i18nPlaceholder,a.i18nContext,a.i18nBlock,n),Nc(e,u,i,r),iE(e,u,d,s.i18nPlaceholder,a.i18nContext,a.i18nBlock,n),n=void 0}if(s.emptyView!==null){let h=s.handle.slot+2,m=e.views.get(s.emptyView);if(s.emptyI18nPlaceholder===void 0)Nc(e,m,i,r);else{if(a===null)throw Error("i18n tag placeholder should only occur inside an i18n block");tE(e,m,h,s.emptyI18nPlaceholder,a.i18nContext,a.i18nBlock,n),Nc(e,m,i,r),iE(e,m,h,s.emptyI18nPlaceholder,a.i18nContext,a.i18nBlock,n),n=void 0}}break}}function M3(e,t,i,r){let{startName:n,closeName:a}=e.i18nPlaceholder,o=Ki.ElementTag|Ki.OpenTag,s=e.handle.slot;r!==void 0&&(o|=Ki.TemplateTag,s={element:s,template:r.handle.slot}),a||(o|=Ki.CloseTag),Mm(t.params,n,s,i.subTemplateIndex,o)}function I3(e,t,i,r){let{closeName:n}=e.i18nPlaceholder;if(n){let a=Ki.ElementTag|Ki.CloseTag,o=e.handle.slot;r!==void 0&&(a|=Ki.TemplateTag,o={element:o,template:r.handle.slot}),Mm(t.params,n,o,i.subTemplateIndex,a)}}function tE(e,t,i,r,n,a,o){let{startName:s,closeName:l}=r,c=Ki.TemplateTag|Ki.OpenTag;l||(c|=Ki.CloseTag),o!==void 0&&Mm(n.params,s,o.handle.slot,a.subTemplateIndex,c),Mm(n.params,s,i,TB(e,a,t),c)}function iE(e,t,i,r,n,a,o){let{closeName:s}=r,l=Ki.TemplateTag|Ki.CloseTag;s&&(Mm(n.params,s,i,TB(e,a,t),l),o!==void 0&&Mm(n.params,s,o.handle.slot,a.subTemplateIndex,l))}function TB(e,t,i){for(let r of i.create)if(r.kind===I.I18nStart)return r.subTemplateIndex;return t.subTemplateIndex}function Mm(e,t,i,r,n){let a=e.get(t)??[];a.push({value:i,subTemplateIndex:r,flags:n}),e.set(t,a)}function JK(e){let t=new Map,i=new Map,r=new Map;for(let o of e.units)for(let s of o.create)switch(s.kind){case I.I18nStart:t.set(s.xref,s.subTemplateIndex);break;case I.I18nContext:i.set(s.xref,s);break;case I.IcuPlaceholder:r.set(s.xref,s);break}let n=new Map,a=o=>o.usage===km.I18nText?o.i18nOwner:o.context;for(let o of e.units)for(let s of o.update)if(s.kind===I.I18nExpression){let l=n.get(a(s))||0,c=t.get(s.i18nOwner)??null,d={value:l,subTemplateIndex:c,flags:Ki.ExpressionIndex};eQ(s,d,i,r),n.set(a(s),l+1)}}function eQ(e,t,i,r){if(e.i18nPlaceholder!==null){let n=i.get(e.context),a=e.resolutionTime===hg.Creation?n.params:n.postprocessingParams,o=a.get(e.i18nPlaceholder)||[];o.push(t),a.set(e.i18nPlaceholder,o)}e.icuPlaceholder!==null&&r.get(e.icuPlaceholder)?.expressionPlaceholders.push(t)}function tQ(e){for(let t of e.units)T2(t,t.create,null),T2(t,t.update,null)}function T2(e,t,i){let r=new Map;for(let n of t)switch(n.kind){case I.Variable:switch(n.variable.kind){case gn.Identifier:case gn.Alias:if(r.has(n.variable.identifier))continue;r.set(n.variable.identifier,n.xref);break;case gn.SavedView:i={view:n.variable.view,variable:n.xref};break}break;case I.Listener:case I.TwoWayListener:T2(e,n.handlerOps,i);break}for(let n of t)n.kind==I.Listener||n.kind===I.TwoWayListener||Tn(n,a=>{if(a instanceof Oa)return r.has(a.name)?new Bl(r.get(a.name)):new ma(new Ll(e.job.root.xref),a.name);if(a instanceof jb&&typeof a.view=="number"){if(i===null||i.view!==a.view)throw new Error(`AssertionError: no saved view ${a.view} from view ${e.xref}`);return a.view=new Bl(i.variable),a}else return a},Ri.None);for(let n of t)Ba(n,a=>{if(a instanceof Oa)throw new Error(`AssertionError: no lexical reads should remain, but found read of ${a.name}`)})}var iQ=new Map([[gi.HTML,E.sanitizeHtml],[gi.RESOURCE_URL,E.sanitizeResourceUrl],[gi.SCRIPT,E.sanitizeScript],[gi.STYLE,E.sanitizeStyle],[gi.URL,E.sanitizeUrl]]),rQ=new Map([[gi.HTML,E.trustConstantHtml],[gi.RESOURCE_URL,E.trustConstantResourceUrl]]);function nQ(e){for(let t of e.units){let i=_S(t);if(e.kind!==Ze.Host){for(let r of t.create)if(r.kind===I.ExtractedAttribute){let n=rQ.get(k3(r.securityContext))??null;r.trustedValueFn=n!==null?Le(n):null}}for(let r of t.update)switch(r.kind){case I.Property:case I.Attribute:case I.HostProperty:let n=null;if(Array.isArray(r.securityContext)&&r.securityContext.length===2&&r.securityContext.indexOf(gi.URL)>-1&&r.securityContext.indexOf(gi.RESOURCE_URL)>-1?n=E.sanitizeUrlOrResourceUrl:n=iQ.get(k3(r.securityContext))??null,r.sanitizer=n!==null?Le(n):null,r.sanitizer===null){let a=!1;if(e.kind===Ze.Host||r.kind===I.HostProperty)a=!0;else{let o=i.get(r.target);if(o===void 0||!Wc(o))throw Error("Property should have an element-like owner");a=aQ(o)}a&&hS(r.name)&&(r.sanitizer=Le(E.validateIframeAttribute))}break}}}function aQ(e){return e.kind===I.ElementStart&&e.tag?.toLowerCase()==="iframe"}function k3(e){if(Array.isArray(e)){if(e.length>1)throw Error("AssertionError: Ambiguous security context");return e[0]||gi.NONE}return e}function oQ(e){for(let t of e.units)for(let i of t.create)i.kind===I.TwoWayListener&&Tn(i,r=>r instanceof Wb?sQ(r.target,r.value):r,Ri.InChildOperation)}function X_(e,t){return e instanceof Bl?S3(e,t):S3(e,t).or(e.set(t))}function Y_(e){return e instanceof ma||e instanceof Hs||e instanceof Bl}function sQ(e,t){if(Y_(e))return X_(e,t);if(e instanceof ci&&Y_(e.rhs))return new ci(e.operator,e.lhs,X_(e.rhs,t));if(e instanceof co&&Y_(e.falseCase))return new co(e.condition,e.trueCase,X_(e.falseCase,t));if(e instanceof kl){let i=e.condition;for(;;)if(i instanceof kl)i=i.condition;else{if(Y_(i))return X_(i,t);break}}throw new Error("Unsupported expression in two-way action binding.")}function lQ(e){for(let t of e.units){t.create.prepend([nm(t.job.allocateXrefId(),{kind:gn.SavedView,name:null,view:t.xref},new JE,Ls.None)]);for(let i of t.create){if(i.kind!==I.Listener&&i.kind!==I.TwoWayListener)continue;let r=t!==e.root;if(!r)for(let n of i.handlerOps)Ba(n,a=>{a instanceof Ub&&(r=!0)});r&&cQ(t,i)}}}function cQ(e,t){t.handlerOps.prepend([nm(e.job.allocateXrefId(),{kind:gn.Context,name:null,view:e.xref},new jb(e.xref),Ls.None)]);for(let i of t.handlerOps)i.kind===I.Statement&&i.statement instanceof Jr&&(i.statement.value=new e2(i.statement.value))}function dQ(e){let t=new Map;for(let i of e.units){let r=0;for(let n of i.create)Nm(n)&&(n.handle.slot=r,t.set(n.xref,n.handle.slot),r+=n.numSlotsUsed);i.decls=r}for(let i of e.units)for(let r of i.ops())if(r.kind===I.Template||r.kind===I.RepeaterCreate){let n=e.views.get(r.xref);r.decls=n.decls}}function uQ(e){for(let t of e.units)for(let i of t.update)if(i.kind===I.Binding)switch(i.bindingKind){case dt.ClassName:if(i.expression instanceof Ur)throw new Error("Unexpected interpolation in ClassName binding");ve.replace(i,k$(i.target,i.name,i.expression,i.sourceSpan));break;case dt.StyleProperty:ve.replace(i,I$(i.target,i.name,i.expression,i.unit,i.sourceSpan));break;case dt.Property:case dt.Template:i.name==="style"?ve.replace(i,N$(i.target,i.expression,i.sourceSpan)):i.name==="class"&&ve.replace(i,P$(i.target,i.expression,i.sourceSpan));break}}function hQ(e){for(let t of e.units)t.create.prepend(D2(t.create)),t.update.prepend(D2(t.update))}function D2(e){let t=0,i=[];for(let r of e){let n=new Map;Ba(r,(c,d)=>{d&Ri.InChildOperation||c instanceof Vl&&n.set(c.xref,c)});let a=0,o=new Set,s=new Set,l=new Map;Ba(r,(c,d)=>{d&Ri.InChildOperation||(c instanceof gs?(o.has(c.xref)||(o.add(c.xref),l.set(c.xref,`tmp_${t}_${a++}`)),N3(l,c)):c instanceof Vl&&(n.get(c.xref)===c&&(s.add(c.xref),a--),N3(l,c)))}),i.push(...Array.from(new Set(l.values())).map(c=>Ws(new Wn(c)))),t++,(r.kind===I.Listener||r.kind===I.TwoWayListener)&&r.handlerOps.prepend(D2(r.handlerOps))}return i}function N3(e,t){let i=e.get(t.xref);if(i===void 0)throw new Error(`Found xref with unassigned name: ${t.xref}`);t.name=i}function mQ(e){for(let t of e.units)for(let i of t.create){if(i.kind!==I.RepeaterCreate||i.trackByFn!==null)continue;let r=!1;i.track=Ke(i.track,o=>{if(o instanceof Iu||o instanceof qb)throw new Error("Illegal State: Pipes are not allowed in this context");return o instanceof Hb?(r=!0,et("this")):o},Ri.None);let n,a=[new er("$index"),new er("$item")];r?n=new du(a,[new Jr(i.track)]):n=vn(a,i.track),i.trackByFn=e.pool.getSharedFunctionReference(n,"_forTrack")}}function pQ(e){for(let t of e.units)for(let i of t.create)i.kind===I.RepeaterCreate&&(i.track instanceof lo&&i.track.name==="$index"?i.trackByFn=Le(E.repeaterTrackByIndex):i.track instanceof lo&&i.track.name==="$item"?i.trackByFn=Le(E.repeaterTrackByIdentity):fQ(e.root.xref,i.track)?(i.usesComponentInstance=!0,i.track.receiver.receiver.view===t.xref?i.trackByFn=i.track.receiver:(i.trackByFn=Le(E.componentInstance).callFn([]).prop(i.track.receiver.name),i.track=i.trackByFn)):i.track=Ke(i.track,r=>r instanceof Ll?(i.usesComponentInstance=!0,new Hb(r.view)):r,Ri.None))}function fQ(e,t){if(!(t instanceof ha)||t.args.length!==2||!(t.receiver instanceof ma&&t.receiver.receiver instanceof Ll)||t.receiver.receiver.view!==e)return!1;let[i,r]=t.args;return!(!(i instanceof lo)||i.name!=="$index"||!(r instanceof lo)||r.name!=="$item")}function gQ(e){for(let t of e.units)for(let i of t.create)i.kind===I.RepeaterCreate&&(i.track=Ke(i.track,r=>{if(r instanceof Oa){if(r.name===i.varNames.$index)return et("$index");if(r.name===i.varNames.$implicit)return et("$item")}return r},Ri.None))}function vQ(e){for(let t of e.units){let i=0;for(let r of t.ops())$C(r)&&(i+=_Q(r));for(let r of t.ops())Ba(r,n=>{qs(n)&&(e.compatibility===uo.TemplateDefinitionBuilder&&n instanceof Mu||(WO(n)&&(n.varOffset=i),$C(n)&&(i+=P3(n))))});if(e.compatibility===uo.TemplateDefinitionBuilder)for(let r of t.ops())Ba(r,n=>{!qs(n)||!(n instanceof Mu)||(WO(n)&&(n.varOffset=i),$C(n)&&(i+=P3(n)))});t.vars=i}if(e instanceof fg)for(let t of e.units)for(let i of t.create){if(i.kind!==I.Template&&i.kind!==I.RepeaterCreate)continue;let r=e.views.get(i.xref);i.vars=r.vars}}function _Q(e){let t;switch(e.kind){case I.Property:case I.HostProperty:case I.Attribute:return t=1,e.expression instanceof Ur&&!bQ(e.expression)&&(t+=e.expression.expressions.length),t;case I.TwoWayProperty:return 1;case I.StyleProp:case I.ClassProp:case I.StyleMap:case I.ClassMap:return t=2,e.expression instanceof Ur&&(t+=e.expression.expressions.length),t;case I.InterpolateText:return e.interpolation.expressions.length;case I.I18nExpression:case I.Conditional:case I.DeferWhen:return 1;case I.RepeaterCreate:return e.emptyView?1:0;default:throw new Error(`Unhandled op: ${I[e.kind]}`)}}function P3(e){switch(e.kind){case bt.PureFunctionExpr:return 1+e.args.length;case bt.PipeBinding:return 1+e.args.length;case bt.PipeBindingVariadic:return 1+e.numArgs;default:throw new Error(`AssertionError: unhandled ConsumesVarsTrait expression ${e.constructor.name}`)}}function bQ(e){return!(e.expressions.length!==1||e.strings.length!==2||e.strings[0]!==""||e.strings[1]!=="")}function xQ(e){for(let t of e.units){rE(t.create),rE(t.update);for(let i of t.create)(i.kind===I.Listener||i.kind===I.TwoWayListener)&&rE(i.handlerOps);nE(t.create,e.compatibility),nE(t.update,e.compatibility);for(let i of t.create)(i.kind===I.Listener||i.kind===I.TwoWayListener)&&nE(i.handlerOps,e.compatibility)}}var pn=function(e){return e[e.None=0]="None",e[e.ViewContextRead=1]="ViewContextRead",e[e.ViewContextWrite=2]="ViewContextWrite",e[e.SideEffectful=4]="SideEffectful",e}(pn||{});function rE(e){let t=new Map;for(let i of e)i.kind===I.Variable&&i.flags&Ls.AlwaysInline&&(Ba(i,r=>{if(qs(r)&&xS(r)!==pn.None)throw new Error("AssertionError: A context-sensitive variable was marked AlwaysInline")}),t.set(i.xref,i)),Tn(i,r=>r instanceof Bl&&t.has(r.xref)?t.get(r.xref).initializer.clone():r,Ri.None);for(let i of t.values())ve.remove(i)}function nE(e,t){let i=new Map,r=new Map,n=new Set,a=new Map;for(let c of e){if(c.kind===I.Variable){if(i.has(c.xref)||r.has(c.xref))throw new Error(`Should not see two declarations of the same variable: ${c.xref}`);i.set(c.xref,c),r.set(c.xref,0)}a.set(c,yQ(c)),wQ(c,r,n)}let o=!1;for(let c of e.reversed()){let d=a.get(c);if(c.kind===I.Variable&&r.get(c.xref)===0){if(o&&d.fences&pn.ViewContextWrite||d.fences&pn.SideEffectful){let u=Ws(c.initializer.toStmt());a.set(u,d),ve.replace(c,u)}else CQ(c,r),ve.remove(c);a.delete(c),i.delete(c.xref),r.delete(c.xref);continue}d.fences&pn.ViewContextRead&&(o=!0)}let s=[];for(let[c,d]of r){let h=!!(i.get(c).flags&Ls.AlwaysInline);d!==1||h||n.has(c)||s.push(c)}let l;for(;l=s.pop();){let c=i.get(l),d=a.get(c);if(!!(c.flags&Ls.AlwaysInline))throw new Error("AssertionError: Found an 'AlwaysInline' variable after the always inlining pass.");for(let h=c.next;h.kind!==I.ListEnd;h=h.next){let m=a.get(h);if(m.variablesUsed.has(l)){if(t===uo.TemplateDefinitionBuilder&&!SQ(c,h))break;if(EQ(l,c.initializer,h,d.fences)){m.variablesUsed.delete(l);for(let f of d.variablesUsed)m.variablesUsed.add(f);m.fences|=d.fences,i.delete(l),r.delete(l),a.delete(c),ve.remove(c)}break}if(!DB(m.fences,d.fences))break}}}function xS(e){switch(e.kind){case bt.NextContext:return pn.ViewContextRead|pn.ViewContextWrite;case bt.RestoreView:return pn.ViewContextRead|pn.ViewContextWrite|pn.SideEffectful;case bt.Reference:return pn.ViewContextRead;default:return pn.None}}function yQ(e){let t=pn.None,i=new Set;return Ba(e,r=>{if(qs(r))switch(r.kind){case bt.ReadVariable:i.add(r.xref);break;default:t|=xS(r)}}),{fences:t,variablesUsed:i}}function wQ(e,t,i){Ba(e,(r,n)=>{if(!qs(r)||r.kind!==bt.ReadVariable)return;let a=t.get(r.xref);a!==void 0&&(t.set(r.xref,a+1),n&Ri.InChildOperation&&i.add(r.xref))})}function CQ(e,t){Ba(e,i=>{if(!qs(i)||i.kind!==bt.ReadVariable)return;let r=t.get(i.xref);if(r!==void 0){if(r===0)throw new Error(`Inaccurate variable count: ${i.xref} - found another read but count is already 0`);t.set(i.xref,r-1)}})}function DB(e,t){if(e&pn.ViewContextWrite){if(t&pn.ViewContextRead)return!1}else if(e&pn.ViewContextRead&&t&pn.ViewContextWrite)return!1;return!0}function EQ(e,t,i,r){let n=!1,a=!0;return Tn(i,(o,s)=>{if(!qs(o)||n||!a)return o;if(s&Ri.InChildOperation&&r&pn.ViewContextRead)return o;switch(o.kind){case bt.ReadVariable:if(o.xref===e)return n=!0,t;break;default:let l=xS(o);a=a&&DB(l,r);break}return o},Ri.None),n}function SQ(e,t){switch(e.variable.kind){case gn.Identifier:return e.initializer instanceof lo&&e.initializer.name==="ctx";case gn.Context:return t.kind===I.Variable;default:return!0}}function AQ(e){for(let t of e.units){let i=null,r=null;for(let n of t.create)switch(n.kind){case I.I18nStart:i=n;break;case I.I18nEnd:i=null;break;case I.IcuStart:i===null&&(r=e.allocateXrefId(),ve.insertBefore(Ex(r,n.message,void 0,null),n));break;case I.IcuEnd:r!==null&&(ve.insertAfter(Sx(r,null),n),r=null);break}}}var TQ=[{kind:Ze.Tmpl,fn:CZ},{kind:Ze.Host,fn:QX},{kind:Ze.Tmpl,fn:oZ},{kind:Ze.Tmpl,fn:IZ},{kind:Ze.Tmpl,fn:AQ},{kind:Ze.Both,fn:yX},{kind:Ze.Both,fn:uQ},{kind:Ze.Both,fn:lX},{kind:Ze.Both,fn:aX},{kind:Ze.Tmpl,fn:xX},{kind:Ze.Both,fn:wZ},{kind:Ze.Tmpl,fn:$K},{kind:Ze.Both,fn:uX},{kind:Ze.Both,fn:yZ},{kind:Ze.Tmpl,fn:hX},{kind:Ze.Tmpl,fn:AZ},{kind:Ze.Tmpl,fn:wX},{kind:Ze.Tmpl,fn:rZ},{kind:Ze.Tmpl,fn:_X},{kind:Ze.Tmpl,fn:YK},{kind:Ze.Tmpl,fn:nX},{kind:Ze.Tmpl,fn:iX},{kind:Ze.Tmpl,fn:MZ},{kind:Ze.Both,fn:PZ},{kind:Ze.Tmpl,fn:$X},{kind:Ze.Tmpl,fn:XX},{kind:Ze.Tmpl,fn:lQ},{kind:Ze.Both,fn:eX},{kind:Ze.Both,fn:KK},{kind:Ze.Tmpl,fn:gQ},{kind:Ze.Both,fn:tQ},{kind:Ze.Tmpl,fn:CX},{kind:Ze.Tmpl,fn:oQ},{kind:Ze.Tmpl,fn:pQ},{kind:Ze.Both,fn:ZK},{kind:Ze.Both,fn:nQ},{kind:Ze.Tmpl,fn:nZ},{kind:Ze.Both,fn:fZ},{kind:Ze.Both,fn:TX},{kind:Ze.Both,fn:hQ},{kind:Ze.Tmpl,fn:dQ},{kind:Ze.Tmpl,fn:QK},{kind:Ze.Tmpl,fn:JK},{kind:Ze.Tmpl,fn:HX},{kind:Ze.Tmpl,fn:mQ},{kind:Ze.Tmpl,fn:QY},{kind:Ze.Tmpl,fn:ZX},{kind:Ze.Both,fn:gX},{kind:Ze.Tmpl,fn:XK},{kind:Ze.Both,fn:vQ},{kind:Ze.Tmpl,fn:qX},{kind:Ze.Both,fn:xQ},{kind:Ze.Both,fn:sZ},{kind:Ze.Tmpl,fn:bX},{kind:Ze.Tmpl,fn:dZ},{kind:Ze.Tmpl,fn:hZ},{kind:Ze.Tmpl,fn:AX},{kind:Ze.Tmpl,fn:pZ},{kind:Ze.Both,fn:NZ},{kind:Ze.Both,fn:WK},{kind:Ze.Both,fn:dX}];function MB(e,t){for(let i of TQ)(i.kind===t||i.kind===Ze.Both)&&i.fn(e)}function DQ(e,t){let i=kB(e.root);return IB(e.root,t),i}function IB(e,t){for(let i of e.job.units){if(i.parent!==e.xref)continue;IB(i,t);let r=kB(i);t.statements.push(r.toDeclStmt(r.name))}}function kB(e){if(e.fnName===null)throw new Error(`AssertionError: view ${e.xref} is unnamed`);let t=[];for(let a of e.create){if(a.kind!==I.Statement)throw new Error(`AssertionError: expected all create ops to have been compiled, but got ${I[a.kind]}`);t.push(a.statement)}let i=[];for(let a of e.update){if(a.kind!==I.Statement)throw new Error(`AssertionError: expected all update ops to have been compiled, but got ${I[a.kind]}`);i.push(a.statement)}let r=ox(1,t),n=ox(2,i);return Gs([new er("rf"),new er("ctx")],[...r,...n],void 0,void 0,e.fnName)}function ox(e,t){return t.length===0?[]:[Ag(new ci(ze.BitwiseAnd,et("rf"),L(e)),t)]}function MQ(e){if(e.root.fnName===null)throw new Error("AssertionError: host binding function is unnamed");let t=[];for(let a of e.root.create){if(a.kind!==I.Statement)throw new Error(`AssertionError: expected all create ops to have been compiled, but got ${I[a.kind]}`);t.push(a.statement)}let i=[];for(let a of e.root.update){if(a.kind!==I.Statement)throw new Error(`AssertionError: expected all update ops to have been compiled, but got ${I[a.kind]}`);i.push(a.statement)}if(t.length===0&&i.length===0)return null;let r=ox(1,t),n=ox(2,i);return Gs([new er("rf"),new er("ctx")],[...r,...n],void 0,void 0,e.root.fnName)}var NB=uo.TemplateDefinitionBuilder,su=new Dm,lu="ng-template";function IQ(e,t,i,r,n,a,o){let s=new fg(e,i,NB,r,n,a,o);return Yc(s.root,t),s}function kQ(e,t,i){let r=new Qb(e.componentName,i,NB);for(let n of e.properties??[]){let a=dt.Property;n.name.startsWith("attr.")&&(n.name=n.name.substring(5),a=dt.Attribute),n.isAnimation&&(a=dt.Animation);let o=t.calcPossibleSecurityContexts(e.componentSelector,n.name,a===dt.Attribute).filter(s=>s!==gi.NONE);NQ(r,n,a,o)}for(let[n,a]of Object.entries(e.attributes)??[]){let o=t.calcPossibleSecurityContexts(e.componentSelector,n,!0).filter(s=>s!==gi.NONE);PQ(r,n,a,o)}for(let n of e.events??[])RQ(r,n);return r}function NQ(e,t,i,r){let n,a=t.expression.ast;a instanceof zr?n=new Ur(a.strings,a.expressions.map(o=>Zt(o,e,t.sourceSpan)),[]):n=Zt(a,e,t.sourceSpan),e.root.update.push(Du(e.root.xref,i,t.name,n,null,r,!1,!1,null,null,t.sourceSpan))}function PQ(e,t,i,r){let n=Du(e.root.xref,dt.Attribute,t,i,null,r,!0,!1,null,null,i.sourceSpan);e.root.update.push(n)}function RQ(e,t){let[i,r]=t.type!==1?[null,t.targetOrPhase]:[t.targetOrPhase,null],n=vS(e.root.xref,new ho,t.name,null,yS(e.root,t.handler,t.handlerSpan),i,r,!0,t.sourceSpan);e.root.create.push(n)}function Yc(e,t){for(let i of t)if(i instanceof pa)FQ(e,i);else if(i instanceof La)OQ(e,i);else if(i instanceof Ab)LQ(e,i);else if(i instanceof Dl)PB(e,i,null);else if(i instanceof fu)RB(e,i,null);else if(i instanceof Eb)BQ(e,i);else if(i instanceof Cb)VQ(e,i);else if(i instanceof gu)zQ(e,i);else if(i instanceof ig)UQ(e,i);else if(i instanceof fm)HQ(e,i);else throw new Error(`Unsupported template node: ${i.constructor.name}`)}function FQ(e,t){if(t.i18n!==void 0&&!(t.i18n instanceof jn||t.i18n instanceof zc))throw Error(`Unhandled i18n metadata type for element: ${t.i18n.constructor.name}`);let i=e.job.allocateXrefId(),[r,n]=ua(t.name),a=z$(n,i,hB(r),t.i18n instanceof zc?t.i18n:void 0,t.startSourceSpan,t.sourceSpan);e.create.push(a),jQ(e,a,t),LB(a,t);let o=null;t.i18n instanceof jn&&(o=e.job.allocateXrefId(),e.create.push(Ex(o,t.i18n,void 0,t.startSourceSpan))),Yc(e,t.children);let s=H$(i,t.endSourceSpan??t.startSourceSpan);e.create.push(s),o!==null&&ve.insertBefore(Sx(o,t.endSourceSpan??t.startSourceSpan),s)}function OQ(e,t){if(t.i18n!==void 0&&!(t.i18n instanceof jn||t.i18n instanceof zc))throw Error(`Unhandled i18n metadata type for template: ${t.i18n.constructor.name}`);let i=e.job.allocateView(e.xref),r=t.tagName,n="";t.tagName&&([n,r]=ua(t.tagName));let a=t.i18n instanceof zc?t.i18n:void 0,o=hB(n),s=r===null?"":fX(r,o),l=GQ(t)?oo.NgTemplate:oo.Structural,c=Cx(i.xref,l,r,s,o,a,t.startSourceSpan,t.sourceSpan);e.create.push(c),WQ(e,c,t,l),LB(c,t),Yc(i,t.children);for(let{name:d,value:u}of t.variables)i.contextVariables.set(d,u!==""?u:"$implicit");if(l===oo.NgTemplate&&t.i18n instanceof jn){let d=e.job.allocateXrefId();ve.insertAfter(Ex(d,t.i18n,void 0,t.startSourceSpan),i.create.head),ve.insertBefore(Sx(d,t.endSourceSpan??t.startSourceSpan),i.create.tail)}}function LQ(e,t){if(t.i18n!==void 0&&!(t.i18n instanceof zc))throw Error(`Unhandled i18n metadata type for element: ${t.i18n.constructor.name}`);let i=$$(e.job.allocateXrefId(),t.selector,t.i18n,t.sourceSpan);for(let r of t.attributes){let n=su.securityContext(t.name,r.name,!0);e.update.push(Du(i.xref,dt.Attribute,r.name,L(r.value),null,n,!0,!1,null,Tl(r.i18n),r.sourceSpan))}e.create.push(i)}function PB(e,t,i){e.create.push(sB(e.job.allocateXrefId(),t.value,i,t.sourceSpan))}function RB(e,t,i){let r=t.value;if(r instanceof Fa&&(r=r.ast),!(r instanceof zr))throw new Error(`AssertionError: expected Interpolation for BoundText node, got ${r.constructor.name}`);if(t.i18n!==void 0&&!(t.i18n instanceof Bs))throw Error(`Unhandled i18n metadata type for text interpolation: ${t.i18n?.constructor.name}`);let n=t.i18n instanceof Bs?t.i18n.children.filter(s=>s instanceof rg).map(s=>s.name):[];if(n.length>0&&n.length!==r.expressions.length)throw Error(`Unexpected number of i18n placeholders (${r.expressions.length}) for BoundText with ${r.expressions.length} expressions`);let a=e.job.allocateXrefId();e.create.push(sB(a,"",i,t.sourceSpan));let o=e.job.compatibility?null:t.sourceSpan;e.update.push(T$(a,new Ur(r.strings,r.expressions.map(s=>Zt(s,e.job,o)),n),t.sourceSpan))}function BQ(e,t){let i=null,r=null,n=[];for(let o=0;o<t.branches.length;o++){let s=t.branches[o],l=e.job.allocateView(e.xref),c=null;o===0&&(c=I2(e,l.xref,s)),s.expressionAlias!==null&&l.contextVariables.set(s.expressionAlias.name,uB);let d;if(s.i18n!==void 0){if(!(s.i18n instanceof Rl))throw Error(`Unhandled i18n metadata type for if block: ${s.i18n?.constructor.name}`);d=s.i18n}let u=Cx(l.xref,oo.Block,c,"Conditional",Gn.HTML,d,s.startSourceSpan,s.sourceSpan);e.create.push(u),i===null&&(i=l.xref,r=u.handle);let h=s.expression?Zt(s.expression,e.job,null):null,m=new Xb(h,u.xref,u.handle,s.expressionAlias);n.push(m),Yc(l,s.children)}let a=nB(i,r,null,n,t.sourceSpan);e.update.push(a)}function VQ(e,t){if(t.cases.length===0)return;let i=null,r=null,n=[];for(let o of t.cases){let s=e.job.allocateView(e.xref),l;if(o.i18n!==void 0){if(!(o.i18n instanceof Rl))throw Error(`Unhandled i18n metadata type for switch block: ${o.i18n?.constructor.name}`);l=o.i18n}let c=Cx(s.xref,oo.Block,null,"Case",Gn.HTML,l,o.startSourceSpan,o.sourceSpan);e.create.push(c),i===null&&(i=s.xref,r=c.handle);let d=o.expression?Zt(o.expression,e.job,t.startSourceSpan):null,u=new Xb(d,c.xref,c.handle);n.push(u),Yc(s,o.children)}let a=nB(i,r,Zt(t.expression,e.job,null),n,t.sourceSpan);e.update.push(a)}function Z_(e,t,i,r,n){if(i!==void 0&&!(i instanceof Rl))throw Error("Unhandled i18n metadata type for defer block");if(r===void 0)return null;let a=e.job.allocateView(e.xref);Yc(a,r);let o=Cx(a.xref,oo.Block,null,`Defer${t}`,Gn.HTML,i,n,n);return e.create.push(o),o}function zQ(e,t){let i=e.job.deferBlocksMeta.get(t);if(i===void 0)throw new Error("AssertionError: unable to find metadata for deferred block");let r=Z_(e,"",t.i18n,t.children,t.sourceSpan),n=Z_(e,"Loading",t.loading?.i18n,t.loading?.children,t.loading?.sourceSpan),a=Z_(e,"Placeholder",t.placeholder?.i18n,t.placeholder?.children,t.placeholder?.sourceSpan),o=Z_(e,"Error",t.error?.i18n,t.error?.children,t.error?.sourceSpan),s=e.job.allocateXrefId(),l=X$(s,r.xref,r.handle,i,e.job.allDeferrableDepsFn,t.sourceSpan);l.placeholderView=a?.xref??null,l.placeholderSlot=a?.handle??null,l.loadingSlot=n?.handle??null,l.errorSlot=o?.handle??null,l.placeholderMinimumTime=t.placeholder?.minimumTime??null,l.loadingMinimumTime=t.loading?.minimumTime??null,l.loadingAfterTime=t.loading?.afterTime??null,e.create.push(l);let c=!1,d=[],u=[];for(let h of[t.triggers,t.prefetchTriggers]){if(h.idle!==void 0){let m=Zd(s,{kind:ur.Idle},c,h.idle.sourceSpan);d.push(m)}if(h.immediate!==void 0){let m=Zd(s,{kind:ur.Immediate},c,h.immediate.sourceSpan);d.push(m)}if(h.timer!==void 0){let m=Zd(s,{kind:ur.Timer,delay:h.timer.delay},c,h.timer.sourceSpan);d.push(m)}if(h.hover!==void 0){let m=Zd(s,{kind:ur.Hover,targetName:h.hover.reference,targetXref:null,targetSlot:null,targetView:null,targetSlotViewSteps:null},c,h.hover.sourceSpan);d.push(m)}if(h.interaction!==void 0){let m=Zd(s,{kind:ur.Interaction,targetName:h.interaction.reference,targetXref:null,targetSlot:null,targetView:null,targetSlotViewSteps:null},c,h.interaction.sourceSpan);d.push(m)}if(h.viewport!==void 0){let m=Zd(s,{kind:ur.Viewport,targetName:h.viewport.reference,targetXref:null,targetSlot:null,targetView:null,targetSlotViewSteps:null},c,h.viewport.sourceSpan);d.push(m)}if(h.when!==void 0){if(h.when.value instanceof zr)throw new Error("Unexpected interpolation in defer block when trigger");let m=L$(s,Zt(h.when.value,e.job,h.when.sourceSpan),c,h.when.sourceSpan);u.push(m)}d.length===0&&u.length===0&&d.push(Zd(s,{kind:ur.Idle},!1,null)),c=!0}e.create.push(d),e.update.push(u)}function UQ(e,t){if(t.i18n instanceof jn&&Ff(t.i18n)){let i=e.job.allocateXrefId();e.create.push(Z$(i,t.i18n,oS(t.i18n).name,null));for(let[r,n]of Object.entries(Z(Z({},t.vars),t.placeholders)))n instanceof fu?RB(e,n,r):PB(e,n,r);e.create.push(K$(i))}else throw Error(`Unhandled i18n metadata type for ICU: ${t.i18n?.constructor.name}`)}function HQ(e,t){let i=e.job.allocateView(e.xref);i.contextVariables.set(t.item.name,t.item.value),i.contextVariables.set(t.contextVariables.$index.name,t.contextVariables.$index.value),i.contextVariables.set(t.contextVariables.$count.name,t.contextVariables.$count.value);let r=`\u0275${t.contextVariables.$index.name}_${i.xref}`,n=`\u0275${t.contextVariables.$count.name}_${i.xref}`;i.contextVariables.set(r,t.contextVariables.$index.value),i.contextVariables.set(n,t.contextVariables.$count.value),i.aliases.add({kind:gn.Alias,name:null,identifier:t.contextVariables.$first.name,expression:new Oa(r).identical(L(0))}),i.aliases.add({kind:gn.Alias,name:null,identifier:t.contextVariables.$last.name,expression:new Oa(r).identical(new Oa(n).minus(L(1)))}),i.aliases.add({kind:gn.Alias,name:null,identifier:t.contextVariables.$even.name,expression:new Oa(r).modulo(L(2)).identical(L(0))}),i.aliases.add({kind:gn.Alias,name:null,identifier:t.contextVariables.$odd.name,expression:new Oa(r).modulo(L(2)).notIdentical(L(0))});let a=En(t.trackBy.span,t.sourceSpan),o=Zt(t.trackBy,e.job,a);Yc(i,t.children);let s=null,l=null;t.empty!==null&&(s=e.job.allocateView(e.xref),Yc(s,t.empty.children),l=I2(e,s.xref,t.empty));let c={$index:t.contextVariables.$index.name,$count:t.contextVariables.$count.name,$first:t.contextVariables.$first.name,$last:t.contextVariables.$last.name,$even:t.contextVariables.$even.name,$odd:t.contextVariables.$odd.name,$implicit:t.item.name};if(t.i18n!==void 0&&!(t.i18n instanceof Rl))throw Error("AssertionError: Unhandled i18n metadata type or @for");if(t.empty?.i18n!==void 0&&!(t.empty.i18n instanceof Rl))throw Error("AssertionError: Unhandled i18n metadata type or @empty");let d=t.i18n,u=t.empty?.i18n,h=I2(e,i.xref,t),m=U$(i.xref,s?.xref??null,h,o,c,l,d,u,t.startSourceSpan,t.sourceSpan);e.create.push(m);let f=Zt(t.expression,e.job,En(t.expression.span,t.sourceSpan)),p=O$(m.xref,m.handle,f,t.sourceSpan);e.update.push(p)}function Zt(e,t,i){if(e instanceof Fa)return Zt(e.ast,t,i);if(e instanceof fn){let r=e.receiver instanceof Bc,n=e.receiver instanceof Hn&&!(e.receiver instanceof Bc),a=e.name==="$any"||e.name==="$event";return n||r&&!a?new Oa(e.name):new ma(Zt(e.receiver,t,i),e.name,null,En(e.span,i))}else{if(e instanceof _m)return e.receiver instanceof Hn?new um(new Ll(t.root.xref),e.name,Zt(e.value,t,i),null,En(e.span,i)):new um(Zt(e.receiver,t,i),e.name,Zt(e.value,t,i),void 0,En(e.span,i));if(e instanceof xm)return new jf(Zt(e.receiver,t,i),Zt(e.key,t,i),Zt(e.value,t,i),void 0,En(e.span,i));if(e instanceof js){if(e.receiver instanceof Hn)throw new Error("Unexpected ImplicitReceiver");return new ha(Zt(e.receiver,t,i),e.args.map(r=>Zt(r,t,i)),void 0,En(e.span,i))}else{if(e instanceof Un)return L(e.value,void 0,En(e.span,i));if(e instanceof Ol)switch(e.operator){case"+":return new hu(cu.Plus,Zt(e.expr,t,i),void 0,En(e.span,i));case"-":return new hu(cu.Minus,Zt(e.expr,t,i),void 0,En(e.span,i));default:throw new Error(`AssertionError: unknown unary operator ${e.operator}`)}else if(e instanceof Na){let r=mX.get(e.operation);if(r===void 0)throw new Error(`AssertionError: unknown binary operator ${e.operation}`);return new ci(r,Zt(e.left,t,i),Zt(e.right,t,i),void 0,En(e.span,i))}else{if(e instanceof Bc)return new Ll(t.root.xref);if(e instanceof Fl)return new Hs(Zt(e.receiver,t,i),Zt(e.key,t,i),void 0,En(e.span,i));if(e instanceof Hc)throw new Error("AssertionError: Chain in unknown context");if(e instanceof ym){let r=e.keys.map((n,a)=>{let o=e.values[a];return new hm(n.key,Zt(o,t,i),n.quoted)});return new fs(r,void 0,En(e.span,i))}else{if(e instanceof Cu)return new Go(e.expressions.map(r=>Zt(r,t,i)));if(e instanceof xu)return new co(Zt(e.condition,t,i),Zt(e.trueExp,t,i),Zt(e.falseExp,t,i),void 0,En(e.span,i));if(e instanceof Su)return Zt(e.expression,t,i);if(e instanceof wu)return new Iu(t.allocateXrefId(),new ho,e.name,[Zt(e.exp,t,i),...e.args.map(r=>Zt(r,t,i))]);if(e instanceof yu)return new Em(Zt(e.receiver,t,i),Zt(e.key,t,i),En(e.span,i));if(e instanceof bm)return new Cm(Zt(e.receiver,t,i),e.name);if(e instanceof Au)return new jc(Zt(e.receiver,t,i),e.args.map(r=>Zt(r,t,i)));if(e instanceof zn)return new mg(En(e.span,i));if(e instanceof Eu)return bL(Zt(e.expression,t,i),En(e.span,i));throw new Error(`Unhandled expression type "${e.constructor.name}" in file "${i?.start.file.url}"`)}}}}}function M2(e,t,i,r){let n;return t instanceof zr?n=new Ur(t.strings,t.expressions.map(a=>Zt(a,e,r??null)),Object.keys(Tl(i)?.placeholders??{})):t instanceof Or?n=Zt(t,e,r??null):n=L(t),n}var FB=new Map([[0,dt.Property],[5,dt.TwoWayProperty],[1,dt.Attribute],[2,dt.ClassName],[3,dt.StyleProperty],[4,dt.Animation]]);function GQ(e){return ua(e.tagName??"")[1]===lu}function Tl(e){if(e==null)return null;if(!(e instanceof jn))throw Error(`Expected i18n meta to be a Message, but got: ${e.constructor.name}`);return e}function jQ(e,t,i){let r=new Array,n=new Set;for(let a of i.attributes){let o=su.securityContext(i.name,a.name,!0);r.push(Du(t.xref,dt.Attribute,a.name,M2(e.job,a.value,a.i18n),null,o,!0,!1,null,Tl(a.i18n),a.sourceSpan)),a.i18n&&n.add(a.name)}for(let a of i.inputs)n.has(a.name)&&console.error(`On component ${e.job.componentName}, the binding ${a.name} is both an i18n attribute and a property. You may want to remove the property binding. This will become a compilation error in future versions of Angular.`),r.push(Du(t.xref,FB.get(a.type),a.name,M2(e.job,xg(a.value),a.i18n),a.unit,a.securityContext,!1,!1,null,Tl(a.i18n)??null,a.sourceSpan));e.create.push(r.filter(a=>a?.kind===I.ExtractedAttribute)),e.update.push(r.filter(a=>a?.kind===I.Binding));for(let a of i.outputs){if(a.type===1&&a.phase===null)throw Error("Animation listener should have a phase");a.type===2?e.create.push(lB(t.xref,t.handle,a.name,t.tag,OB(e,a.handler,a.handlerSpan),a.sourceSpan)):e.create.push(vS(t.xref,t.handle,a.name,t.tag,yS(e,a.handler,a.handlerSpan),a.phase,a.target,!1,a.sourceSpan))}r.some(a=>a?.i18nMessage)!==null&&e.create.push(dB(e.job.allocateXrefId(),new ho,t.xref))}function WQ(e,t,i,r){let n=new Array;for(let a of i.templateAttrs)if(a instanceof pm){let o=su.securityContext(lu,a.name,!0);n.push(K_(e,t.xref,1,a.name,a.value,null,o,!0,r,Tl(a.i18n),a.sourceSpan))}else n.push(K_(e,t.xref,a.type,a.name,xg(a.value),a.unit,a.securityContext,!0,r,Tl(a.i18n),a.sourceSpan));for(let a of i.attributes){let o=su.securityContext(lu,a.name,!0);n.push(K_(e,t.xref,1,a.name,a.value,null,o,!1,r,Tl(a.i18n),a.sourceSpan))}for(let a of i.inputs)n.push(K_(e,t.xref,a.type,a.name,xg(a.value),a.unit,a.securityContext,!1,r,Tl(a.i18n),a.sourceSpan));e.create.push(n.filter(a=>a?.kind===I.ExtractedAttribute)),e.update.push(n.filter(a=>a?.kind===I.Binding));for(let a of i.outputs){if(a.type===1&&a.phase===null)throw Error("Animation listener should have a phase");if(r===oo.NgTemplate&&(a.type===2?e.create.push(lB(t.xref,t.handle,a.name,t.tag,OB(e,a.handler,a.handlerSpan),a.sourceSpan)):e.create.push(vS(t.xref,t.handle,a.name,t.tag,yS(e,a.handler,a.handlerSpan),a.phase,a.target,!1,a.sourceSpan))),r===oo.Structural&&a.type!==1){let o=su.securityContext(lu,a.name,!1);e.create.push(zo(t.xref,dt.Property,null,a.name,null,null,null,o))}}n.some(a=>a?.i18nMessage)!==null&&e.create.push(dB(e.job.allocateXrefId(),new ho,t.xref))}function K_(e,t,i,r,n,a,o,s,l,c,d){let u=typeof n=="string";if(l===oo.Structural){if(!s)switch(i){case 0:case 2:case 3:return zo(t,dt.Property,null,r,null,null,c,o);case 5:return zo(t,dt.TwoWayProperty,null,r,null,null,c,o)}if(!u&&(i===1||i===4))return null}let h=FB.get(i);return l===oo.NgTemplate&&(i===2||i===3||i===1&&!u)&&(h=dt.Property),Du(t,h,r,M2(e.job,n,c),a,o,u,s,l,c,d)}function yS(e,t,i){t=xg(t);let r=new Array,n=t instanceof Hc?t.expressions:[t];if(n.length===0)throw new Error("Expected listener to have non-empty expression list.");let a=n.map(s=>Zt(s,e.job,i)),o=a.pop();return r.push(...a.map(s=>Ws(new bn(s,s.sourceSpan)))),r.push(Ws(new Jr(o,o.sourceSpan))),r}function OB(e,t,i){t=xg(t);let r=new Array;if(t instanceof Hc)if(t.expressions.length===1)t=t.expressions[0];else throw new Error("Expected two-way listener to have a single expression.");let n=Zt(t,e.job,i),a=new Oa("$event"),o=new Wb(n,a);return r.push(Ws(new bn(o))),r.push(Ws(new Jr(a))),r}function xg(e){return e instanceof Fa?e.ast:e}function LB(e,t){qQ(e.localRefs);for(let{name:i,value:r}of t.references)e.localRefs.push({name:i,target:r})}function qQ(e){if(!Array.isArray(e))throw new Error("AssertionError: expected an array")}function En(e,t){if(t===null)return null;let i=t.start.moveBy(e.start),r=t.start.moveBy(e.end),n=t.fullStart.moveBy(e.start);return new Qt(i,r,n)}function I2(e,t,i){let r=null;for(let n of i.children)if(!(n instanceof mm)){if(r!==null)return null;(n instanceof pa||n instanceof La&&n.tagName!==null)&&(r=n)}if(r!==null){for(let a of r.attributes){let o=su.securityContext(lu,a.name,!0);e.update.push(Du(t,dt.Attribute,a.name,L(a.value),null,o,!0,!1,null,Tl(a.i18n),a.sourceSpan))}for(let a of r.inputs)if(a.type!==4&&a.type!==1){let o=su.securityContext(lu,a.name,!0);e.create.push(zo(t,dt.Property,null,a.name,null,null,null,o))}let n=r instanceof pa?r.name:r.tagName;return n===lu?null:n}return null}var BB=!1,k2=class extends y2{constructor(){super(gB)}parse(t,i,r){return super.parse(t,i,r)}},VB="ngPreserveWhitespaces",$Q=new Set(["pre","template","textarea","script","style"]),zB=` \f
\r	\v\u1680\u180E\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF`,XQ=new RegExp(`[^${zB}]`),YQ=new RegExp(`[${zB}]{2,}`,"g");function ZQ(e){return e.some(t=>t.name===VB)}function UB(e){return e.replace(new RegExp(vB,"g")," ")}var N2=class{visitElement(t,i){return $Q.has(t.name)||ZQ(t.attrs)?new Bo(t.name,Ar(this,t.attrs),t.children,t.sourceSpan,t.startSourceSpan,t.endSourceSpan,t.i18n):new Bo(t.name,t.attrs,R3(this,t.children),t.sourceSpan,t.startSourceSpan,t.endSourceSpan,t.i18n)}visitAttribute(t,i){return t.name!==VB?t:null}visitText(t,i){let r=t.value.match(XQ),n=i&&(i.prev instanceof Tm||i.next instanceof Tm);if(r||n){let a=t.tokens.map(s=>s.type===5?KQ(s):s),o=HB(t.value);return new Xc(o,t.sourceSpan,a,t.i18n)}return null}visitComment(t,i){return t}visitExpansion(t,i){return t}visitExpansionCase(t,i){return t}visitBlock(t,i){return new Vo(t.name,t.parameters,R3(this,t.children),t.sourceSpan,t.nameSpan,t.startSourceSpan,t.endSourceSpan)}visitBlockParameter(t,i){return t}};function KQ({type:e,parts:t,sourceSpan:i}){return{type:e,parts:[HB(t[0])],sourceSpan:i}}function HB(e){return UB(e).replace(YQ," ")}function R3(e,t){let i=[];return t.forEach((r,n)=>{let a={prev:t[n-1],next:t[n+1]},o=r.visit(e,a);o&&i.push(o)}),i}var F3=".",QQ="attr",JQ="class",eJ="style",tJ="*",aE="animate-",P2=class{constructor(t,i,r,n){this._exprParser=t,this._interpolationConfig=i,this._schemaRegistry=r,this.errors=n}get interpolationConfig(){return this._interpolationConfig}createBoundHostProperties(t,i){let r=[];for(let n of Object.keys(t)){let a=t[n];typeof a=="string"?this.parsePropertyBinding(n,a,!0,!1,i,i.start.offset,void 0,[],r,i):this._reportError(`Value of the host property binding "${n}" needs to be a string representing an expression but got "${a}" (${typeof a})`,i)}return r}createDirectiveHostEventAsts(t,i){let r=[];for(let n of Object.keys(t)){let a=t[n];typeof a=="string"?this.parseEvent(n,a,!1,i,i,[],r,i):this._reportError(`Value of the host listener "${n}" needs to be a string representing an expression but got "${a}" (${typeof a})`,i)}return r}parseInterpolation(t,i,r){let n=i.start.toString(),a=i.fullStart.offset;try{let o=this._exprParser.parseInterpolation(t,n,a,r,this._interpolationConfig);return o&&this._reportExpressionParserErrors(o.errors,i),o}catch(o){return this._reportError(`${o}`,i),this._exprParser.wrapLiteralPrimitive("ERROR",n,a)}}parseInterpolationExpression(t,i){let r=i.start.toString(),n=i.start.offset;try{let a=this._exprParser.parseInterpolationExpression(t,r,n);return a&&this._reportExpressionParserErrors(a.errors,i),a}catch(a){return this._reportError(`${a}`,i),this._exprParser.wrapLiteralPrimitive("ERROR",r,n)}}parseInlineTemplateBinding(t,i,r,n,a,o,s,l){let c=r.start.offset+tJ.length,d=this._parseTemplateBindings(t,i,r,c,n);for(let u of d){let h=Mc(r,u.sourceSpan),m=u.key.source,f=Mc(r,u.key.span);if(u instanceof cg){let p=u.value?u.value.source:"$implicit",g=u.value?Mc(r,u.value.span):void 0;s.push(new WE(m,p,h,f,g))}else if(u.value){let p=l?h:r,g=Mc(r,u.value.ast.sourceSpan);this._parsePropertyAst(m,u.value,!1,p,f,g,a,o)}else a.push([m,""]),this.parseLiteralAttr(m,null,f,n,void 0,a,o,f)}}_parseTemplateBindings(t,i,r,n,a){let o=r.start.toString();try{let s=this._exprParser.parseTemplateBindings(t,i,o,n,a);return this._reportExpressionParserErrors(s.errors,r),s.warnings.forEach(l=>{this._reportError(l,r,Oc.WARNING)}),s.templateBindings}catch(s){return this._reportError(`${s}`,r),[]}}parseLiteralAttr(t,i,r,n,a,o,s,l){oE(t)?(t=t.substring(1),l!==void 0&&(l=Mc(l,new ao(l.start.offset+1,l.end.offset))),i&&this._reportError('Assigning animation triggers via @prop="exp" attributes with an expression is invalid. Use property bindings (e.g. [@prop]="exp") or use an attribute without a value (e.g. @prop) instead.',r,Oc.ERROR),this._parseAnimation(t,i,r,n,l,a,o,s)):s.push(new zf(t,this._exprParser.wrapLiteralPrimitive(i,"",n),Fc.LITERAL_ATTR,r,l,a))}parsePropertyBinding(t,i,r,n,a,o,s,l,c,d){t.length===0&&this._reportError("Property name is missing in binding",a);let u=!1;t.startsWith(aE)?(u=!0,t=t.substring(aE.length),d!==void 0&&(d=Mc(d,new ao(d.start.offset+aE.length,d.end.offset)))):oE(t)&&(u=!0,t=t.substring(1),d!==void 0&&(d=Mc(d,new ao(d.start.offset+1,d.end.offset)))),u?this._parseAnimation(t,i,a,o,d,s,l,c):this._parsePropertyAst(t,this.parseBinding(i,r,s||a,o),n,a,d,s,l,c)}parsePropertyInterpolation(t,i,r,n,a,o,s,l){let c=this.parseInterpolation(i,n||r,l);return c?(this._parsePropertyAst(t,c,!1,r,s,n,a,o),!0):!1}_parsePropertyAst(t,i,r,n,a,o,s,l){s.push([t,i.source]),l.push(new zf(t,i,r?Fc.TWO_WAY:Fc.DEFAULT,n,a,o))}_parseAnimation(t,i,r,n,a,o,s,l){t.length===0&&this._reportError("Animation trigger is missing",r);let c=this.parseBinding(i||"undefined",!1,o||r,n);s.push([t,c.source]),l.push(new zf(t,c,Fc.ANIMATION,r,a,o))}parseBinding(t,i,r,n){let a=(r&&r.start||"(unknown)").toString();try{let o=i?this._exprParser.parseSimpleBinding(t,a,n,this._interpolationConfig):this._exprParser.parseBinding(t,a,n,this._interpolationConfig);return o&&this._reportExpressionParserErrors(o.errors,r),o}catch(o){return this._reportError(`${o}`,r),this._exprParser.wrapLiteralPrimitive("ERROR",a,n)}}createBoundElementProperty(t,i,r=!1,n=!0){if(i.isAnimation)return new Vb(i.name,4,gi.NONE,i.expression,null,i.sourceSpan,i.keySpan,i.valueSpan);let a=null,o,s=null,l=i.name.split(F3),c;if(l.length>1)if(l[0]==QQ){s=l.slice(1).join(F3),r||this._validatePropertyOrAttributeName(s,i.sourceSpan,!0),c=sE(this._schemaRegistry,t,s,!0);let d=s.indexOf(":");if(d>-1){let u=s.substring(0,d),h=s.substring(d+1);s=DE(u,h)}o=1}else l[0]==JQ?(s=l[1],o=2,c=[gi.NONE]):l[0]==eJ&&(a=l.length>2?l[2]:null,s=l[1],o=3,c=[gi.STYLE]);if(s===null){let d=this._schemaRegistry.getMappedPropName(i.name);s=n?d:i.name,c=sE(this._schemaRegistry,t,d,!1),o=i.type===Fc.TWO_WAY?5:0,r||this._validatePropertyOrAttributeName(d,i.sourceSpan,!1)}return new Vb(s,o,c[0],i.expression,a,i.sourceSpan,i.keySpan,i.valueSpan)}parseEvent(t,i,r,n,a,o,s,l){t.length===0&&this._reportError("Event name is missing in binding",n),oE(t)?(t=t.slice(1),l!==void 0&&(l=Mc(l,new ao(l.start.offset+1,l.end.offset))),this._parseAnimationEvent(t,i,n,a,s,l)):this._parseRegularEvent(t,i,r,n,a,o,s,l)}calcPossibleSecurityContexts(t,i,r){let n=this._schemaRegistry.getMappedPropName(i);return sE(this._schemaRegistry,t,n,r)}_parseAnimationEvent(t,i,r,n,a,o){let s=NW(t,[t,""]),l=s[0],c=s[1].toLowerCase(),d=this._parseAction(i,n);a.push(new Bb(l,c,1,d,r,n,o)),l.length===0&&this._reportError("Animation event name is missing in binding",r),c?c!=="start"&&c!=="done"&&this._reportError(`The provided animation output phase value "${c}" for "@${l}" is not supported (use start or done)`,r):this._reportError(`The animation trigger output event (@${l}) is missing its phase value name (start or done are currently supported)`,r)}_parseRegularEvent(t,i,r,n,a,o,s,l){let[c,d]=kW(t,[null,t]),u=this.errors.length,h=this._parseAction(i,a),m=this.errors.length===u;o.push([t,h.source]),r&&m&&!this._isAllowedAssignmentEvent(h)&&this._reportError("Unsupported expression in a two-way binding",n),s.push(new Bb(d,c,r?2:0,h,n,a,l))}_parseAction(t,i){let r=(i&&i.start||"(unknown").toString(),n=i&&i.start?i.start.offset:0;try{let a=this._exprParser.parseAction(t,r,n,this._interpolationConfig);return a&&this._reportExpressionParserErrors(a.errors,i),!a||a.ast instanceof zn?(this._reportError("Empty expressions are not allowed",i),this._exprParser.wrapLiteralPrimitive("ERROR",r,n)):a}catch(a){return this._reportError(`${a}`,i),this._exprParser.wrapLiteralPrimitive("ERROR",r,n)}}_reportError(t,i,r=Oc.ERROR){this.errors.push(new $t(i,t,r))}_reportExpressionParserErrors(t,i){for(let r of t)this._reportError(r.message,i)}_validatePropertyOrAttributeName(t,i,r){let n=r?this._schemaRegistry.validateAttribute(t):this._schemaRegistry.validateProperty(t);n.error&&this._reportError(n.msg,i,Oc.ERROR)}_isAllowedAssignmentEvent(t){return t instanceof Fa?this._isAllowedAssignmentEvent(t.ast):t instanceof Su?this._isAllowedAssignmentEvent(t.expression):t instanceof fn||t instanceof Fl?!0:t instanceof Na?(t.operation==="&&"||t.operation==="||"||t.operation==="??")&&(t.right instanceof fn||t.right instanceof Fl):t instanceof xu||t instanceof Eu}};function oE(e){return e[0]=="@"}function sE(e,t,i,r){let n=[];return cm.parse(t).forEach(a=>{let o=a.element?[a.element]:e.allKnownElementNames(),s=new Set(a.notSelectors.filter(c=>c.isElementSelector()).map(c=>c.element)),l=o.filter(c=>!s.has(c));n.push(...l.map(c=>e.securityContext(c,i,r)))}),n.length===0?[gi.NONE]:Array.from(new Set(n)).sort()}function Mc(e,t){let i=t.start-e.start.offset,r=t.end-e.end.offset;return new Qt(e.start.moveBy(i),e.end.moveBy(r),e.fullStart.moveBy(i),e.details)}function iJ(e){if(e==null||e.length===0||e[0]=="/")return!1;let t=e.match(rJ);return t===null||t[1]=="package"||t[1]=="asset"}var rJ=/^([^:/?#]+):/,nJ="select",aJ="link",oJ="rel",sJ="href",lJ="stylesheet",cJ="style",dJ="script",uJ="ngNonBindable",hJ="ngProjectAs";function GB(e){let t=null,i=null,r=null,n=!1,a="";e.attrs.forEach(l=>{let c=l.name.toLowerCase();c==nJ?t=l.value:c==sJ?i=l.value:c==oJ?r=l.value:l.name==uJ?n=!0:l.name==hJ&&l.value.length>0&&(a=l.value)}),t=mJ(t);let o=e.name.toLowerCase(),s=no.OTHER;return AE(o)?s=no.NG_CONTENT:o==cJ?s=no.STYLE:o==dJ?s=no.SCRIPT:o==aJ&&r==lJ&&(s=no.STYLESHEET),new R2(s,t,i,n,a)}var no=function(e){return e[e.NG_CONTENT=0]="NG_CONTENT",e[e.STYLE=1]="STYLE",e[e.STYLESHEET=2]="STYLESHEET",e[e.SCRIPT=3]="SCRIPT",e[e.OTHER=4]="OTHER",e}(no||{}),R2=class{constructor(t,i,r,n,a){this.type=t,this.selectAttr=i,this.hrefAttr=r,this.nonBindable=n,this.projectAs=a}};function mJ(e){return e===null||e.length===0?"*":e}var pJ=/^\s*([0-9A-Za-z_$]*)\s+of\s+([\S\s]*)/,fJ=/^track\s+([\S\s]*)/,gJ=/^(as\s)+(.*)/,wS=/^else[^\S\r\n]+if/,vJ=/^let\s+([\S\s]*)/,O3=/(\s*)(\S+)(\s*)/,F2=new Set(["$index","$first","$last","$even","$odd","$count"]);function L3(e){return e==="empty"}function B3(e){return e==="else"||wS.test(e)}function _J(e,t,i,r){let n=CJ(t),a=[],o=V3(e,n,r);o!==null&&a.push(new au(o.expression,Ar(i,e.children,e.children),o.expressionAlias,e.sourceSpan,e.startSourceSpan,e.endSourceSpan,e.nameSpan,e.i18n));for(let u of t)if(wS.test(u.name)){let h=V3(u,n,r);if(h!==null){let m=Ar(i,u.children,u.children);a.push(new au(h.expression,m,h.expressionAlias,u.sourceSpan,u.startSourceSpan,u.endSourceSpan,u.nameSpan,u.i18n))}}else if(u.name==="else"){let h=Ar(i,u.children,u.children);a.push(new au(null,h,null,u.sourceSpan,u.startSourceSpan,u.endSourceSpan,u.nameSpan,u.i18n))}let s=a.length>0?a[0].startSourceSpan:e.startSourceSpan,l=a.length>0?a[a.length-1].endSourceSpan:e.endSourceSpan,c=e.sourceSpan,d=a[a.length-1];return d!==void 0&&(c=new Qt(s.start,d.sourceSpan.end)),{node:new Eb(a,c,e.startSourceSpan,l,e.nameSpan),errors:n}}function bJ(e,t,i,r){let n=[],a=yJ(e,n,r),o=null,s=null;for(let l of t)l.name==="empty"?s!==null?n.push(new $t(l.sourceSpan,"@for loop can only have one @empty block")):l.parameters.length>0?n.push(new $t(l.sourceSpan,"@empty block cannot have parameters")):s=new eg(Ar(i,l.children,l.children),l.sourceSpan,l.startSourceSpan,l.endSourceSpan,l.nameSpan,l.i18n):n.push(new $t(l.sourceSpan,`Unrecognized @for loop block "${l.name}"`));if(a!==null)if(a.trackBy===null)n.push(new $t(e.sourceSpan,'@for loop must have a "track" expression'));else{let l=s?.endSourceSpan??e.endSourceSpan,c=new Qt(e.sourceSpan.start,l?.end??e.sourceSpan.end);o=new fm(a.itemName,a.expression,a.trackBy.expression,a.trackBy.keywordSpan,a.context,Ar(i,e.children,e.children),s,c,e.sourceSpan,e.startSourceSpan,l,e.nameSpan,e.i18n)}return{node:o,errors:n}}function xJ(e,t,i){let r=EJ(e),n=e.parameters.length>0?yg(e.parameters[0],i):i.parseBinding("",!1,e.sourceSpan,0),a=[],o=[],s=null;for(let l of e.children){if(!(l instanceof Vo))continue;if((l.name!=="case"||l.parameters.length===0)&&l.name!=="default"){o.push(new Sb(l.name,l.sourceSpan,l.nameSpan));continue}let c=l.name==="case"?yg(l.parameters[0],i):null,d=new Jf(c,Ar(t,l.children,l.children),l.sourceSpan,l.startSourceSpan,l.endSourceSpan,l.nameSpan,l.i18n);c===null?s=d:a.push(d)}return s!==null&&a.push(s),{node:new Cb(n,a,o,e.sourceSpan,e.startSourceSpan,e.endSourceSpan,e.nameSpan),errors:r}}function yJ(e,t,i){if(e.parameters.length===0)return t.push(new $t(e.sourceSpan,"@for loop does not have an expression")),null;let[r,...n]=e.parameters,a=SJ(r,t)?.match(pJ);if(!a||a[2].trim().length===0)return t.push(new $t(r.sourceSpan,'Cannot parse expression. @for loop expression must match the pattern "<identifier> of <expression>"')),null;let[,o,s]=a,l=r.expression.split(" ")[0],c=new Qt(r.sourceSpan.start,r.sourceSpan.start.moveBy(l.length)),d={itemName:new Pl(o,"$implicit",c,c),trackBy:null,expression:yg(r,i,s),context:{}};for(let u of n){let h=u.expression.match(vJ);if(h!==null){let f=new Qt(u.sourceSpan.start.moveBy(h[0].length-h[1].length),u.sourceSpan.end);wJ(u.sourceSpan,h[1],f,d.context,t);continue}let m=u.expression.match(fJ);if(m!==null){if(d.trackBy!==null)t.push(new $t(u.sourceSpan,'@for loop can only have one "track" expression'));else{let f=yg(u,i,m[1]);f.ast instanceof zn&&t.push(new $t(u.sourceSpan,'@for loop must have a "track" expression'));let p=new Qt(u.sourceSpan.start,u.sourceSpan.start.moveBy(5));d.trackBy={expression:f,keywordSpan:p}}continue}t.push(new $t(u.sourceSpan,`Unrecognized @for loop paramater "${u.expression}"`))}for(let u of F2)if(!d.context.hasOwnProperty(u)){let h=new Qt(e.startSourceSpan.end,e.startSourceSpan.end);d.context[u]=new Pl(u,u,h,h)}return d}function wJ(e,t,i,r,n){let a=t.split(","),o=i.start;for(let s of a){let l=s.split("="),c=l.length===2?l[0].trim():"",d=l.length===2?l[1].trim():"";if(c.length===0||d.length===0)n.push(new $t(e,'Invalid @for loop "let" parameter. Parameter should match the pattern "<name> = <variable name>"'));else if(!F2.has(d))n.push(new $t(e,`Unknown "let" parameter variable "${d}". The allowed variables are: ${Array.from(F2).join(", ")}`));else if(r.hasOwnProperty(d))n.push(new $t(e,`Duplicate "let" parameter variable "${d}"`));else{let[,u,h]=l[0].match(O3)??[],m=u!==void 0&&l.length===2?new Qt(o.moveBy(u.length),o.moveBy(u.length+h.length)):i,f;if(l.length===2){let[,g,v]=l[1].match(O3)??[];f=g!==void 0?new Qt(o.moveBy(l[0].length+1+g.length),o.moveBy(l[0].length+1+g.length+v.length)):void 0}let p=new Qt(m.start,f?.end??m.end);r[d]=new Pl(c,d,p,m,f)}o=o.moveBy(s.length+1)}}function CJ(e){let t=[],i=!1;for(let r=0;r<e.length;r++){let n=e[r];n.name==="else"?(i?t.push(new $t(n.sourceSpan,"Conditional can only have one @else block")):e.length>1&&r<e.length-1?t.push(new $t(n.sourceSpan,"@else block must be last inside the conditional")):n.parameters.length>0&&t.push(new $t(n.sourceSpan,"@else block cannot have parameters")),i=!0):wS.test(n.name)||t.push(new $t(n.sourceSpan,`Unrecognized conditional block @${n.name}`))}return t}function EJ(e){let t=[],i=!1;if(e.parameters.length!==1)return t.push(new $t(e.sourceSpan,"@switch block must have exactly one parameter")),t;for(let r of e.children)if(!(r instanceof _g||r instanceof Xc&&r.value.trim().length===0)){if(!(r instanceof Vo)||r.name!=="case"&&r.name!=="default"){t.push(new $t(r.sourceSpan,"@switch block can only contain @case and @default blocks"));continue}r.name==="default"?(i?t.push(new $t(r.sourceSpan,"@switch block can only have one @default block")):r.parameters.length>0&&t.push(new $t(r.sourceSpan,"@default block cannot have parameters")),i=!0):r.name==="case"&&r.parameters.length!==1&&t.push(new $t(r.sourceSpan,"@case block must have exactly one parameter"))}return t}function yg(e,t,i){let r,n;return typeof i=="string"?(r=Math.max(0,e.expression.lastIndexOf(i)),n=r+i.length):(r=0,n=e.expression.length),t.parseBinding(e.expression.slice(r,n),!1,e.sourceSpan,e.sourceSpan.start.offset+r)}function V3(e,t,i){if(e.parameters.length===0)return t.push(new $t(e.sourceSpan,"Conditional block does not have an expression")),null;let r=yg(e.parameters[0],i),n=null;for(let a=1;a<e.parameters.length;a++){let o=e.parameters[a],s=o.expression.match(gJ);if(s===null)t.push(new $t(o.sourceSpan,`Unrecognized conditional paramater "${o.expression}"`));else if(e.name!=="if")t.push(new $t(o.sourceSpan,'"as" expression is only allowed on the primary @if block'));else if(n!==null)t.push(new $t(o.sourceSpan,'Conditional can only have one "as" expression'));else{let l=s[2].trim(),c=o.sourceSpan.start.moveBy(s[1].length),d=new Qt(c,c.moveBy(l.length));n=new Pl(l,l,d,d)}}return{expression:r,expressionAlias:n}}function SJ(e,t){let i=e.expression,r=/^\s$/,n=0,a=0,o=i.length-1;for(let s=0;s<i.length;s++){let l=i[s];if(l==="(")a=s+1,n++;else{if(r.test(l))continue;break}}if(n===0)return i;for(let s=i.length-1;s>-1;s--){let l=i[s];if(l===")"){if(o=s,n--,n===0)break}else{if(r.test(l))continue;break}}return n!==0?(t.push(new $t(e.sourceSpan,"Unclosed parentheses in expression")),null):i.slice(a,o)}var AJ=/^\d+\.?\d*(ms|s)?$/,TJ=/^\s$/,z3=new Map([[Os,Pa],[lm,im],[Ml,ms]]),Ra=function(e){return e.IDLE="idle",e.TIMER="timer",e.INTERACTION="interaction",e.IMMEDIATE="immediate",e.HOVER="hover",e.VIEWPORT="viewport",e}(Ra||{});function U3({expression:e,sourceSpan:t},i,r,n){let a=e.indexOf("when"),o=new Qt(t.start.moveBy(a),t.start.moveBy(a+4)),s=jB(e,t);if(a===-1)n.push(new $t(t,'Could not find "when" keyword in expression'));else{let l=wg(e,a+1),c=i.parseBinding(e.slice(l),!1,t,t.start.offset+l);WB("when",r,n,new ME(c,t,s,o))}}function H3({expression:e,sourceSpan:t},i,r,n){let a=e.indexOf("on"),o=new Qt(t.start.moveBy(a),t.start.moveBy(a+2)),s=jB(e,t);if(a===-1)r.push(new $t(t,'Could not find "on" keyword in expression'));else{let l=wg(e,a+1);new O2(e,l,t,i,r,n,s,o).parse()}}function jB(e,t){return e.startsWith("prefetch")?new Qt(t.start,t.start.moveBy(8)):null}var O2=class{constructor(t,i,r,n,a,o,s,l){this.expression=t,this.start=i,this.span=r,this.triggers=n,this.errors=a,this.placeholder=o,this.prefetchSpan=s,this.onSourceSpan=l,this.index=0,this.tokens=new vg().tokenize(t.slice(i))}parse(){for(;this.tokens.length>0&&this.index<this.tokens.length;){let t=this.token();if(!t.isIdentifier()){this.unexpectedToken(t);break}if(this.isFollowedByOrLast(Uo))this.consumeTrigger(t,[]),this.advance();else if(this.isFollowedByOrLast(Ml)){this.advance();let i=this.errors.length,r=this.consumeParameters();if(this.errors.length!==i)break;this.consumeTrigger(t,r),this.advance()}else this.index<this.tokens.length-1&&this.unexpectedToken(this.tokens[this.index+1]);this.advance()}}advance(){this.index++}isFollowedByOrLast(t){return this.index===this.tokens.length-1?!0:this.tokens[this.index+1].isCharacter(t)}token(){return this.tokens[Math.min(this.index,this.tokens.length-1)]}consumeTrigger(t,i){let r=this.span.start.moveBy(this.start+t.index-this.tokens[0].index),n=new Qt(r,r.moveBy(t.strValue.length)),a=r.moveBy(this.token().end-t.index),o=t.index===0,s=o?this.onSourceSpan:null,l=o?this.prefetchSpan:null,c=new Qt(o?this.span.start:r,a);try{switch(t.toString()){case Ra.IDLE:this.trackTrigger("idle",DJ(i,n,c,l,s));break;case Ra.TIMER:this.trackTrigger("timer",MJ(i,n,c,this.prefetchSpan,this.onSourceSpan));break;case Ra.INTERACTION:this.trackTrigger("interaction",NJ(i,n,c,this.prefetchSpan,this.onSourceSpan,this.placeholder));break;case Ra.IMMEDIATE:this.trackTrigger("immediate",IJ(i,n,c,this.prefetchSpan,this.onSourceSpan));break;case Ra.HOVER:this.trackTrigger("hover",kJ(i,n,c,this.prefetchSpan,this.onSourceSpan,this.placeholder));break;case Ra.VIEWPORT:this.trackTrigger("viewport",PJ(i,n,c,this.prefetchSpan,this.onSourceSpan,this.placeholder));break;default:throw new Error(`Unrecognized trigger type "${t}"`)}}catch(d){this.error(t,d.message)}}consumeParameters(){let t=[];if(!this.token().isCharacter(Ml))return this.unexpectedToken(this.token()),t;this.advance();let i=[],r="";for(;this.index<this.tokens.length;){let n=this.token();if(n.isCharacter(ms)&&i.length===0){r.length&&t.push(r);break}if(n.type===li.Character&&z3.has(n.numValue)&&i.push(z3.get(n.numValue)),i.length>0&&n.isCharacter(i[i.length-1])&&i.pop(),i.length===0&&n.isCharacter(Uo)&&r.length>0){t.push(r),r="",this.advance();continue}r+=this.tokenText(),this.advance()}return(!this.token().isCharacter(ms)||i.length>0)&&this.error(this.token(),"Unexpected end of expression"),this.index<this.tokens.length-1&&!this.tokens[this.index+1].isCharacter(Uo)&&this.unexpectedToken(this.tokens[this.index+1]),t}tokenText(){return this.expression.slice(this.start+this.token().index,this.start+this.token().end)}trackTrigger(t,i){WB(t,this.triggers,this.errors,i)}error(t,i){let r=this.span.start.moveBy(this.start+t.index),n=r.moveBy(t.end-t.index);this.errors.push(new $t(new Qt(r,n),i))}unexpectedToken(t){this.error(t,`Unexpected token "${t}"`)}};function WB(e,t,i,r){t[e]?i.push(new $t(r.sourceSpan,`Duplicate "${e}" trigger is not allowed`)):t[e]=r}function DJ(e,t,i,r,n){if(e.length>0)throw new Error(`"${Ra.IDLE}" trigger cannot have parameters`);return new IE(t,i,r,n)}function MJ(e,t,i,r,n){if(e.length!==1)throw new Error(`"${Ra.TIMER}" trigger must have exactly one parameter`);let a=sx(e[0]);if(a===null)throw new Error(`Could not parse time value of trigger "${Ra.TIMER}"`);return new NE(a,t,i,r,n)}function IJ(e,t,i,r,n){if(e.length>0)throw new Error(`"${Ra.IMMEDIATE}" trigger cannot have parameters`);return new kE(t,i,r,n)}function kJ(e,t,i,r,n,a){return CS(Ra.HOVER,e,a),new xb(e[0]??null,t,i,r,n)}function NJ(e,t,i,r,n,a){return CS(Ra.INTERACTION,e,a),new yb(e[0]??null,t,i,r,n)}function PJ(e,t,i,r,n,a){return CS(Ra.VIEWPORT,e,a),new wb(e[0]??null,t,i,r,n)}function CS(e,t,i){if(t.length>1)throw new Error(`"${e}" trigger can only have zero or one parameters`);if(t.length===0){if(i===null)throw new Error(`"${e}" trigger with no parameters can only be placed on an @defer that has a @placeholder block`);if(i.children.length!==1||!(i.children[0]instanceof pa))throw new Error(`"${e}" trigger with no parameters can only be placed on an @defer that has a @placeholder block with exactly one root element node`)}}function wg(e,t=0){let i=!1;for(let r=t;r<e.length;r++)if(TJ.test(e[r]))i=!0;else if(i)return r;return-1}function sx(e){let t=e.match(AJ);if(!t)return null;let[i,r]=t;return parseFloat(i)*(r==="s"?1e3:1)}var RJ=/^prefetch\s+when\s/,FJ=/^prefetch\s+on\s/,qB=/^minimum\s/,OJ=/^after\s/,LJ=/^when\s/,BJ=/^on\s/;function L2(e){return e==="placeholder"||e==="loading"||e==="error"}function VJ(e,t,i,r){let n=[],{placeholder:a,loading:o,error:s}=zJ(t,n,i),{triggers:l,prefetchTriggers:c}=jJ(e.parameters,r,n,a),d=e.endSourceSpan,u=e.sourceSpan.end;if(t.length>0){let f=t[t.length-1];d=f.endSourceSpan,u=f.sourceSpan.end}let h=new Qt(e.sourceSpan.start,u);return{node:new gu(Ar(i,e.children,e.children),l,c,a,o,s,e.nameSpan,h,e.sourceSpan,e.startSourceSpan,d,e.i18n),errors:n}}function zJ(e,t,i){let r=null,n=null,a=null;for(let o of e)try{if(!L2(o.name)){t.push(new $t(o.startSourceSpan,`Unrecognized block "@${o.name}"`));break}switch(o.name){case"placeholder":r!==null?t.push(new $t(o.startSourceSpan,"@defer block can only have one @placeholder block")):r=UJ(o,i);break;case"loading":n!==null?t.push(new $t(o.startSourceSpan,"@defer block can only have one @loading block")):n=HJ(o,i);break;case"error":a!==null?t.push(new $t(o.startSourceSpan,"@defer block can only have one @error block")):a=GJ(o,i);break}}catch(s){t.push(new $t(o.startSourceSpan,s.message))}return{placeholder:r,loading:n,error:a}}function UJ(e,t){let i=null;for(let r of e.parameters)if(qB.test(r.expression)){if(i!=null)throw new Error('@placeholder block can only have one "minimum" parameter');let n=sx(r.expression.slice(wg(r.expression)));if(n===null)throw new Error('Could not parse time value of parameter "minimum"');i=n}else throw new Error(`Unrecognized parameter in @placeholder block: "${r.expression}"`);return new Zf(Ar(t,e.children,e.children),i,e.nameSpan,e.sourceSpan,e.startSourceSpan,e.endSourceSpan,e.i18n)}function HJ(e,t){let i=null,r=null;for(let n of e.parameters)if(OJ.test(n.expression)){if(i!=null)throw new Error('@loading block can only have one "after" parameter');let a=sx(n.expression.slice(wg(n.expression)));if(a===null)throw new Error('Could not parse time value of parameter "after"');i=a}else if(qB.test(n.expression)){if(r!=null)throw new Error('@loading block can only have one "minimum" parameter');let a=sx(n.expression.slice(wg(n.expression)));if(a===null)throw new Error('Could not parse time value of parameter "minimum"');r=a}else throw new Error(`Unrecognized parameter in @loading block: "${n.expression}"`);return new Kf(Ar(t,e.children,e.children),i,r,e.nameSpan,e.sourceSpan,e.startSourceSpan,e.endSourceSpan,e.i18n)}function GJ(e,t){if(e.parameters.length>0)throw new Error("@error block cannot have parameters");return new Qf(Ar(t,e.children,e.children),e.nameSpan,e.sourceSpan,e.startSourceSpan,e.endSourceSpan,e.i18n)}function jJ(e,t,i,r){let n={},a={};for(let o of e)LJ.test(o.expression)?U3(o,t,n,i):BJ.test(o.expression)?H3(o,n,i,r):RJ.test(o.expression)?U3(o,t,a,i):FJ.test(o.expression)?H3(o,a,i,r):i.push(new $t(o.sourceSpan,"Unrecognized trigger"));return{triggers:n,prefetchTriggers:a}}var WJ=/^(?:(bind-)|(let-)|(ref-|#)|(on-)|(bindon-)|(@))(.*)$/,G3=1,j3=2,W3=3,q3=4,$3=5,qJ=6,Pf=7,Ic={BANANA_BOX:{start:"[(",end:")]"},PROPERTY:{start:"[",end:"]"},EVENT:{start:"(",end:")"}},X3="*";function $J(e,t,i){let r=new B2(t,i),n=Ar(r,e,e),a=t.errors.concat(r.errors),o={nodes:n,errors:a,styleUrls:r.styleUrls,styles:r.styles,ngContentSelectors:r.ngContentSelectors};return i.collectCommentNodes&&(o.commentNodes=r.commentNodes),o}var B2=class{constructor(t,i){this.bindingParser=t,this.options=i,this.errors=[],this.styles=[],this.styleUrls=[],this.ngContentSelectors=[],this.commentNodes=[],this.inI18nBlock=!1,this.processedNodes=new Set}visitElement(t){let i=ng(t.i18n);i&&(this.inI18nBlock&&this.reportError("Cannot mark an element as translatable inside of a translatable section. Please remove the nested i18n marker.",t.sourceSpan),this.inI18nBlock=!0);let r=GB(t);if(r.type===no.SCRIPT)return null;if(r.type===no.STYLE){let g=KJ(t);return g!==null&&this.styles.push(g),null}else if(r.type===no.STYLESHEET&&iJ(r.hrefAttr))return this.styleUrls.push(r.hrefAttr),null;let n=JW(t.name),a=[],o=[],s=[],l=[],c=[],d={},u=[],h=[],m=!1;for(let g of t.attrs){let v=!1,b=Y3(g.name),_=!1;if(g.i18n&&(d[g.name]=g.i18n),b.startsWith(X3)){m&&this.reportError("Can't have multiple template bindings on one element. Use only one attribute prefixed with *",g.sourceSpan),_=!0,m=!0;let x=g.value,w=b.substring(X3.length),y=[],M=g.valueSpan?g.valueSpan.start.offset:g.sourceSpan.start.offset+g.name.length;this.bindingParser.parseInlineTemplateBinding(w,x,g.sourceSpan,M,[],u,y,!0),h.push(...y.map(T=>new Pl(T.name,T.value,T.sourceSpan,T.keySpan,T.valueSpan)))}else v=this.parseAttribute(n,g,[],a,o,s,l);!v&&!_&&c.push(this.visitAttribute(g))}let f;r.nonBindable?f=Ar(XJ,t.children).flat(1/0):f=Ar(this,t.children,t.children);let p;if(r.type===no.NG_CONTENT){t.children&&!t.children.every(b=>YJ(b)||ZJ(b))&&this.reportError("<ng-content> element cannot have content.",t.sourceSpan);let g=r.selectAttr,v=t.attrs.map(b=>this.visitAttribute(b));p=new Ab(g,v,t.sourceSpan,t.i18n),this.ngContentSelectors.push(g)}else if(n){let g=this.extractAttributes(t.name,a,d);p=new La(t.name,c,g.bound,o,[],f,l,s,t.sourceSpan,t.startSourceSpan,t.endSourceSpan,t.i18n)}else{let g=this.extractAttributes(t.name,a,d);p=new pa(t.name,c,g.bound,o,f,l,t.sourceSpan,t.startSourceSpan,t.endSourceSpan,t.i18n)}if(m){let g=this.extractAttributes("ng-template",u,d),v=[];g.literal.forEach(w=>v.push(w)),g.bound.forEach(w=>v.push(w));let b=p instanceof pa?{attributes:p.attributes,inputs:p.inputs,outputs:p.outputs}:{attributes:[],inputs:[],outputs:[]},_=n&&i?void 0:t.i18n,x=p instanceof La?null:p.name;p=new La(x,b.attributes,b.inputs,b.outputs,v,[p],[],h,t.sourceSpan,t.startSourceSpan,t.endSourceSpan,_)}return i&&(this.inI18nBlock=!1),p}visitAttribute(t){return new pm(t.name,t.value,t.sourceSpan,t.keySpan,t.valueSpan,t.i18n)}visitText(t){return this.processedNodes.has(t)?null:this._visitTextWithInterpolation(t.value,t.sourceSpan,t.tokens,t.i18n)}visitExpansion(t){if(!t.i18n)return null;if(!ng(t.i18n))throw new Error(`Invalid type "${t.i18n.constructor}" for "i18n" property of ${t.sourceSpan.toString()}. Expected a "Message"`);let i=t.i18n,r={},n={};return Object.keys(i.placeholders).forEach(a=>{let o=i.placeholders[a];if(a.startsWith(nq)){let s=a.trim(),l=this.bindingParser.parseInterpolationExpression(o.text,o.sourceSpan);r[s]=new fu(l,o.sourceSpan)}else n[a]=this._visitTextWithInterpolation(o.text,o.sourceSpan,null)}),new ig(r,n,t.sourceSpan,i)}visitExpansionCase(t){return null}visitComment(t){return this.options.collectCommentNodes&&this.commentNodes.push(new mm(t.value||"",t.sourceSpan)),null}visitBlockParameter(){return null}visitBlock(t,i){let r=Array.isArray(i)?i.indexOf(t):-1;if(r===-1)throw new Error("Visitor invoked incorrectly. Expecting visitBlock to be invoked siblings array as its context");if(this.processedNodes.has(t))return null;let n=null;switch(t.name){case"defer":n=VJ(t,this.findConnectedBlocks(r,i,L2),this,this.bindingParser);break;case"switch":n=xJ(t,this,this.bindingParser);break;case"for":n=bJ(t,this.findConnectedBlocks(r,i,L3),this,this.bindingParser);break;case"if":n=_J(t,this.findConnectedBlocks(r,i,B3),this,this.bindingParser);break;default:let a;L2(t.name)?(a=`@${t.name} block can only be used after an @defer block.`,this.processedNodes.add(t)):L3(t.name)?(a=`@${t.name} block can only be used after an @for block.`,this.processedNodes.add(t)):B3(t.name)?(a=`@${t.name} block can only be used after an @if or @else if block.`,this.processedNodes.add(t)):a=`Unrecognized block @${t.name}.`,n={node:new Sb(t.name,t.sourceSpan,t.nameSpan),errors:[new $t(t.sourceSpan,a)]};break}return this.errors.push(...n.errors),n.node}findConnectedBlocks(t,i,r){let n=[];for(let a=t+1;a<i.length;a++){let o=i[a];if(o instanceof Xc&&o.value.trim().length===0){this.processedNodes.add(o);continue}if(!(o instanceof Vo)||!r(o.name))break;n.push(o),this.processedNodes.add(o)}return n}extractAttributes(t,i,r){let n=[],a=[];return i.forEach(o=>{let s=r[o.name];if(o.isLiteral)a.push(new pm(o.name,o.expression.source||"",o.sourceSpan,o.keySpan,o.valueSpan,s));else{let l=this.bindingParser.createBoundElementProperty(t,o,!0,!1);n.push(_b.fromBoundElementProperty(l,s))}}),{bound:n,literal:a}}parseAttribute(t,i,r,n,a,o,s){let l=Y3(i.name),c=i.value,d=i.sourceSpan,u=i.valueSpan?i.valueSpan.start.offset:d.start.offset;function h(v,b,_){let x=i.name.length-l.length,w=v.start.moveBy(b.length+x),y=w.moveBy(_.length);return new Qt(w,y,w,_)}let m=l.match(WJ);if(m){if(m[G3]!=null){let v=m[Pf],b=h(d,m[G3],v);this.bindingParser.parsePropertyBinding(v,c,!1,!1,d,u,i.valueSpan,r,n,b)}else if(m[j3])if(t){let v=m[Pf],b=h(d,m[j3],v);this.parseVariable(v,c,d,b,i.valueSpan,o)}else this.reportError('"let-" is only supported on ng-template elements.',d);else if(m[W3]){let v=m[Pf],b=h(d,m[W3],v);this.parseReference(v,c,d,b,i.valueSpan,s)}else if(m[q3]){let v=[],b=m[Pf],_=h(d,m[q3],b);this.bindingParser.parseEvent(b,c,!1,d,i.valueSpan||d,r,v,_),lE(v,a)}else if(m[$3]){let v=m[Pf],b=h(d,m[$3],v);this.bindingParser.parsePropertyBinding(v,c,!1,!0,d,u,i.valueSpan,r,n,b),this.parseAssignmentEvent(v,c,d,i.valueSpan,r,a,b)}else if(m[qJ]){let v=h(d,"",l);this.bindingParser.parseLiteralAttr(l,c,d,u,i.valueSpan,r,n,v)}return!0}let f=null;if(l.startsWith(Ic.BANANA_BOX.start)?f=Ic.BANANA_BOX:l.startsWith(Ic.PROPERTY.start)?f=Ic.PROPERTY:l.startsWith(Ic.EVENT.start)&&(f=Ic.EVENT),f!==null&&l.endsWith(f.end)&&l.length>f.start.length+f.end.length){let v=l.substring(f.start.length,l.length-f.end.length),b=h(d,f.start,v);if(f.start===Ic.BANANA_BOX.start)this.bindingParser.parsePropertyBinding(v,c,!1,!0,d,u,i.valueSpan,r,n,b),this.parseAssignmentEvent(v,c,d,i.valueSpan,r,a,b);else if(f.start===Ic.PROPERTY.start)this.bindingParser.parsePropertyBinding(v,c,!1,!1,d,u,i.valueSpan,r,n,b);else{let _=[];this.bindingParser.parseEvent(v,c,!1,d,i.valueSpan||d,r,_,b),lE(_,a)}return!0}let p=h(d,"",l);return this.bindingParser.parsePropertyInterpolation(l,c,d,i.valueSpan,r,n,p,i.valueTokens??null)}_visitTextWithInterpolation(t,i,r,n){let a=UB(t),o=this.bindingParser.parseInterpolation(a,i,r);return o?new fu(o,i,n):new Dl(a,i)}parseVariable(t,i,r,n,a,o){t.indexOf("-")>-1?this.reportError('"-" is not allowed in variable names',r):t.length===0&&this.reportError("Variable does not have a name",r),o.push(new Pl(t,i,r,n,a))}parseReference(t,i,r,n,a,o){t.indexOf("-")>-1?this.reportError('"-" is not allowed in reference names',r):t.length===0?this.reportError("Reference does not have a name",r):o.some(s=>s.name===t)&&this.reportError(`Reference "#${t}" is defined more than once`,r),o.push(new tg(t,i,r,n,a))}parseAssignmentEvent(t,i,r,n,a,o,s){let l=[];this.bindingParser.parseEvent(`${t}Change`,i,!0,r,n||r,a,l,s),lE(l,o)}reportError(t,i,r=Oc.ERROR){this.errors.push(new $t(i,t,r))}},V2=class{visitElement(t){let i=GB(t);if(i.type===no.SCRIPT||i.type===no.STYLE||i.type===no.STYLESHEET)return null;let r=Ar(this,t.children,null);return new pa(t.name,Ar(this,t.attrs),[],[],r,[],t.sourceSpan,t.startSourceSpan,t.endSourceSpan)}visitComment(t){return null}visitAttribute(t){return new pm(t.name,t.value,t.sourceSpan,t.keySpan,t.valueSpan,t.i18n)}visitText(t){return new Dl(t.value,t.sourceSpan)}visitExpansion(t){return null}visitExpansionCase(t){return null}visitBlock(t,i){let r=[new Dl(t.startSourceSpan.toString(),t.startSourceSpan),...Ar(this,t.children)];return t.endSourceSpan!==null&&r.push(new Dl(t.endSourceSpan.toString(),t.endSourceSpan)),r}visitBlockParameter(t,i){return null}},XJ=new V2;function Y3(e){return/^data-/i.test(e)?e.substring(5):e}function lE(e,t){t.push(...e.map(i=>bb.fromParsedEvent(i)))}function YJ(e){return e instanceof Xc&&e.value.trim().length==0}function ZJ(e){return e instanceof _g}function KJ(e){return e.children.length!==1||!(e.children[0]instanceof Xc)?null:e.children[0].value}var Ps=function(e){return e[e.ELEMENT=0]="ELEMENT",e[e.TEMPLATE=1]="TEMPLATE",e}(Ps||{});function QJ(){return{getUniqueId:cq(),icus:new Map}}var z2=class e{constructor(t,i,r=0,n=null,a,o){this.index=t,this.ref=i,this.level=r,this.templateIndex=n,this.meta=a,this.registry=o,this.bindings=new Set,this.placeholders=new Map,this.isEmitted=!1,this._unresolvedCtxCount=0,this._registry=o||QJ(),this.id=this._registry.getUniqueId()}appendTag(t,i,r,n){if(i.isVoid&&n)return;let a=i.isVoid||!n?i.startName:i.closeName,o={type:t,index:r,ctx:this.id,isVoid:i.isVoid,closed:n};Of(this.placeholders,a,o)}appendBlockPart(t,i,r){let n=r?t.closeName:t.startName,a={type:Ps.TEMPLATE,index:i,ctx:this.id,closed:r};Of(this.placeholders,n,a)}get icus(){return this._registry.icus}get isRoot(){return this.level===0}get isResolved(){return this._unresolvedCtxCount===0}getSerializedPlaceholders(){let t=new Map;return this.placeholders.forEach((i,r)=>t.set(r,i.map(JJ))),t}appendBinding(t){this.bindings.add(t)}appendIcu(t,i){Of(this._registry.icus,t,i)}appendBoundText(t){DL(t,this.bindings.size,this.id).forEach((r,n)=>Of(this.placeholders,n,...r))}appendTemplate(t,i){this.appendTag(Ps.TEMPLATE,t,i,!1),this.appendTag(Ps.TEMPLATE,t,i,!0),this._unresolvedCtxCount++}appendBlock(t,i){this.appendBlockPart(t,i,!1),this.appendBlockPart(t,i,!0),this._unresolvedCtxCount++}appendElement(t,i,r){this.appendTag(Ps.ELEMENT,t,i,r)}appendProjection(t,i){this.appendTag(Ps.ELEMENT,t,i,!1),this.appendTag(Ps.ELEMENT,t,i,!0)}forkChildContext(t,i,r){return new e(t,this.ref,this.level+1,i,r,this._registry)}reconcileChildContext(t){["start","close"].forEach(r=>{let n=t.meta[`${r}Name`],o=(this.placeholders.get(n)||[]).find(K3(this.id,t.templateIndex));o&&(o.ctx=t.id)}),t.placeholders.forEach((r,n)=>{let a=this.placeholders.get(n);if(!a){this.placeholders.set(n,r);return}let o=a.findIndex(K3(t.id,t.templateIndex));if(o>=0){let s=n.startsWith("CLOSE");if(n.endsWith("NG-TEMPLATE"))a.splice(o+(s?0:1),0,...r);else{let c=s?r.length-1:0;r[c].tmpl=a[o],a.splice(o,1,...r)}}else a.push(...r);this.placeholders.set(n,a)}),this._unresolvedCtxCount--}};function cE(e,t,i,r){return px(`${r?"/":""}${e}${t}`,i)}function Z3(e,{index:t,ctx:i,isVoid:r},n){return r?cE(e,t,i)+cE(e,t,i,!0):cE(e,t,i,n)}function K3(e,t){return i=>typeof i=="object"&&i.type===Ps.TEMPLATE&&i.index===t&&i.ctx===e}function JJ(e){let t=(r,n)=>Z3("#",r,n),i=(r,n)=>Z3("*",r,n);switch(e.type){case Ps.ELEMENT:return e.closed?t(e,!0)+(e.tmpl?i(e.tmpl,!0):""):e.tmpl?i(e.tmpl)+t(e)+(e.isVoid?i(e.tmpl,!0):""):t(e);case Ps.TEMPLATE:return i(e,e.closed);default:return e}}var eee="!important",lx=2,cx=class{constructor(t){this._directiveExpr=t,this._hasInitialValues=!1,this.hasBindings=!1,this.hasBindingsWithPipes=!1,this._classMapInput=null,this._styleMapInput=null,this._singleStyleInputs=null,this._singleClassInputs=null,this._lastStylingInput=null,this._firstStylingInput=null,this._stylesIndex=new Map,this._classesIndex=new Map,this._initialStyleValues=[],this._initialClassValues=[]}registerBoundInput(t){let i=null,r=t.name;switch(t.type){case 0:i=this.registerInputBasedOnName(r,t.value,t.sourceSpan);break;case 3:i=this.registerStyleInput(r,!1,t.value,t.sourceSpan,t.unit);break;case 2:i=this.registerClassInput(r,!1,t.value,t.sourceSpan);break}return!!i}registerInputBasedOnName(t,i,r){let n=null,a=t.substring(0,6),o=t==="style"||a==="style."||a==="style!";if(o||!o&&(t==="class"||a==="class."||a==="class!")){let l=t.charAt(5)!==".",c=t.slice(l?5:6);o?n=this.registerStyleInput(c,l,i,r):n=this.registerClassInput(c,l,i,r)}return n}registerStyleInput(t,i,r,n,a){if(eL(r))return null;nee(t)||(t=bS(t));let{property:o,hasOverrideFlag:s,suffix:l}=J3(t);a=typeof a=="string"&&a.length!==0?a:l;let c={name:o,suffix:a,value:r,sourceSpan:n,hasOverrideFlag:s};return i?this._styleMapInput=c:((this._singleStyleInputs=this._singleStyleInputs||[]).push(c),Q3(this._stylesIndex,o)),this._lastStylingInput=c,this._firstStylingInput=this._firstStylingInput||c,this._checkForPipes(r),this.hasBindings=!0,c}registerClassInput(t,i,r,n){if(eL(r))return null;let{property:a,hasOverrideFlag:o}=J3(t),s={name:a,value:r,sourceSpan:n,hasOverrideFlag:o,suffix:null};return i?this._classMapInput=s:((this._singleClassInputs=this._singleClassInputs||[]).push(s),Q3(this._classesIndex,a)),this._lastStylingInput=s,this._firstStylingInput=this._firstStylingInput||s,this._checkForPipes(r),this.hasBindings=!0,s}_checkForPipes(t){t instanceof Fa&&t.ast instanceof wu&&(this.hasBindingsWithPipes=!0)}registerStyleAttr(t){this._initialStyleValues=wB(t),this._hasInitialValues=!0}registerClassAttr(t){this._initialClassValues=t.trim().split(/\s+/g),this._hasInitialValues=!0}populateInitialStylingAttrs(t){if(this._initialClassValues.length){t.push(L(1));for(let i=0;i<this._initialClassValues.length;i++)t.push(L(this._initialClassValues[i]))}if(this._initialStyleValues.length){t.push(L(2));for(let i=0;i<this._initialStyleValues.length;i+=2)t.push(L(this._initialStyleValues[i]),L(this._initialStyleValues[i+1]))}}assignHostAttrs(t,i){this._directiveExpr&&(t.length||this._hasInitialValues)&&(this.populateInitialStylingAttrs(t),i.set("hostAttrs",zt(t)))}buildClassMapInstruction(t){return this._classMapInput?this._buildMapBasedInstruction(t,!0,this._classMapInput):null}buildStyleMapInstruction(t){return this._styleMapInput?this._buildMapBasedInstruction(t,!1,this._styleMapInput):null}_buildMapBasedInstruction(t,i,r){let n=lx,a=r.value.visit(t),o;return a instanceof zr?(n+=a.expressions.length,o=i?tee(a):iee(a)):o=i?E.classMap:E.styleMap,{reference:o,calls:[{supportsInterpolation:!0,sourceSpan:r.sourceSpan,allocateBindingSlots:n,params:s=>{let l=s(a);return Array.isArray(l)?l:[l]}}]}}_buildSingleInputs(t,i,r,n,a){let o=[];return i.forEach(s=>{let l=o[o.length-1],c=s.value.visit(r),d=t,u=lx;c instanceof zr&&(u+=c.expressions.length,n&&(d=n(c)));let h={sourceSpan:s.sourceSpan,allocateBindingSlots:u,supportsInterpolation:!!n,params:m=>{let f=[];f.push(L(s.name));let p=m(c);return Array.isArray(p)?f.push(...p):f.push(p),!a&&s.suffix!==null&&f.push(L(s.suffix)),f}};l&&l.reference===d?l.calls.push(h):o.push({reference:d,calls:[h]})}),o}_buildClassInputs(t){return this._singleClassInputs?this._buildSingleInputs(E.classProp,this._singleClassInputs,t,null,!0):[]}_buildStyleInputs(t){return this._singleStyleInputs?this._buildSingleInputs(E.styleProp,this._singleStyleInputs,t,ree,!1):[]}buildUpdateLevelInstructions(t){let i=[];if(this.hasBindings){let r=this.buildStyleMapInstruction(t);r&&i.push(r);let n=this.buildClassMapInstruction(t);n&&i.push(n),i.push(...this._buildStyleInputs(t)),i.push(...this._buildClassInputs(t))}return i}};function Q3(e,t){e.has(t)||e.set(t,e.size)}function J3(e){let t=!1,i=e.indexOf(eee);i!==-1&&(e=i>0?e.substring(0,i):"",t=!0);let r=null,n=e,a=e.lastIndexOf(".");return a>0&&(r=e.slice(a+1),n=e.substring(0,a)),{property:n,suffix:r,hasOverrideFlag:t}}function tee(e){switch(ku(e)){case 1:return E.classMap;case 3:return E.classMapInterpolate1;case 5:return E.classMapInterpolate2;case 7:return E.classMapInterpolate3;case 9:return E.classMapInterpolate4;case 11:return E.classMapInterpolate5;case 13:return E.classMapInterpolate6;case 15:return E.classMapInterpolate7;case 17:return E.classMapInterpolate8;default:return E.classMapInterpolateV}}function iee(e){switch(ku(e)){case 1:return E.styleMap;case 3:return E.styleMapInterpolate1;case 5:return E.styleMapInterpolate2;case 7:return E.styleMapInterpolate3;case 9:return E.styleMapInterpolate4;case 11:return E.styleMapInterpolate5;case 13:return E.styleMapInterpolate6;case 15:return E.styleMapInterpolate7;case 17:return E.styleMapInterpolate8;default:return E.styleMapInterpolateV}}function ree(e){switch(ku(e)){case 1:return E.styleProp;case 3:return E.stylePropInterpolate1;case 5:return E.stylePropInterpolate2;case 7:return E.stylePropInterpolate3;case 9:return E.stylePropInterpolate4;case 11:return E.stylePropInterpolate5;case 13:return E.stylePropInterpolate6;case 15:return E.stylePropInterpolate7;case 17:return E.stylePropInterpolate8;default:return E.stylePropInterpolateV}}function nee(e){return e.startsWith("--")}function eL(e){return e instanceof Fa&&(e=e.ast),e instanceof zn}var aee="select",oee="ngProjectAs",U2=new Set(["$event"]),Q_="ng-template",dE=new Map([["window",E.resolveWindow],["document",E.resolveDocument],["body",E.resolveBody]]),see=[" ",`
`,"\r","	"];function Zc(e,t){return Ag(et(Mg).bitwiseAnd(L(e),null,!1),t)}function $B(e,t=null,i=null){let{type:r,name:n,target:a,phase:o,handler:s}=e;if(a&&!dE.has(a))throw new Error(`Unexpected global target '${a}' defined for '${n}' event.
        Supported list of global targets: ${Array.from(dE.keys())}.`);let l="$event",c=new Set,d=i===null||i.bindingLevel===0?et(la):i.getOrCreateSharedContextVar(0),u=e.type===2?Xq(i,d,s,"b",e.handlerSpan,c,U2):$q(i,d,s,"b",e.handlerSpan,c,U2),h=[],m=i?.variableDeclarations(),f=i?.restoreViewStatement();if(m&&h.push(...m),h.push(...u),f){h.unshift(f);let x=h[h.length-1];x instanceof Jr?h[h.length-1]=new Jr(vu(x.value.sourceSpan,E.resetView,[x.value])):h.push(new bn(vu(null,E.resetView,[])))}let p=r===1?UW(n,o):n,g=t&&Vs(t),v=[];c.has(l)&&v.push(new er(l,Ul));let b=Gs(v,h,da,null,g),_=[L(p),b];return a&&_.push(L(!1),Le(dE.get(a))),_}function lee(){return{prepareStatements:[],constExpressions:[],i18nVarRefsCache:new Map}}var H2=class{constructor(t,i,r,n){this.name=t,this.index=i,this.scope=r,this.visitor=n}getConstCount(){return this.visitor.getConstCount()}getVarCount(){return this.visitor.getVarCount()}},G2=class e{constructor(t,i,r=0,n,a,o,s,l,c,d,u,h,m,f=lee()){this.constantPool=t,this.level=r,this.contextName=n,this.i18nContext=a,this.templateIndex=o,this.templateName=s,this._namespace=l,this.i18nUseExternalIds=d,this.deferBlocks=u,this.elementLocations=h,this.allDeferrableDepsFn=m,this._constants=f,this._dataIndex=0,this._bindingContext=0,this._prefixCode=[],this._creationCodeFns=[],this._updateCodeFns=[],this._currentIndex=0,this._tempVariables=[],this._controlFlowTempVariable=null,this._nestedTemplateFns=[],this.i18n=null,this._pureFunctionSlots=0,this._bindingSlots=0,this._ngContentReservedSlots=[],this._ngContentSelectorsOffset=0,this._implicitReceiverExpr=null,this.visitReference=ro,this.visitVariable=ro,this.visitTextAttribute=ro,this.visitBoundAttribute=ro,this.visitBoundEvent=ro,this.visitDeferredTrigger=ro,this.visitDeferredBlockError=ro,this.visitDeferredBlockLoading=ro,this.visitDeferredBlockPlaceholder=ro,this.visitIfBlockBranch=ro,this.visitSwitchBlockCase=ro,this.visitForLoopBlockEmpty=ro,this.visitUnknownBlock=ro,this._bindingScope=i.nestedScope(r),this.fileBasedI18nSuffix=c.replace(/[^A-Za-z0-9]/g,"_")+"_",this._valueConverter=new dx(t,()=>this.allocateDataSlot(),p=>this.allocatePureFunctionSlots(p),(p,g,v,b)=>{this._bindingScope.set(this.level,g,b),this.creationInstruction(null,E.pipe,[L(v),L(p)])})}buildTemplateFunction(t,i,r=0,n,a){this._ngContentSelectorsOffset=r,this._namespace!==E.namespaceHTML&&this.creationInstruction(null,this._namespace),i.forEach(f=>{let p=a?.[f.name];this.registerContextVariables(f.name,f.value),p&&this.registerContextVariables(p,f.value)});let o=this.i18nContext||ng(n)&&!Ff(n)&&!(_ee(t)&&t[0].i18n===n),s=uE(t);if(o&&this.i18nStart(null,n,s),Vf(this,t),this._pureFunctionSlots+=this._bindingSlots,this._valueConverter.updatePipeSlotOffsets(this._bindingSlots),this._nestedTemplateFns.forEach(f=>f()),this.level===0&&this._ngContentReservedSlots.length){let f=[];if(this._ngContentReservedSlots.length>1||this._ngContentReservedSlots[0]!=="*"){let p=this._ngContentReservedSlots.map(g=>g!=="*"?Cg(g):g);f.push(this.constantPool.getConstLiteral(hs(p),!0))}this.creationInstruction(null,E.projectionDef,f,!0)}o&&this.i18nEnd(null,s);let l=Mb(this._creationCodeFns),c=Mb(this._updateCodeFns),d=this._bindingScope.viewSnapshotStatements(),u=this._bindingScope.variableDeclarations().concat(this._tempVariables),h=l.length>0?[Zc(1,d.concat(l))]:[],m=c.length>0?[Zc(2,u.concat(c))]:[];return Gs([new er(Mg,Eg),new er(la,null)],[...this._prefixCode,...h,...m],da,null,this.templateName)}getLocal(t){return this._bindingScope.get(t)}notifyImplicitReceiverUse(){this._bindingScope.notifyImplicitReceiverUse()}maybeRestoreView(){this._bindingScope.maybeRestoreView()}i18nTranslate(t,i={},r,n){let a=r||this.i18nGenerateMainBlockVar(),o=this.i18nGenerateClosureVar(t.id),s=yee(t,a,o,i,n);return this._constants.prepareStatements.push(...s),a}registerContextVariables(t,i){let r=this._bindingScope.freshReferenceName(),n=this.level,a=i===OE,o=et(t+r);this._bindingScope.set(n,t,s=>a&&s.bindingLevel===n&&!s.isListenerScope()?et(la):o,1,(s,l)=>{let c;if(s.bindingLevel===n)if(s.isListenerScope()&&s.hasRestoreViewVariable())c=et(IL),s.notifyRestoredViewContextUse();else{if(a)return[];c=et(la)}else{let d=s.getSharedContextName(n);c=d||j2(l)}return[o.set(a?c:c.prop(i||hq)).toConstDecl()]})}i18nAppendBindings(t){t.length>0&&t.forEach(i=>this.i18n.appendBinding(i))}i18nBindProps(t){let i={};return Object.keys(t).forEach(r=>{let n=t[r];if(n instanceof Dl)i[r]=L(n.value);else{let a=n.value.visit(this._valueConverter);if(this.allocateBindingSlots(a),a instanceof zr){let{strings:o,expressions:s}=a,{id:l,bindings:c}=this.i18n,d=lq(o,c.size,l);this.i18nAppendBindings(s),i[r]=L(d)}}}),i}i18nGenerateMainBlockVar(){return et(this.constantPool.uniqueName(rq))}i18nGenerateClosureVar(t){let i,r=this.fileBasedI18nSuffix.toUpperCase();if(this.i18nUseExternalIds){let n=Db("EXTERNAL_"),a=this.constantPool.uniqueName(r);i=`${n}${Vs(t)}$$${a}`}else{let n=Db(r);i=this.constantPool.uniqueName(n)}return et(i)}i18nUpdateRef(t){let{icus:i,meta:r,isRoot:n,isResolved:a,isEmitted:o}=t;if(n&&a&&!o&&!Ff(r)){t.isEmitted=!0;let s=t.getSerializedPlaceholders(),l={},c=s.size?EO(s):{};i.size&&i.forEach((h,m)=>{if(h.length===1)c[m]=h[0];else{let f=px(`${aq}${m}`);c[m]=L(f),l[m]=zt(h)}});let d=Array.from(s.values()).some(h=>h.length>1)||Object.keys(l).length,u;d&&(u=h=>{let m=[h];return Object.keys(l).length&&m.push(gg(l,!0)),vu(null,E.i18nPostprocess,m)}),this.i18nTranslate(r,c,t.ref,u)}}i18nStart(t=null,i,r){let n=this.allocateDataSlot();this.i18n=this.i18nContext?this.i18nContext.forkChildContext(n,this.templateIndex,i):new z2(n,this.i18nGenerateMainBlockVar(),0,this.templateIndex,i);let{id:a,ref:o}=this.i18n,s=[L(n),this.addToConsts(o)];a>0&&s.push(L(a)),this.creationInstruction(t,r?E.i18n:E.i18nStart,s)}i18nEnd(t=null,i){if(!this.i18n)throw new Error("i18nEnd is executed with no i18n context present");this.i18nContext?(this.i18nContext.reconcileChildContext(this.i18n),this.i18nUpdateRef(this.i18nContext)):this.i18nUpdateRef(this.i18n);let{index:r,bindings:n}=this.i18n;if(n.size){for(let a of n)this.updateInstructionWithAdvance(this.getConstCount()-1,t,E.i18nExp,()=>this.convertPropertyBinding(a));this.updateInstruction(t,E.i18nApply,[L(r)])}i||this.creationInstruction(t,E.i18nEnd),this.i18n=null}i18nAttributesInstruction(t,i,r){let n=!1,a=[];if(i.forEach(o=>{let s=o.i18n,l=o.value.visit(this._valueConverter);if(this.allocateBindingSlots(l),l instanceof zr){let c=DL(s),d=EO(c);a.push(L(o.name),this.i18nTranslate(s,d)),l.expressions.forEach(u=>{n=!0,this.updateInstructionWithAdvance(t,r,E.i18nExp,()=>this.convertPropertyBinding(u))})}}),a.length>0){let o=L(this.allocateDataSlot()),s=this.addToConsts(zt(a));this.creationInstruction(r,E.i18nAttributes,[o,s]),n&&this.updateInstruction(r,E.i18nApply,[o])}}getNamespaceInstruction(t){switch(t){case"math":return E.namespaceMathML;case"svg":return E.namespaceSVG;default:return E.namespaceHTML}}addNamespaceInstruction(t,i){this._namespace=t,this.creationInstruction(i.startSourceSpan,t)}interpolatedUpdateInstruction(t,i,r,n,a,o){this.updateInstructionWithAdvance(i,n.sourceSpan,t,()=>[L(r),...this.getUpdateInstructionArguments(a),...o])}visitContent(t){let i=this.allocateDataSlot(),r=this._ngContentSelectorsOffset+this._ngContentReservedSlots.length,n=[L(i)];this._ngContentReservedSlots.push(t.selector);let a=t.attributes.filter(s=>s.name.toLowerCase()!==aee),o=this.getAttributeExpressions(t.name,a,[],[]);o.length>0?n.push(L(r),zt(o)):r!==0&&n.push(L(r)),this.creationInstruction(t.sourceSpan,E.projection,n),this.i18n&&this.i18n.appendProjection(t.i18n,i)}visitElement(t){let i=this.allocateDataSlot(),r=new cx(null);this.elementLocations.set(t,{index:i,level:this.level});let n=!1,a=ng(t.i18n)&&!Ff(t.i18n),o=[],[s,l]=ua(t.name),c=SE(t.name);for(let C of t.attributes){let{name:N,value:D}=C;N===mq?n=!0:N==="style"?r.registerStyleAttr(D):N==="class"?r.registerClassAttr(D):o.push(C)}let d=[L(i)];c||d.push(L(l));let u=[],h=[];t.inputs.forEach(C=>{r.registerBoundInput(C)||((C.type===0||C.type===5)&&C.i18n?h.push(C):u.push(C))});let m=this.getAttributeExpressions(t.name,o,u,t.outputs,r,[],h);d.push(this.addAttrsToConsts(m));let f=this.prepareRefsArray(t.references);d.push(this.addToConsts(f));let p=this._namespace,g=this.getNamespaceInstruction(s);g!==p&&this.addNamespaceInstruction(g,t),this.i18n&&this.i18n.appendElement(t.i18n,i);let v=!a&&this.i18n?!uE(t.children):t.children.length>0,b=!r.hasBindingsWithPipes&&t.outputs.length===0&&h.length===0&&!v,_=!b&&uE(t.children);if(b)this.creationInstruction(t.sourceSpan,c?E.elementContainer:E.element,jh(d));else{if(this.creationInstruction(t.startSourceSpan,c?E.elementContainerStart:E.elementStart,jh(d)),n&&this.creationInstruction(t.startSourceSpan,E.disableBindings),h.length>0&&this.i18nAttributesInstruction(i,h,t.startSourceSpan??t.sourceSpan),t.outputs.length>0)for(let C of t.outputs)this.creationInstruction(C.sourceSpan,C.type===2?E.twoWayListener:E.listener,this.prepareListenerParameter(t.name,C,i));a&&this.i18nStart(t.startSourceSpan,t.i18n,_)}let x=r.buildUpdateLevelInstructions(this._valueConverter),w=x.length-1;for(let C=0;C<=w;C++){let N=x[C];this._bindingSlots+=this.processStylingUpdateInstruction(i,N)}let y=L(void 0),M=[],T=[];u.forEach(C=>{let N=C.type;if(N===4){let D=C.value.visit(this._valueConverter),k=D instanceof Un?!!D.value:!0;this.allocateBindingSlots(D),M.push({span:C.sourceSpan,reference:E.property,paramsOrFn:J_(()=>k?this.convertPropertyBinding(D):y,EL(C.name))})}else{if(C.i18n)return;let D=C.value.visit(this._valueConverter);if(D!==void 0){let k=[],[U,F]=ua(C.name),H=N===1,V=YB(C.securityContext,H);if(V||xee(t.name)&&hS(C.name)&&(V=Le(E.validateIframeAttribute)),V&&k.push(V),U){let Q=L(U);V?k.push(Q):k.push(L(null),Q)}if(this.allocateBindingSlots(D),N===0||N===5)D instanceof zr?this.interpolatedUpdateInstruction(rL(D),i,F,C,D,k):M.push({span:C.sourceSpan,reference:N===5?E.twoWayProperty:E.property,paramsOrFn:J_(()=>this.convertPropertyBinding(D),F,k)});else if(N===1)if(D instanceof zr&&ku(D)>1)this.interpolatedUpdateInstruction(pee(D),i,F,C,D,k);else{let Q=D instanceof zr?D.expressions[0]:D;T.push({span:C.sourceSpan,paramsOrFn:J_(()=>this.convertPropertyBinding(Q),F,k)})}else this.updateInstructionWithAdvance(i,C.sourceSpan,E.classProp,()=>[L(i),L(F),this.convertPropertyBinding(D),...k])}}});for(let C of M)this.updateInstructionWithAdvance(i,C.span,C.reference,C.paramsOrFn);for(let C of T)this.updateInstructionWithAdvance(i,C.span,E.attribute,C.paramsOrFn);if(Vf(this,t.children),!a&&this.i18n&&this.i18n.appendElement(t.i18n,i,!0),!b){let C=t.endSourceSpan??t.sourceSpan;a&&this.i18nEnd(C,_),n&&this.creationInstruction(C,E.enableBindings),this.creationInstruction(C,c?E.elementContainerEnd:E.elementEnd)}}prepareEmbeddedTemplateFn(t,i,r=[],n,a){let o=this.allocateDataSlot();this.i18n&&n&&(n instanceof Rl?this.i18n.appendBlock(n,o):this.i18n.appendTemplate(n,o));let s=`${this.contextName}${i}_${o}`,l=this.constantPool.uniqueName(`${s}_Template`,!1),c=new e(this.constantPool,this._bindingScope,this.level+1,s,this.i18n,o,l,this._namespace,this.fileBasedI18nSuffix,this.i18nUseExternalIds,this.deferBlocks,this.elementLocations,this.allDeferrableDepsFn,this._constants);return this._nestedTemplateFns.push(()=>{let d=c.buildTemplateFunction(t,r,this._ngContentReservedSlots.length+this._ngContentSelectorsOffset,n,a);this.constantPool.statements.push(d.toDeclStmt(l)),c._ngContentReservedSlots.length&&this._ngContentReservedSlots.push(...c._ngContentReservedSlots)}),new H2(l,o,c._bindingScope,c)}createEmbeddedTemplateFn(t,i,r,n,a=[],o,s,l){let c=this.prepareEmbeddedTemplateFn(i,r,a,l),d=[L(c.index),et(c.name),L(t),this.addAttrsToConsts(o||null)];if(s&&s.length>0){let u=this.prepareRefsArray(s);d.push(this.addToConsts(u)),d.push(Le(E.templateRefExtractor))}return this.creationInstruction(n,E.templateCreate,()=>(d.splice(2,0,L(c.getConstCount()),L(c.getVarCount())),jh(d))),c.index}visitTemplate(t){let i=t.tagName?ua(t.tagName)[1]:t.tagName,r=t.tagName?"_"+Vs(t.tagName):"",n=this.getAttributeExpressions(Q_,t.attributes,t.inputs,t.outputs,void 0,t.templateAttrs),a=this.createEmbeddedTemplateFn(i,t.children,r,t.sourceSpan,t.variables,n,t.references,t.i18n);if(this.templatePropertyBindings(a,t.templateAttrs),i===Q_){let[o,s]=RW(t.inputs,oq);o.length>0&&this.i18nAttributesInstruction(a,o,t.startSourceSpan??t.sourceSpan),s.length>0&&this.templatePropertyBindings(a,s);for(let l of t.outputs)this.creationInstruction(l.sourceSpan,l.type===2?E.twoWayListener:E.listener,this.prepareListenerParameter("ng_template",l,a))}}visitBoundText(t){if(this.i18n){let n=t.value.visit(this._valueConverter);this.allocateBindingSlots(n),n instanceof zr&&(this.i18n.appendBoundText(t.i18n),this.i18nAppendBindings(n.expressions));return}let i=this.allocateDataSlot();this.creationInstruction(t.sourceSpan,E.text,[L(i)]);let r=t.value.visit(this._valueConverter);this.allocateBindingSlots(r),r instanceof zr?this.updateInstructionWithAdvance(i,t.sourceSpan,fee(r),()=>this.getUpdateInstructionArguments(r)):fb("Text nodes should be interpolated and never bound directly.")}visitText(t){this.i18n||this.creationInstruction(t.sourceSpan,E.text,[L(this.allocateDataSlot()),L(t.value)])}visitIcu(t){let i=!1;this.i18n||(i=!0,this.i18nStart(null,t.i18n,!0));let r=this.i18n,n=this.i18nBindProps(t.vars),a=this.i18nBindProps(t.placeholders),o=t.i18n,s=l=>{let c=Object.fromEntries(Object.entries(Z(Z({},n),a)).sort()),d=Tg(c,!1);return vu(null,E.i18nPostprocess,[l,gg(d,!0)])};if(Ff(r.meta))this.i18nTranslate(o,{},r.ref,s);else{let l=this.i18nTranslate(o,{},void 0,s);r.appendIcu(oS(o).name,l)}return i&&this.i18nEnd(null,!0),null}visitIfBlock(t){this.allocateBindingSlots(null);let i=t.branches.map((a,o)=>{let{expression:s,expressionAlias:l,children:c,sourceSpan:d}=a,u=l!==null?[new Pl(l.name,OE,l.sourceSpan,l.keySpan)]:void 0,h=null,m;if(o===0){let g=this.inferProjectionDataFromInsertionPoint(a);h=g.tagName,m=g.attrsExprs}let f=this.createEmbeddedTemplateFn(h,c,"_Conditional",d,u,m,void 0,a.i18n),p=s===null?null:s.visit(this._valueConverter);return{index:f,expression:p,alias:l}}),r=i[0].index,n=()=>{let a=null,o=l=>{if(l>i.length-1)return L(-1);let{index:c,expression:d,alias:u}=i[l];if(d===null)return L(c);let h;return u?(a=this.allocateControlFlowTempVariable(),h=a.set(this.convertPropertyBinding(d))):h=this.convertPropertyBinding(d),h.conditional(L(c),o(l+1))},s=[L(r),o(0)];return a!==null&&s.push(a),s};this.updateInstructionWithAdvance(r,t.branches[0].sourceSpan,E.conditional,n)}visitSwitchBlock(t){if(t.cases.length===0)return;let i=t.cases.map(a=>{let o=this.createEmbeddedTemplateFn(null,a.children,"_Case",a.sourceSpan,void 0,void 0,void 0,a.i18n),s=a.expression===null?null:a.expression.visit(this._valueConverter);return{index:o,expression:s}}),r=i[0].index,n=t.expression.visit(this._valueConverter);this.allocateBindingSlots(null),this.updateInstructionWithAdvance(r,t.sourceSpan,E.conditional,()=>{let a=o=>{if(o>i.length-1)return L(-1);let{index:s,expression:l}=i[o];return l===null?L(s):(o===0?this.allocateControlFlowTempVariable().set(this.convertPropertyBinding(n)):this.allocateControlFlowTempVariable()).identical(this.convertPropertyBinding(l)).conditional(L(s),a(o+1))};return[L(r),a(0)]})}visitDeferredBlock(t){let{loading:i,placeholder:r,error:n,triggers:a,prefetchTriggers:o}=t,s=this.deferBlocks.get(t);if(!s)throw new Error("Could not resolve `defer` block metadata. Block may need to be analyzed.");let l=this.createEmbeddedTemplateFn(null,t.children,"_Defer",t.sourceSpan,void 0,void 0,void 0,t.i18n),c=i?this.createEmbeddedTemplateFn(null,i.children,"_DeferLoading",i.sourceSpan,void 0,void 0,void 0,i.i18n):null,d=i?jh([L(i.minimumTime),L(i.afterTime)]):null,u=r?this.createEmbeddedTemplateFn(null,r.children,"_DeferPlaceholder",r.sourceSpan,void 0,void 0,void 0,r.i18n):null,h=r&&r.minimumTime!==null?zt([L(r.minimumTime)]):null,m=n?this.createEmbeddedTemplateFn(null,n.children,"_DeferError",n.sourceSpan,void 0,void 0,void 0,n.i18n):null,f=this.allocateDataSlot(),p=`${this.contextName}_Defer_${f}_DepsFn`;this.creationInstruction(t.sourceSpan,E.defer,jh([L(f),L(l),this.allDeferrableDepsFn??this.createDeferredDepsFunction(p,s),L(c),L(u),L(m),d?.length?this.addToConsts(zt(d)):kc,h?this.addToConsts(h):kc,d?.length||h?Le(E.deferEnableTimerScheduling):kc])),this.allocateDataSlot(),this.createDeferTriggerInstructions(f,a,s,!1),this.createDeferTriggerInstructions(f,o,s,!0)}createDeferredDepsFunction(t,i){if(i.deps.length===0)return kc;let r=[];for(let a of i.deps)if(a.isDeferrable){let o=vn([new er("m",Ul)],et("m").prop(a.isDefaultImport?"default":a.symbolName)),s=new Xf(a.importPath).prop("then").callFn([o]);r.push(s)}else r.push(a.type);let n=vn([],zt(r));return this.constantPool.statements.push(n.toDeclStmt(t,Sn.Final)),et(t)}createDeferTriggerInstructions(t,i,r,n){let{when:a,idle:o,immediate:s,timer:l,hover:c,interaction:d,viewport:u}=i;if(a){let h=a.value.visit(this._valueConverter);this.allocateBindingSlots(h),this.updateInstructionWithAdvance(t,a.sourceSpan,n?E.deferPrefetchWhen:E.deferWhen,()=>this.convertPropertyBinding(h))}(o||!n&&Object.keys(i).length===0)&&this.creationInstruction(o?.sourceSpan||null,n?E.deferPrefetchOnIdle:E.deferOnIdle),s&&this.creationInstruction(s.sourceSpan,n?E.deferPrefetchOnImmediate:E.deferOnImmediate),l&&this.creationInstruction(l.sourceSpan,n?E.deferPrefetchOnTimer:E.deferOnTimer,[L(l.delay)]),c&&this.domNodeBasedTrigger("hover",c,r,n?E.deferPrefetchOnHover:E.deferOnHover),d&&this.domNodeBasedTrigger("interaction",d,r,n?E.deferPrefetchOnInteraction:E.deferOnInteraction),u&&this.domNodeBasedTrigger("viewport",u,r,n?E.deferPrefetchOnViewport:E.deferOnViewport)}domNodeBasedTrigger(t,i,r,n){let a=r.triggerElements.get(i);a&&this.creationInstruction(i.sourceSpan,n,()=>{let o=this.elementLocations.get(a);if(!o)throw new Error(`Could not determine location of reference passed into '${t}' trigger. Template may not have been fully analyzed.`);let s=Math.max(this.level-o.level,-1),l=[L(o.index)];return s!==0&&l.push(L(s)),l})}inferProjectionDataFromInsertionPoint(t){let i=null,r=null,n;for(let a of t.children)if(!(a instanceof mm)){if(i!==null){i=null;break}(a instanceof pa||a instanceof La&&a.tagName!==null)&&(i=a)}if(i!==null){let a=i instanceof pa?i.name:i.tagName;r=a===Q_?null:a,n=this.getAttributeExpressions(Q_,i.attributes,i.inputs,[])}return{tagName:r,attrsExprs:n}}allocateDataSlot(){return this._dataIndex++}visitForLoopBlock(t){let i=this.allocateDataSlot(),{tagName:r,attrsExprs:n}=this.inferProjectionDataFromInsertionPoint(t),a=this.prepareEmbeddedTemplateFn(t.children,"_For",[t.item,t.contextVariables.$index,t.contextVariables.$count],t.i18n,{[t.contextVariables.$index.name]:this.getLevelSpecificVariableName("$index",this.level+1),[t.contextVariables.$count.name]:this.getLevelSpecificVariableName("$count",this.level+1)}),{expression:o,usesComponentInstance:s}=this.createTrackByFunction(t),l=null,c=null,d;if(t.empty!==null){let h=this.inferProjectionDataFromInsertionPoint(t.empty);c=h.tagName,d=h.attrsExprs,l=this.prepareEmbeddedTemplateFn(t.empty.children,"_ForEmpty",void 0,t.empty.i18n),this.allocateBindingSlots(null)}this.registerComputedLoopVariables(t,a.scope),this.creationInstruction(t.sourceSpan,E.repeaterCreate,()=>{let h=[L(i),et(a.name),L(a.getConstCount()),L(a.getVarCount()),L(r),this.addAttrsToConsts(n||null),o];return l!==null?h.push(L(s),et(l.name),L(l.getConstCount()),L(l.getVarCount()),L(c),this.addAttrsToConsts(d||null)):s&&h.push(L(s)),jh(h)});let u=t.expression.visit(this._valueConverter);this.updateInstructionWithAdvance(i,t.sourceSpan,E.repeater,()=>[this.convertPropertyBinding(u)])}registerComputedLoopVariables(t,i){let r=i.bindingLevel;i.set(r,t.contextVariables.$odd.name,(n,a)=>this.getLevelSpecificForLoopVariable(t,n,a,"$index").modulo(L(2)).notIdentical(L(0))),i.set(r,t.contextVariables.$even.name,(n,a)=>this.getLevelSpecificForLoopVariable(t,n,a,"$index").modulo(L(2)).identical(L(0))),i.set(r,t.contextVariables.$first.name,(n,a)=>this.getLevelSpecificForLoopVariable(t,n,a,"$index").identical(L(0))),i.set(r,t.contextVariables.$last.name,(n,a)=>{let o=this.getLevelSpecificForLoopVariable(t,n,a,"$index"),s=this.getLevelSpecificForLoopVariable(t,n,a,"$count");return o.identical(s.minus(L(1)))})}getLevelSpecificVariableName(t,i){return`\u0275${t}_${i}`}getLevelSpecificForLoopVariable(t,i,r,n){let a=i.bindingLevel===r?t.contextVariables[n].name:this.getLevelSpecificVariableName(n,r);return i.get(a)}optimizeTrackByFunction(t){let i=t.contextVariables.$index.name,r=t.item.name,n=t.trackBy.ast;if(n instanceof fn&&n.receiver instanceof Hn&&n.name===i)return{expression:Le(E.repeaterTrackByIndex),usesComponentInstance:!1};if(n instanceof fn&&n.receiver instanceof Hn&&n.name===r)return{expression:Le(E.repeaterTrackByIdentity),usesComponentInstance:!1};if(n instanceof js&&n.receiver instanceof fn&&n.receiver.receiver instanceof Hn&&n.args.length===2){let a=n.args[0]instanceof fn&&n.args[0].receiver instanceof Hn&&n.args[0].name===i,o=n.args[1]instanceof fn&&n.args[1].receiver instanceof Hn&&n.args[1].name===r;if(a&&o)return{expression:(this.level===0?et(la):new Il(E.componentInstance).callFn([])).prop(n.receiver.name),usesComponentInstance:!1}}return null}createTrackByFunction(t){let i=this.optimizeTrackByFunction(t);if(i!==null)return i;let r=t.contextVariables,n=new W2(this._bindingScope,{[r.$index.name]:"$index",[t.item.name]:"$item",[r.$count.name]:r.$count.name,[r.$first.name]:r.$first.name,[r.$last.name]:r.$last.name,[r.$even.name]:r.$even.name,[r.$odd.name]:r.$odd.name}),a=[new er("$index"),new er("$item")],o=Zq(t.trackBy.ast,n,et(la),"track"),s=n.getComponentAccessCount()>0,l;if(!s&&o.length===1&&o[0]instanceof bn)l=vn(a,o[0].expr);else{if(o.length>0){let c=o[o.length-1];c instanceof bn&&(o[o.length-1]=new Jr(c.expr))}l=Gs(a,o)}return{expression:this.constantPool.getSharedFunctionReference(l,"_forTrack"),usesComponentInstance:s}}getConstCount(){return this._dataIndex}getVarCount(){return this._pureFunctionSlots}getConsts(){return this._constants}getNgContentSelectors(){return this._ngContentReservedSlots.length?this.constantPool.getConstLiteral(hs(this._ngContentReservedSlots),!0):null}bindingContext(){return`${this._bindingContext++}`}templatePropertyBindings(t,i){let r=[];for(let n of i){if(!(n instanceof _b))continue;let a=n.value.visit(this._valueConverter);if(a!==void 0)if(this.allocateBindingSlots(a),a instanceof zr){let o=[];this.interpolatedUpdateInstruction(rL(a),t,n.name,n,a,o)}else r.push({span:n.sourceSpan,paramsOrFn:J_(()=>this.convertPropertyBinding(a),n.name)})}for(let n of r)this.updateInstructionWithAdvance(t,n.span,E.property,n.paramsOrFn)}instructionFn(t,i,r,n,a=!1){t[a?"unshift":"push"]({span:i,reference:r,paramsOrFn:n})}processStylingUpdateInstruction(t,i){let r=0;if(i)for(let n of i.calls)r+=n.allocateBindingSlots,this.updateInstructionWithAdvance(t,n.sourceSpan,i.reference,()=>n.params(a=>n.supportsInterpolation&&a instanceof zr?this.getUpdateInstructionArguments(a):this.convertPropertyBinding(a)));return r}creationInstruction(t,i,r,n){this.instructionFn(this._creationCodeFns,t,i,r||[],n)}updateInstructionWithAdvance(t,i,r,n){this.addAdvanceInstructionIfNecessary(t,i),this.updateInstruction(i,r,n)}updateInstruction(t,i,r){this.instructionFn(this._updateCodeFns,t,i,r||[])}addAdvanceInstructionIfNecessary(t,i){if(t!==this._currentIndex){let r=t-this._currentIndex;if(r<1)throw new Error("advance instruction can only go forwards");this.instructionFn(this._updateCodeFns,i,E.advance,r>1?[L(r)]:[]),this._currentIndex=t}}allocatePureFunctionSlots(t){let i=this._pureFunctionSlots;return this._pureFunctionSlots+=t,i}allocateBindingSlots(t){this._bindingSlots+=t instanceof zr?t.expressions.length:1}getImplicitReceiverExpr(){return this._implicitReceiverExpr?this._implicitReceiverExpr:this._implicitReceiverExpr=this.level===0?et(la):this._bindingScope.getOrCreateSharedContextVar(0)}convertPropertyBinding(t){let i=XL(this,this.getImplicitReceiverExpr(),t,this.bindingContext()),r=i.currValExpr;return this._tempVariables.push(...i.stmts),r}getUpdateInstructionArguments(t){let{args:i,stmts:r}=Kq(this,this.getImplicitReceiverExpr(),t,this.bindingContext());return this._tempVariables.push(...r),i}allocateControlFlowTempVariable(){if(this._controlFlowTempVariable===null){let t=`${this.contextName}_contFlowTmp`;this._tempVariables.push(new Wn(t)),this._controlFlowTempVariable=et(t)}return this._controlFlowTempVariable}getAttributeExpressions(t,i,r,n,a,o=[],s=[]){let l=new Set,c=[],d;for(let h of i)if(h.name===oee&&(d=h),h.i18n){let{i18nVarRefsCache:m}=this._constants,f;m.has(h.i18n)?f=m.get(h.i18n):(f=this.i18nTranslate(h.i18n),m.set(h.i18n,f)),c.push(L(h.name),f)}else c.push(...iL(h.name),vee(t,h));d&&c.push(...mee(d));function u(h,m){typeof h=="string"?l.has(h)||(c.push(...iL(h)),m!==void 0&&c.push(m),l.add(h)):c.push(L(h))}if(a&&a.populateInitialStylingAttrs(c),r.length||n.length){let h=c.length;for(let m=0;m<r.length;m++){let f=r[m];f.type!==4&&f.type!==1&&u(f.name)}for(let m=0;m<n.length;m++){let f=n[m];f.type!==1&&u(f.name)}c.length!==h&&c.splice(h,0,L(3))}return o.length&&(c.push(L(4)),o.forEach(h=>u(h.name))),s.length&&(c.push(L(6)),s.forEach(h=>u(h.name))),c}addToConsts(t){if(xL(t))return kc;let i=this._constants.constExpressions;for(let r=0;r<i.length;r++)if(i[r].isEquivalent(t))return L(r);return L(i.push(t)-1)}addAttrsToConsts(t){return t!==null&&t.length>0?this.addToConsts(zt(t)):kc}prepareRefsArray(t){if(!t||t.length===0)return kc;let i=t.flatMap(r=>{let n=this.allocateDataSlot(),a=this._bindingScope.freshReferenceName(),o=this.level,s=et(a);return this._bindingScope.set(o,r.name,s,0,(l,c)=>{let d=c>0?[j2(c).toStmt()]:[],u=s.set(Le(E.reference).callFn([L(n)]));return d.concat(u.toConstDecl())},!0),[r.name,r.value]});return hs(i)}prepareListenerParameter(t,i,r){return()=>{let n=i.name,a=i.type===1?SL(n,i.phase):Vs(n),o=`${this.templateName}_${t}_${a}_${r}_listener`,s=this._bindingScope.nestedScope(this._bindingScope.bindingLevel,U2);return $B(i,o,s)}}},dx=class extends jE{constructor(t,i,r,n){super(),this.constantPool=t,this.allocateSlot=i,this.allocatePureFunctionSlots=r,this.definePipe=n,this._pipeBindExprs=[]}visitPipe(t,i){let r=this.allocateSlot(),n=`PIPE:${r}`,a=this.allocatePureFunctionSlots(2+t.args.length),o=new fn(t.span,t.sourceSpan,t.nameSpan,new Hn(t.span,t.sourceSpan),n),{identifier:s,isVarLength:l}=dee(t.args);this.definePipe(t.name,n,r,Le(s));let c=[t.exp,...t.args],d=l?this.visitAll([new Cu(t.span,t.sourceSpan,c)]):this.visitAll(c),u=new js(t.span,t.sourceSpan,o,[new Un(t.span,t.sourceSpan,r),new Un(t.span,t.sourceSpan,a),...d],null);return this._pipeBindExprs.push(u),u}updatePipeSlotOffsets(t){this._pipeBindExprs.forEach(i=>{let r=i.args[1];r.value+=t})}visitLiteralArray(t,i){return new Vc(t.span,t.sourceSpan,this.visitAll(t.expressions),r=>{let n=zt(r);return tL(this.constantPool,n,this.allocatePureFunctionSlots)})}visitLiteralMap(t,i){return new Vc(t.span,t.sourceSpan,this.visitAll(t.values),r=>{let n=xn(r.map((a,o)=>({key:t.keys[o].key,value:a,quoted:t.keys[o].quoted})));return tL(this.constantPool,n,this.allocatePureFunctionSlots)})}},cee=[E.pipeBind1,E.pipeBind2,E.pipeBind3,E.pipeBind4];function dee(e){let t=cee[e.length];return{identifier:t||E.pipeBindV,isVarLength:!t}}var uee=[E.pureFunction0,E.pureFunction1,E.pureFunction2,E.pureFunction3,E.pureFunction4,E.pureFunction5,E.pureFunction6,E.pureFunction7,E.pureFunction8];function hee(e){let t=uee[e.length];return{identifier:t||E.pureFunctionV,isVarLength:!t}}function j2(e){return Le(E.nextContext).callFn(e>1?[L(e)]:[])}function tL(e,t,i){let{literalFactory:r,literalFactoryArguments:n}=e.getLiteralFactory(t),a=i(1+n.length),{identifier:o,isVarLength:s}=hee(n),l=[L(a),r];return s?l.push(zt(n)):l.push(...n),Le(o).callFn(l)}function iL(e){let[t,i]=ua(e),r=L(i);return t?[L(0),L(t),r]:[r]}var Xh="$$shared_ctx$$",ux=class e{static createRootScope(){return new e}constructor(t=0,i=null,r){if(this.bindingLevel=t,this.parent=i,this.globals=r,this.map=new Map,this.referenceNameIndex=0,this.restoreViewVariable=null,this.usesRestoredViewContext=!1,r!==void 0)for(let n of r)this.set(0,n,et(n))}get(t){let i=this;for(;i;){let r=i.map.get(t);if(r!=null)return i!==this&&(r={retrievalLevel:r.retrievalLevel,lhs:r.lhs,declareLocalCallback:r.declareLocalCallback,declare:!1,priority:r.priority},this.map.set(t,r),this.maybeGenerateSharedContextVar(r),this.maybeRestoreView()),r.declareLocalCallback&&!r.declare&&(r.declare=!0),typeof r.lhs=="function"?r.lhs(this,r.retrievalLevel):r.lhs;i=i.parent}return this.bindingLevel===0?null:this.getComponentProperty(t)}hasLocal(t){return this.map.has(t)}set(t,i,r,n=0,a,o){if(this.map.has(i)){if(o)return this;fb(`The name ${i} is already defined in scope to be ${this.map.get(i)}`)}return this.map.set(i,{retrievalLevel:t,lhs:r,declare:!1,declareLocalCallback:a,priority:n}),this}getLocal(t){return this.get(t)}notifyImplicitReceiverUse(){this.bindingLevel!==0&&(this.map.get(Xh+0).declare=!0)}nestedScope(t,i){let r=new e(t,this,i);return t>0&&r.generateSharedContextVar(0),r}getOrCreateSharedContextVar(t){let i=Xh+t;return this.map.has(i)||this.generateSharedContextVar(t),this.map.get(i).lhs}getSharedContextName(t){let i=this.map.get(Xh+t);return i&&i.declare?i.lhs:null}maybeGenerateSharedContextVar(t){if(t.priority===1&&t.retrievalLevel<this.bindingLevel){let i=this.map.get(Xh+t.retrievalLevel);i?i.declare=!0:this.generateSharedContextVar(t.retrievalLevel)}}generateSharedContextVar(t){let i=et(la+this.freshReferenceName());this.map.set(Xh+t,{retrievalLevel:t,lhs:i,declareLocalCallback:(r,n)=>[i.set(j2(n)).toConstDecl()],declare:!1,priority:2})}getComponentProperty(t){let i=this.map.get(Xh+0);i.declare=!0,this.maybeRestoreView();let r=typeof i.lhs=="function"?i.lhs(this,i.retrievalLevel):i.lhs;return t===OE?r:r.prop(t)}maybeRestoreView(){this.isListenerScope()&&(this.parent.restoreViewVariable||(this.parent.restoreViewVariable=et(this.parent.freshReferenceName())),this.restoreViewVariable=this.parent.restoreViewVariable)}restoreViewStatement(){if(this.restoreViewVariable){let t=vu(null,E.restoreView,[this.restoreViewVariable]);return this.usesRestoredViewContext?et(IL).set(t).toConstDecl():t.toStmt()}return null}viewSnapshotStatements(){return this.restoreViewVariable?[this.restoreViewVariable.set(vu(null,E.getCurrentView,[])).toConstDecl()]:[]}isListenerScope(){return this.parent&&this.parent.bindingLevel===this.bindingLevel}variableDeclarations(){let t=0;return Array.from(this.map.values()).filter(i=>i.declare).sort((i,r)=>r.retrievalLevel-i.retrievalLevel||r.priority-i.priority).reduce((i,r)=>{let n=this.bindingLevel-r.retrievalLevel,a=r.declareLocalCallback(this,n-t);return t=n,i.concat(a)},[])}freshReferenceName(){let t=this;for(;t.parent;)t=t.parent;return`${uq}${t.referenceNameIndex++}`}hasRestoreViewVariable(){return!!this.restoreViewVariable}notifyRestoredViewContextUse(){this.usesRestoredViewContext=!0}},W2=class extends ux{constructor(t,i){super(t.bindingLevel+1,t),this.globalOverrides=i,this.componentAccessCount=0}get(t){if(this.globalOverrides.hasOwnProperty(t))return et(this.globalOverrides[t]);let i=this.parent;for(;i;){if(i.hasLocal(t))return null;i=i.parent}return this.componentAccessCount++,et("this").prop(t)}getComponentAccessCount(){return this.componentAccessCount}};function mee(e){let t=Cg(e.value)[0];return[L(5),hs(t)]}function rL(e){switch(ku(e)){case 1:return E.propertyInterpolate;case 3:return E.propertyInterpolate1;case 5:return E.propertyInterpolate2;case 7:return E.propertyInterpolate3;case 9:return E.propertyInterpolate4;case 11:return E.propertyInterpolate5;case 13:return E.propertyInterpolate6;case 15:return E.propertyInterpolate7;case 17:return E.propertyInterpolate8;default:return E.propertyInterpolateV}}function pee(e){switch(ku(e)){case 3:return E.attributeInterpolate1;case 5:return E.attributeInterpolate2;case 7:return E.attributeInterpolate3;case 9:return E.attributeInterpolate4;case 11:return E.attributeInterpolate5;case 13:return E.attributeInterpolate6;case 15:return E.attributeInterpolate7;case 17:return E.attributeInterpolate8;default:return E.attributeInterpolateV}}function fee(e){switch(ku(e)){case 1:return E.textInterpolate;case 3:return E.textInterpolate1;case 5:return E.textInterpolate2;case 7:return E.textInterpolate3;case 9:return E.textInterpolate4;case 11:return E.textInterpolate5;case 13:return E.textInterpolate6;case 15:return E.textInterpolate7;case 17:return E.textInterpolate8;default:return E.textInterpolateV}}function gee(e,t,i={}){let{interpolationConfig:r,preserveWhitespaces:n,enableI18nLegacyMessageIdFormat:a}=i,o=hx(r),l=new k2().parse(e,t,Bt(Z({leadingTriviaChars:see},i),{tokenizeExpansionForms:!0,tokenizeBlocks:i.enableBlockSyntax??!0}));if(!i.alwaysAttemptHtmlToR3AstConversion&&l.errors&&l.errors.length>0){let _={interpolationConfig:r,preserveWhitespaces:n,errors:l.errors,nodes:[],styleUrls:[],styles:[],ngContentSelectors:[]};return i.collectCommentNodes&&(_.commentNodes=[]),_}let c=l.rootNodes,d=new nx(r,!n,a),u=d.visitAllWithErrors(c);if(!i.alwaysAttemptHtmlToR3AstConversion&&u.errors&&u.errors.length>0){let _={interpolationConfig:r,preserveWhitespaces:n,errors:u.errors,nodes:[],styleUrls:[],styles:[],ngContentSelectors:[]};return i.collectCommentNodes&&(_.commentNodes=[]),_}c=u.rootNodes,n||(c=Ar(new N2,c),d.hasI18nMeta&&(c=Ar(new nx(r,!1),c)));let{nodes:h,errors:m,styleUrls:f,styles:p,ngContentSelectors:g,commentNodes:v}=$J(c,o,{collectCommentNodes:!!i.collectCommentNodes});m.push(...l.errors,...u.errors);let b={interpolationConfig:r,preserveWhitespaces:n,errors:m.length>0?m:null,nodes:h,styleUrls:f,styles:p,ngContentSelectors:g};return i.collectCommentNodes&&(b.commentNodes=v),b}var XB=new Dm;function hx(e=Fs){return new P2(new Jb(new vg),e,XB,[])}function YB(e,t){switch(e){case gi.HTML:return Le(E.sanitizeHtml);case gi.SCRIPT:return Le(E.sanitizeScript);case gi.STYLE:return t?Le(E.sanitizeStyle):null;case gi.URL:return Le(E.sanitizeUrl);case gi.RESOURCE_URL:return Le(E.sanitizeResourceUrl);default:return null}}function vee(e,t){let i=hs(t.value);if(_B(e,t.name))switch(XB.securityContext(e,t.name,!0)){case gi.HTML:return bE(Le(E.trustConstantHtml),new qf([new $f(t.value)],[]),void 0,t.valueSpan);case gi.RESOURCE_URL:return bE(Le(E.trustConstantResourceUrl),new qf([new $f(t.value)],[]),void 0,t.valueSpan);default:return i}else return i}function _ee(e){return e.length===1&&e[0]instanceof pa}function bee(e){return e instanceof Dl||e instanceof fu||e instanceof ig}function xee(e){return e.toLowerCase()==="iframe"}function uE(e){return e.every(bee)}function J_(e,t,i){return()=>{let r=e(),n=Array.isArray(r)?r:[r];return i&&n.push(...i),t&&n.unshift(L(t)),n}}var nL="ngI18nClosureMode";function yee(e,t,i,r={},n){r=Object.fromEntries(Object.entries(r).sort());let a=[ML(t),Ag(wee(),bB(t,e,i,r),xB(t,e,Tg(r,!1)))];return n&&a.push(new bn(t.set(n(t)))),a}function wee(){return Sg(et(nL)).notIdentical(L("undefined",nS)).and(et(nL))}function Cee(e){return(e.descendants?1:0)|(e.static?2:0)|(e.emitDistinctChangesOnly?4:0)}function Eee(e,t){if(Array.isArray(e.predicate)){let i=[];return e.predicate.forEach(r=>{let n=r.split(",").map(a=>L(a.trim()));i.push(...n)}),t.getConstLiteral(zt(i),!0)}else switch(e.predicate.forwardRef){case 0:case 2:return e.predicate.expression;case 1:return Le(E.resolveForwardRef).callFn([e.predicate.expression])}}function ZB(e,t,i,r){let n=[];r!==void 0&&n.push(...r),e.isSignal&&n.push(new ma(et(la),e.propertyName)),n.push(Eee(e,t),L(Cee(e))),e.read&&n.push(e.read);let a=e.isSignal?i.signalBased:i.nonSignal;return Le(a).callFn(n)}var ES=Symbol("queryAdvancePlaceholder");function KB(e){let t=[],i=0,r=()=>{i>0&&(t.unshift(Le(E.queryAdvance).callFn(i===1?[]:[L(i)]).toStmt()),i=0)};for(let n=e.length-1;n>=0;n--){let a=e[n];a===ES?i++:(r(),t.unshift(a))}return r(),t}function See(e,t,i){let r=[],n=[],a=kL(s=>n.push(s),sS);e.forEach(s=>{let l=ZB(s,t,{signalBased:E.viewQuerySignal,nonSignal:E.viewQuery});if(r.push(l.toStmt()),s.isSignal){n.push(ES);return}let c=a(),d=Le(E.loadQuery).callFn([]),u=Le(E.queryRefresh).callFn([c.set(d)]),h=et(la).prop(s.propertyName).set(s.first?c.prop("first"):c);n.push(u.and(h).toStmt())});let o=i?`${i}_Query`:null;return Gs([new er(Mg,Eg),new er(la,null)],[Zc(1,r),Zc(2,KB(n))],da,null,o)}function Aee(e,t,i){let r=[],n=[],a=kL(s=>n.push(s),sS);for(let s of e){if(r.push(ZB(s,t,{nonSignal:E.contentQuery,signalBased:E.contentQuerySignal},[et("dirIndex")]).toStmt()),s.isSignal){n.push(ES);continue}let l=a(),c=Le(E.loadQuery).callFn([]),d=Le(E.queryRefresh).callFn([l.set(c)]),u=et(la).prop(s.propertyName).set(s.first?l.prop("first"):l);n.push(d.and(u).toStmt())}let o=i?`${i}_ContentQueries`:null;return Gs([new er(Mg,Eg),new er(la,null),new er("dirIndex",null)],[Zc(1,r),Zc(2,KB(n))],da,null,o)}var Tee=/attr\.([^\]]+)/,QB="%COMP%",Dee=`_nghost-${QB}`,Mee=`_ngcontent-${QB}`;function JB(e,t,i){let r=new Uc,n=Cg(e.selector);return r.set("type",e.type.value),n.length>0&&r.set("selectors",hs(n)),e.queries.length>0&&r.set("contentQueries",Aee(e.queries,t,e.name)),e.viewQueries.length&&r.set("viewQuery",See(e.viewQueries,t,e.name)),r.set("hostBindings",Vee(e.host,e.typeSourceSpan,i,t,e.selector||"",e.name,r)),r.set("inputs",SO(e.inputs,!0)),r.set("outputs",SO(e.outputs)),e.exportAs!==null&&r.set("exportAs",zt(e.exportAs.map(a=>L(a)))),e.isStandalone&&r.set("standalone",L(!0)),e.isSignal&&r.set("signals",L(!0)),r}function e5(e,t){let i=[],r=t.providers,n=t.viewProviders,a=Object.keys(t.inputs);if(r||n){let o=[r||new Go([])];n&&o.push(n),i.push(Le(E.ProvidersFeature).callFn(o))}for(let o of a)if(t.inputs[o].transformFunction!==null){i.push(Le(E.InputTransformsFeatureFeature));break}t.hostDirectives?.length&&i.push(Le(E.HostDirectivesFeature).callFn([$ee(t.hostDirectives)])),t.usesInheritance&&i.push(Le(E.InheritDefinitionFeature)),t.fullInheritance&&i.push(Le(E.CopyDefinitionFeature)),t.lifecycle.usesOnChanges&&i.push(Le(E.NgOnChangesFeature)),t.hasOwnProperty("template")&&t.isStandalone&&i.push(Le(E.StandaloneFeature)),i.length&&e.set("features",zt(i))}function Iee(e,t,i){let r=JB(e,t,i);e5(r,e);let n=Le(E.defineDirective).callFn([r.toLiteralMap()],void 0,!0),a=Bee(e);return{expression:n,type:a,statements:[]}}function kee(e,t,i){let r=[];for(let[a,{importPath:o,isDefaultImport:s}]of i){let l=vn([new er("m",Ul)],et("m").prop(s?"default":a)),c=new Xf(o).prop("then").callFn([l]);r.push(c)}let n=vn([],zt(r));return e.statements.push(n.toDeclStmt(t,Sn.Final)),et(t)}function Nee(e,t,i){let r=JB(e,t,i);e5(r,e);let n=e.selector&&cm.parse(e.selector),a=n&&n[0];if(a){let u=a.getAttrs();u.length&&r.set("attrs",t.getConstLiteral(zt(u.map(h=>h!=null?L(h):L(void 0))),!0))}let o=e.name,s=o?`${o}_Template`:null,l=null;if(e.deferBlocks.size>0&&e.deferrableTypes.size>0&&e.deferBlockDepsEmitMode===1){let u=`${o}_DeferFn`;l=kee(t,u,e.deferrableTypes)}if(!BB&&!e.useTemplatePipeline){let u=e.template,h=new G2(t,ux.createRootScope(),0,o,null,null,s,E.namespaceHTML,e.relativeContextFilePath,e.i18nUseExternalIds,e.deferBlocks,new Map,l),m=h.buildTemplateFunction(u.nodes,[]),f=h.getNgContentSelectors();f&&r.set("ngContentSelectors",f),r.set("decls",L(h.getConstCount())),r.set("vars",L(h.getVarCount()));let{constExpressions:p,prepareStatements:g}=h.getConsts();if(p.length>0){let v=zt(p);g.length>0&&(v=vn([],[...g,new Jr(v)])),r.set("consts",v)}r.set("template",m)}else{let u=IQ(e.name,e.template.nodes,t,e.relativeContextFilePath,e.i18nUseExternalIds,e.deferBlocks,l);MB(u,Ze.Tmpl);let h=DQ(u,t);u.contentSelectors!==null&&r.set("ngContentSelectors",u.contentSelectors),r.set("decls",L(u.root.decls)),r.set("vars",L(u.root.vars)),u.consts.length>0&&(u.constsInitializers.length>0?r.set("consts",vn([],[...u.constsInitializers,new Jr(zt(u.consts))])):r.set("consts",zt(u.consts))),r.set("template",h)}if(e.declarationListEmitMode!==3&&e.declarations.length>0)r.set("dependencies",Ree(zt(e.declarations.map(u=>u.type)),e.declarationListEmitMode));else if(e.declarationListEmitMode===3){let u=[e.type.value];e.rawImports&&u.push(e.rawImports),r.set("dependencies",Le(E.getComponentDepsFactory).callFn(u))}if(e.encapsulation===null&&(e.encapsulation=Qd.Emulated),e.styles&&e.styles.length){let h=(e.encapsulation==Qd.Emulated?qee(e.styles,Mee,Dee):e.styles).reduce((m,f)=>(f.trim().length>0&&m.push(t.getConstLiteral(L(f))),m),[]);h.length>0&&r.set("styles",zt(h))}else e.encapsulation===Qd.Emulated&&(e.encapsulation=Qd.None);e.encapsulation!==Qd.Emulated&&r.set("encapsulation",L(e.encapsulation)),e.animations!==null&&r.set("data",xn([{key:"animation",value:e.animations,quoted:!1}])),e.changeDetection!==null&&(typeof e.changeDetection=="number"&&e.changeDetection!==iS.Default?r.set("changeDetection",L(e.changeDetection)):typeof e.changeDetection=="object"&&r.set("changeDetection",e.changeDetection));let c=Le(E.defineComponent).callFn([r.toLiteralMap()],void 0,!0),d=Pee(e);return{expression:c,type:d,statements:[]}}function Pee(e){let t=t5(e);return t.push($2(e.template.ngContentSelectors)),t.push(An(L(e.isStandalone))),t.push(i5(e)),e.isSignal&&t.push(An(L(e.isSignal))),An(Le(E.ComponentDeclaration,t))}function Ree(e,t){switch(t){case 0:return e;case 1:return vn([],e);case 2:let i=e.prop("map").callFn([Le(E.resolveForwardRef)]);return vn([],i);case 3:throw new Error("Unsupported with an array of pre-resolved dependencies")}}function Fee(e){let t=[];for(let i of Object.getOwnPropertyNames(e)){let r=e[i];t.push(L(i),r)}return t}function Oee(e){return An(L(e))}function q2(e){let t=Object.keys(e).map(i=>{let r=Array.isArray(e[i])?e[i][0]:e[i];return{key:i,value:L(r),quoted:!0}});return xn(t)}function $2(e){return e.length>0?An(zt(e.map(t=>L(t)))):Us}function t5(e){let t=e.selector!==null?e.selector.replace(/\n/g,""):null;return[mx(e.type.type,e.typeArgumentCount),t!==null?Oee(t):Us,e.exportAs!==null?$2(e.exportAs):Us,An(Lee(e)),An(q2(e.outputs)),$2(e.queries.map(i=>i.propertyName))]}function Lee(e){return xn(Object.keys(e.inputs).map(t=>{let i=e.inputs[t],r=[{key:"alias",value:L(i.bindingPropertyName),quoted:!0},{key:"required",value:L(i.required),quoted:!0}];return i.isSignal&&r.push({key:"isSignal",value:L(i.isSignal),quoted:!0}),{key:t,value:xn(r),quoted:!0}}))}function Bee(e){let t=t5(e);return t.push(Us),t.push(An(L(e.isStandalone))),t.push(i5(e)),e.isSignal&&t.push(An(L(e.isSignal))),An(Le(E.DirectiveDeclaration,t))}function Vee(e,t,i,r,n,a,o){let s=i.createBoundHostProperties(e.properties,t),l=i.createDirectiveHostEventAsts(e.listeners,t);if(BB||e.useTemplatePipeline){e.specialAttributes.styleAttr&&(e.attributes.style=L(e.specialAttributes.styleAttr)),e.specialAttributes.classAttr&&(e.attributes.class=L(e.specialAttributes.classAttr));let D=kQ({componentName:a,componentSelector:n,properties:s,events:l,attributes:e.attributes},i,r);MB(D,Ze.Host),o.set("hostAttrs",D.root.attributes);let k=D.root.vars;return k!==null&&k>0&&o.set("hostVars",L(k)),MQ(D)}let c=0,d=()=>`${c++}`,u=et(la),h=new cx(u),{styleAttr:m,classAttr:f}=e.specialAttributes;m!==void 0&&h.registerStyleAttr(m),f!==void 0&&h.registerClassAttr(f);let p=[],g=[],v=[],b=t;l&&l.length&&p.push(...Hee(l,a));let _=[],x=0;s&&s.forEach(D=>{h.registerInputBasedOnName(D.name,D.expression,b)?x+=lx:(_.push(D),x++)});let w,y=()=>{if(!w){let D=k=>{let U=x;return x+=k,U};w=new dx(r,()=>fb("Unexpected node"),D,()=>fb("Unexpected pipe"))}return w},M=[],T=[],C=[];for(let D of _){let k=D.expression.visit(y()),U=aL(u,k,d),{bindingName:F,instruction:H,isAttribute:V}=Uee(D),Q=i.calcPossibleSecurityContexts(n,F,V).filter(re=>re!==gi.NONE),$=null;Q.length&&(Q.length===2&&Q.indexOf(gi.URL)>-1&&Q.indexOf(gi.RESOURCE_URL)>-1?$=Le(E.sanitizeUrlOrResourceUrl):$=YB(Q[0],V));let ee=[L(F),U.currValExpr];$?ee.push($):hS(F)&&ee.push(Le(E.validateIframeAttribute)),v.push(...U.stmts),H===E.hostProperty?M.push(ee):H===E.attribute?T.push(ee):H===E.syntheticHostProperty?C.push(ee):g.push({reference:H,paramsOrFn:ee,span:null})}for(let D of M)g.push({reference:E.hostProperty,paramsOrFn:D,span:null});for(let D of T)g.push({reference:E.attribute,paramsOrFn:D,span:null});for(let D of C)g.push({reference:E.syntheticHostProperty,paramsOrFn:D,span:null});let N=Fee(e.attributes);if(h.assignHostAttrs(N,o),h.hasBindings&&h.buildUpdateLevelInstructions(y()).forEach(D=>{for(let k of D.calls){x+=Math.max(k.allocateBindingSlots-lx,0);let{params:U,stmts:F}=zee(k,u,aL,d);v.push(...F),g.push({reference:D.reference,paramsOrFn:U,span:null})}}),x&&o.set("hostVars",L(x)),p.length>0||g.length>0){let D=a?`${a}_HostBindings`:null,k=[];return p.length>0&&k.push(Zc(1,Mb(p))),g.length>0&&k.push(Zc(2,v.concat(Mb(g)))),Gs([new er(Mg,Eg),new er(la,null)],k,da,null,D)}return null}function aL(e,t,i){return XL(null,e,t,i())}function zee(e,t,i,r){let n=[];return{params:e.params(o=>{let s=i(t,o,r);return Array.isArray(s.stmts)&&s.stmts.length>0&&n.push(...s.stmts),s.currValExpr}),stmts:n}}function Uee(e){let t=e.name,i,r=t.match(Tee);return r?(t=r[1],i=E.attribute):e.isAnimation?(t=EL(t),i=E.syntheticHostProperty):i=E.hostProperty,{bindingName:t,instruction:i,isAttribute:!!r}}function Hee(e,t){let i=[],r=[],n=[];for(let a of e){let o=a.name&&Vs(a.name),s=a.type===1?SL(o,a.targetOrPhase):o,l=t&&o?`${t}_${s}_HostBindingHandler`:null,c=$B(bb.fromParsedEvent(a),l);a.type==1?r.push(c):i.push(c)}for(let a of r)n.push({reference:E.syntheticHostListener,paramsOrFn:a,span:null});for(let a of i)n.push({reference:E.listener,paramsOrFn:a,span:null});return n}var Gee=/^(?:\[([^\]]+)\])|(?:\(([^\)]+)\))$/;function jee(e){let t={},i={},r={},n={};for(let a of Object.keys(e)){let o=e[a],s=a.match(Gee);if(s===null)switch(a){case"class":if(typeof o!="string")throw new Error("Class binding must be string");n.classAttr=o;break;case"style":if(typeof o!="string")throw new Error("Style binding must be string");n.styleAttr=o;break;default:typeof o=="string"?t[a]=L(o):t[a]=o}else if(s[1]!=null){if(typeof o!="string")throw new Error("Property binding must be string");r[s[1]]=o}else if(s[2]!=null){if(typeof o!="string")throw new Error("Event binding must be string");i[s[2]]=o}}return{attributes:t,listeners:i,properties:r,specialAttributes:n}}function Wee(e,t){let i=hx();return i.createDirectiveHostEventAsts(e.listeners,t),i.createBoundHostProperties(e.properties,t),i.errors}function qee(e,t,i){let r=new ZE;return e.map(n=>r.shimCssText(n,t,i))}function i5(e){return e.hostDirectives?.length?An(zt(e.hostDirectives.map(t=>xn([{key:"directive",value:Sg(t.directive.type),quoted:!1},{key:"inputs",value:q2(t.inputs||{}),quoted:!1},{key:"outputs",value:q2(t.outputs||{}),quoted:!1}])))):Us}function $ee(e){let t=[],i=!1;for(let r of e){if(!r.inputs&&!r.outputs)t.push(r.directive.type);else{let n=[{key:"directive",value:r.directive.type,quoted:!1}];if(r.inputs){let a=oL(r.inputs);a&&n.push({key:"inputs",value:a,quoted:!1})}if(r.outputs){let a=oL(r.outputs);a&&n.push({key:"outputs",value:a,quoted:!1})}t.push(xn(n))}r.isForwardReference&&(i=!0)}return i?new du([],[new Jr(zt(t))]):zt(t)}function oL(e){let t=[];for(let i in e)e.hasOwnProperty(i)&&t.push(L(i),L(e[i]));return t.length>0?zt(t):null}var X2=class{constructor(t){this.directiveMatcher=t}bind(t){if(!t.template)throw new Error("Binding without a template not yet supported");let i=Y2.apply(t.template),r=Xee(i),{directives:n,eagerDirectives:a,bindings:o,references:s}=Z2.apply(t.template,this.directiveMatcher),{expressions:l,symbols:c,nestingLevel:d,usedPipes:u,eagerPipes:h,deferBlocks:m}=K2.applyWithScope(t.template,i);return new Q2(t,n,a,o,s,l,c,d,r,u,h,m)}},Y2=class e{constructor(t,i){this.parentScope=t,this.rootNode=i,this.namedEntities=new Map,this.elementsInScope=new Set,this.childScopes=new Map,this.isDeferred=t!==null&&t.isDeferred?!0:i instanceof gu}static newRootScope(){return new e(null,null)}static apply(t){let i=e.newRootScope();return i.ingest(t),i}ingest(t){t instanceof La?(t.variables.forEach(i=>this.visitVariable(i)),t.children.forEach(i=>i.visit(this))):t instanceof au?(t.expressionAlias!==null&&this.visitVariable(t.expressionAlias),t.children.forEach(i=>i.visit(this))):t instanceof fm?(this.visitVariable(t.item),Object.values(t.contextVariables).forEach(i=>this.visitVariable(i)),t.children.forEach(i=>i.visit(this))):t instanceof Jf||t instanceof eg||t instanceof gu||t instanceof Qf||t instanceof Zf||t instanceof Kf?t.children.forEach(i=>i.visit(this)):t.forEach(i=>i.visit(this))}visitElement(t){t.references.forEach(i=>this.visitReference(i)),t.children.forEach(i=>i.visit(this)),this.elementsInScope.add(t)}visitTemplate(t){t.references.forEach(i=>this.visitReference(i)),this.ingestScopedNode(t)}visitVariable(t){this.maybeDeclare(t)}visitReference(t){this.maybeDeclare(t)}visitDeferredBlock(t){this.ingestScopedNode(t),t.placeholder?.visit(this),t.loading?.visit(this),t.error?.visit(this)}visitDeferredBlockPlaceholder(t){this.ingestScopedNode(t)}visitDeferredBlockError(t){this.ingestScopedNode(t)}visitDeferredBlockLoading(t){this.ingestScopedNode(t)}visitSwitchBlock(t){t.cases.forEach(i=>i.visit(this))}visitSwitchBlockCase(t){this.ingestScopedNode(t)}visitForLoopBlock(t){this.ingestScopedNode(t),t.empty?.visit(this)}visitForLoopBlockEmpty(t){this.ingestScopedNode(t)}visitIfBlock(t){t.branches.forEach(i=>i.visit(this))}visitIfBlockBranch(t){this.ingestScopedNode(t)}visitContent(t){}visitBoundAttribute(t){}visitBoundEvent(t){}visitBoundText(t){}visitText(t){}visitTextAttribute(t){}visitIcu(t){}visitDeferredTrigger(t){}visitUnknownBlock(t){}maybeDeclare(t){this.namedEntities.has(t.name)||this.namedEntities.set(t.name,t)}lookup(t){return this.namedEntities.has(t)?this.namedEntities.get(t):this.parentScope!==null?this.parentScope.lookup(t):null}getChildScope(t){let i=this.childScopes.get(t);if(i===void 0)throw new Error(`Assertion error: child scope for ${t} not found`);return i}ingestScopedNode(t){let i=new e(this,t);i.ingest(t),this.childScopes.set(t,i)}},Z2=class e{constructor(t,i,r,n,a){this.matcher=t,this.directives=i,this.eagerDirectives=r,this.bindings=n,this.references=a,this.isInDeferBlock=!1}static apply(t,i){let r=new Map,n=new Map,a=new Map,o=[];return new e(i,r,o,n,a).ingest(t),{directives:r,eagerDirectives:o,bindings:n,references:a}}ingest(t){t.forEach(i=>i.visit(this))}visitElement(t){this.visitElementOrTemplate(t)}visitTemplate(t){this.visitElementOrTemplate(t)}visitElementOrTemplate(t){let i=gq(t),r=[];this.matcher.match(i,(a,o)=>r.push(...o)),r.length>0&&(this.directives.set(t,r),this.isInDeferBlock||this.eagerDirectives.push(...r)),t.references.forEach(a=>{let o=null;if(a.value.trim()==="")o=r.find(s=>s.isComponent)||null;else if(o=r.find(s=>s.exportAs!==null&&s.exportAs.some(l=>l===a.value))||null,o===null)return;o!==null?this.references.set(a,{directive:o,node:t}):this.references.set(a,t)});let n=(a,o)=>{let s=r.find(c=>c[o].hasBindingPropertyName(a.name)),l=s!==void 0?s:t;this.bindings.set(a,l)};t.inputs.forEach(a=>n(a,"inputs")),t.attributes.forEach(a=>n(a,"inputs")),t instanceof La&&t.templateAttrs.forEach(a=>n(a,"inputs")),t.outputs.forEach(a=>n(a,"outputs")),t.children.forEach(a=>a.visit(this))}visitDeferredBlock(t){let i=this.isInDeferBlock;this.isInDeferBlock=!0,t.children.forEach(r=>r.visit(this)),this.isInDeferBlock=i,t.placeholder?.visit(this),t.loading?.visit(this),t.error?.visit(this)}visitDeferredBlockPlaceholder(t){t.children.forEach(i=>i.visit(this))}visitDeferredBlockError(t){t.children.forEach(i=>i.visit(this))}visitDeferredBlockLoading(t){t.children.forEach(i=>i.visit(this))}visitSwitchBlock(t){t.cases.forEach(i=>i.visit(this))}visitSwitchBlockCase(t){t.children.forEach(i=>i.visit(this))}visitForLoopBlock(t){t.item.visit(this),Object.values(t.contextVariables).forEach(i=>i.visit(this)),t.children.forEach(i=>i.visit(this)),t.empty?.visit(this)}visitForLoopBlockEmpty(t){t.children.forEach(i=>i.visit(this))}visitIfBlock(t){t.branches.forEach(i=>i.visit(this))}visitIfBlockBranch(t){t.expressionAlias?.visit(this),t.children.forEach(i=>i.visit(this))}visitContent(t){}visitVariable(t){}visitReference(t){}visitTextAttribute(t){}visitBoundAttribute(t){}visitBoundEvent(t){}visitBoundAttributeOrEvent(t){}visitText(t){}visitBoundText(t){}visitIcu(t){}visitDeferredTrigger(t){}visitUnknownBlock(t){}},K2=class e extends Lb{constructor(t,i,r,n,a,o,s,l,c){super(),this.bindings=t,this.symbols=i,this.usedPipes=r,this.eagerPipes=n,this.deferBlocks=a,this.nestingLevel=o,this.scope=s,this.rootNode=l,this.level=c,this.visitNode=d=>d.visit(this)}visit(t,i){t instanceof Or?t.visit(this,i):t.visit(this)}static applyWithScope(t,i){let r=new Map,n=new Map,a=new Map,o=new Set,s=new Set,l=t instanceof La?t:null,c=new Map;return new e(r,n,o,s,c,a,i,l,0).ingest(t),{expressions:r,symbols:n,nestingLevel:a,usedPipes:o,eagerPipes:s,deferBlocks:c}}ingest(t){if(t instanceof La)t.variables.forEach(this.visitNode),t.children.forEach(this.visitNode),this.nestingLevel.set(t,this.level);else if(t instanceof au)t.expressionAlias!==null&&this.visitNode(t.expressionAlias),t.children.forEach(this.visitNode),this.nestingLevel.set(t,this.level);else if(t instanceof fm)this.visitNode(t.item),Object.values(t.contextVariables).forEach(i=>this.visitNode(i)),t.trackBy.visit(this),t.children.forEach(this.visitNode),this.nestingLevel.set(t,this.level);else if(t instanceof gu){if(this.scope.rootNode!==t)throw new Error(`Assertion error: resolved incorrect scope for deferred block ${t}`);this.deferBlocks.set(t,this.scope),t.children.forEach(i=>i.visit(this)),this.nestingLevel.set(t,this.level)}else t instanceof Jf||t instanceof eg||t instanceof Qf||t instanceof Zf||t instanceof Kf?(t.children.forEach(i=>i.visit(this)),this.nestingLevel.set(t,this.level)):t.forEach(this.visitNode)}visitElement(t){t.inputs.forEach(this.visitNode),t.outputs.forEach(this.visitNode),t.children.forEach(this.visitNode),t.references.forEach(this.visitNode)}visitTemplate(t){t.inputs.forEach(this.visitNode),t.outputs.forEach(this.visitNode),t.templateAttrs.forEach(this.visitNode),t.references.forEach(this.visitNode),this.ingestScopedNode(t)}visitVariable(t){this.rootNode!==null&&this.symbols.set(t,this.rootNode)}visitReference(t){this.rootNode!==null&&this.symbols.set(t,this.rootNode)}visitText(t){}visitContent(t){}visitTextAttribute(t){}visitUnknownBlock(t){}visitDeferredTrigger(){}visitIcu(t){Object.keys(t.vars).forEach(i=>t.vars[i].visit(this)),Object.keys(t.placeholders).forEach(i=>t.placeholders[i].visit(this))}visitBoundAttribute(t){t.value.visit(this)}visitBoundEvent(t){t.handler.visit(this)}visitDeferredBlock(t){this.ingestScopedNode(t),t.triggers.when?.value.visit(this),t.prefetchTriggers.when?.value.visit(this),t.placeholder&&this.visitNode(t.placeholder),t.loading&&this.visitNode(t.loading),t.error&&this.visitNode(t.error)}visitDeferredBlockPlaceholder(t){this.ingestScopedNode(t)}visitDeferredBlockError(t){this.ingestScopedNode(t)}visitDeferredBlockLoading(t){this.ingestScopedNode(t)}visitSwitchBlock(t){t.expression.visit(this),t.cases.forEach(this.visitNode)}visitSwitchBlockCase(t){t.expression?.visit(this),this.ingestScopedNode(t)}visitForLoopBlock(t){t.expression.visit(this),this.ingestScopedNode(t),t.empty?.visit(this)}visitForLoopBlockEmpty(t){this.ingestScopedNode(t)}visitIfBlock(t){t.branches.forEach(i=>i.visit(this))}visitIfBlockBranch(t){t.expression?.visit(this),this.ingestScopedNode(t)}visitBoundText(t){t.value.visit(this)}visitPipe(t,i){return this.usedPipes.add(t.name),this.scope.isDeferred||this.eagerPipes.add(t.name),super.visitPipe(t,i)}visitPropertyRead(t,i){return this.maybeMap(t,t.name),super.visitPropertyRead(t,i)}visitSafePropertyRead(t,i){return this.maybeMap(t,t.name),super.visitSafePropertyRead(t,i)}visitPropertyWrite(t,i){return this.maybeMap(t,t.name),super.visitPropertyWrite(t,i)}ingestScopedNode(t){let i=this.scope.getChildScope(t);new e(this.bindings,this.symbols,this.usedPipes,this.eagerPipes,this.deferBlocks,this.nestingLevel,i,t,this.level+1).ingest(t)}maybeMap(t,i){if(!(t.receiver instanceof Hn))return;let r=this.scope.lookup(i);r!==null&&this.bindings.set(t,r)}},Q2=class{constructor(t,i,r,n,a,o,s,l,c,d,u,h){this.target=t,this.directives=i,this.eagerDirectives=r,this.bindings=n,this.references=a,this.exprTargets=o,this.symbols=s,this.nestingLevel=l,this.scopedNodeEntities=c,this.usedPipes=d,this.eagerPipes=u,this.deferBlocks=h}getEntitiesInScope(t){return this.scopedNodeEntities.get(t)??new Set}getDirectivesOfNode(t){return this.directives.get(t)||null}getReferenceTarget(t){return this.references.get(t)||null}getConsumerOfBinding(t){return this.bindings.get(t)||null}getExpressionTarget(t){return this.exprTargets.get(t)||null}getDefinitionNodeOfSymbol(t){return this.symbols.get(t)||null}getNestingLevel(t){return this.nestingLevel.get(t)||0}getUsedDirectives(){let t=new Set;return this.directives.forEach(i=>i.forEach(r=>t.add(r))),Array.from(t.values())}getEagerlyUsedDirectives(){let t=new Set(this.eagerDirectives);return Array.from(t.values())}getUsedPipes(){return Array.from(this.usedPipes)}getEagerlyUsedPipes(){return Array.from(this.eagerPipes)}getDeferBlocks(){return Array.from(this.deferBlocks.keys())}getDeferredTriggerTarget(t,i){if(!(i instanceof yb)&&!(i instanceof wb)&&!(i instanceof xb))return null;let r=i.reference;if(r===null){let a=null;if(t.placeholder!==null){for(let o of t.placeholder.children)if(!(o instanceof mm)){if(a!==null)return null;o instanceof pa&&(a=o)}}return a}let n=this.findEntityInScope(t,r);if(n instanceof tg&&this.getDefinitionNodeOfSymbol(n)!==t){let a=this.getReferenceTarget(n);if(a!==null)return this.referenceTargetToElement(a)}if(t.placeholder!==null){let a=this.findEntityInScope(t.placeholder,r),o=a instanceof tg?this.getReferenceTarget(a):null;if(o!==null)return this.referenceTargetToElement(o)}return null}isDeferred(t){for(let i of this.deferBlocks.values()){let r=[i];for(;r.length>0;){let n=r.pop();if(n.elementsInScope.has(t))return!0;r.push(...n.childScopes.values())}}return!1}findEntityInScope(t,i){let r=this.getEntitiesInScope(t);for(let n of r)if(n.name===i)return n;return null}referenceTargetToElement(t){return t instanceof pa?t:t instanceof La?null:this.referenceTargetToElement(t.node)}};function Xee(e){let t=new Map;function i(a){if(t.has(a.rootNode))return t.get(a.rootNode);let o=a.namedEntities,s;return a.parentScope!==null?s=new Map([...i(a.parentScope),...o]):s=new Map(o),t.set(a.rootNode,s),s}let r=[e];for(;r.length>0;){let a=r.pop();for(let o of a.childScopes.values())r.push(o);i(a)}let n=new Map;for(let[a,o]of t)n.set(a,new Set(o.values()));return n}var J2=class{},Tx=!0,eS=class{constructor(t=new VE){this.jitEvaluator=t,this.FactoryTarget=El,this.ResourceLoader=J2,this.elementSchemaRegistry=new Dm}compilePipe(t,i,r){let n={name:r.name,type:nn(r.type),typeArgumentCount:0,deps:null,pipeName:r.pipeName,pure:r.pure,isStandalone:r.isStandalone},a=BO(n);return this.jitExpression(a.expression,t,i,[])}compilePipeDeclaration(t,i,r){let n=ute(r),a=BO(n);return this.jitExpression(a.expression,t,i,[])}compileInjectable(t,i,r){let{expression:n,statements:a}=DO({name:r.name,type:nn(r.type),typeArgumentCount:r.typeArgumentCount,providedIn:hL(r.providedIn),useClass:Yh(r,"useClass"),useFactory:uL(r,"useFactory"),useValue:Yh(r,"useValue"),useExisting:Yh(r,"useExisting"),deps:r.deps?.map(o5)},!0);return this.jitExpression(n,t,i,a)}compileInjectableDeclaration(t,i,r){let{expression:n,statements:a}=DO({name:r.type.name,type:nn(r.type),typeArgumentCount:0,providedIn:hL(r.providedIn),useClass:Yh(r,"useClass"),useFactory:uL(r,"useFactory"),useValue:Yh(r,"useValue"),useExisting:Yh(r,"useExisting"),deps:r.deps?.map(mL)},!0);return this.jitExpression(n,t,i,a)}compileInjector(t,i,r){let n={name:r.name,type:nn(r.type),providers:r.providers&&r.providers.length>0?new di(r.providers):null,imports:r.imports.map(o=>new di(o))},a=LO(n);return this.jitExpression(a.expression,t,i,[])}compileInjectorDeclaration(t,i,r){let n=hte(r),a=LO(n);return this.jitExpression(a.expression,t,i,[])}compileNgModule(t,i,r){let n={kind:Lc.Global,type:nn(r.type),bootstrap:r.bootstrap.map(nn),declarations:r.declarations.map(nn),publicDeclarationTypes:null,imports:r.imports.map(nn),includeImportTypes:!0,exports:r.exports.map(nn),selectorScopeMode:Ob.Inline,containsForwardDecls:!1,schemas:r.schemas?r.schemas.map(nn):null,id:r.id?new di(r.id):null},a=Uq(n);return this.jitExpression(a.expression,t,i,[])}compileNgModuleDeclaration(t,i,r){let n=Hq(r);return this.jitExpression(n,t,i,[])}compileDirective(t,i,r){let n=cL(r);return this.compileDirectiveFromMeta(t,i,n)}compileDirectiveDeclaration(t,i,r){let n=this.createParseSourceSpan("Directive",r.type.name,i),a=n5(r,n);return this.compileDirectiveFromMeta(t,i,a)}compileDirectiveFromMeta(t,i,r){let n=new pb,a=hx(),o=Iee(r,n,a);return this.jitExpression(o.expression,t,i,n.statements)}compileComponent(t,i,r){let{template:n,interpolation:a,deferBlocks:o}=a5(r.template,r.name,i,r.preserveWhitespaces,r.interpolation),s=Bt(Z(Z({},r),cL(r)),{selector:r.selector||this.elementSchemaRegistry.getDefaultComponentElementName(),template:n,declarations:r.declarations.map(Qee),declarationListEmitMode:0,deferBlocks:o,deferrableTypes:new Map,deferrableDeclToImportDecl:new Map,deferBlockDepsEmitMode:0,styles:[...r.styles,...n.styles],encapsulation:r.encapsulation,interpolation:a,changeDetection:r.changeDetection??null,animations:r.animations!=null?new di(r.animations):null,viewProviders:r.viewProviders!=null?new di(r.viewProviders):null,relativeContextFilePath:"",i18nUseExternalIds:!0,useTemplatePipeline:Tx}),l=`ng:///${r.name}.js`;return this.compileComponentFromMeta(t,l,s)}compileComponentDeclaration(t,i,r){let n=this.createParseSourceSpan("Component",r.type.name,i),a=Kee(r,n,i);return this.compileComponentFromMeta(t,i,a)}compileComponentFromMeta(t,i,r){let n=new pb,a=hx(r.interpolation),o=Nee(r,n,a);return this.jitExpression(o.expression,t,i,n.statements)}compileFactory(t,i,r){let n=Jd({name:r.name,type:nn(r.type),typeArgumentCount:r.typeArgumentCount,deps:tte(r.deps),target:r.target});return this.jitExpression(n.expression,t,i,n.statements)}compileFactoryDeclaration(t,i,r){let n=Jd({name:r.type.name,type:nn(r.type),typeArgumentCount:0,deps:Array.isArray(r.deps)?r.deps.map(mL):r.deps,target:r.target});return this.jitExpression(n.expression,t,i,n.statements)}createParseSourceSpan(t,i,r){return Rq(t,i,r)}jitExpression(t,i,r,n){let a=[...n,new Wn("$def",t,void 0,Sn.Exported)];return this.jitEvaluator.evaluateStatements(r,a,new UE(i),!0).$def}};function sL(e){return Bt(Z({},e),{isSignal:e.isSignal,predicate:r5(e.predicate),read:e.read?new di(e.read):null,static:e.static,emitDistinctChangesOnly:e.emitDistinctChangesOnly})}function lL(e){return{propertyName:e.propertyName,first:e.first??!1,predicate:r5(e.predicate),descendants:e.descendants??!1,read:e.read?new di(e.read):null,static:e.static??!1,emitDistinctChangesOnly:e.emitDistinctChangesOnly??!0,isSignal:!!e.isSignal}}function r5(e){return Array.isArray(e)?e:aS(new di(e),1)}function cL(e){let t=dte(e.inputs||[]),i=mE(e.outputs||[]),r=e.propMetadata,n={},a={};for(let s in r)r.hasOwnProperty(s)&&r[s].forEach(l=>{ote(l)?n[s]={bindingPropertyName:l.alias||s,classPropertyName:s,required:l.required||!1,isSignal:!!l.isSignal,transformFunction:l.transform!=null?new di(l.transform):null}:ste(l)&&(a[s]=l.alias||s)});let o=e.hostDirectives?.length?e.hostDirectives.map(s=>typeof s=="function"?{directive:nn(s),inputs:null,outputs:null,isForwardReference:!1}:{directive:nn(s.directive),isForwardReference:!1,inputs:s.inputs?mE(s.inputs):null,outputs:s.outputs?mE(s.outputs):null}):null;return Bt(Z({},e),{typeArgumentCount:0,typeSourceSpan:e.typeSourceSpan,type:nn(e.type),deps:null,host:Bt(Z({},rte(e.propMetadata,e.typeSourceSpan,e.host)),{useTemplatePipeline:Tx}),inputs:Z(Z({},t),n),outputs:Z(Z({},i),a),queries:e.queries.map(sL),providers:e.providers!=null?new di(e.providers):null,viewQueries:e.viewQueries.map(sL),fullInheritance:!1,hostDirectives:o})}function n5(e,t){let i=e.hostDirectives?.length?e.hostDirectives.map(r=>({directive:nn(r.directive),isForwardReference:!1,inputs:r.inputs?dL(r.inputs):null,outputs:r.outputs?dL(r.outputs):null})):null;return{name:e.type.name,type:nn(e.type),typeSourceSpan:t,selector:e.selector??null,inputs:e.inputs?lte(e.inputs):{},outputs:e.outputs??{},host:Yee(e.host),queries:(e.queries??[]).map(lL),viewQueries:(e.viewQueries??[]).map(lL),providers:e.providers!==void 0?new di(e.providers):null,exportAs:e.exportAs??null,usesInheritance:e.usesInheritance??!1,lifecycle:{usesOnChanges:e.usesOnChanges??!1},deps:null,typeArgumentCount:0,fullInheritance:!1,isStandalone:e.isStandalone??!1,isSignal:e.isSignal??!1,hostDirectives:i}}function Yee(e={}){return{attributes:Zee(e.attributes??{}),listeners:e.listeners??{},properties:e.properties??{},specialAttributes:{classAttr:e.classAttribute,styleAttr:e.styleAttribute},useTemplatePipeline:Tx}}function dL(e){let t=null;for(let i=1;i<e.length;i+=2)t=t||{},t[e[i-1]]=e[i];return t}function Zee(e){let t={};for(let i of Object.keys(e))t[i]=new di(e[i]);return t}function Kee(e,t,i){let{template:r,interpolation:n,deferBlocks:a}=a5(e.template,e.type.name,i,e.preserveWhitespaces??!1,e.interpolation),o=[];if(e.dependencies)for(let s of e.dependencies)switch(s.kind){case"directive":case"component":o.push(hE(s));break;case"pipe":o.push(ete(s));break}else(e.components||e.directives||e.pipes)&&(e.components&&o.push(...e.components.map(s=>hE(s,!0))),e.directives&&o.push(...e.directives.map(s=>hE(s))),e.pipes&&o.push(...Jee(e.pipes)));return Bt(Z({},n5(e,t)),{template:r,styles:e.styles??[],declarations:o,viewProviders:e.viewProviders!==void 0?new di(e.viewProviders):null,animations:e.animations!==void 0?new di(e.animations):null,deferBlocks:a,deferrableTypes:new Map,deferrableDeclToImportDecl:new Map,deferBlockDepsEmitMode:0,changeDetection:e.changeDetection??iS.Default,encapsulation:e.encapsulation??Qd.Emulated,interpolation:n,declarationListEmitMode:2,relativeContextFilePath:"",i18nUseExternalIds:!0,useTemplatePipeline:Tx})}function Qee(e){return Bt(Z({},e),{type:new di(e.type)})}function hE(e,t=null){return{kind:bx.Directive,isComponent:t||e.kind==="component",selector:e.selector,type:new di(e.type),inputs:e.inputs??[],outputs:e.outputs??[],exportAs:e.exportAs??null}}function Jee(e){return e?Object.keys(e).map(t=>({kind:bx.Pipe,name:t,type:new di(e[t])})):[]}function ete(e){return{kind:bx.Pipe,name:e.name,type:new di(e.type)}}function a5(e,t,i,r,n){let a=n?Ib.fromArray(n):Fs,o=gee(e,i,{preserveWhitespaces:r,interpolationConfig:a});if(o.errors!==null){let c=o.errors.map(d=>d.toString()).join(", ");throw new Error(`Errors during JIT compilation of template for ${t}: ${c}`)}let l=new X2(new nb).bind({template:o.nodes});return{template:o,interpolation:a,deferBlocks:ite(l)}}function Yh(e,t){if(e.hasOwnProperty(t))return aS(new di(e[t]),0)}function uL(e,t){if(e.hasOwnProperty(t))return new di(e[t])}function hL(e){let t=typeof e=="function"?new di(e):new _n(e??null);return aS(t,0)}function tte(e){return e==null?null:e.map(o5)}function o5(e){let t=e.attribute!=null,i=e.token===null?null:new di(e.token),r=t?new di(e.attribute):i;return s5(r,t,e.host,e.optional,e.self,e.skipSelf)}function mL(e){let t=e.attribute??!1,i=e.token===null?null:new di(e.token);return s5(i,t,e.host??!1,e.optional??!1,e.self??!1,e.skipSelf??!1)}function s5(e,t,i,r,n,a){let o=t?L("unknown"):null;return{token:e,attributeNameType:o,host:i,optional:r,self:n,skipSelf:a}}function ite(e){let t=e.getDeferBlocks(),i=new Map;for(let r of t){let n=new Map;pL(r,r.triggers,e,n),pL(r,r.prefetchTriggers,e,n),i.set(r,{deps:[],triggerElements:n})}return i}function pL(e,t,i,r){Object.keys(t).forEach(n=>{let a=t[n];r.set(a,i.getDeferredTriggerTarget(e,a))})}function rte(e,t,i){let r=jee(i||{}),n=Wee(r,t);if(n.length)throw new Error(n.map(a=>a.msg).join(`
`));for(let a in e)e.hasOwnProperty(a)&&e[a].forEach(o=>{nte(o)?r.properties[o.hostPropertyName||a]=HW("this",a):ate(o)&&(r.listeners[o.eventName||a]=`${a}(${(o.args||[]).join(",")})`)});return r}function nte(e){return e.ngMetadataName==="HostBinding"}function ate(e){return e.ngMetadataName==="HostListener"}function ote(e){return e.ngMetadataName==="Input"}function ste(e){return e.ngMetadataName==="Output"}function lte(e){return Object.keys(e).reduce((t,i)=>{let r=e[i];return typeof r=="string"||Array.isArray(r)?t[i]=cte(r):t[i]={bindingPropertyName:r.publicName,classPropertyName:i,transformFunction:r.transformFunction!==null?new di(r.transformFunction):null,required:r.isRequired,isSignal:r.isSignal},t},{})}function cte(e){return typeof e=="string"?{bindingPropertyName:e,classPropertyName:e,transformFunction:null,required:!1,isSignal:!1}:{bindingPropertyName:e[0],classPropertyName:e[1],transformFunction:e[2]?new di(e[2]):null,required:!1,isSignal:!1}}function dte(e){return e.reduce((t,i)=>{if(typeof i=="string"){let[r,n]=l5(i);t[n]={bindingPropertyName:r,classPropertyName:n,required:!1,isSignal:!1,transformFunction:null}}else t[i.name]={bindingPropertyName:i.alias||i.name,classPropertyName:i.name,required:i.required||!1,isSignal:!1,transformFunction:i.transform!=null?new di(i.transform):null};return t},{})}function mE(e){return e.reduce((t,i)=>{let[r,n]=l5(i);return t[n]=r,t},{})}function l5(e){let[t,i]=e.split(":",2).map(r=>r.trim());return[i??t,t]}function ute(e){return{name:e.type.name,type:nn(e.type),typeArgumentCount:0,pipeName:e.name,deps:null,pure:e.pure??!0,isStandalone:e.isStandalone??!1}}function hte(e){return{name:e.type.name,type:nn(e.type),providers:e.providers!==void 0&&e.providers.length>0?new di(e.providers):null,imports:e.imports!==void 0?e.imports.map(t=>new di(t)):[]}}function mte(e){let t=e.ng||(e.ng={});t.\u0275compilerFacade=new eS}var Ske=new xE("17.3.12");var tS=class{constructor(){this.closedByParent=!1,this.implicitNamespacePrefix=null,this.isVoid=!1,this.ignoreFirstLf=!1,this.canSelfClose=!0,this.preventNamespaceInheritance=!1}requireExtraParent(t){return!1}isClosedByChild(t){return!1}getContentType(){return Rs.PARSABLE_DATA}},Ake=new tS;mte(Bf);var v5=(()=>{class e{constructor(i,r){this._renderer=i,this._elementRef=r,this.onChange=n=>{},this.onTouched=()=>{}}setProperty(i,r){this._renderer.setProperty(this._elementRef.nativeElement,i,r)}registerOnTouched(i){this.onTouched=i}registerOnChange(i){this.onChange=i}setDisabledState(i){this.setProperty("disabled",i)}static{this.\u0275fac=function(r){return new(r||e)(z(Hp),z(nt))}}static{this.\u0275dir=lt({type:e})}}return e})(),pte=(()=>{class e extends v5{static{this.\u0275fac=(()=>{let i;return function(n){return(i||(i=sr(e)))(n||e)}})()}static{this.\u0275dir=lt({type:e,features:[Ot]})}}return e})(),$s=new Be("");var fte={provide:$s,useExisting:Jn(()=>Rx),multi:!0};function gte(){let e=Ad()?Ad().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}var vte=new Be(""),Rx=(()=>{class e extends v5{constructor(i,r,n){super(i,r),this._compositionMode=n,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!gte())}writeValue(i){let r=i??"";this.setProperty("value",r)}_handleInput(i){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(i)}_compositionStart(){this._composing=!0}_compositionEnd(i){this._composing=!1,this._compositionMode&&this.onChange(i)}static{this.\u0275fac=function(r){return new(r||e)(z(Hp),z(nt),z(vte,8))}}static{this.\u0275dir=lt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,n){r&1&&q("input",function(o){return n._handleInput(o.target.value)})("blur",function(){return n.onTouched()})("compositionstart",function(){return n._compositionStart()})("compositionend",function(o){return n._compositionEnd(o.target.value)})},features:[_i([fte]),Ot]})}}return e})();function Kc(e){return e==null||(typeof e=="string"||Array.isArray(e))&&e.length===0}function _5(e){return e!=null&&typeof e.length=="number"}var Ru=new Be(""),MS=new Be(""),_te=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Fm=class{static min(t){return bte(t)}static max(t){return xte(t)}static required(t){return yte(t)}static requiredTrue(t){return wte(t)}static email(t){return Cte(t)}static minLength(t){return Ete(t)}static maxLength(t){return Ste(t)}static pattern(t){return Ate(t)}static nullValidator(t){return b5(t)}static compose(t){return S5(t)}static composeAsync(t){return A5(t)}};function bte(e){return t=>{if(Kc(t.value)||Kc(e))return null;let i=parseFloat(t.value);return!isNaN(i)&&i<e?{min:{min:e,actual:t.value}}:null}}function xte(e){return t=>{if(Kc(t.value)||Kc(e))return null;let i=parseFloat(t.value);return!isNaN(i)&&i>e?{max:{max:e,actual:t.value}}:null}}function yte(e){return Kc(e.value)?{required:!0}:null}function wte(e){return e.value===!0?null:{required:!0}}function Cte(e){return Kc(e.value)||_te.test(e.value)?null:{email:!0}}function Ete(e){return t=>Kc(t.value)||!_5(t.value)?null:t.value.length<e?{minlength:{requiredLength:e,actualLength:t.value.length}}:null}function Ste(e){return t=>_5(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}function Ate(e){if(!e)return b5;let t,i;return typeof e=="string"?(i="",e.charAt(0)!=="^"&&(i+="^"),i+=e,e.charAt(e.length-1)!=="$"&&(i+="$"),t=new RegExp(i)):(i=e.toString(),t=e),r=>{if(Kc(r.value))return null;let n=r.value;return t.test(n)?null:{pattern:{requiredPattern:i,actualValue:n}}}}function b5(e){return null}function x5(e){return e!=null}function y5(e){return Qv(e)?Pn(e):e}function w5(e){let t={};return e.forEach(i=>{t=i!=null?Z(Z({},t),i):t}),Object.keys(t).length===0?null:t}function C5(e,t){return t.map(i=>i(e))}function Tte(e){return!e.validate}function E5(e){return e.map(t=>Tte(t)?t:i=>t.validate(i))}function S5(e){if(!e)return null;let t=e.filter(x5);return t.length==0?null:function(i){return w5(C5(i,t))}}function IS(e){return e!=null?S5(E5(e)):null}function A5(e){if(!e)return null;let t=e.filter(x5);return t.length==0?null:function(i){let r=C5(i,t).map(y5);return Gv(r).pipe(Rt(w5))}}function kS(e){return e!=null?A5(E5(e)):null}function c5(e,t){return e===null?[t]:Array.isArray(e)?[...e,t]:[e,t]}function T5(e){return e._rawValidators}function D5(e){return e._rawAsyncValidators}function SS(e){return e?Array.isArray(e)?e:[e]:[]}function Mx(e,t){return Array.isArray(e)?e.includes(t):e===t}function d5(e,t){let i=SS(t);return SS(e).forEach(n=>{Mx(i,n)||i.push(n)}),i}function u5(e,t){return SS(t).filter(i=>!Mx(e,i))}var Ix=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=IS(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=kS(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,i){return this.control?this.control.hasError(t,i):!1}getError(t,i){return this.control?this.control.getError(t,i):null}},Pu=class extends Ix{get formDirective(){return null}get path(){return null}},Gl=class extends Ix{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},AS=class{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},Dte={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},jke=Bt(Z({},Dte),{"[class.ng-submitted]":"isSubmitted"}),yn=(()=>{class e extends AS{constructor(i){super(i)}static{this.\u0275fac=function(r){return new(r||e)(z(Gl,2))}}static{this.\u0275dir=lt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,n){r&2&&ft("ng-untouched",n.isUntouched)("ng-touched",n.isTouched)("ng-pristine",n.isPristine)("ng-dirty",n.isDirty)("ng-valid",n.isValid)("ng-invalid",n.isInvalid)("ng-pending",n.isPending)},features:[Ot]})}}return e})();var Pg="VALID",Dx="INVALID",Rm="PENDING",Rg="DISABLED";function NS(e){return(Fx(e)?e.validators:e)||null}function Mte(e){return Array.isArray(e)?IS(e):e||null}function PS(e,t){return(Fx(t)?t.asyncValidators:e)||null}function Ite(e){return Array.isArray(e)?kS(e):e||null}function Fx(e){return e!=null&&!Array.isArray(e)&&typeof e=="object"}function M5(e,t,i){let r=e.controls;if(!(t?Object.keys(r):r).length)throw new Ji(1e3,"");if(!r[i])throw new Ji(1001,"")}function I5(e,t,i){e._forEachChild((r,n)=>{if(i[n]===void 0)throw new Ji(1002,"")})}var Om=class{constructor(t,i){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(i)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===Pg}get invalid(){return this.status===Dx}get pending(){return this.status==Rm}get disabled(){return this.status===Rg}get enabled(){return this.status!==Rg}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(d5(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(d5(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(u5(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(u5(t,this._rawAsyncValidators))}hasValidator(t){return Mx(this._rawValidators,t)}hasAsyncValidator(t){return Mx(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(i=>{i.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=Rm,t.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){let i=this._parentMarkedDirty(t.onlySelf);this.status=Rg,this.errors=null,this._forEachChild(r=>{r.disable(Bt(Z({},t),{onlySelf:!0}))}),this._updateValue(),t.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Bt(Z({},t),{skipPristineCheck:i})),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){let i=this._parentMarkedDirty(t.onlySelf);this.status=Pg,this._forEachChild(r=>{r.enable(Bt(Z({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Bt(Z({},t),{skipPristineCheck:i})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Pg||this.status===Rm)&&this._runAsyncValidator(t.emitEvent)),t.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(i=>i._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Rg:Pg}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=Rm,this._hasOwnPendingAsyncValidator=!0;let i=y5(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,i={}){this.errors=t,this._updateControlsErrors(i.emitEvent!==!1)}get(t){let i=t;return i==null||(Array.isArray(i)||(i=i.split(".")),i.length===0)?null:i.reduce((r,n)=>r&&r._find(n),this)}getError(t,i){let r=i?this.get(i):this;return r&&r.errors?r.errors[t]:null}hasError(t,i){return!!this.getError(t,i)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Pe,this.statusChanges=new Pe}_calculateStatus(){return this._allControlsDisabled()?Rg:this.errors?Dx:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Rm)?Rm:this._anyControlsHaveStatus(Dx)?Dx:Pg}_anyControlsHaveStatus(t){return this._anyControls(i=>i.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Fx(t)&&t.updateOn!=null&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){let i=this._parent&&this._parent.dirty;return!t&&!!i&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=Mte(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=Ite(this._rawAsyncValidators)}},Lm=class extends Om{constructor(t,i,r){super(NS(i),PS(r,i)),this.controls=t,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,i){return this.controls[t]?this.controls[t]:(this.controls[t]=i,i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange),i)}addControl(t,i,r={}){this.registerControl(t,i),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}setControl(t,i,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],i&&this.registerControl(t,i),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,i={}){I5(this,!0,t),Object.keys(t).forEach(r=>{M5(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(t,i={}){t!=null&&(Object.keys(t).forEach(r=>{let n=this.controls[r];n&&n.patchValue(t[r],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(t={},i={}){this._forEachChild((r,n)=>{r.reset(t?t[n]:null,{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i),this._updateTouched(i),this.updateValueAndValidity(i)}getRawValue(){return this._reduceChildren({},(t,i,r)=>(t[r]=i.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(i,r)=>r._syncPendingControls()?!0:i);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(i=>{let r=this.controls[i];r&&t(r,i)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(let[i,r]of Object.entries(this.controls))if(this.contains(i)&&t(r))return!0;return!1}_reduceValue(){let t={};return this._reduceChildren(t,(i,r,n)=>((r.enabled||this.disabled)&&(i[n]=r.value),i))}_reduceChildren(t,i){let r=t;return this._forEachChild((n,a)=>{r=i(r,n,a)}),r}_allControlsDisabled(){for(let t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}};var TS=class extends Lm{};var Og=new Be("CallSetDisabledState",{providedIn:"root",factory:()=>Ox}),Ox="always";function kte(e,t){return[...t.path,e]}function kx(e,t,i=Ox){RS(e,t),t.valueAccessor.writeValue(e.value),(e.disabled||i==="always")&&t.valueAccessor.setDisabledState?.(e.disabled),Pte(e,t),Fte(e,t),Rte(e,t),Nte(e,t)}function h5(e,t,i=!0){let r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),Px(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(()=>{}))}function Nx(e,t){e.forEach(i=>{i.registerOnValidatorChange&&i.registerOnValidatorChange(t)})}function Nte(e,t){if(t.valueAccessor.setDisabledState){let i=r=>{t.valueAccessor.setDisabledState(r)};e.registerOnDisabledChange(i),t._registerOnDestroy(()=>{e._unregisterOnDisabledChange(i)})}}function RS(e,t){let i=T5(e);t.validator!==null?e.setValidators(c5(i,t.validator)):typeof i=="function"&&e.setValidators([i]);let r=D5(e);t.asyncValidator!==null?e.setAsyncValidators(c5(r,t.asyncValidator)):typeof r=="function"&&e.setAsyncValidators([r]);let n=()=>e.updateValueAndValidity();Nx(t._rawValidators,n),Nx(t._rawAsyncValidators,n)}function Px(e,t){let i=!1;if(e!==null){if(t.validator!==null){let n=T5(e);if(Array.isArray(n)&&n.length>0){let a=n.filter(o=>o!==t.validator);a.length!==n.length&&(i=!0,e.setValidators(a))}}if(t.asyncValidator!==null){let n=D5(e);if(Array.isArray(n)&&n.length>0){let a=n.filter(o=>o!==t.asyncValidator);a.length!==n.length&&(i=!0,e.setAsyncValidators(a))}}}let r=()=>{};return Nx(t._rawValidators,r),Nx(t._rawAsyncValidators,r),i}function Pte(e,t){t.valueAccessor.registerOnChange(i=>{e._pendingValue=i,e._pendingChange=!0,e._pendingDirty=!0,e.updateOn==="change"&&k5(e,t)})}function Rte(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,e.updateOn==="blur"&&e._pendingChange&&k5(e,t),e.updateOn!=="submit"&&e.markAsTouched()})}function k5(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function Fte(e,t){let i=(r,n)=>{t.valueAccessor.writeValue(r),n&&t.viewToModelUpdate(r)};e.registerOnChange(i),t._registerOnDestroy(()=>{e._unregisterOnChange(i)})}function N5(e,t){e==null,RS(e,t)}function Ote(e,t){return Px(e,t)}function Lte(e,t){if(!e.hasOwnProperty("model"))return!1;let i=e.model;return i.isFirstChange()?!0:!Object.is(t,i.currentValue)}function Bte(e){return Object.getPrototypeOf(e.constructor)===pte}function P5(e,t){e._syncPendingControls(),t.forEach(i=>{let r=i.control;r.updateOn==="submit"&&r._pendingChange&&(i.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function Vte(e,t){if(!t)return null;Array.isArray(t);let i,r,n;return t.forEach(a=>{a.constructor===Rx?i=a:Bte(a)?r=a:n=a}),n||r||i||null}function zte(e,t){let i=e.indexOf(t);i>-1&&e.splice(i,1)}var Ute={provide:Pu,useExisting:Jn(()=>Lg)},Fg=Promise.resolve(),Lg=(()=>{class e extends Pu{constructor(i,r,n){super(),this.callSetDisabledState=n,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Pe,this.form=new Lm({},IS(i),kS(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(i){Fg.then(()=>{let r=this._findContainer(i.path);i.control=r.registerControl(i.name,i.control),kx(i.control,i,this.callSetDisabledState),i.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(i)})}getControl(i){return this.form.get(i.path)}removeControl(i){Fg.then(()=>{let r=this._findContainer(i.path);r&&r.removeControl(i.name),this._directives.delete(i)})}addFormGroup(i){Fg.then(()=>{let r=this._findContainer(i.path),n=new Lm({});N5(n,i),r.registerControl(i.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(i){Fg.then(()=>{let r=this._findContainer(i.path);r&&r.removeControl(i.name)})}getFormGroup(i){return this.form.get(i.path)}updateModel(i,r){Fg.then(()=>{this.form.get(i.path).setValue(r)})}setValue(i){this.control.setValue(i)}onSubmit(i){return this.submitted=!0,P5(this.form,this._directives),this.ngSubmit.emit(i),i?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(i=void 0){this.form.reset(i),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(i){return i.pop(),i.length?this.form.get(i):this.form}static{this.\u0275fac=function(r){return new(r||e)(z(Ru,10),z(MS,10),z(Og,8))}}static{this.\u0275dir=lt({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,n){r&1&&q("submit",function(o){return n.onSubmit(o)})("reset",function(){return n.onReset()})},inputs:{options:[de.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[_i([Ute]),Ot]})}}return e})();function m5(e,t){let i=e.indexOf(t);i>-1&&e.splice(i,1)}function p5(e){return typeof e=="object"&&e!==null&&Object.keys(e).length===2&&"value"in e&&"disabled"in e}var Nu=class extends Om{constructor(t=null,i,r){super(NS(i),PS(r,i)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(i),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Fx(i)&&(i.nonNullable||i.initialValueIsDefault)&&(p5(t)?this.defaultValue=t.value:this.defaultValue=t)}setValue(t,i={}){this.value=this._pendingValue=t,this._onChange.length&&i.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,i.emitViewToModelChange!==!1)),this.updateValueAndValidity(i)}patchValue(t,i={}){this.setValue(t,i)}reset(t=this.defaultValue,i={}){this._applyFormState(t),this.markAsPristine(i),this.markAsUntouched(i),this.setValue(this.value,i),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){m5(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){m5(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(t){p5(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};var Hte=e=>e instanceof Nu;var Gte={provide:Gl,useExisting:Jn(()=>an)},f5=Promise.resolve(),an=(()=>{class e extends Gl{constructor(i,r,n,a,o,s){super(),this._changeDetectorRef=o,this.callSetDisabledState=s,this.control=new Nu,this._registered=!1,this.name="",this.update=new Pe,this._parent=i,this._setValidators(r),this._setAsyncValidators(n),this.valueAccessor=Vte(this,a)}ngOnChanges(i){if(this._checkForErrors(),!this._registered||"name"in i){if(this._registered&&(this._checkName(),this.formDirective)){let r=i.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in i&&this._updateDisabled(i),Lte(i,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){kx(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(i){f5.then(()=>{this.control.setValue(i,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(i){let r=i.isDisabled.currentValue,n=r!==0&&ot(r);f5.then(()=>{n&&!this.control.disabled?this.control.disable():!n&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(i){return this._parent?kte(i,this._parent):[i]}static{this.\u0275fac=function(r){return new(r||e)(z(Pu,9),z(Ru,10),z(MS,10),z($s,10),z(Vt,8),z(Og,8))}}static{this.\u0275dir=lt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[de.None,"disabled","isDisabled"],model:[de.None,"ngModel","model"],options:[de.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[_i([Gte]),Ot,ir]})}}return e})();var jte=new Be("");var Wte={provide:Pu,useExisting:Jn(()=>Bg)},Bg=(()=>{class e extends Pu{constructor(i,r,n){super(),this.callSetDisabledState=n,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Pe,this._setValidators(i),this._setAsyncValidators(r)}ngOnChanges(i){this._checkFormPresent(),i.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Px(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(i){let r=this.form.get(i.path);return kx(r,i,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(i),r}getControl(i){return this.form.get(i.path)}removeControl(i){h5(i.control||null,i,!1),zte(this.directives,i)}addFormGroup(i){this._setUpFormContainer(i)}removeFormGroup(i){this._cleanUpFormContainer(i)}getFormGroup(i){return this.form.get(i.path)}addFormArray(i){this._setUpFormContainer(i)}removeFormArray(i){this._cleanUpFormContainer(i)}getFormArray(i){return this.form.get(i.path)}updateModel(i,r){this.form.get(i.path).setValue(r)}onSubmit(i){return this.submitted=!0,P5(this.form,this.directives),this.ngSubmit.emit(i),i?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(i=void 0){this.form.reset(i),this.submitted=!1}_updateDomValue(){this.directives.forEach(i=>{let r=i.control,n=this.form.get(i.path);r!==n&&(h5(r||null,i),Hte(n)&&(kx(n,i,this.callSetDisabledState),i.control=n))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(i){let r=this.form.get(i.path);N5(r,i),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(i){if(this.form){let r=this.form.get(i.path);r&&Ote(r,i)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){RS(this.form,this),this._oldForm&&Px(this._oldForm,this)}_checkFormPresent(){this.form}static{this.\u0275fac=function(r){return new(r||e)(z(Ru,10),z(MS,10),z(Og,8))}}static{this.\u0275dir=lt({type:e,selectors:[["","formGroup",""]],hostBindings:function(r,n){r&1&&q("submit",function(o){return n.onSubmit(o)})("reset",function(){return n.onReset()})},inputs:{form:[de.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[_i([Wte]),Ot,ir]})}}return e})();var R5=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({})}}return e})(),DS=class extends Om{constructor(t,i,r){super(NS(i),PS(r,i)),this.controls=t,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,i={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}insert(t,i,r={}){this.controls.splice(t,0,i),this._registerControl(i),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(t,i={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:i.emitEvent})}setControl(t,i,r={}){let n=this._adjustIndex(t);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),i&&(this.controls.splice(n,0,i),this._registerControl(i)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,i={}){I5(this,!1,t),t.forEach((r,n)=>{M5(this,!1,n),this.at(n).setValue(r,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(t,i={}){t!=null&&(t.forEach((r,n)=>{this.at(n)&&this.at(n).patchValue(r,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(t=[],i={}){this._forEachChild((r,n)=>{r.reset(t[n],{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i),this._updateTouched(i),this.updateValueAndValidity(i)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(i=>i._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((i,r)=>r._syncPendingControls()?!0:i,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((i,r)=>{t(i,r)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(i=>i.enabled&&t(i))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(let t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}};function g5(e){return!!e&&(e.asyncValidators!==void 0||e.validators!==void 0||e.updateOn!==void 0)}var F5=(()=>{class e{constructor(){this.useNonNullable=!1}get nonNullable(){let i=new e;return i.useNonNullable=!0,i}group(i,r=null){let n=this._reduceControls(i),a={};return g5(r)?a=r:r!==null&&(a.validators=r.validator,a.asyncValidators=r.asyncValidator),new Lm(n,a)}record(i,r=null){let n=this._reduceControls(i);return new TS(n,r)}control(i,r,n){let a={};return this.useNonNullable?(g5(r)?a=r:(a.validators=r,a.asyncValidators=n),new Nu(i,Bt(Z({},a),{nonNullable:!0}))):new Nu(i,r,n)}array(i,r,n){let a=i.map(o=>this._createControl(o));return new DS(a,r,n)}_reduceControls(i){let r={};return Object.keys(i).forEach(n=>{r[n]=this._createControl(i[n])}),r}_createControl(i){if(i instanceof Nu)return i;if(i instanceof Om)return i;if(Array.isArray(i)){let r=i[0],n=i.length>1?i[1]:null,a=i.length>2?i[2]:null;return this.control(r,n,a)}else return this.control(i)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var O5=(()=>{class e{static withConfig(i){return{ngModule:e,providers:[{provide:Og,useValue:i.callSetDisabledState??Ox}]}}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[R5]})}}return e})(),L5=(()=>{class e{static withConfig(i){return{ngModule:e,providers:[{provide:jte,useValue:i.warnOnNgModelWithFormControl??"always"},{provide:Og,useValue:i.callSetDisabledState??Ox}]}}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[R5]})}}return e})();var ni="primary",Jg=Symbol("RouteTitle"),VS=class{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){let i=this.params[t];return Array.isArray(i)?i[0]:i}return null}getAll(t){if(this.has(t)){let i=this.params[t];return Array.isArray(i)?i:[i]}return[]}get keys(){return Object.keys(this.params)}};function Hm(e){return new VS(e)}function qte(e,t,i){let r=i.path.split("/");if(r.length>e.length||i.pathMatch==="full"&&(t.hasChildren()||r.length<e.length))return null;let n={};for(let a=0;a<r.length;a++){let o=r[a],s=e[a];if(o.startsWith(":"))n[o.substring(1)]=s;else if(o!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:n}}function $te(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!Xs(e[i],t[i]))return!1;return!0}function Xs(e,t){let i=e?zS(e):void 0,r=t?zS(t):void 0;if(!i||!r||i.length!=r.length)return!1;let n;for(let a=0;a<i.length;a++)if(n=i[a],!q5(e[n],t[n]))return!1;return!0}function zS(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function q5(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;let i=[...e].sort(),r=[...t].sort();return i.every((n,a)=>r[a]===n)}else return e===t}function $5(e){return e.length>0?e[e.length-1]:null}function id(e){return Uv(e)?e:Qv(e)?Pn(Promise.resolve(e)):pt(e)}var Xte={exact:Y5,subset:Z5},X5={exact:Yte,subset:Zte,ignored:()=>!0};function B5(e,t,i){return Xte[i.paths](e.root,t.root,i.matrixParams)&&X5[i.queryParams](e.queryParams,t.queryParams)&&!(i.fragment==="exact"&&e.fragment!==t.fragment)}function Yte(e,t){return Xs(e,t)}function Y5(e,t,i){if(!Ou(e.segments,t.segments)||!Vx(e.segments,t.segments,i)||e.numberOfChildren!==t.numberOfChildren)return!1;for(let r in t.children)if(!e.children[r]||!Y5(e.children[r],t.children[r],i))return!1;return!0}function Zte(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(i=>q5(e[i],t[i]))}function Z5(e,t,i){return K5(e,t,t.segments,i)}function K5(e,t,i,r){if(e.segments.length>i.length){let n=e.segments.slice(0,i.length);return!(!Ou(n,i)||t.hasChildren()||!Vx(n,i,r))}else if(e.segments.length===i.length){if(!Ou(e.segments,i)||!Vx(e.segments,i,r))return!1;for(let n in t.children)if(!e.children[n]||!Z5(e.children[n],t.children[n],r))return!1;return!0}else{let n=i.slice(0,e.segments.length),a=i.slice(e.segments.length);return!Ou(e.segments,n)||!Vx(e.segments,n,r)||!e.children[ni]?!1:K5(e.children[ni],t,a,r)}}function Vx(e,t,i){return t.every((r,n)=>X5[i](e[n].parameters,r.parameters))}var Qc=class{constructor(t=new ji([],{}),i={},r=null){this.root=t,this.queryParams=i,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Hm(this.queryParams),this._queryParamMap}toString(){return Jte.serialize(this)}},ji=class{constructor(t,i){this.segments=t,this.children=i,this.parent=null,Object.values(i).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return zx(this)}},Fu=class{constructor(t,i){this.path=t,this.parameters=i}get parameterMap(){return this._parameterMap??=Hm(this.parameters),this._parameterMap}toString(){return J5(this)}};function Kte(e,t){return Ou(e,t)&&e.every((i,r)=>Xs(i.parameters,t[r].parameters))}function Ou(e,t){return e.length!==t.length?!1:e.every((i,r)=>i.path===t[r].path)}function Qte(e,t){let i=[];return Object.entries(e.children).forEach(([r,n])=>{r===ni&&(i=i.concat(t(n,r)))}),Object.entries(e.children).forEach(([r,n])=>{r!==ni&&(i=i.concat(t(n,r)))}),i}var ev=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:()=>new Wg,providedIn:"root"})}}return e})(),Wg=class{parse(t){let i=new HS(t);return new Qc(i.parseRootSegment(),i.parseQueryParams(),i.parseFragment())}serialize(t){let i=`/${Vg(t.root,!0)}`,r=iie(t.queryParams),n=typeof t.fragment=="string"?`#${eie(t.fragment)}`:"";return`${i}${r}${n}`}},Jte=new Wg;function zx(e){return e.segments.map(t=>J5(t)).join("/")}function Vg(e,t){if(!e.hasChildren())return zx(e);if(t){let i=e.children[ni]?Vg(e.children[ni],!1):"",r=[];return Object.entries(e.children).forEach(([n,a])=>{n!==ni&&r.push(`${n}:${Vg(a,!1)}`)}),r.length>0?`${i}(${r.join("//")})`:i}else{let i=Qte(e,(r,n)=>n===ni?[Vg(e.children[ni],!1)]:[`${n}:${Vg(r,!1)}`]);return Object.keys(e.children).length===1&&e.children[ni]!=null?`${zx(e)}/${i[0]}`:`${zx(e)}/(${i.join("//")})`}}function Q5(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Lx(e){return Q5(e).replace(/%3B/gi,";")}function eie(e){return encodeURI(e)}function US(e){return Q5(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ux(e){return decodeURIComponent(e)}function V5(e){return Ux(e.replace(/\+/g,"%20"))}function J5(e){return`${US(e.path)}${tie(e.parameters)}`}function tie(e){return Object.entries(e).map(([t,i])=>`;${US(t)}=${US(i)}`).join("")}function iie(e){let t=Object.entries(e).map(([i,r])=>Array.isArray(r)?r.map(n=>`${Lx(i)}=${Lx(n)}`).join("&"):`${Lx(i)}=${Lx(r)}`).filter(i=>i);return t.length?`?${t.join("&")}`:""}var rie=/^[^\/()?;#]+/;function FS(e){let t=e.match(rie);return t?t[0]:""}var nie=/^[^\/()?;=#]+/;function aie(e){let t=e.match(nie);return t?t[0]:""}var oie=/^[^=?&#]+/;function sie(e){let t=e.match(oie);return t?t[0]:""}var lie=/^[^&#]+/;function cie(e){let t=e.match(lie);return t?t[0]:""}var HS=class{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ji([],{}):new ji([],this.parseChildren())}parseQueryParams(){let t={};if(this.consumeOptional("?"))do this.parseQueryParam(t);while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let i={};this.peekStartsWith("/(")&&(this.capture("/"),i=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(i).length>0)&&(r[ni]=new ji(t,i)),r}parseSegment(){let t=FS(this.remaining);if(t===""&&this.peekStartsWith(";"))throw new Ji(4009,!1);return this.capture(t),new Fu(Ux(t),this.parseMatrixParams())}parseMatrixParams(){let t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){let i=aie(this.remaining);if(!i)return;this.capture(i);let r="";if(this.consumeOptional("=")){let n=FS(this.remaining);n&&(r=n,this.capture(r))}t[Ux(i)]=Ux(r)}parseQueryParam(t){let i=sie(this.remaining);if(!i)return;this.capture(i);let r="";if(this.consumeOptional("=")){let o=cie(this.remaining);o&&(r=o,this.capture(r))}let n=V5(i),a=V5(r);if(t.hasOwnProperty(n)){let o=t[n];Array.isArray(o)||(o=[o],t[n]=o),o.push(a)}else t[n]=a}parseParens(t){let i={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=FS(this.remaining),n=this.remaining[r.length];if(n!=="/"&&n!==")"&&n!==";")throw new Ji(4010,!1);let a;r.indexOf(":")>-1?(a=r.slice(0,r.indexOf(":")),this.capture(a),this.capture(":")):t&&(a=ni);let o=this.parseChildren();i[a]=Object.keys(o).length===1?o[ni]:new ji([],o),this.consumeOptional("//")}return i}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return this.peekStartsWith(t)?(this.remaining=this.remaining.substring(t.length),!0):!1}capture(t){if(!this.consumeOptional(t))throw new Ji(4011,!1)}};function e4(e){return e.segments.length>0?new ji([],{[ni]:e}):e}function t4(e){let t={};for(let[r,n]of Object.entries(e.children)){let a=t4(n);if(r===ni&&a.segments.length===0&&a.hasChildren())for(let[o,s]of Object.entries(a.children))t[o]=s;else(a.segments.length>0||a.hasChildren())&&(t[r]=a)}let i=new ji(e.segments,t);return die(i)}function die(e){if(e.numberOfChildren===1&&e.children[ni]){let t=e.children[ni];return new ji(e.segments.concat(t.segments),t.children)}return e}function Gm(e){return e instanceof Qc}function uie(e,t,i=null,r=null){let n=i4(e);return r4(n,t,i,r)}function i4(e){let t;function i(a){let o={};for(let l of a.children){let c=i(l);o[l.outlet]=c}let s=new ji(a.url,o);return a===e&&(t=s),s}let r=i(e.root),n=e4(r);return t??n}function r4(e,t,i,r){let n=e;for(;n.parent;)n=n.parent;if(t.length===0)return OS(n,n,n,i,r);let a=hie(t);if(a.toRoot())return OS(n,n,new ji([],{}),i,r);let o=mie(a,n,e),s=o.processChildren?Hg(o.segmentGroup,o.index,a.commands):a4(o.segmentGroup,o.index,a.commands);return OS(n,o.segmentGroup,s,i,r)}function Hx(e){return typeof e=="object"&&e!=null&&!e.outlets&&!e.segmentPath}function qg(e){return typeof e=="object"&&e!=null&&e.outlets}function OS(e,t,i,r,n){let a={};r&&Object.entries(r).forEach(([l,c])=>{a[l]=Array.isArray(c)?c.map(d=>`${d}`):`${c}`});let o;e===t?o=i:o=n4(e,t,i);let s=e4(t4(o));return new Qc(s,a,n)}function n4(e,t,i){let r={};return Object.entries(e.children).forEach(([n,a])=>{a===t?r[n]=i:r[n]=n4(a,t,i)}),new ji(e.segments,r)}var Gx=class{constructor(t,i,r){if(this.isAbsolute=t,this.numberOfDoubleDots=i,this.commands=r,t&&r.length>0&&Hx(r[0]))throw new Ji(4003,!1);let n=r.find(qg);if(n&&n!==$5(r))throw new Ji(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function hie(e){if(typeof e[0]=="string"&&e.length===1&&e[0]==="/")return new Gx(!0,0,e);let t=0,i=!1,r=e.reduce((n,a,o)=>{if(typeof a=="object"&&a!=null){if(a.outlets){let s={};return Object.entries(a.outlets).forEach(([l,c])=>{s[l]=typeof c=="string"?c.split("/"):c}),[...n,{outlets:s}]}if(a.segmentPath)return[...n,a.segmentPath]}return typeof a!="string"?[...n,a]:o===0?(a.split("/").forEach((s,l)=>{l==0&&s==="."||(l==0&&s===""?i=!0:s===".."?t++:s!=""&&n.push(s))}),n):[...n,a]},[]);return new Gx(i,t,r)}var zm=class{constructor(t,i,r){this.segmentGroup=t,this.processChildren=i,this.index=r}};function mie(e,t,i){if(e.isAbsolute)return new zm(t,!0,0);if(!i)return new zm(t,!1,NaN);if(i.parent===null)return new zm(i,!0,0);let r=Hx(e.commands[0])?0:1,n=i.segments.length-1+r;return pie(i,n,e.numberOfDoubleDots)}function pie(e,t,i){let r=e,n=t,a=i;for(;a>n;){if(a-=n,r=r.parent,!r)throw new Ji(4005,!1);n=r.segments.length}return new zm(r,!1,n-a)}function fie(e){return qg(e[0])?e[0].outlets:{[ni]:e}}function a4(e,t,i){if(e??=new ji([],{}),e.segments.length===0&&e.hasChildren())return Hg(e,t,i);let r=gie(e,t,i),n=i.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){let a=new ji(e.segments.slice(0,r.pathIndex),{});return a.children[ni]=new ji(e.segments.slice(r.pathIndex),e.children),Hg(a,0,n)}else return r.match&&n.length===0?new ji(e.segments,{}):r.match&&!e.hasChildren()?GS(e,t,i):r.match?Hg(e,0,n):GS(e,t,i)}function Hg(e,t,i){if(i.length===0)return new ji(e.segments,{});{let r=fie(i),n={};if(Object.keys(r).some(a=>a!==ni)&&e.children[ni]&&e.numberOfChildren===1&&e.children[ni].segments.length===0){let a=Hg(e.children[ni],t,i);return new ji(e.segments,a.children)}return Object.entries(r).forEach(([a,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(n[a]=a4(e.children[a],t,o))}),Object.entries(e.children).forEach(([a,o])=>{r[a]===void 0&&(n[a]=o)}),new ji(e.segments,n)}}function gie(e,t,i){let r=0,n=t,a={match:!1,pathIndex:0,commandIndex:0};for(;n<e.segments.length;){if(r>=i.length)return a;let o=e.segments[n],s=i[r];if(qg(s))break;let l=`${s}`,c=r<i.length-1?i[r+1]:null;if(n>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!U5(l,c,o))return a;r+=2}else{if(!U5(l,{},o))return a;r++}n++}return{match:!0,pathIndex:n,commandIndex:r}}function GS(e,t,i){let r=e.segments.slice(0,t),n=0;for(;n<i.length;){let a=i[n];if(qg(a)){let l=vie(a.outlets);return new ji(r,l)}if(n===0&&Hx(i[0])){let l=e.segments[t];r.push(new Fu(l.path,z5(i[0]))),n++;continue}let o=qg(a)?a.outlets[ni]:`${a}`,s=n<i.length-1?i[n+1]:null;o&&s&&Hx(s)?(r.push(new Fu(o,z5(s))),n+=2):(r.push(new Fu(o,{})),n++)}return new ji(r,{})}function vie(e){let t={};return Object.entries(e).forEach(([i,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(t[i]=GS(new ji([],{}),0,r))}),t}function z5(e){let t={};return Object.entries(e).forEach(([i,r])=>t[i]=`${r}`),t}function U5(e,t,i){return e==i.path&&Xs(t,i.parameters)}var Gg="imperative",wn=function(e){return e[e.NavigationStart=0]="NavigationStart",e[e.NavigationEnd=1]="NavigationEnd",e[e.NavigationCancel=2]="NavigationCancel",e[e.NavigationError=3]="NavigationError",e[e.RoutesRecognized=4]="RoutesRecognized",e[e.ResolveStart=5]="ResolveStart",e[e.ResolveEnd=6]="ResolveEnd",e[e.GuardsCheckStart=7]="GuardsCheckStart",e[e.GuardsCheckEnd=8]="GuardsCheckEnd",e[e.RouteConfigLoadStart=9]="RouteConfigLoadStart",e[e.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",e[e.ChildActivationStart=11]="ChildActivationStart",e[e.ChildActivationEnd=12]="ChildActivationEnd",e[e.ActivationStart=13]="ActivationStart",e[e.ActivationEnd=14]="ActivationEnd",e[e.Scroll=15]="Scroll",e[e.NavigationSkipped=16]="NavigationSkipped",e}(wn||{}),$o=class{constructor(t,i){this.id=t,this.url=i}},jm=class extends $o{constructor(t,i,r="imperative",n=null){super(t,i),this.type=wn.NavigationStart,this.navigationTrigger=r,this.restoredState=n}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ys=class extends $o{constructor(t,i,r){super(t,i),this.urlAfterRedirects=r,this.type=wn.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},fo=function(e){return e[e.Redirect=0]="Redirect",e[e.SupersededByNewNavigation=1]="SupersededByNewNavigation",e[e.NoDataFromResolver=2]="NoDataFromResolver",e[e.GuardRejected=3]="GuardRejected",e}(fo||{}),jx=function(e){return e[e.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",e[e.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",e}(jx||{}),Jc=class extends $o{constructor(t,i,r,n){super(t,i),this.reason=r,this.code=n,this.type=wn.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},ed=class extends $o{constructor(t,i,r,n){super(t,i),this.reason=r,this.code=n,this.type=wn.NavigationSkipped}},$g=class extends $o{constructor(t,i,r,n){super(t,i),this.error=r,this.target=n,this.type=wn.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Wx=class extends $o{constructor(t,i,r,n){super(t,i),this.urlAfterRedirects=r,this.state=n,this.type=wn.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},jS=class extends $o{constructor(t,i,r,n){super(t,i),this.urlAfterRedirects=r,this.state=n,this.type=wn.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},WS=class extends $o{constructor(t,i,r,n,a){super(t,i),this.urlAfterRedirects=r,this.state=n,this.shouldActivate=a,this.type=wn.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},qS=class extends $o{constructor(t,i,r,n){super(t,i),this.urlAfterRedirects=r,this.state=n,this.type=wn.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},$S=class extends $o{constructor(t,i,r,n){super(t,i),this.urlAfterRedirects=r,this.state=n,this.type=wn.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},XS=class{constructor(t){this.route=t,this.type=wn.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},YS=class{constructor(t){this.route=t,this.type=wn.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},ZS=class{constructor(t){this.snapshot=t,this.type=wn.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},KS=class{constructor(t){this.snapshot=t,this.type=wn.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},QS=class{constructor(t){this.snapshot=t,this.type=wn.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},JS=class{constructor(t){this.snapshot=t,this.type=wn.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},qx=class{constructor(t,i,r){this.routerEvent=t,this.position=i,this.anchor=r,this.type=wn.Scroll}toString(){let t=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${t}')`}},Xg=class{},Yg=class{constructor(t){this.url=t}};var eA=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new tv,this.attachRef=null}},tv=(()=>{class e{constructor(){this.contexts=new Map}onChildOutletCreated(i,r){let n=this.getOrCreateContext(i);n.outlet=r,this.contexts.set(i,n)}onChildOutletDestroyed(i){let r=this.getContext(i);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let i=this.contexts;return this.contexts=new Map,i}onOutletReAttached(i){this.contexts=i}getOrCreateContext(i){let r=this.getContext(i);return r||(r=new eA,this.contexts.set(i,r)),r}getContext(i){return this.contexts.get(i)||null}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),$x=class{constructor(t){this._root=t}get root(){return this._root.value}parent(t){let i=this.pathFromRoot(t);return i.length>1?i[i.length-2]:null}children(t){let i=tA(t,this._root);return i?i.children.map(r=>r.value):[]}firstChild(t){let i=tA(t,this._root);return i&&i.children.length>0?i.children[0].value:null}siblings(t){let i=iA(t,this._root);return i.length<2?[]:i[i.length-2].children.map(n=>n.value).filter(n=>n!==t)}pathFromRoot(t){return iA(t,this._root).map(i=>i.value)}};function tA(e,t){if(e===t.value)return t;for(let i of t.children){let r=tA(e,i);if(r)return r}return null}function iA(e,t){if(e===t.value)return[t];for(let i of t.children){let r=iA(e,i);if(r.length)return r.unshift(t),r}return[]}var po=class{constructor(t,i){this.value=t,this.children=i}toString(){return`TreeNode(${this.value})`}};function Vm(e){let t={};return e&&e.children.forEach(i=>t[i.value.outlet]=i),t}var Xx=class extends $x{constructor(t,i){super(t),this.snapshot=i,hA(this,t)}toString(){return this.snapshot.toString()}};function o4(e){let t=_ie(e),i=new Nn([new Fu("",{})]),r=new Nn({}),n=new Nn({}),a=new Nn({}),o=new Nn(""),s=new Lu(i,r,a,o,n,ni,e,t.root);return s.snapshot=t.root,new Xx(new po(s,[]),t)}function _ie(e){let t={},i={},r={},n="",a=new Zg([],t,r,n,i,ni,e,null,{});return new Yx("",new po(a,[]))}var Lu=class{constructor(t,i,r,n,a,o,s,l){this.urlSubject=t,this.paramsSubject=i,this.queryParamsSubject=r,this.fragmentSubject=n,this.dataSubject=a,this.outlet=o,this.component=s,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(Rt(c=>c[Jg]))??pt(void 0),this.url=t,this.params=i,this.queryParams=r,this.fragment=n,this.data=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Rt(t=>Hm(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Rt(t=>Hm(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function uA(e,t,i="emptyOnly"){let r,{routeConfig:n}=e;return t!==null&&(i==="always"||n?.path===""||!t.component&&!t.routeConfig?.loadComponent)?r={params:Z(Z({},t.params),e.params),data:Z(Z({},t.data),e.data),resolve:Z(Z(Z(Z({},e.data),t.data),n?.data),e._resolvedData)}:r={params:Z({},e.params),data:Z({},e.data),resolve:Z(Z({},e.data),e._resolvedData??{})},n&&l4(n)&&(r.resolve[Jg]=n.title),r}var Zg=class{get title(){return this.data?.[Jg]}constructor(t,i,r,n,a,o,s,l,c){this.url=t,this.params=i,this.queryParams=r,this.fragment=n,this.data=a,this.outlet=o,this.component=s,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Hm(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Hm(this.queryParams),this._queryParamMap}toString(){let t=this.url.map(r=>r.toString()).join("/"),i=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${t}', path:'${i}')`}},Yx=class extends $x{constructor(t,i){super(i),this.url=t,hA(this,i)}toString(){return s4(this._root)}};function hA(e,t){t.value._routerState=e,t.children.forEach(i=>hA(e,i))}function s4(e){let t=e.children.length>0?` { ${e.children.map(s4).join(", ")} } `:"";return`${e.value}${t}`}function LS(e){if(e.snapshot){let t=e.snapshot,i=e._futureSnapshot;e.snapshot=i,Xs(t.queryParams,i.queryParams)||e.queryParamsSubject.next(i.queryParams),t.fragment!==i.fragment&&e.fragmentSubject.next(i.fragment),Xs(t.params,i.params)||e.paramsSubject.next(i.params),$te(t.url,i.url)||e.urlSubject.next(i.url),Xs(t.data,i.data)||e.dataSubject.next(i.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function rA(e,t){let i=Xs(e.params,t.params)&&Kte(e.url,t.url),r=!e.parent!=!t.parent;return i&&!r&&(!e.parent||rA(e.parent,t.parent))}function l4(e){return typeof e.title=="string"||e.title===null}var mA=(()=>{class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=ni,this.activateEvents=new Pe,this.deactivateEvents=new Pe,this.attachEvents=new Pe,this.detachEvents=new Pe,this.parentContexts=Ve(tv),this.location=Ve(as),this.changeDetector=Ve(Vt),this.environmentInjector=Ve(xd),this.inputBinder=Ve(ey,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(i){if(i.name){let{firstChange:r,previousValue:n}=i.name;if(r)return;this.isTrackedInParentContexts(n)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(n)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(i){return this.parentContexts.getContext(i)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let i=this.parentContexts.getContext(this.name);i?.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ji(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ji(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ji(4012,!1);this.location.detach();let i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,r){this.activated=i,this._activatedRoute=r,this.location.insert(i.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){let i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,r){if(this.isActivated)throw new Ji(4013,!1);this._activatedRoute=i;let n=this.location,o=i.snapshot.component,s=this.parentContexts.getOrCreateContext(this.name).children,l=new nA(i,s,n.injector);this.activated=n.createComponent(o,{index:n.length,injector:l,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=lt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ir]})}}return e})(),nA=class e{__ngOutletInjector(t){return new e(this.route,this.childContexts,t)}constructor(t,i,r){this.route=t,this.childContexts=i,this.parent=r}get(t,i){return t===Lu?this.route:t===tv?this.childContexts:this.parent.get(t,i)}},ey=new Be(""),H5=(()=>{class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(i){this.unsubscribeFromRouteData(i),this.subscribeToRouteData(i)}unsubscribeFromRouteData(i){this.outletDataSubscriptions.get(i)?.unsubscribe(),this.outletDataSubscriptions.delete(i)}subscribeToRouteData(i){let{activatedRoute:r}=i,n=rh([r.queryParams,r.params,r.data]).pipe(Wr(([a,o,s],l)=>(s=Z(Z(Z({},a),o),s),l===0?pt(s):Promise.resolve(s)))).subscribe(a=>{if(!i.isActivated||!i.activatedComponentRef||i.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(i);return}let o=tI(r.component);if(!o){this.unsubscribeFromRouteData(i);return}for(let{templateName:s}of o.inputs)i.activatedComponentRef.setInput(s,a[s])});this.outletDataSubscriptions.set(i,n)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac})}}return e})();function bie(e,t,i){let r=Kg(e,t._root,i?i._root:void 0);return new Xx(r,t)}function Kg(e,t,i){if(i&&e.shouldReuseRoute(t.value,i.value.snapshot)){let r=i.value;r._futureSnapshot=t.value;let n=xie(e,t,i);return new po(r,n)}else{if(e.shouldAttach(t.value)){let a=e.retrieve(t.value);if(a!==null){let o=a.route;return o.value._futureSnapshot=t.value,o.children=t.children.map(s=>Kg(e,s)),o}}let r=yie(t.value),n=t.children.map(a=>Kg(e,a));return new po(r,n)}}function xie(e,t,i){return t.children.map(r=>{for(let n of i.children)if(e.shouldReuseRoute(r.value,n.value.snapshot))return Kg(e,r,n);return Kg(e,r)})}function yie(e){return new Lu(new Nn(e.url),new Nn(e.params),new Nn(e.queryParams),new Nn(e.fragment),new Nn(e.data),e.outlet,e.component,e)}var c4="ngNavigationCancelingError";function d4(e,t){let{redirectTo:i,navigationBehaviorOptions:r}=Gm(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,n=u4(!1,fo.Redirect);return n.url=i,n.navigationBehaviorOptions=r,n}function u4(e,t){let i=new Error(`NavigationCancelingError: ${e||""}`);return i[c4]=!0,i.cancellationCode=t,i}function wie(e){return h4(e)&&Gm(e.url)}function h4(e){return!!e&&e[c4]}var Cie=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=Ae({type:e,selectors:[["ng-component"]],standalone:!0,features:[Xt],decls:1,vars:0,template:function(r,n){r&1&&ae(0,"router-outlet")},dependencies:[mA],encapsulation:2})}}return e})();function Eie(e,t){return e.providers&&!e._injector&&(e._injector=jw(e.providers,t,`Route: ${e.path}`)),e._injector??t}function pA(e){let t=e.children&&e.children.map(pA),i=t?Bt(Z({},e),{children:t}):Z({},e);return!i.component&&!i.loadComponent&&(t||i.loadChildren)&&i.outlet&&i.outlet!==ni&&(i.component=Cie),i}function Zs(e){return e.outlet||ni}function Sie(e,t){let i=e.filter(r=>Zs(r)===t);return i.push(...e.filter(r=>Zs(r)!==t)),i}function iv(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let t=e.parent;t;t=t.parent){let i=t.routeConfig;if(i?._loadedInjector)return i._loadedInjector;if(i?._injector)return i._injector}return null}var Aie=(e,t,i,r)=>Rt(n=>(new aA(t,n.targetRouterState,n.currentRouterState,i,r).activate(e),n)),aA=class{constructor(t,i,r,n,a){this.routeReuseStrategy=t,this.futureState=i,this.currState=r,this.forwardEvent=n,this.inputBindingEnabled=a}activate(t){let i=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(i,r,t),LS(this.futureState.root),this.activateChildRoutes(i,r,t)}deactivateChildRoutes(t,i,r){let n=Vm(i);t.children.forEach(a=>{let o=a.value.outlet;this.deactivateRoutes(a,n[o],r),delete n[o]}),Object.values(n).forEach(a=>{this.deactivateRouteAndItsChildren(a,r)})}deactivateRoutes(t,i,r){let n=t.value,a=i?i.value:null;if(n===a)if(n.component){let o=r.getContext(n.outlet);o&&this.deactivateChildRoutes(t,i,o.children)}else this.deactivateChildRoutes(t,i,r);else a&&this.deactivateRouteAndItsChildren(i,r)}deactivateRouteAndItsChildren(t,i){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,i):this.deactivateRouteAndOutlet(t,i)}detachAndStoreRouteSubtree(t,i){let r=i.getContext(t.value.outlet),n=r&&t.value.component?r.children:i,a=Vm(t);for(let o of Object.values(a))this.deactivateRouteAndItsChildren(o,n);if(r&&r.outlet){let o=r.outlet.detach(),s=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:s})}}deactivateRouteAndOutlet(t,i){let r=i.getContext(t.value.outlet),n=r&&t.value.component?r.children:i,a=Vm(t);for(let o of Object.values(a))this.deactivateRouteAndItsChildren(o,n);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(t,i,r){let n=Vm(i);t.children.forEach(a=>{this.activateRoutes(a,n[a.value.outlet],r),this.forwardEvent(new JS(a.value.snapshot))}),t.children.length&&this.forwardEvent(new KS(t.value.snapshot))}activateRoutes(t,i,r){let n=t.value,a=i?i.value:null;if(LS(n),n===a)if(n.component){let o=r.getOrCreateContext(n.outlet);this.activateChildRoutes(t,i,o.children)}else this.activateChildRoutes(t,i,r);else if(n.component){let o=r.getOrCreateContext(n.outlet);if(this.routeReuseStrategy.shouldAttach(n.snapshot)){let s=this.routeReuseStrategy.retrieve(n.snapshot);this.routeReuseStrategy.store(n.snapshot,null),o.children.onOutletReAttached(s.contexts),o.attachRef=s.componentRef,o.route=s.route.value,o.outlet&&o.outlet.attach(s.componentRef,s.route.value),LS(s.route.value),this.activateChildRoutes(t,null,o.children)}else{let s=iv(n.snapshot);o.attachRef=null,o.route=n,o.injector=s,o.outlet&&o.outlet.activateWith(n,o.injector),this.activateChildRoutes(t,null,o.children)}}else this.activateChildRoutes(t,null,r)}},Zx=class{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}},Um=class{constructor(t,i){this.component=t,this.route=i}};function Tie(e,t,i){let r=e._root,n=t?t._root:null;return zg(r,n,i,[r.value])}function Die(e){let t=e.routeConfig?e.routeConfig.canActivateChild:null;return!t||t.length===0?null:{node:e,guards:t}}function qm(e,t){let i=Symbol(),r=t.get(e,i);return r===i?typeof e=="function"&&!yM(e)?e:t.get(e):r}function zg(e,t,i,r,n={canDeactivateChecks:[],canActivateChecks:[]}){let a=Vm(t);return e.children.forEach(o=>{Mie(o,a[o.value.outlet],i,r.concat([o.value]),n),delete a[o.value.outlet]}),Object.entries(a).forEach(([o,s])=>jg(s,i.getContext(o),n)),n}function Mie(e,t,i,r,n={canDeactivateChecks:[],canActivateChecks:[]}){let a=e.value,o=t?t.value:null,s=i?i.getContext(e.value.outlet):null;if(o&&a.routeConfig===o.routeConfig){let l=Iie(o,a,a.routeConfig.runGuardsAndResolvers);l?n.canActivateChecks.push(new Zx(r)):(a.data=o.data,a._resolvedData=o._resolvedData),a.component?zg(e,t,s?s.children:null,r,n):zg(e,t,i,r,n),l&&s&&s.outlet&&s.outlet.isActivated&&n.canDeactivateChecks.push(new Um(s.outlet.component,o))}else o&&jg(t,s,n),n.canActivateChecks.push(new Zx(r)),a.component?zg(e,null,s?s.children:null,r,n):zg(e,null,i,r,n);return n}function Iie(e,t,i){if(typeof i=="function")return i(e,t);switch(i){case"pathParamsChange":return!Ou(e.url,t.url);case"pathParamsOrQueryParamsChange":return!Ou(e.url,t.url)||!Xs(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!rA(e,t)||!Xs(e.queryParams,t.queryParams);case"paramsChange":default:return!rA(e,t)}}function jg(e,t,i){let r=Vm(e),n=e.value;Object.entries(r).forEach(([a,o])=>{n.component?t?jg(o,t.children.getContext(a),i):jg(o,null,i):jg(o,t,i)}),n.component?t&&t.outlet&&t.outlet.isActivated?i.canDeactivateChecks.push(new Um(t.outlet.component,n)):i.canDeactivateChecks.push(new Um(null,n)):i.canDeactivateChecks.push(new Um(null,n))}function rv(e){return typeof e=="function"}function kie(e){return typeof e=="boolean"}function Nie(e){return e&&rv(e.canLoad)}function Pie(e){return e&&rv(e.canActivate)}function Rie(e){return e&&rv(e.canActivateChild)}function Fie(e){return e&&rv(e.canDeactivate)}function Oie(e){return e&&rv(e.canMatch)}function m4(e){return e instanceof fM||e?.name==="EmptyError"}var Bx=Symbol("INITIAL_VALUE");function Wm(){return Wr(e=>rh(e.map(t=>t.pipe(Br(1),wa(Bx)))).pipe(Rt(t=>{for(let i of t)if(i!==!0){if(i===Bx)return Bx;if(i===!1||i instanceof Qc)return i}return!0}),Mi(t=>t!==Bx),Br(1)))}function Lie(e,t){return Za(i=>{let{targetSnapshot:r,currentSnapshot:n,guards:{canActivateChecks:a,canDeactivateChecks:o}}=i;return o.length===0&&a.length===0?pt(Bt(Z({},i),{guardsResult:!0})):Bie(o,r,n,e).pipe(Za(s=>s&&kie(s)?Vie(r,a,e,t):pt(s)),Rt(s=>Bt(Z({},i),{guardsResult:s})))})}function Bie(e,t,i,r){return Pn(e).pipe(Za(n=>jie(n.component,n.route,i,t,r)),ic(n=>n!==!0,!0))}function Vie(e,t,i,r){return Pn(t).pipe(tc(n=>Hv(Uie(n.route.parent,r),zie(n.route,r),Gie(e,n.path,i),Hie(e,n.route,i))),ic(n=>n!==!0,!0))}function zie(e,t){return e!==null&&t&&t(new QS(e)),pt(!0)}function Uie(e,t){return e!==null&&t&&t(new ZS(e)),pt(!0)}function Hie(e,t,i){let r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||r.length===0)return pt(!0);let n=r.map(a=>Fp(()=>{let o=iv(t)??i,s=qm(a,o),l=Pie(s)?s.canActivate(t,e):nc(o,()=>s(t,e));return id(l).pipe(ic())}));return pt(n).pipe(Wm())}function Gie(e,t,i){let r=t[t.length-1],a=t.slice(0,t.length-1).reverse().map(o=>Die(o)).filter(o=>o!==null).map(o=>Fp(()=>{let s=o.guards.map(l=>{let c=iv(o.node)??i,d=qm(l,c),u=Rie(d)?d.canActivateChild(r,e):nc(c,()=>d(r,e));return id(u).pipe(ic())});return pt(s).pipe(Wm())}));return pt(a).pipe(Wm())}function jie(e,t,i,r,n){let a=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!a||a.length===0)return pt(!0);let o=a.map(s=>{let l=iv(t)??n,c=qm(s,l),d=Fie(c)?c.canDeactivate(e,t,i,r):nc(l,()=>c(e,t,i,r));return id(d).pipe(ic())});return pt(o).pipe(Wm())}function Wie(e,t,i,r){let n=t.canLoad;if(n===void 0||n.length===0)return pt(!0);let a=n.map(o=>{let s=qm(o,e),l=Nie(s)?s.canLoad(t,i):nc(e,()=>s(t,i));return id(l)});return pt(a).pipe(Wm(),p4(r))}function p4(e){return mM(Tr(t=>{if(Gm(t))throw d4(e,t)}),Rt(t=>t===!0))}function qie(e,t,i,r){let n=t.canMatch;if(!n||n.length===0)return pt(!0);let a=n.map(o=>{let s=qm(o,e),l=Oie(s)?s.canMatch(t,i):nc(e,()=>s(t,i));return id(l)});return pt(a).pipe(Wm(),p4(r))}var Qg=class{constructor(t){this.segmentGroup=t||null}},Kx=class extends Error{constructor(t){super(),this.urlTree=t}};function Bm(e){return vd(new Qg(e))}function $ie(e){return vd(new Ji(4e3,!1))}function Xie(e){return vd(u4(!1,fo.GuardRejected))}var oA=class{constructor(t,i){this.urlSerializer=t,this.urlTree=i}lineralizeSegments(t,i){let r=[],n=i.root;for(;;){if(r=r.concat(n.segments),n.numberOfChildren===0)return pt(r);if(n.numberOfChildren>1||!n.children[ni])return $ie(t.redirectTo);n=n.children[ni]}}applyRedirectCommands(t,i,r){let n=this.applyRedirectCreateUrlTree(i,this.urlSerializer.parse(i),t,r);if(i.startsWith("/"))throw new Kx(n);return n}applyRedirectCreateUrlTree(t,i,r,n){let a=this.createSegmentGroup(t,i.root,r,n);return new Qc(a,this.createQueryParams(i.queryParams,this.urlTree.queryParams),i.fragment)}createQueryParams(t,i){let r={};return Object.entries(t).forEach(([n,a])=>{if(typeof a=="string"&&a.startsWith(":")){let s=a.substring(1);r[n]=i[s]}else r[n]=a}),r}createSegmentGroup(t,i,r,n){let a=this.createSegments(t,i.segments,r,n),o={};return Object.entries(i.children).forEach(([s,l])=>{o[s]=this.createSegmentGroup(t,l,r,n)}),new ji(a,o)}createSegments(t,i,r,n){return i.map(a=>a.path.startsWith(":")?this.findPosParam(t,a,n):this.findOrReturn(a,r))}findPosParam(t,i,r){let n=r[i.path.substring(1)];if(!n)throw new Ji(4001,!1);return n}findOrReturn(t,i){let r=0;for(let n of i){if(n.path===t.path)return i.splice(r),n;r++}return t}},sA={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Yie(e,t,i,r,n){let a=fA(e,t,i);return a.matched?(r=Eie(t,r),qie(r,t,i,n).pipe(Rt(o=>o===!0?a:Z({},sA)))):pt(a)}function fA(e,t,i){if(t.path==="**")return Zie(i);if(t.path==="")return t.pathMatch==="full"&&(e.hasChildren()||i.length>0)?Z({},sA):{matched:!0,consumedSegments:[],remainingSegments:i,parameters:{},positionalParamSegments:{}};let n=(t.matcher||qte)(i,e,t);if(!n)return Z({},sA);let a={};Object.entries(n.posParams??{}).forEach(([s,l])=>{a[s]=l.path});let o=n.consumed.length>0?Z(Z({},a),n.consumed[n.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:n.consumed,remainingSegments:i.slice(n.consumed.length),parameters:o,positionalParamSegments:n.posParams??{}}}function Zie(e){return{matched:!0,parameters:e.length>0?$5(e).parameters:{},consumedSegments:e,remainingSegments:[],positionalParamSegments:{}}}function G5(e,t,i,r){return i.length>0&&Jie(e,i,r)?{segmentGroup:new ji(t,Qie(r,new ji(i,e.children))),slicedSegments:[]}:i.length===0&&ere(e,i,r)?{segmentGroup:new ji(e.segments,Kie(e,i,r,e.children)),slicedSegments:i}:{segmentGroup:new ji(e.segments,e.children),slicedSegments:i}}function Kie(e,t,i,r){let n={};for(let a of i)if(ty(e,t,a)&&!r[Zs(a)]){let o=new ji([],{});n[Zs(a)]=o}return Z(Z({},r),n)}function Qie(e,t){let i={};i[ni]=t;for(let r of e)if(r.path===""&&Zs(r)!==ni){let n=new ji([],{});i[Zs(r)]=n}return i}function Jie(e,t,i){return i.some(r=>ty(e,t,r)&&Zs(r)!==ni)}function ere(e,t,i){return i.some(r=>ty(e,t,r))}function ty(e,t,i){return(e.hasChildren()||t.length>0)&&i.pathMatch==="full"?!1:i.path===""}function tre(e,t,i,r){return Zs(e)!==r&&(r===ni||!ty(t,i,e))?!1:fA(t,e,i).matched}function ire(e,t,i){return t.length===0&&!e.children[i]}var lA=class{};function rre(e,t,i,r,n,a,o="emptyOnly"){return new cA(e,t,i,r,n,o,a).recognize()}var nre=31,cA=class{constructor(t,i,r,n,a,o,s){this.injector=t,this.configLoader=i,this.rootComponentType=r,this.config=n,this.urlTree=a,this.paramsInheritanceStrategy=o,this.urlSerializer=s,this.applyRedirects=new oA(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(t){return new Ji(4002,`'${t.segmentGroup}'`)}recognize(){let t=G5(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(t).pipe(Rt(i=>{let r=new Zg([],Object.freeze({}),Object.freeze(Z({},this.urlTree.queryParams)),this.urlTree.fragment,{},ni,this.rootComponentType,null,{}),n=new po(r,i),a=new Yx("",n),o=uie(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,a.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(a._root,null),{state:a,tree:o}}))}match(t){return this.processSegmentGroup(this.injector,this.config,t,ni).pipe(ec(r=>{if(r instanceof Kx)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Qg?this.noMatchError(r):r}))}inheritParamsAndData(t,i){let r=t.value,n=uA(r,i,this.paramsInheritanceStrategy);r.params=Object.freeze(n.params),r.data=Object.freeze(n.data),t.children.forEach(a=>this.inheritParamsAndData(a,r))}processSegmentGroup(t,i,r,n){return r.segments.length===0&&r.hasChildren()?this.processChildren(t,i,r):this.processSegment(t,i,r,r.segments,n,!0).pipe(Rt(a=>a instanceof po?[a]:[]))}processChildren(t,i,r){let n=[];for(let a of Object.keys(r.children))a==="primary"?n.unshift(a):n.push(a);return Pn(n).pipe(tc(a=>{let o=r.children[a],s=Sie(i,a);return this.processSegmentGroup(t,s,o,a)}),vM((a,o)=>(a.push(...o),a)),Rw(null),gM(),Za(a=>{if(a===null)return Bm(r);let o=f4(a);return are(o),pt(o)}))}processSegment(t,i,r,n,a,o){return Pn(i).pipe(tc(s=>this.processSegmentAgainstRoute(s._injector??t,i,s,r,n,a,o).pipe(ec(l=>{if(l instanceof Qg)return pt(null);throw l}))),ic(s=>!!s),ec(s=>{if(m4(s))return ire(r,n,a)?pt(new lA):Bm(r);throw s}))}processSegmentAgainstRoute(t,i,r,n,a,o,s){return tre(r,n,a,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(t,n,r,a,o):this.allowRedirects&&s?this.expandSegmentAgainstRouteUsingRedirect(t,n,i,r,a,o):Bm(n):Bm(n)}expandSegmentAgainstRouteUsingRedirect(t,i,r,n,a,o){let{matched:s,consumedSegments:l,positionalParamSegments:c,remainingSegments:d}=fA(i,n,a);if(!s)return Bm(i);n.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>nre&&(this.allowRedirects=!1));let u=this.applyRedirects.applyRedirectCommands(l,n.redirectTo,c);return this.applyRedirects.lineralizeSegments(n,u).pipe(Za(h=>this.processSegment(t,r,i,h.concat(d),o,!1)))}matchSegmentAgainstRoute(t,i,r,n,a){let o=Yie(i,r,n,t,this.urlSerializer);return r.path==="**"&&(i.children={}),o.pipe(Wr(s=>s.matched?(t=r._injector??t,this.getChildConfig(t,r,n).pipe(Wr(({routes:l})=>{let c=r._loadedInjector??t,{consumedSegments:d,remainingSegments:u,parameters:h}=s,m=new Zg(d,h,Object.freeze(Z({},this.urlTree.queryParams)),this.urlTree.fragment,sre(r),Zs(r),r.component??r._loadedComponent??null,r,lre(r)),{segmentGroup:f,slicedSegments:p}=G5(i,d,u,l);if(p.length===0&&f.hasChildren())return this.processChildren(c,l,f).pipe(Rt(v=>v===null?null:new po(m,v)));if(l.length===0&&p.length===0)return pt(new po(m,[]));let g=Zs(r)===a;return this.processSegment(c,l,f,p,g?ni:a,!0).pipe(Rt(v=>new po(m,v instanceof po?[v]:[])))}))):Bm(i)))}getChildConfig(t,i,r){return i.children?pt({routes:i.children,injector:t}):i.loadChildren?i._loadedRoutes!==void 0?pt({routes:i._loadedRoutes,injector:i._loadedInjector}):Wie(t,i,r,this.urlSerializer).pipe(Za(n=>n?this.configLoader.loadChildren(t,i).pipe(Tr(a=>{i._loadedRoutes=a.routes,i._loadedInjector=a.injector})):Xie(i))):pt({routes:[],injector:t})}};function are(e){e.sort((t,i)=>t.value.outlet===ni?-1:i.value.outlet===ni?1:t.value.outlet.localeCompare(i.value.outlet))}function ore(e){let t=e.value.routeConfig;return t&&t.path===""}function f4(e){let t=[],i=new Set;for(let r of e){if(!ore(r)){t.push(r);continue}let n=t.find(a=>r.value.routeConfig===a.value.routeConfig);n!==void 0?(n.children.push(...r.children),i.add(n)):t.push(r)}for(let r of i){let n=f4(r.children);t.push(new po(r.value,n))}return t.filter(r=>!i.has(r))}function sre(e){return e.data||{}}function lre(e){return e.resolve||{}}function cre(e,t,i,r,n,a){return Za(o=>rre(e,t,i,r,o.extractedUrl,n,a).pipe(Rt(({state:s,tree:l})=>Bt(Z({},o),{targetSnapshot:s,urlAfterRedirects:l}))))}function dre(e,t){return Za(i=>{let{targetSnapshot:r,guards:{canActivateChecks:n}}=i;if(!n.length)return pt(i);let a=new Set(n.map(l=>l.route)),o=new Set;for(let l of a)if(!o.has(l))for(let c of g4(l))o.add(c);let s=0;return Pn(o).pipe(tc(l=>a.has(l)?ure(l,r,e,t):(l.data=uA(l,l.parent,e).resolve,pt(void 0))),Tr(()=>s++),Fw(1),Za(l=>s===o.size?pt(i):Co))})}function g4(e){let t=e.children.map(i=>g4(i)).flat();return[e,...t]}function ure(e,t,i,r){let n=e.routeConfig,a=e._resolve;return n?.title!==void 0&&!l4(n)&&(a[Jg]=n.title),hre(a,e,t,r).pipe(Rt(o=>(e._resolvedData=o,e.data=uA(e,e.parent,i).resolve,null)))}function hre(e,t,i,r){let n=zS(e);if(n.length===0)return pt({});let a={};return Pn(n).pipe(Za(o=>mre(e[o],t,i,r).pipe(ic(),Tr(s=>{a[o]=s}))),Fw(1),Op(a),ec(o=>m4(o)?Co:vd(o)))}function mre(e,t,i,r){let n=iv(t)??r,a=qm(e,n),o=a.resolve?a.resolve(t,i):nc(n,()=>a(t,i));return id(o)}function BS(e){return Wr(t=>{let i=e(t);return i?Pn(i).pipe(Rt(()=>t)):pt(t)})}var v4=(()=>{class e{buildTitle(i){let r,n=i.root;for(;n!==void 0;)r=this.getResolvedTitleForRoute(n)??r,n=n.children.find(a=>a.outlet===ni);return r}getResolvedTitleForRoute(i){return i.data[Jg]}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:()=>Ve(pre),providedIn:"root"})}}return e})(),pre=(()=>{class e extends v4{constructor(i){super(),this.title=i}updateTitle(i){let r=this.buildTitle(i);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||e)(he(HI))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),nv=new Be("",{providedIn:"root",factory:()=>({})}),Qx=new Be(""),gA=(()=>{class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Ve(Jv)}loadComponent(i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return pt(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=id(i.loadComponent()).pipe(Rt(_4),Tr(a=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=a}),bd(()=>{this.componentLoaders.delete(i)})),n=new zv(r,()=>new ut).pipe(Iw());return this.componentLoaders.set(i,n),n}loadChildren(i,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return pt({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let a=fre(r,this.compiler,i,this.onLoadEndListener).pipe(bd(()=>{this.childrenLoaders.delete(r)})),o=new zv(a,()=>new ut).pipe(Iw());return this.childrenLoaders.set(r,o),o}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function fre(e,t,i,r){return id(e.loadChildren()).pipe(Rt(_4),Za(n=>n instanceof VM||Array.isArray(n)?pt(n):Pn(t.compileModuleAsync(n))),Rt(n=>{r&&r(e);let a,o,s=!1;return Array.isArray(n)?(o=n,s=!0):(a=n.create(i).injector,o=a.get(Qx,[],{optional:!0,self:!0}).flat()),{routes:o.map(pA),injector:a}}))}function gre(e){return e&&typeof e=="object"&&"default"in e}function _4(e){return gre(e)?e.default:e}var vA=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:()=>Ve(vre),providedIn:"root"})}}return e})(),vre=(()=>{class e{shouldProcessUrl(i){return!0}extract(i){return i}merge(i,r){return i}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),b4=new Be(""),x4=new Be("");function _re(e,t,i){let r=e.get(x4),n=e.get(yt);return e.get(Xe).runOutsideAngular(()=>{if(!n.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(c=>setTimeout(c));let a,o=new Promise(c=>{a=c}),s=n.startViewTransition(()=>(a(),bre(e))),{onViewTransitionCreated:l}=r;return l&&nc(e,()=>l({transition:s,from:t,to:i})),o})}function bre(e){return new Promise(t=>{Hw(t,{injector:e})})}var _A=(()=>{class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new ut,this.transitionAbortSubject=new ut,this.configLoader=Ve(gA),this.environmentInjector=Ve(xd),this.urlSerializer=Ve(ev),this.rootContexts=Ve(tv),this.location=Ve(Td),this.inputBindingEnabled=Ve(ey,{optional:!0})!==null,this.titleStrategy=Ve(v4),this.options=Ve(nv,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=Ve(vA),this.createViewTransition=Ve(b4,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>pt(void 0),this.rootComponentType=null;let i=n=>this.events.next(new XS(n)),r=n=>this.events.next(new YS(n));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=i}complete(){this.transitions?.complete()}handleNavigationRequest(i){let r=++this.navigationId;this.transitions?.next(Bt(Z(Z({},this.transitions.value),i),{id:r}))}setupNavigations(i,r,n){return this.transitions=new Nn({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Gg,restoredState:null,currentSnapshot:n.snapshot,targetSnapshot:null,currentRouterState:n,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Mi(a=>a.id!==0),Rt(a=>Bt(Z({},a),{extractedUrl:this.urlHandlingStrategy.extract(a.rawUrl)})),Wr(a=>{let o=!1,s=!1;return pt(a).pipe(Wr(l=>{if(this.navigationId>a.id)return this.cancelNavigationTransition(a,"",fo.SupersededByNewNavigation),Co;this.currentTransition=a,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?Bt(Z({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let c=!i.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=l.extras.onSameUrlNavigation??i.onSameUrlNavigation;if(!c&&d!=="reload"){let u="";return this.events.next(new ed(l.id,this.urlSerializer.serialize(l.rawUrl),u,jx.IgnoredSameUrlNavigation)),l.resolve(null),Co}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return pt(l).pipe(Wr(u=>{let h=this.transitions?.getValue();return this.events.next(new jm(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),h!==this.transitions?.getValue()?Co:Promise.resolve(u)}),cre(this.environmentInjector,this.configLoader,this.rootComponentType,i.config,this.urlSerializer,this.paramsInheritanceStrategy),Tr(u=>{a.targetSnapshot=u.targetSnapshot,a.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation=Bt(Z({},this.currentNavigation),{finalUrl:u.urlAfterRedirects});let h=new Wx(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:u,extractedUrl:h,source:m,restoredState:f,extras:p}=l,g=new jm(u,this.urlSerializer.serialize(h),m,f);this.events.next(g);let v=o4(this.rootComponentType).snapshot;return this.currentTransition=a=Bt(Z({},l),{targetSnapshot:v,urlAfterRedirects:h,extras:Bt(Z({},p),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=h,pt(a)}else{let u="";return this.events.next(new ed(l.id,this.urlSerializer.serialize(l.extractedUrl),u,jx.IgnoredByUrlHandlingStrategy)),l.resolve(null),Co}}),Tr(l=>{let c=new jS(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(c)}),Rt(l=>(this.currentTransition=a=Bt(Z({},l),{guards:Tie(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),a)),Lie(this.environmentInjector,l=>this.events.next(l)),Tr(l=>{if(a.guardsResult=l.guardsResult,Gm(l.guardsResult))throw d4(this.urlSerializer,l.guardsResult);let c=new WS(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(c)}),Mi(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",fo.GuardRejected),!1)),BS(l=>{if(l.guards.canActivateChecks.length)return pt(l).pipe(Tr(c=>{let d=new qS(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}),Wr(c=>{let d=!1;return pt(c).pipe(dre(this.paramsInheritanceStrategy,this.environmentInjector),Tr({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(c,"",fo.NoDataFromResolver)}}))}),Tr(c=>{let d=new $S(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}))}),BS(l=>{let c=d=>{let u=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&u.push(this.configLoader.loadComponent(d.routeConfig).pipe(Tr(h=>{d.component=h}),Rt(()=>{})));for(let h of d.children)u.push(...c(h));return u};return rh(c(l.targetSnapshot.root)).pipe(Rw(null),Br(1))}),BS(()=>this.afterPreactivation()),Wr(()=>{let{currentSnapshot:l,targetSnapshot:c}=a,d=this.createViewTransition?.(this.environmentInjector,l.root,c.root);return d?Pn(d).pipe(Rt(()=>a)):pt(a)}),Rt(l=>{let c=bie(i.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=a=Bt(Z({},l),{targetRouterState:c}),this.currentNavigation.targetRouterState=c,a}),Tr(()=>{this.events.next(new Xg)}),Aie(this.rootContexts,i.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Br(1),Tr({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ys(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),yi(this.transitionAbortSubject.pipe(Tr(l=>{throw l}))),bd(()=>{!o&&!s&&this.cancelNavigationTransition(a,"",fo.SupersededByNewNavigation),this.currentTransition?.id===a.id&&(this.currentNavigation=null,this.currentTransition=null)}),ec(l=>{if(s=!0,h4(l))this.events.next(new Jc(a.id,this.urlSerializer.serialize(a.extractedUrl),l.message,l.cancellationCode)),wie(l)?this.events.next(new Yg(l.url)):a.resolve(!1);else{this.events.next(new $g(a.id,this.urlSerializer.serialize(a.extractedUrl),l,a.targetSnapshot??void 0));try{a.resolve(i.errorHandler(l))}catch(c){this.options.resolveNavigationPromiseOnError?a.resolve(!1):a.reject(c)}}return Co}))}))}cancelNavigationTransition(i,r,n){let a=new Jc(i.id,this.urlSerializer.serialize(i.extractedUrl),r,n);this.events.next(a),i.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function xre(e){return e!==Gg}var yre=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:()=>Ve(wre),providedIn:"root"})}}return e})(),dA=class{shouldDetach(t){return!1}store(t,i){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,i){return t.routeConfig===i.routeConfig}},wre=(()=>{class e extends dA{static{this.\u0275fac=(()=>{let i;return function(n){return(i||(i=sr(e)))(n||e)}})()}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),y4=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:()=>Ve(Cre),providedIn:"root"})}}return e})(),Cre=(()=>{class e extends y4{constructor(){super(...arguments),this.location=Ve(Td),this.urlSerializer=Ve(ev),this.options=Ve(nv,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=Ve(vA),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Qc,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=o4(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(i){return this.location.subscribe(r=>{r.type==="popstate"&&i(r.url,r.state)})}handleRouterEvent(i,r){if(i instanceof jm)this.stateMemento=this.createStateMemento();else if(i instanceof ed)this.rawUrlTree=r.initialUrl;else if(i instanceof Wx){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let n=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(n,r)}}else i instanceof Xg?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r))):i instanceof Jc&&(i.code===fo.GuardRejected||i.code===fo.NoDataFromResolver)?this.restoreHistory(r):i instanceof $g?this.restoreHistory(r,!0):i instanceof Ys&&(this.lastSuccessfulId=i.id,this.currentPageId=this.browserPageId)}setBrowserUrl(i,r){let n=this.urlSerializer.serialize(i);if(this.location.isCurrentPathEqualTo(n)||r.extras.replaceUrl){let a=this.browserPageId,o=Z(Z({},r.extras.state),this.generateNgRouterState(r.id,a));this.location.replaceState(n,"",o)}else{let a=Z(Z({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(n,"",a)}}restoreHistory(i,r=!1){if(this.canceledNavigationResolution==="computed"){let n=this.browserPageId,a=this.currentPageId-n;a!==0?this.location.historyGo(a):this.currentUrlTree===i.finalUrl&&a===0&&(this.resetState(i),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(i,r){return this.canceledNavigationResolution==="computed"?{navigationId:i,\u0275routerPageId:r}:{navigationId:i}}static{this.\u0275fac=(()=>{let i;return function(n){return(i||(i=sr(e)))(n||e)}})()}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Ug=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(Ug||{});function w4(e,t){e.events.pipe(Mi(i=>i instanceof Ys||i instanceof Jc||i instanceof $g||i instanceof ed),Rt(i=>i instanceof Ys||i instanceof ed?Ug.COMPLETE:(i instanceof Jc?i.code===fo.Redirect||i.code===fo.SupersededByNewNavigation:!1)?Ug.REDIRECTING:Ug.FAILED),Mi(i=>i!==Ug.REDIRECTING),Br(1)).subscribe(()=>{t()})}function Ere(e){throw e}var Sre={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Are={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},td=(()=>{class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=Ve(Yv),this.stateManager=Ve(y4),this.options=Ve(nv,{optional:!0})||{},this.pendingTasks=Ve(zM),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=Ve(_A),this.urlSerializer=Ve(ev),this.location=Ve(Td),this.urlHandlingStrategy=Ve(vA),this._events=new ut,this.errorHandler=this.options.errorHandler||Ere,this.navigated=!1,this.routeReuseStrategy=Ve(yre),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=Ve(Qx,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!Ve(ey,{optional:!0}),this.eventsSubscription=new Nr,this.isNgZoneEnabled=Ve(Xe)instanceof Xe&&Xe.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:i=>{this.console.warn(i)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let i=this.navigationTransitions.events.subscribe(r=>{try{let n=this.navigationTransitions.currentTransition,a=this.navigationTransitions.currentNavigation;if(n!==null&&a!==null){if(this.stateManager.handleRouterEvent(r,a),r instanceof Jc&&r.code!==fo.Redirect&&r.code!==fo.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Ys)this.navigated=!0;else if(r instanceof Yg){let o=this.urlHandlingStrategy.merge(r.url,n.currentRawUrl),s={info:n.extras.info,skipLocationChange:n.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||xre(n.source)};this.scheduleNavigation(o,Gg,null,s,{resolve:n.resolve,reject:n.reject,promise:n.promise})}}Dre(r)&&this._events.next(r)}catch(n){this.navigationTransitions.transitionAbortSubject.next(n)}});this.eventsSubscription.add(i)}resetRootComponentType(i){this.routerState.root.component=i,this.navigationTransitions.rootComponentType=i}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Gg,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((i,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(i,"popstate",r)},0)})}navigateToSyncWithBrowser(i,r,n){let a={replaceUrl:!0},o=n?.navigationId?n:null;if(n){let l=Z({},n);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(a.state=l)}let s=this.parseUrl(i);this.scheduleNavigation(s,r,o,a)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(i){this.config=i.map(pA),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(i,r={}){let{relativeTo:n,queryParams:a,fragment:o,queryParamsHandling:s,preserveFragment:l}=r,c=l?this.currentUrlTree.fragment:o,d=null;switch(s){case"merge":d=Z(Z({},this.currentUrlTree.queryParams),a);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=a||null}d!==null&&(d=this.removeEmptyProps(d));let u;try{let h=n?n.snapshot:this.routerState.snapshot.root;u=i4(h)}catch{(typeof i[0]!="string"||!i[0].startsWith("/"))&&(i=[]),u=this.currentUrlTree.root}return r4(u,i,d,c??null)}navigateByUrl(i,r={skipLocationChange:!1}){let n=Gm(i)?i:this.parseUrl(i),a=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(a,Gg,null,r)}navigate(i,r={skipLocationChange:!1}){return Tre(i),this.navigateByUrl(this.createUrlTree(i,r),r)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){try{return this.urlSerializer.parse(i)}catch{return this.urlSerializer.parse("/")}}isActive(i,r){let n;if(r===!0?n=Z({},Sre):r===!1?n=Z({},Are):n=r,Gm(i))return B5(this.currentUrlTree,i,n);let a=this.parseUrl(i);return B5(this.currentUrlTree,a,n)}removeEmptyProps(i){return Object.entries(i).reduce((r,[n,a])=>(a!=null&&(r[n]=a),r),{})}scheduleNavigation(i,r,n,a,o){if(this.disposed)return Promise.resolve(!1);let s,l,c;o?(s=o.resolve,l=o.reject,c=o.promise):c=new Promise((u,h)=>{s=u,l=h});let d=this.pendingTasks.add();return w4(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:i,extras:a,resolve:s,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(u=>Promise.reject(u))}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function Tre(e){for(let t=0;t<e.length;t++)if(e[t]==null)throw new Ji(4008,!1)}function Dre(e){return!(e instanceof Xg)&&!(e instanceof Yg)}var rd=(()=>{class e{constructor(i,r,n,a,o,s){this.router=i,this.route=r,this.tabIndexAttribute=n,this.renderer=a,this.el=o,this.locationStrategy=s,this.href=null,this.commands=null,this.onChanges=new ut,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=i.events.subscribe(c=>{c instanceof Ys&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(i){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",i)}ngOnChanges(i){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(i){i!=null?(this.commands=Array.isArray(i)?i:[i],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(i,r,n,a,o){let s=this.urlTree;if(s===null||this.isAnchorElement&&(i!==0||r||n||a||o||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(s,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let i=this.urlTree;this.href=i!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(i)):null;let r=this.href===null?null:OM(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(i,r){let n=this.renderer,a=this.el.nativeElement;r!==null?n.setAttribute(a,i,r):n.removeAttribute(a,i)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(r){return new(r||e)(z(td),z(Lu),ea("tabindex"),z(Hp),z(nt),z(Gp))}}static{this.\u0275dir=lt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,n){r&1&&q("click",function(o){return n.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),r&2&&Ft("target",n.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[de.HasDecoratorInputTransform,"preserveFragment","preserveFragment",ot],skipLocationChange:[de.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",ot],replaceUrl:[de.HasDecoratorInputTransform,"replaceUrl","replaceUrl",ot],routerLink:"routerLink"},standalone:!0,features:[wi,ir]})}}return e})();var Jx=class{};var Mre=(()=>{class e{constructor(i,r,n,a,o){this.router=i,this.injector=n,this.preloadingStrategy=a,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Mi(i=>i instanceof Ys),tc(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(i,r){let n=[];for(let a of r){a.providers&&!a._injector&&(a._injector=jw(a.providers,i,`Route: ${a.path}`));let o=a._injector??i,s=a._loadedInjector??o;(a.loadChildren&&!a._loadedRoutes&&a.canLoad===void 0||a.loadComponent&&!a._loadedComponent)&&n.push(this.preloadConfig(o,a)),(a.children||a._loadedRoutes)&&n.push(this.processRoutes(s,a.children??a._loadedRoutes))}return Pn(n).pipe(Nw())}preloadConfig(i,r){return this.preloadingStrategy.preload(r,()=>{let n;r.loadChildren&&r.canLoad===void 0?n=this.loader.loadChildren(i,r):n=pt(null);let a=n.pipe(Za(o=>o===null?pt(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??i,o.routes))));if(r.loadComponent&&!r._loadedComponent){let o=this.loader.loadComponent(r);return Pn([a,o]).pipe(Nw())}else return a})}static{this.\u0275fac=function(r){return new(r||e)(he(td),he(Jv),he(xd),he(Jx),he(gA))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),C4=new Be(""),Ire=(()=>{class e{constructor(i,r,n,a,o={}){this.urlSerializer=i,this.transitions=r,this.viewportScroller=n,this.zone=a,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=Ve(xd),o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(i=>{i instanceof jm?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=i.navigationTrigger,this.restoredId=i.restoredState?i.restoredState.navigationId:0):i instanceof Ys?(this.lastId=i.id,this.scheduleScrollEvent(i,this.urlSerializer.parse(i.urlAfterRedirects).fragment)):i instanceof ed&&i.code===jx.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(i,this.urlSerializer.parse(i.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(i=>{i instanceof qx&&(i.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(i.position):i.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(i.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(i,r){this.zone.runOutsideAngular(()=>sl(this,null,function*(){yield new Promise(n=>{setTimeout(()=>{n()}),Hw(()=>{n()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new qx(i,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(r){sh()}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac})}}return e})();function kre(e){return e.routerState.root}function av(e,t){return{\u0275kind:e,\u0275providers:t}}function Nre(){let e=Ve(Ea);return t=>{let i=e.get(Sd);if(t!==i.components[0])return;let r=e.get(td),n=e.get(E4);e.get(bA)===1&&r.initialNavigation(),e.get(S4,null,Bw.Optional)?.setUpPreloading(),e.get(C4,null,Bw.Optional)?.init(),r.resetRootComponentType(i.componentTypes[0]),n.closed||(n.next(),n.complete(),n.unsubscribe())}}var E4=new Be("",{factory:()=>new ut}),bA=new Be("",{providedIn:"root",factory:()=>1});function Pre(){return av(2,[{provide:bA,useValue:0},{provide:qw,multi:!0,deps:[Ea],useFactory:t=>{let i=t.get(nI,Promise.resolve());return()=>i.then(()=>new Promise(r=>{let n=t.get(td),a=t.get(E4);w4(n,()=>{r(!0)}),t.get(_A).afterPreactivation=()=>(r(!0),a.closed?pt(void 0):a),n.initialNavigation()}))}}])}function Rre(){return av(3,[{provide:qw,multi:!0,useFactory:()=>{let t=Ve(td);return()=>{t.setUpLocationChangeListener()}}},{provide:bA,useValue:2}])}var S4=new Be("");function Fre(e){return av(0,[{provide:S4,useExisting:Mre},{provide:Jx,useExisting:e}])}function Ore(){return av(8,[H5,{provide:ey,useExisting:H5}])}function Lre(e){let t=[{provide:b4,useValue:_re},{provide:x4,useValue:Z({skipNextTransition:!!e?.skipInitialTransition},e)}];return av(9,t)}var j5=new Be("ROUTER_FORROOT_GUARD"),Bre=[Td,{provide:ev,useClass:Wg},td,tv,{provide:Lu,useFactory:kre,deps:[td]},gA,[]],xA=(()=>{class e{constructor(i){}static forRoot(i,r){return{ngModule:e,providers:[Bre,[],{provide:Qx,multi:!0,useValue:i},{provide:j5,useFactory:Hre,deps:[[td,new Wv,new Vw]]},{provide:nv,useValue:r||{}},r?.useHash?zre():Ure(),Vre(),r?.preloadingStrategy?Fre(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?Gre(r):[],r?.bindToComponentInputs?Ore().\u0275providers:[],r?.enableViewTransitions?Lre().\u0275providers:[],jre()]}}static forChild(i){return{ngModule:e,providers:[{provide:Qx,multi:!0,useValue:i}]}}static{this.\u0275fac=function(r){return new(r||e)(he(j5,8))}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({})}}return e})();function Vre(){return{provide:C4,useFactory:()=>{let e=Ve(cI),t=Ve(Xe),i=Ve(nv),r=Ve(_A),n=Ve(ev);return i.scrollOffset&&e.setOffset(i.scrollOffset),new Ire(n,r,e,t,i)}}}function zre(){return{provide:Gp,useClass:oI}}function Ure(){return{provide:Gp,useClass:aI}}function Hre(e){return"guarded"}function Gre(e){return[e.initialNavigation==="disabled"?Rre().\u0275providers:[],e.initialNavigation==="enabledBlocking"?Pre().\u0275providers:[]]}var W5=new Be("");function jre(){return[{provide:W5,useFactory:Nre},{provide:ZM,multi:!0,useExisting:W5}]}var Wre=["*"],qre=e=>({"background-image":e}),A4=(()=>{class e{title="";imgURL="";constructor(){}ngOnInit(){}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Ae({type:e,selectors:[["app-home-card"]],inputs:{title:"title",imgURL:"imgURL"},ngContentSelectors:Wre,decls:6,vars:4,consts:[[1,"card",3,"ngStyle"],[1,"card-content"],[1,"title"],[1,"content"]],template:function(r,n){r&1&&(ti(),S(0,"div",0)(1,"div",1)(2,"h2",2),G(3),A(),S(4,"div",3),it(5),A()()()),r&2&&(O("ngStyle",Cd(2,qre,"url("+n.imgURL+")")),P(3),Vr(" ",n.title," "))},dependencies:[e0],styles:['.card[_ngcontent-%COMP%]{--transition-duration: .25s;--transform-transition: transform var(--transition-duration) ease;color:var(--clr-neutral-100);background-size:cover;width:var(--card-width);aspect-ratio:1;border-radius:.25rem;padding:1rem 0 0;overflow:hidden;position:relative;transition:var(--transform-transition);box-shadow:#00000030 0 10px 20px,#0000003b 0 6px 6px}.card[_ngcontent-%COMP%]:before{content:"";position:absolute;background:#000;opacity:.5;pointer-events:none;width:var(--card-width);aspect-ratio:1;border-radius:.25rem;padding:1rem 0 0;top:0}.card-content[_ngcontent-%COMP%]{--padding: 1.1rem;height:100%;padding:var(--padding);padding-top:3rem;background:linear-gradient(#0000,#000000bf 50%,#000)}.title[_ngcontent-%COMP%]{position:relative;width:max-content;font-size:1rem}.title[_ngcontent-%COMP%]:after{content:"";position:absolute;height:4px;width:calc(100% + var(--padding));left:calc(var(--padding) * -1);bottom:0;background-color:var(--clr-accent-400)}@media (hover){.title[_ngcontent-%COMP%]:after{transform-origin:left;transform:scaleX(0);transition:var(--transform-transition)}.card-content[_ngcontent-%COMP%]{transform:translateY(55%);transition:var(--transform-transition)}.card[_ngcontent-%COMP%]:hover, .card[_ngcontent-%COMP%]:focus-within{transform:scale(1.025)}.card[_ngcontent-%COMP%]:hover:before{opacity:0}.card[_ngcontent-%COMP%]:hover   .title[_ngcontent-%COMP%]:after, .card[_ngcontent-%COMP%]:focus-within   .title[_ngcontent-%COMP%]:after{transform:scaleX(1);transition-delay:var(--transition-duration)}.card[_ngcontent-%COMP%]:hover   .card-content[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]:focus-within   .card-content[_ngcontent-%COMP%]{transform:translateY(0)}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important;transition-delay:0ms!important}}']})}return e})();var T4=(()=>{class e{constructor(){}ngOnInit(){}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Ae({type:e,selectors:[["app-home"]],decls:40,vars:0,consts:[[1,"w-full","home"],[1,"flex","flex-row","flex-wrap","gap-4","mx-16","pb-4","section"],["routerLink","/sampling"],["title","Sampling","imgURL","assets/images/home-cards/sampling.png"],["href","https://clementpla.github.io/SegmentationMetricTutorial/main/classification"],["imgURL","assets/images/home-cards/metric.jpg","title","Classification Metrics"],[1,"flex-row","flex","gap-4","flex-wrap","mx-16","pb-4","section"],["routerLink","/PSNR"],["title","Image Quality and Noise","imgURL","assets/image_presets/phantom.png"],["routerLink","/fourierTransform"],["title","Fourier Transform 2D","imgURL","assets/images/home-cards/fourierTransform.jpg"],["routerLink","/spatialFiltering"],["title","Spatial Filtering","imgURL","assets/images/home-cards/spatial_filtering.jpg"],["routerLink","/spectralFiltering"],["title","Spectral Filtering","imgURL","assets/image_presets/CTandstripes.jpeg"],["routerLink","/colorspaces"],["title","Colorspaces","imgURL","assets/images/home-cards/colorspace.jpg"],["routerLink","/morphology"],["title","Morphology","imgURL","assets/images/home-cards/morphology.jpg"],["routerLink","/histogram"],["title","Image Histogram","imgURL","assets/images/home-cards/histogram.jpg"],["href","https://clementpla.github.io/SegmentationMetricTutorial/main/segmentation"],["imgURL","assets/images/home-cards/segmentation_metrics.jpg","title","Segmentation Metrics"],["routerLink","/PCA"],["title","Principal Component Analysis","imgURL","assets/images/home-cards/pca.jpg"],["routerLink","/weightLoss"],["title","Learning & Loss","imgURL","assets/images/home-cards/weight_loss.png"],["routerLink","/regression"],["title","Regression","imgURL","assets/images/home-cards/regression.png"],["routerLink","/optimizer"],["title","Gradient Descent & Optimizers","imgURL","assets/images/home-cards/gradient_descent.png"],["routerLink","/gradientDescent"],["title","Fully Connected Networks","imgURL","assets/images/home-cards/neural_network.png"]],template:function(r,n){r&1&&(S(0,"div",0)(1,"h2"),G(2,"1D"),A(),S(3,"div",1)(4,"a",2),ae(5,"app-home-card",3),A(),S(6,"a",4),ae(7,"app-home-card",5),A()(),S(8,"h2"),G(9,"2D"),A(),S(10,"div",6)(11,"a",7),ae(12,"app-home-card",8),A(),S(13,"a",9),ae(14,"app-home-card",10),A(),S(15,"a",11),ae(16,"app-home-card",12),A(),S(17,"a",13),ae(18,"app-home-card",14),A(),S(19,"a",15),ae(20,"app-home-card",16),A(),S(21,"a",17),ae(22,"app-home-card",18),A(),S(23,"a",19),ae(24,"app-home-card",20),A(),S(25,"a",21),ae(26,"app-home-card",22),A()(),S(27,"h2"),G(28,"Machine Learning"),A(),S(29,"div",6)(30,"a",23),ae(31,"app-home-card",24),A(),S(32,"a",25),ae(33,"app-home-card",26),A(),S(34,"a",27),ae(35,"app-home-card",28),A(),S(36,"a",29),ae(37,"app-home-card",30),A(),S(38,"a",31),ae(39,"app-home-card",32),A()()())},dependencies:[rd,A4],styles:["a[_ngcontent-%COMP%]{color:inherit;text-decoration:inherit}h2[_ngcontent-%COMP%]{border:solid white 2px;width:fit-content;border-radius:2em;padding:0 1em;color:#fff}@media (max-width: 768px){.home-container[_ngcontent-%COMP%]{gap:1em;margin:0 1em}}.home[_ngcontent-%COMP%]{background-color:var(--mat-sidenav-content-background-color)}@keyframes _ngcontent-%COMP%_rotate{0%{transform:rotateY(90deg);opacity:.1}to{transform:rotateY(0);opacity:1}}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(n){animation-name:_ngcontent-%COMP%_rotate;animation-duration:.2s;animation-direction:normal;animation-fill-mode:both;animation-timing-function:ease-out}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(n){animation-delay:.1s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(2n){animation-delay:.2s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(3n){animation-delay:.3s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(4n){animation-delay:.4s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(5n){animation-delay:.5s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(6n){animation-delay:.6s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(7n){animation-delay:.7s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(8n){animation-delay:.8s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(9n){animation-delay:.9s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(10n){animation-delay:1s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(11n){animation-delay:1.1s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(12n){animation-delay:1.2s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(13n){animation-delay:1.3s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(14n){animation-delay:1.4s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(15n){animation-delay:1.5s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(16n){animation-delay:1.6s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(17n){animation-delay:1.7s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(18n){animation-delay:1.8s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(19n){animation-delay:1.9s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(20n){animation-delay:2s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(21n){animation-delay:2.1s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(22n){animation-delay:2.2s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(23n){animation-delay:2.3s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(24n){animation-delay:2.4s}.section[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(25n){animation-delay:2.5s}"]})}return e})();var nd=(()=>{class e{leftDrawer=!0;rightDrawer=!0;static \u0275fac=function(r){return new(r||e)};static \u0275dir=lt({type:e,inputs:{leftDrawer:"leftDrawer",rightDrawer:"rightDrawer"}})}return e})();function yA(e,t,i,r){var n=arguments.length,a=n<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,i,a):o(t,i))||a);return n>3&&a&&Object.defineProperty(t,i,a),a}function D4(e,t){return function(i,r){t(i,r,e)}}function M4(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}var wA=new Be("OpenCV config object token"),ov=(()=>{let e=class{constructor(i,r){this._ngZone=r,this.cvState=new Nn({ready:!1,error:!1,loading:!0,state:"loading"}),i||(i={}),this.configModule=this.generateConfigModule(i),this.loadOpenCv()}loadOpenCv(){this.cvState.next(this.newState("loading")),window.Module=this.configModule;let i=document.createElement("script");i.setAttribute("async",""),i.setAttribute("type","text/javascript"),i.addEventListener("error",()=>{let n=new Error("Failed to load "+this.configModule.scriptUrl);this.cvState.next(this.newState("error")),this.cvState.error(n)},{passive:!0}),i.src=this.configModule.scriptUrl;let r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(i,r):document.head.appendChild(i)}newState(i){let r={ready:!1,loading:!1,error:!1,state:""};return Object.keys(r).forEach(n=>{n!=="state"&&(n===i?(r[n]=!0,r.state=n):r[n]=!1)}),r}generateConfigModule(i){return{scriptUrl:i.openCVDirPath?`${i.openCVDirPath}/opencv.js`:"/assets/opencv/opencv.js",wasmBinaryFile:"opencv_js.wasm",usingWasm:!0,onRuntimeInitialized:()=>{this._ngZone.run(()=>{console.log("openCV Ready"),this.cvState.next(this.newState("ready")),i.runOnOpenCVInit&&i.runOnOpenCVInit()})}}}};return e.\u0275prov=He({factory:function(){return new e(he(wA),he(Xe))},token:e,providedIn:"root"}),e=yA([SM({providedIn:"root"}),D4(0,wM(wA)),M4("design:paramtypes",[Object,Xe])],e),e})(),CA,ry=CA=class{static forRoot(t){return{ngModule:CA,providers:[{provide:wA,useValue:t}]}}};ry=CA=yA([XM({declarations:[],exports:[],providers:[ov]})],ry);var ad=(()=>{class e{showImagePreset=!1;constructor(){}toggleImagePreset(){this.showImagePreset=!this.showImagePreset}static \u0275fac=function(r){return new(r||e)};static \u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var k4=["outputCanvas"],N4=["inputCanvas"],za=(()=>{class e extends nd{ngxOpenCv;uiservice;cdr;cvState;outputCanvasContained;drawCanvasContained;outputCanvas;drawCanvas;profileOptions;sideMenuContext=!0;constructor(i,r,n){super(),this.ngxOpenCv=i,this.uiservice=r,this.cdr=n}ngAfterViewInit(){this.ngxOpenCv.cvState.subscribe(i=>{this.cvState=i,i.error||i.loading||i.ready}),this.cdr.detectChanges()}loadSelectedFileFromPath(i){let r=new Image;r.onerror=n=>{console.log("Loading failed")},r.src=i,r.onload=()=>{this.drawCanvas?this.drawCanvas.drawImage(r):this.drawCanvasContained&&this.drawCanvasContained.drawImage(r)}}loadSelectedFile(i){var r=new FileReader;r.onload=n=>{let a=new Image;a.onerror=o=>{console.log("Loading failed")},a.src=n.target.result,a.onload=()=>{this.drawCanvasContained.drawImage(a)}},r.readAsDataURL(i)}clearCanvas(){this.drawCanvasContained.clearCanvas()}updateProfile(){let i=this.outputCanvas.getProfile();this.profileOptions={legend:{data:["Profile"],align:"left"},tooltip:{},xAxis:{data:Array.from(Array(i.length).keys()),silent:!1,splitLine:{show:!1}},yAxis:[{type:"value",min:0,max:275}],series:[{symbol:"none",name:"profile",type:"line",areaStyle:{},data:i}],animationEasing:"elasticOut",animationDelayUpdate:r=>r*5}}toggleImagePresets(){this.sideMenuContext=!this.sideMenuContext}static \u0275fac=function(r){return new(r||e)(z(ov),z(ad),z(Vt))};static \u0275dir=lt({type:e,contentQueries:function(r,n,a){if(r&1&&(Si(a,k4,5),Si(a,N4,5)),r&2){let o;Me(o=Ie())&&(n.outputCanvasContained=o.first),Me(o=Ie())&&(n.drawCanvasContained=o.first)}},viewQuery:function(r,n){if(r&1&&(tt(k4,5),tt(N4,5)),r&2){let a;Me(a=Ie())&&(n.outputCanvas=a.first),Me(a=Ie())&&(n.drawCanvas=a.first)}},features:[Ot]})}return e})();var Xre=new Be("cdk-dir-doc",{providedIn:"root",factory:Yre});function Yre(){return Ve(yt)}var Zre=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function Kre(e){let t=e?.toLowerCase()||"";return t==="auto"&&typeof navigator<"u"&&navigator?.language?Zre.test(navigator.language)?"rtl":"ltr":t==="rtl"?"rtl":"ltr"}var go=(()=>{class e{constructor(i){if(this.value="ltr",this.change=new Pe,i){let r=i.body?i.body.dir:null,n=i.documentElement?i.documentElement.dir:null;this.value=Kre(r||n||"ltr")}}ngOnDestroy(){this.change.complete()}static{this.\u0275fac=function(r){return new(r||e)(he(Xre,8))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var od=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({})}}return e})();var SA;try{SA=typeof Intl<"u"&&Intl.v8BreakIterator}catch{SA=!1}var pi=(()=>{class e{constructor(i){this._platformId=i,this.isBrowser=this._platformId?t0(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||SA)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static{this.\u0275fac=function(r){return new(r||e)(he(ll))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Xm,P4=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function AA(){if(Xm)return Xm;if(typeof document!="object"||!document)return Xm=new Set(P4),Xm;let e=document.createElement("input");return Xm=new Set(P4.filter(t=>(e.setAttribute("type",t),e.type===t))),Xm}var sv;function Qre(){if(sv==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>sv=!0}))}finally{sv=sv||!1}return sv}function sd(e){return Qre()?e:!!e.capture}var _s=function(e){return e[e.NORMAL=0]="NORMAL",e[e.NEGATED=1]="NEGATED",e[e.INVERTED=2]="INVERTED",e}(_s||{}),ay,Bu;function oy(){if(Bu==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return Bu=!1,Bu;if("scrollBehavior"in document.documentElement.style)Bu=!0;else{let e=Element.prototype.scrollTo;e?Bu=!/\{\s*\[native code\]\s*\}/.test(e.toString()):Bu=!1}}return Bu}function Ym(){if(typeof document!="object"||!document)return _s.NORMAL;if(ay==null){let e=document.createElement("div"),t=e.style;e.dir="rtl",t.width="1px",t.overflow="auto",t.visibility="hidden",t.pointerEvents="none",t.position="absolute";let i=document.createElement("div"),r=i.style;r.width="2px",r.height="1px",e.appendChild(i),document.body.appendChild(e),ay=_s.NORMAL,e.scrollLeft===0&&(e.scrollLeft=1,ay=e.scrollLeft===0?_s.NEGATED:_s.INVERTED),e.remove()}return ay}var EA;function Jre(){if(EA==null){let e=typeof document<"u"?document.head:null;EA=!!(e&&(e.createShadowRoot||e.attachShadow))}return EA}function R4(e){if(Jre()){let t=e.getRootNode?e.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function Xo(e){return e.composedPath?e.composedPath()[0]:e.target}function lv(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}var TA=class{constructor(t){this._box=t,this._destroyed=new ut,this._resizeSubject=new ut,this._elementObservables=new Map,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(i=>this._resizeSubject.next(i)))}observe(t){return this._elementObservables.has(t)||this._elementObservables.set(t,new ns(i=>{let r=this._resizeSubject.subscribe(i);return this._resizeObserver?.observe(t,{box:this._box}),()=>{this._resizeObserver?.unobserve(t),r.unsubscribe(),this._elementObservables.delete(t)}}).pipe(Mi(i=>i.some(r=>r.target===t)),Lw({bufferSize:1,refCount:!0}),yi(this._destroyed))),this._elementObservables.get(t)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},F4=(()=>{class e{constructor(){this._observers=new Map,this._ngZone=Ve(Xe),typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,i]of this._observers)i.destroy();this._observers.clear(),typeof ResizeObserver<"u"}observe(i,r){let n=r?.box||"content-box";return this._observers.has(n)||this._observers.set(n,new TA(n)),this._observers.get(n).observe(i)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function qn(e){return e!=null&&`${e}`!="false"}function Zm(e){return Array.isArray(e)?e:[e]}function Hr(e){return e==null?"":typeof e=="string"?e:`${e}px`}function Yo(e){return e instanceof nt?e.nativeElement:e}var ene=(()=>{class e{create(i){return typeof MutationObserver>"u"?null:new MutationObserver(i)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var sy=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({providers:[ene]})}}return e})();function vo(e,...t){return t.length?t.some(i=>e[i]):e.altKey||e.shiftKey||e.ctrlKey||e.metaKey}var O4=new Set,Vu,tne=(()=>{class e{constructor(i,r){this._platform=i,this._nonce=r,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):rne}matchMedia(i){return(this._platform.WEBKIT||this._platform.BLINK)&&ine(i,this._nonce),this._matchMedia(i)}static{this.\u0275fac=function(r){return new(r||e)(he(pi),he(zp,8))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function ine(e,t){if(!O4.has(e))try{Vu||(Vu=document.createElement("style"),t&&Vu.setAttribute("nonce",t),Vu.setAttribute("type","text/css"),document.head.appendChild(Vu)),Vu.sheet&&(Vu.sheet.insertRule(`@media ${e} {body{ }}`,0),O4.add(e))}catch(i){console.error(i)}}function rne(e){return{matches:e==="all"||e==="",media:e,addListener:()=>{},removeListener:()=>{}}}var B4=(()=>{class e{constructor(i,r){this._mediaMatcher=i,this._zone=r,this._queries=new Map,this._destroySubject=new ut}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(i){return L4(Zm(i)).some(n=>this._registerQuery(n).mql.matches)}observe(i){let n=L4(Zm(i)).map(o=>this._registerQuery(o).observable),a=rh(n);return a=Hv(a.pipe(Br(1)),a.pipe(jv(1),nh(0))),a.pipe(Rt(o=>{let s={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:c})=>{s.matches=s.matches||l,s.breakpoints[c]=l}),s}))}_registerQuery(i){if(this._queries.has(i))return this._queries.get(i);let r=this._mediaMatcher.matchMedia(i),a={observable:new ns(o=>{let s=l=>this._zone.run(()=>o.next(l));return r.addListener(s),()=>{r.removeListener(s)}}).pipe(wa(r),Rt(({matches:o})=>({query:i,matches:o})),yi(this._destroySubject)),mql:r};return this._queries.set(i,a),a}static{this.\u0275fac=function(r){return new(r||e)(he(tne),he(Xe))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function L4(e){return e.map(t=>t.split(",")).reduce((t,i)=>t.concat(i)).map(t=>t.trim())}var H4=" ";function G4(e,t,i){let r=j4(e,t);i=i.trim(),!r.some(n=>n.trim()===i)&&(r.push(i),e.setAttribute(t,r.join(H4)))}function PA(e,t,i){let r=j4(e,t);i=i.trim();let n=r.filter(a=>a!==i);n.length?e.setAttribute(t,n.join(H4)):e.removeAttribute(t)}function j4(e,t){return e.getAttribute(t)?.match(/\S+/g)??[]}var dy=class{constructor(t,i){this._items=t,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new ut,this._typeaheadSubscription=Nr.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=r=>r.disabled,this._pressedLetters=[],this.tabOut=new ut,this.change=new ut,t instanceof wd?this._itemChangesSubscription=t.changes.subscribe(r=>this._itemsChanged(r.toArray())):Gw(t)&&(this._effectRef=eI(()=>this._itemsChanged(t()),{injector:i}))}skipPredicate(t){return this._skipPredicateFn=t,this}withWrap(t=!0){return this._wrap=t,this}withVerticalOrientation(t=!0){return this._vertical=t,this}withHorizontalOrientation(t){return this._horizontal=t,this}withAllowedModifierKeys(t){return this._allowedModifierKeys=t,this}withTypeAhead(t=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Tr(i=>this._pressedLetters.push(i)),nh(t),Mi(()=>this._pressedLetters.length>0),Rt(()=>this._pressedLetters.join(""))).subscribe(i=>{let r=this._getItemsArray();for(let n=1;n<r.length+1;n++){let a=(this._activeItemIndex+n)%r.length,o=r[a];if(!this._skipPredicateFn(o)&&o.getLabel().toUpperCase().trim().indexOf(i)===0){this.setActiveItem(a);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(t=!0){return this._homeAndEnd=t,this}withPageUpDown(t=!0,i=10){return this._pageUpAndDown={enabled:t,delta:i},this}setActiveItem(t){let i=this._activeItem;this.updateActiveItem(t),this._activeItem!==i&&this.change.next(this._activeItemIndex)}onKeydown(t){let i=t.keyCode,n=["altKey","ctrlKey","metaKey","shiftKey"].every(a=>!t[a]||this._allowedModifierKeys.indexOf(a)>-1);switch(i){case 9:this.tabOut.next();return;case 40:if(this._vertical&&n){this.setNextItemActive();break}else return;case 38:if(this._vertical&&n){this.setPreviousItemActive();break}else return;case 39:if(this._horizontal&&n){this._horizontal==="rtl"?this.setPreviousItemActive():this.setNextItemActive();break}else return;case 37:if(this._horizontal&&n){this._horizontal==="rtl"?this.setNextItemActive():this.setPreviousItemActive();break}else return;case 36:if(this._homeAndEnd&&n){this.setFirstItemActive();break}else return;case 35:if(this._homeAndEnd&&n){this.setLastItemActive();break}else return;case 33:if(this._pageUpAndDown.enabled&&n){let a=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(a>0?a:0,1);break}else return;case 34:if(this._pageUpAndDown.enabled&&n){let a=this._activeItemIndex+this._pageUpAndDown.delta,o=this._getItemsArray().length;this._setActiveItemByIndex(a<o?a:o-1,-1);break}else return;default:(n||vo(t,"shiftKey"))&&(t.key&&t.key.length===1?this._letterKeyStream.next(t.key.toLocaleUpperCase()):(i>=65&&i<=90||i>=48&&i<=57)&&this._letterKeyStream.next(String.fromCharCode(i)));return}this._pressedLetters=[],t.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(t){let i=this._getItemsArray(),r=typeof t=="number"?t:i.indexOf(t),n=i[r];this._activeItem=n??null,this._activeItemIndex=r}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(t){this._wrap?this._setActiveInWrapMode(t):this._setActiveInDefaultMode(t)}_setActiveInWrapMode(t){let i=this._getItemsArray();for(let r=1;r<=i.length;r++){let n=(this._activeItemIndex+t*r+i.length)%i.length,a=i[n];if(!this._skipPredicateFn(a)){this.setActiveItem(n);return}}}_setActiveInDefaultMode(t){this._setActiveItemByIndex(this._activeItemIndex+t,t)}_setActiveItemByIndex(t,i){let r=this._getItemsArray();if(r[t]){for(;this._skipPredicateFn(r[t]);)if(t+=i,!r[t])return;this.setActiveItem(t)}}_getItemsArray(){return Gw(this._items)?this._items():this._items instanceof wd?this._items.toArray():this._items}_itemsChanged(t){if(this._activeItem){let i=t.indexOf(this._activeItem);i>-1&&i!==this._activeItemIndex&&(this._activeItemIndex=i)}}},uy=class extends dy{setActiveItem(t){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(t),this.activeItem&&this.activeItem.setActiveStyles()}},hy=class extends dy{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(t){return this._origin=t,this}setActiveItem(t){super.setActiveItem(t),this.activeItem&&this.activeItem.focus(this._origin)}};var RA=(()=>{class e{constructor(i){this._platform=i}isDisabled(i){return i.hasAttribute("disabled")}isVisible(i){return _ne(i)&&getComputedStyle(i).visibility==="visible"}isTabbable(i){if(!this._platform.isBrowser)return!1;let r=vne(Ane(i));if(r&&(V4(r)===-1||!this.isVisible(r)))return!1;let n=i.nodeName.toLowerCase(),a=V4(i);return i.hasAttribute("contenteditable")?a!==-1:n==="iframe"||n==="object"||this._platform.WEBKIT&&this._platform.IOS&&!Ene(i)?!1:n==="audio"?i.hasAttribute("controls")?a!==-1:!1:n==="video"?a===-1?!1:a!==null?!0:this._platform.FIREFOX||i.hasAttribute("controls"):i.tabIndex>=0}isFocusable(i,r){return Sne(i)&&!this.isDisabled(i)&&(r?.ignoreVisibility||this.isVisible(i))}static{this.\u0275fac=function(r){return new(r||e)(he(pi))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function vne(e){try{return e.frameElement}catch{return null}}function _ne(e){return!!(e.offsetWidth||e.offsetHeight||typeof e.getClientRects=="function"&&e.getClientRects().length)}function bne(e){let t=e.nodeName.toLowerCase();return t==="input"||t==="select"||t==="button"||t==="textarea"}function xne(e){return wne(e)&&e.type=="hidden"}function yne(e){return Cne(e)&&e.hasAttribute("href")}function wne(e){return e.nodeName.toLowerCase()=="input"}function Cne(e){return e.nodeName.toLowerCase()=="a"}function W4(e){if(!e.hasAttribute("tabindex")||e.tabIndex===void 0)return!1;let t=e.getAttribute("tabindex");return!!(t&&!isNaN(parseInt(t,10)))}function V4(e){if(!W4(e))return null;let t=parseInt(e.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}function Ene(e){let t=e.nodeName.toLowerCase(),i=t==="input"&&e.type;return i==="text"||i==="password"||t==="select"||t==="textarea"}function Sne(e){return xne(e)?!1:bne(e)||yne(e)||e.hasAttribute("contenteditable")||W4(e)}function Ane(e){return e.ownerDocument&&e.ownerDocument.defaultView||window}var MA=class{get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}constructor(t,i,r,n,a=!1){this._element=t,this._checker=i,this._ngZone=r,this._document=n,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,a||this.attachAnchors()}destroy(){let t=this._startAnchor,i=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),i&&(i.removeEventListener("focus",this.endAnchorListener),i.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return this._hasAttached?!0:(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(i=>{this._executeOnStable(()=>i(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(i=>{this._executeOnStable(()=>i(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(i=>{this._executeOnStable(()=>i(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){let i=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return t=="start"?i.length?i[0]:this._getFirstTabbableElement(this._element):i.length?i[i.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){let i=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(i){if(!this._checker.isFocusable(i)){let r=this._getFirstTabbableElement(i);return r?.focus(t),!!r}return i.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){let i=this._getRegionBoundary("start");return i&&i.focus(t),!!i}focusLastTabbableElement(t){let i=this._getRegionBoundary("end");return i&&i.focus(t),!!i}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let i=t.children;for(let r=0;r<i.length;r++){let n=i[r].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(i[r]):null;if(n)return n}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let i=t.children;for(let r=i.length-1;r>=0;r--){let n=i[r].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(i[r]):null;if(n)return n}return null}_createAnchor(){let t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,i){t?i.setAttribute("tabindex","0"):i.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.pipe(Br(1)).subscribe(t)}},q4=(()=>{class e{constructor(i,r,n){this._checker=i,this._ngZone=r,this._document=n}create(i,r=!1){return new MA(i,this._checker,this._ngZone,this._document,r)}static{this.\u0275fac=function(r){return new(r||e)(he(RA),he(Xe),he(yt))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function FA(e){return e.buttons===0||e.detail===0}function OA(e){let t=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0];return!!t&&t.identifier===-1&&(t.radiusX==null||t.radiusX===1)&&(t.radiusY==null||t.radiusY===1)}var Tne=new Be("cdk-input-modality-detector-options"),Dne={ignoreKeys:[18,17,224,91,16]},$4=650,Km=sd({passive:!0,capture:!0}),Mne=(()=>{class e{get mostRecentModality(){return this._modality.value}constructor(i,r,n,a){this._platform=i,this._mostRecentTarget=null,this._modality=new Nn(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(s=>s===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Xo(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<$4||(this._modality.next(FA(o)?"keyboard":"mouse"),this._mostRecentTarget=Xo(o))},this._onTouchstart=o=>{if(OA(o)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Xo(o)},this._options=Z(Z({},Dne),a),this.modalityDetected=this._modality.pipe(jv(1)),this.modalityChanged=this.modalityDetected.pipe(_d()),i.isBrowser&&r.runOutsideAngular(()=>{n.addEventListener("keydown",this._onKeydown,Km),n.addEventListener("mousedown",this._onMousedown,Km),n.addEventListener("touchstart",this._onTouchstart,Km)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Km),document.removeEventListener("mousedown",this._onMousedown,Km),document.removeEventListener("touchstart",this._onTouchstart,Km))}static{this.\u0275fac=function(r){return new(r||e)(he(pi),he(Xe),he(yt),he(Tne,8))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Ine=new Be("liveAnnouncerElement",{providedIn:"root",factory:kne});function kne(){return null}var Nne=new Be("LIVE_ANNOUNCER_DEFAULT_OPTIONS"),Pne=0,X4=(()=>{class e{constructor(i,r,n,a){this._ngZone=r,this._defaultOptions=a,this._document=n,this._liveElement=i||this._createLiveElement()}announce(i,...r){let n=this._defaultOptions,a,o;return r.length===1&&typeof r[0]=="number"?o=r[0]:[a,o]=r,this.clear(),clearTimeout(this._previousTimeout),a||(a=n&&n.politeness?n.politeness:"polite"),o==null&&n&&(o=n.duration),this._liveElement.setAttribute("aria-live",a),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(s=>this._currentResolve=s)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=i,typeof o=="number"&&(this._previousTimeout=setTimeout(()=>this.clear(),o)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){let i="cdk-live-announcer-element",r=this._document.getElementsByClassName(i),n=this._document.createElement("div");for(let a=0;a<r.length;a++)r[a].remove();return n.classList.add(i),n.classList.add("cdk-visually-hidden"),n.setAttribute("aria-atomic","true"),n.setAttribute("aria-live","polite"),n.id=`cdk-live-announcer-${Pne++}`,this._document.body.appendChild(n),n}_exposeAnnouncerToModals(i){let r=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let n=0;n<r.length;n++){let a=r[n],o=a.getAttribute("aria-owns");o?o.indexOf(i)===-1&&a.setAttribute("aria-owns",o+" "+i):a.setAttribute("aria-owns",i)}}static{this.\u0275fac=function(r){return new(r||e)(he(Ine,8),he(Xe),he(yt),he(Nne,8))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var cy=function(e){return e[e.IMMEDIATE=0]="IMMEDIATE",e[e.EVENTUAL=1]="EVENTUAL",e}(cy||{}),Rne=new Be("cdk-focus-monitor-default-options"),ly=sd({passive:!0,capture:!0}),Ks=(()=>{class e{constructor(i,r,n,a,o){this._ngZone=i,this._platform=r,this._inputModalityDetector=n,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new ut,this._rootNodeFocusAndBlurListener=s=>{let l=Xo(s);for(let c=l;c;c=c.parentElement)s.type==="focus"?this._onFocus(s,c):this._onBlur(s,c)},this._document=a,this._detectionMode=o?.detectionMode||cy.IMMEDIATE}monitor(i,r=!1){let n=Yo(i);if(!this._platform.isBrowser||n.nodeType!==1)return pt();let a=R4(n)||this._getDocument(),o=this._elementInfo.get(n);if(o)return r&&(o.checkChildren=!0),o.subject;let s={checkChildren:r,subject:new ut,rootNode:a};return this._elementInfo.set(n,s),this._registerGlobalListeners(s),s.subject}stopMonitoring(i){let r=Yo(i),n=this._elementInfo.get(r);n&&(n.subject.complete(),this._setClasses(r),this._elementInfo.delete(r),this._removeGlobalListeners(n))}focusVia(i,r,n){let a=Yo(i),o=this._getDocument().activeElement;a===o?this._getClosestElementsInfo(a).forEach(([s,l])=>this._originChanged(s,r,l)):(this._setOrigin(r),typeof a.focus=="function"&&a.focus(n))}ngOnDestroy(){this._elementInfo.forEach((i,r)=>this.stopMonitoring(r))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(i){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(i)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:i&&this._isLastInteractionFromInputLabel(i)?"mouse":"program"}_shouldBeAttributedToTouch(i){return this._detectionMode===cy.EVENTUAL||!!i?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(i,r){i.classList.toggle("cdk-focused",!!r),i.classList.toggle("cdk-touch-focused",r==="touch"),i.classList.toggle("cdk-keyboard-focused",r==="keyboard"),i.classList.toggle("cdk-mouse-focused",r==="mouse"),i.classList.toggle("cdk-program-focused",r==="program")}_setOrigin(i,r=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=i,this._originFromTouchInteraction=i==="touch"&&r,this._detectionMode===cy.IMMEDIATE){clearTimeout(this._originTimeoutId);let n=this._originFromTouchInteraction?$4:1;this._originTimeoutId=setTimeout(()=>this._origin=null,n)}})}_onFocus(i,r){let n=this._elementInfo.get(r),a=Xo(i);!n||!n.checkChildren&&r!==a||this._originChanged(r,this._getFocusOrigin(a),n)}_onBlur(i,r){let n=this._elementInfo.get(r);!n||n.checkChildren&&i.relatedTarget instanceof Node&&r.contains(i.relatedTarget)||(this._setClasses(r),this._emitOrigin(n,null))}_emitOrigin(i,r){i.subject.observers.length&&this._ngZone.run(()=>i.subject.next(r))}_registerGlobalListeners(i){if(!this._platform.isBrowser)return;let r=i.rootNode,n=this._rootNodeFocusListenerCount.get(r)||0;n||this._ngZone.runOutsideAngular(()=>{r.addEventListener("focus",this._rootNodeFocusAndBlurListener,ly),r.addEventListener("blur",this._rootNodeFocusAndBlurListener,ly)}),this._rootNodeFocusListenerCount.set(r,n+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(yi(this._stopInputModalityDetector)).subscribe(a=>{this._setOrigin(a,!0)}))}_removeGlobalListeners(i){let r=i.rootNode;if(this._rootNodeFocusListenerCount.has(r)){let n=this._rootNodeFocusListenerCount.get(r);n>1?this._rootNodeFocusListenerCount.set(r,n-1):(r.removeEventListener("focus",this._rootNodeFocusAndBlurListener,ly),r.removeEventListener("blur",this._rootNodeFocusAndBlurListener,ly),this._rootNodeFocusListenerCount.delete(r))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(i,r,n){this._setClasses(i,r),this._emitOrigin(n,r),this._lastFocusOrigin=r}_getClosestElementsInfo(i){let r=[];return this._elementInfo.forEach((n,a)=>{(a===i||n.checkChildren&&a.contains(i))&&r.push([a,n])}),r}_isLastInteractionFromInputLabel(i){let{_mostRecentTarget:r,mostRecentModality:n}=this._inputModalityDetector;if(n!=="mouse"||!r||r===i||i.nodeName!=="INPUT"&&i.nodeName!=="TEXTAREA"||i.disabled)return!1;let a=i.labels;if(a){for(let o=0;o<a.length;o++)if(a[o].contains(r))return!0}return!1}static{this.\u0275fac=function(r){return new(r||e)(he(Xe),he(pi),he(Mne),he(yt,8),he(Rne,8))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var zu=function(e){return e[e.NONE=0]="NONE",e[e.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",e[e.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",e}(zu||{}),z4="cdk-high-contrast-black-on-white",U4="cdk-high-contrast-white-on-black",DA="cdk-high-contrast-active",Y4=(()=>{class e{constructor(i,r){this._platform=i,this._document=r,this._breakpointSubscription=Ve(B4).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return zu.NONE;let i=this._document.createElement("div");i.style.backgroundColor="rgb(1,2,3)",i.style.position="absolute",this._document.body.appendChild(i);let r=this._document.defaultView||window,n=r&&r.getComputedStyle?r.getComputedStyle(i):null,a=(n&&n.backgroundColor||"").replace(/ /g,"");switch(i.remove(),a){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return zu.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return zu.BLACK_ON_WHITE}return zu.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let i=this._document.body.classList;i.remove(DA,z4,U4),this._hasCheckedHighContrastMode=!0;let r=this.getHighContrastMode();r===zu.BLACK_ON_WHITE?i.add(DA,z4):r===zu.WHITE_ON_BLACK&&i.add(DA,U4)}}static{this.\u0275fac=function(r){return new(r||e)(he(pi),he(yt))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Fne=["text"],One=[[["mat-icon"]],"*"],Lne=["mat-icon","*"];function Bne(e,t){if(e&1&&ae(0,"mat-pseudo-checkbox",1),e&2){let i=J();O("disabled",i.disabled)("state",i.selected?"checked":"unchecked")}}function Vne(e,t){if(e&1&&ae(0,"mat-pseudo-checkbox",3),e&2){let i=J();O("disabled",i.disabled)}}function zne(e,t){if(e&1&&(S(0,"span",4),G(1),A()),e&2){let i=J();P(),Vr("(",i.group.label,")")}}var Une=["mat-internal-form-field",""],Hne=["*"];function Gne(){return!0}var jne=new Be("mat-sanity-checks",{providedIn:"root",factory:Gne}),Et=(()=>{class e{constructor(i,r,n){this._sanityChecks=r,this._document=n,this._hasDoneGlobalChecks=!1,i._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(i){return lv()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[i]}static{this.\u0275fac=function(r){return new(r||e)(he(Y4),he(jne,8),he(yt))}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[od,od]})}}return e})();var Jm=class{constructor(t,i,r,n,a){this._defaultMatcher=t,this.ngControl=i,this._parentFormGroup=r,this._parentForm=n,this._stateChanges=a,this.errorState=!1}updateErrorState(){let t=this.errorState,i=this._parentFormGroup||this._parentForm,r=this.matcher||this._defaultMatcher,n=this.ngControl?this.ngControl.control:null,a=r?.isErrorState(n,i)??!1;a!==t&&(this.errorState=a,this._stateChanges.next())}};var vy=(()=>{class e{isErrorState(i,r){return!!(i&&i.invalid&&(i.touched||r&&r.submitted))}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var GA=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[Et,Et]})}}return e})(),fa=function(e){return e[e.FADING_IN=0]="FADING_IN",e[e.VISIBLE=1]="VISIBLE",e[e.FADING_OUT=2]="FADING_OUT",e[e.HIDDEN=3]="HIDDEN",e}(fa||{}),VA=class{constructor(t,i,r,n=!1){this._renderer=t,this.element=i,this.config=r,this._animationForciblyDisabledThroughCss=n,this.state=fa.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},Z4=sd({passive:!0,capture:!0}),zA=class{constructor(){this._events=new Map,this._delegateEventHandler=t=>{let i=Xo(t);i&&this._events.get(t.type)?.forEach((r,n)=>{(n===i||n.contains(i))&&r.forEach(a=>a.handleEvent(t))})}}addHandler(t,i,r,n){let a=this._events.get(i);if(a){let o=a.get(r);o?o.add(n):a.set(r,new Set([n]))}else this._events.set(i,new Map([[r,new Set([n])]])),t.runOutsideAngular(()=>{document.addEventListener(i,this._delegateEventHandler,Z4)})}removeHandler(t,i,r){let n=this._events.get(t);if(!n)return;let a=n.get(i);a&&(a.delete(r),a.size===0&&n.delete(i),n.size===0&&(this._events.delete(t),document.removeEventListener(t,this._delegateEventHandler,Z4)))}},K4={enterDuration:225,exitDuration:150},Wne=800,Q4=sd({passive:!0,capture:!0}),J4=["mousedown","touchstart"],e8=["mouseup","mouseleave","touchend","touchcancel"],gy=class e{static{this._eventManager=new zA}constructor(t,i,r,n){this._target=t,this._ngZone=i,this._platform=n,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,n.isBrowser&&(this._containerElement=Yo(r))}fadeInRipple(t,i,r={}){let n=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),a=Z(Z({},K4),r.animation);r.centered&&(t=n.left+n.width/2,i=n.top+n.height/2);let o=r.radius||qne(t,i,n),s=t-n.left,l=i-n.top,c=a.enterDuration,d=document.createElement("div");d.classList.add("mat-ripple-element"),d.style.left=`${s-o}px`,d.style.top=`${l-o}px`,d.style.height=`${o*2}px`,d.style.width=`${o*2}px`,r.color!=null&&(d.style.backgroundColor=r.color),d.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(d);let u=window.getComputedStyle(d),h=u.transitionProperty,m=u.transitionDuration,f=h==="none"||m==="0s"||m==="0s, 0s"||n.width===0&&n.height===0,p=new VA(this,d,r,f);d.style.transform="scale3d(1, 1, 1)",p.state=fa.FADING_IN,r.persistent||(this._mostRecentTransientRipple=p);let g=null;return!f&&(c||a.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let v=()=>this._finishRippleTransition(p),b=()=>this._destroyRipple(p);d.addEventListener("transitionend",v),d.addEventListener("transitioncancel",b),g={onTransitionEnd:v,onTransitionCancel:b}}),this._activeRipples.set(p,g),(f||!c)&&this._finishRippleTransition(p),p}fadeOutRipple(t){if(t.state===fa.FADING_OUT||t.state===fa.HIDDEN)return;let i=t.element,r=Z(Z({},K4),t.config.animation);i.style.transitionDuration=`${r.exitDuration}ms`,i.style.opacity="0",t.state=fa.FADING_OUT,(t._animationForciblyDisabledThroughCss||!r.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){let i=Yo(t);!this._platform.isBrowser||!i||i===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=i,J4.forEach(r=>{e._eventManager.addHandler(this._ngZone,r,i,this)}))}handleEvent(t){t.type==="mousedown"?this._onMousedown(t):t.type==="touchstart"?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{e8.forEach(i=>{this._triggerElement.addEventListener(i,this,Q4)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){t.state===fa.FADING_IN?this._startFadeOutTransition(t):t.state===fa.FADING_OUT&&this._destroyRipple(t)}_startFadeOutTransition(t){let i=t===this._mostRecentTransientRipple,{persistent:r}=t.config;t.state=fa.VISIBLE,!r&&(!i||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){let i=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=fa.HIDDEN,i!==null&&(t.element.removeEventListener("transitionend",i.onTransitionEnd),t.element.removeEventListener("transitioncancel",i.onTransitionCancel)),t.element.remove()}_onMousedown(t){let i=FA(t),r=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+Wne;!this._target.rippleDisabled&&!i&&!r&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!OA(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let i=t.changedTouches;if(i)for(let r=0;r<i.length;r++)this.fadeInRipple(i[r].clientX,i[r].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{let i=t.state===fa.VISIBLE||t.config.terminateOnPointerUp&&t.state===fa.FADING_IN;!t.config.persistent&&i&&t.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let t=this._triggerElement;t&&(J4.forEach(i=>e._eventManager.removeHandler(i,t,this)),this._pointerUpEventsRegistered&&(e8.forEach(i=>t.removeEventListener(i,this,Q4)),this._pointerUpEventsRegistered=!1))}};function qne(e,t,i){let r=Math.max(Math.abs(e-i.left),Math.abs(e-i.right)),n=Math.max(Math.abs(t-i.top),Math.abs(t-i.bottom));return Math.sqrt(r*r+n*n)}var dv=new Be("mat-ripple-global-options"),Zo=(()=>{class e{get disabled(){return this._disabled}set disabled(i){i&&this.fadeOutAllNonPersistent(),this._disabled=i,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(i){this._trigger=i,this._setupTriggerEventsIfEnabled()}constructor(i,r,n,a,o){this._elementRef=i,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=a||{},this._rippleRenderer=new gy(this,r,i,n)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Z(Z(Z({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(i,r=0,n){return typeof i=="number"?this._rippleRenderer.fadeInRipple(i,r,Z(Z({},this.rippleConfig),n)):this._rippleRenderer.fadeInRipple(0,0,Z(Z({},this.rippleConfig),i))}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(Xe),z(pi),z(dv,8),z(zi,8))}}static{this.\u0275dir=lt({type:e,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(r,n){r&2&&ft("mat-ripple-unbounded",n.unbounded)},inputs:{color:[de.None,"matRippleColor","color"],unbounded:[de.None,"matRippleUnbounded","unbounded"],centered:[de.None,"matRippleCentered","centered"],radius:[de.None,"matRippleRadius","radius"],animation:[de.None,"matRippleAnimation","animation"],disabled:[de.None,"matRippleDisabled","disabled"],trigger:[de.None,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0})}}return e})(),jl=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[Et,Et]})}}return e})(),jA=(()=>{class e{constructor(i){this._animationMode=i,this.state="unchecked",this.disabled=!1,this.appearance="full"}static{this.\u0275fac=function(r){return new(r||e)(z(zi,8))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(r,n){r&2&&ft("mat-pseudo-checkbox-indeterminate",n.state==="indeterminate")("mat-pseudo-checkbox-checked",n.state==="checked")("mat-pseudo-checkbox-disabled",n.disabled)("mat-pseudo-checkbox-minimal",n.appearance==="minimal")("mat-pseudo-checkbox-full",n.appearance==="full")("_mat-animation-noopable",n._animationMode==="NoopAnimations")},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},standalone:!0,features:[Xt],decls:0,vars:0,template:function(r,n){},styles:['.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-minimal-pseudo-checkbox-selected-checkmark-color)}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color)}.mat-pseudo-checkbox-full{border-color:var(--mat-full-pseudo-checkbox-unselected-icon-color);border-width:2px;border-style:solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-disabled{border-color:var(--mat-full-pseudo-checkbox-disabled-unselected-icon-color)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{background-color:var(--mat-full-pseudo-checkbox-selected-icon-color);border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-full-pseudo-checkbox-selected-checkmark-color)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled{background-color:var(--mat-full-pseudo-checkbox-disabled-selected-icon-color)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-full-pseudo-checkbox-disabled-selected-checkmark-color)}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}'],encapsulation:2,changeDetection:0})}}return e})(),WA=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[Et]})}}return e})(),qA=new Be("MAT_OPTION_PARENT_COMPONENT");var $A=new Be("MatOptgroup");var $ne=0,UA=class{constructor(t,i=!1){this.source=t,this.isUserInput=i}},ip=(()=>{class e{get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(i){this._disabled=i}get disableRipple(){return!!(this._parent&&this._parent.disableRipple)}get hideSingleSelectionIndicator(){return!!(this._parent&&this._parent.hideSingleSelectionIndicator)}constructor(i,r,n,a){this._element=i,this._changeDetectorRef=r,this._parent=n,this.group=a,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id=`mat-option-${$ne++}`,this.onSelectionChange=new Pe,this._stateChanges=new ut}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(i=!0){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),i&&this._emitSelectionChangeEvent())}deselect(i=!0){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),i&&this._emitSelectionChangeEvent())}focus(i,r){let n=this._getHostElement();typeof n.focus=="function"&&n.focus(r)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(i){(i.keyCode===13||i.keyCode===32)&&!vo(i)&&(this._selectViaInteraction(),i.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=this.multiple?!this._selected:!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){let i=this.viewValue;i!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=i)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(i=!1){this.onSelectionChange.emit(new UA(this,i))}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(Vt),z(qA,8),z($A,8))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-option"]],viewQuery:function(r,n){if(r&1&&tt(Fne,7),r&2){let a;Me(a=Ie())&&(n._text=a.first)}},hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(r,n){r&1&&q("click",function(){return n._selectViaInteraction()})("keydown",function(o){return n._handleKeydown(o)}),r&2&&(Cs("id",n.id),Ft("aria-selected",n.selected)("aria-disabled",n.disabled.toString()),ft("mdc-list-item--selected",n.selected)("mat-mdc-option-multiple",n.multiple)("mat-mdc-option-active",n.active)("mdc-list-item--disabled",n.disabled))},inputs:{value:"value",id:"id",disabled:[de.HasDecoratorInputTransform,"disabled","disabled",ot]},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],standalone:!0,features:[wi,Xt],ngContentSelectors:Lne,decls:8,vars:5,consts:[["text",""],["aria-hidden","true",1,"mat-mdc-option-pseudo-checkbox",3,"disabled","state"],[1,"mdc-list-item__primary-text"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"],["aria-hidden","true","mat-ripple","",1,"mat-mdc-option-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled"]],template:function(r,n){r&1&&(ti(One),Te(0,Bne,1,2,"mat-pseudo-checkbox",1),it(1),S(2,"span",2,0),it(4,1),A(),Te(5,Vne,1,1,"mat-pseudo-checkbox",3)(6,zne,2,1,"span",4),ae(7,"div",5)),r&2&&(fi(0,n.multiple?0:-1),P(5),fi(5,!n.multiple&&n.selected&&!n.hideSingleSelectionIndicator?5:-1),P(),fi(6,n.group&&n.group._inert?6:-1),P(),O("matRippleTrigger",n._getHostElement())("matRippleDisabled",n.disabled||n.disableRipple))},dependencies:[jA,Zo],styles:['.mat-mdc-option{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:16px;padding-right:16px;-webkit-user-select:none;user-select:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);color:var(--mat-option-label-text-color);font-family:var(--mat-option-label-text-font);line-height:var(--mat-option-label-text-line-height);font-size:var(--mat-option-label-text-size);letter-spacing:var(--mat-option-label-text-tracking);font-weight:var(--mat-option-label-text-weight);min-height:48px}.mat-mdc-option:focus{outline:none}[dir=rtl] .mat-mdc-option,.mat-mdc-option[dir=rtl]{padding-left:16px;padding-right:16px}.mat-mdc-option:hover:not(.mdc-list-item--disabled){background-color:var(--mat-option-hover-state-layer-color)}.mat-mdc-option:focus.mdc-list-item,.mat-mdc-option.mat-mdc-option-active.mdc-list-item{background-color:var(--mat-option-focus-state-layer-color)}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled) .mdc-list-item__primary-text{color:var(--mat-option-selected-state-label-text-color)}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-multiple){background-color:var(--mat-option-selected-state-layer-color)}.mat-mdc-option.mdc-list-item{align-items:center;background:rgba(0,0,0,0)}.mat-mdc-option.mdc-list-item--disabled{cursor:default;pointer-events:none}.mat-mdc-option.mdc-list-item--disabled .mat-mdc-option-pseudo-checkbox,.mat-mdc-option.mdc-list-item--disabled .mdc-list-item__primary-text,.mat-mdc-option.mdc-list-item--disabled>mat-icon{opacity:.38}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}.cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{right:auto;left:16px}.mat-mdc-option-multiple{--mdc-list-list-item-selected-container-color:var(--mdc-list-list-item-container-color, transparent)}.mat-mdc-option-active .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}}return e})();function n8(e,t,i){if(i.length){let r=t.toArray(),n=i.toArray(),a=0;for(let o=0;o<e+1;o++)r[o].group&&r[o].group===n[a]&&a++;return a}return 0}function a8(e,t,i,r){return e<i?e:e+t>i+r?Math.max(0,e-r+t):i}var XA=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[jl,Et,WA]})}}return e})(),t8={capture:!0},i8=["focus","click","mouseenter","touchstart"],LA="mat-ripple-loader-uninitialized",BA="mat-ripple-loader-class-name",r8="mat-ripple-loader-centered",fy="mat-ripple-loader-disabled",o8=(()=>{class e{constructor(){this._document=Ve(yt,{optional:!0}),this._animationMode=Ve(zi,{optional:!0}),this._globalRippleOptions=Ve(dv,{optional:!0}),this._platform=Ve(pi),this._ngZone=Ve(Xe),this._hosts=new Map,this._onInteraction=i=>{if(!(i.target instanceof HTMLElement))return;let n=i.target.closest(`[${LA}]`);n&&this._createRipple(n)},this._ngZone.runOutsideAngular(()=>{for(let i of i8)this._document?.addEventListener(i,this._onInteraction,t8)})}ngOnDestroy(){let i=this._hosts.keys();for(let r of i)this.destroyRipple(r);for(let r of i8)this._document?.removeEventListener(r,this._onInteraction,t8)}configureRipple(i,r){i.setAttribute(LA,""),(r.className||!i.hasAttribute(BA))&&i.setAttribute(BA,r.className||""),r.centered&&i.setAttribute(r8,""),r.disabled&&i.setAttribute(fy,"")}getRipple(i){return this._hosts.get(i)||this._createRipple(i)}setDisabled(i,r){let n=this._hosts.get(i);if(n){n.disabled=r;return}r?i.setAttribute(fy,""):i.removeAttribute(fy)}_createRipple(i){if(!this._document)return;let r=this._hosts.get(i);if(r)return r;i.querySelector(".mat-ripple")?.remove();let n=this._document.createElement("span");n.classList.add("mat-ripple",i.getAttribute(BA)),i.append(n);let a=new Zo(new nt(n),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return a._isInitialized=!0,a.trigger=i,a.centered=i.hasAttribute(r8),a.disabled=i.hasAttribute(fy),this.attachRipple(i,a),a}attachRipple(i,r){i.removeAttribute(LA),this._hosts.set(i,r)}destroyRipple(i){let r=this._hosts.get(i);r&&(r.ngOnDestroy(),this._hosts.delete(i))}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),_y=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=Ae({type:e,selectors:[["div","mat-internal-form-field",""]],hostAttrs:[1,"mdc-form-field","mat-internal-form-field"],hostVars:2,hostBindings:function(r,n){r&2&&ft("mdc-form-field--align-end",n.labelPosition==="before")},inputs:{labelPosition:"labelPosition"},standalone:!0,features:[Xt],attrs:Une,ngContentSelectors:Hne,decls:1,vars:0,template:function(r,n){r&1&&(ti(),it(0))},styles:[".mdc-form-field{display:inline-flex;align-items:center;vertical-align:middle}.mdc-form-field[hidden]{display:none}.mdc-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{margin-left:auto;margin-right:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{padding-left:0;padding-right:4px}.mdc-form-field--nowrap>label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{padding-left:4px;padding-right:0}.mdc-form-field--space-between{justify-content:space-between}.mdc-form-field--space-between>label{margin:0}[dir=rtl] .mdc-form-field--space-between>label,.mdc-form-field--space-between>label[dir=rtl]{margin:0}.mdc-form-field{font-family:var(--mdc-form-field-label-text-font);line-height:var(--mdc-form-field-label-text-line-height);font-size:var(--mdc-form-field-label-text-size);font-weight:var(--mdc-form-field-label-text-weight);letter-spacing:var(--mdc-form-field-label-text-tracking);color:var(--mdc-form-field-label-text-color)}.mat-internal-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}"],encapsulation:2,changeDetection:0})}}return e})();var Xne=["notch"],Yne=["matFormFieldNotchedOutline",""],Zne=["*"],Kne=["textField"],Qne=["iconPrefixContainer"],Jne=["textPrefixContainer"],eae=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],tae=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function iae(e,t){e&1&&ae(0,"span",17)}function rae(e,t){if(e&1&&(S(0,"label",16),it(1,1),Te(2,iae,1,0,"span",17),A()),e&2){let i=J(2);O("floating",i._shouldLabelFloat())("monitorResize",i._hasOutline())("id",i._labelId),Ft("for",i._control.disableAutomaticLabeling?null:i._control.id),P(2),fi(2,!i.hideRequiredMarker&&i._control.required?2:-1)}}function nae(e,t){if(e&1&&Te(0,rae,3,5,"label",16),e&2){let i=J();fi(0,i._hasFloatingLabel()?0:-1)}}function aae(e,t){e&1&&ae(0,"div",5)}function oae(e,t){}function sae(e,t){if(e&1&&Te(0,oae,0,0,"ng-template",11),e&2){J(2);let i=kt(1);O("ngTemplateOutlet",i)}}function lae(e,t){if(e&1&&(S(0,"div",7),Te(1,sae,1,1,null,11),A()),e&2){let i=J();O("matFormFieldNotchedOutlineOpen",i._shouldLabelFloat()),P(),fi(1,i._forceDisplayInfixLabel()?-1:1)}}function cae(e,t){e&1&&(S(0,"div",8,2),it(2,2),A())}function dae(e,t){e&1&&(S(0,"div",9,3),it(2,3),A())}function uae(e,t){}function hae(e,t){if(e&1&&Te(0,uae,0,0,"ng-template",11),e&2){J();let i=kt(1);O("ngTemplateOutlet",i)}}function mae(e,t){e&1&&(S(0,"div",12),it(1,4),A())}function pae(e,t){e&1&&(S(0,"div",13),it(1,5),A())}function fae(e,t){e&1&&ae(0,"div",14)}function gae(e,t){if(e&1&&(S(0,"div",18),it(1,6),A()),e&2){let i=J();O("@transitionMessages",i._subscriptAnimationState)}}function vae(e,t){if(e&1&&(S(0,"mat-hint",20),G(1),A()),e&2){let i=J(2);O("id",i._hintLabelId),P(),gr(i.hintLabel)}}function _ae(e,t){if(e&1&&(S(0,"div",19),Te(1,vae,2,2,"mat-hint",20),it(2,7),ae(3,"div",21),it(4,8),A()),e&2){let i=J();O("@transitionMessages",i._subscriptAnimationState),P(),fi(1,i.hintLabel?1:-1)}}var Qs=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=lt({type:e,selectors:[["mat-label"]],standalone:!0})}}return e})();var bae=new Be("MatError");var xae=0,s8=(()=>{class e{constructor(){this.align="start",this.id=`mat-mdc-hint-${xae++}`}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=lt({type:e,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(r,n){r&2&&(Cs("id",n.id),Ft("align",null),ft("mat-mdc-form-field-hint-end",n.align==="end"))},inputs:{align:"align",id:"id"},standalone:!0})}}return e})(),yae=new Be("MatPrefix");var wae=new Be("MatSuffix");var f8=new Be("FloatingLabelParent"),l8=(()=>{class e{get floating(){return this._floating}set floating(i){this._floating=i,this.monitorResize&&this._handleResize()}get monitorResize(){return this._monitorResize}set monitorResize(i){this._monitorResize=i,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}constructor(i){this._elementRef=i,this._floating=!1,this._monitorResize=!1,this._resizeObserver=Ve(F4),this._ngZone=Ve(Xe),this._parent=Ve(f8),this._resizeSubscription=new Nr}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return Cae(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}static{this.\u0275fac=function(r){return new(r||e)(z(nt))}}static{this.\u0275dir=lt({type:e,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(r,n){r&2&&ft("mdc-floating-label--float-above",n.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"},standalone:!0})}}return e})();function Cae(e){let t=e;if(t.offsetParent!==null)return t.scrollWidth;let i=t.cloneNode(!0);i.style.setProperty("position","absolute"),i.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(i);let r=i.scrollWidth;return i.remove(),r}var c8="mdc-line-ripple--active",xy="mdc-line-ripple--deactivating",d8=(()=>{class e{constructor(i,r){this._elementRef=i,this._handleTransitionEnd=n=>{let a=this._elementRef.nativeElement.classList,o=a.contains(xy);n.propertyName==="opacity"&&o&&a.remove(c8,xy)},r.runOutsideAngular(()=>{i.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){let i=this._elementRef.nativeElement.classList;i.remove(xy),i.add(c8)}deactivate(){this._elementRef.nativeElement.classList.add(xy)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(Xe))}}static{this.\u0275dir=lt({type:e,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"],standalone:!0})}}return e})(),u8=(()=>{class e{constructor(i,r){this._elementRef=i,this._ngZone=r,this.open=!1}ngAfterViewInit(){let i=this._elementRef.nativeElement.querySelector(".mdc-floating-label");i?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),typeof requestAnimationFrame=="function"&&(i.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>i.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(i){!this.open||!i?this._notch.nativeElement.style.width="":this._notch.nativeElement.style.width=`calc(${i}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(Xe))}}static{this.\u0275cmp=Ae({type:e,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(r,n){if(r&1&&tt(Xne,5),r&2){let a;Me(a=Ie())&&(n._notch=a.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(r,n){r&2&&ft("mdc-notched-outline--notched",n.open)},inputs:{open:[de.None,"matFormFieldNotchedOutlineOpen","open"]},standalone:!0,features:[Xt],attrs:Yne,ngContentSelectors:Zne,decls:5,vars:0,consts:[["notch",""],[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],[1,"mdc-notched-outline__trailing"]],template:function(r,n){r&1&&(ti(),ae(0,"div",1),S(1,"div",2,0),it(3),A(),ae(4,"div",3))},encapsulation:2,changeDetection:0})}}return e})(),Eae={transitionMessages:Ts("transitionMessages",[So("enter",ta({opacity:1,transform:"translateY(0%)"})),Ao("void => enter",[ta({opacity:0,transform:"translateY(-5px)"}),os("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},uv=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=lt({type:e})}}return e})();var hv=new Be("MatFormField"),Sae=new Be("MAT_FORM_FIELD_DEFAULT_OPTIONS"),h8=0,m8="fill",Aae="auto",p8="fixed",Tae="translateY(-50%)",rp=(()=>{class e{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(i){this._hideRequiredMarker=qn(i)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||Aae}set floatLabel(i){i!==this._floatLabel&&(this._floatLabel=i,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(i){let r=this._appearance,n=i||this._defaults?.appearance||m8;this._appearance=n,this._appearance==="outline"&&this._appearance!==r&&(this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||p8}set subscriptSizing(i){this._subscriptSizing=i||this._defaults?.subscriptSizing||p8}get hintLabel(){return this._hintLabel}set hintLabel(i){this._hintLabel=i,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(i){this._explicitFormFieldControl=i}constructor(i,r,n,a,o,s,l,c){this._elementRef=i,this._changeDetectorRef=r,this._ngZone=n,this._dir=a,this._platform=o,this._defaults=s,this._animationMode=l,this._hideRequiredMarker=!1,this.color="primary",this._appearance=m8,this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId=`mat-mdc-form-field-label-${h8++}`,this._hintLabelId=`mat-mdc-hint-${h8++}`,this._subscriptAnimationState="",this._destroyed=new ut,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,s&&(s.appearance&&(this.appearance=s.appearance),this._hideRequiredMarker=!!s?.hideRequiredMarker,s.color&&(this.color=s.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){let i=this._control;i.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${i.controlType}`),i.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),i.ngControl&&i.ngControl.valueChanges&&i.ngControl.valueChanges.pipe(yi(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(i=>!i._isText),this._hasTextPrefix=!!this._prefixChildren.find(i=>i._isText),this._hasIconSuffix=!!this._suffixChildren.find(i=>!i._isText),this._hasTextSuffix=!!this._suffixChildren.find(i=>i._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),Rn(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){this._control}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||this._isFocused===null)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(yi(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe(yi(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return this.floatLabel==="always"}_hasOutline(){return this.appearance==="outline"}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(i){let r=this._control?this._control.ngControl:null;return r&&r[i]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||!this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(0):this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){this._hintChildren}_syncDescribedByIds(){if(this._control){let i=[];if(this._control.userAriaDescribedBy&&typeof this._control.userAriaDescribedBy=="string"&&i.push(...this._control.userAriaDescribedBy.split(" ")),this._getDisplayedMessages()==="hint"){let r=this._hintChildren?this._hintChildren.find(a=>a.align==="start"):null,n=this._hintChildren?this._hintChildren.find(a=>a.align==="end"):null;r?i.push(r.id):this._hintLabel&&i.push(this._hintLabelId),n&&i.push(n.id)}else this._errorChildren&&i.push(...this._errorChildren.map(r=>r.id));this._control.setDescribedByIds(i)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;let i=this._floatingLabel.element;if(!(this._iconPrefixContainer||this._textPrefixContainer)){i.style.transform="";return}if(!this._isAttachedToDom()){this._needsOutlineLabelOffsetUpdateOnStable=!0;return}let r=this._iconPrefixContainer?.nativeElement,n=this._textPrefixContainer?.nativeElement,a=r?.getBoundingClientRect().width??0,o=n?.getBoundingClientRect().width??0,s=this._dir.value==="rtl"?"-1":"1",l=`${a+o}px`,d=`calc(${s} * (${l} + var(--mat-mdc-form-field-label-offset-x, 0px)))`;i.style.transform=`var(
        --mat-mdc-form-field-label-transform,
        ${Tae} translateX(${d})
    )`}_isAttachedToDom(){let i=this._elementRef.nativeElement;if(i.getRootNode){let r=i.getRootNode();return r&&r!==i}return document.documentElement.contains(i)}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(Vt),z(Xe),z(go),z(pi),z(Sae,8),z(zi,8),z(yt))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-form-field"]],contentQueries:function(r,n,a){if(r&1&&(Si(a,Qs,5),Si(a,Qs,7),Si(a,uv,5),Si(a,yae,5),Si(a,wae,5),Si(a,bae,5),Si(a,s8,5)),r&2){let o;Me(o=Ie())&&(n._labelChildNonStatic=o.first),Me(o=Ie())&&(n._labelChildStatic=o.first),Me(o=Ie())&&(n._formFieldControl=o.first),Me(o=Ie())&&(n._prefixChildren=o),Me(o=Ie())&&(n._suffixChildren=o),Me(o=Ie())&&(n._errorChildren=o),Me(o=Ie())&&(n._hintChildren=o)}},viewQuery:function(r,n){if(r&1&&(tt(Kne,5),tt(Qne,5),tt(Jne,5),tt(l8,5),tt(u8,5),tt(d8,5)),r&2){let a;Me(a=Ie())&&(n._textField=a.first),Me(a=Ie())&&(n._iconPrefixContainer=a.first),Me(a=Ie())&&(n._textPrefixContainer=a.first),Me(a=Ie())&&(n._floatingLabel=a.first),Me(a=Ie())&&(n._notchedOutline=a.first),Me(a=Ie())&&(n._lineRipple=a.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(r,n){r&2&&ft("mat-mdc-form-field-label-always-float",n._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",n._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",n._hasIconSuffix)("mat-form-field-invalid",n._control.errorState)("mat-form-field-disabled",n._control.disabled)("mat-form-field-autofilled",n._control.autofilled)("mat-form-field-no-animations",n._animationMode==="NoopAnimations")("mat-form-field-appearance-fill",n.appearance=="fill")("mat-form-field-appearance-outline",n.appearance=="outline")("mat-form-field-hide-placeholder",n._hasFloatingLabel()&&!n._shouldLabelFloat())("mat-focused",n._control.focused)("mat-primary",n.color!=="accent"&&n.color!=="warn")("mat-accent",n.color==="accent")("mat-warn",n.color==="warn")("ng-untouched",n._shouldForward("untouched"))("ng-touched",n._shouldForward("touched"))("ng-pristine",n._shouldForward("pristine"))("ng-dirty",n._shouldForward("dirty"))("ng-valid",n._shouldForward("valid"))("ng-invalid",n._shouldForward("invalid"))("ng-pending",n._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],standalone:!0,features:[_i([{provide:hv,useExisting:e},{provide:f8,useExisting:e}]),Xt],ngContentSelectors:tae,decls:18,vars:21,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(r,n){if(r&1){let a=Ue();ti(eae),Te(0,nae,1,1,"ng-template",null,0,Ed),S(2,"div",4,1),q("click",function(s){return j(a),W(n._control.onContainerClick(s))}),Te(4,aae,1,0,"div",5),S(5,"div",6),Te(6,lae,2,2,"div",7)(7,cae,3,0,"div",8)(8,dae,3,0,"div",9),S(9,"div",10),Te(10,hae,1,1,null,11),it(11),A(),Te(12,mae,2,0,"div",12)(13,pae,2,0,"div",13),A(),Te(14,fae,1,0,"div",14),A(),S(15,"div",15),Te(16,gae,2,1)(17,_ae,5,2),A()}if(r&2){let a;P(2),ft("mdc-text-field--filled",!n._hasOutline())("mdc-text-field--outlined",n._hasOutline())("mdc-text-field--no-label",!n._hasFloatingLabel())("mdc-text-field--disabled",n._control.disabled)("mdc-text-field--invalid",n._control.errorState),P(2),fi(4,!n._hasOutline()&&!n._control.disabled?4:-1),P(2),fi(6,n._hasOutline()?6:-1),P(),fi(7,n._hasIconPrefix?7:-1),P(),fi(8,n._hasTextPrefix?8:-1),P(2),fi(10,!n._hasOutline()||n._forceDisplayInfixLabel()?10:-1),P(2),fi(12,n._hasTextSuffix?12:-1),P(),fi(13,n._hasIconSuffix?13:-1),P(),fi(14,n._hasOutline()?-1:14),P(),ft("mat-mdc-form-field-subscript-dynamic-size",n.subscriptSizing==="dynamic"),P(),fi(16,(a=n._getDisplayedMessages())==="error"?16:a==="hint"?17:-1)}},dependencies:[l8,u8,Dd,d8,s8],styles:['.mdc-text-field{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 96px/0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;pointer-events:none}.mdc-notched-outline__trailing{flex-grow:1}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-top:1px solid;border-bottom:1px solid}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{max-width:calc(100% - 12px*2)}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-text-field--filled{border-top-left-radius:var(--mdc-filled-text-field-container-shape);border-top-right-radius:var(--mdc-filled-text-field-container-shape);border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-caret-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-focus-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-hover-label-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-disabled-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-focus-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-hover-label-text-color)}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font);font-size:var(--mdc-filled-text-field-label-text-size);font-weight:var(--mdc-filled-text-field-label-text-weight);letter-spacing:var(--mdc-filled-text-field-label-text-tracking)}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color)}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color)}.mdc-text-field--filled .mdc-line-ripple::before{border-bottom-width:var(--mdc-filled-text-field-active-indicator-height)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-caret-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-focus-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-hover-label-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-disabled-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-focus-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-hover-label-text-color)}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font);font-size:var(--mdc-outlined-text-field-label-text-size);font-weight:var(--mdc-outlined-text-field-label-text-weight);letter-spacing:var(--mdc-outlined-text-field-label-text-tracking)}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(.75*var(--mdc-outlined-text-field-label-text-size))}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mdc-outlined-text-field-label-text-size)}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-outlined-text-field-container-shape))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-hover-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-focus-outline-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-disabled-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-hover-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-focus-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-outline-width)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-focus-outline-width)}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height);padding-top:var(--mat-form-field-filled-with-label-container-padding-top);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding);padding-bottom:var(--mat-form-field-container-vertical-padding)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color)}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font);line-height:var(--mat-form-field-subscript-text-line-height);font-size:var(--mat-form-field-subscript-text-size);letter-spacing:var(--mat-form-field-subscript-text-tracking);font-weight:var(--mat-form-field-subscript-text-weight)}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color)}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity)}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color)}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color)}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font);line-height:var(--mat-form-field-container-text-line-height);font-size:var(--mat-form-field-container-text-size);letter-spacing:var(--mat-form-field-container-text-tracking);font-weight:var(--mat-form-field-container-text-weight)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color)}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color)}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color)}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color)}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color)}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[Eae.transitionMessages]},changeDetection:0})}}return e})(),Uu=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[Et,On,sy,Et]})}}return e})();var np=class{get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(t=!1,i,r=!0,n){this._multiple=t,this._emitChanges=r,this.compareWith=n,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new ut,i&&i.length&&(t?i.forEach(a=>this._markSelected(a)):this._markSelected(i[0]),this._selectedToEmit.length=0)}select(...t){this._verifyValueAssignment(t),t.forEach(r=>this._markSelected(r));let i=this._hasQueuedChanges();return this._emitChangeEvent(),i}deselect(...t){this._verifyValueAssignment(t),t.forEach(r=>this._unmarkSelected(r));let i=this._hasQueuedChanges();return this._emitChangeEvent(),i}setSelection(...t){this._verifyValueAssignment(t);let i=this.selected,r=new Set(t);t.forEach(a=>this._markSelected(a)),i.filter(a=>!r.has(this._getConcreteValue(a,r))).forEach(a=>this._unmarkSelected(a));let n=this._hasQueuedChanges();return this._emitChangeEvent(),n}toggle(t){return this.isSelected(t)?this.deselect(t):this.select(t)}clear(t=!0){this._unmarkAll();let i=this._hasQueuedChanges();return t&&this._emitChangeEvent(),i}isSelected(t){return this._selection.has(this._getConcreteValue(t))}isEmpty(){return this._selection.size===0}hasValue(){return!this.isEmpty()}sort(t){this._multiple&&this.selected&&this._selected.sort(t)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(t){t=this._getConcreteValue(t),this.isSelected(t)||(this._multiple||this._unmarkAll(),this.isSelected(t)||this._selection.add(t),this._emitChanges&&this._selectedToEmit.push(t))}_unmarkSelected(t){t=this._getConcreteValue(t),this.isSelected(t)&&(this._selection.delete(t),this._emitChanges&&this._deselectedToEmit.push(t))}_unmarkAll(){this.isEmpty()||this._selection.forEach(t=>this._unmarkSelected(t))}_verifyValueAssignment(t){t.length>1&&this._multiple}_hasQueuedChanges(){return!!(this._deselectedToEmit.length||this._selectedToEmit.length)}_getConcreteValue(t,i){if(this.compareWith){i=i??this._selection;for(let r of i)if(this.compareWith(t,r))return r;return t}else return t}};var wy=(()=>{class e{constructor(){this._listeners=[]}notify(i,r){for(let n of this._listeners)n(i,r)}listen(i){return this._listeners.push(i),()=>{this._listeners=this._listeners.filter(r=>i!==r)}}ngOnDestroy(){this._listeners=[]}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Dae=20,mv=(()=>{class e{constructor(i,r,n){this._ngZone=i,this._platform=r,this._scrolled=new ut,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=n}register(i){this.scrollContainers.has(i)||this.scrollContainers.set(i,i.elementScrolled().subscribe(()=>this._scrolled.next(i)))}deregister(i){let r=this.scrollContainers.get(i);r&&(r.unsubscribe(),this.scrollContainers.delete(i))}scrolled(i=Dae){return this._platform.isBrowser?new ns(r=>{this._globalSubscription||this._addGlobalListener();let n=i>0?this._scrolled.pipe(Pw(i)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{n.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):pt()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((i,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(i,r){let n=this.getAncestorScrollContainers(i);return this.scrolled(r).pipe(Mi(a=>!a||n.indexOf(a)>-1))}getAncestorScrollContainers(i){let r=[];return this.scrollContainers.forEach((n,a)=>{this._scrollableContainsElement(a,i)&&r.push(a)}),r}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(i,r){let n=Yo(r),a=i.getElementRef().nativeElement;do if(n==a)return!0;while(n=n.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{let i=this._getWindow();return ya(i.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static{this.\u0275fac=function(r){return new(r||e)(he(Xe),he(pi),he(yt,8))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Cy=(()=>{class e{constructor(i,r,n,a){this.elementRef=i,this.scrollDispatcher=r,this.ngZone=n,this.dir=a,this._destroyed=new ut,this._elementScrolled=new ns(o=>this.ngZone.runOutsideAngular(()=>ya(this.elementRef.nativeElement,"scroll").pipe(yi(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(i){let r=this.elementRef.nativeElement,n=this.dir&&this.dir.value=="rtl";i.left==null&&(i.left=n?i.end:i.start),i.right==null&&(i.right=n?i.start:i.end),i.bottom!=null&&(i.top=r.scrollHeight-r.clientHeight-i.bottom),n&&Ym()!=_s.NORMAL?(i.left!=null&&(i.right=r.scrollWidth-r.clientWidth-i.left),Ym()==_s.INVERTED?i.left=i.right:Ym()==_s.NEGATED&&(i.left=i.right?-i.right:i.right)):i.right!=null&&(i.left=r.scrollWidth-r.clientWidth-i.right),this._applyScrollToOptions(i)}_applyScrollToOptions(i){let r=this.elementRef.nativeElement;oy()?r.scrollTo(i):(i.top!=null&&(r.scrollTop=i.top),i.left!=null&&(r.scrollLeft=i.left))}measureScrollOffset(i){let r="left",n="right",a=this.elementRef.nativeElement;if(i=="top")return a.scrollTop;if(i=="bottom")return a.scrollHeight-a.clientHeight-a.scrollTop;let o=this.dir&&this.dir.value=="rtl";return i=="start"?i=o?n:r:i=="end"&&(i=o?r:n),o&&Ym()==_s.INVERTED?i==r?a.scrollWidth-a.clientWidth-a.scrollLeft:a.scrollLeft:o&&Ym()==_s.NEGATED?i==r?a.scrollLeft+a.scrollWidth-a.clientWidth:-a.scrollLeft:i==r?a.scrollLeft:a.scrollWidth-a.clientWidth-a.scrollLeft}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(mv),z(Xe),z(go,8))}}static{this.\u0275dir=lt({type:e,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0})}}return e})(),Mae=20,Gu=(()=>{class e{constructor(i,r,n){this._platform=i,this._change=new ut,this._changeListener=a=>{this._change.next(a)},this._document=n,r.runOutsideAngular(()=>{if(i.isBrowser){let a=this._getWindow();a.addEventListener("resize",this._changeListener),a.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let i=this._getWindow();i.removeEventListener("resize",this._changeListener),i.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let i={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),i}getViewportRect(){let i=this.getViewportScrollPosition(),{width:r,height:n}=this.getViewportSize();return{top:i.top,left:i.left,bottom:i.top+n,right:i.left+r,height:n,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let i=this._document,r=this._getWindow(),n=i.documentElement,a=n.getBoundingClientRect(),o=-a.top||i.body.scrollTop||r.scrollY||n.scrollTop||0,s=-a.left||i.body.scrollLeft||r.scrollX||n.scrollLeft||0;return{top:o,left:s}}change(i=Mae){return i>0?this._change.pipe(Pw(i)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let i=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:i.innerWidth,height:i.innerHeight}:{width:0,height:0}}static{this.\u0275fac=function(r){return new(r||e)(he(pi),he(Xe),he(yt,8))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Hu=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({})}}return e})(),YA=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[od,Hu,od,Hu]})}}return e})();var pv=class{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;t!=null&&(this._attachedHost=null,t.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(t){this._attachedHost=t}},KA=class extends pv{constructor(t,i,r,n,a){super(),this.component=t,this.viewContainerRef=i,this.injector=r,this.componentFactoryResolver=n,this.projectableNodes=a}},ju=class extends pv{constructor(t,i,r,n){super(),this.templateRef=t,this.viewContainerRef=i,this.context=r,this.injector=n}get origin(){return this.templateRef.elementRef}attach(t,i=this.context){return this.context=i,super.attach(t)}detach(){return this.context=void 0,super.detach()}},QA=class extends pv{constructor(t){super(),this.element=t instanceof nt?t.nativeElement:t}},Ey=class{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){if(t instanceof KA)return this._attachedPortal=t,this.attachComponentPortal(t);if(t instanceof ju)return this._attachedPortal=t,this.attachTemplatePortal(t);if(this.attachDomPortal&&t instanceof QA)return this._attachedPortal=t,this.attachDomPortal(t)}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var Sy=class extends Ey{constructor(t,i,r,n,a){super(),this.outletElement=t,this._componentFactoryResolver=i,this._appRef=r,this._defaultInjector=n,this.attachDomPortal=o=>{this._document;let s=o.element;s.parentNode;let l=this._document.createComment("dom-portal");s.parentNode.insertBefore(l,s),this.outletElement.appendChild(s),this._attachedPortal=o,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(s,l)})},this._document=a}attachComponentPortal(t){let r=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),n;return t.viewContainerRef?(n=t.viewContainerRef.createComponent(r,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector,t.projectableNodes||void 0),this.setDisposeFn(()=>n.destroy())):(n=r.create(t.injector||this._defaultInjector||Ea.NULL),this._appRef.attachView(n.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(n.hostView),n.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(n)),this._attachedPortal=t,n}attachTemplatePortal(t){let i=t.viewContainerRef,r=i.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return r.rootNodes.forEach(n=>this.outletElement.appendChild(n)),r.detectChanges(),this.setDisposeFn(()=>{let n=i.indexOf(r);n!==-1&&i.remove(n)}),this._attachedPortal=t,r}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}};var v8=(()=>{class e extends Ey{constructor(i,r,n){super(),this._componentFactoryResolver=i,this._viewContainerRef=r,this._isInitialized=!1,this.attached=new Pe,this.attachDomPortal=a=>{this._document;let o=a.element;o.parentNode;let s=this._document.createComment("dom-portal");a.setAttachedHost(this),o.parentNode.insertBefore(s,o),this._getRootNode().appendChild(o),this._attachedPortal=a,super.setDisposeFn(()=>{s.parentNode&&s.parentNode.replaceChild(o,s)})},this._document=n}get portal(){return this._attachedPortal}set portal(i){this.hasAttached()&&!i&&!this._isInitialized||(this.hasAttached()&&super.detach(),i&&super.attach(i),this._attachedPortal=i||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(i){i.setAttachedHost(this);let r=i.viewContainerRef!=null?i.viewContainerRef:this._viewContainerRef,a=(i.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(i.component),o=r.createComponent(a,r.length,i.injector||r.injector,i.projectableNodes||void 0);return r!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=i,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(i){i.setAttachedHost(this);let r=this._viewContainerRef.createEmbeddedView(i.templateRef,i.context,{injector:i.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=i,this._attachedRef=r,this.attached.emit(r),r}_getRootNode(){let i=this._viewContainerRef.element.nativeElement;return i.nodeType===i.ELEMENT_NODE?i:i.parentNode}static{this.\u0275fac=function(r){return new(r||e)(z(ch),z(as),z(yt))}}static{this.\u0275dir=lt({type:e,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[de.None,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],standalone:!0,features:[Ot]})}}return e})();var Ay=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({})}}return e})();var _8=oy(),JA=class{constructor(t,i){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=i}attach(){}enable(){if(this._canBeEnabled()){let t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=Hr(-this._previousScrollPosition.left),t.style.top=Hr(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let t=this._document.documentElement,i=this._document.body,r=t.style,n=i.style,a=r.scrollBehavior||"",o=n.scrollBehavior||"";this._isEnabled=!1,r.left=this._previousHTMLStyles.left,r.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),_8&&(r.scrollBehavior=n.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),_8&&(r.scrollBehavior=a,n.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let i=this._document.body,r=this._viewportRuler.getViewportSize();return i.scrollHeight>r.height||i.scrollWidth>r.width}};var eT=class{constructor(t,i,r,n){this._scrollDispatcher=t,this._ngZone=i,this._viewportRuler=r,this._config=n,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef,this._overlayRef=t}enable(){if(this._scrollSubscription)return;let t=this._scrollDispatcher.scrolled(0).pipe(Mi(i=>!i||!this._overlayRef.overlayElement.contains(i.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{let i=this._viewportRuler.getViewportScrollPosition().top;Math.abs(i-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},Ty=class{enable(){}disable(){}attach(){}};function tT(e,t){return t.some(i=>{let r=e.bottom<i.top,n=e.top>i.bottom,a=e.right<i.left,o=e.left>i.right;return r||n||a||o})}function b8(e,t){return t.some(i=>{let r=e.top<i.top,n=e.bottom>i.bottom,a=e.left<i.left,o=e.right>i.right;return r||n||a||o})}var iT=class{constructor(t,i,r,n){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this._config=n,this._scrollSubscription=null}attach(t){this._overlayRef,this._overlayRef=t}enable(){if(!this._scrollSubscription){let t=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(t).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let i=this._overlayRef.overlayElement.getBoundingClientRect(),{width:r,height:n}=this._viewportRuler.getViewportSize();tT(i,[{width:r,height:n,bottom:n,right:r,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},Iae=(()=>{class e{constructor(i,r,n,a){this._scrollDispatcher=i,this._viewportRuler=r,this._ngZone=n,this.noop=()=>new Ty,this.close=o=>new eT(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new JA(this._viewportRuler,this._document),this.reposition=o=>new iT(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=a}static{this.\u0275fac=function(r){return new(r||e)(he(mv),he(Gu),he(Xe),he(yt))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Dy=class{constructor(t){if(this.scrollStrategy=new Ty,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){let i=Object.keys(t);for(let r of i)t[r]!==void 0&&(this[r]=t[r])}}};var rT=class{constructor(t,i){this.connectionPair=t,this.scrollableViewProperties=i}};var E8=(()=>{class e{constructor(i){this._attachedOverlays=[],this._document=i}ngOnDestroy(){this.detach()}add(i){this.remove(i),this._attachedOverlays.push(i)}remove(i){let r=this._attachedOverlays.indexOf(i);r>-1&&this._attachedOverlays.splice(r,1),this._attachedOverlays.length===0&&this.detach()}static{this.\u0275fac=function(r){return new(r||e)(he(yt))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),kae=(()=>{class e extends E8{constructor(i,r){super(i),this._ngZone=r,this._keydownListener=n=>{let a=this._attachedOverlays;for(let o=a.length-1;o>-1;o--)if(a[o]._keydownEvents.observers.length>0){let s=a[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>s.next(n)):s.next(n);break}}}add(i){super.add(i),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static{this.\u0275fac=function(r){return new(r||e)(he(yt),he(Xe,8))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Nae=(()=>{class e extends E8{constructor(i,r,n){super(i),this._platform=r,this._ngZone=n,this._cursorStyleIsSet=!1,this._pointerDownListener=a=>{this._pointerDownEventTarget=Xo(a)},this._clickListener=a=>{let o=Xo(a),s=a.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;let l=this._attachedOverlays.slice();for(let c=l.length-1;c>-1;c--){let d=l[c];if(d._outsidePointerEvents.observers.length<1||!d.hasAttached())continue;if(d.overlayElement.contains(o)||d.overlayElement.contains(s))break;let u=d._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>u.next(a)):u.next(a)}}}add(i){if(super.add(i),!this._isAttached){let r=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(r)):this._addEventListeners(r),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){let i=this._document.body;i.removeEventListener("pointerdown",this._pointerDownListener,!0),i.removeEventListener("click",this._clickListener,!0),i.removeEventListener("auxclick",this._clickListener,!0),i.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(i.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(i){i.addEventListener("pointerdown",this._pointerDownListener,!0),i.addEventListener("click",this._clickListener,!0),i.addEventListener("auxclick",this._clickListener,!0),i.addEventListener("contextmenu",this._clickListener,!0)}static{this.\u0275fac=function(r){return new(r||e)(he(yt),he(pi),he(Xe,8))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),S8=(()=>{class e{constructor(i,r){this._platform=r,this._document=i}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let i="cdk-overlay-container";if(this._platform.isBrowser||lv()){let n=this._document.querySelectorAll(`.${i}[platform="server"], .${i}[platform="test"]`);for(let a=0;a<n.length;a++)n[a].remove()}let r=this._document.createElement("div");r.classList.add(i),lv()?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}static{this.\u0275fac=function(r){return new(r||e)(he(yt),he(pi))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),nT=class{constructor(t,i,r,n,a,o,s,l,c,d=!1){this._portalOutlet=t,this._host=i,this._pane=r,this._config=n,this._ngZone=a,this._keyboardDispatcher=o,this._document=s,this._location=l,this._outsideClickDispatcher=c,this._animationsDisabled=d,this._backdropElement=null,this._backdropClick=new ut,this._attachments=new ut,this._detachments=new ut,this._locationChanges=Nr.EMPTY,this._backdropClickHandler=u=>this._backdropClick.next(u),this._backdropTransitionendHandler=u=>{this._disposeBackdrop(u.target)},this._keydownEvents=new ut,this._outsidePointerEvents=new ut,n.scrollStrategy&&(this._scrollStrategy=n.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=n.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let i=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Br(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof i?.onDestroy=="function"&&i.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),i}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){let t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config=Z(Z({},this._config),t),this._updateElementSize()}setDirection(t){this._config=Bt(Z({},this._config),{direction:t}),this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){let t=this._config.direction;return t?typeof t=="string"?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let t=this._pane.style;t.width=Hr(this._config.width),t.height=Hr(this._config.height),t.minWidth=Hr(this._config.minWidth),t.minHeight=Hr(this._config.minHeight),t.maxWidth=Hr(this._config.maxWidth),t.maxHeight=Hr(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){let t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let t=this._backdropElement;if(t){if(this._animationsDisabled){this._disposeBackdrop(t);return}t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500))}}_toggleClasses(t,i,r){let n=Zm(i||[]).filter(a=>!!a);n.length&&(r?t.classList.add(...n):t.classList.remove(...n))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{let t=this._ngZone.onStable.pipe(yi(Rn(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){let t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}},x8="cdk-overlay-connected-position-bounding-box",Pae=/([A-Za-z%]+)$/,aT=class{get positions(){return this._preferredPositions}constructor(t,i,r,n,a){this._viewportRuler=i,this._document=r,this._platform=n,this._overlayContainer=a,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new ut,this._resizeSubscription=Nr.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}attach(t){this._overlayRef&&this._overlayRef,this._validatePositions(),t.hostElement.classList.add(x8),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let t=this._originRect,i=this._overlayRect,r=this._viewportRect,n=this._containerRect,a=[],o;for(let s of this._preferredPositions){let l=this._getOriginPoint(t,n,s),c=this._getOverlayPoint(l,i,s),d=this._getOverlayFit(c,i,r,s);if(d.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(s,l);return}if(this._canFitWithFlexibleDimensions(d,c,r)){a.push({position:s,origin:l,overlayRect:i,boundingBoxRect:this._calculateBoundingBoxRect(l,s)});continue}(!o||o.overlayFit.visibleArea<d.visibleArea)&&(o={overlayFit:d,overlayPoint:c,originPoint:l,position:s,overlayRect:i})}if(a.length){let s=null,l=-1;for(let c of a){let d=c.boundingBoxRect.width*c.boundingBoxRect.height*(c.position.weight||1);d>l&&(l=d,s=c)}this._isPushed=!1,this._applyPosition(s.position,s.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(o.position,o.originPoint);return}this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Wu(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(x8),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let i=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,i)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,t.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,i,r){let n;if(r.originX=="center")n=t.left+t.width/2;else{let o=this._isRtl()?t.right:t.left,s=this._isRtl()?t.left:t.right;n=r.originX=="start"?o:s}i.left<0&&(n-=i.left);let a;return r.originY=="center"?a=t.top+t.height/2:a=r.originY=="top"?t.top:t.bottom,i.top<0&&(a-=i.top),{x:n,y:a}}_getOverlayPoint(t,i,r){let n;r.overlayX=="center"?n=-i.width/2:r.overlayX==="start"?n=this._isRtl()?-i.width:0:n=this._isRtl()?0:-i.width;let a;return r.overlayY=="center"?a=-i.height/2:a=r.overlayY=="top"?0:-i.height,{x:t.x+n,y:t.y+a}}_getOverlayFit(t,i,r,n){let a=w8(i),{x:o,y:s}=t,l=this._getOffset(n,"x"),c=this._getOffset(n,"y");l&&(o+=l),c&&(s+=c);let d=0-o,u=o+a.width-r.width,h=0-s,m=s+a.height-r.height,f=this._subtractOverflows(a.width,d,u),p=this._subtractOverflows(a.height,h,m),g=f*p;return{visibleArea:g,isCompletelyWithinViewport:a.width*a.height===g,fitsInViewportVertically:p===a.height,fitsInViewportHorizontally:f==a.width}}_canFitWithFlexibleDimensions(t,i,r){if(this._hasFlexibleDimensions){let n=r.bottom-i.y,a=r.right-i.x,o=y8(this._overlayRef.getConfig().minHeight),s=y8(this._overlayRef.getConfig().minWidth),l=t.fitsInViewportVertically||o!=null&&o<=n,c=t.fitsInViewportHorizontally||s!=null&&s<=a;return l&&c}return!1}_pushOverlayOnScreen(t,i,r){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};let n=w8(i),a=this._viewportRect,o=Math.max(t.x+n.width-a.width,0),s=Math.max(t.y+n.height-a.height,0),l=Math.max(a.top-r.top-t.y,0),c=Math.max(a.left-r.left-t.x,0),d=0,u=0;return n.width<=a.width?d=c||-o:d=t.x<this._viewportMargin?a.left-r.left-t.x:0,n.height<=a.height?u=l||-s:u=t.y<this._viewportMargin?a.top-r.top-t.y:0,this._previousPushAmount={x:d,y:u},{x:t.x+d,y:t.y+u}}_applyPosition(t,i){if(this._setTransformOrigin(t),this._setOverlayElementStyles(i,t),this._setBoundingBoxStyles(i,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._positionChanges.observers.length){let r=this._getScrollVisibility();if(t!==this._lastPosition||!this._lastScrollVisibility||!Rae(this._lastScrollVisibility,r)){let n=new rT(t,r);this._positionChanges.next(n)}this._lastScrollVisibility=r}this._lastPosition=t,this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;let i=this._boundingBox.querySelectorAll(this._transformOriginSelector),r,n=t.overlayY;t.overlayX==="center"?r="center":this._isRtl()?r=t.overlayX==="start"?"right":"left":r=t.overlayX==="start"?"left":"right";for(let a=0;a<i.length;a++)i[a].style.transformOrigin=`${r} ${n}`}_calculateBoundingBoxRect(t,i){let r=this._viewportRect,n=this._isRtl(),a,o,s;if(i.overlayY==="top")o=t.y,a=r.height-o+this._viewportMargin;else if(i.overlayY==="bottom")s=r.height-t.y+this._viewportMargin*2,a=r.height-s+this._viewportMargin;else{let m=Math.min(r.bottom-t.y+r.top,t.y),f=this._lastBoundingBoxSize.height;a=m*2,o=t.y-m,a>f&&!this._isInitialRender&&!this._growAfterOpen&&(o=t.y-f/2)}let l=i.overlayX==="start"&&!n||i.overlayX==="end"&&n,c=i.overlayX==="end"&&!n||i.overlayX==="start"&&n,d,u,h;if(c)h=r.width-t.x+this._viewportMargin*2,d=t.x-this._viewportMargin;else if(l)u=t.x,d=r.right-t.x;else{let m=Math.min(r.right-t.x+r.left,t.x),f=this._lastBoundingBoxSize.width;d=m*2,u=t.x-m,d>f&&!this._isInitialRender&&!this._growAfterOpen&&(u=t.x-f/2)}return{top:o,left:u,bottom:s,right:h,width:d,height:a}}_setBoundingBoxStyles(t,i){let r=this._calculateBoundingBoxRect(t,i);!this._isInitialRender&&!this._growAfterOpen&&(r.height=Math.min(r.height,this._lastBoundingBoxSize.height),r.width=Math.min(r.width,this._lastBoundingBoxSize.width));let n={};if(this._hasExactPosition())n.top=n.left="0",n.bottom=n.right=n.maxHeight=n.maxWidth="",n.width=n.height="100%";else{let a=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;n.height=Hr(r.height),n.top=Hr(r.top),n.bottom=Hr(r.bottom),n.width=Hr(r.width),n.left=Hr(r.left),n.right=Hr(r.right),i.overlayX==="center"?n.alignItems="center":n.alignItems=i.overlayX==="end"?"flex-end":"flex-start",i.overlayY==="center"?n.justifyContent="center":n.justifyContent=i.overlayY==="bottom"?"flex-end":"flex-start",a&&(n.maxHeight=Hr(a)),o&&(n.maxWidth=Hr(o))}this._lastBoundingBoxSize=r,Wu(this._boundingBox.style,n)}_resetBoundingBoxStyles(){Wu(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Wu(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,i){let r={},n=this._hasExactPosition(),a=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(n){let d=this._viewportRuler.getViewportScrollPosition();Wu(r,this._getExactOverlayY(i,t,d)),Wu(r,this._getExactOverlayX(i,t,d))}else r.position="static";let s="",l=this._getOffset(i,"x"),c=this._getOffset(i,"y");l&&(s+=`translateX(${l}px) `),c&&(s+=`translateY(${c}px)`),r.transform=s.trim(),o.maxHeight&&(n?r.maxHeight=Hr(o.maxHeight):a&&(r.maxHeight="")),o.maxWidth&&(n?r.maxWidth=Hr(o.maxWidth):a&&(r.maxWidth="")),Wu(this._pane.style,r)}_getExactOverlayY(t,i,r){let n={top:"",bottom:""},a=this._getOverlayPoint(i,this._overlayRect,t);if(this._isPushed&&(a=this._pushOverlayOnScreen(a,this._overlayRect,r)),t.overlayY==="bottom"){let o=this._document.documentElement.clientHeight;n.bottom=`${o-(a.y+this._overlayRect.height)}px`}else n.top=Hr(a.y);return n}_getExactOverlayX(t,i,r){let n={left:"",right:""},a=this._getOverlayPoint(i,this._overlayRect,t);this._isPushed&&(a=this._pushOverlayOnScreen(a,this._overlayRect,r));let o;if(this._isRtl()?o=t.overlayX==="end"?"left":"right":o=t.overlayX==="end"?"right":"left",o==="right"){let s=this._document.documentElement.clientWidth;n.right=`${s-(a.x+this._overlayRect.width)}px`}else n.left=Hr(a.x);return n}_getScrollVisibility(){let t=this._getOriginRect(),i=this._pane.getBoundingClientRect(),r=this._scrollables.map(n=>n.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:b8(t,r),isOriginOutsideView:tT(t,r),isOverlayClipped:b8(i,r),isOverlayOutsideView:tT(i,r)}}_subtractOverflows(t,...i){return i.reduce((r,n)=>r-Math.max(n,0),t)}_getNarrowedViewportRect(){let t=this._document.documentElement.clientWidth,i=this._document.documentElement.clientHeight,r=this._viewportRuler.getViewportScrollPosition();return{top:r.top+this._viewportMargin,left:r.left+this._viewportMargin,right:r.left+t-this._viewportMargin,bottom:r.top+i-this._viewportMargin,width:t-2*this._viewportMargin,height:i-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,i){return i==="x"?t.offsetX==null?this._offsetX:t.offsetX:t.offsetY==null?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&Zm(t).forEach(i=>{i!==""&&this._appliedPanelClasses.indexOf(i)===-1&&(this._appliedPanelClasses.push(i),this._pane.classList.add(i))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){let t=this._origin;if(t instanceof nt)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();let i=t.width||0,r=t.height||0;return{top:t.y,bottom:t.y+r,left:t.x,right:t.x+i,height:r,width:i}}};function Wu(e,t){for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function y8(e){if(typeof e!="number"&&e!=null){let[t,i]=e.split(Pae);return!i||i==="px"?parseFloat(t):null}return e||null}function w8(e){return{top:Math.floor(e.top),right:Math.floor(e.right),bottom:Math.floor(e.bottom),left:Math.floor(e.left),width:Math.floor(e.width),height:Math.floor(e.height)}}function Rae(e,t){return e===t?!0:e.isOriginClipped===t.isOriginClipped&&e.isOriginOutsideView===t.isOriginOutsideView&&e.isOverlayClipped===t.isOverlayClipped&&e.isOverlayOutsideView===t.isOverlayOutsideView}var C8="cdk-global-overlay-wrapper",oT=class{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(t){let i=t.getConfig();this._overlayRef=t,this._width&&!i.width&&t.updateSize({width:this._width}),this._height&&!i.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(C8),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let t=this._overlayRef.overlayElement.style,i=this._overlayRef.hostElement.style,r=this._overlayRef.getConfig(),{width:n,height:a,maxWidth:o,maxHeight:s}=r,l=(n==="100%"||n==="100vw")&&(!o||o==="100%"||o==="100vw"),c=(a==="100%"||a==="100vh")&&(!s||s==="100%"||s==="100vh"),d=this._xPosition,u=this._xOffset,h=this._overlayRef.getConfig().direction==="rtl",m="",f="",p="";l?p="flex-start":d==="center"?(p="center",h?f=u:m=u):h?d==="left"||d==="end"?(p="flex-end",m=u):(d==="right"||d==="start")&&(p="flex-start",f=u):d==="left"||d==="start"?(p="flex-start",m=u):(d==="right"||d==="end")&&(p="flex-end",f=u),t.position=this._cssPosition,t.marginLeft=l?"0":m,t.marginTop=c?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=l?"0":f,i.justifyContent=p,i.alignItems=c?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let t=this._overlayRef.overlayElement.style,i=this._overlayRef.hostElement,r=i.style;i.classList.remove(C8),r.justifyContent=r.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}},Fae=(()=>{class e{constructor(i,r,n,a){this._viewportRuler=i,this._document=r,this._platform=n,this._overlayContainer=a}global(){return new oT}flexibleConnectedTo(i){return new aT(i,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static{this.\u0275fac=function(r){return new(r||e)(he(Gu),he(yt),he(pi),he(S8))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Oae=0,qu=(()=>{class e{constructor(i,r,n,a,o,s,l,c,d,u,h,m){this.scrollStrategies=i,this._overlayContainer=r,this._componentFactoryResolver=n,this._positionBuilder=a,this._keyboardDispatcher=o,this._injector=s,this._ngZone=l,this._document=c,this._directionality=d,this._location=u,this._outsideClickDispatcher=h,this._animationsModuleType=m}create(i){let r=this._createHostElement(),n=this._createPaneElement(r),a=this._createPortalOutlet(n),o=new Dy(i);return o.direction=o.direction||this._directionality.value,new nT(a,r,n,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations")}position(){return this._positionBuilder}_createPaneElement(i){let r=this._document.createElement("div");return r.id=`cdk-overlay-${Oae++}`,r.classList.add("cdk-overlay-pane"),i.appendChild(r),r}_createHostElement(){let i=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(i),i}_createPortalOutlet(i){return this._appRef||(this._appRef=this._injector.get(Sd)),new Sy(i,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static{this.\u0275fac=function(r){return new(r||e)(he(Iae),he(S8),he(ch),he(Fae),he(kae),he(Ea),he(Xe),he(yt),he(go),he(Td),he(Nae),he(zi,8))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Lae=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],A8=new Be("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let e=Ve(qu);return()=>e.scrollStrategies.reposition()}}),fv=(()=>{class e{constructor(i){this.elementRef=i}static{this.\u0275fac=function(r){return new(r||e)(z(nt))}}static{this.\u0275dir=lt({type:e,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"],standalone:!0})}}return e})(),lT=(()=>{class e{get offsetX(){return this._offsetX}set offsetX(i){this._offsetX=i,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(i){this._offsetY=i,this._position&&this._updatePositionStrategy(this._position)}get disposeOnNavigation(){return this._disposeOnNavigation}set disposeOnNavigation(i){this._disposeOnNavigation=i}constructor(i,r,n,a,o){this._overlay=i,this._dir=o,this._backdropSubscription=Nr.EMPTY,this._attachSubscription=Nr.EMPTY,this._detachSubscription=Nr.EMPTY,this._positionSubscription=Nr.EMPTY,this._disposeOnNavigation=!1,this._ngZone=Ve(Xe),this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.hasBackdrop=!1,this.lockPosition=!1,this.flexibleDimensions=!1,this.growAfterOpen=!1,this.push=!1,this.backdropClick=new Pe,this.positionChange=new Pe,this.attach=new Pe,this.detach=new Pe,this.overlayKeydown=new Pe,this.overlayOutsideClick=new Pe,this._templatePortal=new ju(r,n),this._scrollStrategyFactory=a,this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(i){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),i.origin&&this.open&&this._position.apply()),i.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=Lae);let i=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=i.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=i.detachments().subscribe(()=>this.detach.emit()),i.keydownEvents().subscribe(r=>{this.overlayKeydown.next(r),r.keyCode===27&&!this.disableClose&&!vo(r)&&(r.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(r=>{let n=this._getOriginElement(),a=Xo(r);(!n||n!==a&&!n.contains(a))&&this.overlayOutsideClick.next(r)})}_buildConfig(){let i=this._position=this.positionStrategy||this._createPositionStrategy(),r=new Dy({direction:this._dir,positionStrategy:i,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop,disposeOnNavigation:this.disposeOnNavigation});return(this.width||this.width===0)&&(r.width=this.width),(this.height||this.height===0)&&(r.height=this.height),(this.minWidth||this.minWidth===0)&&(r.minWidth=this.minWidth),(this.minHeight||this.minHeight===0)&&(r.minHeight=this.minHeight),this.backdropClass&&(r.backdropClass=this.backdropClass),this.panelClass&&(r.panelClass=this.panelClass),r}_updatePositionStrategy(i){let r=this.positions.map(n=>({originX:n.originX,originY:n.originY,overlayX:n.overlayX,overlayY:n.overlayY,offsetX:n.offsetX||this.offsetX,offsetY:n.offsetY||this.offsetY,panelClass:n.panelClass||void 0}));return i.setOrigin(this._getOrigin()).withPositions(r).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){let i=this._overlay.position().flexibleConnectedTo(this._getOrigin());return this._updatePositionStrategy(i),i}_getOrigin(){return this.origin instanceof fv?this.origin.elementRef:this.origin}_getOriginElement(){return this.origin instanceof fv?this.origin.elementRef.nativeElement:this.origin instanceof nt?this.origin.nativeElement:typeof Element<"u"&&this.origin instanceof Element?this.origin:null}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(i=>{this.backdropClick.emit(i)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(bM(()=>this.positionChange.observers.length>0)).subscribe(i=>{this._ngZone.run(()=>this.positionChange.emit(i)),this.positionChange.observers.length===0&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||e)(z(qu),z(lh),z(as),z(A8),z(go,8))}}static{this.\u0275dir=lt({type:e,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:[de.None,"cdkConnectedOverlayOrigin","origin"],positions:[de.None,"cdkConnectedOverlayPositions","positions"],positionStrategy:[de.None,"cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:[de.None,"cdkConnectedOverlayOffsetX","offsetX"],offsetY:[de.None,"cdkConnectedOverlayOffsetY","offsetY"],width:[de.None,"cdkConnectedOverlayWidth","width"],height:[de.None,"cdkConnectedOverlayHeight","height"],minWidth:[de.None,"cdkConnectedOverlayMinWidth","minWidth"],minHeight:[de.None,"cdkConnectedOverlayMinHeight","minHeight"],backdropClass:[de.None,"cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:[de.None,"cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:[de.None,"cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:[de.None,"cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:[de.None,"cdkConnectedOverlayOpen","open"],disableClose:[de.None,"cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:[de.None,"cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:[de.HasDecoratorInputTransform,"cdkConnectedOverlayHasBackdrop","hasBackdrop",ot],lockPosition:[de.HasDecoratorInputTransform,"cdkConnectedOverlayLockPosition","lockPosition",ot],flexibleDimensions:[de.HasDecoratorInputTransform,"cdkConnectedOverlayFlexibleDimensions","flexibleDimensions",ot],growAfterOpen:[de.HasDecoratorInputTransform,"cdkConnectedOverlayGrowAfterOpen","growAfterOpen",ot],push:[de.HasDecoratorInputTransform,"cdkConnectedOverlayPush","push",ot],disposeOnNavigation:[de.HasDecoratorInputTransform,"cdkConnectedOverlayDisposeOnNavigation","disposeOnNavigation",ot]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],standalone:!0,features:[wi,ir]})}}return e})();function Bae(e){return()=>e.scrollStrategies.reposition()}var Vae={provide:A8,deps:[qu],useFactory:Bae},T8=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({providers:[qu,Vae],imports:[od,Ay,YA,YA]})}}return e})();var zae=["trigger"],Uae=["panel"],Hae=[[["mat-select-trigger"]],"*"],Gae=["mat-select-trigger","*"];function jae(e,t){if(e&1&&(S(0,"span",4),G(1),A()),e&2){let i=J();P(),gr(i.placeholder)}}function Wae(e,t){e&1&&it(0)}function qae(e,t){if(e&1&&(S(0,"span",11),G(1),A()),e&2){let i=J(2);P(),gr(i.triggerValue)}}function $ae(e,t){if(e&1&&(S(0,"span",10),Te(1,Wae,1,0)(2,qae,2,1),A()),e&2){let i=J();P(),fi(1,i.customTrigger?1:2)}}function Xae(e,t){if(e&1){let i=Ue();S(0,"div",12,1),q("@transformPanel.done",function(n){j(i);let a=J();return W(a._panelDoneAnimatingStream.next(n.toState))})("keydown",function(n){j(i);let a=J();return W(a._handleKeydown(n))}),it(2,1),A()}if(e&2){let i=J();Xv("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",i._getPanelTheme(),""),O("ngClass",i.panelClass)("@transformPanel","showing"),Ft("id",i.id+"-panel")("aria-multiselectable",i.multiple)("aria-label",i.ariaLabel||null)("aria-labelledby",i._getPanelAriaLabelledby())}}var Yae={transformPanelWrap:Ts("transformPanelWrap",[Ao("* => void",CI("@transformPanel",[wI()],{optional:!0}))]),transformPanel:Ts("transformPanel",[So("void",ta({opacity:0,transform:"scale(1, 0.8)"})),Ao("void => showing",os("120ms cubic-bezier(0, 0, 0.2, 1)",ta({opacity:1,transform:"scale(1, 1)"}))),Ao("* => void",os("100ms linear",ta({opacity:0})))])};var D8=0,M8=new Be("mat-select-scroll-strategy",{providedIn:"root",factory:()=>{let e=Ve(qu);return()=>e.scrollStrategies.reposition()}});function Zae(e){return()=>e.scrollStrategies.reposition()}var Kae=new Be("MAT_SELECT_CONFIG"),Qae={provide:M8,deps:[qu],useFactory:Zae},Jae=new Be("MatSelectTrigger"),cT=class{constructor(t,i){this.source=t,this.value=i}},My=(()=>{class e{_scrollOptionIntoView(i){let r=this.options.toArray()[i];if(r){let n=this.panel.nativeElement,a=n8(i,this.options,this.optionGroups),o=r._getHostElement();i===0&&a===1?n.scrollTop=0:n.scrollTop=a8(o.offsetTop,o.offsetHeight,n.scrollTop,n.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(i){return new cT(this,i)}get focused(){return this._focused||this._panelOpen}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(i){this._hideSingleSelectionIndicator=i,this._syncParentProperties()}get placeholder(){return this._placeholder}set placeholder(i){this._placeholder=i,this.stateChanges.next()}get required(){return this._required??this.ngControl?.control?.hasValidator(Fm.required)??!1}set required(i){this._required=i,this.stateChanges.next()}get multiple(){return this._multiple}set multiple(i){this._selectionModel,this._multiple=i}get compareWith(){return this._compareWith}set compareWith(i){this._compareWith=i,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(i){this._assignValue(i)&&this._onChange(i)}get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(i){this._errorStateTracker.matcher=i}get id(){return this._id}set id(i){this._id=i||this._uid,this.stateChanges.next()}get errorState(){return this._errorStateTracker.errorState}set errorState(i){this._errorStateTracker.errorState=i}constructor(i,r,n,a,o,s,l,c,d,u,h,m,f,p){this._viewportRuler=i,this._changeDetectorRef=r,this._elementRef=o,this._dir=s,this._parentFormField=d,this.ngControl=u,this._liveAnnouncer=f,this._defaultOptions=p,this._positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}],this._panelOpen=!1,this._compareWith=(g,v)=>g===v,this._uid=`mat-select-${D8++}`,this._triggerAriaLabelledBy=null,this._destroy=new ut,this.stateChanges=new ut,this.disableAutomaticLabeling=!0,this._onChange=()=>{},this._onTouched=()=>{},this._valueId=`mat-select-value-${D8++}`,this._panelDoneAnimatingStream=new ut,this._overlayPanelClass=this._defaultOptions?.overlayPanelClass||"",this._focused=!1,this.controlType="mat-select",this.disabled=!1,this.disableRipple=!1,this.tabIndex=0,this._hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1,this._multiple=!1,this.disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1,this.ariaLabel="",this.panelWidth=this._defaultOptions&&typeof this._defaultOptions.panelWidth<"u"?this._defaultOptions.panelWidth:"auto",this._initialized=new ut,this.optionSelectionChanges=Fp(()=>{let g=this.options;return g?g.changes.pipe(wa(g),Wr(()=>Rn(...g.map(v=>v.onSelectionChange)))):this._initialized.pipe(Wr(()=>this.optionSelectionChanges))}),this.openedChange=new Pe,this._openedStream=this.openedChange.pipe(Mi(g=>g),Rt(()=>{})),this._closedStream=this.openedChange.pipe(Mi(g=>!g),Rt(()=>{})),this.selectionChange=new Pe,this.valueChange=new Pe,this._trackedModal=null,this._skipPredicate=g=>this.panelOpen?!1:g.disabled,this.ngControl&&(this.ngControl.valueAccessor=this),p?.typeaheadDebounceInterval!=null&&(this.typeaheadDebounceInterval=p.typeaheadDebounceInterval),this._errorStateTracker=new Jm(a,u,c,l,this.stateChanges),this._scrollStrategyFactory=m,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(h)||0,this.id=this.id}ngOnInit(){this._selectionModel=new np(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(_d(),yi(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen)),this._viewportRuler.change().pipe(yi(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._changeDetectorRef.detectChanges())})}ngAfterContentInit(){this._initialized.next(),this._initialized.complete(),this._initKeyManager(),this._selectionModel.changed.pipe(yi(this._destroy)).subscribe(i=>{i.added.forEach(r=>r.select()),i.removed.forEach(r=>r.deselect())}),this.options.changes.pipe(wa(null),yi(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){let i=this._getTriggerAriaLabelledby(),r=this.ngControl;if(i!==this._triggerAriaLabelledBy){let n=this._elementRef.nativeElement;this._triggerAriaLabelledBy=i,i?n.setAttribute("aria-labelledby",i):n.removeAttribute("aria-labelledby")}r&&(this._previousControl!==r.control&&(this._previousControl!==void 0&&r.disabled!==null&&r.disabled!==this.disabled&&(this.disabled=r.disabled),this._previousControl=r.control),this.updateErrorState())}ngOnChanges(i){(i.disabled||i.userAriaDescribedBy)&&this.stateChanges.next(),i.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this.typeaheadDebounceInterval)}ngOnDestroy(){this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete(),this._clearFromModal()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin()),this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._applyModalPanelOwnership(),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_applyModalPanelOwnership(){let i=this._elementRef.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!i)return;let r=`${this.id}-panel`;this._trackedModal&&PA(this._trackedModal,"aria-owns",r),G4(i,"aria-owns",r),this._trackedModal=i}_clearFromModal(){if(!this._trackedModal)return;let i=`${this.id}-panel`;PA(this._trackedModal,"aria-owns",i),this._trackedModal=null}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched(),this.stateChanges.next())}writeValue(i){this._assignValue(i)}registerOnChange(i){this._onChange=i}registerOnTouched(i){this._onTouched=i}setDisabledState(i){this.disabled=i,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){let i=this._selectionModel.selected.map(r=>r.viewValue);return this._isRtl()&&i.reverse(),i.join(", ")}return this._selectionModel.selected[0].viewValue}updateErrorState(){this._errorStateTracker.updateErrorState()}_isRtl(){return this._dir?this._dir.value==="rtl":!1}_handleKeydown(i){this.disabled||(this.panelOpen?this._handleOpenKeydown(i):this._handleClosedKeydown(i))}_handleClosedKeydown(i){let r=i.keyCode,n=r===40||r===38||r===37||r===39,a=r===13||r===32,o=this._keyManager;if(!o.isTyping()&&a&&!vo(i)||(this.multiple||i.altKey)&&n)i.preventDefault(),this.open();else if(!this.multiple){let s=this.selected;o.onKeydown(i);let l=this.selected;l&&s!==l&&this._liveAnnouncer.announce(l.viewValue,1e4)}}_handleOpenKeydown(i){let r=this._keyManager,n=i.keyCode,a=n===40||n===38,o=r.isTyping();if(a&&i.altKey)i.preventDefault(),this.close();else if(!o&&(n===13||n===32)&&r.activeItem&&!vo(i))i.preventDefault(),r.activeItem._selectViaInteraction();else if(!o&&this._multiple&&n===65&&i.ctrlKey){i.preventDefault();let s=this.options.some(l=>!l.disabled&&!l.selected);this.options.forEach(l=>{l.disabled||(s?l.select():l.deselect())})}else{let s=r.activeItemIndex;r.onKeydown(i),this._multiple&&a&&i.shiftKey&&r.activeItem&&r.activeItemIndex!==s&&r.activeItem._selectViaInteraction()}}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe(Br(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(i){if(this.options.forEach(r=>r.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&i)Array.isArray(i),i.forEach(r=>this._selectOptionByValue(r)),this._sortValues();else{let r=this._selectOptionByValue(i);r?this._keyManager.updateActiveItem(r):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(i){let r=this.options.find(n=>{if(this._selectionModel.isSelected(n))return!1;try{return n.value!=null&&this._compareWith(n.value,i)}catch{return!1}});return r&&this._selectionModel.select(r),r}_assignValue(i){return i!==this._value||this._multiple&&Array.isArray(i)?(this.options&&this._setSelectionByValue(i),this._value=i,!0):!1}_getOverlayWidth(i){return this.panelWidth==="auto"?(i instanceof fv?i.elementRef:i||this._elementRef).nativeElement.getBoundingClientRect().width:this.panelWidth===null?"":this.panelWidth}_syncParentProperties(){if(this.options)for(let i of this.options)i._changeDetectorRef.markForCheck()}_initKeyManager(){this._keyManager=new uy(this.options).withTypeAhead(this.typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]).skipPredicate(this._skipPredicate),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){let i=Rn(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(yi(i)).subscribe(r=>{this._onSelect(r.source,r.isUserInput),r.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),Rn(...this.options.map(r=>r._stateChanges)).pipe(yi(i)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(i,r){let n=this._selectionModel.isSelected(i);i.value==null&&!this._multiple?(i.deselect(),this._selectionModel.clear(),this.value!=null&&this._propagateChanges(i.value)):(n!==i.selected&&(i.selected?this._selectionModel.select(i):this._selectionModel.deselect(i)),r&&this._keyManager.setActiveItem(i),this.multiple&&(this._sortValues(),r&&this.focus())),n!==this._selectionModel.isSelected(i)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){let i=this.options.toArray();this._selectionModel.sort((r,n)=>this.sortComparator?this.sortComparator(r,n,i):i.indexOf(r)-i.indexOf(n)),this.stateChanges.next()}}_propagateChanges(i){let r;this.multiple?r=this.selected.map(n=>n.value):r=this.selected?this.selected.value:i,this._value=r,this.valueChange.emit(r),this._onChange(r),this.selectionChange.emit(this._getChangeEvent(r)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){if(this._keyManager)if(this.empty){let i=-1;for(let r=0;r<this.options.length;r++)if(!this.options.get(r).disabled){i=r;break}this._keyManager.setActiveItem(i)}else this._keyManager.setActiveItem(this._selectionModel.selected[0])}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(i){this._elementRef.nativeElement.focus(i)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;let i=this._parentFormField?.getLabelId(),r=i?i+" ":"";return this.ariaLabelledby?r+this.ariaLabelledby:i}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;let i=this._parentFormField?.getLabelId(),r=(i?i+" ":"")+this._valueId;return this.ariaLabelledby&&(r+=" "+this.ariaLabelledby),r}_panelDoneAnimating(i){this.openedChange.emit(i)}setDescribedByIds(i){i.length?this._elementRef.nativeElement.setAttribute("aria-describedby",i.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}static{this.\u0275fac=function(r){return new(r||e)(z(Gu),z(Vt),z(Xe),z(vy),z(nt),z(go,8),z(Lg,8),z(Bg,8),z(hv,8),z(Gl,10),ea("tabindex"),z(M8),z(X4),z(Kae,8))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-select"]],contentQueries:function(r,n,a){if(r&1&&(Si(a,Jae,5),Si(a,ip,5),Si(a,$A,5)),r&2){let o;Me(o=Ie())&&(n.customTrigger=o.first),Me(o=Ie())&&(n.options=o),Me(o=Ie())&&(n.optionGroups=o)}},viewQuery:function(r,n){if(r&1&&(tt(zae,5),tt(Uae,5),tt(lT,5)),r&2){let a;Me(a=Ie())&&(n.trigger=a.first),Me(a=Ie())&&(n.panel=a.first),Me(a=Ie())&&(n._overlayDir=a.first)}},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","listbox",1,"mat-mdc-select"],hostVars:19,hostBindings:function(r,n){r&1&&q("keydown",function(o){return n._handleKeydown(o)})("focus",function(){return n._onFocus()})("blur",function(){return n._onBlur()}),r&2&&(Ft("id",n.id)("tabindex",n.disabled?-1:n.tabIndex)("aria-controls",n.panelOpen?n.id+"-panel":null)("aria-expanded",n.panelOpen)("aria-label",n.ariaLabel||null)("aria-required",n.required.toString())("aria-disabled",n.disabled.toString())("aria-invalid",n.errorState)("aria-activedescendant",n._getAriaActiveDescendant()),ft("mat-mdc-select-disabled",n.disabled)("mat-mdc-select-invalid",n.errorState)("mat-mdc-select-required",n.required)("mat-mdc-select-empty",n.empty)("mat-mdc-select-multiple",n.multiple))},inputs:{userAriaDescribedBy:[de.None,"aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",disabled:[de.HasDecoratorInputTransform,"disabled","disabled",ot],disableRipple:[de.HasDecoratorInputTransform,"disableRipple","disableRipple",ot],tabIndex:[de.HasDecoratorInputTransform,"tabIndex","tabIndex",i=>i==null?0:Dr(i)],hideSingleSelectionIndicator:[de.HasDecoratorInputTransform,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",ot],placeholder:"placeholder",required:[de.HasDecoratorInputTransform,"required","required",ot],multiple:[de.HasDecoratorInputTransform,"multiple","multiple",ot],disableOptionCentering:[de.HasDecoratorInputTransform,"disableOptionCentering","disableOptionCentering",ot],compareWith:"compareWith",value:"value",ariaLabel:[de.None,"aria-label","ariaLabel"],ariaLabelledby:[de.None,"aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:[de.HasDecoratorInputTransform,"typeaheadDebounceInterval","typeaheadDebounceInterval",Dr],sortComparator:"sortComparator",id:"id",panelWidth:"panelWidth"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},exportAs:["matSelect"],standalone:!0,features:[_i([{provide:uv,useExisting:e},{provide:qA,useExisting:e}]),wi,ir,Xt],ngContentSelectors:Gae,decls:11,vars:8,consts:[["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],["panel",""],["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],[1,"mat-mdc-select-value"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false","aria-hidden","true"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"backdropClick","attach","detach","cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth"],[1,"mat-mdc-select-value-text"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"keydown","ngClass"]],template:function(r,n){if(r&1){let a=Ue();ti(Hae),S(0,"div",2,0),q("click",function(){return j(a),W(n.open())}),S(3,"div",3),Te(4,jae,2,1,"span",4)(5,$ae,3,1),A(),S(6,"div",5)(7,"div",6),Ca(),S(8,"svg",7),ae(9,"path",8),A()()()(),Te(10,Xae,3,9,"ng-template",9),q("backdropClick",function(){return j(a),W(n.close())})("attach",function(){return j(a),W(n._onAttached())})("detach",function(){return j(a),W(n.close())})}if(r&2){let a=kt(1);P(3),Ft("id",n._valueId),P(),fi(4,n.empty?4:5),P(6),O("cdkConnectedOverlayPanelClass",n._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",n._scrollStrategy)("cdkConnectedOverlayOrigin",n._preferredOverlayOrigin||a)("cdkConnectedOverlayOpen",n.panelOpen)("cdkConnectedOverlayPositions",n._positions)("cdkConnectedOverlayWidth",n._overlayWidth)}},dependencies:[fv,lT,Es],styles:['.mat-mdc-select{display:inline-block;width:100%;outline:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-select-enabled-trigger-text-color);font-family:var(--mat-select-trigger-text-font);line-height:var(--mat-select-trigger-text-line-height);font-size:var(--mat-select-trigger-text-size);font-weight:var(--mat-select-trigger-text-weight);letter-spacing:var(--mat-select-trigger-text-tracking)}div.mat-mdc-select-panel{box-shadow:var(--mat-select-container-elevation-shadow)}.mat-mdc-select-disabled{color:var(--mat-select-disabled-trigger-text-color)}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-invalid .mat-mdc-select-arrow,.mat-form-field-invalid:not(.mat-form-field-disabled) .mat-mdc-form-field-infix::after{color:var(--mat-select-invalid-arrow-color)}.mat-mdc-select-arrow{width:10px;height:5px;position:relative;color:var(--mat-select-enabled-arrow-color)}.mat-mdc-form-field.mat-focused .mat-mdc-select-arrow{color:var(--mat-select-focused-arrow-color)}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-disabled .mat-mdc-select-arrow{color:var(--mat-select-disabled-arrow-color)}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:GrayText}div.mat-mdc-select-panel{width:100%;max-height:275px;outline:0;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-select-panel-background-color)}.cdk-high-contrast-active div.mat-mdc-select-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) div.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above div.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}div.mat-mdc-select-panel .mat-mdc-option{--mdc-list-list-item-container-color: var(--mat-select-panel-background-color)}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1);color:var(--mat-select-placeholder-text-color)}._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper{cursor:pointer}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:var(--mat-select-arrow-transform)}'],encapsulation:2,data:{animation:[Yae.transformPanel]},changeDetection:0})}}return e})();var I8=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({providers:[Qae],imports:[On,T8,XA,Et,Hu,Uu,XA,Et]})}}return e})();var eoe=["dialogPopup"],toe=["hueSlider"],ioe=["alphaSlider"];function roe(e,t){if(e&1&&ae(0,"div"),e&2){let i=J();Xv("arrow arrow-",i.cpUsePosition,""),ei("left",i.cpArrowPosition)("top",i.arrowTop,"px")}}function noe(e,t){if(e&1){let i=Ue();S(0,"div",28),q("newValue",function(n){j(i);let a=J();return W(a.onColorChange(n))})("dragStart",function(){j(i);let n=J();return W(n.onDragStart("saturation-lightness"))})("dragEnd",function(){j(i);let n=J();return W(n.onDragEnd("saturation-lightness"))}),ae(1,"div",16),A()}if(e&2){let i=J();ei("background-color",i.hueSliderColor),O("rgX",1)("rgY",1),P(),ei("top",i.slider==null?null:i.slider.v,"px")("left",i.slider==null?null:i.slider.s,"px")}}function aoe(e,t){e&1&&(Ca(),S(0,"svg",29),ae(1,"path",30)(2,"path",31),A())}function ooe(e,t){if(e&1){let i=Ue();S(0,"button",32),q("click",function(n){j(i);let a=J();return W(a.onAddPresetColor(n,a.selectedColor))}),G(1),A()}if(e&2){let i=J();yr(i.cpAddColorButtonClass),O("disabled",i.cpPresetColors&&i.cpPresetColors.length>=i.cpMaxPresetColorsLength),P(),Vr(" ",i.cpAddColorButtonText," ")}}function soe(e,t){e&1&&ae(0,"div",33)}function loe(e,t){if(e&1){let i=Ue();S(0,"input",39),q("keyup.enter",function(n){j(i);let a=J(2);return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J(2);return W(a.onAlphaInput(n))}),A()}if(e&2){let i=J(2);O("rg",1)("value",i.cmykText==null?null:i.cmykText.a)}}function coe(e,t){e&1&&(S(0,"div"),G(1,"A"),A())}function doe(e,t){if(e&1){let i=Ue();S(0,"div",34)(1,"div",35)(2,"input",36),q("keyup.enter",function(n){j(i);let a=J();return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J();return W(a.onCyanInput(n))}),A(),S(3,"input",36),q("keyup.enter",function(n){j(i);let a=J();return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J();return W(a.onMagentaInput(n))}),A(),S(4,"input",36),q("keyup.enter",function(n){j(i);let a=J();return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J();return W(a.onYellowInput(n))}),A(),S(5,"input",36),q("keyup.enter",function(n){j(i);let a=J();return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J();return W(a.onBlackInput(n))}),A(),Te(6,loe,1,2,"input",37),A(),S(7,"div",35)(8,"div"),G(9,"C"),A(),S(10,"div"),G(11,"M"),A(),S(12,"div"),G(13,"Y"),A(),S(14,"div"),G(15,"K"),A(),Te(16,coe,2,0,"div",38),A()()}if(e&2){let i=J();ei("display",i.format!==3?"none":"block"),P(2),O("rg",100)("value",i.cmykText==null?null:i.cmykText.c),P(),O("rg",100)("value",i.cmykText==null?null:i.cmykText.m),P(),O("rg",100)("value",i.cmykText==null?null:i.cmykText.y),P(),O("rg",100)("value",i.cmykText==null?null:i.cmykText.k),P(),O("ngIf",i.cpAlphaChannel!=="disabled"),P(10),O("ngIf",i.cpAlphaChannel!=="disabled")}}function uoe(e,t){if(e&1){let i=Ue();S(0,"input",39),q("keyup.enter",function(n){j(i);let a=J(2);return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J(2);return W(a.onAlphaInput(n))}),A()}if(e&2){let i=J(2);O("rg",1)("value",i.hslaText==null?null:i.hslaText.a)}}function hoe(e,t){e&1&&(S(0,"div"),G(1,"A"),A())}function moe(e,t){if(e&1){let i=Ue();S(0,"div",40)(1,"div",35)(2,"input",41),q("keyup.enter",function(n){j(i);let a=J();return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J();return W(a.onHueInput(n))}),A(),S(3,"input",36),q("keyup.enter",function(n){j(i);let a=J();return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J();return W(a.onSaturationInput(n))}),A(),S(4,"input",36),q("keyup.enter",function(n){j(i);let a=J();return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J();return W(a.onLightnessInput(n))}),A(),Te(5,uoe,1,2,"input",37),A(),S(6,"div",35)(7,"div"),G(8,"H"),A(),S(9,"div"),G(10,"S"),A(),S(11,"div"),G(12,"L"),A(),Te(13,hoe,2,0,"div",38),A()()}if(e&2){let i=J();ei("display",i.format!==2?"none":"block"),P(2),O("rg",360)("value",i.hslaText==null?null:i.hslaText.h),P(),O("rg",100)("value",i.hslaText==null?null:i.hslaText.s),P(),O("rg",100)("value",i.hslaText==null?null:i.hslaText.l),P(),O("ngIf",i.cpAlphaChannel!=="disabled"),P(8),O("ngIf",i.cpAlphaChannel!=="disabled")}}function poe(e,t){if(e&1){let i=Ue();S(0,"input",39),q("keyup.enter",function(n){j(i);let a=J(2);return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J(2);return W(a.onAlphaInput(n))}),A()}if(e&2){let i=J(2);O("rg",1)("value",i.rgbaText==null?null:i.rgbaText.a)}}function foe(e,t){e&1&&(S(0,"div"),G(1,"A"),A())}function goe(e,t){if(e&1){let i=Ue();S(0,"div",42)(1,"div",35)(2,"input",43),q("keyup.enter",function(n){j(i);let a=J();return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J();return W(a.onRedInput(n))}),A(),S(3,"input",43),q("keyup.enter",function(n){j(i);let a=J();return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J();return W(a.onGreenInput(n))}),A(),S(4,"input",43),q("keyup.enter",function(n){j(i);let a=J();return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J();return W(a.onBlueInput(n))}),A(),Te(5,poe,1,2,"input",37),A(),S(6,"div",35)(7,"div"),G(8,"R"),A(),S(9,"div"),G(10,"G"),A(),S(11,"div"),G(12,"B"),A(),Te(13,foe,2,0,"div",38),A()()}if(e&2){let i=J();ei("display",i.format!==1?"none":"block"),P(2),O("rg",255)("value",i.rgbaText==null?null:i.rgbaText.r),P(),O("rg",255)("value",i.rgbaText==null?null:i.rgbaText.g),P(),O("rg",255)("value",i.rgbaText==null?null:i.rgbaText.b),P(),O("ngIf",i.cpAlphaChannel!=="disabled"),P(8),O("ngIf",i.cpAlphaChannel!=="disabled")}}function voe(e,t){if(e&1){let i=Ue();S(0,"input",39),q("keyup.enter",function(n){j(i);let a=J(2);return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J(2);return W(a.onAlphaInput(n))}),A()}if(e&2){let i=J(2);O("rg",1)("value",i.hexAlpha)}}function _oe(e,t){e&1&&(S(0,"div"),G(1,"A"),A())}function boe(e,t){if(e&1){let i=Ue();S(0,"div",44)(1,"div",35)(2,"input",45),q("blur",function(){j(i);let n=J();return W(n.onHexInput(null))})("keyup.enter",function(n){j(i);let a=J();return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J();return W(a.onHexInput(n))}),A(),Te(3,voe,1,2,"input",37),A(),S(4,"div",35)(5,"div"),G(6,"Hex"),A(),Te(7,_oe,2,0,"div",38),A()()}if(e&2){let i=J();ei("display",i.format!==0?"none":"block"),ft("hex-alpha",i.cpAlphaChannel==="forced"),P(2),O("value",i.hexText),P(),O("ngIf",i.cpAlphaChannel==="forced"),P(4),O("ngIf",i.cpAlphaChannel==="forced")}}function xoe(e,t){if(e&1){let i=Ue();S(0,"input",39),q("keyup.enter",function(n){j(i);let a=J(2);return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J(2);return W(a.onAlphaInput(n))}),A()}if(e&2){let i=J(2);O("rg",1)("value",i.hslaText==null?null:i.hslaText.a)}}function yoe(e,t){if(e&1){let i=Ue();S(0,"div",46)(1,"div",35)(2,"input",36),q("keyup.enter",function(n){j(i);let a=J();return W(a.onAcceptColor(n))})("newValue",function(n){j(i);let a=J();return W(a.onValueInput(n))}),A(),Te(3,xoe,1,2,"input",37),A(),S(4,"div",35)(5,"div"),G(6,"V"),A(),S(7,"div"),G(8,"A"),A()()()}if(e&2){let i=J();P(2),O("rg",100)("value",i.hslaText==null?null:i.hslaText.l),P(),O("ngIf",i.cpAlphaChannel!=="disabled")}}function woe(e,t){if(e&1){let i=Ue();S(0,"div",47)(1,"span",48),q("click",function(){j(i);let n=J();return W(n.onFormatToggle(-1))}),A(),S(2,"span",48),q("click",function(){j(i);let n=J();return W(n.onFormatToggle(1))}),A()()}}function Coe(e,t){if(e&1){let i=Ue();S(0,"span",55),q("click",function(n){j(i);let a=J().$implicit,o=J(3);return W(o.onRemovePresetColor(n,a))}),A()}if(e&2){let i=J(4);yr(i.cpRemoveColorButtonClass)}}function Eoe(e,t){if(e&1){let i=Ue();S(0,"div",53),q("click",function(){let n=j(i).$implicit,a=J(3);return W(a.setColorFromString(n))}),Te(1,Coe,1,3,"span",54),A()}if(e&2){let i=t.$implicit,r=J(3);ei("background-color",i),P(),O("ngIf",r.cpAddColorButton)}}function Soe(e,t){if(e&1&&(S(0,"div"),Te(1,Eoe,2,3,"div",52),A()),e&2){let i=J(2);yr(i.cpPresetColorsClass),P(),O("ngForOf",i.cpPresetColors)}}function Aoe(e,t){if(e&1&&(S(0,"div"),G(1),A()),e&2){let i=J(2);yr(i.cpPresetEmptyMessageClass),P(),gr(i.cpPresetEmptyMessage)}}function Toe(e,t){if(e&1&&(S(0,"div",49),ae(1,"hr"),S(2,"div",50),G(3),A(),Te(4,Soe,2,4,"div",51)(5,Aoe,2,4,"div",51),A()),e&2){let i=J();P(3),gr(i.cpPresetLabel),P(),O("ngIf",i.cpPresetColors==null?null:i.cpPresetColors.length),P(),O("ngIf",!(i.cpPresetColors!=null&&i.cpPresetColors.length)&&i.cpAddColorButton)}}function Doe(e,t){if(e&1){let i=Ue();S(0,"button",58),q("click",function(n){j(i);let a=J(2);return W(a.onCancelColor(n))}),G(1),A()}if(e&2){let i=J(2);yr(i.cpCancelButtonClass),P(),gr(i.cpCancelButtonText)}}function Moe(e,t){if(e&1){let i=Ue();S(0,"button",58),q("click",function(n){j(i);let a=J(2);return W(a.onAcceptColor(n))}),G(1),A()}if(e&2){let i=J(2);yr(i.cpOKButtonClass),P(),gr(i.cpOKButtonText)}}function Ioe(e,t){if(e&1&&(S(0,"div",56),Te(1,Doe,2,4,"button",57)(2,Moe,2,4,"button",57),A()),e&2){let i=J();P(),O("ngIf",i.cpCancelButton),P(),O("ngIf",i.cpOKButton)}}function koe(e,t){e&1&&uh(0)}function Noe(e,t){if(e&1&&(S(0,"div",59),Te(1,koe,1,0,"ng-container",60),A()),e&2){let i=J();P(),O("ngTemplateOutlet",i.cpExtraTemplate)}}var ga=function(e){return e[e.HEX=0]="HEX",e[e.RGBA=1]="RGBA",e[e.HSLA=2]="HSLA",e[e.CMYK=3]="CMYK",e}(ga||{}),xs=class{r;g;b;a;constructor(t,i,r,n){this.r=t,this.g=i,this.b=r,this.a=n}},ap=class{h;s;v;a;constructor(t,i,r,n){this.h=t,this.s=i,this.v=r,this.a=n}},Wl=class{h;s;l;a;constructor(t,i,r,n){this.h=t,this.s=i,this.l=r,this.a=n}},$u=class{c;m;y;k;a;constructor(t,i,r,n,a=1){this.c=t,this.m=i,this.y=r,this.k=n,this.a=a}};function Poe(e,t){let i="right",r="bottom",{height:n,width:a}=e,{top:o,left:s}=t,l=o+t.height,c=s+t.width,d=o-n<0,u=l+n>(window.innerHeight||document.documentElement.clientHeight),h=s-a<0,m=c+a>(window.innerWidth||document.documentElement.clientWidth),f=d&&u&&h&&m;return u&&(r="top"),d&&(r="bottom"),h&&(i="right"),m&&(i="left"),f?["left","right","top","bottom"].reduce((g,v)=>e[g]>e[v]?g:v):h&&m?d?"bottom":u||o>l?"top":"bottom":d&&u?h?"right":m||s>c?"left":"right":`${r}-${i}`}function Roe(){let e="";typeof navigator<"u"&&(e=navigator.userAgent.toLowerCase());let t=e.indexOf("msie ");return t>0?parseInt(e.substring(t+5,e.indexOf(".",t)),10):!1}var Foe=(()=>{class e{rg;text;newValue=new Pe;inputChange(i){let r=i.target.value;if(this.rg===void 0)this.newValue.emit(r);else{let n=parseFloat(r);this.newValue.emit({v:n,rg:this.rg})}}static \u0275fac=function(r){return new(r||e)};static \u0275dir=lt({type:e,selectors:[["","text",""]],hostBindings:function(r,n){r&1&&q("input",function(o){return n.inputChange(o)})},inputs:{rg:"rg",text:"text"},outputs:{newValue:"newValue"}})}return e})(),Ooe=(()=>{class e{elRef;listenerMove;listenerStop;rgX;rgY;slider;dragEnd=new Pe;dragStart=new Pe;newValue=new Pe;mouseDown(i){this.start(i)}touchStart(i){this.start(i)}constructor(i){this.elRef=i,this.listenerMove=r=>this.move(r),this.listenerStop=()=>this.stop()}move(i){i.preventDefault(),this.setCursor(i)}start(i){this.setCursor(i),i.stopPropagation(),document.addEventListener("mouseup",this.listenerStop),document.addEventListener("touchend",this.listenerStop),document.addEventListener("mousemove",this.listenerMove),document.addEventListener("touchmove",this.listenerMove),this.dragStart.emit()}stop(){document.removeEventListener("mouseup",this.listenerStop),document.removeEventListener("touchend",this.listenerStop),document.removeEventListener("mousemove",this.listenerMove),document.removeEventListener("touchmove",this.listenerMove),this.dragEnd.emit()}getX(i){let r=this.elRef.nativeElement.getBoundingClientRect();return(i.pageX!==void 0?i.pageX:i.touches[0].pageX)-r.left-window.pageXOffset}getY(i){let r=this.elRef.nativeElement.getBoundingClientRect();return(i.pageY!==void 0?i.pageY:i.touches[0].pageY)-r.top-window.pageYOffset}setCursor(i){let r=this.elRef.nativeElement.offsetWidth,n=this.elRef.nativeElement.offsetHeight,a=Math.max(0,Math.min(this.getX(i),r)),o=Math.max(0,Math.min(this.getY(i),n));this.rgX!==void 0&&this.rgY!==void 0?this.newValue.emit({s:a/r,v:1-o/n,rgX:this.rgX,rgY:this.rgY}):this.rgX===void 0&&this.rgY!==void 0?this.newValue.emit({v:o/n,rgY:this.rgY}):this.rgX!==void 0&&this.rgY===void 0&&this.newValue.emit({v:a/r,rgX:this.rgX})}static \u0275fac=function(r){return new(r||e)(z(nt))};static \u0275dir=lt({type:e,selectors:[["","slider",""]],hostBindings:function(r,n){r&1&&q("mousedown",function(o){return n.mouseDown(o)})("touchstart",function(o){return n.touchStart(o)})},inputs:{rgX:"rgX",rgY:"rgY",slider:"slider"},outputs:{dragEnd:"dragEnd",dragStart:"dragStart",newValue:"newValue"}})}return e})(),Iy=class{h;s;v;a;constructor(t,i,r,n){this.h=t,this.s=i,this.v=r,this.a=n}},ky=class{h;s;v;a;constructor(t,i,r,n){this.h=t,this.s=i,this.v=r,this.a=n}},P8=(()=>{class e{active=null;setActive(i){this.active&&this.active!==i&&this.active.cpDialogDisplay!=="inline"&&this.active.closeDialog(),this.active=i}hsva2hsla(i){let r=i.h,n=i.s,a=i.v,o=i.a;if(a===0)return new Wl(r,0,0,o);if(n===0&&a===1)return new Wl(r,1,1,o);{let s=a*(2-n)/2;return new Wl(r,a*n/(1-Math.abs(2*s-1)),s,o)}}hsla2hsva(i){let r=Math.min(i.h,1),n=Math.min(i.s,1),a=Math.min(i.l,1),o=Math.min(i.a,1);if(a===0)return new ap(r,0,0,o);{let s=a+n*(1-Math.abs(2*a-1))/2;return new ap(r,2*(s-a)/s,s,o)}}hsvaToRgba(i){let r,n,a,o=i.h,s=i.s,l=i.v,c=i.a,d=Math.floor(o*6),u=o*6-d,h=l*(1-s),m=l*(1-u*s),f=l*(1-(1-u)*s);switch(d%6){case 0:r=l,n=f,a=h;break;case 1:r=m,n=l,a=h;break;case 2:r=h,n=l,a=f;break;case 3:r=h,n=m,a=l;break;case 4:r=f,n=h,a=l;break;case 5:r=l,n=h,a=m;break;default:r=0,n=0,a=0}return new xs(r,n,a,c)}cmykToRgb(i){let r=(1-i.c)*(1-i.k),n=(1-i.m)*(1-i.k),a=(1-i.y)*(1-i.k);return new xs(r,n,a,i.a)}rgbaToCmyk(i){let r=1-Math.max(i.r,i.g,i.b);if(r===1)return new $u(0,0,0,1,i.a);{let n=(1-i.r-r)/(1-r),a=(1-i.g-r)/(1-r),o=(1-i.b-r)/(1-r);return new $u(n,a,o,r,i.a)}}rgbaToHsva(i){let r,n,a=Math.min(i.r,1),o=Math.min(i.g,1),s=Math.min(i.b,1),l=Math.min(i.a,1),c=Math.max(a,o,s),d=Math.min(a,o,s),u=c,h=c-d;if(n=c===0?0:h/c,c===d)r=0;else{switch(c){case a:r=(o-s)/h+(o<s?6:0);break;case o:r=(s-a)/h+2;break;case s:r=(a-o)/h+4;break;default:r=0}r/=6}return new ap(r,n,u,l)}rgbaToHex(i,r){let n="#"+(16777216|i.r<<16|i.g<<8|i.b).toString(16).substr(1);return r&&(n+=(256|Math.round(i.a*255)).toString(16).substr(1)),n}normalizeCMYK(i){return new $u(i.c/100,i.m/100,i.y/100,i.k/100,i.a)}denormalizeCMYK(i){return new $u(Math.floor(i.c*100),Math.floor(i.m*100),Math.floor(i.y*100),Math.floor(i.k*100),i.a)}denormalizeRGBA(i){return new xs(Math.round(i.r*255),Math.round(i.g*255),Math.round(i.b*255),i.a)}stringToHsva(i="",r=!1){let n=null;i=(i||"").toLowerCase();let a=[{re:/(rgb)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new xs(parseInt(o[2],10)/255,parseInt(o[3],10)/255,parseInt(o[4],10)/255,isNaN(parseFloat(o[5]))?1:parseFloat(o[5]))}},{re:/(hsl)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new Wl(parseInt(o[2],10)/360,parseInt(o[3],10)/100,parseInt(o[4],10)/100,isNaN(parseFloat(o[5]))?1:parseFloat(o[5]))}}];r?a.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})?$/,parse:function(o){return new xs(parseInt(o[1],16)/255,parseInt(o[2],16)/255,parseInt(o[3],16)/255,parseInt(o[4]||"FF",16)/255)}}):a.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,parse:function(o){return new xs(parseInt(o[1],16)/255,parseInt(o[2],16)/255,parseInt(o[3],16)/255,1)}}),a.push({re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,parse:function(o){return new xs(parseInt(o[1]+o[1],16)/255,parseInt(o[2]+o[2],16)/255,parseInt(o[3]+o[3],16)/255,1)}});for(let o in a)if(a.hasOwnProperty(o)){let s=a[o],l=s.re.exec(i),c=l&&s.parse(l);if(c)return c instanceof xs?n=this.rgbaToHsva(c):c instanceof Wl&&(n=this.hsla2hsva(c)),n}return n}outputFormat(i,r,n){switch(r==="auto"&&(r=i.a<1?"rgba":"hex"),r){case"hsla":let a=this.hsva2hsla(i),o=new Wl(Math.round(a.h*360),Math.round(a.s*100),Math.round(a.l*100),Math.round(a.a*100)/100);return i.a<1||n==="always"?"hsla("+o.h+","+o.s+"%,"+o.l+"%,"+o.a+")":"hsl("+o.h+","+o.s+"%,"+o.l+"%)";case"rgba":let s=this.denormalizeRGBA(this.hsvaToRgba(i));return i.a<1||n==="always"?"rgba("+s.r+","+s.g+","+s.b+","+Math.round(s.a*100)/100+")":"rgb("+s.r+","+s.g+","+s.b+")";default:let l=n==="always"||n==="forced";return this.rgbaToHex(this.denormalizeRGBA(this.hsvaToRgba(i)),l)}}static \u0275fac=function(r){return new(r||e)};static \u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),N8=typeof window<"u"&&"ontouchstart"in window,Loe=(()=>{class e{ngZone;elRef;cdRef;document;platformId;service;isIE10=!1;cmyk;hsva;width;height;cmykColor;outputColor;initialColor;fallbackColor;listenerResize;listenerMouseDown;directiveInstance;sliderH;sliderDimMax;directiveElementRef;dialogArrowSize=10;dialogArrowOffset=15;dialogInputFields=[ga.HEX,ga.RGBA,ga.HSLA,ga.CMYK];useRootViewContainer=!1;show;hidden;top;left;position;format;slider;hexText;hexAlpha;cmykText;hslaText;rgbaText;arrowTop;selectedColor;hueSliderColor;alphaSliderColor;cpWidth;cpHeight;cpColorMode;cpCmykEnabled;cpAlphaChannel;cpOutputFormat;cpDisableInput;cpDialogDisplay;cpIgnoredElements;cpSaveClickOutside;cpCloseClickOutside;cpPosition;cpUsePosition;cpPositionOffset;cpOKButton;cpOKButtonText;cpOKButtonClass;cpCancelButton;cpCancelButtonText;cpCancelButtonClass;cpEyeDropper;eyeDropperSupported;cpPresetLabel;cpPresetColors;cpPresetColorsClass;cpMaxPresetColorsLength;cpPresetEmptyMessage;cpPresetEmptyMessageClass;cpAddColorButton;cpAddColorButtonText;cpAddColorButtonClass;cpRemoveColorButtonClass;cpArrowPosition;cpTriggerElement;cpExtraTemplate;dialogElement;hueSlider;alphaSlider;handleEsc(i){this.show&&this.cpDialogDisplay==="popup"&&this.onCancelColor(i)}handleEnter(i){this.show&&this.cpDialogDisplay==="popup"&&this.onAcceptColor(i)}constructor(i,r,n,a,o,s){this.ngZone=i,this.elRef=r,this.cdRef=n,this.document=a,this.platformId=o,this.service=s,this.eyeDropperSupported=t0(this.platformId)&&"EyeDropper"in this.document.defaultView}ngOnInit(){this.slider=new Iy(0,0,0,0);let i=this.hueSlider.nativeElement.offsetWidth||140,r=this.alphaSlider.nativeElement.offsetWidth||140;this.sliderDimMax=new ky(i,this.cpWidth,130,r),this.cpCmykEnabled?this.format=ga.CMYK:this.cpOutputFormat==="rgba"?this.format=ga.RGBA:this.cpOutputFormat==="hsla"?this.format=ga.HSLA:this.format=ga.HEX,this.listenerMouseDown=n=>{this.onMouseDown(n)},this.listenerResize=()=>{this.onResize()},this.openDialog(this.initialColor,!1)}ngOnDestroy(){this.closeDialog()}ngAfterViewInit(){if(this.cpWidth!==230||this.cpDialogDisplay==="inline"){let i=this.hueSlider.nativeElement.offsetWidth||140,r=this.alphaSlider.nativeElement.offsetWidth||140;this.sliderDimMax=new ky(i,this.cpWidth,130,r),this.updateColorPicker(!1),this.cdRef.detectChanges()}}openDialog(i,r=!0){this.service.setActive(this),this.width||(this.cpWidth=this.directiveElementRef.nativeElement.offsetWidth),this.height||(this.height=320),this.setInitialColor(i),this.setColorFromString(i,r),this.openColorPicker()}closeDialog(){this.closeColorPicker()}setupDialog(i,r,n,a,o,s,l,c,d,u,h,m,f,p,g,v,b,_,x,w,y,M,T,C,N,D,k,U,F,H,V,Q,$,ee,re,we,te,oe){this.setInitialColor(n),this.setColorMode(c),this.isIE10=Roe()===10,this.directiveInstance=i,this.directiveElementRef=r,this.cpDisableInput=m,this.cpCmykEnabled=d,this.cpAlphaChannel=u,this.cpOutputFormat=h,this.cpDialogDisplay=s,this.cpIgnoredElements=f,this.cpSaveClickOutside=p,this.cpCloseClickOutside=g,this.useRootViewContainer=v,this.width=this.cpWidth=parseInt(a,10),this.height=this.cpHeight=parseInt(o,10),this.cpPosition=b,this.cpPositionOffset=parseInt(_,10),this.cpOKButton=D,this.cpOKButtonText=U,this.cpOKButtonClass=k,this.cpCancelButton=F,this.cpCancelButtonText=V,this.cpCancelButtonClass=H,this.cpEyeDropper=we,this.fallbackColor=l||"#fff",this.setPresetConfig(w,y),this.cpPresetColorsClass=M,this.cpMaxPresetColorsLength=T,this.cpPresetEmptyMessage=C,this.cpPresetEmptyMessageClass=N,this.cpAddColorButton=Q,this.cpAddColorButtonText=ee,this.cpAddColorButtonClass=$,this.cpRemoveColorButtonClass=re,this.cpTriggerElement=te,this.cpExtraTemplate=oe,x||(this.dialogArrowOffset=0),s==="inline"&&(this.dialogArrowSize=0,this.dialogArrowOffset=0),h==="hex"&&u!=="always"&&u!=="forced"&&(this.cpAlphaChannel="disabled")}setColorMode(i){switch(i.toString().toUpperCase()){case"1":case"C":case"COLOR":this.cpColorMode=1;break;case"2":case"G":case"GRAYSCALE":this.cpColorMode=2;break;case"3":case"P":case"PRESETS":this.cpColorMode=3;break;default:this.cpColorMode=1}}setInitialColor(i){this.initialColor=i}setPresetConfig(i,r){this.cpPresetLabel=i,this.cpPresetColors=r}setColorFromString(i,r=!0,n=!0){let a;this.cpAlphaChannel==="always"||this.cpAlphaChannel==="forced"?(a=this.service.stringToHsva(i,!0),!a&&!this.hsva&&(a=this.service.stringToHsva(i,!1))):a=this.service.stringToHsva(i,!1),!a&&!this.hsva&&(a=this.service.stringToHsva(this.fallbackColor,!1)),a&&(this.hsva=a,this.sliderH=this.hsva.h,this.cpOutputFormat==="hex"&&this.cpAlphaChannel==="disabled"&&(this.hsva.a=1),this.updateColorPicker(r,n))}onResize(){this.position==="fixed"?this.setDialogPosition():this.cpDialogDisplay!=="inline"&&this.closeColorPicker()}onDragEnd(i){this.directiveInstance.sliderDragEnd({slider:i,color:this.outputColor})}onDragStart(i){this.directiveInstance.sliderDragStart({slider:i,color:this.outputColor})}onMouseDown(i){this.show&&!this.isIE10&&this.cpDialogDisplay==="popup"&&i.target!==this.directiveElementRef.nativeElement&&!this.isDescendant(this.elRef.nativeElement,i.target)&&!this.isDescendant(this.directiveElementRef.nativeElement,i.target)&&this.cpIgnoredElements.filter(r=>r===i.target).length===0&&this.ngZone.run(()=>{this.cpSaveClickOutside?this.directiveInstance.colorSelected(this.outputColor):(this.hsva=null,this.setColorFromString(this.initialColor,!1),this.cpCmykEnabled&&this.directiveInstance.cmykChanged(this.cmykColor),this.directiveInstance.colorChanged(this.initialColor),this.directiveInstance.colorCanceled()),this.cpCloseClickOutside&&this.closeColorPicker()})}onAcceptColor(i){i.stopPropagation(),this.outputColor&&this.directiveInstance.colorSelected(this.outputColor),this.cpDialogDisplay==="popup"&&this.closeColorPicker()}onCancelColor(i){this.hsva=null,i.stopPropagation(),this.directiveInstance.colorCanceled(),this.setColorFromString(this.initialColor,!0),this.cpDialogDisplay==="popup"&&(this.cpCmykEnabled&&this.directiveInstance.cmykChanged(this.cmykColor),this.directiveInstance.colorChanged(this.initialColor,!0),this.closeColorPicker())}onEyeDropper(){if(!this.eyeDropperSupported)return;new window.EyeDropper().open().then(r=>{this.setColorFromString(r.sRGBHex,!0)})}onFormatToggle(i){let r=this.dialogInputFields.length-(this.cpCmykEnabled?0:1),n=((this.dialogInputFields.indexOf(this.format)+i)%r+r)%r;this.format=this.dialogInputFields[n]}onColorChange(i){this.hsva.s=i.s/i.rgX,this.hsva.v=i.v/i.rgY,this.updateColorPicker(),this.directiveInstance.sliderChanged({slider:"lightness",value:this.hsva.v,color:this.outputColor}),this.directiveInstance.sliderChanged({slider:"saturation",value:this.hsva.s,color:this.outputColor})}onHueChange(i){this.hsva.h=i.v/i.rgX,this.sliderH=this.hsva.h,this.updateColorPicker(),this.directiveInstance.sliderChanged({slider:"hue",value:this.hsva.h,color:this.outputColor})}onValueChange(i){this.hsva.v=i.v/i.rgX,this.updateColorPicker(),this.directiveInstance.sliderChanged({slider:"value",value:this.hsva.v,color:this.outputColor})}onAlphaChange(i){this.hsva.a=i.v/i.rgX,this.updateColorPicker(),this.directiveInstance.sliderChanged({slider:"alpha",value:this.hsva.a,color:this.outputColor})}onHexInput(i){if(i===null)this.updateColorPicker();else{i&&i[0]!=="#"&&(i="#"+i);let r=/^#([a-f0-9]{3}|[a-f0-9]{6})$/gi;this.cpAlphaChannel==="always"&&(r=/^#([a-f0-9]{3}|[a-f0-9]{6}|[a-f0-9]{8})$/gi);let n=r.test(i);n&&(i.length<5&&(i="#"+i.substring(1).split("").map(a=>a+a).join("")),this.cpAlphaChannel==="forced"&&(i+=Math.round(this.hsva.a*255).toString(16)),this.setColorFromString(i,!0,!1)),this.directiveInstance.inputChanged({input:"hex",valid:n,value:i,color:this.outputColor})}}onRedInput(i){let r=this.service.hsvaToRgba(this.hsva),n=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;n&&(r.r=i.v/i.rg,this.hsva=this.service.rgbaToHsva(r),this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"red",valid:n,value:r.r,color:this.outputColor})}onBlueInput(i){let r=this.service.hsvaToRgba(this.hsva),n=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;n&&(r.b=i.v/i.rg,this.hsva=this.service.rgbaToHsva(r),this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"blue",valid:n,value:r.b,color:this.outputColor})}onGreenInput(i){let r=this.service.hsvaToRgba(this.hsva),n=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;n&&(r.g=i.v/i.rg,this.hsva=this.service.rgbaToHsva(r),this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"green",valid:n,value:r.g,color:this.outputColor})}onHueInput(i){let r=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;r&&(this.hsva.h=i.v/i.rg,this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"hue",valid:r,value:this.hsva.h,color:this.outputColor})}onValueInput(i){let r=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;r&&(this.hsva.v=i.v/i.rg,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"value",valid:r,value:this.hsva.v,color:this.outputColor})}onAlphaInput(i){let r=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;r&&(this.hsva.a=i.v/i.rg,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"alpha",valid:r,value:this.hsva.a,color:this.outputColor})}onLightnessInput(i){let r=this.service.hsva2hsla(this.hsva),n=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;n&&(r.l=i.v/i.rg,this.hsva=this.service.hsla2hsva(r),this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"lightness",valid:n,value:r.l,color:this.outputColor})}onSaturationInput(i){let r=this.service.hsva2hsla(this.hsva),n=!isNaN(i.v)&&i.v>=0&&i.v<=i.rg;n&&(r.s=i.v/i.rg,this.hsva=this.service.hsla2hsva(r),this.sliderH=this.hsva.h,this.updateColorPicker()),this.directiveInstance.inputChanged({input:"saturation",valid:n,value:r.s,color:this.outputColor})}onCyanInput(i){!isNaN(i.v)&&i.v>=0&&i.v<=i.rg&&(this.cmyk.c=i.v,this.updateColorPicker(!1,!0,!0)),this.directiveInstance.inputChanged({input:"cyan",valid:!0,value:this.cmyk.c,color:this.outputColor})}onMagentaInput(i){!isNaN(i.v)&&i.v>=0&&i.v<=i.rg&&(this.cmyk.m=i.v,this.updateColorPicker(!1,!0,!0)),this.directiveInstance.inputChanged({input:"magenta",valid:!0,value:this.cmyk.m,color:this.outputColor})}onYellowInput(i){!isNaN(i.v)&&i.v>=0&&i.v<=i.rg&&(this.cmyk.y=i.v,this.updateColorPicker(!1,!0,!0)),this.directiveInstance.inputChanged({input:"yellow",valid:!0,value:this.cmyk.y,color:this.outputColor})}onBlackInput(i){!isNaN(i.v)&&i.v>=0&&i.v<=i.rg&&(this.cmyk.k=i.v,this.updateColorPicker(!1,!0,!0)),this.directiveInstance.inputChanged({input:"black",valid:!0,value:this.cmyk.k,color:this.outputColor})}onAddPresetColor(i,r){i.stopPropagation(),this.cpPresetColors.filter(n=>n===r).length||(this.cpPresetColors=this.cpPresetColors.concat(r),this.directiveInstance.presetColorsChanged(this.cpPresetColors))}onRemovePresetColor(i,r){i.stopPropagation(),this.cpPresetColors=this.cpPresetColors.filter(n=>n!==r),this.directiveInstance.presetColorsChanged(this.cpPresetColors)}openColorPicker(){this.show||(this.show=!0,this.hidden=!0,setTimeout(()=>{this.hidden=!1,this.setDialogPosition(),this.cdRef.detectChanges()},0),this.directiveInstance.stateChanged(!0),this.isIE10||this.ngZone.runOutsideAngular(()=>{N8?document.addEventListener("touchstart",this.listenerMouseDown):document.addEventListener("mousedown",this.listenerMouseDown)}),window.addEventListener("resize",this.listenerResize))}closeColorPicker(){this.show&&(this.show=!1,this.directiveInstance.stateChanged(!1),this.isIE10||(N8?document.removeEventListener("touchstart",this.listenerMouseDown):document.removeEventListener("mousedown",this.listenerMouseDown)),window.removeEventListener("resize",this.listenerResize),this.cdRef.destroyed||this.cdRef.detectChanges())}updateColorPicker(i=!0,r=!0,n=!1){if(this.sliderDimMax){this.cpColorMode===2&&(this.hsva.s=0);let a,o,s,l=this.outputColor;if(o=this.service.hsva2hsla(this.hsva),this.cpCmykEnabled?(n?(s=this.service.cmykToRgb(this.service.normalizeCMYK(this.cmyk)),this.hsva=this.service.rgbaToHsva(s)):(s=this.service.hsvaToRgba(this.hsva),this.cmyk=this.service.denormalizeCMYK(this.service.rgbaToCmyk(s))),s=this.service.denormalizeRGBA(s),this.sliderH=this.hsva.h):s=this.service.denormalizeRGBA(this.service.hsvaToRgba(this.hsva)),a=this.service.denormalizeRGBA(this.service.hsvaToRgba(new ap(this.sliderH||this.hsva.h,1,1,1))),r){this.hslaText=new Wl(Math.round(o.h*360),Math.round(o.s*100),Math.round(o.l*100),Math.round(o.a*100)/100),this.rgbaText=new xs(s.r,s.g,s.b,Math.round(s.a*100)/100),this.cpCmykEnabled&&(this.cmykText=new $u(this.cmyk.c,this.cmyk.m,this.cmyk.y,this.cmyk.k,Math.round(this.cmyk.a*100)/100));let c=this.cpAlphaChannel==="always";this.hexText=this.service.rgbaToHex(s,c),this.hexAlpha=this.rgbaText.a}if(this.cpOutputFormat==="auto"&&this.format!==ga.RGBA&&this.format!==ga.CMYK&&this.format!==ga.HSLA&&this.hsva.a<1&&(this.format=this.hsva.a<1?ga.RGBA:ga.HEX),this.hueSliderColor="rgb("+a.r+","+a.g+","+a.b+")",this.alphaSliderColor="rgb("+s.r+","+s.g+","+s.b+")",this.outputColor=this.service.outputFormat(this.hsva,this.cpOutputFormat,this.cpAlphaChannel),this.selectedColor=this.service.outputFormat(this.hsva,"rgba",null),this.format!==ga.CMYK)this.cmykColor="";else if(this.cpAlphaChannel==="always"||this.cpAlphaChannel==="enabled"||this.cpAlphaChannel==="forced"){let c=Math.round(this.cmyk.a*100)/100;this.cmykColor=`cmyka(${this.cmyk.c},${this.cmyk.m},${this.cmyk.y},${this.cmyk.k},${c})`}else this.cmykColor=`cmyk(${this.cmyk.c},${this.cmyk.m},${this.cmyk.y},${this.cmyk.k})`;this.slider=new Iy((this.sliderH||this.hsva.h)*this.sliderDimMax.h-8,this.hsva.s*this.sliderDimMax.s-8,(1-this.hsva.v)*this.sliderDimMax.v-8,this.hsva.a*this.sliderDimMax.a-8),i&&l!==this.outputColor&&(this.cpCmykEnabled&&this.directiveInstance.cmykChanged(this.cmykColor),this.directiveInstance.colorChanged(this.outputColor))}}setDialogPosition(){if(this.cpDialogDisplay==="inline")this.position="relative";else{let i="static",r="",n,a=null,o=null,s=this.directiveElementRef.nativeElement.parentNode,l=this.dialogElement.nativeElement.offsetHeight;for(;s!==null&&s.tagName!=="HTML";){if(n=window.getComputedStyle(s),i=n.getPropertyValue("position"),r=n.getPropertyValue("transform"),i!=="static"&&a===null&&(a=s),r&&r!=="none"&&o===null&&(o=s),i==="fixed"){a=o;break}s=s.parentNode}let c=this.createDialogBox(this.directiveElementRef.nativeElement,i!=="fixed");if(this.useRootViewContainer||i==="fixed"&&(!a||a instanceof HTMLUnknownElement))this.top=c.top,this.left=c.left;else{a===null&&(a=s);let v=this.createDialogBox(a,i!=="fixed");this.top=c.top-v.top,this.left=c.left-v.left}i==="fixed"&&(this.position="fixed");let d=this.cpPosition,u=this.dialogElement.nativeElement.getBoundingClientRect();if(this.cpPosition==="auto"){let v=this.cpTriggerElement.nativeElement.getBoundingClientRect();d=Poe(u,v)}switch(this.arrowTop=d==="top"?l-1:void 0,this.cpArrowPosition=void 0,d){case"top":this.top-=l+this.dialogArrowSize,this.left+=this.cpPositionOffset/100*c.width-this.dialogArrowOffset;break;case"bottom":this.top+=c.height+this.dialogArrowSize,this.left+=this.cpPositionOffset/100*c.width-this.dialogArrowOffset;break;case"top-left":case"left-top":this.top-=l-c.height+c.height*this.cpPositionOffset/100,this.left-=this.cpWidth+this.dialogArrowSize-2-this.dialogArrowOffset;break;case"top-right":case"right-top":this.top-=l-c.height+c.height*this.cpPositionOffset/100,this.left+=c.width+this.dialogArrowSize-2-this.dialogArrowOffset;break;case"left":case"bottom-left":case"left-bottom":this.top+=c.height*this.cpPositionOffset/100-this.dialogArrowOffset,this.left-=this.cpWidth+this.dialogArrowSize-2;break;case"right":case"bottom-right":case"right-bottom":default:this.top+=c.height*this.cpPositionOffset/100-this.dialogArrowOffset,this.left+=c.width+this.dialogArrowSize-2;break}let h=window.innerHeight,m=window.innerWidth,f=this.elRef.nativeElement.getBoundingClientRect();this.top+u.height>h&&(this.top=h-u.height,this.cpArrowPosition=f.x/2-20),this.left+u.width>m&&(this.left=m-u.width,this.cpArrowPosition=f.x/2-20),this.cpUsePosition=d}}isDescendant(i,r){let n=r.parentNode;for(;n!==null;){if(n===i)return!0;n=n.parentNode}return!1}createDialogBox(i,r){let{top:n,left:a}=i.getBoundingClientRect();return{top:n+(r?window.pageYOffset:0),left:a+(r?window.pageXOffset:0),width:i.offsetWidth,height:i.offsetHeight}}static \u0275fac=function(r){return new(r||e)(z(Xe),z(nt),z(Vt),z(yt),z(ll),z(P8))};static \u0275cmp=Ae({type:e,selectors:[["color-picker"]],viewQuery:function(r,n){if(r&1&&(tt(eoe,7),tt(toe,7),tt(ioe,7)),r&2){let a;Me(a=Ie())&&(n.dialogElement=a.first),Me(a=Ie())&&(n.hueSlider=a.first),Me(a=Ie())&&(n.alphaSlider=a.first)}},hostBindings:function(r,n){r&1&&q("keyup.esc",function(o){return n.handleEsc(o)},!1,zw)("keyup.enter",function(o){return n.handleEnter(o)},!1,zw)},decls:30,vars:51,consts:[["dialogPopup",""],["hueSlider",""],["valueSlider",""],["alphaSlider",""],[1,"color-picker",3,"click"],[3,"left","class","top",4,"ngIf"],["class","saturation-lightness",3,"slider","rgX","rgY","background-color","newValue","dragStart","dragEnd",4,"ngIf"],[1,"hue-alpha","box"],[1,"left"],[1,"selected-color-background"],[1,"selected-color",3,"click"],["class","eyedropper-icon","xmlns","http://www.w3.org/2000/svg","height","24px","viewBox","0 0 24 24","width","24px","fill","#000000",4,"ngIf"],["type","button",3,"class","disabled","click",4,"ngIf"],[1,"right"],["style","height: 16px;",4,"ngIf"],[1,"hue",3,"newValue","dragStart","dragEnd","slider","rgX"],[1,"cursor"],[1,"value",3,"newValue","dragStart","dragEnd","slider","rgX"],[1,"alpha",3,"newValue","dragStart","dragEnd","slider","rgX"],["class","cmyk-text",3,"display",4,"ngIf"],["class","hsla-text",3,"display",4,"ngIf"],["class","rgba-text",3,"display",4,"ngIf"],["class","hex-text",3,"hex-alpha","display",4,"ngIf"],["class","value-text",4,"ngIf"],["class","type-policy",4,"ngIf"],["class","preset-area",4,"ngIf"],["class","button-area",4,"ngIf"],["class","extra-template",4,"ngIf"],[1,"saturation-lightness",3,"newValue","dragStart","dragEnd","slider","rgX","rgY"],["xmlns","http://www.w3.org/2000/svg","height","24px","viewBox","0 0 24 24","width","24px","fill","#000000",1,"eyedropper-icon"],["d","M0 0h24v24H0V0z","fill","none"],["d","M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"],["type","button",3,"click","disabled"],[2,"height","16px"],[1,"cmyk-text"],[1,"box"],["type","number","pattern","[0-9]*","min","0","max","100",3,"keyup.enter","newValue","text","rg","value"],["type","number","pattern","[0-9]+([\\.,][0-9]{1,2})?","min","0","max","1","step","0.1",3,"text","rg","value","keyup.enter","newValue",4,"ngIf"],[4,"ngIf"],["type","number","pattern","[0-9]+([\\.,][0-9]{1,2})?","min","0","max","1","step","0.1",3,"keyup.enter","newValue","text","rg","value"],[1,"hsla-text"],["type","number","pattern","[0-9]*","min","0","max","360",3,"keyup.enter","newValue","text","rg","value"],[1,"rgba-text"],["type","number","pattern","[0-9]*","min","0","max","255",3,"keyup.enter","newValue","text","rg","value"],[1,"hex-text"],[3,"blur","keyup.enter","newValue","text","value"],[1,"value-text"],[1,"type-policy"],[1,"type-policy-arrow",3,"click"],[1,"preset-area"],[1,"preset-label"],[3,"class",4,"ngIf"],["class","preset-color",3,"backgroundColor","click",4,"ngFor","ngForOf"],[1,"preset-color",3,"click"],[3,"class","click",4,"ngIf"],[3,"click"],[1,"button-area"],["type","button",3,"class","click",4,"ngIf"],["type","button",3,"click"],[1,"extra-template"],[4,"ngTemplateOutlet"]],template:function(r,n){if(r&1){let a=Ue();S(0,"div",4,0),q("click",function(s){return j(a),W(s.stopPropagation())}),Te(2,roe,1,7,"div",5)(3,noe,2,8,"div",6),S(4,"div",7)(5,"div",8),ae(6,"div",9),S(7,"div",10),q("click",function(){return j(a),W(n.eyeDropperSupported&&n.cpEyeDropper&&n.onEyeDropper())}),Te(8,aoe,3,0,"svg",11),A(),Te(9,ooe,2,5,"button",12),A(),S(10,"div",13),Te(11,soe,1,0,"div",14),S(12,"div",15,1),q("newValue",function(s){return j(a),W(n.onHueChange(s))})("dragStart",function(){return j(a),W(n.onDragStart("hue"))})("dragEnd",function(){return j(a),W(n.onDragEnd("hue"))}),ae(14,"div",16),A(),S(15,"div",17,2),q("newValue",function(s){return j(a),W(n.onValueChange(s))})("dragStart",function(){return j(a),W(n.onDragStart("value"))})("dragEnd",function(){return j(a),W(n.onDragEnd("value"))}),ae(17,"div",16),A(),S(18,"div",18,3),q("newValue",function(s){return j(a),W(n.onAlphaChange(s))})("dragStart",function(){return j(a),W(n.onDragStart("alpha"))})("dragEnd",function(){return j(a),W(n.onDragEnd("alpha"))}),ae(20,"div",16),A()()(),Te(21,doe,17,12,"div",19)(22,moe,14,10,"div",20)(23,goe,14,10,"div",21)(24,boe,8,7,"div",22)(25,yoe,9,3,"div",23)(26,woe,3,0,"div",24)(27,Toe,6,3,"div",25)(28,Ioe,3,2,"div",26)(29,Noe,2,1,"div",27),A()}r&2&&(ei("display",n.show?"block":"none")("visibility",n.hidden?"hidden":"visible")("top",n.top,"px")("left",n.left,"px")("position",n.position)("height",n.cpHeight,"px")("width",n.cpWidth,"px"),ft("open",n.show),P(2),O("ngIf",n.cpDialogDisplay==="popup"),P(),O("ngIf",(n.cpColorMode||1)===1),P(4),ei("background-color",n.selectedColor)("cursor",n.eyeDropperSupported&&n.cpEyeDropper?"pointer":null),P(),O("ngIf",n.eyeDropperSupported&&n.cpEyeDropper),P(),O("ngIf",n.cpAddColorButton),P(2),O("ngIf",n.cpAlphaChannel==="disabled"),P(),ei("display",(n.cpColorMode||1)===1?"block":"none"),O("rgX",1),P(2),ei("left",n.slider==null?null:n.slider.h,"px"),P(),ei("display",(n.cpColorMode||1)===2?"block":"none"),O("rgX",1),P(2),ei("right",n.slider==null?null:n.slider.v,"px"),P(),ei("display",n.cpAlphaChannel==="disabled"?"none":"block")("background-color",n.alphaSliderColor),O("rgX",1),P(2),ei("left",n.slider==null?null:n.slider.a,"px"),P(),O("ngIf",!n.cpDisableInput&&(n.cpColorMode||1)===1),P(),O("ngIf",!n.cpDisableInput&&(n.cpColorMode||1)===1),P(),O("ngIf",!n.cpDisableInput&&(n.cpColorMode||1)===1),P(),O("ngIf",!n.cpDisableInput&&(n.cpColorMode||1)===1),P(),O("ngIf",!n.cpDisableInput&&(n.cpColorMode||1)===2),P(),O("ngIf",!n.cpDisableInput&&(n.cpColorMode||1)===1),P(),O("ngIf",(n.cpPresetColors==null?null:n.cpPresetColors.length)||n.cpAddColorButton),P(),O("ngIf",n.cpOKButton||n.cpCancelButton),P(),O("ngIf",n.cpExtraTemplate))},dependencies:[Fn,cn,Dd,Foe,Ooe],styles:[`.color-picker{position:absolute;z-index:1000;width:230px;height:auto;border:#777 solid 1px;cursor:default;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:#fff}.color-picker *{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;margin:0;font-size:11px}.color-picker input{width:0;height:26px;min-width:0;font-size:13px;text-align:center;color:#000}.color-picker input:invalid,.color-picker input:-moz-ui-invalid,.color-picker input:-moz-submit-invalid{box-shadow:none}.color-picker input::-webkit-inner-spin-button,.color-picker input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none}.color-picker .arrow{position:absolute;z-index:999999;width:0;height:0;border-style:solid}.color-picker .arrow.arrow-top{left:8px;border-width:10px 5px;border-color:#777 rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0)}.color-picker .arrow.arrow-bottom{top:-20px;left:8px;border-width:10px 5px;border-color:rgba(0,0,0,0) rgba(0,0,0,0) #777 rgba(0,0,0,0)}.color-picker .arrow.arrow-top-left,.color-picker .arrow.arrow-left-top{right:-21px;bottom:8px;border-width:5px 10px;border-color:rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0) #777}.color-picker .arrow.arrow-top-right,.color-picker .arrow.arrow-right-top{bottom:8px;left:-20px;border-width:5px 10px;border-color:rgba(0,0,0,0) #777 rgba(0,0,0,0) rgba(0,0,0,0)}.color-picker .arrow.arrow-left,.color-picker .arrow.arrow-left-bottom,.color-picker .arrow.arrow-bottom-left{top:8px;right:-21px;border-width:5px 10px;border-color:rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0) #777}.color-picker .arrow.arrow-right,.color-picker .arrow.arrow-right-bottom,.color-picker .arrow.arrow-bottom-right{top:8px;left:-20px;border-width:5px 10px;border-color:rgba(0,0,0,0) #777 rgba(0,0,0,0) rgba(0,0,0,0)}.color-picker .cursor{position:relative;width:16px;height:16px;border:#222 solid 2px;border-radius:50%;cursor:default}.color-picker .box{display:flex;padding:4px 8px}.color-picker .left{position:relative;padding:16px 8px}.color-picker .right{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;padding:12px 8px}.color-picker .button-area{padding:0 16px 16px;text-align:right}.color-picker .button-area button{margin-left:8px}.color-picker .preset-area{padding:4px 15px}.color-picker .preset-area .preset-label{overflow:hidden;width:100%;padding:4px;font-size:11px;white-space:nowrap;text-align:left;text-overflow:ellipsis;color:#555}.color-picker .preset-area .preset-color{position:relative;display:inline-block;width:18px;height:18px;margin:4px 6px 8px;border:#a9a9a9 solid 1px;border-radius:25%;cursor:pointer}.color-picker .preset-area .preset-empty-message{min-height:18px;margin-top:4px;margin-bottom:8px;font-style:italic;text-align:center}.color-picker .hex-text{width:100%;padding:4px 8px;font-size:11px}.color-picker .hex-text .box{padding:0 24px 8px 8px}.color-picker .hex-text .box div{float:left;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;text-align:center;color:#555;clear:left}.color-picker .hex-text .box input{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;padding:1px;border:#a9a9a9 solid 1px}.color-picker .hex-alpha .box div:first-child,.color-picker .hex-alpha .box input:first-child{flex-grow:3;margin-right:8px}.color-picker .cmyk-text,.color-picker .hsla-text,.color-picker .rgba-text,.color-picker .value-text{width:100%;padding:4px 8px;font-size:11px}.color-picker .cmyk-text .box,.color-picker .hsla-text .box,.color-picker .rgba-text .box{padding:0 24px 8px 8px}.color-picker .value-text .box{padding:0 8px 8px}.color-picker .cmyk-text .box div,.color-picker .hsla-text .box div,.color-picker .rgba-text .box div,.color-picker .value-text .box div{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;margin-right:8px;text-align:center;color:#555}.color-picker .cmyk-text .box div:last-child,.color-picker .hsla-text .box div:last-child,.color-picker .rgba-text .box div:last-child,.color-picker .value-text .box div:last-child{margin-right:0}.color-picker .cmyk-text .box input,.color-picker .hsla-text .box input,.color-picker .rgba-text .box input,.color-picker .value-text .box input{float:left;-webkit-flex:1;-ms-flex:1;flex:1;padding:1px;margin:0 8px 0 0;border:#a9a9a9 solid 1px}.color-picker .cmyk-text .box input:last-child,.color-picker .hsla-text .box input:last-child,.color-picker .rgba-text .box input:last-child,.color-picker .value-text .box input:last-child{margin-right:0}.color-picker .hue-alpha{align-items:center;margin-bottom:3px}.color-picker .hue{direction:ltr;width:100%;height:16px;margin-bottom:16px;border:none;cursor:pointer;background-size:100% 100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAAQCAYAAAD06IYnAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AIWDwkUFWbCCAAAAFxJREFUaN7t0kEKg0AQAME2x83/n2qu5qCgD1iDhCoYdpnbQC9bbY1qVO/jvc6k3ad91s7/7F1/csgPrujuQ17BDYSFsBAWwgJhISyEBcJCWAgLhIWwEBYIi2f7Ar/1TCgFH2X9AAAAAElFTkSuQmCC)}.color-picker .value{direction:rtl;width:100%;height:16px;margin-bottom:16px;border:none;cursor:pointer;background-size:100% 100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAAQCAYAAAD06IYnAAACTklEQVR42u3SYUcrABhA4U2SkmRJMmWSJklKJiWZZpKUJJskKUmaTFImKZOUzMySpGRmliRNJilJSpKSJEtmSpIpmWmSdO736/6D+x7OP3gUCoWCv1cqlSQlJZGcnExKSgqpqamkpaWRnp5ORkYGmZmZqFQqsrKyyM7OJicnh9zcXNRqNXl5eeTn56PRaCgoKKCwsJCioiK0Wi3FxcWUlJRQWlpKWVkZ5eXlVFRUUFlZiU6no6qqiurqampqaqitraWurg69Xk99fT0GgwGj0UhDQwONjY00NTXR3NxMS0sLra2ttLW10d7ejslkwmw209HRQWdnJ11dXXR3d9PT00Nvby99fX309/czMDDA4OAgFouFoaEhrFYrw8PDjIyMMDo6ytjYGDabjfHxcSYmJpicnGRqagq73c709DQzMzPMzs4yNzfH/Pw8DocDp9OJy+XC7XazsLDA4uIiS0tLLC8vs7KywurqKmtra3g8HrxeLz6fD7/fz/r6OhsbG2xubrK1tcX29jaBQICdnR2CwSC7u7vs7e2xv7/PwcEBh4eHHB0dcXx8zMnJCaenp5ydnXF+fs7FxQWXl5dcXV1xfX3Nzc0Nt7e33N3dEQqFuL+/5+HhgXA4TCQS4fHxkaenJ56fn3l5eeH19ZVoNMrb2xvv7+98fHwQi8WIx+N8fn6SSCT4+vri+/ubn58ffn9/+VcKgSWwBJbAElgCS2AJLIElsASWwBJYAktgCSyBJbAElsASWAJLYAksgSWwBJbAElgCS2AJLIElsP4/WH8AmJ5Z6jHS4h8AAAAASUVORK5CYII=)}.color-picker .alpha{direction:ltr;width:100%;height:16px;border:none;cursor:pointer;background-size:100% 100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAAQCAYAAAD06IYnAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AIWDwYQlZMa3gAAAWVJREFUaN7tmEGO6jAQRCsOArHgBpyAJYGjcGocxAm4A2IHpmoWE0eBH+ezmFlNvU06shJ3W6VEelWMUQAIIF9f6qZpimsA1LYtS2uF51/u27YVAFZVRUkEoGHdPV/sIcbIEIIkUdI/9Xa7neyv61+SWFUVAVCSct00TWn2fv6u3+Ecfd3tXzy/0+nEUu+SPjo/kqzrmiQpScN6v98XewfA8/lMkiLJ2WxGSUopcT6fM6U0NX9/frfbjev1WtfrlZfLhYfDQQHG/AIOlnGwjINlHCxjHCzjYJm/TJWdCwquJXseFFzGwDNNeiKMOJTO8xQdDQaeB29+K9efeLaBo9J7vdvtJj1RjFFjfiv7qv95tjx/7leSQgh93e1ffMeIp6O+YQjho/N791t1XVOSSI7N//K+4/GoxWLBx+PB5/Op5XLJ+/3OlJJWqxU3m83ovv5iGf8KjYNlHCxjHCzjYBkHy5gf5gusvQU7U37jTAAAAABJRU5ErkJggg==)}.color-picker .type-policy{position:absolute;top:218px;right:12px;width:16px;height:24px;background-size:8px 16px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAgCAYAAAAffCjxAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACewAAAnsB01CO3AAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIASURBVEiJ7ZY9axRRFIafsxMStrLQJpAgpBFhi+C9w1YSo00I6RZ/g9vZpBf/QOr4GyRgkSKNSrAadsZqQGwCkuAWyRZJsySwvhZ7N/vhzrgbLH3Ld8597jlzz50zJokyxXH8DqDVar0qi6v8BbItqSGpEcfxdlmsFWXkvX8AfAVWg3UKPEnT9GKujMzsAFgZsVaCN1VTQd77XUnrgE1kv+6935268WRpzrnHZvYRWC7YvC3pRZZl3wozqtVqiyH9IgjAspkd1Gq1xUJQtVrdB9ZKIAOthdg/Qc65LUk7wNIMoCVJO865rYFhkqjX6/d7vV4GPJwBMqofURS5JEk6FYBer/eeYb/Mo9WwFnPOvQbeAvfuAAK4BN4sAJtAG/gJIElmNuiJyba3EGNmZiPeZuEVmVell/Y/6N+CzDn3AXhEOOo7Hv/3BeAz8IzQkMPnJbuPx1wC+yYJ7/0nYIP5S/0FHKdp+rwCEEXRS/rf5Hl1Gtb2M0iSpCOpCZzPATmX1EySpHMLAsiy7MjMDoHrGSDXZnaYZdnRwBh7J91utwmczAA6CbG3GgPleX4jqUH/a1CktqRGnuc3hSCAMB32gKspkCtgb3KCQMmkjeP4WNJThrNNZval1WptTIsv7JtQ4tmIdRa8qSoEpWl6YWZNoAN0zKxZNPehpLSBZv2t+Q0CJ9lLnARQLAAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center}.color-picker .type-policy .type-policy-arrow{display:block;width:100%;height:50%}.color-picker .selected-color{position:absolute;top:16px;left:8px;width:40px;height:40px;border:1px solid #a9a9a9;border-radius:50%}.color-picker .selected-color-background{width:40px;height:40px;border-radius:50%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAh0lEQVRYR+2W0QlAMQgD60zdfwOdqa8TmI/wQMr5K0I5bZLIzLOa2nt37VVVbd+dDx5obgCC3KBLwJ2ff4PnVidkf+ucIhw80HQaCLo3DMH3CRK3iFsmAWVl6hPNDwt8EvNE5q+YuEXcMgkonVM6SdyCoEvAnZ8v1Hjx817MilmxSUB5rdLJDycZgUAZUch/AAAAAElFTkSuQmCC)}.color-picker .saturation-lightness{direction:ltr;width:100%;height:130px;border:none;cursor:pointer;touch-action:manipulation;background-size:100% 100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOYAAACCCAYAAABSD7T3AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AIWDwksPWR6lgAAIABJREFUeNrtnVuT47gRrAHN+P//Or/61Y5wONZ7mZ1u3XAeLMjJZGZVgdKsfc5xR3S0RIIUW+CHzCpc2McYo7XGv3ex7UiZd57rjyzzv+v+33X/R/+3r/f7vR386Y+TvKNcf/wdhTLPcv9qU2wZd74uth0t1821jkIZLPcsI/6nWa4XvutquU0Z85mnx80S/ZzgpnLnOtHNt7/ofx1TKXcSNzN/7qbMQ3ju7rNQmMYYd/4s2j9aa+P+gGaMcZrb1M/tdrvf7/d2v99P9/t93O/3cbvdxu12G9frdVwul3E+n8c///nP+2+//Xb66aefxl//+tfx5z//2YK5Al2rgvf4UsbpdGrB52bAvArXpuzjmiqAVSGz5eDmGYXzhbAZmCrnmzddpUU+8Y1dAOYeXCtDUwVwV7YCGH6uAmyMcZ9l5vkUaBPGMUZ7/J5w/792/fvv9Xq93263dr/fTxPECeME8nK5jM/Pz/HTTz/dv337dvrll1/GP/7xj/G3v/1t/OUvfwkVswongjdOp9PzH3U3D3zmWGnZVXn4jCqs7wC2BKP4/8tAzkZsoWx6XrqeHZymvp4ABCBJhTQwKfDT8gzrZCIqi5AhiACjBfEB2rP8/X63MM7f6/V6v9/v7Xa7bYC83W7jcrlsVHIq5ffv30+//fbb+OWXX8ZPP/00/v73v4+ff/75JSvbeu+bL2WMMaFbAlpBNM85QX+ct6qoSqkPAwuQlBVKqGNFSUOAA3Bmu7gC5hNOd15nSwvAOUW7C4giUCV8Sgn5L9hNFIqTsp0GxI0ysioyjAjkY/tGJVEpz+fz+OWXX+7fv38//f777+Pbt2/j119/HT///PP49ddfx8fHRwrmTjV779EXu2px2xhjwtdJZQcAWQIPLPISsMJaSwiD8gzIKrwSyATE5j5nAbR5c1dBUwBlsEWW0h6LqiYsqFPAQxCyRZ3wOSARxmlXMX5k64pQfvv27f75+dk+Pj5OHx8f4/v37+Pbt2/jt99+G9++fRsfHx/jcrmUFLO31gYDWblxRIs/TqfT7ousxJsAxXA2Gc7TA9XdgfdoHbFsj76X2+1WArgI1ageGwA3qupqoHsmcbI6Fu93quggFa9d7LeDtgKfAFHBJ+NEByIkcJ5KervdTmhhGcgJJSZ5vn//fj+fz+18Pp8+Pz/H5+fnmGD+/vvv4/v37+Pj42N8fn6O2+1Ws7JjjP6wraMI5E4RZ8x2vV5TSwkquotV7/d7Tz6HFWsD/qNcdw0CQ3q/321c686TwDVIdbuy73zNldhSHb8I2klZznm+InBS4U6n0302aBFsLhHDAKJVJVglfI9jhvu53W53sLANYNxAiDA6MCeUHx8f9+v12i6XS7tcLqcZW57P5yeY8/fz83Ocz+fnsSmYUyknWEG85WBst9stzSLyMdfr9Qi08iY15UZ0LlDGLhR3o5zK2j7OPUTD0E+nU3tk7Xb/16NFbhloAMuY1zjLUOO3BKeIDe+Z8s3/J4gFo4TM5jPmuRg28foUKKVSwo16TgA5npywcWLHgYl/Pz8/73/605/ab7/91m63W7tcLie0sZj4mao5gTyfz88E0f1+j8EcYzwTPEG2cqjyfHNF0M8fuqEiaOVnRzZZQNh5fwQyHg/HDGfJo89Q1zb/quu5XC6773I2XKfTqd/v9+d3wuqWva/YTdUdEV3fhIv/Viyps6YE3x3r43K5bJQS66zaxVGFsvd+//j4aF+/fm3fv39vt9utff36tf3+++/tdrudvn37ZuNLBaaCMgUzC+rZRiFowxUuJI8YMqcCp9Opq5vagaYU6lGJA1XQqejchw6Cj0Gw5nYBrGw01A2O206n04BGouNNyTfp/FwElhUey6nXrIKw7QQWddxuN2ldL5fL839gSPF8ahu/JvBO48CPSuqMf8Vp9/P53L58+dLu93s7n8/tfr8/39/v9/b5+TkhPJ3P56mQ436/j+/fv+/iSgbzer0+AZx/5+88bv6OMda6S5z6kd21fYC9dxv7cIJJ2d9AOS30fPMzyHiTM8B4DF6XUlYHp4KQW3W+1t77MNB1vGHxWq7Xa7vf78+y5/N5A+H1et29xuP5dbYtyaRu4AksbPq6936fjRzXRxBbPr/b+b18+fKljTHaBBBfn8/n0/1+H1++fBnn8zm0sB8fH5u4cr5GuBhMVk0EEn9RsctgVhM+ixlJtMA23R8B6yysAstBOgFXIKKCMIgToMqNEu2fYMH7ztc732dQKkCj1ytAZtY0Kx8pIr8GGJ+AT3V+2Hirhl++fBmXy2Wz73w+b17P8p+fn8/tUwGVleVkTyUb68DkfayWY4zxNRihU4EpLJPZVrK+u7J4/mgfKqeLW9X2REWlItL1diynbDDb3+jXgYjQqn0rrxWc+NkILP7F7xIbMvx7vV53x40xnlbWJF12ZSag/N0pW6t+ZzmOMzHjajKwDfond78zYTdfq18up97zr2q8v3IioBprRtBl0EZ9og5WBRGOdOHjIjXF7UotFbgOWnXzIJyzYvjG5IYgsmMOxHkz8OsMSrVNWeq5T8DaOcbEv1Od5rbs9aO7YvMet63EkF++fMExq+MRl4/L5bLZN/+ez+fnZ6KazuMqXSQVO5spJXflHAIzes/xJseckRJiDMog9d6VfRrqXMr6KpVV27jRwJacGovOAM1zMdQMnwK1AubK63kdCChvI1C7g0z9nf/D+Xze2Vj8H7Gx4P9duQlsYCrqyN8XqG3Hm/10Oj3jw/n+crlstuM+jPmmxT2dTuPz83Pzt2pn1XsEHX/bnPaVqVmh0xwOt0o6XLLAHePUU203wHfcrspCwmV3TryB5s0Mseeg97x/BwzCjBlbB+pRAPla0BVQuT6V6QHdBlj3d0KG147b+DqxQeUymDO43W4dQar+TIjwmAd0z8/h65vf0/yLv3Pb5XLpru/ydDo9s7ET0I+Pj6dKK9VUEIeKWQWPAOrJ8LKd4vE+t91Y3e7UFlWatg2VwJnb+HPmtvm/sfK59/OaWF3x/eP1UPHvA5DDYDpYXfb0drv1V2DkBkxtw/tEWVVlXWdC9pFYs5/jfh9dS/16vW7s6lTG+TfqsxSJHxkXXq/Xdr1eu4LsfD6P3vsT3N77DkL+zPm5jSdKL4zR3AxQd6rHkLkYlSowsrq7znzu6wSwdsMJOXmA5fBcjxtgMGBYHlr5zokhtsMCTgXLQOW4XC6dEyEMprL8mAQzXRgduix2yZzorxkYsDn3hB1VeMLGsXsVtgl2pW8S3svk0vw7R4hNaHvv4cACl5HFzwIH0Kc6zu4XjDPR/jpAVxWzO1Xk2DDb3vTcxeGU1iWZHkmIDWziWKvirCJ4Dravs6IJ/GG6cTqWdXDy+fArQDVVkLqkVjAoZIITdmmIqXwqa95N3+MGYoZQdRVNO53Y1xRkhO16vY7eu507Ca9lJnbGpxOemQhSw/AQsmmp5zU9BiU8G6wvX76M6/U6Pj4+do0Bz4CpgiknTUeDqwlKBmg3u4OVjrZ1A+rAcgaejWq6eJCvCYFDONSwOgHX4EQRw8lxbzDOdEK6gZ3Hk1b+8g2o1JFtKXyv/fEdTXuWjWXdAZiBp6ADeDrCFiim7B6ZFneeI7Gvm/PMkUDX67W7xI8b0D7/v8dA9qfN5oaCf74WZjH0mf1cmfY1Y0JUFmVrTWu8uzkNcLtEj7u5FXBTkfC6GOA5q8YMxO8KVvF6sAVGdcrUbsKODcQKkLMOMdmlxum642YrPm26AlhZW1YB1R+rrGswE8TaYAWeUMxdf+WjwSvZ2Ef3ytOyfn5+PpVPAaqOn43MtNBqvmjjxbjM4lZjZY4gqNMI5ktaW/sYKNwS+9lFQzGihmMCKPa7+Z0V6Eb0GRmobtpX8JljWu5FMLN5ja6hG9kwQgZqf5+1NH5UxzkFReCdWhJ8XdlGUkxO7HRlYRm4mVO43W7ter12TPJEw/rmEN3L5SKHIWZg9mz+pUoKOYq5bJTJdX2gme1UcxMZQFaEQIlHct32M+Y1BzGkGuzfiyAN9z+ugplZ1symCrDCYYkGxDTpI9RzBy0rHyeDUC1nWaeUaD9n4xkNyYMBDZtzZ3B++fJlY21XFDOcARJlabOyiS3uCpLI9jrZjCDkaVvcCCjwognKShWdzXZWlZMvVTgD8LpqlCLrqgbcB+qYwrgKYpT0ccCqbKyCValkEabn/FynogCrPKfqf51xJ7sGB2ZXcZmxoSOztjx300DZi7a0/2AIR0UlBag9SuDw6KcAzlaB7vHZvWpjK90dyrq6bKyDUZQbR0B05biLQkHIcSUmgIK+SwuqgHCnoio2RQU1yj+BnBy9pphVKLGyC7ZzFK1pxWK+E8IhVCWLN/uLtnUU4ayoYLoaANz8FdtaSvY4pV0BEW2ls61czqllBKpTyKgMAhrZ1cdc1RROtPmvWNkdcKZ7ZKxaWjiPLJMpp7OZKxA+rqG/oJLjxf0pnJlqLoDZo3gyU0mKGys2taKecj/d1C+rJSplBqlTyAqgR+D8KjKlmRL2gtUcAdCtsL+ijCNT1oqqqkH2OHEbG5sDFnUg5Aa+yLou2VU1ptj1S2ZQqv1ORZN9IWzRfgaRBxKoBE8UWyqlJFtrIc0AxNjSjed99CTY/XDfSzCz5M0IZoVEsWnPFNTsl8ooVC1TzbGgqFZNDSgVwKK+1sGDMKqxZCWGVMDysiEr1jVSQJUYwj5iHOlThdHt44SQg9CN+nl8D90NMIgAdgr46JqRiR9I8vRdFvbr17m/yxUMKjNLMiVUADwu2CWGhhi+F55TWM9M9cogzms1dnM4uOF/LAEYWdcqnM7yFmyq3IfwmOROd7Y1iFWtOjoY8To41mTV5IysgFFuRzsbWFGbNIIJCDv1dOo4lZG7jWBwRFtVTKuWyeCByJKOan8oZ3ep9XddNl0tDuaywLz9cXPYeDAA0SpkBO9sbVcTOVWldPv4uyzEkzxHtjvonHoSkFEWNoo1d8DhcQputd2ppNon4BzoAiJ1hBFQg0dVtdbGHHDQWushmNEQukLM2QO1G2Y8bgTXqFhcBJj7EjPgcPts8US8qPpPB/dXznOh5Z438tzH5ec6QgrOKrRRfKmysBmUDB+PhYabMlVPER+GCSITTzr7am2tArH3bgcEzPJm+cr5jJ4NnHNFDVrFXcI5Le9k5Jnw+bedbV+FfRzZIHaOOaOsLY0/7UGs58DjrGwKMIMFIGzOEW1/jGsdAtCN6hEAI4hBe9YXeRROBSVPAVPAqvIM5bx5hVKWAMP6zBRy3iescridVdFBinBxXDnG2GRY2XbCvp1lhvGtO9Bxu5h908XQu42lnSArMFdizMim8uwRCxPGnnOS8lwpnbOiDqTAjsrRN/PcoAScCbaACqVM40ylnjjTBs+bwWlAG23/UKbdkiwKWIQPGzWaczpoSlxPEj822cNWkpS7FyzsDrqpfgpG3jahw2vgbaSQAxuLWZYt7JzyNe8JoZpNAcvDFOdw0wqYT9AK1rZz/DdbSlLPp0ryIxgQJlK9AZlEq7IOXpohg9PIhrCng88JsOxiV4ZWAYfg4sikx/8ky2Z9l862uqwrfscIH8+ugTmVGyiddeVYUgEMn4GZzg14EwIsh9sx2cKKiWXReuOE5gzGOQgdlRKVVdlevqb279Xq0Qnsts2VDaBO0coezsruWtHApu6sKG4IBhN0aGU2kLrMKGRTN3HmbCDwKV14zvkMEDG4QfZVspVlaNU2mhc5TEZ3N1h/zqTheuLpW05ZWTGVjb3dbnNmxKZBnN8JqidaVLKAOyARNLS+MB54Z2+VaqoMLKroVBlngefnTPAcoHNWCSvlfA8CI0HEmBNBnBlXyMrzU7A7WVm94PPqQ2gmqKx+WDGsnvilmcSOBJqOK1nYyAIzuAyesq3UdSK3KfWcYKD95HmfYOU3qser2CtYEUA+FpfqdNvgPBZUBhDrGONRVlQsh8rLcaUCykHG0OOUwTlLBrsh5soEMGezi1E4HRVt1icp5wZEFXdibCkG8Y8vX75sbO4E0iom9z+hjSiOfy3DhpXItpVhE+UGQdvoWjtChmrGHf4YAzKgBNnGtuJxFCeGdhUAfQLLK8kBYAP6gvFJZajMG3Xkycy8KuC0q4Eyymwtwdxdv2M0mIBtK0LKnf640j00Auq4gUkdWGlhs22qJc6dZCsL19oxnlTJG4SYVRIGpD8TPFBuM6OElbS1pldid4mGAyN6ZIupbC5bXJN9fdpbThSxLUaI8IG1XIYBxW3Tjs6KQosKcxfxcQmdnwRGM10GnFcCy2XYunLMyAkdgk4mePiczsLygthcBut6goOqS7YVFXADLjaosB6s6ofcZWAZSIRYqSUkizYwttYab3vUOQ9w2HRxIIg8WwRVeE68xi4UtL3zRphxplzwuZrcqYCq1I3jPI5dnJIygEohMbPqVJSzrwzxBJTs5zN+ReUSgxikPQVF3JVBeNQxbHENrEMNvEdFZVV9lH9+ORGEsNZQpyTNc4C3AG7XF4ngzq+DrO2zbuaaOXgdaFcdkEotoSFBVX2qJ0C8OWZeG4KGlpghA0XfTOPCqV2qqwQ26QWfF2PMLhI2w1lVAa2aPsYd0za25MQRwgcZN6uQDCi+ZxiD4XEM2kZxOT41FnZnaRlcpZouzlRqqdbQVWopQoSB58RV50lBNrHi/AwXS5LrwDVlpY3Fc3ByiYGc52Trist6kOXdwInAQtJpp5QchyaquYOV7Su+fxVMaV3dc0RE2S6mUY0gLt2pMcYqrKIQ9w2l1gpQUMtQYcmmbt5DTNxdhnUCjQqtbK9SUSzvrC0mmhhE1e2FS2+oxypy/ZASutkmtjx3vcBC24PX65nbqkBCRhfjS9kIYPnee8cMagVOhI/3T1fAmdtAWZsCswTJCkQVNa0qWKSKPOpHAUhD9DrbVcyoYkwqhvh17vYAayXLQyKGYdxlUDFp494rBXRjYgO17DDYetNIUj/ezp6S0lnlpEwsWmJMkOwsKXeZKEAjIHn0EQJISaRBcO6UMINz7p/bEjjnw4ft+xmDvksxX4G2rIris7qaeKwAFMP2Oi7n4criuZwtpSUwpfLxSnORSrIqusc5ZFaXysqRWjiZ2DyAWEIL35tVSoQElFACjOeGGSE7AHEQgdo/LSvCOgGBvkxsmDbvlS3Fp5vhaB2TAGqRKrKKMrhLVpaGzEVjZ0OQxDhaCTA+QyRR1d15aQzrJntL3RibsipjG6jlgL4yqbS0sNYg1e84vhbBVrElK64CUcWYXDfKxhpIuxiVJZUxsbMy/uRBKTNRQ4kQ3LdRYLS0rJjRPlTPqY6gdJsEDc+aQXAn+HgsNUCbRuF0Oj0zwnA7bWDkbhO5Ens00qeQhS1laBMl5M/cAaxsLF8rKyql+Tf7ELLEGu/ixiimdCvo0TjfpjKwaggen4eh5v7LokLKbLuyvHhcZG8dhGrEDx7Hg93ZppJF7qBqO3iVveXEDQNInzeoe8Yq6ePaZBZ2JviM3W2UAGotekRCAGq4EkF1X3DOnR11yRsBL1tRa0PVcZiNFXZ2c34FskvomInQQ6lzpJoZbJxk43NwKJFBquJSsrByHydxKOnTxQASBmS3j+JMnsHSla3Ec6K9VWoJVn9zfjwOM7hqYAAqJQwE2a3nA48J2QGegRkpZNivSY+ys3EkKd4oJIwsvIHl3cWgLt5k4NH6OmtLWdpurOkwEMupYc7eMtDRhOcI2ui5JhVIzXzLyto/GAPuZoyo8wkoduVgJglCt7OhGbgID4Mq4si+63zUS1FuFFXFlqyaj2emHlLMcBqYu0FMuR28BbB7lOxRMSiCQXFhCKuwkhZ+pYDiGSgbsKKV8MiSRsuHSIWM9rklRiIlZZuqXjsQK8ooYJMgq3JKWVkhHbhsVxFUzthOWPkYijcbx54IKsSdT+uLr3crGKyoYgFiGR9iBk4kfloUX+JIlQRQqabmpgnhqtpQpb6RVQ1WH5DnrS4hEoGZqaerQ2dhFbz8XePxShmDbo70eISjoorO2vK8SJXI4SUmEU4zWKDzUDtWTYw7xXlbSTEj4FRg7zKnKoGRALv0Gs9Tgc1BpCywGZRQAtqVz2xrBcAMzEpfZwFSa2G5W0QBFjSMapWAEFa3HcGN7CxDzECyIkJ97qwrqWNTWVo876PPsjPkj2wvgroM5lLZKMETKVql/CvnWVFiFa/SzJUQwkoZsr67Y6vlSRV3/2tmNTOY3vnaxYwMuoPKqdzR1w7IqHymlPxaAThfU7Ko2ZXYj4AYJHL+kNdKwRQYESTRa5fsUZ/rVC1TMTyWVyYoqNtuzaHsMyv2tvoarxdfqwYgU1axFo/cnql1FGsqK+uAROV8BX4GU8WcZTATi2q7Qcyi0O0V+GhWBMNRUkn8H1SsWVE5By3Gi0ECqUeJoBfAtDa4amkdXG37AGP5Ggeb84p7UazpoKRzdFzeQ8HkoHGxprKy/Hpm5t12p47J6xTYDEz7uINEXSuxYXvFskYAc+ySxH9sf5ftKzU6IbwVBcUGg5e5FMCEXSErZR0wGayV19woM9guPjTqJdVTqR4uE4nJnLldWVkECCZLd2VLF+xtamex7IpiriSDUpvrpn9lrwGMCHyppMH+ps6LILsuFGUj1XEOXiqbqSHPUKnClpWV68kqtURVNDY4TNaocykoYeTU5ngGEQa/S1DnnE4AeXMcKjHPAmFVjCBENaeyLVNHfr3px8xUstJ94hIpfH4HKE/eDaArK6lSyVVFbdt1gxTIVk3pppVlFXi4pEhVBTObquohU85MLXn1iahvUkHJjSCMc01tLFveVVBx0DodM6jftCu7DOtIzYxrc0qp1JGP2ayYFz2Gb6HvMrO8cnGtV6Gjm3uImSfD2GpWK6uowbZGMxFKQCo1pOMtcMXFpRst+hXGoAomF3sSTBGgTglbBKWwsQ3tZqaYSp0Z1CimRDWFcCJUPYJ00BI5FkKYNoifuQxmN88SWVXWLMaUqqqgC0BmQJR6sk3u9NCf6jYLXxAfqsYEgVLAhRY2AtgtflZNFmFyhxdrLkAdWlk4D88M2ixHyepIdhMHrG/iR1ZGtq0MGpbDbRPYOXeSY1M6Ny4ZstvGSktK+XbFPATj2D371saPEsAMXhXrsZ0km/XStkhhMyBfsa6uXFZe2VCe+YMr1+GKgwrQyNYq1VRrB+EizAow6NsdNKcyVEkYeM73ys6q4kAHp6BiFklTkIrVC5oYV7uzwOGCz4UJ0Stq2lWMJy4wtb+RetL6tZFicnJmBw5UjCvXXMZVJX2MQkbf+XN5EWd78Vz8/JEsMZTBiKNzsm1inLRUQ74H4NidaqI68j5sAFgxcRveC7ieLJXfQYxjZZ2CsiWFewZXJmBIlZ1tdtrX4hSuateKso/RZOtOKW2nmq1oTzeK6dRWAWu2NRVb4hq0SXm1GvtugHrbr5IXqmSktg5CuDE2MSlPwsY5kNE2Wp3AqiZbWVLAxiBF+2iBZbuNj6MB6rsMLC7FyasaYDyo7KkoPyEtw3pEMXfPvxAJi2jAQQgjrz0rLIZSWZlIoNhwd5xK4AR9mYNjWAaLrnuImJeBVN9zBORObVvbr+mTTfFSEJLSRnHo7hEJoIi8MFqjxmvgmF5URZz4zLFgZZ8Ctu2X7ggVccKm9gVxIsOHqxXgNMKnFWZYnf1dBnOhayXq17QwFlWW09eNKyVJFmXqaONGA5aCegMbJ3UUkGY1ic3nKWgjq8qfVYGQG1gRt6rs62a6HiqqUOqdesK5NmX4nGofJoiE1d0dF9lVVkvT1/kEEaaCoYOwFpcVcoLM+7669PxC9rWqktH0sWUYld0VCpuBZ/stVRcGgy9WX2+U1Qthi9SzAqSxzZsy+OiFzBYnySGV6Gku44rD8BCOZBV3BvD5+AKRHNwMEsB6EzHnJpkTAeiUlEGkcECeB6GDZTp5YEJTlvdrknxYjTllMkfNtXwDjM7uVjK5JXUUn43rrqpK2jytaxHW0M5G8DC8rtHMYs7KSgduVQMGTYFqFvVS6rkD3sDJ46afdYFwoq11AOKCBLhvwoUgc8IGANycR6knZrdJPdsuxnyjfd3FovTlRMdEdtOl5CMV5EHsXQBis7TOwvIDZaGj2Vnpbh7cpK63VwYEMLwqbjzyl699sawFFkF1yqjUU31HfC6sW1ZFVFuXVXVgz9keEaw0ys1lWfm+azQAQSWA+hKYVfsZjPncAcUB9oIayy/UZXRNckDGji77GsWbvBo6tPrWPqOyVkBUq+INeqpzNdYs/u0ifh5qmpqIW+33JVSUcwY70KL4U9lYdU6ljtSls7lmfi9g3YzeQfVkaGFaV3ODCnaD2N8wsEDFklE3RzM3ZghdYkWHsszq70FIecnKkVkt8ezMzRq9bkGuKojRLBVSod3Y1yPqKgYW7JRQTPVyy5xIYLjOgxgT52RKJUY1dOrIiRd4futQx/A5AcSmEjz0vFWrkLzvbWAu9HOWbGgxFk1VNTpnBKk6TgwisI/HcxYXP1uAWO72ULFlBTq+aSu2VTUs6hrxM2CF+hEor1VIA9ZmFUaab1lSSgZsVs4sxzHlVLoJHr9H4DhONTkI1XC0/wiY2NoWAG5RlnHFnq6oLccpQddMuJ/O17JVA5OHLi0BqCztq7Y1++ucCd98qLI8MIHBV/cKjxQTme3hFBS3MyCqnDsuym2o80HjvFFTtrURmNaGJsmVahImjTsUXKtQZTAVs7Mvv8/+fzUrZAXcLJ6M4koe6XP0b6SmWWNDzyUpQ8bl+LtWx4tuqZ36cRYV3yuVxPNwvIiqiQCSmu7srgTzR6nkyhpCarXwFy1vGd5iP2cY06lFr5Njhhg1Y6+NB28ftbK83s8rf7kLJbKwDFPbLg25a0AdZJEiqr5phixKMDlRUtcssq1hriLqGoH+zeNgVm9OemjsETV8JdF0NHnkIFxWY1OB4Yrp7rtWJ7NgAAAPXklEQVQ3oNs5nplyVf8u2FoLu1JrHveaZWQjqAkshtFa2gzsSG3Zpkbvg3HafF9slPPlldjFlK80Gysm8Mr4MPhneNWENPGjAIpmilTPATdTRTXlCBYHYAQuPwA36xIpWtGN4q3Y2MhiGsUpuSSnlEJRD8PorC7CFYVw+F51qThgabxsTxWzCGY0ZSsb3lfqAy0OPNjNy8xiQQKsHYFQ2HBZVvVbBuq3m1oWKajqaonsM6uZUr6CjXWNZ0l5E3h3jURma6kP3MJIiy1Lm+kahQq41N2iZja5sjtlLYNZHZrH6qUGm4vMbDp6Rw2CFmvuyFkrBcCyMtFqBaECmsHoK9BZ2LA/lJcRqSaDqnaWbrZdGaz3DLgIvBln4woGztbyJGqslwxkhhHrTjTYFXCtOoKS8uLdofVdAbOylGU6nlYpXWZts4nXBq6WxJitMNokHUJnbnJplQm+aGpY2a5GMV2QD1hRubBPFKdumf5OHkLHz0F9luE5kjBjRa0nFE5CUGqHw32MmjZ6xkgINVnSnZ1VZStK2qKlRaLlQgK7uTq7JFXJwM+3SOEKyhZNI+tJ0I5qMYy9k2qJD7dVWdqKXa0CKNR0Ccjg+B2IYu2fcBZJZkMFgM11r0X92wilghFGgzVnexlqB7xL9mS29SiYUVY2nXOZjNBRsyDsQPRWW5hrZ4XcdC4HVWRbjgJr4sFofK5SzjQ7rhI1UebdPdEbj6sqIvTZQZ5va08rABsAW0UxeWytAk7A2KJ9ZpxzCioB24XFtYAeXYxr6anSqhLgppEqWbGwLunTgrV+IjWlL29ljaAl4EQMGsErp4apeZiquwRXLXAqOCeru32mmydc6oWTSWpFAGdzeTB8RTHVMEtlM90CbbQCYhPjq3egYr1FGdYIQjiuDGZ5zZ/AzobKGOyLxti6c4Rwtv2anyWlLICnlLhxJRXt6A5ebDBWFNONbxWZ2d02mnu4S9YECpeppV1zSWRBWxHYzVIv1CXSouwqqX3jBBBDZdYQbpTQW4ZQlS8r5kH4suSRmg2++3JN10x1PaAmEkmtYlEdeGpJEM6kOuCqCR22oSujj5IV2HdT0zj5prLKTjXFAPjdQlyq7xIBxAQP5yMczG4VxAKw0n6ilZ2QBce2pLulkuxxqnoIzFfgqyqjil9S1VNwBrFmeyeops8yOjZUybZdfS8CuaTIJumzs5tODaNtLpFDQ/PcJGweLhmeL1nB0KqiUDScsiUVD89Di3HtrKtSULw3RLiygZD+7sF8JTObgYsrGvDNUFRGl1iy0Ll1YkUc2aJYMog920I8qW6YDCg1Mqk0JHJFKXkbgbRreI+qpYNOZHrVcDUba7pjsphSJNtK6upgRNAVoOS0mugBeN4bIZgHhuPZ/s1ENaX6KsVr+YNrh1Nb7ipR0PE5zbNRegCbrHRUw6Yf07dLBJl1f8KB9as2V1nNqAsl62LBBhehwalerkHmB1JFIEZKSEusdl5JQj1nJlHXSCF342gJ9CYGrXelknJIXqVP8sD+qtplCR3XH2qfKq0ygMp+KnVkKxNlZ8m2YkIlVMiCnXUwl7qznBKSvQz3m3Pt6oQbXO5b5FixCh/fHxUQW/AEcK6zCNqKQnL9sywqmKuwvqSYzT/aPVNNpVyhvRW21aqciCsjdWvBwILUvh5VyCzbWoC1pJjJ680CWsl+udKB6T5RwG1mlohnlpbg47iz5U9ha0FGtmRLFYBtO99y97Ap0z+ZDTAog6kSLZsMHg/IFkkgp6CpvU2U0cYVSdnmkjwBdOmXbxTWNWzuIbipMioVxEckZEoahSOiy2M3K0jcC1LhVDwaqG0ZvkcWqCnrG4GIxykrqlbWdw6LQyBaZR8HmLRIhQWsHswD42ZXVLNkf9l+FlW0HVQ2lwFsC/Z1FdzlQR0KaPfo+Fdfu+/dwVRICu1CGR7AEIiAhc+AZUF0kOBaPxmUqg4i64vQnU4nFDYJ9Nz+1fVXveH9qmr+kPILx8oKcRV/BFbxbE0JMT0kSD4w6L/lNY8ocsqagVdU3A3MjxhxcGuqzsPH4irpaow1q6OyrVjvp9Npc59E91LldboYVzJWdimWfAW2SNEKcDaX2FmBLLA/uKxlmhh613Is1URQApbKfttwxL02q6Onx5pQxSbPojAg+v5hAnN6LHVRDXIsvKtRjiS0qJUyZTAXVbAK82ElFJWaQdVoqUC1Unt7BVaTQudM6SuqexjQJN4+0icaxv/utbKv83ETbT8H8gjcOKxOJmbUa6OOVXht3dFY6rHv9XoNzFLceEA1o8+pKm0LAHPHZ2rYKjFq0hfZFixsqHJgD3eD5n+U0kb1mFjXkn2lvMSSOsNE/CdIAKF0Sytq6urOHUN5gwg4GZosgbmggM5ucra2qrS2Ig1cbiBBcxYzgzUDNLCvL8GbZXNp6ORy3LmS+Kk83zRIAK6A1ioKa2I9NapIuiUFdfC9766PFZUtqUr6KbWk+zZU1a/ZrIXEztrjTOfz7hwKziCeXIaraHtbZIMz+2pGgazCmw4qWAFvEdhodYp0Xq0pV7G1YWYWbO4qhGq42+Z8BYtrLWvluNPpZAeaFFS1vubPgbgxsqcpnAaszBovKaFoDQ8BGtjfUOl4NAG2nmQV04feJgumvX2fsrQEWZghL0JnVdYkn3DOZIeRN86RqPWCmsvGVqEMRnwxQAxwS8EMYo3IzmY2+BCcLp4MKiuyuhImamlbZFcNoNl7tp+RHd18ZjQIRKyXdFRhN98/hyKqwXWNo7O1wiaXoHN108REZZWEq6grnIfjzeg8jdRf1XEL4kkXa5bBjKxoKaljBjeHlVxQ4GaycpW4lDOAKtnTxHAtOfzOtZwHAM7sqVXkV6yu6kap1nHkXKqWF/4XHqjenNKqBjpR3l1ch3Ejg1+EsgdQhsdG0B4FM9sWAVWpuAyiwTPleZxt9VyZVS2qXfReWqTAilpr9ApoWTjxymit7NwV4JTriZyOA9B0k7HFfULourmKYHVnRQvqGL5HMHdqFcR2qWpmcK6eTwx2dipWrviDilr+fKWq3OWRWdHKwA4eu8wjchbeRzFilqjjZN3ufCpfkJ0/scVpnYk6L0PI77lxdWCZ87WiWm7B/AGquQSnujGKsB8CJmiJq8q1pKIVWyqOiTK66r18BN8r74/AE71fdC3yPS2MxdOpnE1tlVxD9JmVOoggN+r4PjAXVFPa3Eg5jVJGFVUGNolH20GVrUB7BOySWq6WqYQdWR92pcFMYMwckbSgCKCqD67DiiWu1g8MQC9ByfcFqW1L+jL714qNCuznoSxt0da2gtWN1G8F0BK0NN0nuimelUF9dIdAfjO44UT3CjQLoUeLHJFTO3gmpRuIIOvwBQCbqNeo3qtZ9iF6xVK13GRlo4zqimq+CGdTiR1uRY8oqgE02hZBa79kZXPMquxRHKla2saZWN4mRqZUj0vLCKhkjKnqOQHNuSZVJoKvAqS1wpEquvWDC1B2ypwrCPsRMEPVTODMLJMDv6qeKXwi2JYV5Sq4qKyvgGsHCLiuj2jR59V8gMqSJ2FJZRXEHVRHj3sFPrct6OpqlW1GpatQdt0GvwfM6n63InsGVFhJGaBqgqqIV6IsXllZgySPq4R3bnt3wi5cv+cN2yqQLW1T95KYVsWWtKk4cB9W53WQQflQYR6Wl4HaJZjvVE0D5yvq+RKgZCs5qdBEP5sD94cAvQLlSgNaSMAtHx88BuNQ41zdFsX30zKbcs0MLD/ihkpQzl0wiTqKLTfbKmCmyYICnK0IbaieC4CG9iSyLQ7cIMGQwau6TKoq60Apl3WN40LZpca1CKKK9VQyyIEn8w0F8F6CL2h8o3ixGwC7s7EWzCOqmcApYxYD4jsAzVS0sl2t98pA7vrKophCVSonbYpgH6mvSn24pTBV4sdtV3BtMq5k82y+IADvUJ0uAlkCVTxIaPm+UNu/qkV4F1TzHXCGrXIAqItBKypqK99VtAOVs64O4ObX7pHLVCpYHcRmwvLR7TvYAKBBN58LGVzDuFz+hQbWgncQyCZAk+VbsPSouf93261iZgmfCpwRbAvqmSqriU2PwhjaoOyYqtIegVXViTsmyta6bGySpY3gyRrpIyAeaWDDxtpsXwKyalMDKNP7YBXMqEskUsi2uC8FNAPxAKTVfT1o6VzM0E0jF+1rWcUuHvdyg7vgoFplX8HpvHpMCOMRUPHzZkInsqlFKNX/EIO52E0SxSzOwob2VmRLW5D1XIU0rbgM1AzWgyC7fe8G7xUAK/taEBat7luqtyP7EmsaJQOj5F+mrnZfCuYCfBUAWwShyd6pMY/vAHG1UqOYpbI/gy5T0CMKm+UO3gFuC85dgfDVeguPDfITrIBLsLrcgdh3CFgFZjaKJ4Iv3F8ANEqvuxR1tVKOgLoCa1jxboBAkj6v7j/icFbA7f4rfRnQDLRViG13i0vqBQrYVqBbADZT0ZpiHoSzvQpopKIFS3sE1HfBWlHXd0H7LnArqvougMtljHBgZnh3Eoz/BKjLML4Z2Aq0+hEJr9jaVUBbvNzCIUiroC7AWmmFw4o5AK3MtB5VypZMSFgs05JyGVwlwBqsEGAAa2ZU1CjUexXGsE4rKriilBvFzOKKo3AuAroE6QFQU3u8YpNXwS5k+1TZt5UrwouN4KiUEw+k3ZWDp1RXHNRqXb21Ts39945yZSg3VnZFNQ9CF3XeZyr5DgBXKiwCMa2MxeTDYXgP1Fsf9QNKZc0k81RJk3r6EQ3rCmBVyLL75EjZ1pIVDHoFtiOAHoB0BdTVylqBsKKKS+AeBXJVLY+CXASuGvO/Auq7GuEjDfGKg1oKa1z/dmmi9I9SUGNhl0AtfulHAawoYrnSkmNXAVuGEhrEVXvUF+A5Ct2PqNOjDetyna4CmeUolmeXLN4Aq7C5Sj10Q7yjgl+t6CNxSRHmI5X+CpwreYB3Qfdqna4q21KdBuc4GoZsn49ZOOiVinwHqK9WzjvgeweEh2AU5+vtxZ9Cd9Wqkh49V18E5oj6vVyn0RStAyGIO5edXRKd5B0VGVXq2yr3xYp+5Ut+C4QJ4P1N339pQMjRejj4vb/Dcr6rQc3O/0rjmtZpeYCBiCHfCemRbNhbK/pNUPc3wfKy5f2D7OlL3/uPhve/oU4T0F8f+VNM2vyoiv0jK+KHQfdHq+0bncz4oz73/+Y6LbKw1o/5B7eOf1Rl/0du9B9tn/9bvrf/j+v0h6ttn2tp/r/4819y4/zv5391uvzzfwDifz6phT1MPgAAAABJRU5ErkJggg==)}.color-picker .cp-add-color-button-class{position:absolute;display:inline;padding:0;margin:3px -3px;border:0;cursor:pointer;background:transparent}.color-picker .cp-add-color-button-class:hover{text-decoration:underline}.color-picker .cp-add-color-button-class:disabled{cursor:not-allowed;color:#999}.color-picker .cp-add-color-button-class:disabled:hover{text-decoration:none}.color-picker .cp-remove-color-button-class{position:absolute;top:-5px;right:-5px;display:block;width:10px;height:10px;border-radius:50%;cursor:pointer;text-align:center;background:#fff;box-shadow:1px 1px 5px #333}.color-picker .cp-remove-color-button-class:before{content:"x";position:relative;bottom:3.5px;display:inline-block;font-size:10px}.color-picker .eyedropper-icon{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);fill:#fff;mix-blend-mode:exclusion}
`],encapsulation:2})}return e})(),Boe=!1,R8=(()=>{class e{injector;cfr;appRef;vcRef;elRef;_service;dialog;dialogCreated=!1;ignoreChanges=!1;cmpRef;viewAttachedToAppRef=!1;colorPicker;cpWidth="230px";cpHeight="auto";cpToggle=!1;cpDisabled=!1;cpIgnoredElements=[];cpFallbackColor="";cpColorMode="color";cpCmykEnabled=!1;cpOutputFormat="auto";cpAlphaChannel="enabled";cpDisableInput=!1;cpDialogDisplay="popup";cpSaveClickOutside=!0;cpCloseClickOutside=!0;cpUseRootViewContainer=!1;cpPosition="auto";cpPositionOffset="0%";cpPositionRelativeToArrow=!1;cpOKButton=!1;cpOKButtonText="OK";cpOKButtonClass="cp-ok-button-class";cpCancelButton=!1;cpCancelButtonText="Cancel";cpCancelButtonClass="cp-cancel-button-class";cpEyeDropper=!1;cpPresetLabel="Preset colors";cpPresetColors;cpPresetColorsClass="cp-preset-colors-class";cpMaxPresetColorsLength=6;cpPresetEmptyMessage="No colors added";cpPresetEmptyMessageClass="preset-empty-message";cpAddColorButton=!1;cpAddColorButtonText="Add color";cpAddColorButtonClass="cp-add-color-button-class";cpRemoveColorButtonClass="cp-remove-color-button-class";cpArrowPosition=0;cpExtraTemplate;cpInputChange=new Pe(!0);cpToggleChange=new Pe(!0);cpSliderChange=new Pe(!0);cpSliderDragEnd=new Pe(!0);cpSliderDragStart=new Pe(!0);colorPickerOpen=new Pe(!0);colorPickerClose=new Pe(!0);colorPickerCancel=new Pe(!0);colorPickerSelect=new Pe(!0);colorPickerChange=new Pe(!1);cpCmykColorChange=new Pe(!0);cpPresetColorsChange=new Pe(!0);handleClick(){this.inputFocus()}handleFocus(){this.inputFocus()}handleInput(i){this.inputChange(i)}constructor(i,r,n,a,o,s){this.injector=i,this.cfr=r,this.appRef=n,this.vcRef=a,this.elRef=o,this._service=s}ngOnDestroy(){this.cmpRef!=null&&(this.viewAttachedToAppRef&&this.appRef.detachView(this.cmpRef.hostView),this.cmpRef.destroy(),this.cmpRef=null,this.dialog=null)}ngOnChanges(i){i.cpToggle&&!this.cpDisabled&&(i.cpToggle.currentValue?this.openDialog():i.cpToggle.currentValue||this.closeDialog()),i.colorPicker&&(this.dialog&&!this.ignoreChanges&&(this.cpDialogDisplay==="inline"&&this.dialog.setInitialColor(i.colorPicker.currentValue),this.dialog.setColorFromString(i.colorPicker.currentValue,!1),this.cpUseRootViewContainer&&this.cpDialogDisplay!=="inline"&&this.cmpRef.changeDetectorRef.detectChanges()),this.ignoreChanges=!1),(i.cpPresetLabel||i.cpPresetColors)&&this.dialog&&this.dialog.setPresetConfig(this.cpPresetLabel,this.cpPresetColors)}openDialog(){if(this.dialogCreated)this.dialog&&(this.cmpRef.instance.cpAlphaChannel=this.cpAlphaChannel,this.dialog.openDialog(this.colorPicker));else{let i=this.vcRef;if(this.dialogCreated=!0,this.viewAttachedToAppRef=!1,this.cpUseRootViewContainer&&this.cpDialogDisplay!=="inline"){let n=this.appRef.componentTypes[0],a=this.injector.get(n,Ea.NULL);a!==Ea.NULL?(i=a.vcRef||a.viewContainerRef||this.vcRef,Boe&&i===this.vcRef&&console.warn("You are using cpUseRootViewContainer, but the root component is not exposing viewContainerRef!Please expose it by adding 'public vcRef: ViewContainerRef' to the constructor.")):this.viewAttachedToAppRef=!0}let r=this.cfr.resolveComponentFactory(Loe);if(this.viewAttachedToAppRef)this.cmpRef=r.create(this.injector),this.appRef.attachView(this.cmpRef.hostView),document.body.appendChild(this.cmpRef.hostView.rootNodes[0]);else{let n=Ea.create({providers:[],parent:i.injector});this.cmpRef=i.createComponent(r,0,n,[])}this.cmpRef.instance.setupDialog(this,this.elRef,this.colorPicker,this.cpWidth,this.cpHeight,this.cpDialogDisplay,this.cpFallbackColor,this.cpColorMode,this.cpCmykEnabled,this.cpAlphaChannel,this.cpOutputFormat,this.cpDisableInput,this.cpIgnoredElements,this.cpSaveClickOutside,this.cpCloseClickOutside,this.cpUseRootViewContainer,this.cpPosition,this.cpPositionOffset,this.cpPositionRelativeToArrow,this.cpPresetLabel,this.cpPresetColors,this.cpPresetColorsClass,this.cpMaxPresetColorsLength,this.cpPresetEmptyMessage,this.cpPresetEmptyMessageClass,this.cpOKButton,this.cpOKButtonClass,this.cpOKButtonText,this.cpCancelButton,this.cpCancelButtonClass,this.cpCancelButtonText,this.cpAddColorButton,this.cpAddColorButtonClass,this.cpAddColorButtonText,this.cpRemoveColorButtonClass,this.cpEyeDropper,this.elRef,this.cpExtraTemplate),this.dialog=this.cmpRef.instance,this.vcRef!==i&&this.cmpRef.changeDetectorRef.detectChanges()}}closeDialog(){this.dialog&&this.cpDialogDisplay==="popup"&&this.dialog.closeDialog()}cmykChanged(i){this.cpCmykColorChange.emit(i)}stateChanged(i){this.cpToggleChange.emit(i),i?this.colorPickerOpen.emit(this.colorPicker):this.colorPickerClose.emit(this.colorPicker)}colorChanged(i,r=!0){this.ignoreChanges=r,this.colorPickerChange.emit(i)}colorSelected(i){this.colorPickerSelect.emit(i)}colorCanceled(){this.colorPickerCancel.emit()}inputFocus(){let i=this.elRef.nativeElement,r=this.cpIgnoredElements.filter(n=>n===i);!this.cpDisabled&&!r.length&&(typeof document<"u"&&i===document.activeElement?this.openDialog():!this.dialog||!this.dialog.show?this.openDialog():this.closeDialog())}inputChange(i){this.dialog?this.dialog.setColorFromString(i.target.value,!0):(this.colorPicker=i.target.value,this.colorPickerChange.emit(this.colorPicker))}inputChanged(i){this.cpInputChange.emit(i)}sliderChanged(i){this.cpSliderChange.emit(i)}sliderDragEnd(i){this.cpSliderDragEnd.emit(i)}sliderDragStart(i){this.cpSliderDragStart.emit(i)}presetColorsChanged(i){this.cpPresetColorsChange.emit(i)}static \u0275fac=function(r){return new(r||e)(z(Ea),z(ch),z(Sd),z(as),z(nt),z(P8))};static \u0275dir=lt({type:e,selectors:[["","colorPicker",""]],hostBindings:function(r,n){r&1&&q("click",function(){return n.handleClick()})("focus",function(){return n.handleFocus()})("input",function(o){return n.handleInput(o)})},inputs:{colorPicker:"colorPicker",cpWidth:"cpWidth",cpHeight:"cpHeight",cpToggle:"cpToggle",cpDisabled:"cpDisabled",cpIgnoredElements:"cpIgnoredElements",cpFallbackColor:"cpFallbackColor",cpColorMode:"cpColorMode",cpCmykEnabled:"cpCmykEnabled",cpOutputFormat:"cpOutputFormat",cpAlphaChannel:"cpAlphaChannel",cpDisableInput:"cpDisableInput",cpDialogDisplay:"cpDialogDisplay",cpSaveClickOutside:"cpSaveClickOutside",cpCloseClickOutside:"cpCloseClickOutside",cpUseRootViewContainer:"cpUseRootViewContainer",cpPosition:"cpPosition",cpPositionOffset:"cpPositionOffset",cpPositionRelativeToArrow:"cpPositionRelativeToArrow",cpOKButton:"cpOKButton",cpOKButtonText:"cpOKButtonText",cpOKButtonClass:"cpOKButtonClass",cpCancelButton:"cpCancelButton",cpCancelButtonText:"cpCancelButtonText",cpCancelButtonClass:"cpCancelButtonClass",cpEyeDropper:"cpEyeDropper",cpPresetLabel:"cpPresetLabel",cpPresetColors:"cpPresetColors",cpPresetColorsClass:"cpPresetColorsClass",cpMaxPresetColorsLength:"cpMaxPresetColorsLength",cpPresetEmptyMessage:"cpPresetEmptyMessage",cpPresetEmptyMessageClass:"cpPresetEmptyMessageClass",cpAddColorButton:"cpAddColorButton",cpAddColorButtonText:"cpAddColorButtonText",cpAddColorButtonClass:"cpAddColorButtonClass",cpRemoveColorButtonClass:"cpRemoveColorButtonClass",cpArrowPosition:"cpArrowPosition",cpExtraTemplate:"cpExtraTemplate"},outputs:{cpInputChange:"cpInputChange",cpToggleChange:"cpToggleChange",cpSliderChange:"cpSliderChange",cpSliderDragEnd:"cpSliderDragEnd",cpSliderDragStart:"cpSliderDragStart",colorPickerOpen:"colorPickerOpen",colorPickerClose:"colorPickerClose",colorPickerCancel:"colorPickerCancel",colorPickerSelect:"colorPickerSelect",colorPickerChange:"colorPickerChange",cpCmykColorChange:"cpCmykColorChange",cpPresetColorsChange:"cpPresetColorsChange"},exportAs:["ngxColorPicker"],features:[ir]})}return e})(),F8=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=je({type:e});static \u0275inj=Ge({imports:[On]})}return e})();function O8(e,t,i,r,n){var a=i-e,o=r-t,s=1;a<0&&(s=-1,a=-a);var l=2*a-o,c=e;for(let d=t;d<r;d++)n.push({x:c,y:d}),l>0?(c=c+s,l=l+2*(a-o)):l=l+2*a}function L8(e,t,i,r,n){var a=i-e,o=r-t,s=1;o<0&&(s=-1,o=-o);var l=2*o-a,c=t;for(let d=e;d<i;d++)n.push({x:d,y:c}),l>0?(c=c+s,l=l+2*(o-a)):l=l+2*o}function B8(e,t){let i=new Array;var r=Math.round(e.x),n=Math.round(e.y),a=Math.round(t.x),o=Math.round(t.y);return Math.abs(o-n)<Math.abs(a-r)?r>a?L8(a,o,r,n,i):L8(r,n,a,o,i):n>o?O8(a,o,r,n,i):O8(r,n,a,o,i),i}var Uoe=["switch"],Hoe=["*"];function Goe(e,t){e&1&&(S(0,"div",10),Ca(),S(1,"svg",12),ae(2,"path",13),A(),S(3,"svg",14),ae(4,"path",15),A()())}var joe=new Be("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1,hideIcon:!1})}),Woe={provide:$s,useExisting:Jn(()=>op),multi:!0},Ny=class{constructor(t,i){this.source=t,this.checked=i}},qoe=0,op=(()=>{class e{_createChangeEvent(i){return new Ny(this,i)}get buttonId(){return`${this.id||this._uniqueId}-button`}focus(){this._switchElement.nativeElement.focus()}get checked(){return this._checked}set checked(i){this._checked=i,this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(i,r,n,a,o,s){this._elementRef=i,this._focusMonitor=r,this._changeDetectorRef=n,this.defaults=o,this._onChange=l=>{},this._onTouched=()=>{},this._validatorOnChange=()=>{},this._checked=!1,this.name=null,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.disabled=!1,this.disableRipple=!1,this.tabIndex=0,this.change=new Pe,this.toggleChange=new Pe,this.tabIndex=parseInt(a)||0,this.color=o.color||"accent",this._noopAnimations=s==="NoopAnimations",this.id=this._uniqueId=`mat-mdc-slide-toggle-${++qoe}`,this.hideIcon=o.hideIcon??!1,this._labelId=this._uniqueId+"-label"}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(i=>{i==="keyboard"||i==="program"?(this._focused=!0,this._changeDetectorRef.markForCheck()):i||Promise.resolve().then(()=>{this._focused=!1,this._onTouched(),this._changeDetectorRef.markForCheck()})})}ngOnChanges(i){i.required&&this._validatorOnChange()}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}writeValue(i){this.checked=!!i}registerOnChange(i){this._onChange=i}registerOnTouched(i){this._onTouched=i}validate(i){return this.required&&i.value!==!0?{required:!0}:null}registerOnValidatorChange(i){this._validatorOnChange=i}setDisabledState(i){this.disabled=i,this._changeDetectorRef.markForCheck()}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(this._createChangeEvent(this.checked))}_handleClick(){this.toggleChange.emit(),this.defaults.disableToggleValue||(this.checked=!this.checked,this._onChange(this.checked),this.change.emit(new Ny(this,this.checked)))}_getAriaLabelledBy(){return this.ariaLabelledby?this.ariaLabelledby:this.ariaLabel?null:this._labelId}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(Ks),z(Vt),ea("tabindex"),z(joe),z(zi,8))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-slide-toggle"]],viewQuery:function(r,n){if(r&1&&tt(Uoe,5),r&2){let a;Me(a=Ie())&&(n._switchElement=a.first)}},hostAttrs:[1,"mat-mdc-slide-toggle"],hostVars:13,hostBindings:function(r,n){r&2&&(Cs("id",n.id),Ft("tabindex",null)("aria-label",null)("name",null)("aria-labelledby",null),yr(n.color?"mat-"+n.color:""),ft("mat-mdc-slide-toggle-focused",n._focused)("mat-mdc-slide-toggle-checked",n.checked)("_mat-animation-noopable",n._noopAnimations))},inputs:{name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:[de.None,"aria-label","ariaLabel"],ariaLabelledby:[de.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[de.None,"aria-describedby","ariaDescribedby"],required:[de.HasDecoratorInputTransform,"required","required",ot],color:"color",disabled:[de.HasDecoratorInputTransform,"disabled","disabled",ot],disableRipple:[de.HasDecoratorInputTransform,"disableRipple","disableRipple",ot],tabIndex:[de.HasDecoratorInputTransform,"tabIndex","tabIndex",i=>i==null?0:Dr(i)],checked:[de.HasDecoratorInputTransform,"checked","checked",ot],hideIcon:[de.HasDecoratorInputTransform,"hideIcon","hideIcon",ot]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],standalone:!0,features:[_i([Woe,{provide:Ru,useExisting:e,multi:!0}]),wi,ir,Xt],ngContentSelectors:Hoe,decls:13,vars:24,consts:[["switch",""],["mat-internal-form-field","",3,"labelPosition"],["role","switch","type","button",1,"mdc-switch",3,"click","tabIndex","disabled"],[1,"mdc-switch__track"],[1,"mdc-switch__handle-track"],[1,"mdc-switch__handle"],[1,"mdc-switch__shadow"],[1,"mdc-elevation-overlay"],[1,"mdc-switch__ripple"],["mat-ripple","",1,"mat-mdc-slide-toggle-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-switch__icons"],[1,"mdc-label",3,"click","for"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--on"],["d","M19.69,5.23L8.96,15.96l-4.23-4.23L2.96,13.5l6,6L21.46,7L19.69,5.23z"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--off"],["d","M20 13H4v-2h16v2z"]],template:function(r,n){if(r&1){let a=Ue();ti(),S(0,"div",1)(1,"button",2,0),q("click",function(){return j(a),W(n._handleClick())}),ae(3,"div",3),S(4,"div",4)(5,"div",5)(6,"div",6),ae(7,"div",7),A(),S(8,"div",8),ae(9,"div",9),A(),Te(10,Goe,5,0,"div",10),A()()(),S(11,"label",11),q("click",function(s){return j(a),W(s.stopPropagation())}),it(12),A()()}if(r&2){let a=kt(2);O("labelPosition",n.labelPosition),P(),ft("mdc-switch--selected",n.checked)("mdc-switch--unselected",!n.checked)("mdc-switch--checked",n.checked)("mdc-switch--disabled",n.disabled),O("tabIndex",n.disabled?-1:n.tabIndex)("disabled",n.disabled),Ft("id",n.buttonId)("name",n.name)("aria-label",n.ariaLabel)("aria-labelledby",n._getAriaLabelledBy())("aria-describedby",n.ariaDescribedby)("aria-required",n.required||null)("aria-checked",n.checked),P(8),O("matRippleTrigger",a)("matRippleDisabled",n.disableRipple||n.disabled)("matRippleCentered",!0),P(),fi(10,n.hideIcon?-1:10),P(),O("for",n.buttonId),Ft("id",n._labelId)}},dependencies:[Zo,_y],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1);background-color:var(--mdc-elevation-overlay-color)}.mdc-switch{align-items:center;background:none;border:none;cursor:pointer;display:inline-flex;flex-shrink:0;margin:0;outline:none;overflow:visible;padding:0;position:relative}.mdc-switch[hidden]{display:none}.mdc-switch:disabled{cursor:default;pointer-events:none}.mdc-switch__track{overflow:hidden;position:relative;width:100%}.mdc-switch__track::before,.mdc-switch__track::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";height:100%;left:0;position:absolute;width:100%}@media screen and (forced-colors: active){.mdc-switch__track::before,.mdc-switch__track::after{border-color:currentColor}}.mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0)}.mdc-switch__track::after{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(-100%)}[dir=rtl] .mdc-switch__track::after,.mdc-switch__track[dir=rtl]::after{transform:translateX(100%)}.mdc-switch--selected .mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__track::before,.mdc-switch--selected .mdc-switch__track[dir=rtl]::before{transform:translateX(-100%)}.mdc-switch--selected .mdc-switch__track::after{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0)}.mdc-switch__handle-track{height:100%;pointer-events:none;position:absolute;top:0;transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);left:0;right:auto;transform:translateX(0)}[dir=rtl] .mdc-switch__handle-track,.mdc-switch__handle-track[dir=rtl]{left:auto;right:0}.mdc-switch--selected .mdc-switch__handle-track{transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__handle-track,.mdc-switch--selected .mdc-switch__handle-track[dir=rtl]{transform:translateX(-100%)}.mdc-switch__handle{display:flex;pointer-events:auto;position:absolute;top:50%;transform:translateY(-50%);left:0;right:auto}[dir=rtl] .mdc-switch__handle,.mdc-switch__handle[dir=rtl]{left:auto;right:0}.mdc-switch__handle::before,.mdc-switch__handle::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";width:100%;height:100%;left:0;position:absolute;top:0;transition:background-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1),border-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);z-index:-1}@media screen and (forced-colors: active){.mdc-switch__handle::before,.mdc-switch__handle::after{border-color:currentColor}}.mdc-switch__shadow{border-radius:inherit;bottom:0;left:0;position:absolute;right:0;top:0}.mdc-elevation-overlay{bottom:0;left:0;right:0;top:0}.mdc-switch__ripple{left:50%;position:absolute;top:50%;transform:translate(-50%, -50%);z-index:-1}.mdc-switch:disabled .mdc-switch__ripple{display:none}.mdc-switch__icons{height:100%;position:relative;width:100%;z-index:1}.mdc-switch__icon{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;opacity:0;transition:opacity 30ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-switch--selected .mdc-switch__icon--on,.mdc-switch--unselected .mdc-switch__icon--off{opacity:1;transition:opacity 45ms 30ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle .mdc-switch--disabled+label{color:var(--mdc-switch-disabled-label-text-color)}.mdc-switch{width:var(--mdc-switch-track-width)}.mdc-switch.mdc-switch--selected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-selected-handle-color)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-hover-handle-color)}.mdc-switch.mdc-switch--selected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-focus-handle-color)}.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-selected-pressed-handle-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-selected-handle-color)}.mdc-switch.mdc-switch--unselected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-unselected-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-hover-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-focus-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-unselected-pressed-handle-color)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-unselected-handle-color)}.mdc-switch .mdc-switch__handle::before{background:var(--mdc-switch-handle-surface-color)}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation)}.mdc-switch:disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation)}.mdc-switch .mdc-switch__focus-ring-wrapper,.mdc-switch .mdc-switch__handle{height:var(--mdc-switch-handle-height)}.mdc-switch .mdc-switch__handle{border-radius:var(--mdc-switch-handle-shape)}.mdc-switch .mdc-switch__handle{width:var(--mdc-switch-handle-width)}.mdc-switch .mdc-switch__handle-track{width:calc(100% - var(--mdc-switch-handle-width))}.mdc-switch.mdc-switch--selected:enabled .mdc-switch__icon{fill:var(--mdc-switch-selected-icon-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-selected-icon-color)}.mdc-switch.mdc-switch--unselected:enabled .mdc-switch__icon{fill:var(--mdc-switch-unselected-icon-color)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-unselected-icon-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icons{opacity:var(--mdc-switch-disabled-selected-icon-opacity)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icons{opacity:var(--mdc-switch-disabled-unselected-icon-opacity)}.mdc-switch.mdc-switch--selected .mdc-switch__icon{width:var(--mdc-switch-selected-icon-size);height:var(--mdc-switch-selected-icon-size)}.mdc-switch.mdc-switch--unselected .mdc-switch__icon{width:var(--mdc-switch-unselected-icon-size);height:var(--mdc-switch-unselected-icon-size)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-hover-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:focus .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:focus .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-focus-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-pressed-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-hover-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-focus-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-pressed-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus):hover .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus).mdc-ripple-surface--hover .mdc-switch__ripple::before{opacity:var(--mdc-switch-selected-hover-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:focus.mdc-ripple-upgraded--background-focused .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:focus:not(.mdc-ripple-upgraded):focus .mdc-switch__ripple::before{transition-duration:75ms;opacity:var(--mdc-switch-selected-focus-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:active:not(.mdc-ripple-upgraded) .mdc-switch__ripple::after{transition:opacity 150ms linear}.mdc-switch.mdc-switch--selected:enabled:active:not(.mdc-ripple-upgraded):active .mdc-switch__ripple::after{transition-duration:75ms;opacity:var(--mdc-switch-selected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:active.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-switch-selected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus):hover .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus).mdc-ripple-surface--hover .mdc-switch__ripple::before{opacity:var(--mdc-switch-unselected-hover-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:focus.mdc-ripple-upgraded--background-focused .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:focus:not(.mdc-ripple-upgraded):focus .mdc-switch__ripple::before{transition-duration:75ms;opacity:var(--mdc-switch-unselected-focus-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:active:not(.mdc-ripple-upgraded) .mdc-switch__ripple::after{transition:opacity 150ms linear}.mdc-switch.mdc-switch--unselected:enabled:active:not(.mdc-ripple-upgraded):active .mdc-switch__ripple::after{transition-duration:75ms;opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:active.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity)}.mdc-switch .mdc-switch__ripple{height:var(--mdc-switch-state-layer-size);width:var(--mdc-switch-state-layer-size)}.mdc-switch .mdc-switch__track{height:var(--mdc-switch-track-height)}.mdc-switch:disabled .mdc-switch__track{opacity:var(--mdc-switch-disabled-track-opacity)}.mdc-switch:enabled .mdc-switch__track::after{background:var(--mdc-switch-selected-track-color)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-hover-track-color)}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-focus-track-color)}.mdc-switch:enabled:active .mdc-switch__track::after{background:var(--mdc-switch-selected-pressed-track-color)}.mdc-switch:disabled .mdc-switch__track::after{background:var(--mdc-switch-disabled-selected-track-color)}.mdc-switch:enabled .mdc-switch__track::before{background:var(--mdc-switch-unselected-track-color)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-hover-track-color)}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-focus-track-color)}.mdc-switch:enabled:active .mdc-switch__track::before{background:var(--mdc-switch-unselected-pressed-track-color)}.mdc-switch:disabled .mdc-switch__track::before{background:var(--mdc-switch-disabled-unselected-track-color)}.mdc-switch .mdc-switch__track{border-radius:var(--mdc-switch-track-shape)}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation-shadow)}.mdc-switch:disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation-shadow)}.mat-mdc-slide-toggle{display:inline-block;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple,.mat-mdc-slide-toggle .mdc-switch__ripple::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple:not(:empty),.mat-mdc-slide-toggle .mdc-switch__ripple::after:not(:empty){transform:translateZ(0)}.mat-mdc-slide-toggle .mdc-switch__ripple::after{content:"";opacity:0}.mat-mdc-slide-toggle .mdc-switch:hover .mdc-switch__ripple::after{opacity:.04;transition:opacity 75ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mdc-switch .mdc-switch__ripple::after{opacity:.12}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mat-mdc-focus-indicator::before{content:""}.mat-mdc-slide-toggle .mat-ripple-element{opacity:.12}.mat-mdc-slide-toggle .mat-mdc-focus-indicator::before{border-radius:50%}.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle-track,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-elevation-overlay,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__icon,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::after,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::after{transition:none}.mat-mdc-slide-toggle .mdc-switch:enabled+.mdc-label{cursor:pointer}.mdc-switch__handle{transition:width 75ms cubic-bezier(0.4, 0, 0.2, 1),height 75ms cubic-bezier(0.4, 0, 0.2, 1),margin 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-switch--selected .mdc-switch__track::before{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mdc-switch--selected .mdc-switch__track::after{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch--unselected .mdc-switch__track::before{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch--unselected .mdc-switch__track::after{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{width:var(--mat-switch-unselected-handle-size);height:var(--mat-switch-unselected-handle-size)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{width:var(--mat-switch-selected-handle-size);height:var(--mat-switch-selected-handle-size)}.mat-mdc-slide-toggle .mdc-switch__handle:has(.mdc-switch__icons){width:var(--mat-switch-with-icon-handle-size);height:var(--mat-switch-with-icon-handle-size)}.mat-mdc-slide-toggle:active .mdc-switch:not(.mdc-switch--disabled) .mdc-switch__handle{width:var(--mat-switch-pressed-handle-size);height:var(--mat-switch-pressed-handle-size)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{margin:var(--mat-switch-selected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-selected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{margin:var(--mat-switch-unselected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-unselected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle:active .mdc-switch--selected:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-selected-pressed-handle-horizontal-margin)}.mat-mdc-slide-toggle:active .mdc-switch--unselected:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-unselected-pressed-handle-horizontal-margin)}.mdc-switch__track::after,.mdc-switch__track::before{border-width:var(--mat-switch-track-outline-width);border-color:var(--mat-switch-track-outline-color)}.mdc-switch--selected .mdc-switch__track::after,.mdc-switch--selected .mdc-switch__track::before{border-width:var(--mat-switch-selected-track-outline-width)}.mdc-switch--disabled .mdc-switch__track::after,.mdc-switch--disabled .mdc-switch__track::before{border-width:var(--mat-switch-disabled-unselected-track-outline-width);border-color:var(--mat-switch-disabled-unselected-track-outline-color)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-selected-handle-opacity)}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-unselected-handle-opacity)}'],encapsulation:2,changeDetection:0})}}return e})();var V8=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[op,Et,Et]})}}return e})();var $oe=["*"],Py;function Xoe(){if(Py===void 0&&(Py=null,typeof window<"u")){let e=window;e.trustedTypes!==void 0&&(Py=e.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return Py}function gv(e){return Xoe()?.createHTML(e)||e}function U8(e){return Error(`Unable to find icon with the name "${e}"`)}function Yoe(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}function H8(e){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${e}".`)}function G8(e){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${e}".`)}var ql=class{constructor(t,i,r){this.url=t,this.svgText=i,this.options=r}},Zoe=(()=>{class e{constructor(i,r,n,a){this._httpClient=i,this._sanitizer=r,this._errorHandler=a,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=n}addSvgIcon(i,r,n){return this.addSvgIconInNamespace("",i,r,n)}addSvgIconLiteral(i,r,n){return this.addSvgIconLiteralInNamespace("",i,r,n)}addSvgIconInNamespace(i,r,n,a){return this._addSvgIconConfig(i,r,new ql(n,null,a))}addSvgIconResolver(i){return this._resolvers.push(i),this}addSvgIconLiteralInNamespace(i,r,n,a){let o=this._sanitizer.sanitize(Ka.HTML,n);if(!o)throw G8(n);let s=gv(o);return this._addSvgIconConfig(i,r,new ql("",s,a))}addSvgIconSet(i,r){return this.addSvgIconSetInNamespace("",i,r)}addSvgIconSetLiteral(i,r){return this.addSvgIconSetLiteralInNamespace("",i,r)}addSvgIconSetInNamespace(i,r,n){return this._addSvgIconSetConfig(i,new ql(r,null,n))}addSvgIconSetLiteralInNamespace(i,r,n){let a=this._sanitizer.sanitize(Ka.HTML,r);if(!a)throw G8(r);let o=gv(a);return this._addSvgIconSetConfig(i,new ql("",o,n))}registerFontClassAlias(i,r=i){return this._fontCssClassesByAlias.set(i,r),this}classNameForFontAlias(i){return this._fontCssClassesByAlias.get(i)||i}setDefaultFontSetClass(...i){return this._defaultFontSetClass=i,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(i){let r=this._sanitizer.sanitize(Ka.RESOURCE_URL,i);if(!r)throw H8(i);let n=this._cachedIconsByUrl.get(r);return n?pt(Ry(n)):this._loadSvgIconFromConfig(new ql(i,null)).pipe(Tr(a=>this._cachedIconsByUrl.set(r,a)),Rt(a=>Ry(a)))}getNamedSvgIcon(i,r=""){let n=j8(r,i),a=this._svgIconConfigs.get(n);if(a)return this._getSvgFromConfig(a);if(a=this._getIconConfigFromResolvers(r,i),a)return this._svgIconConfigs.set(n,a),this._getSvgFromConfig(a);let o=this._iconSetConfigs.get(r);return o?this._getSvgFromIconSetConfigs(i,o):vd(U8(n))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(i){return i.svgText?pt(Ry(this._svgElementFromConfig(i))):this._loadSvgIconFromConfig(i).pipe(Rt(r=>Ry(r)))}_getSvgFromIconSetConfigs(i,r){let n=this._extractIconWithNameFromAnySet(i,r);if(n)return pt(n);let a=r.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(ec(s=>{let c=`Loading icon set URL: ${this._sanitizer.sanitize(Ka.RESOURCE_URL,o.url)} failed: ${s.message}`;return this._errorHandler.handleError(new Error(c)),pt(null)})));return Gv(a).pipe(Rt(()=>{let o=this._extractIconWithNameFromAnySet(i,r);if(!o)throw U8(i);return o}))}_extractIconWithNameFromAnySet(i,r){for(let n=r.length-1;n>=0;n--){let a=r[n];if(a.svgText&&a.svgText.toString().indexOf(i)>-1){let o=this._svgElementFromConfig(a),s=this._extractSvgIconFromSet(o,i,a.options);if(s)return s}}return null}_loadSvgIconFromConfig(i){return this._fetchIcon(i).pipe(Tr(r=>i.svgText=r),Rt(()=>this._svgElementFromConfig(i)))}_loadSvgIconSetFromConfig(i){return i.svgText?pt(null):this._fetchIcon(i).pipe(Tr(r=>i.svgText=r))}_extractSvgIconFromSet(i,r,n){let a=i.querySelector(`[id="${r}"]`);if(!a)return null;let o=a.cloneNode(!0);if(o.removeAttribute("id"),o.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(o,n);if(o.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(o),n);let s=this._svgElementFromString(gv("<svg></svg>"));return s.appendChild(o),this._setSvgAttributes(s,n)}_svgElementFromString(i){let r=this._document.createElement("DIV");r.innerHTML=i;let n=r.querySelector("svg");if(!n)throw Error("<svg> tag not found");return n}_toSvgElement(i){let r=this._svgElementFromString(gv("<svg></svg>")),n=i.attributes;for(let a=0;a<n.length;a++){let{name:o,value:s}=n[a];o!=="id"&&r.setAttribute(o,s)}for(let a=0;a<i.childNodes.length;a++)i.childNodes[a].nodeType===this._document.ELEMENT_NODE&&r.appendChild(i.childNodes[a].cloneNode(!0));return r}_setSvgAttributes(i,r){return i.setAttribute("fit",""),i.setAttribute("height","100%"),i.setAttribute("width","100%"),i.setAttribute("preserveAspectRatio","xMidYMid meet"),i.setAttribute("focusable","false"),r&&r.viewBox&&i.setAttribute("viewBox",r.viewBox),i}_fetchIcon(i){let{url:r,options:n}=i,a=n?.withCredentials??!1;if(!this._httpClient)throw Yoe();if(r==null)throw Error(`Cannot fetch icon from URL "${r}".`);let o=this._sanitizer.sanitize(Ka.RESOURCE_URL,r);if(!o)throw H8(r);let s=this._inProgressUrlFetches.get(o);if(s)return s;let l=this._httpClient.get(o,{responseType:"text",withCredentials:a}).pipe(Rt(c=>gv(c)),bd(()=>this._inProgressUrlFetches.delete(o)),_M());return this._inProgressUrlFetches.set(o,l),l}_addSvgIconConfig(i,r,n){return this._svgIconConfigs.set(j8(i,r),n),this}_addSvgIconSetConfig(i,r){let n=this._iconSetConfigs.get(i);return n?n.push(r):this._iconSetConfigs.set(i,[r]),this}_svgElementFromConfig(i){if(!i.svgElement){let r=this._svgElementFromString(i.svgText);this._setSvgAttributes(r,i.options),i.svgElement=r}return i.svgElement}_getIconConfigFromResolvers(i,r){for(let n=0;n<this._resolvers.length;n++){let a=this._resolvers[n](r,i);if(a)return Koe(a)?new ql(a.url,null,a.options):new ql(a,null)}}static{this.\u0275fac=function(r){return new(r||e)(he(RI,8),he(d1),he(yt,8),he(yd))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function Ry(e){return e.cloneNode(!0)}function j8(e,t){return e+":"+t}function Koe(e){return!!(e.url&&e.options)}var Qoe=new Be("MAT_ICON_DEFAULT_OPTIONS"),Joe=new Be("mat-icon-location",{providedIn:"root",factory:ese});function ese(){let e=Ve(yt),t=e?e.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}var W8=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],tse=W8.map(e=>`[${e}]`).join(", "),ise=/^url\(['"]?#(.*?)['"]?\)$/,$n=(()=>{class e{get color(){return this._color||this._defaultColor}set color(i){this._color=i}get svgIcon(){return this._svgIcon}set svgIcon(i){i!==this._svgIcon&&(i?this._updateSvgIcon(i):this._svgIcon&&this._clearSvgElement(),this._svgIcon=i)}get fontSet(){return this._fontSet}set fontSet(i){let r=this._cleanupFontValue(i);r!==this._fontSet&&(this._fontSet=r,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(i){let r=this._cleanupFontValue(i);r!==this._fontIcon&&(this._fontIcon=r,this._updateFontIconClasses())}constructor(i,r,n,a,o,s){this._elementRef=i,this._iconRegistry=r,this._location=a,this._errorHandler=o,this.inline=!1,this._previousFontSetClass=[],this._currentIconFetch=Nr.EMPTY,s&&(s.color&&(this.color=this._defaultColor=s.color),s.fontSet&&(this.fontSet=s.fontSet)),n||i.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(i){if(!i)return["",""];let r=i.split(":");switch(r.length){case 1:return["",r[0]];case 2:return r;default:throw Error(`Invalid icon name: "${i}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let i=this._elementsWithExternalReferences;if(i&&i.size){let r=this._location.getPathname();r!==this._previousPath&&(this._previousPath=r,this._prependPathToReferences(r))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(i){this._clearSvgElement();let r=this._location.getPathname();this._previousPath=r,this._cacheChildrenWithExternalReferences(i),this._prependPathToReferences(r),this._elementRef.nativeElement.appendChild(i)}_clearSvgElement(){let i=this._elementRef.nativeElement,r=i.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();r--;){let n=i.childNodes[r];(n.nodeType!==1||n.nodeName.toLowerCase()==="svg")&&n.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let i=this._elementRef.nativeElement,r=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(n=>n.length>0);this._previousFontSetClass.forEach(n=>i.classList.remove(n)),r.forEach(n=>i.classList.add(n)),this._previousFontSetClass=r,this.fontIcon!==this._previousFontIconClass&&!r.includes("mat-ligature-font")&&(this._previousFontIconClass&&i.classList.remove(this._previousFontIconClass),this.fontIcon&&i.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(i){return typeof i=="string"?i.trim().split(" ")[0]:i}_prependPathToReferences(i){let r=this._elementsWithExternalReferences;r&&r.forEach((n,a)=>{n.forEach(o=>{a.setAttribute(o.name,`url('${i}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(i){let r=i.querySelectorAll(tse),n=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let a=0;a<r.length;a++)W8.forEach(o=>{let s=r[a],l=s.getAttribute(o),c=l?l.match(ise):null;if(c){let d=n.get(s);d||(d=[],n.set(s,d)),d.push({name:o,value:c[1]})}})}_updateSvgIcon(i){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),i){let[r,n]=this._splitIconName(i);r&&(this._svgNamespace=r),n&&(this._svgName=n),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(n,r).pipe(Br(1)).subscribe(a=>this._setSvgElement(a),a=>{let o=`Error retrieving icon ${r}:${n}! ${a.message}`;this._errorHandler.handleError(new Error(o))})}}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(Zoe),ea("aria-hidden"),z(Joe),z(yd),z(Qoe,8))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(r,n){r&2&&(Ft("data-mat-icon-type",n._usingFontIcon()?"font":"svg")("data-mat-icon-name",n._svgName||n.fontIcon)("data-mat-icon-namespace",n._svgNamespace||n.fontSet)("fontIcon",n._usingFontIcon()?n.fontIcon:null),yr(n.color?"mat-"+n.color:""),ft("mat-icon-inline",n.inline)("mat-icon-no-color",n.color!=="primary"&&n.color!=="accent"&&n.color!=="warn"))},inputs:{color:"color",inline:[de.HasDecoratorInputTransform,"inline","inline",ot],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],standalone:!0,features:[wi,Xt],ngContentSelectors:$oe,decls:1,vars:0,template:function(r,n){r&1&&(ti(),it(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}}return e})(),q8=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[Et,Et]})}}return e})();var rse=(e,t)=>({cornerHandle:e,"anchorHandle animate-pulse":t}),nse=e=>({hidden:e}),Fy=(()=>{class e{handleDrag=!1;handleSize=16;handlePos={x:256,y:-50};handleColor="#7dafff";scale=1;showCoordinates=!0;isAnchor=!1;constructor(){}startHandleDrag(i,r){this.handleDrag=!0}stopHandleDrag(){this.handleDrag=!1}moveTo(i,r,n,a){i=Math.min(Math.max(i,this.handleSize/2),n-this.handleSize/2),r=Math.min(Math.max(r,this.handleSize/2),a-this.handleSize/2),this.handlePos={x:i,y:r}}getLabelCoordinates(){let i=this.handlePos.x*this.scale,r=this.handlePos.y*this.scale;return{x:i.toFixed(0),y:r.toFixed(0)}}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Ae({type:e,selectors:[["app-handle"]],inputs:{handleSize:"handleSize",handlePos:"handlePos",handleColor:"handleColor",scale:"scale",showCoordinates:"showCoordinates",isAnchor:"isAnchor"},decls:3,vars:17,consts:[[1,"handle",3,"mousedown","touchstart","touchstop","mouseup","ngClass"],[1,"select-none","pointer-events-none",3,"ngClass"]],template:function(r,n){r&1&&(S(0,"div",0),q("mousedown",function(o){return n.startHandleDrag(o,1)})("touchstart",function(o){return n.startHandleDrag(o,1)})("touchstop",function(){return n.stopHandleDrag()})("mouseup",function(){return n.stopHandleDrag()}),S(1,"p",1),G(2),A()()),r&2&&(ei("top",n.handlePos.y,"px")("left",n.handlePos.x,"px")("--width",n.handleSize,"px")("--color",n.handleColor),O("ngClass",hh(12,rse,!n.isAnchor,n.isAnchor)),P(),O("ngClass",Cd(15,nse,!n.showCoordinates)),P(),qM("(",n.getLabelCoordinates().x,",",n.getLabelCoordinates().y,")"))},dependencies:[Es],styles:[".handle[_ngcontent-%COMP%]{width:var(--width);aspect-ratio:1;position:absolute;cursor:move;border:solid rgba(255,255,255,.25) 1px;transform:translate(-50%,-50%);font-size:smaller;transform-origin:top left;z-index:99;display:flex;justify-content:center;text-align:center;border-radius:100%}.cornerHandle[_ngcontent-%COMP%]{background:radial-gradient(circle at calc(var(--width) / 2) calc(var(--width) / 2),var(--color),#000);box-shadow:#0000004d 0 19px 38px,#00000038 0 15px 12px}.anchorHandle[_ngcontent-%COMP%]{border:solid rgba(255,255,255,.75) 1px;background:#bfbfbf80;z-index:128}.handle[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{position:relative;top:-24px}.handle[_ngcontent-%COMP%]:hover{border:dashed white 1px}"]})}return e})();var ase=["handle1"],ose=["handle2"],sse=["midHandle"],X8=(()=>{class e{cdr;point1={x:0,y:0};point2={x:0,y:0};scale=1;property;handle1;handle2;midHandle;labelPos={x:0,y:0};midPoint={x:0,y:0};constructor(i){this.cdr=i}ngOnInit(){}ngAfterViewInit(){this.update(),this.cdr.detectChanges()}getRectangleCoordinates(){let i=this.point1.x,r=this.point1.y,n=this.point2.x,a=this.point2.y;return{x1:i,y1:r,x2:n,y2:a}}getHandles(){return[this.handle1,this.handle2]}getMidHandle(){return this.midHandle}update(){this.point1=this.handle1.handlePos,this.point2=this.handle2.handlePos,this.midPoint={x:(this.point1.x+this.point2.x)/2,y:(this.point1.y+this.point2.y)/2},this.updateNamePosition()}updateNamePosition(){let i=Math.min(this.handle1.handlePos.y,this.handle2.handlePos.y),r=this.handle1.handlePos.x,n=this.handle2.handlePos.x,a=(r+n)/2;this.labelPos={y:i,x:a}}static \u0275fac=function(r){return new(r||e)(z(Vt))};static \u0275cmp=Ae({type:e,selectors:[["app-roi"]],viewQuery:function(r,n){if(r&1&&(tt(ase,5),tt(ose,5),tt(sse,5)),r&2){let a;Me(a=Ie())&&(n.handle1=a.first),Me(a=Ie())&&(n.handle2=a.first),Me(a=Ie())&&(n.midHandle=a.first)}},inputs:{point1:"point1",point2:"point2",scale:"scale",property:"property"},decls:8,vars:17,consts:[["handle1",""],["handle2",""],["midHandle",""],[3,"handlePos","scale","handleColor"],[3,"handlePos","scale","handleColor","handleSize","showCoordinates","isAnchor"],[1,"absolute","label","text-sm","select-none","pointer-events-none"]],template:function(r,n){r&1&&(ae(0,"app-handle",3,0)(2,"app-handle",3,1)(4,"app-handle",4,2),S(6,"p",5),G(7),A()),r&2&&(O("handlePos",n.point1)("scale",n.scale)("handleColor",n.property.color),P(2),O("handlePos",n.point2)("scale",n.scale)("handleColor",n.property.color),P(2),O("handlePos",n.midPoint)("scale",n.scale)("handleColor","white")("handleSize",12)("showCoordinates",!1)("isAnchor",!0),P(2),ei("top",n.labelPos.y,"px")("left",n.labelPos.x,"px"),P(),gr(n.property.name))},dependencies:[Fy],styles:[".label[_ngcontent-%COMP%]{transform:translate(-50%,-100%);transform-origin:top left;z-index:50}"]})}return e})();var cse=["canvas"],dse=["canvasUI"],use=["handleProfile"],hse=["ROI"],mse=e=>({BWFilter:e}),pse=e=>({hidden:e}),fse=()=>({x:50,y:100}),gse=()=>({x:250,y:100});function vse(e,t){if(e&1&&(S(0,"p",15),G(1),A()),e&2){let i=J();P(),gr(i.title)}}function _se(e,t){if(e&1){let i=Ue();S(0,"span",16)(1,"mat-slide-toggle",17),Pt("ngModelChange",function(n){j(i);let a=J();return Dt(a.isBWChecked,n)||(a.isBWChecked=n),W(n)}),q("change",function(){j(i);let n=J();return W(n.BWToggle())}),G(2,"B&W"),A()()}if(e&2){let i=J();P(),Nt("ngModel",i.isBWChecked)}}function bse(e,t){if(e&1){let i=Ue();S(0,"span",18)(1,"mat-slide-toggle",17),Pt("ngModelChange",function(n){j(i);let a=J();return Dt(a.profile,n)||(a.profile=n),W(n)}),q("change",function(){j(i);let n=J();return W(n.updateCanvasUI())}),G(2,"profile"),A()()}if(e&2){let i=J();P(),Nt("ngModel",i.profile)}}function xse(e,t){if(e&1&&(S(0,"div",19,3),ae(2,"div",20),S(3,"mat-icon"),G(4,"brush"),A()()),e&2){let i=J();ei("top",i.cursorPosition.y,"px")("left",i.cursorPosition.x,"px")("width",i.getCursorTransform(),"px"),P(2),ei("border-color",i.drawColor)}}function yse(e,t){if(e&1&&ae(0,"app-roi",21,4),e&2){let i=t.$implicit,r=J();O("point1",i.initial1)("point2",i.initial2)("scale",r.getScreenToCanvasScale())("property",i)}}var Ua=(()=>{class e{drawingEnded=new Pe;canvas;ctx;canvasUI;ctxUI;handles;ROIs;width=256;height=this.width;UIwidth=1024;roi=[];brushRadius=10;drawColor="white";drawable=!0;title="";BWOption=!1;OnlyBW=!1;profileOption=!1;BWSet=new Pe;profileChanged=new Pe;roiChanged=new Pe;profile=!1;isBWChecked=!1;cursorPosition={x:0,y:0};startDrawing=!1;initialPos;profileArray;constructor(){}ngOnInit(){let i=this.canvas.nativeElement;this.ctx=i.getContext("2d",{alpha:!1}),this.ctx.imageSmoothingEnabled=!1,this.height=this.width,i.width=this.width,i.height=this.height,this.ctx.canvas.width=this.width,this.ctx.canvas.height=this.height;let r=this.canvasUI.nativeElement;this.ctxUI=r.getContext("2d",{alpha:!0}),r.width=this.UIwidth,r.height=this.UIwidth,this.drawable&&this.captureEvents(i),this.ctx.fillRect(0,0,this.width,this.height)}BWToggle(){this.BWSet.emit()}ngAfterViewInit(){this.updateCanvasUI()}setCanvasDimensions(i,r){this.height=r,this.width=i,this.ctx.canvas.width=i,this.ctx.canvas.height=r}getArray(){return this.ctx.getImageData(0,0,this.width,this.height).data}getCanvas(){return this.ctx.canvas}getCtx(){return this.ctx}clearCanvas(){this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.width,this.height),this.drawingEnded.emit()}drawImage(i){this.ctx.drawImage(i,0,0,this.width,this.height),this.updateCanvasUI(),this.drawingEnded.emit()}drawMat(i){cv.imshow(this.getCanvas(),i),this.updateCanvasUI()}drawMatWithoutEvent(i){cv.imshow(this.getCanvas(),i)}drawArray(i,r=this.width,n=this.height,a=0,o=0){var s=new ImageData(i,r,n);this.ctx.putImageData(s,a,o),this.updateCanvasUI(),this.drawingEnded.emit()}drawCroppedArray(i,r=this.width,n=this.height,a=0,o=0,s=0,l=0,c=r,d=n){var u=new ImageData(i,r,n);this.ctx.putImageData(u,a,o,s,l,c,d),this.updateCanvasUI(),this.drawingEnded.emit()}draw(i,r=null){this.ctx.beginPath(),this.ctx.moveTo(i.x,i.y),r?this.ctx.lineTo(r.x,r.y):this.ctx.lineTo(i.x,i.y),this.ctx.lineWidth=this.brushRadius,this.ctx.strokeStyle=this.drawColor,this.ctx.lineCap="round",this.ctx.stroke()}draw_callback(){this.drawingEnded.emit(!0)}captureEvents(i){let r=ya(i,"touchstart"),n=ya(i,"mousedown"),a=ya(i,"mousemove"),o=Rn(r,n),s=ya(i,"touchmove"),l=Rn(s,a),c=ya(i,"touchend"),d=ya(i,"mouseup"),u=ya(i,"mouseleave"),h=Rn(c,u,d),m=!1;l.subscribe({next:f=>{let p=i.getBoundingClientRect();var g=this.getClientPosition(f);this.cursorPosition.x=g.clientX-p.left,this.cursorPosition.y=g.clientY-p.top}}),o.pipe(Wr(f=>{let p=i.getBoundingClientRect(),g=this.getCoord(f,p);return m=!0,this.initialPos=g,this.startDrawing=!0,this.draw(g),this.draw_callback(),l.pipe(yi(h),Ow())})).subscribe({next:f=>{let p=i.getBoundingClientRect();var g=this.getCoord(f[0],p);let v=this.getCoord(f[1],p);this.startDrawing&&(this.startDrawing=!1,g=this.initialPos),this.draw(g,v),this.draw_callback()}}),h.subscribe(f=>{m&&(this.updateCanvasUI(),this.draw_callback()),m=!1})}getClientPosition(i){return i.preventDefault(),"touches"in i?{clientX:i.touches[0].clientX,clientY:i.touches[0].clientY}:{clientX:i.clientX,clientY:i.clientY}}getCoord(i,r){var n=this.getClientPosition(i);return{x:(n.clientX-r.left)*(this.width/r.width),y:(n.clientY-r.top)*(this.height/r.height)}}getCursorTransform(){return this.canvas.nativeElement.getBoundingClientRect().width/this.width*this.brushRadius}updateHandleDragPos(i){let n=this.ctxUI.canvas.getBoundingClientRect();var a=this.getClientPosition(i);let o=this.handles.toArray(),s=this.ROIs.toArray(),l=a.clientX-n.left,c=a.clientY-n.top,d=!1,u=l>=n.width||l<=0||c>=n.height||c<=0;o.forEach(h=>{h.handleDrag=u?!1:h.handleDrag,h.handleDrag&&(h.moveTo(l,c,n.width,n.height),d=!0)}),s.forEach(h=>{let m=h.getHandles();m.forEach(p=>{p.handleDrag=u?!1:p.handleDrag,p.handleDrag&&(p.moveTo(l,c,n.width,n.height),h.update(),d=!0)});let f=h.getMidHandle();if(f.handleDrag=u?!1:f.handleDrag,f.handleDrag){let p=l-f.handlePos.x,g=c-f.handlePos.y;m.forEach(v=>{v.moveTo(v.handlePos.x+p,v.handlePos.y+g,n.width,n.height),h.update(),d=!0})}}),this.updateCanvasUI()}updateCanvasUI(){this.ctxUI.clearRect(0,0,this.UIwidth,this.UIwidth),requestAnimationFrame(()=>{this.ROIs.length>0&&this.updateROI(),this.profile&&this.updateProfile()})}transformCoordinatesFromScreenToUISpace(i){let n=this.ctxUI.canvas.getBoundingClientRect(),a=n.width,o=n.height,s=i.x*(this.UIwidth/a),l=i.y*(this.UIwidth/o);return{x:s,y:l}}transformCoordinatesFromScreenToCanvas(i){let n=this.ctx.canvas.getBoundingClientRect(),a=n.width,o=n.height,s=i.x*(this.width/a),l=i.y*(this.height/o);return{x:s,y:l}}getScreenToCanvasScale(){let n=this.ctx.canvas.getBoundingClientRect().width;return this.width/n}getProfile(){return this.profileArray}updateProfile(){this.ctxUI.beginPath();let i=this.handles.toArray(),r=this.transformCoordinatesFromScreenToCanvas(i[0].handlePos),n=this.transformCoordinatesFromScreenToCanvas(i[1].handlePos),a=this.transformCoordinatesFromScreenToUISpace(i[0].handlePos),o=this.transformCoordinatesFromScreenToUISpace(i[1].handlePos);this.ctxUI.moveTo(a.x,a.y),this.ctxUI.lineTo(o.x,o.y),this.ctxUI.lineWidth=3,this.ctxUI.strokeStyle="blue",this.ctxUI.setLineDash([10,20]),this.ctxUI.stroke(),this.recomputeProfile(r,n)}updateROI(){let i=this.ROIs.toArray();this.ctxUI.setLineDash([5,5]),this.ctxUI.lineWidth=2,i.forEach(r=>{let n=r.getHandles(),a=this.transformCoordinatesFromScreenToUISpace(n[0].handlePos),o=this.transformCoordinatesFromScreenToUISpace(n[1].handlePos);this.ctxUI.beginPath(),this.ctxUI.strokeStyle=r.property.color,this.ctxUI.fillStyle=r.property.color,this.ctxUI.strokeRect(a.x,a.y,o.x-a.x,o.y-a.y),this.ctxUI.globalAlpha=.3,this.ctxUI.fillRect(a.x,a.y,o.x-a.x,o.y-a.y),this.ctxUI.fill(),this.ctxUI.globalAlpha=1,this.ctxUI.stroke(),this.recomputeROI(r)})}recomputeProfile(i,r){let n=B8(i,r);this.profileArray=new Array;let a=this.getArray();n.forEach(o=>{let s=o.y,l=o.x,c=(this.width*s+l)*4;this.profileArray.push(a[c])}),this.profileChanged.emit()}recomputeROI(i){let r=i.getHandles(),n=this.transformCoordinatesFromScreenToCanvas(r[0].handlePos),a=this.transformCoordinatesFromScreenToCanvas(r[1].handlePos),o=Math.min(n.x,a.x),s=Math.min(n.y,a.y),l=Math.abs(n.x-a.x),c=Math.abs(n.y-a.y),d=this.ctx.getImageData(o,s,l,c);i.property.data=d,this.roiChanged.emit(i.property)}isBW(){return this.isBWChecked}getValueAtSquare(i,r,n,a){return this.ctx.getImageData(i,r,n,a).data}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Ae({type:e,selectors:[["app-draw-canvas"]],viewQuery:function(r,n){if(r&1&&(tt(cse,7),tt(dse,7),tt(use,5),tt(hse,5)),r&2){let a;Me(a=Ie())&&(n.canvas=a.first),Me(a=Ie())&&(n.canvasUI=a.first),Me(a=Ie())&&(n.handles=a),Me(a=Ie())&&(n.ROIs=a)}},hostBindings:function(r,n){r&1&&q("resize",function(o){return n.updateCanvasUI(o)},!1,LM)},inputs:{width:"width",roi:"roi",brushRadius:"brushRadius",drawColor:"drawColor",drawable:"drawable",title:"title",BWOption:"BWOption",OnlyBW:"OnlyBW",profileOption:"profileOption"},outputs:{drawingEnded:"drawingEnded",BWSet:"BWSet",profileChanged:"profileChanged",roiChanged:"roiChanged"},decls:15,vars:20,consts:[["canvas",""],["canvasUI",""],["handleProfile",""],["cursor",""],["ROI",""],[1,"canvas-container",3,"mousemove"],["class","title select-none",4,"ngIf"],["class","BW-toggle toggle",4,"ngIf"],["class","Profile-toggle toggle",4,"ngIf"],["class","cursor",3,"top","left","width",4,"ngIf"],["id","canvasVisu",3,"ngClass"],["id","canvasUI",1,"pointer-events-none",3,"width"],[3,"ngClass"],[1,"handle",3,"handlePos","scale"],[3,"point1","point2","scale","property",4,"ngFor","ngForOf"],[1,"title","select-none"],[1,"BW-toggle","toggle"],["color","primary",3,"ngModelChange","change","ngModel"],[1,"Profile-toggle","toggle"],[1,"cursor"],[1,"cursor-radius"],[3,"point1","point2","scale","property"]],template:function(r,n){if(r&1){let a=Ue();S(0,"div",5),q("mousemove",function(s){return j(a),W(n.updateHandleDragPos(s))}),Te(1,vse,2,1,"p",6)(2,_se,3,1,"span",7)(3,bse,3,1,"span",8)(4,xse,5,8,"div",9),ae(5,"canvas",10,0)(7,"canvas",11,1),S(9,"div",12),ae(10,"app-handle",13,2)(12,"app-handle",13,2),A(),Te(14,yse,2,4,"app-roi",14),A()}r&2&&(ei("cursor",n.drawable?"none":"default"),P(),O("ngIf",n.title),P(),O("ngIf",n.BWOption),P(),O("ngIf",n.profileOption),P(),O("ngIf",n.drawable),P(),O("ngClass",Cd(14,mse,n.isBWChecked||n.OnlyBW)),P(2),O("width",n.UIwidth),P(2),O("ngClass",Cd(16,pse,!n.profile)),P(),O("handlePos",cl(18,fse))("scale",n.getScreenToCanvasScale()),P(2),O("handlePos",cl(19,gse))("scale",n.getScreenToCanvasScale()),P(2),O("ngForOf",n.roi))},dependencies:[Es,Fn,cn,yn,an,op,$n,Fy,X8],styles:[".canvas-container[_ngcontent-%COMP%]{overflow:hidden;position:relative;width:100%;aspect-ratio:1;cursor:none;box-shadow:#0000003d 0 3px 8px}.toggle[_ngcontent-%COMP%]{position:absolute;color:#fff;z-index:10;background-color:#7f7f7f80;border-radius:3px;margin:5px;padding:0 5px}.BW-toggle[_ngcontent-%COMP%]{top:0;right:0}.Profile-toggle[_ngcontent-%COMP%]{bottom:0;right:0}.title[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:10;pointer-events:none;margin:5px;background-color:#7f7f7f80;color:#fff;padding:0 5px;border-radius:3px}.canvas-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{width:100%;aspect-ratio:1}.canvas-container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:absolute;height:inherit}.cursor[_ngcontent-%COMP%]{z-index:5;position:absolute;aspect-ratio:1;transform:translate(-50%,-50%);pointer-events:none;transform-origin:top left}.cursor[_ngcontent-%COMP%] > .cursor-radius[_ngcontent-%COMP%]{position:relative;width:inherit;aspect-ratio:1;border-radius:50%;border-style:dashed;border-width:1px;pointer-events:none;transform-origin:center;animation:_ngcontent-%COMP%_rotation 20s infinite linear;background:radial-gradient(circle,#fff 0% 5%,#64646480 3% 100%)}.cursor[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translateY(-75%)}@keyframes _ngcontent-%COMP%_rotation{0%{transform:rotate(0)}to{transform:rotate(359deg)}}.BWFilter[_ngcontent-%COMP%]{filter:grayscale(1)}"]})}return e})();var wse=["knob"],Cse=["valueIndicatorContainer"];function Ese(e,t){if(e&1&&(S(0,"div",2,1)(2,"div",5)(3,"span",6),G(4),A()()()),e&2){let i=J();P(4),gr(i.valueIndicatorText)}}var Sse=["trackActive"],Ase=["*"];function Tse(e,t){if(e&1&&ae(0,"div"),e&2){let i=t.$implicit,r=t.$index,n=J(3);yr(i===0?"mdc-slider__tick-mark--active":"mdc-slider__tick-mark--inactive"),ei("transform",n._calcTickMarkTransform(r))}}function Dse(e,t){if(e&1&&HM(0,Tse,1,4,"div",8,UM),e&2){let i=J(2);GM(i._tickMarks)}}function Mse(e,t){if(e&1&&(S(0,"div",6,1),Te(2,Dse,2,0),A()),e&2){let i=J();P(2),fi(2,i._cachedWidth?2:-1)}}function Ise(e,t){if(e&1&&ae(0,"mat-slider-visual-thumb",7),e&2){let i=J();O("discrete",i.discrete)("thumbPosition",1)("valueIndicatorText",i.startValueIndicatorText)}}var Gt=function(e){return e[e.START=1]="START",e[e.END=2]="END",e}(Gt||{}),sp=function(e){return e[e.ACTIVE=0]="ACTIVE",e[e.INACTIVE=1]="INACTIVE",e}(sp||{}),dT=new Be("_MatSlider"),Y8=new Be("_MatSliderThumb"),kse=new Be("_MatSliderRangeThumb"),Z8=new Be("_MatSliderVisualThumb");var Nse=(()=>{class e{constructor(i,r,n,a){this._cdr=i,this._ngZone=r,this._slider=a,this._isHovered=!1,this._isActive=!1,this._isValueIndicatorVisible=!1,this._platform=Ve(pi),this._onPointerMove=o=>{if(this._sliderInput._isFocused)return;let s=this._hostElement.getBoundingClientRect(),l=this._slider._isCursorOnSliderThumb(o,s);this._isHovered=l,l?this._showHoverRipple():this._hideRipple(this._hoverRippleRef)},this._onMouseLeave=()=>{this._isHovered=!1,this._hideRipple(this._hoverRippleRef)},this._onFocus=()=>{this._hideRipple(this._hoverRippleRef),this._showFocusRipple(),this._hostElement.classList.add("mdc-slider__thumb--focused")},this._onBlur=()=>{this._isActive||this._hideRipple(this._focusRippleRef),this._isHovered&&this._showHoverRipple(),this._hostElement.classList.remove("mdc-slider__thumb--focused")},this._onDragStart=o=>{o.button===0&&(this._isActive=!0,this._showActiveRipple())},this._onDragEnd=()=>{this._isActive=!1,this._hideRipple(this._activeRippleRef),this._sliderInput._isFocused||this._hideRipple(this._focusRippleRef),this._platform.SAFARI&&this._showHoverRipple()},this._hostElement=n.nativeElement}ngAfterViewInit(){this._ripple.radius=24,this._sliderInput=this._slider._getInput(this.thumbPosition),this._sliderInputEl=this._sliderInput._hostElement;let i=this._sliderInputEl;this._ngZone.runOutsideAngular(()=>{i.addEventListener("pointermove",this._onPointerMove),i.addEventListener("pointerdown",this._onDragStart),i.addEventListener("pointerup",this._onDragEnd),i.addEventListener("pointerleave",this._onMouseLeave),i.addEventListener("focus",this._onFocus),i.addEventListener("blur",this._onBlur)})}ngOnDestroy(){let i=this._sliderInputEl;i&&(i.removeEventListener("pointermove",this._onPointerMove),i.removeEventListener("pointerdown",this._onDragStart),i.removeEventListener("pointerup",this._onDragEnd),i.removeEventListener("pointerleave",this._onMouseLeave),i.removeEventListener("focus",this._onFocus),i.removeEventListener("blur",this._onBlur))}_showHoverRipple(){this._isShowingRipple(this._hoverRippleRef)||(this._hoverRippleRef=this._showRipple({enterDuration:0,exitDuration:0}),this._hoverRippleRef?.element.classList.add("mat-mdc-slider-hover-ripple"))}_showFocusRipple(){this._isShowingRipple(this._focusRippleRef)||(this._focusRippleRef=this._showRipple({enterDuration:0,exitDuration:0},!0),this._focusRippleRef?.element.classList.add("mat-mdc-slider-focus-ripple"))}_showActiveRipple(){this._isShowingRipple(this._activeRippleRef)||(this._activeRippleRef=this._showRipple({enterDuration:225,exitDuration:400}),this._activeRippleRef?.element.classList.add("mat-mdc-slider-active-ripple"))}_isShowingRipple(i){return i?.state===fa.FADING_IN||i?.state===fa.VISIBLE}_showRipple(i,r){if(!this._slider.disabled&&(this._showValueIndicator(),this._slider._isRange&&this._slider._getThumb(this.thumbPosition===Gt.START?Gt.END:Gt.START)._showValueIndicator(),!(this._slider._globalRippleOptions?.disabled&&!r)))return this._ripple.launch({animation:this._slider._noopAnimations?{enterDuration:0,exitDuration:0}:i,centered:!0,persistent:!0})}_hideRipple(i){if(i?.fadeOut(),this._isShowingAnyRipple())return;this._slider._isRange||this._hideValueIndicator();let r=this._getSibling();r._isShowingAnyRipple()||(this._hideValueIndicator(),r._hideValueIndicator())}_showValueIndicator(){this._hostElement.classList.add("mdc-slider__thumb--with-indicator")}_hideValueIndicator(){this._hostElement.classList.remove("mdc-slider__thumb--with-indicator")}_getSibling(){return this._slider._getThumb(this.thumbPosition===Gt.START?Gt.END:Gt.START)}_getValueIndicatorContainer(){return this._valueIndicatorContainer?.nativeElement}_getKnob(){return this._knob.nativeElement}_isShowingAnyRipple(){return this._isShowingRipple(this._hoverRippleRef)||this._isShowingRipple(this._focusRippleRef)||this._isShowingRipple(this._activeRippleRef)}static{this.\u0275fac=function(r){return new(r||e)(z(Vt),z(Xe),z(nt),z(dT))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-slider-visual-thumb"]],viewQuery:function(r,n){if(r&1&&(tt(Zo,5),tt(wse,5),tt(Cse,5)),r&2){let a;Me(a=Ie())&&(n._ripple=a.first),Me(a=Ie())&&(n._knob=a.first),Me(a=Ie())&&(n._valueIndicatorContainer=a.first)}},hostAttrs:[1,"mdc-slider__thumb","mat-mdc-slider-visual-thumb"],inputs:{discrete:"discrete",thumbPosition:"thumbPosition",valueIndicatorText:"valueIndicatorText"},standalone:!0,features:[_i([{provide:Z8,useExisting:e}]),Xt],decls:4,vars:2,consts:[["knob",""],["valueIndicatorContainer",""],[1,"mdc-slider__value-indicator-container"],[1,"mdc-slider__thumb-knob"],["matRipple","",1,"mat-mdc-focus-indicator",3,"matRippleDisabled"],[1,"mdc-slider__value-indicator"],[1,"mdc-slider__value-indicator-text"]],template:function(r,n){r&1&&(Te(0,Ese,5,1,"div",2),ae(1,"div",3,0)(3,"div",4)),r&2&&(fi(0,n.discrete?0:-1),P(3),O("matRippleDisabled",!0))},dependencies:[Zo],styles:[".mat-mdc-slider-visual-thumb .mat-ripple{height:100%;width:100%}.mat-mdc-slider .mdc-slider__tick-marks{justify-content:start}.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--inactive{position:absolute;left:2px}"],encapsulation:2,changeDetection:0})}}return e})(),K8=(()=>{class e{get disabled(){return this._disabled}set disabled(i){this._disabled=i;let r=this._getInput(Gt.END),n=this._getInput(Gt.START);r&&(r.disabled=this._disabled),n&&(n.disabled=this._disabled)}get discrete(){return this._discrete}set discrete(i){this._discrete=i,this._updateValueIndicatorUIs()}get min(){return this._min}set min(i){let r=isNaN(i)?this._min:i;this._min!==r&&this._updateMin(r)}_updateMin(i){let r=this._min;this._min=i,this._isRange?this._updateMinRange({old:r,new:i}):this._updateMinNonRange(i),this._onMinMaxOrStepChange()}_updateMinRange(i){let r=this._getInput(Gt.END),n=this._getInput(Gt.START),a=r.value,o=n.value;n.min=i.new,r.min=Math.max(i.new,n.value),n.max=Math.min(r.max,r.value),n._updateWidthInactive(),r._updateWidthInactive(),i.new<i.old?this._onTranslateXChangeBySideEffect(r,n):this._onTranslateXChangeBySideEffect(n,r),a!==r.value&&this._onValueChange(r),o!==n.value&&this._onValueChange(n)}_updateMinNonRange(i){let r=this._getInput(Gt.END);if(r){let n=r.value;r.min=i,r._updateThumbUIByValue(),this._updateTrackUI(r),n!==r.value&&this._onValueChange(r)}}get max(){return this._max}set max(i){let r=isNaN(i)?this._max:i;this._max!==r&&this._updateMax(r)}_updateMax(i){let r=this._max;this._max=i,this._isRange?this._updateMaxRange({old:r,new:i}):this._updateMaxNonRange(i),this._onMinMaxOrStepChange()}_updateMaxRange(i){let r=this._getInput(Gt.END),n=this._getInput(Gt.START),a=r.value,o=n.value;r.max=i.new,n.max=Math.min(i.new,r.value),r.min=n.value,r._updateWidthInactive(),n._updateWidthInactive(),i.new>i.old?this._onTranslateXChangeBySideEffect(n,r):this._onTranslateXChangeBySideEffect(r,n),a!==r.value&&this._onValueChange(r),o!==n.value&&this._onValueChange(n)}_updateMaxNonRange(i){let r=this._getInput(Gt.END);if(r){let n=r.value;r.max=i,r._updateThumbUIByValue(),this._updateTrackUI(r),n!==r.value&&this._onValueChange(r)}}get step(){return this._step}set step(i){let r=isNaN(i)?this._step:i;this._step!==r&&this._updateStep(r)}_updateStep(i){this._step=i,this._isRange?this._updateStepRange():this._updateStepNonRange(),this._onMinMaxOrStepChange()}_updateStepRange(){let i=this._getInput(Gt.END),r=this._getInput(Gt.START),n=i.value,a=r.value,o=r.value;i.min=this._min,r.max=this._max,i.step=this._step,r.step=this._step,this._platform.SAFARI&&(i.value=i.value,r.value=r.value),i.min=Math.max(this._min,r.value),r.max=Math.min(this._max,i.value),r._updateWidthInactive(),i._updateWidthInactive(),i.value<o?this._onTranslateXChangeBySideEffect(r,i):this._onTranslateXChangeBySideEffect(i,r),n!==i.value&&this._onValueChange(i),a!==r.value&&this._onValueChange(r)}_updateStepNonRange(){let i=this._getInput(Gt.END);if(i){let r=i.value;i.step=this._step,this._platform.SAFARI&&(i.value=i.value),i._updateThumbUIByValue(),r!==i.value&&this._onValueChange(i)}}constructor(i,r,n,a,o,s){this._ngZone=i,this._cdr=r,this._elementRef=n,this._dir=a,this._globalRippleOptions=o,this._disabled=!1,this._discrete=!1,this.showTickMarks=!1,this._min=0,this.disableRipple=!1,this._max=100,this._step=1,this.displayWith=l=>`${l}`,this._rippleRadius=24,this.startValueIndicatorText="",this.endValueIndicatorText="",this._isRange=!1,this._isRtl=!1,this._hasViewInitialized=!1,this._tickMarkTrackWidth=0,this._hasAnimation=!1,this._resizeTimer=null,this._platform=Ve(pi),this._knobRadius=8,this._thumbsOverlap=!1,this._noopAnimations=s==="NoopAnimations",this._dirChangeSubscription=this._dir.change.subscribe(()=>this._onDirChange()),this._isRtl=this._dir.value==="rtl"}ngAfterViewInit(){this._platform.isBrowser&&this._updateDimensions();let i=this._getInput(Gt.END),r=this._getInput(Gt.START);this._isRange=!!i&&!!r,this._cdr.detectChanges();let n=this._getThumb(Gt.END);this._rippleRadius=n._ripple.radius,this._inputPadding=this._rippleRadius-this._knobRadius,this._isRange?this._initUIRange(i,r):this._initUINonRange(i),this._updateTrackUI(i),this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._observeHostResize(),this._cdr.detectChanges()}_initUINonRange(i){i.initProps(),i.initUI(),this._updateValueIndicatorUI(i),this._hasViewInitialized=!0,i._updateThumbUIByValue()}_initUIRange(i,r){i.initProps(),i.initUI(),r.initProps(),r.initUI(),i._updateMinMax(),r._updateMinMax(),i._updateStaticStyles(),r._updateStaticStyles(),this._updateValueIndicatorUIs(),this._hasViewInitialized=!0,i._updateThumbUIByValue(),r._updateThumbUIByValue()}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._resizeObserver?.disconnect(),this._resizeObserver=null}_onDirChange(){this._isRtl=this._dir.value==="rtl",this._isRange?this._onDirChangeRange():this._onDirChangeNonRange(),this._updateTickMarkUI()}_onDirChangeRange(){let i=this._getInput(Gt.END),r=this._getInput(Gt.START);i._setIsLeftThumb(),r._setIsLeftThumb(),i.translateX=i._calcTranslateXByValue(),r.translateX=r._calcTranslateXByValue(),i._updateStaticStyles(),r._updateStaticStyles(),i._updateWidthInactive(),r._updateWidthInactive(),i._updateThumbUIByValue(),r._updateThumbUIByValue()}_onDirChangeNonRange(){this._getInput(Gt.END)._updateThumbUIByValue()}_observeHostResize(){typeof ResizeObserver>"u"||!ResizeObserver||this._ngZone.runOutsideAngular(()=>{this._resizeObserver=new ResizeObserver(()=>{this._isActive()||(this._resizeTimer&&clearTimeout(this._resizeTimer),this._onResize())}),this._resizeObserver.observe(this._elementRef.nativeElement)})}_isActive(){return this._getThumb(Gt.START)._isActive||this._getThumb(Gt.END)._isActive}_getValue(i=Gt.END){let r=this._getInput(i);return r?r.value:this.min}_skipUpdate(){return!!(this._getInput(Gt.START)?._skipUIUpdate||this._getInput(Gt.END)?._skipUIUpdate)}_updateDimensions(){this._cachedWidth=this._elementRef.nativeElement.offsetWidth,this._cachedLeft=this._elementRef.nativeElement.getBoundingClientRect().left}_setTrackActiveStyles(i){let r=this._trackActive.nativeElement.style;r.left=i.left,r.right=i.right,r.transformOrigin=i.transformOrigin,r.transform=i.transform}_calcTickMarkTransform(i){return`translateX(${i*(this._tickMarkTrackWidth/(this._tickMarks.length-1))}px`}_onTranslateXChange(i){this._hasViewInitialized&&(this._updateThumbUI(i),this._updateTrackUI(i),this._updateOverlappingThumbUI(i))}_onTranslateXChangeBySideEffect(i,r){this._hasViewInitialized&&(i._updateThumbUIByValue(),r._updateThumbUIByValue())}_onValueChange(i){this._hasViewInitialized&&(this._updateValueIndicatorUI(i),this._updateTickMarkUI(),this._cdr.detectChanges())}_onMinMaxOrStepChange(){this._hasViewInitialized&&(this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.markForCheck())}_onResize(){if(this._hasViewInitialized){if(this._updateDimensions(),this._isRange){let i=this._getInput(Gt.END),r=this._getInput(Gt.START);i._updateThumbUIByValue(),r._updateThumbUIByValue(),i._updateStaticStyles(),r._updateStaticStyles(),i._updateMinMax(),r._updateMinMax(),i._updateWidthInactive(),r._updateWidthInactive()}else{let i=this._getInput(Gt.END);i&&i._updateThumbUIByValue()}this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.detectChanges()}}_areThumbsOverlapping(){let i=this._getInput(Gt.START),r=this._getInput(Gt.END);return!i||!r?!1:r.translateX-i.translateX<20}_updateOverlappingThumbClassNames(i){let r=i.getSibling(),n=this._getThumb(i.thumbPosition);this._getThumb(r.thumbPosition)._hostElement.classList.remove("mdc-slider__thumb--top"),n._hostElement.classList.toggle("mdc-slider__thumb--top",this._thumbsOverlap)}_updateOverlappingThumbUI(i){!this._isRange||this._skipUpdate()||this._thumbsOverlap!==this._areThumbsOverlapping()&&(this._thumbsOverlap=!this._thumbsOverlap,this._updateOverlappingThumbClassNames(i))}_updateThumbUI(i){if(this._skipUpdate())return;let r=this._getThumb(i.thumbPosition===Gt.END?Gt.END:Gt.START);r._hostElement.style.transform=`translateX(${i.translateX}px)`}_updateValueIndicatorUI(i){if(this._skipUpdate())return;let r=this.displayWith(i.value);if(this._hasViewInitialized?i._valuetext.set(r):i._hostElement.setAttribute("aria-valuetext",r),this.discrete){i.thumbPosition===Gt.START?this.startValueIndicatorText=r:this.endValueIndicatorText=r;let n=this._getThumb(i.thumbPosition);r.length<3?n._hostElement.classList.add("mdc-slider__thumb--short-value"):n._hostElement.classList.remove("mdc-slider__thumb--short-value")}}_updateValueIndicatorUIs(){let i=this._getInput(Gt.END),r=this._getInput(Gt.START);i&&this._updateValueIndicatorUI(i),r&&this._updateValueIndicatorUI(r)}_updateTickMarkTrackUI(){if(!this.showTickMarks||this._skipUpdate())return;let i=this._step&&this._step>0?this._step:1,n=(Math.floor(this.max/i)*i-this.min)/(this.max-this.min);this._tickMarkTrackWidth=this._cachedWidth*n-6}_updateTrackUI(i){this._skipUpdate()||(this._isRange?this._updateTrackUIRange(i):this._updateTrackUINonRange(i))}_updateTrackUIRange(i){let r=i.getSibling();if(!r||!this._cachedWidth)return;let n=Math.abs(r.translateX-i.translateX)/this._cachedWidth;i._isLeftThumb&&this._cachedWidth?this._setTrackActiveStyles({left:"auto",right:`${this._cachedWidth-r.translateX}px`,transformOrigin:"right",transform:`scaleX(${n})`}):this._setTrackActiveStyles({left:`${r.translateX}px`,right:"auto",transformOrigin:"left",transform:`scaleX(${n})`})}_updateTrackUINonRange(i){this._isRtl?this._setTrackActiveStyles({left:"auto",right:"0px",transformOrigin:"right",transform:`scaleX(${1-i.fillPercentage})`}):this._setTrackActiveStyles({left:"0px",right:"auto",transformOrigin:"left",transform:`scaleX(${i.fillPercentage})`})}_updateTickMarkUI(){if(!this.showTickMarks||this.step===void 0||this.min===void 0||this.max===void 0)return;let i=this.step>0?this.step:1;this._isRange?this._updateTickMarkUIRange(i):this._updateTickMarkUINonRange(i),this._isRtl&&this._tickMarks.reverse()}_updateTickMarkUINonRange(i){let r=this._getValue(),n=Math.max(Math.floor((r-this.min)/i),0),a=Math.max(Math.floor((this.max-r)/i),0);this._isRtl?n++:a++,this._tickMarks=Array(n).fill(sp.ACTIVE).concat(Array(a).fill(sp.INACTIVE))}_updateTickMarkUIRange(i){let r=this._getValue(),n=this._getValue(Gt.START),a=Math.max(Math.floor((n-this.min)/i),0),o=Math.max(Math.floor((r-n)/i)+1,0),s=Math.max(Math.floor((this.max-r)/i),0);this._tickMarks=Array(a).fill(sp.INACTIVE).concat(Array(o).fill(sp.ACTIVE),Array(s).fill(sp.INACTIVE))}_getInput(i){if(i===Gt.END&&this._input)return this._input;if(this._inputs?.length)return i===Gt.START?this._inputs.first:this._inputs.last}_getThumb(i){return i===Gt.END?this._thumbs?.last:this._thumbs?.first}_setTransition(i){this._hasAnimation=!this._platform.IOS&&i&&!this._noopAnimations,this._elementRef.nativeElement.classList.toggle("mat-mdc-slider-with-animation",this._hasAnimation)}_isCursorOnSliderThumb(i,r){let n=r.width/2,a=r.x+n,o=r.y+n,s=i.clientX-a,l=i.clientY-o;return Math.pow(s,2)+Math.pow(l,2)<Math.pow(n,2)}static{this.\u0275fac=function(r){return new(r||e)(z(Xe),z(Vt),z(nt),z(go,8),z(dv,8),z(zi,8))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-slider"]],contentQueries:function(r,n,a){if(r&1&&(Si(a,Y8,5),Si(a,kse,4)),r&2){let o;Me(o=Ie())&&(n._input=o.first),Me(o=Ie())&&(n._inputs=o)}},viewQuery:function(r,n){if(r&1&&(tt(Sse,5),tt(Z8,5)),r&2){let a;Me(a=Ie())&&(n._trackActive=a.first),Me(a=Ie())&&(n._thumbs=a)}},hostAttrs:[1,"mat-mdc-slider","mdc-slider"],hostVars:12,hostBindings:function(r,n){r&2&&(yr("mat-"+(n.color||"primary")),ft("mdc-slider--range",n._isRange)("mdc-slider--disabled",n.disabled)("mdc-slider--discrete",n.discrete)("mdc-slider--tick-marks",n.showTickMarks)("_mat-animation-noopable",n._noopAnimations))},inputs:{disabled:[de.HasDecoratorInputTransform,"disabled","disabled",ot],discrete:[de.HasDecoratorInputTransform,"discrete","discrete",ot],showTickMarks:[de.HasDecoratorInputTransform,"showTickMarks","showTickMarks",ot],min:[de.HasDecoratorInputTransform,"min","min",Dr],color:"color",disableRipple:[de.HasDecoratorInputTransform,"disableRipple","disableRipple",ot],max:[de.HasDecoratorInputTransform,"max","max",Dr],step:[de.HasDecoratorInputTransform,"step","step",Dr],displayWith:"displayWith"},exportAs:["matSlider"],standalone:!0,features:[_i([{provide:dT,useExisting:e}]),wi,Xt],ngContentSelectors:Ase,decls:9,vars:5,consts:[["trackActive",""],["tickMarkContainer",""],[1,"mdc-slider__track"],[1,"mdc-slider__track--inactive"],[1,"mdc-slider__track--active"],[1,"mdc-slider__track--active_fill"],[1,"mdc-slider__tick-marks"],[3,"discrete","thumbPosition","valueIndicatorText"],[3,"class","transform"]],template:function(r,n){r&1&&(ti(),it(0),S(1,"div",2),ae(2,"div",3),S(3,"div",4),ae(4,"div",5,0),A(),Te(6,Mse,3,1,"div",6),A(),Te(7,Ise,1,3,"mat-slider-visual-thumb",7),ae(8,"mat-slider-visual-thumb",7)),r&2&&(P(6),fi(6,n.showTickMarks?6:-1),P(),fi(7,n._isRange?7:-1),P(),O("discrete",n.discrete)("thumbPosition",2)("valueIndicatorText",n.endValueIndicatorText))},dependencies:[Nse],styles:['.mdc-slider{cursor:pointer;height:48px;margin:0 24px;position:relative;touch-action:pan-y}.mdc-slider .mdc-slider__track{position:absolute;top:50%;transform:translateY(-50%);width:100%}.mdc-slider .mdc-slider__track--active,.mdc-slider .mdc-slider__track--inactive{display:flex;height:100%;position:absolute;width:100%}.mdc-slider .mdc-slider__track--active{overflow:hidden}.mdc-slider .mdc-slider__track--active_fill{border-top-style:solid;box-sizing:border-box;height:100%;width:100%;position:relative;-webkit-transform-origin:left;transform-origin:left}[dir=rtl] .mdc-slider .mdc-slider__track--active_fill,.mdc-slider .mdc-slider__track--active_fill[dir=rtl]{-webkit-transform-origin:right;transform-origin:right}.mdc-slider .mdc-slider__track--inactive{left:0;top:0}.mdc-slider .mdc-slider__track--inactive::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-slider .mdc-slider__track--inactive::before{border-color:CanvasText}}.mdc-slider .mdc-slider__value-indicator-container{bottom:44px;left:50%;left:var(--slider-value-indicator-container-left, 50%);pointer-events:none;position:absolute;right:var(--slider-value-indicator-container-right);transform:translateX(-50%);transform:var(--slider-value-indicator-container-transform, translateX(-50%))}.mdc-slider .mdc-slider__value-indicator{transition:transform 100ms 0ms cubic-bezier(0.4, 0, 1, 1);align-items:center;border-radius:4px;display:flex;height:32px;padding:0 12px;transform:scale(0);transform-origin:bottom}.mdc-slider .mdc-slider__value-indicator::before{border-left:6px solid rgba(0,0,0,0);border-right:6px solid rgba(0,0,0,0);border-top:6px solid;bottom:-5px;content:"";height:0;left:50%;left:var(--slider-value-indicator-caret-left, 50%);position:absolute;right:var(--slider-value-indicator-caret-right);transform:translateX(-50%);transform:var(--slider-value-indicator-caret-transform, translateX(-50%));width:0}.mdc-slider .mdc-slider__value-indicator::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-slider .mdc-slider__value-indicator::after{border-color:CanvasText}}.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator-container{pointer-events:auto}.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:transform 100ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale(1)}@media(prefers-reduced-motion){.mdc-slider .mdc-slider__value-indicator,.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:none}}.mdc-slider .mdc-slider__thumb{display:flex;left:-24px;outline:none;position:absolute;user-select:none;height:48px;width:48px}.mdc-slider .mdc-slider__thumb--top{z-index:1}.mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-style:solid;border-width:1px;box-sizing:content-box}.mdc-slider .mdc-slider__thumb-knob{box-sizing:border-box;left:50%;position:absolute;top:50%;transform:translate(-50%, -50%)}.mdc-slider .mdc-slider__tick-marks{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:space-between;padding:0 1px;position:absolute;width:100%}.mdc-slider--discrete .mdc-slider__thumb,.mdc-slider--discrete .mdc-slider__track--active_fill{transition:transform 80ms ease}@media(prefers-reduced-motion){.mdc-slider--discrete .mdc-slider__thumb,.mdc-slider--discrete .mdc-slider__track--active_fill{transition:none}}.mdc-slider--disabled{cursor:auto}.mdc-slider--disabled .mdc-slider__thumb{pointer-events:none}.mdc-slider__input{cursor:pointer;left:2px;margin:0;height:44px;opacity:0;pointer-events:none;position:absolute;top:2px;width:44px}.mat-mdc-slider{display:inline-block;box-sizing:border-box;outline:none;vertical-align:middle;margin-left:8px;margin-right:8px;width:auto;min-width:112px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-slider .mdc-slider__thumb-knob{background-color:var(--mdc-slider-handle-color);border-color:var(--mdc-slider-handle-color)}.mat-mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb-knob{background-color:var(--mdc-slider-disabled-handle-color);border-color:var(--mdc-slider-disabled-handle-color)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb::before,.mat-mdc-slider .mdc-slider__thumb::after{background-color:var(--mdc-slider-handle-color)}.mat-mdc-slider .mdc-slider__thumb:hover::before,.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-surface--hover::before{opacity:var(--mdc-ripple-hover-opacity)}.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-upgraded--background-focused::before,.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:var(--mdc-ripple-focus-opacity)}.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:var(--mdc-ripple-press-opacity)}.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity)}.mat-mdc-slider .mdc-slider__track--active_fill{border-color:var(--mdc-slider-active-track-color)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__track--active_fill{border-color:var(--mdc-slider-disabled-active-track-color)}.mat-mdc-slider .mdc-slider__track--inactive{background-color:var(--mdc-slider-inactive-track-color);opacity:.24}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__track--inactive{background-color:var(--mdc-slider-disabled-inactive-track-color);opacity:.24}.mat-mdc-slider .mdc-slider__tick-mark--active{background-color:var(--mdc-slider-with-tick-marks-active-container-color);opacity:var(--mdc-slider-with-tick-marks-active-container-opacity)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__tick-mark--active{background-color:var(--mdc-slider-with-tick-marks-active-container-color);opacity:var(--mdc-slider-with-tick-marks-active-container-opacity)}.mat-mdc-slider .mdc-slider__tick-mark--inactive{background-color:var(--mdc-slider-with-tick-marks-inactive-container-color);opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__tick-mark--inactive{background-color:var(--mdc-slider-with-tick-marks-disabled-container-color);opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity)}.mat-mdc-slider .mdc-slider__value-indicator{background-color:var(--mdc-slider-label-container-color);opacity:1}.mat-mdc-slider .mdc-slider__value-indicator::before{border-top-color:var(--mdc-slider-label-container-color)}.mat-mdc-slider .mdc-slider__value-indicator{color:var(--mdc-slider-label-label-text-color)}.mat-mdc-slider .mdc-slider__track{height:var(--mdc-slider-inactive-track-height)}.mat-mdc-slider .mdc-slider__track--active{height:var(--mdc-slider-active-track-height);top:calc((var(--mdc-slider-inactive-track-height) - var(--mdc-slider-active-track-height)) / 2)}.mat-mdc-slider .mdc-slider__track--active_fill{border-top-width:var(--mdc-slider-active-track-height)}.mat-mdc-slider .mdc-slider__track--inactive{height:var(--mdc-slider-inactive-track-height)}.mat-mdc-slider .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-mark--inactive{height:var(--mdc-slider-with-tick-marks-container-size);width:var(--mdc-slider-with-tick-marks-container-size)}.mat-mdc-slider.mdc-slider--disabled{opacity:0.38}.mat-mdc-slider .mdc-slider__value-indicator-text{letter-spacing:var(--mdc-slider-label-label-text-tracking);font-size:var(--mdc-slider-label-label-text-size);font-family:var(--mdc-slider-label-label-text-font);font-weight:var(--mdc-slider-label-label-text-weight);line-height:var(--mdc-slider-label-label-text-line-height)}.mat-mdc-slider .mdc-slider__track--active{border-radius:var(--mdc-slider-active-track-shape)}.mat-mdc-slider .mdc-slider__track--inactive{border-radius:var(--mdc-slider-inactive-track-shape)}.mat-mdc-slider .mdc-slider__thumb-knob{border-radius:var(--mdc-slider-handle-shape);width:var(--mdc-slider-handle-width);height:var(--mdc-slider-handle-height);border-style:solid;border-width:calc(var(--mdc-slider-handle-height) / 2) calc(var(--mdc-slider-handle-width) / 2)}.mat-mdc-slider .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-mark--inactive{border-radius:var(--mdc-slider-with-tick-marks-container-shape)}.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb-knob{background-color:var(--mdc-slider-hover-handle-color);border-color:var(--mdc-slider-hover-handle-color)}.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb-knob{background-color:var(--mdc-slider-focus-handle-color);border-color:var(--mdc-slider-focus-handle-color)}.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:var(--mdc-slider-with-overlap-handle-outline-color);border-width:var(--mdc-slider-with-overlap-handle-outline-width)}.mat-mdc-slider .mdc-slider__thumb-knob{box-shadow:var(--mdc-slider-handle-elevation)}.mat-mdc-slider .mdc-slider__input{box-sizing:content-box;pointer-events:auto}.mat-mdc-slider .mdc-slider__input.mat-mdc-slider-input-no-pointer-events{pointer-events:none}.mat-mdc-slider .mdc-slider__input.mat-slider__right-input{left:auto;right:0}.mat-mdc-slider .mdc-slider__thumb,.mat-mdc-slider .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider.mdc-slider--discrete .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider .mdc-slider__track,.mat-mdc-slider .mdc-slider__thumb{pointer-events:none}.mat-mdc-slider .mdc-slider__value-indicator-container{transform:var(--mat-slider-value-indicator-container-transform)}.mat-mdc-slider .mdc-slider__value-indicator{width:var(--mat-slider-value-indicator-width);height:var(--mat-slider-value-indicator-height);padding:var(--mat-slider-value-indicator-padding);opacity:var(--mat-slider-value-indicator-opacity);border-radius:var(--mat-slider-value-indicator-border-radius)}.mat-mdc-slider .mdc-slider__value-indicator::before{display:var(--mat-slider-value-indicator-caret-display)}.mat-mdc-slider .mdc-slider__value-indicator-text{width:var(--mat-slider-value-indicator-width);transform:var(--mat-slider-value-indicator-text-transform)}.mat-mdc-slider .mat-ripple .mat-ripple-element{background-color:var(--mat-slider-ripple-color)}.mat-mdc-slider .mat-ripple .mat-mdc-slider-hover-ripple{background-color:var(--mat-slider-hover-state-layer-color)}.mat-mdc-slider .mat-ripple .mat-mdc-slider-focus-ripple,.mat-mdc-slider .mat-ripple .mat-mdc-slider-active-ripple{background-color:var(--mat-slider-focus-state-layer-color)}.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__track--active_fill,.mat-mdc-slider._mat-animation-noopable .mdc-slider__value-indicator{transition:none}.mat-mdc-slider .mat-mdc-focus-indicator::before{border-radius:50%}.mat-mdc-slider .mdc-slider__value-indicator{word-break:normal}.mat-mdc-slider .mdc-slider__value-indicator-text{text-align:center}.mdc-slider__thumb--focused .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}}return e})();var Pse={provide:$s,useExisting:Jn(()=>uT),multi:!0};var uT=(()=>{class e{get value(){return Dr(this._hostElement.value,0)}set value(i){i=isNaN(i)?0:i;let r=i+"";if(!this._hasSetInitialValue){this._initialValue=r;return}this._isActive||this._setValue(r)}_setValue(i){this._hostElement.value=i,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges(),this._slider._cdr.markForCheck()}get translateX(){return this._slider.min>=this._slider.max?(this._translateX=this._tickMarkOffset,this._translateX):(this._translateX===void 0&&(this._translateX=this._calcTranslateXByValue()),this._translateX)}set translateX(i){this._translateX=i}get min(){return Dr(this._hostElement.min,0)}set min(i){this._hostElement.min=i+"",this._cdr.detectChanges()}get max(){return Dr(this._hostElement.max,0)}set max(i){this._hostElement.max=i+"",this._cdr.detectChanges()}get step(){return Dr(this._hostElement.step,0)}set step(i){this._hostElement.step=i+"",this._cdr.detectChanges()}get disabled(){return ot(this._hostElement.disabled)}set disabled(i){this._hostElement.disabled=i,this._cdr.detectChanges(),this._slider.disabled!==this.disabled&&(this._slider.disabled=this.disabled)}get percentage(){return this._slider.min>=this._slider.max?this._slider._isRtl?1:0:(this.value-this._slider.min)/(this._slider.max-this._slider.min)}get fillPercentage(){return this._slider._cachedWidth?this._translateX===0?0:this.translateX/this._slider._cachedWidth:this._slider._isRtl?1:0}_setIsFocused(i){this._isFocused=i}constructor(i,r,n,a){this._ngZone=i,this._elementRef=r,this._cdr=n,this._slider=a,this.valueChange=new Pe,this.dragStart=new Pe,this.dragEnd=new Pe,this.thumbPosition=Gt.END,this._valuetext=BM(""),this._knobRadius=8,this._tickMarkOffset=3,this._isActive=!1,this._isFocused=!1,this._hasSetInitialValue=!1,this._destroyed=new ut,this._skipUIUpdate=!1,this._onTouchedFn=()=>{},this._isControlInitialized=!1,this._platform=Ve(pi),this._hostElement=r.nativeElement,this._ngZone.runOutsideAngular(()=>{this._hostElement.addEventListener("pointerdown",this._onPointerDown.bind(this)),this._hostElement.addEventListener("pointermove",this._onPointerMove.bind(this)),this._hostElement.addEventListener("pointerup",this._onPointerUp.bind(this))})}ngOnDestroy(){this._hostElement.removeEventListener("pointerdown",this._onPointerDown),this._hostElement.removeEventListener("pointermove",this._onPointerMove),this._hostElement.removeEventListener("pointerup",this._onPointerUp),this._destroyed.next(),this._destroyed.complete(),this.dragStart.complete(),this.dragEnd.complete()}initProps(){this._updateWidthInactive(),this.disabled!==this._slider.disabled&&(this._slider.disabled=!0),this.step=this._slider.step,this.min=this._slider.min,this.max=this._slider.max,this._initValue()}initUI(){this._updateThumbUIByValue()}_initValue(){this._hasSetInitialValue=!0,this._initialValue===void 0?this.value=this._getDefaultValue():(this._hostElement.value=this._initialValue,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges())}_getDefaultValue(){return this.min}_onBlur(){this._setIsFocused(!1),this._onTouchedFn()}_onFocus(){this._slider._setTransition(!1),this._slider._updateTrackUI(this),this._setIsFocused(!0)}_onChange(){this.valueChange.emit(this.value),this._isActive&&this._updateThumbUIByValue({withAnimation:!0})}_onInput(){this._onChangeFn?.(this.value),(this._slider.step||!this._isActive)&&this._updateThumbUIByValue({withAnimation:!0}),this._slider._onValueChange(this)}_onNgControlValueChange(){(!this._isActive||!this._isFocused)&&(this._slider._onValueChange(this),this._updateThumbUIByValue()),this._slider.disabled=this._formControl.disabled}_onPointerDown(i){if(!(this.disabled||i.button!==0)){if(this._platform.IOS){let r=this._slider._isCursorOnSliderThumb(i,this._slider._getThumb(this.thumbPosition)._hostElement.getBoundingClientRect());this._isActive=r,this._updateWidthActive(),this._slider._updateDimensions();return}this._isActive=!0,this._setIsFocused(!0),this._updateWidthActive(),this._slider._updateDimensions(),this._slider.step||this._updateThumbUIByPointerEvent(i,{withAnimation:!0}),this.disabled||(this._handleValueCorrection(i),this.dragStart.emit({source:this,parent:this._slider,value:this.value}))}}_handleValueCorrection(i){this._skipUIUpdate=!0,setTimeout(()=>{this._skipUIUpdate=!1,this._fixValue(i)},0)}_fixValue(i){let r=i.clientX-this._slider._cachedLeft,n=this._slider._cachedWidth,a=this._slider.step===0?1:this._slider.step,o=Math.floor((this._slider.max-this._slider.min)/a),s=this._slider._isRtl?1-r/n:r/n,c=Math.round(s*o)/o*(this._slider.max-this._slider.min)+this._slider.min,d=Math.round(c/a)*a,u=this.value;if(d===u){this._slider._onValueChange(this),this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(i,{withAnimation:this._slider._hasAnimation});return}this.value=d,this.valueChange.emit(this.value),this._onChangeFn?.(this.value),this._slider._onValueChange(this),this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(i,{withAnimation:this._slider._hasAnimation})}_onPointerMove(i){!this._slider.step&&this._isActive&&this._updateThumbUIByPointerEvent(i)}_onPointerUp(){this._isActive&&(this._isActive=!1,this._platform.SAFARI&&this._setIsFocused(!1),this.dragEnd.emit({source:this,parent:this._slider,value:this.value}),setTimeout(()=>this._updateWidthInactive(),this._platform.IOS?10:0))}_clamp(i){let r=this._tickMarkOffset,n=this._slider._cachedWidth-this._tickMarkOffset;return Math.max(Math.min(i,n),r)}_calcTranslateXByValue(){return this._slider._isRtl?(1-this.percentage)*(this._slider._cachedWidth-this._tickMarkOffset*2)+this._tickMarkOffset:this.percentage*(this._slider._cachedWidth-this._tickMarkOffset*2)+this._tickMarkOffset}_calcTranslateXByPointerEvent(i){return i.clientX-this._slider._cachedLeft}_updateWidthActive(){}_updateWidthInactive(){this._hostElement.style.padding=`0 ${this._slider._inputPadding}px`,this._hostElement.style.width=`calc(100% + ${this._slider._inputPadding-this._tickMarkOffset*2}px)`,this._hostElement.style.left=`-${this._slider._rippleRadius-this._tickMarkOffset}px`}_updateThumbUIByValue(i){this.translateX=this._clamp(this._calcTranslateXByValue()),this._updateThumbUI(i)}_updateThumbUIByPointerEvent(i,r){this.translateX=this._clamp(this._calcTranslateXByPointerEvent(i)),this._updateThumbUI(r)}_updateThumbUI(i){this._slider._setTransition(!!i?.withAnimation),this._slider._onTranslateXChange(this)}writeValue(i){(this._isControlInitialized||i!==null)&&(this.value=i)}registerOnChange(i){this._onChangeFn=i,this._isControlInitialized=!0}registerOnTouched(i){this._onTouchedFn=i}setDisabledState(i){this.disabled=i}focus(){this._hostElement.focus()}blur(){this._hostElement.blur()}static{this.\u0275fac=function(r){return new(r||e)(z(Xe),z(nt),z(Vt),z(dT))}}static{this.\u0275dir=lt({type:e,selectors:[["input","matSliderThumb",""]],hostAttrs:["type","range",1,"mdc-slider__input"],hostVars:1,hostBindings:function(r,n){r&1&&q("change",function(){return n._onChange()})("input",function(){return n._onInput()})("blur",function(){return n._onBlur()})("focus",function(){return n._onFocus()}),r&2&&Ft("aria-valuetext",n._valuetext())},inputs:{value:[de.HasDecoratorInputTransform,"value","value",Dr]},outputs:{valueChange:"valueChange",dragStart:"dragStart",dragEnd:"dragEnd"},exportAs:["matSliderThumb"],standalone:!0,features:[_i([Pse,{provide:Y8,useExisting:e}]),wi]})}}return e})();var Q8=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[Et,jl]})}}return e})();var J8=sd({passive:!0}),eV=(()=>{class e{constructor(i,r){this._platform=i,this._ngZone=r,this._monitoredElements=new Map}monitor(i){if(!this._platform.isBrowser)return Co;let r=Yo(i),n=this._monitoredElements.get(r);if(n)return n.subject;let a=new ut,o="cdk-text-field-autofilled",s=l=>{l.animationName==="cdk-text-field-autofill-start"&&!r.classList.contains(o)?(r.classList.add(o),this._ngZone.run(()=>a.next({target:l.target,isAutofilled:!0}))):l.animationName==="cdk-text-field-autofill-end"&&r.classList.contains(o)&&(r.classList.remove(o),this._ngZone.run(()=>a.next({target:l.target,isAutofilled:!1})))};return this._ngZone.runOutsideAngular(()=>{r.addEventListener("animationstart",s,J8),r.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(r,{subject:a,unlisten:()=>{r.removeEventListener("animationstart",s,J8)}}),a}stopMonitoring(i){let r=Yo(i),n=this._monitoredElements.get(r);n&&(n.unlisten(),n.subject.complete(),r.classList.remove("cdk-text-field-autofill-monitored"),r.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(r))}ngOnDestroy(){this._monitoredElements.forEach((i,r)=>this.stopMonitoring(r))}static{this.\u0275fac=function(r){return new(r||e)(he(pi),he(Xe))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var tV=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({})}}return e})();var Ose=new Be("MAT_INPUT_VALUE_ACCESSOR"),Lse=["button","checkbox","file","hidden","image","radio","range","reset","submit"],Bse=0,iV=(()=>{class e{get disabled(){return this._disabled}set disabled(i){this._disabled=qn(i),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(i){this._id=i||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(Fm.required)??!1}set required(i){this._required=qn(i)}get type(){return this._type}set type(i){this._type=i||"text",this._validateType(),!this._isTextarea&&AA().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(i){this._errorStateTracker.matcher=i}get value(){return this._inputValueAccessor.value}set value(i){i!==this.value&&(this._inputValueAccessor.value=i,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(i){this._readonly=qn(i)}get errorState(){return this._errorStateTracker.errorState}set errorState(i){this._errorStateTracker.errorState=i}constructor(i,r,n,a,o,s,l,c,d,u){this._elementRef=i,this._platform=r,this.ngControl=n,this._autofillMonitor=c,this._formField=u,this._uid=`mat-input-${Bse++}`,this.focused=!1,this.stateChanges=new ut,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(f=>AA().has(f)),this._iOSKeyupListener=f=>{let p=f.target;!p.value&&p.selectionStart===0&&p.selectionEnd===0&&(p.setSelectionRange(1,1),p.setSelectionRange(0,0))};let h=this._elementRef.nativeElement,m=h.nodeName.toLowerCase();this._inputValueAccessor=l||h,this._previousNativeValue=this.value,this.id=this.id,r.IOS&&d.runOutsideAngular(()=>{i.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._errorStateTracker=new Jm(s,n,o,a,this.stateChanges),this._isServer=!this._platform.isBrowser,this._isNativeSelect=m==="select",this._isTextarea=m==="textarea",this._isInFormField=!!u,this._isNativeSelect&&(this.controlType=h.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(i=>{this.autofilled=i.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==null&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(i){this._elementRef.nativeElement.focus(i)}updateErrorState(){this._errorStateTracker.updateErrorState()}_focusChanged(i){i!==this.focused&&(this.focused=i,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){let i=this._elementRef.nativeElement.value;this._previousNativeValue!==i&&(this._previousNativeValue=i,this.stateChanges.next())}_dirtyCheckPlaceholder(){let i=this._getPlaceholder();if(i!==this._previousPlaceholder){let r=this._elementRef.nativeElement;this._previousPlaceholder=i,i?r.setAttribute("placeholder",i):r.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){Lse.indexOf(this._type)>-1}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let i=this._elementRef.nativeElement.validity;return i&&i.badInput}get empty(){return!this._isNeverEmpty()&&!this._elementRef.nativeElement.value&&!this._isBadInput()&&!this.autofilled}get shouldLabelFloat(){if(this._isNativeSelect){let i=this._elementRef.nativeElement,r=i.options[0];return this.focused||i.multiple||!this.empty||!!(i.selectedIndex>-1&&r&&r.label)}else return this.focused||!this.empty}setDescribedByIds(i){i.length?this._elementRef.nativeElement.setAttribute("aria-describedby",i.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){let i=this._elementRef.nativeElement;return this._isNativeSelect&&(i.multiple||i.size>1)}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(pi),z(Gl,10),z(Lg,8),z(Bg,8),z(vy),z(Ose,10),z(eV),z(Xe),z(hv,8))}}static{this.\u0275dir=lt({type:e,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(r,n){r&1&&q("focus",function(){return n._focusChanged(!0)})("blur",function(){return n._focusChanged(!1)})("input",function(){return n._onInput()}),r&2&&(Cs("id",n.id)("disabled",n.disabled)("required",n.required),Ft("name",n.name||null)("readonly",n.readonly&&!n._isNativeSelect||null)("aria-invalid",n.empty&&n.required?null:n.errorState)("aria-required",n.required)("id",n.id),ft("mat-input-server",n._isServer)("mat-mdc-form-field-textarea-control",n._isInFormField&&n._isTextarea)("mat-mdc-form-field-input-control",n._isInFormField)("mdc-text-field__input",n._isInFormField)("mat-mdc-native-select-inline",n._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:[de.None,"aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],standalone:!0,features:[_i([{provide:uv,useExisting:e}]),ir]})}}return e})(),rV=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[Et,Uu,Uu,tV,Et]})}}return e})();var hr=(()=>{class e{cdr;min=1;max=100;step=1;value=15;title="";valueChange=new Pe;constructor(i){this.cdr=i}ngOnInit(){}ngAfterContentInit(){this.cdr.detectChanges()}ngAfterViewInit(){this.cdr.detectChanges()}onChange(i){this.valueChange.emit(i)}static \u0275fac=function(r){return new(r||e)(z(Vt))};static \u0275cmp=Ae({type:e,selectors:[["app-labelled-sliders"]],inputs:{min:"min",max:"max",step:"step",value:"value",title:"title"},outputs:{valueChange:"valueChange"},decls:9,vars:6,consts:[["slider",""],[1,"vertical-flex"],["appearance","fill"],["matInput","","type","text","readonly","true",3,"ngModelChange","ngModel"],["thumbLabel","","tickInterval","auto",3,"min","max","step"],["matSliderThumb","",3,"ngModelChange","valueChange","ngModel"]],template:function(r,n){if(r&1){let a=Ue();S(0,"div",1)(1,"mat-form-field",2)(2,"mat-label"),G(3),A(),S(4,"input",3),Pt("ngModelChange",function(s){return j(a),Dt(n.value,s)||(n.value=s),W(s)}),A()(),S(5,"mat-slider",4,0)(7,"input",5,0),Pt("ngModelChange",function(s){return j(a),Dt(n.value,s)||(n.value=s),W(s)}),q("valueChange",function(s){return j(a),W(n.onChange(s))}),A()()()}r&2&&(P(3),gr(n.title),P(),Nt("ngModel",n.value),P(),O("min",n.min)("max",n.max)("step",n.step),P(2),Nt("ngModel",n.value))},dependencies:[rp,Qs,uT,Rx,yn,an,iV,K8]})}return e})();var nV=["*"],zse=["content"],Use=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],Hse=["mat-drawer","mat-drawer-content","*"];function Gse(e,t){if(e&1){let i=Ue();S(0,"div",1),q("click",function(){j(i);let n=J();return W(n._onBackdropClicked())}),A()}if(e&2){let i=J();ft("mat-drawer-shown",i._isShowingBackdrop())}}function jse(e,t){e&1&&(S(0,"mat-drawer-content"),it(1,2),A())}var Wse={transformDrawer:Ts("transform",[So("open, open-instant",ta({transform:"none",visibility:"visible"})),So("void",ta({"box-shadow":"none",visibility:"hidden"})),Ao("void => open-instant",os("0ms")),Ao("void <=> open, open-instant => void",os("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])};var qse=new Be("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:$se}),aV=new Be("MAT_DRAWER_CONTAINER");function $se(){return!1}var hT=(()=>{class e extends Cy{constructor(i,r,n,a,o){super(n,a,o),this._changeDetectorRef=i,this._container=r}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}static{this.\u0275fac=function(r){return new(r||e)(z(Vt),z(Jn(()=>_v)),z(nt),z(mv),z(Xe))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(r,n){r&2&&ei("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},standalone:!0,features:[_i([{provide:Cy,useExisting:e}]),Ot,Xt],ngContentSelectors:nV,decls:1,vars:0,template:function(r,n){r&1&&(ti(),it(0))},encapsulation:2,changeDetection:0})}}return e})(),vv=(()=>{class e{get position(){return this._position}set position(i){i=i==="end"?"end":"start",i!==this._position&&(this._isAttached&&this._updatePositionInParent(i),this._position=i,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(i){this._mode=i,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(i){this._disableClose=qn(i)}get autoFocus(){let i=this._autoFocus;return i??(this.mode==="side"?"dialog":"first-tabbable")}set autoFocus(i){(i==="true"||i==="false"||i==null)&&(i=qn(i)),this._autoFocus=i}get opened(){return this._opened}set opened(i){this.toggle(qn(i))}constructor(i,r,n,a,o,s,l,c){this._elementRef=i,this._focusTrapFactory=r,this._focusMonitor=n,this._platform=a,this._ngZone=o,this._interactivityChecker=s,this._doc=l,this._container=c,this._focusTrap=null,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new ut,this._animationEnd=new ut,this._animationState="void",this.openedChange=new Pe(!0),this._openedStream=this.openedChange.pipe(Mi(d=>d),Rt(()=>{})),this.openedStart=this._animationStarted.pipe(Mi(d=>d.fromState!==d.toState&&d.toState.indexOf("open")===0),Op(void 0)),this._closedStream=this.openedChange.pipe(Mi(d=>!d),Rt(()=>{})),this.closedStart=this._animationStarted.pipe(Mi(d=>d.fromState!==d.toState&&d.toState==="void"),Op(void 0)),this._destroyed=new ut,this.onPositionChanged=new Pe,this._modeChanged=new ut,this.openedChange.subscribe(d=>{d?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{ya(this._elementRef.nativeElement,"keydown").pipe(Mi(d=>d.keyCode===27&&!this.disableClose&&!vo(d)),yi(this._destroyed)).subscribe(d=>this._ngZone.run(()=>{this.close(),d.stopPropagation(),d.preventDefault()}))}),this._animationEnd.pipe(_d((d,u)=>d.fromState===u.fromState&&d.toState===u.toState)).subscribe(d=>{let{fromState:u,toState:h}=d;(h.indexOf("open")===0&&u==="void"||h==="void"&&u.indexOf("open")===0)&&this.openedChange.emit(this._opened)})}_forceFocus(i,r){this._interactivityChecker.isFocusable(i)||(i.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{let n=()=>{i.removeEventListener("blur",n),i.removeEventListener("mousedown",n),i.removeAttribute("tabindex")};i.addEventListener("blur",n),i.addEventListener("mousedown",n)})),i.focus(r)}_focusByCssSelector(i,r){let n=this._elementRef.nativeElement.querySelector(i);n&&this._forceFocus(n,r)}_takeFocus(){if(!this._focusTrap)return;let i=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(r=>{!r&&typeof this._elementRef.nativeElement.focus=="function"&&i.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus);break}}_restoreFocus(i){this.autoFocus!=="dialog"&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,i):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){let i=this._doc.activeElement;return!!i&&this._elementRef.nativeElement.contains(i)}ngAfterViewInit(){this._isAttached=!0,this._position==="end"&&this._updatePositionInParent("end"),this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState())}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap?.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(i){return this.toggle(!0,i)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(i=!this.opened,r){i&&r&&(this._openedVia=r);let n=this._setOpen(i,!i&&this._isFocusWithinDrawer(),this._openedVia||"program");return i||(this._openedVia=null),n}_setOpen(i,r,n){return this._opened=i,i?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",r&&this._restoreFocus(n)),this._updateFocusTrapState(),new Promise(a=>{this.openedChange.pipe(Br(1)).subscribe(o=>a(o?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=!!this._container?.hasBackdrop)}_updatePositionInParent(i){if(!this._platform.isBrowser)return;let r=this._elementRef.nativeElement,n=r.parentNode;i==="end"?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),n.insertBefore(this._anchor,r)),n.appendChild(r)):this._anchor&&this._anchor.parentNode.insertBefore(r,this._anchor)}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(q4),z(Ks),z(pi),z(Xe),z(RA),z(yt,8),z(aV,8))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-drawer"]],viewQuery:function(r,n){if(r&1&&tt(zse,5),r&2){let a;Me(a=Ie())&&(n._content=a.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(r,n){r&1&&WM("@transform.start",function(o){return n._animationStarted.next(o)})("@transform.done",function(o){return n._animationEnd.next(o)}),r&2&&(jM("@transform",n._animationState),Ft("align",null),ft("mat-drawer-end",n.position==="end")("mat-drawer-over",n.mode==="over")("mat-drawer-push",n.mode==="push")("mat-drawer-side",n.mode==="side")("mat-drawer-opened",n.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],standalone:!0,features:[Xt],ngContentSelectors:nV,decls:3,vars:0,consts:[["content",""],["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(r,n){r&1&&(ti(),S(0,"div",1,0),it(2),A())},dependencies:[Cy],encapsulation:2,data:{animation:[Wse.transformDrawer]},changeDetection:0})}}return e})(),_v=(()=>{class e{get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(i){this._autosize=qn(i)}get hasBackdrop(){return this._drawerHasBackdrop(this._start)||this._drawerHasBackdrop(this._end)}set hasBackdrop(i){this._backdropOverride=i==null?null:qn(i)}get scrollable(){return this._userContent||this._content}constructor(i,r,n,a,o,s=!1,l){this._dir=i,this._element=r,this._ngZone=n,this._changeDetectorRef=a,this._animationMode=l,this._drawers=new wd,this.backdropClick=new Pe,this._destroyed=new ut,this._doCheckSubject=new ut,this._contentMargins={left:null,right:null},this._contentMarginChanges=new ut,i&&i.change.pipe(yi(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),o.change().pipe(yi(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=s}ngAfterContentInit(){this._allDrawers.changes.pipe(wa(this._allDrawers),yi(this._destroyed)).subscribe(i=>{this._drawers.reset(i.filter(r=>!r._container||r._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(wa(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(i=>{this._watchDrawerToggle(i),this._watchDrawerPosition(i),this._watchDrawerMode(i)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(nh(10),yi(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(i=>i.open())}close(){this._drawers.forEach(i=>i.close())}updateContentMargins(){let i=0,r=0;if(this._left&&this._left.opened){if(this._left.mode=="side")i+=this._left._getWidth();else if(this._left.mode=="push"){let n=this._left._getWidth();i+=n,r-=n}}if(this._right&&this._right.opened){if(this._right.mode=="side")r+=this._right._getWidth();else if(this._right.mode=="push"){let n=this._right._getWidth();r+=n,i-=n}}i=i||null,r=r||null,(i!==this._contentMargins.left||r!==this._contentMargins.right)&&(this._contentMargins={left:i,right:r},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(i){i._animationStarted.pipe(Mi(r=>r.fromState!==r.toState),yi(this._drawers.changes)).subscribe(r=>{r.toState!=="open-instant"&&this._animationMode!=="NoopAnimations"&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),i.mode!=="side"&&i.openedChange.pipe(yi(this._drawers.changes)).subscribe(()=>this._setContainerClass(i.opened))}_watchDrawerPosition(i){i&&i.onPositionChanged.pipe(yi(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(Br(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(i){i&&i._modeChanged.pipe(yi(Rn(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(i){let r=this._element.nativeElement.classList,n="mat-drawer-container-has-open";i?r.add(n):r.remove(n)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(i=>{i.position=="end"?(this._end!=null,this._end=i):(this._start!=null,this._start=i)}),this._right=this._left=null,this._dir&&this._dir.value==="rtl"?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&this._start.mode!="over"||this._isDrawerOpen(this._end)&&this._end.mode!="over"}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(i=>i&&!i.disableClose&&this._drawerHasBackdrop(i)).forEach(i=>i._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._drawerHasBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._drawerHasBackdrop(this._end)}_isDrawerOpen(i){return i!=null&&i.opened}_drawerHasBackdrop(i){return this._backdropOverride==null?!!i&&i.mode!=="side":this._backdropOverride}static{this.\u0275fac=function(r){return new(r||e)(z(go,8),z(nt),z(Xe),z(Vt),z(Gu),z(qse),z(zi,8))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-drawer-container"]],contentQueries:function(r,n,a){if(r&1&&(Si(a,hT,5),Si(a,vv,5)),r&2){let o;Me(o=Ie())&&(n._content=o.first),Me(o=Ie())&&(n._allDrawers=o)}},viewQuery:function(r,n){if(r&1&&tt(hT,5),r&2){let a;Me(a=Ie())&&(n._userContent=a.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(r,n){r&2&&ft("mat-drawer-container-explicit-backdrop",n._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],standalone:!0,features:[_i([{provide:aV,useExisting:e}]),Xt],ngContentSelectors:Hse,decls:4,vars:2,consts:[[1,"mat-drawer-backdrop",3,"mat-drawer-shown"],[1,"mat-drawer-backdrop",3,"click"]],template:function(r,n){r&1&&(ti(Use),Te(0,Gse,1,2,"div",0),it(1),it(2,1),Te(3,jse,2,0,"mat-drawer-content")),r&2&&(fi(0,n.hasBackdrop?0:-1),P(3),fi(3,n._content?-1:3))},dependencies:[hT],styles:['.mat-drawer-container{position:relative;z-index:1;color:var(--mat-sidenav-content-text-color);background-color:var(--mat-sidenav-content-background-color);box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible;background-color:var(--mat-sidenav-scrim-color)}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;color:var(--mat-sidenav-container-text-color);box-shadow:var(--mat-sidenav-container-elevation-shadow);background-color:var(--mat-sidenav-container-background-color);border-top-right-radius:var(--mat-sidenav-container-shape);border-bottom-right-radius:var(--mat-sidenav-container-shape);width:var(--mat-sidenav-container-width);display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0);border-top-left-radius:var(--mat-sidenav-container-shape);border-bottom-left-radius:var(--mat-sidenav-container-shape);border-top-right-radius:0;border-bottom-right-radius:0}[dir=rtl] .mat-drawer{border-top-left-radius:var(--mat-sidenav-container-shape);border-bottom-left-radius:var(--mat-sidenav-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{border-top-right-radius:var(--mat-sidenav-container-shape);border-bottom-right-radius:var(--mat-sidenav-container-shape);border-top-left-radius:0;border-bottom-left-radius:0;left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-side{box-shadow:none;border-right-color:var(--mat-sidenav-container-divider-color);border-right-width:1px;border-right-style:solid}.mat-drawer-side.mat-drawer-end{border-left-color:var(--mat-sidenav-container-divider-color);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side{border-left-color:var(--mat-sidenav-container-divider-color);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side.mat-drawer-end{border-right-color:var(--mat-sidenav-container-divider-color);border-right-width:1px;border-right-style:solid;border-left:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0})}}return e})();var oV=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[Et,Hu,Hu,Et]})}}return e})();var Xse=["mat-button",""],cV=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],dV=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"];var Yse=".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}";var Zse=["mat-mini-fab",""],Kse='.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-fab{position:relative;display:inline-flex;position:relative;align-items:center;justify-content:center;box-sizing:border-box;width:56px;height:56px;padding:0;border:none;fill:currentColor;text-decoration:none;cursor:pointer;user-select:none;-moz-appearance:none;-webkit-appearance:none;overflow:visible;transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1),opacity 15ms linear 30ms,transform 270ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-fab .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-fab[hidden]{display:none}.mdc-fab::-moz-focus-inner{padding:0;border:0}.mdc-fab .mdc-fab__focus-ring{position:absolute}.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{border-color:CanvasText}}.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{border-color:CanvasText}}.mdc-fab:active,.mdc-fab:focus{outline:none}.mdc-fab:hover{cursor:pointer}.mdc-fab>svg{width:100%}.mdc-fab--mini{width:40px;height:40px}.mdc-fab--extended{border-radius:24px;padding-left:20px;padding-right:20px;width:auto;max-width:100%;height:48px;line-height:normal}.mdc-fab--extended .mdc-fab__ripple{border-radius:24px}.mdc-fab--extended .mdc-fab__icon{margin-left:calc(12px - 20px);margin-right:12px}[dir=rtl] .mdc-fab--extended .mdc-fab__icon,.mdc-fab--extended .mdc-fab__icon[dir=rtl]{margin-left:12px;margin-right:calc(12px - 20px)}.mdc-fab--extended .mdc-fab__label+.mdc-fab__icon{margin-left:12px;margin-right:calc(12px - 20px)}[dir=rtl] .mdc-fab--extended .mdc-fab__label+.mdc-fab__icon,.mdc-fab--extended .mdc-fab__label+.mdc-fab__icon[dir=rtl]{margin-left:calc(12px - 20px);margin-right:12px}.mdc-fab--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-fab--touch .mdc-fab__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-fab::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-fab::before{border-color:CanvasText}}.mdc-fab__label{justify-content:flex-start;text-overflow:ellipsis;white-space:nowrap;overflow-x:hidden;overflow-y:visible}.mdc-fab__icon{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}.mdc-fab .mdc-fab__icon{display:inline-flex;align-items:center;justify-content:center}.mdc-fab--exited{transform:scale(0);opacity:0;transition:opacity 15ms linear 150ms,transform 180ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-fab--exited .mdc-fab__icon{transform:scale(0);transition:transform 135ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mat-mdc-fab{background-color:var(--mdc-fab-container-color)}.mat-mdc-fab .mdc-fab__icon{width:var(--mdc-fab-icon-size);height:var(--mdc-fab-icon-size);font-size:var(--mdc-fab-icon-size)}.mat-mdc-fab:not(.mdc-fab--extended){border-radius:var(--mdc-fab-container-shape)}.mat-mdc-fab:not(.mdc-fab--extended) .mdc-fab__ripple{border-radius:var(--mdc-fab-container-shape)}.mat-mdc-mini-fab{background-color:var(--mdc-fab-small-container-color)}.mat-mdc-mini-fab .mdc-fab__icon{width:var(--mdc-fab-small-icon-size);height:var(--mdc-fab-small-icon-size);font-size:var(--mdc-fab-small-icon-size)}.mat-mdc-mini-fab:not(.mdc-fab--extended){border-radius:var(--mdc-fab-small-container-shape)}.mat-mdc-mini-fab:not(.mdc-fab--extended) .mdc-fab__ripple{border-radius:var(--mdc-fab-small-container-shape)}.mat-mdc-extended-fab{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mdc-extended-fab-container-height);border-radius:var(--mdc-extended-fab-container-shape);font-family:var(--mdc-extended-fab-label-text-font);font-size:var(--mdc-extended-fab-label-text-size);font-weight:var(--mdc-extended-fab-label-text-weight);letter-spacing:var(--mdc-extended-fab-label-text-tracking)}.mat-mdc-extended-fab .mdc-fab__ripple{border-radius:var(--mdc-extended-fab-container-shape)}.mat-mdc-fab,.mat-mdc-mini-fab{-webkit-tap-highlight-color:rgba(0,0,0,0);flex-shrink:0}.mat-mdc-fab .mat-mdc-button-ripple,.mat-mdc-fab .mat-mdc-button-persistent-ripple,.mat-mdc-fab .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab .mat-mdc-button-ripple,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-fab .mat-mdc-button-ripple,.mat-mdc-mini-fab .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-fab .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-fab .mdc-button__label,.mat-mdc-mini-fab .mdc-button__label{z-index:1}.mat-mdc-fab .mat-mdc-focus-indicator,.mat-mdc-mini-fab .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-fab:focus .mat-mdc-focus-indicator::before,.mat-mdc-mini-fab:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-fab._mat-animation-noopable,.mat-mdc-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-fab:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-mini-fab:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}.mat-mdc-fab .mat-icon,.mat-mdc-fab .material-icons,.mat-mdc-mini-fab .mat-icon,.mat-mdc-mini-fab .material-icons{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}.mat-mdc-fab .mat-mdc-focus-indicator::before,.mat-mdc-mini-fab .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-fab[disabled],.mat-mdc-fab.mat-mdc-button-disabled,.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none}.mat-mdc-fab[disabled],.mat-mdc-fab[disabled]:focus,.mat-mdc-fab.mat-mdc-button-disabled,.mat-mdc-fab.mat-mdc-button-disabled:focus,.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab[disabled]:focus,.mat-mdc-mini-fab.mat-mdc-button-disabled,.mat-mdc-mini-fab.mat-mdc-button-disabled:focus{box-shadow:none}.mat-mdc-fab.mat-mdc-button-disabled-interactive,.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-fab{color:var(--mat-fab-foreground-color, inherit);box-shadow:var(--mdc-fab-container-elevation-shadow)}.mat-mdc-fab .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-fab-touch-target-display)}.mat-mdc-fab .mat-ripple-element{background-color:var(--mat-fab-ripple-color)}.mat-mdc-fab .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-state-layer-color)}.mat-mdc-fab.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-disabled-state-layer-color)}.mat-mdc-fab:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-hover-state-layer-opacity)}.mat-mdc-fab.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-fab.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-fab.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-focus-state-layer-opacity)}.mat-mdc-fab:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-pressed-state-layer-opacity)}.mat-mdc-fab:hover{box-shadow:var(--mdc-fab-hover-container-elevation-shadow)}.mat-mdc-fab:focus{box-shadow:var(--mdc-fab-focus-container-elevation-shadow)}.mat-mdc-fab:active,.mat-mdc-fab:focus:active{box-shadow:var(--mdc-fab-pressed-container-elevation-shadow)}.mat-mdc-fab[disabled],.mat-mdc-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-fab-disabled-state-foreground-color);background-color:var(--mat-fab-disabled-state-container-color)}.mat-mdc-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-mini-fab{color:var(--mat-fab-small-foreground-color, inherit);box-shadow:var(--mdc-fab-small-container-elevation-shadow)}.mat-mdc-mini-fab .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-fab-small-touch-target-display)}.mat-mdc-mini-fab .mat-ripple-element{background-color:var(--mat-fab-small-ripple-color)}.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-small-state-layer-color)}.mat-mdc-mini-fab.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-small-disabled-state-layer-color)}.mat-mdc-mini-fab:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-hover-state-layer-opacity)}.mat-mdc-mini-fab.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-focus-state-layer-opacity)}.mat-mdc-mini-fab:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-pressed-state-layer-opacity)}.mat-mdc-mini-fab:hover{box-shadow:var(--mdc-fab-small-hover-container-elevation-shadow)}.mat-mdc-mini-fab:focus{box-shadow:var(--mdc-fab-small-focus-container-elevation-shadow)}.mat-mdc-mini-fab:active,.mat-mdc-mini-fab:focus:active{box-shadow:var(--mdc-fab-small-pressed-container-elevation-shadow)}.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-fab-small-disabled-state-foreground-color);background-color:var(--mat-fab-small-disabled-state-container-color)}.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-extended-fab{box-shadow:var(--mdc-extended-fab-container-elevation-shadow)}.mat-mdc-extended-fab:hover{box-shadow:var(--mdc-extended-fab-hover-container-elevation-shadow)}.mat-mdc-extended-fab:focus{box-shadow:var(--mdc-extended-fab-focus-container-elevation-shadow)}.mat-mdc-extended-fab:active,.mat-mdc-extended-fab:focus:active{box-shadow:var(--mdc-extended-fab-pressed-container-elevation-shadow)}.mat-mdc-extended-fab[disabled],.mat-mdc-extended-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none}.mat-mdc-extended-fab[disabled],.mat-mdc-extended-fab[disabled]:focus,.mat-mdc-extended-fab.mat-mdc-button-disabled,.mat-mdc-extended-fab.mat-mdc-button-disabled:focus{box-shadow:none}.mat-mdc-extended-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-extended-fab>.mat-icon,.mat-mdc-extended-fab>.material-icons{margin-left:calc(12px - 20px);margin-right:12px}[dir=rtl] .mat-mdc-extended-fab>.mat-icon,[dir=rtl] .mat-mdc-extended-fab>.material-icons,.mat-mdc-extended-fab>.mat-icon[dir=rtl],.mat-mdc-extended-fab>.material-icons[dir=rtl]{margin-left:12px;margin-right:calc(12px - 20px)}.mat-mdc-extended-fab .mat-mdc-button-touch-target{width:100%}.mat-mdc-extended-fab .mdc-button__label+.mat-icon,.mat-mdc-extended-fab .mdc-button__label+.material-icons{margin-left:12px;margin-right:calc(12px - 20px)}[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.material-icons,.mat-mdc-extended-fab .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-extended-fab .mdc-button__label+.material-icons[dir=rtl]{margin-left:calc(12px - 20px);margin-right:12px}',Qse=["mat-icon-button",""],Jse=["*"];var ele=new Be("MAT_BUTTON_CONFIG");var tle=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],mT=(()=>{class e{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(i){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,i)}get disableRipple(){return this._disableRipple}set disableRipple(i){this._disableRipple=i,this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(i){this._disabled=i,this._updateRippleDisabled()}constructor(i,r,n,a){this._elementRef=i,this._platform=r,this._ngZone=n,this._animationMode=a,this._focusMonitor=Ve(Ks),this._rippleLoader=Ve(o8),this._isFab=!1,this._disableRipple=!1,this._disabled=!1;let o=Ve(ele,{optional:!0}),s=i.nativeElement,l=s.classList;this.disabledInteractive=o?.disabledInteractive??!1,this._rippleLoader?.configureRipple(s,{className:"mat-mdc-button-ripple"});for(let{attribute:c,mdcClasses:d}of tle)s.hasAttribute(c)&&l.add(...d)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(i="program",r){i?this._focusMonitor.focusVia(this._elementRef.nativeElement,i,r):this._elementRef.nativeElement.focus(r)}_getAriaDisabled(){return this.ariaDisabled!=null?this.ariaDisabled:this.disabled&&this.disabledInteractive?!0:null}_getDisabledAttribute(){return this.disabledInteractive||!this.disabled?null:!0}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static{this.\u0275fac=function(r){sh()}}static{this.\u0275dir=lt({type:e,inputs:{color:"color",disableRipple:[de.HasDecoratorInputTransform,"disableRipple","disableRipple",ot],disabled:[de.HasDecoratorInputTransform,"disabled","disabled",ot],ariaDisabled:[de.HasDecoratorInputTransform,"aria-disabled","ariaDisabled",ot],disabledInteractive:[de.HasDecoratorInputTransform,"disabledInteractive","disabledInteractive",ot]},features:[wi]})}}return e})();var Lr=(()=>{class e extends mT{constructor(i,r,n,a){super(i,r,n,a)}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(pi),z(Xe),z(zi,8))}}static{this.\u0275cmp=Ae({type:e,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(r,n){r&2&&(Ft("disabled",n._getDisabledAttribute())("aria-disabled",n._getAriaDisabled()),yr(n.color?"mat-"+n.color:""),ft("mat-mdc-button-disabled",n.disabled)("mat-mdc-button-disabled-interactive",n.disabledInteractive)("_mat-animation-noopable",n._animationMode==="NoopAnimations")("mat-unthemed",!n.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[Ot,Xt],attrs:Xse,ngContentSelectors:dV,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(r,n){r&1&&(ti(cV),ae(0,"span",0),it(1),S(2,"span",1),it(3,1),A(),it(4,2),ae(5,"span",2)(6,"span",3)),r&2&&ft("mdc-button__ripple",!n._isFab)("mdc-fab__ripple",n._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px);display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{font-family:var(--mdc-text-button-label-text-font);font-size:var(--mdc-text-button-label-text-size);letter-spacing:var(--mdc-text-button-label-text-tracking);font-weight:var(--mdc-text-button-label-text-weight);text-transform:var(--mdc-text-button-label-text-transform);height:var(--mdc-text-button-container-height);border-radius:var(--mdc-text-button-container-shape);padding:0 var(--mat-text-button-horizontal-padding, 8px)}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape)}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 8px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color)}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color)}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color)}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity)}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity)}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity)}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display)}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-unelevated-button{font-family:var(--mdc-filled-button-label-text-font);font-size:var(--mdc-filled-button-label-text-size);letter-spacing:var(--mdc-filled-button-label-text-tracking);font-weight:var(--mdc-filled-button-label-text-weight);text-transform:var(--mdc-filled-button-label-text-transform);height:var(--mdc-filled-button-container-height);border-radius:var(--mdc-filled-button-container-shape);padding:0 var(--mat-filled-button-horizontal-padding, 16px)}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color)}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color)}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color)}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity)}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity)}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity)}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display)}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color);background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{font-family:var(--mdc-protected-button-label-text-font);font-size:var(--mdc-protected-button-label-text-size);letter-spacing:var(--mdc-protected-button-label-text-tracking);font-weight:var(--mdc-protected-button-label-text-weight);text-transform:var(--mdc-protected-button-label-text-transform);height:var(--mdc-protected-button-container-height);border-radius:var(--mdc-protected-button-container-shape);padding:0 var(--mat-protected-button-horizontal-padding, 16px);box-shadow:var(--mdc-protected-button-container-elevation-shadow)}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color)}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color)}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color)}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color)}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity)}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity)}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity)}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display)}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow)}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow)}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow)}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color);background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow)}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{font-family:var(--mdc-outlined-button-label-text-font);font-size:var(--mdc-outlined-button-label-text-size);letter-spacing:var(--mdc-outlined-button-label-text-tracking);font-weight:var(--mdc-outlined-button-label-text-weight);text-transform:var(--mdc-outlined-button-label-text-transform);height:var(--mdc-outlined-button-container-height);border-radius:var(--mdc-outlined-button-container-shape);padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width);padding:0 var(--mat-outlined-button-horizontal-padding, 15px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color)}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape)}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color)}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width))}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color)}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color)}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity)}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity)}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity)}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display)}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color);border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button-base{text-decoration:none}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px)*-1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}}return e})();var ile=new Be("mat-mdc-fab-default-options",{providedIn:"root",factory:uV});function uV(){return{color:"accent"}}var lV=uV();var lp=(()=>{class e extends mT{constructor(i,r,n,a,o){super(i,r,n,a),this._options=o,this._isFab=!0,this._options=this._options||lV,this.color=this._options.color||lV.color}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(pi),z(Xe),z(zi,8),z(ile,8))}}static{this.\u0275cmp=Ae({type:e,selectors:[["button","mat-mini-fab",""]],hostVars:14,hostBindings:function(r,n){r&2&&(Ft("disabled",n._getDisabledAttribute())("aria-disabled",n._getAriaDisabled()),yr(n.color?"mat-"+n.color:""),ft("mat-mdc-button-disabled",n.disabled)("mat-mdc-button-disabled-interactive",n.disabledInteractive)("_mat-animation-noopable",n._animationMode==="NoopAnimations")("mat-unthemed",!n.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[Ot,Xt],attrs:Zse,ngContentSelectors:dV,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(r,n){r&1&&(ti(cV),ae(0,"span",0),it(1),S(2,"span",1),it(3,1),A(),it(4,2),ae(5,"span",2)(6,"span",3)),r&2&&ft("mdc-button__ripple",!n._isFab)("mdc-fab__ripple",n._isFab)},styles:[Kse],encapsulation:2,changeDetection:0})}}return e})();var Oy=(()=>{class e extends mT{constructor(i,r,n,a){super(i,r,n,a),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(pi),z(Xe),z(zi,8))}}static{this.\u0275cmp=Ae({type:e,selectors:[["button","mat-icon-button",""]],hostVars:14,hostBindings:function(r,n){r&2&&(Ft("disabled",n._getDisabledAttribute())("aria-disabled",n._getAriaDisabled()),yr(n.color?"mat-"+n.color:""),ft("mat-mdc-button-disabled",n.disabled)("mat-mdc-button-disabled-interactive",n.disabledInteractive)("_mat-animation-noopable",n._animationMode==="NoopAnimations")("mat-unthemed",!n.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[Ot,Xt],attrs:Qse,ngContentSelectors:Jse,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(r,n){r&1&&(ti(),ae(0,"span",0),it(1),ae(2,"span",1)(3,"span",2))},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{color:var(--mdc-icon-button-icon-color)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{border-radius:50%;flex-shrink:0;text-align:center;width:var(--mdc-icon-button-state-layer-size, 48px);height:var(--mdc-icon-button-state-layer-size, 48px);padding:calc(calc(var(--mdc-icon-button-state-layer-size, 48px) - var(--mdc-icon-button-icon-size, 24px)) / 2);font-size:var(--mdc-icon-button-icon-size);-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled],.mat-mdc-icon-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-icon-button-ripple-color)}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-state-layer-color)}.mat-mdc-icon-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-disabled-state-layer-color)}.mat-mdc-icon-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-hover-state-layer-opacity)}.mat-mdc-icon-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-focus-state-layer-opacity)}.mat-mdc-icon-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-pressed-state-layer-opacity)}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-icon-button-touch-target-display)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',Yse],encapsulation:2,changeDetection:0})}}return e})();var hV=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[Et,jl,Et]})}}return e})();var rle=["*",[["mat-toolbar-row"]]],nle=["*","mat-toolbar-row"],bv=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=lt({type:e,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"],standalone:!0})}}return e})(),cp=(()=>{class e{constructor(i,r,n){this._elementRef=i,this._platform=r,this._document=n}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(pi),z(yt))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-toolbar"]],contentQueries:function(r,n,a){if(r&1&&Si(a,bv,5),r&2){let o;Me(o=Ie())&&(n._toolbarRows=o)}},hostAttrs:[1,"mat-toolbar"],hostVars:6,hostBindings:function(r,n){r&2&&(yr(n.color?"mat-"+n.color:""),ft("mat-toolbar-multiple-rows",n._toolbarRows.length>0)("mat-toolbar-single-row",n._toolbarRows.length===0))},inputs:{color:"color"},exportAs:["matToolbar"],standalone:!0,features:[Xt],ngContentSelectors:nle,decls:2,vars:0,template:function(r,n){r&1&&(ti(rle),it(0),it(1,1))},styles:[".mat-toolbar{background:var(--mat-toolbar-container-background-color);color:var(--mat-toolbar-container-text-color)}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font);font-size:var(--mat-toolbar-title-text-size);line-height:var(--mat-toolbar-title-text-line-height);font-weight:var(--mat-toolbar-title-text-weight);letter-spacing:var(--mat-toolbar-title-text-tracking);margin:0}.cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color:var(--mat-toolbar-container-text-color);--mdc-outlined-button-label-text-color:var(--mat-toolbar-container-text-color)}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height)}}"],encapsulation:2,changeDetection:0})}}return e})();var mV=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[Et,Et]})}}return e})();var ale=["*",[["","drawerLeft",""]],[["","drawerRight",""]],[["","centerContent",""]]],ole=["*","[drawerLeft]","[drawerRight]","[centerContent]"];function sle(e,t){if(e&1){let i=Ue();S(0,"button",10),q("click",function(){j(i),J();let n=kt(12);return W(n.toggle())}),S(1,"mat-icon"),G(2,"menu"),A()()}}function lle(e,t){if(e&1){let i=Ue();S(0,"button",10),q("click",function(){j(i),J();let n=kt(16);return W(n.toggle())}),S(1,"mat-icon"),G(2,"menu"),A()()}}var Ga=(()=>{class e{leftDrawer=!0;rightDrawer=!0;constructor(){}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Ae({type:e,selectors:[["app-tutorial-template"]],inputs:{leftDrawer:"leftDrawer",rightDrawer:"rightDrawer"},ngContentSelectors:ole,decls:21,vars:4,consts:[["drawerLeft",""],["drawerRight",""],["color","primary"],["mat-icon-button","","class","example-icon",3,"click",4,"ngIf"],["routerLink","/home",1,"show-smallscreen"],["mat-icon-button","",1,"example-icon"],["mode","side",3,"opened"],[1,"vertical-flex","drawer"],["mode","side","position","end",3,"opened"],[1,"horizontal-flex","drawer-container"],["mat-icon-button","",1,"example-icon",3,"click"]],template:function(r,n){r&1&&(ti(ale),S(0,"mat-toolbar",2)(1,"mat-toolbar-row"),Te(2,sle,3,0,"button",3),S(3,"a",4)(4,"button",5)(5,"mat-icon"),G(6,"home"),A()()(),S(7,"span"),it(8),A(),Te(9,lle,3,0,"button",3),A()(),S(10,"mat-drawer-container")(11,"mat-drawer",6,0)(13,"div",7),it(14,1),A()(),S(15,"mat-drawer",8,1),ae(17,"div",7),it(18,2),A(),S(19,"div",9),it(20,3),A()()),r&2&&(P(2),O("ngIf",n.leftDrawer),P(7),O("ngIf",n.rightDrawer),P(2),O("opened",n.leftDrawer),P(4),O("opened",n.rightDrawer))},dependencies:[cn,vv,_v,Oy,cp,bv,$n,rd],styles:["mat-drawer[_ngcontent-%COMP%]{max-width:50vw}mat-toolbar-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:100%;text-align:center}.loading[_ngcontent-%COMP%]{position:fixed;z-index:100;top:50%;left:50%;transform:translate(-50%,-50%);background-color:#000c;width:100vw;height:100vh;justify-content:center;align-items:center;display:flex}.drawer[_ngcontent-%COMP%]{padding:1em .25em;align-items:center}.drawer-container[_ngcontent-%COMP%]{gap:1em;justify-content:center;align-items:center;margin-top:1em}[_nghost-%COMP%]     h2{text-align:center;margin:1ch}"]})}return e})();var cle=["determinateSpinner"];function dle(e,t){if(e&1&&(Ca(),S(0,"svg",11),ae(1,"circle",12),A()),e&2){let i=J();Ft("viewBox",i._viewBox()),P(),ei("stroke-dasharray",i._strokeCircumference(),"px")("stroke-dashoffset",i._strokeCircumference()/2,"px")("stroke-width",i._circleStrokeWidth(),"%"),Ft("r",i._circleRadius())}}var ule=new Be("mat-progress-spinner-default-options",{providedIn:"root",factory:hle});function hle(){return{diameter:pV}}var pV=100,mle=10,fV=(()=>{class e{get color(){return this._color||this._defaultColor}set color(i){this._color=i}constructor(i,r,n){this._elementRef=i,this._defaultColor="primary",this._value=0,this._diameter=pV,this._noopAnimations=r==="NoopAnimations"&&!!n&&!n._forceAnimations,this.mode=i.nativeElement.nodeName.toLowerCase()==="mat-spinner"?"indeterminate":"determinate",n&&(n.color&&(this.color=this._defaultColor=n.color),n.diameter&&(this.diameter=n.diameter),n.strokeWidth&&(this.strokeWidth=n.strokeWidth))}get value(){return this.mode==="determinate"?this._value:0}set value(i){this._value=Math.max(0,Math.min(100,i||0))}get diameter(){return this._diameter}set diameter(i){this._diameter=i||0}get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(i){this._strokeWidth=i||0}_circleRadius(){return(this.diameter-mle)/2}_viewBox(){let i=this._circleRadius()*2+this.strokeWidth;return`0 0 ${i} ${i}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return this.mode==="determinate"?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(zi,8),z(ule))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(r,n){if(r&1&&tt(cle,5),r&2){let a;Me(a=Ie())&&(n._determinateCircle=a.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:18,hostBindings:function(r,n){r&2&&(Ft("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow",n.mode==="determinate"?n.value:null)("mode",n.mode),yr("mat-"+n.color),ei("width",n.diameter,"px")("height",n.diameter,"px")("--mdc-circular-progress-size",n.diameter+"px")("--mdc-circular-progress-active-indicator-width",n.diameter+"px"),ft("_mat-animation-noopable",n._noopAnimations)("mdc-circular-progress--indeterminate",n.mode==="indeterminate"))},inputs:{color:"color",mode:"mode",value:[de.HasDecoratorInputTransform,"value","value",Dr],diameter:[de.HasDecoratorInputTransform,"diameter","diameter",Dr],strokeWidth:[de.HasDecoratorInputTransform,"strokeWidth","strokeWidth",Dr]},exportAs:["matProgressSpinner"],standalone:!0,features:[wi,Xt],decls:14,vars:11,consts:[["circle",""],["determinateSpinner",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(r,n){if(r&1&&(Te(0,dle,2,8,"ng-template",null,0,Ed),S(2,"div",2,1),Ca(),S(4,"svg",3),ae(5,"circle",4),A()(),Bp(),S(6,"div",5)(7,"div",6)(8,"div",7),uh(9,8),A(),S(10,"div",9),uh(11,8),A(),S(12,"div",10),uh(13,8),A()()()),r&2){let a=kt(1);P(4),Ft("viewBox",n._viewBox()),P(),ei("stroke-dasharray",n._strokeCircumference(),"px")("stroke-dashoffset",n._strokeDashOffset(),"px")("stroke-width",n._circleStrokeWidth(),"%"),Ft("r",n._circleRadius()),P(4),O("ngTemplateOutlet",a),P(2),O("ngTemplateOutlet",a),P(2),O("ngTemplateOutlet",a)}},dependencies:[Dd],styles:["@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-color-1-fade-in-out{from{opacity:.99}25%{opacity:.99}26%{opacity:0}89%{opacity:0}90%{opacity:.99}to{opacity:.99}}@keyframes mdc-circular-progress-color-2-fade-in-out{from{opacity:0}15%{opacity:0}25%{opacity:.99}50%{opacity:.99}51%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-3-fade-in-out{from{opacity:0}40%{opacity:0}50%{opacity:.99}75%{opacity:.99}76%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-4-fade-in-out{from{opacity:0}65%{opacity:0}75%{opacity:.99}90%{opacity:.99}to{opacity:0}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}.mdc-circular-progress{display:inline-flex;position:relative;direction:ltr;line-height:0;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-1{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-1-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-2{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-2-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-3{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-3-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-4{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-4-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--closed{opacity:0}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color)}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width)}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-1 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-2 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-3 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-4 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mat-mdc-progress-spinner .mdc-circular-progress{width:var(--mdc-circular-progress-size) !important;height:var(--mdc-circular-progress-size) !important}.mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}"],encapsulation:2,changeDetection:0})}}return e})();var gV=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[On,Et]})}}return e})();var vV=(()=>{class e{uiservice;loadingEvent=new Pe;showPresetEvent=new Pe;constructor(i){this.uiservice=i}ngOnInit(){}loading(i){i.target.files&&i.target.files[0]&&this.loadingEvent.emit(i.target.files[0])}toggleShowImagePreset(){this.uiservice.toggleImagePreset()}static \u0275fac=function(r){return new(r||e)(z(ad))};static \u0275cmp=Ae({type:e,selectors:[["app-loading-buttons"]],outputs:{loadingEvent:"loadingEvent",showPresetEvent:"showPresetEvent"},decls:6,vars:0,consts:[["fileInput",""],["type","button","mat-raised-button","","color","primary",3,"click"],["hidden","","type","file","accept","images/*",3,"change"]],template:function(r,n){if(r&1){let a=Ue();S(0,"button",1),q("click",function(){return j(a),W(n.toggleShowImagePreset())}),G(1,"Show preset"),A(),S(2,"button",1),q("click",function(){j(a);let s=kt(5);return W(s.click())}),G(3,` Load image
`),A(),S(4,"input",2,0),q("change",function(s){return j(a),W(n.loading(s))}),A()}},dependencies:[Lr]})}return e})();var _V=[{name:"Fourier Transform",content:[{name:"House",url:"assets/image_presets/House.jpeg"},{name:"Moon",url:"assets/image_presets/Moon.jpeg"},{name:"CT Scan",url:"assets/image_presets/CTandstripes.jpeg"},{name:"X Ray",url:"assets/image_presets/XrayBar.jpeg"}]},{name:"Morphological Operations",content:[{name:"Hello",url:"assets/image_presets/Hello.jpeg"},{name:"Tree",url:"assets/image_presets/arbre_binaire.jpeg"},{name:"Little Guy",url:"assets/image_presets/bonhomme_morpho.jpeg"}]},{name:"Miscellaneous",content:[{name:"Phantom",url:"assets/image_presets/phantom.png"}]},{name:"Color images",content:[{name:"Peppers",url:"assets/image_presets/poivron.jpeg"},{name:"Butterfly",url:"assets/image_presets/papillon.jpg"},{name:"Homomorphic Flower",url:"assets/image_presets/hibiscus_homomorphic.jpg"}]}];function vle(e,t){if(e&1){let i=Ue();S(0,"div",3)(1,"button",4),q("click",function(){let n=j(i).$implicit,a=J(2);return W(a.loadSelectedImage(n.url))}),G(2),A(),ae(3,"div",5)(4,"img",6),A()}if(e&2){let i=t.$implicit;P(2),Vr(" ",i.name," "),P(2),O("src",i.url,FM)}}function _le(e,t){if(e&1&&(S(0,"div")(1,"p"),G(2),A(),Te(3,vle,5,2,"div",2),A()),e&2){let i=t.$implicit;P(2),gr(i.name),P(),O("ngForOf",i.content)}}var bV=(()=>{class e{uiservice;presetEvent=new Pe;images_presets=_V;constructor(i){this.uiservice=i}ngOnInit(){}loadSelectedImage(i){this.uiservice.toggleImagePreset(),this.presetEvent.emit(i)}static \u0275fac=function(r){return new(r||e)(z(ad))};static \u0275cmp=Ae({type:e,selectors:[["app-image-presets"]],outputs:{presetEvent:"presetEvent"},decls:5,vars:1,consts:[["mat-button","","color","primary",3,"click"],[4,"ngFor","ngForOf"],["class","horizontal-align",4,"ngFor","ngForOf"],[1,"horizontal-align"],["mat-button","",3,"click"],[1,"filler"],["alt","image.name","width","32px","height","32px",1,"rounded",3,"src"]],template:function(r,n){r&1&&(S(0,"button",0),q("click",function(){return n.uiservice.toggleImagePreset()}),G(1,`
Close `),S(2,"mat-icon"),G(3,"close"),A()(),Te(4,_le,4,2,"div",1)),r&2&&(P(4),O("ngForOf",n.images_presets))},dependencies:[Fn,Lr,$n],styles:[".horizontal-align[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row}.horizontal-align[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:first-child{align-self:flex-start}.filler[_ngcontent-%COMP%]{flex-grow:1}.horizontal-align[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:last-child{align-self:flex-end}.rounded[_ngcontent-%COMP%]{border-radius:50%}"]})}return e})();var xle=["inputCanvas"],yle=["*",[["","drawerRight",""]],[["","centerContent",""]],[["","drawerLeft",""]]],wle=["*","[drawerRight]","[centerContent]","[drawerLeft]"];function Cle(e,t){e&1&&(S(0,"div",12),ae(1,"mat-spinner",13),A()),e&2&&(P(),O("diameter",300))}function Ele(e,t){if(e&1){let i=Ue();S(0,"button",14),q("click",function(){j(i),J();let n=kt(13);return W(n.toggle())}),S(1,"mat-icon"),G(2,"menu"),A()()}}function Sle(e,t){if(e&1){let i=Ue();S(0,"button",14),q("click",function(){j(i),J();let n=kt(18);return W(n.toggle())}),S(1,"mat-icon"),G(2,"menu"),A()()}}function Ale(e,t){if(e&1){let i=Ue();At(0),S(1,"app-loading-buttons",15),q("loadingEvent",function(n){j(i);let a=J();return W(a.loadSelectedFile(n))}),A(),ae(2,"hr"),S(3,"button",16),q("click",function(){j(i);let n=J();return W(n.drawCanvasContained.clearCanvas())}),G(4," Clear "),A(),ae(5,"hr"),it(6,3),Tt()}}function Tle(e,t){if(e&1){let i=Ue();At(0),S(1,"app-image-presets",17),q("presetEvent",function(n){j(i);let a=J();return W(a.loadSelectedFileFromPath(n))}),A(),Tt()}}var ja=(()=>{class e extends Ga{ngxOpenCv;uiservice;cdr;cvState;drawCanvasContained;profileOptions;sideMenuContext=!0;constructor(i,r,n){super(),this.ngxOpenCv=i,this.uiservice=r,this.cdr=n}ngAfterViewInit(){this.ngxOpenCv.cvState.subscribe(i=>{console.log("OpenCV.js is ready",i),this.cvState=i.toString()}),this.cdr.detectChanges()}loadSelectedFileFromPath(i){let r=new Image;r.onerror=n=>{console.log("Loading failed")},r.src=i,r.onload=()=>{this.drawCanvasContained&&this.drawCanvasContained.drawImage(r)}}loadSelectedFile(i){var r=new FileReader;r.onload=n=>{let a=new Image;a.onerror=o=>{console.log("Loading failed")},a.src=n.target.result,a.onload=()=>{this.drawCanvasContained.drawImage(a)}},r.readAsDataURL(i)}toggleImagePresets(){this.sideMenuContext=!this.sideMenuContext}static \u0275fac=function(r){return new(r||e)(z(ov),z(ad),z(Vt))};static \u0275cmp=Ae({type:e,selectors:[["app-tutorial-template-images"]],contentQueries:function(r,n,a){if(r&1&&Si(a,xle,5),r&2){let o;Me(o=Ie())&&(n.drawCanvasContained=o.first)}},features:[Ot],ngContentSelectors:wle,decls:23,vars:7,consts:[["drawerLeft",""],["drawerRight",""],["class","loading",4,"ngIf"],["color","primary"],["mat-icon-button","","class","example-icon",3,"click",4,"ngIf"],["routerLink","/home",1,"show-smallscreen"],["mat-icon-button","",1,"example-icon"],["mode","side",3,"opened"],[1,"vertical-flex","drawer"],[4,"ngIf"],["mode","side","position","end",3,"opened"],[1,"horizontal-flex","drawer-container"],[1,"loading"],["color","primary",3,"diameter"],["mat-icon-button","",1,"example-icon",3,"click"],[3,"loadingEvent"],["mat-raised-button","","color","warn",1,"fillWidth",3,"click"],[3,"presetEvent"]],template:function(r,n){r&1&&(ti(yle),Te(0,Cle,2,1,"div",2),S(1,"mat-toolbar",3)(2,"mat-toolbar-row"),Te(3,Ele,3,0,"button",4),S(4,"a",5)(5,"button",6)(6,"mat-icon"),G(7,"home"),A()()(),S(8,"span"),it(9),A(),Te(10,Sle,3,0,"button",4),A()(),S(11,"mat-drawer-container")(12,"mat-drawer",7,0)(14,"div",8),Te(15,Ale,7,0,"ng-container",9)(16,Tle,2,0,"ng-container",9),A()(),S(17,"mat-drawer",10,1),ae(19,"div",8),it(20,1),A(),S(21,"div",11),it(22,2),A()()),r&2&&(O("ngIf",n.cvState=="loading"),P(3),O("ngIf",n.leftDrawer),P(7),O("ngIf",n.rightDrawer),P(2),O("opened",n.leftDrawer),P(3),O("ngIf",!n.uiservice.showImagePreset),P(),O("ngIf",n.uiservice.showImagePreset),P(),O("opened",n.rightDrawer))},dependencies:[fV,cn,vv,_v,Lr,Oy,cp,bv,$n,rd,vV,bV],styles:["mat-drawer[_ngcontent-%COMP%]{max-width:50vw}mat-toolbar-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:100%;text-align:center}.loading[_ngcontent-%COMP%]{position:fixed;z-index:100;top:50%;left:50%;transform:translate(-50%,-50%);background-color:#000c;width:100vw;height:100vh;justify-content:center;align-items:center;display:flex}.drawer[_ngcontent-%COMP%]{padding:1em .25em;align-items:center}.drawer-container[_ngcontent-%COMP%]{gap:1em;justify-content:center;align-items:center;margin-top:1em}[_nghost-%COMP%]     h2{text-align:center;margin:1ch}"]})}return e})();var Dle=["canvas1"],Mle=["canvas2"],Ile=["canvas3"],xV=(()=>{class e extends za{canvas1;canvas2;canvas3;color="#ffffff";colorCtr=new Nu(null);colorspace="RGB";ngAfterViewInit(){super.ngAfterViewInit,this.updateColorSpace()}updateInput(){let i=cv.imread(this.canvas1.getCanvas(),cv.IMREAD_GRAYSCALE),r=cv.imread(this.canvas2.getCanvas(),cv.IMREAD_GRAYSCALE),n=cv.imread(this.canvas3.getCanvas(),cv.IMREAD_GRAYSCALE);cv.cvtColor(i,i,cv.COLOR_RGB2GRAY),cv.cvtColor(r,r,cv.COLOR_RGB2GRAY),cv.cvtColor(n,n,cv.COLOR_RGB2GRAY);let a=new cv.MatVector,o=new cv.Mat;switch(this.colorspace){case"RGB":{a.push_back(i),a.push_back(r),a.push_back(n),cv.merge(a,o);break}case"YCrCb":{a.push_back(i),a.push_back(r),a.push_back(n),cv.merge(a,o),cv.cvtColor(o,o,cv.COLOR_YCrCb2RGB);break}case"LAB":{a.push_back(i),a.push_back(r),a.push_back(n),cv.merge(a,o),cv.cvtColor(o,o,cv.COLOR_Lab2RGB);break}case"HSV":{i.convertTo(i,cv.CV_32FC1),cv.convertScaleAbs(i,i,179/255,0),a.push_back(i),a.push_back(r),a.push_back(n),cv.merge(a,o),cv.cvtColor(o,o,cv.COLOR_HSV2RGB);break}}cv.imshow(this.drawCanvas.getCanvas(),o),i.delete(),r.delete(),n.delete(),o.delete(),a.delete(),this.updateColorSpace()}updateColorSpace(){let i=cv.imread(this.drawCanvas.getCanvas()),r=new cv.MatVector;switch(this.colorspace){case"RGB":{this.canvas1.title="R",this.canvas2.title="G",this.canvas3.title="B";break}case"LAB":{this.canvas1.title="L",this.canvas2.title="A",this.canvas3.title="B",cv.cvtColor(i,i,cv.COLOR_RGB2Lab);break}case"HSV":{this.canvas1.title="H",this.canvas2.title="S",this.canvas3.title="V",cv.cvtColor(i,i,cv.COLOR_RGB2HSV);break}case"YCrCb":{this.canvas1.title="Y",this.canvas2.title="Cr",this.canvas3.title="Cb",cv.cvtColor(i,i,cv.COLOR_RGB2YCrCb);break}}cv.split(i,r),this.colorspace=="HSV"&&cv.convertScaleAbs(r.get(0),r.get(0),1.42),cv.imshow(this.canvas1.getCanvas(),r.get(0)),cv.imshow(this.canvas2.getCanvas(),r.get(1)),cv.imshow(this.canvas3.getCanvas(),r.get(2)),i.delete(),r.delete()}static \u0275fac=(()=>{let i;return function(n){return(i||(i=sr(e)))(n||e)}})();static \u0275cmp=Ae({type:e,selectors:[["app-color-spaces"]],viewQuery:function(r,n){if(r&1&&(tt(Dle,5),tt(Mle,5),tt(Ile,5)),r&2){let a;Me(a=Ie())&&(n.canvas1=a.first),Me(a=Ie())&&(n.canvas2=a.first),Me(a=Ie())&&(n.canvas3=a.first)}},features:[Ot],decls:34,vars:26,consts:[["brushSizeSlider",""],["inputCanvas",""],["canvas1",""],["canvas2",""],["canvas3",""],[3,"rightDrawer"],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["title","Brush Size"],[3,"colorPickerChange","colorPicker","cpDialogDisplay","cpToggle","cpFallbackColor","cpDisableInput"],[1,"fillWidth"],[3,"ngModelChange","colorPickerChange","ngModel"],["value","RGB"],["value","HSV"],["value","LAB"],["value","YCrCb"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["title","Canvas",1,"main-canvas",3,"drawingEnded","width","drawColor","drawable","brushRadius","BWOption"],[1,"horizontal-flex","canvas-grid"],["title","Red",1,"grid-item",3,"drawingEnded","width","drawColor","drawable","brushRadius"],["title","Green",1,"grid-item",3,"drawingEnded","width","drawColor","drawable","brushRadius"],["title","Blue",1,"grid-item",3,"drawingEnded","width","drawColor","drawable","brushRadius"]],template:function(r,n){if(r&1){let a=Ue();S(0,"app-tutorial-template-images",5),G(1," Colorspaces "),At(2,6),ae(3,"app-labelled-sliders",7,0)(5,"hr"),S(6,"h2"),G(7,"Brush color"),A(),S(8,"input",8),Pt("colorPickerChange",function(s){return j(a),Dt(n.color,s)||(n.color=s),W(s)}),A(),ae(9,"hr"),S(10,"h2"),G(11,"Colorspace"),A(),S(12,"mat-form-field",9)(13,"mat-label"),G(14,"Choose a colorspace"),A(),S(15,"mat-select",10),Pt("ngModelChange",function(s){return j(a),Dt(n.colorspace,s)||(n.colorspace=s),W(s)}),q("colorPickerChange",function(){return j(a),W(n.updateColorSpace())}),S(16,"mat-option",11),G(17,"RGB"),A(),S(18,"mat-option",12),G(19,"HSV"),A(),S(20,"mat-option",13),G(21,"LAB"),A(),S(22,"mat-option",14),G(23,"YCrCb"),A()()(),Tt(),At(24,15),S(25,"app-draw-canvas",16,1),q("drawingEnded",function(){return j(a),W(n.updateColorSpace())}),A(),S(27,"div",17)(28,"app-draw-canvas",18,2),q("drawingEnded",function(){return j(a),W(n.updateInput())}),A(),S(30,"app-draw-canvas",19,3),q("drawingEnded",function(){return j(a),W(n.updateInput())}),A(),S(32,"app-draw-canvas",20,4),q("drawingEnded",function(){return j(a),W(n.updateInput())}),A()(),Tt(),A()}if(r&2){let a=kt(4);O("rightDrawer",!1),P(8),ei("background",n.color),Nt("colorPicker",n.color),O("cpDialogDisplay","inline")("cpToggle",!0)("cpFallbackColor","#ffffff")("cpDisableInput",!0),P(7),Nt("ngModel",n.colorspace),P(10),O("width",256)("drawColor",n.color)("drawable",!0)("brushRadius",a.value)("BWOption",!0),P(3),O("width",256)("drawColor",n.color)("drawable",!0)("brushRadius",a.value),P(2),O("width",256)("drawColor",n.color)("drawable",!0)("brushRadius",a.value),P(2),O("width",256)("drawColor",n.color)("drawable",!0)("brushRadius",a.value)}},dependencies:[rp,Qs,My,ip,yn,an,R8,Ua,hr,ja],styles:[".options-bar[_ngcontent-%COMP%]{gap:2em;align-items:center;padding:0 2em}.options-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:80%}.brush-slider[_ngcontent-%COMP%]{font-size:small}.main-canvas[_ngcontent-%COMP%]{border:solid 1px white;margin:1em;border-radius:.25em;overflow:hidden;aspect-ratio:1;min-width:256px;width:33%;box-shadow:#00000040 0 54px 55px,#0000001f 0 -12px 30px,#0000001f 0 4px 6px,#0000002b 0 12px 13px,#00000017 0 -3px 5px}.grid-item[_ngcontent-%COMP%]{margin:auto;min-width:256px;box-shadow:#26394d 0 20px 30px -10px}.canvas-grid[_ngcontent-%COMP%]{gap:.5em;flex-direction:row;flex-wrap:wrap}"]})}return e})();var kle=["button"],Nle=["*"];function Ple(e,t){if(e&1&&ae(0,"mat-pseudo-checkbox",3),e&2){let i=J();O("disabled",i.disabled)}}function Rle(e,t){if(e&1&&ae(0,"mat-pseudo-checkbox",3),e&2){let i=J();O("disabled",i.disabled)}}var yV=new Be("MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS",{providedIn:"root",factory:Fle});function Fle(){return{hideSingleSelectionIndicator:!1,hideMultipleSelectionIndicator:!1}}var wV=new Be("MatButtonToggleGroup"),Ole={provide:$s,useExisting:Jn(()=>bo),multi:!0},CV=0,Ly=class{constructor(t,i){this.source=t,this.value=i}},bo=(()=>{class e{get name(){return this._name}set name(i){this._name=i,this._markButtonsForCheck()}get value(){let i=this._selectionModel?this._selectionModel.selected:[];return this.multiple?i.map(r=>r.value):i[0]?i[0].value:void 0}set value(i){this._setSelectionByValue(i),this.valueChange.emit(this.value)}get selected(){let i=this._selectionModel?this._selectionModel.selected:[];return this.multiple?i:i[0]||null}get multiple(){return this._multiple}set multiple(i){this._multiple=i,this._markButtonsForCheck()}get disabled(){return this._disabled}set disabled(i){this._disabled=i,this._markButtonsForCheck()}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(i){this._hideSingleSelectionIndicator=i,this._markButtonsForCheck()}get hideMultipleSelectionIndicator(){return this._hideMultipleSelectionIndicator}set hideMultipleSelectionIndicator(i){this._hideMultipleSelectionIndicator=i,this._markButtonsForCheck()}constructor(i,r){this._changeDetector=i,this._multiple=!1,this._disabled=!1,this._controlValueAccessorChangeFn=()=>{},this._onTouched=()=>{},this._name=`mat-button-toggle-group-${CV++}`,this.valueChange=new Pe,this.change=new Pe,this.appearance=r&&r.appearance?r.appearance:"standard",this.hideSingleSelectionIndicator=r?.hideSingleSelectionIndicator??!1,this.hideMultipleSelectionIndicator=r?.hideMultipleSelectionIndicator??!1}ngOnInit(){this._selectionModel=new np(this.multiple,void 0,!1)}ngAfterContentInit(){this._selectionModel.select(...this._buttonToggles.filter(i=>i.checked))}writeValue(i){this.value=i,this._changeDetector.markForCheck()}registerOnChange(i){this._controlValueAccessorChangeFn=i}registerOnTouched(i){this._onTouched=i}setDisabledState(i){this.disabled=i}_emitChangeEvent(i){let r=new Ly(i,this.value);this._rawValue=r.value,this._controlValueAccessorChangeFn(r.value),this.change.emit(r)}_syncButtonToggle(i,r,n=!1,a=!1){!this.multiple&&this.selected&&!i.checked&&(this.selected.checked=!1),this._selectionModel?r?this._selectionModel.select(i):this._selectionModel.deselect(i):a=!0,a?Promise.resolve().then(()=>this._updateModelValue(i,n)):this._updateModelValue(i,n)}_isSelected(i){return this._selectionModel&&this._selectionModel.isSelected(i)}_isPrechecked(i){return typeof this._rawValue>"u"?!1:this.multiple&&Array.isArray(this._rawValue)?this._rawValue.some(r=>i.value!=null&&r===i.value):i.value===this._rawValue}_setSelectionByValue(i){this._rawValue=i,this._buttonToggles&&(this.multiple&&i?(Array.isArray(i),this._clearSelection(),i.forEach(r=>this._selectValue(r))):(this._clearSelection(),this._selectValue(i)))}_clearSelection(){this._selectionModel.clear(),this._buttonToggles.forEach(i=>i.checked=!1)}_selectValue(i){let r=this._buttonToggles.find(n=>n.value!=null&&n.value===i);r&&(r.checked=!0,this._selectionModel.select(r))}_updateModelValue(i,r){r&&this._emitChangeEvent(i),this.valueChange.emit(this.value)}_markButtonsForCheck(){this._buttonToggles?.forEach(i=>i._markForCheck())}static{this.\u0275fac=function(r){return new(r||e)(z(Vt),z(yV,8))}}static{this.\u0275dir=lt({type:e,selectors:[["mat-button-toggle-group"]],contentQueries:function(r,n,a){if(r&1&&Si(a,Wa,5),r&2){let o;Me(o=Ie())&&(n._buttonToggles=o)}},hostAttrs:["role","group",1,"mat-button-toggle-group"],hostVars:5,hostBindings:function(r,n){r&2&&(Ft("aria-disabled",n.disabled),ft("mat-button-toggle-vertical",n.vertical)("mat-button-toggle-group-appearance-standard",n.appearance==="standard"))},inputs:{appearance:"appearance",name:"name",vertical:[de.HasDecoratorInputTransform,"vertical","vertical",ot],value:"value",multiple:[de.HasDecoratorInputTransform,"multiple","multiple",ot],disabled:[de.HasDecoratorInputTransform,"disabled","disabled",ot],hideSingleSelectionIndicator:[de.HasDecoratorInputTransform,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",ot],hideMultipleSelectionIndicator:[de.HasDecoratorInputTransform,"hideMultipleSelectionIndicator","hideMultipleSelectionIndicator",ot]},outputs:{valueChange:"valueChange",change:"change"},exportAs:["matButtonToggleGroup"],standalone:!0,features:[_i([Ole,{provide:wV,useExisting:e}]),wi]})}}return e})(),Wa=(()=>{class e{get buttonId(){return`${this.id}-button`}get appearance(){return this.buttonToggleGroup?this.buttonToggleGroup.appearance:this._appearance}set appearance(i){this._appearance=i}get checked(){return this.buttonToggleGroup?this.buttonToggleGroup._isSelected(this):this._checked}set checked(i){i!==this._checked&&(this._checked=i,this.buttonToggleGroup&&this.buttonToggleGroup._syncButtonToggle(this,this._checked),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled||this.buttonToggleGroup&&this.buttonToggleGroup.disabled}set disabled(i){this._disabled=i}constructor(i,r,n,a,o,s){this._changeDetectorRef=r,this._elementRef=n,this._focusMonitor=a,this._checked=!1,this.ariaLabelledby=null,this._disabled=!1,this.change=new Pe;let l=Number(o);this.tabIndex=l||l===0?l:null,this.buttonToggleGroup=i,this.appearance=s&&s.appearance?s.appearance:"standard"}ngOnInit(){let i=this.buttonToggleGroup;this.id=this.id||`mat-button-toggle-${CV++}`,i&&(i._isPrechecked(this)?this.checked=!0:i._isSelected(this)!==this._checked&&i._syncButtonToggle(this,this._checked))}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){let i=this.buttonToggleGroup;this._focusMonitor.stopMonitoring(this._elementRef),i&&i._isSelected(this)&&i._syncButtonToggle(this,!1,!1,!0)}focus(i){this._buttonElement.nativeElement.focus(i)}_onButtonClick(){let i=this._isSingleSelector()?!0:!this._checked;i!==this._checked&&(this._checked=i,this.buttonToggleGroup&&(this.buttonToggleGroup._syncButtonToggle(this,this._checked,!0),this.buttonToggleGroup._onTouched())),this.change.emit(new Ly(this,this.value))}_markForCheck(){this._changeDetectorRef.markForCheck()}_getButtonName(){return this._isSingleSelector()?this.buttonToggleGroup.name:this.name||null}_isSingleSelector(){return this.buttonToggleGroup&&!this.buttonToggleGroup.multiple}static{this.\u0275fac=function(r){return new(r||e)(z(wV,8),z(Vt),z(nt),z(Ks),ea("tabindex"),z(yV,8))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-button-toggle"]],viewQuery:function(r,n){if(r&1&&tt(kle,5),r&2){let a;Me(a=Ie())&&(n._buttonElement=a.first)}},hostAttrs:["role","presentation",1,"mat-button-toggle"],hostVars:12,hostBindings:function(r,n){r&1&&q("focus",function(){return n.focus()}),r&2&&(Ft("aria-label",null)("aria-labelledby",null)("id",n.id)("name",null),ft("mat-button-toggle-standalone",!n.buttonToggleGroup)("mat-button-toggle-checked",n.checked)("mat-button-toggle-disabled",n.disabled)("mat-button-toggle-appearance-standard",n.appearance==="standard"))},inputs:{ariaLabel:[de.None,"aria-label","ariaLabel"],ariaLabelledby:[de.None,"aria-labelledby","ariaLabelledby"],id:"id",name:"name",value:"value",tabIndex:"tabIndex",disableRipple:[de.HasDecoratorInputTransform,"disableRipple","disableRipple",ot],appearance:"appearance",checked:[de.HasDecoratorInputTransform,"checked","checked",ot],disabled:[de.HasDecoratorInputTransform,"disabled","disabled",ot]},outputs:{change:"change"},exportAs:["matButtonToggle"],standalone:!0,features:[wi,Xt],ngContentSelectors:Nle,decls:8,vars:11,consts:[["button",""],["type","button",1,"mat-button-toggle-button","mat-focus-indicator",3,"click","id","disabled"],[1,"mat-button-toggle-label-content"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"mat-button-toggle-focus-overlay"],["matRipple","",1,"mat-button-toggle-ripple",3,"matRippleTrigger","matRippleDisabled"]],template:function(r,n){if(r&1){let a=Ue();ti(),S(0,"button",1,0),q("click",function(){return j(a),W(n._onButtonClick())}),S(2,"span",2),Te(3,Ple,1,1,"mat-pseudo-checkbox",3)(4,Rle,1,1,"mat-pseudo-checkbox",3),it(5),A()(),ae(6,"span",4)(7,"span",5)}if(r&2){let a=kt(1);O("id",n.buttonId)("disabled",n.disabled||null),Ft("tabindex",n.disabled?-1:n.tabIndex)("aria-pressed",n.checked)("name",n._getButtonName())("aria-label",n.ariaLabel)("aria-labelledby",n.ariaLabelledby),P(3),fi(3,n.buttonToggleGroup&&n.checked&&!n.buttonToggleGroup.multiple&&!n.buttonToggleGroup.hideSingleSelectionIndicator?3:-1),P(),fi(4,n.buttonToggleGroup&&n.checked&&n.buttonToggleGroup.multiple&&!n.buttonToggleGroup.hideMultipleSelectionIndicator?4:-1),P(3),O("matRippleTrigger",a)("matRippleDisabled",n.disableRipple||n.disabled)}},dependencies:[Zo,jA],styles:[".mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;-webkit-tap-highlight-color:rgba(0,0,0,0);transform:translateZ(0);border-radius:var(--mat-legacy-button-toggle-shape)}.mat-button-toggle-standalone:not([class*=mat-elevation-z]),.mat-button-toggle-group:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.cdk-high-contrast-active .mat-button-toggle-standalone,.cdk-high-contrast-active .mat-button-toggle-group{outline:solid 1px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:var(--mat-standard-button-toggle-shape);border:solid 1px var(--mat-standard-button-toggle-divider-color)}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard .mat-pseudo-checkbox,.mat-button-toggle-group-appearance-standard .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-selected-checkmark-color: var( --mat-standard-button-toggle-selected-state-text-color )}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard:not([class*=mat-elevation-z]),.mat-button-toggle-group-appearance-standard:not([class*=mat-elevation-z]){box-shadow:none}.cdk-high-contrast-active .mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.cdk-high-contrast-active .mat-button-toggle-group-appearance-standard{outline:0}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative;color:var(--mat-legacy-button-toggle-text-color);font-family:var(--mat-legacy-button-toggle-label-text-font);font-size:var(--mat-legacy-button-toggle-label-text-size);line-height:var(--mat-legacy-button-toggle-label-text-line-height);font-weight:var(--mat-legacy-button-toggle-label-text-weight);letter-spacing:var(--mat-legacy-button-toggle-label-text-tracking);--mat-minimal-pseudo-checkbox-selected-checkmark-color: var( --mat-legacy-button-toggle-selected-state-text-color )}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:var(--mat-legacy-button-toggle-focus-state-layer-opacity)}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle .mat-pseudo-checkbox{margin-right:12px}[dir=rtl] .mat-button-toggle .mat-pseudo-checkbox{margin-right:0;margin-left:12px}.mat-button-toggle-checked{color:var(--mat-legacy-button-toggle-selected-state-text-color);background-color:var(--mat-legacy-button-toggle-selected-state-background-color)}.mat-button-toggle-disabled{color:var(--mat-legacy-button-toggle-disabled-state-text-color);background-color:var(--mat-legacy-button-toggle-disabled-state-background-color);--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color: var( --mat-legacy-button-toggle-disabled-state-text-color )}.mat-button-toggle-disabled.mat-button-toggle-checked{background-color:var(--mat-legacy-button-toggle-disabled-selected-state-background-color)}.mat-button-toggle-appearance-standard{color:var(--mat-standard-button-toggle-text-color);background-color:var(--mat-standard-button-toggle-background-color);font-family:var(--mat-standard-button-toggle-label-text-font);font-size:var(--mat-standard-button-toggle-label-text-size);line-height:var(--mat-standard-button-toggle-label-text-line-height);font-weight:var(--mat-standard-button-toggle-label-text-weight);letter-spacing:var(--mat-standard-button-toggle-label-text-tracking)}.mat-button-toggle-group-appearance-standard .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:solid 1px var(--mat-standard-button-toggle-divider-color)}[dir=rtl] .mat-button-toggle-group-appearance-standard .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:none;border-right:solid 1px var(--mat-standard-button-toggle-divider-color)}.mat-button-toggle-group-appearance-standard.mat-button-toggle-vertical .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:none;border-right:none;border-top:solid 1px var(--mat-standard-button-toggle-divider-color)}.mat-button-toggle-appearance-standard.mat-button-toggle-checked{color:var(--mat-standard-button-toggle-selected-state-text-color);background-color:var(--mat-standard-button-toggle-selected-state-background-color)}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled{color:var(--mat-standard-button-toggle-disabled-state-text-color);background-color:var(--mat-standard-button-toggle-disabled-state-background-color)}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color: var( --mat-standard-button-toggle-disabled-selected-state-text-color )}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled.mat-button-toggle-checked{color:var(--mat-standard-button-toggle-disabled-selected-state-text-color);background-color:var(--mat-standard-button-toggle-disabled-selected-state-background-color)}.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{background-color:var(--mat-standard-button-toggle-state-layer-color)}.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:var(--mat-standard-button-toggle-hover-state-layer-opacity)}.mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:var(--mat-standard-button-toggle-focus-state-layer-opacity)}@media(hover: none){.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;user-select:none;display:inline-block;padding:0 16px;line-height:var(--mat-legacy-button-toggle-height);position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px;line-height:var(--mat-standard-button-toggle-height)}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;pointer-events:none;opacity:0;background-color:var(--mat-legacy-button-toggle-state-layer-color)}.cdk-high-contrast-active .mat-button-toggle-checked .mat-button-toggle-focus-overlay{border-bottom:solid 500px;opacity:.5;height:0}.cdk-high-contrast-active .mat-button-toggle-checked:hover .mat-button-toggle-focus-overlay{opacity:.6}.cdk-high-contrast-active .mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard{--mat-focus-indicator-border-radius:var(--mat-standard-button-toggle-shape)}.mat-button-toggle-group-appearance-standard .mat-button-toggle:last-of-type .mat-button-toggle-button::before{border-top-right-radius:var(--mat-standard-button-toggle-shape);border-bottom-right-radius:var(--mat-standard-button-toggle-shape)}.mat-button-toggle-group-appearance-standard .mat-button-toggle:first-of-type .mat-button-toggle-button::before{border-top-left-radius:var(--mat-standard-button-toggle-shape);border-bottom-left-radius:var(--mat-standard-button-toggle-shape)}"],encapsulation:2,changeDetection:0})}}return e})(),EV=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[Et,jl,Wa,Et]})}}return e})();function Lle(e,t){if(e&1){let i=Ue();At(0),S(1,"app-labelled-sliders",21),Pt("valueChange",function(n){j(i);let a=J();return Dt(a.gaussStdX,n)||(a.gaussStdX=n),W(n)}),q("valueChange",function(){j(i);let n=J();return W(n.drawGaussian())}),A(),S(2,"app-labelled-sliders",22),Pt("valueChange",function(n){j(i);let a=J();return Dt(a.gaussStdY,n)||(a.gaussStdY=n),W(n)}),q("valueChange",function(){j(i);let n=J();return W(n.drawGaussian())}),A(),Tt()}if(e&2){let i=J();P(),O("min",.5)("max",128)("step",.5),Nt("value",i.gaussStdX),P(),O("min",.5)("max",128)("step",.5),Nt("value",i.gaussStdY)}}function Ble(e,t){if(e&1){let i=Ue();S(0,"app-labelled-sliders",23),Pt("valueChange",function(n){j(i);let a=J();return Dt(a.gaussStdY,n)||(a.gaussStdY=n),W(n)})("valueChange",function(n){j(i);let a=J();return Dt(a.gaussStdX,n)||(a.gaussStdX=n),W(n)}),q("valueChange",function(){j(i);let n=J();return W(n.drawGaussian())}),A()}if(e&2){let i=J();O("min",.5)("max",128)("step",.5),Nt("value",i.gaussStdY)("value",i.gaussStdX)}}var SV=(()=>{class e extends za{angle=0;frequency=25;magLog=!0;brushSize=10;gaussStdX=10;gaussStdY=10;repsentationNorm="logAmplitudeOne";drawGaussian(){var i=this.drawCanvas.width,r=this.drawCanvas.height,n=new Uint8ClampedArray(i*r*4);for(let a=0;a<r;a++)for(let o=0;o<i;o++){let s=(a*i+o)*4,l=255*Math.exp(-Math.pow((o-r/2)/(Math.sqrt(2)*this.gaussStdY),2)+-Math.pow((a-i/2)/(Math.sqrt(2)*this.gaussStdX),2));n[s]=l,n[s+1]=l,n[s+2]=l,n[s+3]=255}this.drawCanvas.drawArray(n)}drawSin(){var i=this.drawCanvas.width,r=this.drawCanvas.height,n=new Uint8ClampedArray(i*r*4);for(let a=0;a<r;a++)for(let o=0;o<i;o++){let s=(a*i+o)*4,l=Math.PI*this.angle/180,c=a*Math.cos(l)*this.frequency/r+o*Math.sin(l)*this.frequency/i,d=Math.round((1+Math.sin(Math.PI*2*c))*127);n[s]=d,n[s+1]=d,n[s+2]=d,n[s+3]=255}this.drawCanvas.drawArray(n)}updateFFT(){let i=cv.imread(this.drawCanvas.getCanvas());cv.cvtColor(i,i,cv.COLOR_RGBA2GRAY,0);let r=cv.getOptimalDFTSize(i.rows),n=cv.getOptimalDFTSize(i.cols),a=cv.Scalar.all(0),o=new cv.Mat;cv.copyMakeBorder(i,o,0,r-i.rows,0,n-i.cols,cv.BORDER_CONSTANT,a);let s=new cv.Mat;o.convertTo(s,cv.CV_32F);let l=new cv.MatVector,c=new cv.Mat,d=new cv.Mat.zeros(o.rows,o.cols,cv.CV_32F);l.push_back(s),l.push_back(d),cv.merge(l,c),cv.dft(c,c,cv.DFT_SCALE),cv.split(c,l),cv.magnitude(l.get(0),l.get(1),l.get(0));let u=l.get(0),h=new cv.Mat.ones(u.rows,u.cols,u.type());switch(this.repsentationNorm){case"logAmplitudeOne":cv.add(u,h,u),cv.log(u,u);break;case"logAmplitude":cv.log(u,u);break;case"amplitude":break}let m=new cv.Rect(0,0,u.cols&-2,u.rows&-2);u=u.roi(m);let f=u.cols/2,p=u.rows/2,g=new cv.Mat,v=new cv.Rect(0,0,f,p),b=new cv.Rect(f,0,f,p),_=new cv.Rect(0,p,f,p),x=new cv.Rect(f,p,f,p),w=u.roi(v),y=u.roi(b),M=u.roi(_),T=u.roi(x);w.copyTo(g),T.copyTo(w),g.copyTo(T),y.copyTo(g),M.copyTo(y),g.copyTo(M),cv.normalize(u,u,0,1,cv.NORM_MINMAX),this.outputCanvas.drawMat(u),i.delete(),o.delete(),l.delete(),c.delete(),h.delete(),g.delete()}static \u0275fac=(()=>{let i;return function(n){return(i||(i=sr(e)))(n||e)}})();static \u0275cmp=Ae({type:e,selectors:[["app-fast-fourier-transform"]],features:[Ot],decls:36,vars:18,consts:[["brushSizeSlider",""],["toggleAxis",""],["singleGaussAxis",""],["inputCanvas",""],["outputCanvas",""],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["name","representationNorm",3,"ngModelChange","change","ngModel"],["value","amplitude"],["value","logAmplitude"],["value","logAmplitudeOne"],["title","Brush Size"],["mat-raised-button","","color","primary",1,"fillWidth",3,"click"],["color","primary","labelPosition","before",1,"example-margin"],[4,"ngIf","ngIfElse"],["title","Angle","thumbLabel","","tickInterval","auto",3,"valueChange","min","max","step","value"],["title","Frequency","thumbLabel","","tickInterval","auto",3,"valueChange","min","max","step","value"],["ngProjectAs","[drawerRight]",5,["","drawerRight",""]],["echarts","",1,"profile-graph",3,"options"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["title","Canvas",1,"canvas",3,"drawingEnded","width","drawable","OnlyBW","brushRadius"],["title","Fourier Transform",1,"canvas",3,"profileChanged","drawable","profileOption"],["title","Gaussian STD X","thumbLabel","","tickInterval","auto",3,"valueChange","min","max","step","value"],["title","Gaussian STD Y","thumbLabel","","tickInterval","auto",3,"valueChange","min","max","step","value"],["title","Gaussian STD","thumbLabel","","tickInterval","auto",3,"valueChange","min","max","step","value"]],template:function(r,n){if(r&1){let a=Ue();S(0,"app-tutorial-template-images"),G(1," Fourier Transform "),At(2,5),S(3,"mat-button-toggle-group",6),Pt("ngModelChange",function(s){return j(a),Dt(n.repsentationNorm,s)||(n.repsentationNorm=s),W(s)}),q("change",function(){return j(a),W(n.updateFFT())}),S(4,"mat-button-toggle",7),G(5,"A"),A(),S(6,"mat-button-toggle",8),G(7,"log(A)"),A(),S(8,"mat-button-toggle",9),G(9,"log(1+A)"),A()(),ae(10,"hr")(11,"app-labelled-sliders",10,0)(13,"hr"),S(14,"button",11),q("click",function(){return j(a),W(n.drawGaussian())}),G(15," Draw Gaussian "),A(),S(16,"mat-slide-toggle",12,1),G(18," Independant axis "),A(),Te(19,Lle,3,8,"ng-container",13)(20,Ble,1,5,"ng-template",null,2,Ed),ae(22,"hr"),S(23,"button",11),q("click",function(){return j(a),W(n.drawSin())}),G(24," Draw sin(x) "),A(),S(25,"app-labelled-sliders",14),Pt("valueChange",function(s){return j(a),Dt(n.angle,s)||(n.angle=s),W(s)}),q("valueChange",function(){return j(a),W(n.drawSin())}),A(),S(26,"app-labelled-sliders",15),Pt("valueChange",function(s){return j(a),Dt(n.frequency,s)||(n.frequency=s),W(s)}),q("valueChange",function(){return j(a),W(n.drawSin())}),A(),Tt(),At(27,16),S(28,"h2"),G(29,"Profile"),A(),ae(30,"div",17),Tt(),At(31,18),S(32,"app-draw-canvas",19,3),q("drawingEnded",function(){return j(a),W(n.updateFFT())}),A(),S(34,"app-draw-canvas",20,4),q("profileChanged",function(){return j(a),W(n.updateProfile())}),A(),Tt(),A()}if(r&2){let a=kt(12),o=kt(17),s=kt(21);P(3),Nt("ngModel",n.repsentationNorm),P(16),O("ngIf",o.checked)("ngIfElse",s),P(6),O("min",0)("max",180)("step",2.5),Nt("value",n.angle),P(),O("min",0)("max",256)("step",1),Nt("value",n.frequency),P(4),O("options",n.profileOptions),P(2),O("width",256)("drawable",!0)("OnlyBW",!0)("brushRadius",a.value),P(2),O("drawable",!1)("profileOption",!0)}},dependencies:[mn,bo,Wa,cn,yn,an,op,Lr,Ua,hr,ja],styles:[".drawer-content[_ngcontent-%COMP%]{margin:1em auto;gap:1em}.canvas[_ngcontent-%COMP%]{width:45%;min-width:256px}.profile-graph[_ngcontent-%COMP%]{width:256px}"]})}return e})();var AV=(()=>{class e extends za{inputHistoOptions;outputHistoOptions;tileGridSize=8;clipLimit=20;colorspace="LAB";updateHistogram(){let i=cv.imread(this.drawCanvas.getCanvas());if(this.outputCanvas.isBWChecked=this.drawCanvas.isBW(),this.drawCanvas.isBW()){cv.cvtColor(i,i,cv.COLOR_RGBA2GRAY);var r=this.getHistogramFromGrayMat(i)}else var r=this.getHistogramFromColorMat(i);this.inputHistoOptions=this.updateHistoChart(r),i.delete();let n=cv.imread(this.outputCanvas.getCanvas());if(this.outputCanvas.isBW()){cv.cvtColor(n,n,cv.COLOR_RGBA2GRAY);var r=this.getHistogramFromGrayMat(n)}else var r=this.getHistogramFromColorMat(n);this.outputHistoOptions=this.updateHistoChart(r),n.delete()}updateHistoChart(i){let r={legend:{data:["Histogram"],align:"left",textStyle:{color:"white"}},tooltip:{},xAxis:{data:Array.from(Array(i[0].length).keys()),silent:!1,splitLine:{show:!1}},yAxis:{},animationEasing:"exponentialIn",animationDuration:500};return i.length==1?r.series=[{name:"Histogram",type:"line",symbol:"none",areaStyle:{color:new qr.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(220, 220, 220)"},{offset:1,color:"rgb(150, 150, 150)"}])},data:i[0],dimensions:["R"],itemStyle:{color:"rgb(220, 220, 220)"}}]:(r.legend={data:["R","G","B"],align:"left",textStyle:{color:"white"}},r.series=[{name:"R",type:"line",symbol:"none",itemStyle:{color:"rgb(220, 100, 100)"},areaStyle:{color:new qr.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(255, 68, 100)"},{offset:1,color:"rgb(180, 68, 100)"}])},data:i[0]},{name:"G",type:"line",symbol:"none",itemStyle:{color:"rgb(100, 220, 100)"},areaStyle:{color:new qr.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(68, 255, 100)"},{offset:1,color:"rgb(68, 180, 100)"}])},data:i[1]},{name:"B",type:"line",symbol:"none",itemStyle:{color:"rgb(100, 100, 220)"},areaStyle:{color:new qr.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(68, 100, 255)"},{offset:1,color:"rgb(68, 100, 180)"}])},data:i[2]}]),r}getHistogramFromColorMat(i){let r=new Array,n=new cv.MatVector;cv.split(i,n);let a=new cv.Mat,o=new cv.Mat,s=new cv.Mat,l=[256],c=[0,255],d=new cv.Mat;cv.calcHist(n,[0],d,a,l,c,!1),cv.calcHist(n,[1],d,o,l,c,!1),cv.calcHist(n,[2],d,s,l,c,!1),r.push(a.data32F),r.push(o.data32F),r.push(s.data32F);for(let u=0;u<3;u++)for(let h=0;h<256;h++){let m=r[u];m[h]/=i.rows*i.cols,r[u]=Array.from(m)}return d.delete(),n.delete(),a.delete(),o.delete(),s.delete(),r}getHistogramFromGrayMat(i){let r=new Array,n=new cv.MatVector;n.push_back(i);let a=new cv.Mat,o=[256],s=[0,255],l=new cv.Mat;cv.calcHist(n,[0],l,a,o,s,!1),r.push(a.data32F);for(let c=0;c<256;c++){let d=r[0];d[c]/=i.rows*i.cols,r[0]=Array.from(d)}return l.delete(),n.delete(),a.delete(),r}equalizeHistogram(){let i=cv.imread(this.drawCanvas.getCanvas());if(this.drawCanvas.isBW())cv.cvtColor(i,i,cv.COLOR_RGB2GRAY),cv.equalizeHist(i,i);else switch(this.colorspace){case"RGB":{let r=new cv.MatVector;cv.split(i,r),cv.equalizeHist(r.get(0),r.get(0)),cv.equalizeHist(r.get(1),r.get(1)),cv.equalizeHist(r.get(2),r.get(2)),cv.merge(r,i),r.delete();break}case"LAB":{cv.cvtColor(i,i,cv.COLOR_RGB2Lab);let r=new cv.MatVector;cv.split(i,r),cv.equalizeHist(r.get(0),r.get(0)),cv.merge(r,i),cv.cvtColor(i,i,cv.COLOR_Lab2RGB),r.delete();break}case"HSV":{cv.cvtColor(i,i,cv.COLOR_RGB2HSV);let r=new cv.MatVector;cv.split(i,r),cv.equalizeHist(r.get(2),r.get(2)),cv.merge(r,i),cv.cvtColor(i,i,cv.COLOR_HSV2RGB),r.delete();break}}this.outputCanvas.drawMat(i),this.updateHistogram(),i.delete()}CLAHE(){let i=cv.imread(this.drawCanvas.getCanvas()),r=new cv.Size(this.tileGridSize,this.tileGridSize),n=new cv.CLAHE(this.clipLimit,r);if(this.drawCanvas.isBW())cv.cvtColor(i,i,cv.COLOR_RGB2GRAY),n.apply(i,i);else switch(this.colorspace){case"RGB":{let a=new cv.MatVector;cv.split(i,a),n.apply(a.get(0),a.get(0)),n.apply(a.get(1),a.get(1)),n.apply(a.get(2),a.get(2)),cv.merge(a,i),a.delete();break}case"LAB":{cv.cvtColor(i,i,cv.COLOR_RGB2Lab);let a=new cv.MatVector;cv.split(i,a),n.apply(a.get(0),a.get(0)),cv.merge(a,i),cv.cvtColor(i,i,cv.COLOR_Lab2RGB),a.delete();break}case"HSV":{cv.cvtColor(i,i,cv.COLOR_RGB2HSV);let a=new cv.MatVector;cv.split(i,a),n.apply(a.get(2),a.get(2)),cv.merge(a,i),cv.cvtColor(i,i,cv.COLOR_HSV2RGB),a.delete();break}}this.outputCanvas.drawMat(i),this.updateHistogram(),i.delete(),n.delete()}ngAfterViewInit(){super.ngAfterViewInit(),this.ngxOpenCv.cvState.subscribe(i=>{this.cvState=i,i.ready&&this.updateHistogram()})}static \u0275fac=(()=>{let i;return function(n){return(i||(i=sr(e)))(n||e)}})();static \u0275cmp=Ae({type:e,selectors:[["app-image-histogram"]],features:[Ot],decls:41,vars:19,consts:[["inputCanvas",""],["outputCanvas",""],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["name","Colorspace","aria-label","Color space",3,"ngModelChange","ngModel"],["value","RGB"],["value","LAB"],["value","HSV"],["mat-raised-button","","color","primary",1,"fillWidth",3,"click"],[3,"valueChange","min","max","step","title","value"],["ngProjectAs","[drawerRight]",5,["","drawerRight",""]],["echarts","",1,"histo-graph",3,"options"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["title","Image",1,"canvas",3,"drawingEnded","BWSet","width","drawable","BWOption"],["title","Result",1,"canvas",3,"BWSet","width","drawable","BWOption"]],template:function(r,n){if(r&1){let a=Ue();S(0,"app-tutorial-template-images"),G(1," Histogram and equalization "),At(2,2),S(3,"h3"),G(4,"Colorspace"),A(),S(5,"mat-button-toggle-group",3),Pt("ngModelChange",function(s){return j(a),Dt(n.colorspace,s)||(n.colorspace=s),W(s)}),S(6,"mat-button-toggle",4)(7,"b"),G(8,"RGB"),A()(),S(9,"mat-button-toggle",5)(10,"b"),G(11,"L"),A(),G(12,"AB"),A(),S(13,"mat-button-toggle",6),G(14,"HS"),S(15,"b"),G(16,"V"),A()()(),ae(17,"hr"),S(18,"button",7),q("click",function(){return j(a),W(n.equalizeHistogram())}),G(19," Histogram equalization "),A(),ae(20,"hr"),S(21,"h3"),G(22," Contrast Limited "),ae(23,"br"),G(24," Adaptive Histogram "),ae(25,"br"),G(26," Equalization "),A(),S(27,"app-labelled-sliders",8),Pt("valueChange",function(s){return j(a),Dt(n.tileGridSize,s)||(n.tileGridSize=s),W(s)}),q("valueChange",function(){return j(a),W(n.CLAHE())}),A(),S(28,"app-labelled-sliders",8),Pt("valueChange",function(s){return j(a),Dt(n.clipLimit,s)||(n.clipLimit=s),W(s)}),q("valueChange",function(){return j(a),W(n.CLAHE())}),A(),S(29,"button",7),q("click",function(){return j(a),W(n.CLAHE())}),G(30," CLAHE "),A(),Tt(),At(31,9),ae(32,"div",10),S(33,"h2"),G(34,"Result canvas"),A(),ae(35,"div",10),Tt(),At(36,11),S(37,"app-draw-canvas",12,0),q("drawingEnded",function(){return j(a),W(n.updateHistogram())})("BWSet",function(){return j(a),W(n.updateHistogram())}),A(),S(39,"app-draw-canvas",13,1),q("BWSet",function(){return j(a),W(n.updateHistogram())}),A(),Tt(),A()}r&2&&(P(5),Nt("ngModel",n.colorspace),P(22),O("min",4)("max",48)("step",2)("title","Tile Grid size"),Nt("value",n.tileGridSize),P(),O("min",4)("max",48)("step",2)("title","Clip Limit"),Nt("value",n.clipLimit),P(4),O("options",n.inputHistoOptions),P(3),O("options",n.outputHistoOptions),P(2),O("width",1024)("drawable",!1)("BWOption",!0),P(2),O("width",1024)("drawable",!1)("BWOption",!0))},dependencies:[mn,bo,Wa,yn,an,Lr,Ua,hr,ja],styles:[".canvas[_ngcontent-%COMP%]{width:45%;min-width:256px}.histo-graph[_ngcontent-%COMP%]{min-width:350px;aspect-ratio:1}"]})}return e})();function fT(e,t){let i=e.length,r=e[0].length,n=new Array(i).fill(0).map(()=>new Array(r).fill(0));for(let a=0;a<i;a++)for(let o=0;o<r;o++)for(let s=0;s<i;s++)n[a][o]+=e[a][s]*t[s][o];return n}function gT(e){let t=e.length,i=e[0].length,r=new Array(i).fill(0).map(()=>new Array(t).fill(0));for(let n=0;n<t;n++)for(let a=0;a<i;a++)r[a][n]=e[n][a];return r}function Js(){return Js=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Js.apply(null,arguments)}var vT={relTol:1e-12,absTol:1e-15,matrix:"Matrix",number:"number",numberFallback:"number",precision:64,predictable:!1,randomSeed:null};function TV(e,t){if(xv(e,t))return e[t];throw typeof e[t]=="function"&&Vle(e,t)?new Error('Cannot access method "'+t+'" as a property'):new Error('No access to property "'+t+'"')}function DV(e,t,i){if(xv(e,t))return e[t]=i,i;throw new Error('No access to property "'+t+'"')}function xv(e,t){return!zle(e)&&!Array.isArray(e)?!1:hp(Ule,t)?!0:!(t in Object.prototype||t in Function.prototype)}function Vle(e,t){return e==null||typeof e[t]!="function"||hp(e,t)&&Object.getPrototypeOf&&t in Object.getPrototypeOf(e)?!1:hp(Hle,t)?!0:!(t in Object.prototype||t in Function.prototype)}function zle(e){return typeof e=="object"&&e&&e.constructor===Object}var Ule={length:!0,name:!0},Hle={toString:!0,valueOf:!0,toLocaleString:!0};var By=class{constructor(t){this.wrappedObject=t,this[Symbol.iterator]=this.entries}keys(){return Object.keys(this.wrappedObject).filter(t=>this.has(t)).values()}get(t){return TV(this.wrappedObject,t)}set(t,i){return DV(this.wrappedObject,t,i),this}has(t){return xv(this.wrappedObject,t)&&t in this.wrappedObject}entries(){return Gle(this.keys(),t=>[t,this.get(t)])}forEach(t){for(var i of this.keys())t(this.get(i),i,this)}delete(t){xv(this.wrappedObject,t)&&delete this.wrappedObject[t]}clear(){for(var t of this.keys())this.delete(t)}get size(){return Object.keys(this.wrappedObject).length}};function Gle(e,t){return{next:()=>{var i=e.next();return i.done?i:{value:t(i.value),done:!1}}}}function xi(e){return typeof e=="number"}function Ei(e){return!e||typeof e!="object"||typeof e.constructor!="function"?!1:e.isBigNumber===!0&&typeof e.constructor.prototype=="object"&&e.constructor.prototype.isBigNumber===!0||typeof e.constructor.isDecimal=="function"&&e.constructor.isDecimal(e)===!0}function MV(e){return typeof e=="bigint"}function yv(e){return e&&typeof e=="object"&&Object.getPrototypeOf(e).isComplex===!0||!1}function wv(e){return e&&typeof e=="object"&&Object.getPrototypeOf(e).isFraction===!0||!1}function Vy(e){return e&&e.constructor.prototype.isUnit===!0||!1}function Dn(e){return typeof e=="string"}var Fi=Array.isArray;function ui(e){return e&&e.constructor.prototype.isMatrix===!0||!1}function Zu(e){return Array.isArray(e)||ui(e)}function zy(e){return e&&e.isDenseMatrix&&e.constructor.prototype.isMatrix===!0||!1}function Uy(e){return e&&e.isSparseMatrix&&e.constructor.prototype.isMatrix===!0||!1}function Hy(e){return e&&e.constructor.prototype.isRange===!0||!1}function mp(e){return e&&e.constructor.prototype.isIndex===!0||!1}function IV(e){return typeof e=="boolean"}function kV(e){return e&&e.constructor.prototype.isResultSet===!0||!1}function NV(e){return e&&e.constructor.prototype.isHelp===!0||!1}function PV(e){return typeof e=="function"}function RV(e){return e instanceof Date}function FV(e){return e instanceof RegExp}function pp(e){return!!(e&&typeof e=="object"&&e.constructor===Object&&!yv(e)&&!wv(e))}function OV(e){return e?e instanceof Map||e instanceof By||typeof e.set=="function"&&typeof e.get=="function"&&typeof e.keys=="function"&&typeof e.has=="function":!1}function LV(e){return e===null}function BV(e){return e===void 0}function VV(e){return e&&e.isAccessorNode===!0&&e.constructor.prototype.isNode===!0||!1}function zV(e){return e&&e.isArrayNode===!0&&e.constructor.prototype.isNode===!0||!1}function UV(e){return e&&e.isAssignmentNode===!0&&e.constructor.prototype.isNode===!0||!1}function HV(e){return e&&e.isBlockNode===!0&&e.constructor.prototype.isNode===!0||!1}function GV(e){return e&&e.isConditionalNode===!0&&e.constructor.prototype.isNode===!0||!1}function jV(e){return e&&e.isConstantNode===!0&&e.constructor.prototype.isNode===!0||!1}function WV(e){return e&&e.isFunctionAssignmentNode===!0&&e.constructor.prototype.isNode===!0||!1}function qV(e){return e&&e.isFunctionNode===!0&&e.constructor.prototype.isNode===!0||!1}function $V(e){return e&&e.isIndexNode===!0&&e.constructor.prototype.isNode===!0||!1}function XV(e){return e&&e.isNode===!0&&e.constructor.prototype.isNode===!0||!1}function YV(e){return e&&e.isObjectNode===!0&&e.constructor.prototype.isNode===!0||!1}function ZV(e){return e&&e.isOperatorNode===!0&&e.constructor.prototype.isNode===!0||!1}function KV(e){return e&&e.isParenthesisNode===!0&&e.constructor.prototype.isNode===!0||!1}function QV(e){return e&&e.isRangeNode===!0&&e.constructor.prototype.isNode===!0||!1}function JV(e){return e&&e.isRelationalNode===!0&&e.constructor.prototype.isNode===!0||!1}function ez(e){return e&&e.isSymbolNode===!0&&e.constructor.prototype.isNode===!0||!1}function tz(e){return e&&e.constructor.prototype.isChain===!0||!1}function on(e){var t=typeof e;return t==="object"?e===null?"null":Ei(e)?"BigNumber":e.constructor&&e.constructor.name?e.constructor.name:"Object":t}function Kt(e){var t=typeof e;if(t==="number"||t==="bigint"||t==="string"||t==="boolean"||e===null||e===void 0)return e;if(typeof e.clone=="function")return e.clone();if(Array.isArray(e))return e.map(function(i){return Kt(i)});if(e instanceof Date)return new Date(e.valueOf());if(Ei(e))return e;if(pp(e))return jle(e,Kt);throw new TypeError("Cannot clone: unknown type of value (value: ".concat(e,")"))}function jle(e,t){var i={};for(var r in e)hp(e,r)&&(i[r]=t(e[r]));return i}function iz(e,t){for(var i in t)hp(t,i)&&(e[i]=t[i]);return e}function Ko(e,t){var i,r,n;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(r=0,n=e.length;r<n;r++)if(!Ko(e[r],t[r]))return!1;return!0}else{if(typeof e=="function")return e===t;if(e instanceof Object){if(Array.isArray(t)||!(t instanceof Object))return!1;for(i in e)if(!(i in t)||!Ko(e[i],t[i]))return!1;for(i in t)if(!(i in e))return!1;return!0}else return e===t}}function hp(e,t){return e&&Object.hasOwnProperty.call(e,t)}function rz(e,t){for(var i={},r=0;r<t.length;r++){var n=t[r],a=e[n];a!==void 0&&(i[n]=a)}return i}var nz=["Matrix","Array"],az=["number","BigNumber","Fraction"];var va=function(t){if(t)throw new Error(`The global config is readonly. 
Please create a mathjs instance if you want to change the default configuration. 
Example:

  import { create, all } from 'mathjs';
  const mathjs = create(all);
  mathjs.config({ number: 'BigNumber' });
`);return Object.freeze(vT)};Js(va,vT,{MATRIX_OPTIONS:nz,NUMBER_OPTIONS:az});var CT=hM(xT(),1);function ie(e,t,i,r){function n(a){var o=rz(a,t.map($le));return Wle(e,t,a),i(o)}return n.isFactory=!0,n.fn=e,n.dependencies=t.slice().sort(),r&&(n.meta=r),n}function Wle(e,t,i){var r=t.filter(a=>!qle(a)).every(a=>i[a]!==void 0);if(!r){var n=t.filter(a=>i[a]===void 0);throw new Error('Cannot create function "'.concat(e,'", ')+"some dependencies are missing: ".concat(n.map(a=>'"'.concat(a,'"')).join(", "),"."))}}function qle(e){return e&&e[0]==="?"}function $le(e){return e&&e[0]==="?"?e.slice(1):e}function ai(e){return typeof e=="boolean"?!0:isFinite(e)?e===Math.round(e):!1}var lz=Math.sign||function(e){return e>0?1:e<0?-1:0},cz=Math.log2||function(t){return Math.log(t)/Math.LN2},dz=Math.log10||function(t){return Math.log(t)/Math.LN10},uz=Math.log1p||function(e){return Math.log(e+1)},hz=Math.cbrt||function(t){if(t===0)return t;var i=t<0,r;return i&&(t=-t),isFinite(t)?(r=Math.exp(Math.log(t)/3),r=(t/(r*r)+2*r)/3):r=t,i?-r:r},mz=Math.expm1||function(t){return t>=2e-4||t<=-2e-4?Math.exp(t)-1:t+t*t/2+t*t*t/6};function yT(e,t,i){var r={2:"0b",8:"0o",16:"0x"},n=r[t],a="";if(i){if(i<1)throw new Error("size must be in greater than 0");if(!ai(i))throw new Error("size must be an integer");if(e>2**(i-1)-1||e<-(2**(i-1)))throw new Error("Value must be in range [-2^".concat(i-1,", 2^").concat(i-1,"-1]"));if(!ai(e))throw new Error("Value must be an integer");e<0&&(e=e+2**i),a="i".concat(i)}var o="";return e<0&&(e=-e,o="-"),"".concat(o).concat(n).concat(e.toString(t)).concat(a)}function Cv(e,t){if(typeof t=="function")return t(e);if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity";if(isNaN(e))return"NaN";var{notation:i,precision:r,wordSize:n}=wT(t);switch(i){case"fixed":return pz(e,r);case"exponential":return fz(e,r);case"engineering":return Xle(e,r);case"bin":return yT(e,2,n);case"oct":return yT(e,8,n);case"hex":return yT(e,16,n);case"auto":return Yle(e,r,t).replace(/((\.\d*?)(0+))($|e)/,function(){var a=arguments[2],o=arguments[4];return a!=="."?a+o:o});default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function wT(e){var t="auto",i,r;if(e!==void 0)if(xi(e))i=e;else if(Ei(e))i=e.toNumber();else if(pp(e))e.precision!==void 0&&(i=oz(e.precision,()=>{throw new Error('Option "precision" must be a number or BigNumber')})),e.wordSize!==void 0&&(r=oz(e.wordSize,()=>{throw new Error('Option "wordSize" must be a number or BigNumber')})),e.notation&&(t=e.notation);else throw new Error("Unsupported type of options, number, BigNumber, or object expected");return{notation:t,precision:i,wordSize:r}}function Gy(e){var t=String(e).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!t)throw new SyntaxError("Invalid number "+e);var i=t[1],r=t[2],n=parseFloat(t[4]||"0"),a=r.indexOf(".");n+=a!==-1?a-1:r.length-1;var o=r.replace(".","").replace(/^0*/,function(s){return n-=s.length,""}).replace(/0*$/,"").split("").map(function(s){return parseInt(s)});return o.length===0&&(o.push(0),n++),{sign:i,coefficients:o,exponent:n}}function Xle(e,t){if(isNaN(e)||!isFinite(e))return String(e);var i=Gy(e),r=jy(i,t),n=r.exponent,a=r.coefficients,o=n%3===0?n:n<0?n-3-n%3:n-n%3;if(xi(t))for(;t>a.length||n-o+1>a.length;)a.push(0);else for(var s=Math.abs(n-o)-(a.length-1),l=0;l<s;l++)a.push(0);for(var c=Math.abs(n-o),d=1;c>0;)d++,c--;var u=a.slice(d).join(""),h=xi(t)&&u.length||u.match(/[1-9]/)?"."+u:"",m=a.slice(0,d).join("")+h+"e"+(n>=0?"+":"")+o.toString();return r.sign+m}function pz(e,t){if(isNaN(e)||!isFinite(e))return String(e);var i=Gy(e),r=typeof t=="number"?jy(i,i.exponent+1+t):i,n=r.coefficients,a=r.exponent+1,o=a+(t||0);return n.length<o&&(n=n.concat(fp(o-n.length))),a<0&&(n=fp(-a+1).concat(n),a=1),a<n.length&&n.splice(a,0,a===0?"0.":"."),r.sign+n.join("")}function fz(e,t){if(isNaN(e)||!isFinite(e))return String(e);var i=Gy(e),r=t?jy(i,t):i,n=r.coefficients,a=r.exponent;n.length<t&&(n=n.concat(fp(t-n.length)));var o=n.shift();return r.sign+o+(n.length>0?"."+n.join(""):"")+"e"+(a>=0?"+":"")+a}function Yle(e,t,i){if(isNaN(e)||!isFinite(e))return String(e);var r=sz(i?.lowerExp,-3),n=sz(i?.upperExp,5),a=Gy(e),o=t?jy(a,t):a;if(o.exponent<r||o.exponent>=n)return fz(e,t);var s=o.coefficients,l=o.exponent;s.length<t&&(s=s.concat(fp(t-s.length))),s=s.concat(fp(l-s.length+1+(s.length<t?t-s.length:0))),s=fp(-l).concat(s);var c=l>0?l:0;return c<s.length-1&&s.splice(c+1,0,"."),o.sign+s.join("")}function jy(e,t){for(var i={sign:e.sign,coefficients:e.coefficients,exponent:e.exponent},r=i.coefficients;t<=0;)r.unshift(0),i.exponent++,t++;if(r.length>t){var n=r.splice(t,r.length-t);if(n[0]>=5){var a=t-1;for(r[a]++;r[a]===10;)r.pop(),a===0&&(r.unshift(0),i.exponent++,a++),a--,r[a]++}}return i}function fp(e){for(var t=[],i=0;i<e;i++)t.push(0);return t}function gz(e){return e.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}var LLe=Number.EPSILON||2220446049250313e-31;function Xn(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e-8,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(i<=0)throw new Error("Relative tolerance must be greater than 0");if(r<0)throw new Error("Absolute tolerance must be at least 0");return isNaN(e)||isNaN(t)?!1:!isFinite(e)||!isFinite(t)?e===t:e===t?!0:Math.abs(e-t)<=Math.max(i*Math.max(Math.abs(e),Math.abs(t)),r)}function oz(e,t){if(xi(e))return e;if(Ei(e))return e.toNumber();t()}function sz(e,t){return xi(e)?e:Ei(e)?e.toNumber():t}var vz=function(){return vz=CT.default.create,CT.default},Zle=["?BigNumber","?Complex","?DenseMatrix","?Fraction"],ET=ie("typed",Zle,function(t){var{BigNumber:i,Complex:r,DenseMatrix:n,Fraction:a}=t,o=vz();return o.clear(),o.addTypes([{name:"number",test:xi},{name:"Complex",test:yv},{name:"BigNumber",test:Ei},{name:"bigint",test:MV},{name:"Fraction",test:wv},{name:"Unit",test:Vy},{name:"identifier",test:s=>Dn&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(s)},{name:"string",test:Dn},{name:"Chain",test:tz},{name:"Array",test:Fi},{name:"Matrix",test:ui},{name:"DenseMatrix",test:zy},{name:"SparseMatrix",test:Uy},{name:"Range",test:Hy},{name:"Index",test:mp},{name:"boolean",test:IV},{name:"ResultSet",test:kV},{name:"Help",test:NV},{name:"function",test:PV},{name:"Date",test:RV},{name:"RegExp",test:FV},{name:"null",test:LV},{name:"undefined",test:BV},{name:"AccessorNode",test:VV},{name:"ArrayNode",test:zV},{name:"AssignmentNode",test:UV},{name:"BlockNode",test:HV},{name:"ConditionalNode",test:GV},{name:"ConstantNode",test:jV},{name:"FunctionNode",test:qV},{name:"FunctionAssignmentNode",test:WV},{name:"IndexNode",test:$V},{name:"Node",test:XV},{name:"ObjectNode",test:YV},{name:"OperatorNode",test:ZV},{name:"ParenthesisNode",test:KV},{name:"RangeNode",test:QV},{name:"RelationalNode",test:JV},{name:"SymbolNode",test:ez},{name:"Map",test:OV},{name:"Object",test:pp}]),o.addConversions([{from:"number",to:"BigNumber",convert:function(l){if(i||Wy(l),gz(l)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+l+"). Use function bignumber(x) to convert to BigNumber.");return new i(l)}},{from:"number",to:"Complex",convert:function(l){return r||qy(l),new r(l,0)}},{from:"BigNumber",to:"Complex",convert:function(l){return r||qy(l),new r(l.toNumber(),0)}},{from:"bigint",to:"number",convert:function(l){if(l>Number.MAX_SAFE_INTEGER)throw new TypeError("Cannot implicitly convert bigint to number: value exceeds the max safe integer value (value: "+l+")");return Number(l)}},{from:"bigint",to:"BigNumber",convert:function(l){return i||Wy(l),new i(l.toString())}},{from:"bigint",to:"Fraction",convert:function(l){return a||$y(l),new a(l.toString())}},{from:"Fraction",to:"BigNumber",convert:function(l){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(l){return r||qy(l),new r(l.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(l){a||$y(l);var c=new a(l);if(c.valueOf()!==l)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+l+"). Use function fraction(x) to convert to Fraction.");return c}},{from:"string",to:"number",convert:function(l){var c=Number(l);if(isNaN(c))throw new Error('Cannot convert "'+l+'" to a number');return c}},{from:"string",to:"BigNumber",convert:function(l){i||Wy(l);try{return new i(l)}catch{throw new Error('Cannot convert "'+l+'" to BigNumber')}}},{from:"string",to:"bigint",convert:function(l){try{return BigInt(l)}catch{throw new Error('Cannot convert "'+l+'" to BigInt')}}},{from:"string",to:"Fraction",convert:function(l){a||$y(l);try{return new a(l)}catch{throw new Error('Cannot convert "'+l+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(l){r||qy(l);try{return new r(l)}catch{throw new Error('Cannot convert "'+l+'" to Complex')}}},{from:"boolean",to:"number",convert:function(l){return+l}},{from:"boolean",to:"BigNumber",convert:function(l){return i||Wy(l),new i(+l)}},{from:"boolean",to:"bigint",convert:function(l){return BigInt(+l)}},{from:"boolean",to:"Fraction",convert:function(l){return a||$y(l),new a(+l)}},{from:"boolean",to:"string",convert:function(l){return String(l)}},{from:"Array",to:"Matrix",convert:function(l){return n||Kle(),new n(l)}},{from:"Matrix",to:"Array",convert:function(l){return l.valueOf()}}]),o.onMismatch=(s,l,c)=>{var d=o.createError(s,l,c);if(["wrongType","mismatch"].includes(d.data.category)&&l.length===1&&Zu(l[0])&&c.some(h=>!h.params.includes(","))){var u=new TypeError("Function '".concat(s,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(s,")'."));throw u.data=d.data,u}throw d},o.onMismatch=(s,l,c)=>{var d=o.createError(s,l,c);if(["wrongType","mismatch"].includes(d.data.category)&&l.length===1&&Zu(l[0])&&c.some(h=>!h.params.includes(","))){var u=new TypeError("Function '".concat(s,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(s,")'."));throw u.data=d.data,u}throw d},o});function Wy(e){throw new Error("Cannot convert value ".concat(e," into a BigNumber: no class 'BigNumber' provided"))}function qy(e){throw new Error("Cannot convert value ".concat(e," into a Complex number: no class 'Complex' provided"))}function Kle(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}function $y(e){throw new Error("Cannot convert value ".concat(e," into a Fraction, no class 'Fraction' provided."))}var gp=9e15,hd=1e9,ST="0123456789abcdef",Yy="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Zy="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",AT={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-gp,maxE:gp,crypto:!1},yz,$l,Ut=!0,Qy="[DecimalError] ",ud=Qy+"Invalid argument: ",wz=Qy+"Precision limit exceeded",Cz=Qy+"crypto unavailable",Ez="[object Decimal]",Yn=Math.floor,sn=Math.pow,Qle=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Jle=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,ece=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Sz=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ws=1e7,Mt=7,tce=9007199254740991,ice=Yy.length-1,TT=Zy.length-1,ye={toStringTag:Ez};ye.absoluteValue=ye.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),vt(e)};ye.ceil=function(){return vt(new this.constructor(this),this.e+1,2)};ye.clampedTo=ye.clamp=function(e,t){var i,r=this,n=r.constructor;if(e=new n(e),t=new n(t),!e.s||!t.s)return new n(NaN);if(e.gt(t))throw Error(ud+t);return i=r.cmp(e),i<0?e:r.cmp(t)>0?t:new n(r)};ye.comparedTo=ye.cmp=function(e){var t,i,r,n,a=this,o=a.d,s=(e=new a.constructor(e)).d,l=a.s,c=e.s;if(!o||!s)return!l||!c?NaN:l!==c?l:o===s?0:!o^l<0?1:-1;if(!o[0]||!s[0])return o[0]?l:s[0]?-c:0;if(l!==c)return l;if(a.e!==e.e)return a.e>e.e^l<0?1:-1;for(r=o.length,n=s.length,t=0,i=r<n?r:n;t<i;++t)if(o[t]!==s[t])return o[t]>s[t]^l<0?1:-1;return r===n?0:r>n^l<0?1:-1};ye.cosine=ye.cos=function(){var e,t,i=this,r=i.constructor;return i.d?i.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(i.e,i.sd())+Mt,r.rounding=1,i=rce(r,Iz(r,i)),r.precision=e,r.rounding=t,vt($l==2||$l==3?i.neg():i,e,t,!0)):new r(1):new r(NaN)};ye.cubeRoot=ye.cbrt=function(){var e,t,i,r,n,a,o,s,l,c,d=this,u=d.constructor;if(!d.isFinite()||d.isZero())return new u(d);for(Ut=!1,a=d.s*sn(d.s*d,1/3),!a||Math.abs(a)==1/0?(i=Mn(d.d),e=d.e,(a=(e-i.length+1)%3)&&(i+=a==1||a==-2?"0":"00"),a=sn(i,1/3),e=Yn((e+1)/3)-(e%3==(e<0?-1:2)),a==1/0?i="5e"+e:(i=a.toExponential(),i=i.slice(0,i.indexOf("e")+1)+e),r=new u(i),r.s=d.s):r=new u(a.toString()),o=(e=u.precision)+3;;)if(s=r,l=s.times(s).times(s),c=l.plus(d),r=nr(c.plus(d).times(s),c.plus(l),o+2,1),Mn(s.d).slice(0,o)===(i=Mn(r.d)).slice(0,o))if(i=i.slice(o-3,o+1),i=="9999"||!n&&i=="4999"){if(!n&&(vt(s,e+1,0),s.times(s).times(s).eq(d))){r=s;break}o+=4,n=1}else{(!+i||!+i.slice(1)&&i.charAt(0)=="5")&&(vt(r,e+1,1),t=!r.times(r).times(r).eq(d));break}return Ut=!0,vt(r,e,u.rounding,t)};ye.decimalPlaces=ye.dp=function(){var e,t=this.d,i=NaN;if(t){if(e=t.length-1,i=(e-Yn(this.e/Mt))*Mt,e=t[e],e)for(;e%10==0;e/=10)i--;i<0&&(i=0)}return i};ye.dividedBy=ye.div=function(e){return nr(this,new this.constructor(e))};ye.dividedToIntegerBy=ye.divToInt=function(e){var t=this,i=t.constructor;return vt(nr(t,new i(e),0,1,1),i.precision,i.rounding)};ye.equals=ye.eq=function(e){return this.cmp(e)===0};ye.floor=function(){return vt(new this.constructor(this),this.e+1,3)};ye.greaterThan=ye.gt=function(e){return this.cmp(e)>0};ye.greaterThanOrEqualTo=ye.gte=function(e){var t=this.cmp(e);return t==1||t===0};ye.hyperbolicCosine=ye.cosh=function(){var e,t,i,r,n,a=this,o=a.constructor,s=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return s;i=o.precision,r=o.rounding,o.precision=i+Math.max(a.e,a.sd())+4,o.rounding=1,n=a.d.length,n<32?(e=Math.ceil(n/3),t=(1/ew(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),a=vp(o,1,a.times(t),new o(1),!0);for(var l,c=e,d=new o(8);c--;)l=a.times(a),a=s.minus(l.times(d.minus(l.times(d))));return vt(a,o.precision=i,o.rounding=r,!0)};ye.hyperbolicSine=ye.sinh=function(){var e,t,i,r,n=this,a=n.constructor;if(!n.isFinite()||n.isZero())return new a(n);if(t=a.precision,i=a.rounding,a.precision=t+Math.max(n.e,n.sd())+4,a.rounding=1,r=n.d.length,r<3)n=vp(a,2,n,n,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:e|0,n=n.times(1/ew(5,e)),n=vp(a,2,n,n,!0);for(var o,s=new a(5),l=new a(16),c=new a(20);e--;)o=n.times(n),n=n.times(s.plus(o.times(l.times(o).plus(c))))}return a.precision=t,a.rounding=i,vt(n,t,i,!0)};ye.hyperbolicTangent=ye.tanh=function(){var e,t,i=this,r=i.constructor;return i.isFinite()?i.isZero()?new r(i):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,nr(i.sinh(),i.cosh(),r.precision=e,r.rounding=t)):new r(i.s)};ye.inverseCosine=ye.acos=function(){var e,t=this,i=t.constructor,r=t.abs().cmp(1),n=i.precision,a=i.rounding;return r!==-1?r===0?t.isNeg()?ys(i,n,a):new i(0):new i(NaN):t.isZero()?ys(i,n+4,a).times(.5):(i.precision=n+6,i.rounding=1,t=t.asin(),e=ys(i,n+4,a).times(.5),i.precision=n,i.rounding=a,e.minus(t))};ye.inverseHyperbolicCosine=ye.acosh=function(){var e,t,i=this,r=i.constructor;return i.lte(1)?new r(i.eq(1)?0:NaN):i.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(i.e),i.sd())+4,r.rounding=1,Ut=!1,i=i.times(i).minus(1).sqrt().plus(i),Ut=!0,r.precision=e,r.rounding=t,i.ln()):new r(i)};ye.inverseHyperbolicSine=ye.asinh=function(){var e,t,i=this,r=i.constructor;return!i.isFinite()||i.isZero()?new r(i):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(i.e),i.sd())+6,r.rounding=1,Ut=!1,i=i.times(i).plus(1).sqrt().plus(i),Ut=!0,r.precision=e,r.rounding=t,i.ln())};ye.inverseHyperbolicTangent=ye.atanh=function(){var e,t,i,r,n=this,a=n.constructor;return n.isFinite()?n.e>=0?new a(n.abs().eq(1)?n.s/0:n.isZero()?n:NaN):(e=a.precision,t=a.rounding,r=n.sd(),Math.max(r,e)<2*-n.e-1?vt(new a(n),e,t,!0):(a.precision=i=r-n.e,n=nr(n.plus(1),new a(1).minus(n),i+e,1),a.precision=e+4,a.rounding=1,n=n.ln(),a.precision=e,a.rounding=t,n.times(.5))):new a(NaN)};ye.inverseSine=ye.asin=function(){var e,t,i,r,n=this,a=n.constructor;return n.isZero()?new a(n):(t=n.abs().cmp(1),i=a.precision,r=a.rounding,t!==-1?t===0?(e=ys(a,i+4,r).times(.5),e.s=n.s,e):new a(NaN):(a.precision=i+6,a.rounding=1,n=n.div(new a(1).minus(n.times(n)).sqrt().plus(1)).atan(),a.precision=i,a.rounding=r,n.times(2)))};ye.inverseTangent=ye.atan=function(){var e,t,i,r,n,a,o,s,l,c=this,d=c.constructor,u=d.precision,h=d.rounding;if(c.isFinite()){if(c.isZero())return new d(c);if(c.abs().eq(1)&&u+4<=TT)return o=ys(d,u+4,h).times(.25),o.s=c.s,o}else{if(!c.s)return new d(NaN);if(u+4<=TT)return o=ys(d,u+4,h).times(.5),o.s=c.s,o}for(d.precision=s=u+10,d.rounding=1,i=Math.min(28,s/Mt+2|0),e=i;e;--e)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(Ut=!1,t=Math.ceil(s/Mt),r=1,l=c.times(c),o=new d(c),n=c;e!==-1;)if(n=n.times(l),a=o.minus(n.div(r+=2)),n=n.times(l),o=a.plus(n.div(r+=2)),o.d[t]!==void 0)for(e=t;o.d[e]===a.d[e]&&e--;);return i&&(o=o.times(2<<i-1)),Ut=!0,vt(o,d.precision=u,d.rounding=h,!0)};ye.isFinite=function(){return!!this.d};ye.isInteger=ye.isInt=function(){return!!this.d&&Yn(this.e/Mt)>this.d.length-2};ye.isNaN=function(){return!this.s};ye.isNegative=ye.isNeg=function(){return this.s<0};ye.isPositive=ye.isPos=function(){return this.s>0};ye.isZero=function(){return!!this.d&&this.d[0]===0};ye.lessThan=ye.lt=function(e){return this.cmp(e)<0};ye.lessThanOrEqualTo=ye.lte=function(e){return this.cmp(e)<1};ye.logarithm=ye.log=function(e){var t,i,r,n,a,o,s,l,c=this,d=c.constructor,u=d.precision,h=d.rounding,m=5;if(e==null)e=new d(10),t=!0;else{if(e=new d(e),i=e.d,e.s<0||!i||!i[0]||e.eq(1))return new d(NaN);t=e.eq(10)}if(i=c.d,c.s<0||!i||!i[0]||c.eq(1))return new d(i&&!i[0]?-1/0:c.s!=1?NaN:i?0:1/0);if(t)if(i.length>1)a=!0;else{for(n=i[0];n%10===0;)n/=10;a=n!==1}if(Ut=!1,s=u+m,o=dd(c,s),r=t?Ky(d,s+10):dd(e,s),l=nr(o,r,s,1),Ev(l.d,n=u,h))do if(s+=10,o=dd(c,s),r=t?Ky(d,s+10):dd(e,s),l=nr(o,r,s,1),!a){+Mn(l.d).slice(n+1,n+15)+1==1e14&&(l=vt(l,u+1,0));break}while(Ev(l.d,n+=10,h));return Ut=!0,vt(l,u,h)};ye.minus=ye.sub=function(e){var t,i,r,n,a,o,s,l,c,d,u,h,m=this,f=m.constructor;if(e=new f(e),!m.d||!e.d)return!m.s||!e.s?e=new f(NaN):m.d?e.s=-e.s:e=new f(e.d||m.s!==e.s?m:NaN),e;if(m.s!=e.s)return e.s=-e.s,m.plus(e);if(c=m.d,h=e.d,s=f.precision,l=f.rounding,!c[0]||!h[0]){if(h[0])e.s=-e.s;else if(c[0])e=new f(m);else return new f(l===3?-0:0);return Ut?vt(e,s,l):e}if(i=Yn(e.e/Mt),d=Yn(m.e/Mt),c=c.slice(),a=d-i,a){for(u=a<0,u?(t=c,a=-a,o=h.length):(t=h,i=d,o=c.length),r=Math.max(Math.ceil(s/Mt),o)+2,a>r&&(a=r,t.length=1),t.reverse(),r=a;r--;)t.push(0);t.reverse()}else{for(r=c.length,o=h.length,u=r<o,u&&(o=r),r=0;r<o;r++)if(c[r]!=h[r]){u=c[r]<h[r];break}a=0}for(u&&(t=c,c=h,h=t,e.s=-e.s),o=c.length,r=h.length-o;r>0;--r)c[o++]=0;for(r=h.length;r>a;){if(c[--r]<h[r]){for(n=r;n&&c[--n]===0;)c[n]=ws-1;--c[n],c[r]+=ws}c[r]-=h[r]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--i;return c[0]?(e.d=c,e.e=Jy(c,i),Ut?vt(e,s,l):e):new f(l===3?-0:0)};ye.modulo=ye.mod=function(e){var t,i=this,r=i.constructor;return e=new r(e),!i.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||i.d&&!i.d[0]?vt(new r(i),r.precision,r.rounding):(Ut=!1,r.modulo==9?(t=nr(i,e.abs(),0,3,1),t.s*=e.s):t=nr(i,e,0,r.modulo,1),t=t.times(e),Ut=!0,i.minus(t))};ye.naturalExponential=ye.exp=function(){return DT(this)};ye.naturalLogarithm=ye.ln=function(){return dd(this)};ye.negated=ye.neg=function(){var e=new this.constructor(this);return e.s=-e.s,vt(e)};ye.plus=ye.add=function(e){var t,i,r,n,a,o,s,l,c,d,u=this,h=u.constructor;if(e=new h(e),!u.d||!e.d)return!u.s||!e.s?e=new h(NaN):u.d||(e=new h(e.d||u.s===e.s?u:NaN)),e;if(u.s!=e.s)return e.s=-e.s,u.minus(e);if(c=u.d,d=e.d,s=h.precision,l=h.rounding,!c[0]||!d[0])return d[0]||(e=new h(u)),Ut?vt(e,s,l):e;if(a=Yn(u.e/Mt),r=Yn(e.e/Mt),c=c.slice(),n=a-r,n){for(n<0?(i=c,n=-n,o=d.length):(i=d,r=a,o=c.length),a=Math.ceil(s/Mt),o=a>o?a+1:o+1,n>o&&(n=o,i.length=1),i.reverse();n--;)i.push(0);i.reverse()}for(o=c.length,n=d.length,o-n<0&&(n=o,i=d,d=c,c=i),t=0;n;)t=(c[--n]=c[n]+d[n]+t)/ws|0,c[n]%=ws;for(t&&(c.unshift(t),++r),o=c.length;c[--o]==0;)c.pop();return e.d=c,e.e=Jy(c,r),Ut?vt(e,s,l):e};ye.precision=ye.sd=function(e){var t,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ud+e);return i.d?(t=Az(i.d),e&&i.e+1>t&&(t=i.e+1)):t=NaN,t};ye.round=function(){var e=this,t=e.constructor;return vt(new t(e),e.e+1,t.rounding)};ye.sine=ye.sin=function(){var e,t,i=this,r=i.constructor;return i.isFinite()?i.isZero()?new r(i):(e=r.precision,t=r.rounding,r.precision=e+Math.max(i.e,i.sd())+Mt,r.rounding=1,i=ace(r,Iz(r,i)),r.precision=e,r.rounding=t,vt($l>2?i.neg():i,e,t,!0)):new r(NaN)};ye.squareRoot=ye.sqrt=function(){var e,t,i,r,n,a,o=this,s=o.d,l=o.e,c=o.s,d=o.constructor;if(c!==1||!s||!s[0])return new d(!c||c<0&&(!s||s[0])?NaN:s?o:1/0);for(Ut=!1,c=Math.sqrt(+o),c==0||c==1/0?(t=Mn(s),(t.length+l)%2==0&&(t+="0"),c=Math.sqrt(t),l=Yn((l+1)/2)-(l<0||l%2),c==1/0?t="5e"+l:(t=c.toExponential(),t=t.slice(0,t.indexOf("e")+1)+l),r=new d(t)):r=new d(c.toString()),i=(l=d.precision)+3;;)if(a=r,r=a.plus(nr(o,a,i+2,1)).times(.5),Mn(a.d).slice(0,i)===(t=Mn(r.d)).slice(0,i))if(t=t.slice(i-3,i+1),t=="9999"||!n&&t=="4999"){if(!n&&(vt(a,l+1,0),a.times(a).eq(o))){r=a;break}i+=4,n=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(vt(r,l+1,1),e=!r.times(r).eq(o));break}return Ut=!0,vt(r,l,d.rounding,e)};ye.tangent=ye.tan=function(){var e,t,i=this,r=i.constructor;return i.isFinite()?i.isZero()?new r(i):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,i=i.sin(),i.s=1,i=nr(i,new r(1).minus(i.times(i)).sqrt(),e+10,0),r.precision=e,r.rounding=t,vt($l==2||$l==4?i.neg():i,e,t,!0)):new r(NaN)};ye.times=ye.mul=function(e){var t,i,r,n,a,o,s,l,c,d=this,u=d.constructor,h=d.d,m=(e=new u(e)).d;if(e.s*=d.s,!h||!h[0]||!m||!m[0])return new u(!e.s||h&&!h[0]&&!m||m&&!m[0]&&!h?NaN:!h||!m?e.s/0:e.s*0);for(i=Yn(d.e/Mt)+Yn(e.e/Mt),l=h.length,c=m.length,l<c&&(a=h,h=m,m=a,o=l,l=c,c=o),a=[],o=l+c,r=o;r--;)a.push(0);for(r=c;--r>=0;){for(t=0,n=l+r;n>r;)s=a[n]+m[r]*h[n-r-1]+t,a[n--]=s%ws|0,t=s/ws|0;a[n]=(a[n]+t)%ws|0}for(;!a[--o];)a.pop();return t?++i:a.shift(),e.d=a,e.e=Jy(a,i),Ut?vt(e,u.precision,u.rounding):e};ye.toBinary=function(e,t){return IT(this,2,e,t)};ye.toDecimalPlaces=ye.toDP=function(e,t){var i=this,r=i.constructor;return i=new r(i),e===void 0?i:(qa(e,0,hd),t===void 0?t=r.rounding:qa(t,0,8),vt(i,e+i.e+1,t))};ye.toExponential=function(e,t){var i,r=this,n=r.constructor;return e===void 0?i=el(r,!0):(qa(e,0,hd),t===void 0?t=n.rounding:qa(t,0,8),r=vt(new n(r),e+1,t),i=el(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+i:i};ye.toFixed=function(e,t){var i,r,n=this,a=n.constructor;return e===void 0?i=el(n):(qa(e,0,hd),t===void 0?t=a.rounding:qa(t,0,8),r=vt(new a(n),e+n.e+1,t),i=el(r,!1,e+r.e+1)),n.isNeg()&&!n.isZero()?"-"+i:i};ye.toFraction=function(e){var t,i,r,n,a,o,s,l,c,d,u,h,m=this,f=m.d,p=m.constructor;if(!f)return new p(m);if(c=i=new p(1),r=l=new p(0),t=new p(r),a=t.e=Az(f)-m.e-1,o=a%Mt,t.d[0]=sn(10,o<0?Mt+o:o),e==null)e=a>0?t:c;else{if(s=new p(e),!s.isInt()||s.lt(c))throw Error(ud+s);e=s.gt(t)?a>0?t:c:s}for(Ut=!1,s=new p(Mn(f)),d=p.precision,p.precision=a=f.length*Mt*2;u=nr(s,t,0,1,1),n=i.plus(u.times(r)),n.cmp(e)!=1;)i=r,r=n,n=c,c=l.plus(u.times(n)),l=n,n=t,t=s.minus(u.times(n)),s=n;return n=nr(e.minus(i),r,0,1,1),l=l.plus(n.times(c)),i=i.plus(n.times(r)),l.s=c.s=m.s,h=nr(c,r,a,1).minus(m).abs().cmp(nr(l,i,a,1).minus(m).abs())<1?[c,r]:[l,i],p.precision=d,Ut=!0,h};ye.toHexadecimal=ye.toHex=function(e,t){return IT(this,16,e,t)};ye.toNearest=function(e,t){var i=this,r=i.constructor;if(i=new r(i),e==null){if(!i.d)return i;e=new r(1),t=r.rounding}else{if(e=new r(e),t===void 0?t=r.rounding:qa(t,0,8),!i.d)return e.s?i:e;if(!e.d)return e.s&&(e.s=i.s),e}return e.d[0]?(Ut=!1,i=nr(i,e,0,t,1).times(e),Ut=!0,vt(i)):(e.s=i.s,i=e),i};ye.toNumber=function(){return+this};ye.toOctal=function(e,t){return IT(this,8,e,t)};ye.toPower=ye.pow=function(e){var t,i,r,n,a,o,s=this,l=s.constructor,c=+(e=new l(e));if(!s.d||!e.d||!s.d[0]||!e.d[0])return new l(sn(+s,c));if(s=new l(s),s.eq(1))return s;if(r=l.precision,a=l.rounding,e.eq(1))return vt(s,r,a);if(t=Yn(e.e/Mt),t>=e.d.length-1&&(i=c<0?-c:c)<=tce)return n=Tz(l,s,i,r),e.s<0?new l(1).div(n):vt(n,r,a);if(o=s.s,o<0){if(t<e.d.length-1)return new l(NaN);if(e.d[t]&1||(o=1),s.e==0&&s.d[0]==1&&s.d.length==1)return s.s=o,s}return i=sn(+s,c),t=i==0||!isFinite(i)?Yn(c*(Math.log("0."+Mn(s.d))/Math.LN10+s.e+1)):new l(i+"").e,t>l.maxE+1||t<l.minE-1?new l(t>0?o/0:0):(Ut=!1,l.rounding=s.s=1,i=Math.min(12,(t+"").length),n=DT(e.times(dd(s,r+i)),r),n.d&&(n=vt(n,r+5,1),Ev(n.d,r,a)&&(t=r+10,n=vt(DT(e.times(dd(s,t+i)),t),t+5,1),+Mn(n.d).slice(r+1,r+15)+1==1e14&&(n=vt(n,r+1,0)))),n.s=o,Ut=!0,l.rounding=a,vt(n,r,a))};ye.toPrecision=function(e,t){var i,r=this,n=r.constructor;return e===void 0?i=el(r,r.e<=n.toExpNeg||r.e>=n.toExpPos):(qa(e,1,hd),t===void 0?t=n.rounding:qa(t,0,8),r=vt(new n(r),e,t),i=el(r,e<=r.e||r.e<=n.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+i:i};ye.toSignificantDigits=ye.toSD=function(e,t){var i=this,r=i.constructor;return e===void 0?(e=r.precision,t=r.rounding):(qa(e,1,hd),t===void 0?t=r.rounding:qa(t,0,8)),vt(new r(i),e,t)};ye.toString=function(){var e=this,t=e.constructor,i=el(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+i:i};ye.truncated=ye.trunc=function(){return vt(new this.constructor(this),this.e+1,1)};ye.valueOf=ye.toJSON=function(){var e=this,t=e.constructor,i=el(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+i:i};function Mn(e){var t,i,r,n=e.length-1,a="",o=e[0];if(n>0){for(a+=o,t=1;t<n;t++)r=e[t]+"",i=Mt-r.length,i&&(a+=cd(i)),a+=r;o=e[t],r=o+"",i=Mt-r.length,i&&(a+=cd(i))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}function qa(e,t,i){if(e!==~~e||e<t||e>i)throw Error(ud+e)}function Ev(e,t,i,r){var n,a,o,s;for(a=e[0];a>=10;a/=10)--t;return--t<0?(t+=Mt,n=0):(n=Math.ceil((t+1)/Mt),t%=Mt),a=sn(10,Mt-t),s=e[n]%a|0,r==null?t<3?(t==0?s=s/100|0:t==1&&(s=s/10|0),o=i<4&&s==99999||i>3&&s==49999||s==5e4||s==0):o=(i<4&&s+1==a||i>3&&s+1==a/2)&&(e[n+1]/a/100|0)==sn(10,t-2)-1||(s==a/2||s==0)&&(e[n+1]/a/100|0)==0:t<4?(t==0?s=s/1e3|0:t==1?s=s/100|0:t==2&&(s=s/10|0),o=(r||i<4)&&s==9999||!r&&i>3&&s==4999):o=((r||i<4)&&s+1==a||!r&&i>3&&s+1==a/2)&&(e[n+1]/a/1e3|0)==sn(10,t-3)-1,o}function Xy(e,t,i){for(var r,n=[0],a,o=0,s=e.length;o<s;){for(a=n.length;a--;)n[a]*=t;for(n[0]+=ST.indexOf(e.charAt(o++)),r=0;r<n.length;r++)n[r]>i-1&&(n[r+1]===void 0&&(n[r+1]=0),n[r+1]+=n[r]/i|0,n[r]%=i)}return n.reverse()}function rce(e,t){var i,r,n;if(t.isZero())return t;r=t.d.length,r<32?(i=Math.ceil(r/3),n=(1/ew(4,i)).toString()):(i=16,n="2.3283064365386962890625e-10"),e.precision+=i,t=vp(e,1,t.times(n),new e(1));for(var a=i;a--;){var o=t.times(t);t=o.times(o).minus(o).times(8).plus(1)}return e.precision-=i,t}var nr=function(){function e(r,n,a){var o,s=0,l=r.length;for(r=r.slice();l--;)o=r[l]*n+s,r[l]=o%a|0,s=o/a|0;return s&&r.unshift(s),r}function t(r,n,a,o){var s,l;if(a!=o)l=a>o?1:-1;else for(s=l=0;s<a;s++)if(r[s]!=n[s]){l=r[s]>n[s]?1:-1;break}return l}function i(r,n,a,o){for(var s=0;a--;)r[a]-=s,s=r[a]<n[a]?1:0,r[a]=s*o+r[a]-n[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,n,a,o,s,l){var c,d,u,h,m,f,p,g,v,b,_,x,w,y,M,T,C,N,D,k,U=r.constructor,F=r.s==n.s?1:-1,H=r.d,V=n.d;if(!H||!H[0]||!V||!V[0])return new U(!r.s||!n.s||(H?V&&H[0]==V[0]:!V)?NaN:H&&H[0]==0||!V?F*0:F/0);for(l?(m=1,d=r.e-n.e):(l=ws,m=Mt,d=Yn(r.e/m)-Yn(n.e/m)),D=V.length,C=H.length,v=new U(F),b=v.d=[],u=0;V[u]==(H[u]||0);u++);if(V[u]>(H[u]||0)&&d--,a==null?(y=a=U.precision,o=U.rounding):s?y=a+(r.e-n.e)+1:y=a,y<0)b.push(1),f=!0;else{if(y=y/m+2|0,u=0,D==1){for(h=0,V=V[0],y++;(u<C||h)&&y--;u++)M=h*l+(H[u]||0),b[u]=M/V|0,h=M%V|0;f=h||u<C}else{for(h=l/(V[0]+1)|0,h>1&&(V=e(V,h,l),H=e(H,h,l),D=V.length,C=H.length),T=D,_=H.slice(0,D),x=_.length;x<D;)_[x++]=0;k=V.slice(),k.unshift(0),N=V[0],V[1]>=l/2&&++N;do h=0,c=t(V,_,D,x),c<0?(w=_[0],D!=x&&(w=w*l+(_[1]||0)),h=w/N|0,h>1?(h>=l&&(h=l-1),p=e(V,h,l),g=p.length,x=_.length,c=t(p,_,g,x),c==1&&(h--,i(p,D<g?k:V,g,l))):(h==0&&(c=h=1),p=V.slice()),g=p.length,g<x&&p.unshift(0),i(_,p,x,l),c==-1&&(x=_.length,c=t(V,_,D,x),c<1&&(h++,i(_,D<x?k:V,x,l))),x=_.length):c===0&&(h++,_=[0]),b[u++]=h,c&&_[0]?_[x++]=H[T]||0:(_=[H[T]],x=1);while((T++<C||_[0]!==void 0)&&y--);f=_[0]!==void 0}b[0]||b.shift()}if(m==1)v.e=d,yz=f;else{for(u=1,h=b[0];h>=10;h/=10)u++;v.e=u+d*m-1,vt(v,s?a+v.e+1:a,o,f)}return v}}();function vt(e,t,i,r){var n,a,o,s,l,c,d,u,h,m=e.constructor;e:if(t!=null){if(u=e.d,!u)return e;for(n=1,s=u[0];s>=10;s/=10)n++;if(a=t-n,a<0)a+=Mt,o=t,d=u[h=0],l=d/sn(10,n-o-1)%10|0;else if(h=Math.ceil((a+1)/Mt),s=u.length,h>=s)if(r){for(;s++<=h;)u.push(0);d=l=0,n=1,a%=Mt,o=a-Mt+1}else break e;else{for(d=s=u[h],n=1;s>=10;s/=10)n++;a%=Mt,o=a-Mt+n,l=o<0?0:d/sn(10,n-o-1)%10|0}if(r=r||t<0||u[h+1]!==void 0||(o<0?d:d%sn(10,n-o-1)),c=i<4?(l||r)&&(i==0||i==(e.s<0?3:2)):l>5||l==5&&(i==4||r||i==6&&(a>0?o>0?d/sn(10,n-o):0:u[h-1])%10&1||i==(e.s<0?8:7)),t<1||!u[0])return u.length=0,c?(t-=e.e+1,u[0]=sn(10,(Mt-t%Mt)%Mt),e.e=-t||0):u[0]=e.e=0,e;if(a==0?(u.length=h,s=1,h--):(u.length=h+1,s=sn(10,Mt-a),u[h]=o>0?(d/sn(10,n-o)%sn(10,o)|0)*s:0),c)for(;;)if(h==0){for(a=1,o=u[0];o>=10;o/=10)a++;for(o=u[0]+=s,s=1;o>=10;o/=10)s++;a!=s&&(e.e++,u[0]==ws&&(u[0]=1));break}else{if(u[h]+=s,u[h]!=ws)break;u[h--]=0,s=1}for(a=u.length;u[--a]===0;)u.pop()}return Ut&&(e.e>m.maxE?(e.d=null,e.e=NaN):e.e<m.minE&&(e.e=0,e.d=[0])),e}function el(e,t,i){if(!e.isFinite())return Mz(e);var r,n=e.e,a=Mn(e.d),o=a.length;return t?(i&&(r=i-o)>0?a=a.charAt(0)+"."+a.slice(1)+cd(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(e.e<0?"e":"e+")+e.e):n<0?(a="0."+cd(-n-1)+a,i&&(r=i-o)>0&&(a+=cd(r))):n>=o?(a+=cd(n+1-o),i&&(r=i-n-1)>0&&(a=a+"."+cd(r))):((r=n+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),i&&(r=i-o)>0&&(n+1===o&&(a+="."),a+=cd(r))),a}function Jy(e,t){var i=e[0];for(t*=Mt;i>=10;i/=10)t++;return t}function Ky(e,t,i){if(t>ice)throw Ut=!0,i&&(e.precision=i),Error(wz);return vt(new e(Yy),t,1,!0)}function ys(e,t,i){if(t>TT)throw Error(wz);return vt(new e(Zy),t,i,!0)}function Az(e){var t=e.length-1,i=t*Mt+1;if(t=e[t],t){for(;t%10==0;t/=10)i--;for(t=e[0];t>=10;t/=10)i++}return i}function cd(e){for(var t="";e--;)t+="0";return t}function Tz(e,t,i,r){var n,a=new e(1),o=Math.ceil(r/Mt+4);for(Ut=!1;;){if(i%2&&(a=a.times(t),bz(a.d,o)&&(n=!0)),i=Yn(i/2),i===0){i=a.d.length-1,n&&a.d[i]===0&&++a.d[i];break}t=t.times(t),bz(t.d,o)}return Ut=!0,a}function _z(e){return e.d[e.d.length-1]&1}function Dz(e,t,i){for(var r,n=new e(t[0]),a=0;++a<t.length;)if(r=new e(t[a]),r.s)n[i](r)&&(n=r);else{n=r;break}return n}function DT(e,t){var i,r,n,a,o,s,l,c=0,d=0,u=0,h=e.constructor,m=h.rounding,f=h.precision;if(!e.d||!e.d[0]||e.e>17)return new h(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(t==null?(Ut=!1,l=f):l=t,s=new h(.03125);e.e>-2;)e=e.times(s),u+=5;for(r=Math.log(sn(2,u))/Math.LN10*2+5|0,l+=r,i=a=o=new h(1),h.precision=l;;){if(a=vt(a.times(e),l,1),i=i.times(++d),s=o.plus(nr(a,i,l,1)),Mn(s.d).slice(0,l)===Mn(o.d).slice(0,l)){for(n=u;n--;)o=vt(o.times(o),l,1);if(t==null)if(c<3&&Ev(o.d,l-r,m,c))h.precision=l+=10,i=a=s=new h(1),d=0,c++;else return vt(o,h.precision=f,m,Ut=!0);else return h.precision=f,o}o=s}}function dd(e,t){var i,r,n,a,o,s,l,c,d,u,h,m=1,f=10,p=e,g=p.d,v=p.constructor,b=v.rounding,_=v.precision;if(p.s<0||!g||!g[0]||!p.e&&g[0]==1&&g.length==1)return new v(g&&!g[0]?-1/0:p.s!=1?NaN:g?0:p);if(t==null?(Ut=!1,d=_):d=t,v.precision=d+=f,i=Mn(g),r=i.charAt(0),Math.abs(a=p.e)<15e14){for(;r<7&&r!=1||r==1&&i.charAt(1)>3;)p=p.times(e),i=Mn(p.d),r=i.charAt(0),m++;a=p.e,r>1?(p=new v("0."+i),a++):p=new v(r+"."+i.slice(1))}else return c=Ky(v,d+2,_).times(a+""),p=dd(new v(r+"."+i.slice(1)),d-f).plus(c),v.precision=_,t==null?vt(p,_,b,Ut=!0):p;for(u=p,l=o=p=nr(p.minus(1),p.plus(1),d,1),h=vt(p.times(p),d,1),n=3;;){if(o=vt(o.times(h),d,1),c=l.plus(nr(o,new v(n),d,1)),Mn(c.d).slice(0,d)===Mn(l.d).slice(0,d))if(l=l.times(2),a!==0&&(l=l.plus(Ky(v,d+2,_).times(a+""))),l=nr(l,new v(m),d,1),t==null)if(Ev(l.d,d-f,b,s))v.precision=d+=f,c=o=p=nr(u.minus(1),u.plus(1),d,1),h=vt(p.times(p),d,1),n=s=1;else return vt(l,v.precision=_,b,Ut=!0);else return v.precision=_,l;l=c,n+=2}}function Mz(e){return String(e.s*e.s/0)}function MT(e,t){var i,r,n;for((i=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(i<0&&(i=r),i+=+t.slice(r+1),t=t.substring(0,r)):i<0&&(i=t.length),r=0;t.charCodeAt(r)===48;r++);for(n=t.length;t.charCodeAt(n-1)===48;--n);if(t=t.slice(r,n),t){if(n-=r,e.e=i=i-r-1,e.d=[],r=(i+1)%Mt,i<0&&(r+=Mt),r<n){for(r&&e.d.push(+t.slice(0,r)),n-=Mt;r<n;)e.d.push(+t.slice(r,r+=Mt));t=t.slice(r),r=Mt-t.length}else r-=n;for(;r--;)t+="0";e.d.push(+t),Ut&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function nce(e,t){var i,r,n,a,o,s,l,c,d;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),Sz.test(t))return MT(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(Jle.test(t))i=16,t=t.toLowerCase();else if(Qle.test(t))i=2;else if(ece.test(t))i=8;else throw Error(ud+t);for(a=t.search(/p/i),a>0?(l=+t.slice(a+1),t=t.substring(2,a)):t=t.slice(2),a=t.indexOf("."),o=a>=0,r=e.constructor,o&&(t=t.replace(".",""),s=t.length,a=s-a,n=Tz(r,new r(i),a,a*2)),c=Xy(t,i,ws),d=c.length-1,a=d;c[a]===0;--a)c.pop();return a<0?new r(e.s*0):(e.e=Jy(c,d),e.d=c,Ut=!1,o&&(e=nr(e,n,s*4)),l&&(e=e.times(Math.abs(l)<54?sn(2,l):Sv.pow(2,l))),Ut=!0,e)}function ace(e,t){var i,r=t.d.length;if(r<3)return t.isZero()?t:vp(e,2,t,t);i=1.4*Math.sqrt(r),i=i>16?16:i|0,t=t.times(1/ew(5,i)),t=vp(e,2,t,t);for(var n,a=new e(5),o=new e(16),s=new e(20);i--;)n=t.times(t),t=t.times(a.plus(n.times(o.times(n).minus(s))));return t}function vp(e,t,i,r,n){var a,o,s,l,c=1,d=e.precision,u=Math.ceil(d/Mt);for(Ut=!1,l=i.times(i),s=new e(r);;){if(o=nr(s.times(l),new e(t++*t++),d,1),s=n?r.plus(o):r.minus(o),r=nr(o.times(l),new e(t++*t++),d,1),o=s.plus(r),o.d[u]!==void 0){for(a=u;o.d[a]===s.d[a]&&a--;);if(a==-1)break}a=s,s=r,r=o,o=a,c++}return Ut=!0,o.d.length=u+1,o}function ew(e,t){for(var i=e;--t;)i*=e;return i}function Iz(e,t){var i,r=t.s<0,n=ys(e,e.precision,1),a=n.times(.5);if(t=t.abs(),t.lte(a))return $l=r?4:1,t;if(i=t.divToInt(n),i.isZero())$l=r?3:2;else{if(t=t.minus(i.times(n)),t.lte(a))return $l=_z(i)?r?2:3:r?4:1,t;$l=_z(i)?r?1:4:r?3:2}return t.minus(n).abs()}function IT(e,t,i,r){var n,a,o,s,l,c,d,u,h,m=e.constructor,f=i!==void 0;if(f?(qa(i,1,hd),r===void 0?r=m.rounding:qa(r,0,8)):(i=m.precision,r=m.rounding),!e.isFinite())d=Mz(e);else{for(d=el(e),o=d.indexOf("."),f?(n=2,t==16?i=i*4-3:t==8&&(i=i*3-2)):n=t,o>=0&&(d=d.replace(".",""),h=new m(1),h.e=d.length-o,h.d=Xy(el(h),10,n),h.e=h.d.length),u=Xy(d,10,n),a=l=u.length;u[--l]==0;)u.pop();if(!u[0])d=f?"0p+0":"0";else{if(o<0?a--:(e=new m(e),e.d=u,e.e=a,e=nr(e,h,i,r,0,n),u=e.d,a=e.e,c=yz),o=u[i],s=n/2,c=c||u[i+1]!==void 0,c=r<4?(o!==void 0||c)&&(r===0||r===(e.s<0?3:2)):o>s||o===s&&(r===4||c||r===6&&u[i-1]&1||r===(e.s<0?8:7)),u.length=i,c)for(;++u[--i]>n-1;)u[i]=0,i||(++a,u.unshift(1));for(l=u.length;!u[l-1];--l);for(o=0,d="";o<l;o++)d+=ST.charAt(u[o]);if(f){if(l>1)if(t==16||t==8){for(o=t==16?4:3,--l;l%o;l++)d+="0";for(u=Xy(d,n,t),l=u.length;!u[l-1];--l);for(o=1,d="1.";o<l;o++)d+=ST.charAt(u[o])}else d=d.charAt(0)+"."+d.slice(1);d=d+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)d="0"+d;d="0."+d}else if(++a>l)for(a-=l;a--;)d+="0";else a<l&&(d=d.slice(0,a)+"."+d.slice(a))}d=(t==16?"0x":t==2?"0b":t==8?"0o":"")+d}return e.s<0?"-"+d:d}function bz(e,t){if(e.length>t)return e.length=t,!0}function oce(e){return new this(e).abs()}function sce(e){return new this(e).acos()}function lce(e){return new this(e).acosh()}function cce(e,t){return new this(e).plus(t)}function dce(e){return new this(e).asin()}function uce(e){return new this(e).asinh()}function hce(e){return new this(e).atan()}function mce(e){return new this(e).atanh()}function pce(e,t){e=new this(e),t=new this(t);var i,r=this.precision,n=this.rounding,a=r+4;return!e.s||!t.s?i=new this(NaN):!e.d&&!t.d?(i=ys(this,a,1).times(t.s>0?.25:.75),i.s=e.s):!t.d||e.isZero()?(i=t.s<0?ys(this,r,n):new this(0),i.s=e.s):!e.d||t.isZero()?(i=ys(this,a,1).times(.5),i.s=e.s):t.s<0?(this.precision=a,this.rounding=1,i=this.atan(nr(e,t,a,1)),t=ys(this,a,1),this.precision=r,this.rounding=n,i=e.s<0?i.minus(t):i.plus(t)):i=this.atan(nr(e,t,a,1)),i}function fce(e){return new this(e).cbrt()}function gce(e){return vt(e=new this(e),e.e+1,2)}function vce(e,t,i){return new this(e).clamp(t,i)}function _ce(e){if(!e||typeof e!="object")throw Error(Qy+"Object expected");var t,i,r,n=e.defaults===!0,a=["precision",1,hd,"rounding",0,8,"toExpNeg",-gp,0,"toExpPos",0,gp,"maxE",0,gp,"minE",-gp,0,"modulo",0,9];for(t=0;t<a.length;t+=3)if(i=a[t],n&&(this[i]=AT[i]),(r=e[i])!==void 0)if(Yn(r)===r&&r>=a[t+1]&&r<=a[t+2])this[i]=r;else throw Error(ud+i+": "+r);if(i="crypto",n&&(this[i]=AT[i]),(r=e[i])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[i]=!0;else throw Error(Cz);else this[i]=!1;else throw Error(ud+i+": "+r);return this}function bce(e){return new this(e).cos()}function xce(e){return new this(e).cosh()}function kz(e){var t,i,r;function n(a){var o,s,l,c=this;if(!(c instanceof n))return new n(a);if(c.constructor=n,xz(a)){c.s=a.s,Ut?!a.d||a.e>n.maxE?(c.e=NaN,c.d=null):a.e<n.minE?(c.e=0,c.d=[0]):(c.e=a.e,c.d=a.d.slice()):(c.e=a.e,c.d=a.d?a.d.slice():a.d);return}if(l=typeof a,l==="number"){if(a===0){c.s=1/a<0?-1:1,c.e=0,c.d=[0];return}if(a<0?(a=-a,c.s=-1):c.s=1,a===~~a&&a<1e7){for(o=0,s=a;s>=10;s/=10)o++;Ut?o>n.maxE?(c.e=NaN,c.d=null):o<n.minE?(c.e=0,c.d=[0]):(c.e=o,c.d=[a]):(c.e=o,c.d=[a]);return}else if(a*0!==0){a||(c.s=NaN),c.e=NaN,c.d=null;return}return MT(c,a.toString())}else if(l!=="string")throw Error(ud+a);return(s=a.charCodeAt(0))===45?(a=a.slice(1),c.s=-1):(s===43&&(a=a.slice(1)),c.s=1),Sz.test(a)?MT(c,a):nce(c,a)}if(n.prototype=ye,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.EUCLID=9,n.config=n.set=_ce,n.clone=kz,n.isDecimal=xz,n.abs=oce,n.acos=sce,n.acosh=lce,n.add=cce,n.asin=dce,n.asinh=uce,n.atan=hce,n.atanh=mce,n.atan2=pce,n.cbrt=fce,n.ceil=gce,n.clamp=vce,n.cos=bce,n.cosh=xce,n.div=yce,n.exp=wce,n.floor=Cce,n.hypot=Ece,n.ln=Sce,n.log=Ace,n.log10=Dce,n.log2=Tce,n.max=Mce,n.min=Ice,n.mod=kce,n.mul=Nce,n.pow=Pce,n.random=Rce,n.round=Fce,n.sign=Oce,n.sin=Lce,n.sinh=Bce,n.sqrt=Vce,n.sub=zce,n.sum=Uce,n.tan=Hce,n.tanh=Gce,n.trunc=jce,e===void 0&&(e={}),e&&e.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<r.length;)e.hasOwnProperty(i=r[t++])||(e[i]=this[i]);return n.config(e),n}function yce(e,t){return new this(e).div(t)}function wce(e){return new this(e).exp()}function Cce(e){return vt(e=new this(e),e.e+1,3)}function Ece(){var e,t,i=new this(0);for(Ut=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)i.d&&(i=i.plus(t.times(t)));else{if(t.s)return Ut=!0,new this(1/0);i=t}return Ut=!0,i.sqrt()}function xz(e){return e instanceof Sv||e&&e.toStringTag===Ez||!1}function Sce(e){return new this(e).ln()}function Ace(e,t){return new this(e).log(t)}function Tce(e){return new this(e).log(2)}function Dce(e){return new this(e).log(10)}function Mce(){return Dz(this,arguments,"lt")}function Ice(){return Dz(this,arguments,"gt")}function kce(e,t){return new this(e).mod(t)}function Nce(e,t){return new this(e).mul(t)}function Pce(e,t){return new this(e).pow(t)}function Rce(e){var t,i,r,n,a=0,o=new this(1),s=[];if(e===void 0?e=this.precision:qa(e,1,hd),r=Math.ceil(e/Mt),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));a<r;)n=t[a],n>=429e7?t[a]=crypto.getRandomValues(new Uint32Array(1))[0]:s[a++]=n%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(r*=4);a<r;)n=t[a]+(t[a+1]<<8)+(t[a+2]<<16)+((t[a+3]&127)<<24),n>=214e7?crypto.randomBytes(4).copy(t,a):(s.push(n%1e7),a+=4);a=r/4}else throw Error(Cz);else for(;a<r;)s[a++]=Math.random()*1e7|0;for(r=s[--a],e%=Mt,r&&e&&(n=sn(10,Mt-e),s[a]=(r/n|0)*n);s[a]===0;a--)s.pop();if(a<0)i=0,s=[0];else{for(i=-1;s[0]===0;i-=Mt)s.shift();for(r=1,n=s[0];n>=10;n/=10)r++;r<Mt&&(i-=Mt-r)}return o.e=i,o.d=s,o}function Fce(e){return vt(e=new this(e),e.e+1,this.rounding)}function Oce(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function Lce(e){return new this(e).sin()}function Bce(e){return new this(e).sinh()}function Vce(e){return new this(e).sqrt()}function zce(e,t){return new this(e).sub(t)}function Uce(){var e=0,t=arguments,i=new this(t[e]);for(Ut=!1;i.s&&++e<t.length;)i=i.plus(t[e]);return Ut=!0,vt(i,this.precision,this.rounding)}function Hce(e){return new this(e).tan()}function Gce(e){return new this(e).tanh()}function jce(e){return vt(e=new this(e),e.e+1,1)}ye[Symbol.for("nodejs.util.inspect.custom")]=ye.toString;ye[Symbol.toStringTag]="Decimal";var Sv=ye.constructor=kz(AT);Yy=new Sv(Yy);Zy=new Sv(Zy);var kT=Sv;var Wce="BigNumber",qce=["?on","config"],NT=ie(Wce,qce,e=>{var{on:t,config:i}=e,r=kT.clone({precision:i.precision,modulo:kT.EUCLID});return r.prototype=Object.create(r.prototype),r.prototype.type="BigNumber",r.prototype.isBigNumber=!0,r.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},r.fromJSON=function(n){return new r(n.value)},t&&t("config",function(n,a){n.precision!==a.precision&&r.config({precision:n.precision})}),r},{isClass:!0});var Zn=Math.cosh||function(e){return Math.abs(e)<1e-9?1-e:(Math.exp(e)+Math.exp(-e))*.5},Qo=Math.sinh||function(e){return Math.abs(e)<1e-9?e:(Math.exp(e)-Math.exp(-e))*.5},$ce=function(e){var t=Math.PI/4;if(-t>e||e>t)return Math.cos(e)-1;var i=e*e;return i*(i*(i*(i*(i*(i*(i*(i/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},Xce=function(e,t){var i=Math.abs(e),r=Math.abs(t);return i<3e3&&r<3e3?Math.sqrt(i*i+r*r):(i<r?(i=r,r=e/t):r=t/e,i*Math.sqrt(1+r*r))},_p=function(){throw SyntaxError("Invalid Param")};function PT(e,t){var i=Math.abs(e),r=Math.abs(t);return e===0?Math.log(r):t===0?Math.log(i):i<3e3&&r<3e3?Math.log(e*e+t*t)*.5:(e=e/2,t=t/2,.5*Math.log(e*e+t*t)+Math.LN2)}var Yce=function(e,t){var i={re:0,im:0};if(e==null)i.re=i.im=0;else if(t!==void 0)i.re=e,i.im=t;else switch(typeof e){case"object":if("im"in e&&"re"in e)i.re=e.re,i.im=e.im;else if("abs"in e&&"arg"in e){if(!Number.isFinite(e.abs)&&Number.isFinite(e.arg))return le.INFINITY;i.re=e.abs*Math.cos(e.arg),i.im=e.abs*Math.sin(e.arg)}else if("r"in e&&"phi"in e){if(!Number.isFinite(e.r)&&Number.isFinite(e.phi))return le.INFINITY;i.re=e.r*Math.cos(e.phi),i.im=e.r*Math.sin(e.phi)}else e.length===2?(i.re=e[0],i.im=e[1]):_p();break;case"string":i.im=i.re=0;var r=e.replace(/_/g,"").match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),n=1,a=0;r===null&&_p();for(var o=0;o<r.length;o++){var s=r[o];s===" "||s==="	"||s===`
`||(s==="+"?n++:s==="-"?a++:s==="i"||s==="I"?(n+a===0&&_p(),r[o+1]!==" "&&!isNaN(r[o+1])?(i.im+=parseFloat((a%2?"-":"")+r[o+1]),o++):i.im+=parseFloat((a%2?"-":"")+"1"),n=a=0):((n+a===0||isNaN(s))&&_p(),r[o+1]==="i"||r[o+1]==="I"?(i.im+=parseFloat((a%2?"-":"")+s),o++):i.re+=parseFloat((a%2?"-":"")+s),n=a=0))}n+a>0&&_p();break;case"number":i.im=0,i.re=e;break;default:_p()}return isNaN(i.re)||isNaN(i.im),i};function le(e,t){if(!(this instanceof le))return new le(e,t);var i=Yce(e,t);this.re=i.re,this.im=i.im}le.prototype={re:0,im:0,sign:function(){var e=this.abs();return new le(this.re/e,this.im/e)},add:function(e,t){var i=new le(e,t);return this.isInfinite()&&i.isInfinite()?le.NAN:this.isInfinite()||i.isInfinite()?le.INFINITY:new le(this.re+i.re,this.im+i.im)},sub:function(e,t){var i=new le(e,t);return this.isInfinite()&&i.isInfinite()?le.NAN:this.isInfinite()||i.isInfinite()?le.INFINITY:new le(this.re-i.re,this.im-i.im)},mul:function(e,t){var i=new le(e,t);return this.isInfinite()&&i.isZero()||this.isZero()&&i.isInfinite()?le.NAN:this.isInfinite()||i.isInfinite()?le.INFINITY:i.im===0&&this.im===0?new le(this.re*i.re,0):new le(this.re*i.re-this.im*i.im,this.re*i.im+this.im*i.re)},div:function(e,t){var i=new le(e,t);if(this.isZero()&&i.isZero()||this.isInfinite()&&i.isInfinite())return le.NAN;if(this.isInfinite()||i.isZero())return le.INFINITY;if(this.isZero()||i.isInfinite())return le.ZERO;e=this.re,t=this.im;var r=i.re,n=i.im,a,o;return n===0?new le(e/r,t/r):Math.abs(r)<Math.abs(n)?(o=r/n,a=r*o+n,new le((e*o+t)/a,(t*o-e)/a)):(o=n/r,a=n*o+r,new le((e+t*o)/a,(t-e*o)/a))},pow:function(e,t){var i=new le(e,t);if(e=this.re,t=this.im,i.isZero())return le.ONE;if(i.im===0){if(t===0&&e>0)return new le(Math.pow(e,i.re),0);if(e===0)switch((i.re%4+4)%4){case 0:return new le(Math.pow(t,i.re),0);case 1:return new le(0,Math.pow(t,i.re));case 2:return new le(-Math.pow(t,i.re),0);case 3:return new le(0,-Math.pow(t,i.re))}}if(e===0&&t===0&&i.re>0&&i.im>=0)return le.ZERO;var r=Math.atan2(t,e),n=PT(e,t);return e=Math.exp(i.re*n-i.im*r),t=i.im*n+i.re*r,new le(e*Math.cos(t),e*Math.sin(t))},sqrt:function(){var e=this.re,t=this.im,i=this.abs(),r,n;if(e>=0){if(t===0)return new le(Math.sqrt(e),0);r=.5*Math.sqrt(2*(i+e))}else r=Math.abs(t)/Math.sqrt(2*(i-e));return e<=0?n=.5*Math.sqrt(2*(i-e)):n=Math.abs(t)/Math.sqrt(2*(i+e)),new le(r,t<0?-n:n)},exp:function(){var e=Math.exp(this.re);return this.im,new le(e*Math.cos(this.im),e*Math.sin(this.im))},expm1:function(){var e=this.re,t=this.im;return new le(Math.expm1(e)*Math.cos(t)+$ce(t),Math.exp(e)*Math.sin(t))},log:function(){var e=this.re,t=this.im;return t===0&&e>0,new le(PT(e,t),Math.atan2(t,e))},abs:function(){return Xce(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var e=this.re,t=this.im;return new le(Math.sin(e)*Zn(t),Math.cos(e)*Qo(t))},cos:function(){var e=this.re,t=this.im;return new le(Math.cos(e)*Zn(t),-Math.sin(e)*Qo(t))},tan:function(){var e=2*this.re,t=2*this.im,i=Math.cos(e)+Zn(t);return new le(Math.sin(e)/i,Qo(t)/i)},cot:function(){var e=2*this.re,t=2*this.im,i=Math.cos(e)-Zn(t);return new le(-Math.sin(e)/i,Qo(t)/i)},sec:function(){var e=this.re,t=this.im,i=.5*Zn(2*t)+.5*Math.cos(2*e);return new le(Math.cos(e)*Zn(t)/i,Math.sin(e)*Qo(t)/i)},csc:function(){var e=this.re,t=this.im,i=.5*Zn(2*t)-.5*Math.cos(2*e);return new le(Math.sin(e)*Zn(t)/i,-Math.cos(e)*Qo(t)/i)},asin:function(){var e=this.re,t=this.im,i=new le(t*t-e*e+1,-2*e*t).sqrt(),r=new le(i.re-t,i.im+e).log();return new le(r.im,-r.re)},acos:function(){var e=this.re,t=this.im,i=new le(t*t-e*e+1,-2*e*t).sqrt(),r=new le(i.re-t,i.im+e).log();return new le(Math.PI/2-r.im,r.re)},atan:function(){var e=this.re,t=this.im;if(e===0){if(t===1)return new le(0,1/0);if(t===-1)return new le(0,-1/0)}var i=e*e+(1-t)*(1-t),r=new le((1-t*t-e*e)/i,-2*e/i).log();return new le(-.5*r.im,.5*r.re)},acot:function(){var e=this.re,t=this.im;if(t===0)return new le(Math.atan2(1,e),0);var i=e*e+t*t;return i!==0?new le(e/i,-t/i).atan():new le(e!==0?e/0:0,t!==0?-t/0:0).atan()},asec:function(){var e=this.re,t=this.im;if(e===0&&t===0)return new le(0,1/0);var i=e*e+t*t;return i!==0?new le(e/i,-t/i).acos():new le(e!==0?e/0:0,t!==0?-t/0:0).acos()},acsc:function(){var e=this.re,t=this.im;if(e===0&&t===0)return new le(Math.PI/2,1/0);var i=e*e+t*t;return i!==0?new le(e/i,-t/i).asin():new le(e!==0?e/0:0,t!==0?-t/0:0).asin()},sinh:function(){var e=this.re,t=this.im;return new le(Qo(e)*Math.cos(t),Zn(e)*Math.sin(t))},cosh:function(){var e=this.re,t=this.im;return new le(Zn(e)*Math.cos(t),Qo(e)*Math.sin(t))},tanh:function(){var e=2*this.re,t=2*this.im,i=Zn(e)+Math.cos(t);return new le(Qo(e)/i,Math.sin(t)/i)},coth:function(){var e=2*this.re,t=2*this.im,i=Zn(e)-Math.cos(t);return new le(Qo(e)/i,-Math.sin(t)/i)},csch:function(){var e=this.re,t=this.im,i=Math.cos(2*t)-Zn(2*e);return new le(-2*Qo(e)*Math.cos(t)/i,2*Zn(e)*Math.sin(t)/i)},sech:function(){var e=this.re,t=this.im,i=Math.cos(2*t)+Zn(2*e);return new le(2*Zn(e)*Math.cos(t)/i,-2*Qo(e)*Math.sin(t)/i)},asinh:function(){var e=this.im;this.im=-this.re,this.re=e;var t=this.asin();return this.re=-this.im,this.im=e,e=t.re,t.re=-t.im,t.im=e,t},acosh:function(){var e=this.acos();if(e.im<=0){var t=e.re;e.re=-e.im,e.im=t}else{var t=e.im;e.im=-e.re,e.re=t}return e},atanh:function(){var e=this.re,t=this.im,i=e>1&&t===0,r=1-e,n=1+e,a=r*r+t*t,o=a!==0?new le((n*r-t*t)/a,(t*r+n*t)/a):new le(e!==-1?e/0:0,t!==0?t/0:0),s=o.re;return o.re=PT(o.re,o.im)/2,o.im=Math.atan2(o.im,s)/2,i&&(o.im=-o.im),o},acoth:function(){var e=this.re,t=this.im;if(e===0&&t===0)return new le(0,Math.PI/2);var i=e*e+t*t;return i!==0?new le(e/i,-t/i).atanh():new le(e!==0?e/0:0,t!==0?-t/0:0).atanh()},acsch:function(){var e=this.re,t=this.im;if(t===0)return new le(e!==0?Math.log(e+Math.sqrt(e*e+1)):1/0,0);var i=e*e+t*t;return i!==0?new le(e/i,-t/i).asinh():new le(e!==0?e/0:0,t!==0?-t/0:0).asinh()},asech:function(){var e=this.re,t=this.im;if(this.isZero())return le.INFINITY;var i=e*e+t*t;return i!==0?new le(e/i,-t/i).acosh():new le(e!==0?e/0:0,t!==0?-t/0:0).acosh()},inverse:function(){if(this.isZero())return le.INFINITY;if(this.isInfinite())return le.ZERO;var e=this.re,t=this.im,i=e*e+t*t;return new le(e/i,-t/i)},conjugate:function(){return new le(this.re,-this.im)},neg:function(){return new le(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new le(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new le(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new le(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,t){var i=new le(e,t);return Math.abs(i.re-this.re)<=le.EPSILON&&Math.abs(i.im-this.im)<=le.EPSILON},clone:function(){return new le(this.re,this.im)},toString:function(){var e=this.re,t=this.im,i="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(e)<le.EPSILON&&(e=0),Math.abs(t)<le.EPSILON&&(t=0),t===0?i+e:(e!==0?(i+=e,i+=" ",t<0?(t=-t,i+="-"):i+="+",i+=" "):t<0&&(t=-t,i+="-"),t!==1&&(i+=t),i+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}};le.ZERO=new le(0,0);le.ONE=new le(1,0);le.I=new le(0,1);le.PI=new le(Math.PI,0);le.E=new le(Math.E,0);le.INFINITY=new le(1/0,1/0);le.NAN=new le(NaN,NaN);le.EPSILON=1e-15;var Zce="Complex",Kce=[],RT=ie(Zce,Kce,()=>(Object.defineProperty(le,"name",{value:"Complex"}),le.prototype.constructor=le,le.prototype.type="Complex",le.prototype.isComplex=!0,le.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},le.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},le.prototype.format=function(e){var t="",i=this.im,r=this.re,n=Cv(this.re,e),a=Cv(this.im,e),o=xi(e)?e:e?e.precision:null;if(o!==null){var s=Math.pow(10,-o);Math.abs(r/i)<s&&(r=0),Math.abs(i/r)<s&&(i=0)}return i===0?t=n:r===0?i===1?t="i":i===-1?t="-i":t=a+"i":i<0?i===-1?t=n+" - i":t=n+" - "+a.substring(1)+"i":i===1?t=n+" + i":t=n+" + "+a+"i",t},le.fromPolar=function(e){switch(arguments.length){case 1:{var t=arguments[0];if(typeof t=="object")return le(t);throw new TypeError("Input has to be an object with r and phi keys.")}case 2:{var i=arguments[0],r=arguments[1];if(xi(i)){if(Vy(r)&&r.hasBase("ANGLE")&&(r=r.toNumber("rad")),xi(r))return new le({r:i,phi:r});throw new TypeError("Phi is not a number nor an angle unit.")}else throw new TypeError("Radius r is not a number.")}default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},le.prototype.valueOf=le.prototype.toString,le.fromJSON=function(e){return new le(e)},le.compare=function(e,t){return e.re>t.re?1:e.re<t.re?-1:e.im>t.im?1:e.im<t.im?-1:0},le),{isClass:!0});var Qce=2e3,mt={s:1,n:0,d:1};function Xl(e,t){if(isNaN(e=parseInt(e,10)))throw tw();return e*t}function Ir(e,t){if(t===0)throw FT();var i=Object.create(Cn.prototype);i.s=e<0?-1:1,e=e<0?-e:e;var r=bp(e,t);return i.n=e/r,i.d=t/r,i}function Nz(e){for(var t={},i=e,r=2,n=4;n<=i;){for(;i%r===0;)i/=r,t[r]=(t[r]||0)+1;n+=1+2*r++}return i!==e?i>1&&(t[i]=(t[i]||0)+1):t[e]=(t[e]||0)+1,t}var xo=function(e,t){var i=0,r=1,n=1,a=0,o=0,s=0,l=1,c=1,d=0,u=1,h=1,m=1,f=1e7,p;if(e!=null)if(t!==void 0){if(i=e,r=t,n=i*r,i%1!==0||r%1!==0)throw ide()}else switch(typeof e){case"object":{if("d"in e&&"n"in e)i=e.n,r=e.d,"s"in e&&(i*=e.s);else if(0 in e)i=e[0],1 in e&&(r=e[1]);else throw tw();n=i*r;break}case"number":{if(e<0&&(n=e,e=-e),e%1===0)i=e;else if(e>0){for(e>=1&&(c=Math.pow(10,Math.floor(1+Math.log(e)/Math.LN10)),e/=c);u<=f&&m<=f;)if(p=(d+h)/(u+m),e===p){u+m<=f?(i=d+h,r=u+m):m>u?(i=h,r=m):(i=d,r=u);break}else e>p?(d+=h,u+=m):(h+=d,m+=u),u>f?(i=h,r=m):(i=d,r=u);i*=c}else(isNaN(e)||isNaN(t))&&(r=i=NaN);break}case"string":{if(u=e.match(/\d+|./g),u===null)throw tw();if(u[d]==="-"?(n=-1,d++):u[d]==="+"&&d++,u.length===d+1?o=Xl(u[d++],n):u[d+1]==="."||u[d]==="."?(u[d]!=="."&&(a=Xl(u[d++],n)),d++,(d+1===u.length||u[d+1]==="("&&u[d+3]===")"||u[d+1]==="'"&&u[d+3]==="'")&&(o=Xl(u[d],n),l=Math.pow(10,u[d].length),d++),(u[d]==="("&&u[d+2]===")"||u[d]==="'"&&u[d+2]==="'")&&(s=Xl(u[d+1],n),c=Math.pow(10,u[d+1].length)-1,d+=3)):u[d+1]==="/"||u[d+1]===":"?(o=Xl(u[d],n),l=Xl(u[d+2],1),d+=3):u[d+3]==="/"&&u[d+1]===" "&&(a=Xl(u[d],n),o=Xl(u[d+2],n),l=Xl(u[d+4],1),d+=5),u.length<=d){r=l*c,n=i=s+r*a+c*o;break}}default:throw tw()}if(r===0)throw FT();mt.s=n<0?-1:1,mt.n=Math.abs(i),mt.d=Math.abs(r)};function Jce(e,t,i){for(var r=1;t>0;e=e*e%i,t>>=1)t&1&&(r=r*e%i);return r}function ede(e,t){for(;t%2===0;t/=2);for(;t%5===0;t/=5);if(t===1)return 0;for(var i=10%t,r=1;i!==1;r++)if(i=i*10%t,r>Qce)return 0;return r}function tde(e,t,i){for(var r=1,n=Jce(10,i,t),a=0;a<300;a++){if(r===n)return a;r=r*10%t,n=n*10%t}return 0}function bp(e,t){if(!e)return t;if(!t)return e;for(;;){if(e%=t,!e)return t;if(t%=e,!t)return e}}function Cn(e,t){if(xo(e,t),this instanceof Cn)e=bp(mt.d,mt.n),this.s=mt.s,this.n=mt.n/e,this.d=mt.d/e;else return Ir(mt.s*mt.n,mt.d)}var FT=function(){return new Error("Division by Zero")},tw=function(){return new Error("Invalid argument")},ide=function(){return new Error("Parameters must be integer")};Cn.prototype={s:1,n:0,d:1,abs:function(){return Ir(this.n,this.d)},neg:function(){return Ir(-this.s*this.n,this.d)},add:function(e,t){return xo(e,t),Ir(this.s*this.n*mt.d+mt.s*this.d*mt.n,this.d*mt.d)},sub:function(e,t){return xo(e,t),Ir(this.s*this.n*mt.d-mt.s*this.d*mt.n,this.d*mt.d)},mul:function(e,t){return xo(e,t),Ir(this.s*mt.s*this.n*mt.n,this.d*mt.d)},div:function(e,t){return xo(e,t),Ir(this.s*mt.s*this.n*mt.d,this.d*mt.n)},clone:function(){return Ir(this.s*this.n,this.d)},mod:function(e,t){if(isNaN(this.n)||isNaN(this.d))return new Cn(NaN);if(e===void 0)return Ir(this.s*this.n%this.d,1);if(xo(e,t),mt.n===0&&this.d===0)throw FT();return Ir(this.s*(mt.d*this.n)%(mt.n*this.d),mt.d*this.d)},gcd:function(e,t){return xo(e,t),Ir(bp(mt.n,this.n)*bp(mt.d,this.d),mt.d*this.d)},lcm:function(e,t){return xo(e,t),mt.n===0&&this.n===0?Ir(0,1):Ir(mt.n*this.n,bp(mt.n,this.n)*bp(mt.d,this.d))},ceil:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new Cn(NaN):Ir(Math.ceil(e*this.s*this.n/this.d),e)},floor:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new Cn(NaN):Ir(Math.floor(e*this.s*this.n/this.d),e)},round:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new Cn(NaN):Ir(Math.round(e*this.s*this.n/this.d),e)},roundTo:function(e,t){return xo(e,t),Ir(this.s*Math.round(this.n*mt.d/(this.d*mt.n))*mt.n,mt.d)},inverse:function(){return Ir(this.s*this.d,this.n)},pow:function(e,t){if(xo(e,t),mt.d===1)return mt.s<0?Ir(Math.pow(this.s*this.d,mt.n),Math.pow(this.n,mt.n)):Ir(Math.pow(this.s*this.n,mt.n),Math.pow(this.d,mt.n));if(this.s<0)return null;var i=Nz(this.n),r=Nz(this.d),n=1,a=1;for(var o in i)if(o!=="1"){if(o==="0"){n=0;break}if(i[o]*=mt.n,i[o]%mt.d===0)i[o]/=mt.d;else return null;n*=Math.pow(o,i[o])}for(var o in r)if(o!=="1"){if(r[o]*=mt.n,r[o]%mt.d===0)r[o]/=mt.d;else return null;a*=Math.pow(o,r[o])}return mt.s<0?Ir(a,n):Ir(n,a)},equals:function(e,t){return xo(e,t),this.s*this.n*mt.d===mt.s*mt.n*this.d},compare:function(e,t){xo(e,t);var i=this.s*this.n*mt.d-mt.s*mt.n*this.d;return(0<i)-(i<0)},simplify:function(e){if(isNaN(this.n)||isNaN(this.d))return this;e=e||.001;for(var t=this.abs(),i=t.toContinued(),r=1;r<i.length;r++){for(var n=Ir(i[r-1],1),a=r-2;a>=0;a--)n=n.inverse().add(i[a]);if(Math.abs(n.sub(t).valueOf())<e)return n.mul(this.s)}return this},divisible:function(e,t){return xo(e,t),!(!(mt.n*this.d)||this.n*mt.d%(mt.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(e){var t,i="",r=this.n,n=this.d;return this.s<0&&(i+="-"),n===1?i+=r:(e&&(t=Math.floor(r/n))>0&&(i+=t,i+=" ",r%=n),i+=r,i+="/",i+=n),i},toLatex:function(e){var t,i="",r=this.n,n=this.d;return this.s<0&&(i+="-"),n===1?i+=r:(e&&(t=Math.floor(r/n))>0&&(i+=t,r%=n),i+="\\frac{",i+=r,i+="}{",i+=n,i+="}"),i},toContinued:function(){var e,t=this.n,i=this.d,r=[];if(isNaN(t)||isNaN(i))return r;do r.push(Math.floor(t/i)),e=t%i,t=i,i=e;while(t!==1);return r},toString:function(e){var t=this.n,i=this.d;if(isNaN(t)||isNaN(i))return"NaN";e=e||15;var r=ede(t,i),n=tde(t,i,r),a=this.s<0?"-":"";if(a+=t/i|0,t%=i,t*=10,t&&(a+="."),r){for(var o=n;o--;)a+=t/i|0,t%=i,t*=10;a+="(";for(var o=r;o--;)a+=t/i|0,t%=i,t*=10;a+=")"}else for(var o=e;t&&o--;)a+=t/i|0,t%=i,t*=10;return a}};var rde="Fraction",nde=[],OT=ie(rde,nde,()=>(Object.defineProperty(Cn,"name",{value:"Fraction"}),Cn.prototype.constructor=Cn,Cn.prototype.type="Fraction",Cn.prototype.isFraction=!0,Cn.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},Cn.fromJSON=function(e){return new Cn(e)},Cn),{isClass:!0});var ade="Matrix",ode=[],LT=ie(ade,ode,()=>{function e(){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator")}return e.prototype.type="Matrix",e.prototype.isMatrix=!0,e.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},e.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},e.prototype.create=function(t,i){throw new Error("Cannot invoke create on a Matrix interface")},e.prototype.subset=function(t,i,r){throw new Error("Cannot invoke subset on a Matrix interface")},e.prototype.get=function(t){throw new Error("Cannot invoke get on a Matrix interface")},e.prototype.set=function(t,i,r){throw new Error("Cannot invoke set on a Matrix interface")},e.prototype.resize=function(t,i){throw new Error("Cannot invoke resize on a Matrix interface")},e.prototype.reshape=function(t,i){throw new Error("Cannot invoke reshape on a Matrix interface")},e.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},e.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},e.prototype.map=function(t,i){throw new Error("Cannot invoke map on a Matrix interface")},e.prototype.forEach=function(t){throw new Error("Cannot invoke forEach on a Matrix interface")},e.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},e.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},e.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},e.prototype.format=function(t){throw new Error("Cannot invoke format on a Matrix interface")},e.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},e},{isClass:!0});function BT(e,t,i){var r=e.constructor,n=new r(2),a="";if(i){if(i<1)throw new Error("size must be in greater than 0");if(!ai(i))throw new Error("size must be an integer");if(e.greaterThan(n.pow(i-1).sub(1))||e.lessThan(n.pow(i-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(i-1,", 2^").concat(i-1,"-1]"));if(!e.isInteger())throw new Error("Value must be an integer");e.lessThan(0)&&(e=e.add(n.pow(i))),a="i".concat(i)}switch(t){case 2:return"".concat(e.toBinary()).concat(a);case 8:return"".concat(e.toOctal()).concat(a);case 16:return"".concat(e.toHexadecimal()).concat(a);default:throw new Error("Base ".concat(t," not supported "))}}function Fz(e,t){if(typeof t=="function")return t(e);if(!e.isFinite())return e.isNaN()?"NaN":e.gt(0)?"Infinity":"-Infinity";var{notation:i,precision:r,wordSize:n}=wT(t);switch(i){case"fixed":return lde(e,r);case"exponential":return Pz(e,r);case"engineering":return sde(e,r);case"bin":return BT(e,2,n);case"oct":return BT(e,8,n);case"hex":return BT(e,16,n);case"auto":{var a=Rz(t?.lowerExp,-3),o=Rz(t?.upperExp,5);if(e.isZero())return"0";var s,l=e.toSignificantDigits(r),c=l.e;return c>=a&&c<o?s=l.toFixed():s=Pz(e,r),s.replace(/((\.\d*?)(0+))($|e)/,function(){var d=arguments[2],u=arguments[4];return d!=="."?d+u:u})}default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function sde(e,t){var i=e.e,r=i%3===0?i:i<0?i-3-i%3:i-i%3,n=e.mul(Math.pow(10,-r)),a=n.toPrecision(t);if(a.includes("e")){var o=e.constructor;a=new o(a).toFixed()}return a+"e"+(i>=0?"+":"")+r.toString()}function Pz(e,t){return t!==void 0?e.toExponential(t-1):e.toExponential()}function lde(e,t){return e.toFixed(t)}function Rz(e,t){return xi(e)?e:Ei(e)?e.toNumber():t}function Ti(e,t){var i=cde(e,t);return t&&typeof t=="object"&&"truncate"in t&&i.length>t.truncate?i.substring(0,t.truncate-3)+"...":i}function cde(e,t){if(typeof e=="number")return Cv(e,t);if(Ei(e))return Fz(e,t);if(dde(e))return!t||t.fraction!=="decimal"?e.s*e.n+"/"+e.d:e.toString();if(Array.isArray(e))return Bz(e,t);if(Dn(e))return Oz(e);if(typeof e=="function")return e.syntax?String(e.syntax):"function";if(e&&typeof e=="object"){if(typeof e.format=="function")return e.format(t);if(e&&e.toString(t)!=={}.toString())return e.toString(t);var i=Object.keys(e).map(r=>Oz(r)+": "+Ti(e[r],t));return"{"+i.join(", ")+"}"}return String(e)}function Oz(e){for(var t=String(e),i="",r=0;r<t.length;){var n=t.charAt(r);i+=n in Lz?Lz[n]:n,r++}return'"'+i+'"'}var Lz={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"};function Bz(e,t){if(Array.isArray(e)){for(var i="[",r=e.length,n=0;n<r;n++)n!==0&&(i+=", "),i+=Bz(e[n],t);return i+="]",i}else return Ti(e,t)}function dde(e){return e&&typeof e=="object"&&typeof e.s=="number"&&typeof e.n=="number"&&typeof e.d=="number"||!1}function oi(e,t,i){if(!(this instanceof oi))throw new SyntaxError("Constructor must be called with the new operator");this.actual=e,this.expected=t,this.relation=i,this.message="Dimension mismatch ("+(Array.isArray(e)?"["+e.join(", ")+"]":e)+" "+(this.relation||"!=")+" "+(Array.isArray(t)?"["+t.join(", ")+"]":t)+")",this.stack=new Error().stack}oi.prototype=new RangeError;oi.prototype.constructor=RangeError;oi.prototype.name="DimensionError";oi.prototype.isDimensionError=!0;function Yl(e,t,i){if(!(this instanceof Yl))throw new SyntaxError("Constructor must be called with the new operator");this.index=e,arguments.length<3?(this.min=0,this.max=t):(this.min=t,this.max=i),this.min!==void 0&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":this.max!==void 0&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=new Error().stack}Yl.prototype=new RangeError;Yl.prototype.constructor=RangeError;Yl.prototype.name="IndexError";Yl.prototype.isIndexError=!0;function Li(e){for(var t=[];Array.isArray(e);)t.push(e.length),e=e[0];return t}function Vz(e,t,i){var r,n=e.length;if(n!==t[i])throw new oi(n,t[i]);if(i<t.length-1){var a=i+1;for(r=0;r<n;r++){var o=e[r];if(!Array.isArray(o))throw new oi(t.length-1,t.length,"<");Vz(e[r],t,a)}}else for(r=0;r<n;r++)if(Array.isArray(e[r]))throw new oi(t.length+1,t.length,">")}function zT(e,t){var i=t.length===0;if(i){if(Array.isArray(e))throw new oi(e.length,0)}else Vz(e,t,0)}function mr(e,t){if(e!==void 0){if(!xi(e)||!ai(e))throw new TypeError("Index must be an integer (value: "+e+")");if(e<0||typeof t=="number"&&e>=t)throw new Yl(e,t)}}function Ku(e,t,i){if(!Array.isArray(t))throw new TypeError("Array expected");if(t.length===0)throw new Error("Resizing to scalar is not supported");t.forEach(function(n){if(!xi(n)||!ai(n)||n<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Ti(t)+")")}),(xi(e)||Ei(e))&&(e=[e]);var r=i!==void 0?i:0;return VT(e,t,0,r),e}function VT(e,t,i,r){var n,a,o=e.length,s=t[i],l=Math.min(o,s);if(e.length=s,i<t.length-1){var c=i+1;for(n=0;n<l;n++)a=e[n],Array.isArray(a)||(a=[a],e[n]=a),VT(a,t,c,r);for(n=l;n<s;n++)a=[],e[n]=a,VT(a,t,c,r)}else{for(n=0;n<l;n++)for(;Array.isArray(e[n]);)e[n]=e[n][0];for(n=l;n<s;n++)e[n]=r}}function Av(e,t){var i=rw(e),r=i.length;if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("Array expected");if(t.length===0)throw new oi(0,r,"!=");t=Tv(t,r);var n=zz(t);if(r!==n)throw new oi(n,r,"!=");try{return ude(i,t)}catch(a){throw a instanceof oi?new oi(n,r,"!="):a}}function Tv(e,t){var i=zz(e),r=e.slice(),n=-1,a=e.indexOf(n),o=e.indexOf(n,a+1)>=0;if(o)throw new Error("More than one wildcard in sizes");var s=a>=0,l=t%i===0;if(s)if(l)r[a]=-t/i;else throw new Error("Could not replace wildcard, since "+t+" is no multiple of "+-i);return r}function zz(e){return e.reduce((t,i)=>t*i,1)}function ude(e,t){for(var i=e,r,n=t.length-1;n>0;n--){var a=t[n];r=[];for(var o=i.length/a,s=0;s<o;s++)r.push(i.slice(s*a,(s+1)*a));i=r}return i}function iw(e,t,i,r){var n=r||Li(e);if(i)for(var a=0;a<i;a++)e=[e],n.unshift(1);for(e=Uz(e,t,0);n.length<t;)n.push(1);return e}function Uz(e,t,i){var r,n;if(Array.isArray(e)){var a=i+1;for(r=0,n=e.length;r<n;r++)e[r]=Uz(e[r],t,a)}else for(var o=i;o<t;o++)e=[e];return e}function rw(e){if(!Array.isArray(e))return e;var t=[];return e.forEach(function i(r){Array.isArray(r)?r.forEach(i):t.push(r)}),t}function Qu(e,t){for(var i,r=0,n=0;n<e.length;n++){var a=e[n],o=Array.isArray(a);if(n===0&&o&&(r=a.length),o&&a.length!==r)return;var s=o?Qu(a,t):t(a);if(i===void 0)i=s;else if(i!==s)return"mixed"}return i}function Hz(e,t,i,r){if(r<i){if(e.length!==t.length)throw new oi(e.length,t.length);for(var n=[],a=0;a<e.length;a++)n[a]=Hz(e[a],t[a],i,r+1);return n}else return e.concat(t)}function UT(){var e=Array.prototype.slice.call(arguments,0,-1),t=Array.prototype.slice.call(arguments,-1);if(e.length===1)return e[0];if(e.length>1)return e.slice(1).reduce(function(i,r){return Hz(i,r,t,0)},e[0]);throw new Error("Wrong number of arguments in function concat")}function HT(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];for(var r=t.map(h=>h.length),n=Math.max(...r),a=new Array(n).fill(null),o=0;o<t.length;o++)for(var s=t[o],l=r[o],c=0;c<l;c++){var d=n-l+c;s[c]>a[d]&&(a[d]=s[c])}for(var u=0;u<t.length;u++)Gz(t[u],a);return a}function Gz(e,t){for(var i=t.length,r=e.length,n=0;n<r;n++){var a=i-r+n;if(e[n]<t[a]&&e[n]>1||e[n]>t[a])throw new Error("shape missmatch: missmatch is found in arg with shape (".concat(e,") not possible to broadcast dimension ").concat(r," with size ").concat(e[n]," to size ").concat(t[a]))}}function Dv(e,t){var i=Li(e);if(Ko(i,t))return e;Gz(i,t);var r=HT(i,t),n=r.length,a=[...Array(n-i.length).fill(1),...i],o=mde(e);i.length<n&&(o=Av(o,a),i=Li(o));for(var s=0;s<n;s++)i[s]<r[s]&&(o=hde(o,r[s],s),i=Li(o));return o}function hde(e,t,i){return UT(...Array(t).fill(e),i)}function nw(e,t){if(!Array.isArray(e))throw new Error("Array expected");var i=Li(e);if(t.length!==i.length)throw new oi(t.length,i.length);for(var r=0;r<t.length;r++)mr(t[r],i[r]);return t.reduce((n,a)=>n[a],e)}function mde(e){return Js([],e)}var GT=hM(xT(),1);function xp(e,t,i){if(GT.default.isTypedFunction(e)){var r=(t.isMatrix?t.size():Li(t)).map(()=>0),n=t.isMatrix?t.get(r):nw(t,r),a=Object.keys(e.signatures).length===1,o=pde(e,n,r,t),s=a?Object.values(e.signatures)[0]:e;return o>=1&&o<=3?function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];return jz(s,c.slice(0,o),i,e.name)}:function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];return jz(s,c,i,e.name)}}return e}function pde(e,t,i,r){for(var n=[t,i,r],a=3;a>0;a--){var o=n.slice(0,a);if(GT.default.resolve(e,o)!==null)return a}}function jz(e,t,i,r){try{return e(...t)}catch(n){fde(n,t,i,r)}}function fde(e,t,i,r){var n;if(e instanceof TypeError&&((n=e.data)===null||n===void 0?void 0:n.category)==="wrongType"){var a=[];throw a.push("value: ".concat(on(t[0]))),t.length>=2&&a.push("index: ".concat(on(t[1]))),t.length>=3&&a.push("array: ".concat(on(t[2]))),new TypeError("Function ".concat(i," cannot apply callback arguments ")+"".concat(r,"(").concat(a.join(", "),") at index ").concat(JSON.stringify(t[1])))}else throw new TypeError("Function ".concat(i," cannot apply callback arguments ")+"to function ".concat(r,": ").concat(e.message))}var gde="DenseMatrix",vde=["Matrix"],jT=ie(gde,vde,e=>{var{Matrix:t}=e;function i(d,u){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(u&&!Dn(u))throw new Error("Invalid datatype: "+u);if(ui(d))d.type==="DenseMatrix"?(this._data=Kt(d._data),this._size=Kt(d._size),this._datatype=u||d._datatype):(this._data=d.toArray(),this._size=d.size(),this._datatype=u||d._datatype);else if(d&&Fi(d.data)&&Fi(d.size))this._data=d.data,this._size=d.size,zT(this._data,this._size),this._datatype=u||d.datatype;else if(Fi(d))this._data=c(d),this._size=Li(this._data),zT(this._data,this._size),this._datatype=u;else{if(d)throw new TypeError("Unsupported type of data ("+on(d)+")");this._data=[],this._size=[0],this._datatype=u}}i.prototype=new t,i.prototype.createDenseMatrix=function(d,u){return new i(d,u)},Object.defineProperty(i,"name",{value:"DenseMatrix"}),i.prototype.constructor=i,i.prototype.type="DenseMatrix",i.prototype.isDenseMatrix=!0,i.prototype.getDataType=function(){return Qu(this._data,on)},i.prototype.storage=function(){return"dense"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(d,u){return new i(d,u)},i.prototype.subset=function(d,u,h){switch(arguments.length){case 1:return r(this,d);case 2:case 3:return a(this,d,u,h);default:throw new SyntaxError("Wrong number of arguments")}},i.prototype.get=function(d){return nw(this._data,d)},i.prototype.set=function(d,u,h){if(!Fi(d))throw new TypeError("Array expected");if(d.length<this._size.length)throw new oi(d.length,this._size.length,"<");var m,f,p,g=d.map(function(b){return b+1});l(this,g,h);var v=this._data;for(m=0,f=d.length-1;m<f;m++)p=d[m],mr(p,v.length),v=v[p];return p=d[d.length-1],mr(p,v.length),v[p]=u,this};function r(d,u){if(!mp(u))throw new TypeError("Invalid index");var h=u.isScalar();if(h)return d.get(u.min());var m=u.size();if(m.length!==d._size.length)throw new oi(m.length,d._size.length);for(var f=u.min(),p=u.max(),g=0,v=d._size.length;g<v;g++)mr(f[g],d._size[g]),mr(p[g],d._size[g]);return new i(n(d._data,u,m.length,0),d._datatype)}function n(d,u,h,m){var f=m===h-1,p=u.dimension(m);return f?p.map(function(g){return mr(g,d.length),d[g]}).valueOf():p.map(function(g){mr(g,d.length);var v=d[g];return n(v,u,h,m+1)}).valueOf()}function a(d,u,h,m){if(!u||u.isIndex!==!0)throw new TypeError("Invalid index");var f=u.size(),p=u.isScalar(),g;if(ui(h)?(g=h.size(),h=h.valueOf()):g=Li(h),p){if(g.length!==0)throw new TypeError("Scalar expected");d.set(u.min(),h,m)}else{if(!Ko(g,f))try{g.length===0?h=Dv([h],f):h=Dv(h,f),g=Li(h)}catch{}if(f.length<d._size.length)throw new oi(f.length,d._size.length,"<");if(g.length<f.length){for(var v=0,b=0;f[v]===1&&g[v]===1;)v++;for(;f[v]===1;)b++,v++;h=iw(h,f.length,b,g)}if(!Ko(f,g))throw new oi(f,g,">");var _=u.max().map(function(y){return y+1});l(d,_,m);var x=f.length,w=0;o(d._data,u,h,x,w)}return d}function o(d,u,h,m,f){var p=f===m-1,g=u.dimension(f);p?g.forEach(function(v,b){mr(v),d[v]=h[b[0]]}):g.forEach(function(v,b){mr(v),o(d[v],u,h[b[0]],m,f+1)})}i.prototype.resize=function(d,u,h){if(!Zu(d))throw new TypeError("Array or Matrix expected");var m=d.valueOf().map(p=>Array.isArray(p)&&p.length===1?p[0]:p),f=h?this.clone():this;return s(f,m,u)};function s(d,u,h){if(u.length===0){for(var m=d._data;Fi(m);)m=m[0];return m}return d._size=u.slice(0),d._data=Ku(d._data,d._size,h),d}i.prototype.reshape=function(d,u){var h=u?this.clone():this;h._data=Av(h._data,d);var m=h._size.reduce((f,p)=>f*p);return h._size=Tv(d,m),h};function l(d,u,h){for(var m=d._size.slice(0),f=!1;m.length<u.length;)m.push(0),f=!0;for(var p=0,g=u.length;p<g;p++)u[p]>m[p]&&(m[p]=u[p],f=!0);f&&s(d,m,h)}i.prototype.clone=function(){var d=new i({data:Kt(this._data),size:Kt(this._size),datatype:this._datatype});return d},i.prototype.size=function(){return this._size.slice(0)},i.prototype._forEach=function(d){var u=this,h=u.size();if(h.length===1){for(var m=0;m<h[0];m++)d(u._data,m,[m]);return}var f=Array(h.length).fill(0),p=Array(h.length-1),g=p.length-1;p[0]=u._data[0];for(var v=0;v<g;v++)p[v+1]=p[v][0];for(f[g]=-1;;){var b=void 0;for(b=g;b>=0;b--){if(f[b]++,f[b]===h[b]){f[b]=0;continue}p[b]=b===0?u._data[f[b]]:p[b-1][f[b]];for(var _=b;_<g;_++)p[_+1]=p[_][0];for(var x=0;x<h[p.length];x++)f[p.length]=x,d(p[g],x,f.slice(0));break}if(b===-1)break}},i.prototype.map=function(d){var u=this,h=new i(u),m=xp(d,u._data,"map");return h._forEach(function(f,p,g){f[p]=m(f[p],g,u)}),h},i.prototype.forEach=function(d){var u=this,h=xp(d,u._data,"map");u._forEach(function(m,f,p){h(m[f],p,u)})},i.prototype[Symbol.iterator]=function*(){var d=function*(h,m){if(Fi(h))for(var f=0;f<h.length;f++)yield*Mw(d(h[f],m.concat(f)));else yield{value:h,index:m}};yield*Mw(d(this._data,[]))},i.prototype.rows=function(){var d=[],u=this.size();if(u.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");var h=this._data;for(var m of h)d.push(new i([m],this._datatype));return d},i.prototype.columns=function(){var d=this,u=[],h=this.size();if(h.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var m=this._data,f=function(v){var b=m.map(_=>[_[v]]);u.push(new i(b,d._datatype))},p=0;p<h[1];p++)f(p);return u},i.prototype.toArray=function(){return Kt(this._data)},i.prototype.valueOf=function(){return this._data},i.prototype.format=function(d){return Ti(this._data,d)},i.prototype.toString=function(){return Ti(this._data)},i.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(d){if(d){if(Ei(d)&&(d=d.toNumber()),!xi(d)||!ai(d))throw new TypeError("The parameter k must be an integer number")}else d=0;for(var u=d>0?d:0,h=d<0?-d:0,m=this._size[0],f=this._size[1],p=Math.min(m-h,f-u),g=[],v=0;v<p;v++)g[v]=this._data[v+h][v+u];return new i({data:g,size:[p],datatype:this._datatype})},i.diagonal=function(d,u,h,m){if(!Fi(d))throw new TypeError("Array expected, size parameter");if(d.length!==2)throw new Error("Only two dimensions matrix are supported");if(d=d.map(function(M){if(Ei(M)&&(M=M.toNumber()),!xi(M)||!ai(M)||M<1)throw new Error("Size values must be positive integers");return M}),h){if(Ei(h)&&(h=h.toNumber()),!xi(h)||!ai(h))throw new TypeError("The parameter k must be an integer number")}else h=0;var f=h>0?h:0,p=h<0?-h:0,g=d[0],v=d[1],b=Math.min(g-p,v-f),_;if(Fi(u)){if(u.length!==b)throw new Error("Invalid value array length");_=function(T){return u[T]}}else if(ui(u)){var x=u.size();if(x.length!==1||x[0]!==b)throw new Error("Invalid matrix length");_=function(T){return u.get([T])}}else _=function(){return u};m||(m=Ei(_(0))?_(0).mul(0):0);var w=[];if(d.length>0){w=Ku(w,d,m);for(var y=0;y<b;y++)w[y+p][y+f]=_(y)}return new i({data:w,size:[g,v]})},i.fromJSON=function(d){return new i(d)},i.prototype.swapRows=function(d,u){if(!xi(d)||!ai(d)||!xi(u)||!ai(u))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return mr(d,this._size[0]),mr(u,this._size[0]),i._swapRows(d,u,this._data),this},i._swapRows=function(d,u,h){var m=h[d];h[d]=h[u],h[u]=m};function c(d){return ui(d)?c(d.valueOf()):Fi(d)?d.map(c):d}return i},{isClass:!0});function ar(e,t,i){return e&&typeof e.map=="function"?e.map(function(r){return ar(r,t,i)}):t(e)}var Wz="isInteger",_de=["typed"],WT=ie(Wz,_de,e=>{var{typed:t}=e;return t(Wz,{number:ai,BigNumber:function(r){return r.isInt()},bigint:function(r){return!0},Fraction:function(r){return r.d===1&&isFinite(r.n)},"Array | Matrix":t.referToSelf(i=>r=>ar(r,i))})});var $a="number",Zl="number, number";function qT(e){return Math.abs(e)}qT.signature=$a;function $T(e,t){return e+t}$T.signature=Zl;function XT(e,t){return e-t}XT.signature=Zl;function YT(e,t){return e*t}YT.signature=Zl;function bde(e,t){return e/t}bde.signature=Zl;function ZT(e){return-e}ZT.signature=$a;function xde(e){return e}xde.signature=$a;function yde(e){return hz(e)}yde.signature=$a;function wde(e){return e*e*e}wde.signature=$a;function Cde(e){return Math.exp(e)}Cde.signature=$a;function Ede(e){return mz(e)}Ede.signature=$a;function Sde(e,t){if(!ai(e)||!ai(t))throw new Error("Parameters in function gcd must be integer numbers");for(var i;t!==0;)i=e%t,e=t,t=i;return e<0?-e:e}Sde.signature=Zl;function Ade(e,t){if(!ai(e)||!ai(t))throw new Error("Parameters in function lcm must be integer numbers");if(e===0||t===0)return 0;for(var i,r=e*t;t!==0;)i=t,t=e%i,e=i;return Math.abs(r/e)}Ade.signature=Zl;function Tde(e){return dz(e)}Tde.signature=$a;function Dde(e){return cz(e)}Dde.signature=$a;function Mde(e){return uz(e)}Mde.signature=$a;function Ide(e,t){return t===0?e:e-t*Math.floor(e/t)}Ide.signature=Zl;function aw(e){return lz(e)}aw.signature=$a;function kde(e){return Math.sqrt(e)}kde.signature=$a;function Nde(e){return e*e}Nde.signature=$a;function Pde(e,t){var i,r,n,a=0,o=1,s=1,l=0;if(!ai(e)||!ai(t))throw new Error("Parameters in function xgcd must be integer numbers");for(;t;)r=Math.floor(e/t),n=e-r*t,i=a,a=o-r*a,o=i,i=s,s=l-r*s,l=i,e=t,t=n;var c;return e<0?c=[-e,-o,-l]:c=[e,e?o:0,l],c}Pde.signature=Zl;function Rde(e,t){return e*e<1&&t===1/0||e*e>1&&t===-1/0?0:Math.pow(e,t)}Rde.signature=Zl;function Fde(e){return Math.abs(e)}Fde.signature=$a;var Mv="number";function Ode(e){return ai(e)}Ode.signature=Mv;function Lde(e){return e<0}Lde.signature=Mv;function KT(e){return e>0}KT.signature=Mv;function Bde(e){return e===0}Bde.signature=Mv;function Vde(e){return Number.isNaN(e)}Vde.signature=Mv;function Jo(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e-9,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(i<=0)throw new Error("Relative tolerance must be greater than 0");if(r<0)throw new Error("Absolute tolerance must be at least 0");return e.isNaN()||t.isNaN()?!1:!e.isFinite()||!t.isFinite()?e.eq(t):e.eq(t)?!0:e.minus(t).abs().lte(e.constructor.max(e.constructor.max(e.abs(),t.abs()).mul(i),r))}var qz="isPositive",zde=["typed","config"],QT=ie(qz,zde,e=>{var{typed:t,config:i}=e;return t(qz,{number:r=>Xn(r,0,i.relTol,i.absTol)?!1:KT(r),BigNumber:r=>Jo(r,new r.constructor(0),i.relTol,i.absTol)?!1:!r.isNeg()&&!r.isZero()&&!r.isNaN(),bigint:r=>r>0n,Fraction:r=>r.s>0&&r.n>0,Unit:t.referToSelf(r=>n=>t.find(r,n.valueType())(n.value)),"Array | Matrix":t.referToSelf(r=>n=>ar(n,r))})});var $z="isZero",Ude=["typed","equalScalar"],JT=ie($z,Ude,e=>{var{typed:t,equalScalar:i}=e;return t($z,{"number | BigNumber | Complex | Fraction":r=>i(r,0),bigint:r=>r===0n,Unit:t.referToSelf(r=>n=>t.find(r,n.valueType())(n.value)),"Array | Matrix":t.referToSelf(r=>n=>ar(n,r))})});function Xz(e,t,i,r){return Xn(e.re,t.re,i,r)&&Xn(e.im,t.im,i,r)}var tl=ie("compareUnits",["typed"],e=>{var{typed:t}=e;return{"Unit, Unit":t.referToSelf(i=>(r,n)=>{if(!r.equalBase(n))throw new Error("Cannot compare units with different base");return t.find(i,[r.valueType(),n.valueType()])(r.value,n.value)})}});var ow="equalScalar",Hde=["typed","config"],eD=ie(ow,Hde,e=>{var{typed:t,config:i}=e,r=tl({typed:t});return t(ow,{"boolean, boolean":function(a,o){return a===o},"number, number":function(a,o){return Xn(a,o,i.relTol,i.absTol)},"BigNumber, BigNumber":function(a,o){return a.eq(o)||Jo(a,o,i.relTol,i.absTol)},"bigint, bigint":function(a,o){return a===o},"Fraction, Fraction":function(a,o){return a.equals(o)},"Complex, Complex":function(a,o){return Xz(a,o,i.relTol,i.absTol)}},r)}),c5e=ie(ow,["typed","config"],e=>{var{typed:t,config:i}=e;return t(ow,{"number, number":function(n,a){return Xn(n,a,i.relTol,i.absTol)}})});var Gde="SparseMatrix",jde=["typed","equalScalar","Matrix"],tD=ie(Gde,jde,e=>{var{typed:t,equalScalar:i,Matrix:r}=e;function n(p,g){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(g&&!Dn(g))throw new Error("Invalid datatype: "+g);if(ui(p))a(this,p,g);else if(p&&Fi(p.index)&&Fi(p.ptr)&&Fi(p.size))this._values=p.values,this._index=p.index,this._ptr=p.ptr,this._size=p.size,this._datatype=g||p.datatype;else if(Fi(p))o(this,p,g);else{if(p)throw new TypeError("Unsupported type of data ("+on(p)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=g}}function a(p,g,v){g.type==="SparseMatrix"?(p._values=g._values?Kt(g._values):void 0,p._index=Kt(g._index),p._ptr=Kt(g._ptr),p._size=Kt(g._size),p._datatype=v||g._datatype):o(p,g.valueOf(),v||g._datatype)}function o(p,g,v){p._values=[],p._index=[],p._ptr=[],p._datatype=v;var b=g.length,_=0,x=i,w=0;if(Dn(v)&&(x=t.find(i,[v,v])||i,w=t.convert(0,v)),b>0){var y=0;do{p._ptr.push(p._index.length);for(var M=0;M<b;M++){var T=g[M];if(Fi(T)){if(y===0&&_<T.length&&(_=T.length),y<T.length){var C=T[y];x(C,w)||(p._values.push(C),p._index.push(M))}}else y===0&&_<1&&(_=1),x(T,w)||(p._values.push(T),p._index.push(M))}y++}while(y<_)}p._ptr.push(p._index.length),p._size=[b,_]}n.prototype=new r,n.prototype.createSparseMatrix=function(p,g){return new n(p,g)},Object.defineProperty(n,"name",{value:"SparseMatrix"}),n.prototype.constructor=n,n.prototype.type="SparseMatrix",n.prototype.isSparseMatrix=!0,n.prototype.getDataType=function(){return Qu(this._values,on)},n.prototype.storage=function(){return"sparse"},n.prototype.datatype=function(){return this._datatype},n.prototype.create=function(p,g){return new n(p,g)},n.prototype.density=function(){var p=this._size[0],g=this._size[1];return p!==0&&g!==0?this._index.length/(p*g):0},n.prototype.subset=function(p,g,v){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return s(this,p);case 2:case 3:return l(this,p,g,v);default:throw new SyntaxError("Wrong number of arguments")}};function s(p,g){if(!mp(g))throw new TypeError("Invalid index");var v=g.isScalar();if(v)return p.get(g.min());var b=g.size();if(b.length!==p._size.length)throw new oi(b.length,p._size.length);var _,x,w,y,M=g.min(),T=g.max();for(_=0,x=p._size.length;_<x;_++)mr(M[_],p._size[_]),mr(T[_],p._size[_]);var C=p._values,N=p._index,D=p._ptr,k=g.dimension(0),U=g.dimension(1),F=[],H=[];k.forEach(function(ee,re){H[ee]=re[0],F[ee]=!0});var V=C?[]:void 0,Q=[],$=[];return U.forEach(function(ee){for($.push(Q.length),w=D[ee],y=D[ee+1];w<y;w++)_=N[w],F[_]===!0&&(Q.push(H[_]),V&&V.push(C[w]))}),$.push(Q.length),new n({values:V,index:Q,ptr:$,size:b,datatype:p._datatype})}function l(p,g,v,b){if(!g||g.isIndex!==!0)throw new TypeError("Invalid index");var _=g.size(),x=g.isScalar(),w;if(ui(v)?(w=v.size(),v=v.toArray()):w=Li(v),x){if(w.length!==0)throw new TypeError("Scalar expected");p.set(g.min(),v,b)}else{if(_.length!==1&&_.length!==2)throw new oi(_.length,p._size.length,"<");if(w.length<_.length){for(var y=0,M=0;_[y]===1&&w[y]===1;)y++;for(;_[y]===1;)M++,y++;v=iw(v,_.length,M,w)}if(!Ko(_,w))throw new oi(_,w,">");if(_.length===1){var T=g.dimension(0);T.forEach(function(D,k){mr(D),p.set([D,0],v[k[0]],b)})}else{var C=g.dimension(0),N=g.dimension(1);C.forEach(function(D,k){mr(D),N.forEach(function(U,F){mr(U),p.set([D,U],v[k[0]][F[0]],b)})})}}return p}n.prototype.get=function(p){if(!Fi(p))throw new TypeError("Array expected");if(p.length!==this._size.length)throw new oi(p.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var g=p[0],v=p[1];mr(g,this._size[0]),mr(v,this._size[1]);var b=c(g,this._ptr[v],this._ptr[v+1],this._index);return b<this._ptr[v+1]&&this._index[b]===g?this._values[b]:0},n.prototype.set=function(p,g,v){if(!Fi(p))throw new TypeError("Array expected");if(p.length!==this._size.length)throw new oi(p.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var b=p[0],_=p[1],x=this._size[0],w=this._size[1],y=i,M=0;Dn(this._datatype)&&(y=t.find(i,[this._datatype,this._datatype])||i,M=t.convert(0,this._datatype)),(b>x-1||_>w-1)&&(h(this,Math.max(b+1,x),Math.max(_+1,w),v),x=this._size[0],w=this._size[1]),mr(b,x),mr(_,w);var T=c(b,this._ptr[_],this._ptr[_+1],this._index);return T<this._ptr[_+1]&&this._index[T]===b?y(g,M)?d(T,_,this._values,this._index,this._ptr):this._values[T]=g:y(g,M)||u(T,b,_,g,this._values,this._index,this._ptr),this};function c(p,g,v,b){if(v-g===0)return v;for(var _=g;_<v;_++)if(b[_]===p)return _;return g}function d(p,g,v,b,_){v.splice(p,1),b.splice(p,1);for(var x=g+1;x<_.length;x++)_[x]--}function u(p,g,v,b,_,x,w){_.splice(p,0,b),x.splice(p,0,g);for(var y=v+1;y<w.length;y++)w[y]++}n.prototype.resize=function(p,g,v){if(!Zu(p))throw new TypeError("Array or Matrix expected");var b=p.valueOf().map(x=>Array.isArray(x)&&x.length===1?x[0]:x);if(b.length!==2)throw new Error("Only two dimensions matrix are supported");b.forEach(function(x){if(!xi(x)||!ai(x)||x<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Ti(b)+")")});var _=v?this.clone():this;return h(_,b[0],b[1],g)};function h(p,g,v,b){var _=b||0,x=i,w=0;Dn(p._datatype)&&(x=t.find(i,[p._datatype,p._datatype])||i,w=t.convert(0,p._datatype),_=t.convert(_,p._datatype));var y=!x(_,w),M=p._size[0],T=p._size[1],C,N,D;if(v>T){for(N=T;N<v;N++)if(p._ptr[N]=p._values.length,y)for(C=0;C<M;C++)p._values.push(_),p._index.push(C);p._ptr[v]=p._values.length}else v<T&&(p._ptr.splice(v+1,T-v),p._values.splice(p._ptr[v],p._values.length),p._index.splice(p._ptr[v],p._index.length));if(T=v,g>M){if(y){var k=0;for(N=0;N<T;N++){p._ptr[N]=p._ptr[N]+k,D=p._ptr[N+1]+k;var U=0;for(C=M;C<g;C++,U++)p._values.splice(D+U,0,_),p._index.splice(D+U,0,C),k++}p._ptr[T]=p._values.length}}else if(g<M){var F=0;for(N=0;N<T;N++){p._ptr[N]=p._ptr[N]-F;var H=p._ptr[N],V=p._ptr[N+1]-F;for(D=H;D<V;D++)C=p._index[D],C>g-1&&(p._values.splice(D,1),p._index.splice(D,1),F++)}p._ptr[N]=p._values.length}return p._size[0]=g,p._size[1]=v,p}n.prototype.reshape=function(p,g){if(!Fi(p))throw new TypeError("Array expected");if(p.length!==2)throw new Error("Sparse matrices can only be reshaped in two dimensions");p.forEach(function(ee){if(!xi(ee)||!ai(ee)||ee<=-2||ee===0)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+Ti(p)+")")});var v=this._size[0]*this._size[1];p=Tv(p,v);var b=p[0]*p[1];if(v!==b)throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var _=g?this.clone():this;if(this._size[0]===p[0]&&this._size[1]===p[1])return _;for(var x=[],w=0;w<_._ptr.length;w++)for(var y=0;y<_._ptr[w+1]-_._ptr[w];y++)x.push(w);for(var M=_._values.slice(),T=_._index.slice(),C=0;C<_._index.length;C++){var N=T[C],D=x[C],k=N*_._size[1]+D;x[C]=k%p[1],T[C]=Math.floor(k/p[1])}_._values.length=0,_._index.length=0,_._ptr.length=p[1]+1,_._size=p.slice();for(var U=0;U<_._ptr.length;U++)_._ptr[U]=0;for(var F=0;F<M.length;F++){var H=T[F],V=x[F],Q=M[F],$=c(H,_._ptr[V],_._ptr[V+1],_._index);u($,H,V,Q,_._values,_._index,_._ptr)}return _},n.prototype.clone=function(){var p=new n({values:this._values?Kt(this._values):void 0,index:Kt(this._index),ptr:Kt(this._ptr),size:Kt(this._size),datatype:this._datatype});return p},n.prototype.size=function(){return this._size.slice(0)},n.prototype.map=function(p,g){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var v=this,b=this._size[0],_=this._size[1],x=xp(p,v,"map"),w=function(M,T,C){return x(M,[T,C],v)};return m(this,0,b-1,0,_-1,w,g)};function m(p,g,v,b,_,x,w){var y=[],M=[],T=[],C=i,N=0;Dn(p._datatype)&&(C=t.find(i,[p._datatype,p._datatype])||i,N=t.convert(0,p._datatype));for(var D=function(oe,pe,ue){var _e=x(oe,pe,ue);C(_e,N)||(y.push(_e),M.push(pe))},k=b;k<=_;k++){T.push(y.length);var U=p._ptr[k],F=p._ptr[k+1];if(w)for(var H=U;H<F;H++){var V=p._index[H];V>=g&&V<=v&&D(p._values[H],V-g,k-b)}else{for(var Q={},$=U;$<F;$++){var ee=p._index[$];Q[ee]=p._values[$]}for(var re=g;re<=v;re++){var we=re in Q?Q[re]:0;D(we,re-g,k-b)}}}return T.push(y.length),new n({values:y,index:M,ptr:T,size:[v-g+1,_-b+1]})}n.prototype.forEach=function(p,g){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var v=this,b=this._size[0],_=this._size[1],x=xp(p,v,"forEach"),w=0;w<_;w++){var y=this._ptr[w],M=this._ptr[w+1];if(g)for(var T=y;T<M;T++){var C=this._index[T];x(this._values[T],[C,w],v)}else{for(var N={},D=y;D<M;D++){var k=this._index[D];N[k]=this._values[D]}for(var U=0;U<b;U++){var F=U in N?N[U]:0;x(F,[U,w],v)}}}},n.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var p=this._size[1],g=0;g<p;g++)for(var v=this._ptr[g],b=this._ptr[g+1],_=v;_<b;_++){var x=this._index[_];yield{value:this._values[_],index:[x,g]}}},n.prototype.toArray=function(){return f(this._values,this._index,this._ptr,this._size,!0)},n.prototype.valueOf=function(){return f(this._values,this._index,this._ptr,this._size,!1)};function f(p,g,v,b,_){var x=b[0],w=b[1],y=[],M,T;for(M=0;M<x;M++)for(y[M]=[],T=0;T<w;T++)y[M][T]=0;for(T=0;T<w;T++)for(var C=v[T],N=v[T+1],D=C;D<N;D++)M=g[D],y[M][T]=p?_?Kt(p[D]):p[D]:1;return y}return n.prototype.format=function(p){for(var g=this._size[0],v=this._size[1],b=this.density(),_="Sparse Matrix ["+Ti(g,p)+" x "+Ti(v,p)+"] density: "+Ti(b,p)+`
`,x=0;x<v;x++)for(var w=this._ptr[x],y=this._ptr[x+1],M=w;M<y;M++){var T=this._index[M];_+=`
    (`+Ti(T,p)+", "+Ti(x,p)+") ==> "+(this._values?Ti(this._values[M],p):"X")}return _},n.prototype.toString=function(){return Ti(this.toArray())},n.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},n.prototype.diagonal=function(p){if(p){if(Ei(p)&&(p=p.toNumber()),!xi(p)||!ai(p))throw new TypeError("The parameter k must be an integer number")}else p=0;var g=p>0?p:0,v=p<0?-p:0,b=this._size[0],_=this._size[1],x=Math.min(b-v,_-g),w=[],y=[],M=[];M[0]=0;for(var T=g;T<_&&w.length<x;T++)for(var C=this._ptr[T],N=this._ptr[T+1],D=C;D<N;D++){var k=this._index[D];if(k===T-g+v){w.push(this._values[D]),y[w.length-1]=k-v;break}}return M.push(w.length),new n({values:w,index:y,ptr:M,size:[x,1]})},n.fromJSON=function(p){return new n(p)},n.diagonal=function(p,g,v,b,_){if(!Fi(p))throw new TypeError("Array expected, size parameter");if(p.length!==2)throw new Error("Only two dimensions matrix are supported");if(p=p.map(function(ee){if(Ei(ee)&&(ee=ee.toNumber()),!xi(ee)||!ai(ee)||ee<1)throw new Error("Size values must be positive integers");return ee}),v){if(Ei(v)&&(v=v.toNumber()),!xi(v)||!ai(v))throw new TypeError("The parameter k must be an integer number")}else v=0;var x=i,w=0;Dn(_)&&(x=t.find(i,[_,_])||i,w=t.convert(0,_));var y=v>0?v:0,M=v<0?-v:0,T=p[0],C=p[1],N=Math.min(T-M,C-y),D;if(Fi(g)){if(g.length!==N)throw new Error("Invalid value array length");D=function(re){return g[re]}}else if(ui(g)){var k=g.size();if(k.length!==1||k[0]!==N)throw new Error("Invalid matrix length");D=function(re){return g.get([re])}}else D=function(){return g};for(var U=[],F=[],H=[],V=0;V<C;V++){H.push(U.length);var Q=V-y;if(Q>=0&&Q<N){var $=D(Q);x($,w)||(F.push(Q+M),U.push($))}}return H.push(U.length),new n({values:U,index:F,ptr:H,size:[T,C]})},n.prototype.swapRows=function(p,g){if(!xi(p)||!ai(p)||!xi(g)||!ai(g))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return mr(p,this._size[0]),mr(g,this._size[0]),n._swapRows(p,g,this._size[1],this._values,this._index,this._ptr),this},n._forEachRow=function(p,g,v,b,_){for(var x=b[p],w=b[p+1],y=x;y<w;y++)_(v[y],g[y])},n._swapRows=function(p,g,v,b,_,x){for(var w=0;w<v;w++){var y=x[w],M=x[w+1],T=c(p,y,M,_),C=c(g,y,M,_);if(T<M&&C<M&&_[T]===p&&_[C]===g){if(b){var N=b[T];b[T]=b[C],b[C]=N}continue}if(T<M&&_[T]===p&&(C>=M||_[C]!==g)){var D=b?b[T]:void 0;_.splice(C,0,g),b&&b.splice(C,0,D),_.splice(C<=T?T+1:T,1),b&&b.splice(C<=T?T+1:T,1);continue}if(C<M&&_[C]===g&&(T>=M||_[T]!==p)){var k=b?b[C]:void 0;_.splice(T,0,p),b&&b.splice(T,0,k),_.splice(T<=C?C+1:C,1),b&&b.splice(T<=C?C+1:C,1)}}},n},{isClass:!0});var Wde="number",qde=["typed"];function $de(e){var t=e.match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/);if(t){var i={"0b":2,"0o":8,"0x":16}[t[1]],r=t[2],n=t[3];return{input:e,radix:i,integerPart:r,fractionalPart:n}}else return null}function Xde(e){for(var t=parseInt(e.integerPart,e.radix),i=0,r=0;r<e.fractionalPart.length;r++){var n=parseInt(e.fractionalPart[r],e.radix);i+=n/Math.pow(e.radix,r+1)}var a=t+i;if(isNaN(a))throw new SyntaxError('String "'+e.input+'" is not a valid number');return a}var iD=ie(Wde,qde,e=>{var{typed:t}=e,i=t("number",{"":function(){return 0},number:function(n){return n},string:function(n){if(n==="NaN")return NaN;var a=$de(n);if(a)return Xde(a);var o=0,s=n.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);s&&(o=Number(s[2]),n=s[1]);var l=Number(n);if(isNaN(l))throw new SyntaxError('String "'+n+'" is not a valid number');if(s){if(l>2**o-1)throw new SyntaxError('String "'.concat(n,'" is out of range'));l>=2**(o-1)&&(l=l-2**o)}return l},BigNumber:function(n){return n.toNumber()},bigint:function(n){return Number(n)},Fraction:function(n){return n.valueOf()},Unit:t.referToSelf(r=>n=>{var a=n.clone();return a.value=r(n.value),a}),null:function(n){return 0},"Unit, string | Unit":function(n,a){return n.toNumber(a)},"Array | Matrix":t.referToSelf(r=>n=>ar(n,r))});return i.fromJSON=function(r){return parseFloat(r.value)},i});var Yde="bignumber",Zde=["typed","BigNumber"],rD=ie(Yde,Zde,e=>{var{typed:t,BigNumber:i}=e;return t("bignumber",{"":function(){return new i(0)},number:function(n){return new i(n+"")},string:function(n){var a=n.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(a){var o=a[2],s=i(a[1]),l=new i(2).pow(Number(o));if(s.gt(l.sub(1)))throw new SyntaxError('String "'.concat(n,'" is out of range'));var c=new i(2).pow(Number(o)-1);return s.gte(c)?s.sub(l):s}return new i(n)},BigNumber:function(n){return n},bigint:function(n){return new i(n.toString())},Unit:t.referToSelf(r=>n=>{var a=n.clone();return a.value=r(n.value),a}),Fraction:function(n){return new i(n.n).div(n.d).times(n.s)},null:function(n){return new i(0)},"Array | Matrix":t.referToSelf(r=>n=>ar(n,r))})});var Kde="complex",Qde=["typed","Complex"],nD=ie(Kde,Qde,e=>{var{typed:t,Complex:i}=e;return t("complex",{"":function(){return i.ZERO},number:function(n){return new i(n,0)},"number, number":function(n,a){return new i(n,a)},"BigNumber, BigNumber":function(n,a){return new i(n.toNumber(),a.toNumber())},Fraction:function(n){return new i(n.valueOf(),0)},Complex:function(n){return n.clone()},string:function(n){return i(n)},null:function(n){return i(0)},Object:function(n){if("re"in n&&"im"in n)return new i(n.re,n.im);if("r"in n&&"phi"in n||"abs"in n&&"arg"in n)return new i(n);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":t.referToSelf(r=>n=>ar(n,r))})});var Jde="fraction",eue=["typed","Fraction"],aD=ie(Jde,eue,e=>{var{typed:t,Fraction:i}=e;return t("fraction",{number:function(n){if(!isFinite(n)||isNaN(n))throw new Error(n+" cannot be represented as a fraction");return new i(n)},string:function(n){return new i(n)},"number, number":function(n,a){return new i(n,a)},null:function(n){return new i(0)},BigNumber:function(n){return new i(n.toString())},bigint:function(n){return new i(n.toString())},Fraction:function(n){return n},Unit:t.referToSelf(r=>n=>{var a=n.clone();return a.value=r(n.value),a}),Object:function(n){return new i(n)},"Array | Matrix":t.referToSelf(r=>n=>ar(n,r))})});var Yz="matrix",tue=["typed","Matrix","DenseMatrix","SparseMatrix"],oD=ie(Yz,tue,e=>{var{typed:t,Matrix:i,DenseMatrix:r,SparseMatrix:n}=e;return t(Yz,{"":function(){return a([])},string:function(s){return a([],s)},"string, string":function(s,l){return a([],s,l)},Array:function(s){return a(s)},Matrix:function(s){return a(s,s.storage())},"Array | Matrix, string":a,"Array | Matrix, string, string":a});function a(o,s,l){if(s==="dense"||s==="default"||s===void 0)return new r(o,l);if(s==="sparse")return new n(o,l);throw new TypeError("Unknown matrix type "+JSON.stringify(s)+".")}});var Zz="matrixFromColumns",iue=["typed","matrix","flatten","size"],sD=ie(Zz,iue,e=>{var{typed:t,matrix:i,flatten:r,size:n}=e;return t(Zz,{"...Array":function(l){return a(l)},"...Matrix":function(l){return i(a(l.map(c=>c.toArray())))}});function a(s){if(s.length===0)throw new TypeError("At least one column is needed to construct a matrix.");for(var l=o(s[0]),c=[],d=0;d<l;d++)c[d]=[];for(var u of s){var h=o(u);if(h!==l)throw new TypeError("The vectors had different length: "+(l|0)+" \u2260 "+(h|0));for(var m=r(u),f=0;f<l;f++)c[f].push(m[f])}return c}function o(s){var l=n(s);if(l.length===1)return l[0];if(l.length===2){if(l[0]===1)return l[1];if(l[1]===1)return l[0];throw new TypeError("At least one of the arguments is not a vector.")}else throw new TypeError("Only one- or two-dimensional vectors are supported.")}});var Kz="unaryMinus",rue=["typed"],lD=ie(Kz,rue,e=>{var{typed:t}=e;return t(Kz,{number:ZT,"Complex | BigNumber | Fraction":i=>i.neg(),bigint:i=>-i,Unit:t.referToSelf(i=>r=>{var n=r.clone();return n.value=t.find(i,n.valueType())(r.value),n}),"Array | Matrix":t.referToSelf(i=>r=>ar(r,i,!0))})});var Qz="abs",nue=["typed"],cD=ie(Qz,nue,e=>{var{typed:t}=e;return t(Qz,{number:qT,"Complex | BigNumber | Fraction | Unit":i=>i.abs(),bigint:i=>i<0n?-i:i,"Array | Matrix":t.referToSelf(i=>r=>ar(r,i,!0))})});var Jz="addScalar",aue=["typed"],dD=ie(Jz,aue,e=>{var{typed:t}=e;return t(Jz,{"number, number":$T,"Complex, Complex":function(r,n){return r.add(n)},"BigNumber, BigNumber":function(r,n){return r.plus(n)},"bigint, bigint":function(r,n){return r+n},"Fraction, Fraction":function(r,n){return r.add(n)},"Unit, Unit":t.referToSelf(i=>(r,n)=>{if(r.value===null||r.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(n.value===null||n.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(n))throw new Error("Units do not match");var a=r.clone();return a.value=t.find(i,[a.valueType(),n.valueType()])(a.value,n.value),a.fixPrefix=!1,a})})});var e6="subtractScalar",oue=["typed"],uD=ie(e6,oue,e=>{var{typed:t}=e;return t(e6,{"number, number":XT,"Complex, Complex":function(r,n){return r.sub(n)},"BigNumber, BigNumber":function(r,n){return r.minus(n)},"bigint, bigint":function(r,n){return r-n},"Fraction, Fraction":function(r,n){return r.sub(n)},"Unit, Unit":t.referToSelf(i=>(r,n)=>{if(r.value===null||r.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(n.value===null||n.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(n))throw new Error("Units do not match");var a=r.clone();return a.value=t.find(i,[a.valueType(),n.valueType()])(a.value,n.value),a.fixPrefix=!1,a})})});var sue="matAlgo11xS0s",lue=["typed","equalScalar"],t6=ie(sue,lue,e=>{var{typed:t,equalScalar:i}=e;return function(n,a,o,s){var l=n._values,c=n._index,d=n._ptr,u=n._size,h=n._datatype;if(!l)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var m=u[0],f=u[1],p,g=i,v=0,b=o;typeof h=="string"&&(p=h,g=t.find(i,[p,p]),v=t.convert(0,p),a=t.convert(a,p),b=t.find(o,[p,p]));for(var _=[],x=[],w=[],y=0;y<f;y++){w[y]=x.length;for(var M=d[y],T=d[y+1],C=M;C<T;C++){var N=c[C],D=s?b(a,l[C]):b(l[C],a);g(D,v)||(x.push(N),_.push(D))}}return w[f]=x.length,n.createSparseMatrix({values:_,index:x,ptr:w,size:[m,f],datatype:p})}});var cue="matAlgo12xSfs",due=["typed","DenseMatrix"],es=ie(cue,due,e=>{var{typed:t,DenseMatrix:i}=e;return function(n,a,o,s){var l=n._values,c=n._index,d=n._ptr,u=n._size,h=n._datatype;if(!l)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var m=u[0],f=u[1],p,g=o;typeof h=="string"&&(p=h,a=t.convert(a,p),g=t.find(o,[p,p]));for(var v=[],b=[],_=[],x=0;x<f;x++){for(var w=x+1,y=d[x],M=d[x+1],T=y;T<M;T++){var C=c[T];b[C]=l[T],_[C]=w}for(var N=0;N<m;N++)x===0&&(v[N]=[]),_[N]===w?v[N][x]=s?g(a,b[N]):g(b[N],a):v[N][x]=s?g(a,0):g(0,a)}return new i({data:v,size:[m,f],datatype:p})}});var uue="matAlgo14xDs",hue=["typed"],sw=ie(uue,hue,e=>{var{typed:t}=e;return function(n,a,o,s){var l=n._data,c=n._size,d=n._datatype,u,h=o;typeof d=="string"&&(u=d,a=t.convert(a,u),h=t.find(o,[u,u]));var m=c.length>0?i(h,0,c,c[0],l,a,s):[];return n.createDenseMatrix({data:m,size:Kt(c),datatype:u})};function i(r,n,a,o,s,l,c){var d=[];if(n===a.length-1)for(var u=0;u<o;u++)d[u]=c?r(l,s[u]):r(s[u],l);else for(var h=0;h<o;h++)d[h]=i(r,n+1,a,a[n+1],s[h],l,c);return d}});var mue="matAlgo03xDSf",pue=["typed"],ts=ie(mue,pue,e=>{var{typed:t}=e;return function(r,n,a,o){var s=r._data,l=r._size,c=r._datatype||r.getDataType(),d=n._values,u=n._index,h=n._ptr,m=n._size,f=n._datatype||n._data===void 0?n._datatype:n.getDataType();if(l.length!==m.length)throw new oi(l.length,m.length);if(l[0]!==m[0]||l[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+m+")");if(!d)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var p=l[0],g=l[1],v,b=0,_=a;typeof c=="string"&&c===f&&c!=="mixed"&&(v=c,b=t.convert(0,v),_=t.find(a,[v,v]));for(var x=[],w=0;w<p;w++)x[w]=[];for(var y=[],M=[],T=0;T<g;T++){for(var C=T+1,N=h[T],D=h[T+1],k=N;k<D;k++){var U=u[k];y[U]=o?_(d[k],s[U][T]):_(s[U][T],d[k]),M[U]=C}for(var F=0;F<p;F++)M[F]===C?x[F][T]=y[F]:x[F][T]=o?_(b,s[F][T]):_(s[F][T],b)}return r.createDenseMatrix({data:x,size:[p,g],datatype:c===r._datatype&&f===n._datatype?v:void 0})}});var fue="matAlgo05xSfSf",gue=["typed","equalScalar"],i6=ie(fue,gue,e=>{var{typed:t,equalScalar:i}=e;return function(n,a,o){var s=n._values,l=n._index,c=n._ptr,d=n._size,u=n._datatype||n._data===void 0?n._datatype:n.getDataType(),h=a._values,m=a._index,f=a._ptr,p=a._size,g=a._datatype||a._data===void 0?a._datatype:a.getDataType();if(d.length!==p.length)throw new oi(d.length,p.length);if(d[0]!==p[0]||d[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+d+") must match Matrix B ("+p+")");var v=d[0],b=d[1],_,x=i,w=0,y=o;typeof u=="string"&&u===g&&u!=="mixed"&&(_=u,x=t.find(i,[_,_]),w=t.convert(0,_),y=t.find(o,[_,_]));var M=s&&h?[]:void 0,T=[],C=[],N=M?[]:void 0,D=M?[]:void 0,k=[],U=[],F,H,V,Q;for(H=0;H<b;H++){C[H]=T.length;var $=H+1;for(V=c[H],Q=c[H+1];V<Q;V++)F=l[V],T.push(F),k[F]=$,N&&(N[F]=s[V]);for(V=f[H],Q=f[H+1];V<Q;V++)F=m[V],k[F]!==$&&T.push(F),U[F]=$,D&&(D[F]=h[V]);if(M)for(V=C[H];V<T.length;){F=T[V];var ee=k[F],re=U[F];if(ee===$||re===$){var we=ee===$?N[F]:w,te=re===$?D[F]:w,oe=y(we,te);x(oe,w)?T.splice(V,1):(M.push(oe),V++)}}}return C[b]=T.length,n.createSparseMatrix({values:M,index:T,ptr:C,size:[v,b],datatype:u===n._datatype&&g===a._datatype?_:void 0})}});var vue="matAlgo13xDD",_ue=["typed"],r6=ie(vue,_ue,e=>{var{typed:t}=e;return function(n,a,o){var s=n._data,l=n._size,c=n._datatype,d=a._data,u=a._size,h=a._datatype,m=[];if(l.length!==u.length)throw new oi(l.length,u.length);for(var f=0;f<l.length;f++){if(l[f]!==u[f])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+u+")");m[f]=l[f]}var p,g=o;typeof c=="string"&&c===h&&(p=c,g=t.find(o,[p,p]));var v=m.length>0?i(g,0,m,m[0],s,d):[];return n.createDenseMatrix({data:v,size:m,datatype:p})};function i(r,n,a,o,s,l){var c=[];if(n===a.length-1)for(var d=0;d<o;d++)c[d]=r(s[d],l[d]);else for(var u=0;u<o;u++)c[u]=i(r,n+1,a,a[n+1],s[u],l[u]);return c}});function ln(e,t){if(Ko(e.size(),t.size()))return[e,t];var i=HT(e.size(),t.size());return[e,t].map(r=>bue(r,i))}function bue(e,t){return Ko(e.size(),t)?e:e.create(Dv(e.valueOf(),t),e.datatype())}var xue="matrixAlgorithmSuite",yue=["typed","matrix"],Xa=ie(xue,yue,e=>{var{typed:t,matrix:i}=e,r=r6({typed:t}),n=sw({typed:t});return function(o){var s=o.elop,l=o.SD||o.DS,c;s?(c={"DenseMatrix, DenseMatrix":(m,f)=>r(...ln(m,f),s),"Array, Array":(m,f)=>r(...ln(i(m),i(f)),s).valueOf(),"Array, DenseMatrix":(m,f)=>r(...ln(i(m),f),s),"DenseMatrix, Array":(m,f)=>r(...ln(m,i(f)),s)},o.SS&&(c["SparseMatrix, SparseMatrix"]=(m,f)=>o.SS(...ln(m,f),s,!1)),o.DS&&(c["DenseMatrix, SparseMatrix"]=(m,f)=>o.DS(...ln(m,f),s,!1),c["Array, SparseMatrix"]=(m,f)=>o.DS(...ln(i(m),f),s,!1)),l&&(c["SparseMatrix, DenseMatrix"]=(m,f)=>l(...ln(f,m),s,!0),c["SparseMatrix, Array"]=(m,f)=>l(...ln(i(f),m),s,!0))):(c={"DenseMatrix, DenseMatrix":t.referToSelf(m=>(f,p)=>r(...ln(f,p),m)),"Array, Array":t.referToSelf(m=>(f,p)=>r(...ln(i(f),i(p)),m).valueOf()),"Array, DenseMatrix":t.referToSelf(m=>(f,p)=>r(...ln(i(f),p),m)),"DenseMatrix, Array":t.referToSelf(m=>(f,p)=>r(...ln(f,i(p)),m))},o.SS&&(c["SparseMatrix, SparseMatrix"]=t.referToSelf(m=>(f,p)=>o.SS(...ln(f,p),m,!1))),o.DS&&(c["DenseMatrix, SparseMatrix"]=t.referToSelf(m=>(f,p)=>o.DS(...ln(f,p),m,!1)),c["Array, SparseMatrix"]=t.referToSelf(m=>(f,p)=>o.DS(...ln(i(f),p),m,!1))),l&&(c["SparseMatrix, DenseMatrix"]=t.referToSelf(m=>(f,p)=>l(...ln(p,f),m,!0)),c["SparseMatrix, Array"]=t.referToSelf(m=>(f,p)=>l(...ln(i(p),f),m,!0))));var d=o.scalar||"any",u=o.Ds||o.Ss;u&&(s?(c["DenseMatrix,"+d]=(m,f)=>n(m,f,s,!1),c[d+", DenseMatrix"]=(m,f)=>n(f,m,s,!0),c["Array,"+d]=(m,f)=>n(i(m),f,s,!1).valueOf(),c[d+", Array"]=(m,f)=>n(i(f),m,s,!0).valueOf()):(c["DenseMatrix,"+d]=t.referToSelf(m=>(f,p)=>n(f,p,m,!1)),c[d+", DenseMatrix"]=t.referToSelf(m=>(f,p)=>n(p,f,m,!0)),c["Array,"+d]=t.referToSelf(m=>(f,p)=>n(i(f),p,m,!1).valueOf()),c[d+", Array"]=t.referToSelf(m=>(f,p)=>n(i(p),f,m,!0).valueOf())));var h=o.sS!==void 0?o.sS:o.Ss;return s?(o.Ss&&(c["SparseMatrix,"+d]=(m,f)=>o.Ss(m,f,s,!1)),h&&(c[d+", SparseMatrix"]=(m,f)=>h(f,m,s,!0))):(o.Ss&&(c["SparseMatrix,"+d]=t.referToSelf(m=>(f,p)=>o.Ss(f,p,m,!1))),h&&(c[d+", SparseMatrix"]=t.referToSelf(m=>(f,p)=>h(p,f,m,!0)))),s&&s.signatures&&iz(c,s.signatures),c}});var wue="matAlgo01xDSid",Cue=["typed"],lw=ie(wue,Cue,e=>{var{typed:t}=e;return function(r,n,a,o){var s=r._data,l=r._size,c=r._datatype||r.getDataType(),d=n._values,u=n._index,h=n._ptr,m=n._size,f=n._datatype||n._data===void 0?n._datatype:n.getDataType();if(l.length!==m.length)throw new oi(l.length,m.length);if(l[0]!==m[0]||l[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+m+")");if(!d)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var p=l[0],g=l[1],v=typeof c=="string"&&c!=="mixed"&&c===f?c:void 0,b=v?t.find(a,[v,v]):a,_,x,w=[];for(_=0;_<p;_++)w[_]=[];var y=[],M=[];for(x=0;x<g;x++){for(var T=x+1,C=h[x],N=h[x+1],D=C;D<N;D++)_=u[D],y[_]=o?b(d[D],s[_][x]):b(s[_][x],d[D]),M[_]=T;for(_=0;_<p;_++)M[_]===T?w[_][x]=y[_]:w[_][x]=s[_][x]}return r.createDenseMatrix({data:w,size:[p,g],datatype:c===r._datatype&&f===n._datatype?v:void 0})}});var Eue="matAlgo04xSidSid",Sue=["typed","equalScalar"],n6=ie(Eue,Sue,e=>{var{typed:t,equalScalar:i}=e;return function(n,a,o){var s=n._values,l=n._index,c=n._ptr,d=n._size,u=n._datatype||n._data===void 0?n._datatype:n.getDataType(),h=a._values,m=a._index,f=a._ptr,p=a._size,g=a._datatype||a._data===void 0?a._datatype:a.getDataType();if(d.length!==p.length)throw new oi(d.length,p.length);if(d[0]!==p[0]||d[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+d+") must match Matrix B ("+p+")");var v=d[0],b=d[1],_,x=i,w=0,y=o;typeof u=="string"&&u===g&&u!=="mixed"&&(_=u,x=t.find(i,[_,_]),w=t.convert(0,_),y=t.find(o,[_,_]));var M=s&&h?[]:void 0,T=[],C=[],N=s&&h?[]:void 0,D=s&&h?[]:void 0,k=[],U=[],F,H,V,Q,$;for(H=0;H<b;H++){C[H]=T.length;var ee=H+1;for(Q=c[H],$=c[H+1],V=Q;V<$;V++)F=l[V],T.push(F),k[F]=ee,N&&(N[F]=s[V]);for(Q=f[H],$=f[H+1],V=Q;V<$;V++)if(F=m[V],k[F]===ee){if(N){var re=y(N[F],h[V]);x(re,w)?k[F]=null:N[F]=re}}else T.push(F),U[F]=ee,D&&(D[F]=h[V]);if(N&&D)for(V=C[H];V<T.length;)F=T[V],k[F]===ee?(M[V]=N[F],V++):U[F]===ee?(M[V]=D[F],V++):T.splice(V,1)}return C[b]=T.length,n.createSparseMatrix({values:M,index:T,ptr:C,size:[v,b],datatype:u===n._datatype&&g===a._datatype?_:void 0})}});var Aue="matAlgo10xSids",Tue=["typed","DenseMatrix"],cw=ie(Aue,Tue,e=>{var{typed:t,DenseMatrix:i}=e;return function(n,a,o,s){var l=n._values,c=n._index,d=n._ptr,u=n._size,h=n._datatype;if(!l)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var m=u[0],f=u[1],p,g=o;typeof h=="string"&&(p=h,a=t.convert(a,p),g=t.find(o,[p,p]));for(var v=[],b=[],_=[],x=0;x<f;x++){for(var w=x+1,y=d[x],M=d[x+1],T=y;T<M;T++){var C=c[T];b[C]=l[T],_[C]=w}for(var N=0;N<m;N++)x===0&&(v[N]=[]),_[N]===w?v[N][x]=s?g(a,b[N]):g(b[N],a):v[N][x]=a}return new i({data:v,size:[m,f],datatype:p})}});var Due="multiplyScalar",Mue=["typed"],hD=ie(Due,Mue,e=>{var{typed:t}=e;return t("multiplyScalar",{"number, number":YT,"Complex, Complex":function(r,n){return r.mul(n)},"BigNumber, BigNumber":function(r,n){return r.times(n)},"bigint, bigint":function(r,n){return r*n},"Fraction, Fraction":function(r,n){return r.mul(n)},"number | Fraction | BigNumber | Complex, Unit":(i,r)=>r.multiply(i),"Unit, number | Fraction | BigNumber | Complex | Unit":(i,r)=>i.multiply(r)})});var a6="multiply",Iue=["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],mD=ie(a6,Iue,e=>{var{typed:t,matrix:i,addScalar:r,multiplyScalar:n,equalScalar:a,dot:o}=e,s=t6({typed:t,equalScalar:a}),l=sw({typed:t});function c(w,y){switch(w.length){case 1:switch(y.length){case 1:if(w[0]!==y[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(w[0]!==y[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+w[0]+") must match Matrix rows ("+y[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+y.length+" dimensions)")}break;case 2:switch(y.length){case 1:if(w[1]!==y[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+w[1]+") must match Vector length ("+y[0]+")");break;case 2:if(w[1]!==y[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+w[1]+") must match Matrix B rows ("+y[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+y.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+w.length+" dimensions)")}}function d(w,y,M){if(M===0)throw new Error("Cannot multiply two empty vectors");return o(w,y)}function u(w,y){if(y.storage()!=="dense")throw new Error("Support for SparseMatrix not implemented");return h(w,y)}function h(w,y){var M=w._data,T=w._size,C=w._datatype||w.getDataType(),N=y._data,D=y._size,k=y._datatype||y.getDataType(),U=T[0],F=D[1],H,V=r,Q=n;C&&k&&C===k&&typeof C=="string"&&C!=="mixed"&&(H=C,V=t.find(r,[H,H]),Q=t.find(n,[H,H]));for(var $=[],ee=0;ee<F;ee++){for(var re=Q(M[0],N[0][ee]),we=1;we<U;we++)re=V(re,Q(M[we],N[we][ee]));$[ee]=re}return w.createDenseMatrix({data:$,size:[F],datatype:C===w._datatype&&k===y._datatype?H:void 0})}var m=t("_multiplyMatrixVector",{"DenseMatrix, any":p,"SparseMatrix, any":b}),f=t("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":g,"DenseMatrix, SparseMatrix":v,"SparseMatrix, DenseMatrix":_,"SparseMatrix, SparseMatrix":x});function p(w,y){var M=w._data,T=w._size,C=w._datatype||w.getDataType(),N=y._data,D=y._datatype||y.getDataType(),k=T[0],U=T[1],F,H=r,V=n;C&&D&&C===D&&typeof C=="string"&&C!=="mixed"&&(F=C,H=t.find(r,[F,F]),V=t.find(n,[F,F]));for(var Q=[],$=0;$<k;$++){for(var ee=M[$],re=V(ee[0],N[0]),we=1;we<U;we++)re=H(re,V(ee[we],N[we]));Q[$]=re}return w.createDenseMatrix({data:Q,size:[k],datatype:C===w._datatype&&D===y._datatype?F:void 0})}function g(w,y){var M=w._data,T=w._size,C=w._datatype||w.getDataType(),N=y._data,D=y._size,k=y._datatype||y.getDataType(),U=T[0],F=T[1],H=D[1],V,Q=r,$=n;C&&k&&C===k&&typeof C=="string"&&C!=="mixed"&&C!=="mixed"&&(V=C,Q=t.find(r,[V,V]),$=t.find(n,[V,V]));for(var ee=[],re=0;re<U;re++){var we=M[re];ee[re]=[];for(var te=0;te<H;te++){for(var oe=$(we[0],N[0][te]),pe=1;pe<F;pe++)oe=Q(oe,$(we[pe],N[pe][te]));ee[re][te]=oe}}return w.createDenseMatrix({data:ee,size:[U,H],datatype:C===w._datatype&&k===y._datatype?V:void 0})}function v(w,y){var M=w._data,T=w._size,C=w._datatype||w.getDataType(),N=y._values,D=y._index,k=y._ptr,U=y._size,F=y._datatype||y._data===void 0?y._datatype:y.getDataType();if(!N)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var H=T[0],V=U[1],Q,$=r,ee=n,re=a,we=0;C&&F&&C===F&&typeof C=="string"&&C!=="mixed"&&(Q=C,$=t.find(r,[Q,Q]),ee=t.find(n,[Q,Q]),re=t.find(a,[Q,Q]),we=t.convert(0,Q));for(var te=[],oe=[],pe=[],ue=y.createSparseMatrix({values:te,index:oe,ptr:pe,size:[H,V],datatype:C===w._datatype&&F===y._datatype?Q:void 0}),_e=0;_e<V;_e++){pe[_e]=oe.length;var ce=k[_e],fe=k[_e+1];if(fe>ce)for(var be=0,ge=0;ge<H;ge++){for(var Oe=ge+1,De=void 0,$e=ce;$e<fe;$e++){var _t=D[$e];be!==Oe?(De=ee(M[ge][_t],N[$e]),be=Oe):De=$(De,ee(M[ge][_t],N[$e]))}be===Oe&&!re(De,we)&&(oe.push(ge),te.push(De))}}return pe[V]=oe.length,ue}function b(w,y){var M=w._values,T=w._index,C=w._ptr,N=w._datatype||w._data===void 0?w._datatype:w.getDataType();if(!M)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var D=y._data,k=y._datatype||y.getDataType(),U=w._size[0],F=y._size[0],H=[],V=[],Q=[],$,ee=r,re=n,we=a,te=0;N&&k&&N===k&&typeof N=="string"&&N!=="mixed"&&($=N,ee=t.find(r,[$,$]),re=t.find(n,[$,$]),we=t.find(a,[$,$]),te=t.convert(0,$));var oe=[],pe=[];Q[0]=0;for(var ue=0;ue<F;ue++){var _e=D[ue];if(!we(_e,te))for(var ce=C[ue],fe=C[ue+1],be=ce;be<fe;be++){var ge=T[be];pe[ge]?oe[ge]=ee(oe[ge],re(_e,M[be])):(pe[ge]=!0,V.push(ge),oe[ge]=re(_e,M[be]))}}for(var Oe=V.length,De=0;De<Oe;De++){var $e=V[De];H[De]=oe[$e]}return Q[1]=V.length,w.createSparseMatrix({values:H,index:V,ptr:Q,size:[U,1],datatype:N===w._datatype&&k===y._datatype?$:void 0})}function _(w,y){var M=w._values,T=w._index,C=w._ptr,N=w._datatype||w._data===void 0?w._datatype:w.getDataType();if(!M)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var D=y._data,k=y._datatype||y.getDataType(),U=w._size[0],F=y._size[0],H=y._size[1],V,Q=r,$=n,ee=a,re=0;N&&k&&N===k&&typeof N=="string"&&N!=="mixed"&&(V=N,Q=t.find(r,[V,V]),$=t.find(n,[V,V]),ee=t.find(a,[V,V]),re=t.convert(0,V));for(var we=[],te=[],oe=[],pe=w.createSparseMatrix({values:we,index:te,ptr:oe,size:[U,H],datatype:N===w._datatype&&k===y._datatype?V:void 0}),ue=[],_e=[],ce=0;ce<H;ce++){oe[ce]=te.length;for(var fe=ce+1,be=0;be<F;be++){var ge=D[be][ce];if(!ee(ge,re))for(var Oe=C[be],De=C[be+1],$e=Oe;$e<De;$e++){var _t=T[$e];_e[_t]!==fe?(_e[_t]=fe,te.push(_t),ue[_t]=$(ge,M[$e])):ue[_t]=Q(ue[_t],$(ge,M[$e]))}}for(var st=oe[ce],jt=te.length,Di=st;Di<jt;Di++){var Bi=te[Di];we[Di]=ue[Bi]}}return oe[H]=te.length,pe}function x(w,y){var M=w._values,T=w._index,C=w._ptr,N=w._datatype||w._data===void 0?w._datatype:w.getDataType(),D=y._values,k=y._index,U=y._ptr,F=y._datatype||y._data===void 0?y._datatype:y.getDataType(),H=w._size[0],V=y._size[1],Q=M&&D,$,ee=r,re=n;N&&F&&N===F&&typeof N=="string"&&N!=="mixed"&&($=N,ee=t.find(r,[$,$]),re=t.find(n,[$,$]));for(var we=Q?[]:void 0,te=[],oe=[],pe=w.createSparseMatrix({values:we,index:te,ptr:oe,size:[H,V],datatype:N===w._datatype&&F===y._datatype?$:void 0}),ue=Q?[]:void 0,_e=[],ce,fe,be,ge,Oe,De,$e,_t,st=0;st<V;st++){oe[st]=te.length;var jt=st+1;for(Oe=U[st],De=U[st+1],ge=Oe;ge<De;ge++)if(_t=k[ge],Q)for(fe=C[_t],be=C[_t+1],ce=fe;ce<be;ce++)$e=T[ce],_e[$e]!==jt?(_e[$e]=jt,te.push($e),ue[$e]=re(D[ge],M[ce])):ue[$e]=ee(ue[$e],re(D[ge],M[ce]));else for(fe=C[_t],be=C[_t+1],ce=fe;ce<be;ce++)$e=T[ce],_e[$e]!==jt&&(_e[$e]=jt,te.push($e));if(Q)for(var Di=oe[st],Bi=te.length,fr=Di;fr<Bi;fr++){var Vi=te[fr];we[fr]=ue[Vi]}}return oe[V]=te.length,pe}return t(a6,n,{"Array, Array":t.referTo("Matrix, Matrix",w=>(y,M)=>{c(Li(y),Li(M));var T=w(i(y),i(M));return ui(T)?T.valueOf():T}),"Matrix, Matrix":function(y,M){var T=y.size(),C=M.size();return c(T,C),T.length===1?C.length===1?d(y,M,T[0]):u(y,M):C.length===1?m(y,M):f(y,M)},"Matrix, Array":t.referTo("Matrix,Matrix",w=>(y,M)=>w(y,i(M))),"Array, Matrix":t.referToSelf(w=>(y,M)=>w(i(y,M.storage()),M)),"SparseMatrix, any":function(y,M){return s(y,M,n,!1)},"DenseMatrix, any":function(y,M){return l(y,M,n,!1)},"any, SparseMatrix":function(y,M){return s(M,y,n,!0)},"any, DenseMatrix":function(y,M){return l(M,y,n,!0)},"Array, any":function(y,M){return l(i(y),M,n,!1).valueOf()},"any, Array":function(y,M){return l(i(M),y,n,!0).valueOf()},"any, any":n,"any, any, ...any":t.referToSelf(w=>(y,M,T)=>{for(var C=w(y,M),N=0;N<T.length;N++)C=w(C,T[N]);return C})})});var o6="sign",kue=["typed","BigNumber","Fraction","complex"],pD=ie(o6,kue,e=>{var{typed:t,BigNumber:i,complex:r,Fraction:n}=e;return t(o6,{number:aw,Complex:function(o){return o.im===0?r(aw(o.re)):o.sign()},BigNumber:function(o){return new i(o.cmp(0))},bigint:function(o){return o>0n?1n:o<0n?-1n:0n},Fraction:function(o){return new n(o.s,1)},"Array | Matrix":t.referToSelf(a=>o=>ar(o,a,!0)),Unit:t.referToSelf(a=>o=>{if(!o._isDerived()&&o.units[0].unit.offset!==0)throw new TypeError("sign is ambiguous for units with offset");return t.find(a,o.valueType())(o.value)})})});var Nue="sqrt",Pue=["config","typed","Complex"],fD=ie(Nue,Pue,e=>{var{config:t,typed:i,Complex:r}=e;return i("sqrt",{number:n,Complex:function(o){return o.sqrt()},BigNumber:function(o){return!o.isNegative()||t.predictable?o.sqrt():n(o.toNumber())},Unit:function(o){return o.pow(.5)}});function n(a){return isNaN(a)?NaN:a>=0||t.predictable?Math.sqrt(a):new r(a,0).sqrt()}});var s6="subtract",Rue=["typed","matrix","equalScalar","subtractScalar","unaryMinus","DenseMatrix","concat"],gD=ie(s6,Rue,e=>{var{typed:t,matrix:i,equalScalar:r,subtractScalar:n,unaryMinus:a,DenseMatrix:o,concat:s}=e,l=lw({typed:t}),c=ts({typed:t}),d=i6({typed:t,equalScalar:r}),u=cw({typed:t,DenseMatrix:o}),h=es({typed:t,DenseMatrix:o}),m=Xa({typed:t,matrix:i,concat:s});return t(s6,{"any, any":n},m({elop:n,SS:d,DS:l,SD:c,Ss:h,sS:u}))});var Fue="matAlgo07xSSf",Oue=["typed","DenseMatrix"],il=ie(Fue,Oue,e=>{var{typed:t,DenseMatrix:i}=e;return function(a,o,s){var l=a._size,c=a._datatype||a._data===void 0?a._datatype:a.getDataType(),d=o._size,u=o._datatype||o._data===void 0?o._datatype:o.getDataType();if(l.length!==d.length)throw new oi(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");var h=l[0],m=l[1],f,p=0,g=s;typeof c=="string"&&c===u&&c!=="mixed"&&(f=c,p=t.convert(0,f),g=t.find(s,[f,f]));var v,b,_=[];for(v=0;v<h;v++)_[v]=[];var x=[],w=[],y=[],M=[];for(b=0;b<m;b++){var T=b+1;for(r(a,b,y,x,T),r(o,b,M,w,T),v=0;v<h;v++){var C=y[v]===T?x[v]:p,N=M[v]===T?w[v]:p;_[v][b]=g(C,N)}}return new i({data:_,size:[h,m],datatype:c===a._datatype&&u===o._datatype?f:void 0})};function r(n,a,o,s,l){for(var c=n._values,d=n._index,u=n._ptr,h=u[a],m=u[a+1];h<m;h++){var f=d[h];o[f]=l,s[f]=c[h]}}});var l6="conj",Lue=["typed"],vD=ie(l6,Lue,e=>{var{typed:t}=e;return t(l6,{"number | BigNumber | Fraction":i=>i,Complex:i=>i.conjugate(),"Array | Matrix":t.referToSelf(i=>r=>ar(r,i))})});var c6="im",Bue=["typed"],_D=ie(c6,Bue,e=>{var{typed:t}=e;return t(c6,{number:()=>0,"BigNumber | Fraction":i=>i.mul(0),Complex:i=>i.im,"Array | Matrix":t.referToSelf(i=>r=>ar(r,i))})});var d6="re",Vue=["typed"],bD=ie(d6,Vue,e=>{var{typed:t}=e;return t(d6,{"number | BigNumber | Fraction":i=>i,Complex:i=>i.re,"Array | Matrix":t.referToSelf(i=>r=>ar(r,i))})});var u6="concat",zue=["typed","matrix","isInteger"],xD=ie(u6,zue,e=>{var{typed:t,matrix:i,isInteger:r}=e;return t(u6,{"...Array | Matrix | number | BigNumber":function(a){var o,s=a.length,l=-1,c,d=!1,u=[];for(o=0;o<s;o++){var h=a[o];if(ui(h)&&(d=!0),xi(h)||Ei(h)){if(o!==s-1)throw new Error("Dimension must be specified as last argument");if(c=l,l=h.valueOf(),!r(l))throw new TypeError("Integer number expected for dimension");if(l<0||o>0&&l>c)throw new Yl(l,c+1)}else{var m=Kt(h).valueOf(),f=Li(m);if(u[o]=m,c=l,l=f.length-1,o>0&&l!==c)throw new oi(c+1,l+1)}}if(u.length===0)throw new SyntaxError("At least one matrix expected");for(var p=u.shift();u.length;)p=UT(p,u.shift(),l);return d?i(p):p},"...string":function(a){return a.join("")}})});var h6="column",Uue=["typed","Index","matrix","range"],yD=ie(h6,Uue,e=>{var{typed:t,Index:i,matrix:r,range:n}=e;return t(h6,{"Matrix, number":a,"Array, number":function(s,l){return a(r(Kt(s)),l).valueOf()}});function a(o,s){if(o.size().length!==2)throw new Error("Only two dimensional matrix is supported");mr(s,o.size()[1]);var l=n(0,o.size()[0]),c=new i(l,s),d=o.subset(c);return ui(d)?d:r([[d]])}});var m6="diag",Hue=["typed","matrix","DenseMatrix","SparseMatrix"],wD=ie(m6,Hue,e=>{var{typed:t,matrix:i,DenseMatrix:r,SparseMatrix:n}=e;return t(m6,{Array:function(c){return a(c,0,Li(c),null)},"Array, number":function(c,d){return a(c,d,Li(c),null)},"Array, BigNumber":function(c,d){return a(c,d.toNumber(),Li(c),null)},"Array, string":function(c,d){return a(c,0,Li(c),d)},"Array, number, string":function(c,d,u){return a(c,d,Li(c),u)},"Array, BigNumber, string":function(c,d,u){return a(c,d.toNumber(),Li(c),u)},Matrix:function(c){return a(c,0,c.size(),c.storage())},"Matrix, number":function(c,d){return a(c,d,c.size(),c.storage())},"Matrix, BigNumber":function(c,d){return a(c,d.toNumber(),c.size(),c.storage())},"Matrix, string":function(c,d){return a(c,0,c.size(),d)},"Matrix, number, string":function(c,d,u){return a(c,d,c.size(),u)},"Matrix, BigNumber, string":function(c,d,u){return a(c,d.toNumber(),c.size(),u)}});function a(l,c,d,u){if(!ai(c))throw new TypeError("Second parameter in function diag must be an integer");var h=c>0?c:0,m=c<0?-c:0;switch(d.length){case 1:return o(l,c,u,d[0],m,h);case 2:return s(l,c,u,d,m,h)}throw new RangeError("Matrix for function diag must be 2 dimensional")}function o(l,c,d,u,h,m){var f=[u+h,u+m];if(d&&d!=="sparse"&&d!=="dense")throw new TypeError("Unknown matrix type ".concat(d,'"'));var p=d==="sparse"?n.diagonal(f,l,c):r.diagonal(f,l,c);return d!==null?p:p.valueOf()}function s(l,c,d,u,h,m){if(ui(l)){var f=l.diagonal(c);return d!==null?d!==f.storage()?i(f,d):f:f.valueOf()}for(var p=Math.min(u[0]-h,u[1]-m),g=[],v=0;v<p;v++)g[v]=l[v+h][v+m];return d!==null?i(g):g}});var p6="flatten",Gue=["typed"],CD=ie(p6,Gue,e=>{var{typed:t}=e;return t(p6,{Array:function(r){return rw(r)},Matrix:function(r){return r.create(rw(r.toArray()),r.datatype())}})});var f6="getMatrixDataType",jue=["typed"],ED=ie(f6,jue,e=>{var{typed:t}=e;return t(f6,{Array:function(r){return Qu(r,on)},Matrix:function(r){return r.getDataType()}})});var g6="identity",Wue=["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],SD=ie(g6,Wue,e=>{var{typed:t,config:i,matrix:r,BigNumber:n,DenseMatrix:a,SparseMatrix:o}=e;return t(g6,{"":function(){return i.matrix==="Matrix"?r([]):[]},string:function(d){return r(d)},"number | BigNumber":function(d){return l(d,d,i.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, string":function(d,u){return l(d,d,u)},"number | BigNumber, number | BigNumber":function(d,u){return l(d,u,i.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(d,u,h){return l(d,u,h)},Array:function(d){return s(d)},"Array, string":function(d,u){return s(d,u)},Matrix:function(d){return s(d.valueOf(),d.storage())},"Matrix, string":function(d,u){return s(d.valueOf(),u)}});function s(c,d){switch(c.length){case 0:return d?r(d):[];case 1:return l(c[0],c[0],d);case 2:return l(c[0],c[1],d);default:throw new Error("Vector containing two values expected")}}function l(c,d,u){var h=Ei(c)||Ei(d)?n:null;if(Ei(c)&&(c=c.toNumber()),Ei(d)&&(d=d.toNumber()),!ai(c)||c<1)throw new Error("Parameters in function identity must be positive integers");if(!ai(d)||d<1)throw new Error("Parameters in function identity must be positive integers");var m=h?new n(1):1,f=h?new h(0):0,p=[c,d];if(u){if(u==="sparse")return o.diagonal(p,m,0,f);if(u==="dense")return a.diagonal(p,m,0,f);throw new TypeError('Unknown matrix type "'.concat(u,'"'))}for(var g=Ku([],p,f),v=c<d?c:d,b=0;b<v;b++)g[b][b]=m;return g}});function dw(){throw new Error('No "bignumber" implementation available')}function v6(){throw new Error('No "fraction" implementation available')}function uw(){throw new Error('No "matrix" implementation available')}var _6="range",que=["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],AD=ie(_6,que,e=>{var{typed:t,config:i,matrix:r,bignumber:n,smaller:a,smallerEq:o,larger:s,largerEq:l,add:c,isPositive:d}=e;return t(_6,{string:h,"string, boolean":h,"number, number":function(g,v){return u(m(g,v,1,!1))},"number, number, number":function(g,v,b){return u(m(g,v,b,!1))},"number, number, boolean":function(g,v,b){return u(m(g,v,1,b))},"number, number, number, boolean":function(g,v,b,_){return u(m(g,v,b,_))},"BigNumber, BigNumber":function(g,v){var b=g.constructor;return u(m(g,v,new b(1),!1))},"BigNumber, BigNumber, BigNumber":function(g,v,b){return u(m(g,v,b,!1))},"BigNumber, BigNumber, boolean":function(g,v,b){var _=g.constructor;return u(m(g,v,new _(1),b))},"BigNumber, BigNumber, BigNumber, boolean":function(g,v,b,_){return u(m(g,v,b,_))},"Unit, Unit, Unit":function(g,v,b){return u(m(g,v,b,!1))},"Unit, Unit, Unit, boolean":function(g,v,b,_){return u(m(g,v,b,_))}});function u(p){return i.matrix==="Matrix"?r?r(p):uw():p}function h(p,g){var v=f(p);if(!v)throw new SyntaxError('String "'+p+'" is no valid range');return i.number==="BigNumber"?(n===void 0&&dw(),u(m(n(v.start),n(v.end),n(v.step)),g)):u(m(v.start,v.end,v.step,g))}function m(p,g,v,b){for(var _=[],x=d(v)?b?o:a:b?l:s,w=p;x(w,g);)_.push(w),w=c(w,v);return _}function f(p){var g=p.split(":"),v=g.map(function(_){return Number(_)}),b=v.some(function(_){return isNaN(_)});if(b)return null;switch(v.length){case 2:return{start:v[0],end:v[1],step:1};case 3:return{start:v[0],end:v[2],step:v[1]};default:return null}}});var b6="reshape",$ue=["typed","isInteger","matrix"],TD=ie(b6,$ue,e=>{var{typed:t,isInteger:i}=e;return t(b6,{"Matrix, Array":function(n,a){return n.reshape(a,!0)},"Array, Array":function(n,a){return a.forEach(function(o){if(!i(o))throw new TypeError("Invalid size for dimension: "+o)}),Av(n,a)}})});var x6="size",Xue=["typed","config","?matrix"],DD=ie(x6,Xue,e=>{var{typed:t,config:i,matrix:r}=e;return t(x6,{Matrix:function(a){return a.create(a.size(),"number")},Array:Li,string:function(a){return i.matrix==="Array"?[a.length]:r([a.length],"dense","number")},"number | Complex | BigNumber | Unit | boolean | null":function(a){return i.matrix==="Array"?[]:r?r([],"dense","number"):uw()}})});var y6="transpose",Yue=["typed","matrix"],MD=ie(y6,Yue,e=>{var{typed:t,matrix:i}=e;return t(y6,{Array:o=>r(i(o)).valueOf(),Matrix:r,any:Kt});function r(o){var s=o.size(),l;switch(s.length){case 1:l=o.clone();break;case 2:{var c=s[0],d=s[1];if(d===0)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+Ti(s)+")");switch(o.storage()){case"dense":l=n(o,c,d);break;case"sparse":l=a(o,c,d);break}}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+Ti(s)+")")}return l}function n(o,s,l){for(var c=o._data,d=[],u,h=0;h<l;h++){u=d[h]=[];for(var m=0;m<s;m++)u[m]=Kt(c[m][h])}return o.createDenseMatrix({data:d,size:[l,s],datatype:o._datatype})}function a(o,s,l){for(var c=o._values,d=o._index,u=o._ptr,h=c?[]:void 0,m=[],f=[],p=[],g=0;g<s;g++)p[g]=0;var v,b,_;for(v=0,b=d.length;v<b;v++)p[d[v]]++;for(var x=0,w=0;w<s;w++)f.push(x),x+=p[w],p[w]=f[w];for(f.push(x),_=0;_<l;_++)for(var y=u[_],M=u[_+1],T=y;T<M;T++){var C=p[d[T]]++;m[C]=_,c&&(h[C]=Kt(c[T]))}return o.createSparseMatrix({values:h,index:m,ptr:f,size:[l,s],datatype:o._datatype})}});var w6="zeros",Zue=["typed","config","matrix","BigNumber"],ID=ie(w6,Zue,e=>{var{typed:t,config:i,matrix:r,BigNumber:n}=e;return t(w6,{"":function(){return i.matrix==="Array"?a([]):a([],"default")},"...number | BigNumber | string":function(c){var d=c[c.length-1];if(typeof d=="string"){var u=c.pop();return a(c,u)}else return i.matrix==="Array"?a(c):a(c,"default")},Array:a,Matrix:function(c){var d=c.storage();return a(c.valueOf(),d)},"Array | Matrix, string":function(c,d){return a(c.valueOf(),d)}});function a(l,c){var d=o(l),u=d?new n(0):0;if(s(l),c){var h=r(c);return l.length>0?h.resize(l,u):h}else{var m=[];return l.length>0?Ku(m,l,u):m}}function o(l){var c=!1;return l.forEach(function(d,u,h){Ei(d)&&(c=!0,h[u]=d.toNumber())}),c}function s(l){l.forEach(function(c){if(typeof c!="number"||!ai(c)||c<0)throw new Error("Parameters in function zeros must be positive integers")})}});var Kue="numeric",Que=["number","?bignumber","?fraction"],kD=ie(Kue,Que,e=>{var{number:t,bignumber:i,fraction:r}=e,n={string:!0,number:!0,BigNumber:!0,Fraction:!0},a={number:o=>t(o),BigNumber:i?o=>i(o):dw,bigint:o=>BigInt(o),Fraction:r?o=>r(o):v6};return function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"number",c=arguments.length>2?arguments[2]:void 0;if(c!==void 0)throw new SyntaxError("numeric() takes one or two arguments");var d=on(s);if(!(d in n))throw new TypeError("Cannot convert "+s+' of type "'+d+'"; valid input types are '+Object.keys(n).join(", "));if(!(l in a))throw new TypeError("Cannot convert "+s+' to type "'+l+'"; valid output types are '+Object.keys(a).join(", "));return l===d?s:a[l](s)}});var C6="divideScalar",Jue=["typed","numeric"],ND=ie(C6,Jue,e=>{var{typed:t,numeric:i}=e;return t(C6,{"number, number":function(n,a){return n/a},"Complex, Complex":function(n,a){return n.div(a)},"BigNumber, BigNumber":function(n,a){return n.div(a)},"bigint, bigint":function(n,a){return n/a},"Fraction, Fraction":function(n,a){return n.div(a)},"Unit, number | Complex | Fraction | BigNumber | Unit":(r,n)=>r.divide(n),"number | Fraction | Complex | BigNumber, Unit":(r,n)=>n.divideInto(r)})});function hw(e){var{DenseMatrix:t}=e;return function(r,n,a){var o=r.size();if(o.length!==2)throw new RangeError("Matrix must be two dimensional (size: "+Ti(o)+")");var s=o[0],l=o[1];if(s!==l)throw new RangeError("Matrix must be square (size: "+Ti(o)+")");var c=[];if(ui(n)){var d=n.size(),u=n._data;if(d.length===1){if(d[0]!==s)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var h=0;h<s;h++)c[h]=[u[h]];return new t({data:c,size:[s,1],datatype:n._datatype})}if(d.length===2){if(d[0]!==s||d[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(zy(n)){if(a){c=[];for(var m=0;m<s;m++)c[m]=[u[m][0]];return new t({data:c,size:[s,1],datatype:n._datatype})}return n}if(Uy(n)){for(var f=0;f<s;f++)c[f]=[0];for(var p=n._values,g=n._index,v=n._ptr,b=v[1],_=v[0];_<b;_++){var x=g[_];c[x][0]=p[_]}return new t({data:c,size:[s,1],datatype:n._datatype})}}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(Fi(n)){var w=Li(n);if(w.length===1){if(w[0]!==s)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var y=0;y<s;y++)c[y]=[n[y]];return new t({data:c,size:[s,1]})}if(w.length===2){if(w[0]!==s||w[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var M=0;M<s;M++)c[M]=[n[M][0]];return new t({data:c,size:[s,1]})}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}var E6="usolve",ehe=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],PD=ie(E6,ehe,e=>{var{typed:t,matrix:i,divideScalar:r,multiplyScalar:n,subtractScalar:a,equalScalar:o,DenseMatrix:s}=e,l=hw({DenseMatrix:s});return t(E6,{"SparseMatrix, Array | Matrix":function(h,m){return d(h,m)},"DenseMatrix, Array | Matrix":function(h,m){return c(h,m)},"Array, Array | Matrix":function(h,m){var f=i(h),p=c(f,m);return p.valueOf()}});function c(u,h){h=l(u,h,!0);for(var m=h._data,f=u._size[0],p=u._size[1],g=[],v=u._data,b=p-1;b>=0;b--){var _=m[b][0]||0,x=void 0;if(o(_,0))x=0;else{var w=v[b][b];if(o(w,0))throw new Error("Linear system cannot be solved since matrix is singular");x=r(_,w);for(var y=b-1;y>=0;y--)m[y]=[a(m[y][0]||0,n(x,v[y][b]))]}g[b]=[x]}return new s({data:g,size:[f,1]})}function d(u,h){h=l(u,h,!0);for(var m=h._data,f=u._size[0],p=u._size[1],g=u._values,v=u._index,b=u._ptr,_=[],x=p-1;x>=0;x--){var w=m[x][0]||0;if(o(w,0))_[x]=[0];else{for(var y=0,M=[],T=[],C=b[x],N=b[x+1],D=N-1;D>=C;D--){var k=v[D];k===x?y=g[D]:k<x&&(M.push(g[D]),T.push(k))}if(o(y,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var U=r(w,y),F=0,H=T.length;F<H;F++){var V=T[F];m[V]=[a(m[V][0],n(U,M[F]))]}_[x]=[U]}}return new s({data:_,size:[f,1]})}});var S6="usolveAll",the=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],RD=ie(S6,the,e=>{var{typed:t,matrix:i,divideScalar:r,multiplyScalar:n,subtractScalar:a,equalScalar:o,DenseMatrix:s}=e,l=hw({DenseMatrix:s});return t(S6,{"SparseMatrix, Array | Matrix":function(h,m){return d(h,m)},"DenseMatrix, Array | Matrix":function(h,m){return c(h,m)},"Array, Array | Matrix":function(h,m){var f=i(h),p=c(f,m);return p.map(g=>g.valueOf())}});function c(u,h){for(var m=[l(u,h,!0)._data.map(T=>T[0])],f=u._data,p=u._size[0],g=u._size[1],v=g-1;v>=0;v--)for(var b=m.length,_=0;_<b;_++){var x=m[_];if(o(f[v][v],0))if(o(x[v],0)){if(_===0){var y=[...x];y[v]=1;for(var M=v-1;M>=0;M--)y[M]=a(y[M],f[M][v]);m.push(y)}}else{if(_===0)return[];m.splice(_,1),_-=1,b-=1}else{x[v]=r(x[v],f[v][v]);for(var w=v-1;w>=0;w--)x[w]=a(x[w],n(x[v],f[w][v]))}}return m.map(T=>new s({data:T.map(C=>[C]),size:[p,1]}))}function d(u,h){for(var m=[l(u,h,!0)._data.map(we=>we[0])],f=u._size[0],p=u._size[1],g=u._values,v=u._index,b=u._ptr,_=p-1;_>=0;_--)for(var x=m.length,w=0;w<x;w++){for(var y=m[w],M=[],T=[],C=b[_],N=b[_+1],D=0,k=N-1;k>=C;k--){var U=v[k];U===_?D=g[k]:U<_&&(M.push(g[k]),T.push(U))}if(o(D,0))if(o(y[_],0)){if(w===0){var Q=[...y];Q[_]=1;for(var $=0,ee=T.length;$<ee;$++){var re=T[$];Q[re]=a(Q[re],M[$])}m.push(Q)}}else{if(w===0)return[];m.splice(w,1),w-=1,x-=1}else{y[_]=r(y[_],D);for(var F=0,H=T.length;F<H;F++){var V=T[F];y[V]=a(y[V],n(y[_],M[F]))}}}return m.map(we=>new s({data:we.map(te=>[te]),size:[f,1]}))}});var mw="equal",ihe=["typed","matrix","equalScalar","DenseMatrix","concat"],FD=ie(mw,ihe,e=>{var{typed:t,matrix:i,equalScalar:r,DenseMatrix:n,concat:a}=e,o=ts({typed:t}),s=il({typed:t,DenseMatrix:n}),l=es({typed:t,DenseMatrix:n}),c=Xa({typed:t,matrix:i,concat:a});return t(mw,rhe({typed:t,equalScalar:r}),c({elop:r,SS:s,DS:o,Ss:l}))}),rhe=ie(mw,["typed","equalScalar"],e=>{var{typed:t,equalScalar:i}=e;return t(mw,{"any, any":function(n,a){return n===null?a===null:a===null?n===null:n===void 0?a===void 0:a===void 0?n===void 0:i(n,a)}})});var pw="smaller",nhe=["typed","config","matrix","DenseMatrix","concat"],OD=ie(pw,nhe,e=>{var{typed:t,config:i,matrix:r,DenseMatrix:n,concat:a}=e,o=ts({typed:t}),s=il({typed:t,DenseMatrix:n}),l=es({typed:t,DenseMatrix:n}),c=Xa({typed:t,matrix:r,concat:a}),d=tl({typed:t});return t(pw,ahe({typed:t,config:i}),{"boolean, boolean":(u,h)=>u<h,"BigNumber, BigNumber":function(h,m){return h.lt(m)&&!Jo(h,m,i.relTol,i.absTol)},"bigint, bigint":(u,h)=>u<h,"Fraction, Fraction":(u,h)=>u.compare(h)===-1,"Complex, Complex":function(h,m){throw new TypeError("No ordering relation is defined for complex numbers")}},d,c({SS:s,DS:o,Ss:l}))}),ahe=ie(pw,["typed","config"],e=>{var{typed:t,config:i}=e;return t(pw,{"number, number":function(n,a){return n<a&&!Xn(n,a,i.relTol,i.absTol)}})});var fw="smallerEq",ohe=["typed","config","matrix","DenseMatrix","concat"],LD=ie(fw,ohe,e=>{var{typed:t,config:i,matrix:r,DenseMatrix:n,concat:a}=e,o=ts({typed:t}),s=il({typed:t,DenseMatrix:n}),l=es({typed:t,DenseMatrix:n}),c=Xa({typed:t,matrix:r,concat:a}),d=tl({typed:t});return t(fw,she({typed:t,config:i}),{"boolean, boolean":(u,h)=>u<=h,"BigNumber, BigNumber":function(h,m){return h.lte(m)||Jo(h,m,i.relTol,i.absTol)},"bigint, bigint":(u,h)=>u<=h,"Fraction, Fraction":(u,h)=>u.compare(h)!==1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},d,c({SS:s,DS:o,Ss:l}))}),she=ie(fw,["typed","config"],e=>{var{typed:t,config:i}=e;return t(fw,{"number, number":function(n,a){return n<=a||Xn(n,a,i.relTol,i.absTol)}})});var gw="larger",lhe=["typed","config","matrix","DenseMatrix","concat"],BD=ie(gw,lhe,e=>{var{typed:t,config:i,matrix:r,DenseMatrix:n,concat:a}=e,o=ts({typed:t}),s=il({typed:t,DenseMatrix:n}),l=es({typed:t,DenseMatrix:n}),c=Xa({typed:t,matrix:r,concat:a}),d=tl({typed:t});return t(gw,che({typed:t,config:i}),{"boolean, boolean":(u,h)=>u>h,"BigNumber, BigNumber":function(h,m){return h.gt(m)&&!Jo(h,m,i.relTol,i.absTol)},"bigint, bigint":(u,h)=>u>h,"Fraction, Fraction":(u,h)=>u.compare(h)===1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},d,c({SS:s,DS:o,Ss:l}))}),che=ie(gw,["typed","config"],e=>{var{typed:t,config:i}=e;return t(gw,{"number, number":function(n,a){return n>a&&!Xn(n,a,i.relTol,i.absTol)}})});var vw="largerEq",dhe=["typed","config","matrix","DenseMatrix","concat"],VD=ie(vw,dhe,e=>{var{typed:t,config:i,matrix:r,DenseMatrix:n,concat:a}=e,o=ts({typed:t}),s=il({typed:t,DenseMatrix:n}),l=es({typed:t,DenseMatrix:n}),c=Xa({typed:t,matrix:r,concat:a}),d=tl({typed:t});return t(vw,uhe({typed:t,config:i}),{"boolean, boolean":(u,h)=>u>=h,"BigNumber, BigNumber":function(h,m){return h.gte(m)||Jo(h,m,i.relTol,i.absTol)},"bigint, bigint":function(h,m){return h>=m},"Fraction, Fraction":(u,h)=>u.compare(h)!==-1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},d,c({SS:s,DS:o,Ss:l}))}),uhe=ie(vw,["typed","config"],e=>{var{typed:t,config:i}=e;return t(vw,{"number, number":function(n,a){return n>=a||Xn(n,a,i.relTol,i.absTol)}})});var hhe="ImmutableDenseMatrix",mhe=["smaller","DenseMatrix"],zD=ie(hhe,mhe,e=>{var{smaller:t,DenseMatrix:i}=e;function r(n,a){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(a&&!Dn(a))throw new Error("Invalid datatype: "+a);if(ui(n)||Fi(n)){var o=new i(n,a);this._data=o._data,this._size=o._size,this._datatype=o._datatype,this._min=null,this._max=null}else if(n&&Fi(n.data)&&Fi(n.size))this._data=n.data,this._size=n.size,this._datatype=n.datatype,this._min=typeof n.min<"u"?n.min:null,this._max=typeof n.max<"u"?n.max:null;else{if(n)throw new TypeError("Unsupported type of data ("+on(n)+")");this._data=[],this._size=[0],this._datatype=a,this._min=null,this._max=null}}return r.prototype=new i,r.prototype.type="ImmutableDenseMatrix",r.prototype.isImmutableDenseMatrix=!0,r.prototype.subset=function(n){switch(arguments.length){case 1:{var a=i.prototype.subset.call(this,n);return ui(a)?new r({data:a._data,size:a._size,datatype:a._datatype}):a}case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},r.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},r.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},r.prototype.clone=function(){return new r({data:Kt(this._data),size:Kt(this._size),datatype:this._datatype})},r.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.fromJSON=function(n){return new r(n)},r.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},r.prototype.min=function(){if(this._min===null){var n=null;this.forEach(function(a){(n===null||t(a,n))&&(n=a)}),this._min=n!==null?n:void 0}return this._min},r.prototype.max=function(){if(this._max===null){var n=null;this.forEach(function(a){(n===null||t(n,a))&&(n=a)}),this._max=n!==null?n:void 0}return this._max},r},{isClass:!0});var phe="Index",fhe=["ImmutableDenseMatrix","getMatrixDataType"],UD=ie(phe,fhe,e=>{var{ImmutableDenseMatrix:t,getMatrixDataType:i}=e;function r(a){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._sourceSize=[],this._isScalar=!0;for(var o=0,s=arguments.length;o<s;o++){var l=arguments[o],c=Fi(l),d=ui(l),u=null;if(Hy(l))this._dimensions.push(l),this._isScalar=!1;else if(c||d){var h=void 0;i(l)==="boolean"?(c&&(h=n(A6(l).valueOf())),d&&(h=n(A6(l._data).valueOf())),u=l.valueOf().length):h=n(l.valueOf()),this._dimensions.push(h);var m=h.size();(m.length!==1||m[0]!==1||u!==null)&&(this._isScalar=!1)}else if(typeof l=="number")this._dimensions.push(n([l]));else if(typeof l=="string")this._dimensions.push(l);else throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._sourceSize.push(u)}}r.prototype.type="Index",r.prototype.isIndex=!0;function n(a){for(var o=0,s=a.length;o<s;o++)if(typeof a[o]!="number"||!ai(a[o]))throw new TypeError("Index parameters must be positive integer numbers");return new t(a)}return r.prototype.clone=function(){var a=new r;return a._dimensions=Kt(this._dimensions),a._isScalar=this._isScalar,a._sourceSize=this._sourceSize,a},r.create=function(a){var o=new r;return r.apply(o,a),o},r.prototype.size=function(){for(var a=[],o=0,s=this._dimensions.length;o<s;o++){var l=this._dimensions[o];a[o]=typeof l=="string"?1:l.size()[0]}return a},r.prototype.max=function(){for(var a=[],o=0,s=this._dimensions.length;o<s;o++){var l=this._dimensions[o];a[o]=typeof l=="string"?l:l.max()}return a},r.prototype.min=function(){for(var a=[],o=0,s=this._dimensions.length;o<s;o++){var l=this._dimensions[o];a[o]=typeof l=="string"?l:l.min()}return a},r.prototype.forEach=function(a){for(var o=0,s=this._dimensions.length;o<s;o++)a(this._dimensions[o],o,this)},r.prototype.dimension=function(a){return this._dimensions[a]||null},r.prototype.isObjectProperty=function(){return this._dimensions.length===1&&typeof this._dimensions[0]=="string"},r.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},r.prototype.isScalar=function(){return this._isScalar},r.prototype.toArray=function(){for(var a=[],o=0,s=this._dimensions.length;o<s;o++){var l=this._dimensions[o];a.push(typeof l=="string"?l:l.toArray())}return a},r.prototype.valueOf=r.prototype.toArray,r.prototype.toString=function(){for(var a=[],o=0,s=this._dimensions.length;o<s;o++){var l=this._dimensions[o];typeof l=="string"?a.push(JSON.stringify(l)):a.push(l.toString())}return"["+a.join(", ")+"]"},r.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},r.fromJSON=function(a){return r.create(a.dimensions)},r},{isClass:!0});function A6(e){var t=[];return e.forEach((i,r)=>{i&&t.push(r)}),t}var ghe="atan",vhe=["typed"],HD=ie(ghe,vhe,e=>{var{typed:t}=e;return t("atan",{number:function(r){return Math.atan(r)},Complex:function(r){return r.atan()},BigNumber:function(r){return r.atan()}})});var _w=ie("trigUnit",["typed"],e=>{var{typed:t}=e;return{Unit:t.referToSelf(i=>r=>{if(!r.hasBase(r.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return t.find(i,r.valueType())(r.value)})}});var T6="cos",_he=["typed"],GD=ie(T6,_he,e=>{var{typed:t}=e,i=_w({typed:t});return t(T6,{number:Math.cos,"Complex | BigNumber":r=>r.cos()},i)});var D6="sin",bhe=["typed"],jD=ie(D6,bhe,e=>{var{typed:t}=e,i=_w({typed:t});return t(D6,{number:Math.sin,"Complex | BigNumber":r=>r.sin()},i)});var M6="add",xhe=["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],WD=ie(M6,xhe,e=>{var{typed:t,matrix:i,addScalar:r,equalScalar:n,DenseMatrix:a,SparseMatrix:o,concat:s}=e,l=lw({typed:t}),c=n6({typed:t,equalScalar:n}),d=cw({typed:t,DenseMatrix:a}),u=Xa({typed:t,matrix:i,concat:s});return t(M6,{"any, any":r,"any, any, ...any":t.referToSelf(h=>(m,f,p)=>{for(var g=h(m,f),v=0;v<p.length;v++)g=h(g,p[v]);return g})},u({elop:r,DS:l,SS:c,Ss:d}))});var I6="dot",yhe=["typed","addScalar","multiplyScalar","conj","size"],qD=ie(I6,yhe,e=>{var{typed:t,addScalar:i,multiplyScalar:r,conj:n,size:a}=e;return t(I6,{"Array | DenseMatrix, Array | DenseMatrix":s,"SparseMatrix, SparseMatrix":l});function o(d,u){var h=c(d),m=c(u),f,p;if(h.length===1)f=h[0];else if(h.length===2&&h[1]===1)f=h[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+h.join(", ")+")");if(m.length===1)p=m[0];else if(m.length===2&&m[1]===1)p=m[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+m.join(", ")+")");if(f!==p)throw new RangeError("Vectors must have equal length ("+f+" != "+p+")");if(f===0)throw new RangeError("Cannot calculate the dot product of empty vectors");return f}function s(d,u){var h=o(d,u),m=ui(d)?d._data:d,f=ui(d)?d._datatype||d.getDataType():void 0,p=ui(u)?u._data:u,g=ui(u)?u._datatype||u.getDataType():void 0,v=c(d).length===2,b=c(u).length===2,_=i,x=r;if(f&&g&&f===g&&typeof f=="string"&&f!=="mixed"){var w=f;_=t.find(i,[w,w]),x=t.find(r,[w,w])}if(!v&&!b){for(var y=x(n(m[0]),p[0]),M=1;M<h;M++)y=_(y,x(n(m[M]),p[M]));return y}if(!v&&b){for(var T=x(n(m[0]),p[0][0]),C=1;C<h;C++)T=_(T,x(n(m[C]),p[C][0]));return T}if(v&&!b){for(var N=x(n(m[0][0]),p[0]),D=1;D<h;D++)N=_(N,x(n(m[D][0]),p[D]));return N}if(v&&b){for(var k=x(n(m[0][0]),p[0][0]),U=1;U<h;U++)k=_(k,x(n(m[U][0]),p[U][0]));return k}}function l(d,u){o(d,u);for(var h=d._index,m=d._values,f=u._index,p=u._values,g=0,v=i,b=r,_=0,x=0;_<h.length&&x<f.length;){var w=h[_],y=f[x];if(w<y){_++;continue}if(w>y){x++;continue}w===y&&(g=v(g,b(m[_],p[x])),_++,x++)}return g}function c(d){return ui(d)?d.size():a(d)}});var k6="qr",whe=["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtractScalar","complex"],$D=ie(k6,whe,e=>{var{typed:t,matrix:i,zeros:r,identity:n,isZero:a,equal:o,sign:s,sqrt:l,conj:c,unaryMinus:d,addScalar:u,divideScalar:h,multiplyScalar:m,subtractScalar:f,complex:p}=e;return Js(t(k6,{DenseMatrix:function(x){return v(x)},SparseMatrix:function(x){return b(x)},Array:function(x){var w=i(x),y=v(w);return{Q:y.Q.valueOf(),R:y.R.valueOf()}}}),{_denseQRimpl:g});function g(_){var x=_._size[0],w=_._size[1],y=n([x],"dense"),M=y._data,T=_.clone(),C=T._data,N,D,k,U=r([x],"");for(k=0;k<Math.min(w,x);++k){var F=C[k][k],H=d(o(F,0)?1:s(F)),V=c(H),Q=0;for(N=k;N<x;N++)Q=u(Q,m(C[N][k],c(C[N][k])));var $=m(H,l(Q));if(!a($)){var ee=f(F,$);for(U[k]=1,N=k+1;N<x;N++)U[N]=h(C[N][k],ee);var re=d(c(h(ee,$))),we=void 0;for(D=k;D<w;D++){for(we=0,N=k;N<x;N++)we=u(we,m(c(U[N]),C[N][D]));for(we=m(we,re),N=k;N<x;N++)C[N][D]=m(f(C[N][D],m(U[N],we)),V)}for(N=0;N<x;N++){for(we=0,D=k;D<x;D++)we=u(we,m(M[N][D],U[D]));for(we=m(we,re),D=k;D<x;++D)M[N][D]=h(f(M[N][D],m(we,c(U[D]))),V)}}}return{Q:y,R:T,toString:function(){return"Q: "+this.Q.toString()+`
R: `+this.R.toString()}}}function v(_){var x=g(_),w=x.R._data;if(_._data.length>0)for(var y=w[0][0].type==="Complex"?p(0):0,M=0;M<w.length;++M)for(var T=0;T<M&&T<(w[0]||[]).length;++T)w[M][T]=y;return x}function b(_){throw new Error("qr not implemented for sparse matrices yet")}});var N6="det",Che=["typed","matrix","subtractScalar","multiply","divideScalar","isZero","unaryMinus"],XD=ie(N6,Che,e=>{var{typed:t,matrix:i,subtractScalar:r,multiply:n,divideScalar:a,isZero:o,unaryMinus:s}=e;return t(N6,{any:function(d){return Kt(d)},"Array | Matrix":function(d){var u;switch(ui(d)?u=d.size():Array.isArray(d)?(d=i(d),u=d.size()):u=[],u.length){case 0:return Kt(d);case 1:if(u[0]===1)return Kt(d.valueOf()[0]);if(u[0]===0)return 1;throw new RangeError("Matrix must be square (size: "+Ti(u)+")");case 2:{var h=u[0],m=u[1];if(h===m)return l(d.clone().valueOf(),h,m);if(m===0)return 1;throw new RangeError("Matrix must be square (size: "+Ti(u)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+Ti(u)+")")}}});function l(c,d,u){if(d===1)return Kt(c[0][0]);if(d===2)return r(n(c[0][0],c[1][1]),n(c[1][0],c[0][1]));for(var h=!1,m=new Array(d).fill(0).map((M,T)=>T),f=0;f<d;f++){var p=m[f];if(o(c[p][f])){var g=void 0;for(g=f+1;g<d;g++)if(!o(c[m[g]][f])){p=m[g],m[g]=m[f],m[f]=p,h=!h;break}if(g===d)return c[p][f]}for(var v=c[p][f],b=f===0?1:c[m[f-1]][f-1],_=f+1;_<d;_++)for(var x=m[_],w=f+1;w<d;w++)c[x][w]=a(r(n(c[x][w],v),n(c[x][f],c[p][w])),b)}var y=c[m[d-1]][d-1];return h?s(y):y}});var P6="inv",Ehe=["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],YD=ie(P6,Ehe,e=>{var{typed:t,matrix:i,divideScalar:r,addScalar:n,multiply:a,unaryMinus:o,det:s,identity:l,abs:c}=e;return t(P6,{"Array | Matrix":function(h){var m=ui(h)?h.size():Li(h);switch(m.length){case 1:if(m[0]===1)return ui(h)?i([r(1,h.valueOf()[0])]):[r(1,h[0])];throw new RangeError("Matrix must be square (size: "+Ti(m)+")");case 2:{var f=m[0],p=m[1];if(f===p)return ui(h)?i(d(h.valueOf(),f,p),h.storage()):d(h,f,p);throw new RangeError("Matrix must be square (size: "+Ti(m)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+Ti(m)+")")}},any:function(h){return r(1,h)}});function d(u,h,m){var f,p,g,v,b;if(h===1){if(v=u[0][0],v===0)throw Error("Cannot calculate inverse, determinant is zero");return[[r(1,v)]]}else if(h===2){var _=s(u);if(_===0)throw Error("Cannot calculate inverse, determinant is zero");return[[r(u[1][1],_),r(o(u[0][1]),_)],[r(o(u[1][0]),_),r(u[0][0],_)]]}else{var x=u.concat();for(f=0;f<h;f++)x[f]=x[f].concat();for(var w=l(h).valueOf(),y=0;y<m;y++){var M=c(x[y][y]),T=y;for(f=y+1;f<h;)c(x[f][y])>M&&(M=c(x[f][y]),T=f),f++;if(M===0)throw Error("Cannot calculate inverse, determinant is zero");f=T,f!==y&&(b=x[y],x[y]=x[f],x[f]=b,b=w[y],w[y]=w[f],w[f]=b);var C=x[y],N=w[y];for(f=0;f<h;f++){var D=x[f],k=w[f];if(f!==y){if(D[y]!==0){for(g=r(o(D[y]),C[y]),p=y;p<m;p++)D[p]=n(D[p],a(g,C[p]));for(p=0;p<m;p++)k[p]=n(k[p],a(g,N[p]))}}else{for(g=C[y],p=y;p<m;p++)D[p]=r(D[p],g);for(p=0;p<m;p++)k[p]=r(k[p],g)}}}return w}}});function R6(e){var{addScalar:t,subtract:i,flatten:r,multiply:n,multiplyScalar:a,divideScalar:o,sqrt:s,abs:l,bignumber:c,diag:d,size:u,reshape:h,inv:m,qr:f,usolve:p,usolveAll:g,equal:v,complex:b,larger:_,smaller:x,matrixFromColumns:w,dot:y}=e;function M(te,oe,pe,ue){var _e=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,ce=T(te,oe,pe,ue,_e);C(te,oe,pe,ue,_e,ce);var{values:fe,C:be}=N(te,oe,pe,ue,_e);if(_e){var ge=D(te,oe,be,ce,fe,pe,ue);return{values:fe,eigenvectors:ge}}return{values:fe}}function T(te,oe,pe,ue,_e){var ce=ue==="BigNumber",fe=ue==="Complex",be=ce?c(0):0,ge=ce?c(1):fe?b(1):1,Oe=ce?c(1):1,De=ce?c(10):2,$e=a(De,De),_t;_e&&(_t=Array(oe).fill(ge));for(var st=!1;!st;){st=!0;for(var jt=0;jt<oe;jt++){for(var Di=be,Bi=be,fr=0;fr<oe;fr++)jt!==fr&&(Di=t(Di,l(te[fr][jt])),Bi=t(Bi,l(te[jt][fr])));if(!v(Di,0)&&!v(Bi,0)){for(var Vi=Oe,Wi=Di,In=o(Bi,De),kn=a(Bi,De);x(Wi,In);)Wi=a(Wi,$e),Vi=a(Vi,De);for(;_(Wi,kn);)Wi=o(Wi,$e),Vi=o(Vi,De);var Gr=x(o(t(Wi,Bi),Vi),a(t(Di,Bi),.95));if(Gr){st=!1;for(var ol=o(1,Vi),_a=0;_a<oe;_a++)jt!==_a&&(te[jt][_a]=a(te[jt][_a],ol),te[_a][jt]=a(te[_a][jt],Vi));_e&&(_t[jt]=a(_t[jt],ol))}}}}return _e?d(_t):null}function C(te,oe,pe,ue,_e,ce){var fe=ue==="BigNumber",be=ue==="Complex",ge=fe?c(0):be?b(0):0;fe&&(pe=c(pe));for(var Oe=0;Oe<oe-2;Oe++){for(var De=0,$e=ge,_t=Oe+1;_t<oe;_t++){var st=te[_t][Oe];x(l($e),l(st))&&($e=st,De=_t)}if(!x(l($e),pe)){if(De!==Oe+1){var jt=te[De];te[De]=te[Oe+1],te[Oe+1]=jt;for(var Di=0;Di<oe;Di++){var Bi=te[Di][De];te[Di][De]=te[Di][Oe+1],te[Di][Oe+1]=Bi}if(_e){var fr=ce[De];ce[De]=ce[Oe+1],ce[Oe+1]=fr}}for(var Vi=Oe+2;Vi<oe;Vi++){var Wi=o(te[Vi][Oe],$e);if(Wi!==0){for(var In=0;In<oe;In++)te[Vi][In]=i(te[Vi][In],a(Wi,te[Oe+1][In]));for(var kn=0;kn<oe;kn++)te[kn][Oe+1]=t(te[kn][Oe+1],a(Wi,te[kn][Vi]));if(_e)for(var Gr=0;Gr<oe;Gr++)ce[Vi][Gr]=i(ce[Vi][Gr],a(Wi,ce[Oe+1][Gr]))}}}}return ce}function N(te,oe,pe,ue,_e){var ce=ue==="BigNumber",fe=ue==="Complex",be=ce?c(1):fe?b(1):1;ce&&(pe=c(pe));for(var ge=Kt(te),Oe=[],De=oe,$e=[],_t=_e?d(Array(oe).fill(be)):void 0,st=_e?d(Array(De).fill(be)):void 0,jt=0;jt<=100;){jt+=1;for(var Di=ge[De-1][De-1],Bi=0;Bi<De;Bi++)ge[Bi][Bi]=i(ge[Bi][Bi],Di);var{Q:fr,R:Vi}=f(ge);ge=n(Vi,fr);for(var Wi=0;Wi<De;Wi++)ge[Wi][Wi]=t(ge[Wi][Wi],Di);if(_e&&(st=n(st,fr)),De===1||x(l(ge[De-1][De-2]),pe)){jt=0,Oe.push(ge[De-1][De-1]),_e&&($e.unshift([[1]]),F(st,oe),_t=n(_t,st),De>1&&(st=d(Array(De-1).fill(be)))),De-=1,ge.pop();for(var In=0;In<De;In++)ge[In].pop()}else if(De===2||x(l(ge[De-2][De-3]),pe)){jt=0;var kn=k(ge[De-2][De-2],ge[De-2][De-1],ge[De-1][De-2],ge[De-1][De-1]);Oe.push(...kn),_e&&($e.unshift(U(ge[De-2][De-2],ge[De-2][De-1],ge[De-1][De-2],ge[De-1][De-1],kn[0],kn[1],pe,ue)),F(st,oe),_t=n(_t,st),De>2&&(st=d(Array(De-2).fill(be)))),De-=2,ge.pop(),ge.pop();for(var Gr=0;Gr<De;Gr++)ge[Gr].pop(),ge[Gr].pop()}if(De===0)break}if(Oe.sort((th,wo)=>+i(l(th),l(wo))),jt>100){var ol=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+Oe.join(", "));throw ol.values=Oe,ol.vectors=[],ol}var _a=_e?n(_t,H($e,oe)):void 0;return{values:Oe,C:_a}}function D(te,oe,pe,ue,_e,ce,fe){var be=m(pe),ge=n(be,te,pe),Oe=fe==="BigNumber",De=fe==="Complex",$e=Oe?c(0):De?b(0):0,_t=Oe?c(1):De?b(1):1,st=[],jt=[];for(var Di of _e){var Bi=V(st,Di,v);Bi===-1?(st.push(Di),jt.push(1)):jt[Bi]+=1}for(var fr=[],Vi=st.length,Wi=Array(oe).fill($e),In=d(Array(oe).fill(_t)),kn=function(){var _a=st[Gr],th=i(ge,n(_a,In)),wo=g(th,Wi);for(wo.shift();wo.length<jt[Gr];){var B=Q(th,oe,wo,ce,fe);if(B===null)break;wo.push(B)}var K=n(m(ue),pe);wo=wo.map(ne=>n(K,ne)),fr.push(...wo.map(ne=>({value:_a,vector:r(ne)})))},Gr=0;Gr<Vi;Gr++)kn();return fr}function k(te,oe,pe,ue){var _e=t(te,ue),ce=i(a(te,ue),a(oe,pe)),fe=a(_e,.5),be=a(s(i(a(_e,_e),a(4,ce))),.5);return[t(fe,be),i(fe,be)]}function U(te,oe,pe,ue,_e,ce,fe,be){var ge=be==="BigNumber",Oe=be==="Complex",De=ge?c(0):Oe?b(0):0,$e=ge?c(1):Oe?b(1):1;if(x(l(pe),fe))return[[$e,De],[De,$e]];if(_(l(i(_e,ce)),fe))return[[i(_e,ue),i(ce,ue)],[pe,pe]];var _t=i(te,_e),st=i(ue,_e);return x(l(oe),fe)&&x(l(st),fe)?[[_t,$e],[pe,De]]:[[oe,De],[st,$e]]}function F(te,oe){for(var pe=0;pe<te.length;pe++)te[pe].push(...Array(oe-te[pe].length).fill(0));for(var ue=te.length;ue<oe;ue++)te.push(Array(oe).fill(0)),te[ue][ue]=1;return te}function H(te,oe){for(var pe=[],ue=0;ue<oe;ue++)pe[ue]=Array(oe).fill(0);var _e=0;for(var ce of te){for(var fe=ce.length,be=0;be<fe;be++)for(var ge=0;ge<fe;ge++)pe[_e+be][_e+ge]=ce[be][ge];_e+=fe}return pe}function V(te,oe,pe){for(var ue=0;ue<te.length;ue++)if(pe(te[ue],oe))return ue;return-1}function Q(te,oe,pe,ue,_e){for(var ce=_e==="BigNumber"?c(1e3):1e3,fe,be=0;be<5;++be){fe=$(oe,pe,_e);try{fe=p(te,fe)}catch{continue}if(_(re(fe),ce))break}if(be>=5)return null;for(be=0;;){var ge=p(te,fe);if(x(re(ee(fe,[ge])),ue))break;if(++be>=10)return null;fe=we(ge)}return fe}function $(te,oe,pe){var ue=pe==="BigNumber",_e=pe==="Complex",ce=Array(te).fill(0).map(fe=>2*Math.random()-1);return ue&&(ce=ce.map(fe=>c(fe))),_e&&(ce=ce.map(fe=>b(fe))),ce=ee(ce,oe),we(ce,pe)}function ee(te,oe){var pe=u(te);for(var ue of oe)ue=h(ue,pe),te=i(te,n(o(y(ue,te),y(ue,ue)),ue));return te}function re(te){return l(s(y(te,te)))}function we(te,oe){var pe=oe==="BigNumber",ue=oe==="Complex",_e=pe?c(1):ue?b(1):1;return n(o(_e,re(te)),te)}return M}function F6(e){var{config:t,addScalar:i,subtract:r,abs:n,atan:a,cos:o,sin:s,multiplyScalar:l,inv:c,bignumber:d,multiply:u,add:h}=e;function m(C,N){var D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.relTol,k=arguments.length>3?arguments[3]:void 0,U=arguments.length>4?arguments[4]:void 0;if(k==="number")return f(C,D,U);if(k==="BigNumber")return p(C,D,U);throw TypeError("Unsupported data type: "+k)}function f(C,N,D){var k=C.length,U=Math.abs(N/k),F,H;if(D){H=new Array(k);for(var V=0;V<k;V++)H[V]=Array(k).fill(0),H[V][V]=1}for(var Q=y(C);Math.abs(Q[1])>=Math.abs(U);){var $=Q[0][0],ee=Q[0][1];F=g(C[$][$],C[ee][ee],C[$][ee]),C=w(C,F,$,ee),D&&(H=b(H,F,$,ee)),Q=y(C)}for(var re=Array(k).fill(0),we=0;we<k;we++)re[we]=C[we][we];return T(Kt(re),H,D)}function p(C,N,D){var k=C.length,U=n(N/k),F,H;if(D){H=new Array(k);for(var V=0;V<k;V++)H[V]=Array(k).fill(0),H[V][V]=1}for(var Q=M(C);n(Q[1])>=n(U);){var $=Q[0][0],ee=Q[0][1];F=v(C[$][$],C[ee][ee],C[$][ee]),C=x(C,F,$,ee),D&&(H=_(H,F,$,ee)),Q=M(C)}for(var re=Array(k).fill(0),we=0;we<k;we++)re[we]=C[we][we];return T(Kt(re),H,D)}function g(C,N,D){var k=N-C;return Math.abs(k)<=t.relTol?Math.PI/4:.5*Math.atan(2*D/(N-C))}function v(C,N,D){var k=r(N,C);return n(k)<=t.relTol?d(-1).acos().div(4):l(.5,a(u(2,D,c(k))))}function b(C,N,D,k){for(var U=C.length,F=Math.cos(N),H=Math.sin(N),V=Array(U).fill(0),Q=Array(U).fill(0),$=0;$<U;$++)V[$]=F*C[$][D]-H*C[$][k],Q[$]=H*C[$][D]+F*C[$][k];for(var ee=0;ee<U;ee++)C[ee][D]=V[ee],C[ee][k]=Q[ee];return C}function _(C,N,D,k){for(var U=C.length,F=o(N),H=s(N),V=Array(U).fill(d(0)),Q=Array(U).fill(d(0)),$=0;$<U;$++)V[$]=r(l(F,C[$][D]),l(H,C[$][k])),Q[$]=i(l(H,C[$][D]),l(F,C[$][k]));for(var ee=0;ee<U;ee++)C[ee][D]=V[ee],C[ee][k]=Q[ee];return C}function x(C,N,D,k){for(var U=C.length,F=d(o(N)),H=d(s(N)),V=l(F,F),Q=l(H,H),$=Array(U).fill(d(0)),ee=Array(U).fill(d(0)),re=u(d(2),F,H,C[D][k]),we=i(r(l(V,C[D][D]),re),l(Q,C[k][k])),te=h(l(Q,C[D][D]),re,l(V,C[k][k])),oe=0;oe<U;oe++)$[oe]=r(l(F,C[D][oe]),l(H,C[k][oe])),ee[oe]=i(l(H,C[D][oe]),l(F,C[k][oe]));C[D][D]=we,C[k][k]=te,C[D][k]=d(0),C[k][D]=d(0);for(var pe=0;pe<U;pe++)pe!==D&&pe!==k&&(C[D][pe]=$[pe],C[pe][D]=$[pe],C[k][pe]=ee[pe],C[pe][k]=ee[pe]);return C}function w(C,N,D,k){for(var U=C.length,F=Math.cos(N),H=Math.sin(N),V=F*F,Q=H*H,$=Array(U).fill(0),ee=Array(U).fill(0),re=V*C[D][D]-2*F*H*C[D][k]+Q*C[k][k],we=Q*C[D][D]+2*F*H*C[D][k]+V*C[k][k],te=0;te<U;te++)$[te]=F*C[D][te]-H*C[k][te],ee[te]=H*C[D][te]+F*C[k][te];C[D][D]=re,C[k][k]=we,C[D][k]=0,C[k][D]=0;for(var oe=0;oe<U;oe++)oe!==D&&oe!==k&&(C[D][oe]=$[oe],C[oe][D]=$[oe],C[k][oe]=ee[oe],C[oe][k]=ee[oe]);return C}function y(C){for(var N=C.length,D=0,k=[0,1],U=0;U<N;U++)for(var F=U+1;F<N;F++)Math.abs(D)<Math.abs(C[U][F])&&(D=Math.abs(C[U][F]),k=[U,F]);return[k,D]}function M(C){for(var N=C.length,D=0,k=[0,1],U=0;U<N;U++)for(var F=U+1;F<N;F++)n(D)<n(C[U][F])&&(D=n(C[U][F]),k=[U,F]);return[k,D]}function T(C,N,D){var k=C.length,U=Array(k),F;if(D){F=Array(k);for(var H=0;H<k;H++)F[H]=Array(k)}for(var V=0;V<k;V++){for(var Q=0,$=C[0],ee=0;ee<C.length;ee++)n(C[ee])<n($)&&(Q=ee,$=C[Q]);if(U[V]=C.splice(Q,1)[0],D)for(var re=0;re<k;re++)F[V][re]=N[re][Q],N[re].splice(Q,1)}if(!D)return{values:U};var we=F.map((te,oe)=>({value:U[oe],vector:te}));return{values:U,eigenvectors:we}}return m}var She="eigs",Ahe=["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","size","reshape","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],ZD=ie(She,Ahe,e=>{var{config:t,typed:i,matrix:r,addScalar:n,subtract:a,equal:o,abs:s,atan:l,cos:c,sin:d,multiplyScalar:u,divideScalar:h,inv:m,bignumber:f,multiply:p,add:g,larger:v,column:b,flatten:_,number:x,complex:w,sqrt:y,diag:M,size:T,reshape:C,qr:N,usolve:D,usolveAll:k,im:U,re:F,smaller:H,matrixFromColumns:V,dot:Q}=e,$=F6({config:t,addScalar:n,subtract:a,column:b,flatten:_,equal:o,abs:s,atan:l,cos:c,sin:d,multiplyScalar:u,inv:m,bignumber:f,complex:w,multiply:p,add:g}),ee=R6({config:t,addScalar:n,subtract:a,multiply:p,multiplyScalar:u,flatten:_,divideScalar:h,sqrt:y,abs:s,bignumber:f,diag:M,size:T,reshape:C,qr:N,inv:m,usolve:D,usolveAll:k,equal:o,complex:w,larger:v,smaller:H,matrixFromColumns:V,dot:Q});return i("eigs",{Array:function(ce){return re(r(ce))},"Array, number|BigNumber":function(ce,fe){return re(r(ce),{precision:fe})},"Array, Object"(_e,ce){return re(r(_e),ce)},Matrix:function(ce){return re(ce,{matricize:!0})},"Matrix, number|BigNumber":function(ce,fe){return re(ce,{precision:fe,matricize:!0})},"Matrix, Object":function(ce,fe){var be={matricize:!0};return Js(be,fe),re(ce,be)}});function re(_e){var ce,fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},be="eigenvectors"in fe?fe.eigenvectors:!0,ge=(ce=fe.precision)!==null&&ce!==void 0?ce:t.relTol,Oe=we(_e,ge,be);return fe.matricize&&(Oe.values=r(Oe.values),be&&(Oe.eigenvectors=Oe.eigenvectors.map(De=>{var{value:$e,vector:_t}=De;return{value:$e,vector:r(_t)}}))),be&&Object.defineProperty(Oe,"vectors",{enumerable:!1,get:()=>{throw new Error("eigs(M).vectors replaced with eigs(M).eigenvectors")}}),Oe}function we(_e,ce,fe){var be=_e.toArray(),ge=_e.size();if(ge.length!==2||ge[0]!==ge[1])throw new RangeError("Matrix must be square (size: ".concat(Ti(ge),")"));var Oe=ge[0];if(oe(be,Oe,ce)&&(pe(be,Oe),te(be,Oe,ce))){var De=ue(_e,be,Oe);return $(be,Oe,ce,De,fe)}var $e=ue(_e,be,Oe);return ee(be,Oe,ce,$e,fe)}function te(_e,ce,fe){for(var be=0;be<ce;be++)for(var ge=be;ge<ce;ge++)if(v(f(s(a(_e[be][ge],_e[ge][be]))),fe))return!1;return!0}function oe(_e,ce,fe){for(var be=0;be<ce;be++)for(var ge=0;ge<ce;ge++)if(v(f(s(U(_e[be][ge]))),fe))return!1;return!0}function pe(_e,ce){for(var fe=0;fe<ce;fe++)for(var be=0;be<ce;be++)_e[fe][be]=F(_e[fe][be])}function ue(_e,ce,fe){var be=_e.datatype();if(be==="number"||be==="BigNumber"||be==="Complex")return be;for(var ge=!1,Oe=!1,De=!1,$e=0;$e<fe;$e++)for(var _t=0;_t<fe;_t++){var st=ce[$e][_t];if(xi(st)||wv(st))ge=!0;else if(Ei(st))Oe=!0;else if(yv(st))De=!0;else throw TypeError("Unsupported type in Matrix: "+on(st))}if(Oe&&De&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),De){for(var jt=0;jt<fe;jt++)for(var Di=0;Di<fe;Di++)ce[jt][Di]=w(ce[jt][Di]);return"Complex"}if(Oe){for(var Bi=0;Bi<fe;Bi++)for(var fr=0;fr<fe;fr++)ce[Bi][fr]=f(ce[Bi][fr]);return"BigNumber"}if(ge){for(var Vi=0;Vi<fe;Vi++)for(var Wi=0;Wi<fe;Wi++)ce[Vi][Wi]=x(ce[Vi][Wi]);return"number"}else throw TypeError("Matrix contains unsupported types only.")}});var Iv=NT({config:va}),KD=RT({});var QD=OT({});var JD=LT({});var Ya=jT({Matrix:JD});var It=ET({BigNumber:Iv,Complex:KD,DenseMatrix:Ya,Fraction:QD});var O6=cD({typed:It});var yp=dD({typed:It});var The=HD({typed:It});var eM=nD({Complex:KD,typed:It}),L6=vD({typed:It}),Dhe=GD({typed:It});var md=eD({config:va,typed:It});var B6=CD({typed:It});var Mhe=ED({typed:It});var Ihe=_D({typed:It}),V6=WT({typed:It});var khe=QT({config:va,typed:It}),z6=JT({equalScalar:md,typed:It});var wp=hD({typed:It});var U6=iD({typed:It});var Nhe=bD({typed:It});var Phe=pD({BigNumber:Iv,Fraction:QD,complex:eM,typed:It}),Rhe=jD({typed:It}),bw=tD({Matrix:JD,equalScalar:md,typed:It});var kv=uD({typed:It});var tM=rD({BigNumber:Iv,typed:It});var H6=fD({Complex:KD,config:va,typed:It});var xw=lD({typed:It});var Fhe=aD({Fraction:QD,typed:It});var pr=oD({DenseMatrix:Ya,Matrix:JD,SparseMatrix:bw,typed:It});var Ohe=kD({bignumber:tM,fraction:Fhe,number:U6});var Lhe=TD({isInteger:V6,matrix:pr,typed:It}),iM=DD({matrix:pr,config:va,typed:It}),G6=MD({matrix:pr,typed:It});var Bhe=ID({BigNumber:Iv,config:va,matrix:pr,typed:It});var Ju=xD({isInteger:V6,matrix:pr,typed:It});var Vhe=wD({DenseMatrix:Ya,SparseMatrix:bw,matrix:pr,typed:It}),Cp=ND({numeric:Ohe,typed:It});var j6=FD({DenseMatrix:Ya,concat:Ju,equalScalar:md,matrix:pr,typed:It});var W6=SD({BigNumber:Iv,DenseMatrix:Ya,SparseMatrix:bw,config:va,matrix:pr,typed:It});var zhe=VD({DenseMatrix:Ya,concat:Ju,config:va,matrix:pr,typed:It});var Uhe=sD({flatten:B6,matrix:pr,size:iM,typed:It});var Hhe=$D({addScalar:yp,complex:eM,conj:L6,divideScalar:Cp,equal:j6,identity:W6,isZero:z6,matrix:pr,multiplyScalar:wp,sign:Phe,sqrt:H6,subtractScalar:kv,typed:It,unaryMinus:xw,zeros:Bhe});var rM=OD({DenseMatrix:Ya,concat:Ju,config:va,matrix:pr,typed:It}),Ghe=gD({DenseMatrix:Ya,concat:Ju,equalScalar:md,matrix:pr,subtractScalar:kv,typed:It,unaryMinus:xw});var jhe=PD({DenseMatrix:Ya,divideScalar:Cp,equalScalar:md,matrix:pr,multiplyScalar:wp,subtractScalar:kv,typed:It});var q6=WD({DenseMatrix:Ya,SparseMatrix:bw,addScalar:yp,concat:Ju,equalScalar:md,matrix:pr,typed:It});var $6=qD({addScalar:yp,conj:L6,multiplyScalar:wp,size:iM,typed:It});var Whe=zD({DenseMatrix:Ya,smaller:rM}),qhe=UD({ImmutableDenseMatrix:Whe,getMatrixDataType:Mhe}),X6=BD({DenseMatrix:Ya,concat:Ju,config:va,matrix:pr,typed:It});var Ep=mD({addScalar:yp,dot:$6,equalScalar:md,matrix:pr,multiplyScalar:wp,typed:It});var $he=RD({DenseMatrix:Ya,divideScalar:Cp,equalScalar:md,matrix:pr,multiplyScalar:wp,subtractScalar:kv,typed:It});var Xhe=XD({divideScalar:Cp,isZero:z6,matrix:pr,multiply:Ep,subtractScalar:kv,typed:It,unaryMinus:xw});var Yhe=LD({DenseMatrix:Ya,concat:Ju,config:va,matrix:pr,typed:It});var Zhe=AD({bignumber:tM,matrix:pr,add:q6,config:va,isPositive:khe,larger:X6,largerEq:zhe,smaller:rM,smallerEq:Yhe,typed:It});var Khe=yD({Index:qhe,matrix:pr,range:Zhe,typed:It}),Qhe=YD({abs:O6,addScalar:yp,det:Xhe,divideScalar:Cp,identity:W6,matrix:pr,multiply:Ep,typed:It,unaryMinus:xw});var Y6=ZD({abs:O6,add:q6,addScalar:yp,atan:The,bignumber:tM,column:Khe,complex:eM,config:va,cos:Dhe,diag:Vhe,divideScalar:Cp,dot:$6,equal:j6,flatten:B6,im:Ihe,inv:Qhe,larger:X6,matrix:pr,matrixFromColumns:Uhe,multiply:Ep,multiplyScalar:wp,number:U6,qr:Hhe,re:Nhe,reshape:Lhe,sin:Rhe,size:iM,smaller:rM,sqrt:H6,subtract:Ghe,typed:It,usolve:jhe,usolveAll:$he});function Z6(e){let t=e.length,i=e[0].length;if(t!=2||i!=2)throw new Error("Only 2x2 matrices are supported for MMt_solution");let r=fT(e,gT(e)),n=Jhe(r),a=n.vectors,o=[[Math.sqrt(n.values[0]),0],[0,Math.sqrt(n.values[1])]];return fT(gT(a),o)}function Jhe(e){let t=e.length,i=new Array(t).fill(0).map(()=>new Array(t).fill(0)),r=1,n=-1*(e[0][0]+e[1][1]),a=e[0][0]*e[1][1]-e[0][1]*e[1][0],o=Math.sqrt(n*n-4*r*a),s=(-n+o)/(2*r),l=(-n-o)/(2*r);e[0][0]-s==0||e[0][0]-l==0?(i[0]=[1,-e[1][0]/(e[1][1]-s)],i[1]=[1,-e[1][0]/(e[1][1]-l)]):(i[0]=[-e[0][1]/(e[0][0]-s),1],i[1]=[-e[0][1]/(e[0][0]-l),1]);let c=Math.sqrt(i[0][0]**2+i[0][1]**2),d=Math.sqrt(i[1][0]**2+i[1][1]**2);return i[0]=[i[0][0]/c,i[0][1]/c],i[1]=[i[1][0]/d,i[1][1]/d],s>l?{values:[s,l],vectors:i}:{values:[l,s],vectors:[i[1],i[0]]}}function K6(e){let t=e.length,i=e[0].length,r=new Array(i).fill(0);e.forEach(h=>{h.forEach((m,f)=>{r[f]+=m})}),r=r.map(h=>h/t);let n=e.map(h=>h.map((m,f)=>m-r[f])),a=pr(n),o=Ep(G6(a),a),l=Y6(o).eigenvectors,c=new Array;for(let h=0;h<l.length;h++)c.push(l[h].vector.valueOf());let d=new Array(t);for(let h=0;h<t;h++)d[h]=Ep(c,n[h]).valueOf();let u=new Array(i).fill(0);d.forEach(h=>{h.forEach((m,f)=>{u[f]+=m**2})}),u=u.map(h=>h/t),u=u.map(h=>h);for(let h=0;h<i;h++)for(let m=0;m<i;m++)c[h][m]*=u[h];return{data:d,mean:r,U:c}}function eme(e,t){let i=e.length;for(let n=0;n<i;n++){let a=n;for(let o=n+1;o<i;o++)Math.abs(e[o][n])>Math.abs(e[a][n])&&(a=o);[e[n],e[a]]=[e[a],e[n]],[t[n],t[a]]=[t[a],t[n]];for(let o=n+1;o<i;o++){let s=e[o][n]/e[n][n];for(let l=n;l<i;l++)e[o][l]-=s*e[n][l];t[o]-=s*t[n]}}let r=new Array(i).fill(0);for(let n=i-1;n>=0;n--){let a=t[n];for(let o=n+1;o<i;o++)a-=e[n][o]*r[o];r[n]=a/e[n][n]}return r}function Q6(e,t,i){let r=e.length,n=i,a=[],o=[];for(let l=0;l<=n;l++){a[l]=[];for(let d=0;d<=n;d++){let u=0;for(let h=0;h<r;h++)u+=Math.pow(e[h],l+d);a[l][d]=u}let c=0;for(let d=0;d<r;d++)c+=t[d]*Math.pow(e[d],l);o[l]=c}return eme(a,o)}function Sp(e=0,t=1){let i=1-Math.random(),r=Math.random();return Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*r)*t+e}function eh(e,t={x:0,y:0},i={x:1,y:1}){let r=new Array(e);if(i instanceof Array){if(i[1][0]===0)for(let n=0;n<e;n++)r[n]={x:Sp(t.x,i[0][0]),y:Sp(t.y,i[1][1])};else{let n=Z6(i);for(let a=0;a<e;a++){let o=Sp(0,1),s=Sp(0,1);r[a]={x:t.x+n[0][0]*o+n[0][1]*s,y:t.y+n[1][0]*o+n[1][1]*s}}}return r}for(let n=0;n<e;n++)r[n]={x:Sp(t.x,i.x),y:Sp(t.y,i.y)};return r}function Nv(e,t,i){return Math.min(Math.max(e,t),i)}function J6(e,t){let i=e.length;if(t==null){let r=e.reduce((n,a)=>n+a)/i}return Math.sqrt(e.map(r=>Math.pow(r-t,2)).reduce((r,n)=>r+n)/i)}function nM(e){return e.reduce((t,i)=>t+i)/e.length}function eU(e=0,t=1){let i=1-Math.random(),r=Math.random();return Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*r)*t+e}function tU(e,t,i){let r=[];for(let n=e;n<t;n+=i)r.push(n);return r}function Pv(e,t,i){let r=(t-e)/(i-1);return tU(e,t+r,r)}function aM(e,t,i=!1){let r=[],n=tU(0,e.length,1);if(i)for(let a=0;a<t;a++)r.push(e[n[Math.floor(Math.random()*n.length)]]);else for(let a=0;a<t;a++){let o=Math.floor(Math.random()*n.length);r.push(e[o]),n.splice(o,1)}return r}var iU=(()=>{class e{x_range=[-10,10];y_range=[-10,10];w_max=5;w_min=0;b_max=20;b_min=-20;lin_separability=!0;positiveBorder=[[this.x_range[0],this.y_range[0]],[this.x_range[1],this.y_range[1]],[this.x_range[1],this.y_range[0]],[this.x_range[0],this.y_range[0]]];negativeBorder=[[this.x_range[0],this.y_range[0]],[this.x_range[1],this.y_range[1]],[this.x_range[1],this.y_range[1]],[this.x_range[0],this.y_range[1]],[this.x_range[0],this.y_range[0]]];w=1;b=0;echartInstance;echartInstance3D;loss_3d_data;data_chart={legend:{align:"left"},tooltip:{},xAxis:{min:this.x_range[0],max:this.x_range[1]},yAxis:{min:this.y_range[0],max:this.y_range[1]},series:[{type:"scatter",encode:{tooltip:[0,1]},symbolSize:5,color:"green"},{type:"scatter",encode:{tooltip:[0,1]},symbolSize:5,color:"red"},{type:"line",data:this.positiveBorder,showSymbol:!1,areaStyle:{color:"green",opacity:.3},color:"black",z:-1},{type:"line",data:this.negativeBorder,showSymbol:!1,areaStyle:{color:"red",opacity:.3},lineStyle:{width:0},z:-1}],animationEasing:"elasticOut",animationDelayUpdate:i=>i};option_3d_graph={tooltip:{},visualMap:{show:!0,dimension:2,min:0,max:75,inRange:{color:["#313695","#4575b4","#74add1","#abd9e9","#fee090","#fdae61","#f46d43","#d73027","#a50026"]}},xAxis3D:{type:"value",name:"W"},yAxis3D:{type:"value",name:"b"},zAxis3D:{type:"value",name:"loss",axisLabel:{show:!1}},grid3D:{viewControl:{projection:"orthographic"}},series:[{type:"surface",tooltip:{show:!1},wireframe:{show:!0},data:[]},{type:"scatter3D",data:[[this.w,this.b,this.compute_loss(this.w,this.b)]],symbolSize:20}]};ptClass1;ptClass2;nPoints=100;constructor(){}ngOnInit(){this.distribute_points(),this.update_fx()}distribute_points(){this.lin_separability?(this.ptClass1=eh(this.nPoints,{x:5,y:-5},{x:4,y:4}),this.ptClass2=eh(this.nPoints,{x:-5,y:5},{x:4,y:4})):(this.ptClass1=eh(this.nPoints,{x:0,y:0},{x:1,y:1}),this.ptClass2=eh(this.nPoints,{x:0,y:0},{x:.1,y:.1}),this.ptClass2.forEach(n=>{let a=Math.sqrt(n.x*n.x+n.y*n.y);n.x=n.x*(5+5/a),n.y=n.y*(5+5/a)}));let i={data:this.ptClass1.map(n=>({value:[Nv(n.x,this.x_range[0],this.x_range[1]),Nv(n.y,this.y_range[0],this.y_range[1])]}))},r={data:this.ptClass2.map(n=>({value:[Nv(n.x,this.x_range[0],this.x_range[1]),Nv(n.y,this.y_range[0],this.y_range[1])]}))};Array.isArray(this.data_chart.series)&&(this.data_chart.series[0].data=i.data,this.data_chart.series[1].data=r.data),this.loss_3d_data=this.get_3D_data(),this.option_3d_graph.series[0].data=this.loss_3d_data,this.update_charts()}update_charts(){this.echartInstance?.setOption(this.data_chart),this.echartInstance3D?.setOption(this.option_3d_graph)}get_3D_data(){let i=new Array,r=50;for(let n=0;n<=r;n++)for(let a=0;a<=r;a++){let o=this.w_min+n*(this.w_max-this.w_min)/r,s=this.b_min+a*(this.b_max-this.b_min)/r,l=this.compute_loss(o,s);i.push([o,s,l])}return i}onChartInit(i){this.echartInstance=i}onChartInit3D(i){this.echartInstance3D=i}update_b(i){this.b=i,this.update_fx()}update_w(i){this.w=i,this.update_fx()}update_fx(){let i=[this.x_range[0],this.w*this.x_range[0]+this.b],r=[this.x_range[1],this.w*this.x_range[1]+this.b];this.positiveBorder[0]=i,this.positiveBorder[1]=r,this.negativeBorder[0]=i,this.negativeBorder[1]=r,this.option_3d_graph.series[1].data=[[this.w,this.b,this.compute_loss(this.w,this.b)]],this.update_charts()}compute_loss_v2(i,r){let n=0,a=Math.sqrt(1+i*i);for(let o=0;o<this.nPoints;o++){let s=this.ptClass1[o],l=this.ptClass2[o];n+=Math.abs(s.y+s.x*i+r)/a,n+=Math.abs(l.y+l.x*i+r)/a}return n/this.nPoints}compute_loss(i,r){let n=0,a=Math.sqrt(1+i*i);for(let o=0;o<this.nPoints;o++){let s=this.ptClass1[o],l=this.ptClass2[o];n+=+(s.y-s.x*i-r>0),n+=+(l.y-l.x*i-r<0)}return 100*n/(this.nPoints*2)}change_points_distributions(i){this.lin_separability=i.value=="linear",this.distribute_points(),this.update_fx()}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Ae({type:e,selectors:[["app-weights-loss"]],decls:16,vars:12,consts:[[3,"rightDrawer"],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["title","Slope",3,"valueChange","max","min","step","value"],["title","Intercept",3,"valueChange","max","min","step","value"],["name","fontStyle","aria-label","Font Style",3,"change"],["value","linear",3,"checked"],["value","non_linear"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["echarts","",1,"graph",3,"chartInit","options"]],template:function(r,n){r&1&&(S(0,"app-tutorial-template",0),At(1,1),S(2,"h3"),G(3," Tunable parameters "),A(),S(4,"app-labelled-sliders",2),q("valueChange",function(o){return n.update_w(o)}),A(),S(5,"app-labelled-sliders",3),q("valueChange",function(o){return n.update_b(o)}),A(),S(6,"h3"),G(7," Samples distribution "),A(),S(8,"mat-button-toggle-group",4),q("change",function(o){return n.change_points_distributions(o)}),S(9,"mat-button-toggle",5),G(10,"Linear"),A(),S(11,"mat-button-toggle",6),G(12,"Circular"),A()(),Tt(),At(13,7),S(14,"div",8),q("chartInit",function(o){return n.onChartInit(o)}),A(),S(15,"div",8),q("chartInit",function(o){return n.onChartInit3D(o)}),A(),Tt(),A()),r&2&&(O("rightDrawer",!1),P(4),O("max",n.w_max)("min",n.w_min)("step",.1)("value",n.w),P(),O("max",n.b_max)("min",n.b_min)("step",.1)("value",n.b),P(4),O("checked",n.lin_separability),P(5),O("options",n.data_chart),P(),O("options",n.option_3d_graph))},dependencies:[mn,bo,Wa,hr,Ga],styles:[".graph[_ngcontent-%COMP%]{aspect-ratio:1;width:30vw;background-color:#fff;border-radius:.25em;border-color:#000;margin:5%}.label-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin:0 20px}.parameter-adjusting[_ngcontent-%COMP%]{margin:5px;border-radius:.5em;box-shadow:#0e1e251f 0 2px 4px,#0e1e2552 0 2px 16px}"]})}return e})();var tme=0,oM=new Be("CdkAccordion"),rU=(()=>{class e{constructor(){this._stateChanges=new ut,this._openCloseAllActions=new ut,this.id=`cdk-accordion-${tme++}`,this.multi=!1}openAll(){this.multi&&this._openCloseAllActions.next(!0)}closeAll(){this._openCloseAllActions.next(!1)}ngOnChanges(i){this._stateChanges.next(i)}ngOnDestroy(){this._stateChanges.complete(),this._openCloseAllActions.complete()}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=lt({type:e,selectors:[["cdk-accordion"],["","cdkAccordion",""]],inputs:{multi:[de.HasDecoratorInputTransform,"multi","multi",ot]},exportAs:["cdkAccordion"],standalone:!0,features:[_i([{provide:oM,useExisting:e}]),wi,ir]})}}return e})(),ime=0,nU=(()=>{class e{get expanded(){return this._expanded}set expanded(i){if(this._expanded!==i){if(this._expanded=i,this.expandedChange.emit(i),i){this.opened.emit();let r=this.accordion?this.accordion.id:this.id;this._expansionDispatcher.notify(this.id,r)}else this.closed.emit();this._changeDetectorRef.markForCheck()}}constructor(i,r,n){this.accordion=i,this._changeDetectorRef=r,this._expansionDispatcher=n,this._openCloseAllSubscription=Nr.EMPTY,this.closed=new Pe,this.opened=new Pe,this.destroyed=new Pe,this.expandedChange=new Pe,this.id=`cdk-accordion-child-${ime++}`,this._expanded=!1,this.disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=n.listen((a,o)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===o&&this.id!==a&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(i=>{this.disabled||(this.expanded=i)})}static{this.\u0275fac=function(r){return new(r||e)(z(oM,12),z(Vt),z(wy))}}static{this.\u0275dir=lt({type:e,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:[de.HasDecoratorInputTransform,"expanded","expanded",ot],disabled:[de.HasDecoratorInputTransform,"disabled","disabled",ot]},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],standalone:!0,features:[_i([{provide:oM,useValue:void 0}]),wi]})}}return e})(),aU=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({})}}return e})();var rme=["body"],nme=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],ame=["mat-expansion-panel-header","*","mat-action-row"];function ome(e,t){}var sme=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],lme=["mat-panel-title","mat-panel-description","*"];function cme(e,t){if(e&1&&(S(0,"span",1),Ca(),S(1,"svg",2),ae(2,"path",3),A()()),e&2){let i=J();O("@indicatorRotate",i._getExpandedState())}}var sM=new Be("MAT_ACCORDION"),oU="225ms cubic-bezier(0.4,0.0,0.2,1)",lU={indicatorRotate:Ts("indicatorRotate",[So("collapsed, void",ta({transform:"rotate(0deg)"})),So("expanded",ta({transform:"rotate(180deg)"})),Ao("expanded <=> collapsed, void => collapsed",os(oU))]),bodyExpansion:Ts("bodyExpansion",[So("collapsed, void",ta({height:"0px",visibility:"hidden"})),So("expanded",ta({height:"*",visibility:""})),Ao("expanded <=> collapsed, void => collapsed",os(oU))])},cU=new Be("MAT_EXPANSION_PANEL"),dme=(()=>{class e{constructor(i,r){this._template=i,this._expansionPanel=r}static{this.\u0275fac=function(r){return new(r||e)(z(lh),z(cU,8))}}static{this.\u0275dir=lt({type:e,selectors:[["ng-template","matExpansionPanelContent",""]],standalone:!0})}}return e})(),ume=0,dU=new Be("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS"),Kl=(()=>{class e extends nU{get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(i){this._hideToggle=i}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(i){this._togglePosition=i}constructor(i,r,n,a,o,s,l){super(i,r,n),this._viewContainerRef=a,this._animationMode=s,this._hideToggle=!1,this.afterExpand=new Pe,this.afterCollapse=new Pe,this._inputChanges=new ut,this._headerId=`mat-expansion-panel-header-${ume++}`,this.accordion=i,this._document=o,this._animationsDisabled=s==="NoopAnimations",l&&(this.hideToggle=l.hideToggle)}_hasSpacing(){return this.accordion?this.expanded&&this.accordion.displayMode==="default":!1}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this._lazyContent._expansionPanel===this&&this.opened.pipe(wa(null),Mi(()=>this.expanded&&!this._portal),Br(1)).subscribe(()=>{this._portal=new ju(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(i){this._inputChanges.next(i)}ngOnDestroy(){super.ngOnDestroy(),this._inputChanges.complete()}_containsFocus(){if(this._body){let i=this._document.activeElement,r=this._body.nativeElement;return i===r||r.contains(i)}return!1}_animationStarted(i){!sU(i)&&!this._animationsDisabled&&this._body&&this._body?.nativeElement.setAttribute("inert","")}_animationDone(i){sU(i)||(i.toState==="expanded"?this.afterExpand.emit():i.toState==="collapsed"&&this.afterCollapse.emit(),!this._animationsDisabled&&this._body&&this._body.nativeElement.removeAttribute("inert"))}static{this.\u0275fac=function(r){return new(r||e)(z(sM,12),z(Vt),z(wy),z(as),z(yt),z(zi,8),z(dU,8))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-expansion-panel"]],contentQueries:function(r,n,a){if(r&1&&Si(a,dme,5),r&2){let o;Me(o=Ie())&&(n._lazyContent=o.first)}},viewQuery:function(r,n){if(r&1&&tt(rme,5),r&2){let a;Me(a=Ie())&&(n._body=a.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(r,n){r&2&&ft("mat-expanded",n.expanded)("_mat-animation-noopable",n._animationsDisabled)("mat-expansion-panel-spacing",n._hasSpacing())},inputs:{hideToggle:[de.HasDecoratorInputTransform,"hideToggle","hideToggle",ot],togglePosition:"togglePosition"},outputs:{afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],standalone:!0,features:[_i([{provide:sM,useValue:void 0},{provide:cU,useExisting:e}]),wi,Ot,ir,Xt],ngContentSelectors:ame,decls:7,vars:4,consts:[["body",""],["role","region",1,"mat-expansion-panel-content",3,"id"],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(r,n){if(r&1){let a=Ue();ti(nme),it(0),S(1,"div",1,0),q("@bodyExpansion.start",function(s){return j(a),W(n._animationStarted(s))})("@bodyExpansion.done",function(s){return j(a),W(n._animationDone(s))}),S(3,"div",2),it(4,1),Te(5,ome,0,0,"ng-template",3),A(),it(6,2),A()}r&2&&(P(),O("@bodyExpansion",n._getExpandedState())("id",n.id),Ft("aria-labelledby",n._headerId),P(4),O("cdkPortalOutlet",n._portal))},dependencies:[v8],styles:['.mat-expansion-panel{box-sizing:content-box;display:block;margin:0;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative;background:var(--mat-expansion-container-background-color);color:var(--mat-expansion-container-text-color);border-radius:var(--mat-expansion-container-shape)}.mat-expansion-panel:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:var(--mat-expansion-container-shape);border-top-left-radius:var(--mat-expansion-container-shape)}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:var(--mat-expansion-container-shape);border-bottom-left-radius:var(--mat-expansion-container-shape)}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible;font-family:var(--mat-expansion-container-text-font);font-size:var(--mat-expansion-container-text-size);font-weight:var(--mat-expansion-container-text-weight);line-height:var(--mat-expansion-container-text-line-height);letter-spacing:var(--mat-expansion-container-text-tracking)}.mat-expansion-panel-content[style*="visibility: hidden"] *{visibility:hidden !important}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px;border-top-color:var(--mat-expansion-actions-divider-color)}.mat-action-row .mat-button-base,.mat-action-row .mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row .mat-button-base,[dir=rtl] .mat-action-row .mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2,data:{animation:[lU.bodyExpansion]},changeDetection:0})}}return e})();function sU(e){return e.fromState==="void"}var Ql=(()=>{class e{constructor(i,r,n,a,o,s,l){this.panel=i,this._element=r,this._focusMonitor=n,this._changeDetectorRef=a,this._animationMode=s,this._parentChangeSubscription=Nr.EMPTY,this.tabIndex=0;let c=i.accordion?i.accordion._stateChanges.pipe(Mi(d=>!!(d.hideToggle||d.togglePosition))):Co;this.tabIndex=parseInt(l||"")||0,this._parentChangeSubscription=Rn(i.opened,i.closed,c,i._inputChanges.pipe(Mi(d=>!!(d.hideToggle||d.disabled||d.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),i.closed.pipe(Mi(()=>i._containsFocus())).subscribe(()=>n.focusVia(r,"program")),o&&(this.expandedHeight=o.expandedHeight,this.collapsedHeight=o.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){let i=this._isExpanded();return i&&this.expandedHeight?this.expandedHeight:!i&&this.collapsedHeight?this.collapsedHeight:null}_keydown(i){switch(i.keyCode){case 32:case 13:vo(i)||(i.preventDefault(),this._toggle());break;default:this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(i);return}}focus(i,r){i?this._focusMonitor.focusVia(this._element,i,r):this._element.nativeElement.focus(r)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(i=>{i&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}static{this.\u0275fac=function(r){return new(r||e)(z(Kl,1),z(nt),z(Ks),z(Vt),z(dU,8),z(zi,8),ea("tabindex"))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(r,n){r&1&&q("click",function(){return n._toggle()})("keydown",function(o){return n._keydown(o)}),r&2&&(Ft("id",n.panel._headerId)("tabindex",n.disabled?-1:n.tabIndex)("aria-controls",n._getPanelId())("aria-expanded",n._isExpanded())("aria-disabled",n.panel.disabled),ei("height",n._getHeaderHeight()),ft("mat-expanded",n._isExpanded())("mat-expansion-toggle-indicator-after",n._getTogglePosition()==="after")("mat-expansion-toggle-indicator-before",n._getTogglePosition()==="before")("_mat-animation-noopable",n._animationMode==="NoopAnimations"))},inputs:{expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight",tabIndex:[de.HasDecoratorInputTransform,"tabIndex","tabIndex",i=>i==null?0:Dr(i)]},standalone:!0,features:[wi,Xt],ngContentSelectors:lme,decls:5,vars:3,consts:[[1,"mat-content"],[1,"mat-expansion-indicator"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-hidden","true","focusable","false"],["d","M480-345 240-585l56-56 184 184 184-184 56 56-240 240Z"]],template:function(r,n){r&1&&(ti(sme),S(0,"span",0),it(1),it(2,1),it(3,2),A(),Te(4,cme,3,1,"span",1)),r&2&&(ft("mat-content-hide-toggle",!n._showToggle()),P(4),fi(4,n._showToggle()?4:-1))},styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-expansion-header-collapsed-state-height);font-family:var(--mat-expansion-header-text-font);font-size:var(--mat-expansion-header-text-size);font-weight:var(--mat-expansion-header-text-weight);line-height:var(--mat-expansion-header-text-line-height);letter-spacing:var(--mat-expansion-header-text-tracking)}.mat-expansion-panel-header.mat-expanded{height:var(--mat-expansion-header-expanded-state-height)}.mat-expansion-panel-header[aria-disabled=true]{color:var(--mat-expansion-header-disabled-state-text-color)}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-header-hover-state-layer-color)}@media(hover: none){.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-container-background-color)}}.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-keyboard-focused,.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-program-focused{background:var(--mat-expansion-header-focus-state-layer-color)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-content.mat-content-hide-toggle{margin-right:8px}[dir=rtl] .mat-content.mat-content-hide-toggle{margin-right:0;margin-left:8px}.mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-left:24px;margin-right:0}[dir=rtl] .mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-right:24px;margin-left:0}.mat-expansion-panel-header-title{color:var(--mat-expansion-header-text-color)}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;flex-basis:0;margin-right:16px;align-items:center}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-title,.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-description{color:inherit}.mat-expansion-panel-header-description{flex-grow:2;color:var(--mat-expansion-header-description-color)}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle;color:var(--mat-expansion-header-indicator-color);display:inline-block;display:var(--mat-expansion-legacy-header-indicator-display, inline-block)}.mat-expansion-indicator svg{width:24px;height:24px;margin:0 -8px;vertical-align:middle;fill:var(--mat-expansion-header-indicator-color);display:none;display:var(--mat-expansion-header-indicator-display, none)}.cdk-high-contrast-active .mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}'],encapsulation:2,data:{animation:[lU.indicatorRotate]},changeDetection:0})}}return e})();var pd=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=lt({type:e,selectors:[["mat-panel-title"]],hostAttrs:[1,"mat-expansion-panel-header-title"],standalone:!0})}}return e})(),uU=(()=>{class e extends rU{constructor(){super(...arguments),this._ownHeaders=new wd,this.hideToggle=!1,this.displayMode="default",this.togglePosition="after"}ngAfterContentInit(){this._headers.changes.pipe(wa(this._headers)).subscribe(i=>{this._ownHeaders.reset(i.filter(r=>r.panel.accordion===this)),this._ownHeaders.notifyOnChanges()}),this._keyManager=new hy(this._ownHeaders).withWrap().withHomeAndEnd()}_handleHeaderKeydown(i){this._keyManager.onKeydown(i)}_handleHeaderFocus(i){this._keyManager.updateActiveItem(i)}ngOnDestroy(){super.ngOnDestroy(),this._keyManager?.destroy(),this._ownHeaders.destroy()}static{this.\u0275fac=(()=>{let i;return function(n){return(i||(i=sr(e)))(n||e)}})()}static{this.\u0275dir=lt({type:e,selectors:[["mat-accordion"]],contentQueries:function(r,n,a){if(r&1&&Si(a,Ql,5),r&2){let o;Me(o=Ie())&&(n._headers=o)}},hostAttrs:[1,"mat-accordion"],hostVars:2,hostBindings:function(r,n){r&2&&ft("mat-accordion-multi",n.multi)},inputs:{hideToggle:[de.HasDecoratorInputTransform,"hideToggle","hideToggle",ot],displayMode:"displayMode",togglePosition:"togglePosition"},exportAs:["matAccordion"],standalone:!0,features:[_i([{provide:sM,useExisting:e}]),wi,Ot]})}}return e})(),hU=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[Et,aU,Ay]})}}return e})();var hme=["canvas"],mme=(e,t)=>({activated:e,deactivated:t}),mU=()=>[];function pme(e,t){e&1&&(S(0,"mat-icon"),G(1,"visibility"),A())}function fme(e,t){e&1&&(S(0,"mat-icon"),G(1,"visibility_off"),A())}function gme(e,t){if(e&1&&(S(0,"td"),G(1),A()),e&2){let i=t.index,r=J().index,n=J();P(),Vr(" ",n.getFormattedValue(r,i)," ")}}function vme(e,t){if(e&1&&(S(0,"tr"),Te(1,gme,2,1,"td",18),A()),e&2){let i=J();P(),O("ngForOf",cl(1,mU).constructor(i.kernel.size))}}var pU=(()=>{class e{kernel;updateFilters=new Pe;canvas;ctx;ngOnInit(){this.kernel.delete=!1;let i=this.canvas.nativeElement;this.ctx=i.getContext("2d",{alpha:!1}),i.width=this.kernel.size,i.height=this.kernel.size,this.ctx.canvas.width=this.kernel.size,this.ctx.canvas.height=this.kernel.size,this.drawFilter()}delete(i){i.stopPropagation(),this.kernel.delete=!0,this.updateFilters.emit()}toggleActive(i){i.stopPropagation(),this.kernel.active=!this.kernel.active,this.updateFilters.emit()}drawFilter(){let i=new Uint8ClampedArray(this.kernel.size*this.kernel.size*4);for(let n=0;n<this.kernel.size;n++)for(let a=0;a<this.kernel.size;a++){let o=this.kernel.element[n*this.kernel.size+a];i[4*n*this.kernel.size+a*4]=o,i[4*n*this.kernel.size+a*4+1]=o,i[4*n*this.kernel.size+a*4+2]=o,i[4*n*this.kernel.size+a*4+3]=255}let r=new ImageData(i,this.kernel.size,this.kernel.size);this.ctx.putImageData(r,0,0)}getFormattedValue(i,r){let n=i*this.kernel.size+r;return(this.kernel.element[n]/255).toFixed(0)}updateFilter(){this.updateFilters.emit(!0)}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Ae({type:e,selectors:[["app-structural-element"]],viewQuery:function(r,n){if(r&1&&tt(hme,7),r&2){let a;Me(a=Ie())&&(n.canvas=a.first)}},inputs:{kernel:"kernel"},outputs:{updateFilters:"updateFilters"},decls:35,vars:9,consts:[["panelH",""],["canvas",""],[3,"ngClass"],["mat-mini-fab","","color","accent",1,"action-button",3,"click"],[4,"ngIf"],["appearance","fill",3,"click"],[3,"ngModelChange","ngModel"],["value","erosion"],["value","dilation"],["value","opening"],["value","closing"],["value","tophat"],["value","gradient"],["value","skeletonize"],["mat-mini-fab","","color","warn",1,"action-button",3,"click"],[1,"vertical-flex","center"],[1,"rounded-table"],[3,"mouseenter"],[4,"ngFor","ngForOf"]],template:function(r,n){if(r&1){let a=Ue();S(0,"mat-expansion-panel",2,0)(2,"mat-expansion-panel-header")(3,"mat-panel-title")(4,"button",3),q("click",function(s){return j(a),W(n.toggleActive(s))}),Te(5,pme,2,0,"mat-icon",4)(6,fme,2,0,"mat-icon",4),A(),S(7,"span")(8,"mat-form-field",5),q("click",function(){j(a);let s=kt(1);return W(s.toggle())}),S(9,"mat-label"),G(10,"Operation"),A(),S(11,"mat-select",6),Pt("ngModelChange",function(s){return j(a),Dt(n.kernel.morphOp,s)||(n.kernel.morphOp=s),W(s)}),q("ngModelChange",function(){return j(a),W(n.updateFilter())}),S(12,"mat-option",7),G(13,"Erosion"),A(),S(14,"mat-option",8),G(15,"Dilation"),A(),S(16,"mat-option",9),G(17,"Opening"),A(),S(18,"mat-option",10),G(19,"Closing"),A(),S(20,"mat-option",11),G(21,"Top Hat"),A(),S(22,"mat-option",12),G(23,"Gradient"),A(),S(24,"mat-option",13),G(25,"Skeletonize"),A()()()(),S(26,"button",14),q("click",function(s){return j(a),W(n.delete(s))}),S(27,"mat-icon"),G(28,"close"),A()()()(),S(29,"div",15)(30,"div",16)(31,"table",17),q("mouseenter",function(){return j(a),W(n.drawFilter())}),Te(32,vme,2,2,"tr",18),A()(),ae(33,"canvas",null,1),A()()}r&2&&(O("ngClass",hh(5,mme,n.kernel.active,!n.kernel.active)),P(5),O("ngIf",n.kernel.active),P(),O("ngIf",!n.kernel.active),P(5),Nt("ngModel",n.kernel.morphOp),P(21),O("ngForOf",cl(8,mU).constructor(n.kernel.size)))},dependencies:[rp,Qs,My,ip,Es,Fn,cn,yn,an,Kl,Ql,pd,lp,$n],styles:["mat-expansion-panel-header[_ngcontent-%COMP%]{height:fit-content}canvas[_ngcontent-%COMP%]{width:128px;aspect-ratio:1;image-rendering:-moz-crisp-edges;image-rendering:-webkit-crisp-edges;image-rendering:pixelated;image-rendering:crisp-edges;box-shadow:#0000001f 0 1px 3px,#0000003d 0 1px 2px;border-radius:.5em}.title-span[_ngcontent-%COMP%]{margin:auto}tr[_ngcontent-%COMP%]:nth-child(odd){background-color:#646464}.horizontal-flex[_ngcontent-%COMP%]{width:100%}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#6f9b75}td[_ngcontent-%COMP%]{font-size:small}.center[_ngcontent-%COMP%]{align-items:center;gap:1em}.deactivated[_ngcontent-%COMP%]:not(button){filter:brightness(.7);border:solid white 1px}.rounded-table[_ngcontent-%COMP%]{overflow:hidden;box-shadow:#0000001f 0 1px 3px,#0000003d 0 1px 2px;aspect-ratio:1;overflow:scroll}button[_ngcontent-%COMP%]{transform:scale(.5)}"]})}return e})();var bme=["elementCanvasVisu"];function xme(e,t){if(e&1){let i=Ue();S(0,"app-structural-element",19),q("updateFilters",function(){j(i);let n=J();return W(n.updateFilters())}),A()}if(e&2){let i=t.$implicit;O("kernel",i)}}var fU=(()=>{class e extends za{eltCanvasVisu;listKernels=new Array;ksize=3;structuralElementType="circle";width=256;ngAfterViewInit(){super.ngAfterViewInit(),this.cleanFilterList(),this.updateVisu()}updateVisu(){this.ngxOpenCv.cvState.subscribe(i=>{if(this.cvState=i,i.ready){let r=this.getStructuringMat(this.ksize,this.structuralElementType);cv.convertScaleAbs(r,r,255);let n=32-this.ksize;cv.copyMakeBorder(r,r,n,n,n,n,cv.BORDER_CONSTANT),cv.imshow(this.eltCanvasVisu.nativeElement,r),r.delete()}})}applyFilter(){let i=cv.imread(this.drawCanvas.getCanvas()),r=new cv.Point(-1,-1),n=new cv.Mat;cv.cvtColor(i,n,cv.COLOR_RGB2GRAY),this.listKernels.forEach(a=>{if(!a.active)return;let o=a.size,s=cv.matFromArray(o,o,cv.CV_8UC1,a.element);switch(a.morphOp){case"erosion":{cv.erode(n,n,s,r,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue());break}case"dilation":{cv.dilate(n,n,s,r,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue());break}case"opening":{cv.morphologyEx(n,n,cv.MORPH_OPEN,s,r,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue());break}case"closing":{cv.morphologyEx(n,n,cv.MORPH_CLOSE,s);break}case"gradient":{cv.morphologyEx(n,n,cv.MORPH_GRADIENT,s);break}case"tophat":{cv.morphologyEx(n,n,cv.MORPH_TOPHAT,s);break}case"skeletonize":{for(var l=new cv.Mat(this.width,this.width,cv.CV_8UC1,new cv.Scalar(0)),c=new cv.Mat,d=new cv.Mat,u=!1,h=50;!u&&h>0;)cv.erode(n,d,s),cv.dilate(d,c,s),cv.subtract(n,c,c),cv.bitwise_or(l,c,l),d.copyTo(n),u=cv.norm(n)==0,h--;l.copyTo(n),l.delete(),c.delete(),d.delete();break}}s.delete()}),this.outputCanvas.drawMat(n),n.delete(),i.delete()}updateFilters(){this.listKernels=this.listKernels.filter(i=>!i.delete),this.applyFilter()}cleanFilterList(){this.listKernels=new Array}getStructuringMat(i,r){let n=new cv.Size(i,i);switch(r){case"circle":{var a=cv.getStructuringElement(cv.MORPH_ELLIPSE,n);break}case"square":{var a=cv.getStructuringElement(cv.MORPH_RECT,n);break}case"cross":{var a=cv.getStructuringElement(cv.MORPH_CROSS,n);break}}return a}addFilter(){let i=this.getStructuringMat(this.ksize,this.structuralElementType);cv.convertScaleAbs(i,i,255);let r="erosion",n=this.listKernels.length;n>0&&(r=this.listKernels[n-1].morphOp);let a=new Uint8ClampedArray(i.data,i.cols,i.rows),o={morphOp:r,size:this.ksize,element:a,active:!0,delete:!1};this.listKernels.push(o),i.delete(),this.updateFilters()}static \u0275fac=(()=>{let i;return function(n){return(i||(i=sr(e)))(n||e)}})();static \u0275cmp=Ae({type:e,selectors:[["app-morpho-tools"]],viewQuery:function(r,n){if(r&1&&tt(bme,7),r&2){let a;Me(a=Ie())&&(n.eltCanvasVisu=a.first)}},features:[Ot],decls:35,vars:16,consts:[["brushSizeSlider",""],["elementCanvasVisu",""],["inputCanvas",""],["outputCanvas",""],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["title","Brush Size"],[3,"valueChange","min","max","step","title","value"],[3,"ngModelChange","change","ngModel"],["value","circle"],["value","square"],["value","cross"],[1,"structuralElementVisu"],["mat-raised-button","","color","primary",1,"fillWidth",3,"click"],["ngProjectAs","[drawerRight]",5,["","drawerRight",""]],["echarts","",1,"profile-graph",3,"options"],[3,"kernel","updateFilters",4,"ngFor","ngForOf"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["title","Canvas",1,"canvas",3,"drawingEnded","width","drawable","BWOption","OnlyBW","brushRadius"],["title","Result",1,"canvas",3,"profileChanged","width","profileOption","drawable"],[3,"updateFilters","kernel"]],template:function(r,n){if(r&1){let a=Ue();S(0,"app-tutorial-template-images"),G(1," Morphological Transformations "),At(2,4),ae(3,"app-labelled-sliders",5,0)(5,"hr"),S(6,"app-labelled-sliders",6),Pt("valueChange",function(s){return j(a),Dt(n.ksize,s)||(n.ksize=s),W(s)}),q("valueChange",function(){return j(a),W(n.updateVisu())}),A(),S(7,"span")(8,"mat-button-toggle-group",7),Pt("ngModelChange",function(s){return j(a),Dt(n.structuralElementType,s)||(n.structuralElementType=s),W(s)}),q("change",function(){return j(a),W(n.updateVisu())}),S(9,"mat-button-toggle",8)(10,"mat-icon"),G(11,"toll"),A()(),S(12,"mat-button-toggle",9)(13,"mat-icon"),G(14,"crop_square"),A()(),S(15,"mat-button-toggle",10)(16,"mat-icon"),G(17,"games"),A()()()(),ae(18,"canvas",11,1),S(20,"button",12),q("click",function(){return j(a),W(n.addFilter())}),G(21," Add "),A(),Tt(),At(22,13),S(23,"h2"),G(24,"Profile"),A(),ae(25,"div",14),S(26,"h2"),G(27,"Active filters"),A(),ae(28,"hr"),Te(29,xme,1,1,"app-structural-element",15),Tt(),At(30,16),S(31,"app-draw-canvas",17,2),q("drawingEnded",function(){return j(a),W(n.applyFilter())}),A(),S(33,"app-draw-canvas",18,3),q("profileChanged",function(){return j(a),W(n.updateProfile())}),A(),Tt(),A()}if(r&2){let a=kt(4);P(6),O("min",3)("max",25)("step",2)("title","Element size"),Nt("value",n.ksize),P(2),Nt("ngModel",n.structuralElementType),P(17),O("options",n.profileOptions),P(4),O("ngForOf",n.listKernels),P(2),O("width",n.width)("drawable",!0)("BWOption",!1)("OnlyBW",!0)("brushRadius",a.value),P(2),O("width",n.width)("profileOption",!0)("drawable",!1)}},dependencies:[mn,bo,Wa,Fn,yn,an,Lr,$n,Ua,hr,pU,ja],styles:[".canvas[_ngcontent-%COMP%]{width:45%;min-width:256px;image-rendering:-moz-crisp-edges;image-rendering:-webkit-crisp-edges;image-rendering:pixelated;image-rendering:crisp-edges}.structuralElementVisu[_ngcontent-%COMP%]{width:128px;aspect-ratio:1;image-rendering:-moz-crisp-edges;image-rendering:-webkit-crisp-edges;image-rendering:pixelated;image-rendering:crisp-edges;margin:1em}.profile-graph[_ngcontent-%COMP%]{min-width:300px;padding:0 .5em}"]})}return e})();function lM(e){let t=Array(e.length).fill(0);Cw(e,t);let i=new Array(e.length);for(let r=0;r<i.length;r++){let n=e[r],a=t[r];i[r]=2*Math.sqrt(n*n+a*a)/e.length}return i}function Cw(e,t){let i=e.length;if(i!=t.length)throw new RangeError("Mismatched lengths");i!=0&&(i&i-1?Cme(e,t):wme(e,t))}function yme(e,t){Cw(t,e)}function wme(e,t){let i=e.length;if(i!=t.length)throw new RangeError("Mismatched lengths");if(i==1)return;let r=-1;for(let s=0;s<32;s++)1<<s==i&&(r=s);if(r==-1)throw new RangeError("Length is not a power of 2");let n=new Array(i/2),a=new Array(i/2);for(let s=0;s<i/2;s++)n[s]=Math.cos(2*Math.PI*s/i),a[s]=Math.sin(2*Math.PI*s/i);for(let s=0;s<i;s++){let l=o(s,r);if(l>s){let c=e[s];e[s]=e[l],e[l]=c,c=t[s],t[s]=t[l],t[l]=c}}for(let s=2;s<=i;s*=2){let l=s/2,c=i/s;for(let d=0;d<i;d+=s)for(let u=d,h=0;u<d+l;u++,h+=c){let m=u+l,f=e[m]*n[h]+t[m]*a[h],p=-e[m]*a[h]+t[m]*n[h];e[m]=e[u]-f,t[m]=t[u]-p,e[u]+=f,t[u]+=p}}function o(s,l){let c=0;for(let d=0;d<l;d++)c=c<<1|s&1,s>>>=1;return c}}function Cme(e,t){let i=e.length;if(i!=t.length)throw new RangeError("Mismatched lengths");let r=1;for(;r<i*2+1;)r*=2;let n=new Array(i),a=new Array(i);for(let h=0;h<i;h++){let m=h*h%(i*2);n[h]=Math.cos(Math.PI*m/i),a[h]=Math.sin(Math.PI*m/i)}let o=ww(r),s=ww(r);for(let h=0;h<i;h++)o[h]=e[h]*n[h]+t[h]*a[h],s[h]=-e[h]*a[h]+t[h]*n[h];let l=ww(r),c=ww(r);l[0]=n[0],c[0]=a[0];for(let h=1;h<i;h++)l[h]=l[r-h]=n[h],c[h]=c[r-h]=a[h];let d=new Array(r),u=new Array(r);Eme(o,s,l,c,d,u);for(let h=0;h<i;h++)e[h]=d[h]*n[h]+u[h]*a[h],t[h]=-d[h]*a[h]+u[h]*n[h]}function Eme(e,t,i,r,n,a){let o=e.length;if(o!=t.length||o!=i.length||o!=r.length||o!=n.length||o!=a.length)throw new RangeError("Mismatched lengths");e=e.slice(),t=t.slice(),i=i.slice(),r=r.slice(),Cw(e,t),Cw(i,r);for(let s=0;s<o;s++){let l=e[s]*i[s]-t[s]*r[s];t[s]=t[s]*i[s]+e[s]*r[s],e[s]=l}yme(e,t);for(let s=0;s<o;s++)n[s]=e[s]/o,a[s]=t[s]/o}function ww(e){return Array(e).fill(0)}var Sme=["input"],Ame=["label"],Tme=["*"],Dme=new Be("mat-checkbox-default-options",{providedIn:"root",factory:vU});function vU(){return{color:"accent",clickAction:"check-indeterminate"}}var Kn=function(e){return e[e.Init=0]="Init",e[e.Checked=1]="Checked",e[e.Unchecked=2]="Unchecked",e[e.Indeterminate=3]="Indeterminate",e}(Kn||{}),Mme={provide:$s,useExisting:Jn(()=>Ap),multi:!0},cM=class{},Ime=0,gU=vU(),Ap=(()=>{class e{focus(){this._inputElement.nativeElement.focus()}_createChangeEvent(i){let r=new cM;return r.source=this,r.checked=i,r}_getAnimationTargetElement(){return this._inputElement?.nativeElement}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(i,r,n,a,o,s){this._elementRef=i,this._changeDetectorRef=r,this._ngZone=n,this._animationMode=o,this._options=s,this._animationClasses={uncheckedToChecked:"mdc-checkbox--anim-unchecked-checked",uncheckedToIndeterminate:"mdc-checkbox--anim-unchecked-indeterminate",checkedToUnchecked:"mdc-checkbox--anim-checked-unchecked",checkedToIndeterminate:"mdc-checkbox--anim-checked-indeterminate",indeterminateToChecked:"mdc-checkbox--anim-indeterminate-checked",indeterminateToUnchecked:"mdc-checkbox--anim-indeterminate-unchecked"},this.ariaLabel="",this.ariaLabelledby=null,this.labelPosition="after",this.name=null,this.change=new Pe,this.indeterminateChange=new Pe,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=Kn.Init,this._controlValueAccessorChangeFn=()=>{},this._validatorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||gU,this.color=this._options.color||gU.color,this.tabIndex=parseInt(a)||0,this.id=this._uniqueId=`mat-mdc-checkbox-${++Ime}`}ngOnChanges(i){i.required&&this._validatorChangeFn()}ngAfterViewInit(){this._syncIndeterminate(this._indeterminate)}get checked(){return this._checked}set checked(i){i!=this.checked&&(this._checked=i,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(i){i!==this.disabled&&(this._disabled=i,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(i){let r=i!=this._indeterminate;this._indeterminate=i,r&&(this._indeterminate?this._transitionCheckState(Kn.Indeterminate):this._transitionCheckState(this.checked?Kn.Checked:Kn.Unchecked),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(i){this.checked=!!i}registerOnChange(i){this._controlValueAccessorChangeFn=i}registerOnTouched(i){this._onTouched=i}setDisabledState(i){this.disabled=i}validate(i){return this.required&&i.value!==!0?{required:!0}:null}registerOnValidatorChange(i){this._validatorChangeFn=i}_transitionCheckState(i){let r=this._currentCheckState,n=this._getAnimationTargetElement();if(!(r===i||!n)&&(this._currentAnimationClass&&n.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(r,i),this._currentCheckState=i,this._currentAnimationClass.length>0)){n.classList.add(this._currentAnimationClass);let a=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{n.classList.remove(a)},1e3)})}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.checked),this.change.emit(this._createChangeEvent(this.checked)),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_handleInputClick(){let i=this._options?.clickAction;!this.disabled&&i!=="noop"?(this.indeterminate&&i!=="check"&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?Kn.Checked:Kn.Unchecked),this._emitChangeEvent()):!this.disabled&&i==="noop"&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate)}_onInteractionEvent(i){i.stopPropagation()}_onBlur(){Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}_getAnimationClassForCheckStateTransition(i,r){if(this._animationMode==="NoopAnimations")return"";switch(i){case Kn.Init:if(r===Kn.Checked)return this._animationClasses.uncheckedToChecked;if(r==Kn.Indeterminate)return this._checked?this._animationClasses.checkedToIndeterminate:this._animationClasses.uncheckedToIndeterminate;break;case Kn.Unchecked:return r===Kn.Checked?this._animationClasses.uncheckedToChecked:this._animationClasses.uncheckedToIndeterminate;case Kn.Checked:return r===Kn.Unchecked?this._animationClasses.checkedToUnchecked:this._animationClasses.checkedToIndeterminate;case Kn.Indeterminate:return r===Kn.Checked?this._animationClasses.indeterminateToChecked:this._animationClasses.indeterminateToUnchecked}return""}_syncIndeterminate(i){let r=this._inputElement;r&&(r.nativeElement.indeterminate=i)}_onInputClick(){this._handleInputClick()}_onTouchTargetClick(){this._handleInputClick(),this.disabled||this._inputElement.nativeElement.focus()}_preventBubblingFromLabel(i){i.target&&this._labelElement.nativeElement.contains(i.target)&&i.stopPropagation()}static{this.\u0275fac=function(r){return new(r||e)(z(nt),z(Vt),z(Xe),ea("tabindex"),z(zi,8),z(Dme,8))}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-checkbox"]],viewQuery:function(r,n){if(r&1&&(tt(Sme,5),tt(Ame,5),tt(Zo,5)),r&2){let a;Me(a=Ie())&&(n._inputElement=a.first),Me(a=Ie())&&(n._labelElement=a.first),Me(a=Ie())&&(n.ripple=a.first)}},hostAttrs:[1,"mat-mdc-checkbox"],hostVars:14,hostBindings:function(r,n){r&2&&(Cs("id",n.id),Ft("tabindex",null)("aria-label",null)("aria-labelledby",null),yr(n.color?"mat-"+n.color:"mat-accent"),ft("_mat-animation-noopable",n._animationMode==="NoopAnimations")("mdc-checkbox--disabled",n.disabled)("mat-mdc-checkbox-disabled",n.disabled)("mat-mdc-checkbox-checked",n.checked))},inputs:{ariaLabel:[de.None,"aria-label","ariaLabel"],ariaLabelledby:[de.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[de.None,"aria-describedby","ariaDescribedby"],id:"id",required:[de.HasDecoratorInputTransform,"required","required",ot],labelPosition:"labelPosition",name:"name",value:"value",disableRipple:[de.HasDecoratorInputTransform,"disableRipple","disableRipple",ot],tabIndex:[de.HasDecoratorInputTransform,"tabIndex","tabIndex",i=>i==null?void 0:Dr(i)],color:"color",checked:[de.HasDecoratorInputTransform,"checked","checked",ot],disabled:[de.HasDecoratorInputTransform,"disabled","disabled",ot],indeterminate:[de.HasDecoratorInputTransform,"indeterminate","indeterminate",ot]},outputs:{change:"change",indeterminateChange:"indeterminateChange"},exportAs:["matCheckbox"],standalone:!0,features:[_i([Mme,{provide:Ru,useExisting:e,multi:!0}]),wi,ir,Xt],ngContentSelectors:Tme,decls:15,vars:19,consts:[["checkbox",""],["input",""],["label",""],["mat-internal-form-field","",3,"click","labelPosition"],[1,"mdc-checkbox"],[1,"mat-mdc-checkbox-touch-target",3,"click"],["type","checkbox",1,"mdc-checkbox__native-control",3,"blur","click","change","checked","indeterminate","disabled","id","required","tabIndex"],[1,"mdc-checkbox__ripple"],[1,"mdc-checkbox__background"],["focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mdc-checkbox__checkmark"],["fill","none","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-checkbox__checkmark-path"],[1,"mdc-checkbox__mixedmark"],["mat-ripple","",1,"mat-mdc-checkbox-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-label",3,"for"]],template:function(r,n){if(r&1){let a=Ue();ti(),S(0,"div",3),q("click",function(s){return j(a),W(n._preventBubblingFromLabel(s))}),S(1,"div",4,0)(3,"div",5),q("click",function(){return j(a),W(n._onTouchTargetClick())}),A(),S(4,"input",6,1),q("blur",function(){return j(a),W(n._onBlur())})("click",function(){return j(a),W(n._onInputClick())})("change",function(s){return j(a),W(n._onInteractionEvent(s))}),A(),ae(6,"div",7),S(7,"div",8),Ca(),S(8,"svg",9),ae(9,"path",10),A(),Bp(),ae(10,"div",11),A(),ae(11,"div",12),A(),S(12,"label",13,2),it(14),A()()}if(r&2){let a=kt(2);O("labelPosition",n.labelPosition),P(4),ft("mdc-checkbox--selected",n.checked),O("checked",n.checked)("indeterminate",n.indeterminate)("disabled",n.disabled)("id",n.inputId)("required",n.required)("tabIndex",n.disabled?-1:n.tabIndex),Ft("aria-label",n.ariaLabel||null)("aria-labelledby",n.ariaLabelledby)("aria-describedby",n.ariaDescribedby)("aria-checked",n.indeterminate?"mixed":null)("name",n.name)("value",n.value),P(7),O("matRippleTrigger",a)("matRippleDisabled",n.disableRipple||n.disabled)("matRippleCentered",!0),P(),O("for",n.inputId)}},dependencies:[Zo,_y],styles:['.mdc-touch-target-wrapper{display:inline}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:mdc-animation-deceleration-curve-timing-function;transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom}.mdc-checkbox[hidden]{display:none}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{border-color:CanvasText}}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{border-color:CanvasText}}@media all and (-ms-high-contrast: none){.mdc-checkbox .mdc-checkbox__focus-ring{display:none}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-checkbox__mixedmark{margin:0 1px}}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:rgba(0,0,0,0);pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--upgraded .mdc-checkbox__checkmark{opacity:1}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear 0s;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear 0s;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background{transition:border-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit}.mdc-checkbox__native-control:disabled{cursor:default;pointer-events:none}.mdc-checkbox--touch{margin:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2)}.mdc-checkbox--touch .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);right:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);width:var(--mdc-checkbox-state-layer-size);height:var(--mdc-checkbox-state-layer-size)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 180ms 0ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark-path,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__mixedmark{transition:none}.mdc-checkbox{padding:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2);margin:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2)}.mdc-checkbox .mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color);background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background{border-color:transparent;background-color:var(--mdc-checkbox-disabled-selected-icon-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}@keyframes mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}}@keyframes mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}}.mdc-checkbox.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}@keyframes mdc-checkbox-fade-in-background-FF212121FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}}@keyframes mdc-checkbox-fade-out-background-FF212121FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}}.mdc-checkbox:hover.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:hover.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-FF212121FFF4433600000000FFF44336}.mdc-checkbox:hover.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:hover.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-FF212121FFF4433600000000FFF44336}.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}@keyframes mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}}@keyframes mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}}.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox .mdc-checkbox__background{top:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2)}.mdc-checkbox .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);right:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);width:var(--mdc-checkbox-state-layer-size);height:var(--mdc-checkbox-state-layer-size)}.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:focus:not(:checked):not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-focus-icon-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-focus-icon-color);background-color:var(--mdc-checkbox-selected-focus-icon-color)}.mdc-checkbox:hover .mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox:hover .mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}.mat-mdc-checkbox{display:inline-block;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-checkbox .mdc-checkbox__background{-webkit-print-color-adjust:exact;color-adjust:exact}.mat-mdc-checkbox._mat-animation-noopable *,.mat-mdc-checkbox._mat-animation-noopable *::before{transition:none !important;animation:none !important}.mat-mdc-checkbox label{cursor:pointer}.mat-mdc-checkbox.mat-mdc-checkbox-disabled label{cursor:default;color:var(--mat-checkbox-disabled-label-color)}.mat-mdc-checkbox label:empty{display:none}.cdk-high-contrast-active .mat-mdc-checkbox.mat-mdc-checkbox-disabled{opacity:.5}.cdk-high-contrast-active .mat-mdc-checkbox .mdc-checkbox__checkmark{--mdc-checkbox-selected-checkmark-color: CanvasText;--mdc-checkbox-disabled-selected-checkmark-color: CanvasText}.mat-mdc-checkbox .mdc-checkbox__ripple{opacity:0}.mat-mdc-checkbox-ripple,.mdc-checkbox__ripple{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-checkbox-ripple:not(:empty),.mdc-checkbox__ripple:not(:empty){transform:translateZ(0)}.mat-mdc-checkbox-ripple .mat-ripple-element{opacity:.1}.mat-mdc-checkbox-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-checkbox-touch-target-display)}.mat-mdc-checkbox-ripple::before{border-radius:50%}.mdc-checkbox__native-control:focus~.mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}}return e})();var _U=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[Ap,Et,Et]})}}return e})();var xU=(()=>{class e{formBuilder;n_points=1024;t_start=0;t_stop=8;fe=2;y1=!0;y2=!0;y3=!0;y1Phase=0;y2Phase=2;y3Phase=4;original_data=Array(this.n_points);sampled_data=Array(this.n_points);original_fft=Array(this.n_points);sampled_fft=Array(this.n_points);original_graph;sampled_graph;original_fft_graph;sampled_fft_graph;echartInstanceSampledGraph;echartsInstanceOriginalGraph;echartsInstanceOriginalFFTGraph;echartsInstanceSampledFFTGraph;constructor(i){this.formBuilder=i,this.createData(),this.update_fft_chart(),this.initialize_echarts()}ngAfterViewInit(){this.update_fe(this.fe),this.update_fft_chart()}initialize_echarts(){let i={xAxis:{min:this.t_start,max:this.t_stop},yAxis:{min:-7,max:7}};this.original_graph=Object.assign({},i),this.original_graph.series=[{data:this.original_data,type:"line",showSymbol:!1,animation:!1},{data:this.sampled_data,type:"bar",barWidth:2}],this.original_graph.title={text:"Original Signal"},this.sampled_graph=Object.assign({},i),this.sampled_graph.title={text:"Sampled Signal"},this.sampled_graph.series=[{data:this.sampled_data,type:"line",showSymbol:!0}],this.sampled_fft_graph=Object.assign({},i),this.sampled_fft_graph.title={text:"Sampled Signal FFT"},this.original_fft_graph=Object.assign({},i),this.original_fft_graph.title={text:"Original Signal FFT"}}createData(){let i=Pv(this.t_start,this.t_stop,this.n_points);this.original_data=new Array(this.n_points);for(let r=0;r<this.n_points;r++){let n=i[r];this.original_data[r]=[n,this.signal(n)]}this.resample_signal(),this.original_graph&&Array.isArray(this.original_graph.series)&&(this.original_graph.series[0].data=this.original_data,this.echartsInstanceOriginalGraph?.setOption(this.original_graph)),this.update_fft_chart()}resample_signal(){let i=1/this.fe,r=Math.round(this.t_stop/i),n=Pv(this.t_start,this.t_stop,r+1);this.sampled_data=new Array(r+1);for(let a=0;a<=r;a++){let o=n[a];this.sampled_data[a]=[o,this.signal(o)]}}recompute(){this.createData(),this.update_fe(this.fe)}signal(i){let r=this.y1?Math.sin(2*Math.PI*.5*i-this.y1Phase)*4:0,n=this.y2?Math.sin(2*Math.PI*1*i+2-this.y2Phase)*2:0,a=this.y3?Math.sin(2*Math.PI*4*i+4-this.y3Phase)*1:0;return r+n+a}update_fft_chart(){let i=lM(this.original_data.map(a=>a[1])),r=this.n_points/(this.t_stop-this.t_start),n={xAxis:{min:0,max:5},yAxis:{min:0,max:5},series:[{data:i.map((a,o)=>[o*r/this.n_points,a]),type:"bar"}]};this.original_fft_graph=Object.assign({},n),this.original_fft_graph.title={text:"Fourier Transform of the original signal"},this.echartsInstanceOriginalFFTGraph?.setOption(this.original_fft_graph),this.update_sampled_fft_chart()}update_sampled_fft_chart(){if(this.sampled_data.length==0)return;let i=new Array(this.n_points),r=this.n_points/(this.t_stop-this.t_start),n=this.sampled_data.length,a=1/this.fe;for(let c=0;c<this.n_points;c++){let d=n/this.n_points*c,u=Math.floor(d);if(u==n-1)i[c]=this.sampled_data[n-1];else{let h=d-u;i[c]=[this.t_start+c/r,(1-h)*this.sampled_data[u][1]+h*this.sampled_data[u+1][1]]}}let o=lM(i.map(c=>c[1])),s=o.length/(this.t_stop-this.t_start),l={xAxis:{min:0,max:5},yAxis:{min:0,max:5},series:[{data:o.map((c,d)=>[d*s/o.length,c]),type:"bar"}]};this.sampled_fft_graph=Object.assign({},l),this.sampled_fft_graph.title={text:"Fourier Transform of the sampled signal"},this.echartsInstanceSampledFFTGraph?.setOption(this.sampled_fft_graph)}onSampledChartInit(i){this.echartInstanceSampledGraph=i}onOriginalChartInit(i){this.echartsInstanceOriginalGraph=i}onFFTChartInit(i){this.echartsInstanceOriginalFFTGraph=i}onSampledFFTChartInit(i){this.echartsInstanceSampledFFTGraph=i}update_fe(i){i&&(this.fe=i,this.resample_signal(),Array.isArray(this.sampled_graph.series)&&(this.sampled_graph.series[0].data=this.sampled_data,this.sampled_graph.title={text:`Sampled Signal fe = ${this.fe}, N = ${this.sampled_data.length}`},this.echartInstanceSampledGraph?.setOption(this.sampled_graph),Array.isArray(this.original_graph.series)&&(this.original_graph.series[1].data=this.sampled_data,this.echartsInstanceOriginalGraph?.setOption(this.original_graph))),this.update_fft_chart())}static \u0275fac=function(r){return new(r||e)(z(F5))};static \u0275cmp=Ae({type:e,selectors:[["app-sampling"]],decls:26,vars:24,consts:[[3,"rightDrawer"],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],[3,"change","checked"],[3,"valueChange","change","value","min","max","step"],[1,"w-64"],["title","Sub sampling frequency",3,"valueChange","value","max","min","step"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],[1,"grid","md:grid-cols-2","w-full","gap-2","p-2"],["echarts","",1,"bg-white",3,"chartInit","options"]],template:function(r,n){r&1&&(S(0,"app-tutorial-template",0),G(1," Sampling Frequency and Nyquist-Shannon Theorem "),At(2,1),S(3,"mat-label"),G(4,"Components"),A(),S(5,"p")(6,"mat-checkbox",2),q("change",function(){return n.y1=!n.y1,n.recompute()}),G(7,"Y1"),A(),S(8,"app-labelled-sliders",3),Pt("valueChange",function(o){return Dt(n.y1Phase,o)||(n.y1Phase=o),o}),q("change",function(){return n.recompute()}),A()(),S(9,"p")(10,"mat-checkbox",2),q("change",function(){return n.y2=!n.y2,n.recompute()}),G(11,"Y2"),A(),S(12,"app-labelled-sliders",3),Pt("valueChange",function(o){return Dt(n.y2Phase,o)||(n.y2Phase=o),o}),q("change",function(){return n.recompute()}),A()(),S(13,"p")(14,"mat-checkbox",2),q("change",function(){return n.y3=!n.y3,n.recompute()}),G(15,"Y3"),A(),S(16,"app-labelled-sliders",3),Pt("valueChange",function(o){return Dt(n.y3Phase,o)||(n.y3Phase=o),o}),q("change",function(){return n.recompute()}),A()(),S(17,"p",4),G(18," The Nyquist-Shannon theorem states that a signal must be sampled at a rate of at least twice the highest frequency component in the signal in order to be able to reconstruct the original signal from the samples. This is known as the Nyquist rate. "),A(),S(19,"app-labelled-sliders",5),q("valueChange",function(o){return n.update_fe(o)}),A(),Tt(),At(20,6),S(21,"div",7)(22,"div",8),q("chartInit",function(o){return n.onOriginalChartInit(o)}),A(),S(23,"div",8),q("chartInit",function(o){return n.onSampledChartInit(o)}),A(),S(24,"div",8),q("chartInit",function(o){return n.onFFTChartInit(o)}),A(),S(25,"div",8),q("chartInit",function(o){return n.onSampledFFTChartInit(o)}),A()(),Tt(),A()),r&2&&(O("rightDrawer",!1),P(6),O("checked",n.y1),P(2),Nt("value",n.y1Phase),O("min",0)("max",6.28)("step",.05),P(2),O("checked",n.y2),P(2),Nt("value",n.y2Phase),O("min",0)("max",6.28)("step",.05),P(2),O("checked",n.y3),P(2),Nt("value",n.y3Phase),O("min",0)("max",6.28)("step",.05),P(3),O("value",n.fe)("max",64)("min",0)("step",.1),P(3),O("options",n.original_graph),P(),O("options",n.sampled_graph),P(),O("options",n.original_fft_graph),P(),O("options",n.sampled_fft_graph))},dependencies:[mn,Ap,Qs,hr,Ga]})}return e})();var rl=class{static getGaussianKernel(t,i,r=1,n=1){t=t%2==0?t+1:t,i=i%2==0?i+1:i;let a=(t-1)/2,o=(i-1)/2,s=Math.sqrt(2),l=new Array;for(let d=0;d<t;d++)for(let u=0;u<i;u++){let h=Math.exp(-Math.pow((d-a)/(s*r),2)-Math.pow((u-o)/(s*n),2));l.push(h)}let c=l.reduce((d,u)=>d+u,0);return l=l.map(d=>d/c),{width:t,height:i,active:!0,mat:[l],name:"Gaussian"}}static getMeanKernel(t,i){let r=new Array(t*i).fill(1/(t*i));return{width:t,height:i,active:!0,mat:[r],name:"Mean"}}static getSobelKernels(){return{width:3,height:3,active:!0,mat:[[1,0,-1,2,0,-2,1,0,-1],[1,2,1,0,0,0,-1,-2,-1]],name:"Sobel"}}static getPrewittKernels(){return{width:3,height:3,active:!0,mat:[[1,0,-1,1,0,-1,1,0,-1],[1,1,1,0,0,0,-1,-1,-1]],name:"Prewitt"}}static getLaplacianKernel(){return{width:3,height:3,active:!0,mat:[[-1,-1,-1,-1,8,-1,-1,-1,-1]],name:"Laplacian"}}static getAdditiveKernel(t){return{width:1,height:1,active:!0,mat:[[t]],name:"Add"}}static getMultiplicativeKernel(t){return{width:1,height:1,active:!0,mat:[[t]],name:"Multiply"}}};var kme=["canvas"],Nme=(e,t)=>({activated:e,deactivated:t}),yU=()=>[];function Pme(e,t){e&1&&(S(0,"mat-icon"),G(1,"visibility"),A())}function Rme(e,t){e&1&&(S(0,"mat-icon"),G(1,"visibility_off"),A())}function Fme(e,t){if(e&1&&(S(0,"td"),G(1),A()),e&2){let i=t.index,r=J().index,n=J().$implicit,a=J();P(),Vr(" ",n[r*a.kernel.width+i].toFixed(2)," ")}}function Ome(e,t){if(e&1&&(S(0,"tr"),Te(1,Fme,2,1,"td",10),A()),e&2){let i=J(2);P(),O("ngForOf",cl(1,yU).constructor(i.kernel.width))}}function Lme(e,t){if(e&1){let i=Ue();S(0,"div",8)(1,"table",9),q("mouseenter",function(){let n=j(i).$implicit,a=J();return W(a.drawFilter(n))}),Te(2,Ome,2,2,"tr",10),A()()}if(e&2){let i=J();P(2),O("ngForOf",cl(1,yU).constructor(i.kernel.height))}}var wU=(()=>{class e{kernel;updateFilters=new Pe;width;height;canvas;ctx;constructor(){}ngOnInit(){this.kernel.delete=!1;let i=this.canvas.nativeElement;this.ctx=i.getContext("2d"),this.width=this.kernel.width,this.height=this.kernel.height,i.width=this.width,i.height=this.height,this.ctx.canvas.width=this.width,this.ctx.canvas.height=this.height,this.drawFilter(this.kernel.mat[0])}delete(i){i.stopPropagation(),this.kernel.delete=!0,this.updateFilters.emit()}toggleActive(i){i.stopPropagation(),this.kernel.active=!this.kernel.active,this.updateFilters.emit()}drawFilter(i){let r=new Uint8ClampedArray(4*i.length),n=i.reduce(function(s,l){return s>l?s:l}),a=i.reduce(function(s,l){return s<l?s:l});a==n&&(a=0,n=1);for(let s=0;s<i.length;s++){let l=s*4,c=Math.round(255*(i[s]-a)/(n-a));r[l]=c,r[l+1]=c,r[l+2]=c,r[l+3]=255}let o=new ImageData(r,this.kernel.width,this.kernel.height);this.ctx.putImageData(o,0,0)}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Ae({type:e,selectors:[["app-kernel-element"]],viewQuery:function(r,n){if(r&1&&tt(kme,7),r&2){let a;Me(a=Ie())&&(n.canvas=a.first)}},inputs:{kernel:"kernel"},outputs:{updateFilters:"updateFilters"},decls:15,vars:8,consts:[["canvas",""],[3,"ngClass"],["mat-mini-fab","","color","accent",1,"action-button",3,"click"],[4,"ngIf"],[1,"title-span"],["mat-mini-fab","","color","warn",1,"action-button",3,"click"],[1,"vertical-flex","center"],["class","rounded-table",4,"ngFor","ngForOf"],[1,"rounded-table"],[3,"mouseenter"],[4,"ngFor","ngForOf"]],template:function(r,n){if(r&1){let a=Ue();S(0,"mat-expansion-panel",1)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"button",2),q("click",function(s){return j(a),W(n.toggleActive(s))}),Te(4,Pme,2,0,"mat-icon",3)(5,Rme,2,0,"mat-icon",3),A(),S(6,"span",4),G(7),A(),S(8,"button",5),q("click",function(s){return j(a),W(n.delete(s))}),S(9,"mat-icon"),G(10,"close"),A()()()(),S(11,"div",6),Te(12,Lme,3,2,"div",7),ae(13,"canvas",null,0),A()()}r&2&&(O("ngClass",hh(5,Nme,n.kernel.active,!n.kernel.active)),P(4),O("ngIf",n.kernel.active),P(),O("ngIf",!n.kernel.active),P(2),Vr(" ",n.kernel.name," "),P(5),O("ngForOf",n.kernel.mat))},dependencies:[Es,Fn,cn,Kl,Ql,pd,lp,$n],styles:["canvas[_ngcontent-%COMP%]{width:128px;aspect-ratio:1;image-rendering:-moz-crisp-edges;image-rendering:-webkit-crisp-edges;image-rendering:pixelated;image-rendering:crisp-edges;box-shadow:#0000001f 0 1px 3px,#0000003d 0 1px 2px;border-radius:.5em}.title-span[_ngcontent-%COMP%]{margin:auto}tr[_ngcontent-%COMP%]:nth-child(odd){background-color:#646464}.horizontal-flex[_ngcontent-%COMP%]{width:100%}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#6f9b75}td[_ngcontent-%COMP%]{font-size:small}.center[_ngcontent-%COMP%]{align-items:center;gap:1em}.deactivated[_ngcontent-%COMP%]:not(button){filter:brightness(.7);border:solid white 1px}.rounded-table[_ngcontent-%COMP%]{border-radius:.75em;overflow:hidden;box-shadow:#0000001f 0 1px 3px,#0000003d 0 1px 2px}button[_ngcontent-%COMP%]{transform:scale(.5)}"]})}return e})();function Vme(e,t){if(e&1){let i=Ue();S(0,"button",25),q("click",function(){j(i);let n=J();return W(n.cleanFilterList())}),G(1," Clear "),A()}}function zme(e,t){if(e&1){let i=Ue();S(0,"app-kernel-element",26),q("updateFilters",function(){j(i);let n=J();return W(n.updateFilters())}),A()}if(e&2){let i=t.$implicit;O("kernel",i)}}var CU=(()=>{class e extends za{listKernels;updateFilters(){this.listKernels=this.listKernels.filter(i=>!i.delete),this.applyFilter()}ngAfterContentInit(){this.listKernels=new Array}laplacianFilter(){this.listKernels.push(rl.getLaplacianKernel()),this.applyFilter()}gaussianBlur(i,r,n){this.listKernels.push(rl.getGaussianKernel(i,i,r,n)),this.applyFilter()}meanFilter(i){this.listKernels.push(rl.getMeanKernel(i,i)),this.applyFilter()}prewittFilter(){this.listKernels.push(rl.getPrewittKernels()),this.applyFilter()}sobelFilter(){this.listKernels.push(rl.getSobelKernels()),this.applyFilter()}additiveFilter(i){this.listKernels.push(rl.getAdditiveKernel(i)),this.applyFilter()}multiplyFilter(i){this.listKernels.push(rl.getMultiplicativeKernel(i)),this.applyFilter()}cleanFilterList(){this.listKernels=new Array,this.applyFilter()}applyFilter(){let i=cv.imread(this.drawCanvas.getCanvas()),r=new cv.Mat;i.convertTo(r,cv.CV_32F,1/255),cv.cvtColor(r,r,cv.COLOR_RGB2GRAY),this.listKernels.forEach(n=>{if(n.active)if(n.name=="Add")r.convertTo(r,-1,1,n.mat[0][0]);else if(n.name=="Multiply")r.convertTo(r,-1,n.mat[0][0],0);else if(n.mat.length==2){let a=cv.matFromArray(n.width,n.height,cv.CV_32F,n.mat[0]),o=new cv.Mat;cv.filter2D(r,o,-1,a),cv.pow(o,2,o),a=cv.matFromArray(n.width,n.height,cv.CV_32F,n.mat[1]);let s=new cv.Mat;cv.filter2D(r,s,-1,a),cv.pow(s,2,s),cv.add(o,s,r),cv.pow(r,.5,r),a.delete(),o.delete(),s.delete()}else{let a=cv.matFromArray(n.width,n.height,cv.CV_32F,n.mat[0]);cv.filter2D(r,r,-1,a),a.delete()}}),cv.convertScaleAbs(r,r,255),cv.imshow(this.outputCanvas.getCanvas(),r),i.delete(),r.delete()}static \u0275fac=(()=>{let i;return function(n){return(i||(i=sr(e)))(n||e)}})();static \u0275cmp=Ae({type:e,selectors:[["app-spatial-filtering"]],features:[Ot],decls:99,vars:32,consts:[["brushSizeSlider",""],["additiveFilterSlider",""],["multiplyFilterSlider",""],["meanFilterSlider",""],["gaussSizeSlider",""],["gaussSTDSliderX",""],["gaussSDTSliderY",""],["inputCanvas",""],["outputCanvas",""],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["title","Brush Size"],[1,"filter-name"],["mat-mini-fab","","color","accent",1,"action-button",3,"click"],["title","Addition factor",3,"max","min","value","step"],["mat-raised-button","","color","primary",1,"add-button",3,"click"],["title","Multiplication factor",3,"max","min","value","step"],["title","Kernel size",3,"max","min","value","step"],["title","STD X",3,"max","min","value","step"],["title","STD Y",3,"max","min","value","step"],["ngProjectAs","[drawerRight]",5,["","drawerRight",""]],["mat-raised-button","","color","warn","class","fillWidth",3,"click",4,"ngIf"],[3,"kernel","updateFilters",4,"ngFor","ngForOf"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["title","Canvas",1,"canvas",3,"drawingEnded","width","drawable","BWOption","brushRadius"],["title","Filtered canvas",1,"canvas",3,"width","drawable"],["mat-raised-button","","color","warn",1,"fillWidth",3,"click"],[3,"updateFilters","kernel"]],template:function(r,n){if(r&1){let a=Ue();S(0,"app-tutorial-template-images"),G(1," Spatial filtering "),At(2,9),ae(3,"app-labelled-sliders",10,0)(5,"hr"),S(6,"mat-expansion-panel")(7,"mat-expansion-panel-header")(8,"mat-panel-title")(9,"span",11)(10,"button",12),q("click",function(s){j(a);let l=kt(15);return n.additiveFilter(l.value),W(s.stopPropagation())}),S(11,"mat-icon"),G(12," add "),A()(),G(13," Brightness "),A()()(),ae(14,"app-labelled-sliders",13,1),S(16,"button",14),q("click",function(){j(a);let s=kt(15);return W(n.additiveFilter(s.value))}),G(17," Add "),A()(),S(18,"mat-expansion-panel")(19,"mat-expansion-panel-header")(20,"mat-panel-title")(21,"span",11)(22,"button",12),q("click",function(s){j(a);let l=kt(27);return n.multiplyFilter(l.value),W(s.stopPropagation())}),S(23,"mat-icon"),G(24," add "),A()(),G(25," Contrast "),A()()(),ae(26,"app-labelled-sliders",15,2),S(28,"button",14),q("click",function(){j(a);let s=kt(27);return W(n.multiplyFilter(s.value))}),G(29," Add "),A()(),S(30,"mat-expansion-panel")(31,"mat-expansion-panel-header")(32,"mat-panel-title")(33,"span",11)(34,"button",12),q("click",function(s){j(a);let l=kt(39);return n.meanFilter(l.value),W(s.stopPropagation())}),S(35,"mat-icon"),G(36," add "),A()(),G(37," Mean blur "),A()()(),ae(38,"app-labelled-sliders",16,3),S(40,"button",14),q("click",function(){j(a);let s=kt(39);return W(n.meanFilter(s.value))}),G(41," Add "),A()(),S(42,"mat-expansion-panel")(43,"mat-expansion-panel-header")(44,"mat-panel-title")(45,"span",11)(46,"button",12),q("click",function(s){j(a);let l=kt(51),c=kt(53),d=kt(55);return n.gaussianBlur(l.value,c.value,d.value),W(s.stopPropagation())}),S(47,"mat-icon"),G(48," add "),A()(),G(49," Gaussian blur "),A()()(),ae(50,"app-labelled-sliders",16,4)(52,"app-labelled-sliders",17,5)(54,"app-labelled-sliders",18,6),S(56,"button",14),q("click",function(){j(a);let s=kt(51),l=kt(53),c=kt(55);return W(n.gaussianBlur(s.value,l.value,c.value))}),G(57," Add "),A()(),S(58,"mat-expansion-panel")(59,"mat-expansion-panel-header")(60,"mat-panel-title")(61,"span",11)(62,"button",12),q("click",function(s){return j(a),n.prewittFilter(),W(s.stopPropagation())}),S(63,"mat-icon"),G(64," add "),A()(),G(65," Prewitt Filter "),A()()(),S(66,"button",14),q("click",function(){return j(a),W(n.prewittFilter())}),G(67," Add "),A()(),S(68,"mat-expansion-panel")(69,"mat-expansion-panel-header")(70,"mat-panel-title")(71,"span",11)(72,"button",12),q("click",function(s){return j(a),n.sobelFilter(),W(s.stopPropagation())}),S(73,"mat-icon"),G(74," add "),A()(),G(75," Sobel Filter "),A()()(),S(76,"button",14),q("click",function(){return j(a),W(n.sobelFilter())}),G(77," Add "),A()(),S(78,"mat-expansion-panel")(79,"mat-expansion-panel-header")(80,"mat-panel-title")(81,"span",11)(82,"button",12),q("click",function(s){return j(a),n.laplacianFilter(),W(s.stopPropagation())}),S(83,"mat-icon"),G(84," add "),A()(),G(85," Laplacian Filter "),A()()(),S(86,"button",14),q("click",function(){return j(a),W(n.laplacianFilter())}),G(87," Add "),A()(),Tt(),At(88,19),S(89,"h2"),G(90,"Active filters"),A(),Te(91,Vme,2,0,"button",20),ae(92,"hr"),Te(93,zme,1,1,"app-kernel-element",21),Tt(),At(94,22),S(95,"app-draw-canvas",23,7),q("drawingEnded",function(){return j(a),W(n.applyFilter())}),A(),ae(97,"app-draw-canvas",24,8),Tt(),A()}if(r&2){let a=kt(4);P(14),O("max",1)("min",-1)("value",0)("step",.1),P(12),O("max",5)("min",0)("value",1)("step",.1),P(12),O("max",9)("min",3)("value",3)("step",2),P(12),O("max",15)("min",3)("value",9)("step",2),P(2),O("max",15)("min",0)("value",2)("step",.5),P(2),O("max",15)("min",0)("value",2)("step",.5),P(37),O("ngIf",n.listKernels.length),P(2),O("ngForOf",n.listKernels),P(2),O("width",512)("drawable",!0)("BWOption",!0)("brushRadius",a.value),P(2),O("width",512)("drawable",!1)}},dependencies:[Fn,cn,Kl,Ql,pd,Lr,lp,$n,Ua,wU,hr,ja],styles:[".filter-name[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transform:scale(.5)}.add-button[_ngcontent-%COMP%]{width:100%}mat-expansion-panel[_ngcontent-%COMP%]{width:100%}.canvas[_ngcontent-%COMP%]{width:45%;min-width:256px}"]})}return e})();var EU=(()=>{class e extends za{width=256;updateFFT(){let i=cv.imread(this.drawCanvas.getCanvas());cv.cvtColor(i,i,cv.COLOR_RGBA2GRAY,0);let r=cv.getOptimalDFTSize(i.rows),n=cv.getOptimalDFTSize(i.cols),a=cv.Scalar.all(0),o=new cv.Mat;cv.copyMakeBorder(i,o,0,r-i.rows,0,n-i.cols,cv.BORDER_CONSTANT,a);let s=new cv.Mat;o.convertTo(s,cv.CV_32F);let l=new cv.MatVector,c=new cv.Mat,d=new cv.Mat.zeros(o.rows,o.cols,cv.CV_32F);l.push_back(s),l.push_back(d),cv.merge(l,c),cv.dft(c,c,cv.DFT_SCALE),cv.split(c,l),cv.magnitude(l.get(0),l.get(1),l.get(0));let u=l.get(0),h=new cv.Mat.ones(u.rows,u.cols,u.type());cv.add(u,h,u),cv.log(u,u);let m=new cv.Rect(0,0,u.cols&-2,u.rows&-2);u=u.roi(m);let f=u.cols/2,p=u.rows/2,g=new cv.Mat,v=new cv.Rect(0,0,f,p),b=new cv.Rect(f,0,f,p),_=new cv.Rect(0,p,f,p),x=new cv.Rect(f,p,f,p),w=u.roi(v),y=u.roi(b),M=u.roi(_),T=u.roi(x);w.copyTo(g),T.copyTo(w),g.copyTo(T),y.copyTo(g),M.copyTo(y),g.copyTo(M),cv.normalize(u,u,0,1,cv.NORM_MINMAX),this.outputCanvas.drawMat(u),i.delete(),o.delete(),l.delete(),c.delete(),h.delete(),g.delete()}updateIFFT(){let i=cv.imread(this.drawCanvas.getCanvas());cv.cvtColor(i,i,cv.COLOR_RGBA2GRAY,0);let r=cv.getOptimalDFTSize(i.rows),n=cv.getOptimalDFTSize(i.cols),a=cv.Scalar.all(0),o=new cv.Mat;cv.copyMakeBorder(i,o,0,r-i.rows,0,n-i.cols,cv.BORDER_CONSTANT,a);let s=new cv.Mat;o.convertTo(s,cv.CV_32F);let l=new cv.MatVector,c=new cv.Mat,d=new cv.Mat.zeros(o.rows,o.cols,cv.CV_32F);l.push_back(s),l.push_back(d),cv.merge(l,c),cv.dft(c,c);let u=cv.imread(this.outputCanvas.getCanvas());cv.cvtColor(u,u,cv.COLOR_RGBA2GRAY,0);let h=new cv.Rect(0,0,u.cols&-2,u.rows&-2);u=u.roi(h);let m=u.cols/2,f=u.rows/2,p=new cv.Mat,g=new cv.Rect(0,0,m,f),v=new cv.Rect(m,0,m,f),b=new cv.Rect(0,f,m,f),_=new cv.Rect(m,f,m,f),x=u.roi(g),w=u.roi(v),y=u.roi(b),M=u.roi(_);x.copyTo(p),M.copyTo(x),p.copyTo(M),w.copyTo(p),y.copyTo(w),p.copyTo(y);let T=new cv.Mat;cv.threshold(u,T,0,1,cv.THRESH_BINARY),T.convertTo(T,cv.CV_32F),cv.split(c,l),console.log(c.type(),T.type()),cv.multiply(l.get(0),T,l.get(0)),cv.multiply(l.get(1),T,l.get(1)),cv.merge(l,c),cv.dft(c,c,cv.DFT_INVERSE),cv.split(c,l),cv.magnitude(l.get(0),l.get(1),l.get(0));let C=l.get(0);cv.normalize(C,C,0,1,cv.NORM_MINMAX),this.drawCanvas.drawMat(C)}static \u0275fac=(()=>{let i;return function(n){return(i||(i=sr(e)))(n||e)}})();static \u0275cmp=Ae({type:e,selectors:[["app-spectral-filtering"]],features:[Ot],decls:11,vars:8,consts:[["brushSizeSlider",""],["inputCanvas",""],["outputCanvas",""],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["title","Brush Size"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["title","Canvas",1,"canvas",3,"drawingEnded","width","drawable","BWOption","brushRadius"],["title","Fourier space",1,"canvas",3,"drawingEnded","width","drawColor","drawable","brushRadius"]],template:function(r,n){if(r&1){let a=Ue();S(0,"app-tutorial-template-images"),G(1," Spectral filtering "),At(2,3),ae(3,"app-labelled-sliders",4,0)(5,"hr"),Tt(),At(6,5),S(7,"app-draw-canvas",6,1),q("drawingEnded",function(){return j(a),W(n.updateFFT())}),A(),S(9,"app-draw-canvas",7,2),q("drawingEnded",function(){return j(a),W(n.updateIFFT())}),A(),Tt(),A()}if(r&2){let a=kt(4);P(7),O("width",n.width)("drawable",!0)("BWOption",!0)("brushRadius",a.value),P(2),O("width",n.width)("drawColor","black")("drawable",!0)("brushRadius",a.value)}},dependencies:[Ua,hr,ja],styles:[".canvas[_ngcontent-%COMP%]{width:45%;min-width:256px}"]})}return e})();var Ew=(()=>{class e{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(i){this._vertical=qn(i)}get inset(){return this._inset}set inset(i){this._inset=qn(i)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=Ae({type:e,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(r,n){r&2&&(Ft("aria-orientation",n.vertical?"vertical":"horizontal"),ft("mat-divider-vertical",n.vertical)("mat-divider-horizontal",!n.vertical)("mat-divider-inset",n.inset))},inputs:{vertical:"vertical",inset:"inset"},standalone:!0,features:[Xt],decls:0,vars:0,template:function(r,n){},styles:[".mat-divider{display:block;margin:0;border-top-style:solid;border-top-color:var(--mat-divider-color);border-top-width:var(--mat-divider-width)}.mat-divider.mat-divider-vertical{border-top:0;border-right-style:solid;border-right-color:var(--mat-divider-color);border-right-width:var(--mat-divider-width)}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}"],encapsulation:2,changeDetection:0})}}return e})(),Sw=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[Et,Et]})}}return e})();var Ume=["foreground"],Hme=["background"],AU=(()=>{class e extends za{viewerSize=256;foregroundCanvas;backgroundCanvas;backgroundData;foregroundData;meanBG=0;meanFG=0;psnr=0;localcontrast=0;rois=[{name:"Background",color:"#f55d42",initial1:{x:256,y:256},initial2:{x:400,y:400}},{name:"Foreground",color:"#44ad52",initial1:{x:128,y:128},initial2:{x:256,y:256}}];pepperSaltNoise=.1;gaussianNoise=5;ngOnInit(){}ngAfterViewInit(){super.ngAfterViewInit(),super.loadSelectedFileFromPath("assets/image_presets/phantom.png")}updateCanvasROI(i){return sl(this,null,function*(){let r=i.data;if(r==null)return;if(i.name=="Background"){var n=this.backgroundCanvas.nativeElement.getContext("2d");this.backgroundData=new Array(r.data.length/4);for(let s=0;s<r.data.length;s+=4)this.backgroundData[s/4]=(r.data[s]+r.data[s+1]+r.data[s+2])/3}else{var n=this.foregroundCanvas.nativeElement.getContext("2d");this.foregroundData=new Array(r.data.length/4);for(let l=0;l<r.data.length;l+=4)this.foregroundData[l/4]=(r.data[l]+r.data[l+1]+r.data[l+2])/3}let a={width:this.viewerSize,height:this.viewerSize},o=yield window.createImageBitmap(r,0,0,r.width,r.height,{resizeHeight:a.height,resizeWidth:a.width});requestAnimationFrame(()=>{n!=null&&r!=null&&(n.clearRect(0,0,n.canvas.width,n.canvas.height),n.canvas.width=this.viewerSize,n.canvas.height=this.viewerSize,n.drawImage(o,0,0),this.updateStats())})})}updateStats(){let i=this.backgroundData,r=this.foregroundData;this.meanBG=nM(i),this.meanFG=nM(r);let n=J6(i,this.meanBG);this.psnr=(this.meanFG-this.meanBG)/n,this.localcontrast=(this.meanFG-this.meanBG)/this.meanBG}addPepperSaltNoise(){let i=this.drawCanvas.getCtx().getImageData(0,0,this.drawCanvas.getCtx().canvas.width,this.drawCanvas.getCtx().canvas.height).data;for(let r=0;r<i.length;r+=4)Math.random()<this.pepperSaltNoise&&(Math.random()<.5?(i[r]=0,i[r+1]=0,i[r+2]=0):(i[r]=255,i[r+1]=255,i[r+2]=255));this.drawCanvas.drawArray(i)}addGaussianNoise(){let i=this.drawCanvas.getCtx().getImageData(0,0,this.drawCanvas.getCtx().canvas.width,this.drawCanvas.getCtx().canvas.height).data;for(let r=0;r<i.length;r+=4){let n=eU(0,this.gaussianNoise);i[r]+=n,i[r+1]+=n,i[r+2]+=n}this.drawCanvas.drawArray(i)}static \u0275fac=(()=>{let i;return function(n){return(i||(i=sr(e)))(n||e)}})();static \u0275cmp=Ae({type:e,selectors:[["app-psnr"]],viewQuery:function(r,n){if(r&1&&(tt(Ume,5),tt(Hme,5)),r&2){let a;Me(a=Ie())&&(n.foregroundCanvas=a.first),Me(a=Ie())&&(n.backgroundCanvas=a.first)}},features:[Ot],decls:51,vars:23,consts:[["brushSizeSlider",""],["inputCanvas",""],["background",""],["foreground",""],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],["title","Brush Size"],["title","Probability",3,"valueChange","value","min","max","step"],["mat-raised-button","","color","primary",3,"click"],["title","Gaussian Noise",3,"valueChange","value","min","max","step"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["title","Canvas",1,"w-1/2",3,"roiChanged","width","drawable","roi","brushRadius","BWOption","profileOption"],["ngProjectAs","[drawerRight]",5,["","drawerRight",""]],[1,"flex","flex-col","gap-2","mx-4"],[1,"w-64","aspect-square","border"],[1,"flex","justify-between"],[1,"flex","flex-col","gap-2"]],template:function(r,n){if(r&1){let a=Ue();S(0,"app-tutorial-template-images"),G(1," Image Quality "),At(2,4),ae(3,"app-labelled-sliders",5,0)(5,"hr"),S(6,"app-labelled-sliders",6),Pt("valueChange",function(s){return j(a),Dt(n.pepperSaltNoise,s)||(n.pepperSaltNoise=s),W(s)}),q("valueChange",function(s){return j(a),W(n.pepperSaltNoise=s)}),A(),S(7,"button",7),q("click",function(){return j(a),W(n.addPepperSaltNoise())}),G(8,"Add pepper & salt noise"),A(),ae(9,"hr"),S(10,"app-labelled-sliders",8),Pt("valueChange",function(s){return j(a),Dt(n.gaussianNoise,s)||(n.gaussianNoise=s),W(s)}),q("valueChange",function(s){return j(a),W(n.gaussianNoise=s)}),A(),S(11,"button",7),q("click",function(){return j(a),W(n.addGaussianNoise())}),G(12,"Add Gaussian noise"),A(),Tt(),At(13,9),S(14,"app-draw-canvas",10,1),q("roiChanged",function(s){return j(a),W(n.updateCanvasROI(s))}),A(),Tt(),At(16,11),S(17,"div",12)(18,"h3"),G(19,"Background"),A(),ae(20,"canvas",13,2),S(22,"div",14)(23,"p"),G(24,"Mean"),A(),S(25,"p"),G(26),A()(),ae(27,"mat-divider"),S(28,"h3"),G(29,"Foreground"),A(),ae(30,"canvas",13,3),S(32,"div",14)(33,"p"),G(34,"Mean"),A(),S(35,"p"),G(36),A()(),ae(37,"mat-divider"),S(38,"h3"),G(39,"Statistics"),A(),S(40,"div",15)(41,"div",14)(42,"p"),G(43,"SNR Differential"),A(),S(44,"p"),G(45),A()(),S(46,"div",14)(47,"p"),G(48,"Local contrast"),A(),S(49,"p"),G(50),A()()()(),Tt(),A()}if(r&2){let a=kt(4);P(6),Nt("value",n.pepperSaltNoise),O("min",0)("max",1)("step",.01),P(4),Nt("value",n.gaussianNoise),O("min",0)("max",75)("step",.5),P(4),O("width",512)("drawable",!1)("roi",n.rois)("drawable",!0)("brushRadius",a.value)("BWOption",!0)("profileOption",!1),P(6),ei("border-color",n.rois[0].color),P(6),gr(n.meanBG.toFixed(3)),P(4),ei("border-color",n.rois[1].color),P(6),gr(n.meanFG.toFixed(3)),P(9),gr(n.psnr.toFixed(3)),P(5),gr(n.localcontrast.toFixed(3))}},dependencies:[Ew,Lr,Ua,hr,ja]})}return e})();var nl=class{ctx;name;constructor(){this.ctx=[]}parameters(){return null}getName(){return this.name}description(){return[]}};function TU(e){let t=e.shape[0],i=e.shape[1],r=new kr([t,1]);for(let n=0;n<t;n++){let a=-1/0,o=0;for(let s=0;s<i;s++)e.data[n*i+s]>a&&(a=e.data[n*i+s],o=s);r.data[n]=o}return r}function DU(e,t,i){let r=e.shape[0],n=e.shape[1];if(n!==t.shape[0])throw new Error("Matrix dimensions do not match, got "+n+" and "+t.shape[0]);let a=t.shape[1],o=new kr([r,a]);for(let s=0;s<r;s++)for(let l=0;l<a;l++){for(let c=0;c<n;c++)o.data[s*a+l]+=e.data[s*n+c]*t.data[c*a+l];i!==void 0&&(o.data[s*a+l]+=i.data[l])}return o}function MU(e,t,i){for(let r=0;r<e.length();r++)e.grad[r]=Math.min(i,Math.max(t,e.grad[r]));return e}var kr=class e{data;shape;grad;require_grad=!0;constructor(t,i=!0){this.require_grad=i,this.data=new Array(t.reduce((r,n)=>r*n)).fill(0),this.shape=t,this.grad=new Array(t.reduce((r,n)=>r*n)).fill(0)}length(){return this.data.length}at(t){return this.data[t]}clone(){let t=new e(this.shape);return t.data=this.data.slice(),t.grad=this.grad.slice(),t}matmul(t,i){return DU(this,t,i)}transpose(){let[t,i]=this.shape,r=new e([i,t]);for(let n=0;n<t;n++)for(let a=0;a<i;a++)r.data[a*t+n]=this.data[n*i+a],r.grad[a*t+n]=this.grad[n*i+a];return r}T(){return this.transpose()}new_like(){return new e(this.shape)}argmax(){return TU(this)}norm(){let t=0;for(let i=0;i<this.data.length;i++)t+=this.data[i]**2;return Math.sqrt(t)}};var yo=class extends nl{weights;bias;hasBias;constructor(t,i,r=!0){super(),this.weights=new kr([t,i]);let n=Math.sqrt(2/(t+i));this.weights.data=this.weights.data.map(()=>n*(2*Math.random()-1)),this.hasBias=r,this.hasBias&&(this.bias=new kr([i])),this.name="FullyConnected"}forward(t){this.ctx=[];let i=t.matmul(this.weights,this.hasBias?this.bias:void 0);return this.ctx.push(t),i}backward(t){let i=this.ctx[0],r=t.shape[0],n=t.shape[1],a=t.new_like();if(a.data=t.grad,i.require_grad){let o=a.matmul(this.weights.T(),void 0);i.grad=o.data}if(this.weights.grad=a.T().matmul(i,void 0).T().data,this.hasBias)for(let o=0;o<r;o++)for(let s=0;s<n;s++)this.bias.grad[s]+=t.grad[o*n+s];return i}parameters(){return this.hasBias?[this.weights,this.bias]:[this.weights]}description(){return[`Input shape: ${this.weights.shape[0]}`,`Output shape: ${this.weights.shape[1]}`]}getName(){return`Fully connected (${this.weights.shape[0]} \u2192 ${this.weights.shape[1]})`}};var Jl=class extends nl{name="Activation";forward(t){throw new Error("Method not implemented.")}backward(t){throw new Error("Method not implemented.")}},fd=class extends Jl{name="RELU";forward(t){let i=t.new_like();this.ctx=[],this.ctx.push(t);for(let r=0;r<i.data.length;r++)i.data[r]=Math.max(0,t.data[r]);return i}backward(t){let i=this.ctx[0];for(let r=0;r<i.data.length;r++)i.grad[r]=i.data[r]>0?t.grad[r]:0;return i}},Tp=class extends Jl{name="Sigmoid";forward(t){let i=t.new_like();this.ctx=[],this.ctx.push(t),this.ctx.push(i);for(let r=0;r<i.data.length;r++)i.data[r]=1/(1+Math.exp(-t.data[r]));return i}backward(t){let i=this.ctx[0],r=this.ctx[1];for(let n=0;n<r.data.length;n++)i.grad[n]=t.grad[n]*r.data[n]*(1-r.data[n]);return i}},Dp=class extends Jl{name="TanH";forward(t){let i=t.new_like();this.ctx=[];for(let r=0;r<i.data.length;r++)i.data[r]=Math.tanh(t.data[r]);return this.ctx.push(t),this.ctx.push(i),i}backward(t){let i=this.ctx[0],r=this.ctx[1];for(let n=0;n<i.data.length;n++)i.grad[n]=t.grad[n]*(1-r.data[n]*r.data[n]);return i}},Mp=class extends Jl{name="Identity";forward(t){return t}backward(t){return t}},Aw=class extends Jl{name="Softmax";forward(t){let i=t.new_like(),r=t.shape[0],n=t.shape[1];this.ctx=[],this.ctx.push(t);let a=new kr([r]);for(let o=0;o<r;o++){let s=0;for(let l=0;l<n;l++)i.data[o*n+l]=Math.exp(t.data[o*n+l]),s+=i.data[o*n+l];for(let l=0;l<n;l++)i.data[o*n+l]/=s;a.data[o]=s}return this.ctx.push(a),i}backward(t){let i=this.ctx[0],r=this.ctx[1],n=i.shape[0],a=i.shape[1],o=new kr(i.shape);for(let s=0;s<n;s++)for(let l=0;l<a;l++)o.data[s*a+l]=t.data[s*a+l]*(r.data[s]-Math.exp(i.data[s*a+l]))/(r.data[s]*r.data[s]);return i.grad=o.data,i}};var Ip=class{layers;is_regression;constructor(t=!1){this.is_regression=t,this.layers=[]}addLayer(t){this.layers.push(t)}addLayerAtPosition(t,i){this.layers.splice(i,0,t)}removeLayerAtPosition(t){this.layers.splice(t,1)}forward(t){let i=t;for(let r=0;r<this.layers.length;r++)i=this.layers[r].forward(i);if(i instanceof Array&&(i=i[0]),i===null)throw new Error("Activations cannot be null");return i}inference(t){let i=this.forward(t);if(this.is_regression)return i;{let r=i.shape[0],n=i.shape[1],a=new kr([r]);for(let o=0;o<r;o++)a.data[o]=i.data[o*n+1];return a}}backward(t){for(let i=this.layers.length-1;i>=0;i--)t=this.layers[i].backward(t)}parameters(){let t=new Array;for(let i=0;i<this.layers.length;i++){let r=this.layers[i].parameters();r&&(t=t.concat(r))}return t}zero_grad(){for(let t=0;t<this.layers.length;t++){let i=this.layers[t].parameters();if(i)for(let r=0;r<i.length;r++)i[r].grad.fill(0)}}changeActivation(t){for(let i=0;i<this.layers.length;i++)if(this.layers[i]instanceof Jl){let r;t==="sigmoid"?r=new Tp:t==="tanh"?r=new Dp:t==="identity"?r=new Mp:r=new fd,this.layers[i]=r}}n_fc_layers(){let t=0;for(let i=0;i<this.layers.length;i++)this.layers[i]instanceof yo&&t++;return t}n_hidden_fc_layers(){return this.n_fc_layers()-2}swap_fc_layers(t,i){let r=0;for(let n=0;n<this.layers.length;n++){let a=this.layers[n];if(a instanceof yo){if(r===t){let o=Math.min(a.weights.shape[0],i.weights.shape[0]),s=Math.min(a.weights.shape[1],i.weights.shape[1]);for(let l=0;l<o;l++)for(let c=0;c<s;c++)i.weights.data[l*i.weights.shape[1]+c]=a.weights.data[l*a.weights.shape[1]+c],i.bias.data[l]=a.bias.data[l];this.layers[n]=i;return}r++}}}getParamsNorms(t){let i=this.layers[t].parameters();if(!i)return;let r=new Array(i.length);for(let n=0;n<i.length;n++)r[n]=i[n].norm();return r}trainableLayers(){let t=[];for(let i=0;i<this.layers.length;i++)this.layers[i].parameters()&&t.push(this.layers[i]);return t}};var gd=class{x;y;label;constructor(t,i,r){this.x=t,this.y=i,this.label=r}},Rv=class{data=[];class1Color="#313695";class2Color="#a50026";constructor(){}get(t){return this.data[t]}length(){return this.data.length}shuffle(){this.data=this.data.sort(()=>Math.random()-.5)}getBatch(t,i){let r=[];for(let o=0;o<i;o++)t*i+o>=this.data.length&&(t=0),r.push(this.data[t*i+o]);let n=new kr([i,2],!1);n.data=r.map(o=>[o.x,o.y]).flat();let a=new kr([i,1],!1);return a.data=r.map(o=>o.label),[n,a]}getCSSForPoint(t){let i=(this.data[t].x+1)/2*100,r=(this.data[t].y+1)/2*100;return{left:i+"%",top:r+"%","background-color":this.data[t].label?this.class1Color:this.class2Color}}createLinearlySeparable(t){let i=[];for(let r=0;r<t;r++){let n=Math.random()*2-1,a=Math.random()*2-1,o=n>a?1:0;i.push(new gd(n,a,o))}this.data=i}createSpiralPoints(t,i=1){let r=[];for(let n=0;n<t/2;n++){let a=n/(t/2),o=i*n/t*4*Math.PI,s=i*n/t*4*Math.PI+Math.PI,l=a*Math.sin(o)+Math.random()*.25,c=a*Math.cos(o)+Math.random()*.25;l=Math.max(Math.min(1,l),-1),c=Math.max(Math.min(1,c),-1);let d=1;r.push(new gd(l,c,d)),l=a*Math.sin(s)+Math.random()*.25,c=a*Math.cos(s)+Math.random()*.25,l=Math.max(Math.min(1,l),-1),c=Math.max(Math.min(1,c),-1),d=0,r.push(new gd(l,c,d))}this.data=r}createCircularPoints(t){let i=[];for(let r=0;r<t;r++){let n=Math.random()*2-1,a=Math.random()*2-1,o=Math.sqrt(n*n+a*a)<.5?1:0;i.push(new gd(n,a,o))}this.data=i}};var Fv=class{lr;weight_decay;model;momentum;momentums},al=class extends Fv{nesterov;constructor(t,i,r=0,n=0,a=!1){super(),this.model=t,this.lr=i,this.weight_decay=r,this.momentum=n,this.nesterov=a}reset_momentums(){if(this.momentum!=0){this.momentums=[];let t=this.model.parameters();for(let i=0;i<t.length;i++)this.momentums.push(new Array(t[i].length()).fill(0))}}step(){let t=this.model.parameters();for(let i=0;i<t.length;i++){let r=t[i];if(r=MU(r,-10,10),this.weight_decay!=0)for(let n=0;n<r.length();n++)r.grad[n]+=this.weight_decay*r.data[n];if(this.momentums)if(this.momentums[i]=r.grad,this.nesterov)for(let n=0;n<r.length();n++)r.grad[n]+=this.momentum*this.momentums[i][n];else r.grad=this.momentums[i];for(let n=0;n<r.length();n++)r.data[n]-=this.lr*r.grad[n]}}zero_grad(){this.model.zero_grad()}},kp=class extends Fv{beta1;beta2;epsilon;velocities;constructor(t,i,r=0,n=.9,a=.999,o=1e-8){super(),this.model=t,this.lr=i,this.weight_decay=r,this.beta1=n,this.beta2=a,this.epsilon=o}reset_momentums(){if(this.momentum!=0){this.momentums=[],this.velocities=[];let t=this.model.parameters();for(let i=0;i<t.length;i++)this.momentums.push(new Array(t[i].length()).fill(0)),this.velocities.push(new Array(t[i].length()).fill(0))}}step(){let t=this.model.parameters();for(let i=0;i<t.length;i++){let r=t[i];if(this.weight_decay!=0)for(let n=0;n<r.length();n++)r.grad[n]+=this.weight_decay*r.data[n];if(this.momentums&&this.velocities){this.momentums[i]=this.momentums[i].map((o,s)=>this.beta1*o+(1-this.beta1)*r.grad[s]),this.velocities[i]=this.velocities[i].map((o,s)=>this.beta2*o+(1-this.beta2)*r.grad[s]*r.grad[s]);let n=this.momentums[i].map(o=>o/(1-Math.pow(this.beta1,1))),a=this.velocities[i].map(o=>o/(1-Math.pow(this.beta2,1)));for(let o=0;o<r.length();o++)r.data[o]-=this.lr*n[o]/(Math.sqrt(a[o])+this.epsilon)}}}zero_grad(){this.model.zero_grad()}},Np=class extends Fv{rho;epsilon;squared_gradients;constructor(t,i,r,n=.9,a=1e-8){super(),this.model=t,this.lr=i,this.weight_decay=r,this.rho=n,this.epsilon=a}reset_momentums(){this.squared_gradients=[];let t=this.model.parameters();for(let i=0;i<t.length;i++)this.squared_gradients.push(new Array(t[i].length()).fill(0))}step(){let t=this.model.parameters();for(let i=0;i<t.length;i++){let r=t[i];if(this.weight_decay!=0)for(let n=0;n<r.length();n++)r.grad[n]+=this.weight_decay*r.data[n];this.squared_gradients[i]=this.squared_gradients[i].map((n,a)=>(n=this.rho*n+(1-this.rho)*r.grad[a]*r.grad[a],r.data[a]-=this.lr*r.grad[a]/(Math.sqrt(n)+this.epsilon),n))}}zero_grad(){this.model.zero_grad()}};var Ov=class{model;dataset;loss;optimizer;currentEpoch=0;losses=[];trainTimeout;constructor(t,i,r){this.model=t,this.loss=i,this.optimizer=r}setDataset(t){this.dataset=t}train(t){if(!this.dataset)return;let i=0,r=0;this.trainTimeout=setInterval(()=>{if(i<this.dataset.length()/t){let n=this.dataset.getBatch(i,t);r+=this.train_step(n).data[0],i++}else this.currentEpoch++,this.losses.push(r/i),r=0,i=0},0)}train_step(t){this.optimizer.zero_grad();let i=t[0],r=t[1],n=this.model.forward(i),a=this.loss.forward([n,r]),o=this.loss.backward();return this.model.backward(o),this.optimizer.step(),a}stopTraining(){this.trainTimeout&&clearInterval(this.trainTimeout)}changeOptimizer(t,i,r){t==="adam"?this.optimizer=new kp(this.model,i,r):t==="sgd"?this.optimizer=new al(this.model,i,r):this.optimizer=new Np(this.model,i,r),this.optimizer.reset_momentums()}correctlyPredicted(){let t=0,i=this.dataset.getBatch(0,this.dataset.length()),r=i[0],n=i[1],a=this.model.forward(r).argmax(),o=r.shape[0];for(let s=0;s<o;s++)a.at(s)==n.at(s)&&t++;return t}};var Lv=class extends nl{is_logits;constructor(t=!0){super(),this.is_logits=t}forward(t){let i=t[0],r=t[1],n=i.shape[0],a=i.shape[1];this.ctx=t;let o=new kr([1]);this.is_logits&&(i=new Aw().forward(i)),o.data=[0];for(let s=0;s<n;s++)for(let l=0;l<a;l++)o.data[0]+=+(r.at(s)==l)*Math.log(i.at(s*a+l)+1e-10);return o.data[0]/=-Math.max(n,1),o}backward(){let t=this.ctx[0],i=this.ctx[1],r=t.shape[0],n=t.shape[1];for(let a=0;a<r;a++){let o=i.at(a);for(let s=0;s<n;s++)s===o?t.grad[a*n+s]=(t.at(a*n+s)-1)/r:t.grad[a*n+s]=t.at(a*n+s)/r}return t}};var Tw=[[.61960784,.00392157,.25882353,1],[.63652441,.02268358,.26282199,1],[.66189927,.05082661,.26881968,1],[.67881584,.06958862,.27281815,1],[.7041907,.09773164,.27881584,1],[.72110727,.11649366,.2828143,1],[.74648212,.14463668,.288812,1],[.77185698,.1727797,.29480969,1],[.78877355,.19154171,.29880815,1],[.8141484,.21968474,.30480584,1],[.83106498,.23844675,.30880431,1],[.84721261,.26120723,.30519031,1],[.8615148,.2828912,.29965398,1],[.8710496,.29734717,.29596309,1],[.88535179,.31903114,.29042676,1],[.89488658,.33348712,.28673587,1],[.90918877,.35517109,.28119954,1],[.91872357,.36962707,.27750865,1],[.93302576,.39131103,.27197232,1],[.94732795,.412995,.26643599,1],[.95686275,.42745098,.2627451,1],[.96101499,.45743945,.27658593,1],[.96378316,.47743176,.28581315,1],[.96793541,.50742022,.29965398,1],[.97208766,.53740869,.31349481,1],[.97485582,.557401,.32272203,1],[.97900807,.58738947,.33656286,1],[.98177624,.60738178,.34579008,1],[.98592849,.63737024,.35963091,1],[.98869666,.65736255,.36885813,1],[.99223376,.68619762,.38362168,1],[.99269512,.70926567,.40299885,1],[.99300269,.72464437,.41591696,1],[.99346405,.74771242,.43529412,1],[.99377163,.76309112,.44821223,1],[.99423299,.78615917,.46758939,1],[.99469435,.80922722,.48696655,1],[.99500192,.82460592,.49988466,1],[.99546328,.84767397,.51926182,1],[.99577086,.86305267,.53217993,1],[.99623222,.88319877,.55309496,1],[.99669358,.89750096,.57708574,1],[.99700115,.90703576,.59307958,1],[.99746251,.92133795,.61707036,1],[.99777009,.93087274,.63306421,1],[.99823145,.94517493,.65705498,1],[.99853902,.95470973,.67304883,1],[.99900038,.96901192,.6970396,1],[.99946175,.98331411,.72103037,1],[.99976932,.9928489,.73702422,1],[.99423299,.99769319,.74002307,1],[.98654364,.99461745,.72802768,1],[.97500961,.99000384,.7100346,1],[.96347559,.98539023,.69204152,1],[.95578624,.98231449,.68004614,1],[.94425221,.97770088,.66205306,1],[.93656286,.97462514,.65005767,1],[.92502884,.97001153,.63206459,1],[.91733948,.96693579,.6200692,1],[.90580546,.96232218,.60207612,1],[.88381392,.95340254,.59976932,1],[.86566705,.94602076,.60346021,1],[.83844675,.9349481,.60899654,1],[.82029988,.92756632,.61268743,1],[.79307958,.91649366,.61822376,1],[.76585928,.90542099,.62376009,1],[.74771242,.89803922,.62745098,1],[.72049212,.88696655,.63298731,1],[.70234525,.87958478,.6366782,1],[.67512495,.86851211,.64221453,1],[.64405998,.85628604,.64352172,1],[.62283737,.84798155,.6438293,1],[.59100346,.8355248,.64429066,1],[.56978085,.8272203,.64459823,1],[.53794694,.81476355,.64505959,1],[.51672434,.80645905,.64536717,1],[.48489043,.79400231,.64582853,1],[.45305652,.78154556,.64628989,1],[.43183391,.77324106,.64659746,1],[.4,.76078431,.64705882,1],[.38400615,.74294502,.6544406,1],[.36001538,.71618608,.66551326,1],[.33602461,.68942714,.67658593,1],[.32003076,.67158785,.6839677,1],[.29603998,.64482891,.69504037,1],[.28004614,.62698962,.70242215,1],[.25605536,.60023068,.71349481,1],[.24006151,.58239139,.72087659,1],[.21607074,.55563245,.73194925,1],[.19946175,.5289504,.73910035,1],[.212995,.51141869,.73079585,1],[.23329489,.48512111,.7183391,1],[.24682814,.46758939,.7100346,1],[.26712803,.44129181,.69757785,1],[.28742791,.41499423,.68512111,1],[.30096117,.39746251,.67681661,1],[.32126105,.37116494,.66435986,1],[.33479431,.35363322,.65605536,1],[.35509419,.32733564,.64359862,1],[.36862745,.30980392,.63529412,1]];var Gme=["heatmapCanvas"],jme=["legendHeatmap"];function Wme(e,t){if(e&1){let i=Ue();S(0,"div",42,2),q("chartInit",function(n){j(i);let a=J(3);return W(a.paramsNormsEcharts.push(n))}),A()}if(e&2){let i=J(2).index,r=J();O("options",r.allParamsNorms[r.getClosestLayer(i)])}}function qme(e,t){if(e&1&&(At(0),Te(1,Wme,2,1,"div",41),Tt()),e&2){let i=J(2);P(),O("ngIf",i.allParamsNorms)}}function $me(e,t){if(e&1&&(S(0,"mat-expansion-panel",40)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),G(3),A()(),S(4,"div",9),Te(5,qme,2,1,"ng-container",37),A()()),e&2){let i=t.$implicit;O("hideToggle",i.description().length==0)("disabled",i.description().length===0),P(3),Vr(" ",i.getName()," "),P(2),O("ngIf",i.description().length>0)}}function Xme(e,t){if(e&1){let i=Ue();At(0),S(1,"div",43),q("click",function(n){let a=j(i).index,o=J();return W(o.removePoint(n,a))}),A(),Tt()}if(e&2){let i=t.index,r=J();P(),O("ngStyle",r.dataset.getCSSForPoint(i))}}function Yme(e,t){if(e&1&&(S(0,"span"),G(1),A()),e&2){let i=J();P(),$M(" ",i.correctlyClassified," / ",i.getDatasetLength()," points accurately classified (",(100*i.correctlyClassified/i.getDatasetLength()).toFixed(1),"%)")}}var IU=(()=>{class e extends nd{cdr;heatmapCanvas;legendHeatmap;paramsNormsEcharts=[];ctx;model;dataset=new Rv;gridResolution=15;trainer;correctlyClassified=0;trainTimeout;n_points=150;n_layers=2;n_neurons=32;allParamsNorms;datasetType="linear";optimizerType="sgd";currentActivation="relu";isTraining=!1;batch_size=Math.trunc(this.n_points/2);heatmap;lr=.1;weight_decay=.001;heatmapOptions;lossOptions;constructor(i){super(),this.cdr=i}ngOnInit(){this.buildModel();let i=new al(this.model,this.lr,1e-5,.1,!0);this.trainer=new Ov(this.model,new Lv,i)}buildModel(i=!0){let r=new Ip(!1);r.addLayer(new yo(2,this.n_neurons)),r.addLayer(new fd);for(let n=0;n<this.n_layers;n++)r.addLayer(new yo(this.n_neurons,this.n_neurons)),r.addLayer(new fd);if(r.addLayer(new yo(this.n_neurons,2,!0)),this.model=r,this.model.changeActivation(this.currentActivation),i){this.allParamsNorms=[];for(let n=0;n<this.n_layers+2;n++)this.allParamsNorms.push({legend:{show:!0,backgroundColor:"rgba(255, 255, 255, 0.5)"},tooltip:{},xAxis:{type:"value",name:"Epochs",min:0},yAxis:{type:"value",name:"Norm"},series:[{data:[],type:"line"}]})}}ngAfterViewInit(){this.ctx=this.heatmapCanvas.nativeElement.getContext("2d"),this.buildHeatmapLegend(),this.resetDataset(),this.updateParamsNormsView(),setInterval(()=>{this.isTraining&&this.updateChart()},75),setInterval(()=>{this.isTraining&&this.updateParamsNormsView()},1e3)}getClosestLayer(i){return Math.floor(i/2)}buildHeatmapLegend(){let i=this.legendHeatmap.nativeElement.getContext("2d"),r=Tw.length;for(let n=0;n<this.gridResolution;n++)i.fillStyle=this.colormap(n/this.gridResolution),i.fillRect(n,0,1,1)}updateParamsNormsView(){if(!this.allParamsNorms)return;let i=this.model.trainableLayers(),r=this.trainer.currentEpoch;i.forEach((n,a)=>{let o=n.parameters();if(!o)return;let s=this.allParamsNorms[a];if(!s)return;o.forEach((c,d)=>{let u=c.norm();if(!s.series)s.series=[{data:[[r,u]],type:"line",name:d==0?"Weights":"Bias"}];else if(Array.isArray(s.series))if(s.series.length<=d)s.series.push({data:[[r,u]],type:"line",name:d==0?"Weights":"Bias"});else{let h=s.series[d].data;s.series[d].name=d==0?"Weights":"Bias",h.push([r,u])}});let l=s.xAxis;l.max=r+10,this.allParamsNorms[a]=s,this.paramsNormsEcharts[a]&&this.paramsNormsEcharts[a].setOption(s)}),this.cdr.detectChanges()}changeNumberLayer(){if(!this.model)return;this.isTraining&&this.trainer.stopTraining();let i=this.model.n_fc_layers()-2;if(this.model.n_fc_layers()!=this.n_layers){if(this.n_layers>i)for(let r=0;r<this.n_layers-i;r++)this.allParamsNorms.push({legend:{show:!0,backgroundColor:"rgba(255, 255, 255, 0.5)"},tooltip:{},xAxis:{type:"value",name:"Epochs",min:0,max:this.trainer.currentEpoch+10},yAxis:{type:"value",name:"Norm"},series:[{data:[[0,0]],type:"line"}]}),this.model.addLayerAtPosition(new yo(this.n_neurons,this.n_neurons),-1),this.currentActivation=="relu"?this.model.addLayerAtPosition(new fd,-1):this.currentActivation=="sigmoid"?this.model.addLayerAtPosition(new Tp,-1):this.currentActivation=="tanh"?this.model.addLayerAtPosition(new Dp,-1):this.model.addLayerAtPosition(new Mp,-1);else{let r=this.model.n_hidden_fc_layers();for(;r>this.n_layers;)this.allParamsNorms.pop(),this.paramsNormsEcharts.splice(-1,1),this.model.removeLayerAtPosition(-2),this.model.removeLayerAtPosition(-2),r--}this.trainer.optimizer.reset_momentums(),this.isTraining&&this.trainer.train(this.batch_size),this.cdr.detectChanges()}}changeNumberNeurons(){if(!this.n_neurons||!this.model)return;this.pauseTraining(),this.model.layers[0]=new yo(2,this.n_neurons);let i=this.model.n_fc_layers()-2;for(let r=0;r<i;r++)this.model.swap_fc_layers(r+1,new yo(this.n_neurons,this.n_neurons));this.model.swap_fc_layers(this.n_layers+1,new yo(this.n_neurons,2,!0)),this.trainer.optimizer.reset_momentums(),this.isTraining&&this.trainer.train(this.batch_size),this.cdr.detectChanges()}resetEchartsNorms(){this.allParamsNorms=[];for(let i=0;i<this.n_layers+2;i++)this.allParamsNorms.push({legend:{show:!0,backgroundColor:"rgba(255, 255, 255, 0.5)"},tooltip:{},xAxis:{type:"value",name:"Epochs",min:0},yAxis:{type:"value",name:"Norm"},series:[{data:[],type:"line"}]}),this.paramsNormsEcharts[i]&&this.paramsNormsEcharts[i].setOption(this.allParamsNorms[i])}changeLearningRate(){this.trainer.optimizer.lr=this.lr}changeWeightDecay(){this.trainer.optimizer.weight_decay=this.weight_decay}changeOptimizer(){this.pauseTraining(),this.trainer.changeOptimizer(this.optimizerType,this.lr,this.weight_decay),this.isTraining&&this.restartTraining()}pauseTraining(){this.trainer.stopTraining()}restartTraining(){this.trainer.train(this.batch_size),this.isTraining=!0}changeActivation(){this.currentActivation&&this.model&&(this.pauseTraining(),this.model.changeActivation(this.currentActivation),this.trainer.optimizer.reset_momentums(),this.isTraining&&this.trainer.train(this.batch_size),this.cdr.detectChanges())}addPoint(i){let r=this.isTraining;this.isTraining=!1,this.trainer.stopTraining();let n=this.heatmapCanvas.nativeElement.getBoundingClientRect(),a=2*(i.clientX-n.left)/n.width-1,o=2*(i.clientY-n.top)/n.height-1,s=i.shiftKey?1:0;this.dataset.data.push(new gd(a,o,s)),this.n_points++,this.updateChart(!1),this.isTraining&&this.trainer.train(this.batch_size),this.isTraining=r,this.cdr.detectChanges()}removePoint(i,r){if(!i.ctrlKey)return;let n=this.isTraining;this.isTraining=!1,this.trainer.stopTraining(),r!=-1&&(this.dataset.data.splice(r,1),this.n_points--,this.updateChart(!1),this.isTraining&&this.trainer.train(this.batch_size),this.isTraining=n,this.cdr.detectChanges())}resetModel(){this.paramsNormsEcharts=[],this.buildModel(!0),this.resetEchartsNorms();let i=new al(this.model,this.lr,1e-5,.1,!0);this.trainer=new Ov(this.model,new Lv,i),this.trainer.setDataset(this.dataset),this.updateChart()}evalMap(){this.pauseTraining();let i=[],r=new kr([this.gridResolution*this.gridResolution,2],!1);for(let s=0;s<this.gridResolution;s++)for(let l=0;l<this.gridResolution;l++){let c=s/this.gridResolution*2-1,d=l/this.gridResolution*2-1;i.push([c,d])}r.data=i.flat();let n=[],a=this.model.inference(r),o=a.shape[0];for(let s=0;s<o;s++){let l=a.data[s],c={x:i[s][0],y:i[s][1],label:l};n.push(c)}return this.isTraining&&this.restartTraining(),n}updateBatchSize(){this.batch_size&&this.isTraining&&(this.trainer.stopTraining(),setTimeout(()=>{this.restartTraining()},0))}resetDataset(){if(this.n_points===void 0||this.batch_size===void 0)return;this.batch_size=Math.min(this.n_points,this.batch_size);let i=new Rv;this.datasetType=="circular"?i.createCircularPoints(this.n_points):this.datasetType=="linear"?i.createLinearlySeparable(this.n_points):this.datasetType=="spiral"&&i.createSpiralPoints(this.n_points),this.trainer&&(this.trainer.stopTraining(),this.trainer.setDataset(i),this.dataset=i,this.isTraining&&this.trainer.train(this.batch_size)),this.model&&this.updateChart(),this.cdr.detectChanges()}switchTraining(){this.isTraining?(this.isTraining=!1,this.trainer.stopTraining()):(this.isTraining=!0,this.trainer.train(this.batch_size))}colormap(i){isNaN(i)&&(i=0);let r=Tw.length,n=Math.floor(i*r);n=Math.min(r-1,n),n=Math.max(0,n);let a=Tw[n];return`rgb(${a[0]*255}, ${a[1]*255}, ${a[2]*255})`}getDatasetLength(){return this.dataset?this.dataset.data.length:0}updateChart(i=!0){i&&(this.heatmap=this.evalMap(),this.correctlyClassified=this.trainer.correctlyPredicted());for(let r=0;r<this.gridResolution;r++)for(let n=0;n<this.gridResolution;n++){let a=this.heatmap[n*this.gridResolution+r].label;this.ctx.fillStyle=this.colormap(a),this.ctx.fillRect(n,r,1,1)}this.lossOptions={xAxis:{type:"value",name:"Epochs",min:0,max:this.trainer.losses.length+10},yAxis:{type:"value",name:"Loss"},series:[{data:this.trainer.losses.map((r,n)=>[n,r]),type:"line"}]},this.cdr.detectChanges()}static \u0275fac=function(r){return new(r||e)(z(Vt))};static \u0275cmp=Ae({type:e,selectors:[["app-gradient-descent"]],viewQuery:function(r,n){if(r&1&&(tt(Gme,5),tt(jme,5)),r&2){let a;Me(a=Ie())&&(n.heatmapCanvas=a.first),Me(a=Ie())&&(n.legendHeatmap=a.first)}},features:[Ot],decls:96,vars:40,consts:[["heatmapCanvas",""],["legendHeatmap",""],["paramsNorms",""],[3,"rightDrawer"],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],[1,"flex","flex-col","gap-2"],["mat-raised-button","","color","primary",1,"w-full",3,"click"],["multi",""],["expanded",""],[1,"flex","flex-col","gap-1"],[1,"w-full","justify-stretch",3,"ngModelChange","change","ngModel"],["value","circular",1,"flex-1"],["value","linear",1,"flex-1"],["value","spiral",1,"flex-1"],[3,"valueChange","min","max","step","title","value"],[3,"valueChange","min","max","title","value"],[3,"ngModelChange","change","ngModel"],["value","tanh"],["value","relu"],["value","sigmoid"],["value","identity"],[1,"mb-2",3,"ngModelChange","change","ngModel"],["value","sgd",1,"flex-1"],["value","adam",1,"flex-1"],["value","RMSPROP",1,"flex-1"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],[1,"flex","gap-2","items-center"],[1,"w-1/2","m-4"],[3,"hideToggle","disabled",4,"ngFor","ngForOf"],[1,"flex","flex-col","items-center","gap-4"],[1,"italic"],[1,"relative","canvasContainer","w-full"],[4,"ngFor","ngForOf"],[1,"w-full","aspect-square","absolute",3,"click","width","height"],[1,"font-semibold"],[1,"w-full","flex","flex-row","gap-1","items-center"],[1,"w-full","h-[32px]",3,"width","height"],[4,"ngIf"],["ngProjectAs","[drawerRight]",5,["","drawerRight",""]],["echarts","",1,"w-80","aspect-square",3,"options"],[3,"hideToggle","disabled"],["echarts","",3,"options","chartInit",4,"ngIf"],["echarts","",3,"chartInit","options"],[1,"absolute","datapoint",3,"click","ngStyle"]],template:function(r,n){if(r&1){let a=Ue();S(0,"app-tutorial-template",3),At(1,4),S(2,"div",5)(3,"button",6),q("click",function(){return j(a),W(n.switchTraining())}),G(4),A(),S(5,"button",6),q("click",function(){return j(a),W(n.resetModel())}),G(6," Reset model "),A(),S(7,"mat-accordion",7)(8,"mat-expansion-panel",8)(9,"mat-expansion-panel-header")(10,"mat-panel-title"),G(11," Data "),A()(),S(12,"div",9)(13,"span"),G(14,"Distribution"),A(),S(15,"mat-button-toggle-group",10),Pt("ngModelChange",function(s){return j(a),Dt(n.datasetType,s)||(n.datasetType=s),W(s)}),q("change",function(){return j(a),W(n.resetDataset())}),S(16,"mat-button-toggle",11),G(17," Circular "),A(),S(18,"mat-button-toggle",12),G(19," Linear "),A(),S(20,"mat-button-toggle",13),G(21," Spiral "),A()(),S(22,"app-labelled-sliders",14),Pt("valueChange",function(s){return j(a),Dt(n.n_points,s)||(n.n_points=s),W(s)}),q("valueChange",function(){return j(a),W(n.resetDataset())}),A(),S(23,"app-labelled-sliders",15),Pt("valueChange",function(s){return j(a),Dt(n.batch_size,s)||(n.batch_size=s),W(s)}),q("valueChange",function(){return j(a),W(n.updateBatchSize())}),A()()(),S(24,"mat-expansion-panel",8)(25,"mat-expansion-panel-header")(26,"mat-panel-title"),G(27," Network "),A()(),S(28,"div",9)(29,"app-labelled-sliders",15),Pt("valueChange",function(s){return j(a),Dt(n.n_layers,s)||(n.n_layers=s),W(s)}),q("valueChange",function(){return j(a),W(n.changeNumberLayer())}),A(),S(30,"app-labelled-sliders",15),Pt("valueChange",function(s){return j(a),Dt(n.n_neurons,s)||(n.n_neurons=s),W(s)}),q("valueChange",function(){return j(a),W(n.changeNumberNeurons())}),A(),S(31,"div",9)(32,"span"),G(33,"Activation function"),A(),S(34,"mat-button-toggle-group",16),Pt("ngModelChange",function(s){return j(a),Dt(n.currentActivation,s)||(n.currentActivation=s),W(s)}),q("change",function(){return j(a),W(n.changeActivation())}),S(35,"mat-button-toggle",17),G(36," TanH "),A(),S(37,"mat-button-toggle",18),G(38," RELU "),A(),S(39,"mat-button-toggle",19),G(40," Sigmoid "),A(),S(41,"mat-button-toggle",20),G(42," Identity "),A()()()()(),S(43,"mat-expansion-panel",8)(44,"mat-expansion-panel-header")(45,"mat-panel-title"),G(46," Training "),A()(),S(47,"div",9)(48,"app-labelled-sliders",14),Pt("valueChange",function(s){return j(a),Dt(n.lr,s)||(n.lr=s),W(s)}),q("valueChange",function(){return j(a),W(n.changeLearningRate())}),A(),S(49,"app-labelled-sliders",14),Pt("valueChange",function(s){return j(a),Dt(n.weight_decay,s)||(n.weight_decay=s),W(s)}),q("valueChange",function(){return j(a),W(n.changeWeightDecay())}),A(),S(50,"span"),G(51,"Optimizer"),A(),S(52,"mat-button-toggle-group",21),Pt("ngModelChange",function(s){return j(a),Dt(n.optimizerType,s)||(n.optimizerType=s),W(s)}),q("change",function(){return j(a),W(n.changeOptimizer())}),S(53,"mat-button-toggle",22),G(54," SGD "),A(),S(55,"mat-button-toggle",23),G(56," Adam "),A(),S(57,"mat-button-toggle",24),G(58," RMSPROP "),A()(),S(59,"button",6),q("click",function(){return j(a),W(n.trainer.optimizer.reset_momentums())}),G(60," Reset momentums "),A()()()()(),Tt(),At(61,25),S(62,"div",26)(63,"div",27)(64,"h2"),G(65,"Context"),A(),S(66,"p"),G(67," In this setup, each datapoint lies in a 2D space. The color of the datapoint represents the class it belongs to. The goal of the neural network is to learn the decision boundary that separates the two classes in the 2D space. "),A(),S(68,"p"),G(69," The neural network receives the 2D coordinates of the datapoint as input and outputs the probability of the datapoint belonging to the blue class. The datapoints are randomly generated following different distributions: circular, linear or spiral. "),A(),S(70,"p"),G(71," The neural network is trained using the gradient descent algorithm. The loss function is the binary cross entropy loss. The network is trained using the backpropagation algorithm. "),A(),S(72,"h2"),G(73,"Model"),A(),S(74,"p"),G(75," You can visualize the weight's norms of the network's layers evolving over time. "),A(),S(76,"mat-accordion"),Te(77,$me,6,4,"mat-expansion-panel",28),A()(),S(78,"div",29)(79,"span",30),G(80," Left click: Add a red point, Shift+Left Click: Add a blue point, Ctrl+Click: remove a point."),A(),S(81,"div",31),Te(82,Xme,2,1,"ng-container",32),S(83,"canvas",33,0),q("click",function(s){return j(a),W(n.addPoint(s))}),G(85," Your browser does not support the HTML5 canvas tag. "),A()(),S(86,"span",34),G(87,"Probability of belonging to the blue class"),A(),S(88,"div",35),G(89," p=0 "),ae(90,"canvas",36,1),G(92," p=1.0 "),A(),Te(93,Yme,2,3,"span",37),A()(),Tt(),At(94,38),ae(95,"div",39),Tt(),A()}r&2&&(O("rightDrawer",!0),P(4),Vr(" ",n.isTraining?"Pause training":"Start training"," "),P(11),Nt("ngModel",n.datasetType),P(7),O("min",2)("max",256)("step",1)("title","Number of points"),Nt("value",n.n_points),P(),O("min",1)("max",n.n_points)("title","Batch size"),Nt("value",n.batch_size),P(6),O("min",0)("max",6)("title","Number of hidden layers"),Nt("value",n.n_layers),P(),O("min",4)("max",64)("title","Number of neurons per layer"),Nt("value",n.n_neurons),P(4),Nt("ngModel",n.currentActivation),P(14),O("min",1e-4)("max",.5)("step",.001)("title","Learning rate"),Nt("value",n.lr),P(),O("min",0)("max",.1)("step",1e-5)("title","Weight decay"),Nt("value",n.weight_decay),P(3),Nt("ngModel",n.optimizerType),P(25),O("ngForOf",n.model.layers),P(5),O("ngForOf",n.dataset.data),P(),O("width",n.gridResolution)("height",n.gridResolution),P(7),O("width",n.gridResolution)("height","1px"),P(3),O("ngIf",n.dataset),P(2),O("options",n.lossOptions))},dependencies:[mn,bo,Wa,Fn,cn,e0,yn,an,uU,Kl,Ql,pd,Lr,hr,Ga],styles:[".datapoint[_ngcontent-%COMP%]{border-radius:100%;width:.75em;z-index:250;aspect-ratio:1;transform:translate(-50%,-50%);border:rgb(192,192,192) solid 1px;box-shadow:#00000040 0 54px 55px,#0000001f 0 -12px 30px,#0000001f 0 4px 6px,#0000002b 0 12px 13px,#00000017 0 -3px 5px}.datapoint[_ngcontent-%COMP%]:hover{scale:1.5;transform-origin:top left;filter:brightness(1.5)}.canvasContainer[_ngcontent-%COMP%]{aspect-ratio:1;border-radius:1em;overflow:hidden;border:solid white 1px;box-shadow:#26394d 0 20px 30px -10px}"]})}return e})();var dM=class extends nl{pos=new kr([2]);out=new kr([1]);constructor(){super(),this.name="ToyLayer",this.pos.data=[0,0]}forward(){let t=this.pos.data[0],i=this.pos.data[1],r=this.equation(t,i);return this.out.data[0]=r,this.out}backward(){let t=this.pos.data[0],i=this.pos.data[1],r=this.derivative_x(t,i),n=this.derivative_y(t,i);return this.pos.grad[0]=r,this.pos.grad[1]=n,this.pos}parameters(){return[this.pos]}equation(t,i){return Math.sin(t*3)*Math.cos(i*3)}derivative_x(t,i){return 3*Math.cos(t*3)*Math.cos(i*3)}derivative_y(t,i){return-3*Math.sin(t*3)*Math.sin(i*3)}},Dw=class extends Ip{layer1=new dM;constructor(){super(),this.layers.push(this.layer1)}forward(){return this.layer1.forward()}backward(){return this.layer1.backward()}currentXY(){return this.layer1.pos.data}currentZ(){return this.forward().data[0]}currentXYZ(t=0){let i=this.currentXY(),r=this.currentZ();return r+=t,[i[0],i[1],r]}noisify_gradient(t=.1){this.layer1.pos.grad[0]+=Math.random()*t-t/2,this.layer1.pos.grad[1]+=Math.random()*t-t/2}equation(t,i){return this.layer1.equation(t,i)}parameters(){return this.layer1.parameters()}bound_check(t=-1,i=1){let r=this.layer1.pos.data[0],n=this.layer1.pos.data[1];this.layer1.pos.data[0]=Math.min(i,Math.max(t,r)),this.layer1.pos.data[1]=Math.min(i,Math.max(t,n))}};var kU=(()=>{class e extends nd{cdr;max_steps=100;simu_speed=50;max_history=25;step_size=.02;current_step=0;initial_xy=[.5,0];min=-1;max=1;noisyGradient=!1;isTraining=!1;trainer;lr=.01;wc=.1;echartInstance;echartLossPlotInstance;_isUpdating=!1;optimizerType="sgd";history=[];model=new Dw;optim;option={grid:{},animation:!1,visualMap:{show:!1,dimension:2,seriesIndex:[0,2],min:this.min,max:this.max,inRange:{symbolSize:[.5,15],color:["#313695","#4575b4","#74add1","#abd9e9","#abd9e9","#abd9e9","#fee090","#fdae61","#f46d43","#d73027","#a50026"]}},xAxis3D:{type:"value",min:this.min,max:this.max},yAxis3D:{type:"value",min:this.min,max:this.max},zAxis3D:{type:"value",show:!1,min:-1,max:1},grid3D:{show:!0,postEffect:{enable:!1}}};lossPlot={xAxis:{type:"value"},yAxis:{type:"value"},series:[{type:"line",data:[]}]};data={series:[{type:"line3D",data:this.history,visualMap:!0,lineStyle:{width:2,border:"black"}},{type:"scatter3D",zlevel:10,data:[this.model.currentXYZ()],symbol:"circle",symbolSize:10,itemStyle:{color:"black",opacity:.5}},{type:"surface",wireframe:{show:!1},dataShape:[Math.round((this.max-this.min)/this.step_size),Math.round((this.max-this.min)/this.step_size)]}]};constructor(i){super(),this.cdr=i,this.model.layer1.pos.data=[...this.initial_xy],this.changeOptimizer()}ngOnInit(){}ngAfterViewInit(){}onChartInit(i){this.echartInstance=i;let r=this.min,n=this.max,a=this.step_size,o=[];for(let s=r;s<n;s+=a)for(let l=r;l<n;l+=a)o.push([s,l,this.model.equation(s,l)]);this.data.series[2].data=o,requestAnimationFrame(()=>{this.updateOption()})}onLossChartInit(i){this.echartLossPlotInstance=i}onChartClick(i){if(this.isTraining&&this.pauseTraining(),i.seriesType==="surface"){let r=i.value[0],n=i.value[1];this.initial_xy=[r,n],this.resetToInitialPoint()}this.isTraining&&this.startTraining()}changeLearningRate(i){this.isTraining&&this.pauseTraining(),this.lr=i,this.optim=new al(this.model,this.lr,this.wc),this.isTraining&&this.startTraining()}changeOptimizer(){this.isTraining&&this.pauseTraining(),this.optimizerType==="sgd"?this.optim=new al(this.model,this.lr,this.wc):this.optimizerType==="Adam"?this.optim=new kp(this.model,this.lr,this.wc):this.optim=new Np(this.model,this.lr,this.wc),this.optim.reset_momentums(),this.isTraining&&this.startTraining()}switchTraining(){this.isTraining=!this.isTraining,this.isTraining?this.startTraining():clearInterval(this.trainer)}pauseTraining(){clearInterval(this.trainer)}startTraining(){this.trainer=setInterval(()=>{this.runTraining()},this.simu_speed)}runTraining(){if(!this.isTraining){clearInterval(this.trainer);return}this.step()}step(){if(this.current_step>=this.max_steps){this.resetToInitialPoint();return}this.model.backward(),this.noisyGradient&&this.model.noisify_gradient(5),this.optim.step(),this.model.bound_check(this.min,this.max),this.history.push(this.model.currentXYZ(.05)),this.current_step+=1,this.updateOption()}resetToInitialPoint(){this.model.layer1.pos.data=[...this.initial_xy],this.optim.reset_momentums(),this.current_step=0,this.history=[],this.updateOption()}updateOption(){this.data.series[1].data=[this.model.currentXYZ(.05)];let i=[];for(let a=this.history.length-this.max_history;a<this.history.length;a++)i.push(this.history[a]);this.data.series[0].data=i;let r={series:[this.data.series[0],this.data.series[1]]},n=[];this.history.forEach((a,o)=>{n.push([o,a[2]])}),this.echartInstance.setOption(r,{notMerge:!1,lazyUpdate:!0,silent:!0}),this.echartLossPlotInstance.setOption({series:[{data:n}]})}static \u0275fac=function(r){return new(r||e)(z(Vt))};static \u0275cmp=Ae({type:e,selectors:[["app-optimizer"]],features:[Ot],decls:28,vars:12,consts:[[3,"rightDrawer"],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],[1,"flex","flex-col","gap-2"],["mat-raised-button","","color","primary",1,"w-full",3,"click"],[3,"valueChange","min","max","step","value","title"],[1,"mb-2",3,"ngModelChange","change","ngModel"],["value","sgd",1,"flex-1"],["value","adam",1,"flex-1"],["value","RMSPROP",1,"flex-1"],[3,"ngModelChange","ngModel"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],[1,"grid","grid-cols-2","w-full"],["echarts","",1,"graph",3,"chartClick","chartInit","options","merge"],["echarts","",1,"graph",3,"chartInit","options"]],template:function(r,n){r&1&&(S(0,"app-tutorial-template",0),At(1,1),S(2,"div",2)(3,"button",3),q("click",function(){return n.switchTraining()}),G(4),A(),S(5,"button",3),q("click",function(){return n.resetToInitialPoint()}),G(6," Reset "),A(),ae(7,"mat-divider"),S(8,"app-labelled-sliders",4),q("valueChange",function(o){return n.changeLearningRate(o)}),A(),ae(9,"mat-divider"),S(10,"span"),G(11,"Optimizer"),A(),S(12,"mat-button-toggle-group",5),Pt("ngModelChange",function(o){return Dt(n.optimizerType,o)||(n.optimizerType=o),o}),q("change",function(){return n.changeOptimizer()}),S(13,"mat-button-toggle",6),G(14," SGD "),A(),S(15,"mat-button-toggle",7),G(16," Adam "),A(),S(17,"mat-button-toggle",8),G(18," RMSPROP "),A()(),S(19,"button",3),q("click",function(){return n.optim.reset_momentums()}),G(20," Reset momentums "),A(),ae(21,"mat-divider"),S(22,"mat-checkbox",9),Pt("ngModelChange",function(o){return Dt(n.noisyGradient,o)||(n.noisyGradient=o),o}),G(23," Noisy gradient "),A()(),Tt(),At(24,10),S(25,"div",11)(26,"div",12),q("chartClick",function(o){return n.onChartClick(o)})("chartInit",function(o){return n.onChartInit(o)}),A(),S(27,"div",13),q("chartInit",function(o){return n.onLossChartInit(o)}),A()(),Tt(),A()),r&2&&(O("rightDrawer",!0),P(4),Vr(" ",n.isTraining?"Pause training":"Start training"," "),P(4),O("min",0)("max",.3)("step",.001)("value",n.lr)("title","Learning rate"),P(4),Nt("ngModel",n.optimizerType),P(10),Nt("ngModel",n.noisyGradient),P(4),O("options",n.option)("merge",n.data),P(),O("options",n.lossPlot))},dependencies:[mn,Ap,bo,Wa,yn,an,Ew,Lr,hr,Ga],styles:[".graph[_ngcontent-%COMP%]{min-width:256px;border-color:#000;margin:5%;background:linear-gradient(#ffffff1a,#ffffff80);border-radius:2em}"]})}return e})();var NU=(()=>{class e extends nd{echartInstance;distribution=null;option={xAxis:{type:"value",min:-1,max:1},yAxis:{type:"value",min:-1,max:1},series:[{}]};covariance=1;constructor(){super()}ngOnInit(){}onChartInit(i){this.echartInstance=i,this.generateData()}generateData(){console.log(this.covariance);let i=eh(1e3,{x:0,y:0},[[1,this.covariance],[this.covariance,1]]),r=K6(i.map(s=>[s.x,s.y])),n=0,a=0;i.forEach(s=>{n=Math.min(n,s.x,s.y),a=Math.max(a,s.x,s.y)});let o=Math.max(Math.abs(n),Math.abs(a));this.option.xAxis={type:"value",min:-o,max:o},this.option.yAxis={type:"value",min:-o,max:o},this.option.series=[{type:"scatter",data:i.map(s=>[s.x,s.y]),symbolSize:5},{type:"line",data:[[0,0],[r.U[0][0],r.U[0][1]]]},{type:"line",data:[[0,0],[r.U[1][0],r.U[1][1]]]}],this.echartInstance.setOption(this.option)}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Ae({type:e,selectors:[["app-principal-component-analysis"]],features:[Ot],decls:6,vars:6,consts:[[3,"rightDrawer"],["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],[3,"valueChange","value","min","max","step"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],[1,"grid","grid-cols-2"],["echarts","",1,"aspect-square","max-w-[512px]","w-full",3,"chartInit","options"]],template:function(r,n){r&1&&(S(0,"app-tutorial-template",0),At(1,1),S(2,"app-labelled-sliders",2),Pt("valueChange",function(o){return Dt(n.covariance,o)||(n.covariance=o),o}),q("valueChange",function(){return n.generateData()}),A(),Tt(),At(3,3),S(4,"div",4)(5,"div",5),q("chartInit",function(o){return n.onChartInit(o)}),A()(),Tt(),A()),r&2&&(O("rightDrawer",!1),P(2),Nt("value",n.covariance),O("min",-5)("max",5)("step",.1),P(3),O("options",n.option))},dependencies:[mn,hr,Ga]})}return e})();var PU=(()=>{class e{graphData;charts;T=2;degree=5;polyCoefs=Array(this.degree+1).fill(0);xs=Pv(0,this.T*2*Math.PI,1e3);equation;noise=.5;xi=aM(this.xs,50);yi=this.xi.map(i=>this.noisyTrueFunction(i));constructor(){this.graphData={xAxis:{type:"value",min:0,max:this.T*2*Math.PI},yAxis:{type:"value",min:-2,max:2},legend:{show:!0,orient:"vertical",backgroundColor:"#ccc"},series:[{name:"Polynomial regression",type:"line",showSymbol:!1,data:this.xs.map(i=>[i,this.evaluatePolynomial(i,this.polyCoefs)])},{name:"True Function",type:"line",showSymbol:!1,data:this.xs.map(i=>[i,this.trueFunction(i)]),lineStyle:{opacity:.5,type:"dashed"}},{name:"Data",type:"scatter",data:this.xi.map((i,r)=>[i,this.yi[r]]),animation:!1}]}}ngOnInit(){}chartInit(i){this.charts=i,this.updatePolynomial()}trueFunction(i){return Math.sin(i)}noisyTrueFunction(i){return this.trueFunction(i)+this.noise*(Math.random()-.5)}evaluatePolynomial(i,r){let n=0;for(let a=0;a<r.length;a++)n+=r[a]*Math.pow(i,a);return n}updatePolynomial(){this.polyCoefs=Q6(this.xi,this.yi,this.degree),Array.isArray(this.graphData.series)&&(this.graphData.series[0].data=this.xs.map(r=>[r,this.evaluatePolynomial(r,this.polyCoefs)])),this.charts.setOption(this.graphData);let i=this.polyCoefs.map((r,n)=>{let a=Math.abs(r).toFixed(1);return r===0?"":n===0?`${r>0?"":"-"}${a}`:n===1?`${r>0?"+":"-"} ${a}x`:`${r>0?"+":"-"} ${a}x^${n}`}).join(" ");this.equation=`y = ${i}`}resamplePoints(){this.xi=aM(this.xs,25),this.yi=this.xi.map(i=>this.noisyTrueFunction(i)),Array.isArray(this.graphData.series)&&(this.graphData.series[2].data=this.xi.map((i,r)=>[i,this.yi[r]])),this.updatePolynomial()}rmse(){let i=this.xs.map(a=>this.evaluatePolynomial(a,this.polyCoefs)),r=this.xs.map(a=>this.trueFunction(a)),n=0;for(let a=0;a<i.length;a++)n+=Math.pow(i[a]-r[a],2);return Math.sqrt(n/i.length)}training_rmse(){let i=this.xi.map(n=>this.evaluatePolynomial(n,this.polyCoefs)),r=0;for(let n=0;n<i.length;n++)r+=Math.pow(i[n]-this.yi[n],2);return Math.sqrt(r/i.length)}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Ae({type:e,selectors:[["app-regression"]],decls:13,vars:13,consts:[["ngProjectAs","[drawerLeft]",5,["","drawerLeft",""]],[1,"flex","flex-col","m-2"],[3,"valueChange","title","value","max","min","step"],["mat-raised-button","","color","primary",3,"click"],["ngProjectAs","[centerContent]",5,["","centerContent",""]],["echarts","",1,"w-full",3,"chartInit","options"]],template:function(r,n){r&1&&(S(0,"app-tutorial-template"),At(1,0),S(2,"div",1)(3,"app-labelled-sliders",2),Pt("valueChange",function(o){return Dt(n.degree,o)||(n.degree=o),o}),q("valueChange",function(){return n.updatePolynomial()}),A(),S(4,"app-labelled-sliders",2),Pt("valueChange",function(o){return Dt(n.noise,o)||(n.noise=o),o}),q("valueChange",function(){return n.resamplePoints()}),A(),S(5,"button",3),q("click",function(){return n.resamplePoints()}),G(6,"Resample"),A()(),Tt(),At(7,4),S(8,"div",5),q("chartInit",function(o){return n.chartInit(o)}),A(),S(9,"div"),G(10),A(),S(11,"div"),G(12),A(),Tt(),A()),r&2&&(P(3),O("title","Polynomial degree"),Nt("value",n.degree),O("max",40)("min",0)("step",1),P(),O("title","Noise level"),Nt("value",n.noise),O("max",5)("min",0)("step",.01),P(4),O("options",n.graphData),P(2),Vr(" Training RMSE: ",n.training_rmse().toFixed(3)," "),P(2),Vr(" RMSE: ",n.rmse().toFixed(3),""))},dependencies:[mn,Lr,hr,Ga]})}return e})();var Zme=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:T4},{path:"fourierTransform",component:SV},{path:"spatialFiltering",component:CU},{path:"colorspaces",component:xV},{path:"morphology",component:fU},{path:"histogram",component:AV},{path:"weightLoss",component:iU},{path:"sampling",component:xU},{path:"spectralFiltering",component:EU},{path:"PSNR",component:AU},{path:"gradientDescent",component:IU},{path:"optimizer",component:kU},{path:"PCA",component:NU},{path:"regression",component:PU}],RU=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=je({type:e});static \u0275inj=Ge({imports:[xA.forRoot(Zme),xA]})}return e})();var FU=(()=>{class e{title="cv-toolbox";static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Ae({type:e,selectors:[["app-root"]],decls:6,vars:0,consts:[[1,"hide-smallscreen"],["routerLink","/home"]],template:function(r,n){r&1&&(S(0,"mat-toolbar",0)(1,"h1")(2,"a",1),G(3," Home"),A()()(),S(4,"div"),ae(5,"router-outlet"),A())},dependencies:[cp,mA,rd],styles:["a[_ngcontent-%COMP%]{color:inherit;text-decoration:inherit}h1[_ngcontent-%COMP%]{text-align:center;width:100%}"]})}return e})();var Kme=(()=>{class e extends o0{constructor(i,r,n){super(i,r,n,Ve($v,{optional:!0}))}ngOnDestroy(){this.flush()}static{this.\u0275fac=function(r){return new(r||e)(he(yt),he(Wp),he(a0))}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac})}}return e})();function Qme(){return new SI}function Jme(e,t,i){return new TI(e,t,i)}var LU=[{provide:a0,useFactory:Qme},{provide:o0,useClass:Kme},{provide:dh,useFactory:Jme,deps:[ph,o0,Xe]}],OU=[{provide:Wp,useFactory:()=>new AI},{provide:zi,useValue:"BrowserAnimations"},...LU],epe=[{provide:Wp,useClass:EI},{provide:zi,useValue:"NoopAnimations"},...LU],BU=(()=>{class e{static withConfig(i){return{ngModule:e,providers:i.disableAnimations?epe:OU}}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({providers:OU,imports:[d0]})}}return e})();var VU=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[GA,Et,GA,Et]})}}return e})();var zU=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[sy,On,Et,jl,WA,Sw]})}}return e})();var UU=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=je({type:e})}static{this.\u0275inj=Ge({imports:[Et,On,Et]})}}return e})();var tpe="@",ipe=(()=>{class e{constructor(i,r,n,a,o){this.doc=i,this.delegate=r,this.zone=n,this.animationType=a,this.moduleImpl=o,this._rendererFactoryPromise=null,this.scheduler=Ve($v,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-Z7LRCVW6.js")).catch(r=>{throw new Ji(5300,!1)}).then(({\u0275createEngine:r,\u0275AnimationRendererFactory:n})=>{this._engine=r(this.animationType,this.doc,this.scheduler);let a=new n(this.delegate,this._engine,this.zone);return this.delegate=a,a})}createRenderer(i,r){let n=this.delegate.createRenderer(i,r);if(n.\u0275type===0)return n;typeof n.throwOnSyntheticProps=="boolean"&&(n.throwOnSyntheticProps=!1);let a=new uM(n);return r?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(o=>{let s=o.createRenderer(i,r);a.use(s)}).catch(o=>{a.use(n)}),a}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static{this.\u0275fac=function(r){sh()}}static{this.\u0275prov=He({token:e,factory:e.\u0275fac})}}return e})(),uM=class{constructor(t){this.delegate=t,this.replay=[],this.\u0275type=1}use(t){if(this.delegate=t,this.replay!==null){for(let i of this.replay)i(t);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(t,i){return this.delegate.createElement(t,i)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}get destroyNode(){return this.delegate.destroyNode}appendChild(t,i){this.delegate.appendChild(t,i)}insertBefore(t,i,r,n){this.delegate.insertBefore(t,i,r,n)}removeChild(t,i,r){this.delegate.removeChild(t,i,r)}selectRootElement(t,i){return this.delegate.selectRootElement(t,i)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,i,r,n){this.delegate.setAttribute(t,i,r,n)}removeAttribute(t,i,r){this.delegate.removeAttribute(t,i,r)}addClass(t,i){this.delegate.addClass(t,i)}removeClass(t,i){this.delegate.removeClass(t,i)}setStyle(t,i,r,n){this.delegate.setStyle(t,i,r,n)}removeStyle(t,i,r){this.delegate.removeStyle(t,i,r)}setProperty(t,i,r){this.shouldReplay(i)&&this.replay.push(n=>n.setProperty(t,i,r)),this.delegate.setProperty(t,i,r)}setValue(t,i){this.delegate.setValue(t,i)}listen(t,i,r){return this.shouldReplay(i)&&this.replay.push(n=>n.listen(t,i,r)),this.delegate.listen(t,i,r)}shouldReplay(t){return this.replay!==null&&t.startsWith(tpe)}};function HU(e="animations"){return Uw("NgAsyncAnimations"),qv([{provide:dh,useFactory:(t,i,r)=>new ipe(t,i,r,e),deps:[yt,ph,Xe]},{provide:zi,useValue:e==="noop"?"NoopAnimations":"BrowserAnimations"}])}var rpe={openCVDirPath:"assets/opencv"},GU=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=je({type:e,bootstrap:[FU]});static \u0275inj=Ge({providers:[HU(),CM(ry.forRoot(rpe))],imports:[sO.forRoot({echarts:()=>import("./chunk-UDIY27WR.js")}),_U,UU,gV,I8,EV,On,L5,Uu,O5,F8,hU,V8,zU,Sw,rV,oV,hV,VU,mV,d0,q8,Q8,RU,BU]})}return e})();UI().bootstrapModule(GU,{ngZoneEventCoalescing:!0}).catch(e=>console.error(e));
